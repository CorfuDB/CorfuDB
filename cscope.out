cscope 15 $HOME/Projects/CorfuDB -q 0000010985 0003878990
	@.mvn/wrapper/MavenWrapperDownloader.java

20 
impÜt
 
	gjava
.
	gÃt
.*;

21 
impÜt
 
	gjava
.
	gio
.*;

22 
impÜt
 
	gjava
.
	gnio
.
	gchªÃls
.*;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

25 
public
 cÏs 
	cMav’W¿µ”DowÆßd”
 {

30 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_DOWNLOAD_URL
 =

37 
´iv©e
 
fš®
 
SŒšg
 
	mMAVEN_WRAPPER_PROPERTIES_PATH
 =

43 
´iv©e
 
fš®
 
SŒšg
 
	mMAVEN_WRAPPER_JAR_PATH
 =

49 
´iv©e
 
fš®
 
SŒšg
 
	mPROPERTY_NAME_WRAPPER_URL
 = "wrapperUrl";

51 
public
 
	$maš
(
SŒšg
 
¬gs
[]) {

52 
Sy¡em
.
out
.
	`´šn
("- Downloader started");

53 
Fe
 
ba£DœeùÜy
 = 
Ãw
 
	`Fe
(
¬gs
[0]);

54 
Sy¡em
.
out
.
	`´šn
("- Usšg ba£ dœeùÜy: " + 
ba£DœeùÜy
.
	`g‘AbsŞu‹P©h
());

58 
Fe
 
mav’W¿µ”Prİ”tyFe
 = 
Ãw
 
	`Fe
(
ba£DœeùÜy
, 
MAVEN_WRAPPER_PROPERTIES_PATH
);

59 
SŒšg
 
u¾
 = 
DEFAULT_DOWNLOAD_URL
;

60 if(
mav’W¿µ”Prİ”tyFe
.
	`exi¡s
()) {

61 
FeIÅutSŒ—m
 
mav’W¿µ”Prİ”tyFeIÅutSŒ—m
 = 
nuÎ
;

62 
Œy
 {

63 
mav’W¿µ”Prİ”tyFeIÅutSŒ—m
 = 
Ãw
 
	`FeIÅutSŒ—m
(
mav’W¿µ”Prİ”tyFe
);

64 
Prİ”t›s
 
mav’W¿µ”Prİ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

65 
mav’W¿µ”Prİ”t›s
.
	`lßd
(
mav’W¿µ”Prİ”tyFeIÅutSŒ—m
);

66 
u¾
 = 
mav’W¿µ”Prİ”t›s
.
	`g‘Prİ”ty
(
PROPERTY_NAME_WRAPPER_URL
, url);

67 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

68 
Sy¡em
.
out
.
	`´šn
("- ERROR†ßdšg '" + 
MAVEN_WRAPPER_PROPERTIES_PATH
 + "'");

69 } 
fš®ly
 {

70 
Œy
 {

71 if(
mav’W¿µ”Prİ”tyFeIÅutSŒ—m
 !ğ
nuÎ
) {

72 
mav’W¿µ”Prİ”tyFeIÅutSŒ—m
.
	`şo£
();

74 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

79 
Sy¡em
.
out
.
	`´šn
("- DowÆßdšg from: : " + 
u¾
);

81 
Fe
 
ouutFe
 = 
Ãw
 
	`Fe
(
ba£DœeùÜy
.
	`g‘AbsŞu‹P©h
(), 
MAVEN_WRAPPER_JAR_PATH
);

82 if(!
ouutFe
.
	`g‘P¬’tFe
().
	`exi¡s
()) {

83 if(!
ouutFe
.
	`g‘P¬’tFe
().
	`mkdœs
()) {

84 
Sy¡em
.
out
.
	`´šn
(

85 "- ERROR c»©šg ouuˆdœeüÜy '" + 
ouutFe
.
	`g‘P¬’tFe
().
	`g‘AbsŞu‹P©h
() + "'");

88 
Sy¡em
.
out
.
	`´šn
("- DowÆßdšgo: " + 
ouutFe
.
	`g‘AbsŞu‹P©h
());

89 
Œy
 {

90 
	`dowÆßdFeFromURL
(
u¾
, 
ouutFe
);

91 
Sy¡em
.
out
.
	`´šn
("Done");

92 
Sy¡em
.
	`ex™
(0);

93 } 
	`ÿtch
 (
ThrowabË
 
e
) {

94 
Sy¡em
.
out
.
	`´šn
("- Error downloading");

95 
e
.
	`´štSckT¿û
();

96 
Sy¡em
.
	`ex™
(1);

100 
´iv©e
 
	$dowÆßdFeFromURL
(
SŒšg
 
u¾SŒšg
, 
Fe
 
de¡š©iÚ
è
throws
 
Exû±iÚ
 {

101 
URL
 
webs™e
 = 
Ãw
 
	`URL
(
u¾SŒšg
);

102 
R—dabËBy‹ChªÃl
 
rbc
;

103 
rbc
 = 
ChªÃls
.
	`ÃwChªÃl
(
webs™e
.
	`İ’SŒ—m
());

104 
FeOuutSŒ—m
 
fos
 = 
Ãw
 
	`FeOuutSŒ—m
(
de¡š©iÚ
);

105 
fos
.
	`g‘ChªÃl
().
	`ŒªsãrFrom
(
rbc
, 0, 
LÚg
.
MAX_VALUE
);

106 
fos
.
	`şo£
();

107 
rbc
.
	`şo£
();

108 
	}
}

	@annotationProcessor/src/main/java/org/corfudb/annotations/ObjectAnnotationProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gAÂÙ©iÚS³c
;

6 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gCÏssName
;

7 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gF›ldS³c
;

8 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gJavaFe
;

9 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gM‘hodS³c
;

10 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gP¬am‘”S³c
;

11 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gP¬am‘”izedTy³Name
;

12 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gTy³Name
;

13 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gTy³S³c
;

14 
impÜt
 
	gcom
.
	gsqu¬eup
.
	gjav­Ût
.
	gTy³V¬ŸbËName
;

16 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

17 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

18 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

23 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

25 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

27 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	g´oûssšg
.
	gAb¡¿ùProûssÜ
;

28 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	g´oûssšg
.
	gF”
;

29 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	g´oûssšg
.
	gMes§g”
;

30 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	g´oûssšg
.
	gProûssšgEnvœÚm’t
;

31 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	g´oûssšg
.
	gRoundEnvœÚm’t
;

32 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	g´oûssšg
.
	gSuµÜ‹dAÂÙ©iÚTy³s
;

33 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	gSourûV”siÚ
;

34 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	g–em’t
.
	gEËm’tKšd
;

35 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	g–em’t
.
	gExecubËEËm’t
;

36 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	g–em’t
.
	gModif›r
;

37 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	g–em’t
.
	gNe¡šgKšd
;

38 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	g–em’t
.
	gTy³EËm’t
;

39 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	g–em’t
.
	gV¬ŸbËEËm’t
;

40 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	gty³
.
	gDeş¬edTy³
;

41 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	gty³
.
	gTy³Kšd
;

42 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	gty³
.
	gTy³MœrÜ
;

43 
impÜt
 
	gjavax
.
	gÏng
.
	gmod–
.
	gut
.
	gEËm’ts
;

44 
impÜt
 
	gjavax
.
	gtoŞs
.
	gDŸgno¡ic
;

46 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

47 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxy
;

48 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRUpÿÎT¬g‘
;

49 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoFunùiÚ
;

50 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoRecÜdFunùiÚ
;

61 @
SuµÜ‹dAÂÙ©iÚTy³s
("org.corfudb.annotations.*")

62 
public
 cÏs 
	cObjeùAÂÙ©iÚProûssÜ
 
ex‹nds
 
	mAb¡¿ùProûssÜ
 {

64 
´iv©e
 
EËm’ts
 
	m–em’tUts
;

65 
´iv©e
 
F”
 
	mf”
;

66 
´iv©e
 
Mes§g”
 
	mmes§g”
;

69 
´iv©e
 
fš®
 
SŒšg
 
	mCORFUSMR_FIELD
 = "_CORFUSMR";

75 @
Ov”ride


76 
public
 
SourûV”siÚ
 
	$g‘SuµÜ‹dSourûV”siÚ
() {

77  
SourûV”siÚ
.
	`Ï‹¡
();

84 @
Ov”ride


85 
public
 
synchrÚized
 
	$š™
(
ProûssšgEnvœÚm’t
 
´oûssšgEnv
) {

86 
su³r
.
	`š™
(
´oûssšgEnv
);

87 
–em’tUts
 = 
´oûssšgEnv
.
	`g‘EËm’tUts
();

88 
f”
 = 
´oûssšgEnv
.
	`g‘F”
();

89 
mes§g”
 = 
´oûssšgEnv
.
	`g‘Mes§g”
();

90 
	}
}

96 
public
 
boŞ—n
 
´oûss
(
S‘
<? 
ex‹nds
 
Ty³EËm’t
> 
ªnÙ©iÚs
, 
RoundEnvœÚm’t
 
roundEnv
) {

97 
	gŒy
 {

98 
	groundEnv
.
g‘RoÙEËm’ts
().
¡»am
()

99 .
f‹r
(
x
 -> x.
g‘Kšd
(è=ğ
EËm’tKšd
.
CLASS
)

101 .
f‹r
(
x
 -> !x.
g‘Sim¶eName
().
toSŒšg
().
’dsW™h
(
ICÜfuSMR
.
CORFUSMR_SUFFIX
))

102 .
m­
(
x
 -> (
Ty³EËm’t
) x)

103 .
fÜEach
(
this
::
´oûssCÏss
);

104 } 
ÿtch
 (
Exû±iÚ
 
e
) {

105 
	gmes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
, 
e
.
g‘Mes§ge
());

107  
	gŒue
;

114 
public
 
	$´oûssCÏss
(
Ty³EËm’t
 
şassEËm’t
) {

117 ià(
şassEËm’t
.
	`g‘AÂÙ©iÚ
(
CÜfuObjeù
.
şass
è!ğ
nuÎ
) {

119 
Œy
 {

120 
	`g’”©eProxy
(
şassEËm’t
);

121 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

122 
mes§g”
.
	`´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
, "Failedo…rocess class "

123 + 
şassEËm’t
.
	`g‘Sim¶eName
() + " with IOException");

127 
şassEËm’t
.
	`g‘Enşo£dEËm’ts
().
	`¡»am
()

128 .
	`f‹r
(
x
 -> x 
š¡ªûof
 
Ty³EËm’t
)

129 .
	`m­
(
x
 -> (
Ty³EËm’t
) x)

130 .
	`fÜEach
(
this
::
´oûssCÏss
);

131 
	}
}

138 
public
 
SŒšg
 
	$g‘SmrFunùiÚName
(
ExecubËEËm’t
 
smrM‘hod
) {

139 
MutÜAcûssÜ
 
mutÜAcûssÜ
 = 
smrM‘hod
.
	`g‘AÂÙ©iÚ
(MutÜAcûssÜ.
şass
);

140 
MutÜ
 
mutÜ
 = 
smrM‘hod
.
	`g‘AÂÙ©iÚ
(MutÜ.
şass
);

141  (
mutÜ
 !ğ
nuÎ
 && !mutÜ.
	`Çme
().
	`equ®s
("")) ? mutator.name() :

142 (
mutÜAcûssÜ
 !ğ
nuÎ
 && !mutÜAcûssÜ.
	`Çme
().
	`equ®s
(""))

144 
mutÜAcûssÜ
.
	`Çme
(è: 
smrM‘hod
.
	`g‘Sim¶eName
().
	`toSŒšg
();

145 
	}
}

148 şas 
	cSmrM‘hodInfo
 {

150 
fš®
 
ExecubËEËm’t
 
	gm‘hod
;

152 
fš®
 
Ty³EËm’t
 
	gš‹rçûOv”ride
;

154 
fš®
 
boŞ—n
 
	gdoNÙAdd
;

156 
fš®
 
boŞ—n
 
	ghasCÚæiùAÂÙ©iÚs
;

158 
fš®
 
SŒšg
 
	gcÚæiùFunùiÚ
;

160 
public
 
SmrM‘hodInfo
(
ExecubËEËm’t
 
m‘hod
,

161 
Ty³EËm’t
 
š‹rçûOv”ride
) {

162 
this
(
m‘hod
, 
š‹rçûOv”ride
, 
çl£
);

165 
public
 
SmrM‘hodInfo
(
ExecubËEËm’t
 
m‘hod
,

166 
Ty³EËm’t
 
š‹rçûOv”ride
,

167 
boŞ—n
 
doNÙAdd
) {

168 
	gthis
.
	gm‘hod
 = 
m‘hod
;

169 
	gthis
.
	gš‹rçûOv”ride
 = 
š‹rçûOv”ride
;

170 
	gthis
.
	gdoNÙAdd
 = 
doNÙAdd
;

171 
	gthis
.
	ghasCÚæiùAÂÙ©iÚs
 = 
checkFÜCÚæiùAÂÙ©iÚs
(
m‘hod
);

174 
AcûssÜ
 
	gacûssÜ
 = 
m‘hod
.
g‘AÂÙ©iÚ
(AcûssÜ.
şass
);

175 
MutÜAcûssÜ
 
	gmutÜAcûssÜ
 = 
m‘hod
.
g‘AÂÙ©iÚ
(MutÜAcûssÜ.
şass
);

176 
MutÜ
 
	gmutÜ
 = 
m‘hod
.
g‘AÂÙ©iÚ
(MutÜ.
şass
);

179 ià(
	gacûssÜ
 !ğ
nuÎ
 && !
acûssÜ
.
cÚæiùP¬am‘”FunùiÚ
().
equ®s
("")) {

180 
cÚæiùFunùiÚ
 = 
acûssÜ
.
cÚæiùP¬am‘”FunùiÚ
();

181 } ià(
	gmutÜ
 !ğ
nuÎ
 && !
mutÜ
.
cÚæiùP¬am‘”FunùiÚ
().
equ®s
("")) {

182 
cÚæiùFunùiÚ
 = 
mutÜ
.
cÚæiùP¬am‘”FunùiÚ
();

183 } ià(
	gmutÜAcûssÜ
 !ğ
nuÎ
 && !
mutÜAcûssÜ
.
cÚæiùP¬am‘”FunùiÚ
()

184 .
equ®s
("")) {

185 
cÚæiùFunùiÚ
 = 
mutÜAcûssÜ
.
cÚæiùP¬am‘”FunùiÚ
();

187 
	gcÚæiùFunùiÚ
 = 
nuÎ
;

190 ià(
	gcÚæiùFunùiÚ
 !ğ
nuÎ
 && 
hasCÚæiùAÂÙ©iÚs
) {

191 
mes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
, "Method "

192 + 
m‘hod
.
g‘Sim¶eName
()

194 + 
cÚæiùFunùiÚ
 + "'");

203 
´iv©e
 
boŞ—n
 
checkFÜCÚæiùAÂÙ©iÚs
(
ExecubËEËm’t
 
m‘hod
) {

204  
	gm‘hod
.
g‘P¬am‘”s
().
¡»am
()

205 .
ªyM©ch
(
x
 -> x.
g‘AÂÙ©iÚ
(
CÚæiùP¬am‘”
.
şass
)

206 !ğ
nuÎ
);

215 
public
 
	$g’”©eProxy
(
Ty³EËm’t
 
şassEËm’t
)

216 
throws
 
IOExû±iÚ
 {

218 
SŒšg
 
·ckageName
 = 
–em’tUts
.
	`g‘PackageOf
(
şassEËm’t
).
	`toSŒšg
();

220 
CÏssName
 
´oxyName
 = 
şassEËm’t
.
	`g‘Ne¡šgKšd
(è=ğ
Ne¡šgKšd
.
TOP_LEVEL


223 
CÏssName
.
	`be¡Guess
(
şassEËm’t
.
	`g‘Sim¶eName
(è+ 
ICÜfuSMR
.
CORFUSMR_SUFFIX
) :

225 
CÏssName
.
	`be¡Guess
(
şassEËm’t
.
	`g‘EnşosšgEËm’t
().
	`g‘Sim¶eName
()

226 + "$" + 
şassEËm’t
.
	`g‘Sim¶eName
(è+ 
ICÜfuSMR
.
CORFUSMR_SUFFIX
);

228 
Ty³Name
 
Üigš®Name
 = 
P¬am‘”izedTy³Name
.
	`g‘
(
şassEËm’t
.
	`asTy³
());

232 
Ty³S³c
.
Bud”
 
ty³S³cBud”
 = TypeSpec

233 .
	`şassBud”
(
´oxyName
)

234 .
	`addTy³V¬ŸbËs
(
şassEËm’t
.
	`g‘Ty³P¬am‘”s
()

235 .
	`¡»am
()

236 .
	`m­
(
Ty³V¬ŸbËName
::
g‘
)

237 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
())

239 .
	`addSu³rš‹rçû
(
P¬am‘”izedTy³Name


240 .
	`g‘
(
CÏssName
.g‘(
ICÜfuSMR
.
şass
), 
Üigš®Name
))

241 .
	`su³rşass
(
Üigš®Name
)

242 .
	`addModif›rs
(
Modif›r
.
PUBLIC
);

245 
şassEËm’t
.
	`g‘Enşo£dEËm’ts
().
	`¡»am
()

246 .
	`f‹r
(
x
 -> x.
	`g‘Kšd
(è=ğ
EËm’tKšd
.
CONSTRUCTOR
)

247 .
	`m­
(
x
 -> (
ExecubËEËm’t
) x)

248 .
	`fÜEach
(
x
 -> {

249 
ty³S³cBud”
.
	`addM‘hod
(
M‘hodS³c
.
	`cÚ¡ruùÜBud”
()

250 .
	`addModif›rs
(
Modif›r
.
PUBLIC
)

251 .
	`addP¬am‘”s
(
x
.
	`g‘P¬am‘”s
().
	`¡»am
()

252 .
	`m­
(
·¿m
 -> 
P¬am‘”S³c
.
	`bud”
(

253 
Ty³Name
.
	`g‘
(
·¿m
.
	`asTy³
()),

254 
·¿m
.
	`g‘Sim¶eName
().
	`toSŒšg
()

255 ).
	`bud
())

256 .
	`cŞËù
(
CŞËùÜs
.
	`toS‘
())

258 .
	`addS‹m’t
("super($L)",

259 
x
.
	`g‘P¬am‘”s
().
	`¡»am
()

260 .
	`m­
(
·¿m
 ->…¬am.
	`g‘Sim¶eName
().
	`toSŒšg
())

261 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", "))

263 .
	`bud
()

268 
ty³S³cBud”
.
	`addF›ld
(
P¬am‘”izedTy³Name
.
	`g‘
(
CÏssName
.g‘(
ICÜfuSMRProxy
.
şass
),

269 
Üigš®Name
), "´oxy" + 
CORFUSMR_FIELD
, 
Modif›r
.
PUBLIC
);

270 
ty³S³cBud”
.
	`addM‘hod
(
M‘hodS³c
.
	`m‘hodBud”
("getCorfuSMRProxy")

271 .
	`addModif›rs
(
Modif›r
.
PUBLIC
)

272 .
	`»tuºs
(
P¬am‘”izedTy³Name
.
	`g‘
(
CÏssName
.g‘(
ICÜfuSMRProxy
.
şass
),

273 
Üigš®Name
))

274 .
	`addS‹m’t
("»tuº $L", "´oxy" + 
CORFUSMR_FIELD
)

275 .
	`bud
());

276 
ty³S³cBud”
.
	`addM‘hod
(
M‘hodS³c
.
	`m‘hodBud”
("setCorfuSMRProxy")

277 .
	`addP¬am‘”
(
P¬am‘”izedTy³Name
.
	`g‘
(
CÏssName
.g‘(
ICÜfuSMRProxy
.
şass
),

278 
Üigš®Name
), "proxy")

279 .
	`addModif›rs
(
Modif›r
.
PUBLIC
)

280 .
	`»tuºs
(
Ty³Name
.
VOID
)

281 .
	`addS‹m’t
("this.$L =…roxy", "´oxy" + 
CORFUSMR_FIELD
)

282 .
	`bud
());

285 
fš®
 
S‘
<
SmrM‘hodInfo
> 
m‘hodS‘
 = 
şassEËm’t
.
	`g‘Enşo£dEËm’ts
().
	`¡»am
()

286 .
	`f‹r
(
x
 -> x.
	`g‘Kšd
(è=ğ
EËm’tKšd
.
METHOD
)

287 .
	`m­
(
x
 -> (
ExecubËEËm’t
) x)

288 .
	`f‹r
(
x
 -> !x.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
STATIC
))

289 .
	`m­
(
x
 -> 
Ãw
 
	`SmrM‘hodInfo
(x, 
nuÎ
))

290 .
	`cŞËù
(
CŞËùÜs
.
	`toCŞËùiÚ
(
HashS‘
::
Ãw
));

293 
Ty³EËm’t
 
su³rCÏssEËm’t
 = 
şassEËm’t
;

297 
su³rCÏssEËm’t
 = ((
Ty³EËm’t
)((
Deş¬edTy³
)su³rCÏssEËm’t.
	`g‘Su³rşass
())

298 .
	`asEËm’t
());

299 
boŞ—n
 
§mePackage
 = 
CÏssName
.
	`g‘
(
su³rCÏssEËm’t
).
	`·ckageName
().
	`equ®s
(

300 
CÏssName
.
	`g‘
(
şassEËm’t
).
	`·ckageName
());

302 
su³rCÏssEËm’t
.
	`g‘Enşo£dEËm’ts
().
	`¡»am
()

303 .
	`f‹r
(
x
 -> x.
	`g‘Kšd
(è=ğ
EËm’tKšd
.
METHOD
)

304 .
	`m­
(
x
 -> (
ExecubËEËm’t
) x)

305 .
	`f‹r
(
x
 -> !x.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
FINAL
))

306 .
	`f‹r
(
x
 -> !x.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
STATIC
))

308 .
	`f‹r
(
x
 -> 
§mePackage
 || !x.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
PROTECTED
))

310 .
	`f‹r
(
x
 -> x.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
PUBLIC
)

312 
x
.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
PROTECTED
))

313 .
	`fÜEach
(
x
 -> {

314 ià(
m‘hodS‘
.
	`¡»am
().
	`nÚeM©ch
(
y
 -> {

317 ià(
y
.
m‘hod
.
	`g‘Sim¶eName
().
	`equ®s
(
x
.getSimpleName())) {

318 ià(
y
.
m‘hod
.
	`g‘P¬am‘”s
().
	`size
(è=ğ
x
.getParameters().size()) {

321 ià(
x
.
	`g‘P¬am‘”s
().
	`¡»am
().
	`ªyM©ch
(
p
 ->

322 
p
.
	`asTy³
().
	`g‘Kšd
(è=ğ
Ty³Kšd
.
TYPEVAR
)) {

323  
Œue
;

326  
x
.
	`toSŒšg
().
	`equ®s
(
y
.
m‘hod
.toString());

330  
çl£
;

332 
m‘hodS‘
.
	`add
(
Ãw
 
	`SmrM‘hodInfo
(
x
, 
nuÎ
));

337 } !
CÏssName
.
	`g‘
(
su³rCÏssEËm’t
).
	`equ®s
(CÏssName.
OBJECT
));

340 
Li¡
<
Ty³MœrÜ
> 
®lIÁ”çûs
 = 
Ãw
 
A¼ayLi¡
<>();

341 
Li¡
<
Ty³MœrÜ
> 
vis™edIÁ”çûs
 = 
Ãw
 
A¼ayLi¡
<>();

343 
®lIÁ”çûs
.
	`addAÎ
(
şassEËm’t
.
	`g‘IÁ”çûs
());

345 
®lIÁ”çûs
.
	`¡»am
()

346 .
	`f‹r
(
x
 -> !
vis™edIÁ”çûs
.
	`cÚšs
(x))

347 .
	`m­
(
x
 -> (
Ty³EËm’t
è((
Deş¬edTy³
)x).
	`asEËm’t
())

348 .
	`f‹r
(
x
 -> x.
	`g‘IÁ”çûs
().
	`size
() > 0)

349 .
	`couÁ
() > 0) {

350 
Li¡
<
Ty³MœrÜ
> 
š‹rçûTy³s
 = 
Ãw
 
A¼ayLi¡
<>();

351 
®lIÁ”çûs
.
	`¡»am
()

352 .
	`f‹r
(
x
 -> !
vis™edIÁ”çûs
.
	`cÚšs
(x))

353 .
	`f‹r
(
x
 -> ((
Ty³EËm’t
è((
Deş¬edTy³
)x).
	`asEËm’t
())

354 .
	`g‘IÁ”çûs
().
	`size
() > 0)

355 .
	`fÜEach
(
x
 -> {

356 
Ty³EËm’t
 
t
 = (Ty³EËm’tè((
Deş¬edTy³
)
x
).
	`asEËm’t
();

357 
š‹rçûTy³s
.
	`addAÎ
(
t
.
	`g‘IÁ”çûs
());

358 
vis™edIÁ”çûs
.
	`add
(
x
);

360 
®lIÁ”çûs
.
	`addAÎ
(
š‹rçûTy³s
);

363 
S‘
<
Ty³Name
> 
š‹rçûsToAdd
 = 
Ãw
 
HashS‘
<>();

365 
®lIÁ”çûs
.
	`fÜEach
(
içû
 -> {

366 
Ty³EËm’t
 
içûEËm’t
 = (Ty³EËm’tè((
Deş¬edTy³
)
içû
).
	`asEËm’t
();

368 
içûEËm’t
.
	`g‘Enşo£dEËm’ts
().
	`¡»am
()

369 .
	`f‹r
(
x
 -> x.
	`g‘Kšd
(è=ğ
EËm’tKšd
.
METHOD
)

370 .
	`m­
(
x
 -> (
ExecubËEËm’t
) x)

371 .
	`fÜEach
(
m‘hod
 -> {

372 
O±iÚ®
<
SmrM‘hodInfo
> 
ov”wr™e
 =

373 
m‘hodS‘
.
	`¡»am
()

374 .
	`f‹r
(
x
 -> 
m‘hod
.
	`toSŒšg
().
	`equ®s
(x.method.toString()))

375 .
	`fšdFœ¡
();

376 ià(
m‘hod
.
	`g‘AÂÙ©iÚ
(
AcûssÜ
.
şass
è!ğ
nuÎ


377 || 
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ


378 || 
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ


379 || 
m‘hod
.
	`g‘AÂÙ©iÚ
(
PassThrough
.
şass
è!ğ
nuÎ
) {

380 ià(
ov”wr™e
.
	`isP»£Á
()) {

381 
m‘hodS‘
.
	`»move
(
ov”wr™e
.
	`g‘
());

382 
m‘hodS‘
.
	`add
(
Ãw
 
	`SmrM‘hodInfo
(
m‘hod
, 
nuÎ
));

384 
m‘hodS‘
.
	`add
(
Ãw
 
	`SmrM‘hodInfo
(
m‘hod
, 
içûEËm’t
));

386 } ià(
m‘hod
.
	`g‘AÂÙ©iÚ
(
IÁ”çûOv”ride
.
şass
è!ğ
nuÎ
) {

387 
š‹rçûsToAdd
.
	`add
(
P¬am‘”izedTy³Name
.
	`g‘
(
içûEËm’t
.
	`asTy³
()));

388 ià(
ov”wr™e
.
	`isP»£Á
()) {

389 
m‘hodS‘
.
	`»move
(
ov”wr™e
.
	`g‘
());

391 
m‘hodS‘
.
	`add
(
Ãw
 
	`SmrM‘hodInfo
(
m‘hod
,

392 
içûEËm’t
));

396 
m‘hod
.
	`g‘Modif›rs
().
	`cÚšs
(
Modif›r
.
DEFAULT
)

398 
m‘hodS‘
.
	`¡»am
().
	`nÚeM©ch
(
x
 -> x.
m‘hod
.
	`toSŒšg
()

399 .
	`equ®s
(
m‘hod
.
	`toSŒšg
()))) {

400 
m‘hodS‘
.
	`add
(
Ãw
 
	`SmrM‘hodInfo
(
m‘hod
,

401 
içûEËm’t
, 
Œue
));

407 
m‘hodS‘
.
	`»moveIf
(
x
 -> x.
m‘hod
.
	`g‘Sim¶eName
()

408 .
	`toSŒšg
().
	`’dsW™h
(
ICÜfuSMR
.
CORFUSMR_SUFFIX
));

411 
	`checkAÂÙ©edNames
(
m‘hodS‘
);

414 
S‘
<
SmrM‘hodInfo
> 
upC®ls
 = 
m‘hodS‘
.
	`¡»am
()

415 .
	`f‹r
(
x
 -> ((x.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ
)

416 && !
x
.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
	`noUpÿÎ
())

417 || ((
x
.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ
)

418 && !
x
.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
).
	`noUpÿÎ
()))

419 .
	`cŞËù
(
CŞËùÜs
.
	`toCŞËùiÚ
(
HashS‘
::
Ãw
));

421 
	`checkOv”lßdCÚæiùs
(
upC®ls
);

424 
S‘
<
SmrM‘hodInfo
> 
noUpÿÎs
 = 
m‘hodS‘
.
	`¡»am
()

425 .
	`f‹r
(
x
 -> ((x.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ
)

426 && 
x
.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
	`noUpÿÎ
())

427 || ((
x
.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ
)

428 && 
x
.
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
).
	`noUpÿÎ
()))

429 .
	`cŞËù
(
CŞËùÜs
.
	`toCŞËùiÚ
(
HashS‘
::
Ãw
));

431 
	`v”ifyNoUpC®lReã»nû
(
noUpÿÎs
, 
upC®ls
);

434 
m‘hodS‘
.
	`¡»am
()

435 .
	`f‹r
(
x
 -> !x.
doNÙAdd
)

436 .
	`fÜEach
(
m
 -> {

438 
ExecubËEËm’t
 
smrM‘hod
 = 
m
.
m‘hod
;

441 
fš®
 
AcûssÜ
 
acûssÜ
 = 
smrM‘hod
.
	`g‘AÂÙ©iÚ
(AcûssÜ.
şass
);

442 
fš®
 
MutÜAcûssÜ
 
mutÜAcûssÜ
 = 
smrM‘hod


443 .
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
);

444 
fš®
 
MutÜ
 
mutÜ
 = 
smrM‘hod
.
	`g‘AÂÙ©iÚ
(MutÜ.
şass
);

445 
fš®
 
T¿n§ùiÚ®M‘hod
 
Œª§ùiÚ®
 = 
smrM‘hod


446 .
	`g‘AÂÙ©iÚ
(
T¿n§ùiÚ®M‘hod
.
şass
);

449 
M‘hodS³c
.
Bud”
 
ms
 = M‘hodS³c.
	`ov”ridšg
(
smrM‘hod
);

453 
Œy
 {

454 
F›ld
 
f
 = 
ms
.
	`g‘CÏss
().
	`g‘Deş¬edF›ld
("modifiers");

455 
f
.
	`£tAcûssibË
(
Œue
);

456 ((
Li¡
<
Modif›r
>)
f
.
	`g‘
(
ms
)).
	`»move
(Modif›r.
NATIVE
);

457 ((
Li¡
<
Modif›r
>)
f
.
	`g‘
(
ms
)).
	`»move
(Modif›r.
DEFAULT
);

458 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

459 
mes§g”
.
	`´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
,

461 + 
e
.
	`g‘Mes§ge
());

465 
boŞ—n
 
hasCÚæiùD©a
 = 
çl£
;

466 
fš®
 
SŒšg
 
cÚæiùF›ld
 = "cÚæiùF›ld" + 
CORFUSMR_FIELD
;

469 ià(
m
.
cÚæiùFunùiÚ
 !ğ
nuÎ
) {

470 
hasCÚæiùD©a
 = 
Œue
;

471 
	`addCÚæiùF›ldFromFunùiÚToM‘hod
(
ms
, 
cÚæiùF›ld
,

472 
m
.
cÚæiùFunùiÚ
, 
smrM‘hod
);

473 } ià(
m
.
hasCÚæiùAÂÙ©iÚs
) {

474 
hasCÚæiùD©a
 = 
Œue
;

475 
	`addCÚæiùF›ldToM‘hod
(
ms
, 
cÚæiùF›ld
, 
smrM‘hod
);

479 ià(
mutÜ
 !ğ
nuÎ
 || 
mutÜAcûssÜ
 !=‚ull) {

480 
ms
.
	`addS‹m’t
(

481 (
mutÜAcûssÜ
 !ğ
nuÎ
 ? "long‡ddress"

482 + 
CORFUSMR_FIELD
 + " = " : "")

483 + "´oxy" + 
CORFUSMR_FIELD
 + ".logUpdate($S,$L,$L$L$L)",

484 
	`g‘SmrFunùiÚName
(
smrM‘hod
),

486 
mutÜ
 !ğ
nuÎ
 ? "false" :

488 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

490 
hasCÚæiùD©a
 ? 
cÚæiùF›ld
 : "null",

491 
smrM‘hod
.
	`g‘P¬am‘”s
().
	`size
() > 0 ? "," : "",

492 
smrM‘hod
.
	`g‘P¬am‘”s
().
	`¡»am
()

493 .
	`m­
(
V¬ŸbËEËm’t
::
g‘Sim¶eName
)

494 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")));

500 ià(
mutÜAcûssÜ
 !ğ
nuÎ
) {

503 ià(!
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)) {

504 
ms
.
	`addS‹m’t
("return ("

505 + 
P¬am‘”izedTy³Name
.
	`g‘
(
smrM‘hod
.
	`g‘R‘uºTy³
())

506 + "è´oxy" + 
CORFUSMR_FIELD


508 + 
CORFUSMR_FIELD


510 + (
m
.
hasCÚæiùAÂÙ©iÚs
 ? 
cÚæiùF›ld
 : "null")

513 } ià(
Œª§ùiÚ®
 !ğ
nuÎ
) {

515 
ms
.
	`addCode
(
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

516 ? "´oxy" + 
CORFUSMR_FIELD
 + ".TXExecute(() -> {" :

517 "»tuº…roxy" + 
CORFUSMR_FIELD
 + ".TXExecute(() -> {"

519 
ms
.
	`addS‹m’t
("$Lsuper.$L($L)",

520 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

522 
smrM‘hod
.
	`g‘Sim¶eName
(),

523 
smrM‘hod
.
	`g‘P¬am‘”s
().
	`¡»am
()

524 .
	`m­
(
V¬ŸbËEËm’t
::
g‘Sim¶eName
)

525 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")));

526 
ms
.
	`addCode
(
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

529 } ià(
smrM‘hod
.
	`g‘AÂÙ©iÚ
(
PassThrough
.
şass
è!ğ
nuÎ
) {

531 
ms
.
	`addS‹m’t
((
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
()

532 .
	`equ®s
(
Ty³Kšd
.
VOID
) ? "" : "return ") + "proxy"

533 + 
CORFUSMR_FIELD
 + ".passThrough(" + "o" + CORFUSMR_FIELD

534 + " -> {$Lo" + 
CORFUSMR_FIELD
 + ".$L($L);$L})",

535 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

537 
smrM‘hod
.
	`g‘Sim¶eName
(),

538 
smrM‘hod
.
	`g‘P¬am‘”s
().
	`¡»am
()

539 .
	`m­
(
V¬ŸbËEËm’t
::
g‘Sim¶eName
)

540 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")),

541 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

544 } ià(
smrM‘hod
.
	`g‘AÂÙ©iÚ
(
IÁ”çûOv”ride
.
şass
è!ğ
nuÎ
) {

545 
ms
.
	`addS‹m’t
("$L$T.super.$L($L)",

546 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

548 
CÏssName
.
	`g‘
(
m
.
š‹rçûOv”ride
),

549 
smrM‘hod
.
	`g‘Sim¶eName
(),

550 
smrM‘hod
.
	`g‘P¬am‘”s
().
	`¡»am
()

551 .
	`m­
(
V¬ŸbËEËm’t
::
g‘Sim¶eName
)

552 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")));

553 } ià(
mutÜ
 =ğ
nuÎ
) {

555 
ms
.
	`addS‹m’t
((
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
()

556 .
	`equ®s
(
Ty³Kšd
.
VOID
) ? "" : "return ") + "proxy"

557 + 
CORFUSMR_FIELD
 + ".access(" + "o" + CORFUSMR_FIELD

558 + " -> {$Lo" + 
CORFUSMR_FIELD
 + ".$L($L);$L}," + "$L)",

559 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

561 
smrM‘hod
.
	`g‘Sim¶eName
(),

562 
smrM‘hod
.
	`g‘P¬am‘”s
().
	`¡»am
()

563 .
	`m­
(
V¬ŸbËEËm’t
::
g‘Sim¶eName
)

564 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")),

565 
smrM‘hod
.
	`g‘R‘uºTy³
().
	`g‘Kšd
().
	`equ®s
(
Ty³Kšd
.
VOID
)

567 (
m
.
hasCÚæiùAÂÙ©iÚs
 ? 
cÚæiùF›ld
 : "null")

571 ià(
smrM‘hod
.
	`g‘AÂÙ©iÚ
(
DÚtIn¡rum’t
.
şass
è=ğ
nuÎ
) {

572 
ty³S³cBud”
.
	`addM‘hod
(
ms
.
	`bud
());

576 
	`addUpÿÎM­
(
ty³S³cBud”
, 
Üigš®Name
, 
š‹rçûsToAdd
, 
m‘hodS‘
);

577 
	`addUndoRecÜdM­
(
ty³S³cBud”
, 
Üigš®Name
, 
š‹rçûsToAdd
, 
m‘hodS‘
);

578 
	`addUndoM­
(
ty³S³cBud”
, 
Üigš®Name
, 
š‹rçûsToAdd
, 
m‘hodS‘
);

579 
	`addRe£tS‘
(
ty³S³cBud”
, 
Üigš®Name
, 
š‹rçûsToAdd
, 
m‘hodS‘
);

581 
ty³S³cBud”


582 .
	`addSu³rš‹rçûs
(
š‹rçûsToAdd
);

584 
ty³S³cBud”


585 .
	`addAÂÙ©iÚ
(
AÂÙ©iÚS³c
.
	`bud”
(
In¡rum’‹dCÜfuObjeù
.
şass
).
	`bud
());

587 
JavaFe
 
javaFe
 = JavaFile

588 .
	`bud”
(
·ckageName
,

589 
ty³S³cBud”
.
	`bud
())

590 .
	`bud
();

592 
javaFe
.
	`wr™eTo
(
f”
);

593 
	}
}

598 
checkAÂÙ©edNames
(
S‘
<
SmrM‘hodInfo
> 
m‘hodS‘
) {

600 
SmrM‘hodInfo
 
	gsmrM‘hodInfo
 : 
m‘hodS‘
) {

601 ià((
smrM‘hodInfo
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ


602 && 
smrM‘hodInfo
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
Çme
().
isEm±y
())

603 || (
smrM‘hodInfo
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ


604 && 
smrM‘hodInfo
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
).
Çme
()

605 .
isEm±y
())) {

606 
mes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
, "Method "

607 + 
smrM‘hodInfo
.
m‘hod
.
g‘Sim¶eName
()

613 
SŒšg
 
	$g‘AÂÙ©iÚNameF›ld
(
ExecubËEËm’t
 
m‘hod
) {

614 
SŒšg
 
Çme
 = "";

616 ià(
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ
) {

617 
Çme
 = 
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
	`Çme
();

618 } ià(
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ
) {

619 
Çme
 = 
m‘hod
.
	`g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
).
	`Çme
();

622  
Çme
;

623 
	}
}

628 
v”ifyNoUpC®lReã»nû
(
S‘
<
SmrM‘hodInfo
> 
noUpÿÎs
, S‘<SmrM‘hodInfo> 
upC®ls
) {

630 
	gS‘
<
	gSŒšg
> 
	gupC®lM‘hodNames
 = 
upC®ls
.
¡»am
()

631 .
m­
(
x
 -> 
g‘AÂÙ©iÚNameF›ld
(x.
m‘hod
))

632 .
cŞËù
(
CŞËùÜs
.
toCŞËùiÚ
(
HashS‘
::
Ãw
));

634 
SmrM‘hodInfo
 
	gsmrM‘hodInfo
 : 
noUpÿÎs
) {

635 
SŒšg
 
m‘hodName
 = 
g‘AÂÙ©iÚNameF›ld
(
smrM‘hodInfo
.
m‘hod
);

637 ià(!
	gupC®lM‘hodNames
.
cÚšs
(
m‘hodName
)) {

638 
	gmes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
,

639 "E¼Ü " + 
smrM‘hodInfo
.
m‘hod
.
toSŒšg
()

648 
checkOv”lßdCÚæiùs
(
S‘
<
SmrM‘hodInfo
> 
possibËCÚæiùM‘hods
) {

649 
	gS‘
<
	gSmrM‘hodInfo
> 
	g®lM‘hods
 = 
Ãw
 
HashS‘
<>(
possibËCÚæiùM‘hods
);

651 
SmrM‘hodInfo
 
	gsmrM‘hodInfo
 : 
possibËCÚæiùM‘hods
) {

652 
S‘
<
SmrM‘hodInfo
> 
£tDiff
 = 
Ãw
 
HashS‘
<>(
®lM‘hods
);

653 
	g£tDiff
.
»move
(
smrM‘hodInfo
);

655 
SŒšg
 
	gba£M‘hodName
 = 
g‘AÂÙ©iÚNameF›ld
(
smrM‘hodInfo
.
m‘hod
);

657 
SmrM‘hodInfo
 
	gsmrM‘hodInfo2
 : 
£tDiff
) {

658 
SŒšg
 
m‘hodName
 = 
g‘AÂÙ©iÚNameF›ld
(
smrM‘hodInfo2
.
m‘hod
);

660 ià(
	gba£M‘hodName
.
equ®s
(
m‘hodName
)) {

661 
	gmes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
,

663 + 
smrM‘hodInfo
.
m‘hod
.
toSŒšg
() + "‡nd "

664 + 
smrM‘hodInfo2
.
m‘hod
.
toSŒšg
());

678 
´iv©e
 
addRe£tS‘
(
Ty³S³c
.
Bud”
 
ty³S³cBud”
, 
Ty³Name
 
Üigš®Name
,

679 
S‘
<
Ty³Name
> 
š‹rçûsToAdd
, S‘<
SmrM‘hodInfo
> 
m‘hodS‘
) {

681 
SŒšg
 
	g»£tSŒšg
 = 
m‘hodS‘
.
¡»am
()

682 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ


683 && 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
»£t
()

684 || 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ


685 && 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
).
»£t
())

686 .
m­
(
x
 -> "\n.add(\"" + 
g‘SmrFunùiÚName
(x.
m‘hod
) + "\")")

687 .
cŞËù
(
CŞËùÜs
.
joššg
());

689 
F›ldS³c
 
	g»£tS‘
 = F›ldS³c.
bud”
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
S‘
.
şass
),

690 
CÏssName
.
g‘
(
SŒšg
.
şass
)), "»£tS‘" + 
CORFUSMR_FIELD
,

691 
Modif›r
.
FINAL
, Modif›r.
PUBLIC
)

692 .
š™Ÿliz”
("new $T()$L.build()",

693 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
ImmubËS‘
.
Bud”
.
şass
),

694 
CÏssName
.
g‘
(
SŒšg
.
şass
)), 
»£tSŒšg
)

695 .
bud
();

697 
	gty³S³cBud”
.
addF›ld
(
»£tS‘
);

698 
	gty³S³cBud”
.
addM‘hod
(
M‘hodS³c
.
m‘hodBud”
("getCorfuResetSet")

699 .
addModif›rs
(
Modif›r
.
PUBLIC
)

700 .
»tuºs
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
S‘
.
şass
),

701 
CÏssName
.
g‘
(
SŒšg
.
şass
)))

702 .
addS‹m’t
("»tuº $L", "»£tS‘" + 
CORFUSMR_FIELD
)

703 .
bud
());

707 
´iv©e
 
addUpÿÎM­
(
Ty³S³c
.
Bud”
 
ty³S³cBud”
, 
Ty³Name
 
Üigš®Name
,

708 
S‘
<
Ty³Name
> 
š‹rçûsToAdd
, S‘<
SmrM‘hodInfo
> 
m‘hodS‘
) {

711 
SŒšg
 
	gupÿÎSŒšg
 = 
m‘hodS‘
.
¡»am
()

712 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ


713 || (
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ


714 && !
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
noUpÿÎ
()))

715 .
m­
(
x
 -> "\n.put(\"" + 
g‘SmrFunùiÚName
(x.
m‘hod
) + "\", "

716 + "(obj,‡rgsè-> { " + (
x
.
m‘hod
.
g‘R‘uºTy³
()

717 .
g‘Kšd
().
equ®s
(
Ty³Kšd
.
VOID
)

718 ? "" : "»tuº "è+ "obj." + 
x
.
m‘hod
.
g‘Sim¶eName
() + "("

719 + 
IÁSŒ—m
.
¿nge
(0, 
x
.
m‘hod
.
g‘P¬am‘”s
().
size
())

720 .
m­ToObj
(
i
 ->

721 "(" + 
x
.
m‘hod
.
g‘P¬am‘”s
().
g‘
(
i
)

722 .
asTy³
().
toSŒšg
(è+ ")" + "‡rgs[" + 
i
 + "]")

723 .
cŞËù
(
CŞËùÜs
.
joššg
(", "))

724 + ");" + (
x
.
m‘hod
.
g‘R‘uºTy³
().
g‘Kšd
().
equ®s
(
Ty³Kšd
.
VOID
)

726 .
cŞËù
(
CŞËùÜs
.
joššg
());

728 
F›ldS³c
 
	gupÿÎM­
 = F›ldS³c.
bud”
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
M­
.
şass
),

729 
CÏssName
.
g‘
(
SŒšg
.
şass
),

730 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
ICÜfuSMRUpÿÎT¬g‘
.
şass
),

731 
Üigš®Name
)), "upÿÎM­" + 
CORFUSMR_FIELD
,

732 
Modif›r
.
PUBLIC
, Modif›r.
FINAL
)

733 .
š™Ÿliz”
("new $T()$L.build()",

734 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
ImmubËM­
.
Bud”
.
şass
),

735 
CÏssName
.
g‘
(
SŒšg
.
şass
),

736 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName


737 .
g‘
(
ICÜfuSMRUpÿÎT¬g‘
.
şass
),

738 
Üigš®Name
)), 
upÿÎSŒšg
)

739 .
bud
();

741 
	gty³S³cBud”


742 .
addF›ld
(
upÿÎM­
);

744 
	gty³S³cBud”
.
addM‘hod
(
M‘hodS³c
.
m‘hodBud”
("getCorfuSMRUpcallMap")

745 .
addModif›rs
(
Modif›r
.
PUBLIC
)

746 .
»tuºs
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
M­
.
şass
),

747 
CÏssName
.
g‘
(
SŒšg
.
şass
),

748 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
ICÜfuSMRUpÿÎT¬g‘
.
şass
),

749 
Üigš®Name
)))

750 .
addS‹m’t
("»tuº $L", "upÿÎM­" + 
CORFUSMR_FIELD
)

751 .
bud
());

755 
´iv©e
 
addUndoRecÜdM­
(
Ty³S³c
.
Bud”
 
ty³S³cBud”
, 
Ty³Name
 
Üigš®Name
,

756 
S‘
<
Ty³Name
> 
š‹rçûsToAdd
, S‘<
SmrM‘hodInfo
> 
m‘hodS‘
) {

761 
SŒšg
 
	gundoRecÜdSŒšg
 = 
m‘hodS‘
.
¡»am
()

762 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ


763 || 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ
)

764 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è=ğ
nuÎ


765 || !
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
)

766 .
undoRecÜdFunùiÚ
().
equ®s
(""))

767 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è=ğ
nuÎ


768 || !
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
undoRecÜdFunùiÚ
().
equ®s
(""))

769 .
m­
(
x
 -> {

770 
MutÜAcûssÜ
 
mutÜAcûssÜ
 = 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(MutÜAcûssÜ.
şass
);

771 
MutÜ
 
mutÜ
 = 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(MutÜ.
şass
);

772 
SŒšg
 
undoRecÜdFunùiÚ
 = 
mutÜ
 =ğ
nuÎ


773 ? 
mutÜAcûssÜ
.
undoRecÜdFunùiÚ
() :

774 
mutÜ
.
undoRecÜdFunùiÚ
();

776 
O±iÚ®
<
SmrM‘hodInfo
> 
mi
 = 
m‘hodS‘
.
¡»am
()

777 .
f‹r
(
y
 ->

778 
y
.
m‘hod
.
g‘Sim¶eName
().
toSŒšg
().
equ®s
(
undoRecÜdFunùiÚ
))

779 .
fšdFœ¡
();

782 ià(!
mi
.
isP»£Á
()) {

783 
mes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
MANDATORY_WARNING
,

785 + 
x
.
m‘hod
.
g‘Sim¶eName
(è+ "‚amed " + 
undoRecÜdFunùiÚ
);

790 ià(
mi
.
g‘
().
m‘hod
.
g‘P¬am‘”s
().
size
()

791 !ğ
x
.
m‘hod
.
g‘P¬am‘”s
().
size
() + 1) {

792 
mes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
, "undoRecord method "

793 + 
undoRecÜdFunùiÚ
 + " containedhe wrong‚umber of…arameters");

797 ià(
mi
.
g‘
().
š‹rçûOv”ride
 !ğ
nuÎ
) {

798 
š‹rçûsToAdd
.
add
(
P¬am‘”izedTy³Name


799 .
g‘
(
mi
.g‘().
š‹rçûOv”ride
.
asTy³
()));

801 
SŒšg
 
ÿÎšgCÚv’tiÚ
 = 
mi
.
g‘
().
š‹rçûOv”ride
 =ğ
nuÎ
 ? "this." :

802 
mi
.
g‘
().
š‹rçûOv”ride
.
g‘Sim¶eName
() + ".super.";

804  "\n.put(\"" + 
g‘SmrFunùiÚName
(
x
.
m‘hod
) + "\", "

806 + 
ÿÎšgCÚv’tiÚ
 + 
undoRecÜdFunùiÚ
 + "(obj,"

807 + 
IÁSŒ—m
.
¿nge
(0, 
x
.
m‘hod
.
g‘P¬am‘”s
().
size
())

808 .
m­ToObj
(
i
 ->

809 "(" + 
mi
.
g‘
().
m‘hod
.
g‘P¬am‘”s
().g‘(
i
 + 1)

810 .
asTy³
().
toSŒšg
() + ")"

811 + "‡rgs[" + 
i
 + "]")

812 .
cŞËù
(
CŞËùÜs
.
joššg
(", "))

814 .
cŞËù
(
CŞËùÜs
.
joššg
());

816 
F›ldS³c
 
	gundoRecÜdM­
 = F›ldS³c.
bud”
(
P¬am‘”izedTy³Name


817 .
g‘
(
CÏssName
.g‘(
M­
.
şass
),

818 
CÏssName
.
g‘
(
SŒšg
.
şass
),

819 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
IUndoRecÜdFunùiÚ
.
şass
),

820 
Üigš®Name
)), "undoRecÜdM­" + 
CORFUSMR_FIELD
,

821 
Modif›r
.
PUBLIC
, Modif›r.
FINAL
)

822 .
š™Ÿliz”
("new $T()$L.build()",

823 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
ImmubËM­
.
Bud”
.
şass
),

824 
CÏssName
.
g‘
(
SŒšg
.
şass
),

825 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
IUndoRecÜdFunùiÚ
.
şass
),

826 
Üigš®Name
)), 
undoRecÜdSŒšg
)

827 .
bud
();

829 
	gty³S³cBud”
.
addF›ld
(
undoRecÜdM­
);

831 
	gty³S³cBud”
.
addM‘hod
(
M‘hodS³c
.
m‘hodBud”
("getCorfuUndoRecordMap")

832 .
addModif›rs
(
Modif›r
.
PUBLIC
)

833 .
»tuºs
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
M­
.
şass
),

834 
CÏssName
.
g‘
(
SŒšg
.
şass
),

835 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
IUndoRecÜdFunùiÚ
.
şass
),

836 
Üigš®Name
)))

837 .
addS‹m’t
("»tuº $L", "undoRecÜdM­" + 
CORFUSMR_FIELD
)

838 .
bud
());

843 
´iv©e
 
addUndoM­
(
Ty³S³c
.
Bud”
 
ty³S³cBud”
, 
Ty³Name
 
Üigš®Name
,

844 
S‘
<
Ty³Name
> 
š‹rçûsToAdd
, S‘<
SmrM‘hodInfo
> 
m‘hodS‘
) {

845 
SŒšg
 
	gundoSŒšg
 = 
m‘hodS‘
.
¡»am
()

846 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è!ğ
nuÎ


847 || 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è!ğ
nuÎ
)

848 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
è=ğ
nuÎ


849 || !
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜAcûssÜ
.
şass
)

850 .
undoRecÜdFunùiÚ
().
equ®s
(""))

851 .
f‹r
(
x
 -> x.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
è=ğ
nuÎ


852 || !
x
.
m‘hod
.
g‘AÂÙ©iÚ
(
MutÜ
.
şass
).
undoRecÜdFunùiÚ
().
equ®s
(""))

853 .
m­
(
x
 -> {

854 
MutÜAcûssÜ
 
mutÜAcûssÜ
 = 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(MutÜAcûssÜ.
şass
);

855 
MutÜ
 
mutÜ
 = 
x
.
m‘hod
.
g‘AÂÙ©iÚ
(MutÜ.
şass
);

856 
SŒšg
 
undoFunùiÚ
 = 
mutÜ
 =ğ
nuÎ
 ? 
mutÜAcûssÜ
.undoFunction() :

857 
mutÜ
.
undoFunùiÚ
();

859 
O±iÚ®
<
SmrM‘hodInfo
> 
mi
 = 
m‘hodS‘
.
¡»am
()

860 .
f‹r
(
y
 ->

861 
y
.
m‘hod
.
g‘Sim¶eName
().
toSŒšg
().
equ®s
(
undoFunùiÚ
))

862 .
fšdFœ¡
();

865 ià(!
mi
.
isP»£Á
()) {

866 
mes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
MANDATORY_WARNING
,

867 "NØundØm‘hod found fÜ " + 
x
.
m‘hod
.
g‘Sim¶eName
()

868 + "‚amed " + 
undoFunùiÚ
);

873 ià(
mi
.
g‘
().
m‘hod
.
g‘P¬am‘”s
().
size
()

874 !ğ
x
.
m‘hod
.
g‘P¬am‘”s
().
size
() + 2) {

875 
mes§g”
.
´štMes§ge
(
DŸgno¡ic
.
Kšd
.
ERROR
, "undoRecord method "

876 + 
undoFunùiÚ
 + " containedhe wrong‚umber of…arameters");

880 ià(
mi
.
g‘
().
š‹rçûOv”ride
 !ğ
nuÎ
) {

881 
š‹rçûsToAdd
.
add
(
P¬am‘”izedTy³Name


882 .
g‘
(
mi
.g‘().
š‹rçûOv”ride
.
asTy³
()));

884 
SŒšg
 
ÿÎšgCÚv’tiÚ
 = 
mi
.
g‘
().
š‹rçûOv”ride
 =ğ
nuÎ
 ? "this." :

885 
mi
.
g‘
().
š‹rçûOv”ride
.
g‘Sim¶eName
() + ".super.";

887  "\n.put(\"" + 
g‘SmrFunùiÚName
(
x
.
m‘hod
) + "\", "

888 + "(obj, undoRecÜd,‡rgsè-> {" + 
ÿÎšgCÚv’tiÚ


889 + 
undoFunùiÚ
 + "(obj, ("

890 + 
P¬am‘”izedTy³Name
.
g‘
(
mi
.g‘().
m‘hod
.
g‘P¬am‘”s
()

891 .
g‘
(1).
asTy³
())

893 + 
IÁSŒ—m
.
¿nge
(0, 
x
.
m‘hod
.
g‘P¬am‘”s
().
size
())

894 .
m­ToObj
(
i
 ->

895 "(" + 
mi
.
g‘
().
m‘hod
.
g‘P¬am‘”s
().g‘(
i
 + 2)

896 .
asTy³
().
toSŒšg
() + ")"

897 + "‡rgs[" + 
i
 + "]")

898 .
cŞËù
(
CŞËùÜs
.
joššg
(", "))

901 .
cŞËù
(
CŞËùÜs
.
joššg
());

904 
F›ldS³c
 
	gundoM­
 = F›ldS³c.
bud”
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
M­
.
şass
),

905 
CÏssName
.
g‘
(
SŒšg
.
şass
),

906 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
IUndoFunùiÚ
.
şass
),

907 
Üigš®Name
)), "undoM­" + 
CORFUSMR_FIELD
,

908 
Modif›r
.
PUBLIC
, Modif›r.
FINAL
)

909 .
š™Ÿliz”
("new $T()$L.build()",

910 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
ImmubËM­
.
Bud”
.
şass
),

911 
CÏssName
.
g‘
(
SŒšg
.
şass
),

912 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
IUndoFunùiÚ
.
şass
),

913 
Üigš®Name
)), 
undoSŒšg
)

914 .
bud
();

916 
	gty³S³cBud”
.
addF›ld
(
undoM­
);

918 
	gty³S³cBud”
.
addM‘hod
(
M‘hodS³c
.
m‘hodBud”
("getCorfuUndoMap")

919 .
addModif›rs
(
Modif›r
.
PUBLIC
)

920 .
»tuºs
(
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
M­
.
şass
),

921 
CÏssName
.
g‘
(
SŒšg
.
şass
),

922 
P¬am‘”izedTy³Name
.
g‘
(
CÏssName
.g‘(
IUndoFunùiÚ
.
şass
),

923 
Üigš®Name
)))

924 .
addS‹m’t
("»tuº $L", "undoM­" + 
CORFUSMR_FIELD
)

925 .
bud
());

935 
public
 
	$addCÚæiùF›ldToM‘hod
(
M‘hodS³c
.
Bud”
 
ms
, 
SŒšg
 
cÚæiùF›ld
,

936 
ExecubËEËm’t
 
smrM‘hod
) {

937 
ms
.
	`addS‹m’t
("$T $L =‚ew Objeù[]{$L}", 
Objeù
[].
şass
, 
cÚæiùF›ld
,

938 
smrM‘hod
.
	`g‘P¬am‘”s
()

939 .
	`¡»am
()

940 .
	`f‹r
(
y
 -> y.
	`g‘AÂÙ©iÚ
(
CÚæiùP¬am‘”
.
şass
)

941 !ğ
nuÎ
)

942 .
	`m­
(
y
 -> y.
	`g‘Sim¶eName
())

943 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")));

944 
	}
}

953 
public
 
	$addCÚæiùF›ldFromFunùiÚToM‘hod
(
M‘hodS³c
.
Bud”
 
ms
,

954 
SŒšg
 
cÚæiùF›ld
, SŒšg 
funùiÚName
,

955 
ExecubËEËm’t
 
smrM‘hod
) {

956 
ms
.
	`addS‹m’t
("$T $L = $L($L)", 
Objeù
[].
şass
, 
cÚæiùF›ld
, 
funùiÚName
,

957 
smrM‘hod
.
	`g‘P¬am‘”s
()

958 .
	`¡»am
()

959 .
	`m­
(
y
 -> y.
	`g‘Sim¶eName
())

960 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(", ")));

961 
	}
}

	@annotations/src/main/java/org/corfudb/annotations/Accessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

13 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

14 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

15 @
Inh”™ed


16 
	gpublic
 @
š‹rçû
 
	gAcûssÜ
 {

22 
SŒšg
 
cÚæiùP¬am‘”FunùiÚ
()  "";

	@annotations/src/main/java/org/corfudb/annotations/ConflictParameter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

14 @
T¬g‘
(
EËm’tTy³
.
PARAMETER
)

15 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

16 @
Inh”™ed


17 
	gpublic
 @
š‹rçû
 
	gCÚæiùP¬am‘”
 {

	@annotations/src/main/java/org/corfudb/annotations/ConstructorType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

8 
public
 
	eCÚ¡ruùÜTy³
 {

10 
	mRUNTIME
,

12 
	mPERSISTED


	@annotations/src/main/java/org/corfudb/annotations/CorfuObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

14 @
T¬g‘
(
EËm’tTy³
.
TYPE
)

15 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

16 @
Inh”™ed


17 
	gpublic
 @
š‹rçû
 
	gCÜfuObjeù
 {

20 
CÚ¡ruùÜTy³
 
cÚ¡ruùÜTy³
(è 
	gCÚ¡ruùÜTy³
.
	gRUNTIME
;

23 @
D•»ÿ‹d


24 
ObjeùTy³
 
objeùTy³
(è 
	gObjeùTy³
.
	gSTATELESS
;

27 @
D•»ÿ‹d


28 
S‹Sourû
 
¡©eSourû
(è 
	gS‹Sourû
.
	gSELF
;

31 @
D•»ÿ‹d


32 
CÏss
 
¡©eTy³
(è 
	gSticM­pšgObjeù
.
	gşass
;

	@annotations/src/main/java/org/corfudb/annotations/DontInstrument.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

13 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

14 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

15 @
Inh”™ed


16 
	gpublic
 @
š‹rçû
 
	gDÚtIn¡rum’t
 {

	@annotations/src/main/java/org/corfudb/annotations/InstrumentedCorfuObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

12 @
T¬g‘
(
EËm’tTy³
.
TYPE
)

13 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

14 @
Inh”™ed


15 
	gpublic
 @
š‹rçû
 
	gIn¡rum’‹dCÜfuObjeù
 {

	@annotations/src/main/java/org/corfudb/annotations/InterfaceOverride.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

13 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

14 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

15 @
Inh”™ed


16 
	gpublic
 @
š‹rçû
 
	gIÁ”çûOv”ride
 {

	@annotations/src/main/java/org/corfudb/annotations/Mutator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

15 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

16 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

17 @
Inh”™ed


18 
	gpublic
 @
š‹rçû
 
	gMutÜ
 {

21 
SŒšg
 
Çme
()  "";

27 
SŒšg
 
undoFunùiÚ
()  "";

33 
SŒšg
 
undoRecÜdFunùiÚ
()  "";

39 
SŒšg
 
cÚæiùP¬am‘”FunùiÚ
()  "";

45 
boŞ—n
 
»£t
(è 
	gçl£
;

53 
boŞ—n
 
noUpÿÎ
(è 
	gçl£
;

	@annotations/src/main/java/org/corfudb/annotations/MutatorAccessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

14 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

15 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

16 @
Inh”™ed


17 
	gpublic
 @
š‹rçû
 
	gMutÜAcûssÜ
 {

20 
SŒšg
 
Çme
()  "";

26 
SŒšg
 
undoFunùiÚ
()  "";

32 
SŒšg
 
undoRecÜdFunùiÚ
()  "";

38 
SŒšg
 
cÚæiùP¬am‘”FunùiÚ
()  "";

44 
boŞ—n
 
»£t
(è 
	gçl£
;

52 
boŞ—n
 
noUpÿÎ
(è 
	gçl£
;

	@annotations/src/main/java/org/corfudb/annotations/ObjectType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

6 
public
 
	eObjeùTy³
 {

8 
	mSMR
,

10 
	mSTATELESS


	@annotations/src/main/java/org/corfudb/annotations/PassThrough.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

8 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

15 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

16 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

17 @
Inh”™ed


18 
	gpublic
 @
š‹rçû
 
	gPassThrough
 {

	@annotations/src/main/java/org/corfudb/annotations/StateSource.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

6 
public
 
	eS‹Sourû
 {

8 
	mSTATE_OBJECT
,

10 
	mSELF


	@annotations/src/main/java/org/corfudb/annotations/StaticMappingObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

8 
public
 cÏs 
	cSticM­pšgObjeù
 {

	@annotations/src/main/java/org/corfudb/annotations/TransactionalMethod.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

12 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

13 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

14 @
Inh”™ed


15 
	gpublic
 @
š‹rçû
 
	gT¿n§ùiÚ®M‘hod
 {

18 
boŞ—n
 
»adOÆy
(è 
	gçl£
;

24 
SŒšg
 
modif›dSŒ—msFunùiÚ
()  "";

	@annotations/src/main/java/org/corfudb/annotations/package-info.java

5 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
;

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuExecutionContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gDÚtIn¡rum’t
;

11 @
FunùiÚ®IÁ”çû


12 
public
 
š‹rçû
 
	gICÜfuExecutiÚCÚ‹xt
<
	gT
> {

17 
CÚ‹xt
 
	gDEFAULT
 = 
Ãw
 Context();

22 
CÚ‹xt
 
	gOPTIMISTIC
 = 
Ãw
 Context();

27 şas 
	cCÚ‹xt
 { }

39 @
DÚtIn¡rum’t


40 
T
 
g‘CÚ‹xt
(
CÚ‹xt
 
cÚ‹xt
);

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gDÚtIn¡rum’t
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
public
 
š‹rçû
 
	gICÜfuSMR
<
	gT
>

15 
ex‹nds
 
	gICÜfuExecutiÚCÚ‹xt
<
	gT
>, 
	gICÜfuV”siÚPŞicy
, 
	gAutoClo£abË
 {

18 
SŒšg
 
	gCORFUSMR_SUFFIX
 = "$CORFUSMR";

22  
	gICÜfuSMRProxy
<
	gT
> 
g‘CÜfuSMRProxy
() {

23 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("ObjectAnnotationProcessor Issue.");

28  
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
T
> 
´oxy
) {

29 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("ObjectAnnotationProcessor Issue.");

34  
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gT
>> 
g‘CÜfuSMRUpÿÎM­
() {

35 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("ObjectAnnotationProcessor Issue.");

40  
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gT
>> 
g‘CÜfuUndoM­
() {

41 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("ObjectAnnotationProcessor Issue.");

46  
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gT
>> 
g‘CÜfuUndoRecÜdM­
() {

47 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("ObjectAnnotationProcessor Issue.");

54  
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

55 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("ObjectAnnotationProcessor Issue.");

60  
UUID
 
g‘CÜfuSŒ—mID
() {

61  
g‘CÜfuSMRProxy
().
g‘SŒ—mID
();

67 @
	gOv”ride


68 @
PassThrough


69  
şo£
() {

76 @
DÚtIn¡rum’t


77  
şo£W¿µ”
() {

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRAccess.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

9 @
FunùiÚ®IÁ”çû


10 
public
 
š‹rçû
 
	gICÜfuSMRAcûss
<
	gR
, 
	gT
> {

17 
R
 
acûss
(
T
 
obj
);

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRProxy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

4 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

5 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

12 
public
 
š‹rçû
 
	gICÜfuSMRProxy
<
	gT
> {

22 <
	gR
> 
R
 
·ssThrough
(
FunùiÚ
<
T
, R> 
m‘hod
);

30 <
	gR
> 
R
 
acûss
(
ICÜfuSMRAcûss
<R, 
T
> 
acûssM‘hod
, 
Objeù
[] 
cÚæiùObjeù
);

44 
logUpd©e
(
SŒšg
 
smrUpd©eFunùiÚ
, 
boŞ—n
 
k“pUpÿÎResuÉ
,

45 
Objeù
[] 
cÚæiùObjeù
, Objeù... 
¬gs
);

55 <
	gR
> 
R
 
g‘UpÿÎResuÉ
(
time¡amp
, 
Objeù
[] 
cÚæiùObjeù
);

61 
UUID
 
g‘SŒ—mID
();

69 <
	gR
> 
R
 
TXExecu‹
(
Suµl›r
<R> 
txFunùiÚ
);

75 
	gCÏss
<
	gT
> 
g‘ObjeùTy³
();

81 
g‘V”siÚ
();

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRProxyWrapper.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

9 
public
 
š‹rçû
 
	gICÜfuSMRProxyW¿µ”
<
	gT
> {

14 
£tProxy$CORFUSMR
(
ICÜfuSMRProxy
<
T
> 
´oxy
);

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRUpcallTarget.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

8 @
FunùiÚ®IÁ”çû


9 
public
 
š‹rçû
 
	gICÜfuSMRUpÿÎT¬g‘
<
	gR
> {

17 
Objeù
 
upÿÎ
(
R
 
obj
, Objeù[] 
¬gs
);

	@annotations/src/main/java/org/corfudb/runtime/object/ICorfuVersionPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gDÚtIn¡rum’t
;

10 
public
 
š‹rçû
 
	gICÜfuV”siÚPŞicy
 {

16 
V”siÚPŞicy
 
	gDEFAULT
 = 
Ãw
 VersionPolicy();

22 
V”siÚPŞicy
 
	gMONOTONIC
 = 
Ãw
 VersionPolicy();

27 şas 
	cV”siÚPŞicy
 {

35 @
DÚtIn¡rum’t


36  
V”siÚPŞicy
 
	$g‘V”siÚPŞicy
() {

37  
DEFAULT
;

38 
	}
}

	@annotations/src/main/java/org/corfudb/runtime/object/IUndoFunction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

7 
public
 
š‹rçû
 
	gIUndoFunùiÚ
<
	gR
> {

14 
doUndo
(
R
 
objeùToUndo
, 
Objeù
 
undoObjeù
, Objeù[] 
¬gs
);

	@annotations/src/main/java/org/corfudb/runtime/object/IUndoRecordFunction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

8 @
FunùiÚ®IÁ”çû


9 
public
 
š‹rçû
 
	gIUndoRecÜdFunùiÚ
<
	gR
> {

16 
Objeù
 
g‘UndoRecÜd
(
R
 
´eviousV”siÚ
, Objeù[] 
¬gs
);

	@annotations/src/main/java/org/corfudb/runtime/object/package-info.java

5 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

	@cmdlets/src/main/java/org/corfudb/metrics/MBeanDumperApp.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gm‘rics
;

3 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gA‰ribu‹Li¡
;

4 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gObjeùName
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

15 
public
 cÏs 
	cMB—nDum³rAµ
 {

17 
public
 
fš®
 
SŒšg
 
	mJMX_SERVICE_URL
 = "corfu.jmx.service.url";

18 
public
 
fš®
 
SŒšg
 
	mDUMP_DOMAINS
 = "dump.domains";

19 
public
 
fš®
 
SŒšg
 
	mDUMP_FILE
 = "dump.file";

21 
public
 
	$maš
(
SŒšg
[] 
¬gs
è
throws
 
Exû±iÚ
 {

22 
fš®
 
SŒšg
 
£rviûURL
 = 
Sy¡em
.
	`g‘Prİ”ty
(
JMX_SERVICE_URL
);

23 
fš®
 
SŒšg
 
domašsArg
 = 
Sy¡em
.
	`g‘Prİ”ty
(
DUMP_DOMAINS
);

24 
fš®
 
SŒšg
 
dumpFe
 = 
Sy¡em
.
	`g‘Prİ”ty
(
DUMP_FILE
);

28 
fš®
 
SŒšg
[] 
domašs
 = (
domašsArg
 =ğ
nuÎ
 || domašsArg.
	`Ëngth
() == 0) ?

29 
Ãw
 
SŒšg
[0] :

30 
domašsArg
.
	`¥l™
(",");

32 
fš®
 
M­
<
ObjeùName
, 
A‰ribu‹Li¡
> 
mB—nA‰ribu‹s
 =

33 
MB—nUts
.
	`g‘MB—nA‰ribu‹s
(
£rviûURL
, 
domašs
);

34 
MB—nUts
.
	`dumpMB—nA‰ribu‹s
(
mB—nA‰ribu‹s
, 
dumpFe
);

37 
	}
}

	@cmdlets/src/main/java/org/corfudb/metrics/MBeanUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gm‘rics
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gA‰ribu‹Li¡
;

7 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gIn¡ªûNÙFoundExû±iÚ
;

8 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gIÁro¥eùiÚExû±iÚ
;

9 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gMB—nA‰ribu‹Info
;

10 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gMB—nInfo
;

11 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gMB—nS”v”CÚÃùiÚ
;

12 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gM®fÜmedObjeùNameExû±iÚ
;

13 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gObjeùName
;

14 
impÜt
 
	gjavax
.
	gmªagem’t
.
	gReæeùiÚExû±iÚ
;

15 
impÜt
 
	gjavax
.
	gmªagem’t
.
	g»mÙe
.
	gJMXCÚÃùÜ
;

16 
impÜt
 
	gjavax
.
	gmªagem’t
.
	g»mÙe
.
	gJMXCÚÃùÜFaùÜy
;

17 
impÜt
 
	gjavax
.
	gmªagem’t
.
	g»mÙe
.
	gJMXS”viûURL
;

18 
impÜt
 
	gjava
.
	gio
.
	gFe
;

19 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

20 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

21 
impÜt
 
	gjava
.
	gio
.
	gPrštSŒ—m
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

35 @
Slf4j


36 şas 
	cMB—nUts
 {

37 
´iv©e
 
	$MB—nUts
() {

60 
M­
<
ObjeùName
, 
A‰ribu‹Li¡
> 
	`g‘MB—nA‰ribu‹s
(@
NÚNuÎ
 
SŒšg
 
£rviûURL
,

61 @
NÚNuÎ
 
SŒšg
[] 
domašs
)

62 
throws
 
IOExû±iÚ
,

63 
M®fÜmedObjeùNameExû±iÚ
,

64 
IÁro¥eùiÚExû±iÚ
 {

66 
fš®
 
JMXS”viûURL
 
u¾
 = 
Ãw
 
	`JMXS”viûURL
(
£rviûURL
);

67 
fš®
 
M­
<
ObjeùName
, 
A‰ribu‹Li¡
> 
jmxDump
;

69 
	`Œy
 (
JMXCÚÃùÜ
 
cÚÃùÜCl›Á
 = 
JMXCÚÃùÜFaùÜy
.
	`cÚÃù
(
u¾
, 
nuÎ
)) {

70 
fš®
 
MB—nS”v”CÚÃùiÚ
 
mB—nS”v”CÚÃùiÚ
 = 
cÚÃùÜCl›Á
.
	`g‘MB—nS”v”CÚÃùiÚ
();

71 
fš®
 
S‘
<
ObjeùName
> 
objeùNames
 = 
	`g‘ObjeùNamesFÜDomašs
(
mB—nS”v”CÚÃùiÚ
, 
domašs
);

72 
jmxDump
 = 
Ãw
 
HashM­
<>(
objeùNames
.
	`size
());

74 
ObjeùName
 
objeùName
 : 
objeùNames
) {

75 
A‰ribu‹Li¡
 
©Œibu‹Li¡
 = 
Ãw
 
	`A‰ribu‹Li¡
();

76 
Œy
 {

77 
fš®
 
MB—nInfo
 
b—nInfo
 = 
mB—nS”v”CÚÃùiÚ
.
	`g‘MB—nInfo
(
objeùName
);

78 
fš®
 
MB—nA‰ribu‹Info
[] 
b—nInfoA‰ribu‹s
 = 
b—nInfo
.
	`g‘A‰ribu‹s
();

79 
SŒšg
[] 
©Œibu‹Names
 = 
Ãw
 SŒšg[
b—nInfoA‰ribu‹s
.
Ëngth
];

80 
i
 = 0; i < 
b—nInfoA‰ribu‹s
.
Ëngth
; i++) {

81 
©Œibu‹Names
[
i
] = 
b—nInfoA‰ribu‹s
[i].
	`g‘Name
();

83 
A¼ays
.
	`sÜt
(
©Œibu‹Names
);

85 
©Œibu‹Li¡
 = 
mB—nS”v”CÚÃùiÚ
.
	`g‘A‰ribu‹s
(
objeùName
, 
©Œibu‹Names
);

86 } 
	`ÿtch
 (
In¡ªûNÙFoundExû±iÚ
 |

87 
ReæeùiÚExû±iÚ
 |

88 
IOExû±iÚ
 
e
) {

89 
log
.
	`w¬n
("UÇbËØãtch‡‰ribu‹ fÜ {}", 
objeùName
.
	`toSŒšg
());

91 
jmxDump
.
	`put
(
objeùName
, 
©Œibu‹Li¡
);

95  
jmxDump
;

96 
	}
}

111 
´iv©e
 
	gS‘
<
	gObjeùName
> 
g‘ObjeùNamesFÜDomašs
(@
NÚNuÎ
 
MB—nS”v”CÚÃùiÚ
 
mB—nS”v”CÚÃùiÚ
,

112 @
NÚNuÎ
 
SŒšg
[] 
domašs
)

113 
throws
 
	gIOExû±iÚ
, 
	gM®fÜmedObjeùNameExû±iÚ
 {

116 ià(
	gdomašs
.
	gËngth
 == 0) {

117  
mB—nS”v”CÚÃùiÚ
.
qu”yNames
(
nuÎ
,‚ull);

121 
fš®
 
	gS‘
<
	gObjeùName
> 
	gobjeùNames
 = 
Ãw
 
HashS‘
<>();

122 
SŒšg
 
	gdomaš
 : 
domašs
) {

123 
fš®
 
ObjeùName
 
objeùNameF‹r
 = 
Ãw
 ObjeùName(
domaš
 + ":*");

124 
	gobjeùNames
.
addAÎ
(
mB—nS”v”CÚÃùiÚ
.
qu”yNames
(
objeùNameF‹r
, 
nuÎ
));

126  
	gobjeùNames
;

139 
dumpMB—nA‰ribu‹s
(@
NÚNuÎ
 
M­
<
ObjeùName
, 
A‰ribu‹Li¡
> 
jmxDump
,

140 @
NÚNuÎ
 
SŒšg
 
dumpFe
)

141 
throws
 
	gFeNÙFoundExû±iÚ
 {

143 
fš®
 
Fe
 
	gfe
 = 
Ãw
 Fe(
dumpFe
 + 
Sy¡em
.
cu¼’tTimeMlis
());

145 
Œy
 (
PrštSŒ—m
 
´štSŒ—m
 = 
Ãw
 PrštSŒ—m(
fe
)) {

146 
M­
.
EÁry
<
ObjeùName
, 
A‰ribu‹Li¡
> 
dumpEÁry
 : 
jmxDump
.
’ŒyS‘
()) {

147 
fš®
 
SŒšg
 
mB—nA‰ribu‹s
 = 
Ãw
 
SŒšgBud”
()

148 .
­³nd
(
dumpEÁry
.
g‘Key
())

149 .
­³nd
(":")

150 .
­³nd
(
dumpEÁry
.
g‘V®ue
())

151 .
toSŒšg
();

152 
	g´štSŒ—m
.
´šn
(
mB—nA‰ribu‹s
);

	@cmdlets/src/main/java/org/corfudb/shell/ShellMain.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gsh–l
;

3 
impÜt
 
	gşoju»
.
	gjava
.
	g­i
.
	gCloju»
;

4 
impÜt
 
	gşoju»
.
	gÏng
.
	gIFn
;

9 
public
 cÏs 
	cSh–lMaš
 {

11 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

12 
IFn
 
»quœe
 = 
Cloju»
.
	`v¬
("clojure.core", "require");

13 
»quœe
.
	`švoke
(
Cloju»
.
	`»ad
("org.corfudb.shell"));

14 
IFn
 
sh–l
 = 
Cloju»
.
	`v¬
("org.corfudb.shell", "-main");

15 
sh–l
.
	`švoke
(
¬gs
);

17 
	}
}

	@common/src/main/java/org/corfudb/common/compression/Codec.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
;

3 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

4 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

18 
public
 
š‹rçû
 
	gCodec
 {

23 
	eTy³
 {

25 
NONE
(0, 
NoCom´essiÚ
::
g‘In¡ªû
),

26 
LZ4
(1, 
LZ4Com´essiÚ
::
g‘In¡ªû
),

27 
ZSTD
(2, 
ZSTDCom´essiÚ
::
g‘In¡ªû
);

33 
fš®
 
	gid
;

35 
´iv©e
 
	gSuµl›r
<
	gCodec
> 
	gfunc
;

37 
public
 
	gM­
<
	gIÁeg”
, 
	gTy³
> 
	gty³M­
 = 
A¼ays
.
¡»am
(
Codec
.
Ty³
.
v®ues
())

38 .
cŞËù
(
CŞËùÜs
.
toM­
(
Codec
.
Ty³
::
g‘Id
, 
FunùiÚ
.
id’t™y
()));

40 
Ty³
(
id
, 
Suµl›r
<
Codec
> 
func
) {

41 
	gthis
.
	gid
 = 
id
;

42 
	gthis
.
	gfunc
 = 
func
;

45 
public
 
Codec
 
g‘In¡ªû
() {

46  
	gfunc
.
g‘
();

49 
public
 
g‘Id
() {

50  
	gid
;

54 
	gCodec
.
Ty³
 
g‘CodecTy³ById
(
id
) {

55 
	gCodec
.
Ty³
 
	gty³
 = Ty³.
ty³M­
.
g‘
(
id
);

56 
	gObjeùs
.
»quœeNÚNuÎ
(
ty³
, "UnknowÀcodeøid " + 
id
);

57  
	gty³
;

67 
By‹Bufãr
 
com´ess
(By‹Bufã¸
uncom´es£d
);

74 
By‹Bufãr
 
decom´ess
(By‹Bufã¸
com´es£d
);

	@common/src/main/java/org/corfudb/common/compression/LZ4Compression.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
;

3 
impÜt
 
	gÃt
.
	gjpouÁz
.
	glz4
.
	gLZ4Com´essÜ
;

4 
impÜt
 
	gÃt
.
	gjpouÁz
.
	glz4
.
	gLZ4FaùÜy
;

5 
impÜt
 
	gÃt
.
	gjpouÁz
.
	glz4
.
	gLZ4Fa¡Decom´essÜ
;

7 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

8 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

10 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gP»cÚd™iÚs
.
	gcheckArgum’t
;

18 
public
 cÏs 
	cLZ4Com´essiÚ
 
im¶em’ts
 
	mCodec
 {

19 
´iv©e
 
fš®
 
LZ4Com´essÜ
 
	mcom´essÜ
;

20 
´iv©e
 
fš®
 
LZ4Fa¡Decom´essÜ
 
	mdecom´essÜ
;

22 
´iv©e
 
LZ4Com´essiÚ
 
	mINSTANCE
 = 
Ãw
 LZ4Compression();

24 
public
 
	$LZ4Com´essiÚ
() {

25 
LZ4FaùÜy
 
çùÜy
 = LZ4FaùÜy.
	`ç¡e¡JavaIn¡ªû
();

26 
com´essÜ
 = 
çùÜy
.
	`ç¡Com´essÜ
();

27 
decom´essÜ
 = 
çùÜy
.
	`ç¡Decom´essÜ
();

30 
public
 
LZ4Com´essiÚ
 
	$g‘In¡ªû
() {

31  
INSTANCE
;

32 
	}
}

38 @
Ov”ride


39 
public
 
By‹Bufãr
 
	$com´ess
(
By‹Bufãr
 
uncom´es£d
) {

40 
Objeùs
.
	`»quœeNÚNuÎ
(
uncom´es£d
);

41 
	`checkArgum’t
(
uncom´es£d
.
	`hasRemaššg
());

43 
fš®
 
decom´es£dL’gth
 = 
uncom´es£d
.
	`»maššg
();

45 
maxCom´es£dL’gth
 = 
com´essÜ
.
	`maxCom´es£dL’gth
(
decom´es£dL’gth
);

47 
By‹Bufãr
 
com´es£d
 = By‹Bufãr.
	`®loÿ‹
(
maxCom´es£dL’gth
 + 
IÁeg”
.
BYTES
);

48 
com´es£d
.
	`putIÁ
(
decom´es£dL’gth
);

49 
com´es£dL’
 = 
com´essÜ
.
	`com´ess
(
uncom´es£d
, 0, 
decom´es£dL’gth
, 
com´es£d
,

50 
com´es£d
.
	`pos™iÚ
(), 
maxCom´es£dL’gth
);

51 
com´es£d
.
	`pos™iÚ
(
com´es£dL’
 + 
IÁeg”
.
BYTES
);

52 
com´es£d
.
	`æ
();

53  
com´es£d
;

54 
	}
}

60 @
Ov”ride


61 
public
 
By‹Bufãr
 
	$decom´ess
(
By‹Bufãr
 
com´es£d
) {

62 
Objeùs
.
	`»quœeNÚNuÎ
(
com´es£d
);

63 
	`checkArgum’t
(
com´es£d
.
	`»maššg
(è> 
IÁeg”
.
BYTES
);

65 
decom´es£dSize
 = 
com´es£d
.
	`g‘IÁ
();

67 
By‹Bufãr
 
»¡Üed
 = By‹Bufãr.
	`®loÿ‹
(
decom´es£dSize
);

69 
decom´essÜ
.
	`decom´ess
(
com´es£d
, 
IÁeg”
.
BYTES
, 
»¡Üed
, 0, 
decom´es£dSize
);

71  
»¡Üed
;

72 
	}
}

	@common/src/main/java/org/corfudb/common/compression/NoCompression.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
;

3 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

9 
public
 cÏs 
	cNoCom´essiÚ
 
im¶em’ts
 
	mCodec
 {

10 
´iv©e
 
NoCom´essiÚ
 
	mINSTANCE
 = 
Ãw
 NoCompression();

13 
public
 
Codec
 
	$g‘In¡ªû
() {

14  
INSTANCE
;

17 @
Ov”ride


18 
public
 
By‹Bufãr
 
	$com´ess
(
By‹Bufãr
 
uncom´es£d
) {

19  
uncom´es£d
;

20 
	}
}

22 @
Ov”ride


23 
public
 
By‹Bufãr
 
	$decom´ess
(
By‹Bufãr
 
com´es£d
) {

24  
com´es£d
;

25 
	}
}

	@common/src/main/java/org/corfudb/common/compression/ZSTDCompression.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
;

3 
impÜt
 
	gcom
.
	gg™hub
.
	glub’
.
	gz¡d
.
	gZ¡d
;

5 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

6 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gP»cÚd™iÚs
.
	gcheckArgum’t
;

10 
public
 cÏs 
	cZSTDCom´essiÚ
 
im¶em’ts
 
	mCodec
 {

12 
´iv©e
 
fš®
 
	mDEFAULT_COMPRESSION_LEVEL
 = 3;

14 
´iv©e
 
ZSTDCom´essiÚ
 
	mINSTANCE
 = 
Ãw
 ZSTDCompression();

16 
public
 
ZSTDCom´essiÚ
 
	$g‘In¡ªû
() {

17  
INSTANCE
;

24 @
Ov”ride


25 
public
 
By‹Bufãr
 
	$com´ess
(
By‹Bufãr
 
uncom´es£d
) {

26 
Objeùs
.
	`»quœeNÚNuÎ
(
uncom´es£d
);

27 
	`checkArgum’t
(
uncom´es£d
.
	`hasRemaššg
());

29 
fš®
 
decom´es£dL’gth
 = 
uncom´es£d
.
	`»maššg
();

30 
fš®
 
maxCom´es£dL’gth
 = (è
Z¡d
.
	`com´essBound
(
decom´es£dL’gth
);

32 
by‹
[] 
com´es£d
 = 
Ãw
 by‹[
maxCom´es£dL’gth
 + 
IÁeg”
.
BYTES
];

33 
By‹Bufãr
 
w¿µedBuf
 = By‹Bufãr.
	`w¿p
(
com´es£d
);

34 
w¿µedBuf
.
	`putIÁ
(
decom´es£dL’gth
);

36 
com´es£dL’
 = 
Z¡d
.
	`com´essBy‹A¼ay
(
com´es£d
, 
IÁeg”
.
BYTES
, 
maxCom´es£dL’gth
,

37 
uncom´es£d
.
	`¬¿y
(), uncom´es£d.
	`pos™iÚ
(), uncom´es£d.
	`»maššg
(),

38 
DEFAULT_COMPRESSION_LEVEL
);

40 ià(
Z¡d
.
	`isE¼Ü
(
com´es£dL’
)) {

41 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Com´essiÚ faed w™hƒ¼Ü cod" + 
com´es£dL’
);

44 
w¿µedBuf
.
	`pos™iÚ
((è
com´es£dL’
 + 
IÁeg”
.
BYTES
);

45 
w¿µedBuf
.
	`æ
();

46  
w¿µedBuf
;

47 
	}
}

53 @
Ov”ride


54 
public
 
By‹Bufãr
 
	$decom´ess
(
By‹Bufãr
 
com´es£d
) {

55 
Objeùs
.
	`»quœeNÚNuÎ
(
com´es£d
);

56 
	`checkArgum’t
(
com´es£d
.
	`»maššg
(è> 
IÁeg”
.
BYTES
);

58 
decom´es£dSize
 = 
com´es£d
.
	`g‘IÁ
();

59 
by‹
[] 
»¡Üed
 = 
Ãw
 by‹[
decom´es£dSize
];

60 
By‹Bufãr
 
w¿µedBuf
 = By‹Bufãr.
	`w¿p
(
»¡Üed
);

62 
»¡ÜedBy‹s
 = 
Z¡d
.
	`decom´essBy‹A¼ay
(
»¡Üed
, 0,„e¡Üed.
Ëngth
,

63 
com´es£d
.
	`¬¿y
(), 
IÁeg”
.
BYTES
, com´es£d.
	`»maššg
());

65 ià(
Z¡d
.
	`isE¼Ü
(
»¡ÜedBy‹s
)) {

66 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Decom´essiÚ faed w™hƒ¼Ü cod" + 
»¡ÜedBy‹s
);

69 
w¿µedBuf
.
	`pos™iÚ
((è
»¡ÜedBy‹s
);

70 
w¿µedBuf
.
	`æ
();

71  
w¿µedBuf
;

72 
	}
}

	@common/src/main/java/org/corfudb/common/metrics/MetricsServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
;

7 
public
 
š‹rçû
 
	gM‘ricsS”v”
 {

11 
¡¬t
();

16 
¡İ
();

	@common/src/main/java/org/corfudb/common/metrics/servers/PrometheusMetricsServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	g£rv”s
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gio
.
	g´om‘heus
.
	gş›Á
.
	gCŞËùÜRegi¡ry
;

5 
impÜt
 
	gio
.
	g´om‘heus
.
	gş›Á
.
	gdrİwiz¬d
.
	gDrİwiz¬dExpÜts
;

6 
impÜt
 
	gio
.
	g´om‘heus
.
	gş›Á
.
	gexpÜ‹r
.
	gM‘ricsS”vËt
;

7 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	geş£
.
	gj‘ty
.
	g£rv”
.
	gS”v”
;

12 
impÜt
 
	gÜg
.
	geş£
.
	gj‘ty
.
	g£rvËt
.
	gS”vËtCÚ‹xtHªdËr
;

13 
impÜt
 
	gÜg
.
	geş£
.
	gj‘ty
.
	g£rvËt
.
	gS”vËtHŞd”
;

15 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	gM‘ricsS”v”
;

20 @
Slf4j


21 
public
 cÏs 
	cProm‘heusM‘ricsS”v”
 
im¶em’ts
 
	mM‘ricsS”v”
 {

22 
´iv©e
 
fš®
 
S”v”
 
	m£rv”
;

23 
´iv©e
 
fš®
 
CÚfig
 
	mcÚfig
;

25 
public
 
	$Prom‘heusM‘ricsS”v”
(
CÚfig
 
cÚfig
, 
M‘ricRegi¡ry
 
m‘ricRegi¡ry
) {

26 
this
.
cÚfig
 = config;

27 
this
.
£rv”
 = 
Ãw
 
	`S”v”
(
cÚfig
.
	`g‘PÜt
());

28 
CŞËùÜRegi¡ry
.
deçuÉRegi¡ry
.(
Ãw
 
	`Drİwiz¬dExpÜts
(
m‘ricRegi¡ry
));

34 @
Ov”ride


35 
public
 
synchrÚized
 
	$¡¬t
() {

36 ià(
£rv”
.
	`isS¹ed
(è|| !
cÚfig
.
	`isEÇbËd
()) {

40 
S”vËtCÚ‹xtHªdËr
 
cÚ‹xtHªdËr
 = 
Ãw
 
	`S”vËtCÚ‹xtHªdËr
();

41 
cÚ‹xtHªdËr
.
	`£tCÚ‹xtP©h
("/");

42 
£rv”
.
	`£tHªdËr
(
cÚ‹xtHªdËr
);

43 
cÚ‹xtHªdËr
.
	`addS”vËt
(
Ãw
 
	`S”vËtHŞd”
Òew 
	`M‘ricsS”vËt
()), "/metrics");

44 
Œy
 {

45 
£rv”
.
	`¡¬t
();

46 
log
.
	`šfo
("£tupM‘rics:„•Ütšg m‘ric Ú…Üˆ{}", 
cÚfig
.
	`g‘PÜt
());

47 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

48 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

50 
	}
}

55 @
Ov”ride


56 
public
 
synchrÚized
 
	$¡İ
() {

57 ià(!
£rv”
.
	`isRuÂšg
()) {

61 
Œy
 {

62 
£rv”
.
	`¡İ
();

63 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

64 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

66 
	}
}

68 @
	gAÎArgsCÚ¡ruùÜ


69 @
G‘‹r


70 
public
 şas 
	cCÚfig
 {

71 
´iv©e
 
fš®
 
	gpÜt
;

72 
´iv©e
 
fš®
 
boŞ—n
 
	g’abËd
;

73 
public
 
fš®
 
BoŞ—n
 
	gENABLED
 = 
Œue
;

74 
public
 
fš®
 
SŒšg
 
	gMETRICS_PARAM
 = "--metrics";

75 
public
 
fš®
 
SŒšg
 
	gMETRICS_PORT_PARAM
 = "--metrics-port";

77 
public
 
CÚfig
 
·r£
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

78 
boŞ—n
 
	g’abËd
 = 
O±iÚ®
.
ofNuÎabË
(
İts
.
g‘
(
METRICS_PARAM
))

79 .
m­
(
e
 -> (
boŞ—n
)e)

80 .
ÜEl£
(
çl£
);

81 
	gpÜt
 = 
O±iÚ®
.
ofNuÎabË
(
İts
.
g‘
(
METRICS_PORT_PARAM
))

82 .
m­
(
p
 -> 
IÁeg”
.
·r£IÁ
Õ.
toSŒšg
()))

83 .
ÜEl£
(-1);

84  
Ãw
 
CÚfig
(
pÜt
, 
’abËd
);

	@common/src/main/java/org/corfudb/common/result/Result.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	g»suÉ
;

3 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

5 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

6 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

14 
public
 
şass
 
	gResuÉ
<
	gT
, 
E
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
im¶em’ts
 
	gSuµl›r
<T> {

16 
´Ùeùed
 
fš®
 
T
 
	gv®ue
;

17 
´Ùeùed
 
fš®
 
E
 
	g”rÜ
;

19 
public
 
ResuÉ
(
T
 
v®ue
) {

20 
this
(
Objeùs
.
»quœeNÚNuÎ
(
v®ue
), 
nuÎ
);

23 
public
 
ResuÉ
(
E
 
”rÜ
) {

24 
this
(
nuÎ
, 
Objeùs
.
»quœeNÚNuÎ
(
”rÜ
));

27 
´Ùeùed
 
ResuÉ
(
T
 
v®ue
, 
E
 
”rÜ
) {

29 
	gthis
.
	gv®ue
 = 
v®ue
;

30 
	gthis
.
	g”rÜ
 = 
”rÜ
;

33 
public
 <
	gT
, 
E
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
	gResuÉ
<T, 
	gE
> 
of
(
Suµl›r
<
T
> 
»suÉ
) {

34 
	gŒy
 {

35  
	gResuÉ
.
ok
(
»suÉ
.
g‘
());

36 } 
ÿtch
 (
RuÁimeExû±iÚ
 
ex
){

37  
	gResuÉ
.
”rÜ
((
E
è
ex
);

41 
public
 <
	gT
, 
E
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
	gResuÉ
<T, 
	gE
> 
ok
(
T
 
»suÉ
) {

42  
Ãw
 
	gResuÉ
<>(
	g»suÉ
);

45 
public
 <
	gT
, 
E
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
	gResuÉ
<T, 
	gE
> 
”rÜ
(Eƒrror) {

46  
Ãw
 
	gResuÉ
<>(
	g”rÜ
);

55 @
Ov”ride


56 
public
 
T
 
g‘
() {

57 ià(
	g”rÜ
 !ğ
nuÎ
) {

58 
throw
 
”rÜ
;

61  
	gv®ue
;

70 
public
 
E
 
g‘E¼Ü
() {

71 if(
	g”rÜ
 =ğ
nuÎ
) {

72 
throw
 
Ãw
 
NoSuchEËm’tExû±iÚ
("Noƒrror…resent");

75  
	g”rÜ
;

83 
public
 
boŞ—n
 
isV®ue
() {

84  
	gv®ue
 !ğ
nuÎ
;

87 
public
 
boŞ—n
 
isE¼Ü
() {

88  
	g”rÜ
 !ğ
nuÎ
;

98 
public
 
T
 
ÜEl£
(T 
Ùh”
) {

99  
isV®ue
(è? 
	gv®ue
 : 
Ùh”
;

108 
public
 
ifE¼Ü
(
CÚsum”
<
E
> 
cÚsum”
) {

109 ià(
isE¼Ü
()) {

110 
	gcÚsum”
.
acû±
(
”rÜ
);

122 
	gpublic
 <
	gU
> 
	gResuÉ
<U, 
	gE
> 
m­
(
FunùiÚ
<? 
su³r
 
T
, ? 
ex‹nds
 
U
> 
funùiÚ
) {

123 ià(
isV®ue
()) {

124  
Ãw
 
	gResuÉ
<>(
	gfunùiÚ
.
­¶y
(
v®ue
), 
	g”rÜ
);

126  
Ãw
 
	gResuÉ
<>(
	gnuÎ
, 
	g”rÜ
);

138 
	gpublic
 <
Q
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
	gResuÉ
<
	gT
, 
	gQ
> 
m­E¼Ü
(
FunùiÚ
<? 
su³r
 
E
, ?ƒx‹nd Q> 
funùiÚ
) {

139 ià(
isE¼Ü
()) {

140  
	gResuÉ
.
”rÜ
(
funùiÚ
.
­¶y
(error));

142  
	gResuÉ
.
ok
(
g‘
());

147 
	gpublic
 <
	gU
> 
	gResuÉ
<U, 
	gE
> 
æ©M­
(
FunùiÚ
<
T
, 
ResuÉ
<
U
, 
E
>> 
m­³r
) {

149 ià(
isE¼Ü
()) {

150  
	gResuÉ
.
”rÜ
(
g‘E¼Ü
());

153  
	gm­³r
.
­¶y
(
v®ue
);

	@common/src/main/java/org/corfudb/common/util/ClassUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
;

3 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

5 
public
 cÏs 
	cCÏssUts
 {

7 
´iv©e
 
	$CÏssUts
() {

11 @
	`Suµ»ssW¬nšgs
("unchecked")

12 
public
 <
T
> T 
	$ÿ¡
(
Objeù
 
obj
) {

13 
Objeùs
.
	`»quœeNÚNuÎ
(
obj
);

14  (
T
è
obj
;

15 
	}
}

17 
public
 <
	gT
> 
T
 
ÿ¡
(
Objeù
 
obj
, 
CÏss
<T> 
objTy³
) {

18 
	gObjeùs
.
»quœeNÚNuÎ
(
obj
);

19  
	gobjTy³
.
ÿ¡
(
obj
);

	@common/src/main/java/org/corfudb/common/util/ObservableValue.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
;

3 
impÜt
 
	gjava
.
	gut
.
	gOb£rvabË
;

10 
public
 cÏs 
	cOb£rvabËV®ue
 
ex‹nds
 
	mOb£rvabË


12 
´iv©e
 
	mn
 = 0;

14 
public
 
	$Ob£rvabËV®ue
(
n
)

16 
this
.
n
 =‚;

19 
public
 
	$£tV®ue
(
n
)

21 
this
.
n
 =‚;

22 
	`£tChªged
();

23 
	`nÙifyOb£rv”s
();

24 
	}
}

26 
public
 
	$g‘V®ue
()

28  
n
;

29 
	}
}

	@common/src/main/java/org/corfudb/common/util/Tuple.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

11 @
	gAÎArgsCÚ¡ruùÜ


12 @
Equ®sAndHashCode


13 
public
 
şass
 
	gTu¶e
<
	gT
, 
	gU
> {

14 
public
 
fš®
 
T
 
	gfœ¡
;

15 
public
 
fš®
 
U
 
	g£cÚd
;

	@corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowser.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gbrow£r
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicKey
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicRecÜd
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gDyÇmicPrÙobufS”Ÿliz”
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

28 @
Slf4j


29 
public
 cÏs 
	cCÜfuStÜeBrow£r
 {

30 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

36 
public
 
	$CÜfuStÜeBrow£r
(
CÜfuRuÁime
 
ruÁime
) {

37 
this
.
ruÁime
 =„untime;

44 
´iv©e
 
	$v”ifyName¥aû
(
SŒšg
 
Çme¥aû
) {

45 ià(
Çme¥aû
 =ğ
nuÎ
) {

46 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Please specify --namespace");

48 
	}
}

55 
´iv©e
 
	$v”ifyName¥aûAndTabËÇme
(
SŒšg
 
Çme¥aû
, SŒšg 
bËName
) {

56 
	`v”ifyName¥aû
(
Çme¥aû
);

57 ià(
bËName
 =ğ
nuÎ
) {

58 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Please specify --tablename");

60 
	}
}

68 
public
 
	gCÜfuTabË
<
	gCÜfuDyÇmicKey
, 
	gCÜfuDyÇmicRecÜd
> 
	$g‘TabË
(

69 
SŒšg
 
Çme¥aû
, SŒšg 
bËName
) {

70 
log
.
	`šfo
("Name¥aû: {}", 
Çme¥aû
);

71 
log
.
	`šfo
("TabËName: {}", 
bËName
);

72 
IS”Ÿliz”
 
dyÇmicPrÙobufS”Ÿliz”
 =

73 
Ãw
 
	`DyÇmicPrÙobufS”Ÿliz”
(
ruÁime
);

74 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
dyÇmicPrÙobufS”Ÿliz”
);

76 
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
cÜfuTabË
 =

77 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

78 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
>>() {

80 .
	`£tSŒ—mName
(

81 
TabËRegi¡ry
.
	`g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËName
))

82 .
	`£tS”Ÿliz”
(
dyÇmicPrÙobufS”Ÿliz”
)

83 .
	`İ’
();

84  
cÜfuTabË
;

85 
	}
}

93 
public
 
	$´štTabË
(
SŒšg
 
Çme¥aû
, SŒšg 
bËÇme
) {

94 
	`v”ifyName¥aûAndTabËÇme
(
Çme¥aû
, 
bËÇme
);

95 
SŒšgBud”
 
bud”
;

99 ià(
Çme¥aû
.
	`equ®s
(
TabËRegi¡ry
.
CORFU_SYSTEM_NAMESPACE
) &&

100 
bËÇme
.
	`equ®s
(
TabËRegi¡ry
.
REGISTRY_TABLE_NAME
)) {

101 
CÜfuTabË
<
TabËName
,

102 
CÜfuRecÜd
<
TabËDesütÜs
, 
Mes§ge
>> 
»gi¡ryTabË
 =

103 
ruÁime
.
	`g‘TabËRegi¡ry
().
	`g‘Regi¡ryTabË
();

104 
size
 = 
»gi¡ryTabË
.
	`size
();

105 
log
.
	`šfo
("======Printing Table {} in‚amespace {} with {}ƒntries======",

106 
bËÇme
, 
Çme¥aû
, 
size
);

107 
M­
.
EÁry
<
TabËName
, 
CÜfuRecÜd
<
TabËDesütÜs
, 
Mes§ge
>> 
’Œy
:

108 
»gi¡ryTabË
.
	`’ŒyS‘
()) {

109 
bud”
 = 
Ãw
 
	`SŒšgBud”
("\nTabËName:\n" + 
’Œy
.
	`g‘Key
())

110 .
	`­³nd
("\nTabËDesütÜs:\n" + 
’Œy
.
	`g‘V®ue
().
	`g‘Paylßd
())

111 .
	`­³nd
("\nTabËM‘ad©a:\n" + 
’Œy
.
	`g‘V®ue
().
	`g‘M‘ad©a
())

112 .
	`­³nd
("\n====================\n");

113 
log
.
	`šfo
(
bud”
.
	`toSŒšg
());

115  
size
;

118 
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
bË
 = 
	`g‘TabË
(
Çme¥aû
, 
bËÇme
);

119 
size
 = 
bË
.
	`size
();

120 
M­
.
EÁry
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
’Œy
 :

121 
bË
.
	`’ŒyS‘
()) {

122 
bud”
 = 
Ãw
 
	`SŒšgBud”
("\nKey:\n" + 
’Œy
.
	`g‘Key
().getKey())

123 .
	`­³nd
("\nPaylßd:\n" + 
’Œy
.
	`g‘V®ue
().
	`g‘Paylßd
())

124 .
	`­³nd
("\nM‘ad©a:\n" + 
’Œy
.
	`g‘V®ue
().
	`g‘M‘ad©a
())

125 .
	`­³nd
("\n====================\n");

126 
log
.
	`šfo
(
bud”
.
	`toSŒšg
());

128  
size
;

129 
	}
}

136 
public
 
	$li¡TabËs
(
SŒšg
 
Çme¥aû
)

138 
	`v”ifyName¥aû
(
Çme¥aû
);

139 
numTabËs
 = 0;

140 
log
.
	`šfo
("\n=====Tables=======\n");

141 
TabËName
 
bËName
 : 
ruÁime
.
	`g‘TabËRegi¡ry
()

142 .
	`li¡TabËs
(
Çme¥aû
)) {

143 
log
.
	`šfo
("TabË: " + 
bËName
.
	`g‘TabËName
());

144 
log
.
	`šfo
("Name¥aû: " + 
bËName
.
	`g‘Name¥aû
());

145 
numTabËs
++;

147 
log
.
	`šfo
("\n======================\n");

148  
numTabËs
;

149 
	}
}

157 
public
 
	$´štTabËInfo
(
SŒšg
 
Çme¥aû
, SŒšg 
bËÇme
) {

158 
	`v”ifyName¥aûAndTabËÇme
(
Çme¥aû
, 
bËÇme
);

159 
log
.
	`šfo
("\n======================\n");

160 
SŒšg
 
fuÎName
 = 
TabËRegi¡ry
.
	`g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËÇme
);

161 
UUID
 
¡»amUUID
 = UUID.
	`ÇmeUUIDFromBy‹s
(
fuÎName
.
	`g‘By‹s
());

162 
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
bË
 = 
	`g‘TabË
(
Çme¥aû
, 
bËÇme
);

163 
bËSize
 = 
bË
.
	`size
();

164 
log
.
	`šfo
("Table {} in‚amespace {} with ID {} has {}ƒntries",

165 
bËÇme
, 
Çme¥aû
, 
¡»amUUID
.
	`toSŒšg
(), 
bËSize
);

166 
log
.
	`šfo
("\n======================\n");

167  
bËSize
;

168 
	}
}

176 
public
 
	$drİTabË
(
SŒšg
 
Çme¥aû
, SŒšg 
bËÇme
) {

177 
	`v”ifyName¥aûAndTabËÇme
(
Çme¥aû
, 
bËÇme
);

178 
log
.
	`šfo
("\n======================\n");

179 
SŒšg
 
fuÎName
 = 
TabËRegi¡ry
.
	`g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËÇme
);

180 
UUID
 
¡»amUUID
 = UUID.
	`ÇmeUUIDFromBy‹s
(
fuÎName
.
	`g‘By‹s
());

181 
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
bË
 = 
	`g‘TabË
(
Çme¥aû
, 
bËÇme
);

182 
bËSize
 = 
bË
.
	`size
();

183 
log
.
	`šfo
("Table {} in‚amespace {} with ID {} with {}ƒntries will be dropped...",

184 
bËÇme
, 
Çme¥aû
, 
¡»amUUID
.
	`toSŒšg
(), 
bËSize
);

185 
bË
.
	`ş—r
();

186 
log
.
	`šfo
("Table cleared successfully");

187 
log
.
	`šfo
("\n======================\n");

188  
bËSize
;

189 
	}
}

	@corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowserMain.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gbrow£r
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

4 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

6 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicKey
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicRecÜd
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

14 
impÜt
 
	gÜg
.
	gdocİt
.
	gDocİt
;

22 @
Slf4j


23 
public
 cÏs 
	cCÜfuStÜeBrow£rMaš
 {

24 
´iv©e
 
	eO³¿tiÚTy³
 {

25 
	mli¡TabËs
,

26 
	mšfoTabË
,

27 
	mshowTabË
,

28 
	mdrİTabË


31 
´iv©e
 
fš®
 
SŒšg
 
	gUSAGE
 = "Usage: corfu-browser --host=<host> " +

49 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

50 
Œy
 {

51 
CÜfuRuÁime
 
ruÁime
;

52 
log
.
	`šfo
("CorfuBrowser starting...");

54 
M­
<
SŒšg
, 
Objeù
> 
İts
 =

55 
Ãw
 
	`Docİt
(
USAGE
)

56 .
	`w™hV”siÚ
(
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
desüibe
)

57 .
	`·r£
(
¬gs
);

58 
SŒšg
 
ho¡
 = 
İts
.
	`g‘
("--ho¡").
	`toSŒšg
();

59 
IÁeg”
 
pÜt
 = IÁeg”.
	`·r£IÁ
(
İts
.
	`g‘
("--pÜt").
	`toSŒšg
());

60 
boŞ—n
 
sEÇbËd
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
İts
.
	`g‘
("--tlsEnabled")

61 .
	`toSŒšg
());

62 
SŒšg
 
İ”©iÚ
 = 
İts
.
	`g‘
("--İ”©iÚ").
	`toSŒšg
();

63 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
CÜfuRuÁimeP¬am‘”sBud”


64 
bud”
 = 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

65 .
	`ÿcheDi§bËd
(
Œue
)

66 .
	`sEÇbËd
(
sEÇbËd
);

67 ià(
sEÇbËd
) {

68 
SŒšg
 
key¡Üe
 = 
İts
.
	`g‘
("--key¡Üe").
	`toSŒšg
();

69 
SŒšg
 
ks_·sswÜd
 = 
İts
.
	`g‘
("--ks_·sswÜd").
	`toSŒšg
();

70 
SŒšg
 
Œu¡¡Üe
 = 
İts
.
	`g‘
("--Œu¡¡Üe").
	`toSŒšg
();

71 
SŒšg
 
Œu¡¡Üe_·sswÜd
 =

72 
İts
.
	`g‘
("--Œu¡¡Üe_·sswÜd").
	`toSŒšg
();

73 
bud”
.
	`sEÇbËd
(
sEÇbËd
)

74 .
	`keyStÜe
(
key¡Üe
)

75 .
	`ksPasswÜdFe
(
ks_·sswÜd
)

76 .
	`Œu¡StÜe
(
Œu¡¡Üe
)

77 .
	`tsPasswÜdFe
(
Œu¡¡Üe_·sswÜd
);

79 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
bud”
.
	`bud
());

80 
SŒšg
 
sšgËNodeEndpošt
 = SŒšg.
	`fÜm©
("%s:%d", 
ho¡
, 
pÜt
);

81 
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
sšgËNodeEndpošt
);

82 
log
.
	`šfo
("CÚÃùšgØcÜfu clu¡”‡ˆ{}", 
sšgËNodeEndpošt
);

83 
ruÁime
.
	`cÚÃù
();

84 
log
.
	`šfo
("SucûssfuÎy cÚÃùedØ{}", 
sšgËNodeEndpošt
);

86 
CÜfuStÜeBrow£r
 
brow£r
 = 
Ãw
 
	`CÜfuStÜeBrow£r
(
ruÁime
);

87 
SŒšg
 
Çme¥aû
 = 
O±iÚ®
.
	`ofNuÎabË
(
İts
.
	`g‘
("--namespace"))

88 .
	`m­
(
n
 ->‚.
	`toSŒšg
())

89 .
	`ÜEl£
(
nuÎ
);

90 
SŒšg
 
bËName
 = 
O±iÚ®
.
	`ofNuÎabË
(
İts
.
	`g‘
("--tablename"))

91 .
	`m­
(
t
 ->.
	`toSŒšg
())

92 .
	`ÜEl£
(
nuÎ
);

93 
Enum
.
	`v®ueOf
(
O³¿tiÚTy³
.
şass
, 
İ”©iÚ
)) {

94 
li¡TabËs
:

95 
brow£r
.
	`li¡TabËs
(
Çme¥aû
);

97 
šfoTabË
:

98 
brow£r
.
	`´štTabËInfo
(
Çme¥aû
, 
bËName
);

100 
drİTabË
:

101 
brow£r
.
	`drİTabË
(
Çme¥aû
, 
bËName
);

103 
showTabË
:

104 
brow£r
.
	`´štTabË
(
Çme¥aû
, 
bËName
);

107 } 
	`ÿtch
 (
ThrowabË
 
t
) {

108 
log
.
	`”rÜ
("E¼Ü iÀBrow£¸ExecutiÚ.", 
t
);

109 
throw
 
t
;

111 
	}
}

	@format/target/generated-sources/org/corfudb/format/Types.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
;

6 
public
 
fš®
 cÏs 
	cTy³s
 {

7 
´iv©e
 
	$Ty³s
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

20 
public
 
D©aTy³


21 
im¶em’ts
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gPrÙocŞMes§geEnum
 {

25 
DATA
(0),

29 
EMPTY
(1),

33 
HOLE
(2),

37 
TRIMMED
(3),

41 
PROPOSAL
(4),

47 
public
 
fš®
 
	gDATA_VALUE
 = 0;

51 
public
 
fš®
 
	gEMPTY_VALUE
 = 1;

55 
public
 
fš®
 
	gHOLE_VALUE
 = 2;

59 
public
 
fš®
 
	gTRIMMED_VALUE
 = 3;

63 
public
 
fš®
 
	gPROPOSAL_VALUE
 = 4;

66 
public
 
fš®
 
g‘Numb”
() {

67  
	gv®ue
;

73 @
	gjava
.
	gÏng
.
D•»ÿ‹d


74 
public
 
D©aTy³
 
v®ueOf
(
v®ue
) {

75  
fÜNumb”
(
v®ue
);

78 
public
 
D©aTy³
 
fÜNumb”
(
v®ue
) {

79 
	gv®ue
) {

80 0:  
DATA
;

81 1:  
EMPTY
;

82 2:  
HOLE
;

83 3:  
TRIMMED
;

84 4:  
PROPOSAL
;

85 :  
nuÎ
;

89 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gIÁ”Çl
.
	gEnumL™eM­
<
	gD©aTy³
>

90 
š‹º®G‘V®ueM­
() {

91  
	gš‹º®V®ueM­
;

93 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gIÁ”Çl
.
	gEnumL™eM­
<

94 
	gD©aTy³
> 
	gš‹º®V®ueM­
 =

95 
Ãw
 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
EnumL™eM­
<
D©aTy³
>() {

96 
public
 
D©aTy³
 
fšdV®ueByNumb”
(
numb”
) {

97  
D©aTy³
.
fÜNumb”
(
numb”
);

101 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumV®ueDesütÜ


102 
g‘V®ueDesütÜ
() {

103  
g‘DesütÜ
().
g‘V®ues
().
g‘
(
Üdš®
());

105 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumDesütÜ


106 
g‘DesütÜFÜTy³
() {

107  
g‘DesütÜ
();

109 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumDesütÜ


110 
g‘DesütÜ
() {

111  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
g‘DesütÜ
().
g‘EnumTy³s
().
g‘
(0);

114 
´iv©e
 
fš®
 
	gD©aTy³
[] 
	gVALUES
 = 
v®ues
();

116 
public
 
D©aTy³
 
v®ueOf
(

117 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
EnumV®ueDesütÜ
 
desc
) {

118 ià(
	gdesc
.
g‘Ty³
(è!ğ
g‘DesütÜ
()) {

119 
throw
 
Ãw
 
java
.
Ïng
.
IÎeg®Argum’tExû±iÚ
(

122  
	gVALUES
[
desc
.
g‘Index
()];

125 
´iv©e
 
fš®
 
	gv®ue
;

127 
´iv©e
 
D©aTy³
(
v®ue
) {

128 
	gthis
.
	gv®ue
 = 
v®ue
;

137 
public
 
CheckpoštEÁryTy³


138 
im¶em’ts
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gPrÙocŞMes§geEnum
 {

142 
START
(0),

146 
CONTINUATION
(1),

150 
END
(2),

156 
public
 
fš®
 
	gSTART_VALUE
 = 0;

160 
public
 
fš®
 
	gCONTINUATION_VALUE
 = 1;

164 
public
 
fš®
 
	gEND_VALUE
 = 2;

167 
public
 
fš®
 
g‘Numb”
() {

168  
	gv®ue
;

174 @
	gjava
.
	gÏng
.
D•»ÿ‹d


175 
public
 
CheckpoštEÁryTy³
 
v®ueOf
(
v®ue
) {

176  
fÜNumb”
(
v®ue
);

179 
public
 
CheckpoštEÁryTy³
 
fÜNumb”
(
v®ue
) {

180 
	gv®ue
) {

181 0:  
START
;

182 1:  
CONTINUATION
;

183 2:  
END
;

184 :  
nuÎ
;

188 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gIÁ”Çl
.
	gEnumL™eM­
<
	gCheckpoštEÁryTy³
>

189 
š‹º®G‘V®ueM­
() {

190  
	gš‹º®V®ueM­
;

192 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gIÁ”Çl
.
	gEnumL™eM­
<

193 
	gCheckpoštEÁryTy³
> 
	gš‹º®V®ueM­
 =

194 
Ãw
 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
EnumL™eM­
<
CheckpoštEÁryTy³
>() {

195 
public
 
CheckpoštEÁryTy³
 
fšdV®ueByNumb”
(
numb”
) {

196  
CheckpoštEÁryTy³
.
fÜNumb”
(
numb”
);

200 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumV®ueDesütÜ


201 
g‘V®ueDesütÜ
() {

202  
g‘DesütÜ
().
g‘V®ues
().
g‘
(
Üdš®
());

204 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumDesütÜ


205 
g‘DesütÜFÜTy³
() {

206  
g‘DesütÜ
();

208 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumDesütÜ


209 
g‘DesütÜ
() {

210  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
g‘DesütÜ
().
g‘EnumTy³s
().
g‘
(1);

213 
´iv©e
 
fš®
 
	gCheckpoštEÁryTy³
[] 
	gVALUES
 = 
v®ues
();

215 
public
 
CheckpoštEÁryTy³
 
v®ueOf
(

216 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
EnumV®ueDesütÜ
 
desc
) {

217 ià(
	gdesc
.
g‘Ty³
(è!ğ
g‘DesütÜ
()) {

218 
throw
 
Ãw
 
java
.
Ïng
.
IÎeg®Argum’tExû±iÚ
(

221  
	gVALUES
[
desc
.
g‘Index
()];

224 
´iv©e
 
fš®
 
	gv®ue
;

226 
´iv©e
 
CheckpoštEÁryTy³
(
v®ue
) {

227 
	gthis
.
	gv®ue
 = 
v®ue
;

233 
public
 
š‹rçû
 
D©aRªkOrBud”
 
ex‹nds


235 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

240 
boŞ—n
 
hasRªk
();

244 
g‘Rªk
();

249 
boŞ—n
 
hasUuidMo¡SignifiÿÁ
();

253 
g‘UuidMo¡SignifiÿÁ
();

258 
boŞ—n
 
hasUuidL—¡SignifiÿÁ
();

262 
g‘UuidL—¡SignifiÿÁ
();

267 
public
 
fš®
 
şass
 
D©aRªk
 
ex‹nds


268 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


270 
	gD©aRªkOrBud”
 {

272 
´iv©e
 
D©aRªk
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

273 
su³r
(
bud”
);

275 
´iv©e
 
D©aRªk
() {

276 
	g¿nk_
 = 0L;

277 
	guuidMo¡SignifiÿÁ_
 = 0L;

278 
	guuidL—¡SignifiÿÁ_
 = 0L;

281 @
	gjava
.
	gÏng
.
Ov”ride


282 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


283 
g‘UnknownF›lds
() {

284  
	gthis
.
	gunknownF›lds
;

286 
´iv©e
 
D©aRªk
(

287 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

288 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

289 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

290 
this
();

291 
	gmubË_b™F›ld0_
 = 0;

292 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

293 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

294 
	gŒy
 {

295 
boŞ—n
 
	gdÚe
 = 
çl£
;

296 !
	gdÚe
) {

297 
	gg
 = 
šput
.
»adTag
();

298 
	gg
) {

300 
dÚe
 = 
Œue
;

303 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

304 
ex‹nsiÚRegi¡ry
, 
g
)) {

305 
	gdÚe
 = 
Œue
;

310 
b™F›ld0_
 |= 0x00000001;

311 
	g¿nk_
 = 
šput
.
»adIÁ64
();

315 
b™F›ld0_
 |= 0x00000002;

316 
	guuidMo¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

320 
b™F›ld0_
 |= 0x00000004;

321 
	guuidL—¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

326 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

327 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

328 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

329 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

330 
e
).
£tUnfšishedMes§ge
(
this
);

331 } 
	gfš®ly
 {

332 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

333 
makeEx‹nsiÚsImmubË
();

336 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


337 
g‘DesütÜ
() {

338  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_D©aRªk_desütÜ
;

341 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


342 
š‹º®G‘F›ldAcûssÜTabË
() {

343  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_D©aRªk_f›ldAcûssÜTabË


344 .
’su»F›ldAcûssÜsIn™Ÿlized
(

345 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
şass
, org.cÜfudb.fÜm©.Ty³s.D©aRªk.
Bud”
.class);

348 
´iv©e
 
	gb™F›ld0_
;

349 
public
 
fš®
 
	gRANK_FIELD_NUMBER
 = 1;

350 
´iv©e
 
	g¿nk_
;

354 
public
 
boŞ—n
 
hasRªk
() {

355  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

360 
public
 
g‘Rªk
() {

361  
	g¿nk_
;

364 
public
 
fš®
 
	gUUID_MOST_SIGNIFICANT_FIELD_NUMBER
 = 2;

365 
´iv©e
 
	guuidMo¡SignifiÿÁ_
;

369 
public
 
boŞ—n
 
hasUuidMo¡SignifiÿÁ
() {

370  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

375 
public
 
g‘UuidMo¡SignifiÿÁ
() {

376  
	guuidMo¡SignifiÿÁ_
;

379 
public
 
fš®
 
	gUUID_LEAST_SIGNIFICANT_FIELD_NUMBER
 = 3;

380 
´iv©e
 
	guuidL—¡SignifiÿÁ_
;

384 
public
 
boŞ—n
 
hasUuidL—¡SignifiÿÁ
() {

385  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

390 
public
 
g‘UuidL—¡SignifiÿÁ
() {

391  
	guuidL—¡SignifiÿÁ_
;

394 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

395 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

396 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

397 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

398 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

400 ià(!
hasRªk
()) {

401 
	gmemoizedIsIn™Ÿlized
 = 0;

402  
	gçl£
;

404 ià(!
hasUuidMo¡SignifiÿÁ
()) {

405 
	gmemoizedIsIn™Ÿlized
 = 0;

406  
	gçl£
;

408 ià(!
hasUuidL—¡SignifiÿÁ
()) {

409 
	gmemoizedIsIn™Ÿlized
 = 0;

410  
	gçl£
;

412 
	gmemoizedIsIn™Ÿlized
 = 1;

413  
	gŒue
;

416 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

417 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

418 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

419 
ouut
.
wr™eIÁ64
(1, 
¿nk_
);

421 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

422 
ouut
.
wr™eIÁ64
(2, 
uuidMo¡SignifiÿÁ_
);

424 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

425 
ouut
.
wr™eIÁ64
(3, 
uuidL—¡SignifiÿÁ_
);

427 
	gunknownF›lds
.
wr™eTo
(
ouut
);

430 
public
 
g‘S”ŸlizedSize
() {

431 
	gsize
 = 
memoizedSize
;

432 ià(
	gsize
 !ğ-1è 
size
;

434 
	gsize
 = 0;

435 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

436 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


437 .
compu‹IÁ64Size
(1, 
¿nk_
);

439 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

440 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


441 .
compu‹IÁ64Size
(2, 
uuidMo¡SignifiÿÁ_
);

443 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

444 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


445 .
compu‹IÁ64Size
(3, 
uuidL—¡SignifiÿÁ_
);

447 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

448 
	gmemoizedSize
 = 
size
;

449  
	gsize
;

452 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

453 @
	gjava
.
	gÏng
.
Ov”ride


454 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

455 ià(
	gobj
 =ğ
this
) {

456  
Œue
;

458 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
)) {

459  
	gsu³r
.
equ®s
(
obj
);

461 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	gÙh”
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.D©aRªkè
obj
;

463 
boŞ—n
 
	g»suÉ
 = 
Œue
;

464 
	g»suÉ
 = 
»suÉ
 && (
hasRªk
(è=ğ
Ùh”
.hasRank());

465 ià(
hasRªk
()) {

466 
	g»suÉ
 = 
»suÉ
 && (
g‘Rªk
()

467 =ğ
Ùh”
.
g‘Rªk
());

469 
	g»suÉ
 = 
»suÉ
 && (
hasUuidMo¡SignifiÿÁ
(è=ğ
Ùh”
.hasUuidMostSignificant());

470 ià(
hasUuidMo¡SignifiÿÁ
()) {

471 
	g»suÉ
 = 
»suÉ
 && (
g‘UuidMo¡SignifiÿÁ
()

472 =ğ
Ùh”
.
g‘UuidMo¡SignifiÿÁ
());

474 
	g»suÉ
 = 
»suÉ
 && (
hasUuidL—¡SignifiÿÁ
(è=ğ
Ùh”
.hasUuidLeastSignificant());

475 ià(
hasUuidL—¡SignifiÿÁ
()) {

476 
	g»suÉ
 = 
»suÉ
 && (
g‘UuidL—¡SignifiÿÁ
()

477 =ğ
Ùh”
.
g‘UuidL—¡SignifiÿÁ
());

479 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

480  
	g»suÉ
;

483 @
	gjava
.
	gÏng
.
Ov”ride


484 
public
 
hashCode
() {

485 ià(
	gmemoizedHashCode
 != 0) {

486  
memoizedHashCode
;

488 
	ghash
 = 41;

489 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

490 ià(
hasRªk
()) {

491 
	ghash
 = (37 * 
hash
è+ 
RANK_FIELD_NUMBER
;

492 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

493 
g‘Rªk
());

495 ià(
hasUuidMo¡SignifiÿÁ
()) {

496 
	ghash
 = (37 * 
hash
è+ 
UUID_MOST_SIGNIFICANT_FIELD_NUMBER
;

497 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

498 
g‘UuidMo¡SignifiÿÁ
());

500 ià(
hasUuidL—¡SignifiÿÁ
()) {

501 
	ghash
 = (37 * 
hash
è+ 
UUID_LEAST_SIGNIFICANT_FIELD_NUMBER
;

502 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

503 
g‘UuidL—¡SignifiÿÁ
());

505 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

506 
	gmemoizedHashCode
 = 
hash
;

507  
	ghash
;

510 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(

511 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

512 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

513  
	gPARSER
.
·r£From
(
d©a
);

515 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(

516 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

517 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

518 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

519  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

521 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(
by‹
[] 
d©a
)

522 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

523  
	gPARSER
.
·r£From
(
d©a
);

525 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(

526 
by‹
[] 
d©a
,

527 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

528 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

529  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

531 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

532 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

533  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


534 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

536 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(

537 
java
.
io
.
IÅutSŒ—m
 
šput
,

538 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

539 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

540  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


541 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

543 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

544 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

545  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


546 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

548 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£D–im™edFrom
(

549 
java
.
io
.
IÅutSŒ—m
 
šput
,

550 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

551 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

552  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


553 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

555 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(

556 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

557 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

558  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


559 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

561 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
·r£From
(

562 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

563 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

564 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

565  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


566 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

569 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

570 
public
 
Bud”
 
ÃwBud”
() {

571  
	gDEFAULT_INSTANCE
.
toBud”
();

573 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
 
´ÙÙy³
) {

574  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

576 
public
 
Bud”
 
toBud”
() {

577  
	gthis
 =ğ
DEFAULT_INSTANCE


578 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

581 @
	gjava
.
	gÏng
.
Ov”ride


582 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

583 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

584 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

585  
	gbud”
;

590 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


591 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


593 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªkOrBud”
 {

594 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


595 
g‘DesütÜ
() {

596  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_D©aRªk_desütÜ
;

599 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


600 
š‹º®G‘F›ldAcûssÜTabË
() {

601  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_D©aRªk_f›ldAcûssÜTabË


602 .
’su»F›ldAcûssÜsIn™Ÿlized
(

603 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
şass
, org.cÜfudb.fÜm©.Ty³s.D©aRªk.
Bud”
.class);

607 
´iv©e
 
Bud”
() {

608 
maybeFÜûBud”In™Ÿliz©iÚ
();

611 
´iv©e
 
Bud”
(

612 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

613 
su³r
(
·»Á
);

614 
maybeFÜûBud”In™Ÿliz©iÚ
();

616 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

617 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


618 .
	g®waysU£F›ldBud”s
) {

621 
public
 
Bud”
 
ş—r
() {

622 
	gsu³r
.
ş—r
();

623 
	g¿nk_
 = 0L;

624 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

625 
	guuidMo¡SignifiÿÁ_
 = 0L;

626 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

627 
	guuidL—¡SignifiÿÁ_
 = 0L;

628 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

629  
	gthis
;

632 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


633 
g‘DesütÜFÜTy³
() {

634  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_D©aRªk_desütÜ
;

637 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
g‘DeçuÉIn¡ªûFÜTy³
() {

638  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
.
g‘DeçuÉIn¡ªû
();

641 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
bud
() {

642 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	g»suÉ
 = 
budP¬tŸl
();

643 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

644 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

646  
	g»suÉ
;

649 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
budP¬tŸl
() {

650 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.D©aRªk(
this
);

651 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

652 
	gto_b™F›ld0_
 = 0;

653 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

654 
to_b™F›ld0_
 |= 0x00000001;

656 
	g»suÉ
.
	g¿nk_
 = 
¿nk_
;

657 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

658 
to_b™F›ld0_
 |= 0x00000002;

660 
	g»suÉ
.
	guuidMo¡SignifiÿÁ_
 = 
uuidMo¡SignifiÿÁ_
;

661 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

662 
to_b™F›ld0_
 |= 0x00000004;

664 
	g»suÉ
.
	guuidL—¡SignifiÿÁ_
 = 
uuidL—¡SignifiÿÁ_
;

665 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

666 
ÚBut
();

667  
	g»suÉ
;

670 
public
 
Bud”
 
şÚe
() {

671  (
	gBud”
è
	gsu³r
.
şÚe
();

673 
public
 
Bud”
 
£tF›ld
(

674 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

675 
Objeù
 
v®ue
) {

676  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

678 
public
 
Bud”
 
ş—rF›ld
(

679 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

680  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

682 
public
 
Bud”
 
ş—rOÃof
(

683 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

684  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

686 
public
 
Bud”
 
£tR•—‹dF›ld
(

687 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

688 
šdex
, 
Objeù
 
v®ue
) {

689  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

691 
public
 
Bud”
 
addR•—‹dF›ld
(

692 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

693 
Objeù
 
v®ue
) {

694  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

696 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

697 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
) {

698  
m”geFrom
((
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
)
Ùh”
);

700 
	gsu³r
.
m”geFrom
(
Ùh”
);

701  
	gthis
;

705 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
 
Ùh”
) {

706 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
g‘DeçuÉIn¡ªû
()è 
this
;

707 ià(
	gÙh”
.
hasRªk
()) {

708 
£tRªk
(
Ùh”
.
g‘Rªk
());

710 ià(
	gÙh”
.
hasUuidMo¡SignifiÿÁ
()) {

711 
£tUuidMo¡SignifiÿÁ
(
Ùh”
.
g‘UuidMo¡SignifiÿÁ
());

713 ià(
	gÙh”
.
hasUuidL—¡SignifiÿÁ
()) {

714 
£tUuidL—¡SignifiÿÁ
(
Ùh”
.
g‘UuidL—¡SignifiÿÁ
());

716 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

717 
ÚChªged
();

718  
	gthis
;

721 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

722 ià(!
hasRªk
()) {

723  
	gçl£
;

725 ià(!
hasUuidMo¡SignifiÿÁ
()) {

726  
	gçl£
;

728 ià(!
hasUuidL—¡SignifiÿÁ
()) {

729  
	gçl£
;

731  
	gŒue
;

734 
public
 
Bud”
 
m”geFrom
(

735 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

736 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

737 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

738 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	g·r£dMes§ge
 = 
nuÎ
;

739 
	gŒy
 {

740 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

741 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

742 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
è
e
.
g‘UnfšishedMes§ge
();

743 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

744 } 
	gfš®ly
 {

745 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

746 
m”geFrom
(
·r£dMes§ge
);

749  
	gthis
;

751 
´iv©e
 
	gb™F›ld0_
;

753 
´iv©e
 
	g¿nk_
 ;

757 
public
 
boŞ—n
 
hasRªk
() {

758  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

763 
public
 
g‘Rªk
() {

764  
	g¿nk_
;

769 
public
 
Bud”
 
£tRªk
(
v®ue
) {

770 
	gb™F›ld0_
 |= 0x00000001;

771 
	g¿nk_
 = 
v®ue
;

772 
ÚChªged
();

773  
	gthis
;

778 
public
 
Bud”
 
ş—rRªk
() {

779 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

780 
	g¿nk_
 = 0L;

781 
ÚChªged
();

782  
	gthis
;

785 
´iv©e
 
	guuidMo¡SignifiÿÁ_
 ;

789 
public
 
boŞ—n
 
hasUuidMo¡SignifiÿÁ
() {

790  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

795 
public
 
g‘UuidMo¡SignifiÿÁ
() {

796  
	guuidMo¡SignifiÿÁ_
;

801 
public
 
Bud”
 
£tUuidMo¡SignifiÿÁ
(
v®ue
) {

802 
	gb™F›ld0_
 |= 0x00000002;

803 
	guuidMo¡SignifiÿÁ_
 = 
v®ue
;

804 
ÚChªged
();

805  
	gthis
;

810 
public
 
Bud”
 
ş—rUuidMo¡SignifiÿÁ
() {

811 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

812 
	guuidMo¡SignifiÿÁ_
 = 0L;

813 
ÚChªged
();

814  
	gthis
;

817 
´iv©e
 
	guuidL—¡SignifiÿÁ_
 ;

821 
public
 
boŞ—n
 
hasUuidL—¡SignifiÿÁ
() {

822  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

827 
public
 
g‘UuidL—¡SignifiÿÁ
() {

828  
	guuidL—¡SignifiÿÁ_
;

833 
public
 
Bud”
 
£tUuidL—¡SignifiÿÁ
(
v®ue
) {

834 
	gb™F›ld0_
 |= 0x00000004;

835 
	guuidL—¡SignifiÿÁ_
 = 
v®ue
;

836 
ÚChªged
();

837  
	gthis
;

842 
public
 
Bud”
 
ş—rUuidL—¡SignifiÿÁ
() {

843 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

844 
	guuidL—¡SignifiÿÁ_
 = 0L;

845 
ÚChªged
();

846  
	gthis
;

848 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

849 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

850  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

853 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

854 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

855  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

863 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	gDEFAULT_INSTANCE
;

865 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
();

868 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
g‘DeçuÉIn¡ªû
() {

869  
	gDEFAULT_INSTANCE
;

872 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gD©aRªk
>

873 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
D©aRªk
>() {

874 
public
 
D©aRªk
 
·r£P¬tŸlFrom
(

875 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

876 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

877 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

878  
Ãw
 
D©aRªk
(
šput
, 
ex‹nsiÚRegi¡ry
);

882 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gD©aRªk
> 
·r£r
() {

883  
	gPARSER
;

886 @
	gjava
.
	gÏng
.
Ov”ride


887 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gD©aRªk
> 
g‘P¬£rFÜTy³
() {

888  
	gPARSER
;

891 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
g‘DeçuÉIn¡ªûFÜTy³
() {

892  
	gDEFAULT_INSTANCE
;

897 
public
 
š‹rçû
 
LogEÁryOrBud”
 
ex‹nds


899 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

904 
boŞ—n
 
hasD©aTy³
();

908 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aTy³
 
g‘D©aTy³
();

913 
boŞ—n
 
hasD©a
();

917 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
g‘D©a
();

922 
boŞ—n
 
hasGlob®Add»ss
();

926 
g‘Glob®Add»ss
();

931 
	gjava
.
	gut
.
	gLi¡
<java.
	gÏng
.
	gSŒšg
>

932 
g‘SŒ—msLi¡
();

936 
g‘SŒ—msCouÁ
();

940 
	gjava
.
	gÏng
.
SŒšg
 
g‘SŒ—ms
(
šdex
);

944 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


945 
g‘SŒ—msBy‹s
(
šdex
);

950 
g‘LogiÿlAdd»s£sCouÁ
();

954 
boŞ—n
 
cÚšsLogiÿlAdd»s£s
(

955 
java
.
Ïng
.
SŒšg
 
key
);

959 @
	gjava
.
	gÏng
.
D•»ÿ‹d


960 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

961 
g‘LogiÿlAdd»s£s
();

965 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

966 
g‘LogiÿlAdd»s£sM­
();

971 
g‘LogiÿlAdd»s£sOrDeçuÉ
(

972 
java
.
Ïng
.
SŒšg
 
key
,

973 
deçuÉV®ue
);

978 
g‘LogiÿlAdd»s£sOrThrow
(

979 
java
.
Ïng
.
SŒšg
 
key
);

984 
g‘Backpoš‹rsCouÁ
();

988 
boŞ—n
 
cÚšsBackpoš‹rs
(

989 
java
.
Ïng
.
SŒšg
 
key
);

993 @
	gjava
.
	gÏng
.
D•»ÿ‹d


994 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

995 
g‘Backpoš‹rs
();

999 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

1000 
g‘Backpoš‹rsM­
();

1005 
g‘Backpoš‹rsOrDeçuÉ
(

1006 
java
.
Ïng
.
SŒšg
 
key
,

1007 
deçuÉV®ue
);

1012 
g‘Backpoš‹rsOrThrow
(

1013 
java
.
Ïng
.
SŒšg
 
key
);

1018 
boŞ—n
 
hasRªk
();

1022 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
g‘Rªk
();

1026 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªkOrBud”
 
g‘RªkOrBud”
();

1031 
boŞ—n
 
hasCheckpoštEÁryTy³
();

1035 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
CheckpoštEÁryTy³
 
g‘CheckpoštEÁryTy³
();

1040 
boŞ—n
 
hasCheckpoštIdMo¡SignifiÿÁ
();

1044 
g‘CheckpoštIdMo¡SignifiÿÁ
();

1049 
boŞ—n
 
hasCheckpoštIdL—¡SignifiÿÁ
();

1053 
g‘CheckpoštIdL—¡SignifiÿÁ
();

1058 
boŞ—n
 
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
();

1062 
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
();

1067 
boŞ—n
 
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
();

1071 
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
();

1080 
boŞ—n
 
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
();

1088 
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
();

1097 
boŞ—n
 
hasCl›ÁIdL—¡SignifiÿÁ
();

1105 
g‘Cl›ÁIdL—¡SignifiÿÁ
();

1110 
boŞ—n
 
hasCl›ÁIdMo¡SignifiÿÁ
();

1114 
g‘Cl›ÁIdMo¡SignifiÿÁ
();

1123 
boŞ—n
 
hasTh»adId
();

1131 
g‘Th»adId
();

1143 
boŞ—n
 
hasCodecTy³
();

1154 
g‘CodecTy³
();

1159 
public
 
fš®
 
şass
 
LogEÁry
 
ex‹nds


1160 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1162 
	gLogEÁryOrBud”
 {

1164 
´iv©e
 
LogEÁry
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1165 
su³r
(
bud”
);

1167 
´iv©e
 
LogEÁry
() {

1168 
	gd©aTy³_
 = 0;

1169 
	gd©a_
 = 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
EMPTY
;

1170 
	gglob®Add»ss_
 = 0L;

1171 
	g¡»ams_
 = 
com
.
googË
.
´Ùobuf
.
LazySŒšgA¼ayLi¡
.
EMPTY
;

1172 
	gcheckpoštEÁryTy³_
 = 0;

1173 
	gcheckpoštIdMo¡SignifiÿÁ_
 = 0L;

1174 
	gcheckpoštIdL—¡SignifiÿÁ_
 = 0L;

1175 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 = 0L;

1176 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 = 0L;

1177 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 = 0L;

1178 
	gş›ÁIdL—¡SignifiÿÁ_
 = 0L;

1179 
	gş›ÁIdMo¡SignifiÿÁ_
 = 0L;

1180 
	gth»adId_
 = 0L;

1181 
	gcodecTy³_
 = 0;

1184 @
	gjava
.
	gÏng
.
Ov”ride


1185 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1186 
g‘UnknownF›lds
() {

1187  
	gthis
.
	gunknownF›lds
;

1189 
´iv©e
 
LogEÁry
(

1190 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1191 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1192 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1193 
this
();

1194 
	gmubË_b™F›ld0_
 = 0;

1195 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

1196 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

1197 
	gŒy
 {

1198 
boŞ—n
 
	gdÚe
 = 
çl£
;

1199 !
	gdÚe
) {

1200 
	gg
 = 
šput
.
»adTag
();

1201 
	gg
) {

1203 
dÚe
 = 
Œue
;

1206 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

1207 
ex‹nsiÚRegi¡ry
, 
g
)) {

1208 
	gdÚe
 = 
Œue
;

1213 
¿wV®ue
 = 
šput
.
»adEnum
();

1214 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aTy³
 
	gv®ue
 = 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.D©aTy³.
v®ueOf
(
¿wV®ue
);

1215 ià(
	gv®ue
 =ğ
nuÎ
) {

1216 
unknownF›lds
.
m”geV¬štF›ld
(1, 
¿wV®ue
);

1218 
	gb™F›ld0_
 |= 0x00000001;

1219 
	gd©aTy³_
 = 
¿wV®ue
;

1224 
b™F›ld0_
 |= 0x00000002;

1225 
	gd©a_
 = 
šput
.
»adBy‹s
();

1229 
b™F›ld0_
 |= 0x00000004;

1230 
	gglob®Add»ss_
 = 
šput
.
»adIÁ64
();

1234 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

1235 ià(!((
	gmubË_b™F›ld0_
 & 0x00000008) == 0x00000008)) {

1236 
¡»ams_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
LazySŒšgA¼ayLi¡
();

1237 
	gmubË_b™F›ld0_
 |= 0x00000008;

1239 
	g¡»ams_
.
add
(
bs
);

1243 ià(!((
mubË_b™F›ld0_
 & 0x00000010) == 0x00000010)) {

1244 
logiÿlAdd»s£s_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

1245 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1246 
	gmubË_b™F›ld0_
 |= 0x00000010;

1248 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

1249 
	glogiÿlAdd»s£s__
 = 
šput
.
»adMes§ge
(

1250 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
g‘P¬£rFÜTy³
(), 
ex‹nsiÚRegi¡ry
);

1251 
	glogiÿlAdd»s£s_
.
g‘MubËM­
().
put
(

1252 
logiÿlAdd»s£s__
.
g‘Key
(),†ogiÿlAdd»s£s__.
g‘V®ue
());

1256 ià(!((
mubË_b™F›ld0_
 & 0x00000020) == 0x00000020)) {

1257 
backpoš‹rs_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

1258 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1259 
	gmubË_b™F›ld0_
 |= 0x00000020;

1261 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

1262 
	gbackpoš‹rs__
 = 
šput
.
»adMes§ge
(

1263 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
g‘P¬£rFÜTy³
(), 
ex‹nsiÚRegi¡ry
);

1264 
	gbackpoš‹rs_
.
g‘MubËM­
().
put
(

1265 
backpoš‹rs__
.
g‘Key
(), backpoš‹rs__.
g‘V®ue
());

1269 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
Bud”
 
subBud”
 = 
nuÎ
;

1270 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

1271 
subBud”
 = 
¿nk_
.
toBud”
();

1273 
	g¿nk_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
PARSER
, 
ex‹nsiÚRegi¡ry
);

1274 ià(
	gsubBud”
 !ğ
nuÎ
) {

1275 
subBud”
.
m”geFrom
(
¿nk_
);

1276 
	g¿nk_
 = 
subBud”
.
budP¬tŸl
();

1278 
	gb™F›ld0_
 |= 0x00000008;

1282 
¿wV®ue
 = 
šput
.
»adEnum
();

1283 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
CheckpoštEÁryTy³
 
	gv®ue
 = 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.CheckpoštEÁryTy³.
v®ueOf
(
¿wV®ue
);

1284 ià(
	gv®ue
 =ğ
nuÎ
) {

1285 
unknownF›lds
.
m”geV¬štF›ld
(10, 
¿wV®ue
);

1287 
	gb™F›ld0_
 |= 0x00000010;

1288 
	gcheckpoštEÁryTy³_
 = 
¿wV®ue
;

1293 
b™F›ld0_
 |= 0x00000020;

1294 
	gcheckpoštIdMo¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

1298 
b™F›ld0_
 |= 0x00000040;

1299 
	gcheckpoštIdL—¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

1303 
b™F›ld0_
 |= 0x00000080;

1304 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

1308 
b™F›ld0_
 |= 0x00000100;

1309 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

1313 
b™F›ld0_
 |= 0x00000200;

1314 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 = 
šput
.
»adIÁ64
();

1318 
b™F›ld0_
 |= 0x00000400;

1319 
	gş›ÁIdL—¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

1323 
b™F›ld0_
 |= 0x00000800;

1324 
	gş›ÁIdMo¡SignifiÿÁ_
 = 
šput
.
»adIÁ64
();

1328 
b™F›ld0_
 |= 0x00001000;

1329 
	gth»adId_
 = 
šput
.
»adIÁ64
();

1333 
b™F›ld0_
 |= 0x00002000;

1334 
	gcodecTy³_
 = 
šput
.
»adIÁ32
();

1339 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1340 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

1341 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

1342 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

1343 
e
).
£tUnfšishedMes§ge
(
this
);

1344 } 
	gfš®ly
 {

1345 ià(((
	gmubË_b™F›ld0_
 & 0x00000008) == 0x00000008)) {

1346 
¡»ams_
 = sŒ—ms_.
g‘UnmodifŸbËV›w
();

1348 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

1349 
makeEx‹nsiÚsImmubË
();

1352 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1353 
g‘DesütÜ
() {

1354  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogEÁry_desütÜ
;

1357 @
Suµ»ssW¬nšgs
({"rawtypes"})

1358 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘M­F›ld
(

1359 
numb”
) {

1360 
	gnumb”
) {

1362  
š‹º®G‘LogiÿlAdd»s£s
();

1364  
š‹º®G‘Backpoš‹rs
();

1366 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1367 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1370 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1371 
š‹º®G‘F›ldAcûssÜTabË
() {

1372  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogEÁry_f›ldAcûssÜTabË


1373 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1374 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
.
şass
, org.cÜfudb.fÜm©.Ty³s.LogEÁry.
Bud”
.class);

1377 
´iv©e
 
	gb™F›ld0_
;

1378 
public
 
fš®
 
	gDATA_TYPE_FIELD_NUMBER
 = 1;

1379 
´iv©e
 
	gd©aTy³_
;

1383 
public
 
boŞ—n
 
hasD©aTy³
() {

1384  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

1389 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aTy³
 
g‘D©aTy³
() {

1390 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aTy³
 
	g»suÉ
 = 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.D©aTy³.
v®ueOf
(
d©aTy³_
);

1391  
	g»suÉ
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aTy³
.
DATA
 : 
»suÉ
;

1394 
public
 
fš®
 
	gDATA_FIELD_NUMBER
 = 2;

1395 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gd©a_
;

1399 
public
 
boŞ—n
 
hasD©a
() {

1400  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

1405 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
g‘D©a
() {

1406  
	gd©a_
;

1409 
public
 
fš®
 
	gGLOBAL_ADDRESS_FIELD_NUMBER
 = 3;

1410 
´iv©e
 
	gglob®Add»ss_
;

1414 
public
 
boŞ—n
 
hasGlob®Add»ss
() {

1415  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

1420 
public
 
g‘Glob®Add»ss
() {

1421  
	gglob®Add»ss_
;

1424 
public
 
fš®
 
	gSTREAMS_FIELD_NUMBER
 = 6;

1425 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
LazySŒšgLi¡
 
	g¡»ams_
;

1429 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
PrÙocŞSŒšgLi¡


1430 
g‘SŒ—msLi¡
() {

1431  
	g¡»ams_
;

1436 
public
 
g‘SŒ—msCouÁ
() {

1437  
	g¡»ams_
.
size
();

1442 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘SŒ—ms
(
šdex
) {

1443  
	g¡»ams_
.
g‘
(
šdex
);

1448 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1449 
g‘SŒ—msBy‹s
(
šdex
) {

1450  
	g¡»ams_
.
g‘By‹SŒšg
(
šdex
);

1453 
public
 
fš®
 
	gLOGICAL_ADDRESSES_FIELD_NUMBER
 = 7;

1454 
´iv©e
 
fš®
 cÏs 
	cLogiÿlAdd»s£sDeçuÉEÁryHŞd”
 {

1455 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<

1456 
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gdeçuÉEÁry
 =

1457 
com
.
googË
.
´Ùobuf
.
M­EÁry


1458 .<
java
.
Ïng
.
SŒšg
, 
	gjava
.
	gÏng
.
	gLÚg
>
ÃwDeçuÉIn¡ªû
(

1459 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
š‹º®_¡©ic_LogEÁry_LogiÿlAdd»s£sEÁry_desütÜ
,

1460 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
STRING
,

1462 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
INT64
,

1465 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

1466 
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	glogiÿlAdd»s£s_
;

1467 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

1468 
š‹º®G‘LogiÿlAdd»s£s
() {

1469 ià(
	glogiÿlAdd»s£s_
 =ğ
nuÎ
) {

1470  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

1471 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1473  
	glogiÿlAdd»s£s_
;

1476 
public
 
g‘LogiÿlAdd»s£sCouÁ
() {

1477  
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
().
size
();

1483 
public
 
boŞ—n
 
cÚšsLogiÿlAdd»s£s
(

1484 
java
.
Ïng
.
SŒšg
 
key
) {

1485 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1486  
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
().
cÚšsKey
(
key
);

1491 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1492 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘LogiÿlAdd»s£s
() {

1493  
g‘LogiÿlAdd»s£sM­
();

1499 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘LogiÿlAdd»s£sM­
() {

1500  
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
();

1506 
public
 
g‘LogiÿlAdd»s£sOrDeçuÉ
(

1507 
java
.
Ïng
.
SŒšg
 
key
,

1508 
deçuÉV®ue
) {

1509 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1510 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

1511 
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
();

1512  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

1518 
public
 
g‘LogiÿlAdd»s£sOrThrow
(

1519 
java
.
Ïng
.
SŒšg
 
key
) {

1520 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1521 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

1522 
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
();

1523 ià(!
	gm­
.
cÚšsKey
(
key
)) {

1524 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

1526  
	gm­
.
g‘
(
key
);

1529 
public
 
fš®
 
	gBACKPOINTERS_FIELD_NUMBER
 = 8;

1530 
´iv©e
 
fš®
 cÏs 
	cBackpoš‹rsDeçuÉEÁryHŞd”
 {

1531 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<

1532 
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gdeçuÉEÁry
 =

1533 
com
.
googË
.
´Ùobuf
.
M­EÁry


1534 .<
java
.
Ïng
.
SŒšg
, 
	gjava
.
	gÏng
.
	gLÚg
>
ÃwDeçuÉIn¡ªû
(

1535 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
š‹º®_¡©ic_LogEÁry_Backpoš‹rsEÁry_desütÜ
,

1536 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
STRING
,

1538 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
INT64
,

1541 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

1542 
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gbackpoš‹rs_
;

1543 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

1544 
š‹º®G‘Backpoš‹rs
() {

1545 ià(
	gbackpoš‹rs_
 =ğ
nuÎ
) {

1546  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

1547 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1549  
	gbackpoš‹rs_
;

1552 
public
 
g‘Backpoš‹rsCouÁ
() {

1553  
š‹º®G‘Backpoš‹rs
().
g‘M­
().
size
();

1559 
public
 
boŞ—n
 
cÚšsBackpoš‹rs
(

1560 
java
.
Ïng
.
SŒšg
 
key
) {

1561 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1562  
š‹º®G‘Backpoš‹rs
().
g‘M­
().
cÚšsKey
(
key
);

1567 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1568 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘Backpoš‹rs
() {

1569  
g‘Backpoš‹rsM­
();

1575 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘Backpoš‹rsM­
() {

1576  
š‹º®G‘Backpoš‹rs
().
g‘M­
();

1582 
public
 
g‘Backpoš‹rsOrDeçuÉ
(

1583 
java
.
Ïng
.
SŒšg
 
key
,

1584 
deçuÉV®ue
) {

1585 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1586 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

1587 
š‹º®G‘Backpoš‹rs
().
g‘M­
();

1588  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

1594 
public
 
g‘Backpoš‹rsOrThrow
(

1595 
java
.
Ïng
.
SŒšg
 
key
) {

1596 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1597 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

1598 
š‹º®G‘Backpoš‹rs
().
g‘M­
();

1599 ià(!
	gm­
.
cÚšsKey
(
key
)) {

1600 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

1602  
	gm­
.
g‘
(
key
);

1605 
public
 
fš®
 
	gRANK_FIELD_NUMBER
 = 9;

1606 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	g¿nk_
;

1610 
public
 
boŞ—n
 
hasRªk
() {

1611  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

1616 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
g‘Rªk
() {

1617  
	g¿nk_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
g‘DeçuÉIn¡ªû
(è: 
¿nk_
;

1622 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªkOrBud”
 
g‘RªkOrBud”
() {

1623  
	g¿nk_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
g‘DeçuÉIn¡ªû
(è: 
¿nk_
;

1626 
public
 
fš®
 
	gCHECKPOINTENTRYTYPE_FIELD_NUMBER
 = 10;

1627 
´iv©e
 
	gcheckpoštEÁryTy³_
;

1631 
public
 
boŞ—n
 
hasCheckpoštEÁryTy³
() {

1632  ((
	gb™F›ld0_
 & 0x00000010) == 0x00000010);

1637 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
CheckpoštEÁryTy³
 
g‘CheckpoštEÁryTy³
() {

1638 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
CheckpoštEÁryTy³
 
	g»suÉ
 = 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.CheckpoštEÁryTy³.
v®ueOf
(
checkpoštEÁryTy³_
);

1639  
	g»suÉ
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
CheckpoštEÁryTy³
.
START
 : 
»suÉ
;

1642 
public
 
fš®
 
	gCHECKPOINTID_MOST_SIGNIFICANT_FIELD_NUMBER
 = 11;

1643 
´iv©e
 
	gcheckpoštIdMo¡SignifiÿÁ_
;

1647 
public
 
boŞ—n
 
hasCheckpoštIdMo¡SignifiÿÁ
() {

1648  ((
	gb™F›ld0_
 & 0x00000020) == 0x00000020);

1653 
public
 
g‘CheckpoštIdMo¡SignifiÿÁ
() {

1654  
	gcheckpoštIdMo¡SignifiÿÁ_
;

1657 
public
 
fš®
 
	gCHECKPOINTID_LEAST_SIGNIFICANT_FIELD_NUMBER
 = 12;

1658 
´iv©e
 
	gcheckpoštIdL—¡SignifiÿÁ_
;

1662 
public
 
boŞ—n
 
hasCheckpoštIdL—¡SignifiÿÁ
() {

1663  ((
	gb™F›ld0_
 & 0x00000040) == 0x00000040);

1668 
public
 
g‘CheckpoštIdL—¡SignifiÿÁ
() {

1669  
	gcheckpoštIdL—¡SignifiÿÁ_
;

1672 
public
 
fš®
 
	gCHECKPOINTEDSTREAMID_MOST_SIGNIFICANT_FIELD_NUMBER
 = 13;

1673 
´iv©e
 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
;

1677 
public
 
boŞ—n
 
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
() {

1678  ((
	gb™F›ld0_
 & 0x00000080) == 0x00000080);

1683 
public
 
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
() {

1684  
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
;

1687 
public
 
fš®
 
	gCHECKPOINTEDSTREAMID_LEAST_SIGNIFICANT_FIELD_NUMBER
 = 14;

1688 
´iv©e
 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
;

1692 
public
 
boŞ—n
 
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
() {

1693  ((
	gb™F›ld0_
 & 0x00000100) == 0x00000100);

1698 
public
 
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
() {

1699  
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
;

1702 
public
 
fš®
 
	gCHECKPOINTEDSTREAMSTARTLOGADDRESS_FIELD_NUMBER
 = 15;

1703 
´iv©e
 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
;

1711 
public
 
boŞ—n
 
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
() {

1712  ((
	gb™F›ld0_
 & 0x00000200) == 0x00000200);

1721 
public
 
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
() {

1722  
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
;

1725 
public
 
fš®
 
	gCLIENTID_LEAST_SIGNIFICANT_FIELD_NUMBER
 = 16;

1726 
´iv©e
 
	gş›ÁIdL—¡SignifiÿÁ_
;

1734 
public
 
boŞ—n
 
hasCl›ÁIdL—¡SignifiÿÁ
() {

1735  ((
	gb™F›ld0_
 & 0x00000400) == 0x00000400);

1744 
public
 
g‘Cl›ÁIdL—¡SignifiÿÁ
() {

1745  
	gş›ÁIdL—¡SignifiÿÁ_
;

1748 
public
 
fš®
 
	gCLIENTID_MOST_SIGNIFICANT_FIELD_NUMBER
 = 17;

1749 
´iv©e
 
	gş›ÁIdMo¡SignifiÿÁ_
;

1753 
public
 
boŞ—n
 
hasCl›ÁIdMo¡SignifiÿÁ
() {

1754  ((
	gb™F›ld0_
 & 0x00000800) == 0x00000800);

1759 
public
 
g‘Cl›ÁIdMo¡SignifiÿÁ
() {

1760  
	gş›ÁIdMo¡SignifiÿÁ_
;

1763 
public
 
fš®
 
	gTHREADID_FIELD_NUMBER
 = 18;

1764 
´iv©e
 
	gth»adId_
;

1772 
public
 
boŞ—n
 
hasTh»adId
() {

1773  ((
	gb™F›ld0_
 & 0x00001000) == 0x00001000);

1782 
public
 
g‘Th»adId
() {

1783  
	gth»adId_
;

1786 
public
 
fš®
 
	gCODECTYPE_FIELD_NUMBER
 = 19;

1787 
´iv©e
 
	gcodecTy³_
;

1798 
public
 
boŞ—n
 
hasCodecTy³
() {

1799  ((
	gb™F›ld0_
 & 0x00002000) == 0x00002000);

1811 
public
 
g‘CodecTy³
() {

1812  
	gcodecTy³_
;

1815 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

1816 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1817 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

1818 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

1819 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

1821 ià(
hasRªk
()) {

1822 ià(!
g‘Rªk
().
isIn™Ÿlized
()) {

1823 
	gmemoizedIsIn™Ÿlized
 = 0;

1824  
	gçl£
;

1827 
	gmemoizedIsIn™Ÿlized
 = 1;

1828  
	gŒue
;

1831 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

1832 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1833 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

1834 
ouut
.
wr™eEnum
(1, 
d©aTy³_
);

1836 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1837 
ouut
.
wr™eBy‹s
(2, 
d©a_
);

1839 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

1840 
ouut
.
wr™eIÁ64
(3, 
glob®Add»ss_
);

1842 
	gi
 = 0; i < 
	g¡»ams_
.
size
(); i++) {

1843 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 6, 
¡»ams_
.
g‘Raw
(
i
));

1845 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1846 .
£rŸlizeSŒšgM­To
(

1847 
ouut
,

1848 
š‹º®G‘LogiÿlAdd»s£s
(),

1849 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
,

1851 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1852 .
£rŸlizeSŒšgM­To
(

1853 
ouut
,

1854 
š‹º®G‘Backpoš‹rs
(),

1855 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
,

1857 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

1858 
ouut
.
wr™eMes§ge
(9, 
g‘Rªk
());

1860 ià(((
	gb™F›ld0_
 & 0x00000010) == 0x00000010)) {

1861 
ouut
.
wr™eEnum
(10, 
checkpoštEÁryTy³_
);

1863 ià(((
	gb™F›ld0_
 & 0x00000020) == 0x00000020)) {

1864 
ouut
.
wr™eIÁ64
(11, 
checkpoštIdMo¡SignifiÿÁ_
);

1866 ià(((
	gb™F›ld0_
 & 0x00000040) == 0x00000040)) {

1867 
ouut
.
wr™eIÁ64
(12, 
checkpoštIdL—¡SignifiÿÁ_
);

1869 ià(((
	gb™F›ld0_
 & 0x00000080) == 0x00000080)) {

1870 
ouut
.
wr™eIÁ64
(13, 
checkpoš‹dSŒ—mIdMo¡SignifiÿÁ_
);

1872 ià(((
	gb™F›ld0_
 & 0x00000100) == 0x00000100)) {

1873 
ouut
.
wr™eIÁ64
(14, 
checkpoš‹dSŒ—mIdL—¡SignifiÿÁ_
);

1875 ià(((
	gb™F›ld0_
 & 0x00000200) == 0x00000200)) {

1876 
ouut
.
wr™eIÁ64
(15, 
checkpoš‹dSŒ—mS¹LogAdd»ss_
);

1878 ià(((
	gb™F›ld0_
 & 0x00000400) == 0x00000400)) {

1879 
ouut
.
wr™eIÁ64
(16, 
ş›ÁIdL—¡SignifiÿÁ_
);

1881 ià(((
	gb™F›ld0_
 & 0x00000800) == 0x00000800)) {

1882 
ouut
.
wr™eIÁ64
(17, 
ş›ÁIdMo¡SignifiÿÁ_
);

1884 ià(((
	gb™F›ld0_
 & 0x00001000) == 0x00001000)) {

1885 
ouut
.
wr™eIÁ64
(18, 
th»adId_
);

1887 ià(((
	gb™F›ld0_
 & 0x00002000) == 0x00002000)) {

1888 
ouut
.
wr™eIÁ32
(19, 
codecTy³_
);

1890 
	gunknownF›lds
.
wr™eTo
(
ouut
);

1893 
public
 
g‘S”ŸlizedSize
() {

1894 
	gsize
 = 
memoizedSize
;

1895 ià(
	gsize
 !ğ-1è 
size
;

1897 
	gsize
 = 0;

1898 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

1899 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1900 .
compu‹EnumSize
(1, 
d©aTy³_
);

1902 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1903 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1904 .
compu‹By‹sSize
(2, 
d©a_
);

1906 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

1907 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1908 .
compu‹IÁ64Size
(3, 
glob®Add»ss_
);

1911 
	gd©aSize
 = 0;

1912 
	gi
 = 0; i < 
	g¡»ams_
.
size
(); i++) {

1913 
	gd©aSize
 +ğ
compu‹SŒšgSizeNoTag
(
¡»ams_
.
g‘Raw
(
i
));

1915 
	gsize
 +ğ
d©aSize
;

1916 
	gsize
 +ğ1 * 
g‘SŒ—msLi¡
().
size
();

1918 
	gjava
.
	gut
.
	gM­
.
	gEÁry
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	g’Œy


1919 : 
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
().
’ŒyS‘
()) {

1920 
com
.
googË
.
´Ùobuf
.
M­EÁry
<
java
.
Ïng
.
SŒšg
, 
	gjava
.
	gÏng
.
	gLÚg
>

1921 
	glogiÿlAdd»s£s__
 = 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
ÃwBud”FÜTy³
()

1922 .
£tKey
(
’Œy
.
g‘Key
())

1923 .
£tV®ue
(
’Œy
.
g‘V®ue
())

1924 .
bud
();

1925 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1926 .
compu‹Mes§geSize
(7, 
logiÿlAdd»s£s__
);

1928 
	gjava
.
	gut
.
	gM­
.
	gEÁry
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	g’Œy


1929 : 
š‹º®G‘Backpoš‹rs
().
g‘M­
().
’ŒyS‘
()) {

1930 
com
.
googË
.
´Ùobuf
.
M­EÁry
<
java
.
Ïng
.
SŒšg
, 
	gjava
.
	gÏng
.
	gLÚg
>

1931 
	gbackpoš‹rs__
 = 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
ÃwBud”FÜTy³
()

1932 .
£tKey
(
’Œy
.
g‘Key
())

1933 .
£tV®ue
(
’Œy
.
g‘V®ue
())

1934 .
bud
();

1935 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1936 .
compu‹Mes§geSize
(8, 
backpoš‹rs__
);

1938 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

1939 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1940 .
compu‹Mes§geSize
(9, 
g‘Rªk
());

1942 ià(((
	gb™F›ld0_
 & 0x00000010) == 0x00000010)) {

1943 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1944 .
compu‹EnumSize
(10, 
checkpoštEÁryTy³_
);

1946 ià(((
	gb™F›ld0_
 & 0x00000020) == 0x00000020)) {

1947 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1948 .
compu‹IÁ64Size
(11, 
checkpoštIdMo¡SignifiÿÁ_
);

1950 ià(((
	gb™F›ld0_
 & 0x00000040) == 0x00000040)) {

1951 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1952 .
compu‹IÁ64Size
(12, 
checkpoštIdL—¡SignifiÿÁ_
);

1954 ià(((
	gb™F›ld0_
 & 0x00000080) == 0x00000080)) {

1955 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1956 .
compu‹IÁ64Size
(13, 
checkpoš‹dSŒ—mIdMo¡SignifiÿÁ_
);

1958 ià(((
	gb™F›ld0_
 & 0x00000100) == 0x00000100)) {

1959 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1960 .
compu‹IÁ64Size
(14, 
checkpoš‹dSŒ—mIdL—¡SignifiÿÁ_
);

1962 ià(((
	gb™F›ld0_
 & 0x00000200) == 0x00000200)) {

1963 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1964 .
compu‹IÁ64Size
(15, 
checkpoš‹dSŒ—mS¹LogAdd»ss_
);

1966 ià(((
	gb™F›ld0_
 & 0x00000400) == 0x00000400)) {

1967 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1968 .
compu‹IÁ64Size
(16, 
ş›ÁIdL—¡SignifiÿÁ_
);

1970 ià(((
	gb™F›ld0_
 & 0x00000800) == 0x00000800)) {

1971 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1972 .
compu‹IÁ64Size
(17, 
ş›ÁIdMo¡SignifiÿÁ_
);

1974 ià(((
	gb™F›ld0_
 & 0x00001000) == 0x00001000)) {

1975 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1976 .
compu‹IÁ64Size
(18, 
th»adId_
);

1978 ià(((
	gb™F›ld0_
 & 0x00002000) == 0x00002000)) {

1979 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1980 .
compu‹IÁ32Size
(19, 
codecTy³_
);

1982 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

1983 
	gmemoizedSize
 = 
size
;

1984  
	gsize
;

1987 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

1988 @
	gjava
.
	gÏng
.
Ov”ride


1989 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

1990 ià(
	gobj
 =ğ
this
) {

1991  
Œue
;

1993 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogEÁry
)) {

1994  
	gsu³r
.
equ®s
(
obj
);

1996 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
	gÙh”
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.LogEÁryè
obj
;

1998 
boŞ—n
 
	g»suÉ
 = 
Œue
;

1999 
	g»suÉ
 = 
»suÉ
 && (
hasD©aTy³
(è=ğ
Ùh”
.hasDataType());

2000 ià(
hasD©aTy³
()) {

2001 
	g»suÉ
 = 
»suÉ
 && 
d©aTy³_
 =ğ
Ùh”
.dataType_;

2003 
	g»suÉ
 = 
»suÉ
 && (
hasD©a
(è=ğ
Ùh”
.hasData());

2004 ià(
hasD©a
()) {

2005 
	g»suÉ
 = 
»suÉ
 && 
g‘D©a
()

2006 .
equ®s
(
Ùh”
.
g‘D©a
());

2008 
	g»suÉ
 = 
»suÉ
 && (
hasGlob®Add»ss
(è=ğ
Ùh”
.hasGlobalAddress());

2009 ià(
hasGlob®Add»ss
()) {

2010 
	g»suÉ
 = 
»suÉ
 && (
g‘Glob®Add»ss
()

2011 =ğ
Ùh”
.
g‘Glob®Add»ss
());

2013 
	g»suÉ
 = 
»suÉ
 && 
g‘SŒ—msLi¡
()

2014 .
equ®s
(
Ùh”
.
g‘SŒ—msLi¡
());

2015 
	g»suÉ
 = 
»suÉ
 && 
š‹º®G‘LogiÿlAdd»s£s
().
equ®s
(

2016 
Ùh”
.
š‹º®G‘LogiÿlAdd»s£s
());

2017 
	g»suÉ
 = 
»suÉ
 && 
š‹º®G‘Backpoš‹rs
().
equ®s
(

2018 
Ùh”
.
š‹º®G‘Backpoš‹rs
());

2019 
	g»suÉ
 = 
»suÉ
 && (
hasRªk
(è=ğ
Ùh”
.hasRank());

2020 ià(
hasRªk
()) {

2021 
	g»suÉ
 = 
»suÉ
 && 
g‘Rªk
()

2022 .
equ®s
(
Ùh”
.
g‘Rªk
());

2024 
	g»suÉ
 = 
»suÉ
 && (
hasCheckpoštEÁryTy³
(è=ğ
Ùh”
.hasCheckpointEntryType());

2025 ià(
hasCheckpoštEÁryTy³
()) {

2026 
	g»suÉ
 = 
»suÉ
 && 
checkpoštEÁryTy³_
 =ğ
Ùh”
.checkpointEntryType_;

2028 
	g»suÉ
 = 
»suÉ
 && (
hasCheckpoštIdMo¡SignifiÿÁ
(è=ğ
Ùh”
.hasCheckpointIdMostSignificant());

2029 ià(
hasCheckpoštIdMo¡SignifiÿÁ
()) {

2030 
	g»suÉ
 = 
»suÉ
 && (
g‘CheckpoštIdMo¡SignifiÿÁ
()

2031 =ğ
Ùh”
.
g‘CheckpoštIdMo¡SignifiÿÁ
());

2033 
	g»suÉ
 = 
»suÉ
 && (
hasCheckpoštIdL—¡SignifiÿÁ
(è=ğ
Ùh”
.hasCheckpointIdLeastSignificant());

2034 ià(
hasCheckpoštIdL—¡SignifiÿÁ
()) {

2035 
	g»suÉ
 = 
»suÉ
 && (
g‘CheckpoštIdL—¡SignifiÿÁ
()

2036 =ğ
Ùh”
.
g‘CheckpoštIdL—¡SignifiÿÁ
());

2038 
	g»suÉ
 = 
»suÉ
 && (
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
(è=ğ
Ùh”
.hasCheckpointedStreamIdMostSignificant());

2039 ià(
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
()) {

2040 
	g»suÉ
 = 
»suÉ
 && (
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
()

2041 =ğ
Ùh”
.
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
());

2043 
	g»suÉ
 = 
»suÉ
 && (
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
(è=ğ
Ùh”
.hasCheckpointedStreamIdLeastSignificant());

2044 ià(
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
()) {

2045 
	g»suÉ
 = 
»suÉ
 && (
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
()

2046 =ğ
Ùh”
.
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
());

2048 
	g»suÉ
 = 
»suÉ
 && (
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
(è=ğ
Ùh”
.hasCheckpointedStreamStartLogAddress());

2049 ià(
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
()) {

2050 
	g»suÉ
 = 
»suÉ
 && (
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
()

2051 =ğ
Ùh”
.
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
());

2053 
	g»suÉ
 = 
»suÉ
 && (
hasCl›ÁIdL—¡SignifiÿÁ
(è=ğ
Ùh”
.hasClientIdLeastSignificant());

2054 ià(
hasCl›ÁIdL—¡SignifiÿÁ
()) {

2055 
	g»suÉ
 = 
»suÉ
 && (
g‘Cl›ÁIdL—¡SignifiÿÁ
()

2056 =ğ
Ùh”
.
g‘Cl›ÁIdL—¡SignifiÿÁ
());

2058 
	g»suÉ
 = 
»suÉ
 && (
hasCl›ÁIdMo¡SignifiÿÁ
(è=ğ
Ùh”
.hasClientIdMostSignificant());

2059 ià(
hasCl›ÁIdMo¡SignifiÿÁ
()) {

2060 
	g»suÉ
 = 
»suÉ
 && (
g‘Cl›ÁIdMo¡SignifiÿÁ
()

2061 =ğ
Ùh”
.
g‘Cl›ÁIdMo¡SignifiÿÁ
());

2063 
	g»suÉ
 = 
»suÉ
 && (
hasTh»adId
(è=ğ
Ùh”
.hasThreadId());

2064 ià(
hasTh»adId
()) {

2065 
	g»suÉ
 = 
»suÉ
 && (
g‘Th»adId
()

2066 =ğ
Ùh”
.
g‘Th»adId
());

2068 
	g»suÉ
 = 
»suÉ
 && (
hasCodecTy³
(è=ğ
Ùh”
.hasCodecType());

2069 ià(
hasCodecTy³
()) {

2070 
	g»suÉ
 = 
»suÉ
 && (
g‘CodecTy³
()

2071 =ğ
Ùh”
.
g‘CodecTy³
());

2073 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

2074  
	g»suÉ
;

2077 @
	gjava
.
	gÏng
.
Ov”ride


2078 
public
 
hashCode
() {

2079 ià(
	gmemoizedHashCode
 != 0) {

2080  
memoizedHashCode
;

2082 
	ghash
 = 41;

2083 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

2084 ià(
hasD©aTy³
()) {

2085 
	ghash
 = (37 * 
hash
è+ 
DATA_TYPE_FIELD_NUMBER
;

2086 
	ghash
 = (53 * 
hash
è+ 
d©aTy³_
;

2088 ià(
hasD©a
()) {

2089 
	ghash
 = (37 * 
hash
è+ 
DATA_FIELD_NUMBER
;

2090 
	ghash
 = (53 * 
hash
è+ 
g‘D©a
().
hashCode
();

2092 ià(
hasGlob®Add»ss
()) {

2093 
	ghash
 = (37 * 
hash
è+ 
GLOBAL_ADDRESS_FIELD_NUMBER
;

2094 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2095 
g‘Glob®Add»ss
());

2097 ià(
g‘SŒ—msCouÁ
() > 0) {

2098 
	ghash
 = (37 * 
hash
è+ 
STREAMS_FIELD_NUMBER
;

2099 
	ghash
 = (53 * 
hash
è+ 
g‘SŒ—msLi¡
().
hashCode
();

2101 ià(!
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
().
isEm±y
()) {

2102 
	ghash
 = (37 * 
hash
è+ 
LOGICAL_ADDRESSES_FIELD_NUMBER
;

2103 
	ghash
 = (53 * 
hash
è+ 
š‹º®G‘LogiÿlAdd»s£s
().
hashCode
();

2105 ià(!
š‹º®G‘Backpoš‹rs
().
g‘M­
().
isEm±y
()) {

2106 
	ghash
 = (37 * 
hash
è+ 
BACKPOINTERS_FIELD_NUMBER
;

2107 
	ghash
 = (53 * 
hash
è+ 
š‹º®G‘Backpoš‹rs
().
hashCode
();

2109 ià(
hasRªk
()) {

2110 
	ghash
 = (37 * 
hash
è+ 
RANK_FIELD_NUMBER
;

2111 
	ghash
 = (53 * 
hash
è+ 
g‘Rªk
().
hashCode
();

2113 ià(
hasCheckpoštEÁryTy³
()) {

2114 
	ghash
 = (37 * 
hash
è+ 
CHECKPOINTENTRYTYPE_FIELD_NUMBER
;

2115 
	ghash
 = (53 * 
hash
è+ 
checkpoštEÁryTy³_
;

2117 ià(
hasCheckpoštIdMo¡SignifiÿÁ
()) {

2118 
	ghash
 = (37 * 
hash
è+ 
CHECKPOINTID_MOST_SIGNIFICANT_FIELD_NUMBER
;

2119 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2120 
g‘CheckpoštIdMo¡SignifiÿÁ
());

2122 ià(
hasCheckpoštIdL—¡SignifiÿÁ
()) {

2123 
	ghash
 = (37 * 
hash
è+ 
CHECKPOINTID_LEAST_SIGNIFICANT_FIELD_NUMBER
;

2124 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2125 
g‘CheckpoštIdL—¡SignifiÿÁ
());

2127 ià(
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
()) {

2128 
	ghash
 = (37 * 
hash
è+ 
CHECKPOINTEDSTREAMID_MOST_SIGNIFICANT_FIELD_NUMBER
;

2129 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2130 
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
());

2132 ià(
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
()) {

2133 
	ghash
 = (37 * 
hash
è+ 
CHECKPOINTEDSTREAMID_LEAST_SIGNIFICANT_FIELD_NUMBER
;

2134 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2135 
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
());

2137 ià(
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
()) {

2138 
	ghash
 = (37 * 
hash
è+ 
CHECKPOINTEDSTREAMSTARTLOGADDRESS_FIELD_NUMBER
;

2139 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2140 
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
());

2142 ià(
hasCl›ÁIdL—¡SignifiÿÁ
()) {

2143 
	ghash
 = (37 * 
hash
è+ 
CLIENTID_LEAST_SIGNIFICANT_FIELD_NUMBER
;

2144 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2145 
g‘Cl›ÁIdL—¡SignifiÿÁ
());

2147 ià(
hasCl›ÁIdMo¡SignifiÿÁ
()) {

2148 
	ghash
 = (37 * 
hash
è+ 
CLIENTID_MOST_SIGNIFICANT_FIELD_NUMBER
;

2149 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2150 
g‘Cl›ÁIdMo¡SignifiÿÁ
());

2152 ià(
hasTh»adId
()) {

2153 
	ghash
 = (37 * 
hash
è+ 
THREADID_FIELD_NUMBER
;

2154 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2155 
g‘Th»adId
());

2157 ià(
hasCodecTy³
()) {

2158 
	ghash
 = (37 * 
hash
è+ 
CODECTYPE_FIELD_NUMBER
;

2159 
	ghash
 = (53 * 
hash
è+ 
g‘CodecTy³
();

2161 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

2162 
	gmemoizedHashCode
 = 
hash
;

2163  
	ghash
;

2166 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(

2167 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

2168 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2169  
	gPARSER
.
·r£From
(
d©a
);

2171 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(

2172 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

2173 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2174 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2175  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2177 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(
by‹
[] 
d©a
)

2178 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2179  
	gPARSER
.
·r£From
(
d©a
);

2181 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(

2182 
by‹
[] 
d©a
,

2183 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2184 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2185  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2187 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2188 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2189  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2190 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2192 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(

2193 
java
.
io
.
IÅutSŒ—m
 
šput
,

2194 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2195 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2196  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2197 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2199 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2200 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2201  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2202 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

2204 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£D–im™edFrom
(

2205 
java
.
io
.
IÅutSŒ—m
 
šput
,

2206 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2207 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2208  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2209 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2211 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(

2212 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2213 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2214  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2215 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2217 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
·r£From
(

2218 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2219 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2220 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2221  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2222 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2225 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2226 
public
 
Bud”
 
ÃwBud”
() {

2227  
	gDEFAULT_INSTANCE
.
toBud”
();

2229 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
 
´ÙÙy³
) {

2230  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2232 
public
 
Bud”
 
toBud”
() {

2233  
	gthis
 =ğ
DEFAULT_INSTANCE


2234 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2237 @
	gjava
.
	gÏng
.
Ov”ride


2238 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2239 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2240 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2241  
	gbud”
;

2246 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


2247 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


2249 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogEÁryOrBud”
 {

2250 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2251 
g‘DesütÜ
() {

2252  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogEÁry_desütÜ
;

2255 @
Suµ»ssW¬nšgs
({"rawtypes"})

2256 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘M­F›ld
(

2257 
numb”
) {

2258 
	gnumb”
) {

2260  
š‹º®G‘LogiÿlAdd»s£s
();

2262  
š‹º®G‘Backpoš‹rs
();

2264 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

2265 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

2268 @
Suµ»ssW¬nšgs
({"rawtypes"})

2269 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘MubËM­F›ld
(

2270 
numb”
) {

2271 
	gnumb”
) {

2273  
š‹º®G‘MubËLogiÿlAdd»s£s
();

2275  
š‹º®G‘MubËBackpoš‹rs
();

2277 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

2278 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

2281 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2282 
š‹º®G‘F›ldAcûssÜTabË
() {

2283  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogEÁry_f›ldAcûssÜTabË


2284 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2285 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
.
şass
, org.cÜfudb.fÜm©.Ty³s.LogEÁry.
Bud”
.class);

2289 
´iv©e
 
Bud”
() {

2290 
maybeFÜûBud”In™Ÿliz©iÚ
();

2293 
´iv©e
 
Bud”
(

2294 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2295 
su³r
(
·»Á
);

2296 
maybeFÜûBud”In™Ÿliz©iÚ
();

2298 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

2299 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2300 .
	g®waysU£F›ldBud”s
) {

2301 
g‘RªkF›ldBud”
();

2304 
public
 
Bud”
 
ş—r
() {

2305 
	gsu³r
.
ş—r
();

2306 
	gd©aTy³_
 = 0;

2307 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

2308 
	gd©a_
 = 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
EMPTY
;

2309 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

2310 
	gglob®Add»ss_
 = 0L;

2311 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2312 
	g¡»ams_
 = 
com
.
googË
.
´Ùobuf
.
LazySŒšgA¼ayLi¡
.
EMPTY
;

2313 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

2314 
š‹º®G‘MubËLogiÿlAdd»s£s
().
ş—r
();

2315 
š‹º®G‘MubËBackpoš‹rs
().
ş—r
();

2316 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

2317 
¿nk_
 = 
nuÎ
;

2319 
	g¿nkBud”_
.
ş—r
();

2321 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000040);

2322 
	gcheckpoštEÁryTy³_
 = 0;

2323 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000080);

2324 
	gcheckpoštIdMo¡SignifiÿÁ_
 = 0L;

2325 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000100);

2326 
	gcheckpoštIdL—¡SignifiÿÁ_
 = 0L;

2327 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000200);

2328 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 = 0L;

2329 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000400);

2330 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 = 0L;

2331 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000800);

2332 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 = 0L;

2333 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00001000);

2334 
	gş›ÁIdL—¡SignifiÿÁ_
 = 0L;

2335 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00002000);

2336 
	gş›ÁIdMo¡SignifiÿÁ_
 = 0L;

2337 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00004000);

2338 
	gth»adId_
 = 0L;

2339 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00008000);

2340 
	gcodecTy³_
 = 0;

2341 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00010000);

2342  
	gthis
;

2345 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2346 
g‘DesütÜFÜTy³
() {

2347  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogEÁry_desütÜ
;

2350 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2351  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogEÁry
.
g‘DeçuÉIn¡ªû
();

2354 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
bud
() {

2355 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
	g»suÉ
 = 
budP¬tŸl
();

2356 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

2357 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

2359  
	g»suÉ
;

2362 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
budP¬tŸl
() {

2363 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.LogEÁry(
this
);

2364 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

2365 
	gto_b™F›ld0_
 = 0;

2366 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

2367 
to_b™F›ld0_
 |= 0x00000001;

2369 
	g»suÉ
.
	gd©aTy³_
 = 
d©aTy³_
;

2370 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

2371 
to_b™F›ld0_
 |= 0x00000002;

2373 
	g»suÉ
.
	gd©a_
 = 
d©a_
;

2374 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

2375 
to_b™F›ld0_
 |= 0x00000004;

2377 
	g»suÉ
.
	gglob®Add»ss_
 = 
glob®Add»ss_
;

2378 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

2379 
¡»ams_
 = sŒ—ms_.
g‘UnmodifŸbËV›w
();

2380 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

2382 
	g»suÉ
.
	g¡»ams_
 = 
¡»ams_
;

2383 
	g»suÉ
.
	glogiÿlAdd»s£s_
 = 
š‹º®G‘LogiÿlAdd»s£s
();

2384 
	g»suÉ
.
	glogiÿlAdd»s£s_
.
makeImmubË
();

2385 
	g»suÉ
.
	gbackpoš‹rs_
 = 
š‹º®G‘Backpoš‹rs
();

2386 
	g»suÉ
.
	gbackpoš‹rs_
.
makeImmubË
();

2387 ià(((
	gäom_b™F›ld0_
 & 0x00000040) == 0x00000040)) {

2388 
to_b™F›ld0_
 |= 0x00000008;

2390 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

2391 
»suÉ
.
¿nk_
 =„ank_;

2393 
	g»suÉ
.
	g¿nk_
 = 
¿nkBud”_
.
bud
();

2395 ià(((
	gäom_b™F›ld0_
 & 0x00000080) == 0x00000080)) {

2396 
to_b™F›ld0_
 |= 0x00000010;

2398 
	g»suÉ
.
	gcheckpoštEÁryTy³_
 = 
checkpoštEÁryTy³_
;

2399 ià(((
	gäom_b™F›ld0_
 & 0x00000100) == 0x00000100)) {

2400 
to_b™F›ld0_
 |= 0x00000020;

2402 
	g»suÉ
.
	gcheckpoštIdMo¡SignifiÿÁ_
 = 
checkpoštIdMo¡SignifiÿÁ_
;

2403 ià(((
	gäom_b™F›ld0_
 & 0x00000200) == 0x00000200)) {

2404 
to_b™F›ld0_
 |= 0x00000040;

2406 
	g»suÉ
.
	gcheckpoštIdL—¡SignifiÿÁ_
 = 
checkpoštIdL—¡SignifiÿÁ_
;

2407 ià(((
	gäom_b™F›ld0_
 & 0x00000400) == 0x00000400)) {

2408 
to_b™F›ld0_
 |= 0x00000080;

2410 
	g»suÉ
.
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 = 
checkpoš‹dSŒ—mIdMo¡SignifiÿÁ_
;

2411 ià(((
	gäom_b™F›ld0_
 & 0x00000800) == 0x00000800)) {

2412 
to_b™F›ld0_
 |= 0x00000100;

2414 
	g»suÉ
.
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 = 
checkpoš‹dSŒ—mIdL—¡SignifiÿÁ_
;

2415 ià(((
	gäom_b™F›ld0_
 & 0x00001000) == 0x00001000)) {

2416 
to_b™F›ld0_
 |= 0x00000200;

2418 
	g»suÉ
.
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 = 
checkpoš‹dSŒ—mS¹LogAdd»ss_
;

2419 ià(((
	gäom_b™F›ld0_
 & 0x00002000) == 0x00002000)) {

2420 
to_b™F›ld0_
 |= 0x00000400;

2422 
	g»suÉ
.
	gş›ÁIdL—¡SignifiÿÁ_
 = 
ş›ÁIdL—¡SignifiÿÁ_
;

2423 ià(((
	gäom_b™F›ld0_
 & 0x00004000) == 0x00004000)) {

2424 
to_b™F›ld0_
 |= 0x00000800;

2426 
	g»suÉ
.
	gş›ÁIdMo¡SignifiÿÁ_
 = 
ş›ÁIdMo¡SignifiÿÁ_
;

2427 ià(((
	gäom_b™F›ld0_
 & 0x00008000) == 0x00008000)) {

2428 
to_b™F›ld0_
 |= 0x00001000;

2430 
	g»suÉ
.
	gth»adId_
 = 
th»adId_
;

2431 ià(((
	gäom_b™F›ld0_
 & 0x00010000) == 0x00010000)) {

2432 
to_b™F›ld0_
 |= 0x00002000;

2434 
	g»suÉ
.
	gcodecTy³_
 = 
codecTy³_
;

2435 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

2436 
ÚBut
();

2437  
	g»suÉ
;

2440 
public
 
Bud”
 
şÚe
() {

2441  (
	gBud”
è
	gsu³r
.
şÚe
();

2443 
public
 
Bud”
 
£tF›ld
(

2444 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2445 
Objeù
 
v®ue
) {

2446  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

2448 
public
 
Bud”
 
ş—rF›ld
(

2449 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

2450  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

2452 
public
 
Bud”
 
ş—rOÃof
(

2453 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

2454  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

2456 
public
 
Bud”
 
£tR•—‹dF›ld
(

2457 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2458 
šdex
, 
Objeù
 
v®ue
) {

2459  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

2461 
public
 
Bud”
 
addR•—‹dF›ld
(

2462 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2463 
Objeù
 
v®ue
) {

2464  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

2466 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

2467 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogEÁry
) {

2468  
m”geFrom
((
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
)
Ùh”
);

2470 
	gsu³r
.
m”geFrom
(
Ùh”
);

2471  
	gthis
;

2475 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
 
Ùh”
) {

2476 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
.
g‘DeçuÉIn¡ªû
()è 
this
;

2477 ià(
	gÙh”
.
hasD©aTy³
()) {

2478 
£tD©aTy³
(
Ùh”
.
g‘D©aTy³
());

2480 ià(
	gÙh”
.
hasD©a
()) {

2481 
£tD©a
(
Ùh”
.
g‘D©a
());

2483 ià(
	gÙh”
.
hasGlob®Add»ss
()) {

2484 
£tGlob®Add»ss
(
Ùh”
.
g‘Glob®Add»ss
());

2486 ià(!
	gÙh”
.
	g¡»ams_
.
isEm±y
()) {

2487 ià(
	g¡»ams_
.
isEm±y
()) {

2488 
	g¡»ams_
 = 
Ùh”
.
¡»ams_
;

2489 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

2491 
’su»SŒ—msIsMubË
();

2492 
	g¡»ams_
.
addAÎ
(
Ùh”
.
¡»ams_
);

2494 
ÚChªged
();

2496 
š‹º®G‘MubËLogiÿlAdd»s£s
().
m”geFrom
(

2497 
Ùh”
.
š‹º®G‘LogiÿlAdd»s£s
());

2498 
š‹º®G‘MubËBackpoš‹rs
().
m”geFrom
(

2499 
Ùh”
.
š‹º®G‘Backpoš‹rs
());

2500 ià(
	gÙh”
.
hasRªk
()) {

2501 
m”geRªk
(
Ùh”
.
g‘Rªk
());

2503 ià(
	gÙh”
.
hasCheckpoštEÁryTy³
()) {

2504 
£tCheckpoštEÁryTy³
(
Ùh”
.
g‘CheckpoštEÁryTy³
());

2506 ià(
	gÙh”
.
hasCheckpoštIdMo¡SignifiÿÁ
()) {

2507 
£tCheckpoštIdMo¡SignifiÿÁ
(
Ùh”
.
g‘CheckpoštIdMo¡SignifiÿÁ
());

2509 ià(
	gÙh”
.
hasCheckpoštIdL—¡SignifiÿÁ
()) {

2510 
£tCheckpoštIdL—¡SignifiÿÁ
(
Ùh”
.
g‘CheckpoštIdL—¡SignifiÿÁ
());

2512 ià(
	gÙh”
.
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
()) {

2513 
£tCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
(
Ùh”
.
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
());

2515 ià(
	gÙh”
.
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
()) {

2516 
£tCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
(
Ùh”
.
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
());

2518 ià(
	gÙh”
.
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
()) {

2519 
£tCheckpoš‹dSŒ—mS¹LogAdd»ss
(
Ùh”
.
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
());

2521 ià(
	gÙh”
.
hasCl›ÁIdL—¡SignifiÿÁ
()) {

2522 
£tCl›ÁIdL—¡SignifiÿÁ
(
Ùh”
.
g‘Cl›ÁIdL—¡SignifiÿÁ
());

2524 ià(
	gÙh”
.
hasCl›ÁIdMo¡SignifiÿÁ
()) {

2525 
£tCl›ÁIdMo¡SignifiÿÁ
(
Ùh”
.
g‘Cl›ÁIdMo¡SignifiÿÁ
());

2527 ià(
	gÙh”
.
hasTh»adId
()) {

2528 
£tTh»adId
(
Ùh”
.
g‘Th»adId
());

2530 ià(
	gÙh”
.
hasCodecTy³
()) {

2531 
£tCodecTy³
(
Ùh”
.
g‘CodecTy³
());

2533 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

2534 
ÚChªged
();

2535  
	gthis
;

2538 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2539 ià(
hasRªk
()) {

2540 ià(!
g‘Rªk
().
isIn™Ÿlized
()) {

2541  
	gçl£
;

2544  
	gŒue
;

2547 
public
 
Bud”
 
m”geFrom
(

2548 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2549 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2550 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2551 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
	g·r£dMes§ge
 = 
nuÎ
;

2552 
	gŒy
 {

2553 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

2554 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2555 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
è
e
.
g‘UnfšishedMes§ge
();

2556 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

2557 } 
	gfš®ly
 {

2558 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

2559 
m”geFrom
(
·r£dMes§ge
);

2562  
	gthis
;

2564 
´iv©e
 
	gb™F›ld0_
;

2566 
´iv©e
 
	gd©aTy³_
 = 0;

2570 
public
 
boŞ—n
 
hasD©aTy³
() {

2571  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

2576 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aTy³
 
g‘D©aTy³
() {

2577 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aTy³
 
	g»suÉ
 = 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.D©aTy³.
v®ueOf
(
d©aTy³_
);

2578  
	g»suÉ
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aTy³
.
DATA
 : 
»suÉ
;

2583 
public
 
Bud”
 
£tD©aTy³
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aTy³
 
v®ue
) {

2584 ià(
	gv®ue
 =ğ
nuÎ
) {

2585 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2587 
	gb™F›ld0_
 |= 0x00000001;

2588 
	gd©aTy³_
 = 
v®ue
.
g‘Numb”
();

2589 
ÚChªged
();

2590  
	gthis
;

2595 
public
 
Bud”
 
ş—rD©aTy³
() {

2596 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

2597 
	gd©aTy³_
 = 0;

2598 
ÚChªged
();

2599  
	gthis
;

2602 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gd©a_
 = 
com
.
googË
.
´Ùobuf
.By‹SŒšg.
EMPTY
;

2606 
public
 
boŞ—n
 
hasD©a
() {

2607  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

2612 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
g‘D©a
() {

2613  
	gd©a_
;

2618 
public
 
Bud”
 
£tD©a
(
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2619 ià(
	gv®ue
 =ğ
nuÎ
) {

2620 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2622 
	gb™F›ld0_
 |= 0x00000002;

2623 
	gd©a_
 = 
v®ue
;

2624 
ÚChªged
();

2625  
	gthis
;

2630 
public
 
Bud”
 
ş—rD©a
() {

2631 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

2632 
	gd©a_
 = 
g‘DeçuÉIn¡ªû
().
g‘D©a
();

2633 
ÚChªged
();

2634  
	gthis
;

2637 
´iv©e
 
	gglob®Add»ss_
 ;

2641 
public
 
boŞ—n
 
hasGlob®Add»ss
() {

2642  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

2647 
public
 
g‘Glob®Add»ss
() {

2648  
	gglob®Add»ss_
;

2653 
public
 
Bud”
 
£tGlob®Add»ss
(
v®ue
) {

2654 
	gb™F›ld0_
 |= 0x00000004;

2655 
	gglob®Add»ss_
 = 
v®ue
;

2656 
ÚChªged
();

2657  
	gthis
;

2662 
public
 
Bud”
 
ş—rGlob®Add»ss
() {

2663 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2664 
	gglob®Add»ss_
 = 0L;

2665 
ÚChªged
();

2666  
	gthis
;

2669 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
LazySŒšgLi¡
 
	g¡»ams_
 = 
com
.
googË
.
´Ùobuf
.
LazySŒšgA¼ayLi¡
.
EMPTY
;

2670 
´iv©e
 
’su»SŒ—msIsMubË
() {

2671 ià(!((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

2672 
¡»ams_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
LazySŒšgA¼ayLi¡
(streams_);

2673 
	gb™F›ld0_
 |= 0x00000008;

2679 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
PrÙocŞSŒšgLi¡


2680 
g‘SŒ—msLi¡
() {

2681  
	g¡»ams_
.
g‘UnmodifŸbËV›w
();

2686 
public
 
g‘SŒ—msCouÁ
() {

2687  
	g¡»ams_
.
size
();

2692 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘SŒ—ms
(
šdex
) {

2693  
	g¡»ams_
.
g‘
(
šdex
);

2698 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2699 
g‘SŒ—msBy‹s
(
šdex
) {

2700  
	g¡»ams_
.
g‘By‹SŒšg
(
šdex
);

2705 
public
 
Bud”
 
£tSŒ—ms
(

2706 
šdex
, 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2707 ià(
	gv®ue
 =ğ
nuÎ
) {

2708 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2710 
’su»SŒ—msIsMubË
();

2711 
	g¡»ams_
.
£t
(
šdex
, 
v®ue
);

2712 
ÚChªged
();

2713  
	gthis
;

2718 
public
 
Bud”
 
addSŒ—ms
(

2719 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2720 ià(
	gv®ue
 =ğ
nuÎ
) {

2721 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2723 
’su»SŒ—msIsMubË
();

2724 
	g¡»ams_
.
add
(
v®ue
);

2725 
ÚChªged
();

2726  
	gthis
;

2731 
public
 
Bud”
 
addAÎSŒ—ms
(

2732 
java
.
Ïng
.
I‹¿bË
<java.Ïng.
SŒšg
> 
v®ues
) {

2733 
’su»SŒ—msIsMubË
();

2734 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAb¡¿ùMes§geL™e
.
	gBud”
.
addAÎ
(

2735 
v®ues
, 
¡»ams_
);

2736 
ÚChªged
();

2737  
	gthis
;

2742 
public
 
Bud”
 
ş—rSŒ—ms
() {

2743 
	g¡»ams_
 = 
com
.
googË
.
´Ùobuf
.
LazySŒšgA¼ayLi¡
.
EMPTY
;

2744 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

2745 
ÚChªged
();

2746  
	gthis
;

2751 
public
 
Bud”
 
addSŒ—msBy‹s
(

2752 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2753 ià(
	gv®ue
 =ğ
nuÎ
) {

2754 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2756 
’su»SŒ—msIsMubË
();

2757 
	g¡»ams_
.
add
(
v®ue
);

2758 
ÚChªged
();

2759  
	gthis
;

2762 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

2763 
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	glogiÿlAdd»s£s_
;

2764 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

2765 
š‹º®G‘LogiÿlAdd»s£s
() {

2766 ià(
	glogiÿlAdd»s£s_
 =ğ
nuÎ
) {

2767  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

2768 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

2770  
	glogiÿlAdd»s£s_
;

2772 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

2773 
š‹º®G‘MubËLogiÿlAdd»s£s
() {

2774 
ÚChªged
();;

2775 ià(
	glogiÿlAdd»s£s_
 =ğ
nuÎ
) {

2776 
logiÿlAdd»s£s_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

2777 
LogiÿlAdd»s£sDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

2779 ià(!
	glogiÿlAdd»s£s_
.
isMubË
()) {

2780 
	glogiÿlAdd»s£s_
 = 
logiÿlAdd»s£s_
.
cİy
();

2782  
	glogiÿlAdd»s£s_
;

2785 
public
 
g‘LogiÿlAdd»s£sCouÁ
() {

2786  
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
().
size
();

2792 
public
 
boŞ—n
 
cÚšsLogiÿlAdd»s£s
(

2793 
java
.
Ïng
.
SŒšg
 
key
) {

2794 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2795  
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
().
cÚšsKey
(
key
);

2800 @
	gjava
.
	gÏng
.
D•»ÿ‹d


2801 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘LogiÿlAdd»s£s
() {

2802  
g‘LogiÿlAdd»s£sM­
();

2808 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘LogiÿlAdd»s£sM­
() {

2809  
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
();

2815 
public
 
g‘LogiÿlAdd»s£sOrDeçuÉ
(

2816 
java
.
Ïng
.
SŒšg
 
key
,

2817 
deçuÉV®ue
) {

2818 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2819 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

2820 
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
();

2821  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

2827 
public
 
g‘LogiÿlAdd»s£sOrThrow
(

2828 
java
.
Ïng
.
SŒšg
 
key
) {

2829 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2830 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

2831 
š‹º®G‘LogiÿlAdd»s£s
().
g‘M­
();

2832 ià(!
	gm­
.
cÚšsKey
(
key
)) {

2833 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

2835  
	gm­
.
g‘
(
key
);

2838 
public
 
Bud”
 
ş—rLogiÿlAdd»s£s
() {

2839 
g‘MubËLogiÿlAdd»s£s
().
ş—r
();

2840  
	gthis
;

2846 
public
 
Bud”
 
»moveLogiÿlAdd»s£s
(

2847 
java
.
Ïng
.
SŒšg
 
key
) {

2848 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2849 
g‘MubËLogiÿlAdd»s£s
().
»move
(
key
);

2850  
	gthis
;

2855 @
	gjava
.
	gÏng
.
D•»ÿ‹d


2856 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

2857 
g‘MubËLogiÿlAdd»s£s
() {

2858  
š‹º®G‘MubËLogiÿlAdd»s£s
().
g‘MubËM­
();

2863 
public
 
Bud”
 
putLogiÿlAdd»s£s
(

2864 
java
.
Ïng
.
SŒšg
 
key
,

2865 
v®ue
) {

2866 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2868 
g‘MubËLogiÿlAdd»s£s
().
put
(
key
, 
v®ue
);

2869  
	gthis
;

2875 
public
 
Bud”
 
putAÎLogiÿlAdd»s£s
(

2876 
java
.
ut
.
M­
<java.
Ïng
.
SŒšg
, java.Ïng.
LÚg
> 
v®ues
) {

2877 
g‘MubËLogiÿlAdd»s£s
().
putAÎ
(
v®ues
);

2878  
	gthis
;

2881 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

2882 
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gbackpoš‹rs_
;

2883 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

2884 
š‹º®G‘Backpoš‹rs
() {

2885 ià(
	gbackpoš‹rs_
 =ğ
nuÎ
) {

2886  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

2887 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

2889  
	gbackpoš‹rs_
;

2891 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

2892 
š‹º®G‘MubËBackpoš‹rs
() {

2893 
ÚChªged
();;

2894 ià(
	gbackpoš‹rs_
 =ğ
nuÎ
) {

2895 
backpoš‹rs_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

2896 
Backpoš‹rsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

2898 ià(!
	gbackpoš‹rs_
.
isMubË
()) {

2899 
	gbackpoš‹rs_
 = 
backpoš‹rs_
.
cİy
();

2901  
	gbackpoš‹rs_
;

2904 
public
 
g‘Backpoš‹rsCouÁ
() {

2905  
š‹º®G‘Backpoš‹rs
().
g‘M­
().
size
();

2911 
public
 
boŞ—n
 
cÚšsBackpoš‹rs
(

2912 
java
.
Ïng
.
SŒšg
 
key
) {

2913 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2914  
š‹º®G‘Backpoš‹rs
().
g‘M­
().
cÚšsKey
(
key
);

2919 @
	gjava
.
	gÏng
.
D•»ÿ‹d


2920 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘Backpoš‹rs
() {

2921  
g‘Backpoš‹rsM­
();

2927 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
g‘Backpoš‹rsM­
() {

2928  
š‹º®G‘Backpoš‹rs
().
g‘M­
();

2934 
public
 
g‘Backpoš‹rsOrDeçuÉ
(

2935 
java
.
Ïng
.
SŒšg
 
key
,

2936 
deçuÉV®ue
) {

2937 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2938 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

2939 
š‹º®G‘Backpoš‹rs
().
g‘M­
();

2940  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

2946 
public
 
g‘Backpoš‹rsOrThrow
(

2947 
java
.
Ïng
.
SŒšg
 
key
) {

2948 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2949 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
> 
	gm­
 =

2950 
š‹º®G‘Backpoš‹rs
().
g‘M­
();

2951 ià(!
	gm­
.
cÚšsKey
(
key
)) {

2952 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

2954  
	gm­
.
g‘
(
key
);

2957 
public
 
Bud”
 
ş—rBackpoš‹rs
() {

2958 
g‘MubËBackpoš‹rs
().
ş—r
();

2959  
	gthis
;

2965 
public
 
Bud”
 
»moveBackpoš‹rs
(

2966 
java
.
Ïng
.
SŒšg
 
key
) {

2967 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2968 
g‘MubËBackpoš‹rs
().
»move
(
key
);

2969  
	gthis
;

2974 @
	gjava
.
	gÏng
.
D•»ÿ‹d


2975 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, java.Ïng.
	gLÚg
>

2976 
g‘MubËBackpoš‹rs
() {

2977  
š‹º®G‘MubËBackpoš‹rs
().
g‘MubËM­
();

2982 
public
 
Bud”
 
putBackpoš‹rs
(

2983 
java
.
Ïng
.
SŒšg
 
key
,

2984 
v®ue
) {

2985 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

2987 
g‘MubËBackpoš‹rs
().
put
(
key
, 
v®ue
);

2988  
	gthis
;

2994 
public
 
Bud”
 
putAÎBackpoš‹rs
(

2995 
java
.
ut
.
M­
<java.
Ïng
.
SŒšg
, java.Ïng.
LÚg
> 
v®ues
) {

2996 
g‘MubËBackpoš‹rs
().
putAÎ
(
v®ues
);

2997  
	gthis
;

3000 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
	g¿nk_
 = 
nuÎ
;

3001 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3002 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
, org.cÜfudb.fÜm©.Ty³s.D©aRªk.
	gBud”
, org.cÜfudb.fÜm©.Ty³s.
	gD©aRªkOrBud”
> 
	g¿nkBud”_
;

3006 
public
 
boŞ—n
 
hasRªk
() {

3007  ((
	gb™F›ld0_
 & 0x00000040) == 0x00000040);

3012 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªk
 
g‘Rªk
() {

3013 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

3014  
¿nk_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
g‘DeçuÉIn¡ªû
() :„ank_;

3016  
	g¿nkBud”_
.
g‘Mes§ge
();

3022 
public
 
Bud”
 
£tRªk
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
 
v®ue
) {

3023 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

3024 ià(
v®ue
 =ğ
nuÎ
) {

3025 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3027 
	g¿nk_
 = 
v®ue
;

3028 
ÚChªged
();

3030 
	g¿nkBud”_
.
£tMes§ge
(
v®ue
);

3032 
	gb™F›ld0_
 |= 0x00000040;

3033  
	gthis
;

3038 
public
 
Bud”
 
£tRªk
(

3039 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
Bud”
 
bud”FÜV®ue
) {

3040 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

3041 
¿nk_
 = 
bud”FÜV®ue
.
bud
();

3042 
ÚChªged
();

3044 
	g¿nkBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

3046 
	gb™F›ld0_
 |= 0x00000040;

3047  
	gthis
;

3052 
public
 
Bud”
 
m”geRªk
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
 
v®ue
) {

3053 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

3054 ià(((
b™F›ld0_
 & 0x00000040) == 0x00000040) &&

3055 
¿nk_
 !ğ
nuÎ
 &&

3056 
¿nk_
 !ğ
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
g‘DeçuÉIn¡ªû
()) {

3057 
¿nk_
 =

3058 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
ÃwBud”
(
¿nk_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

3060 
	g¿nk_
 = 
v®ue
;

3062 
ÚChªged
();

3064 
	g¿nkBud”_
.
m”geFrom
(
v®ue
);

3066 
	gb™F›ld0_
 |= 0x00000040;

3067  
	gthis
;

3072 
public
 
Bud”
 
ş—rRªk
() {

3073 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

3074 
¿nk_
 = 
nuÎ
;

3075 
ÚChªged
();

3077 
	g¿nkBud”_
.
ş—r
();

3079 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000040);

3080  
	gthis
;

3085 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
.
Bud”
 
g‘RªkBud”
() {

3086 
	gb™F›ld0_
 |= 0x00000040;

3087 
ÚChªged
();

3088  
g‘RªkF›ldBud”
().
g‘Bud”
();

3093 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
D©aRªkOrBud”
 
g‘RªkOrBud”
() {

3094 ià(
	g¿nkBud”_
 !ğ
nuÎ
) {

3095  
¿nkBud”_
.
g‘Mes§geOrBud”
();

3097  
	g¿nk_
 =ğ
nuÎ
 ?

3098 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
.
g‘DeçuÉIn¡ªû
(è: 
¿nk_
;

3104 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3105 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
, org.cÜfudb.fÜm©.Ty³s.D©aRªk.
	gBud”
, org.cÜfudb.fÜm©.Ty³s.
	gD©aRªkOrBud”
>

3106 
g‘RªkF›ldBud”
() {

3107 ià(
	g¿nkBud”_
 =ğ
nuÎ
) {

3108 
¿nkBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

3109 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
D©aRªk
, 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gD©aRªk
.
	gBud”
, org.cÜfudb.fÜm©.Ty³s.
	gD©aRªkOrBud”
>(

3110 
g‘Rªk
(),

3111 
g‘P¬’tFÜChd»n
(),

3112 
isCËª
());

3113 
	g¿nk_
 = 
nuÎ
;

3115  
	g¿nkBud”_
;

3118 
´iv©e
 
	gcheckpoštEÁryTy³_
 = 0;

3122 
public
 
boŞ—n
 
hasCheckpoštEÁryTy³
() {

3123  ((
	gb™F›ld0_
 & 0x00000080) == 0x00000080);

3128 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
CheckpoštEÁryTy³
 
g‘CheckpoštEÁryTy³
() {

3129 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
CheckpoštEÁryTy³
 
	g»suÉ
 = 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.CheckpoštEÁryTy³.
v®ueOf
(
checkpoštEÁryTy³_
);

3130  
	g»suÉ
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
CheckpoštEÁryTy³
.
START
 : 
»suÉ
;

3135 
public
 
Bud”
 
£tCheckpoštEÁryTy³
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
CheckpoštEÁryTy³
 
v®ue
) {

3136 ià(
	gv®ue
 =ğ
nuÎ
) {

3137 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3139 
	gb™F›ld0_
 |= 0x00000080;

3140 
	gcheckpoštEÁryTy³_
 = 
v®ue
.
g‘Numb”
();

3141 
ÚChªged
();

3142  
	gthis
;

3147 
public
 
Bud”
 
ş—rCheckpoštEÁryTy³
() {

3148 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000080);

3149 
	gcheckpoštEÁryTy³_
 = 0;

3150 
ÚChªged
();

3151  
	gthis
;

3154 
´iv©e
 
	gcheckpoštIdMo¡SignifiÿÁ_
 ;

3158 
public
 
boŞ—n
 
hasCheckpoštIdMo¡SignifiÿÁ
() {

3159  ((
	gb™F›ld0_
 & 0x00000100) == 0x00000100);

3164 
public
 
g‘CheckpoštIdMo¡SignifiÿÁ
() {

3165  
	gcheckpoštIdMo¡SignifiÿÁ_
;

3170 
public
 
Bud”
 
£tCheckpoštIdMo¡SignifiÿÁ
(
v®ue
) {

3171 
	gb™F›ld0_
 |= 0x00000100;

3172 
	gcheckpoštIdMo¡SignifiÿÁ_
 = 
v®ue
;

3173 
ÚChªged
();

3174  
	gthis
;

3179 
public
 
Bud”
 
ş—rCheckpoštIdMo¡SignifiÿÁ
() {

3180 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000100);

3181 
	gcheckpoštIdMo¡SignifiÿÁ_
 = 0L;

3182 
ÚChªged
();

3183  
	gthis
;

3186 
´iv©e
 
	gcheckpoštIdL—¡SignifiÿÁ_
 ;

3190 
public
 
boŞ—n
 
hasCheckpoštIdL—¡SignifiÿÁ
() {

3191  ((
	gb™F›ld0_
 & 0x00000200) == 0x00000200);

3196 
public
 
g‘CheckpoštIdL—¡SignifiÿÁ
() {

3197  
	gcheckpoštIdL—¡SignifiÿÁ_
;

3202 
public
 
Bud”
 
£tCheckpoštIdL—¡SignifiÿÁ
(
v®ue
) {

3203 
	gb™F›ld0_
 |= 0x00000200;

3204 
	gcheckpoštIdL—¡SignifiÿÁ_
 = 
v®ue
;

3205 
ÚChªged
();

3206  
	gthis
;

3211 
public
 
Bud”
 
ş—rCheckpoštIdL—¡SignifiÿÁ
() {

3212 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000200);

3213 
	gcheckpoštIdL—¡SignifiÿÁ_
 = 0L;

3214 
ÚChªged
();

3215  
	gthis
;

3218 
´iv©e
 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 ;

3222 
public
 
boŞ—n
 
hasCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
() {

3223  ((
	gb™F›ld0_
 & 0x00000400) == 0x00000400);

3228 
public
 
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
() {

3229  
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
;

3234 
public
 
Bud”
 
£tCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
(
v®ue
) {

3235 
	gb™F›ld0_
 |= 0x00000400;

3236 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 = 
v®ue
;

3237 
ÚChªged
();

3238  
	gthis
;

3243 
public
 
Bud”
 
ş—rCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
() {

3244 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000400);

3245 
	gcheckpoš‹dSŒ—mIdMo¡SignifiÿÁ_
 = 0L;

3246 
ÚChªged
();

3247  
	gthis
;

3250 
´iv©e
 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 ;

3254 
public
 
boŞ—n
 
hasCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
() {

3255  ((
	gb™F›ld0_
 & 0x00000800) == 0x00000800);

3260 
public
 
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
() {

3261  
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
;

3266 
public
 
Bud”
 
£tCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
(
v®ue
) {

3267 
	gb™F›ld0_
 |= 0x00000800;

3268 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 = 
v®ue
;

3269 
ÚChªged
();

3270  
	gthis
;

3275 
public
 
Bud”
 
ş—rCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
() {

3276 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000800);

3277 
	gcheckpoš‹dSŒ—mIdL—¡SignifiÿÁ_
 = 0L;

3278 
ÚChªged
();

3279  
	gthis
;

3282 
´iv©e
 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 ;

3290 
public
 
boŞ—n
 
hasCheckpoš‹dSŒ—mS¹LogAdd»ss
() {

3291  ((
	gb™F›ld0_
 & 0x00001000) == 0x00001000);

3300 
public
 
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
() {

3301  
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
;

3310 
public
 
Bud”
 
£tCheckpoš‹dSŒ—mS¹LogAdd»ss
(
v®ue
) {

3311 
	gb™F›ld0_
 |= 0x00001000;

3312 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 = 
v®ue
;

3313 
ÚChªged
();

3314  
	gthis
;

3323 
public
 
Bud”
 
ş—rCheckpoš‹dSŒ—mS¹LogAdd»ss
() {

3324 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00001000);

3325 
	gcheckpoš‹dSŒ—mS¹LogAdd»ss_
 = 0L;

3326 
ÚChªged
();

3327  
	gthis
;

3330 
´iv©e
 
	gş›ÁIdL—¡SignifiÿÁ_
 ;

3338 
public
 
boŞ—n
 
hasCl›ÁIdL—¡SignifiÿÁ
() {

3339  ((
	gb™F›ld0_
 & 0x00002000) == 0x00002000);

3348 
public
 
g‘Cl›ÁIdL—¡SignifiÿÁ
() {

3349  
	gş›ÁIdL—¡SignifiÿÁ_
;

3358 
public
 
Bud”
 
£tCl›ÁIdL—¡SignifiÿÁ
(
v®ue
) {

3359 
	gb™F›ld0_
 |= 0x00002000;

3360 
	gş›ÁIdL—¡SignifiÿÁ_
 = 
v®ue
;

3361 
ÚChªged
();

3362  
	gthis
;

3371 
public
 
Bud”
 
ş—rCl›ÁIdL—¡SignifiÿÁ
() {

3372 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00002000);

3373 
	gş›ÁIdL—¡SignifiÿÁ_
 = 0L;

3374 
ÚChªged
();

3375  
	gthis
;

3378 
´iv©e
 
	gş›ÁIdMo¡SignifiÿÁ_
 ;

3382 
public
 
boŞ—n
 
hasCl›ÁIdMo¡SignifiÿÁ
() {

3383  ((
	gb™F›ld0_
 & 0x00004000) == 0x00004000);

3388 
public
 
g‘Cl›ÁIdMo¡SignifiÿÁ
() {

3389  
	gş›ÁIdMo¡SignifiÿÁ_
;

3394 
public
 
Bud”
 
£tCl›ÁIdMo¡SignifiÿÁ
(
v®ue
) {

3395 
	gb™F›ld0_
 |= 0x00004000;

3396 
	gş›ÁIdMo¡SignifiÿÁ_
 = 
v®ue
;

3397 
ÚChªged
();

3398  
	gthis
;

3403 
public
 
Bud”
 
ş—rCl›ÁIdMo¡SignifiÿÁ
() {

3404 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00004000);

3405 
	gş›ÁIdMo¡SignifiÿÁ_
 = 0L;

3406 
ÚChªged
();

3407  
	gthis
;

3410 
´iv©e
 
	gth»adId_
 ;

3418 
public
 
boŞ—n
 
hasTh»adId
() {

3419  ((
	gb™F›ld0_
 & 0x00008000) == 0x00008000);

3428 
public
 
g‘Th»adId
() {

3429  
	gth»adId_
;

3438 
public
 
Bud”
 
£tTh»adId
(
v®ue
) {

3439 
	gb™F›ld0_
 |= 0x00008000;

3440 
	gth»adId_
 = 
v®ue
;

3441 
ÚChªged
();

3442  
	gthis
;

3451 
public
 
Bud”
 
ş—rTh»adId
() {

3452 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00008000);

3453 
	gth»adId_
 = 0L;

3454 
ÚChªged
();

3455  
	gthis
;

3458 
´iv©e
 
	gcodecTy³_
 ;

3469 
public
 
boŞ—n
 
hasCodecTy³
() {

3470  ((
	gb™F›ld0_
 & 0x00010000) == 0x00010000);

3482 
public
 
g‘CodecTy³
() {

3483  
	gcodecTy³_
;

3495 
public
 
Bud”
 
£tCodecTy³
(
v®ue
) {

3496 
	gb™F›ld0_
 |= 0x00010000;

3497 
	gcodecTy³_
 = 
v®ue
;

3498 
ÚChªged
();

3499  
	gthis
;

3511 
public
 
Bud”
 
ş—rCodecTy³
() {

3512 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00010000);

3513 
	gcodecTy³_
 = 0;

3514 
ÚChªged
();

3515  
	gthis
;

3517 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

3518 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3519  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

3522 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

3523 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3524  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

3532 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
	gDEFAULT_INSTANCE
;

3534 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogEÁry
();

3537 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
g‘DeçuÉIn¡ªû
() {

3538  
	gDEFAULT_INSTANCE
;

3541 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogEÁry
>

3542 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LogEÁry
>() {

3543 
public
 
LogEÁry
 
·r£P¬tŸlFrom
(

3544 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3545 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3546 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

3547  
Ãw
 
LogEÁry
(
šput
, 
ex‹nsiÚRegi¡ry
);

3551 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogEÁry
> 
·r£r
() {

3552  
	gPARSER
;

3555 @
	gjava
.
	gÏng
.
Ov”ride


3556 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogEÁry
> 
g‘P¬£rFÜTy³
() {

3557  
	gPARSER
;

3560 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogEÁry
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3561  
	gDEFAULT_INSTANCE
;

3566 
public
 
š‹rçû
 
LogH—d”OrBud”
 
ex‹nds


3568 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

3573 
boŞ—n
 
hasV”siÚ
();

3577 
g‘V”siÚ
();

3582 
boŞ—n
 
hasV”ifyChecksum
();

3586 
boŞ—n
 
g‘V”ifyChecksum
();

3591 
public
 
fš®
 
şass
 
LogH—d”
 
ex‹nds


3592 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


3594 
	gLogH—d”OrBud”
 {

3596 
´iv©e
 
LogH—d”
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

3597 
su³r
(
bud”
);

3599 
´iv©e
 
LogH—d”
() {

3600 
	gv”siÚ_
 = 0;

3601 
	gv”ifyChecksum_
 = 
çl£
;

3604 @
	gjava
.
	gÏng
.
Ov”ride


3605 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


3606 
g‘UnknownF›lds
() {

3607  
	gthis
.
	gunknownF›lds
;

3609 
´iv©e
 
LogH—d”
(

3610 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3611 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3612 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3613 
this
();

3614 
	gmubË_b™F›ld0_
 = 0;

3615 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

3616 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

3617 
	gŒy
 {

3618 
boŞ—n
 
	gdÚe
 = 
çl£
;

3619 !
	gdÚe
) {

3620 
	gg
 = 
šput
.
»adTag
();

3621 
	gg
) {

3623 
dÚe
 = 
Œue
;

3626 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

3627 
ex‹nsiÚRegi¡ry
, 
g
)) {

3628 
	gdÚe
 = 
Œue
;

3633 
b™F›ld0_
 |= 0x00000001;

3634 
	gv”siÚ_
 = 
šput
.
»adIÁ32
();

3638 
b™F›ld0_
 |= 0x00000002;

3639 
	gv”ifyChecksum_
 = 
šput
.
»adBoŞ
();

3644 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3645 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

3646 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

3647 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

3648 
e
).
£tUnfšishedMes§ge
(
this
);

3649 } 
	gfš®ly
 {

3650 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

3651 
makeEx‹nsiÚsImmubË
();

3654 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3655 
g‘DesütÜ
() {

3656  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogH—d”_desütÜ
;

3659 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3660 
š‹º®G‘F›ldAcûssÜTabË
() {

3661  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogH—d”_f›ldAcûssÜTabË


3662 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3663 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
.
şass
, org.cÜfudb.fÜm©.Ty³s.LogH—d”.
Bud”
.class);

3666 
´iv©e
 
	gb™F›ld0_
;

3667 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 1;

3668 
´iv©e
 
	gv”siÚ_
;

3672 
public
 
boŞ—n
 
hasV”siÚ
() {

3673  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

3678 
public
 
g‘V”siÚ
() {

3679  
	gv”siÚ_
;

3682 
public
 
fš®
 
	gVERIFY_CHECKSUM_FIELD_NUMBER
 = 2;

3683 
´iv©e
 
boŞ—n
 
	gv”ifyChecksum_
;

3687 
public
 
boŞ—n
 
hasV”ifyChecksum
() {

3688  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

3693 
public
 
boŞ—n
 
g‘V”ifyChecksum
() {

3694  
	gv”ifyChecksum_
;

3697 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

3698 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3699 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

3700 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

3701 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

3703 
	gmemoizedIsIn™Ÿlized
 = 1;

3704  
	gŒue
;

3707 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

3708 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3709 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

3710 
ouut
.
wr™eIÁ32
(1, 
v”siÚ_
);

3712 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

3713 
ouut
.
wr™eBoŞ
(2, 
v”ifyChecksum_
);

3715 
	gunknownF›lds
.
wr™eTo
(
ouut
);

3718 
public
 
g‘S”ŸlizedSize
() {

3719 
	gsize
 = 
memoizedSize
;

3720 ià(
	gsize
 !ğ-1è 
size
;

3722 
	gsize
 = 0;

3723 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

3724 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3725 .
compu‹IÁ32Size
(1, 
v”siÚ_
);

3727 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

3728 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3729 .
compu‹BoŞSize
(2, 
v”ifyChecksum_
);

3731 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

3732 
	gmemoizedSize
 = 
size
;

3733  
	gsize
;

3736 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

3737 @
	gjava
.
	gÏng
.
Ov”ride


3738 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

3739 ià(
	gobj
 =ğ
this
) {

3740  
Œue
;

3742 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogH—d”
)) {

3743  
	gsu³r
.
equ®s
(
obj
);

3745 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
	gÙh”
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.LogH—d”è
obj
;

3747 
boŞ—n
 
	g»suÉ
 = 
Œue
;

3748 
	g»suÉ
 = 
»suÉ
 && (
hasV”siÚ
(è=ğ
Ùh”
.hasVersion());

3749 ià(
hasV”siÚ
()) {

3750 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

3751 =ğ
Ùh”
.
g‘V”siÚ
());

3753 
	g»suÉ
 = 
»suÉ
 && (
hasV”ifyChecksum
(è=ğ
Ùh”
.hasVerifyChecksum());

3754 ià(
hasV”ifyChecksum
()) {

3755 
	g»suÉ
 = 
»suÉ
 && (
g‘V”ifyChecksum
()

3756 =ğ
Ùh”
.
g‘V”ifyChecksum
());

3758 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

3759  
	g»suÉ
;

3762 @
	gjava
.
	gÏng
.
Ov”ride


3763 
public
 
hashCode
() {

3764 ià(
	gmemoizedHashCode
 != 0) {

3765  
memoizedHashCode
;

3767 
	ghash
 = 41;

3768 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

3769 ià(
hasV”siÚ
()) {

3770 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

3771 
	ghash
 = (53 * 
hash
è+ 
g‘V”siÚ
();

3773 ià(
hasV”ifyChecksum
()) {

3774 
	ghash
 = (37 * 
hash
è+ 
VERIFY_CHECKSUM_FIELD_NUMBER
;

3775 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

3776 
g‘V”ifyChecksum
());

3778 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

3779 
	gmemoizedHashCode
 = 
hash
;

3780  
	ghash
;

3783 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(

3784 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

3785 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3786  
	gPARSER
.
·r£From
(
d©a
);

3788 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(

3789 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

3790 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3791 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3792  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3794 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(
by‹
[] 
d©a
)

3795 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3796  
	gPARSER
.
·r£From
(
d©a
);

3798 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(

3799 
by‹
[] 
d©a
,

3800 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3801 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3802  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3804 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3805 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3806  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3807 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3809 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(

3810 
java
.
io
.
IÅutSŒ—m
 
šput
,

3811 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3812 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3813  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3814 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3816 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3817 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3818  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3819 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

3821 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£D–im™edFrom
(

3822 
java
.
io
.
IÅutSŒ—m
 
šput
,

3823 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3824 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3825  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3826 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3828 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(

3829 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

3830 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3831  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3832 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3834 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
·r£From
(

3835 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3836 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3837 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3838  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3839 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3842 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

3843 
public
 
Bud”
 
ÃwBud”
() {

3844  
	gDEFAULT_INSTANCE
.
toBud”
();

3846 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
 
´ÙÙy³
) {

3847  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

3849 
public
 
Bud”
 
toBud”
() {

3850  
	gthis
 =ğ
DEFAULT_INSTANCE


3851 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

3854 @
	gjava
.
	gÏng
.
Ov”ride


3855 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

3856 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3857 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

3858  
	gbud”
;

3863 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


3864 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


3866 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogH—d”OrBud”
 {

3867 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3868 
g‘DesütÜ
() {

3869  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogH—d”_desütÜ
;

3872 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3873 
š‹º®G‘F›ldAcûssÜTabË
() {

3874  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogH—d”_f›ldAcûssÜTabË


3875 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3876 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
.
şass
, org.cÜfudb.fÜm©.Ty³s.LogH—d”.
Bud”
.class);

3880 
´iv©e
 
Bud”
() {

3881 
maybeFÜûBud”In™Ÿliz©iÚ
();

3884 
´iv©e
 
Bud”
(

3885 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3886 
su³r
(
·»Á
);

3887 
maybeFÜûBud”In™Ÿliz©iÚ
();

3889 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

3890 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3891 .
	g®waysU£F›ldBud”s
) {

3894 
public
 
Bud”
 
ş—r
() {

3895 
	gsu³r
.
ş—r
();

3896 
	gv”siÚ_
 = 0;

3897 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

3898 
	gv”ifyChecksum_
 = 
çl£
;

3899 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

3900  
	gthis
;

3903 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3904 
g‘DesütÜFÜTy³
() {

3905  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_LogH—d”_desütÜ
;

3908 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3909  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogH—d”
.
g‘DeçuÉIn¡ªû
();

3912 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
bud
() {

3913 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
	g»suÉ
 = 
budP¬tŸl
();

3914 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

3915 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

3917  
	g»suÉ
;

3920 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
budP¬tŸl
() {

3921 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.LogH—d”(
this
);

3922 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

3923 
	gto_b™F›ld0_
 = 0;

3924 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

3925 
to_b™F›ld0_
 |= 0x00000001;

3927 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

3928 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

3929 
to_b™F›ld0_
 |= 0x00000002;

3931 
	g»suÉ
.
	gv”ifyChecksum_
 = 
v”ifyChecksum_
;

3932 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

3933 
ÚBut
();

3934  
	g»suÉ
;

3937 
public
 
Bud”
 
şÚe
() {

3938  (
	gBud”
è
	gsu³r
.
şÚe
();

3940 
public
 
Bud”
 
£tF›ld
(

3941 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3942 
Objeù
 
v®ue
) {

3943  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

3945 
public
 
Bud”
 
ş—rF›ld
(

3946 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

3947  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

3949 
public
 
Bud”
 
ş—rOÃof
(

3950 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

3951  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

3953 
public
 
Bud”
 
£tR•—‹dF›ld
(

3954 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3955 
šdex
, 
Objeù
 
v®ue
) {

3956  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

3958 
public
 
Bud”
 
addR•—‹dF›ld
(

3959 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3960 
Objeù
 
v®ue
) {

3961  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

3963 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

3964 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogH—d”
) {

3965  
m”geFrom
((
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
)
Ùh”
);

3967 
	gsu³r
.
m”geFrom
(
Ùh”
);

3968  
	gthis
;

3972 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
 
Ùh”
) {

3973 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
.
g‘DeçuÉIn¡ªû
()è 
this
;

3974 ià(
	gÙh”
.
hasV”siÚ
()) {

3975 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

3977 ià(
	gÙh”
.
hasV”ifyChecksum
()) {

3978 
£tV”ifyChecksum
(
Ùh”
.
g‘V”ifyChecksum
());

3980 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

3981 
ÚChªged
();

3982  
	gthis
;

3985 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3986  
	gŒue
;

3989 
public
 
Bud”
 
m”geFrom
(

3990 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3991 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3992 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3993 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
	g·r£dMes§ge
 = 
nuÎ
;

3994 
	gŒy
 {

3995 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

3996 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3997 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
è
e
.
g‘UnfšishedMes§ge
();

3998 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

3999 } 
	gfš®ly
 {

4000 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

4001 
m”geFrom
(
·r£dMes§ge
);

4004  
	gthis
;

4006 
´iv©e
 
	gb™F›ld0_
;

4008 
´iv©e
 
	gv”siÚ_
 ;

4012 
public
 
boŞ—n
 
hasV”siÚ
() {

4013  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

4018 
public
 
g‘V”siÚ
() {

4019  
	gv”siÚ_
;

4024 
public
 
Bud”
 
£tV”siÚ
(
v®ue
) {

4025 
	gb™F›ld0_
 |= 0x00000001;

4026 
	gv”siÚ_
 = 
v®ue
;

4027 
ÚChªged
();

4028  
	gthis
;

4033 
public
 
Bud”
 
ş—rV”siÚ
() {

4034 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4035 
	gv”siÚ_
 = 0;

4036 
ÚChªged
();

4037  
	gthis
;

4040 
´iv©e
 
boŞ—n
 
	gv”ifyChecksum_
 ;

4044 
public
 
boŞ—n
 
hasV”ifyChecksum
() {

4045  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

4050 
public
 
boŞ—n
 
g‘V”ifyChecksum
() {

4051  
	gv”ifyChecksum_
;

4056 
public
 
Bud”
 
£tV”ifyChecksum
(
boŞ—n
 
v®ue
) {

4057 
	gb™F›ld0_
 |= 0x00000002;

4058 
	gv”ifyChecksum_
 = 
v®ue
;

4059 
ÚChªged
();

4060  
	gthis
;

4065 
public
 
Bud”
 
ş—rV”ifyChecksum
() {

4066 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

4067 
	gv”ifyChecksum_
 = 
çl£
;

4068 
ÚChªged
();

4069  
	gthis
;

4071 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

4072 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4073  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

4076 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

4077 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4078  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

4086 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
	gDEFAULT_INSTANCE
;

4088 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
LogH—d”
();

4091 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
g‘DeçuÉIn¡ªû
() {

4092  
	gDEFAULT_INSTANCE
;

4095 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogH—d”
>

4096 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LogH—d”
>() {

4097 
public
 
LogH—d”
 
·r£P¬tŸlFrom
(

4098 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4099 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4100 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

4101  
Ãw
 
LogH—d”
(
šput
, 
ex‹nsiÚRegi¡ry
);

4105 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogH—d”
> 
·r£r
() {

4106  
	gPARSER
;

4109 @
	gjava
.
	gÏng
.
Ov”ride


4110 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogH—d”
> 
g‘P¬£rFÜTy³
() {

4111  
	gPARSER
;

4114 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
LogH—d”
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4115  
	gDEFAULT_INSTANCE
;

4120 
public
 
š‹rçû
 
M‘ad©aOrBud”
 
ex‹nds


4122 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

4127 
boŞ—n
 
hasPaylßdChecksum
();

4131 
g‘PaylßdChecksum
();

4136 
boŞ—n
 
hasL’gthChecksum
();

4140 
g‘L’gthChecksum
();

4145 
boŞ—n
 
hasL’gth
();

4149 
g‘L’gth
();

4154 
public
 
fš®
 
şass
 
M‘ad©a
 
ex‹nds


4155 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


4157 
	gM‘ad©aOrBud”
 {

4159 
´iv©e
 
M‘ad©a
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

4160 
su³r
(
bud”
);

4162 
´iv©e
 
M‘ad©a
() {

4163 
	g·ylßdChecksum_
 = 0;

4164 
	gËngthChecksum_
 = 0;

4165 
	gËngth_
 = 0;

4168 @
	gjava
.
	gÏng
.
Ov”ride


4169 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


4170 
g‘UnknownF›lds
() {

4171  
	gthis
.
	gunknownF›lds
;

4173 
´iv©e
 
M‘ad©a
(

4174 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4175 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4176 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4177 
this
();

4178 
	gmubË_b™F›ld0_
 = 0;

4179 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

4180 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

4181 
	gŒy
 {

4182 
boŞ—n
 
	gdÚe
 = 
çl£
;

4183 !
	gdÚe
) {

4184 
	gg
 = 
šput
.
»adTag
();

4185 
	gg
) {

4187 
dÚe
 = 
Œue
;

4190 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

4191 
ex‹nsiÚRegi¡ry
, 
g
)) {

4192 
	gdÚe
 = 
Œue
;

4197 
b™F›ld0_
 |= 0x00000001;

4198 
	g·ylßdChecksum_
 = 
šput
.
»adSFixed32
();

4202 
b™F›ld0_
 |= 0x00000002;

4203 
	gËngthChecksum_
 = 
šput
.
»adSFixed32
();

4207 
b™F›ld0_
 |= 0x00000004;

4208 
	gËngth_
 = 
šput
.
»adSFixed32
();

4213 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

4214 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

4215 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

4216 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

4217 
e
).
£tUnfšishedMes§ge
(
this
);

4218 } 
	gfš®ly
 {

4219 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

4220 
makeEx‹nsiÚsImmubË
();

4223 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4224 
g‘DesütÜ
() {

4225  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_M‘ad©a_desütÜ
;

4228 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4229 
š‹º®G‘F›ldAcûssÜTabË
() {

4230  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_M‘ad©a_f›ldAcûssÜTabË


4231 .
’su»F›ldAcûssÜsIn™Ÿlized
(

4232 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
.
şass
, org.cÜfudb.fÜm©.Ty³s.M‘ad©a.
Bud”
.class);

4235 
´iv©e
 
	gb™F›ld0_
;

4236 
public
 
fš®
 
	gPAYLOAD_CHECKSUM_FIELD_NUMBER
 = 1;

4237 
´iv©e
 
	g·ylßdChecksum_
;

4241 
public
 
boŞ—n
 
hasPaylßdChecksum
() {

4242  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

4247 
public
 
g‘PaylßdChecksum
() {

4248  
	g·ylßdChecksum_
;

4251 
public
 
fš®
 
	gLENGTH_CHECKSUM_FIELD_NUMBER
 = 2;

4252 
´iv©e
 
	gËngthChecksum_
;

4256 
public
 
boŞ—n
 
hasL’gthChecksum
() {

4257  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

4262 
public
 
g‘L’gthChecksum
() {

4263  
	gËngthChecksum_
;

4266 
public
 
fš®
 
	gLENGTH_FIELD_NUMBER
 = 3;

4267 
´iv©e
 
	gËngth_
;

4271 
public
 
boŞ—n
 
hasL’gth
() {

4272  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

4277 
public
 
g‘L’gth
() {

4278  
	gËngth_
;

4281 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

4282 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

4283 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

4284 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

4285 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

4287 ià(!
hasPaylßdChecksum
()) {

4288 
	gmemoizedIsIn™Ÿlized
 = 0;

4289  
	gçl£
;

4291 ià(!
hasL’gthChecksum
()) {

4292 
	gmemoizedIsIn™Ÿlized
 = 0;

4293  
	gçl£
;

4295 ià(!
hasL’gth
()) {

4296 
	gmemoizedIsIn™Ÿlized
 = 0;

4297  
	gçl£
;

4299 
	gmemoizedIsIn™Ÿlized
 = 1;

4300  
	gŒue
;

4303 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

4304 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4305 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

4306 
ouut
.
wr™eSFixed32
(1, 
·ylßdChecksum_
);

4308 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

4309 
ouut
.
wr™eSFixed32
(2, 
ËngthChecksum_
);

4311 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

4312 
ouut
.
wr™eSFixed32
(3, 
Ëngth_
);

4314 
	gunknownF›lds
.
wr™eTo
(
ouut
);

4317 
public
 
g‘S”ŸlizedSize
() {

4318 
	gsize
 = 
memoizedSize
;

4319 ià(
	gsize
 !ğ-1è 
size
;

4321 
	gsize
 = 0;

4322 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

4323 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


4324 .
compu‹SFixed32Size
(1, 
·ylßdChecksum_
);

4326 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

4327 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


4328 .
compu‹SFixed32Size
(2, 
ËngthChecksum_
);

4330 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

4331 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


4332 .
compu‹SFixed32Size
(3, 
Ëngth_
);

4334 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

4335 
	gmemoizedSize
 = 
size
;

4336  
	gsize
;

4339 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

4340 @
	gjava
.
	gÏng
.
Ov”ride


4341 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

4342 ià(
	gobj
 =ğ
this
) {

4343  
Œue
;

4345 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gM‘ad©a
)) {

4346  
	gsu³r
.
equ®s
(
obj
);

4348 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
	gÙh”
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.M‘ad©aè
obj
;

4350 
boŞ—n
 
	g»suÉ
 = 
Œue
;

4351 
	g»suÉ
 = 
»suÉ
 && (
hasPaylßdChecksum
(è=ğ
Ùh”
.hasPayloadChecksum());

4352 ià(
hasPaylßdChecksum
()) {

4353 
	g»suÉ
 = 
»suÉ
 && (
g‘PaylßdChecksum
()

4354 =ğ
Ùh”
.
g‘PaylßdChecksum
());

4356 
	g»suÉ
 = 
»suÉ
 && (
hasL’gthChecksum
(è=ğ
Ùh”
.hasLengthChecksum());

4357 ià(
hasL’gthChecksum
()) {

4358 
	g»suÉ
 = 
»suÉ
 && (
g‘L’gthChecksum
()

4359 =ğ
Ùh”
.
g‘L’gthChecksum
());

4361 
	g»suÉ
 = 
»suÉ
 && (
hasL’gth
(è=ğ
Ùh”
.hasLength());

4362 ià(
hasL’gth
()) {

4363 
	g»suÉ
 = 
»suÉ
 && (
g‘L’gth
()

4364 =ğ
Ùh”
.
g‘L’gth
());

4366 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

4367  
	g»suÉ
;

4370 @
	gjava
.
	gÏng
.
Ov”ride


4371 
public
 
hashCode
() {

4372 ià(
	gmemoizedHashCode
 != 0) {

4373  
memoizedHashCode
;

4375 
	ghash
 = 41;

4376 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

4377 ià(
hasPaylßdChecksum
()) {

4378 
	ghash
 = (37 * 
hash
è+ 
PAYLOAD_CHECKSUM_FIELD_NUMBER
;

4379 
	ghash
 = (53 * 
hash
è+ 
g‘PaylßdChecksum
();

4381 ià(
hasL’gthChecksum
()) {

4382 
	ghash
 = (37 * 
hash
è+ 
LENGTH_CHECKSUM_FIELD_NUMBER
;

4383 
	ghash
 = (53 * 
hash
è+ 
g‘L’gthChecksum
();

4385 ià(
hasL’gth
()) {

4386 
	ghash
 = (37 * 
hash
è+ 
LENGTH_FIELD_NUMBER
;

4387 
	ghash
 = (53 * 
hash
è+ 
g‘L’gth
();

4389 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

4390 
	gmemoizedHashCode
 = 
hash
;

4391  
	ghash
;

4394 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(

4395 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

4396 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4397  
	gPARSER
.
·r£From
(
d©a
);

4399 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(

4400 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

4401 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4402 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4403  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

4405 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(
by‹
[] 
d©a
)

4406 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4407  
	gPARSER
.
·r£From
(
d©a
);

4409 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(

4410 
by‹
[] 
d©a
,

4411 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4412 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4413  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

4415 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

4416 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4417  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4418 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

4420 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(

4421 
java
.
io
.
IÅutSŒ—m
 
šput
,

4422 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4423 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4424  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4425 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

4427 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

4428 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4429  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4430 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

4432 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£D–im™edFrom
(

4433 
java
.
io
.
IÅutSŒ—m
 
šput
,

4434 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4435 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4436  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4437 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

4439 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(

4440 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

4441 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4442  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4443 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

4445 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
·r£From
(

4446 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4447 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4448 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4449  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4450 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

4453 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

4454 
public
 
Bud”
 
ÃwBud”
() {

4455  
	gDEFAULT_INSTANCE
.
toBud”
();

4457 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
 
´ÙÙy³
) {

4458  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

4460 
public
 
Bud”
 
toBud”
() {

4461  
	gthis
 =ğ
DEFAULT_INSTANCE


4462 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

4465 @
	gjava
.
	gÏng
.
Ov”ride


4466 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

4467 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

4468 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

4469  
	gbud”
;

4474 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


4475 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


4477 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gM‘ad©aOrBud”
 {

4478 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4479 
g‘DesütÜ
() {

4480  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_M‘ad©a_desütÜ
;

4483 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4484 
š‹º®G‘F›ldAcûssÜTabË
() {

4485  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_M‘ad©a_f›ldAcûssÜTabË


4486 .
’su»F›ldAcûssÜsIn™Ÿlized
(

4487 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
.
şass
, org.cÜfudb.fÜm©.Ty³s.M‘ad©a.
Bud”
.class);

4491 
´iv©e
 
Bud”
() {

4492 
maybeFÜûBud”In™Ÿliz©iÚ
();

4495 
´iv©e
 
Bud”
(

4496 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

4497 
su³r
(
·»Á
);

4498 
maybeFÜûBud”In™Ÿliz©iÚ
();

4500 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

4501 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4502 .
	g®waysU£F›ldBud”s
) {

4505 
public
 
Bud”
 
ş—r
() {

4506 
	gsu³r
.
ş—r
();

4507 
	g·ylßdChecksum_
 = 0;

4508 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4509 
	gËngthChecksum_
 = 0;

4510 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

4511 
	gËngth_
 = 0;

4512 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

4513  
	gthis
;

4516 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4517 
g‘DesütÜFÜTy³
() {

4518  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_M‘ad©a_desütÜ
;

4521 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4522  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gM‘ad©a
.
g‘DeçuÉIn¡ªû
();

4525 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
bud
() {

4526 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
	g»suÉ
 = 
budP¬tŸl
();

4527 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

4528 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

4530  
	g»suÉ
;

4533 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
budP¬tŸl
() {

4534 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.M‘ad©a(
this
);

4535 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

4536 
	gto_b™F›ld0_
 = 0;

4537 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

4538 
to_b™F›ld0_
 |= 0x00000001;

4540 
	g»suÉ
.
	g·ylßdChecksum_
 = 
·ylßdChecksum_
;

4541 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

4542 
to_b™F›ld0_
 |= 0x00000002;

4544 
	g»suÉ
.
	gËngthChecksum_
 = 
ËngthChecksum_
;

4545 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

4546 
to_b™F›ld0_
 |= 0x00000004;

4548 
	g»suÉ
.
	gËngth_
 = 
Ëngth_
;

4549 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

4550 
ÚBut
();

4551  
	g»suÉ
;

4554 
public
 
Bud”
 
şÚe
() {

4555  (
	gBud”
è
	gsu³r
.
şÚe
();

4557 
public
 
Bud”
 
£tF›ld
(

4558 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4559 
Objeù
 
v®ue
) {

4560  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

4562 
public
 
Bud”
 
ş—rF›ld
(

4563 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

4564  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

4566 
public
 
Bud”
 
ş—rOÃof
(

4567 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

4568  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

4570 
public
 
Bud”
 
£tR•—‹dF›ld
(

4571 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4572 
šdex
, 
Objeù
 
v®ue
) {

4573  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

4575 
public
 
Bud”
 
addR•—‹dF›ld
(

4576 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4577 
Objeù
 
v®ue
) {

4578  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

4580 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

4581 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gM‘ad©a
) {

4582  
m”geFrom
((
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
)
Ùh”
);

4584 
	gsu³r
.
m”geFrom
(
Ùh”
);

4585  
	gthis
;

4589 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
 
Ùh”
) {

4590 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
.
g‘DeçuÉIn¡ªû
()è 
this
;

4591 ià(
	gÙh”
.
hasPaylßdChecksum
()) {

4592 
£tPaylßdChecksum
(
Ùh”
.
g‘PaylßdChecksum
());

4594 ià(
	gÙh”
.
hasL’gthChecksum
()) {

4595 
£tL’gthChecksum
(
Ùh”
.
g‘L’gthChecksum
());

4597 ià(
	gÙh”
.
hasL’gth
()) {

4598 
£tL’gth
(
Ùh”
.
g‘L’gth
());

4600 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

4601 
ÚChªged
();

4602  
	gthis
;

4605 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

4606 ià(!
hasPaylßdChecksum
()) {

4607  
	gçl£
;

4609 ià(!
hasL’gthChecksum
()) {

4610  
	gçl£
;

4612 ià(!
hasL’gth
()) {

4613  
	gçl£
;

4615  
	gŒue
;

4618 
public
 
Bud”
 
m”geFrom
(

4619 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4620 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4621 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4622 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
	g·r£dMes§ge
 = 
nuÎ
;

4623 
	gŒy
 {

4624 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

4625 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

4626 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
è
e
.
g‘UnfšishedMes§ge
();

4627 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

4628 } 
	gfš®ly
 {

4629 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

4630 
m”geFrom
(
·r£dMes§ge
);

4633  
	gthis
;

4635 
´iv©e
 
	gb™F›ld0_
;

4637 
´iv©e
 
	g·ylßdChecksum_
 ;

4641 
public
 
boŞ—n
 
hasPaylßdChecksum
() {

4642  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

4647 
public
 
g‘PaylßdChecksum
() {

4648  
	g·ylßdChecksum_
;

4653 
public
 
Bud”
 
£tPaylßdChecksum
(
v®ue
) {

4654 
	gb™F›ld0_
 |= 0x00000001;

4655 
	g·ylßdChecksum_
 = 
v®ue
;

4656 
ÚChªged
();

4657  
	gthis
;

4662 
public
 
Bud”
 
ş—rPaylßdChecksum
() {

4663 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4664 
	g·ylßdChecksum_
 = 0;

4665 
ÚChªged
();

4666  
	gthis
;

4669 
´iv©e
 
	gËngthChecksum_
 ;

4673 
public
 
boŞ—n
 
hasL’gthChecksum
() {

4674  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

4679 
public
 
g‘L’gthChecksum
() {

4680  
	gËngthChecksum_
;

4685 
public
 
Bud”
 
£tL’gthChecksum
(
v®ue
) {

4686 
	gb™F›ld0_
 |= 0x00000002;

4687 
	gËngthChecksum_
 = 
v®ue
;

4688 
ÚChªged
();

4689  
	gthis
;

4694 
public
 
Bud”
 
ş—rL’gthChecksum
() {

4695 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

4696 
	gËngthChecksum_
 = 0;

4697 
ÚChªged
();

4698  
	gthis
;

4701 
´iv©e
 
	gËngth_
 ;

4705 
public
 
boŞ—n
 
hasL’gth
() {

4706  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

4711 
public
 
g‘L’gth
() {

4712  
	gËngth_
;

4717 
public
 
Bud”
 
£tL’gth
(
v®ue
) {

4718 
	gb™F›ld0_
 |= 0x00000004;

4719 
	gËngth_
 = 
v®ue
;

4720 
ÚChªged
();

4721  
	gthis
;

4726 
public
 
Bud”
 
ş—rL’gth
() {

4727 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

4728 
	gËngth_
 = 0;

4729 
ÚChªged
();

4730  
	gthis
;

4732 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

4733 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4734  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

4737 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

4738 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4739  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

4747 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
	gDEFAULT_INSTANCE
;

4749 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
M‘ad©a
();

4752 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
g‘DeçuÉIn¡ªû
() {

4753  
	gDEFAULT_INSTANCE
;

4756 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gM‘ad©a
>

4757 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
M‘ad©a
>() {

4758 
public
 
M‘ad©a
 
·r£P¬tŸlFrom
(

4759 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4760 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4761 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

4762  
Ãw
 
M‘ad©a
(
šput
, 
ex‹nsiÚRegi¡ry
);

4766 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gM‘ad©a
> 
·r£r
() {

4767  
	gPARSER
;

4770 @
	gjava
.
	gÏng
.
Ov”ride


4771 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gM‘ad©a
> 
g‘P¬£rFÜTy³
() {

4772  
	gPARSER
;

4775 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
M‘ad©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4776  
	gDEFAULT_INSTANCE
;

4781 
public
 
š‹rçû
 
TrimEÁryOrBud”
 
ex‹nds


4783 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

4788 
boŞ—n
 
hasChecksum
();

4792 
g‘Checksum
();

4797 
boŞ—n
 
hasAdd»ss
();

4801 
g‘Add»ss
();

4806 
public
 
fš®
 
şass
 
TrimEÁry
 
ex‹nds


4807 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


4809 
	gTrimEÁryOrBud”
 {

4811 
´iv©e
 
TrimEÁry
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

4812 
su³r
(
bud”
);

4814 
´iv©e
 
TrimEÁry
() {

4815 
	gchecksum_
 = 0;

4816 
	gadd»ss_
 = 0L;

4819 @
	gjava
.
	gÏng
.
Ov”ride


4820 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


4821 
g‘UnknownF›lds
() {

4822  
	gthis
.
	gunknownF›lds
;

4824 
´iv©e
 
TrimEÁry
(

4825 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4826 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4827 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4828 
this
();

4829 
	gmubË_b™F›ld0_
 = 0;

4830 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

4831 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

4832 
	gŒy
 {

4833 
boŞ—n
 
	gdÚe
 = 
çl£
;

4834 !
	gdÚe
) {

4835 
	gg
 = 
šput
.
»adTag
();

4836 
	gg
) {

4838 
dÚe
 = 
Œue
;

4841 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

4842 
ex‹nsiÚRegi¡ry
, 
g
)) {

4843 
	gdÚe
 = 
Œue
;

4848 
b™F›ld0_
 |= 0x00000001;

4849 
	gchecksum_
 = 
šput
.
»adIÁ32
();

4853 
b™F›ld0_
 |= 0x00000002;

4854 
	gadd»ss_
 = 
šput
.
»adIÁ64
();

4859 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

4860 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

4861 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

4862 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

4863 
e
).
£tUnfšishedMes§ge
(
this
);

4864 } 
	gfš®ly
 {

4865 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

4866 
makeEx‹nsiÚsImmubË
();

4869 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4870 
g‘DesütÜ
() {

4871  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_TrimEÁry_desütÜ
;

4874 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4875 
š‹º®G‘F›ldAcûssÜTabË
() {

4876  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_TrimEÁry_f›ldAcûssÜTabË


4877 .
’su»F›ldAcûssÜsIn™Ÿlized
(

4878 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
.
şass
, org.cÜfudb.fÜm©.Ty³s.TrimEÁry.
Bud”
.class);

4881 
´iv©e
 
	gb™F›ld0_
;

4882 
public
 
fš®
 
	gCHECKSUM_FIELD_NUMBER
 = 1;

4883 
´iv©e
 
	gchecksum_
;

4887 
public
 
boŞ—n
 
hasChecksum
() {

4888  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

4893 
public
 
g‘Checksum
() {

4894  
	gchecksum_
;

4897 
public
 
fš®
 
	gADDRESS_FIELD_NUMBER
 = 2;

4898 
´iv©e
 
	gadd»ss_
;

4902 
public
 
boŞ—n
 
hasAdd»ss
() {

4903  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

4908 
public
 
g‘Add»ss
() {

4909  
	gadd»ss_
;

4912 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

4913 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

4914 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

4915 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

4916 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

4918 
	gmemoizedIsIn™Ÿlized
 = 1;

4919  
	gŒue
;

4922 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

4923 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4924 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

4925 
ouut
.
wr™eIÁ32
(1, 
checksum_
);

4927 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

4928 
ouut
.
wr™eIÁ64
(2, 
add»ss_
);

4930 
	gunknownF›lds
.
wr™eTo
(
ouut
);

4933 
public
 
g‘S”ŸlizedSize
() {

4934 
	gsize
 = 
memoizedSize
;

4935 ià(
	gsize
 !ğ-1è 
size
;

4937 
	gsize
 = 0;

4938 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

4939 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


4940 .
compu‹IÁ32Size
(1, 
checksum_
);

4942 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

4943 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


4944 .
compu‹IÁ64Size
(2, 
add»ss_
);

4946 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

4947 
	gmemoizedSize
 = 
size
;

4948  
	gsize
;

4951 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

4952 @
	gjava
.
	gÏng
.
Ov”ride


4953 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

4954 ià(
	gobj
 =ğ
this
) {

4955  
Œue
;

4957 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gTrimEÁry
)) {

4958  
	gsu³r
.
equ®s
(
obj
);

4960 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
	gÙh”
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.TrimEÁryè
obj
;

4962 
boŞ—n
 
	g»suÉ
 = 
Œue
;

4963 
	g»suÉ
 = 
»suÉ
 && (
hasChecksum
(è=ğ
Ùh”
.hasChecksum());

4964 ià(
hasChecksum
()) {

4965 
	g»suÉ
 = 
»suÉ
 && (
g‘Checksum
()

4966 =ğ
Ùh”
.
g‘Checksum
());

4968 
	g»suÉ
 = 
»suÉ
 && (
hasAdd»ss
(è=ğ
Ùh”
.hasAddress());

4969 ià(
hasAdd»ss
()) {

4970 
	g»suÉ
 = 
»suÉ
 && (
g‘Add»ss
()

4971 =ğ
Ùh”
.
g‘Add»ss
());

4973 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

4974  
	g»suÉ
;

4977 @
	gjava
.
	gÏng
.
Ov”ride


4978 
public
 
hashCode
() {

4979 ià(
	gmemoizedHashCode
 != 0) {

4980  
memoizedHashCode
;

4982 
	ghash
 = 41;

4983 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

4984 ià(
hasChecksum
()) {

4985 
	ghash
 = (37 * 
hash
è+ 
CHECKSUM_FIELD_NUMBER
;

4986 
	ghash
 = (53 * 
hash
è+ 
g‘Checksum
();

4988 ià(
hasAdd»ss
()) {

4989 
	ghash
 = (37 * 
hash
è+ 
ADDRESS_FIELD_NUMBER
;

4990 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

4991 
g‘Add»ss
());

4993 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

4994 
	gmemoizedHashCode
 = 
hash
;

4995  
	ghash
;

4998 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(

4999 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

5000 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5001  
	gPARSER
.
·r£From
(
d©a
);

5003 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(

5004 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

5005 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5006 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5007  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

5009 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(
by‹
[] 
d©a
)

5010 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5011  
	gPARSER
.
·r£From
(
d©a
);

5013 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(

5014 
by‹
[] 
d©a
,

5015 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5016 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5017  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

5019 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

5020 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5021  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5022 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

5024 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(

5025 
java
.
io
.
IÅutSŒ—m
 
šput
,

5026 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5027 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5028  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5029 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5031 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

5032 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5033  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5034 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

5036 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£D–im™edFrom
(

5037 
java
.
io
.
IÅutSŒ—m
 
šput
,

5038 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5039 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5040  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5041 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5043 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(

5044 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

5045 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5046  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5047 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

5049 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
·r£From
(

5050 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5051 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5052 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5053  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5054 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5057 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

5058 
public
 
Bud”
 
ÃwBud”
() {

5059  
	gDEFAULT_INSTANCE
.
toBud”
();

5061 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
 
´ÙÙy³
) {

5062  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

5064 
public
 
Bud”
 
toBud”
() {

5065  
	gthis
 =ğ
DEFAULT_INSTANCE


5066 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

5069 @
	gjava
.
	gÏng
.
Ov”ride


5070 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

5071 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

5072 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

5073  
	gbud”
;

5078 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


5079 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


5081 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gTrimEÁryOrBud”
 {

5082 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5083 
g‘DesütÜ
() {

5084  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_TrimEÁry_desütÜ
;

5087 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5088 
š‹º®G‘F›ldAcûssÜTabË
() {

5089  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_TrimEÁry_f›ldAcûssÜTabË


5090 .
’su»F›ldAcûssÜsIn™Ÿlized
(

5091 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
.
şass
, org.cÜfudb.fÜm©.Ty³s.TrimEÁry.
Bud”
.class);

5095 
´iv©e
 
Bud”
() {

5096 
maybeFÜûBud”In™Ÿliz©iÚ
();

5099 
´iv©e
 
Bud”
(

5100 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

5101 
su³r
(
·»Á
);

5102 
maybeFÜûBud”In™Ÿliz©iÚ
();

5104 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

5105 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5106 .
	g®waysU£F›ldBud”s
) {

5109 
public
 
Bud”
 
ş—r
() {

5110 
	gsu³r
.
ş—r
();

5111 
	gchecksum_
 = 0;

5112 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

5113 
	gadd»ss_
 = 0L;

5114 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

5115  
	gthis
;

5118 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5119 
g‘DesütÜFÜTy³
() {

5120  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gš‹º®_¡©ic_TrimEÁry_desütÜ
;

5123 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
g‘DeçuÉIn¡ªûFÜTy³
() {

5124  
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gTrimEÁry
.
g‘DeçuÉIn¡ªû
();

5127 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
bud
() {

5128 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
	g»suÉ
 = 
budP¬tŸl
();

5129 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

5130 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

5132  
	g»suÉ
;

5135 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
budP¬tŸl
() {

5136 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.TrimEÁry(
this
);

5137 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

5138 
	gto_b™F›ld0_
 = 0;

5139 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

5140 
to_b™F›ld0_
 |= 0x00000001;

5142 
	g»suÉ
.
	gchecksum_
 = 
checksum_
;

5143 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

5144 
to_b™F›ld0_
 |= 0x00000002;

5146 
	g»suÉ
.
	gadd»ss_
 = 
add»ss_
;

5147 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

5148 
ÚBut
();

5149  
	g»suÉ
;

5152 
public
 
Bud”
 
şÚe
() {

5153  (
	gBud”
è
	gsu³r
.
şÚe
();

5155 
public
 
Bud”
 
£tF›ld
(

5156 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

5157 
Objeù
 
v®ue
) {

5158  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

5160 
public
 
Bud”
 
ş—rF›ld
(

5161 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

5162  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

5164 
public
 
Bud”
 
ş—rOÃof
(

5165 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

5166  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

5168 
public
 
Bud”
 
£tR•—‹dF›ld
(

5169 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

5170 
šdex
, 
Objeù
 
v®ue
) {

5171  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

5173 
public
 
Bud”
 
addR•—‹dF›ld
(

5174 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

5175 
Objeù
 
v®ue
) {

5176  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

5178 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

5179 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gTrimEÁry
) {

5180  
m”geFrom
((
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
)
Ùh”
);

5182 
	gsu³r
.
m”geFrom
(
Ùh”
);

5183  
	gthis
;

5187 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
 
Ùh”
) {

5188 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
.
g‘DeçuÉIn¡ªû
()è 
this
;

5189 ià(
	gÙh”
.
hasChecksum
()) {

5190 
£tChecksum
(
Ùh”
.
g‘Checksum
());

5192 ià(
	gÙh”
.
hasAdd»ss
()) {

5193 
£tAdd»ss
(
Ùh”
.
g‘Add»ss
());

5195 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

5196 
ÚChªged
();

5197  
	gthis
;

5200 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

5201  
	gŒue
;

5204 
public
 
Bud”
 
m”geFrom
(

5205 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5206 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5207 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5208 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
	g·r£dMes§ge
 = 
nuÎ
;

5209 
	gŒy
 {

5210 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

5211 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

5212 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
è
e
.
g‘UnfšishedMes§ge
();

5213 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

5214 } 
	gfš®ly
 {

5215 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

5216 
m”geFrom
(
·r£dMes§ge
);

5219  
	gthis
;

5221 
´iv©e
 
	gb™F›ld0_
;

5223 
´iv©e
 
	gchecksum_
 ;

5227 
public
 
boŞ—n
 
hasChecksum
() {

5228  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

5233 
public
 
g‘Checksum
() {

5234  
	gchecksum_
;

5239 
public
 
Bud”
 
£tChecksum
(
v®ue
) {

5240 
	gb™F›ld0_
 |= 0x00000001;

5241 
	gchecksum_
 = 
v®ue
;

5242 
ÚChªged
();

5243  
	gthis
;

5248 
public
 
Bud”
 
ş—rChecksum
() {

5249 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

5250 
	gchecksum_
 = 0;

5251 
ÚChªged
();

5252  
	gthis
;

5255 
´iv©e
 
	gadd»ss_
 ;

5259 
public
 
boŞ—n
 
hasAdd»ss
() {

5260  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

5265 
public
 
g‘Add»ss
() {

5266  
	gadd»ss_
;

5271 
public
 
Bud”
 
£tAdd»ss
(
v®ue
) {

5272 
	gb™F›ld0_
 |= 0x00000002;

5273 
	gadd»ss_
 = 
v®ue
;

5274 
ÚChªged
();

5275  
	gthis
;

5280 
public
 
Bud”
 
ş—rAdd»ss
() {

5281 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

5282 
	gadd»ss_
 = 0L;

5283 
ÚChªged
();

5284  
	gthis
;

5286 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

5287 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

5288  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

5291 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

5292 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

5293  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

5301 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
	gDEFAULT_INSTANCE
;

5303 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
fÜm©
.
Ty³s
.
TrimEÁry
();

5306 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
g‘DeçuÉIn¡ªû
() {

5307  
	gDEFAULT_INSTANCE
;

5310 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTrimEÁry
>

5311 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TrimEÁry
>() {

5312 
public
 
TrimEÁry
 
·r£P¬tŸlFrom
(

5313 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5314 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5315 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

5316  
Ãw
 
TrimEÁry
(
šput
, 
ex‹nsiÚRegi¡ry
);

5320 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTrimEÁry
> 
·r£r
() {

5321  
	gPARSER
;

5324 @
	gjava
.
	gÏng
.
Ov”ride


5325 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTrimEÁry
> 
g‘P¬£rFÜTy³
() {

5326  
	gPARSER
;

5329 
public
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
TrimEÁry
 
g‘DeçuÉIn¡ªûFÜTy³
() {

5330  
	gDEFAULT_INSTANCE
;

5335 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5336 
	gš‹º®_¡©ic_D©aRªk_desütÜ
;

5337 
´iv©e
 
fš®


5338 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5339 
	gš‹º®_¡©ic_D©aRªk_f›ldAcûssÜTabË
;

5340 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5341 
	gš‹º®_¡©ic_LogEÁry_desütÜ
;

5342 
´iv©e
 
fš®


5343 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5344 
	gš‹º®_¡©ic_LogEÁry_f›ldAcûssÜTabË
;

5345 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5346 
	gš‹º®_¡©ic_LogEÁry_LogiÿlAdd»s£sEÁry_desütÜ
;

5347 
´iv©e
 
fš®


5348 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5349 
	gš‹º®_¡©ic_LogEÁry_LogiÿlAdd»s£sEÁry_f›ldAcûssÜTabË
;

5350 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5351 
	gš‹º®_¡©ic_LogEÁry_Backpoš‹rsEÁry_desütÜ
;

5352 
´iv©e
 
fš®


5353 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5354 
	gš‹º®_¡©ic_LogEÁry_Backpoš‹rsEÁry_f›ldAcûssÜTabË
;

5355 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5356 
	gš‹º®_¡©ic_LogH—d”_desütÜ
;

5357 
´iv©e
 
fš®


5358 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5359 
	gš‹º®_¡©ic_LogH—d”_f›ldAcûssÜTabË
;

5360 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5361 
	gš‹º®_¡©ic_M‘ad©a_desütÜ
;

5362 
´iv©e
 
fš®


5363 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5364 
	gš‹º®_¡©ic_M‘ad©a_f›ldAcûssÜTabË
;

5365 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5366 
	gš‹º®_¡©ic_TrimEÁry_desütÜ
;

5367 
´iv©e
 
fš®


5368 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5369 
	gš‹º®_¡©ic_TrimEÁry_f›ldAcûssÜTabË
;

5371 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


5372 
	$g‘DesütÜ
() {

5373  
desütÜ
;

5374 
	}
}

5375 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


5376 
	gdesütÜ
;

5378 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

5409 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

5410 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

5411 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

5412 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

5413 
desütÜ
 = 
roÙ
;

5414  
	gnuÎ
;

5417 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


5418 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

5419 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

5420 }, 
assigÃr
);

5421 
	gš‹º®_¡©ic_D©aRªk_desütÜ
 =

5422 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

5423 
	gš‹º®_¡©ic_D©aRªk_f›ldAcûssÜTabË
 = 
Ãw


5424 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5425 
š‹º®_¡©ic_D©aRªk_desütÜ
,

5426 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Rank", "UuidMostSignificant", "UuidLeastSignificant", });

5427 
	gš‹º®_¡©ic_LogEÁry_desütÜ
 =

5428 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

5429 
	gš‹º®_¡©ic_LogEÁry_f›ldAcûssÜTabË
 = 
Ãw


5430 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5431 
š‹º®_¡©ic_LogEÁry_desütÜ
,

5432 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "DataType", "Data", "GlobalAddress", "Streams", "LogicalAddresses", "Backpointers", "Rank", "CheckpointEntryType", "CheckpointIdMostSignificant", "CheckpointIdLeastSignificant", "CheckpointedStreamIdMostSignificant", "CheckpointedStreamIdLeastSignificant", "CheckpointedStreamStartLogAddress", "ClientIdLeastSignificant", "ClientIdMostSignificant", "ThreadId", "CodecType", });

5433 
	gš‹º®_¡©ic_LogEÁry_LogiÿlAdd»s£sEÁry_desütÜ
 =

5434 
š‹º®_¡©ic_LogEÁry_desütÜ
.
g‘Ne¡edTy³s
().
g‘
(0);

5435 
	gš‹º®_¡©ic_LogEÁry_LogiÿlAdd»s£sEÁry_f›ldAcûssÜTabË
 = 
Ãw


5436 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5437 
š‹º®_¡©ic_LogEÁry_LogiÿlAdd»s£sEÁry_desütÜ
,

5438 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Key", "Value", });

5439 
	gš‹º®_¡©ic_LogEÁry_Backpoš‹rsEÁry_desütÜ
 =

5440 
š‹º®_¡©ic_LogEÁry_desütÜ
.
g‘Ne¡edTy³s
().
g‘
(1);

5441 
	gš‹º®_¡©ic_LogEÁry_Backpoš‹rsEÁry_f›ldAcûssÜTabË
 = 
Ãw


5442 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5443 
š‹º®_¡©ic_LogEÁry_Backpoš‹rsEÁry_desütÜ
,

5444 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Key", "Value", });

5445 
	gš‹º®_¡©ic_LogH—d”_desütÜ
 =

5446 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(2);

5447 
	gš‹º®_¡©ic_LogH—d”_f›ldAcûssÜTabË
 = 
Ãw


5448 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5449 
š‹º®_¡©ic_LogH—d”_desütÜ
,

5450 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Version", "VerifyChecksum", });

5451 
	gš‹º®_¡©ic_M‘ad©a_desütÜ
 =

5452 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(3);

5453 
	gš‹º®_¡©ic_M‘ad©a_f›ldAcûssÜTabË
 = 
Ãw


5454 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5455 
š‹º®_¡©ic_M‘ad©a_desütÜ
,

5456 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "PayloadChecksum", "LengthChecksum", "Length", });

5457 
	gš‹º®_¡©ic_TrimEÁry_desütÜ
 =

5458 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(4);

5459 
	gš‹º®_¡©ic_TrimEÁry_f›ldAcûssÜTabË
 = 
Ãw


5460 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

5461 
š‹º®_¡©ic_TrimEÁry_desütÜ
,

5462 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Checksum", "Address", });

	@generator/src/main/java/org/corfudb/generator/Correctness.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
;

3 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLogg”
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

5 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

10 
public
 cÏs 
	cCÜ»ùÃss
 {

12 
´iv©e
 
	$CÜ»ùÃss
() {

13 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Utility class");

16 
´iv©e
 
fš®
 
SŒšg
 
TX_PATTERN
 = "%s, %s";

17 
´iv©e
 
fš®
 
SŒšg
 
TX_PATTERN_VERSION
 = "%s, %s, %s";

18 
public
 
fš®
 
SŒšg
 
TX_START
 = "start";

19 
public
 
fš®
 
SŒšg
 
TX_END
 = "end";

20 
public
 
fš®
 
SŒšg
 
TX_ABORTED
 = "aborted";

22 
´iv©e
 
fš®
 
Logg”
 
cÜ»ùÃssLogg”
 = (Logg”è
Logg”FaùÜy
.
	`g‘Logg”
("correctness");

24 
public
 
	$»cÜdO³¿tiÚ
(
SŒšg
 
İ”©iÚ
, 
boŞ—n
 
Œª§ùiÚP»fix
) {

25 ià(
Œª§ùiÚP»fix
) {

26 
SŒšg
 
txO³¿tiÚ
 = "Tx" + 
İ”©iÚ
;

27 
cÜ»ùÃssLogg”
.
	`šfo
("{}, {}", 
txO³¿tiÚ
,

28 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`g‘SÇpshÙTime¡amp
().
	`g‘Sequ’û
());

30 
cÜ»ùÃssLogg”
.
	`šfo
(
İ”©iÚ
);

32 
	}
}

41 
public
 
	$»cÜdT¿n§ùiÚM¬k”s
(
boŞ—n
 
v”siÚ
, 
SŒšg
... 
f›lds
) {

42 ià(
v”siÚ
) {

43 
	`»cÜdO³¿tiÚ
(
SŒšg
.
	`fÜm©
(
TX_PATTERN_VERSION
, 
f›lds
[0], f›lds[1], f›lds[2]), 
çl£
);

45 
	`»cÜdO³¿tiÚ
(
SŒšg
.
	`fÜm©
(
TX_PATTERN
, 
f›lds
[0], f›lds[1]), 
çl£
);

47 
	}
}

	@generator/src/main/java/org/corfudb/generator/Generator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
;

3 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gCheckpoštO³¿tiÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gO³¿tiÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
.
	gÃwWÜkS‹®šgPoŞ
;

25 
public
 cÏs 
	cG’”©Ü
 {

26 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

27 
SŒšg
 
’dPošt
 = 
¬gs
[0];

28 
numSŒ—ms
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[1]);

29 
numKeys
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[2]);

30 
ıP”iod
 = 
LÚg
.
	`·r£LÚg
(
¬gs
[3]);

31 
numTh»ads
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[4]);

32 
numO³¿tiÚs
 = 
IÁeg”
.
	`·r£IÁ
(
¬gs
[5]);

34 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
’dPošt
).
	`cÚÃù
();

36 
S‹
 
¡©e
 = 
Ãw
 
	`S‹
(
numSŒ—ms
, 
numKeys
, 
¹
);

38 
RuÂabË
 
ıTrimTask
 = () -> {

39 
O³¿tiÚ
 
İ
 = 
Ãw
 
	`CheckpoštO³¿tiÚ
(
¡©e
);

40 
İ
.
	`execu‹
();

43 
fš®
 
ScheduËdExecutÜS”viû
 
scheduËr
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(1);

44 
scheduËr
.
	`scheduËAtFixedR©e
(
ıTrimTask
, 30, 
ıP”iod
, 
TimeUn™
.
SECONDS
);

46 
ExecutÜS”viû
 
­pWÜk”s
 = 
	`ÃwWÜkS‹®šgPoŞ
(
numTh»ads
);

48 
RuÂabË
 
­p
 = () -> {

49 
Li¡
<
O³¿tiÚ
> 
İ”©iÚs
 = 
¡©e
.
	`g‘O³¿tiÚs
().
	`§m¶e
(
numO³¿tiÚs
);

50 
O³¿tiÚ
 
İ”©iÚ
 : 
İ”©iÚs
) {

51 
Œy
 {

52 
İ”©iÚ
.
	`execu‹
();

53 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

54 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
ex
);

59 
Futu»
[] 
­psFutu»s
 = 
Ãw
 Futu»[
numTh»ads
];

61 
x
 = 0; x < 
numTh»ads
; x++) {

62 
­psFutu»s
[
x
] = 
­pWÜk”s
.
	`subm™
(
­p
);

65 
x
 = 0; x < 
numTh»ads
; x++) {

66 
Œy
 {

67 
­psFutu»s
[
x
].
	`g‘
();

68 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

69 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

73 
	}
}

	@generator/src/main/java/org/corfudb/generator/LongevityApp.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gCheckpoštO³¿tiÚ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gO³¿tiÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gSy¡emUÇvaabËE¼Ü
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gA¼ayBlockšgQueue
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gBlockšgQueue
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

30 @
Slf4j


31 
public
 cÏs 
	cLÚgev™yAµ
 {

32 
´iv©e
 
fš®
 
	mdu¿tiÚMs
;

33 
´iv©e
 
fš®
 
boŞ—n
 
	mcheckPošt
;

34 
fš®
 
	mBlockšgQueue
<
	mO³¿tiÚ
> 
	mİ”©iÚQueue
;

35 
fš®
 
CÜfuRuÁime
 
	m¹
;

36 
fš®
 
S‹
 
	m¡©e
;

38 
fš®
 
ExecutÜS”viû
 
	mskProduûr
;

39 
fš®
 
ScheduËdExecutÜS”viû
 
	mcheckpoš‹r
;

40 
fš®
 
ExecutÜS”viû
 
	mwÜk”s
;

44 
fš®
 
	mAPPLICATION_TIMEOUT_IN_MS
 = 10000;

45 
fš®
 
	mTIME_TO_WAIT_FOR_RUNTIME_TO_CONNECT
 = 60000;

47 
fš®
 
	mQUEUE_CAPACITY
 = 1000;

49 
	m¡¬tTime
;

50 
fš®
 
	mnumb”Th»ads
;

53 
public
 
	$LÚgev™yAµ
(
du¿tiÚMs
, 
numb”Th»ads
, 
SŒšg
 
cÚfigu¿tiÚSŒšg
, 
boŞ—n
 
checkPošt
) {

54 
this
.
du¿tiÚMs
 = durationMs;

55 
this
.
checkPošt
 = checkPoint;

56 
this
.
numb”Th»ads
 =‚umberThreads;

58 
İ”©iÚQueue
 = 
Ãw
 
A¼ayBlockšgQueue
<>(
QUEUE_CAPACITY
);

60 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
cÚfigu¿tiÚSŒšg
);

62 
Œy
 {

63 
	`ŒyToCÚÃùTimeout
(
TIME_TO_WAIT_FOR_RUNTIME_TO_CONNECT
);

64 } 
	`ÿtch
 (
Sy¡emUÇvaabËE¼Ü
 
e
) {

65 
Sy¡em
.
	`ex™
(1);

69 
¡©e
 = 
Ãw
 
	`S‹
(50, 100, 
¹
);

71 
skProduûr
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
();

73 
wÜk”s
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numb”Th»ads
);

74 
checkpoš‹r
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(1);

87 
´iv©e
 
boŞ—n
 
	$liv’essSucûss
(
boŞ—n
 
fšishedInTime
) {

88 ià(!
fšishedInTime
) {

89  
çl£
;

92 
timeSšûSucûssfulR—dO³¿tiÚ
 = 
Sy¡em
.
	`cu¼’tTimeMlis
()

93 - 
¡©e
.
	`g‘La¡SucûssfulR—dO³¿tiÚTime¡amp
();

94 
timeSšûSucûssfulWr™eO³¿tiÚ
 = 
Sy¡em
.
	`cu¼’tTimeMlis
()

95 - 
¡©e
.
	`g‘La¡SucûssfulWr™eO³¿tiÚTime¡amp
();

97  (
timeSšûSucûssfulR—dO³¿tiÚ
 < 
APPLICATION_TIMEOUT_IN_MS


98 && 
timeSšûSucûssfulWr™eO³¿tiÚ
 < 
APPLICATION_TIMEOUT_IN_MS
);

99 
	}
}

112 
´iv©e
 
	$wa™FÜAµToFšish
() {

113 
wÜk”s
.
	`shutdown
();

114 
Œy
 {

115 
boŞ—n
 
fšishedInTime
 = 
wÜk”s
.

116 
	`awa™T”mš©iÚ
(
du¿tiÚMs
 + 
APPLICATION_TIMEOUT_IN_MS
, 
TimeUn™
.
MILLISECONDS
);

118 
SŒšg
 
liv’essS‹
 = 
	`liv’essSucûss
(
fšishedInTime
) ? "Success" : "Fail";

120 
CÜ»ùÃss
.
	`»cÜdO³¿tiÚ
("Liv’ess, " + 
liv’essS‹
, 
çl£
);

121 ià(!
fšishedInTime
) {

122 
Sy¡em
.
	`ex™
(1);

124 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

125 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
e
);

126 } 
fš®ly
 {

127 
skProduûr
.
	`shutdownNow
();

128 
checkpoš‹r
.
	`shutdownNow
();

130 
boŞ—n
 
checkpoštHasFšished
 = 
çl£
;

131 
ex™Stus
;

132 
Œy
 {

133 
checkpoštHasFšished
 = 
checkpoš‹r
.
	`awa™T”mš©iÚ
(
APPLICATION_TIMEOUT_IN_MS
, 
TimeUn™
.
MILLISECONDS
);

134 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

135 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
e
);

138 
ex™Stus
 = 
checkpoštHasFšished
 ? 0 : 1;

139 
Sy¡em
.
	`ex™
(
ex™Stus
);

141 
	}
}

148 
´iv©e
 
boŞ—n
 
	$w™hšDu¿tiÚLim™
() {

149  
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
 < 
du¿tiÚMs
;

150 
	}
}

160 
´iv©e
 
	$runTaskProduûr
() {

161 
skProduûr
.
	`execu‹
(() -> {

162 
Œue
) {

163 
O³¿tiÚ
 
cu¼’t
 = 
¡©e
.
	`g‘O³¿tiÚs
().
	`g‘RªdomO³¿tiÚ
();

164 
Œy
 {

165 
İ”©iÚQueue
.
	`put
(
cu¼’t
);

166 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

167 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
e
);

168 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

169 
log
.
	`”rÜ
("İ”©iÚƒ¼Ü", 
e
);

174 
	}
}

182 
´iv©e
 
	$runTaskCÚsum”s
() {

184 
i
 = 0; i < 
numb”Th»ads
; i++) {

185 
wÜk”s
.
	`execu‹
(() -> {

186 
	`w™hšDu¿tiÚLim™
()) {

187 
Œy
 {

188 
O³¿tiÚ
 
İ
 = 
İ”©iÚQueue
.
	`ke
();

189 
İ
.
	`execu‹
();

190 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

191 
log
.
	`”rÜ
("O³¿tiÚ faed w™h", 
e
);

196 
	}
}

202 
´iv©e
 
	$runCpTrimTask
() {

203 
RuÂabË
 
ıTrimTask
 = () -> {

204 
O³¿tiÚ
 
İ
 = 
Ãw
 
	`CheckpoštO³¿tiÚ
(
¡©e
);

205 
İ
.
	`execu‹
();

207 
checkpoš‹r
.
	`scheduËAtFixedR©e
(
ıTrimTask
, 30, 20, 
TimeUn™
.
SECONDS
);

208 
	}
}

217 
´iv©e
 
	$ŒyToCÚÃùTimeout
 (
timeoutInMs
è
throws
 
Sy¡emUÇvaabËE¼Ü
 {

218 
Œy
 {

219 
Com¶‘abËFutu»
.
	`suµlyAsync
((è-> 
¹
.
	`cÚÃù
()).
	`g‘
(
timeoutInMs
, 
TimeUn™
.
MILLISECONDS
);

220 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

221 
CÜ»ùÃss
.
	`»cÜdO³¿tiÚ
("Liv’ess, " + 
çl£
, false);

222 
throw
 
Ãw
 
	`Sy¡emUÇvaabËE¼Ü
(
e
.
	`g‘Mes§ge
());

224 
	}
}

227 
public
 
	$runLÚgev™yTe¡
() {

228 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

230 ià(
checkPošt
) {

231 
	`runCpTrimTask
();

234 
	`runTaskProduûr
();

235 
	`runTaskCÚsum”s
();

237 
	`wa™FÜAµToFšish
();

238 
	}
}

	@generator/src/main/java/org/corfudb/generator/LongevityRun.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

5 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLev–
;

6 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLogg”
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLše
;

11 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gCommªdLšeP¬£r
;

12 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gDeçuÉP¬£r
;

13 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gH–pFÜm©‹r
;

14 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gO±iÚ
;

15 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gO±iÚs
;

16 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gşi
.
	gP¬£Exû±iÚ
;

17 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

27 @
Slf4j


28 
public
 cÏs 
	cLÚgev™yRun
 {

29 
´iv©e
 
fš®
 
SŒšg
 
	mTIME_UNIT
 = "time_unit";

30 
´iv©e
 
fš®
 
SŒšg
 
	mTIME_AMOUNT
 = "time_amount";

31 
´iv©e
 
fš®
 
SŒšg
 
	mCORFU_ENDPOINT
 = "corfu_endpoint";

32 
´iv©e
 
fš®
 
SŒšg
 
	mCHECKPOINT
 = "checkpoint";

36 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

37 
Logg”
 
roÙ
 = (Logg”è
Logg”FaùÜy
.
	`g‘Logg”
(Logg”.
ROOT_LOGGER_NAME
);

38 
roÙ
.
	`£tLev–
(
Lev–
.
INFO
);

40 
lÚgev™y
;

42 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
();

44 
O±iÚ
 
amouÁTime
 = 
Ãw
 
	`O±iÚ
("t", 
TIME_AMOUNT
, 
Œue
, "time‡mount");

45 
amouÁTime
.
	`£tRequœed
(
Œue
);

46 
O±iÚ
 
timeUn™
 = 
Ãw
 
	`O±iÚ
("u", 
TIME_UNIT
, 
Œue
, "time unit (s, m, h)");

47 
timeUn™
.
	`£tRequœed
(
Œue
);

48 
O±iÚ
 
cÜfuEndpošt
 = 
Ãw
 
	`O±iÚ
("c", 
CORFU_ENDPOINT
, 
Œue
,

50 
O±iÚ
 
checkPoštFÏg
 = 
Ãw
 
	`O±iÚ
("ı", 
CHECKPOINT
, 
çl£
,

53 
İtiÚs
.
	`addO±iÚ
(
amouÁTime
);

54 
İtiÚs
.
	`addO±iÚ
(
timeUn™
);

55 
İtiÚs
.
	`addO±iÚ
(
cÜfuEndpošt
);

56 
İtiÚs
.
	`addO±iÚ
(
checkPoštFÏg
);

60 
CommªdLšeP¬£r
 
·r£r
 = 
Ãw
 
	`DeçuÉP¬£r
();

61 
H–pFÜm©‹r
 
fÜm©‹r
 = 
Ãw
 
	`H–pFÜm©‹r
();

62 
CommªdLše
 
cmd
;

64 
Œy
 {

65 
cmd
 = 
·r£r
.
	`·r£
(
İtiÚs
, 
¬gs
);

66 
SŒšg
 
timeUn™V®ue
 = 
cmd
.
	`g‘O±iÚV®ue
(
TIME_UNIT
);

67 ià(!
timeUn™V®ue
.
	`equ®s
("m") &&

68 !
timeUn™V®ue
.
	`equ®s
("s") &&

69 !
timeUn™V®ue
.
	`equ®s
("h")){

70 
throw
 
Ãw
 
	`P¬£Exû±iÚ
("Time unit should be {s,m,h}");

72 } 
	`ÿtch
 (
P¬£Exû±iÚ
 
e
) {

73 
log
.
	`šfo
(
e
.
	`g‘Mes§ge
());

74 
fÜm©‹r
.
	`´štH–p
("lÚgev™y", 
İtiÚs
);

76 
Sy¡em
.
	`ex™
(1);

80 
amouÁTimeV®ue
 = 
LÚg
.
	`·r£LÚg
(
cmd
.
	`g‘O±iÚV®ue
(
TIME_AMOUNT
));

81 
SŒšg
 
timeUn™V®ue
 = 
cmd
.
	`g‘O±iÚV®ue
(
TIME_UNIT
);

83 
SŒšg
 
cÚfigu¿tiÚSŒšg
 = 
cmd
.
	`hasO±iÚ
(
CORFU_ENDPOINT
) ?

84 
cmd
.
	`g‘O±iÚV®ue
(
CORFU_ENDPOINT
) : "localhost:9000";

86 
boŞ—n
 
checkPošt
 = 
cmd
.
	`hasO±iÚ
(
CHECKPOINT
) ?

87 
Œue
 : 
çl£
;

89 
timeUn™V®ue
) {

91 
lÚgev™y
 = 
Du¿tiÚ
.
	`ofSecÚds
(
amouÁTimeV®ue
).
	`toMlis
();

94 
lÚgev™y
 = 
Du¿tiÚ
.
	`ofMšu‹s
(
amouÁTimeV®ue
).
	`toMlis
();

97 
lÚgev™y
 = 
Du¿tiÚ
.
	`ofHours
(
amouÁTimeV®ue
).
	`toMlis
();

100 
lÚgev™y
 = 
Du¿tiÚ
.
	`ofHours
(1).
	`toMlis
();

103 
LÚgev™yAµ
 
Ï
 = 
Ãw
 
	`LÚgev™yAµ
(
lÚgev™y
, 10, 
cÚfigu¿tiÚSŒšg
, 
checkPošt
);

104 
Ï
.
	`runLÚgev™yTe¡
();

106 
	}
}

	@generator/src/main/java/org/corfudb/generator/State.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

5 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

9 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
.
	gKeys
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
.
	gO³¿tiÚCouÁ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
.
	gO³¿tiÚs
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
.
	gSŒ—ms
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

20 
impÜt
 
	glombok
.
	gG‘‹r
;

21 
impÜt
 
	glombok
.
	gS‘‹r
;

28 
public
 cÏs 
	cS‹
 {

30 @
G‘‹r


31 
fš®
 
SŒ—ms
 
	m¡»ams
;

33 @
G‘‹r


34 
fš®
 
Keys
 
	mkeys
;

36 @
G‘‹r


37 
fš®
 
O³¿tiÚCouÁ
 
	mİ”©iÚCouÁ
;

39 @
G‘‹r


40 
fš®
 
O³¿tiÚs
 
	mİ”©iÚs
;

42 @
G‘‹r


43 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

45 @
G‘‹r


46 
fš®
 
	mM­
<
	mUUID
, 
	mCÜfuTabË
> 
	mm­s
;

48 @
	mG‘‹r


49 @
S‘‹r


50 vŞ©
	mÏ¡SucûssfulR—dO³¿tiÚTime¡amp
 = -1;

52 @
	mG‘‹r


53 @
S‘‹r


54 vŞ©
	mÏ¡SucûssfulWr™eO³¿tiÚTime¡amp
 = -1;

56 @
G‘‹r


57 vŞ©
Tok’
 
	mŒimM¬k
 = Tok’.
UNINITIALIZED
;

59 
public
 
fš®
 
Rªdom
 
	m¿nd
;

61 
public
 
	$S‹
(
numSŒ—ms
, 
numKeys
, 
CÜfuRuÁime
 
¹
) {

62 
¿nd
 = 
Ãw
 
	`Rªdom
();

64 
¡»ams
 = 
Ãw
 
	`SŒ—ms
(
numSŒ—ms
);

65 
keys
 = 
Ãw
 
	`Keys
(
numKeys
);

66 
İ”©iÚCouÁ
 = 
Ãw
 
	`O³¿tiÚCouÁ
();

68 
this
.
ruÁime
 = 
¹
;

69 
m­s
 = 
Ãw
 
HashM­
<>();

70 
İ”©iÚs
 = 
Ãw
 
	`O³¿tiÚs
(
this
);

72 
¡»ams
.
	`pİuÏ‹
();

73 
keys
.
	`pİuÏ‹
();

74 
İ”©iÚCouÁ
.
	`pİuÏ‹
();

75 
İ”©iÚs
.
	`pİuÏ‹
();

77 
	`İ’Objeùs
();

80 
public
 
	$upd©eTrimM¬k
(
Tok’
 
ÃwTrimM¬k
) {

81 ià(
ÃwTrimM¬k
.
	`com·»To
(
ŒimM¬k
) > 0) {

82 
ŒimM¬k
 = 
ÃwTrimM¬k
;

84 
	}
}

86 
´iv©e
 
	$İ’Objeùs
() {

87 
SŒšg
 
id
: 
¡»ams
.
	`g‘D©aS‘
()) {

88 
UUID
 
uuid
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
id
);

89 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

90 .
	`bud
()

91 .
	`£tSŒ—mID
(
uuid
)

92 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

93 .
	`£tArgum’ts
(
Ãw
 
	`SŒšgIndex”
())

94 .
	`İ’
();

96 
m­s
.
	`put
(
uuid
, 
m­
);

98 
	}
}

100 
public
 
	gM­
<
	gSŒšg
, SŒšg> 
	$g‘M­
(
UUID
 
uuid
) {

101 
M­
 
m­
 = 
m­s
.
	`g‘
(
uuid
);

102 ià(
m­
 =ğ
nuÎ
) {

103 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Map doesn'tƒxist");

105  
m­s
.
	`g‘
(
uuid
);

106 
	}
}

108 
public
 
	gCŞËùiÚ
<
	gCÜfuTabË
> 
	$g‘M­s
() {

109  
m­s
.
	`v®ues
();

110 
	}
}

112 
public
 
	$¡¬tO±imi¡icTx
() {

113 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

114 
	}
}

116 
public
 
	$¡İTx
() {

117  
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

118 
	}
}

120 
public
 
	$¡¬tSÇpshÙTx
() {

121 
ruÁime
.
	`g‘ObjeùsV›w
()

122 .
	`TXBud
()

123 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

124 .
	`bud
()

125 .
	`begš
();

126 
	}
}

128 
public
 
	$¡¬tWr™eAá”Wr™eTx
() {

129 
ruÁime
.
	`g‘ObjeùsV›w
()

130 .
	`TXBud
()

131 .
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
)

132 .
	`bud
()

133 .
	`begš
();

134 
	}
}

	@generator/src/main/java/org/corfudb/generator/StringIndexer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gIndex
;

5 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

6 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

7 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

9 
public
 
şass
 
SŒšgIndex”
 
im¶em’ts
 
	gIndex
.
	gRegi¡ry
<
	gSŒšg
, String> {

11 
public
 
fš®
 
	gIndex
.
Name
 
	gBY_VALUE
 = () -> "BY_VALUE";

12 
public
 
fš®
 
	gIndex
.
Name
 
	gBY_FIRST_CHAR
 = () -> "BY_FIRST_LETTER";

14 
´iv©e
 
fš®
 
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>> 
	gBY_VALUE_INDEX
 =

15 
Ãw
 
Index
.
S³c
<>(

16 
BY_VALUE
,

17 (
	gIndex
.
	gFunùiÚ
<
	gSŒšg
, SŒšg, SŒšg>è(
	gkey
, 
	gv®
) -> val);

19 
´iv©e
 
fš®
 
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>> 
	gBY_FIRST_CHAR_INDEX
 =

20 
Ãw
 
Index
.
S³c
<>(

21 
BY_FIRST_CHAR
,

22 (
	gIndex
.
	gFunùiÚ
<
	gSŒšg
, SŒšg, SŒšg>è(
	gkey
, 
	gv®
) ->

23 
	gCh¬aù”
.
toSŒšg
(
v®
.
ch¬At
(0)));

25 @
Ov”ride


26 
public
 
	gI‹¿tÜ
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
™”©Ü
() {

27  
	gSŒ—m
.
of
(
BY_VALUE_INDEX
, 
BY_FIRST_CHAR_INDEX
).
™”©Ü
();

30 @
Ov”ride


31 
public
 
	gO±iÚ®
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
g‘
(
Index
.
Name
 
Çme
) {

32 
SŒšg
 
	gšdexName
 = (
Çme
 !ğ
nuÎ
)?‚ame.
g‘
() :‚ull;

34 ià(
	gBY_VALUE
.
g‘
().
equ®s
(
šdexName
)) {

35  
	gO±iÚ®
.
of
(
BY_VALUE_INDEX
);

37 } ià(
	gBY_FIRST_CHAR
.
g‘
().
equ®s
(
šdexName
)) {

38  
	gO±iÚ®
.
of
(
BY_FIRST_CHAR_INDEX
);

40  
	gO±iÚ®
.
em±y
();

	@generator/src/main/java/org/corfudb/generator/distributions/DataSet.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

14 
public
 
š‹rçû
 
	gD©aS‘
 {

19 
pİuÏ‹
();

29  
Li¡
 
§m¶e
(
num
) {

30 
Li¡
 
	g»t
 = 
Ãw
 
A¼ayLi¡
<>();

31 
Rªdom
 
	g¿ndom
 = 
Ãw
 Random();

33 
	gx
 = 0; x < 
	gnum
; x++) {

34 
	g»t
.
add
(
g‘D©aS‘
().
g‘
(
¿ndom
.
ÃxtIÁ
(g‘D©aS‘().
size
())));

37  
	g»t
;

44 
Li¡
 
g‘D©aS‘
();

	@generator/src/main/java/org/corfudb/generator/distributions/Keys.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
public
 cÏs 
	cKeys
 
im¶em’ts
 
	mD©aS‘
 {

15 
fš®
 
	mS‘
<
	mSŒšg
> 
	mm­keys
;

16 
fš®
 
	mnumKeys
;

18 
public
 
	$Keys
(
num
) {

19 
m­keys
 = 
Ãw
 
HashS‘
<>();

20 
numKeys
 = 
num
;

23 @
Ov”ride


24 
public
 
	$pİuÏ‹
() {

25 
x
 = 0; x < 
numKeys
; x++) {

26 
m­keys
.
	`add
("key_" + 
IÁeg”
.
	`toSŒšg
(
x
));

28 
	}
}

30 @
Ov”ride


31 
public
 
	gLi¡
<
	gSŒšg
> 
	$g‘D©aS‘
() {

32  
Ãw
 
A¼ayLi¡
<>(
m­keys
);

33 
	}
}

	@generator/src/main/java/org/corfudb/generator/distributions/OperationCount.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

13 
public
 cÏs 
	cO³¿tiÚCouÁ
 
im¶em’ts
 
	mD©aS‘
 {

14 
´iv©e
 
fš®
 
Rªdom
 
	m¿nd
 = 
Ãw
 Random();

16 
public
 
	$pİuÏ‹
() {

20 @
Ov”ride


21 
public
 
Li¡
<
IÁeg”
> 
	$§m¶e
(
num
) {

22 
Li¡
<
IÁeg”
> 
šts
 = 
Ãw
 
A¼ayLi¡
<>();

23 
x
 = 0; x < 
num
; x++) {

24 
šts
.
	`add
(
¿nd
.
	`ÃxtIÁ
(100) + 1);

26  
šts
;

27 
	}
}

29 
public
 
Li¡
 
	$g‘D©aS‘
() {

30  
A¼ays
.
	`asLi¡
();

31 
	}
}

	@generator/src/main/java/org/corfudb/generator/distributions/Operations.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gO³¿tiÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gO±imi¡icTxO³¿tiÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gR—dO³¿tiÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gRemoveO³¿tiÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gSË•O³¿tiÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gSÇpshÙTxO³¿tiÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
.
	gWr™eO³¿tiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
public
 cÏs 
	cO³¿tiÚs
 
im¶em’ts
 
	mD©aS‘
 {

23 
´iv©e
 
fš®
 
S‹
 
	m¡©e
;

24 
fš®
 
	mLi¡
<
	mO³¿tiÚ
> 
	m®lO³¿tiÚs
;

26 
public
 
	$O³¿tiÚs
(
S‹
 
¡©e
) {

27 
®lO³¿tiÚs
 = 
ImmubËLi¡
.
	`of
(

28 
Ãw
 
	`Wr™eO³¿tiÚ
(
¡©e
),

29 
Ãw
 
	`R—dO³¿tiÚ
(
¡©e
),

30 
Ãw
 
	`O±imi¡icTxO³¿tiÚ
(
¡©e
),

31 
Ãw
 
	`SÇpshÙTxO³¿tiÚ
(
¡©e
),

32 
Ãw
 
	`SË•O³¿tiÚ
(
¡©e
),

33 
Ãw
 
	`RemoveO³¿tiÚ
(
¡©e
));

36 
this
.
¡©e
 = state;

39 
public
 
	$pİuÏ‹
() {

41 
	}
}

43 
public
 
O³¿tiÚ
 
	$g‘RªdomO³¿tiÚ
() {

44  
®lO³¿tiÚs
.
	`g‘
(
¡©e
.
¿nd
.
	`ÃxtIÁ
×ÎO³¿tiÚs.
	`size
()));

45 
	}
}

47 
public
 
	gLi¡
<
	gO³¿tiÚ
> 
	$g‘D©aS‘
() {

48  
®lO³¿tiÚs
;

49 
	}
}

	@generator/src/main/java/org/corfudb/generator/distributions/Streams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gdi¡ributiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
public
 cÏs 
	cSŒ—ms
 
im¶em’ts
 
	mD©aS‘
 {

16 
fš®
 
	mS‘
<
	mSŒšg
> 
	m¡»amIds
;

17 
fš®
 
	mnumSŒ—ms
;

19 
public
 
	$SŒ—ms
(
num
) {

20 
¡»amIds
 = 
Ãw
 
HashS‘
<>();

21 
numSŒ—ms
 = 
num
;

24 @
Ov”ride


25 
public
 
	$pİuÏ‹
() {

26 
x
 = 0; x < 
numSŒ—ms
; x++) {

27 
¡»amIds
.
	`add
("bË_" + 
IÁeg”
.
	`toSŒšg
(
x
));

29 
	}
}

31 @
Ov”ride


32 
public
 
	gLi¡
<
	gSŒšg
> 
	$g‘D©aS‘
() {

33  
Ãw
 
A¼ayLi¡
<>(
¡»amIds
);

34 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/CheckpointOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 @
Slf4j


13 
public
 cÏs 
	cCheckpoštO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

15 
public
 
	$CheckpoštO³¿tiÚ
(
S‹
 
¡©e
) {

16 
	`su³r
(
¡©e
);

17 
shÜtName
 = "Checkpoint";

20 @
Ov”ride


21 @
	`Suµ»ssW¬nšgs
("checkstyle:ThreadSleep")

22 
public
 
	$execu‹
() {

23 
Œy
 {

29 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

30 
mcw
.
	`addAÎM­s
(
¡©e
.
	`g‘M­s
());

31 
Tok’
 
ŒimAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
¡©e
.
	`g‘RuÁime
(), "Maithem");

32 
¡©e
.
	`upd©eTrimM¬k
(
ŒimAdd»ss
);

33 
Th»ad
.
	`¦“p
(1000l * 30l * 1l);

34 
¡©e
.
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimAdd»ss
);

35 
¡©e
.
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`gc
();

36 
¡©e
.
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

37 
¡©e
.
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

42 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

43 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

45 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/NestedTxOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 @
Slf4j


14 
public
 cÏs 
	cNe¡edTxO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

16 
´iv©e
 
fš®
 
	mMAX_NEST
 = 20;

18 
public
 
	$Ne¡edTxO³¿tiÚ
(
S‹
 
¡©e
) {

19 
	`su³r
(
¡©e
);

20 
shÜtName
 = "TxNest";

23 @
Ov”ride


24 
public
 
	$execu‹
() {

25 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_START
);

26 
¡©e
.
	`¡¬tO±imi¡icTx
();

28 
numNe¡ed
 = 
¡©e
.
	`g‘O³¿tiÚCouÁ
().
	`§m¶e
(1).
	`g‘
(0);

29 
Ã¡edTxToStİ
 = 
numNe¡ed
;

30 
i
 = 0; i < 
numNe¡ed
 && i < 
MAX_NEST
; i++) {

31 
Œy
{

32 
¡©e
.
	`¡¬tO±imi¡icTx
();

33 
numO³¿tiÚs
 = 
¡©e
.
	`g‘O³¿tiÚCouÁ
().
	`§m¶e
(1).
	`g‘
(0);

34 
Li¡
<
O³¿tiÚ
> 
İ”©iÚs
 = 
¡©e
.
	`g‘O³¿tiÚs
().
	`§m¶e
(
numO³¿tiÚs
);

36 
x
 = 0; x < 
İ”©iÚs
.
	`size
(); x++) {

37 ià(
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
O±imi¡icTxO³¿tiÚ
 ||

38 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
SÇpshÙTxO³¿tiÚ


39 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
Ne¡edTxO³¿tiÚ
) {

42 
İ”©iÚs
.
	`g‘
(
x
).
	`execu‹
();

44 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

45 
log
.
	`w¬n
("T¿n§ùiÚ AbÜ‹d", 
e
);

46 
Ã¡edTxToStİ
--;

50 
i
 = 0; i < 
Ã¡edTxToStİ
; i++) {

51 
¡©e
.
	`¡İTx
();

53 
time¡amp
;

54 
Œy
 {

55 
time¡amp
 = 
¡©e
.
	`¡İTx
();

56 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
Œue
, 
shÜtName
, CÜ»ùÃss.
TX_END
,

57 
LÚg
.
	`toSŒšg
(
time¡amp
));

58 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

59 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_ABORTED
);

61 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/Operation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

11 
public
 
ab¡¿ù
 cÏs 
	cO³¿tiÚ
 {

12 
´Ùeùed
 
fš®
 
S‹
 
	m¡©e
;

13 
SŒšg
 
	mshÜtName
;

15 
public
 
	$O³¿tiÚ
(
S‹
 
¡©e
) {

16 
this
.
¡©e
 = state;

19 
public
 
ab¡¿ù
 
	`execu‹
();

20 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/OptimisticTxOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 @
Slf4j


16 
public
 cÏs 
	cO±imi¡icTxO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

18 
public
 
	$O±imi¡icTxO³¿tiÚ
(
S‹
 
¡©e
) {

19 
	`su³r
(
¡©e
);

20 
shÜtName
 = "TxOpt";

23 @
Ov”ride


24 
public
 
	$execu‹
() {

25 
Œy
 {

26 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_START
);

27 
time¡amp
;

28 
¡©e
.
	`¡¬tO±imi¡icTx
();

30 
numO³¿tiÚs
 = 
¡©e
.
	`g‘O³¿tiÚCouÁ
().
	`§m¶e
(1).
	`g‘
(0);

31 
Li¡
<
O³¿tiÚ
> 
İ”©iÚs
 = 
¡©e
.
	`g‘O³¿tiÚs
().
	`§m¶e
(
numO³¿tiÚs
);

33 
x
 = 0; x < 
İ”©iÚs
.
	`size
(); x++) {

34 ià(
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
O±imi¡icTxO³¿tiÚ


35 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
SÇpshÙTxO³¿tiÚ


36 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
Ne¡edTxO³¿tiÚ
)

41 
İ”©iÚs
.
	`g‘
(
x
).
	`execu‹
();

44 
time¡amp
 = 
¡©e
.
	`¡İTx
();

46 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
Œue
, 
shÜtName
, CÜ»ùÃss.
TX_END
,

47 
LÚg
.
	`toSŒšg
(
time¡amp
));

49 ià(
Add»ss
.
	`isAdd»ss
(
time¡amp
)) {

50 
¡©e
.
	`£tLa¡SucûssfulWr™eO³¿tiÚTime¡amp
(
Sy¡em
.
	`cu¼’tTimeMlis
());

53 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

56 ià(
e
.
	`g‘AbÜtCau£
(è=ğ
AbÜtCau£
.
CONFLICT
) {

57 
¡©e
.
	`£tLa¡SucûssfulWr™eO³¿tiÚTime¡amp
(
Sy¡em
.
	`cu¼’tTimeMlis
());

59 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_ABORTED
);

64 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/ReadOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gSŒšgIndex”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

15 @
Slf4j


16 
public
 cÏs 
	cR—dO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

18 
public
 
	$R—dO³¿tiÚ
(
S‹
 
¡©e
) {

19 
	`su³r
(
¡©e
);

20 
shÜtName
 = "Read";

23 @
Ov”ride


24 
public
 
	$execu‹
() {

25 
SŒšg
 
¡»amId
 = (SŒšgè
¡©e
.
	`g‘SŒ—ms
().
	`§m¶e
(1).
	`g‘
(0);

26 
SŒšg
 
key
 = (SŒšgè
¡©e
.
	`g‘Keys
().
	`§m¶e
(1).
	`g‘
(0);

27 
SŒšg
 
v®
 = 
¡©e
.
	`g‘M­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amId
)).
	`g‘
(
key
);

30 
SŒšg
 
cÜ»ùÃssRecÜd
 = SŒšg.
	`fÜm©
("%s, %s:%s=%s", 
shÜtName
, 
¡»amId
, 
key
, 
v®
);

31 
CÜ»ùÃss
.
	`»cÜdO³¿tiÚ
(
cÜ»ùÃssRecÜd
, 
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
());

34 ((
CÜfuTabË
)
¡©e
.
	`g‘M­
((
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amId
)))).

35 
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_CHAR
, "a");

36 ((
CÜfuTabË
)
¡©e
.
	`g‘M­
((
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amId
)))).

37 
	`g‘ByIndex
(
SŒšgIndex”
.
BY_VALUE
, 
v®
);

39 ià(!
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

40 
¡©e
.
	`£tLa¡SucûssfulR—dO³¿tiÚTime¡amp
(
Sy¡em
.
	`cu¼’tTimeMlis
());

43 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/RemoveOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

12 @
Slf4j


13 
public
 cÏs 
	cRemoveO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

14 
public
 
	$RemoveO³¿tiÚ
(
S‹
 
¡©e
) {

15 
	`su³r
(
¡©e
);

16 
shÜtName
 = "Rm";

19 @
Ov”ride


20 
public
 
	$execu‹
() {

22 ià(
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

23 
SŒšg
 
¡»amId
 = (SŒšgè
¡©e
.
	`g‘SŒ—ms
().
	`§m¶e
(1).
	`g‘
(0);

24 
SŒšg
 
key
 = (SŒšgè
¡©e
.
	`g‘Keys
().
	`§m¶e
(1).
	`g‘
(0);

25 
¡©e
.
	`g‘M­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amId
)).
	`»move
(
key
);

27 
SŒšg
 
cÜ»ùÃssRecÜd
 = SŒšg.
	`fÜm©
("%s, %s:%s", 
shÜtName
, 
¡»amId
, 
key
);

28 
CÜ»ùÃss
.
	`»cÜdO³¿tiÚ
(
cÜ»ùÃssRecÜd
, 
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
());

30 ià(!
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

31 
¡©e
.
	`£tLa¡SucûssfulWr™eO³¿tiÚTime¡amp
(
Sy¡em
.
	`cu¼’tTimeMlis
());

34 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/SleepOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

12 @
Slf4j


13 
public
 cÏs 
	cSË•O³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

15 
public
 
	$SË•O³¿tiÚ
(
S‹
 
¡©e
) {

16 
	`su³r
(
¡©e
);

17 
shÜtName
 = "Sleep";

20 @
Ov”ride


21 @
	`Suµ»ssW¬nšgs
("checkstyle:ThreadSleep")

22 
public
 
	$execu‹
() {

23 
Rªdom
 
¿nd
 = 
Ãw
 
	`Rªdom
();

25 
¦“pTime
 = 
¿nd
.
	`ÃxtIÁ
(50);

26 
Œy
 {

27 
Th»ad
.
	`¦“p
(
¦“pTime
);

28 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

29 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
e
);

31 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/SnapshotTxOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

15 @
Slf4j


16 
public
 cÏs 
	cSÇpshÙTxO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

19 
public
 
	$SÇpshÙTxO³¿tiÚ
(
S‹
 
¡©e
) {

20 
	`su³r
(
¡©e
);

21 
shÜtName
 = "TxSnap";

24 @
Ov”ride


25 
public
 
	$execu‹
() {

26 
Œy
 {

27 
Tok’
 
ŒimM¬k
 = 
¡©e
.
	`g‘TrimM¬k
();

28 
Rªdom
 
¿nd
 = 
Ãw
 
	`Rªdom
();

29 
d–
 = (è
¿nd
.
	`ÃxtIÁ
(10) + 1;

33 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_START
);

37 
¡©e
.
	`¡¬tSÇpshÙTx
();

39 
numO³¿tiÚs
 = 
¡©e
.
	`g‘O³¿tiÚCouÁ
().
	`§m¶e
(1).
	`g‘
(0);

40 
Li¡
<
O³¿tiÚ
> 
İ”©iÚs
 = 
¡©e
.
	`g‘O³¿tiÚs
().
	`§m¶e
(
numO³¿tiÚs
);

42 
x
 = 0; x < 
İ”©iÚs
.
	`size
(); x++) {

43 ià(
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
O±imi¡icTxO³¿tiÚ


44 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
SÇpshÙTxO³¿tiÚ


45 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
RemoveO³¿tiÚ


46 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
Wr™eO³¿tiÚ


47 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
Ne¡edTxO³¿tiÚ
) {

51 
İ”©iÚs
.
	`g‘
(
x
).
	`execu‹
();

54 
¡©e
.
	`¡İTx
();

55 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_END
);

56 
¡©e
.
	`£tLa¡SucûssfulR—dO³¿tiÚTime¡amp
(
Sy¡em
.
	`cu¼’tTimeMlis
());

57 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

58 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_ABORTED
);

62 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/WriteAfterWriteTxOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
public
 cÏs 
	cWr™eAá”Wr™eTxO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

14 
public
 
	$Wr™eAá”Wr™eTxO³¿tiÚ
(
S‹
 
¡©e
) {

15 
	`su³r
(
¡©e
);

16 
shÜtName
 = "TxWaw";

19 @
Ov”ride


20 
public
 
	$execu‹
() {

21 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_START
);

22 
time¡amp
;

23 
¡©e
.
	`¡¬tWr™eAá”Wr™eTx
();

25 
numO³¿tiÚs
 = 
¡©e
.
	`g‘O³¿tiÚCouÁ
().
	`§m¶e
(1).
	`g‘
(0);

26 
Li¡
<
O³¿tiÚ
> 
İ”©iÚs
 = 
¡©e
.
	`g‘O³¿tiÚs
().
	`§m¶e
(
numO³¿tiÚs
);

28 
x
 = 0; x < 
İ”©iÚs
.
	`size
(); x++) {

29 ià(
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
Üg
.
cÜfudb
.
g’”©Ü
.İ”©iÚs.
O±imi¡icTxO³¿tiÚ


30 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
SÇpshÙTxO³¿tiÚ


31 || 
İ”©iÚs
.
	`g‘
(
x
è
š¡ªûof
 
Ne¡edTxO³¿tiÚ
)

36 
İ”©iÚs
.
	`g‘
(
x
).
	`execu‹
();

38 
Œy
 {

39 
time¡amp
 = 
¡©e
.
	`¡İTx
();

40 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
Œue
, 
shÜtName
, CÜ»ùÃss.
TX_END
,

41 
LÚg
.
	`toSŒšg
(
time¡amp
));

42 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

43 
CÜ»ùÃss
.
	`»cÜdT¿n§ùiÚM¬k”s
(
çl£
, 
shÜtName
, CÜ»ùÃss.
TX_ABORTED
);

46 
	}
}

	@generator/src/main/java/org/corfudb/generator/operations/WriteOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gİ”©iÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gCÜ»ùÃss
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gg’”©Ü
.
	gS‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

14 @
Slf4j


15 
public
 cÏs 
	cWr™eO³¿tiÚ
 
ex‹nds
 
	mO³¿tiÚ
 {

17 
public
 
	$Wr™eO³¿tiÚ
(
S‹
 
¡©e
) {

18 
	`su³r
(
¡©e
);

19 
shÜtName
 = "Write";

22 @
Ov”ride


23 
public
 
	$execu‹
() {

25 ià(
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

26 
SŒšg
 
¡»amId
 = (SŒšgè
¡©e
.
	`g‘SŒ—ms
().
	`§m¶e
(1).
	`g‘
(0);

28 
SŒšg
 
key
 = (SŒšgè
¡©e
.
	`g‘Keys
().
	`§m¶e
(1).
	`g‘
(0);

29 
SŒšg
 
v®
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

30 
¡©e
.
	`g‘M­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amId
)).
	`put
(
key
, 
v®
);

32 
SŒšg
 
cÜ»ùÃssRecÜd
 = SŒšg.
	`fÜm©
("%s, %s:%s=%s", 
shÜtName
, 
¡»amId
, 
key
, 
v®
);

33 
CÜ»ùÃss
.
	`»cÜdO³¿tiÚ
(
cÜ»ùÃssRecÜd
, 
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
());

35 ià(!
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

36 
¡©e
.
	`£tLa¡SucûssfulWr™eO³¿tiÚTime¡amp
(
Sy¡em
.
	`cu¼’tTimeMlis
());

39 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/AbstractServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

13 @
Slf4j


14 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùS”v”
 {

19 
´iv©e
 
fš®
 
	mAtomicReã»nû
<
	mS”v”S‹
> 
	m¡©e
 = 
Ãw
 
AtomicReã»nû
<>(
S”v”S‹
.
READY
);

26 
public
 
ab¡¿ù
 
HªdËrM‘hods
 
g‘HªdËr
();

33 
public
 
	$£®S”v”W™hEpoch
(
•och
) {

37 
public
 
ab¡¿ù
 
boŞ—n
 
	`isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
);

46 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

47 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
);

48 
	}
}

57 
public
 
fš®
 
	$hªdËMes§ge
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

58 ià(
	`g‘S‹
(è=ğ
S”v”S‹
.
SHUTDOWN
) {

59 
log
.
	`w¬n
("S”v”„eûived {} buˆi ®»ady shutdown.", 
msg
.
	`g‘MsgTy³
().
	`toSŒšg
());

63 ià(!
	`isS”v”R—dyToHªdËMsg
(
msg
)) {

64 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
NOT_READY
.
	`msg
());

68 
	`´oûssReque¡
(
msg
, 
ùx
, 
r
);

69 
	}
}

71 
´Ùeùed
 
	$£tS‹
(
S”v”S‹
 
ÃwS‹
) {

72 
¡©e
.
	`upd©eAndG‘
(
cu¼S‹
 -> {

73 ià(
cu¼S‹
 =ğ
S”v”S‹
.
SHUTDOWN
 && 
ÃwS‹
 != ServerState.SHUTDOWN) {

74 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Server is in SHUTDOWN state. Can't be changed");

77  
ÃwS‹
;

79 
	}
}

81 
public
 
S”v”S‹
 
	$g‘S‹
() {

82  
¡©e
.
	`g‘
();

83 
	}
}

88 
public
 
	$shutdown
() {

89 
	`£tS‹
(
S”v”S‹
.
SHUTDOWN
);

90 
	}
}

96 
public
 
	eS”v”S‹
 {

97 
	gREADY
, 
	gSHUTDOWN


	@infrastructure/src/main/java/org/corfudb/infrastructure/BaseServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gJSONPaylßdMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gV”siÚInfo
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

14 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

15 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

16 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtSock‘Add»ss
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

23 @
Slf4j


24 
public
 cÏs 
	cBa£S”v”
 
ex‹nds
 
	mAb¡¿ùS”v”
 {

26 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

28 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mexecutÜ
;

31 @
G‘‹r


32 
´iv©e
 
fš®
 
HªdËrM‘hods
 
	mhªdËr
 = HªdËrM‘hods.
g’”©eHªdËr
(
M‘hodHªdËs
.
lookup
(), 
this
);

34 @
Ov”ride


35 
public
 
boŞ—n
 
	$isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

36  
	`g‘S‹
(è=ğ
S”v”S‹
.
READY
;

39 
public
 
	`Ba£S”v”
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
) {

40 
this
.
£rv”CÚ‹xt
 = 
cÚ‹xt
;

41 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
£rv”CÚ‹xt
.
	`g‘Ba£S”v”Th»adCouÁ
(),

42 
Ãw
 
	`S”v”Th»adFaùÜy
("ba£S”v”-",‚ew 
S”v”Th»adFaùÜy
.
	`Exû±iÚHªdËr
()));

43 
	}
}

45 @
Ov”ride


46 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

47 
executÜ
.
	`subm™
((è-> 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
));

48 
	}
}

50 @
Ov”ride


51 
public
 
	$shutdown
() {

52 
su³r
.
	`shutdown
();

53 
executÜ
.
	`shutdown
();

54 
	}
}

63 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
PING
)

64 
´iv©e
 
	$pšg
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

65 
log
.
	`šfo
("PING„eceived by Base Server");

66 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
PONG
.
	`msg
());

67 
	}
}

77 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
KEEP_ALIVE
)

78 
´iv©e
 
	$k“pAlive
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

79 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

80 
	}
}

89 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
VERSION_REQUEST
)

90 
´iv©e
 
	$g‘V”siÚ
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

91 
V”siÚInfo
 
vi
 = 
Ãw
 
	`V”siÚInfo
(
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
(),

92 
£rv”CÚ‹xt
.
	`g‘NodeIdBa£64
());

93 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
JSONPaylßdMsg
<>(
vi
, 
CÜfuMsgTy³
.
VERSION_RESPONSE
));

94 
	}
}

104 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
SEAL
)

105 
public
 
synchrÚized
 
	`hªdËMes§geS‘Epoch
(@
NÚNuÎ
 
CÜfuPaylßdMsg
<
LÚg
> 
msg
,

106 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

107 @
NÚNuÎ
 
IS”v”Rou‹r
 
r
) {

108 
Œy
 {

109 
•och
 = 
msg
.
	`g‘Paylßd
();

110 
SŒšg
 
»mÙeHo¡Add»ss
;

111 
Œy
 {

112 
»mÙeHo¡Add»ss
 = ((
IÃtSock‘Add»ss
)
ùx
.
	`chªÃl
().
	`»mÙeAdd»ss
()).
	`g‘Add»ss
().
	`g‘Ho¡Add»ss
();

113 } 
	`ÿtch
 (
NuÎPoš‹rExû±iÚ
 
e
) {

114 
»mÙeHo¡Add»ss
 = "unavailable";

116 
log
.
	`šfo
("handleMessageSetEpoch: Received SEAL from (clientId={}:{}), movingo‚ewƒpoch {}",

117 
msg
.
	`g‘Cl›ÁID
(), 
»mÙeHo¡Add»ss
, 
•och
);

118 
£rv”CÚ‹xt
.
	`£tS”v”Epoch
(
•och
, 
r
);

119 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

120 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
e
) {

121 
log
.
	`debug
("handleMessageSetEpoch: Rejected SEAL current={},„equested={}",

122 
e
.
	`g‘CÜ»ùEpoch
(), 
msg
.
	`g‘Paylßd
());

123 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
,

124 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
, 
e
.
	`g‘CÜ»ùEpoch
()));

126 
	}
}

137 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
RESET
)

138 
´iv©e
 
	$doRe£t
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

139 
log
.
	`w¬n
("RemÙ»£ˆ»que¡ed from cl›Á {}", 
msg
.
	`g‘Cl›ÁID
());

140 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

141 
CÜfuS”v”
.
	`»¡¬tS”v”
(
Œue
);

142 
	}
}

153 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
RESTART
)

154 
´iv©e
 
	$doRe¡¬t
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

155 
log
.
	`w¬n
("RemÙ»¡¬ˆ»que¡ed from cl›Á {}", 
msg
.
	`g‘Cl›ÁID
());

156 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

157 
CÜfuS”v”
.
	`»¡¬tS”v”
(
çl£
);

158 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/BatchProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

6 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gBlockšgQueue
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gLškedBlockšgQueue
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

15 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

17 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLog
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gRªgeWr™eMsg
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasReque¡
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTrimReque¡
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gWr™eReque¡
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÙaExûededExû±iÚ
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

37 @
Slf4j


38 
public
 cÏs 
	cB©chProûssÜ
 
im¶em’ts
 
	mAutoClo£abË
 {

40 
fš®
 
´iv©e
 
	mBATCH_SIZE
 = 50;

42 
fš®
 
´iv©e
 
boŞ—n
 
	msync
;

44 
fš®
 
´iv©e
 
SŒ—mLog
 
	m¡»amLog
;

46 
fš®
 
´iv©e
 
	mBlockšgQueue
<
	mB©chWr™”O³¿tiÚ
> 
	mİ”©iÚsQueue
;

48 
´iv©e
 
ExecutÜS”viû
 
	m´oûssÜS”viû
 = 
ExecutÜs


49 .
ÃwSšgËTh»adExecutÜ
(
Ãw
 
Th»adFaùÜyBud”
()

50 .
£tD«mÚ
(
çl£
)

51 .
£tNameFÜm©
("LogUnit-BatchProcessor-%d")

52 .
bud
());

60 
´iv©e
 
	m£®Epoch
;

71 
public
 
	$B©chProûssÜ
(
SŒ—mLog
 
¡»amLog
, 
£®Epoch
, 
boŞ—n
 
sync
) {

72 
this
.
£®Epoch
 = sealEpoch;

73 
this
.
sync
 = sync;

74 
this
.
¡»amLog
 = streamLog;

75 
İ”©iÚsQueue
 = 
Ãw
 
LškedBlockšgQueue
<>();

76 
´oûssÜS”viû
.
	`subm™
(
this
::
´oûssÜ
);

85 
public
 <
T
> 
Com¶‘abËFutu»
 <T> 
	`addTask
(@
NÚnuÎ
 
Ty³
 
ty³
, @NÚnuÎ 
CÜfuPaylßdMsg
 
msg
) {

86 
B©chWr™”O³¿tiÚ
<
T
> 
İ”©iÚ
 = 
Ãw
 B©chWr™”O³¿tiÚ<>(
ty³
, 
msg
);

87 
İ”©iÚsQueue
.
	`add
(
İ”©iÚ
);

88  
İ”©iÚ
.
	`g‘Futu»ResuÉ
();

89 
	}
}

91 
´iv©e
 
	$´oûssÜ
() {

93 ià(!
sync
) {

94 
log
.
	`w¬n
("batchWriteProcessor: writes configuredo‚ot sync with secondary storage");

97 
Œy
 {

98 
B©chWr™”O³¿tiÚ
 
Ï¡Op
 = 
nuÎ
;

99 
´oûs£d
 = 0;

100 
Li¡
<
B©chWr™”O³¿tiÚ
> 
»s
 = 
Ãw
 
LškedLi¡
<>();

102 
Œue
) {

103 
B©chWr™”O³¿tiÚ
 
cu¼Op
;

105 ià(
Ï¡Op
 =ğ
nuÎ
) {

106 
cu¼Op
 = 
İ”©iÚsQueue
.
	`ke
();

108 
cu¼Op
 = 
İ”©iÚsQueue
.
	`pŞl
();

110 ià(
cu¼Op
 =ğ
nuÎ
 || 
´oûs£d
 =ğ
BATCH_SIZE


111 || 
cu¼Op
 =ğ
B©chWr™”O³¿tiÚ
.
SHUTDOWN
) {

112 
¡»amLog
.
	`sync
(
sync
);

113 
log
.
	`Œaû
("Com¶‘ed {} o³¿tiÚs", 
´oûs£d
);

115 
B©chWr™”O³¿tiÚ
 
İ”©iÚ
 : 
»s
) {

116 ià(!
İ”©iÚ
.
	`g‘Futu»ResuÉ
().
	`isCom¶‘edExû±iÚ®ly
()

117 && !
İ”©iÚ
.
	`g‘Futu»ResuÉ
().
	`isCªûÎed
()) {

120 
İ”©iÚ
.
	`g‘Futu»ResuÉ
().
	`com¶‘e
(İ”©iÚ.
	`g‘ResuÉV®ue
());

123 
»s
.
	`ş—r
();

124 
´oûs£d
 = 0;

128 ià(
cu¼Op
 =ğ
nuÎ
) {

129 
Ï¡Op
 = 
nuÎ
;

130 } ià(
cu¼Op
 =ğ
B©chWr™”O³¿tiÚ
.
SHUTDOWN
) {

131 
log
.
	`w¬n
("Shutting downhe write…rocessor");

132 
¡»amLog
.
	`sync
(
Œue
);

134 } ià(
¡»amLog
.
	`quÙaExûeded
(è&& 
cu¼Op
.
	`g‘Msg
().
	`g‘PriÜ™yLev–
(è!ğ
PriÜ™yLev–
.
HIGH
) {

135 
cu¼Op
.
	`g‘Futu»ResuÉ
().
	`com¶‘eExû±iÚ®ly
(

136 
Ãw
 
	`QuÙaExûededExû±iÚ
("Quota of "

137 + 
¡»amLog
.
	`quÙaLim™InBy‹s
() + " bytes"));

138 
log
.
	`w¬n
("b©ch´oûssÜ: quÙ¨exûeded, drİpšg msg {}", 
cu¼Op
.
	`g‘Msg
());

139 } ià(
cu¼Op
.
	`g‘Ty³
(è=ğ
Ty³
.
SEAL
 && cu¼Op.
	`g‘Msg
().
	`g‘Epoch
(è>ğ
£®Epoch
) {

140 
log
.
	`šfo
("b©chWr™eProûssÜ: upd©šg from {}Ø{}", 
£®Epoch
, 
cu¼Op
.
	`g‘Msg
().
	`g‘Epoch
());

141 
£®Epoch
 = 
cu¼Op
.
	`g‘Msg
().
	`g‘Epoch
();

142 
»s
.
	`add
(
cu¼Op
);

143 
´oûs£d
++;

144 
Ï¡Op
 = 
cu¼Op
;

145 } ià(
cu¼Op
.
	`g‘Msg
().
	`g‘Epoch
(è!ğ
£®Epoch
) {

146 
log
.
	`w¬n
("batchWriteProcessor: wrongƒpoch on {} msg, sealƒpoch is {},‡nd msgƒpoch is {}",

147 
cu¼Op
.
	`g‘Ty³
(), 
£®Epoch
, cu¼Op.
	`g‘Msg
().
	`g‘Epoch
());

148 
cu¼Op
.
	`g‘Futu»ResuÉ
().
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`WrÚgEpochExû±iÚ
(
£®Epoch
));

149 
»s
.
	`add
(
cu¼Op
);

150 
´oûs£d
++;

151 
Ï¡Op
 = 
cu¼Op
;

153 
Œy
 {

154 
cu¼Op
.
	`g‘Ty³
()) {

155 
PREFIX_TRIM
:

156 
TrimReque¡
 
´efixTrim
 = (TrimReque¡è
cu¼Op
.
	`g‘Msg
().
	`g‘Paylßd
();

157 
¡»amLog
.
	`´efixTrim
(
´efixTrim
.
	`g‘Add»ss
().
	`g‘Sequ’û
());

159 
WRITE
:

160 
Wr™eReque¡
 
wr™e
 = (Wr™eReque¡è
cu¼Op
.
	`g‘Msg
().
	`g‘Paylßd
();

161 
¡»amLog
.
	`­³nd
(
wr™e
.
	`g‘Glob®Add»ss
(), (
LogD©a
èwr™e.
	`g‘D©a
());

163 
RANGE_WRITE
:

164 
RªgeWr™eMsg
 
wr™eRªge
 = (RªgeWr™eMsgè
cu¼Op
.
	`g‘Msg
().
	`g‘Paylßd
();

165 
¡»amLog
.
	`­³nd
(
wr™eRªge
.
	`g‘EÁr›s
());

167 
RESET
:

168 
¡»amLog
.
	`»£t
();

170 
TAILS_QUERY
:

171 
TasReque¡
 
sReque¡
 = (TasReque¡)
cu¼Op
.
	`g‘Msg
().
	`g‘Paylßd
();

172 
TasRe¥Ú£
 
s
;

174 
sReque¡
.
	`g‘ReqTy³
()) {

175 
TasReque¡
.
LOG_TAIL
:

176 
s
 = 
Ãw
 
	`TasRe¥Ú£
(
¡»amLog
.
	`g‘LogTa
());

179 
TasReque¡
.
STREAMS_TAILS
:

180 
s
 = 
¡»amLog
.
	`g‘Tas
(
sReque¡
.
	`g‘SŒ—ms
());

184 
s
 = 
¡»amLog
.
	`g‘AÎTas
();

188 
cu¼Op
.
	`£tResuÉV®ue
(
s
);

190 
LOG_ADDRESS_SPACE_QUERY
:

192 
cu¼Op
.
	`£tResuÉV®ue
(
¡»amLog
.
	`g‘SŒ—msAdd»ssS·û
());

195 
log
.
	`w¬n
("UnknowÀB©chWr™”O³¿tiÚ {}", 
cu¼Op
);

197 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

198 
log
.
	`”rÜ
("Stream†ogƒrror. Batch [queue size={}]. StreamLog: [trim mark: {}].",

199 
İ”©iÚsQueue
.
	`size
(), 
¡»amLog
.
	`g‘TrimM¬k
(), 
e
);

200 
cu¼Op
.
	`g‘Futu»ResuÉ
().
	`com¶‘eExû±iÚ®ly
(
e
);

202 
»s
.
	`add
(
cu¼Op
);

204 
´oûs£d
++;

205 
Ï¡Op
 = 
cu¼Op
;

208 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

209 
log
.
	`”rÜ
("Caughˆexû±iÚ iÀthwr™´oûssÜ ", 
e
);

211 
	}
}

213 @
Ov”ride


214 
public
 
	$şo£
() {

215 
İ”©iÚsQueue
.
	`add
(
B©chWr™”O³¿tiÚ
.
SHUTDOWN
);

216 
´oûssÜS”viû
.
	`shutdown
();

217 
Œy
 {

218 
´oûssÜS”viû
.
	`awa™T”mš©iÚ
(
S”v”CÚ‹xt
.
SHUTDOWN_TIMER
.
	`toMlis
(),

219 
TimeUn™
.
MILLISECONDS
);

220 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

221 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
("B©chProûssÜ clo£ iÁ”ru±ed.", 
e
);

223 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/BatchWriterOperation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

5 
impÜt
 
	glombok
.
	gD©a
;

7 
impÜt
 
	glombok
.
	gToSŒšg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

14 @
	gD©a


15 @
ToSŒšg


16 
public
 
şass
 
	gB©chWr™”O³¿tiÚ
<
	gT
> {

17 
public
 
	eTy³
 {

18 
	gSHUTDOWN
,

19 
	gWRITE
,

20 
	gRANGE_WRITE
,

21 
	gPREFIX_TRIM
,

22 
	gSEAL
,

23 
	gRESET
,

24 
	gTAILS_QUERY
,

25 
	gLOG_ADDRESS_SPACE_QUERY


28 
´iv©e
 
fš®
 
Ty³
 
	gty³
;

29 
´iv©e
 
fš®
 
CÜfuPaylßdMsg
 
	gmsg
;

30 
´iv©e
 
T
 
	g»suÉV®ue
;

31 
´iv©e
 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gfutu»ResuÉ
 = 
Ãw
 
Com¶‘abËFutu»
<>();

33 
public
 
	gB©chWr™”O³¿tiÚ
<
	gVoid
> 
	gSHUTDOWN
 = 
Ãw
 
B©chWr™”O³¿tiÚ
<>(
Ty³
.
SHUTDOWN
, 
	gnuÎ
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/CorfuServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gN‘wÜkUts
.
	gg‘Add»ssFromIÁ”çûName
;

5 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLev–
;

6 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLogg”
;

7 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gcÜe
.
	gjÜª
.
	g¥i
.
	gJÜªExû±iÚ
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	gM‘ricsS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	g£rv”s
.
	gProm‘heusM‘ricsS”v”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

14 
impÜt
 
	gÜg
.
	gdocİt
.
	gDocİt
;

15 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

17 
impÜt
 
	gjava
.
	gio
.
	gFe
;

18 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

30 @
Slf4j


31 
public
 cÏs 
	cCÜfuS”v”
 {

43 
´iv©e
 
fš®
 
SŒšg
 
	mUSAGE
 =

178 
´iv©e
 vŞ©
CÜfuS”v”Node
 
	maùiveS”v”
;

181 
´iv©e
 vŞ©
boŞ—n
 
	mshutdownS”v”
 = 
çl£
;

183 
´iv©e
 vŞ©
boŞ—n
 
	mş—nupS”v”
 = 
çl£
;

185 
´iv©e
 
fš®
 
	mEXIT_ERROR_CODE
 = 100;

192 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

193 
Œy
 {

194 
	`¡¬tS”v”
(
¬gs
);

195 } 
	`ÿtch
 (
ThrowabË
 
”r
) {

196 
log
.
	`”rÜ
("Ex™. UÄecov”abËƒ¼Ü", 
”r
);

197 
throw
 
”r
;

201 
´iv©e
 
	$¡¬tS”v”
(
SŒšg
[] 
¬gs
) {

203 
M­
<
SŒšg
, 
Objeù
> 
İts
 = 
Ãw
 
	`Docİt
(
USAGE
)

204 .
	`w™hV”siÚ
(
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
desüibe
)

205 .
	`·r£
(
¬gs
);

207 
	`´štS¹upMsg
(
İts
);

208 
	`cÚfigu»Logg”
(
İts
);

210 
log
.
	`debug
("S¹ed w™h‡rgum’ts: {}", 
İts
);

214 ià(
İts
.
	`g‘
("--ÃtwÜk-š‹rçû"è!ğ
nuÎ
) {

215 
İts
.
	`put
("--add»ss", 
	`g‘Add»ssFromIÁ”çûName
((
SŒšg
èİts.
	`g‘
("--network-interface")));

216 
İts
.
	`put
("--bšd-to-®l-š‹rçûs", 
çl£
);

217 } ià(
İts
.
	`g‘
("--add»ss"è=ğ
nuÎ
) {

220 
İts
.
	`put
("--bšd-to-®l-š‹rçûs", 
Œue
);

221 
İts
.
	`put
("--address", "localhost");

224 
İts
.
	`put
("--bšd-to-®l-š‹rçûs", 
çl£
);

227 
	`ü—‹S”viûDœeùÜy
(
İts
);

230 ià(
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
İts
.
	`g‘
("--metadata-retention")) < 1) {

231 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Max‚umber of metadata fileso„etain must be greaterhan 0.");

235 
Th»ad
 
shutdownTh»ad
 = 
Ãw
 
	`Th»ad
(
CÜfuS”v”
::
ş—nShutdown
);

236 
shutdownTh»ad
.
	`£tName
("ShutdownThread");

237 
RuÁime
.
	`g‘RuÁime
().
	`addShutdownHook
(
shutdownTh»ad
);

240 !
shutdownS”v”
) {

241 
fš®
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xt
(
İts
);

242 
Œy
 {

243 
	`£tupM‘rics
(
İts
);

244 
aùiveS”v”
 = 
Ãw
 
	`CÜfuS”v”Node
(
£rv”CÚ‹xt
);

245 
aùiveS”v”
.
	`¡¬tAndLi¡’
();

246 } 
	`ÿtch
 (
ThrowabË
 
th
) {

247 
log
.
	`”rÜ
("CÜfuS”v”: S”v”ƒx™šg dutØuÄecov”abËƒ¼Ü: ", 
th
);

248 
Sy¡em
.
	`ex™
(
EXIT_ERROR_CODE
);

251 ià(
ş—nupS”v”
) {

252 
	`ş—rD©aFes
(
£rv”CÚ‹xt
);

253 
ş—nupS”v”
 = 
çl£
;

256 ià(!
shutdownS”v”
) {

257 
log
.
	`šfo
("main: Server„estarting.");

261 
log
.
	`šfo
("main: Serverƒxiting dueo shutdown");

262 
	}
}

272 
´iv©e
 
cÚfigu»Logg”
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

273 
fš®
 
Logg”
 
	groÙ
 = (Logg”è
Logg”FaùÜy
.
g‘Logg”
(Logg”.
ROOT_LOGGER_NAME
);

274 
fš®
 
Lev–
 
	gËv–
 = Lev–.
toLev–
(((
SŒšg
è
İts
.
g‘
("--log-Ëv–")).
toUµ”Ca£
());

275 
	groÙ
.
£tLev–
(
Ëv–
);

283 
´iv©e
 
ü—‹S”viûDœeùÜy
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

284 ià((
	gBoŞ—n
è
	gİts
.
g‘
("--memory")) {

288 
Fe
 
	g£rviûDœ
 = 
Ãw
 Fe((
SŒšg
è
İts
.
g‘
("--log-path"));

290 ià(!
	g£rviûDœ
.
isDœeùÜy
()) {

291 
	glog
.
”rÜ
("Service directory {} does‚ot…ointo‡ directory. Aborting.",

292 
£rviûDœ
);

293 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
("Service directory must be‡ directory!");

296 
SŒšg
 
	gcÜfuS”viûDœP©h
 = 
£rviûDœ
.
g‘AbsŞu‹P©h
()

297 + 
Fe
.
£·¿tÜ


299 
Fe
 
	gcÜfuS”viûDœ
 = 
Ãw
 Fe(
cÜfuS”viûDœP©h
);

301 
	gİts
.
put
("--log-·th", 
cÜfuS”viûDœP©h
);

302 ià(!
	gcÜfuS”viûDœ
.
exi¡s
(è&& cÜfuS”viûDœ.
mkdœs
()) {

303 
	glog
.
šfo
("C»©ed‚ew s”viû dœeùÜy‡ˆ{}.", 
cÜfuS”viûDœ
);

312 
´iv©e
 
	$ş—rD©aFes
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

313 
log
.
	`w¬n
("main: cleanup„equested, DELETE server data files");

314 ià(!
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
(
BoŞ—n
.
şass
, "--memory")) {

315 
Fe
 
£rviûDœ
 = 
Ãw
 
	`Fe
(
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
(
SŒšg
.
şass
, "--log-path"));

316 
Œy
 {

317 
FeUts
.
	`ş—nDœeùÜy
(
£rviûDœ
);

318 } 
	`ÿtch
 (
IOExû±iÚ
 
iÛ
) {

319 
throw
 
Ãw
 
	`UÄecov”abËCÜfuE¼Ü
(
iÛ
);

322 
log
.
	`w¬n
("main: cleanup completed,ƒxpect clean startup");

323 
	}
}

330 
	$»¡¬tS”v”
(
boŞ—n
 
»£tD©a
) {

332 ià(
»£tD©a
) {

333 
ş—nupS”v”
 = 
Œue
;

336 
log
.
	`šfo
("RestartServer: Shutting down corfu server");

337 
aùiveS”v”
.
	`şo£
();

338 
log
.
	`šfo
("RestartServer: Starting corfu server");

339 
	}
}

344 
´iv©e
 
	$ş—nShutdown
() {

345 
log
.
	`šfo
("CleanShutdown: Starting Cleanup.");

346 
shutdownS”v”
 = 
Œue
;

347 
aùiveS”v”
.
	`şo£
();

348 
	}
}

353 
´iv©e
 
	$´štLogo
() {

354 
	`´šn
("â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–„");

355 
	`´šn
("â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

356 
	`´šn
("â–ˆâ–ˆâ–ˆ â–ˆâ–€ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–€ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

357 
	`´šn
("â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–„â–ˆâ–ˆâ–ˆâ–„â–„â–„â–„â–ˆâ–ˆâ–€ â–„â–ˆâ–ˆâ–ˆâ–„â–„â–„ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

358 
	`´šn
("â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–€â–€â–ˆâ–ˆâ–ˆâ–€â–€â–€â–€â–€ â–€â–€â–ˆâ–ˆâ–ˆâ–€â–€â–€ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

359 
	`´šn
("â–ˆâ–ˆâ–ˆ â–ˆâ–„ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

360 
	`´šn
("â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

361 
	`´šn
("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€ â–€â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–€ ");

362 
	`´šn
(" â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆ");

363 
	}
}

371 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

372 
´iv©e
 
	$´šn
(
Objeù
 
lše
) {

373 
Sy¡em
.
out
.
	`´šn
(
lše
);

374 
log
.
	`šfo
(
lše
.
	`toSŒšg
());

375 
	}
}

382 
´iv©e
 
´štS¹upMsg
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

383 
´štLogo
();

384 
´šn
("Welcomeo CORFU SERVER");

385 
´šn
("V”siÚ (" + 
G™R•os™ÜyS‹
.
g‘R•os™ÜyS‹
().
comm™IdAbb»v
 + ")");

387 
fš®
 
	gpÜt
 = 
IÁeg”
.
·r£IÁ
((
SŒšg
è
İts
.
g‘
("<port>"));

388 
fš®
 
SŒšg
 
	gd©aLoÿtiÚ
 = (
BoŞ—n
è
İts
.
g‘
("--memory") ? "MEMORY mode" :

389 
İts
.
g‘
("--log-·th").
toSŒšg
();

391 
´šn
("S”všg oÀpÜˆ" + 
pÜt
);

392 
´šn
("D©¨loÿtiÚ: " + 
d©aLoÿtiÚ
);

400 
´iv©e
 
£tupM‘rics
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

401 
	gProm‘heusM‘ricsS”v”
.
CÚfig
 
	gcÚfig
 = 
Prom‘heusM‘ricsS”v”
.CÚfig.
·r£
(
İts
);

402 
M‘ricsS”v”
 
	g£rv”
 = 
Ãw
 
Prom‘heusM‘ricsS”v”
(
cÚfig
, 
S”v”CÚ‹xt
.
g‘M‘rics
());

403 
	g£rv”
.
¡¬t
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/CorfuServerNode.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gboÙ¡¿p
.
	gS”v”BoÙ¡¿p
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gPoŞedBy‹BufAÎoÿtÜ
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃl
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlFutu»
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlIn™Ÿliz”
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlO±iÚ
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gS”v”ChªÃl
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gL’gthF›ldBa£dF¿meDecod”
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gL’gthF›ldP»³nd”
;

14 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦CÚ‹xt
;

15 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦HªdËr
;

16 
impÜt
 
	glombok
.
	gG‘‹r
;

17 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gN‘tyCÜfuMes§geDecod”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gN‘tyCÜfuMes§geEncod”
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
.
	gPÏšTextSa¦N‘tyS”v”
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
.
	gS¦CÚ‹xtCÚ¡ruùÜ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gV”siÚ
;

26 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

27 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLEngše
;

28 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

35 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

36 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

42 @
Slf4j


43 
public
 cÏs 
	cCÜfuS”v”Node
 
im¶em’ts
 
	mAutoClo£abË
 {

45 @
G‘‹r


46 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

48 @
G‘‹r


49 
´iv©e
 
fš®
 
	mM­
<
	mCÏss
, 
	mAb¡¿ùS”v”
> 
	m£rv”M­
;

51 @
G‘‹r


52 
´iv©e
 
fš®
 
N‘tyS”v”Rou‹r
 
	mrou‹r
;

55 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mşo£
;

57 
´iv©e
 
ChªÃlFutu»
 
	mbšdFutu»
;

64 
public
 
CÜfuS”v”Node
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

65 
this
(
£rv”CÚ‹xt
,

66 
ImmubËM­
.<
CÏss
, 
Ab¡¿ùS”v”
>
bud”
()

67 .
put
(
Ba£S”v”
.
şass
, 
Ãw
 Ba£S”v”(
£rv”CÚ‹xt
))

68 .
put
(
Sequ’ûrS”v”
.
şass
, 
Ãw
 Sequ’ûrS”v”(
£rv”CÚ‹xt
))

69 .
put
(
LayoutS”v”
.
şass
, 
Ãw
 LayoutS”v”(
£rv”CÚ‹xt
))

70 .
put
(
LogUn™S”v”
.
şass
, 
Ãw
 LogUn™S”v”(
£rv”CÚ‹xt
))

71 .
put
(
Mªagem’tS”v”
.
şass
, 
Ãw
 Mªagem’tS”v”(
£rv”CÚ‹xt
))

72 .
bud
()

82 
public
 
CÜfuS”v”Node
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
,

83 @
NÚnuÎ
 
M­
<
CÏss
, 
Ab¡¿ùS”v”
> 
£rv”M­
) {

84 
	gthis
.
	g£rv”CÚ‹xt
 = 
£rv”CÚ‹xt
;

85 
	gthis
.
	g£rv”M­
 = 
£rv”M­
;

86 
	grou‹r
 = 
Ãw
 
N‘tyS”v”Rou‹r
Òew 
A¼ayLi¡
<>(
£rv”M­
.
v®ues
()));

87 
	gthis
.
	g£rv”CÚ‹xt
.
£tS”v”Rou‹r
(
rou‹r
);

88 
	gthis
.
	gşo£
 = 
Ãw
 
AtomicBoŞ—n
(
çl£
);

94 
public
 
ChªÃlFutu»
 
	$¡¬t
() {

95 
bšdFutu»
 = 
	`bšdS”v”
(
£rv”CÚ‹xt
.
	`g‘BossGroup
(),

96 
£rv”CÚ‹xt
.
	`g‘WÜk”Group
(),

97 
this
::
cÚfigu»BoÙ¡¿pO±iÚs
,

98 
£rv”CÚ‹xt
,

99 
rou‹r
,

100 (
SŒšg
è
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
().
	`g‘
("--address"),

101 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
().
	`g‘
("<port>")));

103  
bšdFutu»
.
	`syncUnš‹¼u±ibly
();

104 
	}
}

109 
public
 
	$¡¬tAndLi¡’
() {

111 
this
.
	`¡¬t
().
	`chªÃl
().
	`şo£Futu»
().
	`syncUnš‹¼u±ibly
();

112 
	}
}

117 @
Ov”ride


118 
public
 
	$şo£
() {

120 ià(!
şo£
.
	`com·»AndS‘
(
çl£
, 
Œue
)) {

121 
log
.
	`Œaû
("close: Server‡lready shutdown");

125 
log
.
	`šfo
("close: Shutting down Corfu server‡nd cleaning„esources");

126 
£rv”CÚ‹xt
.
	`şo£
();

127 
bšdFutu»
.
	`chªÃl
().
	`şo£
().
	`syncUnš‹¼u±ibly
();

131 
fš®
 
ExecutÜS”viû
 
shutdownS”viû
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
£rv”M­
.
	`size
(),

132 
Ãw
 
	`S”v”Th»adFaùÜy
("CorfuServer-shutdown-",

133 
Ãw
 
S”v”Th»adFaùÜy
.
	`Exû±iÚHªdËr
()));

137 
Com¶‘abËFutu»
[] 
shutdownFutu»s
 = 
£rv”M­
.
	`v®ues
().
	`¡»am
()

138 .
	`m­
(
£rv”
 -> 
Com¶‘abËFutu»
.
	`runAsync
(() -> {

139 
Œy
 {

140 
log
.
	`šfo
("şo£: Shu‰šg dowÀ{}", 
£rv”
.
	`g‘CÏss
().
	`g‘Sim¶eName
());

141 
£rv”
.
	`shutdown
();

142 
log
.
	`šfo
("şo£: CËªly shutdowÀ{}", 
£rv”
.
	`g‘CÏss
().
	`g‘Sim¶eName
());

143 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

144 
log
.
	`”rÜ
("close: Failedo cleanly shutdown {}",

145 
£rv”
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), 
e
);

147 }, 
shutdownS”viû
))

148 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

150 
Com¶‘abËFutu»
.
	`®lOf
(
shutdownFutu»s
).
	`još
();

151 
shutdownS”viû
.
	`shutdown
();

152 
log
.
	`šfo
("close: Server shutdown‡nd„esources„eleased");

153 
	}
}

158 @
FunùiÚ®IÁ”çû


159 
public
 
š‹rçû
 
	gBoÙ¡¿pCÚfigu»r
 {

166 
cÚfigu»
(
S”v”BoÙ¡¿p
 
£rv”BoÙ¡¿p
);

188 
public
 
ChªÃlFutu»
 
bšdS”v”
(@
NÚnuÎ
 
Ev’tLoİGroup
 
bossGroup
,

189 @
NÚnuÎ
 
Ev’tLoİGroup
 
wÜk”Group
,

190 @
NÚnuÎ
 
BoÙ¡¿pCÚfigu»r
 
boÙ¡¿pCÚfigu»r
,

191 @
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
,

192 @
NÚnuÎ
 
N‘tyS”v”Rou‹r
 
rou‹r
,

193 
SŒšg
 
add»ss
,

194 
pÜt
) {

195 
	gŒy
 {

196 
S”v”BoÙ¡¿p
 
	gboÙ¡¿p
 = 
Ãw
 ServerBootstrap();

197 
	gboÙ¡¿p
.
group
(
bossGroup
, 
wÜk”Group
)

198 .
chªÃl
(
cÚ‹xt
.
g‘ChªÃlIm¶em’tiÚ
().
g‘S”v”ChªÃlCÏss
());

199 
	gboÙ¡¿pCÚfigu»r
.
cÚfigu»
(
boÙ¡¿p
);

201 
	gboÙ¡¿p
.
chdHªdËr
(
g‘S”v”ChªÃlIn™Ÿliz”
(
cÚ‹xt
, 
rou‹r
));

202 
boŞ—n
 
	gbšdToAÎIÁ”çûs
 =

203 
O±iÚ®
.
ofNuÎabË
(
cÚ‹xt
.
g‘S”v”CÚfig
(
BoŞ—n
.
şass
, "--bind-to-all-interfaces"))

204 .
ÜEl£
(
çl£
);

205 ià(
	gbšdToAÎIÁ”çûs
) {

206 
	glog
.
šfo
("CÜfu S”v”†i¡’šg oÀ®Èš‹rçû Ú…Üt:{}", 
pÜt
);

207  
	gboÙ¡¿p
.
bšd
(
pÜt
).
sync
();

209 
	glog
.
šfo
("CÜfu S”v”†i¡’šg oÀ{}:{}", 
add»ss
, 
pÜt
);

210  
	gboÙ¡¿p
.
bšd
(
add»ss
, 
pÜt
).
sync
();

212 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

213 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

222 
public
 
cÚfigu»BoÙ¡¿pO±iÚs
(@
NÚnuÎ
 
S”v”BoÙ¡¿p
 
boÙ¡¿p
) {

223 
	gboÙ¡¿p
.
İtiÚ
(
ChªÃlO±iÚ
.
SO_BACKLOG
, 100)

224 .
chdO±iÚ
(
ChªÃlO±iÚ
.
SO_KEEPALIVE
, 
Œue
)

225 .
chdO±iÚ
(
ChªÃlO±iÚ
.
SO_REUSEADDR
, 
Œue
)

226 .
chdO±iÚ
(
ChªÃlO±iÚ
.
TCP_NODELAY
, 
Œue
)

227 .
chdO±iÚ
(
ChªÃlO±iÚ
.
ALLOCATOR
, 
PoŞedBy‹BufAÎoÿtÜ
.
DEFAULT
);

239 
´iv©e
 
ChªÃlIn™Ÿliz”
 
g‘S”v”ChªÃlIn™Ÿliz”
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
,

240 @
NÚnuÎ
 
N‘tyS”v”Rou‹r
 
rou‹r
) {

243  
Ãw
 
ChªÃlIn™Ÿliz”
() {

244 @
Ov”ride


245 
´Ùeùed
 
š™ChªÃl
(@
NÚnuÎ
 
ChªÃl
 
ch
è
throws
 
	gExû±iÚ
 {

248 
fš®
 
S¦CÚ‹xt
 
	gs¦CÚ‹xt
;

249 
fš®
 
	gSŒšg
[] 
	g’abËdTlsPrÙocŞs
;

250 
fš®
 
	gSŒšg
[] 
	g’abËdTlsCh”Su™es
;

253 
BoŞ—n
 
	gsEÇbËd
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(BoŞ—n.
şass
, "--enable-tls");

254 
BoŞ—n
 
	gsMutu®AuthEÇbËd
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(BoŞ—n.
şass
,

256 ià(
	gsEÇbËd
) {

258 
SŒšg
 
	gchs
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(SŒšg.
şass
, "--tls-ciphers");

259 ià(
	gchs
 !ğ
nuÎ
) {

260 
’abËdTlsCh”Su™es
 = 
P©‹º
.
compe
(",")

261 .
¥l™AsSŒ—m
(
chs
)

262 .
m­
(
SŒšg
::
Œim
)

263 .
toA¼ay
(
SŒšg
[]::
Ãw
);

265 
	g’abËdTlsCh”Su™es
 = 
Ãw
 
SŒšg
[]{};

269 
SŒšg
 
	g´Ùos
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(SŒšg.
şass
, "--tls-protocols");

270 ià(
	g´Ùos
 !ğ
nuÎ
) {

271 
’abËdTlsPrÙocŞs
 = 
P©‹º
.
compe
(",")

272 .
¥l™AsSŒ—m
(
´Ùos
)

273 .
m­
(
SŒšg
::
Œim
)

274 .
toA¼ay
(
SŒšg
[]::
Ãw
);

276 
	g’abËdTlsPrÙocŞs
 = 
Ãw
 
SŒšg
[]{};

279 
	gŒy
 {

280 
	gs¦CÚ‹xt
 = 
S¦CÚ‹xtCÚ¡ruùÜ
.
cÚ¡ruùS¦CÚ‹xt
(
Œue
,

281 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--keystore"),

282 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--keystore-password-file"),

283 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--truststore"),

284 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
,

286 } 
ÿtch
 (
SSLExû±iÚ
 
e
) {

287 
	glog
.
”rÜ
("Could‚Ù budhSSL cÚ‹xt", 
e
);

288 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Couldn'ˆbudhSSL cÚ‹xt", 
e
);

291 
	g’abËdTlsCh”Su™es
 = 
Ãw
 
SŒšg
[]{};

292 
	g’abËdTlsPrÙocŞs
 = 
Ãw
 
SŒšg
[]{};

293 
	gs¦CÚ‹xt
 = 
nuÎ
;

296 
BoŞ—n
 
	g§¦PÏšTextAuth
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(BoŞ—n.
şass
,

300 ià(
	gsEÇbËd
) {

301 
SSLEngše
 
	g’gše
 = 
s¦CÚ‹xt
.
ÃwEngše
(
ch
.
®loc
());

302 
	g’gše
.
£tEÇbËdCh”Su™es
(
’abËdTlsCh”Su™es
);

303 
	g’gše
.
£tEÇbËdPrÙocŞs
(
’abËdTlsPrÙocŞs
);

304 ià(
	gsMutu®AuthEÇbËd
) {

305 
	g’gše
.
£tN“dCl›ÁAuth
(
Œue
);

307 
	gch
.
p–še
().
addLa¡
("s¦", 
Ãw
 
S¦HªdËr
(
’gše
));

310 
	gch
.
p–še
().
addLa¡
(
Ãw
 
L’gthF›ldP»³nd”
(4));

311 
	gch
.
p–še
().
addLa¡
(
Ãw
 
L’gthF›ldBa£dF¿meDecod”
(
IÁeg”


312 .
MAX_VALUE
, 0, 4,

315 ià(
	g§¦PÏšTextAuth
) {

316 
	gch
.
p–še
().
addLa¡
("§¦/¶aš-‹xt", 
Ãw


317 
PÏšTextSa¦N‘tyS”v”
());

320 
	gch
.
p–še
().
addLa¡
(
Ãw
 
N‘tyCÜfuMes§geDecod”
());

321 
	gch
.
p–še
().
addLa¡
(
Ãw
 
N‘tyCÜfuMes§geEncod”
());

322 
	gch
.
p–še
().
addLa¡
(
Ãw
 
S”v”HªdshakeHªdËr
(
cÚ‹xt
.
g‘NodeId
(),

323 
V”siÚ
.
g‘V”siÚSŒšg
() + "("

324 + 
G™R•os™ÜyS‹
.
g‘R•os™ÜyS‹
().
comm™IdAbb»v
 + ")",

325 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--HandshakeTimeout")));

327 
	gch
.
p–še
().
addLa¡
(
rou‹r
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/HandlerMethods.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gExû±iÚMsg
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

13 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

14 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gLambdaM‘açùÜy
;

15 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdË
;

16 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

17 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodTy³
;

18 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gM‘hod
;

19 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gModif›r
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

21 
impÜt
 
	gjava
.
	gut
.
	gEnumM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

38 @
Slf4j


39 
public
 cÏs 
	cHªdËrM‘hods
 {

41 
´iv©e
 
fš®
 
	mM­
<
	mCÜfuMsgTy³
, 
	mSŒšg
> 
	mtim”NameCache
 = 
Ãw
 
HashM­
<>();

44 
´iv©e
 
fš®
 
	mM­
<
	mCÜfuMsgTy³
, 
	mHªdËrM‘hod
> 
	mhªdËrM­
;

52 @
FunùiÚ®IÁ”çû


53 
š‹rçû
 
	mHªdËrM‘hod
<
T
 
ex‹nds
 
	mCÜfuMsg
> {

54 
hªdË
(@
NÚnuÎ
 
T
 
cÜfuMsg
,

55 @
NÚnuÎ
 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

56 @
NÚnuÎ
 
IS”v”Rou‹r
 
r
);

63 
public
 
	gS‘
<
	gCÜfuMsgTy³
> 
	$g‘HªdËdTy³s
() {

64  
hªdËrM­
.
	`keyS‘
();

65 
	}
}

68 
public
 
	$HªdËrM‘hods
() {

69 
hªdËrM­
 = 
Ãw
 
EnumM­
<>(
CÜfuMsgTy³
.
şass
);

70 
	}
}

81 @
Suµ»ssW¬nšgs
("unchecked")

82 
public
 
	$hªdË
(
CÜfuMsg
 
mes§ge
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

83 
fš®
 
HªdËrM‘hod
<
CÜfuMsg
> 
hªdËr
 = 
hªdËrM­
.
	`g‘
(
mes§ge
.
	`g‘MsgTy³
());

84 
Œy
 {

85 
hªdËr
.
	`hªdË
(
mes§ge
, 
ùx
, 
r
);

86 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

88 
log
.
	`”rÜ
("handle: Unhandledƒxception…rocessing {} message",

89 
mes§ge
.
	`g‘MsgTy³
(), 
ex
);

90 
r
.
	`£ndRe¥Ú£
(
ùx
, 
mes§ge
, 
CÜfuMsgTy³
.
ERROR_SERVER_EXCEPTION
.
	`·ylßdMsg
(
Ãw
 
	`Exû±iÚMsg
(
ex
)));

92 
	}
}

100 
public
 
HªdËrM‘hods
 
g’”©eHªdËr
(@
NÚnuÎ
 
fš®
 
M‘hodHªdËs
.
Lookup
 
ÿÎ”
,

101 @
NÚnuÎ
 
fš®
 
Ab¡¿ùS”v”
 
£rv”
) {

102 
HªdËrM‘hods
 
	ghªdËr
 = 
Ãw
 HandlerMethods();

103 
	gA¼ays
.
¡»am
(
£rv”
.
g‘CÏss
().
g‘Deş¬edM‘hods
())

104 .
f‹r
(
m‘hod
 -> m‘hod.
isAÂÙ©iÚP»£Á
(
S”v”HªdËr
.
şass
))

105 .
fÜEach
(
m‘hod
 -> 
hªdËr
.
»gi¡”M‘hod
(
ÿÎ”
, 
£rv”
, method));

106  
	ghªdËr
;

118 @
Suµ»ssW¬nšgs
("unchecked")

119 
´iv©e
 
»gi¡”M‘hod
(@
NÚnuÎ
 
fš®
 
M‘hodHªdËs
.
Lookup
 
ÿÎ”
,

120 @
NÚnuÎ
 
fš®
 
Ab¡¿ùS”v”
 
£rv”
,

121 @
NÚnuÎ
 
fš®
 
M‘hod
 
m‘hod
) {

122 
fš®
 
S”v”HªdËr
 
	gªnÙ©iÚ
 = 
m‘hod
.
g‘AÂÙ©iÚ
(S”v”HªdËr.
şass
);

124 ià(!
	gm‘hod
.
g‘P¬am‘”Ty³s
()[0].
isAssigÇbËFrom
(
ªnÙ©iÚ
.
ty³
().
mes§geTy³


125 .
g‘RawTy³
())) {

126 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
("Incorrect messageype,ƒxpected "

127 + 
ªnÙ©iÚ
.
ty³
().
mes§geTy³
.
g‘RawTy³
() + " but…rovided "

128 + 
m‘hod
.
g‘P¬am‘”Ty³s
()[0]);

130 ià(
	ghªdËrM­
.
cÚšsKey
(
ªnÙ©iÚ
.
ty³
())) {

131 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
("HªdËrM‘hod fÜ " + 
ªnÙ©iÚ
.
ty³
()

135 
	gŒy
 {

136 
	gHªdËrM‘hod
<
	gCÜfuMsg
> 
	gh
;

137 ià(
	gModif›r
.
isStic
(
m‘hod
.
g‘Modif›rs
())) {

138 
M‘hodHªdË
 
	gmh
 = 
ÿÎ”
.
uÄeæeù
(
m‘hod
);

139 
M‘hodTy³
 
	gmt
 = 
mh
.
ty³
().
chªgeP¬am‘”Ty³
(0, 
CÜfuMsg
.
şass
);

140 
	gh
 = (
HªdËrM‘hod
<
CÜfuMsg
>è
LambdaM‘açùÜy
.
m‘açùÜy
(
ÿÎ”
,

141 "hªdË", 
M‘hodTy³
.
m‘hodTy³
(
HªdËrM‘hod
.
şass
),

142 
mt
, 
mh
, mh.
ty³
())

143 .
g‘T¬g‘
().
švokeExaù
();

147 
M‘hodTy³
 
	gmt
 = M‘hodTy³.
m‘hodTy³
(
m‘hod
.
g‘R‘uºTy³
(),

148 
m‘hod
.
g‘P¬am‘”Ty³s
());

149 
M‘hodHªdË
 
	gmh
 = 
ÿÎ”
.
fšdVœtu®
(
£rv”
.
g‘CÏss
(), 
m‘hod
.
g‘Name
(), 
mt
);

150 
M‘hodTy³
 
	gmtG’”ic
 = 
mh
.
ty³
().
chªgeP¬am‘”Ty³
(1, 
CÜfuMsg
.
şass
);

151 
	gh
 = (
HªdËrM‘hod
<
CÜfuMsg
>è
LambdaM‘açùÜy
.
m‘açùÜy
(
ÿÎ”
,

153 
M‘hodTy³
.
m‘hodTy³
(
HªdËrM‘hod
.
şass
, 
£rv”
.
g‘CÏss
()),

154 
mtG’”ic
.
drİP¬am‘”Ty³s
(0, 1), 
mh
,

155 
mh
.
ty³
().
drİP¬am‘”Ty³s
(0, 1)).
g‘T¬g‘
()

156 .
bšdTo
(
£rv”
).
švoke
();

159 
fš®
 
	gHªdËrM‘hod
<
	gCÜfuMsg
> 
	ghªdËr
 = 
g’”©eCÚd™iÚ®HªdËr
(
ªnÙ©iÚ
.
ty³
(), 
h
);

161 
	ghªdËrM­
.
put
(
ªnÙ©iÚ
.
ty³
(), 
hªdËr
);

162 } 
ÿtch
 (
ThrowabË
 
e
) {

163 
	glog
.
”rÜ
("Exû±iÚ duršg mes§ghªdË¸»gi¡¿tiÚ", 
e
);

164 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
e
);

176 
´iv©e
 
	gHªdËrM‘hod
<
	gCÜfuMsg
> 
g’”©eCÚd™iÚ®HªdËr
(@
NÚnuÎ
 
fš®
 
CÜfuMsgTy³
 
ty³
,

177 @
NÚnuÎ
 
fš®
 
HªdËrM‘hod
<
CÜfuMsg
> 
hªdËr
) {

179 
fš®
 
Tim”
 
	gtim”
 = 
g‘Tim”
(
ty³
);

183  (
	gmsg
, 
	gùx
, 
	gr
) -> {

184 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
tim”
)) {

185 
hªdËr
.
hªdË
(
msg
, 
ùx
, 
r
);

191 
´iv©e
 
Tim”
 
g‘Tim”
(@
NÚnuÎ
 
CÜfuMsgTy³
 
ty³
) {

192 
	gtim”NameCache
.
compu‹IfAb£Á
(
ty³
,

193 
aTy³
 -> (
CÜfuCompÚ’t
.
INFRA_MSG_HANDLER
 +

194 
aTy³
.
Çme
().
toLow”Ca£
()));

196  
	gS”v”CÚ‹xt
.
g‘M‘rics
().
tim”
(
tim”NameCache
.
g‘
(
ty³
));

	@infrastructure/src/main/java/org/corfudb/infrastructure/IServerRouter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

6 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
public
 
š‹rçû
 
	gIS”v”Rou‹r
 {

12 
£ndRe¥Ú£
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
šMsg
, CÜfuMsg 
outMsg
);

17 
g‘S”v”Epoch
();

22 
£tS”v”Epoch
(
ÃwEpoch
);

28 
addS”v”
(
Ab¡¿ùS”v”
 
£rv”
);

33 
	gLi¡
<
	gAb¡¿ùS”v”
> 
g‘S”v”s
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/LayoutServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

8 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
.
	gNÚNuÎ
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”Th»adFaùÜy
.
	gExû±iÚHªdËr
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g·xos
.
	gPaxosD©aStÜe
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutBoÙ¡¿pReque¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutComm™‹dReque¡
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutMsg
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Reque¡
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Re¥Ú£
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutPrİo£Reque¡
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutPrİo£Re¥Ú£
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

26 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

60 @
Slf4j


61 
public
 cÏs 
	cLayoutS”v”
 
ex‹nds
 
	mAb¡¿ùS”v”
 {

63 @
G‘‹r


64 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

69 @
G‘‹r


70 
´iv©e
 
fš®
 
HªdËrM‘hods
 
	mhªdËr
 =

71 
HªdËrM‘hods
.
g’”©eHªdËr
(
M‘hodHªdËs
.
lookup
(), 
this
);

73 @
NÚNuÎ


74 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mexecutÜ
;

76 @
NÚNuÎ


77 
´iv©e
 
fš®
 
PaxosD©aStÜe
 
	m·xosD©aStÜe
;

79 @
Ov”ride


80 
public
 
boŞ—n
 
	$isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

81  
	`g‘S‹
(è=ğ
S”v”S‹
.
READY
;

89 
public
 
	`LayoutS”v”
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

90 
this
.
£rv”CÚ‹xt
 = serverContext;

92 
this
.
·xosD©aStÜe
 = 
PaxosD©aStÜe
.
	`bud”
()

93 .
	`d©aStÜe
(
£rv”CÚ‹xt
.
	`g‘D©aStÜe
())

94 .
	`bud
();

96 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(

97 
£rv”CÚ‹xt
.
	`g‘LayoutS”v”Th»adCouÁ
(),

98 
Ãw
 
	`S”v”Th»adFaùÜy
("ÏyoutS”v”-",‚ew 
	`Exû±iÚHªdËr
())

101 ià(
£rv”CÚ‹xt
.
	`š¡®lSšgËNodeLayoutIfAb£Á
()) {

102 
	`£tLayoutInHi¡Üy
(
	`g‘Cu¼’tLayout
());

104 
	}
}

106 @
Ov”ride


107 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

108 
executÜ
.
	`subm™
((è-> 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
));

109 
	}
}

111 @
Ov”ride


112 
public
 
	$shutdown
() {

113 
su³r
.
	`shutdown
();

114 
executÜ
.
	`shutdown
();

115 
	}
}

118 
´iv©e
 
boŞ—n
 
	$isBoÙ¡¿µed
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

119 ià(
	`g‘Cu¼’tLayout
(è=ğ
nuÎ
) {

120 
log
.
	`w¬n
("Reûived mes§gbuˆnÙ boÙ¡¿µed! Mes§ge={}", 
msg
);

121 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
LAYOUT_NOBOOTSTRAP
));

122  
çl£
;

124  
Œue
;

125 
	}
}

136 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_REQUEST
)

137 
public
 
synchrÚized
 
	`hªdËMes§geLayoutReque¡
(
CÜfuPaylßdMsg
<
LÚg
> 
msg
,

138 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

139 ià(!
	`isBoÙ¡¿µed
(
msg
, 
ùx
, 
r
)) {

143 
fš®
 
msgEpoch
 = 
msg
.
	`g‘Paylßd
();

144 
fš®
 
£rv”Epoch
 = 
	`g‘S”v”Epoch
();

146 ià(
msgEpoch
 <ğ
£rv”Epoch
) {

147 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`LayoutMsg
(
	`g‘Cu¼’tLayout
(), 
CÜfuMsgTy³


148 .
LAYOUT_RESPONSE
));

152 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
, 
£rv”Epoch
));

153 
log
.
	`w¬n
("handleMessageLayoutRequest: Message Epoch {}‡head of Serverƒpoch {}",

154 
msgEpoch
, 
£rv”Epoch
);

156 
	}
}

165 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP
)

166 
public
 
synchrÚized
 
	`hªdËMes§geLayoutBoÙ¡¿p
(

167 @
NÚNuÎ
 
CÜfuPaylßdMsg
<
LayoutBoÙ¡¿pReque¡
> 
msg
,

168 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

169 @
NÚNuÎ
 
IS”v”Rou‹r
 
r
) {

171 ià(
	`g‘Cu¼’tLayout
(è=ğ
nuÎ
) {

172 
log
.
	`šfo
("handleMessageLayoutBootstrap: Bootstrap with‚ew†ayout={}, {}",

173 
msg
.
	`g‘Paylßd
().
	`g‘Layout
(), msg);

174 
	`£tCu¼’tLayout
(
msg
.
	`g‘Paylßd
().
	`g‘Layout
());

175 
£rv”CÚ‹xt
.
	`£tS”v”Epoch
(
	`g‘Cu¼’tLayout
().
	`g‘Epoch
(), 
r
);

177 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

180 
log
.
	`w¬n
("handleMessageLayoutBootstrap: Got‡„equesto bootstrap‡ server which is "

182 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
LAYOUT_ALREADY_BOOTSTRAP
));

184 
	}
}

195 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_PREPARE
)

196 
public
 
synchrÚized
 
	`hªdËMes§geLayoutP»·»
(

197 @
NÚNuÎ
 
CÜfuPaylßdMsg
<
LayoutP»·»Reque¡
> 
msg
,

198 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

199 @
NÚNuÎ
 
IS”v”Rou‹r
 
r
) {

202 ià(!
	`isBoÙ¡¿µed
(
msg
, 
ùx
, 
r
)) {

206 
fš®
 
·ylßdEpoch
 = 
msg
.
	`g‘Paylßd
().
	`g‘Epoch
();

207 
fš®
 
£rv”Epoch
 = 
	`g‘S”v”Epoch
();

209 
fš®
 
Rªk
 
´•¬eRªk
 = 
Ãw
 
	`Rªk
(
msg
.
	`g‘Paylßd
().
	`g‘Rªk
(), msg.
	`g‘Cl›ÁID
());

210 
fš®
 
Rªk
 
pha£1Rªk
 = 
	`g‘Pha£1Rªk
(
·ylßdEpoch
);

212 ià(
·ylßdEpoch
 !ğ
£rv”Epoch
) {

213 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
, 
£rv”Epoch
));

214 
log
.
	`Œaû
("handleMessageLayoutPrepare: Incoming message with wrongƒpoch, got {}, "

216 
msg
.
	`g‘Paylßd
().
	`g‘Epoch
(), 
£rv”Epoch
, msg);

220 
Layout
 
´İo£dLayout
 = 
	`g‘Prİo£dLayout
(
·ylßdEpoch
);

223 ià(
pha£1Rªk
 !ğ
nuÎ
 && 
´•¬eRªk
.
	`ËssThªEqu®To
(phase1Rank)) {

224 
log
.
	`debug
("handleMessageLayoutPrepare: Rejected…hase 1…repare of„ank={}, "

225 + "pha£1Rªk={}", 
´•¬eRªk
, 
pha£1Rªk
);

226 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LAYOUT_PREPARE_REJECT
.
	`·ylßdMsg
(
Ãw


227 
	`LayoutP»·»Re¥Ú£
(
pha£1Rªk
.
	`g‘Rªk
(), 
´İo£dLayout
)));

230 
Rªk
 
highe¡Prİo£dRªk
 = 
´İo£dLayout
 =ğ
nuÎ
 ? 
Ãw
 
	`Rªk
(-1L, 
msg
.
	`g‘Cl›ÁID
())

231 : 
	`g‘Pha£2Rªk
(
·ylßdEpoch
);

232 
	`£tPha£1Rªk
(
´•¬eRªk
, 
·ylßdEpoch
);

233 
log
.
	`debug
("hªdËMes§geLayoutP»·»: New…ha£ 1„ªk={}", 
´•¬eRªk
);

234 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LAYOUT_PREPARE_ACK
.
	`·ylßdMsg
(
Ãw


235 
	`LayoutP»·»Re¥Ú£
(
highe¡Prİo£dRªk
.
	`g‘Rªk
(), 
´İo£dLayout
)));

237 
	}
}

247 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_PROPOSE
)

248 
public
 
synchrÚized
 
	`hªdËMes§geLayoutPrİo£
(

249 @
NÚNuÎ
 
CÜfuPaylßdMsg
<
LayoutPrİo£Reque¡
> 
msg
,

250 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

251 @
NÚNuÎ
 
IS”v”Rou‹r
 
r
) {

253 ià(!
	`isBoÙ¡¿µed
(
msg
, 
ùx
, 
r
)) {

257 
fš®
 
·ylßdEpoch
 = 
msg
.
	`g‘Paylßd
().
	`g‘Epoch
();

258 
fš®
 
£rv”Epoch
 = 
	`g‘S”v”Epoch
();

260 
fš®
 
Rªk
 
´İo£Rªk
 = 
Ãw
 
	`Rªk
(
msg
.
	`g‘Paylßd
().
	`g‘Rªk
(), msg.
	`g‘Cl›ÁID
());

261 
fš®
 
Rªk
 
pha£1Rªk
 = 
	`g‘Pha£1Rªk
(
·ylßdEpoch
);

264 ià(
·ylßdEpoch
 !ğ
£rv”Epoch
) {

265 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
, 
£rv”Epoch
));

266 
log
.
	`Œaû
("handleMessageLayoutPropose: Incoming message with wrongƒpoch, got {}, "

267 + "ex³ùed {}, mes§gwas: {}", 
·ylßdEpoch
, 
£rv”Epoch
, 
msg
);

271 ià(
pha£1Rªk
 =ğ
nuÎ
) {

272 
log
.
	`debug
("handleMessageLayoutPropose: Rejected…hase 2…ropose of„ank={}, "

273 + "pha£1RªkòÚe", 
´İo£Rªk
);

274 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE_REJECT
.
	`·ylßdMsg
(
Ãw


275 
	`LayoutPrİo£Re¥Ú£
(-1)));

280 ià(!
´İo£Rªk
.
	`equ®s
(
pha£1Rªk
)) {

281 
log
.
	`debug
("handleMessageLayoutPropose: Rejected…hase 2…ropose of„ank={}, "

282 + "pha£1Rªk={}", 
´İo£Rªk
, 
pha£1Rªk
);

283 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE_REJECT
.
	`·ylßdMsg
(
Ãw


284 
	`LayoutPrİo£Re¥Ú£
(
pha£1Rªk
.
	`g‘Rªk
())));

288 
fš®
 
Rªk
 
pha£2Rªk
 = 
	`g‘Pha£2Rªk
(
·ylßdEpoch
);

289 
fš®
 
Layout
 
´İo£Layout
 = 
msg
.
	`g‘Paylßd
().
	`g‘Layout
();

292 ià(
´İo£Layout
.
	`g‘Epoch
(è!ğ
·ylßdEpoch
) {

293 
log
.
	`debug
("Phase IIƒrror:†ayout {}‡nd…ayload {}ƒpoch should behe same",

294 
´İo£Layout
.
	`g‘Epoch
(), 
·ylßdEpoch
);

295 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE_REJECT
.
	`·ylßdMsg
(
Ãw


296 
	`LayoutPrİo£Re¥Ú£
(
pha£1Rªk
.
	`g‘Rªk
())));

303 ià(
´İo£Rªk
.
	`equ®s
(
pha£2Rªk
)) {

304 
log
.
	`debug
("handleMessageLayoutPropose: Rejected…hase 2…ropose of„ank={}, "

305 + "pha£2Rªk={}", 
´İo£Rªk
, 
pha£2Rªk
);

306 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE_REJECT
.
	`·ylßdMsg
(
Ãw


307 
	`LayoutPrİo£Re¥Ú£
(
pha£2Rªk
.
	`g‘Rªk
())));

311 
log
.
	`debug
("handleMessageLayoutPropose: New…hase 2„ank={},†ayout={}",

312 
´İo£Rªk
, 
´İo£Layout
);

313 
	`£tPha£2D©a
(
Ãw
 
	`Pha£2D©a
(
´İo£Rªk
, 
´İo£Layout
), 
·ylßdEpoch
);

314 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

315 
	}
}

326 
´iv©e
 
synchrÚized
 
fÜûLayout
(@
NÚnuÎ
 
CÜfuPaylßdMsg
<
LayoutComm™‹dReque¡
> 
msg
,

327 @
NÚnuÎ
 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

328 @
NÚnuÎ
 
IS”v”Rou‹r
 
r
) {

329 
fš®
 
	g·ylßdEpoch
 = 
msg
.
g‘Paylßd
().
g‘Epoch
();

330 
fš®
 
	g£rv”Epoch
 = 
g‘S”v”Epoch
();

332 ià(
	g·ylßdEpoch
 !ğ
£rv”Epoch
) {

334 
r
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuMsg
(
CÜfuMsgTy³
.
NACK
));

335 
	glog
.
w¬n
("forceLayout: Tryingo force‡†ayout with‡n oldƒpoch. Layout {}, " +

336 "cu¼’ˆ•och {}", 
·ylßdEpoch
, 
£rv”Epoch
);

340 
fš®
 
Layout
 
	gmsgLayout
 = 
msg
.
g‘Paylßd
().
g‘Layout
();

342 
£tCu¼’tLayout
(
msgLayout
);

343 
	g£rv”CÚ‹xt
.
£tS”v”Epoch
(
msgLayout
.
g‘Epoch
(), 
r
);

344 
	glog
.
w¬n
("fÜûLayout: FÜcšg‚ew†ayouˆ{}", 
msgLayout
);

345 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

361 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_COMMITTED
)

362 
public
 
synchrÚized
 
	`hªdËMes§geLayoutComm™
(

363 @
NÚNuÎ
 
CÜfuPaylßdMsg
<
LayoutComm™‹dReque¡
> 
msg
,

364 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

365 @
NÚNuÎ
 
IS”v”Rou‹r
 
r
) {

367 ià(
msg
.
	`g‘Paylßd
().
	`g‘FÜû
()) {

368 
	`fÜûLayout
(
msg
, 
ùx
, 
r
);

372 ià(!
	`isBoÙ¡¿µed
(
msg
, 
ùx
, 
r
)) {

376 
fš®
 
·ylßdEpoch
 = 
msg
.
	`g‘Paylßd
().
	`g‘Epoch
();

377 
fš®
 
£rv”Epoch
 = 
	`g‘S”v”Epoch
();

378 
fš®
 
Layout
 
msgLayout
 = 
msg
.
	`g‘Paylßd
().
	`g‘Layout
();

380 ià(
·ylßdEpoch
 < 
£rv”Epoch
) {

381 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
, 
£rv”Epoch
));

385 
	`£tCu¼’tLayout
(
msgLayout
);

386 
£rv”CÚ‹xt
.
	`£tS”v”Epoch
(
·ylßdEpoch
, 
r
);

387 
log
.
	`šfo
("New†ayouˆcomm™‹d: {}", 
msgLayout
);

388 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

389 
	}
}

392 
public
 
Layout
 
	$g‘Cu¼’tLayout
() {

393 
Layout
 
Ïyout
 = 
£rv”CÚ‹xt
.
	`g‘Cu¼’tLayout
();

394 ià(
Ïyout
 !ğ
nuÎ
) {

395  
Ãw
 
	`Layout
(
Ïyout
);

397  
nuÎ
;

399 
	}
}

406 
public
 
	$£tCu¼’tLayout
(
Layout
 
Ïyout
) {

407 
£rv”CÚ‹xt
.
	`£tCu¼’tLayout
(
Ïyout
);

409 
	`£tLayoutInHi¡Üy
(
Ïyout
);

410 
	}
}

412 
public
 
Rªk
 
	$g‘Pha£1Rªk
(
•och
) {

413  
·xosD©aStÜe


414 .
	`g‘Pha£1Rªk
(
•och
)

415 .
	`ÜEl£
(
nuÎ
);

416 
	}
}

418 
public
 
	$£tPha£1Rªk
(
Rªk
 
¿nk
, 
•och
) {

419 
·xosD©aStÜe
.
	`£tPha£1Rªk
(
¿nk
, 
•och
);

420 
	}
}

422 
public
 
	$£tPha£2D©a
(
Pha£2D©a
 
pha£2D©a
, 
•och
) {

423 
·xosD©aStÜe
.
	`£tPha£2D©a
(
pha£2D©a
, 
•och
);

424 
	}
}

426 
public
 
	$£tLayoutInHi¡Üy
(
Layout
 
Ïyout
) {

427 
£rv”CÚ‹xt
.
	`£tLayoutInHi¡Üy
(
Ïyout
);

428 
	}
}

430 
´iv©e
 
	$g‘S”v”Epoch
() {

431  
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
();

432 
	}
}

439 
public
 
Rªk
 
	$g‘Pha£2Rªk
(
•och
) {

440  
·xosD©aStÜe


441 .
	`g‘Pha£2D©a
(
•och
)

442 .
	`m­
(
Pha£2D©a
::
g‘Rªk
)

443 .
	`ÜEl£
(
nuÎ
);

444 
	}
}

451 
public
 
Layout
 
	$g‘Prİo£dLayout
(
•och
) {

452  
·xosD©aStÜe


453 .
	`g‘Pha£2D©a
(
•och
)

454 .
	`m­
(
Pha£2D©a
::
g‘Layout
)

455 .
	`ÜEl£
(
nuÎ
);

456 
	}
}

464 @
VisibËFÜTe¡šg


465 
	gO±iÚ®
<
	gPha£2D©a
> 
	$g‘Pha£2D©a
(
•och
) {

466  
·xosD©aStÜe
.
	`g‘Pha£2D©a
(
•och
);

467 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/LocalMonitoringService.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gLambdaUts
.
	grunSªsThrow
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”v”NÙR—dyExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
.
	gSšgËtÚResourû
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

25 @
Slf4j


26 şas 
	cLoÿlMÚ™ÜšgS”viû
 
im¶em’ts
 
	mMÚ™ÜšgS”viû
 {

27 
´iv©e
 
fš®
 
	mCom¶‘abËFutu»
<
	mSequ’ûrM‘rics
> 
	mUNKNOWN
 = 
Com¶‘abËFutu»


28 .
com¶‘edFutu»
(
Sequ’ûrM‘rics
.
UNKNOWN
);

30 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

31 
´iv©e
 
fš®
 
	mSšgËtÚResourû
<
	mCÜfuRuÁime
> 
	mruÁimeSšgËtÚResourû
;

33 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	mpŞlšgS”viû
;

35 
´iv©e
 
fš®
 
	mAtomicReã»nû
<
	mCom¶‘abËFutu»
<
	mSequ’ûrM‘rics
>> 
	m£qu’ûrM‘ricsHŞd”
;

37 
LoÿlMÚ™ÜšgS”viû
(@
NÚNuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
,

38 @
NÚNuÎ
 
SšgËtÚResourû
<
CÜfuRuÁime
> 
ruÁimeSšgËtÚResourû
) {

39 
	mthis
.
	m£rv”CÚ‹xt
 = 
£rv”CÚ‹xt
;

40 
	mthis
.
	mruÁimeSšgËtÚResourû
 = 
ruÁimeSšgËtÚResourû
;

41 
	m£qu’ûrM‘ricsHŞd”
 = 
Ãw
 
AtomicReã»nû
<>(
UNKNOWN
);

43 
	mthis
.
	mpŞlšgS”viû
 = 
ExecutÜs
.
ÃwSšgËTh»adScheduËdExecutÜ
(

44 
Ãw
 
Th»adFaùÜyBud”
()

45 .
£tD«mÚ
(
Œue
)

46 .
£tNameFÜm©
(
£rv”CÚ‹xt
.
g‘Th»adP»fix
() + "LocalMetricsPolling")

47 .
bud
());

50 
´iv©e
 
CÜfuRuÁime
 
	$g‘CÜfuRuÁime
() {

51  
ruÁimeSšgËtÚResourû
.
	`g‘
();

52 
	}
}

61 
´iv©e
 
	gCom¶‘abËFutu»
<
	gSequ’ûrM‘rics
> 
	$qu”yLoÿlSequ’ûrM‘rics
(
Layout
 
Ïyout
) {

64 ià(!
Ïyout
.
	`g‘Prim¬ySequ’ûr
().
	`equ®s
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())) {

65  
UNKNOWN
;

69  
	`g‘CÜfuRuÁime
()

70 .
	`g‘LayoutV›w
()

71 .
	`g‘RuÁimeLayout
(
Ïyout
)

72 .
	`g‘Sequ’ûrCl›Á
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())

73 .
	`»que¡M‘rics
()

75 .
	`exû±iÚ®ly
(
ex
 -> {

76 ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
S”v”NÙR—dyExû±iÚ
) {

77  
Sequ’ûrM‘rics
.
NOT_READY
;

80 
log
.
	`”rÜ
("E¼Ü wh»que¡šg m‘ric äomh£qu’ûr: ", 
ex
);

81  
Sequ’ûrM‘rics
.
UNKNOWN
;

83 
	}
}

91 
´iv©e
 
	$upd©eLoÿlM‘rics
() {

95 
Layout
 
Ïyout
 = 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

96 ià(
Ïyout
 =ğ
nuÎ
) {

97 
log
.
	`debug
("updateLocalMetrics: Cannot update†ocal metrics. Management Server‚ot bootstrapped.");

102 
£qu’ûrM‘ricsHŞd”
.
	`£t
(
	`qu”yLoÿlSequ’ûrM‘rics
(
Ïyout
));

103 
	}
}

108 @
Ov”ride


109 
public
 
	$¡¬t
(
Du¿tiÚ
 
mÚ™ÜšgIÁ”v®
) {

111 
pŞlšgS”viû
.
	`scheduËAtFixedR©e
(

112 (è-> 
	`runSªsThrow
(
this
::
upd©eLoÿlM‘rics
),

114 
mÚ™ÜšgIÁ”v®
.
	`toMlis
(),

115 
TimeUn™
.
MILLISECONDS


117 
	}
}

122 @
Ov”ride


123 
public
 
	$shutdown
() {

125 
pŞlšgS”viû
.
	`shutdownNow
();

126 
log
.
	`šfo
("Local Metrics Polling Task shutting down.");

127 
	}
}

129 
public
 
	gCom¶‘abËFutu»
<
	gSequ’ûrM‘rics
> 
	$g‘M‘rics
() {

130  
£qu’ûrM‘ricsHŞd”
.
	`g‘
();

131 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/LogReplicationServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gSškMªag”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

16 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

17 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

30 @
Slf4j


31 
public
 cÏs 
	cLogR•liÿtiÚS”v”
 
ex‹nds
 
	mAb¡¿ùS”v”
 {

33 
´iv©e
 
fš®
 
SŒšg
 
	mcÚfigFeP©h
 = "/config/corfu/log_replication_config.properties";

35 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

37 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mexecutÜ
;

39 @
G‘‹r


40 
´iv©e
 
fš®
 
SškMªag”
 
	msškMªag”
;

42 @
G‘‹r


43 
´iv©e
 
fš®
 
HªdËrM‘hods
 
	mhªdËr
 = HªdËrM‘hods.
g’”©eHªdËr
(
M‘hodHªdËs
.
lookup
(), 
this
);

45 
public
 
LogR•liÿtiÚS”v”
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
) {

46 
	mthis
.
	m£rv”CÚ‹xt
 = 
cÚ‹xt
;

47 
	mthis
.
	mexecutÜ
 = 
ExecutÜs
.
ÃwFixedTh»adPoŞ
(1,

48 
Ãw
 
S”v”Th»adFaùÜy
("LogR•liÿtiÚS”v”-",‚ew S”v”Th»adFaùÜy.
Exû±iÚHªdËr
()));

49 
LogR•liÿtiÚCÚfig
 
	mcÚfig
 = LogR•liÿtiÚCÚfig.
äomFe
(
cÚfigFeP©h
);

52 
SŒšg
 
	mcÜfuPÜt
 = 
£rv”CÚ‹xt
.
g‘LoÿlEndpošt
().
equ®s
("localhost:9020") ? ":9001" : ":9000";

53 
SŒšg
 
	mcÜfuEndpošt
 = 
£rv”CÚ‹xt
.
g‘NodeLoÿtÜ
().
g‘Ho¡
(è+ 
cÜfuPÜt
;

54 
	mlog
.
šfo
("In™ŸlizSšk Mªag” w™h CÜfuRuÁimtØ{}", 
cÜfuEndpošt
);

55 
	mthis
.
	msškMªag”
 = 
Ãw
 
SškMªag”
(
cÜfuEndpošt
, 
cÚfig
);

60 @
Ov”ride


61 
public
 
boŞ—n
 
	$isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

62  
	`g‘S‹
(è=ğ
S”v”S‹
.
READY
;

63 
	}
}

65 @
Ov”ride


66 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

67 
executÜ
.
	`subm™
((è-> 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
));

68 
	}
}

70 @
Ov”ride


71 
public
 
	$shutdown
() {

72 
su³r
.
	`shutdown
();

73 
executÜ
.
	`shutdown
();

74 
	}
}

78 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_REPLICATION_ENTRY
)

79 
´iv©e
 
	`hªdËLogR•liÿtiÚEÁry
(
CÜfuPaylßdMsg
<
LogR•liÿtiÚEÁry
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

80 
log
.
	`šfo
("Log Replication Entry„eceived by Server.");

82 
LogR•liÿtiÚEÁry
 
ack
 = 
sškMªag”
.
	`»ûive
(
msg
.
	`g‘Paylßd
());

84 ià(
ack
 !ğ
nuÎ
) {

85 
ts
 = 
ack
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
().
	`equ®s
(
Mes§geTy³
.
LOG_ENTRY_REPLICATED
) ?

86 
ack
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
(è:‡ck.g‘M‘ad©a().
	`g‘SÇpshÙTime¡amp
();

87 
log
.
	`šfo
("S’dšg ACK {} oÀ{}ØCl›Á ", 
ack
.
	`g‘M‘ad©a
(), 
ts
);

89 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LOG_REPLICATION_ENTRY
.
	`·ylßdMsg
(
ack
));

91 
	}
}

93 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_REPLICATION_NEGOTIATION_REQUEST
)

94 
´iv©e
 
	$hªdËLogR•liÿtiÚNegÙŸtiÚReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

95 
log
.
	`šfo
("Log Replication Negotiation Request„eceived by Server.");

96 
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
 
»¥Ú£
 = 
Ãw
 
	`LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
(0, 0);

97 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LOG_REPLICATION_NEGOTIATION_RESPONSE
.
	`·ylßdMsg
(
»¥Ú£
));

98 
	}
}

100 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_REPLICATION_QUERY_LEADERSHIP
)

101 
´iv©e
 
	$hªdËLogR•liÿtiÚQu”yL—d”sh
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

102 
log
.
	`šfo
("******Log Replication Query Leadership Request„eceived by Server.");

104 
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
 
»¥
 = 
Ãw
 
	`LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
(0, 
Œue
);

105 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
LOG_REPLICATION_QUERY_LEADERSHIP_RESPONSE
.
	`·ylßdMsg
(
»¥
));

106 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/LogUnitServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gInMemÜySŒ—mLog
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLog
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogCom·ùiÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gExû±iÚMsg
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gKnownAdd»ssReque¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gMuÉËR—dReque¡
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gRªgeWr™eMsg
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dReque¡
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasReque¡
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTrimReque¡
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gWr™eReque¡
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aOuŒªkedExû±iÚ
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLogUn™Exû±iÚ
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gV®ueAdİ‹dExû±iÚ
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

39 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

40 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

41 
impÜt
 
	gjava
.
	gut
.
	gM­
;

42 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

43 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

44 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘iÚExû±iÚ
;

45 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

46 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

47 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

49 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gLOG_ADDRESS_SPACE_QUERY
;

50 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gPREFIX_TRIM
;

51 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gRANGE_WRITE
;

52 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gRESET
;

53 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gSEAL
;

54 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gTAILS_QUERY
;

55 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gB©chWr™”O³¿tiÚ
.
	gTy³
.
	gWRITE
;

73 @
Slf4j


74 
public
 cÏs 
	cLogUn™S”v”
 
ex‹nds
 
	mAb¡¿ùS”v”
 {

79 
´iv©e
 
fš®
 
LogUn™S”v”CÚfig
 
	mcÚfig
;

84 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

89 @
G‘‹r


90 
´iv©e
 
fš®
 
HªdËrM‘hods
 
	mhªdËr
 = HªdËrM‘hods.
g’”©eHªdËr
(
M‘hodHªdËs
.
lookup
(), 
this
);

97 
´iv©e
 
fš®
 
LogUn™S”v”Cache
 
	md©aCache
;

98 @
G‘‹r


99 
´iv©e
 
fš®
 
SŒ—mLog
 
	m¡»amLog
;

100 
´iv©e
 
fš®
 
SŒ—mLogCom·ùiÚ
 
	mlogCËª”
;

101 
´iv©e
 
fš®
 
B©chProûssÜ
 
	mb©chWr™”
;

103 
´iv©e
 
ExecutÜS”viû
 
	mexecutÜ
;

110 
public
 
	$LogUn™S”v”
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

111 
this
.
£rv”CÚ‹xt
 = serverContext;

112 
this
.
cÚfig
 = 
LogUn™S”v”CÚfig
.
	`·r£
(
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
());

113 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
£rv”CÚ‹xt
.
	`g‘Logun™Th»adCouÁ
(),

114 
Ãw
 
	`S”v”Th»adFaùÜy
("LogUn™-",‚ew 
S”v”Th»adFaùÜy
.
	`Exû±iÚHªdËr
()));

116 ià(
cÚfig
.
	`isMemÜyMode
()) {

117 
log
.
	`w¬n
("Log unit opened in-memory mode (Maximum size={}). "

121 + "Thun™ WILL LOSE ALL DATA ià™ƒx™s.", 
Uts


122 .
	`cÚv”tToBy‹SŒšgR•»£Á©iÚ
(
cÚfig
.
	`g‘MaxCacheSize
()));

123 
¡»amLog
 = 
Ãw
 
	`InMemÜySŒ—mLog
();

125 
¡»amLog
 = 
Ãw
 
	`SŒ—mLogFes
(
£rv”CÚ‹xt
, 
cÚfig
.
	`isNoV”ify
());

128 
d©aCache
 = 
Ãw
 
	`LogUn™S”v”Cache
(
cÚfig
, 
¡»amLog
);

129 
b©chWr™”
 = 
Ãw
 
	`B©chProûssÜ
(
¡»amLog
, 
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
(), !
cÚfig
.
	`isNoSync
());

131 
logCËª”
 = 
Ãw
 
	`SŒ—mLogCom·ùiÚ
(
¡»amLog
, 10, 45, 
TimeUn™
.
MINUTES
, 
S”v”CÚ‹xt
.
SHUTDOWN_TIMER
);

135 @
Ov”ride


136 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

137 
executÜ
.
	`subm™
((è-> 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
));

138 
	}
}

143 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
TAIL_REQUEST
)

144 
public
 
	`hªdËTaReque¡
(
CÜfuPaylßdMsg
<
TasReque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

145 
log
.
	`debug
("hªdËTaReque¡:„eûived‡a„eque¡ {}", 
msg
);

146 
b©chWr™”
.<
TasRe¥Ú£
>
	`addTask
(
TAILS_QUERY
, 
msg
)

147 .
	`th’Acû±
(
sRe¥
 -> 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
TAIL_RESPONSE
.
	`·ylßdMsg
(tailsResp)))

148 .
	`exû±iÚ®ly
(
ex
 -> {

149 
	`hªdËExû±iÚ
(
ex
, 
ùx
, 
msg
, 
r
);

150  
nuÎ
;

152 
	}
}

158 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_ADDRESS_SPACE_REQUEST
)

159 
public
 
	$hªdËLogAdd»ssS·ûReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

160 
CÜfuPaylßdMsg
<
Void
> 
·ylßdMsg
 = 
Ãw
 CorfuPayloadMsg<>();

161 
·ylßdMsg
.
	`cİyBa£F›lds
(
msg
);

162 
log
.
	`debug
("hªdËLogAdd»ssS·ûReque¡:„eûived‡†og‡dd»s ¥aû„eque¡ {}", 
msg
);

163 
b©chWr™”
.<
SŒ—msAdd»ssRe¥Ú£
>
	`addTask
(
LOG_ADDRESS_SPACE_QUERY
, 
·ylßdMsg
)

164 .
	`th’Acû±
(
sRe¥
 -> 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
,

165 
CÜfuMsgTy³
.
LOG_ADDRESS_SPACE_RESPONSE
.
	`·ylßdMsg
(
sRe¥
)))

166 .
	`exû±iÚ®ly
(
ex
 -> {

167 
	`hªdËExû±iÚ
(
ex
, 
ùx
, 
·ylßdMsg
, 
r
);

168  
nuÎ
;

170 
	}
}

175 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
TRIM_MARK_REQUEST
)

176 
public
 
	$hªdËTrimM¬kReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

177 
log
.
	`debug
("hªdËTrimM¬kReque¡:„eûived‡rim m¬k„eque¡ {}", 
msg
);

178 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
TRIM_MARK_RESPONSE
.
	`·ylßdMsg
(
¡»amLog
.
	`g‘TrimM¬k
()));

179 
	}
}

184 
	$hªdËExû±iÚ
(
ThrowabË
 
ex
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuPaylßdMsg
 
msg
, 
IS”v”Rou‹r
 
r
) {

185 
log
.
	`Œaû
("hªdËExû±iÚ: hªdlšgƒxû±iÚ {} fÜ {}", 
ex
, 
msg
);

186 ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
WrÚgEpochExû±iÚ
) {

187 
WrÚgEpochExû±iÚ
 
w“
 = (WrÚgEpochExû±iÚè
ex
.
	`g‘Cau£
();

188 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
, 
w“
.
	`g‘CÜ»ùEpoch
()));

189 } ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
Ov”wr™eExû±iÚ
) {

190 
Ov”wr™eExû±iÚ
 
owe
 = (Ov”wr™eExû±iÚè
ex
.
	`g‘Cau£
();

191 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_OVERWRITE


192 .
	`·ylßdMsg
(
owe
.
	`g‘Ov”Wr™eCau£
().
	`g‘Id
()));

193 } ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
D©aOuŒªkedExû±iÚ
) {

194 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_DATA_OUTRANKED
.
	`msg
());

195 } ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
V®ueAdİ‹dExû±iÚ
) {

196 
V®ueAdİ‹dExû±iÚ
 
v«
 = (V®ueAdİ‹dExû±iÚè
ex
.
	`g‘Cau£
();

197 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_VALUE_ADOPTED
.
	`·ylßdMsg
(
v«
.
	`g‘R—dRe¥Ú£
()));

198 } ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
TrimmedExû±iÚ
) {

199 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_TRIMMED
.
	`msg
());

201 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_SERVER_EXCEPTION
.
	`·ylßdMsg
(
Ãw
 
	`Exû±iÚMsg
(
ex
)));

202 
throw
 
Ãw
 
	`LogUn™Exû±iÚ
(
ex
);

204 
	}
}

209 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
WRITE
)

210 
public
 
	`wr™e
(
CÜfuPaylßdMsg
<
Wr™eReque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

211 
LogD©a
 
logD©a
 = (LogD©aè
msg
.
	`g‘Paylßd
().
	`g‘D©a
();

212 
log
.
	`debug
("log wr™e:y³: {},‡dd»ss: {}, sŒ—ms: {}", 
logD©a
.
	`g‘Ty³
(),

213 
logD©a
.
	`g‘Tok’
(),†ogD©a.
	`g‘Backpoš‹rM­
());

218 ià(
logD©a
.
	`isHŞe
()) {

219 
msg
.
	`£tPriÜ™yLev–
(
PriÜ™yLev–
.
HIGH
);

222 
b©chWr™”
.
	`addTask
(
WRITE
, 
msg
)

223 .
	`th’RunAsync
(() -> {

224 
d©aCache
.
	`put
(
msg
.
	`g‘Paylßd
().
	`g‘Glob®Add»ss
(), 
logD©a
);

225 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
WRITE_OK
.
	`msg
());

226 }, 
executÜ
).
	`exû±iÚ®ly
(
ex
 -> {

227 
	`hªdËExû±iÚ
(
ex
, 
ùx
, 
msg
, 
r
);

228  
nuÎ
;

230 
	}
}

235 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
RANGE_WRITE
)

236 
public
 
	`¿ngeWr™e
(
CÜfuPaylßdMsg
<
RªgeWr™eMsg
> 
msg
,

237 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

238 
Li¡
<
LogD©a
> 
¿nge
 = 
msg
.
	`g‘Paylßd
().
	`g‘EÁr›s
();

239 
log
.
	`debug
("¿ngeWr™e: Wr™šg {}ƒÁr› [{}-{}]", 
¿nge
.
	`size
(),

240 
¿nge
.
	`g‘
(0).
	`g‘Glob®Add»ss
(),„ªge.g‘Ôªge.
	`size
() - 1).getGlobalAddress());

242 
b©chWr™”
.
	`addTask
(
RANGE_WRITE
, 
msg
)

243 .
	`th’Run
((è-> 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
WRITE_OK
.
	`msg
()))

244 .
	`exû±iÚ®ly
(
ex
 -> {

245 
	`hªdËExû±iÚ
(
ex
, 
ùx
, 
msg
, 
r
);

246  
nuÎ
;

248 
	}
}

257 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
PREFIX_TRIM
)

258 
´iv©e
 
	`´efixTrim
(
CÜfuPaylßdMsg
<
TrimReque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

259 
IS”v”Rou‹r
 
r
) {

260 
log
.
	`debug
("´efixTrim:rimmšg…»fixØ{}", 
msg
.
	`g‘Paylßd
().
	`g‘Add»ss
());

261 
b©chWr™”
.
	`addTask
(
PREFIX_TRIM
, 
msg
)

262 .
	`th’Run
((è-> 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
()))

263 .
	`exû±iÚ®ly
(
ex
 -> {

264 
	`hªdËExû±iÚ
(
ex
, 
ùx
, 
msg
, 
r
);

265  
nuÎ
;

267 
	}
}

269 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
READ_REQUEST
)

270 
public
 
	`»ad
(
CÜfuPaylßdMsg
<
R—dReque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

271 
add»ss
 = 
msg
.
	`g‘Paylßd
().
	`g‘Add»ss
();

272 
boŞ—n
 
ÿch—bË
 = 
msg
.
	`g‘Paylßd
().
	`isCacheR—dResuÉ
();

273 
log
.
	`Œaû
("»ad: {}, cach—bË: {}", 
msg
.
	`g‘Paylßd
().
	`g‘Add»ss
(), 
ÿch—bË
);

275 
R—dRe¥Ú£
 
¼
 = 
Ãw
 
	`R—dRe¥Ú£
();

276 
Œy
 {

277 
ILogD©a
 
logD©a
;

278 if(
add»ss
 < 
¡»amLog
.
	`g‘TrimM¬k
()) {

279 
logD©a
 = 
LogD©a
.
	`g‘Trimmed
(
add»ss
);

281 
logD©a
 = 
d©aCache
.
	`g‘
(
add»ss
, 
ÿch—bË
);

284 ià(
logD©a
 =ğ
nuÎ
) {

285 
¼
.
	`put
(
add»ss
, 
LogD©a
.
	`g‘Em±y
(address));

287 
¼
.
	`put
(
add»ss
, (
LogD©a
è
logD©a
);

289 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
READ_RESPONSE
.
	`·ylßdMsg
(
¼
));

290 } 
	`ÿtch
 (
D©aCÜru±iÚExû±iÚ
 
e
) {

291 
log
.
	`”rÜ
("D©¨cÜru±iÚƒxû±iÚ wh»adšg‡dd»s {}", 
add»ss
, 
e
);

292 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_DATA_CORRUPTION
.
	`·ylßdMsg
(
add»ss
));

294 
	}
}

296 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MULTIPLE_READ_REQUEST
)

297 
public
 
	`muÉiR—d
(
CÜfuPaylßdMsg
<
MuÉËR—dReque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

298 
boŞ—n
 
ÿch—bË
 = 
msg
.
	`g‘Paylßd
().
	`isCacheR—dResuÉ
();

299 
log
.
	`Œaû
("muÉiR—d: {}, cach—bË: {}", 
msg
.
	`g‘Paylßd
().
	`g‘Add»s£s
(), 
ÿch—bË
);

301 
R—dRe¥Ú£
 
¼
 = 
Ãw
 
	`R—dRe¥Ú£
();

302 
Œy
 {

303 
LÚg
 
add»ss
 : 
msg
.
	`g‘Paylßd
().
	`g‘Add»s£s
()) {

304 
ILogD©a
 
logD©a
;

306 if(
add»ss
 < 
¡»amLog
.
	`g‘TrimM¬k
()) {

307 
logD©a
 = 
LogD©a
.
	`g‘Trimmed
(
add»ss
);

309 
logD©a
 = 
d©aCache
.
	`g‘
(
add»ss
, 
ÿch—bË
);

312 ià(
logD©a
 =ğ
nuÎ
) {

313 
¼
.
	`put
(
add»ss
, 
LogD©a
.
	`g‘Em±y
(address));

315 
¼
.
	`put
(
add»ss
, (
LogD©a
è
logD©a
);

318 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
READ_RESPONSE
.
	`·ylßdMsg
(
¼
));

319 } 
	`ÿtch
 (
D©aCÜru±iÚExû±iÚ
 
e
) {

320 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ERROR_DATA_CORRUPTION
.
	`msg
());

322 
	}
}

328 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
KNOWN_ADDRESS_REQUEST
)

329 
´iv©e
 
	`g‘KnownAdd»s£sInRªge
(
CÜfuPaylßdMsg
<
KnownAdd»ssReque¡
> 
msg
,

330 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

332 
KnownAdd»ssReque¡
 
»que¡
 = 
msg
.
	`g‘Paylßd
();

333 
Œy
 {

334 
S‘
<
LÚg
> 
knownAdd»s£s
 = 
¡»amLog


335 .
	`g‘KnownAdd»s£sInRªge
(
»que¡
.
	`g‘S¹Rªge
(),„eque¡.
	`g‘EndRªge
());

336 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
,

337 
CÜfuMsgTy³
.
KNOWN_ADDRESS_RESPONSE
.
	`·ylßdMsg
(
knownAdd»s£s
));

338 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

339 
	`hªdËExû±iÚ
(
e
, 
ùx
, 
msg
, 
r
);

341 
	}
}

343 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
COMPACT_REQUEST
)

344 
´iv©e
 
	$hªdËCom·ùReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

345 
log
.
	`debug
("hªdËCom·ùReque¡:„eûived‡ com·ù„eque¡ {}", 
msg
);

346 
¡»amLog
.
	`com·ù
();

347 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

348 
	}
}

350 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
FLUSH_CACHE
)

351 
´iv©e
 
	$hªdËFlushCacheReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

352 
log
.
	`debug
("hªdËFlushCacheReque¡:„eûived‡ cachæush„eque¡ {}", 
msg
);

353 
d©aCache
.
	`šv®id©eAÎ
();

354 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

355 
	}
}

364 @
Ov”ride


365 
public
 
	$£®S”v”W™hEpoch
(
•och
) {

366 
CÜfuPaylßdMsg
<
LÚg
> 
msg
 = 
Ãw
 CorfuPayloadMsg<>();

367 
msg
.
	`£tEpoch
(
•och
);

368 
msg
.
	`£tPriÜ™yLev–
(
PriÜ™yLev–
.
HIGH
);

369 
Œy
 {

370 
b©chWr™”
.
	`addTask
(
SEAL
, 
msg
).
	`još
();

371 } 
	`ÿtch
 (
Com¶‘iÚExû±iÚ
 
û
) {

372 ià(
û
.
	`g‘Cau£
(è
š¡ªûof
 
WrÚgEpochExû±iÚ
) {

375 
	`throw
 (
WrÚgEpochExû±iÚ
è
û
.
	`g‘Cau£
();

378 
log
.
	`šfo
("LogUn™ s—lS”v”W™hEpoch: s—Ëd‡nd flushed w™hƒpoch {}", 
•och
);

379 
	}
}

381 @
Ov”ride


382 
public
 
boŞ—n
 
	$isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

383  
	`g‘S‹
(è=ğ
S”v”S‹
.
READY
;

384 
	}
}

395 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
RESET_LOGUNIT
)

396 
´iv©e
 
synchrÚized
 
	`»£tLogUn™
(
CÜfuPaylßdMsg
<
LÚg
> 
msg
,

397 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

402 ià(
msg
.
	`g‘Paylßd
(è> 
£rv”CÚ‹xt
.
	`g‘LogUn™EpochW©”M¬k
()

403 && 
msg
.
	`g‘Paylßd
(è=ğ
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
()) {

404 
£rv”CÚ‹xt
.
	`£tLogUn™EpochW©”M¬k
(
msg
.
	`g‘Paylßd
());

405 
b©chWr™”
.
	`addTask
(
RESET
, 
msg
)

406 .
	`th’Run
(() -> {

407 
d©aCache
.
	`šv®id©eAÎ
();

408 
log
.
	`šfo
("LogUnit Server Reset.");

409 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

410 }).
	`exû±iÚ®ly
(
ex
 -> {

411 
	`hªdËExû±iÚ
(
ex
, 
ùx
, 
msg
, 
r
);

412  
nuÎ
;

415 
log
.
	`šfo
("LogUnit Server Reset„equest„eceived but„eset‡lready done.");

416 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

418 
	}
}

424 @
Ov”ride


425 
public
 
	$shutdown
() {

426 
su³r
.
	`shutdown
();

427 
executÜ
.
	`shutdown
();

428 
logCËª”
.
	`shutdown
();

429 
b©chWr™”
.
	`şo£
();

430 
	}
}

432 @
VisibËFÜTe¡šg


433 
public
 
LogUn™S”v”Cache
 
	$g‘D©aCache
() {

434  
d©aCache
;

435 
	}
}

437 @
VisibËFÜTe¡šg


438 
	$g‘MaxCacheSize
() {

439  
cÚfig
.
	`g‘MaxCacheSize
();

440 
	}
}

442 @
VisibËFÜTe¡šg


443 
B©chProûssÜ
 
	$g‘B©chWr™”
() {

444  
b©chWr™”
;

445 
	}
}

447 @
VisibËFÜTe¡šg


448 
SŒ—mAdd»ssS·û
 
	$g‘SŒ—mAdd»ssS·û
(
UUID
 
¡»amID
) {

449  
¡»amLog
.
	`g‘SŒ—msAdd»ssS·û
().
	`g‘Add»ssM­
().
	`g‘
(
¡»amID
);

450 
	}
}

452 @
VisibËFÜTe¡šg


453 
	$´efixTrim
(
ŒimAdd»ss
) {

454 
¡»amLog
.
	`´efixTrim
(
ŒimAdd»ss
);

455 
	}
}

460 @
	gBud”


461 @
G‘‹r


462 
public
 şas 
	cLogUn™S”v”CÚfig
 {

463 
´iv©e
 
fš®
 
	gÿcheSizeH—pR©io
;

464 
´iv©e
 
fš®
 
	gmaxCacheSize
;

465 
´iv©e
 
fš®
 
boŞ—n
 
	gmemÜyMode
;

466 
´iv©e
 
fš®
 
boŞ—n
 
	gnoV”ify
;

467 
´iv©e
 
fš®
 
boŞ—n
 
	gnoSync
;

475 
public
 
LogUn™S”v”CÚfig
 
·r£
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

476 
	gÿcheSizeH—pR©io
 = 
DoubË
.
·r£DoubË
((
SŒšg
è
İts
.
g‘
("--cache-heap-ratio"));

478  
	gLogUn™S”v”CÚfig
.
bud”
()

479 .
ÿcheSizeH—pR©io
(cacheSizeHeapRatio)

480 .
maxCacheSize
((è(
RuÁime
.
g‘RuÁime
().
maxMemÜy
(è* 
ÿcheSizeH—pR©io
))

481 .
memÜyMode
(
BoŞ—n
.
v®ueOf
(
İts
.
g‘
("--memÜy").
toSŒšg
()))

482 .
noV”ify
((
BoŞ—n
è
İts
.
g‘
("--no-verify"))

483 .
noSync
((
BoŞ—n
è
İts
.
g‘
("--no-sync"))

484 .
bud
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/LogUnitServerCache.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCafãše
;

4 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gLßdšgCache
;

5 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gRemov®Cau£
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”
.
	gLogUn™S”v”CÚfig
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLog
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

21 @
Slf4j


22 
public
 cÏs 
	cLogUn™S”v”Cache
 {

24 
´iv©e
 
fš®
 
	mLßdšgCache
<
	mLÚg
, 
	mILogD©a
> 
	md©aCache
;

25 
´iv©e
 
fš®
 
SŒ—mLog
 
	m¡»amLog
;

27 
public
 
	$LogUn™S”v”Cache
(
LogUn™S”v”CÚfig
 
cÚfig
, 
SŒ—mLog
 
¡»amLog
) {

28 
this
.
¡»amLog
 = streamLog;

29 
this
.
d©aCache
 = 
Cafãše
.
	`ÃwBud”
()

30 .<
LÚg
, 
ILogD©a
>
	`weigh”
((
addr
, 
logD©a
è->†ogD©a.
	`g‘SizeE¡im©e
())

31 .
	`maximumWeight
(
cÚfig
.
	`g‘MaxCacheSize
())

32 .
	`»mov®Li¡’”
(
this
::
hªdËEviùiÚ
)

33 .
	`bud
(
this
::
hªdËR‘r›v®
);

46 
´iv©e
 
ILogD©a
 
	$hªdËR‘r›v®
(
add»ss
) {

47 
LogD©a
 
’Œy
 = 
¡»amLog
.
	`»ad
(
add»ss
);

48 
log
.
	`Œaû
("hªdËR‘r›v®: R‘r›ved[{} : {}]", 
add»ss
, 
’Œy
);

49  
’Œy
;

50 
	}
}

52 
´iv©e
 
	$hªdËEviùiÚ
(
add»ss
, 
ILogD©a
 
’Œy
, 
Remov®Cau£
 
ÿu£
) {

53 
log
.
	`Œaû
("hªdËEviùiÚ: EviùiÚ[{}]: {}", 
add»ss
, 
ÿu£
);

54 
	}
}

66 
public
 
ILogD©a
 
	$g‘
(
add»ss
, 
boŞ—n
 
ÿch—bË
) {

67 ià(!
ÿch—bË
) {

68 
ILogD©a
 
ld
 = 
d©aCache
.
	`g‘IfP»£Á
(
add»ss
);

69  
ld
 !ğ
nuÎ
 ?†d : 
	`hªdËR‘r›v®
(
add»ss
);

72  
d©aCache
.
	`g‘
(
add»ss
);

73 
	}
}

81 
public
 
ILogD©a
 
	$g‘
(
add»ss
) {

82  
	`g‘
(
add»ss
, 
Œue
);

83 
	}
}

92 
public
 
	$put
(
add»ss
, 
ILogD©a
 
’Œy
) {

93 
log
.
	`Œaû
("LogUn™S”v”Cache.put: Cachwr™e[{} : {}]", 
add»ss
, 
’Œy
);

94 
d©aCache
.
	`put
(
add»ss
, 
’Œy
);

95 
	}
}

101 
public
 
	$šv®id©eAÎ
() {

102 
d©aCache
.
	`šv®id©eAÎ
();

103 
	}
}

105 @
VisibËFÜTe¡šg


106 
public
 
	$g‘Size
() {

107  
d©aCache
.
	`asM­
().
	`size
();

108 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/ManagementAgent.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gAcûssLev–
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gClu¡”S‹CÚ‹xt
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gFau»D‘eùÜ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
.
	gSšgËtÚResourû
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gRecov”yHªdËr
.
	grunRecov”yRecÚfigu¿tiÚ
;

30 @
Slf4j


31 
public
 cÏs 
	cMªagem’tAg’t
 {

33 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

39 @
G‘‹r


40 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mCHECK_BOOTSTRAP_INTERVAL
 = Du¿tiÚ.
ofSecÚds
(1);

45 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mRECOVERY_RETRY_INTERVAL
 = Du¿tiÚ.
ofSecÚds
(1);

50 @
G‘‹r


51 
´iv©e
 
fš®
 
Th»ad
 
	mš™Ÿliz©iÚTaskTh»ad
;

53 
´iv©e
 
boŞ—n
 
	m»cov”ed
 = 
çl£
;

55 
´iv©e
 
fš®
 
	mSšgËtÚResourû
<
	mCÜfuRuÁime
> 
	mruÁimeSšgËtÚResourû
;

57 
´iv©e
 vŞ©
boŞ—n
 
	mshutdown
 = 
çl£
;

60 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mMETRICS_POLL_INTERVAL
 = Du¿tiÚ.
ofSecÚds
(3);

66 @
	$G‘‹r
(
AcûssLev–
.
PROTECTED
)

67 
´iv©e
 
fš®
 
LoÿlMÚ™ÜšgS”viû
 
loÿlMÚ™ÜšgS”viû
;

73 @
G‘‹r


74 
´iv©e
 
fš®
 
Du¿tiÚ
 
POLICY_EXECUTE_INTERVAL
 = Du¿tiÚ.
	`ofSecÚds
(1);

79 @
G‘‹r


80 
´iv©e
 
fš®
 
RemÙeMÚ™ÜšgS”viû
 
»mÙeMÚ™ÜšgS”viû
;

89 
public
 
	`Mªagem’tAg’t
(@
NÚNuÎ
 
SšgËtÚResourû
<
CÜfuRuÁime
> 
ruÁimeSšgËtÚResourû
,

90 @
NÚNuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
,

91 @
NÚNuÎ
 
Clu¡”S‹CÚ‹xt
 
şu¡”CÚ‹xt
,

92 @
NÚNuÎ
 
Fau»D‘eùÜ
 
çu»D‘eùÜ
,

93 
Layout
 
mªagem’tLayout
) {

94 
this
.
ruÁimeSšgËtÚResourû
 =„untimeSingletonResource;

95 
this
.
£rv”CÚ‹xt
 = serverContext;

96 
this
.
loÿlMÚ™ÜšgS”viû
 = 
Ãw
 
	`LoÿlMÚ™ÜšgS”viû
(
£rv”CÚ‹xt
, 
ruÁimeSšgËtÚResourû
);

99 ià(
mªagem’tLayout
 =ğ
nuÎ
) {

100 
»cov”ed
 = 
Œue
;

110 
£rv”CÚ‹xt
.
	`š¡®lSšgËNodeLayoutIfAb£Á
();

111 
£rv”CÚ‹xt
.
	`§veMªagem’tLayout
(£rv”CÚ‹xt.
	`g‘Cu¼’tLayout
());

112 
£rv”CÚ‹xt
.
	`§veMªagem’tLayout
(
mªagem’tLayout
);

114 ià(!
»cov”ed
) {

115 
log
.
	`šfo
("A‰em±šgØ»cov”. LayouˆbefÜshutdown: {}", 
mªagem’tLayout
);

118 
this
.
»mÙeMÚ™ÜšgS”viû
 = 
Ãw
 
	`RemÙeMÚ™ÜšgS”viû
(

119 
£rv”CÚ‹xt
,

120 
ruÁimeSšgËtÚResourû
,

121 
şu¡”CÚ‹xt
,

122 
çu»D‘eùÜ
,

123 
loÿlMÚ™ÜšgS”viû


129 
this
.
š™Ÿliz©iÚTaskTh»ad
 = 
Ãw
 
	`Th»ad
Ñhis::
š™Ÿliz©iÚTask
, "initializationTaskThread");

130 
this
.
š™Ÿliz©iÚTaskTh»ad
.
	`£tUnÿughtExû±iÚHªdËr
(

131 (
th»ad
, 
throwabË
) -> {

132 
log
.
	`”rÜ
("E¼Ü iÀš™Ÿliz©iÚask: {}", 
throwabË
);

133 
	`shutdown
();

135 
this
.
š™Ÿliz©iÚTaskTh»ad
.
	`¡¬t
();

144 
´iv©e
 
	$š™Ÿliz©iÚTask
() {

145 
log
.
	`šfo
("Start initializationask");

148 
Œy
 {

149 !
shutdown
 && 
£rv”CÚ‹xt
.
	`g‘Mªagem’tLayout
(è=ğ
nuÎ
) {

150 
log
.
	`w¬n
("initializationTask: Management Server waitingo be bootstrapped");

151 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
CHECK_BOOTSTRAP_INTERVAL
.
	`toMlis
());

153 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

155 
log
.
	`debug
("initializationTask: Initializationask interrupted without " +

161 
»cov”yA‰em±s
 = 0;

162 !
shutdown
 && !
»cov”ed
) {

163 
Œy
 {

164 
boŞ—n
 
»cov”edSucûsfuÎy
 = 
	`runRecov”yRecÚfigu¿tiÚ
(

165 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
(), 
	`g‘CÜfuRuÁime
()

168 ià(
»cov”edSucûsfuÎy
) {

171 
£rv”CÚ‹xt
.
	`§veMªagem’tLayout
(
	`g‘CÜfuRuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
());

172 
log
.
	`šfo
("initializationTask: Recovery completed");

173 
this
.
»cov”ed
 = 
Œue
;

177 
log
.
	`”rÜ
("initializationTask: Recovery failed {}imes. Retrying in {}s.",

178 ++
»cov”yA‰em±s
, 
RECOVERY_RETRY_INTERVAL
);

179 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
RECOVERY_RETRY_INTERVAL
.
	`toMlis
());

180 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

182 
log
.
	`debug
("initializationTask: Initializationask interrupted without being„ecovered");

184 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

186 
log
.
	`”rÜ
("š™Ÿliz©iÚTask:ƒxû±iÚ h­³Ãd duršg†ayouˆ»cov”y, {}", 
e
);

191 ià(!
shutdown
) {

192 
loÿlMÚ™ÜšgS”viû
.
	`¡¬t
(
METRICS_POLL_INTERVAL
);

193 
»mÙeMÚ™ÜšgS”viû
.
	`¡¬t
(
POLICY_EXECUTE_INTERVAL
);

195 
	}
}

202 
public
 
CÜfuRuÁime
 
	$g‘CÜfuRuÁime
() {

203  
ruÁimeSšgËtÚResourû
.
	`g‘
();

204 
	}
}

209 
public
 
	$shutdown
() {

211 
shutdown
 = 
Œue
;

213 
Œy
 {

214 
š™Ÿliz©iÚTaskTh»ad
.
	`š‹¼u±
();

215 
š™Ÿliz©iÚTaskTh»ad
.
	`još
(
S”v”CÚ‹xt
.
SHUTDOWN_TIMER
.
	`toMlis
());

216 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

217 
log
.
	`”rÜ
("š™Ÿliz©iÚTask iÁ”ru±ed : {}", 
›
);

218 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

221 
»mÙeMÚ™ÜšgS”viû
.
	`shutdown
();

222 
loÿlMÚ™ÜšgS”viû
.
	`shutdown
();

224 
log
.
	`šfo
("Management Agent shutting down.");

225 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/ManagementServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gClu¡”S‹CÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gFau»D‘eùÜ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gRecÚfigu¿tiÚEv’tHªdËr
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD‘eùÜMsg
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gFau»D‘eùÜM‘rics
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜMsg
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gUÄ—chabËClu¡”Exû±iÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gIRecÚfigu¿tiÚHªdËrPŞicy
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
.
	gSšgËtÚResourû
;

26 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

27 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

28 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gLock
;

35 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

36 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

47 @
Slf4j


48 
public
 cÏs 
	cMªagem’tS”v”
 
ex‹nds
 
	mAb¡¿ùS”v”
 {

50 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

55 
´iv©e
 
fš®
 
	mSšgËtÚResourû
<
	mCÜfuRuÁime
> 
	mcÜfuRuÁime
 =

56 
SšgËtÚResourû
.
w™hIn™Ÿl
(
this
::
g‘NewCÜfuRuÁime
);

61 
´iv©e
 
fš®
 
IRecÚfigu¿tiÚHªdËrPŞicy
 
	mçu»HªdËrPŞicy
;

63 
´iv©e
 
fš®
 
Clu¡”S‹CÚ‹xt
 
	mşu¡”CÚ‹xt
;

65 @
G‘‹r


66 
´iv©e
 
fš®
 
Mªagem’tAg’t
 
	mmªagem’tAg’t
;

68 
´iv©e
 
fš®
 
Orche¡¿tÜ
 
	mÜche¡¿tÜ
;

73 @
G‘‹r


74 
´iv©e
 
fš®
 
HªdËrM‘hods
 
	mhªdËr
 = HªdËrM‘hods.
g’”©eHªdËr
(
M‘hodHªdËs
.
lookup
(), 
this
);

82 
´iv©e
 
fš®
 
RuÂabË
 
	mruÁimeSy¡emDownHªdËr
 = () -> {

83 
log
.
w¬n
("ManagementServer: Runtime stalled. Invoking systemDownHandler‡fter {} "

84 + "unsucûssfuÈŒ›s.", 
SYSTEM_DOWN_HANDLER_TRIGGER_LIMIT
);

85 
throw
 
Ãw
 
UÄ—chabËClu¡”Exû±iÚ
("Runtime stalled. Invoking systemDownHandler‡fter "

86 + 
SYSTEM_DOWN_HANDLER_TRIGGER_LIMIT
 + " unsuccessfulries.");

96 
´iv©e
 
fš®
 
	gSYSTEM_DOWN_HANDLER_TRIGGER_LIMIT
 = 60;

98 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	gexecutÜ
;

100 
´iv©e
 
fš®
 
Lock
 
	gh—lšgLock
 = 
Ãw
 
R“Á¿ÁLock
();

102 @
Ov”ride


103 
public
 
boŞ—n
 
	$isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

104  
	`g‘S‹
(è=ğ
S”v”S‹
.
READY
;

105 
	}
}

107 @
Ov”ride


108 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

109 ià(
msg
.
	`g‘MsgTy³
(è=ğ
CÜfuMsgTy³
.
NODE_STATE_REQUEST
) {

111 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
);

113 
executÜ
.
	`subm™
((è-> 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
));

115 
	}
}

121 @
Ov”ride


122 
public
 
	$shutdown
() {

123 
su³r
.
	`shutdown
();

124 
executÜ
.
	`shutdown
();

125 
Üche¡¿tÜ
.
	`shutdown
();

126 
mªagem’tAg’t
.
	`shutdown
();

129 
cÜfuRuÁime
.
	`ş—nup
(
CÜfuRuÁime
::
shutdown
);

130 
	}
}

137 
public
 
	$Mªagem’tS”v”
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

138 
this
.
£rv”CÚ‹xt
 = serverContext;

140 
this
.
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
£rv”CÚ‹xt
.
	`g‘Mªagem’tS”v”Th»adCouÁ
(),

141 
Ãw
 
	`S”v”Th»adFaùÜy
("mªagem’t-",‚ew 
S”v”Th»adFaùÜy
.
	`Exû±iÚHªdËr
()));

143 
this
.
çu»HªdËrPŞicy
 = 
£rv”CÚ‹xt
.
	`g‘Fau»HªdËrPŞicy
();

146 
Fau»D‘eùÜ
 
çu»D‘eùÜ
 = 
Ãw
 
	`Fau»D‘eùÜ
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
());

149 
Clu¡”S‹
 
deçuÉV›w
 = Clu¡”S‹.
	`bud”
()

150 .
	`loÿlEndpošt
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())

151 .
	`nodes
(
ImmubËM­
.
	`of
())

152 .
	`uÄe¥ÚsiveNodes
(
ImmubËLi¡
.
	`of
())

153 .
	`bud
();

154 
şu¡”CÚ‹xt
 = 
Clu¡”S‹CÚ‹xt
.
	`bud”
()

155 .
	`şu¡”V›w
(
Ãw
 
AtomicReã»nû
<>(
deçuÉV›w
))

156 .
	`bud
();

158 
Layout
 
mªagem’tLayout
 = 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

159 
mªagem’tAg’t
 = 
Ãw
 
	`Mªagem’tAg’t
(

160 
cÜfuRuÁime
, 
£rv”CÚ‹xt
, 
şu¡”CÚ‹xt
, 
çu»D‘eùÜ
,
mªagem’tLayout


163 
Üche¡¿tÜ
 = 
Ãw
 
	`Orche¡¿tÜ
(
cÜfuRuÁime
, 
£rv”CÚ‹xt
);

164 
	}
}

171 
´iv©e
 
CÜfuRuÁime
 
	$g‘NewCÜfuRuÁime
() {

172 
fš®
 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 =

173 
£rv”CÚ‹xt
.
	`g‘Mªagem’tRuÁimeP¬am‘”s
();

174 
·¿ms
.
	`£tSy¡emDownHªdËrTrigg”Lim™
(
SYSTEM_DOWN_HANDLER_TRIGGER_LIMIT
);

175 
fš®
 
CÜfuRuÁime
 
ruÁime
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
);

176 
fš®
 
Layout
 
mªagem’tLayout
 = 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

178 ià(
mªagem’tLayout
 !ğ
nuÎ
) {

179 
mªagem’tLayout
.
	`g‘LayoutS”v”s
().
	`fÜEach
(
ruÁime
::
addLayoutS”v”
);

181 
ruÁime
.
	`cÚÃù
();

182 
log
.
	`šfo
("getCorfuRuntime: Corfu Runtime connected successfully");

183 
·¿ms
.
	`£tSy¡emDownHªdËr
(
ruÁimeSy¡emDownHªdËr
);

184  
ruÁime
;

185 
	}
}

187 
´iv©e
 
boŞ—n
 
	$isBoÙ¡¿µed
(
CÜfuMsg
 
msg
) {

188 ià(
£rv”CÚ‹xt
.
	`g‘Mªagem’tLayout
(è=ğ
nuÎ
) {

189 
log
.
	`w¬n
("Reûived mes§gbuˆnÙ boÙ¡¿µed! Mes§ge={}", 
msg
);

190  
çl£
;

192  
Œue
;

193 
	}
}

202 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ORCHESTRATOR_REQUEST
)

203 
public
 
synchrÚized
 
	`hªdËOrche¡¿tÜMsg
(@
NÚnuÎ
 
CÜfuPaylßdMsg
<
Orche¡¿tÜMsg
> 
msg
,

204 @
NÚnuÎ
 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

205 @
NÚnuÎ
 
IS”v”Rou‹r
 
r
) {

206 
log
.
	`debug
("Reûived‡ÀÜche¡¿tÜ mes§g{}", 
msg
);

207 
Üche¡¿tÜ
.
	`hªdË
(
msg
, 
ùx
, 
r
);

208 
	}
}

218 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
)

219 
public
 
synchrÚized
 
	`hªdËMªagem’tBoÙ¡¿p
(
CÜfuPaylßdMsg
<
Layout
> 
msg
,

220 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

221 ià(
£rv”CÚ‹xt
.
	`g‘Mªagem’tLayout
(è!ğ
nuÎ
) {

223 
log
.
	`w¬n
("Got‡„equesto bootstrap‡ server with {} which is‡lready bootstrapped, "

224 + "»jeùšg!", 
msg
.
	`g‘Paylßd
());

225 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
MANAGEMENT_ALREADY_BOOTSTRAP_ERROR
));

227 
log
.
	`šfo
("Reûived BoÙ¡¿°Layouˆ: {}", 
msg
.
	`g‘Paylßd
());

228 
£rv”CÚ‹xt
.
	`§veMªagem’tLayout
(
msg
.
	`g‘Paylßd
());

229 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

232 
	}
}

242 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
)

243 
public
 
	`hªdËFau»D‘eùedMsg
(
CÜfuPaylßdMsg
<
D‘eùÜMsg
> 
msg
,

244 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

247 ià(!
	`isBoÙ¡¿µed
(
msg
)) {

248 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
MANAGEMENT_NOBOOTSTRAP_ERROR
));

252 
log
.
	`šfo
("hªdËFau»D‘eùedMsg: Reûived D‘eùÜMsg : {}", 
msg
.
	`g‘Paylßd
());

254 
D‘eùÜMsg
 
d‘eùÜMsg
 = 
msg
.
	`g‘Paylßd
();

255 
Layout
 
Ïyout
 = 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

259 ià(!
d‘eùÜMsg
.
	`g‘D‘eùÜEpoch
().
	`equ®s
(
Ïyout
.
	`g‘Epoch
())) {

260 
log
.
	`”rÜ
("handleFailureDetectedMsg: Discarding stale detector message„eceived. "

262 
d‘eùÜMsg
.
	`g‘D‘eùÜEpoch
(), 
Ïyout
.
	`g‘Epoch
());

263 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
NACK
));

269 
fš®
 
S‘
<
SŒšg
> 
®lAùiveS”v”s
 = 
Ïyout
.
	`g‘AÎAùiveS”v”s
();

270 
fš®
 
S‘
<
SŒšg
> 
»¥ÚsiveFaedNodes
 = 
d‘eùÜMsg
.
	`g‘FaedNodes
()

271 .
	`¡»am
()

272 .
	`f‹r
(
®lAùiveS”v”s
::
cÚšs
)

273 .
	`cŞËù
(
CŞËùÜs
.
	`toS‘
());

277 ià(!
d‘eùÜMsg
.
	`g‘FaedNodes
().
	`isEm±y
(è&& 
»¥ÚsiveFaedNodes
.isEmpty()) {

278 
log
.
	`w¬n
("handleFailureDetectedMsg: No‡ction isaken‡s‚one ofhe failed‚odes " +

281 
d‘eùÜMsg
.
	`g‘FaedNodes
(), 
®lAùiveS”v”s
, 
Ïyout
.
	`g‘Epoch
());

282 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

286 
boŞ—n
 
»suÉ
 = 
RecÚfigu¿tiÚEv’tHªdËr
.
	`hªdËFau»
(

287 
çu»HªdËrPŞicy
,

288 
Ïyout
,

289 
mªagem’tAg’t
.
	`g‘CÜfuRuÁime
(),

290 
»¥ÚsiveFaedNodes
);

292 ià(
»suÉ
) {

293 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

295 
log
.
	`”rÜ
("handleFailureDetectedMsg: failure handling unsuccessful.");

296 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
NACK
));

298 
	}
}

308 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MANAGEMENT_HEALING_DETECTED
)

309 
public
 
	`hªdËH—lšgD‘eùedMsg
(
CÜfuPaylßdMsg
<
D‘eùÜMsg
> 
msg
,

310 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

313 ià(!
	`isBoÙ¡¿µed
(
msg
)) {

314 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
MANAGEMENT_NOBOOTSTRAP_ERROR
));

318 
log
.
	`šfo
("hªdËH—lšgD‘eùedMsg: Reûived D‘eùÜMsg : {}", 
msg
.
	`g‘Paylßd
());

320 
D‘eùÜMsg
 
d‘eùÜMsg
 = 
msg
.
	`g‘Paylßd
();

321 
Layout
 
Ïyout
 = 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

325 ià(!
d‘eùÜMsg
.
	`g‘D‘eùÜEpoch
().
	`equ®s
(
Ïyout
.
	`g‘Epoch
())) {

326 
log
.
	`”rÜ
("handleHealingDetectedMsg: Discarding stale detector message„eceived. "

328 
d‘eùÜMsg
.
	`g‘D‘eùÜEpoch
(), 
Ïyout
.
	`g‘Epoch
());

329 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
NACK
));

335 
fš®
 
Li¡
<
SŒšg
> 
uÄe¥ÚsiveS”v”s
 = 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
();

336 
fš®
 
S‘
<
SŒšg
> 
uÄe¥ÚsiveH—ËdNodes
 = 
d‘eùÜMsg
.
	`g‘H—ËdNodes
()

337 .
	`¡»am
()

338 .
	`f‹r
(
uÄe¥ÚsiveS”v”s
::
cÚšs
)

339 .
	`cŞËù
(
CŞËùÜs
.
	`toS‘
());

343 ià(!
d‘eùÜMsg
.
	`g‘H—ËdNodes
().
	`isEm±y
(è&& 
uÄe¥ÚsiveH—ËdNodes
.isEmpty()) {

344 
log
.
	`w¬n
("handleHealingDetectedMsg: No‡ction isaken‡s‚one ofhe healedNodes‡re" +

347 
d‘eùÜMsg
.
	`g‘H—ËdNodes
(), 
uÄe¥ÚsiveS”v”s
, 
Ïyout
.
	`g‘Epoch
());

348 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

352 
boŞ—n
 
»suÉ
 = 
çl£
;

353 ià(
h—lšgLock
.
	`ŒyLock
()) {

354 
Œy
 {

355 
log
.
	`šfo
("handleHealingDetectedMsg:‡cquired healing†ock. Performing healing for‚odes: {}",

356 
uÄe¥ÚsiveH—ËdNodes
);

357 
fš®
 
Du¿tiÚ
 
»ŒyWÜkæowQu”yTimeout
 = Du¿tiÚ.
	`ofSecÚds
(1L);

358 
»suÉ
 = 
RecÚfigu¿tiÚEv’tHªdËr
.
	`hªdËH—lšg
(

359 
mªagem’tAg’t
.
	`g‘CÜfuRuÁime
(),

360 
uÄe¥ÚsiveH—ËdNodes
,

361 
»ŒyWÜkæowQu”yTimeout
);

362 } 
fš®ly
 {

363 
h—lšgLock
.
	`uÆock
();

366 
log
.
	`šfo
("handleHealingDetectedMsg: healing handling‡lready in…rogress. Skipping.");

367 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
NACK
));

370 ià(
»suÉ
) {

371 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
ACK
));

373 
log
.
	`”rÜ
("handleHealingDetectedMsg: healing handling unsuccessful.");

374 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
NACK
));

376 
	}
}

392 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
NODE_STATE_REQUEST
)

393 
public
 
	$hªdËNodeS‹Reque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

394 
NodeS‹
 
nodeS‹
 = 
şu¡”CÚ‹xt
.
	`g‘Clu¡”V›w
()

395 .
	`g‘Node
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())

396 .
	`ÜEl£G‘
(
this
::
budDeçuÉNodeS‹
);

398 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
NODE_STATE_RESPONSE
.
	`·ylßdMsg
(
nodeS‹
));

399 
	}
}

401 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
FAILURE_DETECTOR_METRICS_REQUEST
)

402 
public
 
	$hªdËFau»D‘eùÜM‘ricsReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

403 
Fau»D‘eùÜM‘rics
 
m‘rics
 = 
£rv”CÚ‹xt
.
	`g‘Fau»D‘eùÜM‘rics
();

404 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
FAILURE_DETECTOR_METRICS_RESPONSE
.
	`·ylßdMsg
(
m‘rics
));

405 
	}
}

412 
´iv©e
 
NodeS‹
 
	$budDeçuÉNodeS‹
() {

413 
log
.
	`šfo
("Management server: {},‚ot„eady yet,„eturn default NodeState, current cluster view: {}",

414 
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
(), 
şu¡”CÚ‹xt
.
	`g‘Clu¡”V›w
());

416 
•och
 = 
Layout
.
INVALID_EPOCH
;

417 
Layout
 
Ïyout
 = 
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

418 ià(
Ïyout
 !ğ
nuÎ
){

419 
•och
 = 
Ïyout
.
	`g‘Epoch
();

425  
NodeS‹
.
	`g‘NÙR—dyNodeS‹
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
());

426 
	}
}

435 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MANAGEMENT_LAYOUT_REQUEST
)

436 
public
 
	$hªdËLayoutReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

438 ià(!
	`isBoÙ¡¿µed
(
msg
)) {

439 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
MANAGEMENT_NOBOOTSTRAP_ERROR
));

442 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
,

443 
CÜfuMsgTy³
.
LAYOUT_RESPONSE
.
	`·ylßdMsg
(
£rv”CÚ‹xt
.
	`g‘Mªagem’tLayout
()));

444 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/MonitoringService.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

8 
public
 
š‹rçû
 
	gMÚ™ÜšgS”viû
 {

13 
¡¬t
(
Du¿tiÚ
 
mÚ™ÜšgIÁ”v®
);

18 
shutdown
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/NettyServerRouter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËr
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlInboundHªdËrAd­‹r
;

9 
impÜt
 
	gjava
.
	gut
.
	gEnumM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	glombok
.
	gG‘‹r
;

14 
impÜt
 
	glombok
.
	gS‘‹r
;

15 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

27 @
	gSlf4j


28 @
	gChªÃlHªdËr
.
Sh¬abË


29 
public
 cÏs 
	cN‘tyS”v”Rou‹r
 
ex‹nds
 
ChªÃlInboundHªdËrAd­‹r
 
im¶em’ts
 
	mIS”v”Rou‹r
 {

34 
´iv©e
 
fš®
 
	mM­
<
	mCÜfuMsgTy³
, 
	mAb¡¿ùS”v”
> 
	mhªdËrM­
;

39 @
	mG‘‹r


40 @
S‘‹r


41 vŞ©
	m£rv”Epoch
;

44 
fš®
 
	mLi¡
<
	mAb¡¿ùS”v”
> 
	m£rv”s
;

51 
public
 
N‘tyS”v”Rou‹r
(
Li¡
<
Ab¡¿ùS”v”
> 
£rv”s
) {

53 
	mthis
.
	m£rv”Epoch
 = ((
Ba£S”v”
è
£rv”s
.
g‘
(0)).
£rv”CÚ‹xt
.
g‘S”v”Epoch
();

54 
	mthis
.
	m£rv”s
 = 
ImmubËLi¡
.
cİyOf
(
£rv”s
);

55 
	mhªdËrM­
 = 
Ãw
 
EnumM­
<>(
CÜfuMsgTy³
.
şass
);

56 
	m£rv”s
.
fÜEach
(
£rv”
 -> s”v”.
g‘HªdËr
().
g‘HªdËdTy³s
()

57 .
fÜEach
(
x
 -> 
hªdËrM­
.
put
(x, 
£rv”
)));

66 @
	gOv”ride


67 @
D•»ÿ‹d


68 
public
 
	$addS”v”
(
Ab¡¿ùS”v”
 
£rv”
) {

69 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("No†onger supported");

70 
	}
}

75 @
Ov”ride


76 
public
 
	gLi¡
<
	gAb¡¿ùS”v”
> 
	$g‘S”v”s
() {

77  
£rv”s
;

78 
	}
}

87 
public
 
	$£ndRe¥Ú£
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
šMsg
, CÜfuMsg 
outMsg
) {

88 
outMsg
.
	`cİyBa£F›lds
(
šMsg
);

89 
ùx
.
	`wr™eAndFlush
(
outMsg
, ctx.
	`voidPromi£
());

90 
log
.
	`Œaû
("S’ˆ»¥Ú£: {}", 
outMsg
);

91 
	}
}

102 
public
 
boŞ—n
 
	$v®id©eEpoch
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

103 
£rv”Epoch
 = 
	`g‘S”v”Epoch
();

104 ià(!
msg
.
	`g‘MsgTy³
().
ignÜeEpoch
 && msg.
	`g‘Epoch
(è!ğ
£rv”Epoch
) {

105 
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
,

106 
£rv”Epoch
));

107 
log
.
	`Œaû
("Incoming message with wrongƒpoch, got {},ƒxpected {}, message was: {}",

108 
msg
.
	`g‘Epoch
(), 
£rv”Epoch
, msg);

109  
çl£
;

111  
Œue
;

112 
	}
}

120 @
Ov”ride


121 
public
 
	$chªÃlR—d
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
msg
) {

122 
Œy
 {

125 
CÜfuMsg
 
m
 = ((CÜfuMsgè
msg
);

127 
Ab¡¿ùS”v”
 
hªdËr
 = 
hªdËrM­
.
	`g‘
(
m
.
	`g‘MsgTy³
());

128 ià(
hªdËr
 =ğ
nuÎ
) {

130 
log
.
	`w¬n
("Reûived uÄegi¡”ed mes§g{}, drİpšg", 
m
);

132 ià(
	`v®id©eEpoch
(
m
, 
ùx
)) {

134 ià(
log
.
	`isT¿ûEÇbËd
()) {

135 
log
.
	`Œaû
("Mes§grou‹dØ{}: {}", 
hªdËr
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), 
msg
);

138 
Œy
 {

139 
hªdËr
.
	`hªdËMes§ge
(
m
, 
ùx
, 
this
);

140 } 
	`ÿtch
 (
ThrowabË
 
t
) {

141 
log
.
	`”rÜ
("channelRead: Handling {} failed dueo {}:{}",

142 
m
 !ğ
nuÎ
 ? m.
	`g‘MsgTy³
() : "UNKNOWN",

143 
t
.
	`g‘CÏss
().
	`g‘Sim¶eName
(),

144 
t
.
	`g‘Mes§ge
(),

145 
t
);

149 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

150 
log
.
	`”rÜ
("Exû±iÚ duršg„—d!", 
e
);

152 
	}
}

154 @
Ov”ride


155 
public
 
	$exû±iÚCaught
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ThrowabË
 
ÿu£
) {

156 
log
.
	`”rÜ
("E¼Ü iÀhªdlšg inbound mes§ge, {}", 
ÿu£
);

157 
ùx
.
	`şo£
();

158 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/Phase2Data.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gToSŒšg
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

13 @
	gD©a


14 @
	gToSŒšg


15 @
AÎArgsCÚ¡ruùÜ


16 
public
 cÏs 
	cPha£2D©a
 {

17 
Rªk
 
	m¿nk
;

18 
Layout
 
	mÏyout
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/Rank.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gToSŒšg
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

15 @
	gSlf4j


16 @
	gToSŒšg


17 @
	gAÎArgsCÚ¡ruùÜ


18 @
Equ®sAndHashCode


19 
public
 cÏs 
	cRªk
 {

20 @
G‘‹r


21 
LÚg
 
	m¿nk
;

22 @
G‘‹r


23 
UUID
 
	mş›ÁId
;

32 
public
 
boŞ—n
 
	$ËssThªEqu®To
(
Rªk
 
Ùh”
) {

33 ià(
Ùh”
 =ğ
nuÎ
) {

34  
çl£
;

36 ià(
this
 =ğ
Ùh”
) {

37  
Œue
;

39  
this
.
¿nk
.
	`com·»To
(
Ùh”
.rank) <= 0;

41 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/RecoveryHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

8 @
Slf4j


9 şas 
	cRecov”yHªdËr
 {

11 
´iv©e
 
	$Recov”yHªdËr
() {

37 
boŞ—n
 
	`runRecov”yRecÚfigu¿tiÚ
(@
NÚNuÎ
 
Layout
 
Ïyout
, 
CÜfuRuÁime
 
cÜfuRuÁime
) {

38 
Layout
 
loÿlRecov”yLayout
 = 
Ãw
 
	`Layout
(
Ïyout
);

39 
boŞ—n
 
»cov”yRecÚfigu¿tiÚResuÉ
 = 
cÜfuRuÁime
.
	`g‘LayoutMªagem’tV›w
().
	`©‹m±Clu¡”Recov”y
(
Ïyout
);

40 
log
.
	`šfo
("Recov”y„ecÚfigu¿tiÚ‡‰em±„esuÉ: {}", 
»cov”yRecÚfigu¿tiÚResuÉ
);

42 
cÜfuRuÁime
.
	`šv®id©eLayout
();

43 
Layout
 
şu¡”Layout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

45 
log
.
	`šfo
("Recovery†ayoutƒpoch:{}, Clusterƒpoch: {}",

46 
loÿlRecov”yLayout
.
	`g‘Epoch
(), 
şu¡”Layout
.getEpoch());

50  
şu¡”Layout
.
	`g‘Epoch
(è> 
loÿlRecov”yLayout
.getEpoch()

51 || 
»cov”yRecÚfigu¿tiÚResuÉ
;

52 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/RemoteMonitoringService.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

6 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	g»suÉ
.
	gResuÉ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gClu¡”AdvisÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gClu¡”AdvisÜFaùÜy
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gClu¡”S‹CÚ‹xt
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gClu¡”Ty³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gFau»D‘eùÜ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gPŞlR•Üt
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gRecÚfigu¿tiÚEv’tHªdËr
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gçu»d‘eùÜ
.
	gClu¡”G¿ph
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
.
	gRedundªcyC®cuÏtÜ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gFau»D‘eùÜM‘rics
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gFau»D‘eùÜM‘rics
.
	gFau»D‘eùÜAùiÚ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gLambdaUts
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
.
	gSšgËtÚResourû
;

34 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

36 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

37 
impÜt
 
	gjava
.
	gut
.
	gM­
;

38 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

39 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

40 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

42 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

43 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

44 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

45 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

46 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

47 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

48 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

49 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

50 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

60 @
Slf4j


61 
public
 cÏs 
	cRemÙeMÚ™ÜšgS”viû
 
im¶em’ts
 
	mMÚ™ÜšgS”viû
 {

62 
´iv©e
 
fš®
 
	mCom¶‘abËFutu»
<
	mD‘eùÜTask
> 
	mDETECTOR_TASK_NOT_COMPLETED


63 ğ
Com¶‘abËFutu»
.
com¶‘edFutu»
(
D‘eùÜTask
.
NOT_COMPLETED
);

65 
´iv©e
 
fš®
 
	mCom¶‘abËFutu»
<
	mD‘eùÜTask
> 
	mDETECTOR_TASK_SKIPPED


66 ğ
Com¶‘abËFutu»
.
com¶‘edFutu»
(
D‘eùÜTask
.
SKIPPED
);

71 @
G‘‹r


72 
´iv©e
 
fš®
 
Fau»D‘eùÜ
 
	mçu»D‘eùÜ
;

80 @
G‘‹r


81 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	md‘eùiÚTasksScheduËr
;

85 @
G‘‹r


86 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mçu»D‘eùÜWÜk”
;

88 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

89 
´iv©e
 
fš®
 
	mSšgËtÚResourû
<
	mCÜfuRuÁime
> 
	mruÁimeSšgËtÚResourû
;

90 
´iv©e
 
fš®
 
Clu¡”S‹CÚ‹xt
 
	mşu¡”CÚ‹xt
;

91 
´iv©e
 
fš®
 
LoÿlMÚ™ÜšgS”viû
 
	mloÿlMÚ™ÜšgS”viû
;

96 
´iv©e
 
	mCom¶‘abËFutu»
<
	mD‘eùÜTask
> 
	mçu»D‘eùÜFutu»
 = 
DETECTOR_TASK_NOT_COMPLETED
;

98 
´iv©e
 
fš®
 
Clu¡”AdvisÜ
 
	madvisÜ
;

104 
´iv©e
 
fš®
 
	mSEQUENCER_NOT_READY_THRESHOLD
 = 3;

110 
´iv©e
 
fš®
 
AtomicLÚg
 
	mcouÁ”
 = 
Ãw
 AtomicLong(1);

118 
´iv©e
 
fš®
 
	md‘eùiÚWÜk”sCouÁ
 = 3;

124 
´iv©e
 vŞ©
	mCom¶‘abËFutu»
<
	mBoŞ—n
> 
	mm”geSegm’tsTask
 = 
Com¶‘abËFutu»
.
com¶‘edFutu»
(
Œue
);

129 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mMERGE_SEGMENTS_RETRY_QUERY_TIMEOUT
 = Du¿tiÚ.
ofSecÚds
(1);

135 @
	mG‘‹r


136 @
	mS‘‹r


137 @
AÎArgsCÚ¡ruùÜ


138 
´iv©e
 cÏs 
	cSequ’ûrNÙR—dyCouÁ”
 {

139 
´iv©e
 
fš®
 
	m•och
;

140 
´iv©e
 
	mcouÁ”
;

142 
public
 
šüem’t
() {

143 
	mcouÁ”
 += 1;

147 
´iv©e
 vŞ©
Sequ’ûrNÙR—dyCouÁ”
 
	g£qu’ûrNÙR—dyCouÁ”
 = 
Ãw
 SequencerNotReadyCounter(0, 0);

149 
RemÙeMÚ™ÜšgS”viû
(@
NÚNuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
,

150 @
NÚNuÎ
 
SšgËtÚResourû
<
CÜfuRuÁime
> 
ruÁimeSšgËtÚResourû
,

151 @
NÚNuÎ
 
Clu¡”S‹CÚ‹xt
 
şu¡”CÚ‹xt
,

152 @
NÚNuÎ
 
Fau»D‘eùÜ
 
çu»D‘eùÜ
,

153 @
NÚNuÎ
 
LoÿlMÚ™ÜšgS”viû
 
loÿlMÚ™ÜšgS”viû
) {

154 
	gthis
.
	g£rv”CÚ‹xt
 = 
£rv”CÚ‹xt
;

155 
	gthis
.
	gruÁimeSšgËtÚResourû
 = 
ruÁimeSšgËtÚResourû
;

156 
	gthis
.
	gşu¡”CÚ‹xt
 = 
şu¡”CÚ‹xt
;

157 
	gthis
.
	gçu»D‘eùÜ
 = 
çu»D‘eùÜ
;

158 
	gthis
.
	gloÿlMÚ™ÜšgS”viû
 = 
loÿlMÚ™ÜšgS”viû
;

159 
	gthis
.
	gadvisÜ
 = 
Clu¡”AdvisÜFaùÜy
.
ü—‹FÜSŒ©egy
(

160 
Clu¡”Ty³
.
COMPLETE_GRAPH
,

161 
£rv”CÚ‹xt
.
g‘LoÿlEndpošt
()

164 
	gthis
.
	gd‘eùiÚTasksScheduËr
 = 
ExecutÜs
.
ÃwSšgËTh»adScheduËdExecutÜ
(

165 
Ãw
 
Th»adFaùÜyBud”
()

166 .
£tD«mÚ
(
Œue
)

167 .
£tNameFÜm©
(
£rv”CÚ‹xt
.
g‘Th»adP»fix
() + "ManagementService")

168 .
bud
());

173 
	gthis
.
	gçu»D‘eùÜWÜk”
 = 
ExecutÜs
.
ÃwFixedTh»adPoŞ
(

174 
d‘eùiÚWÜk”sCouÁ
,

175 
Ãw
 
Th»adFaùÜyBud”
()

176 .
£tD«mÚ
(
Œue
)

177 .
£tNameFÜm©
(
£rv”CÚ‹xt
.
g‘Th»adP»fix
() + "DetectionWorker-%d")

178 .
bud
()

182 
´iv©e
 
CÜfuRuÁime
 
	$g‘CÜfuRuÁime
() {

183  
ruÁimeSšgËtÚResourû
.
	`g‘
();

184 
	}
}

194 @
Ov”ride


195 
public
 
	$¡¬t
(
Du¿tiÚ
 
mÚ™ÜšgIÁ”v®
) {

197 
	`£qu’ûrBoÙ¡¿p
(
£rv”CÚ‹xt
);

199 
d‘eùiÚTasksScheduËr
.
	`scheduËAtFixedR©e
(

200 (è-> 
LambdaUts
.
	`runSªsThrow
(
this
::
runD‘eùiÚTasks
),

202 
mÚ™ÜšgIÁ”v®
.
	`toMlis
(),

203 
TimeUn™
.
MILLISECONDS


205 
	}
}

212 
´iv©e
 
	gCom¶‘abËFutu»
<
	gD‘eùÜTask
> 
	$£qu’ûrBoÙ¡¿p
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

213 
log
.
	`šfo
("Trigger sequencer bootstrap on startup");

214  
	`g‘CÜfuRuÁime
()

215 .
	`g‘LayoutMªagem’tV›w
()

216 .
	`asyncSequ’ûrBoÙ¡¿p
(
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
(), 
çu»D‘eùÜWÜk”
)

217 .
	`th’Aµly
(
D‘eùÜTask
::
äomBoŞ
);

218 
	}
}

227 
´iv©e
 
boŞ—n
 
	$ÿnHªdËRecÚfigu¿tiÚs
() {

231 
Layout
 
Ïyout
 = 
£rv”CÚ‹xt
.
	`g‘Mªagem’tLayout
();

232 ià(!
Ïyout
.
	`g‘AÎS”v”s
().
	`cÚšs
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())) {

233 
log
.
	`debug
("This Server is‚ot‡…art ofhe‡ctive†ayout. Aborting„econfiguration handling.");

234  
çl£
;

236  
Œue
;

237 
	}
}

262 
´iv©e
 
synchrÚized
 
	$runD‘eùiÚTasks
() {

264 
Layout
 
ourLayout
 = 
	`g‘CÜfuRuÁime
()

265 .
	`šv®id©eLayout
()

266 .
	`th’Aµly
(
£rv”CÚ‹xt
::
§veMªagem’tLayout
)

267 .
	`još
();

269 ià(!
	`ÿnHªdËRecÚfigu¿tiÚs
()) {

270 
log
.
	`”rÜ
("Can't„un failure detector. This Server: {}, is‚ot‡…art ofhe‡ctive†ayout: {}",

271 
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
(), 
ourLayout
);

275 ià(!
çu»D‘eùÜFutu»
.
	`isDÚe
()) {

276 
log
.
	`Œaû
("CªnÙ in™Ÿ‹‚ew fau» d‘eùiÚask. PŞlšg iÀ´og»ss. CouÁ”: {}", 
couÁ”
.
	`g‘
());

277 
couÁ”
.
	`šüem’tAndG‘
();

281 
couÁ”
.
	`£t
(1);

283 
çu»D‘eùÜFutu»
 =

285 
loÿlMÚ™ÜšgS”viû
.
	`g‘M‘rics
()

287 .
	`th’Compo£
(
m‘rics
 -> 
	`pŞlR•Üt
(
ourLayout
, metrics))

289 .
	`th’Aµly
(
pŞlR•Üt
 -> {

290 
log
.
	`Œaû
("Upd©şu¡” v›w: {}", 
pŞlR•Üt
.
	`g‘Clu¡”S‹
());

291 
şu¡”CÚ‹xt
.
	`»äeshClu¡”V›w
(
ourLayout
, 
pŞlR•Üt
);

292  
pŞlR•Üt
;

295 .
	`th’Compo£
(
pŞlR•Üt
 -> 
	`runFau»D‘eùÜTask
ÕŞlR•Üt, 
ourLayout
))

297 .
	`wh’Com¶‘e
((
skResuÉ
, 
ex
) -> {

298 ià(
ex
 !ğ
nuÎ
) {

299 
log
.
	`”rÜ
("Fau» d‘eùiÚask fšished w™hƒ¼Ü", 
ex
);

302 
	}
}

304 
´iv©e
 
	gCom¶‘abËFutu»
<
	gPŞlR•Üt
> 
	$pŞlR•Üt
(
Layout
 
Ïyout
, 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
) {

305  
Com¶‘abËFutu»
.
	`suµlyAsync
(() -> {

306 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘CÜfuRuÁime
();

308  
çu»D‘eùÜ
.
	`pŞl
(
Ïyout
, 
cÜfuRuÁime
, 
£qu’ûrM‘rics
);

309 }, 
çu»D‘eùÜWÜk”
);

310 
	}
}

327 
´iv©e
 
	gCom¶‘abËFutu»
<
	gD‘eùÜTask
> 
	$runFau»D‘eùÜTask
(

328 
PŞlR•Üt
 
pŞlR•Üt
, 
Layout
 
ourLayout
) {

330 ià(!
pŞlR•Üt
.
	`g‘Clu¡”S‹
().
	`isR—dy
()) {

331 
log
.
	`šfo
("Clu¡” s‹ i nÙ„—dy: {}", 
pŞlR•Üt
.
	`g‘Clu¡”S‹
());

332  
DETECTOR_TASK_SKIPPED
;

335  
Com¶‘abËFutu»
.
	`suµlyAsync
(() -> {

340 
fš®
 
Layout
 
Ï‹¡Layout
 = 
	`cÜ»ùWrÚgEpochs
(
pŞlR•Üt
, 
ourLayout
);

342 
ResuÉ
<
D‘eùÜTask
, 
RuÁimeExû±iÚ
> 
çu»
 = ResuÉ.
	`of
(() -> {

348 ià(!
pŞlR•Üt
.
	`¬eAÎRe¥ÚsiveS”v”sS—Ëd
()) {

349 
log
.
	`debug
("All„esponsive servers have‚ot been sealed yet. Skipping.");

350  
D‘eùÜTask
.
COMPLETED
;

353 
O±iÚ®
<
LÚg
> 
unfËdSlÙ
 = 
pŞlR•Üt
.
	`g‘LayoutSlÙUnFËd
(
Ï‹¡Layout
);

355 ià(
unfËdSlÙ
.
	`isP»£Á
()) {

356 
log
.
	`šfo
("Tryingo fill‡n unfilled slot {}. PollReport: {}",

357 
unfËdSlÙ
.
	`g‘
(), 
pŞlR•Üt
);

358 
	`d‘eùFau»
(
Ï‹¡Layout
, 
CŞËùiÚs
.
	`em±yS‘
(), 
pŞlR•Üt
).
	`još
();

359  
D‘eùÜTask
.
COMPLETED
;

362 ià(!
pŞlR•Üt
.
	`g‘WrÚgEpochs
().
	`isEm±y
()) {

363 
log
.
	`debug
("Wait for‚ext iteration. Poll„eport contains wrongƒpochs: {}",

364 
pŞlR•Üt
.
	`g‘WrÚgEpochs
()

366  
D‘eùÜTask
.
COMPLETED
;

372 ià(!
Ï‹¡Layout
.
	`equ®s
(
ourLayout
)) {

373 
log
.
	`w¬n
("Layout was updated by correcting wrongƒpochs. " +

375  
D‘eùÜTask
.
COMPLETED
;

378  
D‘eùÜTask
.
NOT_COMPLETED
;

381 
çu»
.
	`ifE¼Ü
(
”r
 -> 
log
.
	`”rÜ
("Cª'ˆfÈ¦Ù. PŞÈ»pÜt: {}", 
pŞlR•Üt
,ƒrr));

383 ià(
çu»
.
	`isV®ue
(è&& fau».
	`g‘
(è=ğ
D‘eùÜTask
.
COMPLETED
) {

384  
D‘eùÜTask
.
COMPLETED
;

387 
D‘eùÜTask
 
h—lšg
 = 
	`d‘eùH—lšg
(
pŞlR•Üt
, 
ourLayout
);

392 ià(
h—lšg
 =ğ
D‘eùÜTask
.
COMPLETED
) {

393  
D‘eùÜTask
.
COMPLETED
;

397 
D‘eùÜTask
 
hªdËFau»
 = 
	`d‘eùFau»
(
pŞlR•Üt
, 
ourLayout
);

401 ià(
hªdËFau»
 =ğ
D‘eùÜTask
.
COMPLETED
) {

402  
D‘eùÜTask
.
COMPLETED
;

406 
	`»¡ÜeRedundªcyAndM”geSegm’ts
(
ourLayout
);

408 
	`hªdËSequ’ûr
(
ourLayout
);

410  
D‘eùÜTask
.
COMPLETED
;

411 }, 
çu»D‘eùÜWÜk”
);

412 
	}
}

420 
´iv©e
 
	$»¡ÜeRedundªcyAndM”geSegm’ts
(
Layout
 
Ïyout
) {

421 
SŒšg
 
loÿlEndpošt
 = 
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
();

424 ià(!
m”geSegm’tsTask
.
	`isDÚe
()){

425 
log
.
	`Œaû
("Merge segmentsask‡lready in…rogress. Skipping spawning‡notherask.");

431 ià(
RedundªcyC®cuÏtÜ
.
	`ÿnRe¡ÜeRedundªcyOrM”geSegm’ts
(
Ïyout
, 
loÿlEndpošt
) &&

432 !
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
loÿlEndpošt
)) {

433 
log
.
	`šfo
("Layout„equires„estoration: {}. Spawningasko merge segments on {}.",

434 
Ïyout
, 
loÿlEndpošt
);

435 
Suµl›r
<
BoŞ—n
> 
»dundªcyAùiÚ
 = (è-> 
	`hªdËM”geSegm’ts
(

436 
loÿlEndpošt
, 
ruÁimeSšgËtÚResourû
, 
Ïyout


438 
m”geSegm’tsTask
 = 
Com¶‘abËFutu»
.
	`suµlyAsync
(
»dundªcyAùiÚ
, 
çu»D‘eùÜWÜk”
);

443 
log
.
	`Œaû
("No segmentso merge. Skipping step.");

444 
	}
}

447 @
VisibËFÜTe¡šg


448 
public
 
	$»¡ÜeRedundªcy
(
Layout
 
Ïyout
) {

449 
	`»¡ÜeRedundªcyAndM”geSegm’ts
(
Ïyout
);

450 
	}
}

452 @
VisibËFÜTe¡šg


453 
boŞ—n
 
hªdËM”geSegm’ts
(
SŒšg
 
loÿlEndpošt
,

454 
SšgËtÚResourû
<
CÜfuRuÁime
> 
ruÁimeSšgËtÚResourû
,

455 
Layout
 
Ïyout
) {

456  
	gRecÚfigu¿tiÚEv’tHªdËr
.
hªdËM”geSegm’ts
(

457 
loÿlEndpošt
,

458 
ruÁimeSšgËtÚResourû
.
g‘
(), 
Ïyout
,

459 
RemÙeMÚ™ÜšgS”viû
.
MERGE_SEGMENTS_RETRY_QUERY_TIMEOUT


472 
´iv©e
 
D‘eùÜTask
 
	$d‘eùH—lšg
(
PŞlR•Üt
 
pŞlR•Üt
, 
Layout
 
Ïyout
) {

473 
log
.
	`Œaû
("HªdË h—lšg,†ayout: {}", 
Ïyout
);

475 
O±iÚ®
<
NodeRªk
> 
h—Ëd
 = 
advisÜ
.
	`h—ËdS”v”
(
pŞlR•Üt
.
	`g‘Clu¡”S‹
());

478 
S‘
<
SŒšg
> 
h—ËdNodes
 = 
h—Ëd


479 .
	`m­
(
NodeRªk
::
g‘Endpošt
)

480 .
	`m­
(
ImmubËS‘
::
of
)

481 .
	`ÜEl£
(
ImmubËS‘
.
	`of
());

483 ià(
h—ËdNodes
.
	`isEm±y
()) {

484 
log
.
	`Œaû
("Nothingo heal");

485  
D‘eùÜTask
.
SKIPPED
;

489 
Fau»D‘eùÜM‘rics
 
hi¡Üy
 = Fau»D‘eùÜM‘rics.
	`bud”
()

490 .
	`loÿlNode
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())

491 .
	`g¿ph
(
advisÜ
.
	`g‘G¿ph
(
pŞlR•Üt
.
	`g‘Clu¡”S‹
()).
	`cÚÃùiv™yG¿ph
())

492 .
	`h—Ëd
(
h—Ëd
.
	`g‘
())

493 .
	`aùiÚ
(
Fau»D‘eùÜAùiÚ
.
HEAL
)

494 .
	`uÄe¥ÚsiveNodes
(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
())

495 .
	`Ïyout
(
Ïyout
.
	`g‘LayoutS”v”s
())

496 .
	`•och
(
Ïyout
.
	`g‘Epoch
())

497 .
	`bud
();

499 
log
.
	`šfo
("HªdË h—lšg. Fau» d‘eùÜ s‹: {}", 
hi¡Üy
.
	`toJsÚ
());

501 
Œy
 {

502 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘CÜfuRuÁime
();

504 
cÜfuRuÁime
.
	`g‘LayoutV›w
()

505 .
	`g‘RuÁimeLayout
(
Ïyout
)

506 .
	`g‘Mªagem’tCl›Á
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())

508 .
	`hªdËH—lšg
(
pŞlR•Üt
.
	`g‘PŞlEpoch
(), 
h—ËdNodes
)

510 .
	`g‘
();

512 
£rv”CÚ‹xt
.
	`§veFau»D‘eùÜM‘rics
(
hi¡Üy
);

514 
log
.
	`šfo
("H—lšg†oÿÈnodsucûssful: {}", 
hi¡Üy
.
	`toJsÚ
());

516  
D‘eùÜTask
.
COMPLETED
;

517 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
“
) {

518 
log
.
	`”rÜ
("H—lšg†oÿÈnodçed: ", 
“
);

519 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

520 
log
.
	`”rÜ
("H—lšg†oÿÈnodš‹¼u±ed: ", 
›
);

521 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

524  
D‘eùÜTask
.
NOT_COMPLETED
;

525 
	}
}

537 
´iv©e
 
D‘eùÜTask
 
	$d‘eùFau»
(
PŞlR•Üt
 
pŞlR•Üt
, 
Layout
 
Ïyout
) {

538 
log
.
	`Œaû
("HªdË fau» fÜh»pÜt: {}", 
pŞlR•Üt
);

540 
Œy
 {

541 
Clu¡”S‹
 
şu¡”S‹
 = 
pŞlR•Üt
.
	`g‘Clu¡”S‹
();

543 ià(
şu¡”S‹
.
	`size
(è!ğ
Ïyout
.
	`g‘AÎS”v”s
().size()) {

544 
SŒšg
 
”r
 = SŒšg.
	`fÜm©
(

546 
şu¡”S‹
, 
Ïyout


548 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
”r
);

551 
O±iÚ®
<
NodeRªk
> 
maybeFaedNode
 = 
advisÜ
.
	`çedS”v”
(
şu¡”S‹
);

553 ià(
maybeFaedNode
.
	`isP»£Á
()) {

554 
NodeRªk
 
çedNode
 = 
maybeFaedNode
.
	`g‘
();

557 
Fau»D‘eùÜM‘rics
 
hi¡Üy
 = Fau»D‘eùÜM‘rics.
	`bud”
()

558 .
	`loÿlNode
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
())

559 .
	`g¿ph
(
advisÜ
.
	`g‘G¿ph
(
pŞlR•Üt
.
	`g‘Clu¡”S‹
()).
	`cÚÃùiv™yG¿ph
())

560 .
	`h—Ëd
(
çedNode
)

561 .
	`aùiÚ
(
Fau»D‘eùÜAùiÚ
.
FAIL
)

562 .
	`uÄe¥ÚsiveNodes
(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
())

563 .
	`Ïyout
(
Ïyout
.
	`g‘LayoutS”v”s
())

564 .
	`•och
(
Ïyout
.
	`g‘Epoch
())

565 .
	`bud
();

567 
£rv”CÚ‹xt
.
	`§veFau»D‘eùÜM‘rics
(
hi¡Üy
);

569 
S‘
<
SŒšg
> 
çedNodes
 = 
Ãw
 
HashS‘
<>();

570 
çedNodes
.
	`add
(
çedNode
.
	`g‘Endpošt
());

571  
	`d‘eùFau»
(
Ïyout
, 
çedNodes
, 
pŞlR•Üt
).
	`g‘
();

573 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

574 
log
.
	`”rÜ
("Exû±iÚ invokšg fau» hªdËr", 
e
);

577  
D‘eùÜTask
.
NOT_COMPLETED
;

578 
	}
}

585 
´iv©e
 
	gCom¶‘abËFutu»
<
	gD‘eùÜTask
> 
	$hªdËSequ’ûr
(
Layout
 
Ïyout
) {

586 
log
.
	`Œaû
("Handling sequencer failures");

588 
Clu¡”S‹
 
şu¡”S‹
 = 
şu¡”CÚ‹xt
.
	`g‘Clu¡”V›w
();

589 
O±iÚ®
<
NodeS‹
> 
´im¬ySequ’ûr
 = 
şu¡”S‹
.
	`g‘Node
(
Ïyout
.
	`g‘Prim¬ySequ’ûr
());

590 ià(
´im¬ySequ’ûr
.
	`isP»£Á
(è&&…rim¬ySequ’ûr.
	`g‘
().
	`g‘Sequ’ûrM‘rics
(è=ğ
Sequ’ûrM‘rics
.
READY
) {

591 
log
.
	`Œaû
("Prim¬y sequ’û¸i ®»ady„—dy‡t: {} iÀ{}", 
´im¬ySequ’ûr
.
	`g‘
(), 
şu¡”S‹
);

592  
DETECTOR_TASK_SKIPPED
;

597 ià(
£qu’ûrNÙR—dyCouÁ”
.
	`g‘Epoch
(è!ğ
Ïyout
.getEpoch()) {

599 
log
.
	`Œaû
("Cu¼’ˆ•och i difã»ÁØÏyouˆ•och. Upd©cu¼’ˆ•ocho: {}", 
Ïyout
.
	`g‘Epoch
());

600 
£qu’ûrNÙR—dyCouÁ”
 = 
Ãw
 
	`Sequ’ûrNÙR—dyCouÁ”
(
Ïyout
.
	`g‘Epoch
(), 1);

601  
DETECTOR_TASK_SKIPPED
;

607 
£qu’ûrNÙR—dyCouÁ”
.
	`šüem’t
();

608 ià(
£qu’ûrNÙR—dyCouÁ”
.
	`g‘CouÁ”
(è< 
SEQUENCER_NOT_READY_THRESHOLD
) {

609  
DETECTOR_TASK_SKIPPED
;

613 
log
.
	`šfo
("A‰em±šgØboÙ¡¿°th´im¬y sequ’ûr. Clu¡”S‹ {}", 
şu¡”S‹
);

616  
	`g‘CÜfuRuÁime
()

617 .
	`g‘LayoutMªagem’tV›w
()

618 .
	`asyncSequ’ûrBoÙ¡¿p
(
Ïyout
, 
çu»D‘eùÜWÜk”
)

619 .
	`th’Aµly
(
D‘eùÜTask
::
äomBoŞ
);

620 
	}
}

628 
´iv©e
 
	gCom¶‘abËFutu»
<
	gD‘eùÜTask
> 
d‘eùFau»
(

629 
Layout
 
Ïyout
, 
S‘
<
SŒšg
> 
çedNodes
, 
PŞlR•Üt
 
pŞlR•Üt
) {

631 
Clu¡”G¿ph
 
	gg¿ph
 = 
advisÜ
.
g‘G¿ph
(
pŞlR•Üt
.
g‘Clu¡”S‹
());

633 
	glog
.
šfo
("Detected failed‚odes in‚ode„esponsiveness: Failed:{}, is slot unfilled: {}, clusterState:{}",

634 
çedNodes
, 
pŞlR•Üt
.
g‘LayoutSlÙUnFËd
(
Ïyout
), 
g¿ph
.
toJsÚ
()

637  
g‘CÜfuRuÁime
()

638 .
g‘LayoutV›w
()

639 .
g‘RuÁimeLayout
(
Ïyout
)

640 .
g‘Mªagem’tCl›Á
(
£rv”CÚ‹xt
.
g‘LoÿlEndpošt
())

641 .
hªdËFau»
(
Ïyout
.
g‘Epoch
(), 
çedNodes
)

642 .
th’Aµly
(
D‘eùÜTask
::
äomBoŞ
);

653 
´iv©e
 
	gCom¶‘abËFutu»
<
	gLayout
> 
	$g‘LayoutFromS”v”
(
Layout
 
Ïyout
, 
SŒšg
 
’dpošt
) {

654 
Com¶‘abËFutu»
<
Layout
> 
com¶‘abËFutu»
 = 
Ãw
 CompletableFuture<>();

655 
Œy
 {

656 
com¶‘abËFutu»
 = 
	`g‘CÜfuRuÁime
()

657 .
	`g‘LayoutV›w
()

658 .
	`g‘RuÁimeLayout
(
Ïyout
)

659 .
	`g‘LayoutCl›Á
(
’dpošt
)

660 .
	`g‘Layout
();

661 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

662 
com¶‘abËFutu»
.
	`com¶‘eExû±iÚ®ly
(
e
);

664  
com¶‘abËFutu»
;

665 
	}
}

673 
´iv©e
 
Layout
 
	$cÜ»ùWrÚgEpochs
(
PŞlR•Üt
 
pŞlR•Üt
, 
Layout
 
Ïyout
) {

675 
M­
<
SŒšg
, 
LÚg
> 
wrÚgEpochs
 = 
pŞlR•Üt
.
	`g‘WrÚgEpochs
();

676 ià(
wrÚgEpochs
.
	`isEm±y
()) {

677  
Ïyout
;

680 
log
.
	`debug
("CÜ»ù wrÚgƒpochs. PŞÈ»pÜt: {}", 
pŞlR•Üt
);

682 
Œy
 {

683 
fš®
 
Layout
 
ŞdLayout
 = 
Ïyout
;

685 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
Layout
>> 
ÏyoutCom¶‘abËFutu»M­
 = 
Ïyout


686 .
	`g‘LayoutS”v”s
()

687 .
	`¡»am
()

688 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(
FunùiÚ
.
	`id’t™y
(),

689 
£rv”
 -> 
	`g‘LayoutFromS”v”
(
ŞdLayout
, server))

695 
O±iÚ®
<
Layout
> 
Ï‹¡Layout
 = 
	`ãtchL©e¡Layout
(
ÏyoutCom¶‘abËFutu»M­
);

697 ià(!
Ï‹¡Layout
.
	`isP»£Á
()) {

698 
log
.
	`”rÜ
("Can't get‡†ayout from‡ny server inhe cluster. Layout servers: {}, wrongƒpochs: {}",

699 
Ïyout
.
	`g‘LayoutS”v”s
(), 
wrÚgEpochs


701 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Error in correcting serverƒpochs. Local‚ode is disconnected");

705 
Layout
 
ÃwMªagem’tLayout
 = 
£rv”CÚ‹xt
.
	`§veMªagem’tLayout
(
Ï‹¡Layout
.
	`g‘
());

707 
	`£®W™hL©e¡Layout
(
pŞlR•Üt
, 
ÃwMªagem’tLayout
);

711 
	`upd©eT¿šgLayoutS”v”s
(
ÃwMªagem’tLayout
, 
ÏyoutCom¶‘abËFutu»M­
);

712  
ÃwMªagem’tLayout
;

714 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
e
) {

715 
log
.
	`”rÜ
("E¼Ü iÀcÜ»ùšg s”v”ƒpochs", 
e
);

718  
£rv”CÚ‹xt
.
	`cİyMªagem’tLayout
();

719 
	}
}

728 
´iv©e
 
	$£®W™hL©e¡Layout
(
PŞlR•Üt
 
pŞlR•Üt
, 
Layout
 
mªagem’tLayout
) {

733 
Layout
 
£®šgLayout
 = 
Ãw
 
	`Layout
(
mªagem’tLayout
);

737 
pŞlR•Üt
.
	`g‘LayoutSlÙUnFËd
(
£®šgLayout
).
	`ifP»£Á
(£®šgLayout::
£tEpoch
);

741 
	`g‘CÜfuRuÁime
()

742 .
	`g‘LayoutV›w
()

743 .
	`g‘RuÁimeLayout
(
£®šgLayout
)

744 .
	`£®MšS”v”S‘
();

745 
	}
}

753 
´iv©e
 
	gO±iÚ®
<
	gLayout
> 
ãtchL©e¡Layout
(
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
Layout
>> 
futu»Layouts
) {

755 
	gT»eS‘
<
	gLayout
> 
	gÏyouts
 = 
Ãw
 
T»eS‘
<>(
Layout
.
LAYOUT_COMPARATOR
);

757 
	gfutu»Layouts
.
v®ues
()

758 .
¡»am
()

760 .
m­
(
async
 ->‡sync.
hªdË
((
Ïyout
, 
ex
) -> {

762 ià(
ex
 !ğ
nuÎ
) {

763  
O±iÚ®
.<
Layout
>
em±y
();

766  
O±iÚ®
.
of
(
Ïyout
);

769 .
m­
(
Com¶‘abËFutu»
::
još
)

771 .
fÜEach
(
İtiÚ®Layout
 -> o±iÚ®Layout.
ifP»£Á
(
Ïyouts
::
add
));

773  
	gO±iÚ®
.
ofNuÎabË
(
Ïyouts
.
isEm±y
(è? 
nuÎ
 :†ayouts.
fœ¡
());

782 
´iv©e
 
upd©eT¿šgLayoutS”v”s
(

783 
Layout
 
Ï‹¡Layout
, 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<Layout>> 
ÏyoutCom¶‘abËFutu»M­
) {

786 
	gÏyoutCom¶‘abËFutu»M­
.
keyS‘
().
fÜEach
(
ÏyoutS”v”
 -> {

787 
Layout
 
Ïyout
 = 
nuÎ
;

788 
Œy
 {

789 
Ïyout
 = 
ÏyoutCom¶‘abËFutu»M­
.
g‘
(
ÏyoutS”v”
).get();

790 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
“
) {

793 
log
.
w¬n
("updateTrailingLayoutServers:†ayout fetch from {} failed: {}",

794 
ÏyoutS”v”
, 
“
);

795 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

796 
log
.
”rÜ
("updateTrailingLayoutServers:†ayout fetch from {} failed: {}",

797 
ÏyoutS”v”
, 
›
);

798 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

802 ià(
Ïyout
 !ğ
nuÎ
 &&†ayout.
equ®s
(
Ï‹¡Layout
)) {

805 
Œy
 {

809 
boŞ—n
 
»suÉ
 = 
g‘CÜfuRuÁime
()

810 .
g‘LayoutV›w
()

811 .
g‘RuÁimeLayout
(
Ï‹¡Layout
)

812 .
g‘LayoutCl›Á
(
ÏyoutS”v”
)

813 .
comm™‹d
(
Ï‹¡Layout
.
g‘Epoch
(),†atestLayout)

814 .
g‘
();

815 ià(
»suÉ
) {

816 
log
.
debug
("Layout Server: {} successfully…atched with†atest†ayout : {}",

817 
ÏyoutS”v”
, 
Ï‹¡Layout
);

819 
log
.
debug
("LayouˆS”v”: {}…©ch w™h†©e¡†ayouˆçed : {}", 
ÏyoutS”v”
, 
Ï‹¡Layout
);

821 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
“
) {

822 
log
.
”rÜ
("Upd©šg†ayouˆ£rv” çed duto", 
“
);

823 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

824 
log
.
”rÜ
("Upd©šg†ayouˆ£rv” çed duto", 
›
);

825 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

830 @
Ov”ride


831 
public
 
	$shutdown
() {

833 
d‘eùiÚTasksScheduËr
.
	`shutdownNow
();

834 
çu»D‘eùÜWÜk”
.
	`shutdownNow
();

835 
log
.
	`šfo
("Fault Detection MonitoringService shutting down.");

836 
	}
}

838 
public
 
	eD‘eùÜTask
 {

842 
	gCOMPLETED
,

846 
	gNOT_COMPLETED
,

850 
	gSKIPPED
;

852 
public
 
D‘eùÜTask
 
äomBoŞ
(
boŞ—n
 
skResuÉ
) {

853  
	gskResuÉ
 ? 
	gCOMPLETED
 : 
NOT_COMPLETED
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/ResourceQuota.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

12 
public
 cÏs 
	cResourûQuÙa
 {

14 @
G‘‹r


15 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
;

17 @
G‘‹r


18 
´iv©e
 
fš®
 
	mlim™
;

20 
´iv©e
 
fš®
 
AtomicLÚg
 
	mu£d
 = 
Ãw
 AtomicLong();

22 
public
 
	$ResourûQuÙa
(
SŒšg
 
Çme
, 
lim™
) {

23 
this
.
Çme
 =‚ame;

24 ià(
lim™
 <= 0) {

25 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Resourû†im™ ha tØbpos™ive: " + 
lim™
);

27 
this
.
lim™
 =†imit;

33 
public
 
	$cÚsume
(
amouÁ
) {

34 
u£d
.
	`upd©eAndG‘
(
cu¼V®
 -> 
M©h
.
	`mš
(M©h.
	`addExaù
(cu¼V®, 
amouÁ
), 
LÚg
.
MAX_VALUE
));

35 
	}
}

40 
public
 
boŞ—n
 
	$hasAvaabË
() {

41  
u£d
.
	`g‘
(è< 
lim™
;

42 
	}
}

47 
public
 
	$»Ëa£
(
amouÁ
) {

48 
u£d
.
	`upd©eAndG‘
(
cu¼V®
 -> 
M©h
.
	`max
(0, M©h.
	`subŒaùExaù
(cu¼V®, 
amouÁ
)));

49 
	}
}

54 
public
 
	$g‘AvaabË
() {

55  
M©h
.
	`max
(
lim™
 - 
u£d
.
	`g‘
(), 0);

56 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/SequencerServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—mAdd»ssRªge
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssReque¡
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

16 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”Cache
.
	gCÚæiùTxSŒ—m
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
.
	gSequ’ûrStus
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrRecov”yMsg
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Reque¡
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Ty³
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

35 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

36 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

37 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

38 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

39 
impÜt
 
	gjava
.
	gut
.
	gM­
;

40 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

41 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

42 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

43 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

83 @
Slf4j


84 
public
 cÏs 
	cSequ’ûrS”v”
 
ex‹nds
 
	mAb¡¿ùS”v”
 {

89 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

95 @
G‘‹r


96 
´iv©e
 
	mglob®LogTa
 = 
Add»ss
.
g‘MšAdd»ss
();

98 
´iv©e
 
	mŒimM¬k
 = 
Add»ss
.
NON_ADDRESS
;

104 
´iv©e
 
	mM­
<
	mUUID
, 
	mLÚg
> 
	m¡»amTaToGlob®TaM­
 = 
Ãw
 
HashM­
<>();

110 
´iv©e
 
	mM­
<
	mUUID
, 
	mSŒ—mAdd»ssS·û
> 
	m¡»amsAdd»ssM­
 = 
Ãw
 
HashM­
<>();

115 
´iv©e
 
fš®
 
	mM­
<
	mBy‹
, 
	mSŒšg
> 
	mtim”NameCache
 = 
Ãw
 
HashM­
<>();

120 @
G‘‹r


121 
´iv©e
 
fš®
 
HªdËrM‘hods
 
	mhªdËr
 = HªdËrM‘hods.
g’”©eHªdËr
(
M‘hodHªdËs
.
lookup
(), 
this
);

123 @
G‘‹r


124 
´iv©e
 
fš®
 
Sequ’ûrS”v”Cache
 
	mÿche
;

126 @
	mG‘‹r


127 @
S‘‹r


128 
´iv©e
 vŞ©
	m£qu’ûrEpoch
 = 
Layout
.
INVALID_EPOCH
;

136 @
G‘‹r


137 
´iv©e
 
	m•ochRªgeLow”Bound
 = 
Layout
.
INVALID_EPOCH
;

139 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mexecutÜ
;

147 
public
 
	$Sequ’ûrS”v”
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

148 
this
.
£rv”CÚ‹xt
 = serverContext;

149 
CÚfig
 
cÚfig
 = CÚfig.
	`·r£
(
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
());

152 
this
.
executÜ
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
(

153 
Ãw
 
	`S”v”Th»adFaùÜy
("£qu’ûr-",‚ew 
S”v”Th»adFaùÜy
.
	`Exû±iÚHªdËr
()));

156 
glob®LogTa
 = 
Add»ss
.
	`g‘MšAdd»ss
();

158 
this
.
ÿche
 = 
Ãw
 
	`Sequ’ûrS”v”Cache
(
cÚfig
.
	`g‘CacheSize
());

161 
	`£tUpTim”NameCache
();

164 @
Ov”ride


165 
´Ùeùed
 
	$´oûssReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

166 
executÜ
.
	`subm™
((è-> 
	`g‘HªdËr
().
	`hªdË
(
msg
, 
ùx
, 
r
));

167 
	}
}

169 @
Ov”ride


170 
public
 
	$shutdown
() {

171 
su³r
.
	`shutdown
();

172 
executÜ
.
	`shutdown
();

173 
	}
}

175 @
Ov”ride


176 
public
 
boŞ—n
 
	$isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

177 ià(
	`g‘S‹
(è!ğ
S”v”S‹
.
READY
){

178  
çl£
;

181 ià((
£qu’ûrEpoch
 !ğ
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
())

182 && (!
msg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
))) {

183 
log
.
	`w¬n
("Rejecting msg‡t sequencer : sequencerStateEpoch:{}, serverEpoch:{}, "

184 + "msg:{}", 
£qu’ûrEpoch
, 
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
(), 
msg
);

185  
çl£
;

187  
Œue
;

188 
	}
}

193 
´iv©e
 
	$£tUpTim”NameCache
() {

194 
tim”NameCache
.
	`put
(
Tok’Reque¡
.
TK_QUERY
, 
CÜfuCompÚ’t
.
INFRA_SEQUENCER
 + "query-token");

195 
tim”NameCache
.
	`put
(
Tok’Reque¡
.
TK_RAW
, 
CÜfuCompÚ’t
.
INFRA_SEQUENCER
 + "raw-token");

196 
tim”NameCache
.
	`put
(
Tok’Reque¡
.
TK_MULTI_STREAM
, 
CÜfuCompÚ’t
.
INFRA_SEQUENCER
 + "multi-stream-token");

197 
tim”NameCache
.
	`put
(
Tok’Reque¡
.
TK_TX
, 
CÜfuCompÚ’t
.
INFRA_SEQUENCER
 + "tx-token");

198 
	}
}

210 
´iv©e
 
boŞ—n
 
	$isEpochInRªge
(
•och
) {

211  
•och
 >ğ
•ochRªgeLow”Bound
 &&ƒpoch <ğ
£qu’ûrEpoch
;

212 
	}
}

225 
´iv©e
 
TxResŞutiÚRe¥Ú£
 
	$txnCªComm™
(
TxResŞutiÚInfo
 
txInfo
) {

226 
log
.
	`Œaû
("Comm™-»q[{}]", 
txInfo
);

227 
fš®
 
Tok’
 
txSÇpshÙTime¡amp
 = 
txInfo
.
	`g‘SÇpshÙTime¡amp
();

233 
txSÇpshÙEpoch
 = 
txSÇpshÙTime¡amp
.
	`g‘Epoch
();

234 ià(!
	`isEpochInRªge
(
txSÇpshÙEpoch
)) {

235 
log
.
	`debug
("ABORT[{}] snapshot-ts[{}] currentƒpoch[{}]†ower bound[{}]",

236 
txInfo
, 
txSÇpshÙTime¡amp
, 
£qu’ûrEpoch
, 
•ochRªgeLow”Bound
);

237  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(
Tok’Ty³
.
TX_ABORT_NEWSEQ
);

240 ià(
txSÇpshÙTime¡amp
.
	`g‘Sequ’û
(è< 
ŒimM¬k
) {

241 
log
.
	`debug
("ABORT[{}] sÇpshÙ-ts[{}]rimM¬k-ts[{}]", 
txInfo
, 
txSÇpshÙTime¡amp
, 
ŒimM¬k
);

242  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(
Tok’Ty³
.
TX_ABORT_SEQ_TRIM
);

245 
M­
.
EÁry
<
UUID
, 
S‘
<
by‹
[]>> 
cÚæiùSŒ—m
 : 
txInfo
.
	`g‘CÚæiùS‘
().
	`’ŒyS‘
()) {

249 
S‘
<
by‹
[]> 
cÚæiùP¬amS‘
 = 
cÚæiùSŒ—m
.
	`g‘V®ue
();

251 ià(
cÚæiùP¬amS‘
 =ğ
nuÎ
 || cÚæiùP¬amS‘.
	`isEm±y
()) {

252 
UUID
 
¡»amId
 = 
cÚæiùSŒ—m
.
	`g‘Key
();

253 
LÚg
 
£qu’û
 = 
¡»amTaToGlob®TaM­
.
	`g‘
(
¡»amId
);

254 ià(
£qu’û
 !ğ
nuÎ
 && sequ’û > 
txSÇpshÙTime¡amp
.
	`g‘Sequ’û
()) {

255 
log
.
	`debug
("ABORT[{}] cÚæiù-¡»am[{}]Ñs={})", 
txInfo
, 
Uts
.
	`toR—dabËId
(
¡»amId
), 
£qu’û
);

256  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(
Tok’Ty³
.
TX_ABORT_CONFLICT
);

262 
by‹
[] 
cÚæiùP¬am
 : 
cÚæiùP¬amS‘
) {

264 
LÚg
 
keyAdd»ss
 = 
ÿche
.
	`g‘IfP»£Á
(
Ãw
 
	`CÚæiùTxSŒ—m
(
cÚæiùSŒ—m
.
	`g‘Key
(), 
cÚæiùP¬am
));

266 
log
.
	`Œaû
("Comm™-ck[{}] cÚæiù-key[{}]Ñs={})", 
txInfo
, 
cÚæiùP¬am
, 
keyAdd»ss
);

268 ià(
keyAdd»ss
 !ğ
nuÎ
 && keyAdd»s > 
txSÇpshÙTime¡amp
.
	`g‘Sequ’û
()) {

269 
log
.
	`debug
("ABORT[{}] cÚæiù-key[{}]Ñs={})", 
txInfo
, 
cÚæiùP¬am
, 
keyAdd»ss
);

270  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(

271 
Tok’Ty³
.
TX_ABORT_CONFLICT
,

272 
keyAdd»ss
,

273 
cÚæiùP¬am
,

274 
cÚæiùSŒ—m
.
	`g‘Key
()

283 
maxCÚæiùNewSequ’ûr
 = 
ÿche
.
	`g‘MaxCÚæiùNewSequ’ûr
();

284 ià(
txSÇpshÙTime¡amp
.
	`g‘Sequ’û
(è< 
maxCÚæiùNewSequ’ûr
) {

285 
log
.
	`debug
("ABORT[{}] snapshot-ts[{}] WILDCARD New Sequencers=[{}]",

286 
txInfo
, 
txSÇpshÙTime¡amp
, 
maxCÚæiùNewSequ’ûr
);

287  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(
Tok’Ty³
.
TX_ABORT_NEWSEQ
);

293 
maxCÚæiùWdÿrd
 = 
ÿche
.
	`g‘MaxCÚæiùWdÿrd
();

294 ià(
txSÇpshÙTime¡amp
.
	`g‘Sequ’û
(è< 
maxCÚæiùWdÿrd
) {

295 
log
.
	`debug
("ABORT[{}] snapshot-ts[{}] WILDCARDs=[{}]",

296 
txInfo
, 
txSÇpshÙTime¡amp
, 
maxCÚæiùWdÿrd
);

297  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(
Tok’Ty³
.
TX_ABORT_SEQ_OVERFLOW
);

302  
Ãw
 
	`TxResŞutiÚRe¥Ú£
(
Tok’Ty³
.
NORMAL
);

303 
	}
}

315 
´iv©e
 
hªdËTok’Qu”y
(
CÜfuPaylßdMsg
<
Tok’Reque¡
> 
msg
,

316 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

317 
Tok’Reque¡
 
	g»q
 = 
msg
.
g‘Paylßd
();

318 
	gLi¡
<
	gUUID
> 
	g¡»ams
 = 
»q
.
g‘SŒ—ms
();

319 
	gM­
<
	gUUID
, 
	gLÚg
> 
	g¡»amTas
;

320 
Tok’
 
	gtok’
;

321 ià(
	g»q
.
g‘SŒ—ms
().
isEm±y
()) {

323 
	gtok’
 = 
Ãw
 
Tok’
(
£qu’ûrEpoch
, 
glob®LogTa
 - 1);

324 
	g¡»amTas
 = 
CŞËùiÚs
.
em±yM­
();

328 
	gtok’
 = 
Ãw
 
Tok’
(
£qu’ûrEpoch
, 
glob®LogTa
 - 1);

329 
	g¡»amTas
 = 
Ãw
 
HashM­
<>(
¡»ams
.
size
());

330 
UUID
 
	g¡»am
 : 
¡»ams
) {

331 
¡»amTas
.
put
(
¡»am
, 
¡»amTaToGlob®TaM­
.
g‘OrDeçuÉ
(¡»am, 
Add»ss
.
NON_EXIST
));

335 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
TOKEN_RES
.
·ylßdMsg
(
Ãw
 
Tok’Re¥Ú£
(

336 
Tok’Ty³
.
NORMAL
, 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
,

337 
Tok’Re¥Ú£
.
NO_CONFLICT_STREAM
, 
tok’
, 
CŞËùiÚs
.
em±yM­
(), 
¡»amTas
)));

341 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
SEQUENCER_TRIM_REQ
)

342 
public
 
	`ŒimCache
(
CÜfuPaylßdMsg
<
LÚg
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

343 
log
.
	`šfo
("trimCache: Starting cacheƒviction");

344 ià(
ŒimM¬k
 < 
msg
.
	`g‘Paylßd
()) {

346 
ŒimM¬k
 = 
msg
.
	`g‘Paylßd
();

347 
ÿche
.
	`šv®id©eUpTo
(
ŒimM¬k
);

350 
SŒ—mAdd»ssS·û
 
¡»amAdd»ssS·û
 : 
¡»amsAdd»ssM­
.
	`v®ues
()) {

351 
¡»amAdd»ssS·û
.
	`Œim
(
ŒimM¬k
);

355 
log
.
	`debug
("ŒimCache: glob®rim {}, sŒ—msAdd»ssS·û {}", 
ŒimM¬k
, 
¡»amsAdd»ssM­
);

357 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

358 
	}
}

363 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
)

364 
public
 
	`»£tS”v”
(
CÜfuPaylßdMsg
<
Sequ’ûrRecov”yMsg
> 
msg
,

365 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

366 
log
.
	`šfo
("Reset sequencer server.");

367 
š™ŸlTok’
 = 
msg
.
	`g‘Paylßd
().
	`g‘Glob®Ta
();

368 
fš®
 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
add»ssS·ûM­
 = 
msg
.
	`g‘Paylßd
().
	`g‘SŒ—msAdd»ssM­
();

369 
fš®
 
boÙ¡¿pMsgEpoch
 = 
msg
.
	`g‘Paylßd
().
	`g‘Sequ’ûrEpoch
();

374 
fš®
 
boŞ—n
 
boÙ¡¿pW™houtTasUpd©e
 = 
msg
.
	`g‘Paylßd
()

375 .
	`g‘BoÙ¡¿pW™houtTasUpd©e
();

380 ià(
boÙ¡¿pW™houtTasUpd©e


381 && (
£qu’ûrEpoch
 =ğ
Layout
.
INVALID_EPOCH
 || 
boÙ¡¿pMsgEpoch
 != sequencerEpoch + 1)) {

383 
log
.
	`w¬n
("Cannot updateƒxisting sequencer. Require full bootstrap. SequencerEpoch : {}, MsgEpoch : {}",

384 
£qu’ûrEpoch
, 
boÙ¡¿pMsgEpoch


387 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
NACK
.
	`msg
());

392 ià(
£rv”CÚ‹xt
.
	`g‘Sequ’ûrEpoch
(è>ğ
boÙ¡¿pMsgEpoch
) {

393 
log
.
	`šfo
("Sequencer‡lready bootstrapped‡tƒpoch {}. Discarding bootstrap„equest withƒpoch {}",

394 
£qu’ûrEpoch
, 
boÙ¡¿pMsgEpoch


397 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
NACK
.
	`msg
());

408 ià(!
boÙ¡¿pW™houtTasUpd©e
) {

410 
ÿche
.
	`šv®id©eAÎ
();

411 
glob®LogTa
 = 
š™ŸlTok’
;

412 
ÿche
.
	`upd©eMaxCÚæiùAdd»ss
(
š™ŸlTok’
 - 1);

415 
¡»amTaToGlob®TaM­
 = 
Ãw
 
HashM­
<>();

418 
M­
.
EÁry
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amAdd»ssS·û
 : 
add»ssS·ûM­
.
	`’ŒyS‘
()) {

419 
LÚg
 
¡»amTa
 = 
¡»amAdd»ssS·û
.
	`g‘V®ue
().
	`g‘Ta
();

420 
log
.
	`Œaû
("OÀSequ’û¸»£t,a fÜ sŒ—m {} s‘Ø{}", 
¡»amAdd»ssS·û
.
	`g‘Key
(), 
¡»amTa
);

421 
¡»amTaToGlob®TaM­
.
	`put
(
¡»amAdd»ssS·û
.
	`g‘Key
(), 
¡»amTa
);

425 
this
.
¡»amsAdd»ssM­
 = 
Ãw
 
HashM­
<>();

426 
this
.
¡»amsAdd»ssM­
.
	`putAÎ
(
add»ssS·ûM­
);

428 
M­
.
EÁry
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amAdd»ssS·û
 : 
this
.
¡»amsAdd»ssM­
.
	`’ŒyS‘
()) {

429 
log
.
	`šfo
("Stream[{}] seto†astrimmed‡ddress {}‡nd {}‡ddresses inhe„ange [{}-{}], " +

431 
Uts
.
	`toR—dabËId
(
¡»amAdd»ssS·û
.
	`g‘Key
()),

432 
¡»amAdd»ssS·û
.
	`g‘V®ue
().
	`g‘TrimM¬k
(),

433 
¡»amAdd»ssS·û
.
	`g‘V®ue
().
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
(),

434 
¡»amAdd»ssS·û
.
	`g‘V®ue
().
	`g‘Lowe¡Add»ss
(),

435 
¡»amAdd»ssS·û
.
	`g‘V®ue
().
	`g‘Highe¡Add»ss
());

436 ià(
log
.
	`isT¿ûEÇbËd
()) {

437 
log
.
	`Œaû
("Stream[{}]‡ddress map on sequencer„eset: {}",

438 
Uts
.
	`toR—dabËId
(
¡»amAdd»ssS·û
.
	`g‘Key
()), sŒ—mAdd»ssS·û.
	`g‘V®ue
().
	`g‘Add»ssM­
());

444 ià(
•ochRªgeLow”Bound
 =ğ
Layout
.
INVALID_EPOCH
 || 
boÙ¡¿pMsgEpoch
 !ğ
£qu’ûrEpoch
 + 1) {

445 
•ochRªgeLow”Bound
 = 
boÙ¡¿pMsgEpoch
;

449 
£qu’ûrEpoch
 = 
boÙ¡¿pMsgEpoch
;

450 
£rv”CÚ‹xt
.
	`£tSequ’ûrEpoch
(
boÙ¡¿pMsgEpoch
);

452 
log
.
	`šfo
("Sequencer„eset withoken = {}, size {} streamTailToGlobalTailMap = {}, sequencerEpoch = {}",

453 
glob®LogTa
, 
¡»amTaToGlob®TaM­
.
	`size
(), sŒ—mTaToGlob®TaM­, 
£qu’ûrEpoch
);

455 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ACK
.
	`msg
());

456 
	}
}

461 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
SEQUENCER_METRICS_REQUEST
)

462 
public
 
	$hªdËM‘ricsReque¡
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

465 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
 = 
Ãw
 
	`Sequ’ûrM‘rics
(
Sequ’ûrStus
.
READY
);

466 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
SEQUENCER_METRICS_RESPONSE
, 
£qu’ûrM‘rics
));

467 
	}
}

472 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
TOKEN_REQ
)

473 
public
 
	`tok’Reque¡
(
CÜfuPaylßdMsg
<
Tok’Reque¡
> 
msg
,

474 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

475 
log
.
	`Œaû
("Tok’„eque¡. Msg: {}", 
msg
);

477 
Tok’Reque¡
 
»q
 = 
msg
.
	`g‘Paylßd
();

478 
fš®
 
Tim”
 
tim”
 = 
	`g‘Tim”
(
»q
.
	`g‘ReqTy³
());

481 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
tim”
)) {

482 
»q
.
	`g‘ReqTy³
()) {

483 
Tok’Reque¡
.
TK_QUERY
:

484 
	`hªdËTok’Qu”y
(
msg
, 
ùx
, 
r
);

487 
Tok’Reque¡
.
TK_RAW
:

488 
	`hªdËRawTok’
(
msg
, 
ùx
, 
r
);

491 
Tok’Reque¡
.
TK_TX
:

492 
	`hªdËTxTok’
(
msg
, 
ùx
, 
r
);

496 
	`hªdËAÎoÿtiÚ
(
msg
, 
ùx
, 
r
);

500 
	}
}

509 
´iv©e
 
Tim”
 
	$g‘Tim”
(
by‹
 
»qTy³
) {

510 
fš®
 
SŒšg
 
tim”Name
 = 
tim”NameCache
.
	`g‘OrDeçuÉ
(
»qTy³
, 
CÜfuCompÚ’t
.
INFRA_SEQUENCER
 + "unknown");

511  
S”v”CÚ‹xt
.
	`g‘M‘rics
().
	`tim”
(
tim”Name
);

512 
	}
}

522 
´iv©e
 
hªdËRawTok’
(
CÜfuPaylßdMsg
<
Tok’Reque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

523 
fš®
 
Tok’Reque¡
 
	g»q
 = 
msg
.
g‘Paylßd
();

527 
Tok’
 
	gtok’
 = 
Ãw
 Tok’(
£qu’ûrEpoch
, 
glob®LogTa
);

528 
	gglob®LogTa
 +ğ
»q
.
g‘NumTok’s
();

529 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
TOKEN_RES
.
·ylßdMsg
(

530 
Ãw
 
Tok’Re¥Ú£
(
tok’
, 
CŞËùiÚs
.
em±yM­
())));

546 
´iv©e
 
hªdËTxTok’
(
CÜfuPaylßdMsg
<
Tok’Reque¡
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

547 
fš®
 
Tok’Reque¡
 
	g»q
 = 
msg
.
g‘Paylßd
();

552 
TxResŞutiÚRe¥Ú£
 
	gtxResŞutiÚRe¥Ú£
 = 
txnCªComm™
(
»q
.
g‘TxnResŞutiÚ
());

553 ià(
	gtxResŞutiÚRe¥Ú£
.
g‘Tok’Ty³
(è!ğ
Tok’Ty³
.
NORMAL
) {

555 
Tok’
 
ÃwTok’
 = 
Ãw
 Tok’(
£qu’ûrEpoch
, 
txResŞutiÚRe¥Ú£
.
g‘Add»ss
());

556 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
TOKEN_RES
.
·ylßdMsg
(
Ãw
 
Tok’Re¥Ú£
(

557 
txResŞutiÚRe¥Ú£
.
g‘Tok’Ty³
(),

558 
txResŞutiÚRe¥Ú£
.
g‘CÚæiùšgKey
(),

559 
txResŞutiÚRe¥Ú£
.
g‘CÚæiùšgSŒ—m
(),

560 
ÃwTok’
, 
CŞËùiÚs
.
em±yM­
(), Collections.emptyMap())));

567 
hªdËAÎoÿtiÚ
(
msg
, 
ùx
, 
r
);

579 
´iv©e
 
hªdËAÎoÿtiÚ
(
CÜfuPaylßdMsg
<
Tok’Reque¡
> 
msg
,

580 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

581 
fš®
 
Tok’Reque¡
 
	g»q
 = 
msg
.
g‘Paylßd
();

585 
	gÃwTa
 = 
glob®LogTa
 + 
»q
.
g‘NumTok’s
();

591 
	gImmubËM­
.
	gBud”
<
	gUUID
, 
	gLÚg
> 
	gbackPoš‹rM­
 = 
ImmubËM­
.
bud”
();

592 
UUID
 
	gid
 : 
»q
.
g‘SŒ—ms
()) {

595 
¡»amTaToGlob®TaM­
.
compu‹
(
id
, (
k
, 
v
) -> {

596 ià(
v
 =ğ
nuÎ
) {

597 
backPoš‹rM­
.
put
(
k
, 
Add»ss
.
NON_EXIST
);

598  
ÃwTa
 - 1;

600 
backPoš‹rM­
.
put
(
k
, 
v
);

601  
ÃwTa
 - 1;

606 
	g¡»amsAdd»ssM­
.
compu‹
(
id
, (
¡»amId
, 
add»ssM­
) -> {

607 ià(
add»ssM­
 =ğ
nuÎ
) {

608 
add»ssM­
 = 
Ãw
 
SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
,‚ew 
Rßršg64NavigabËM­
());

611 
i
 = 
glob®LogTa
; i < 
ÃwTa
; i++) {

612 
add»ssM­
.
addAdd»ss
(
i
);

614  
add»ssM­
;

619 ià(
	g»q
.
g‘TxnResŞutiÚ
(è!ğ
nuÎ
) {

620 
»q
.
g‘TxnResŞutiÚ
()

621 .
g‘Wr™eCÚæiùP¬ams
()

622 .
fÜEach
((
key
, 
v®ue
) -> {

625 
v®ue
.
fÜEach
(
cÚæiùP¬am
 ->

626 
ÿche
.
put
(
Ãw
 
CÚæiùTxSŒ—m
(
key
, 
cÚæiùP¬am
), 
ÃwTa
 - 1));

630 
	glog
.
Œaû
("tok’ {} backpoš‹r {}", 
glob®LogTa
, 
backPoš‹rM­
.
bud
());

633 
Tok’
 
	gtok’
 = 
Ãw
 Tok’(
£qu’ûrEpoch
, 
glob®LogTa
);

634 
	gglob®LogTa
 = 
ÃwTa
;

635 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
TOKEN_RES
.
·ylßdMsg
(

636 
Ãw
 
Tok’Re¥Ú£
(
tok’
, 
backPoš‹rM­
.
bud
())));

648 @
	$S”v”HªdËr
(
ty³
 = 
CÜfuMsgTy³
.
STREAMS_ADDRESS_REQUEST
)

649 
´iv©e
 
	`hªdËSŒ—msAdd»ssReque¡
(
CÜfuPaylßdMsg
<
SŒ—msAdd»ssReque¡
> 
msg
,

650 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

651 
SŒ—msAdd»ssReque¡
 
»q
 = 
msg
.
	`g‘Paylßd
();

652 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amsAdd»ssM­
;

654 
»q
.
	`g‘ReqTy³
()) {

655 
SŒ—msAdd»ssReque¡
.
STREAMS
:

656 
¡»amsAdd»ssM­
 = 
	`g‘SŒ—msAdd»s£s
(
»q
.
	`g‘SŒ—msRªges
());

661 
¡»amsAdd»ssM­
 = 
Ãw
 
HashM­
<>(
this
.streamsAddressMap);

665 
log
.
	`Œaû
("handleStreamsAddressRequest:„eturn‡ddress space for streams [{}]",

666 
¡»amsAdd»ssM­
.
	`keyS‘
());

667 
r
.
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
STREAMS_ADDRESS_RESPONSE
.
	`·ylßdMsg
(

668 
Ãw
 
	`SŒ—msAdd»ssRe¥Ú£
(
	`g‘Glob®LogTa
(), 
¡»amsAdd»ssM­
)));

669 
	}
}

677 
´iv©e
 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
g‘SŒ—msAdd»s£s
(
Li¡
<
SŒ—mAdd»ssRªge
> 
add»ssRªges
) {

678 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
	g»que¡edAdd»ssS·ûs
 = 
Ãw
 
HashM­
<>();

679 
Rßršg64NavigabËM­
 
	gadd»ssM­
;

681 
SŒ—mAdd»ssRªge
 
	g¡»amAdd»ssRªge
 : 
add»ssRªges
) {

682 
UUID
 
¡»amId
 = 
¡»amAdd»ssRªge
.
g‘SŒ—mID
();

684 ià(
	g¡»amsAdd»ssM­
.
cÚšsKey
(
¡»amId
)) {

685 
	gadd»ssM­
 = 
¡»amsAdd»ssM­
.
g‘
(
¡»amId
).
g‘Add»s£sInRªge
(
¡»amAdd»ssRªge
);

686 
	g»que¡edAdd»ssS·ûs
.
put
(
¡»amId
,

687 
Ãw
 
SŒ—mAdd»ssS·û
(
¡»amsAdd»ssM­
.
g‘
(
¡»amId
).
g‘TrimM¬k
(), 
add»ssM­
));

689 
	glog
.
w¬n
("handleStreamsAddressRequest:‡ddress space map is‚ot…resent for stream {}. " +

690 "V”ifyhi i ¨v®id sŒ—m.", 
¡»amId
);

694  
	g»que¡edAdd»ssS·ûs
;

700 @
	gBud”


701 @
G‘‹r


702 
public
 şas 
	cCÚfig
 {

703 
´iv©e
 
fš®
 
	gDEFAULT_CACHE_SIZE
 = 250
_000L
;

705 @
DeçuÉ


706 
´iv©e
 
fš®
 
	gÿcheSize
 = 
DEFAULT_CACHE_SIZE
;

708 
public
 
CÚfig
 
·r£
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

709 
	gÿcheSize
 = 
İts
.
cÚšsKey
("--sequencer-cache-size") ?

710 
LÚg
.
·r£LÚg
((
SŒšg
è
İts
.
g‘
("--£qu’ûr-ÿche-size")è: 
DEFAULT_CACHE_SIZE
;

712  
	gCÚfig
.
bud”
()

713 .
ÿcheSize
(cacheSize)

714 .
bud
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/SequencerServerCache.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCache
;

4 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCacheWr™”
;

5 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCafãše
;

6 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gRemov®Cau£
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

8 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

13 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

30 @
Slf4j


31 
public
 cÏs 
	cSequ’ûrS”v”Cache
 {

37 
´iv©e
 
fš®
 
	mCache
<
	mCÚæiùTxSŒ—m
, 
	mLÚg
> 
	mcÚæiùCache
;

43 @
G‘‹r


44 
´iv©e
 
	mmaxCÚæiùWdÿrd
 = 
Add»ss
.
NOT_FOUND
;

52 @
G‘‹r


53 
´iv©e
 
	mmaxCÚæiùNewSequ’ûr
 = 
Add»ss
.
NOT_FOUND
;

55 @
VisibËFÜTe¡šg


56 
public
 
Sequ’ûrS”v”Cache
(
ÿcheSize
, 
CacheWr™”
<
CÚæiùTxSŒ—m
, 
LÚg
> 
wr™”
) {

57 
	mthis
.
	mcÚæiùCache
 = 
Cafãše
.
ÃwBud”
()

58 .
maximumSize
(
ÿcheSize
)

59 .
wr™”
(writer)

61 .
executÜ
(
RuÂabË
::
run
)

62 .
»cÜdSts
()

63 .
bud
();

73 
public
 
	$Sequ’ûrS”v”Cache
(
ÿcheSize
) {

74 
this
.
cÚæiùCache
 = 
Cafãše
.
	`ÃwBud”
()

75 .
	`maximumSize
(
ÿcheSize
)

77 .
	`executÜ
(
RuÂabË
::
run
)

78 .
	`wr™”
(
	`g‘DeçuÉCacheWr™”
())

79 .
	`»cÜdSts
()

80 .
	`bud
();

81 
	}
}

83 
´iv©e
 
	gCacheWr™”
<
	gCÚæiùTxSŒ—m
, 
	gLÚg
> 
	$g‘DeçuÉCacheWr™”
() {

84  
Ãw
 
CacheWr™”
<
CÚæiùTxSŒ—m
, 
LÚg
>() {

90 @
Ov”ride


91 
public
 
	`wr™e
(@
NÚnuÎ
 
CÚæiùTxSŒ—m
 
key
, @NÚnuÎ 
LÚg
 
v®ue
) {

101 @
Ov”ride


102 
public
 
	`d–‘e
(@
NÚnuÎ
 
CÚæiùTxSŒ—m
 
key
, 
LÚg
 
glob®Add»ss
, @NÚnuÎ 
Remov®Cau£
 
ÿu£
) {

103 ià(
ÿu£
 =ğ
Remov®Cau£
.
REPLACED
) {

104 
SŒšg
 
”rMsg
 = SŒšg.
	`fÜm©
("Ov”rid”rÜ. CÚæiù key: %s,‡dd»ss: %s", 
key
, 
glob®Add»ss
);

105 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
”rMsg
);

108 
log
.
	`Œaû
(

110 
maxCÚæiùWdÿrd
, 
glob®Add»ss
, 
key
, 
ÿu£


113 ià(
glob®Add»ss
 =ğ
nuÎ
) {

114 
glob®Add»ss
 = 
Add»ss
.
NOT_FOUND
;

116 
maxCÚæiùWdÿrd
 = 
M©h
.
	`max
(
glob®Add»ss
, maxConflictWildcard);

119 
	}
}

128 
public
 
LÚg
 
	$g‘IfP»£Á
(
CÚæiùTxSŒ—m
 
cÚæiùKey
) {

129  
cÚæiùCache
.
	`g‘IfP»£Á
(
cÚæiùKey
);

130 
	}
}

137 
public
 
	$šv®id©eUpTo
(
ŒimM¬k
) {

138 
log
.
	`debug
("Inv®id©£qu’û¸ÿche. Trim m¬k: {}", 
ŒimM¬k
);

140 
AtomicLÚg
 
’Œ›s
 = 
Ãw
 
	`AtomicLÚg
();

142 
cÚæiùCache
.
	`asM­
().
	`fÜEach
((
key
, 
txV”siÚ
) -> {

143 ià(
txV”siÚ
 =ğ
nuÎ
 ||xV”siÚ >ğ
ŒimM¬k
) {

147 
cÚæiùCache
.
	`šv®id©e
(
key
);

148 
’Œ›s
.
	`šüem’tAndG‘
();

151 
log
.
	`šfo
("Inv®id©edƒÁr›s: {}", 
’Œ›s
.
	`g‘
());

152 
	}
}

159 
public
 
	$size
() {

160  
cÚæiùCache
.
	`e¡im©edSize
();

161 
	}
}

169 
public
 
	$put
(
CÚæiùTxSŒ—m
 
cÚæiùSŒ—m
, 
ÃwTa
) {

170 
cÚæiùCache
.
	`put
(
cÚæiùSŒ—m
, 
ÃwTa
);

171 
	}
}

176 
public
 
	$šv®id©eAÎ
() {

177 
log
.
	`šfo
("Invalidate sequencer server cache");

178 
cÚæiùCache
.
	`šv®id©eAÎ
();

179 
	}
}

186 
public
 
	$upd©eMaxCÚæiùAdd»ss
(
ÃwMaxCÚæiùWdÿrd
) {

187 
log
.
	`šfo
("upd©eMaxCÚæiùAdd»ss,‚ew‡dd»ss: {}", 
ÃwMaxCÚæiùWdÿrd
);

188 
maxCÚæiùWdÿrd
 = 
ÃwMaxCÚæiùWdÿrd
;

189 
maxCÚæiùNewSequ’ûr
 = 
ÃwMaxCÚæiùWdÿrd
;

190 
	}
}

195 @
Equ®sAndHashCode


196 
public
 şas 
	cCÚæiùTxSŒ—m
 {

197 
´iv©e
 
fš®
 
UUID
 
	g¡»amId
;

198 
´iv©e
 
fš®
 
	gby‹
[] 
	gcÚæiùP¬am
;

200 
public
 
CÚæiùTxSŒ—m
(
UUID
 
¡»amId
, 
by‹
[] 
cÚæiùP¬am
) {

201 
	gthis
.
	g¡»amId
 = 
¡»amId
;

202 
	gthis
.
	gcÚæiùP¬am
 = 
cÚæiùP¬am
;

205 @
Ov”ride


206 
public
 
SŒšg
 
toSŒšg
() {

207  
	g¡»amId
.
toSŒšg
(è+ 
	gcÚæiùP¬am
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/ServerContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

7 
impÜt
 
	glombok
.
	gAcûssLev–
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcomm
.
	gChªÃlIm¶em’tiÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gD©aStÜe
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gKvD©aStÜe
.
	gKvRecÜd
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g·xos
.
	gPaxosD©aStÜe
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gFau»D‘eùÜM‘rics
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gCÚ£rv©iveFau»HªdËrPŞicy
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gIRecÚfigu¿tiÚHªdËrPŞicy
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUuidUts
;

28 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

29 
impÜt
 
	gjava
.
	gio
.
	gFe
;

30 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

31 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

32 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

33 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

34 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

35 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

36 
impÜt
 
	gjava
.
	gut
.
	gM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

38 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

39 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

42 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gM©ch”
;

43 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

45 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
.
	gisM‘ricsR•ÜtšgS‘Up
;

61 @
Slf4j


62 
public
 cÏs 
	cS”v”CÚ‹xt
 
im¶em’ts
 
	mAutoClo£abË
 {

65 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_EPOCH
 = "SERVER_EPOCH";

66 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_EPOCH
 = "CURRENT";

67 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_LAYOUT
 = "LAYOUT";

68 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_LAYOUT
 = "CURRENT";

69 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_LAYOUTS
 = "LAYOUTS";

72 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_SEQUENCER
 = "SEQUENCER";

73 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_SEQUENCER_EPOCH
 = "EPOCH";

76 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_MANAGEMENT
 = "MANAGEMENT";

77 
´iv©e
 
fš®
 
SŒšg
 
	mMANAGEMENT_LAYOUT
 = "LAYOUT";

80 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_FAILURE_DETECTOR
 = "FAILURE_DETECTOR";

83 
´iv©e
 
fš®
 
SŒšg
 
	mPREFIX_LOGUNIT
 = "LOGUNIT";

84 
´iv©e
 
fš®
 
SŒšg
 
	mEPOCH_WATER_MARK
 = "EPOCH_WATER_MARK";

87 
´iv©e
 
fš®
 
SŒšg
 
	mNODE_ID
 = "NODE_ID";

89 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mSŒšg
> 
	mNODE_ID_RECORD
 = 
KvRecÜd
.
of
(
NODE_ID
, 
SŒšg
.
şass
);

91 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mLayout
> 
	mCURR_LAYOUT_RECORD
 = 
KvRecÜd
.
of
(

92 
PREFIX_LAYOUT
, 
KEY_LAYOUT
, 
Layout
.
şass


95 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mLÚg
> 
	mSERVER_EPOCH_RECORD
ğ
KvRecÜd
.
of
(

96 
PREFIX_EPOCH
, 
KEY_EPOCH
, 
LÚg
.
şass


99 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mLÚg
> 
	mSEQUENCER_RECORD
 = 
KvRecÜd
.
of
(

100 
KEY_SEQUENCER
, 
PREFIX_SEQUENCER_EPOCH
, 
LÚg
.
şass


103 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mLayout
> 
	mMANAGEMENT_LAYOUT_RECORD
 = 
KvRecÜd
.
of
(

104 
PREFIX_MANAGEMENT
, 
MANAGEMENT_LAYOUT
, 
Layout
.
şass


107 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mLÚg
> 
	mLOG_UNIT_WATERMARK_RECORD
 = 
KvRecÜd
.
of
(

108 
PREFIX_LOGUNIT
, 
EPOCH_WATER_MARK
, 
LÚg
.
şass


115 
public
 
fš®
 
Du¿tiÚ
 
	mSHUTDOWN_TIMER
 = Du¿tiÚ.
ofSecÚds
(5);

118 @
G‘‹r


119 
´iv©e
 
fš®
 
	mM­
<
	mSŒšg
, 
	mObjeù
> 
	m£rv”CÚfig
;

121 @
G‘‹r


122 
´iv©e
 
fš®
 
D©aStÜe
 
	md©aStÜe
;

124 @
	mG‘‹r


125 @
S‘‹r


126 
´iv©e
 
IS”v”Rou‹r
 
	m£rv”Rou‹r
;

128 @
	mG‘‹r


129 @
S‘‹r


130 
´iv©e
 
IRecÚfigu¿tiÚHªdËrPŞicy
 
	mçu»HªdËrPŞicy
;

132 @
G‘‹r


133 
´iv©e
 
fš®
 
Ev’tLoİGroup
 
	mş›ÁGroup
;

135 @
G‘‹r


136 
´iv©e
 
fš®
 
Ev’tLoİGroup
 
	mbossGroup
;

138 @
G‘‹r


139 
´iv©e
 
fš®
 
Ev’tLoİGroup
 
	mwÜk”Group
;

141 @
	$G‘‹r
 (
AcûssLev–
.
PACKAGE
)

142 
´iv©e
 
fš®
 
NodeLoÿtÜ
 
nodeLoÿtÜ
;

144 @
G‘‹r


145 
´iv©e
 
fš®
 
SŒšg
 
loÿlEndpošt
;

147 @
G‘‹r


148 
´iv©e
 
fš®
 
M‘ricRegi¡ry
 
m‘rics
 = 
Ãw
 
	`M‘ricRegi¡ry
();

150 @
G‘‹r


151 
´iv©e
 
fš®
 
S‘
<
SŒšg
> 
dsFeP»fixesFÜCËªup
 =

152 
S‘s
.
	`ÃwHashS‘
(
PaxosD©aStÜe
.
PREFIX_PHASE_1
, PaxosD©aStÜe.
PREFIX_PHASE_2
, 
PREFIX_LAYOUTS
);

159 
public
 
	`S”v”CÚ‹xt
(
M­
<
SŒšg
, 
Objeù
> 
£rv”CÚfig
) {

160 
this
.
£rv”CÚfig
 = serverConfig;

161 
this
.
d©aStÜe
 = 
Ãw
 
	`D©aStÜe
(
£rv”CÚfig
,his::
d©aStÜeFeCËªup
);

162 
	`g’”©eNodeId
();

163 
this
.
çu»HªdËrPŞicy
 = 
Ãw
 
	`CÚ£rv©iveFau»HªdËrPŞicy
();

167 
fš®
 
boŞ—n
 
´ovidedEv’tLoİs
 =

168 
	`g‘ChªÃlIm¶em’tiÚ
().
	`equ®s
(
ChªÃlIm¶em’tiÚ
.
LOCAL
);

170 ià(
´ovidedEv’tLoİs
) {

171 
ş›ÁGroup
 = 
	`g‘S”v”CÚfig
(
Ev’tLoİGroup
.
şass
, "client");

172 
wÜk”Group
 = 
	`g‘S”v”CÚfig
(
Ev’tLoİGroup
.
şass
, "worker");

173 
bossGroup
 = 
	`g‘S”v”CÚfig
(
Ev’tLoİGroup
.
şass
, "boss");

175 
ş›ÁGroup
 = 
	`g‘NewCl›ÁGroup
();

176 
wÜk”Group
 = 
	`g‘NewWÜk”Group
();

177 
bossGroup
 = 
	`g‘NewBossGroup
();

180 
nodeLoÿtÜ
 = 
NodeLoÿtÜ


181 .
	`·r£SŒšg
(
£rv”CÚfig
.
	`g‘
("--address") + ":" + serverConfig.get("<port>"));

182 
loÿlEndpošt
 = 
nodeLoÿtÜ
.
	`toEndpoštU¾
();

185 ià(!
	`isM‘ricsR•ÜtšgS‘Up
(
m‘rics
)) {

186 
M‘ricsUts
.
	`m‘ricsR•ÜtšgS‘up
(
m‘rics
);

190 
	$g‘Ba£S”v”Th»adCouÁ
() {

191 
IÁeg”
 
th»adCouÁ
 = 
	`g‘S”v”CÚfig
(IÁeg”.
şass
, "--base-server-threads");

192  
th»adCouÁ
 =ğ
nuÎ
 ? 1 :hreadCount;

193 
	}
}

195 
	$g‘LayoutS”v”Th»adCouÁ
() {

196 
IÁeg”
 
th»adCouÁ
 = 
	`g‘S”v”CÚfig
(IÁeg”.
şass
, "--layout-server-threads");

197  
th»adCouÁ
 =ğ
nuÎ
 ? 1 :hreadCount;

198 
	}
}

200 
public
 
	$g‘Logun™Th»adCouÁ
() {

201 
IÁeg”
 
th»adCouÁ
 = 
	`g‘S”v”CÚfig
(IÁeg”.
şass
, "--logunit-threads");

202  
th»adCouÁ
 =ğ
nuÎ
 ? 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2 :hreadCount;

203 
	}
}

205 
public
 
	$g‘Mªagem’tS”v”Th»adCouÁ
() {

206 
IÁeg”
 
th»adCouÁ
 = 
	`g‘S”v”CÚfig
(IÁeg”.
şass
, "--management-server-threads");

207  
th»adCouÁ
 =ğ
nuÎ
 ? 4 :hreadCount;

208 
	}
}

215 
´iv©e
 
	$d©aStÜeFeCËªup
(
SŒšg
 
feName
) {

216 
SŒšg
 
logDœP©h
 = 
	`g‘S”v”CÚfig
(SŒšg.
şass
, "--log-path");

217 ià(
logDœP©h
 =ğ
nuÎ
) {

221 
Fe
 
logDœ
 = 
Ãw
 
	`Fe
(
logDœP©h
);

222 
S‘
<
SŒšg
> 
´efixesToCËª
 = 
	`g‘DsFeP»fixesFÜCËªup
();

223 
numR‘’tiÚ
 = 
IÁeg”
.
	`·r£IÁ
(
	`g‘S”v”CÚfig
(
SŒšg
.
şass
, "--metadata-retention"));

225 
´efixesToCËª
.
	`¡»am
()

226 .
	`f‹r
(
feName
::
¡¬tsW™h
)

227 .
	`fÜEach
(
´efix
 -> {

228 
Fe
[] 
foundFes
 = 
logDœ
.
	`li¡Fes
((
dœ
, 
Çme
è->‚ame.
	`¡¬tsW™h
(
´efix
));

229 ià(
foundFes
 =ğ
nuÎ
 || foundFes.
Ëngth
 <ğ
numR‘’tiÚ
) {

230 
log
.
	`debug
("D©aStÜş—nu°nÙ s¹ed fÜ…»fix: {}.", 
´efix
);

233 
log
.
	`debug
("S¹ cËªšg u°D©aStÜfe w™h…»fix: {}.", 
´efix
);

234 
A¼ays
.
	`¡»am
(
foundFes
)

235 .
	`sÜ‹d
(
Com·¿tÜ
.
	`com·ršgIÁ
(
fe
 -> {

237 
M©ch”
 
m©ch”
 = 
P©‹º
.
	`compe
("\\d+").
	`m©ch”
(
fe
.
	`g‘Name
());

238  
m©ch”
.
	`fšd
(
´efix
.
	`Ëngth
()è? 
IÁeg”
.
	`·r£IÁ
(m©ch”.
	`group
()) : 0;

240 .
	`lim™
(
foundFes
.
Ëngth
 - 
numR‘’tiÚ
)

241 .
	`fÜEach
(
fe
 -> {

242 
Œy
 {

243 ià(
Fes
.
	`d–‘eIfExi¡s
(
fe
.
	`toP©h
())) {

244 
log
.
	`šfo
("Removed D©aStÜfe: {}", 
fe
.
	`g‘Name
());

246 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

247 
log
.
	`”rÜ
("E¼Ü wh’ cËªšg u°D©aStÜfes", 
e
);

251 
	}
}

258 
public
 
ChªÃlIm¶em’tiÚ
 
	$g‘ChªÃlIm¶em’tiÚ
() {

259 
fš®
 
SŒšg
 
ty³
 = 
	`g‘S”v”CÚfig
(SŒšg.
şass
, "--implementation");

260  
ChªÃlIm¶em’tiÚ
.
	`v®ueOf
(
ty³
.
	`toUµ”Ca£
());

261 
	}
}

269 
public
 
CÜfuRuÁimeP¬am‘”s
 
	$g‘Mªagem’tRuÁimeP¬am‘”s
() {

270  
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

271 .
	`´iÜ™yLev–
(
PriÜ™yLev–
.
HIGH
)

272 .
	`Ã‰yEv’tLoİ
(
ş›ÁGroup
)

273 .
	`shutdownN‘tyEv’tLoİ
(
çl£
)

274 .
	`sEÇbËd
((
BoŞ—n
è
£rv”CÚfig
.
	`g‘
("--enable-tls"))

275 .
	`keyStÜe
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--keystore"))

276 .
	`ksPasswÜdFe
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--keystore-password-file"))

277 .
	`Œu¡StÜe
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--truststore"))

278 .
	`tsPasswÜdFe
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--truststore-password-file"))

279 .
	`§¦PÏšTextEÇbËd
((
BoŞ—n
è
£rv”CÚfig
.
	`g‘
("--enable-sasl-plain-text-auth"))

280 .
	`u£ºameFe
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--sasl-plain-text-username-file"))

281 .
	`·sswÜdFe
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--sasl-plain-text-password-file"))

282 .
	`bulkR—dSize
(
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
£rv”CÚfig
.
	`g‘
("--batch-size")))

283 .
	`bud
();

284 
	}
}

289 
´iv©e
 
	$g’”©eNodeId
() {

290 
SŒšg
 
cu¼’tId
 = 
	`g‘D©aStÜe
().
	`g‘
(
NODE_ID_RECORD
);

291 ià(
cu¼’tId
 =ğ
nuÎ
) {

292 
SŒšg
 
idSŒšg
 = 
UuidUts
.
	`asBa£64
(
UUID
.
	`¿ndomUUID
());

293 
log
.
	`šfo
("NØNodId, s‘tšgØÃw Id={}", 
idSŒšg
);

294 
	`g‘D©aStÜe
().
	`put
(
NODE_ID_RECORD
, 
idSŒšg
);

296 
log
.
	`šfo
("NodId = {}", 
cu¼’tId
);

298 
	}
}

305 
public
 
UUID
 
	$g‘NodeId
() {

306  
UuidUts
.
	`äomBa£64
(
	`g‘NodeIdBa£64
());

307 
	}
}

313 
public
 
SŒšg
 
	$g‘NodeIdBa£64
() {

314  
	`g‘D©aStÜe
().
	`g‘
(
NODE_ID_RECORD
);

315 
	}
}

325 @
Suµ»ssW¬nšgs
("unchecked")

326 
	gpublic
 <
	gT
> 
T
 
g‘S”v”CÚfig
(
CÏss
<T> 
ty³
, 
SŒšg
 
İtiÚName
) {

327  (
	gT
è
g‘S”v”CÚfig
().
g‘
(
İtiÚName
);

337 
public
 
synchrÚized
 
boŞ—n
 
	$š¡®lSšgËNodeLayoutIfAb£Á
() {

338 ià((
BoŞ—n
è
	`g‘S”v”CÚfig
().
	`g‘
("--sšgË"è&& 
	`g‘Cu¼’tLayout
(è=ğ
nuÎ
) {

339 
	`£tCu¼’tLayout
(
	`g‘NewSšgËNodeLayout
());

340  
Œue
;

342  
çl£
;

343 
	}
}

352 
public
 
Layout
 
	$g‘NewSšgËNodeLayout
() {

353 
fš®
 
SŒšg
 
şu¡”IdSŒšg
 = (SŒšgè
	`g‘S”v”CÚfig
().
	`g‘
("--cluster-id");

354 
UUID
 
şu¡”Id
;

355 ià(
şu¡”IdSŒšg
.
	`equ®s
("auto")) {

356 
şu¡”Id
 = 
UUID
.
	`¿ndomUUID
();

359 
Œy
 {

360 
şu¡”Id
 = 
UUID
.
	`äomSŒšg
(
şu¡”IdSŒšg
);

361 } 
	`ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
ignÜe
) {

363 
şu¡”Id
 = 
UuidUts
.
	`äomBa£64
(
şu¡”IdSŒšg
);

366 
log
.
	`šfo
("getNewSingleNodeLayout: Bootstrapping with cluster Id {} [{}]",

367 
şu¡”Id
, 
UuidUts
.
	`asBa£64
(clusterId));

368 
SŒšg
 
loÿlAdd»ss
 = 
	`g‘S”v”CÚfig
().
	`g‘
("--address") + ":"

369 + 
	`g‘S”v”CÚfig
().
	`g‘
("<port>");

370  
Ãw
 
	`Layout
(

371 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
loÿlAdd»ss
),

372 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
loÿlAdd»ss
),

373 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
	`LayoutSegm’t
(

374 
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
,

377 
CŞËùiÚs
.
	`sšgËtÚLi¡
(

378 
Ãw
 
Layout
.
	`LayoutSŒe
(

379 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
loÿlAdd»ss
)

384 
şu¡”Id


386 
	}
}

393 
public
 
Layout
 
	$g‘Cu¼’tLayout
() {

394  
	`g‘D©aStÜe
().
	`g‘
(
CURR_LAYOUT_RECORD
);

395 
	}
}

402 
public
 
	$£tCu¼’tLayout
(
Layout
 
Ïyout
) {

403 
	`g‘D©aStÜe
().
	`put
(
CURR_LAYOUT_RECORD
, 
Ïyout
);

404 
	}
}

411 
public
 
	gLi¡
<
	gAb¡¿ùS”v”
> 
	$g‘S”v”s
() {

412  
£rv”Rou‹r
.
	`g‘S”v”s
();

413 
	}
}

418 
public
 
synchrÚized
 
	$g‘S”v”Epoch
() {

419 
LÚg
 
•och
 = 
d©aStÜe
.
	`g‘
(
SERVER_EPOCH_RECORD
);

420  
•och
 =ğ
nuÎ
 ? 0 :ƒpoch;

421 
	}
}

428 
public
 
synchrÚized
 
	$£tS”v”Epoch
(
£rv”Epoch
, 
IS”v”Rou‹r
 
r
) {

429 
LÚg
 
Ï¡Epoch
 = 
d©aStÜe
.
	`g‘
(
SERVER_EPOCH_RECORD
);

430 ià(
Ï¡Epoch
 =ğ
nuÎ
 ||†a¡Epoch < 
£rv”Epoch
) {

431 
d©aStÜe
.
	`put
(
SERVER_EPOCH_RECORD
, 
£rv”Epoch
);

432 
r
.
	`£tS”v”Epoch
(
£rv”Epoch
);

433 
	`g‘S”v”s
().
	`fÜEach
(
s
 -> s.
	`£®S”v”W™hEpoch
(
£rv”Epoch
));

434 } ià(
£rv”Epoch
 =ğ
Ï¡Epoch
) {

438 
throw
 
Ãw
 
	`WrÚgEpochExû±iÚ
(
Ï¡Epoch
);

440 
	}
}

442 
public
 
	$£tLayoutInHi¡Üy
(
Layout
 
Ïyout
) {

443 
KvRecÜd
<
Layout
> 
cu¼LayoutRecÜd
 = KvRecÜd.
	`of
(

444 
PREFIX_LAYOUTS
, 
SŒšg
.
	`v®ueOf
(
Ïyout
.
	`g‘Epoch
()), 
Layout
.
şass


446 
d©aStÜe
.
	`put
(
cu¼LayoutRecÜd
, 
Ïyout
);

447 
	}
}

455 
public
 
	$£tSequ’ûrEpoch
(
£qu’ûrEpoch
) {

456 
d©aStÜe
.
	`put
(
SEQUENCER_RECORD
, 
£qu’ûrEpoch
);

457 
	}
}

464 
public
 
	$g‘Sequ’ûrEpoch
() {

465 
LÚg
 
•och
 = 
d©aStÜe
.
	`g‘
(
SEQUENCER_RECORD
);

466  
•och
 =ğ
nuÎ
 ? 
Layout
.
INVALID_EPOCH
 :ƒpoch;

467 
	}
}

474 
public
 
synchrÚized
 
Layout
 
	$§veMªagem’tLayout
(
Layout
 
ÃwLayout
) {

475 
Layout
 
cu¼’tLayout
 = 
	`cİyMªagem’tLayout
();

478 ià(
ÃwLayout
 =ğ
nuÎ
) {

479 
log
.
	`w¬n
("A‰em±edØupd©w™h‚uÎ. Cu¼’ˆÏyout: {}", 
cu¼’tLayout
);

480  
cu¼’tLayout
;

484 ià(
cu¼’tLayout
 =ğ
nuÎ
 || 
ÃwLayout
.
	`g‘Epoch
() > currentLayout.getEpoch()) {

485 
d©aStÜe
.
	`put
(
MANAGEMENT_LAYOUT_RECORD
, 
ÃwLayout
);

486 
cu¼’tLayout
 = 
	`cİyMªagem’tLayout
();

487 
log
.
	`šfo
("Upd©tØÃw†ayouˆ©ƒpoch {}", 
cu¼’tLayout
.
	`g‘Epoch
());

488  
cu¼’tLayout
;

491  
cu¼’tLayout
;

493 
	}
}

501 
public
 
synchrÚized
 
	$§veFau»D‘eùÜM‘rics
(
Fau»D‘eùÜM‘rics
 
d‘eùÜ
) {

502 
boŞ—n
 
’abËd
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
Sy¡em
.
	`g‘Prİ”ty
("cÜfu.çu»d‘eùÜ", BoŞ—n.
FALSE
.
	`toSŒšg
()));

503 ià(!
’abËd
){

507 
KvRecÜd
<
Fau»D‘eùÜM‘rics
> 
fdRecÜd
 = KvRecÜd.
	`of
(

508 
PREFIX_FAILURE_DETECTOR
,

509 
SŒšg
.
	`v®ueOf
(
	`g‘Mªagem’tLayout
().
	`g‘Epoch
()),

510 
Fau»D‘eùÜM‘rics
.
şass


513 
d©aStÜe
.
	`put
(
fdRecÜd
, 
d‘eùÜ
);

514 
	}
}

521 
public
 
Fau»D‘eùÜM‘rics
 
	$g‘Fau»D‘eùÜM‘rics
() {

522 
boŞ—n
 
’abËd
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
Sy¡em
.
	`g‘Prİ”ty
("cÜfu.çu»d‘eùÜ", BoŞ—n.
FALSE
.
	`toSŒšg
()));

523 if(!
’abËd
){

524  
	`g‘DeçuÉFau»D‘eùÜM‘ric
(
	`g‘Mªagem’tLayout
());

527 
KvRecÜd
<
Fau»D‘eùÜM‘rics
> 
fdRecÜd
 = KvRecÜd.
	`of
(

528 
PREFIX_FAILURE_DETECTOR
,

529 
SŒšg
.
	`v®ueOf
(
	`g‘Mªagem’tLayout
().
	`g‘Epoch
()),

530 
Fau»D‘eùÜM‘rics
.
şass


533  
O±iÚ®


534 .
	`ofNuÎabË
(
d©aStÜe
.
	`g‘
(
fdRecÜd
))

535 .
	`ÜEl£G‘
((è-> 
	`g‘DeçuÉFau»D‘eùÜM‘ric
(
	`g‘Mªagem’tLayout
()));

536 
	}
}

543 
´iv©e
 
Fau»D‘eùÜM‘rics
 
	$g‘DeçuÉFau»D‘eùÜM‘ric
(
Layout
 
Ïyout
) {

544  
Fau»D‘eùÜM‘rics
.
	`bud”
()

545 .
	`loÿlNode
(
	`g‘LoÿlEndpošt
())

546 .
	`Ïyout
(
Ïyout
.
	`g‘LayoutS”v”s
())

547 .
	`uÄe¥ÚsiveNodes
(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
())

548 .
	`•och
(
Ïyout
.
	`g‘Epoch
())

549 .
	`bud
();

550 
	}
}

557 
public
 
Layout
 
	$g‘Mªagem’tLayout
() {

558  
d©aStÜe
.
	`g‘
(
MANAGEMENT_LAYOUT_RECORD
);

559 
	}
}

566 
public
 
synchrÚized
 
	$£tLogUn™EpochW©”M¬k
(
»£tEpoch
) {

567 
d©aStÜe
.
	`put
(
LOG_UNIT_WATERMARK_RECORD
, 
»£tEpoch
);

568 
	}
}

575 
public
 
synchrÚized
 
	$g‘LogUn™EpochW©”M¬k
() {

576 
LÚg
 
»£tEpoch
 = 
d©aStÜe
.
	`g‘
(
LOG_UNIT_WATERMARK_RECORD
);

577  
»£tEpoch
 =ğ
nuÎ
 ? 
Layout
.
INVALID_EPOCH
 :„esetEpoch;

578 
	}
}

585 
public
 
Layout
 
	$cİyMªagem’tLayout
() {

586 
Layout
 
l
 = 
	`g‘Mªagem’tLayout
();

587 ià(
l
 !ğ
nuÎ
) {

588  
Ãw
 
	`Layout
(
l
);

590  
nuÎ
;

592 
	}
}

599 
´iv©e
 
Ev’tLoİGroup
 
	$g‘NewBossGroup
() {

600 
fš®
 
Th»adFaùÜy
 
th»adFaùÜy
 = 
Ãw
 
	`Th»adFaùÜyBud”
()

601 .
	`£tNameFÜm©
(
	`g‘Th»adP»fix
() + "accept-%d")

602 .
	`bud
();

603 
Ev’tLoİGroup
 
group
 = 
	`g‘ChªÃlIm¶em’tiÚ
().
	`g‘G’”©Ü
()

604 .
	`g’”©e
(1, 
th»adFaùÜy
);

605 
log
.
	`šfo
("g‘BossGroup: Ty³ {}", 
group
.
	`g‘CÏss
().
	`g‘Sim¶eName
());

606  
group
;

607 
	}
}

614 
	g´iv©e
 @
NÚnuÎ
 
Ev’tLoİGroup
 
	$g‘NewWÜk”Group
() {

615 
fš®
 
Th»adFaùÜy
 
th»adFaùÜy
 = 
Ãw
 
	`Th»adFaùÜyBud”
()

616 .
	`£tNameFÜm©
(
	`g‘Th»adP»fix
() + "worker-%d")

617 .
	`bud
();

619 
fš®
 
»que¡edTh»ads
 =

620 
IÁeg”
.
	`·r£IÁ
(
	`g‘S”v”CÚfig
(
SŒšg
.
şass
, "--Threads"));

621 
fš®
 
numTh»ads
 = 
»que¡edTh»ads
 == 0

622 ? 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2

623 : 
»que¡edTh»ads
;

624 
Ev’tLoİGroup
 
group
 = 
	`g‘ChªÃlIm¶em’tiÚ
().
	`g‘G’”©Ü
()

625 .
	`g’”©e
(
numTh»ads
, 
th»adFaùÜy
);

627 
log
.
	`šfo
("getWorkerGroup: Type {} with {}hreads",

628 
group
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), 
numTh»ads
);

629  
group
;

630 
	}
}

637 
	g´iv©e
 @
NÚnuÎ
 
Ev’tLoİGroup
 
	$g‘NewCl›ÁGroup
() {

638 
fš®
 
Th»adFaùÜy
 
th»adFaùÜy
 = 
Ãw
 
	`Th»adFaùÜyBud”
()

639 .
	`£tNameFÜm©
(
	`g‘Th»adP»fix
() + "client-%d")

640 .
	`bud
();

642 
fš®
 
»que¡edTh»ads
 =

643 
IÁeg”
.
	`·r£IÁ
(
	`g‘S”v”CÚfig
(
SŒšg
.
şass
, "--Threads"));

644 
fš®
 
numTh»ads
 = 
»que¡edTh»ads
 == 0

645 ? 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2

646 : 
»que¡edTh»ads
;

647 
Ev’tLoİGroup
 
group
 = 
	`g‘ChªÃlIm¶em’tiÚ
().
	`g‘G’”©Ü
()

648 .
	`g’”©e
(
numTh»ads
, 
th»adFaùÜy
);

650 
log
.
	`šfo
("getClientGroup: Type {} with {}hreads",

651 
group
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), 
numTh»ads
);

652  
group
;

653 
	}
}

660 
	gpublic
 @
NÚnuÎ
 
SŒšg
 
	$g‘Th»adP»fix
() {

661 
fš®
 
SŒšg
 
´efix
 = 
	`g‘S”v”CÚfig
(SŒšg.
şass
, "--Prefix");

662 ià(
´efix
.
	`equ®s
("")) {

665  
´efix
 + "-";

667 
	}
}

675 @
Ov”ride


676 
public
 
	$şo£
() {

677 
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = 
	`g‘Mªagem’tRuÁimeP¬am‘”s
();

679 ià(!
	`g‘ChªÃlIm¶em’tiÚ
().
	`equ®s
(
ChªÃlIm¶em’tiÚ
.
LOCAL
)) {

680 
ş›ÁGroup
.
	`shutdownG¿ûfuÎy
(

681 
·¿ms
.
	`g‘N‘tyShutdownQu™eP”iod
(),

682 
·¿ms
.
	`g‘N‘tyShutdownTimeout
(),

683 
TimeUn™
.
MILLISECONDS


685 
bossGroup
.
	`shutdownG¿ûfuÎy
(

686 
·¿ms
.
	`g‘N‘tyShutdownQu™eP”iod
(),

687 
·¿ms
.
	`g‘N‘tyShutdownTimeout
(),

688 
TimeUn™
.
MILLISECONDS


690 
wÜk”Group
.
	`shutdownG¿ûfuÎy
(

691 
·¿ms
.
	`g‘N‘tyShutdownQu™eP”iod
(),

692 
·¿ms
.
	`g‘N‘tyShutdownTimeout
(),

693 
TimeUn™
.
MILLISECONDS


696 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/ServerHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

14 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

15 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

16 @
Inh”™ed


17 
	gpublic
 @
š‹rçû
 
	gS”v”HªdËr
 {

22 
CÜfuMsgTy³
 
ty³
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/ServerHandshakeHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlDu¶exHªdËr
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlPromi£
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gR—dTimeoutExû±iÚ
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gR—dTimeoutHªdËr
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gut
.
	gA‰ribu‹Key
;

10 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gQueue
;

12 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLHªdshakeExû±iÚ
;

16 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gHªdshakeMsg
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gHªdshakeRe¥Ú£
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gHªdshakeS‹
;

31 @
Slf4j


32 
public
 cÏs 
	cS”v”HªdshakeHªdËr
 
ex‹nds
 
	mChªÃlDu¶exHªdËr
 {

34 
´iv©e
 
fš®
 
UUID
 
	mnodeId
;

35 
´iv©e
 
fš®
 
SŒšg
 
	mcÜfuV”siÚ
;

36 
´iv©e
 
fš®
 
HªdshakeS‹
 
	m¡©e
;

37 
´iv©e
 
fš®
 
	mtimeoutInSecÚds
;

38 
´iv©e
 
fš®
 
	mQueue
<
	mCÜfuMsg
> 
	mmes§ges
 = 
Ãw
 
LškedLi¡
<>();

39 
´iv©e
 
fš®
 
	mA‰ribu‹Key
<
	mUUID
> 
	mş›ÁIdA‰rKey
 = 
A‰ribu‹Key
.
v®ueOf
("ClientID");

40 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TIMEOUT_HANDLER
 = "readTimeoutHandler";

49 
public
 
	$S”v”HªdshakeHªdËr
(
UUID
 
nodeId
, 
SŒšg
 
cÜfuV”siÚ
, SŒšg 
timeoutInSecÚds
) {

50 
this
.
nodeId
 =‚odeId;

51 
this
.
cÜfuV”siÚ
 = corfuVersion;

52 
this
.
timeoutInSecÚds
 = 
IÁeg”
.
	`·r£IÁ
(timeoutInSeconds);

53 
this
.
¡©e
 = 
Ãw
 
	`HªdshakeS‹
();

63 @
Ov”ride


64 
public
 
	$chªÃlR—d
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
m
è
throws
 
Exû±iÚ
 {

66 ià(
this
.
¡©e
.
	`çed
()) {

70 ià(
this
.
¡©e
.
	`com¶‘ed
()) {

73 
su³r
.
	`chªÃlR—d
(
ùx
, 
m
);

77 
CÜfuPaylßdMsg
<
HªdshakeMsg
> 
hªdshake
;

79 
Œy
 {

80 
hªdshake
 = (
CÜfuPaylßdMsg
<
HªdshakeMsg
>è
m
;

81 
log
.
	`debug
("channelRead: Handshake Message„eceived. Removing {} from…ipeline.",

82 
READ_TIMEOUT_HANDLER
);

85 
ùx
.
	`p–še
().
	`»move
(
READ_TIMEOUT_HANDLER
).
	`hªdËrRemoved
(ctx);

86 } 
	`ÿtch
 (
CÏssCa¡Exû±iÚ
 
e
) {

87 
log
.
	`w¬n
("channelRead: Non-handshake message„eceived by handshake handler." +

89 ià(
this
.
¡©e
.
	`com¶‘ed
()) {

91 
su³r
.
	`chªÃlR—d
(
ùx
, 
m
);

94 
Œy
 {

95 
log
.
	`debug
("chªÃlR—d: Drİpšg mes§ge: {}", ((
CÜfuMsg
è
m
).
	`g‘MsgTy³
().
	`Çme
());

96 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

97 
log
.
	`”rÜ
("channelRead: Message„eceived by Server is‚ot‡ valid " +

104 
UUID
 
ş›ÁId
 = 
hªdshake
.
	`g‘Paylßd
().
	`g‘Cl›ÁId
();

105 
UUID
 
£rv”Id
 = 
hªdshake
.
	`g‘Paylßd
().
	`g‘S”v”Id
();

109 ià(
£rv”Id
.
	`equ®s
(
UUID
.
	`äomSŒšg
("00000000-0000-0000-0000-000000000000"))) {

110 
log
.
	`šfo
("channelRead:‚ode id matching is‚ot„equested by client.");

111 } ià(!
£rv”Id
.
	`equ®s
(
this
.
nodeId
)) {

112 
log
.
	`”rÜ
("channelRead: Invalid handshake:his is {}‡nd client isryingo connecto {}",

113 
this
.
nodeId
, 
£rv”Id
);

114 
this
.
	`fœeHªdshakeFaed
(
ùx
);

119 
ùx
.
	`chªÃl
().
	`©Œ
(
ş›ÁIdA‰rKey
).
	`£t
(
ş›ÁId
);

120 
log
.
	`šfo
("channelRead: Handshake validated by Server.");

121 
log
.
	`debug
("channelRead: Sending handshake„esponse: Node Id: {} Corfu Version: {}",

122 
this
.
nodeId
,his.
cÜfuV”siÚ
);

124 
CÜfuMsg
 
hªdshakeRe¥Ú£
 = 
CÜfuMsgTy³
.
HANDSHAKE_RESPONSE


125 .
	`·ylßdMsg
(
Ãw
 
	`HªdshakeRe¥Ú£
(
this
.
nodeId
,his.
cÜfuV”siÚ
));

126 
ùx
.
	`wr™eAndFlush
(
hªdshakeRe¥Ú£
);

129 
log
.
	`debug
("chªÃlR—d: Th”¬[{}] mes§ge š queutØbæushed.", 
this
.
mes§ges
.
	`size
());

130 !
mes§ges
.
	`isEm±y
()) {

131 
ùx
.
	`wr™eAndFlush
(
mes§ges
.
	`pŞl
());

135 
log
.
	`šfo
("channelRead: Removing handshake handler from…ipeline.");

136 
ùx
.
	`p–še
().
	`»move
(
this
);

137 
this
.
	`fœeHªdshakeSucûeded
();

138 
	}
}

146 @
Ov”ride


147 
public
 
	$chªÃlAùive
(
fš®
 
ChªÃlHªdËrCÚ‹xt
 
ùx
è
throws
 
Exû±iÚ
 {

148 
log
.
	`šfo
("channelActive: Incoming connectionƒstablished from: {} Start Read Timeout.",

149 
ùx
.
	`chªÃl
().
	`»mÙeAdd»ss
());

150 
ùx
.
	`p–še
().
	`addBefÜe
(ùx.
	`Çme
(), 
READ_TIMEOUT_HANDLER
,

151 
Ãw
 
	`R—dTimeoutHªdËr
(
this
.
timeoutInSecÚds
));

152 
	}
}

160 @
Ov”ride


161 
public
 
	$chªÃlIÇùive
(
ChªÃlHªdËrCÚ‹xt
 
ùx
è
throws
 
Exû±iÚ
 {

162 
log
.
	`debug
("channelInactive: Channel closed.");

163 ià(!
this
.
¡©e
.
	`com¶‘ed
()) {

164 
this
.
	`fœeHªdshakeFaed
(
ùx
);

166 
	}
}

175 @
Ov”ride


176 
public
 
	$exû±iÚCaught
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ThrowabË
 
ÿu£
)

177 
throws
 
Exû±iÚ
 {

178 
log
.
	`”rÜ
("exû±iÚCaught: Exû±iÚ caught: {}", 
ÿu£
.
	`g‘Mes§ge
());

180 ià(
ÿu£
 
š¡ªûof
 
R—dTimeoutExû±iÚ
) {

182 ià(
this
.
¡©e
.
	`çed
()) {

183 
log
.
	`debug
("exceptionCaught: Handshakeimeout checker:‡lready failed.");

187 ià(!
this
.
¡©e
.
	`com¶‘ed
()) {

188 
log
.
	`”rÜ
("exceptionCaught: Handshakeimeout checker:imed out. Close Connection.");

189 
this
.
¡©e
.
	`£t
(
Œue
, 
çl£
);

191 
log
.
	`debug
("exceptionCaught: Handshakeimeout " +

194 } ià(
ÿu£
 
š¡ªûof
 
SSLHªdshakeExû±iÚ
) {

199 
log
.
	`”rÜ
("Client‡uthentication failed for„emote‡ddress {}",

200 
ùx
.
	`chªÃl
().
	`»mÙeAdd»ss
());

202 
su³r
.
	`exû±iÚCaught
(
ùx
, 
ÿu£
);

205 ià(
ùx
.
	`chªÃl
().
	`isAùive
()) {

207 
ùx
.
	`chªÃl
().
	`şo£
();

210 
this
.
	`fœeHªdshakeFaed
(
ùx
);

212 
	}
}

222 @
Ov”ride


223 
public
 
	$wr™e
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
msg
, 
ChªÃlPromi£
 
´omi£
)

224 
throws
 
Exû±iÚ
 {

225 ià(
this
.
¡©e
.
	`çed
()) {

230 ià(
this
.
¡©e
.
	`com¶‘ed
()) {

231 
log
.
	`debug
("write: Handshake‡lready completed,‚ot‡ppending corfu messageo queue");

232 
su³r
.
	`wr™e
(
ùx
, 
msg
, 
´omi£
);

234 
this
.
mes§ges
.
	`ofãr
((
CÜfuMsg
è
msg
);

236 
	}
}

243 
´iv©e
 
	$fœeHªdshakeFaed
(
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

244 
this
.
¡©e
.
	`£t
(
Œue
,rue);

245 
ùx
.
	`chªÃl
().
	`şo£
();

246 
	}
}

251 
´iv©e
 
	$fœeHªdshakeSucûeded
() {

252 
this
.
¡©e
.
	`£t
(
çl£
, 
Œue
);

253 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/ServerThreadFactory.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

9 @
Slf4j


10 
public
 cÏs 
	cS”v”Th»adFaùÜy
 
im¶em’ts
 
	mTh»adFaùÜy
 {

12 
´iv©e
 
fš®
 
Th»adFaùÜy
 
	mdeçuÉFaùÜy
 = 
ExecutÜs
.
deçuÉTh»adFaùÜy
();

14 
´iv©e
 
fš®
 
	mTh»ad
.
UnÿughtExû±iÚHªdËr
 
	mhªdËr
;

16 
´iv©e
 
fš®
 
SŒšg
 
	mth»adP»fix
;

18 
fš®
 
AtomicIÁeg”
 
	mth»adNumb”
 = 
Ãw
 AtomicInteger(0);

20 
public
 
	$S”v”Th»adFaùÜy
(
SŒšg
 
th»adP»fix
, 
Th»ad
.
UnÿughtExû±iÚHªdËr
 
hªdËr
) {

21 
this
.
th»adP»fix
 =hreadPrefix;

22 
this
.
hªdËr
 = handler;

25 @
Ov”ride


26 
public
 
Th»ad
 
	$ÃwTh»ad
(
RuÂabË
 
run
) {

27 
Th»ad
 
th»ad
 = 
deçuÉFaùÜy
.
	`ÃwTh»ad
(
run
);

28 
th»ad
.
	`£tName
(
th»adP»fix
 + 
th»adNumb”
.
	`g‘AndInüem’t
());

29 
th»ad
.
	`£tUnÿughtExû±iÚHªdËr
(
hªdËr
);

30 
th»ad
.
	`£tD«mÚ
(
Œue
);

31  
th»ad
;

32 
	}
}

34 
public
 
şass
 
Exû±iÚHªdËr
 
im¶em’ts
 
	gTh»ad
.
	gUnÿughtExû±iÚHªdËr
 {

35 @
Ov”ride


36 
public
 
unÿughtExû±iÚ
(
Th»ad
 
t
, 
ThrowabË
 
e
) {

37 
	glog
.
”rÜ
("handleUncaughtException[{}]: Uncaught {}:{}",

38 
t
.
g‘Name
(),

39 
e
.
g‘CÏss
().
g‘Sim¶eName
(),

40 
e
.
g‘Mes§ge
(),

41 
e
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/TxResolutionResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gToSŒšg
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Ty³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

10 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 @
	gD©a


17 @
	gToSŒšg


18 @
AÎArgsCÚ¡ruùÜ


19 şas 
	cTxResŞutiÚRe¥Ú£
 {

26 
public
 
	$TxResŞutiÚRe¥Ú£
(
Tok’Ty³
 
tok’Ty³
) {

27 
this
.
tok’Ty³
 =okenType;

28 
this
.
add»ss
 = 
Add»ss
.
NON_ADDRESS
;

29 
this
.
cÚæiùšgKey
 = 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
;

30 
this
.
cÚæiùšgSŒ—m
 = 
Tok’Re¥Ú£
.
NO_CONFLICT_STREAM
;

36 
Tok’Ty³
 
tok’Ty³
;

41 
LÚg
 
add»ss
;

46 
by‹
[] 
cÚæiùšgKey
;

51 
UUID
 
cÚæiùšgSŒ—m
;

52 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/datastore/DataStore.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	guts
.
	gP”si¡’û
.
	gsyncDœeùÜy
;

5 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCache
;

6 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCacheWr™”
;

7 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCafãše
;

8 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gLßdšgCache
;

9 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gRemov®Cau£
;

10 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	ghash
.
	gHash”
;

11 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	ghash
.
	gHashšg
;

12 
impÜt
 
	glombok
.
	gG‘‹r
;

13 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gJsÚUts
;

17 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

18 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

21 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

22 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

23 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

24 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSnd¬dCİyO±iÚ
;

25 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSnd¬dO³nO±iÚ
;

26 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

27 
impÜt
 
	gjava
.
	gut
.
	gM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

49 @
Slf4j


50 
public
 cÏs 
	cD©aStÜe
 
im¶em’ts
 
	mKvD©aStÜe
 {

52 
public
 
fš®
 
SŒšg
 
	mEXTENSION
 = ".ds";

54 @
G‘‹r


55 
´iv©e
 
fš®
 
	mCache
<
	mSŒšg
, 
	mObjeù
> 
	mÿche
;

56 
´iv©e
 
fš®
 
SŒšg
 
	mlogDœP©h
;

58 @
G‘‹r


59 
´iv©e
 
fš®
 
	mdsCacheSize
 = 1
_000
;

61 
´iv©e
 
fš®
 
boŞ—n
 
	mšMem
;

63 
´iv©e
 
fš®
 
	mCÚsum”
<
	mSŒšg
> 
	mş—nupTask
;

71 
public
 
D©aStÜe
(@
NÚnuÎ
 
M­
<
SŒšg
, 
Objeù
> 
İts
,

72 @
NÚnuÎ
 
CÚsum”
<
SŒšg
> 
ş—nupTask
) {

74 ià((
	mİts
.
cÚšsKey
("--memÜy"è&& (
	mBoŞ—n
èİts.
g‘
("--memory")) || !opts.containsKey("--log-path")) {

75 
	mthis
.
	mlogDœP©h
 = 
nuÎ
;

76 
	mthis
.
	mş—nupTask
 = 
feName
 -> { };

77 
	mÿche
 = 
budMemÜyDs
();

78 
	mšMem
 = 
Œue
;

80 
	mthis
.
	mlogDœP©h
 = (
SŒšg
è
İts
.
g‘
("--log-path");

81 
	mthis
.
	mş—nupTask
 = 
ş—nupTask
;

82 
	mÿche
 = 
budP”si¡’tDs
();

83 
	mšMem
 = 
çl£
;

92 
´iv©e
 
	gCache
<
	gSŒšg
, 
	gObjeù
> 
	$budMemÜyDs
() {

93  
Cafãše
.
	`ÃwBud”
().
	`bud
(
k
 -> 
nuÎ
);

94 
	}
}

97 
public
 
	$g‘Checksum
(
by‹
[] 
by‹s
) {

98 
Hash”
 
hash”
 = 
Hashšg
.
	`üc32c
().
	`ÃwHash”
();

99 
by‹
 
a
 : 
by‹s
) {

100 
hash”
.
	`putBy‹
(
a
);

103  
hash”
.
	`hash
().
	`asIÁ
();

104 
	}
}

113 
´iv©e
 
	gCache
<
	gSŒšg
, 
	gObjeù
> 
	$budP”si¡’tDs
() {

114  
Cafãše
.
	`ÃwBud”
()

115 .
	`»cÜdSts
()

116 .
	`wr™”
(
Ãw
 
CacheWr™”
<
SŒšg
, 
Objeù
>() {

117 @
Ov”ride


118 
public
 
synchrÚized
 
	`wr™e
(@
NÚnuÎ
 
SŒšg
 
key
, @NÚnuÎ 
Objeù
 
v®ue
) {

120 ià(
v®ue
 =ğ
NuÎV®ue
.
NULL_VALUE
) {

124 
Œy
 {

125 
SŒšg
 
dsFeName
 = 
key
 + 
EXTENSION
;

126 
P©h
 
·th
 = 
P©hs
.
	`g‘
(
logDœP©h
, 
dsFeName
);

127 
P©h
 
tmpP©h
 = 
P©hs
.
	`g‘
(
logDœP©h
, 
dsFeName
 + ".tmp");

129 
SŒšg
 
jsÚPaylßd
 = 
JsÚUts
.
·r£r
.
	`toJsÚ
(
v®ue
, v®ue.
	`g‘CÏss
());

130 
by‹
[] 
by‹s
 = 
jsÚPaylßd
.
	`g‘By‹s
();

132 
By‹Bufãr
 
bufãr
 = By‹Bufãr.
	`®loÿ‹
(
by‹s
.
Ëngth


133 + 
IÁeg”
.
BYTES
);

134 
bufãr
.
	`putIÁ
(
	`g‘Checksum
(
by‹s
));

135 
bufãr
.
	`put
(
by‹s
);

136 
Fes
.
	`wr™e
(
tmpP©h
, 
bufãr
.
	`¬¿y
(), 
Snd¬dO³nO±iÚ
.
CREATE
,

137 
Snd¬dO³nO±iÚ
.
TRUNCATE_EXISTING
, Snd¬dO³nO±iÚ.
SYNC
);

138 
Fes
.
	`move
(
tmpP©h
, 
·th
, 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
,

139 
Snd¬dCİyO±iÚ
.
ATOMIC_MOVE
);

140 
	`syncDœeùÜy
(
logDœP©h
);

143 
ş—nupTask
.
	`acû±
(
dsFeName
);

144 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

145 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

149 @
Ov”ride


150 
public
 
synchrÚized
 
	`d–‘e
(@
NÚnuÎ
 
SŒšg
 
key
,

151 @
NuÎabË
 
Objeù
 
v®ue
,

152 @
NÚnuÎ
 
Remov®Cau£
 
ÿu£
) {

153 
Œy
 {

154 
P©h
 
·th
 = 
P©hs
.
	`g‘
(
logDœP©h
, 
key
);

155 
Fes
.
	`d–‘eIfExi¡s
(
·th
);

156 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

157 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

161 .
	`maximumSize
(
dsCacheSize
)

162 .
	`bud
();

163 
	}
}

165 
	g´iv©e
 <
	gT
> 
T
 
lßd
(
CÏss
<T> 
tCÏss
, 
SŒšg
 
key
) {

166 
	gŒy
 {

167 
P©h
 
	g·th
 = 
P©hs
.
g‘
(
logDœP©h
, 
key
 + 
EXTENSION
);

168 ià(
	gFes
.
nÙExi¡s
(
·th
)) {

169  
	gnuÎ
;

171 
	gby‹
[] 
	gby‹s
 = 
Fes
.
»adAÎBy‹s
(
·th
);

172 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
w¿p
(
by‹s
);

173 
	gchecksum
 = 
buf
.
g‘IÁ
();

174 
	gby‹
[] 
	g¡rBy‹s
 = 
A¼ays
.
cİyOfRªge
(
by‹s
, 4, by‹s.
Ëngth
);

175 ià(
	gchecksum
 !ğ
g‘Checksum
(
¡rBy‹s
)) {

176 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
();

179 
SŒšg
 
	gjsÚ
 = 
Ãw
 SŒšg(
¡rBy‹s
);

180 
T
 
	gv®
 = 
JsÚUts
.
·r£r
.
äomJsÚ
(
jsÚ
, 
tCÏss
);

181  
	gv®
;

182 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

183 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

191 
´iv©e
 
	eNuÎV®ue
 {

192 
	gNULL_VALUE


195 @
Ov”ride


196 
public
 
	gsynchrÚized
 <
	gT
> 
put
(
KvRecÜd
<
T
> 
key
, T 
v®ue
) {

197 
	gÿche
.
put
(
key
.
g‘FuÎKeyName
(), 
v®ue
);

200 @
Ov”ride


201 
public
 
	gsynchrÚized
 <
	gT
> 
T
 
g‘
(
KvRecÜd
<T> 
key
) {

202 
SŒšg
 
	g·th
 = 
key
.
g‘FuÎKeyName
();

203 
Objeù
 
	gv®
 = 
ÿche
.
g‘
(
·th
, 
k
 -> {

204 ià(!
šMem
) {

205 
T
 
lßdedV®
 = 
lßd
(
key
.
g‘D©aTy³
(), 
·th
);

206 ià(
lßdedV®
 !ğ
nuÎ
) {

207  
lßdedV®
;

213  
NuÎV®ue
.
NULL_VALUE
;

216  
	gv®
 =ğ
NuÎV®ue
.
NULL_VALUE
 ? 
nuÎ
 : (
T
è
v®
;

219 @
Ov”ride


220 
	gpublic
 <
	gT
> 
T
 
g‘
(
KvRecÜd
<T> 
key
, T 
deçuÉV®ue
) {

221 
T
 
	gv®ue
 = 
g‘
(
key
);

222  
	gv®ue
 =ğ
nuÎ
 ? 
deçuÉV®ue
 : 
v®ue
;

225 @
Ov”ride


226 
public
 
	gsynchrÚized
 <
	gT
> 
d–‘e
(
KvRecÜd
<
T
> 
key
) {

227 
	gÿche
.
šv®id©e
(
key
.
g‘FuÎKeyName
());

	@infrastructure/src/main/java/org/corfudb/infrastructure/datastore/KvDataStore.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

16 
public
 
š‹rçû
 
	gKvD©aStÜe
 {

24 <
	gT
> 
put
(
KvRecÜd
<
T
> 
key
, T 
v®ue
);

32 <
	gT
> 
T
 
g‘
(
KvRecÜd
<T> 
key
);

42 <
	gT
> 
T
 
g‘
(
KvRecÜd
<T> 
key
, T 
deçuÉV®ue
);

49 <
	gT
> 
d–‘e
(
KvRecÜd
<
T
> 
key
);

56 @
	gAÎArgsCÚ¡ruùÜ


57 @
G‘‹r


58 
şass
 
	gKvRecÜd
<
	gT
> {

62 
´iv©e
 
fš®
 
SŒšg
 
	g´efix
;

66 
´iv©e
 
fš®
 
SŒšg
 
	gkey
;

70 
´iv©e
 
fš®
 
	gCÏss
<
	gT
> 
	gd©aTy³
;

80 
public
 <
	gR
> 
	gKvRecÜd
<R> 
of
(
SŒšg
 
´efix
, SŒšg 
key
, 
CÏss
<
R
> 
d©aTy³
) {

81  
Ãw
 
	gKvRecÜd
<>(
	g´efix
, 
	gkey
, 
	gd©aTy³
);

91 
public
 <
	gR
> 
	gKvRecÜd
<R> 
of
(
SŒšg
 
key
, 
CÏss
<
R
> 
d©aTy³
) {

92  
of
("", 
key
, 
d©aTy³
);

95 
public
 
SŒšg
 
g‘FuÎKeyName
() {

96  
	g´efix
 + "_" + 
	gkey
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/AddressMetaData.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

6 
public
 cÏs 
	cAdd»ssM‘aD©a
 {

7 
public
 
fš®
 
	mchecksum
;

8 
public
 
fš®
 
	mËngth
;

9 
public
 
fš®
 
	moff£t
;

18 
public
 
	$Add»ssM‘aD©a
(
checksum
, 
Ëngth
, 
off£t
) {

19 
this
.
checksum
 = checksum;

20 
this
.
Ëngth
 =†ength;

21 
this
.
off£t
 = offset;

23 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/InMemoryStreamLog.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

4 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

25 @
Slf4j


26 
public
 
şass
 
InMemÜySŒ—mLog
 
im¶em’ts
 
	gSŒ—mLog
, 
	gSŒ—mLogW™hRªkedAdd»ssS·û
 {

28 
´iv©e
 
	gM­
<
	gLÚg
, 
	gLogD©a
> 
	glogCache
;

29 
´iv©e
 
fš®
 
	gS‘
<
	gLÚg
> 
	gŒimmed
;

30 
´iv©e
 vŞ©
	g¡¬tšgAdd»ss
;

31 
´iv©e
 vŞ©
LogM‘ad©a
 
	glogM‘ad©a
;

36 
public
 
InMemÜySŒ—mLog
() {

37 
	glogCache
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

38 
	gŒimmed
 = 
CÚcu¼’tHashM­
.
ÃwKeyS‘
();

39 
	g¡¬tšgAdd»ss
 = 0;

40 
	glogM‘ad©a
 = 
Ãw
 
LogM‘ad©a
();

43 @
Ov”ride


44 
public
 
synchrÚized
 
­³nd
(
Li¡
<
LogD©a
> 
’Œ›s
) {

45 
LogD©a
 
	g’Œy
 : 
’Œ›s
) {

46 ià(
isTrimmed
(
’Œy
.
g‘Glob®Add»ss
()è|| 
logCache
.
cÚšsKey
(entry.getGlobalAddress())) {

50 
	glogCache
.
put
(
’Œy
.
g‘Glob®Add»ss
(),ƒntry);

51 
	glogM‘ad©a
.
upd©e
(
’Œy
, 
çl£
);

55 @
Ov”ride


56 
public
 
synchrÚized
 
­³nd
(
add»ss
, 
LogD©a
 
’Œy
) {

57 if(
isTrimmed
(
add»ss
)) {

58 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
TRIM
);

61 ià(
	glogCache
.
cÚšsKey
(
add»ss
)) {

62 
throwLogUn™Exû±iÚsIfNeûs§ry
(
add»ss
, 
’Œy
);

64 
	glogCache
.
put
(
add»ss
, 
’Œy
);

65 
	glogM‘ad©a
.
upd©e
(
’Œy
, 
çl£
);

68 
´iv©e
 
boŞ—n
 
isTrimmed
(
add»ss
) {

69  
	gadd»ss
 < 
	g¡¬tšgAdd»ss
 || 
	gŒimmed
.
cÚšs
(
add»ss
);

72 @
Ov”ride


73 
public
 
synchrÚized
 
´efixTrim
(
add»ss
) {

74 ià(
isTrimmed
(
add»ss
)) {

75 
	glog
.
w¬n
("´efixTrim: IgnÜšg„•—‹drim {}", 
add»ss
);

77 
	g¡¬tšgAdd»ss
 = 
add»ss
 + 1;

80 
	glogM‘ad©a
.
´efixTrim
(
add»ss
);

84 @
Ov”ride


85 
public
 
synchrÚized
 
TasRe¥Ú£
 
g‘Tas
(
Li¡
<
UUID
> 
¡»ams
) {

86 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gs
 = 
Ãw
 
HashM­
<>(
¡»ams
.
size
());

87 
UUID
 
	g¡»am
: 
¡»ams
) {

88 
s
.
put
(
¡»am
, 
logM‘ad©a
.
g‘SŒ—mTas
().
g‘
(stream));

90  
Ãw
 
TasRe¥Ú£
(
logM‘ad©a
.
g‘Glob®Ta
(), 
s
);

93 @
Ov”ride


94 
public
 
synchrÚized
 
g‘LogTa
() {

95  
	glogM‘ad©a
.
g‘Glob®Ta
();

98 @
Ov”ride


99 
public
 
synchrÚized
 
TasRe¥Ú£
 
g‘AÎTas
() {

100 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gs
 = 
Ãw
 
HashM­
<>(
logM‘ad©a
.
g‘SŒ—mTas
().
size
());

101 
	gM­
.
	gEÁry
<
	gUUID
, 
	gLÚg
> 
	g’Œy
 : 
logM‘ad©a
.
g‘SŒ—mTas
().
’ŒyS‘
()) {

102 
s
.
put
(
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
());

104  
Ãw
 
TasRe¥Ú£
(
logM‘ad©a
.
g‘Glob®Ta
(), 
s
);

107 @
Ov”ride


108 
public
 
synchrÚized
 
SŒ—msAdd»ssRe¥Ú£
 
g‘SŒ—msAdd»ssS·û
() {

109  
Ãw
 
SŒ—msAdd»ssRe¥Ú£
(
logM‘ad©a
.
g‘Glob®Ta
(),†ogM‘ad©a.
g‘SŒ—msAdd»ssS·ûM­
());

112 @
Ov”ride


113 
public
 
g‘TrimM¬k
() {

114  
	g¡¬tšgAdd»ss
;

117 
´iv©e
 
throwLogUn™Exû±iÚsIfNeûs§ry
(
add»ss
, 
LogD©a
 
’Œy
) {

118 ià(
	g’Œy
.
g‘Rªk
(è=ğ
nuÎ
) {

119 
Ov”wr™eCau£
 
ov”wr™eCau£
 = 
g‘Ov”wr™eCau£FÜAdd»ss
(
add»ss
, 
’Œy
);

120 
	glog
.
Œaû
("throwLogUn™Exû±iÚsIfNeûs§ry: ov”wr™‹Àexû±iÚ fÜ‡dd»s {}, cau£: {}", 
add»ss
, 
ov”wr™eCau£
);

121 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
ov”wr™eCau£
);

124 
as£¹Aµ’dP”m™‹dUn§ã
(
add»ss
, 
’Œy
);

136 @
Ov”ride


137 
public
 
	gS‘
<
	gLÚg
> 
g‘KnownAdd»s£sInRªge
(
¿ngeS¹
, 
¿ngeEnd
) {

139 
	gS‘
<
	gLÚg
> 
	g»suÉ
 = 
Ãw
 
HashS‘
<>();

140 
	gadd»ss
 = 
¿ngeS¹
;‡dd»s <ğ
¿ngeEnd
;‡ddress++) {

141 ià(
	glogCache
.
cÚšsKey
(
add»ss
)) {

142 
	g»suÉ
.
add
(
add»ss
);

145  
	g»suÉ
;

148 @
Ov”ride


149 
public
 
LogD©a
 
»ad
(
add»ss
) {

150 ià(
isTrimmed
(
add»ss
)) {

151  
	gLogD©a
.
g‘Trimmed
(
add»ss
);

154  
	glogCache
.
g‘
(
add»ss
);

157 @
Ov”ride


158 
public
 
sync
(
boŞ—n
 
fÜû
){

162 @
Ov”ride


163 
public
 
şo£
() {

164 
	glogCache
 = 
Ãw
 
HashM­
<>();

167 @
Ov”ride


168 
public
 
synchrÚized
 
com·ù
() {

170 
	gadd»ss
 : 
logCache
.
keyS‘
()) {

171 ià(
add»ss
 < 
¡¬tšgAdd»ss
) {

172 
logCache
.
»move
(
add»ss
);

177 
	gadd»ss
 : 
Œimmed
) {

178 
logCache
.
»move
(
add»ss
);

181 
	gadd»ss
 : 
Œimmed
) {

182 ià(
add»ss
 < 
¡¬tšgAdd»ss
) {

183 
Œimmed
.
»move
(
add»ss
);

188 @
Ov”ride


189 
public
 
»£t
() {

190 
	g¡¬tšgAdd»ss
 = 0;

191 
	glogM‘ad©a
 = 
Ãw
 
LogM‘ad©a
();

193 
	gŒimmed
.
ş—r
();

195 
	glogCache
.
ş—r
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/LogMetadata.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gToSŒšg
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

10 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

12 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

26 @
	gNÙTh»adSaã


27 @
	gToSŒšg


28 @
Slf4j


29 
public
 cÏs 
	cLogM‘ad©a
 {

31 @
G‘‹r


32 
´iv©e
 vŞ©
	mglob®Ta
;

34 @
G‘‹r


35 
´iv©e
 
fš®
 
	mM­
<
	mUUID
, 
	mSŒ—mAdd»ssS·û
> 
	m¡»amsAdd»ssS·ûM­
;

37 @
G‘‹r


38 
´iv©e
 
fš®
 
	mM­
<
	mUUID
, 
	mLÚg
> 
	m¡»amTas
;

40 
public
 
	$LogM‘ad©a
() {

41 
this
.
glob®Ta
 = 
Add»ss
.
NON_ADDRESS
;

42 
this
.
¡»amTas
 = 
Ãw
 
HashM­
<>();

43 
this
.
¡»amsAdd»ssS·ûM­
 = 
Ãw
 
HashM­
<>();

46 
public
 
	`upd©e
(
Li¡
<
LogD©a
> 
’Œ›s
) {

47 
LogD©a
 
’Œy
 : 
’Œ›s
) {

52 
	`upd©e
(
’Œy
, 
Œue
);

54 
	}
}

56 
public
 
	$upd©e
(
LogD©a
 
’Œy
, 
boŞ—n
 
š™Ÿlize
) {

57 
’ŒyAdd»ss
 = 
’Œy
.
	`g‘Glob®Add»ss
();

59 
	`upd©eGlob®Ta
(
’ŒyAdd»ss
);

61 
UUID
 
¡»amId
 : 
’Œy
.
	`g‘SŒ—ms
()) {

62 
	`upd©eSŒ—mS·û
(
¡»amId
, 
’ŒyAdd»ss
);

70 ià(
’Œy
.
	`hasCheckpoštM‘ad©a
()) {

71 
	`upd©eFromCheckpošt
(
’Œy
, 
š™Ÿlize
);

73 
	}
}

83 
´iv©e
 
	$upd©eSŒ—mS·û
(
UUID
 
¡»amId
, 
’ŒyAdd»ss
) {

85 
cu¼’tSŒ—mTa
 = 
¡»amTas
.
	`g‘OrDeçuÉ
(
¡»amId
, 
Add»ss
.
NON_ADDRESS
);

86 
¡»amTas
.
	`put
(
¡»amId
, 
M©h
.
	`max
(
cu¼’tSŒ—mTa
, 
’ŒyAdd»ss
));

89 
¡»amsAdd»ssS·ûM­
.
	`compu‹
(
¡»amId
, (
id
, 
add»ssS·û
) -> {

90 ià(
add»ssS·û
 =ğ
nuÎ
) {

91 
Rßršg64NavigabËM­
 
add»ssM­
 = 
Ãw
 
	`Rßršg64NavigabËM­
();

92 
add»ssM­
.
	`addLÚg
(
’ŒyAdd»ss
);

96  
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_EXIST
, 
add»ssM­
);

98 
add»ssS·û
.
	`addAdd»ss
(
’ŒyAdd»ss
);

99  
add»ssS·û
;

101 
	}
}

112 
´iv©e
 
	$upd©eFromCheckpošt
(
LogD©a
 
’Œy
, 
boŞ—n
 
š™Ÿlize
) {

113 
UUID
 
¡»amId
 = 
’Œy
.
	`g‘Checkpoš‹dSŒ—mId
();

114 
Ï¡Upd©eToSŒ—m
 = 
’Œy
.
	`g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
();

116 ià(
Add»ss
.
	`isAdd»ss
(
Ï¡Upd©eToSŒ—m
)) {

118 
cu¼’tSŒ—mTa
 = 
¡»amTas
.
	`g‘OrDeçuÉ
(
¡»amId
, 
Add»ss
.
NON_ADDRESS
);

119 
¡»amTas
.
	`put
(
¡»amId
, 
M©h
.
	`max
(
cu¼’tSŒ—mTa
, 
Ï¡Upd©eToSŒ—m
));

124 ià(
š™Ÿlize
) {

133 ià(
’Œy
.
	`g‘CheckpoštTy³
(è=ğ
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
END
) {

134 
¡»amsAdd»ssS·ûM­
.
	`compu‹
(
¡»amId
, (
id
, 
add»ssS·û
) -> {

135 ià(
add»ssS·û
 =ğ
nuÎ
) {

139  
Ãw
 
	`SŒ—mAdd»ssS·û
(
Ï¡Upd©eToSŒ—m
,‚ew 
	`Rßršg64NavigabËM­
());

143 
add»ssS·û
.
	`£tTrimM¬k
(
LÚg
.
	`max
×dd»ssS·û.
	`g‘TrimM¬k
(), 
Ï¡Upd©eToSŒ—m
));

144  
add»ssS·û
;

149 
	}
}

151 
public
 
	$upd©eGlob®Ta
(
ÃwTa
) {

152 
glob®Ta
 = 
M©h
.
	`max
(glob®Ta, 
ÃwTa
);

153 
	}
}

155 
public
 
	$´efixTrim
(
add»ss
) {

156 
log
.
	`šfo
("´efixTrim:rim sŒ—m‡dd»s m­ u°tØadd»s {}", 
add»ss
);

157 
M­
.
EÁry
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amAdd»ssM­
 : 
¡»amsAdd»ssS·ûM­
.
	`’ŒyS‘
()) {

158 
log
.
	`Œaû
("prefixTrim:rim‡ddress space for stream {} uporim mark {}",

159 
¡»amAdd»ssM­
.
	`g‘Key
(), 
add»ss
);

160 
¡»amAdd»ssM­
.
	`g‘V®ue
().
	`Œim
(
add»ss
);

162 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/MultiReadWriteLock.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

9 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁR—dWr™eLock
;

14 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

15 
impÜt
 
	glombok
.
	gD©a
;

22 
public
 cÏs 
	cMuÉiR—dWr™eLock
 {

25 
´iv©e
 
fš®
 
	mTh»adLoÿl
<
	mLškedLi¡
<
	mLockM‘ad©a
>> 
	mth»adLockReã»nûs
 = 
Ãw
 
Th»adLoÿl
<>();

27 
´iv©e
 
fš®
 
	mCÚcu¼’tHashM­
<
	mLÚg
, 
	mLockReã»nû
> 
	mlocks
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

35 
public
 
AutoClo£abËLock
 
	$acquœeR—dLock
(
fš®
 
LÚg
 
add»ss
) {

36 
	`»gi¡”LockReã»nû
(
add»ss
, 
çl£
);

37 
R“Á¿ÁR—dWr™eLock
 
lock
 = 
	`cÚ¡ruùLockFÜ
(
add»ss
);

38 
fš®
 
R“Á¿ÁR—dWr™eLock
.
R—dLock
 
»adLock
 = 
lock
.
	`»adLock
();

39 
»adLock
.
	`lock
();

40 
AtomicBoŞ—n
 
şo£d
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

42 ià(!
şo£d
.
	`g‘AndS‘
(
Œue
)) {

43 
Œy
 {

44 
»adLock
.
	`uÆock
();

45 
	`ş—rEv’tu®lyLockFÜ
(
add»ss
);

46 } 
fš®ly
 {

47 
	`d”egi¡”LockReã»nû
(
add»ss
, 
çl£
);

60 
public
 
AutoClo£abËLock
 
	$acquœeWr™eLock
(
fš®
 
LÚg
 
add»ss
) {

61 
	`»gi¡”LockReã»nû
(
add»ss
, 
Œue
);

62 
R“Á¿ÁR—dWr™eLock
 
lock
 = 
	`cÚ¡ruùLockFÜ
(
add»ss
);

63 
fš®
 
R“Á¿ÁR—dWr™eLock
.
Wr™eLock
 
wr™eLock
 = 
lock
.
	`wr™eLock
();

64 
wr™eLock
.
	`lock
();

65 
AtomicBoŞ—n
 
şo£d
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

67 ià(!
şo£d
.
	`g‘AndS‘
(
Œue
)) {

68 
Œy
 {

69 
wr™eLock
.
	`uÆock
();

70 
	`ş—rEv’tu®lyLockFÜ
(
add»ss
);

71 } 
fš®ly
 {

72 
	`d”egi¡”LockReã»nû
(
add»ss
, 
Œue
);

76 
	}
}

78 
´iv©e
 
R“Á¿ÁR—dWr™eLock
 
	$cÚ¡ruùLockFÜ
(
LÚg
 
Çme
) {

79  
locks
.
	`compu‹
(
Çme
, (
key
, 
»f
) -> {

80 ià(
»f
 =ğ
nuÎ
) {

81 
»f
 = 
Ãw
 
	`LockReã»nû
Òew 
	`R“Á¿ÁR—dWr™eLock
());

83 
»f
.
»ã»nûCouÁ
++;

84  
»f
;

86 ).
	`g‘Lock
();

87 
	}
}

89 
´iv©e
 
	$ş—rEv’tu®lyLockFÜ
(
LÚg
 
Çme
) {

90 
locks
.
	`compu‹
(
Çme
, (
unu£dLÚg
, 
»f
) -> {

91 ià(
»f
 =ğ
nuÎ
) {

92 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Lock i wrÚgly u£d " + 
»f
 + " "

93 + 
Sy¡em
.
	`id’t™yHashCode
(
Th»ad
.
	`cu¼’tTh»ad
()));

95 
»f
.
»ã»nûCouÁ
--;

96 ià(
»f
.
	`g‘Reã»nûCouÁ
() == 0) {

97  
nuÎ
;

99  
»f
;

102 
	}
}

105 
´iv©e
 
	$»gi¡”LockReã»nû
(
add»ss
, 
boŞ—n
 
wr™eLock
) {

106 
LškedLi¡
<
LockM‘ad©a
> 
th»adLocks
 = 
th»adLockReã»nûs
.
	`g‘
();

107 ià(
th»adLocks
 =ğ
nuÎ
) {

108 
th»adLocks
 = 
Ãw
 
LškedLi¡
<>();

109 
th»adLockReã»nûs
.
	`£t
(
th»adLocks
);

111 
LockM‘ad©a
 
Ï¡
 = 
th»adLocks
.
	`g‘La¡
();

112 ià(
Ï¡
.
	`g‘Add»ss
(è> 
add»ss
) {

113 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("WrÚg†ock‡cquis™iÚ ord” " + 
Ï¡
.
	`g‘Add»ss
()

114 + " > " + 
add»ss
);

116 ià(
wr™eLock
) {

117 ià(
Ï¡
.
	`g‘Add»ss
(è=ğ
add»ss
 && !Ï¡.
	`isWr™eLock
()) {

118 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Write†ock inhe scope of„ead†ock for "

119 + 
add»ss
);

123 
th»adLocks
.
	`add
(
Ãw
 
	`LockM‘ad©a
(
add»ss
, 
wr™eLock
));

124 
	}
}

126 
´iv©e
 
	$d”egi¡”LockReã»nû
(
add»ss
, 
boŞ—n
 
wr™eLock
) {

127 
LškedLi¡
<
LockM‘ad©a
> 
th»adLocks
 = 
th»adLockReã»nûs
.
	`g‘
();

128 
LockM‘ad©a
 
Ï¡
 = 
th»adLocks
.
	`»moveLa¡
();

129 ià(
Ï¡
.
	`g‘Add»ss
(è!ğ
add»ss
 ||†a¡.
wr™eLock
 != writeLock) {

130 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Wrong unlocking order");

132 ià(
th»adLocks
.
	`isEm±y
()) {

133 
th»adLockReã»nûs
.
	`£t
(
nuÎ
);

135 
	}
}

137 
public
 
š‹rçû
 
AutoClo£abËLock
 
ex‹nds
 
	gAutoClo£abË
 {

138 @
Ov”ride


139 
şo£
();

143 @
	gD©a


144 @
AÎArgsCÚ¡ruùÜ


145 
´iv©e
 cÏs 
	cLockM‘ad©a
 {

146 
´iv©e
 
	gadd»ss
;

147 
´iv©e
 
boŞ—n
 
	gwr™eLock
;

150 @
D©a


151 
´iv©e
 cÏs 
	cLockReã»nû
 {

152 
´iv©e
 
R“Á¿ÁR—dWr™eLock
 
	glock
;

153 
´iv©e
 
	g»ã»nûCouÁ
;

155 
public
 
LockReã»nû
(
R“Á¿ÁR—dWr™eLock
 
lock
) {

156 
	gthis
.
	glock
 = 
lock
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/SegmentHandle.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gIOUts
;

8 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

9 
impÜt
 
	gjava
.
	gnio
.
	gchªÃls
.
	gFeChªÃl
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

11 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

12 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

23 @
	gSlf4j


24 @
D©a


25 şas 
	cSegm’tHªdË
 {

26 
fš®
 
	m£gm’t
;

28 @
NÚNuÎ


29 
fš®
 
FeChªÃl
 
	mwr™eChªÃl
;

31 @
NÚNuÎ


32 
fš®
 
FeChªÃl
 
	m»adChªÃl
;

34 @
NÚNuÎ


35 
SŒšg
 
	mfeName
;

37 
´iv©e
 
fš®
 
	mM­
<
	mLÚg
, 
	mAdd»ssM‘aD©a
> 
	mknownAdd»s£s
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

38 
´iv©e
 
fš®
 
	mS‘
<
	mLÚg
> 
	mŒimmedAdd»s£s
 = 
CŞËùiÚs
.
ÃwS‘FromM­
(
Ãw
 
CÚcu¼’tHashM­
<>());

39 
´iv©e
 
fš®
 
	mS‘
<
	mLÚg
> 
	m³ndšgTrims
 = 
CŞËùiÚs
.
ÃwS‘FromM­
(
Ãw
 
CÚcu¼’tHashM­
<>());

40 
´iv©e
 vŞ©
	m»fCouÁ
 = 0;

43 
public
 
synchrÚized
 
	$»š
() {

44 
»fCouÁ
++;

47 
public
 
synchrÚized
 
	$»Ëa£
() {

48 ià(
»fCouÁ
 == 0) {

49 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("»fCouÁ cªnÙ bËs thª 0, segm’ˆ" + 
£gm’t
);

51 
»fCouÁ
--;

52 
	}
}

54 
public
 
	$şo£
() {

55 
S‘
<
FeChªÃl
> 
chªÃls
 = 
Ãw
 
HashS‘
<>(

56 
A¼ays
.
	`asLi¡
(
wr™eChªÃl
, 
»adChªÃl
)

59 
FeChªÃl
 
chªÃl
 : 
chªÃls
) {

60 
Œy
 {

61 
chªÃl
.
	`fÜû
(
Œue
);

62 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

63 
log
.
	`debug
("Cª'ˆfÜû upd©e šhchªÃl", 
e
.
	`g‘Mes§ge
());

64 } 
fš®ly
 {

65 
IOUts
.
	`şo£Qu›y
(
chªÃl
);

68 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLog.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

19 
public
 
š‹rçû
 
	gSŒ—mLog
 {

26 
­³nd
(
add»ss
, 
LogD©a
 
’Œy
);

35 
­³nd
(
Li¡
<
LogD©a
> 
’Œ›s
);

42 
LogD©a
 
»ad
(
add»ss
);

48 
´efixTrim
(
add»ss
);

53 
com·ù
();

58 
TasRe¥Ú£
 
g‘Tas
(
Li¡
<
UUID
> 
¡»ams
);

63 
g‘LogTa
();

68 
TasRe¥Ú£
 
g‘AÎTas
();

73 
SŒ—msAdd»ssRe¥Ú£
 
g‘SŒ—msAdd»ssS·û
();

78 
g‘TrimM¬k
();

88 
	gS‘
<
	gLÚg
> 
g‘KnownAdd»s£sInRªge
(
¿ngeS¹
, 
¿ngeEnd
);

95 
sync
(
boŞ—n
 
fÜû
è
throws
 
	gIOExû±iÚ
;

100 
şo£
();

105 
»£t
();

114  
Ov”wr™eCau£
 
g‘Ov”wr™eCau£FÜAdd»ss
(
add»ss
, 
LogD©a
 
’Œy
) {

115 
LogD©a
 
	gcu¼’tEÁry
 = 
»ad
(
add»ss
);

116 
Ov”wr™eCau£
 
	gÿu£
 = Ov”wr™eCau£.
DIFF_DATA
;

118 ià(
	gcu¼’tEÁry
 !ğ
nuÎ
) {

119 ià(
cu¼’tEÁry
.
isHŞe
()) {

120 
ÿu£
 = 
Ov”wr™eCau£
.
HOLE
;

121 } ià(
	g’Œy
.
g‘D©a
(è!ğ
nuÎ
 && 
cu¼’tEÁry
.getData() !=‚ull &&

122 
cu¼’tEÁry
.
g‘D©a
().
Ëngth
 =ğ
’Œy
.getData().length) {

127 
ÿu£
 = 
Ov”wr™eCau£
.
SAME_DATA
;

132 
	gÿu£
 = 
Ov”wr™eCau£
.
NONE
;

134  
	gÿu£
;

140  
boŞ—n
 
quÙaExûeded
() {

141  
	gçl£
;

148  
quÙaLim™InBy‹s
() {

149  
	gLÚg
.
	gMAX_VALUE
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogCompaction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

11 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdFutu»
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

23 @
Slf4j


24 
public
 cÏs 
	cSŒ—mLogCom·ùiÚ
 {

25 
fš®
 
SŒšg
 
	mSTREAM_COMPACT_METRIC
 = 
CÜfuCompÚ’t
.
INFRA_STREAM_OPS
 + "compaction";

27 
´iv©e
 
fš®
 
Th»adFaùÜy
 
	mth»adFaùÜy
 = 
Ãw
 
Th»adFaùÜyBud”
()

28 .
£tD«mÚ
(
Œue
)

29 .
£tNameFÜm©
("LogUnit-Maintenance-%d")

30 .
bud
();

35 
´iv©e
 
fš®
 
Tim”
 
	mcom·ùiÚTim”
 = 
S”v”CÚ‹xt
.
g‘M‘rics
().
tim”
(
STREAM_COMPACT_METRIC
);

40 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	mscheduËr
 = 
ExecutÜs
.
ÃwSšgËTh»adScheduËdExecutÜ
(
th»adFaùÜy
);

41 
´iv©e
 
fš®
 
	mScheduËdFutu»
<?> 
	mcom·ùÜ
;

42 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mshutdownTim”
;

44 
public
 
	$SŒ—mLogCom·ùiÚ
(
SŒ—mLog
 
¡»amLog
, 
š™ŸlD–ay
, 
³riod
, 
TimeUn™
 
timeUn™
,

45 
Du¿tiÚ
 
shutdownTim”
) {

46 
this
.
shutdownTim”
 = shutdownTimer;

47 
RuÂabË
 
sk
 = () -> {

48 
log
.
	`debug
("Start†og compaction.");

49 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
com·ùiÚTim”
)){

50 
¡»amLog
.
	`com·ù
();

51 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

52 
log
.
	`”rÜ
("Cª'ˆcom·ù sŒ—m†og.", 
ex
);

55 
com·ùÜ
 = 
scheduËr
.
	`scheduËW™hFixedD–ay
(
sk
, 
š™ŸlD–ay
, 
³riod
, 
timeUn™
);

58 
public
 
	$shutdown
() {

59 
com·ùÜ
.
	`ÿnûl
(
Œue
);

60 
scheduËr
.
	`shutdownNow
();

61 
Œy
 {

62 
scheduËr
.
	`awa™T”mš©iÚ
(
shutdownTim”
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

63 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

64 
log
.
	`debug
("SŒ—m†og com·ùiÚ,‡wa™T”mš©iÚ iÁ”ru±ed : {}", 
›
);

65 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

67 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogDataStore.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gKvD©aStÜe
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gKvD©aStÜe
.
	gKvRecÜd
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

17 @
	gBud”


18 @
Slf4j


19 
public
 cÏs 
	cSŒ—mLogD©aStÜe
 {

20 
´iv©e
 
fš®
 
SŒšg
 
	mTAIL_SEGMENT_PREFIX
 = "TAIL_SEGMENT";

21 
public
 
fš®
 
SŒšg
 
	mTAIL_SEGMENT_KEY
 = "CURRENT";

23 
public
 
fš®
 
SŒšg
 
	mSTARTING_ADDRESS_PREFIX
 = "STARTING_ADDRESS";

24 
public
 
fš®
 
SŒšg
 
	mSTARTING_ADDRESS_KEY
 = "CURRENT";

26 
public
 
fš®
 
	mKvRecÜd
<
	mLÚg
> 
	mTAIL_SEGMENT_RECORD
 = 
Ãw
 
KvRecÜd
<>(

27 
TAIL_SEGMENT_PREFIX
, 
	mTAIL_SEGMENT_KEY
, 
	mLÚg
.
	mşass


30 
public
 
fš®
 
	mKvRecÜd
<
	mLÚg
> 
	mSTARTING_ADDRESS_RECORD
 = 
Ãw
 
KvRecÜd
<>(

31 
STARTING_ADDRESS_PREFIX
, 
	mSTARTING_ADDRESS_KEY
, 
	mLÚg
.
	mşass


34 
´iv©e
 
fš®
 
	mZERO_ADDRESS
 = 0L;

36 @
NÚNuÎ


37 
´iv©e
 
fš®
 
KvD©aStÜe
 
	md©aStÜe
;

42 
´iv©e
 
fš®
 
AtomicLÚg
 
	m¡¬tšgAdd»ss
 = 
Ãw
 AtomicLÚg(
Add»ss
.
NON_ADDRESS
);

46 
´iv©e
 
fš®
 
AtomicLÚg
 
	mSegm’t
 = 
Ãw
 AtomicLÚg(
Add»ss
.
NON_ADDRESS
);

53 
public
 
	$g‘TaSegm’t
() {

54 ià(
Segm’t
.
	`g‘
(è=ğ
Add»ss
.
NON_ADDRESS
) {

55 
Segm’t
.
	`£t
(
d©aStÜe
.
	`g‘
(
TAIL_SEGMENT_RECORD
, 
ZERO_ADDRESS
));

58  
Segm’t
.
	`g‘
();

66 
public
 
	$upd©eTaSegm’t
(
ÃwTaSegm’t
) {

67 ià(
Segm’t
.
	`g‘
(è>ğ
ÃwTaSegm’t
) {

68 
log
.
	`Œaû
("Newa segm’ˆËs thª o¸equ® tØthŞd oÃ: {}. IgnÜe", 
ÃwTaSegm’t
);

72 
log
.
	`debug
("Upd© segm’ˆto: {}", 
ÃwTaSegm’t
);

73 
d©aStÜe
.
	`put
(
TAIL_SEGMENT_RECORD
, 
ÃwTaSegm’t
);

74 
Segm’t
.
	`£t
(
ÃwTaSegm’t
);

75 
	}
}

82 
public
 
	$g‘S¹šgAdd»ss
() {

83 ià(
¡¬tšgAdd»ss
.
	`g‘
(è=ğ
Add»ss
.
NON_ADDRESS
) {

84 
¡¬tšgAdd»ss
.
	`£t
(
d©aStÜe
.
	`g‘
(
STARTING_ADDRESS_RECORD
, 
ZERO_ADDRESS
));

87  
¡¬tšgAdd»ss
.
	`g‘
();

88 
	}
}

95 
public
 
	$upd©eS¹šgAdd»ss
(
ÃwS¹šgAdd»ss
) {

96 
log
.
	`šfo
("Upd©¡¬tšg‡dd»s to: {}", 
ÃwS¹šgAdd»ss
);

98 
d©aStÜe
.
	`put
(
STARTING_ADDRESS_RECORD
, 
ÃwS¹šgAdd»ss
);

99 
¡¬tšgAdd»ss
.
	`£t
(
ÃwS¹šgAdd»ss
);

100 
	}
}

105 
public
 
	$»£tTaSegm’t
() {

106 
log
.
	`šfo
("Re£ˆ segm’t. Cu¼’ˆ£gm’t: {}", 
Segm’t
.
	`g‘
());

107 
d©aStÜe
.
	`put
(
TAIL_SEGMENT_RECORD
, 
ZERO_ADDRESS
);

108 
Segm’t
.
	`£t
(
ZERO_ADDRESS
);

109 
	}
}

114 
public
 
	$»£tS¹šgAdd»ss
() {

115 
log
.
	`šfo
("Re£ˆ¡¬tšg‡dd»ss. Cu¼’ˆadd»ss: {}", 
¡¬tšgAdd»ss
.
	`g‘
());

116 
d©aStÜe
.
	`put
(
STARTING_ADDRESS_RECORD
, 
ZERO_ADDRESS
);

117 
¡¬tšgAdd»ss
.
	`£t
(
ZERO_ADDRESS
);

118 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogFiles.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	ghash
.
	gHash”
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	ghash
.
	gHashšg
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAb¡¿ùMes§ge
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

13 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gIOUts
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogEÁry
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gLogH—d”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gM‘ad©a
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gResourûQuÙa
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLogUn™Exû±iÚ
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

33 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

34 
impÜt
 
	gjava
.
	gio
.
	gFe
;

35 
impÜt
 
	gjava
.
	gio
.
	gFeF‹r
;

36 
impÜt
 
	gjava
.
	gio
.
	gFeNÙFoundExû±iÚ
;

37 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

38 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

39 
impÜt
 
	gjava
.
	gnio
.
	gchªÃls
.
	gFeChªÃl
;

40 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeAÌ—dyExi¡sExû±iÚ
;

41 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeStÜe
;

42 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeSy¡ems
;

43 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeVis™ResuÉ
;

44 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

45 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

46 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

47 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSim¶eFeVis™Ü
;

48 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSnd¬dO³nO±iÚ
;

49 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	g©Œibu‹
.
	gBasicFeA‰ribu‹s
;

50 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

51 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

52 
impÜt
 
	gjava
.
	gut
.
	gEnumS‘
;

53 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

54 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

55 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

56 
impÜt
 
	gjava
.
	gut
.
	gM­
;

57 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

58 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

59 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

60 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

61 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

62 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

63 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

65 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	guts
.
	gP”si¡’û
.
	gsyncDœeùÜy
;

75 @
Slf4j


76 
public
 
şass
 
SŒ—mLogFes
 
im¶em’ts
 
	gSŒ—mLog
, 
	gSŒ—mLogW™hRªkedAdd»ssS·û
 {

78 
public
 
fš®
 
	gMETADATA_SIZE
 = 
M‘ad©a
.
ÃwBud”
()

79 .
£tL’gthChecksum
(-1)

80 .
£tPaylßdChecksum
(-1)

81 .
£tL’gth
(-1)

82 .
bud
()

83 .
g‘S”ŸlizedSize
();

84 
public
 
fš®
 
	gVERSION
 = 2;

85 
public
 
fš®
 
	gRECORDS_PER_LOG_FILE
 = 10000;

86 
´iv©e
 
fš®
 
P©h
 
	glogDœ
;

87 
´iv©e
 
fš®
 
boŞ—n
 
	gv”ify
;

89 
´iv©e
 
fš®
 
SŒ—mLogD©aStÜe
 
	gd©aStÜe
;

91 
´iv©e
 
	gCÚcu¼’tM­
<
	gSŒšg
, 
	gSegm’tHªdË
> 
	gwr™eChªÃls
;

92 
´iv©e
 
fš®
 
	gS‘
<
	gFeChªÃl
> 
	gchªÃlsToSync
;

93 
´iv©e
 
fš®
 
MuÉiR—dWr™eLock
 
	g£gm’tLocks
 = 
Ãw
 MultiReadWriteLock();

100 
´iv©e
 
LogM‘ad©a
 
	glogM‘ad©a
;

104 
´iv©e
 
fš®
 
	glogSizeLim™
;

107 
´iv©e
 
ResourûQuÙa
 
	glogSizeQuÙa
;

116 
public
 
SŒ—mLogFes
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
, 
boŞ—n
 
noV”ify
) {

117 
	glogDœ
 = 
P©hs
.
g‘
(
£rv”CÚ‹xt
.
g‘S”v”CÚfig
().g‘("--log-·th").
toSŒšg
(), "log");

118 
	gwr™eChªÃls
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

119 
	gchªÃlsToSync
 = 
Ãw
 
HashS‘
<>();

120 
	gthis
.
	gv”ify
 = !
noV”ify
;

121 
	gthis
.
	gd©aStÜe
 = 
SŒ—mLogD©aStÜe
.
bud”
().
d©aStÜe
(
£rv”CÚ‹xt
.
g‘D©aStÜe
()).
bud
();

123 
SŒšg
 
	glogSizeLim™P”ûÁageP¬am
 = (SŒšgè
£rv”CÚ‹xt
.
g‘S”v”CÚfig
().
g‘
("--log-size-quota-percentage");

124 
fš®
 
	glogSizeLim™P”ûÁage
 = 
DoubË
.
·r£DoubË
(
logSizeLim™P”ûÁageP¬am
);

125 ià(
	glogSizeLim™P”ûÁage
 < 0.0 || 100.0 <†ogSizeLimitPercentage) {

126 
SŒšg
 
	gmsg
 = SŒšg.
fÜm©
("Invalid quota: quota(%f)%% must be between 0-100%%",

127 
logSizeLim™P”ûÁage
);

128 
throw
 
Ãw
 
LogUn™Exû±iÚ
(
msg
);

131 
	gfeSy¡emC­ac™y
 = 
š™SŒ—mLogDœeùÜy
();

132 
	glogSizeLim™
 = (è(
feSy¡emC­ac™y
 * 
logSizeLim™P”ûÁage
 / 100.0);

134 
	gš™ŸlLogSize
 = 
e¡im©eSize
(
logDœ
);

135 
	glog
.
šfo
("SŒ—mLogFes: {} sizi {} by‹s,†im™ {}", 
logDœ
, 
š™ŸlLogSize
, 
logSizeLim™
);

136 
	glogSizeQuÙa
 = 
Ãw
 
ResourûQuÙa
("LogSizeQuÙa", 
logSizeLim™
);

137 
	glogSizeQuÙa
.
cÚsume
(
š™ŸlLogSize
);

139 
v”ifyLogs
();

142 
	glogM‘ad©a
 = 
Ãw
 
LogM‘ad©a
();

143 
š™ŸlizeLogM‘ad©a
();

147 ià(
	gM©h
.
max
(
logM‘ad©a
.
g‘Glob®Ta
(), 0Lè< 
g‘TrimM¬k
()) {

148 
syncTaSegm’t
(
g‘TrimM¬k
() - 1);

152 
´iv©e
 
g‘S¹šgSegm’t
() {

153  
	gd©aStÜe
.
g‘S¹šgAdd»ss
(è/ 
	gRECORDS_PER_LOG_FILE
;

160 
´iv©e
 
š™SŒ—mLogDœeùÜy
() {

161 
	gfeSy¡emC­ac™y
;

163 
	gŒy
 {

164 ià(!
	glogDœ
.
toFe
().
exi¡s
()) {

165 
	gFes
.
ü—‹DœeùÜ›s
(
logDœ
);

168 
SŒšg
 
	gcÜfuDœ
 = 
logDœ
.
g‘P¬’t
().
toSŒšg
();

169 
FeStÜe
 
	gcÜfuDœBack’d
 = 
Fes
.
g‘FeStÜe
(
P©hs
.
g‘
(
cÜfuDœ
));

171 
Fe
 
	gcÜfuDœFe
 = 
Ãw
 Fe(
cÜfuDœ
);

172 ià(!
	gcÜfuDœFe
.
ÿnWr™e
()) {

173 
throw
 
Ãw
 
LogUn™Exû±iÚ
("CÜfu dœeùÜy i nÙ wr™abË " + 
cÜfuDœ
);

176 
Fe
 
	glogDœeùÜy
 = 
Ãw
 Fe(
logDœ
.
toSŒšg
());

177 ià(!
	glogDœeùÜy
.
ÿnWr™e
()) {

178 
throw
 
Ãw
 
LogUn™Exû±iÚ
("SŒ—m†og dœeùÜy‚Ù wr™abË iÀ" + 
cÜfuDœ
);

181 
	gfeSy¡emC­ac™y
 = 
cÜfuDœBack’d
.
g‘TÙ®S·û
();

182 } 
ÿtch
 (
IOExû±iÚ
 
iÛ
) {

183 
throw
 
Ãw
 
LogUn™Exû±iÚ
(
iÛ
);

186 
	glog
.
šfo
("š™SŒ—mLogDœeùÜy: in™Ÿlized {}", 
logDœ
);

187  
	gfeSy¡emC­ac™y
;

197 
´iv©e
 
š™ŸlizeLogM‘ad©a
() {

198 
	g¡¬tšgSegm’t
 = 
g‘S¹šgSegm’t
();

199 
	gSegm’t
 = 
d©aStÜe
.
g‘TaSegm’t
();

201 
	g¡¬t
 = 
Sy¡em
.
cu¼’tTimeMlis
();

206 
	gcu¼’tSegm’t
 = 
Segm’t
; cu¼’tSegm’ˆ>ğ
¡¬tšgSegm’t
; currentSegment--) {

207 
Segm’tHªdË
 
	g£gm’t
 = 
g‘Segm’tHªdËFÜAdd»ss
(
cu¼’tSegm’t
 * 
RECORDS_PER_LOG_FILE
 + 1);

208 
	gŒy
 {

209 
LÚg
 
	gadd»ss
 : 
£gm’t
.
g‘KnownAdd»s£s
().
keyS‘
()) {

211 ià(
add»ss
 < 
d©aStÜe
.
g‘S¹šgAdd»ss
()) {

214 
LogD©a
 
	glogEÁry
 = 
»ad
(
add»ss
);

215 
	glogM‘ad©a
.
upd©e
(
logEÁry
, 
Œue
);

217 } 
	gfš®ly
 {

218 
	g£gm’t
.
şo£
();

223 
	gwr™eChªÃls
.
ş—r
();

224 
	g’d
 = 
Sy¡em
.
cu¼’tTimeMlis
();

225 
	glog
.
šfo
("š™ŸlizeSŒ—mTas:ook {} m tØlßd {},†og s¹ {}", 
’d
 - 
¡¬t
, 
logM‘ad©a
, 
g‘TrimM¬k
());

236 
public
 
wr™eH—d”
(
FeChªÃl
 
feChªÃl
, 
v”siÚ
, 
boŞ—n
 
v”ify
è
throws
 
	gIOExû±iÚ
 {

238 
LogH—d”
 
	gh—d”
 = LogH—d”.
ÃwBud”
()

239 .
£tV”siÚ
(
v”siÚ
)

240 .
£tV”ifyChecksum
(
v”ify
)

241 .
bud
();

243 
By‹Bufãr
 
	gbuf
 = 
g‘By‹BufãrW™hM‘aD©a
(
h—d”
);

244 
wr™eBy‹Bufãr
(
feChªÃl
, 
buf
);

245 
	gfeChªÃl
.
fÜû
(
Œue
);

248 
´iv©e
 
M‘ad©a
 
g‘M‘ad©a
(
Ab¡¿ùMes§ge
 
mes§ge
) {

249  
	gM‘ad©a
.
ÃwBud”
()

250 .
£tPaylßdChecksum
(
Checksum
.
g‘Checksum
(
mes§ge
.
toBy‹A¼ay
()))

251 .
£tL’gthChecksum
(
Checksum
.
g‘Checksum
(
mes§ge
.
g‘S”ŸlizedSize
()))

252 .
£tL’gth
(
mes§ge
.
g‘S”ŸlizedSize
())

253 .
bud
();

256 
´iv©e
 
By‹Bufãr
 
g‘By‹Bufãr
(
M‘ad©a
 
m‘ad©a
, 
Ab¡¿ùMes§ge
 
mes§ge
) {

257 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
®loÿ‹
(
m‘ad©a
.
g‘S”ŸlizedSize
(è+ 
mes§ge
.getSerializedSize());

258 
	gbuf
.
put
(
m‘ad©a
.
toBy‹A¼ay
());

259 
	gbuf
.
put
(
mes§ge
.
toBy‹A¼ay
());

260 
	gbuf
.
æ
();

261  
	gbuf
;

264 @
VisibËFÜTe¡šg


265 
public
 
By‹Bufãr
 
g‘By‹BufãrW™hM‘aD©a
(
Ab¡¿ùMes§ge
 
mes§ge
) {

266 
M‘ad©a
 
	gm‘ad©a
 = 
g‘M‘ad©a
(
mes§ge
);

267  
g‘By‹Bufãr
(
m‘ad©a
, 
mes§ge
);

270 @
Ov”ride


271 
public
 
boŞ—n
 
quÙaExûeded
() {

272  !
	glogSizeQuÙa
.
hasAvaabË
();

275 @
Ov”ride


276 
public
 
quÙaLim™InBy‹s
() {

277  
	glogSizeQuÙa
.
g‘Lim™
();

280 @
Ov”ride


281 
public
 
g‘LogTa
() {

282  
	glogM‘ad©a
.
g‘Glob®Ta
();

285 @
Ov”ride


286 
public
 
TasRe¥Ú£
 
g‘Tas
(
Li¡
<
UUID
> 
¡»ams
) {

287 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gs
 = 
Ãw
 
HashM­
<>();

288 
	g¡»ams
.
fÜEach
(
¡»am
 -> {

289 
s
.
put
(
¡»am
, 
logM‘ad©a
.
g‘SŒ—mTas
().
g‘
(stream));

291  
Ãw
 
TasRe¥Ú£
(
logM‘ad©a
.
g‘Glob®Ta
(), 
s
);

294 @
Ov”ride


295 
public
 
SŒ—msAdd»ssRe¥Ú£
 
g‘SŒ—msAdd»ssS·û
() {

296  
Ãw
 
SŒ—msAdd»ssRe¥Ú£
(
logM‘ad©a
.
g‘Glob®Ta
(),†ogM‘ad©a.
g‘SŒ—msAdd»ssS·ûM­
());

299 @
Ov”ride


300 
public
 
TasRe¥Ú£
 
g‘AÎTas
() {

301 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gs
 = 
Ãw
 
HashM­
<>(
logM‘ad©a
.
g‘SŒ—mTas
());

302  
Ãw
 
TasRe¥Ú£
(
logM‘ad©a
.
g‘Glob®Ta
(), 
s
);

305 
´iv©e
 
syncTaSegm’t
(
add»ss
) {

309 
	glogM‘ad©a
.
upd©eGlob®Ta
(
add»ss
);

310 
	g£gm’t
 = 
add»ss
 / 
RECORDS_PER_LOG_FILE
;

312 
	gd©aStÜe
.
upd©eTaSegm’t
(
£gm’t
);

315 @
Ov”ride


316 
public
 
´efixTrim
(
add»ss
) {

317 ià(
isTrimmed
(
add»ss
)) {

318 
	glog
.
w¬n
("´efixTrim: IgnÜšg„•—‹drim {}", 
add»ss
);

326 
	gÃwS¹šgAdd»ss
 = 
add»ss
 + 1;

327 
	gd©aStÜe
.
upd©eS¹šgAdd»ss
(
ÃwS¹šgAdd»ss
);

328 
syncTaSegm’t
(
add»ss
);

329 
	glog
.
debug
("Trimmed…»fix,‚ew s¹šg‡dd»s {}", 
ÃwS¹šgAdd»ss
);

332 
	glogM‘ad©a
.
´efixTrim
(
add»ss
);

335 
´iv©e
 
boŞ—n
 
isTrimmed
(
add»ss
) {

336  
	gadd»ss
 < 
	gd©aStÜe
.
g‘S¹šgAdd»ss
();

339 
´iv©e
 
v”ifyLogs
() {

340 
	gSŒšg
[] 
	gex‹nsiÚ
 = {"log"};

341 
Fe
 
	gdœ
 = 
logDœ
.
toFe
();

343 ià(!
	gdœ
.
exi¡s
()) {

344 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
("Stream†og data directory doesn'tƒxists");

347 
	gCŞËùiÚ
<
	gFe
> 
	gfes
 = 
FeUts
.
li¡Fes
(
dœ
, 
ex‹nsiÚ
, 
Œue
);

349 
Fe
 
	gfe
 : 
fes
) {

350 
LogH—d”
 
h—d”
;

352 
Œy
 (
FeChªÃl
 
feChªÃl
 = FeChªÃl.
İ’
(
fe
.
toP©h
())) {

353 
h—d”
 = 
·r£H—d”
(
feChªÃl
, 
fe
.
g‘AbsŞu‹P©h
());

354 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

355 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Inv®id h—d”: " + 
fe
.
g‘AbsŞu‹P©h
(), 
e
);

358 ià(
	gh—d”
 =ğ
nuÎ
) {

359 
log
.
w¬n
("v”ifyLogs: IgnÜšg…¬tŸÎy wr™‹Àh—d” iÀ{}", 
fe
.
g‘AbsŞu‹Fe
());

363 ià(
	gh—d”
.
g‘V”siÚ
(è!ğ
VERSION
) {

364 
SŒšg
 
msg
 = SŒšg.
fÜm©
("Log version %s for %s should matchhe LogUnit†og version %s",

365 
h—d”
.
g‘V”siÚ
(), 
fe
.
g‘AbsŞu‹Fe
(), 
VERSION
);

366 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
msg
);

369 ià(
	gv”ify
 && !
	gh—d”
.
g‘V”ifyChecksum
()) {

370 
SŒšg
 
	gmsg
 = SŒšg.
fÜm©
("Log file %s‚ot generated with check sums, can't verify!",

371 
fe
.
g‘AbsŞu‹Fe
());

372 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
msg
);

377 @
Ov”ride


378 
public
 
sync
(
boŞ—n
 
fÜû
è
throws
 
	gIOExû±iÚ
 {

379 ià(
	gfÜû
) {

380 
FeChªÃl
 
	gch
 : 
chªÃlsToSync
) {

381 
ch
.
fÜû
(
Œue
);

384 
	glog
.
Œaû
("Sync'd {} chªÃls", 
chªÃlsToSync
.
size
());

385 
	gchªÃlsToSync
.
ş—r
();

388 @
Ov”ride


389 
public
 
synchrÚized
 
com·ù
() {

390 
ŒimP»fix
();

393 @
Ov”ride


394 
public
 
g‘TrimM¬k
() {

395  
	gd©aStÜe
.
g‘S¹šgAdd»ss
();

398 
´iv©e
 
ŒimP»fix
() {

401 
	g’dSegm’t
 = 
g‘S¹šgSegm’t
() - 1;

403 ià(
	g’dSegm’t
 < 0) {

404 
	glog
.
debug
("Only one segment detected, ignoringrim");

409 
şo£Segm’tHªdËrs
(
’dSegm’t
);

411 
d–‘eFesM©chšgF‹r
(
fe
 -> {

412 
Œy
 {

413 
SŒšg
 
£gm’tSŒ
 = 
fe
.
g‘Name
().
¥l™
("\\.")[0];

414  
LÚg
.
·r£LÚg
(
£gm’tSŒ
è<ğ
’dSegm’t
;

415 } 
ÿtch
 (
Exû±iÚ
 
e
) {

416 
log
.
w¬n
("ŒimP»fix: ignÜšg f{}", 
fe
.
g‘Name
());

417  
çl£
;

421 
	glog
.
šfo
("ŒimP»fix: com¶‘ed,ƒnd segm’ˆ{}", 
’dSegm’t
);

424 
´iv©e
 
LogD©a
 
g‘LogD©a
(
LogEÁry
 
’Œy
) {

425 
By‹Bufãr
 
	g’ŒyD©a
 = By‹Bufãr.
w¿p
(
’Œy
.
g‘D©a
().
toBy‹A¼ay
());

427 
	gldCodecTy³
 = 
’Œy
.
hasCodecTy³
(è?ƒÁry.
g‘CodecTy³
(è: 
Codec
.
Ty³
.
NONE
.
g‘Id
();

429 
LogD©a
 
	glogD©a
 = 
Ãw
 LogD©a(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ


430 .
D©aTy³
.
ty³M­
.
g‘
((
by‹
è
’Œy
.
g‘D©aTy³
().
g‘Numb”
()),

431 
UÅoŞed
.
w¿µedBufãr
(
’ŒyD©a
.
¬¿y
()), 
ldCodecTy³
);

433 
	glogD©a
.
£tBackpoš‹rM­
(
g‘UUIDLÚgM­
(
’Œy
.
g‘Backpoš‹rsM­
()));

434 
	glogD©a
.
£tGlob®Add»ss
(
’Œy
.
g‘Glob®Add»ss
());

435 
	glogD©a
.
£tRªk
(
ü—‹D©aRªk
(
’Œy
));

437 ià(
	g’Œy
.
hasTh»adId
()) {

438 
	glogD©a
.
£tTh»adId
(
’Œy
.
g‘Th»adId
());

440 ià(
	g’Œy
.
hasCl›ÁIdL—¡SignifiÿÁ
(è&&ƒÁry.
hasCl›ÁIdMo¡SignifiÿÁ
()) {

441 
	glsd
 = 
’Œy
.
g‘Cl›ÁIdL—¡SignifiÿÁ
();

442 
	gmsd
 = 
’Œy
.
g‘Cl›ÁIdMo¡SignifiÿÁ
();

443 
	glogD©a
.
£tCl›ÁId
(
Ãw
 
UUID
(
msd
, 
lsd
));

446 ià(
	g’Œy
.
hasCheckpoštEÁryTy³
()) {

447 
	glogD©a
.
£tCheckpoštTy³
(
CheckpoštEÁry
.
CheckpoštEÁryTy³


448 .
ty³M­
.
g‘
((
by‹
è
’Œy
.
g‘CheckpoštEÁryTy³
().
Üdš®
()));

450 ià(!
	g’Œy
.
hasCheckpoštIdL—¡SignifiÿÁ
()

451 || !
	g’Œy
.
hasCheckpoštIdMo¡SignifiÿÁ
()) {

452 
	glog
.
”rÜ
("Checkpošˆha missšg infÜm©iÚ {}", 
’Œy
);

455 
	glsd
 = 
’Œy
.
g‘CheckpoštIdL—¡SignifiÿÁ
();

456 
	gmsd
 = 
’Œy
.
g‘CheckpoštIdMo¡SignifiÿÁ
();

457 
UUID
 
	gcheckpoštId
 = 
Ãw
 UUID(
msd
, 
lsd
);

459 
	glogD©a
.
£tCheckpoštId
(
checkpoštId
);

461 
	glsd
 = 
’Œy
.
g‘Checkpoš‹dSŒ—mIdL—¡SignifiÿÁ
();

462 
	gmsd
 = 
’Œy
.
g‘Checkpoš‹dSŒ—mIdMo¡SignifiÿÁ
();

463 
UUID
 
	g¡»amId
 = 
Ãw
 UUID(
msd
, 
lsd
);

465 
	glogD©a
.
£tCheckpoš‹dSŒ—mId
(
¡»amId
);

467 
	glogD©a
.
£tCheckpoš‹dSŒ—mS¹LogAdd»ss
(

468 
’Œy
.
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
());

471  
	glogD©a
;

484 
´iv©e
 
M‘ad©a
 
·r£M‘ad©a
(
FeChªÃl
 
feChªÃl
, 
SŒšg
 
£gm’tFe
è
throws
 
	gIOExû±iÚ
 {

485 
	gaùu®M‘aD©aSize
 = 
feChªÃl
.
size
(è- feChªÃl.
pos™iÚ
();

486 ià(
	gaùu®M‘aD©aSize
 < 
	gMETADATA_SIZE
) {

487 
	glog
.
”rÜ
("Meta data has wrong size. Actual size: {},ƒxpected: {}",

488 
aùu®M‘aD©aSize
, 
METADATA_SIZE


490  
	gnuÎ
;

493 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
®loÿ‹
(
METADATA_SIZE
);

494 
	gfeChªÃl
.
»ad
(
buf
);

495 
	gbuf
.
æ
();

497 
M‘ad©a
 
	gm‘ad©a
;

499 
	gŒy
 {

500 
	gm‘ad©a
 = 
M‘ad©a
.
·r£From
(
buf
.
¬¿y
());

501 } 
ÿtch
 (
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

502 
SŒšg
 
	g”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
("Can't…arse metadata",

503 
feChªÃl
, 
£gm’tFe


505 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
, 
e
);

508 ià(
	gm‘ad©a
.
g‘L’gthChecksum
(è!ğ
Checksum
.
g‘Checksum
(
m‘ad©a
.
g‘L’gth
())) {

509 
SŒšg
 
”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
("Metadata: invalid†ength checksum",

510 
feChªÃl
, 
£gm’tFe


512 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
);

515  
	gm‘ad©a
;

518 
´iv©e
 
SŒšg
 
g‘D©aCÜru±iÚE¼ÜMes§ge
(

519 
SŒšg
 
mes§ge
, 
FeChªÃl
 
feChªÃl
, SŒšg 
£gm’tFe
è
throws
 
	gIOExû±iÚ
 {

520  
	gmes§ge
 +

521 ". Segm’ˆFe: " + 
	g£gm’tFe
 +

522 ". Fsize: " + 
	gfeChªÃl
.
size
() +

523 ". Fpos™iÚ: " + 
	gfeChªÃl
.
pos™iÚ
() +

524 ". Glob®a: " + 
	glogM‘ad©a
.
g‘Glob®Ta
() +

525 ". Ta segm’t: " + 
	gd©aStÜe
.
g‘TaSegm’t
() +

526 ". SŒ—ma size: " + 
	glogM‘ad©a
.
g‘SŒ—mTas
().
size
();

537 
´iv©e
 
By‹Bufãr
 
g‘PaylßdFÜM‘ad©a
(
FeChªÃl
 
feChªÃl
, 
M‘ad©a
 
m‘ad©a
è
throws
 
	gIOExû±iÚ
 {

538 ià(
	gfeChªÃl
.
size
(è- feChªÃl.
pos™iÚ
(è< 
	gm‘ad©a
.
g‘L’gth
()) {

539  
	gnuÎ
;

542 
By‹Bufãr
 
	gbuf
 = By‹Bufãr.
®loÿ‹
(
m‘ad©a
.
g‘L’gth
());

543 
	gfeChªÃl
.
»ad
(
buf
);

544 
	gbuf
.
æ
();

545  
	gbuf
;

556 
´iv©e
 
LogH—d”
 
·r£H—d”
(
FeChªÃl
 
chªÃl
, 
SŒšg
 
£gm’tFe
è
throws
 
	gIOExû±iÚ
 {

557 
M‘ad©a
 
	gm‘ad©a
 = 
·r£M‘ad©a
(
chªÃl
, 
£gm’tFe
);

558 ià(
	gm‘ad©a
 =ğ
nuÎ
) {

561 
chªÃl
.
pos™iÚ
(0);

562  
	gnuÎ
;

565 
By‹Bufãr
 
	gbufãr
 = 
g‘PaylßdFÜM‘ad©a
(
chªÃl
, 
m‘ad©a
);

566 ià(
	gbufãr
 =ğ
nuÎ
) {

569 
chªÃl
.
pos™iÚ
(0);

570  
	gnuÎ
;

573 ià(
	gChecksum
.
g‘Checksum
(
bufãr
.
¬¿y
()è!ğ
m‘ad©a
.
g‘PaylßdChecksum
()) {

574 
SŒšg
 
”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
("Invalid metadata checksum",

575 
chªÃl
, 
£gm’tFe


577 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
);

580 
LogH—d”
 
	gh—d”
;

582 
	gŒy
 {

583 
	gh—d”
 = 
LogH—d”
.
·r£From
(
bufãr
.
¬¿y
());

584 } 
ÿtch
 (
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

585 
SŒšg
 
	g”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
("Invalid header",

586 
chªÃl
, 
£gm’tFe


588 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
, 
e
);

591  
	gh—d”
;

602 
´iv©e
 
LogEÁry
 
·r£EÁry
(
FeChªÃl
 
chªÃl
, 
M‘ad©a
 
m‘ad©a
, 
SŒšg
 
feName
)

603 
throws
 
	gIOExû±iÚ
 {

605 ià(
	gm‘ad©a
 =ğ
nuÎ
) {

607  
nuÎ
;

610 
By‹Bufãr
 
	gbufãr
 = 
g‘PaylßdFÜM‘ad©a
(
chªÃl
, 
m‘ad©a
);

611 ià(
	gbufãr
 =ğ
nuÎ
) {

615 
chªÃl
.
pos™iÚ
(chªÃl.pos™iÚ(è- 
METADATA_SIZE
);

616  
	gnuÎ
;

619 ià(
	gv”ify
 && 
	gm‘ad©a
.
g‘PaylßdChecksum
(è!ğ
Checksum
.
g‘Checksum
(
bufãr
.
¬¿y
())) {

620 
SŒšg
 
”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
(

622 
chªÃl
, 
feName


624 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
);

628 
LogEÁry
 
	g’Œy
;

629 
	gŒy
 {

630 
	g’Œy
 = 
LogEÁry
.
·r£From
(
bufãr
.
¬¿y
());

631 } 
ÿtch
 (
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

632 
SŒšg
 
	g”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
("Invalidƒntry",

633 
chªÃl
, 
feName


635 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
, 
e
);

637  
	g’Œy
;

645 
´iv©e
 
»adAdd»ssS·û
(
Segm’tHªdË
 
£gm’t
è
throws
 
	gIOExû±iÚ
 {

646 
FeChªÃl
 
	gfeChªÃl
 = 
£gm’t
.
g‘Wr™eChªÃl
();

647 
	gfeChªÃl
.
pos™iÚ
(0);

649 
LogH—d”
 
	gh—d”
 = 
·r£H—d”
(
feChªÃl
, 
£gm’t
.
g‘FeName
());

650 ià(
	gh—d”
 =ğ
nuÎ
) {

651 
log
.
w¬n
("Couldn'ˆfšd†og h—d” fÜ {}, c»©šg‚ew h—d”.", 
£gm’t
.
g‘FeName
());

652 
wr™eH—d”
(
feChªÃl
, 
VERSION
, 
v”ify
);

656 
	gfeChªÃl
.
size
(è- feChªÃl.
pos™iÚ
() > 0) {

657 
	gchªÃlOff£t
 = 
feChªÃl
.
pos™iÚ
();

658 
M‘ad©a
 
	gm‘ad©a
 = 
·r£M‘ad©a
(
feChªÃl
, 
£gm’t
.
g‘FeName
());

659 
LogEÁry
 
	g’Œy
 = 
·r£EÁry
(
feChªÃl
, 
m‘ad©a
, 
£gm’t
.
g‘FeName
());

661 ià(
	g’Œy
 =ğ
nuÎ
) {

663 
log
.
w¬n
("M®fÜmedƒÁry, m‘ad©¨{} iÀf{}", 
m‘ad©a
, 
£gm’t
.
g‘FeName
());

671 
	gfeChªÃl
.
Œunÿ‹
(
feChªÃl
.
pos™iÚ
());

672 
	gfeChªÃl
.
fÜû
(
Œue
);

676 
Add»ssM‘aD©a
 
	gadd»ssM‘ad©a
 = 
Ãw
 AddressMetaData(

677 
m‘ad©a
.
g‘PaylßdChecksum
(),

678 
m‘ad©a
.
g‘L’gth
(),

679 
chªÃlOff£t
 + 
METADATA_SIZE


682 
	g£gm’t
.
g‘KnownAdd»s£s
().
put
(
’Œy
.
g‘Glob®Add»ss
(), 
add»ssM‘ad©a
);

693 
´iv©e
 
LogD©a
 
»adRecÜd
(
Segm’tHªdË
 
£gm’t
, 
add»ss
è
throws
 
	gIOExû±iÚ
 {

694 
FeChªÃl
 
	gfeChªÃl
 = 
£gm’t
.
g‘R—dChªÃl
();

696 
Add»ssM‘aD©a
 
	gm‘aD©a
 = 
£gm’t
.
g‘KnownAdd»s£s
().
g‘
(
add»ss
);

697 ià(
	gm‘aD©a
 =ğ
nuÎ
) {

698  
nuÎ
;

701 
	gŒy
 {

702 
By‹Bufãr
 
	g’ŒyBuf
 = By‹Bufãr.
®loÿ‹
(
m‘aD©a
.
Ëngth
);

703 
	gfeChªÃl
.
»ad
(
’ŒyBuf
, 
m‘aD©a
.
off£t
);

704  
g‘LogD©a
(
LogEÁry
.
·r£From
(
’ŒyBuf
.
¬¿y
()));

705 } 
ÿtch
 (
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

706 
SŒšg
 
	g”rÜMes§ge
 = 
g‘D©aCÜru±iÚE¼ÜMes§ge
("Invalidƒntry",

707 
feChªÃl
, 
£gm’t
.
g‘FeName
()

709 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
”rÜMes§ge
, 
e
);

713 @
NuÎabË


714 
´iv©e
 
FeChªÃl
 
g‘ChªÃl
(
SŒšg
 
feP©h
, 
boŞ—n
 
»adOÆy
è
throws
 
	gIOExû±iÚ
 {

715 ià(
	g»adOÆy
) {

716 ià(!
Ãw
 
Fe
(
feP©h
).
exi¡s
()) {

717 
throw
 
Ãw
 
FeNÙFoundExû±iÚ
(
feP©h
);

720  
	gFeChªÃl
.
İ’
(

721 
FeSy¡ems
.
g‘DeçuÉ
().
g‘P©h
(
feP©h
),

722 
EnumS‘
.
of
(
Snd¬dO³nO±iÚ
.
READ
)

726 
	gŒy
 {

727 
	gEnumS‘
<
	gSnd¬dO³nO±iÚ
> 
	gİtiÚs
 = 
EnumS‘
.
of
(

728 
Snd¬dO³nO±iÚ
.
READ
,

729 
Snd¬dO³nO±iÚ
.
WRITE
,

730 
Snd¬dO³nO±iÚ
.
CREATE_NEW


732 
FeChªÃl
 
	gchªÃl
 = FeChªÃl.
İ’
(
FeSy¡ems
.
g‘DeçuÉ
().
g‘P©h
(
feP©h
), 
İtiÚs
);

735 
Fe
 
	g£gFe
 = 
Ãw
 Fe(
feP©h
);

736 
syncDœeùÜy
(
£gFe
.
g‘P¬’t
());

737  
	gchªÃl
;

738 } 
ÿtch
 (
FeAÌ—dyExi¡sExû±iÚ
 
ex
) {

739  
	gFeChªÃl
.
İ’
(

740 
FeSy¡ems
.
g‘DeçuÉ
().
g‘P©h
(
feP©h
),

741 
EnumS‘
.
of
(
Snd¬dO³nO±iÚ
.
READ
, Snd¬dO³nO±iÚ.
WRITE
)

753 
Segm’tHªdË
 
g‘Segm’tHªdËFÜAdd»ss
(
add»ss
) {

754 
	g£gm’t
 = 
add»ss
 / 
RECORDS_PER_LOG_FILE
;

756 
SŒšg
 
	gfeP©h
 = 
logDœ
 + 
Fe
.
£·¿tÜ
;

757 
	gfeP©h
 +ğ
£gm’t
;

758 
	gfeP©h
 += ".log";

760 
Segm’tHªdË
 
	ghªdË
 = 
wr™eChªÃls
.
compu‹IfAb£Á
(
feP©h
, 
a
 -> {

761 
FeChªÃl
 
wr™eCh
 = 
nuÎ
;

762 
FeChªÃl
 
»adCh
 = 
nuÎ
;

764 
Œy
 {

765 
wr™eCh
 = 
g‘ChªÃl
(
a
, 
çl£
);

766 
»adCh
 = 
g‘ChªÃl
(
a
, 
Œue
);

768 
Segm’tHªdË
 
sh
 = 
Ãw
 Segm’tHªdË(
£gm’t
, 
wr™eCh
, 
»adCh
, 
a
);

772 
»adAdd»ssS·û
(
sh
);

773  
sh
;

774 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

775 
log
.
”rÜ
("E¼Ü o³nšg f{}", 
a
, 
e
);

776 
IOUts
.
şo£Qu›y
(
wr™eCh
);

777 
IOUts
.
şo£Qu›y
(
»adCh
);

778 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
e
);

782 
	ghªdË
.
»š
();

783  
	ghªdË
;

786 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gLÚg
> 
g‘SŒLÚgM­
(
M­
<
UUID
, 
LÚg
> 
uuidLÚgM­
) {

787 
	gM­
<
	gSŒšg
, 
	gLÚg
> 
	g¡ršgLÚgM­
 = 
Ãw
 
HashM­
<>();

789 
	gM­
.
	gEÁry
<
	gUUID
, 
	gLÚg
> 
	g’Œy
 : 
uuidLÚgM­
.
’ŒyS‘
()) {

790 
¡ršgLÚgM­
.
put
(
’Œy
.
g‘Key
().
toSŒšg
(),ƒÁry.
g‘V®ue
());

793  
	g¡ršgLÚgM­
;

796 @
Suµ»ssW¬nšgs
("checkstyle:abbreviationaswordinname")

797 
´iv©e
 
	gM­
<
	gUUID
, 
	gLÚg
> 
g‘UUIDLÚgM­
(
M­
<
SŒšg
, 
LÚg
> 
¡ršgLÚgM­
) {

798 
	gM­
<
	gUUID
, 
	gLÚg
> 
	guuidLÚgM­
 = 
Ãw
 
HashM­
<>();

800 
	gM­
.
	gEÁry
<
	gSŒšg
, 
	gLÚg
> 
	g’Œy
 : 
¡ršgLÚgM­
.
’ŒyS‘
()) {

801 
uuidLÚgM­
.
put
(
UUID
.
äomSŒšg
(
’Œy
.
g‘Key
()),ƒÁry.
g‘V®ue
());

804  
	guuidLÚgM­
;

807 @
Suµ»ssW¬nšgs
("checkstyle:abbreviationaswordinname")

808 
´iv©e
 
	gS‘
<
	gSŒšg
> 
g‘SŒUUID
(
S‘
<
UUID
> 
uuids
) {

809 
	gS‘
<
	gSŒšg
> 
	g¡rUUIds
 = 
Ãw
 
HashS‘
<>();

811 
UUID
 
	guuid
 : 
uuids
) {

812 
¡rUUIds
.
add
(
uuid
.
toSŒšg
());

815  
	g¡rUUIds
;

820 
´iv©e
 
LogEÁry
 
g‘LogEÁry
(
add»ss
, 
LogD©a
 
’Œy
) {

821 
By‹Bufãr
 
	gd©a
 = By‹Bufãr.
w¿p
(
’Œy
.
g‘D©a
(è=ğ
nuÎ
 ? 
Ãw
 
by‹
[0] :ƒntry.getData());

823 
	gLogEÁry
.
Bud”
 
	glogEÁryBud”
 = 
LogEÁry
.
ÃwBud”
()

824 .
£tD©aTy³
(
Ty³s
.
D©aTy³
.
fÜNumb”
(
’Œy
.
g‘Ty³
().
Üdš®
()))

825 .
£tCodecTy³
(
’Œy
.
g‘PaylßdCodecTy³
().
g‘Id
())

826 .
£tD©a
(
By‹SŒšg
.
cİyFrom
(
d©a
))

827 .
£tGlob®Add»ss
(
add»ss
)

828 .
addAÎSŒ—ms
(
g‘SŒUUID
(
’Œy
.
g‘SŒ—ms
()))

829 .
putAÎBackpoš‹rs
(
g‘SŒLÚgM­
(
’Œy
.
g‘Backpoš‹rM­
()));

831 
	gO±iÚ®
<
	gTy³s
.
	gD©aRªk
> 
	g¿nk
 = 
ü—‹PrÙobufsD©aRªk
(
’Œy
);

832 
	g¿nk
.
ifP»£Á
(
logEÁryBud”
::
£tRªk
);

834 ià(
	g’Œy
.
g‘Cl›ÁId
(è!ğ
nuÎ
 && 
’Œy
.
g‘Th»adId
() !=‚ull) {

835 
logEÁryBud”
.
£tCl›ÁIdMo¡SignifiÿÁ
(

836 
’Œy
.
g‘Cl›ÁId
().
g‘Mo¡SignifiÿÁB™s
());

837 
	glogEÁryBud”
.
£tCl›ÁIdL—¡SignifiÿÁ
(

838 
’Œy
.
g‘Cl›ÁId
().
g‘L—¡SignifiÿÁB™s
());

839 
	glogEÁryBud”
.
£tTh»adId
(
’Œy
.
g‘Th»adId
());

842 ià(
	g’Œy
.
hasCheckpoštM‘ad©a
()) {

843 
	glogEÁryBud”
.
£tCheckpoštEÁryTy³
(

844 
Ty³s
.
CheckpoštEÁryTy³
.
fÜNumb”
(

845 
’Œy
.
g‘CheckpoštTy³
().
Üdš®
()));

846 
	glogEÁryBud”
.
£tCheckpoštIdMo¡SignifiÿÁ
(

847 
’Œy
.
g‘CheckpoštId
().
g‘Mo¡SignifiÿÁB™s
());

848 
	glogEÁryBud”
.
£tCheckpoštIdL—¡SignifiÿÁ
(

849 
’Œy
.
g‘CheckpoštId
().
g‘L—¡SignifiÿÁB™s
());

850 
	glogEÁryBud”
.
£tCheckpoš‹dSŒ—mIdL—¡SignifiÿÁ
(

851 
’Œy
.
g‘Checkpoš‹dSŒ—mId
().
g‘L—¡SignifiÿÁB™s
());

852 
	glogEÁryBud”
.
£tCheckpoš‹dSŒ—mIdMo¡SignifiÿÁ
(

853 
’Œy
.
g‘Checkpoš‹dSŒ—mId
().
g‘Mo¡SignifiÿÁB™s
());

854 
	glogEÁryBud”
.
£tCheckpoš‹dSŒ—mS¹LogAdd»ss
(

855 
’Œy
.
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
());

858  
	glogEÁryBud”
.
bud
();

861 
´iv©e
 
	gO±iÚ®
<
	gTy³s
.
	gD©aRªk
> 
ü—‹PrÙobufsD©aRªk
(
IM‘ad©a
 
’Œy
) {

862 
	gIM‘ad©a
.
D©aRªk
 
	g¿nk
 = 
’Œy
.
g‘Rªk
();

863 ià(
	g¿nk
 =ğ
nuÎ
) {

864  
O±iÚ®
.
em±y
();

866 
	gTy³s
.
D©aRªk
 
	g»suÉ
 = 
Ty³s
.D©aRªk.
ÃwBud”
()

867 .
£tRªk
(
¿nk
.
g‘Rªk
())

868 .
£tUuidL—¡SignifiÿÁ
(
¿nk
.
g‘Uuid
().
g‘L—¡SignifiÿÁB™s
())

869 .
£tUuidMo¡SignifiÿÁ
(
¿nk
.
g‘Uuid
().
g‘Mo¡SignifiÿÁB™s
())

870 .
bud
();

871  
	gO±iÚ®
.
of
(
»suÉ
);

874 @
NuÎabË


875 
´iv©e
 
	gIM‘ad©a
.
D©aRªk
 
ü—‹D©aRªk
(
LogEÁry
 
’t™y
) {

876 ià(!
	g’t™y
.
hasRªk
()) {

877  
	gnuÎ
;

879 
	gTy³s
.
D©aRªk
 
	g¿nk
 = 
’t™y
.
g‘Rªk
();

880  
Ãw
 
	gIM‘ad©a
.
D©aRªk
(
¿nk
.
g‘Rªk
(),

881 
Ãw
 
UUID
(
¿nk
.
g‘UuidMo¡SignifiÿÁ
(),„ªk.
g‘UuidL—¡SignifiÿÁ
()));

892 
´iv©e
 
	gM­
<
	gLÚg
, 
	gAdd»ssM‘aD©a
> 
wr™eRecÜds
(
Segm’tHªdË
 
£gm’t
,

893 
Li¡
<
LogD©a
> 
’Œ›s
è
throws
 
	gIOExû±iÚ
 {

894 
	gM­
<
	gLÚg
, 
	gAdd»ssM‘aD©a
> 
	g»cÜdsM­
 = 
Ãw
 
HashM­
<>();

896 
	gLi¡
<
	gBy‹Bufãr
> 
	g’ŒyBuffs
 = 
Ãw
 
A¼ayLi¡
<>();

897 
	gtÙ®By‹s
 = 0;

899 
	gLi¡
<
	gM‘ad©a
> 
	gm‘ad©aLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

901 
LogD©a
 
	gcu¼
 : 
’Œ›s
) {

902 
LogEÁry
 
logEÁry
 = 
g‘LogEÁry
(
cu¼
.
g‘Glob®Add»ss
(), curr);

903 
M‘ad©a
 
	gm‘ad©a
 = 
g‘M‘ad©a
(
logEÁry
);

904 
	gm‘ad©aLi¡
.
add
(
m‘ad©a
);

905 
By‹Bufãr
 
	g»cÜd
 = 
g‘By‹Bufãr
(
m‘ad©a
, 
logEÁry
);

906 
	gtÙ®By‹s
 +ğ
»cÜd
.
lim™
();

907 
	g’ŒyBuffs
.
add
(
»cÜd
);

910 
By‹Bufãr
 
	g®lRecÜdsBuf
 = By‹Bufãr.
®loÿ‹
(
tÙ®By‹s
);

912 
Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed
 =

913 
£gm’tLocks
.
acquœeWr™eLock
(
£gm’t
.
g‘Segm’t
())) {

914 
šd
 = 0; 
	gšd
 < 
	g’ŒyBuffs
.
size
(); ind++) {

915 
	gchªÃlOff£t
 = 
£gm’t
.
g‘Wr™eChªÃl
().
pos™iÚ
()

916 + 
®lRecÜdsBuf
.
pos™iÚ
(è+ 
METADATA_SIZE
;

917 
	g®lRecÜdsBuf
.
put
(
’ŒyBuffs
.
g‘
(
šd
));

918 
M‘ad©a
 
	gm‘ad©a
 = 
m‘ad©aLi¡
.
g‘
(
šd
);

919 
	g»cÜdsM­
.
put
(
’Œ›s
.
g‘
(
šd
).
g‘Glob®Add»ss
(),

920 
Ãw
 
Add»ssM‘aD©a
(
m‘ad©a
.
g‘PaylßdChecksum
(),

921 
m‘ad©a
.
g‘L’gth
(), 
chªÃlOff£t
));

924 
	g®lRecÜdsBuf
.
æ
();

925 
wr™eBy‹Bufãr
(
£gm’t
.
g‘Wr™eChªÃl
(), 
®lRecÜdsBuf
);

926 
	gchªÃlsToSync
.
add
(
£gm’t
.
g‘Wr™eChªÃl
());

929 
syncTaSegm’t
(
’Œ›s
.
g‘
ÓÁr›s.
size
(è- 1).
g‘Glob®Add»ss
());

930 
	glogM‘ad©a
.
upd©e
(
’Œ›s
);

933  
	g»cÜdsM­
;

945 
´iv©e
 
wr™eBy‹Bufãr
(
FeChªÃl
 
chªÃl
, 
By‹Bufãr
 
buf
è
throws
 
	gIOExû±iÚ
 {

948 
	glogSizeQuÙa
.
cÚsume
(
buf
.
»maššg
());

949 
	gbuf
.
hasRemaššg
()) {

950 
	gchªÃl
.
wr™e
(
buf
);

962 
´iv©e
 
Add»ssM‘aD©a
 
wr™eRecÜd
(
Segm’tHªdË
 
£gm’t
, 
add»ss
,

963 
LogD©a
 
’Œy
è
throws
 
	gIOExû±iÚ
 {

964 
LogEÁry
 
	glogEÁry
 = 
g‘LogEÁry
(
add»ss
, 
’Œy
);

965 
M‘ad©a
 
	gm‘ad©a
 = 
g‘M‘ad©a
(
logEÁry
);

967 
By‹Bufãr
 
	g»cÜd
 = 
g‘By‹Bufãr
(
m‘ad©a
, 
logEÁry
);

968 
	gchªÃlOff£t
;

970 
Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed
 =

971 
£gm’tLocks
.
acquœeWr™eLock
(
£gm’t
.
g‘Segm’t
())) {

972 
chªÃlOff£t
 = 
£gm’t
.
g‘Wr™eChªÃl
().
pos™iÚ
(è+ 
METADATA_SIZE
;

973 
wr™eBy‹Bufãr
(
£gm’t
.
g‘Wr™eChªÃl
(), 
»cÜd
);

974 
	gchªÃlsToSync
.
add
(
£gm’t
.
g‘Wr™eChªÃl
());

975 
syncTaSegm’t
(
add»ss
);

976 
	glogM‘ad©a
.
upd©e
(
’Œy
, 
çl£
);

979  
Ãw
 
Add»ssM‘aD©a
(
m‘ad©a
.
g‘PaylßdChecksum
(), m‘ad©a.
g‘L’gth
(), 
chªÃlOff£t
);

982 
´iv©e
 
g‘Segm’t
(
LogD©a
 
’Œy
) {

983  
	g’Œy
.
g‘Glob®Add»ss
(è/ 
	gRECORDS_PER_LOG_FILE
;

993 
´iv©e
 
	gLi¡
<
	gLogD©a
> 
´•roûss
(
Li¡
<
LogD©a
> 
¿nge
) {

994 
	gLi¡
<
	gLogD©a
> 
	g´oûs£d
 = 
Ãw
 
A¼ayLi¡
<>();

995 
LogD©a
 
	gcu¼
 : 
¿nge
) {

999 ià(
cu¼
.
isTrimmed
()) {

1002 
´efixTrim
(
cu¼
.
g‘Glob®Add»ss
());

1006 ià(
isTrimmed
(
cu¼
.
g‘Glob®Add»ss
())) {

1014 
	g´oûs£d
.
add
(
cu¼
);

1017  
	g´oûs£d
;

1028 
´iv©e
 
boŞ—n
 
v”ify
(
Li¡
<
LogD©a
> 
¿nge
) {

1031 
	gfœ¡Add»ss
 = 
¿nge
.
g‘
(0).
g‘Glob®Add»ss
();

1032 
	gx
 = 1; x < 
	g¿nge
.
size
(); x++) {

1033 ià(
	g¿nge
.
g‘
(
x
).
g‘Glob®Add»ss
(è!ğ
fœ¡Add»ss
 + x) {

1034  
çl£
;

1039 
	gÏ¡Add»ss
 = 
¿nge
.
g‘
Ôªge.
size
(è- 1).
g‘Glob®Add»ss
();

1040 
	gfœ¡Segm’t
 = 
fœ¡Add»ss
 / 
RECORDS_PER_LOG_FILE
;

1041 
	g’dSegm’t
 = 
Ï¡Add»ss
 / 
RECORDS_PER_LOG_FILE
;

1043  
	g’dSegm’t
 - 
	gfœ¡Segm’t
 <= 1;

1054 @
Ov”ride


1055 
public
 
	gS‘
<
	gLÚg
> 
g‘KnownAdd»s£sInRªge
(
¿ngeS¹
, 
¿ngeEnd
) {

1057 
	gS‘
<
	gLÚg
> 
	g»suÉ
 = 
Ãw
 
HashS‘
<>();

1058 
	gadd»ss
 = 
¿ngeS¹
;‡dd»s <ğ
¿ngeEnd
;‡ddress++) {

1059 ià(
g‘Segm’tHªdËFÜAdd»ss
(
add»ss
).
g‘KnownAdd»s£s
().
cÚšsKey
(address)) {

1060 
	g»suÉ
.
add
(
add»ss
);

1063  
	g»suÉ
;

1066 @
Ov”ride


1067 
public
 
­³nd
(
Li¡
<
LogD©a
> 
¿nge
) {

1069 
	gLi¡
<
	gLogD©a
> 
	g’Œ›s
 = 
´•roûss
(
¿nge
);

1071 ià(
	g’Œ›s
.
isEm±y
()) {

1072 
	glog
.
šfo
("Noƒntrieso write.");

1076 ià(!
v”ify
(
’Œ›s
)) {

1078 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Wr™¿ngtoØÏrge: " + 
’Œ›s
.
size
());

1082 
LogD©a
 
	gfœ¡
 = 
’Œ›s
.
g‘
(0);

1083 
LogD©a
 
	gÏ¡
 = 
’Œ›s
.
g‘
ÓÁr›s.
size
() - 1);

1084 
Segm’tHªdË
 
	gfœ¡Sh
 = 
g‘Segm’tHªdËFÜAdd»ss
(
fœ¡
.
g‘Glob®Add»ss
());

1085 
Segm’tHªdË
 
	gÏ¡Sh
 = 
g‘Segm’tHªdËFÜAdd»ss
(
Ï¡
.
g‘Glob®Add»ss
());

1088 
	gS‘
<
	gLÚg
> 
	g³ndšgWr™es
 = 
¿nge
.
¡»am
()

1089 .
m­
(
ILogD©a
::
g‘Glob®Add»ss
).
cŞËù
(
CŞËùÜs
.
toS‘
());

1092 
	gS‘
<
	gLÚg
> 
	g£gOÃOv”Ïp
 = 
S‘s
.
š‹r£ùiÚ
(
³ndšgWr™es
,

1093 
fœ¡Sh
.
g‘KnownAdd»s£s
().
keyS‘
());

1094 
	gS‘
<
	gLÚg
> 
	g£gTwoOv”Ïp
 = 
S‘s
.
š‹r£ùiÚ
(
³ndšgWr™es
,

1095 
Ï¡Sh
.
g‘KnownAdd»s£s
().
keyS‘
());

1096 ià(!
	g£gOÃOv”Ïp
.
isEm±y
(è|| !
	g£gTwoOv”Ïp
.isEmpty()) {

1097 
	glog
.
”rÜ
("Ov”Ïµšg‡dd»s£ d‘eùed: {}, {}", 
£gOÃOv”Ïp
, 
£gTwoOv”Ïp
);

1098 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
SAME_DATA
);

1101 
	gLi¡
<
	gLogD©a
> 
	g£gOÃEÁr›s
 = 
Ãw
 
A¼ayLi¡
<>();

1102 
	gLi¡
<
	gLogD©a
> 
	g£gTwoEÁr›s
 = 
Ãw
 
A¼ayLi¡
<>();

1104 
LogD©a
 
	gcu¼
 : 
’Œ›s
) {

1105 ià(
g‘Segm’t
(
cu¼
è=ğ
fœ¡Sh
.getSegment() &&

1106 !
fœ¡Sh
.
g‘KnownAdd»s£s
().
cÚšsKey
(
cu¼
.
g‘Glob®Add»ss
())) {

1107 
£gOÃEÁr›s
.
add
(
cu¼
);

1108 } ià(
g‘Segm’t
(
cu¼
è=ğ
Ï¡Sh
.getSegment() &&

1109 !
Ï¡Sh
.
g‘KnownAdd»s£s
().
cÚšsKey
(
cu¼
.
g‘Glob®Add»ss
())) {

1110 
£gTwoEÁr›s
.
add
(
cu¼
);

1114 
	gŒy
 {

1115 ià(!
	g£gOÃEÁr›s
.
isEm±y
()) {

1116 
	gM­
<
	gLÚg
, 
	gAdd»ssM‘aD©a
> 
	gfœ¡SegAdd»s£s
 = 
wr™eRecÜds
(
fœ¡Sh
, 
£gOÃEÁr›s
);

1117 
	gfœ¡Sh
.
g‘KnownAdd»s£s
().
putAÎ
(
fœ¡SegAdd»s£s
);

1120 ià(!
	g£gTwoEÁr›s
.
isEm±y
()) {

1121 
	gM­
<
	gLÚg
, 
	gAdd»ssM‘aD©a
> 
	gÏ¡SegAdd»s£s
 = 
wr™eRecÜds
(
Ï¡Sh
, 
£gTwoEÁr›s
);

1122 
	gÏ¡Sh
.
g‘KnownAdd»s£s
().
putAÎ
(
Ï¡SegAdd»s£s
);

1124 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

1125 
	glog
.
”rÜ
("Disk_wr™e[{}-{}]: Exû±iÚ", 
fœ¡
.
g‘Glob®Add»ss
(),

1126 
Ï¡
.
g‘Glob®Add»ss
(), 
e
);

1127 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

1128 } 
	gfš®ly
 {

1129 
	gfœ¡Sh
.
»Ëa£
();

1130 
	gÏ¡Sh
.
»Ëa£
();

1134 @
Ov”ride


1135 
public
 
­³nd
(
add»ss
, 
LogD©a
 
’Œy
) {

1136 ià(
isTrimmed
(
add»ss
)) {

1137 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
TRIM
);

1140 
Segm’tHªdË
 
	g£gm’t
 = 
g‘Segm’tHªdËFÜAdd»ss
(
add»ss
);

1142 
	gŒy
 {

1145 ià(
	g£gm’t
.
g‘KnownAdd»s£s
().
cÚšsKey
(
add»ss
)

1146 || 
	g£gm’t
.
g‘TrimmedAdd»s£s
().
cÚšs
(
add»ss
)) {

1147 ià(
	g’Œy
.
g‘Rªk
(è=ğ
nuÎ
) {

1148 
Ov”wr™eCau£
 
ov”wr™eCau£
 = 
g‘Ov”wr™eCau£FÜAdd»ss
(
add»ss
, 
’Œy
);

1149 
	glog
.
Œaû
("Disk_wr™e[{}]: ov”wr™‹Àexû±iÚ, cau£: {}", 
add»ss
, 
ov”wr™eCau£
);

1150 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
ov”wr™eCau£
);

1153 
as£¹Aµ’dP”m™‹dUn§ã
(
add»ss
, 
’Œy
);

1154 
Add»ssM‘aD©a
 
	gadd»ssM‘aD©a
 = 
wr™eRecÜd
(
£gm’t
, 
add»ss
, 
’Œy
);

1155 
	g£gm’t
.
g‘KnownAdd»s£s
().
put
(
add»ss
, 
add»ssM‘aD©a
);

1158 
Add»ssM‘aD©a
 
	gadd»ssM‘aD©a
 = 
wr™eRecÜd
(
£gm’t
, 
add»ss
, 
’Œy
);

1159 
	g£gm’t
.
g‘KnownAdd»s£s
().
put
(
add»ss
, 
add»ssM‘aD©a
);

1161 
	glog
.
Œaû
("Disk_wr™e[{}]: Wr™‹ÀtØdisk.", 
add»ss
);

1162 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

1163 
	glog
.
”rÜ
("Disk_wr™e[{}]: Exû±iÚ", 
add»ss
, 
e
);

1164 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

1165 } 
	gfš®ly
 {

1166 
	g£gm’t
.
»Ëa£
();

1170 @
Ov”ride


1171 
public
 
LogD©a
 
»ad
(
add»ss
) {

1172 ià(
isTrimmed
(
add»ss
)) {

1173  
	gLogD©a
.
g‘Trimmed
(
add»ss
);

1175 
Segm’tHªdË
 
	g£gm’t
 = 
g‘Segm’tHªdËFÜAdd»ss
(
add»ss
);

1177 
	gŒy
 {

1178 ià(
	g£gm’t
.
g‘P’dšgTrims
().
cÚšs
(
add»ss
)) {

1179  
	gLogD©a
.
g‘Trimmed
(
add»ss
);

1181  
»adRecÜd
(
£gm’t
, 
add»ss
);

1182 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

1183 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

1184 } 
	gfš®ly
 {

1185 
	g£gm’t
.
»Ëa£
();

1189 @
Ov”ride


1190 
public
 
şo£
() {

1191 
Segm’tHªdË
 
	gfh
 : 
wr™eChªÃls
.
v®ues
()) {

1192 
fh
.
şo£
();

1195 
	gwr™eChªÃls
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

1203 
´iv©e
 
şo£Segm’tHªdËrs
(
’dSegm’t
) {

1204 
Segm’tHªdË
 
	gsh
 : 
wr™eChªÃls
.
v®ues
()) {

1205 ià(
sh
.
g‘Segm’t
(è> 
’dSegm’t
) {

1209 ià(
	gsh
.
g‘RefCouÁ
() != 0) {

1210 
log
.
w¬n
("closeSegmentHandlers: Segment {} isrimmed, but„efCount is {},‡ttemptingorim‡nyways",

1211 
sh
.
g‘Segm’t
(), sh.
g‘RefCouÁ
()

1214 
	gchªÃlsToSync
.
»move
(
sh
.
g‘Wr™eChªÃl
());

1215 
	gsh
.
şo£
();

1216 
	gwr™eChªÃls
.
»move
(
sh
.
g‘FeName
());

1225 
´iv©e
 
d–‘eFesM©chšgF‹r
(
FeF‹r
 
feF‹r
) {

1226 
	gnumFes
 = 0;

1227 
	gä“dBy‹s
 = 0;

1228 
Fe
 
	gdœ
 = 
logDœ
.
toFe
();

1229 
	gFe
[] 
	gfes
 = 
dœ
.
li¡Fes
(
feF‹r
);

1230 ià(
	gfes
 =ğ
nuÎ
) {

1234 
Fe
 
	gfe
 : 
fes
) {

1235 
d–
 = 
fe
.
Ëngth
();

1237 ià(!
	gfe
.
d–‘e
()) {

1238 
	glog
.
”rÜ
("d–‘eFesM©chšgF‹r: Couldn'ˆd–‘f{}", 
fe
.
g‘Name
());

1240 
	gä“dBy‹s
 +ğ
d–
;

1241 
	gnumFes
++;

1244 
	glogSizeQuÙa
.
»Ëa£
(
ä“dBy‹s
);

1245 
	glog
.
šfo
("d–‘eFesM©chšgF‹r: com¶‘ed, d–‘ed {} fes, f»ed {} by‹s", 
numFes
, 
ä“dBy‹s
);

1256 @
Ov”ride


1257 
public
 
»£t
() {

1259 
	g’dSegm’t
 = 
M©h
.
max
(
logM‘ad©a
.
g‘Glob®Ta
(), 0Lè/ 
	gRECORDS_PER_LOG_FILE
;

1260 
	glog
.
w¬n
("Glob® Ta:{},ƒndSegm’t={}", 
logM‘ad©a
.
g‘Glob®Ta
(), 
’dSegm’t
);

1263 
şo£Segm’tHªdËrs
(
’dSegm’t
);

1265 
d–‘eFesM©chšgF‹r
(
fe
 -> {

1266 
Œy
 {

1267 
SŒšg
 
£gm’tSŒ
 = 
fe
.
g‘Name
().
¥l™
("\\.")[0];

1268  
LÚg
.
·r£LÚg
(
£gm’tSŒ
è<ğ
’dSegm’t
;

1269 } 
ÿtch
 (
Exû±iÚ
 
e
) {

1270 
log
.
w¬n
("»£t: ignÜšg f{}", 
fe
.
g‘Name
());

1271  
çl£
;

1275 
	gd©aStÜe
.
»£tS¹šgAdd»ss
();

1276 
	gd©aStÜe
.
»£tTaSegm’t
();

1277 
	glogM‘ad©a
 = 
Ãw
 
LogM‘ad©a
();

1278 
	gwr™eChªÃls
.
ş—r
();

1279 
	glogSizeQuÙa
 = 
Ãw
 
ResourûQuÙa
("LogSizeQuÙa", 
logSizeLim™
);

1280 
	glog
.
šfo
("»£t: Com¶‘ed,ƒnd segm’ˆ{}", 
’dSegm’t
);

1283 @
VisibËFÜTe¡šg


1284 
	gS‘
<
	gFeChªÃl
> 
g‘ChªÃlsToSync
() {

1285  
	gchªÃlsToSync
;

1288 @
VisibËFÜTe¡šg


1289 
	gCŞËùiÚ
<
	gSegm’tHªdË
> 
g‘O³nSegm’tHªdËs
() {

1290  
	gwr™eChªÃls
.
v®ues
();

1293 
public
 şas 
	cChecksum
 {

1295 
´iv©e
 
Checksum
() {

1305 
public
 
g‘Checksum
(
by‹
[] 
by‹s
) {

1306 
Hash”
 
	ghash”
 = 
Hashšg
.
üc32c
().
ÃwHash”
();

1307 
by‹
 
	ga
 : 
by‹s
) {

1308 
hash”
.
putBy‹
(
a
);

1311  
	ghash”
.
hash
().
asIÁ
();

1314 
public
 
g‘Checksum
(
num
) {

1315 
Hash”
 
	ghash”
 = 
Hashšg
.
üc32c
().
ÃwHash”
();

1316  
	ghash”
.
putIÁ
(
num
).
hash
().
asIÁ
();

1324 @
VisibËFÜTe¡šg


1325 
	$e¡im©eSize
(
P©h
 
dœeùÜyP©h
) {

1326 
fš®
 
AtomicLÚg
 
size
 = 
Ãw
 
	`AtomicLÚg
(0);

1327 
Œy
 {

1328 
Fes
.
	`w®kFeT»e
(
dœeùÜyP©h
, 
Ãw
 
Sim¶eFeVis™Ü
<
P©h
>() {

1329 @
Ov”ride


1330 
public
 
FeVis™ResuÉ
 
	`vis™Fe
(
P©h
 
fe
,

1331 
BasicFeA‰ribu‹s
 
©Œs
) {

1332 
size
.
	`addAndG‘
(
©Œs
.
	`size
());

1333  
FeVis™ResuÉ
.
CONTINUE
;

1336 @
Ov”ride


1337 
public
 
FeVis™ResuÉ
 
	`vis™FeFaed
(
P©h
 
fe
, 
IOExû±iÚ
 
exc
) {

1339 
log
.
	`”rÜ
("sk³d: {}", 
fe
, 
exc
);

1340  
FeVis™ResuÉ
.
CONTINUE
;

1344  
size
.
	`g‘
();

1345 } 
	`ÿtch
 (
IOExû±iÚ
 
iÛ
) {

1346 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
iÛ
);

1348 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogWithRankedAddressSpace.java

8 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aOuŒªkedExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gV®ueAdİ‹dExû±iÚ
;

25 
public
 
š‹rçû
 
SŒ—mLogW™hRªkedAdd»ssS·û
 
ex‹nds
 
	gSŒ—mLog
 {

42  
as£¹Aµ’dP”m™‹dUn§ã
(
add»ss
, 
LogD©a
 
ÃwEÁry
)

43 
throws
 
	gD©aOuŒªkedExû±iÚ
, 
	gV®ueAdİ‹dExû±iÚ
 {

44 
LogD©a
 
	gŞdEÁry
 = 
»ad
(
add»ss
);

45 ià(
	gŞdEÁry
.
g‘Ty³
(è=ğ
D©aTy³
.
EMPTY
) {

48 ià(
	gÃwEÁry
.
g‘Rªk
().getRank() == 0) {

50 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
DIFF_DATA
);

52 
	gcom·»
 = 
ÃwEÁry
.
g‘Rªk
().
com·»To
(
ŞdEÁry
.getRank());

53 ià(
	gcom·»
 < 0) {

54 
throw
 
Ãw
 
D©aOuŒªkedExû±iÚ
();

56 ià(
	gcom·»
 > 0) {

57 ià(
	gÃwEÁry
.
g‘Ty³
(è=ğ
D©aTy³
.
RANK_ONLY


58 && 
ŞdEÁry
.
g‘Ty³
(è!ğ
D©aTy³
.
RANK_ONLY
) {

61 
R—dRe¥Ú£
 
»¥
 = 
Ãw
 ReadResponse();

62 
	g»¥
.
put
(
add»ss
, 
ŞdEÁry
);

63 
throw
 
Ãw
 
V®ueAdİ‹dExû±iÚ
(
»¥
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/StateTransferException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

6 
public
 cÏs 
	cS‹T¿nsãrExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

7 
public
 
	$S‹T¿nsãrExû±iÚ
() {

10 
public
 
	$S‹T¿nsãrExû±iÚ
(
ThrowabË
 
ÿu£
) {

11 
	`su³r
(
ÿu£
);

12 
	}
}

14 
public
 
	$S‹T¿nsãrExû±iÚ
(
SŒšg
 
mes§ge
) {

15 
	`su³r
(
mes§ge
);

16 
	}
}

18 
public
 
	$S‹T¿nsãrExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

19 
	`su³r
(
mes§ge
, 
ÿu£
);

20 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/StateTransferManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gLi¡s
;

6 
impÜt
 
	glombok
.
	gAcûssLev–
;

7 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

8 
impÜt
 
	glombok
.
	gBud”
;

9 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

10 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

11 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
.
	gExşude
;

12 
impÜt
 
	glombok
.
	gG‘‹r
;

13 
impÜt
 
	glombok
.
	gNÚNuÎ
;

14 
impÜt
 
	glombok
.
	gToSŒšg
;

15 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
.
	gT¿nsãrStus
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	gS‹T¿nsãrB©chProûssÜ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gT¿nsãrSegm’tExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

23 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

27 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

28 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

29 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gFAILED
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gNOT_TRANSFERRED
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gTRANSFERRED
;

39 @
	gSlf4j


40 @
Bud”


41 
public
 cÏs 
	cS‹T¿nsãrMªag”
 {

46 @
	mG‘‹r


47 @
NÚNuÎ


48 
´iv©e
 
fš®
 
LogUn™Cl›Á
 
	mlogUn™Cl›Á
;

53 @
	mG‘‹r


54 @
NÚNuÎ


55 
´iv©e
 
fš®
 
	mb©chSize
;

60 @
	mG‘‹r


61 @
NÚNuÎ


62 
´iv©e
 
fš®
 
S‹T¿nsãrB©chProûssÜ
 
	mb©chProûssÜ
;

72 @
VisibËFÜTe¡šg


73 
	mImmubËLi¡
<
	mLÚg
> 
	$g‘UnknownAdd»s£sInRªge
(
¿ngeS¹
, 
¿ngeEnd
) {

74 
S‘
<
LÚg
> 
knownAdd»s£s
 = 
logUn™Cl›Á


75 .
	`»que¡KnownAdd»s£s
(
¿ngeS¹
, 
¿ngeEnd
).
	`još
().
	`g‘KnownAdd»s£s
();

77  
LÚgSŒ—m
.
	`¿nge
(
¿ngeS¹
, 
¿ngeEnd
 + 1L)

78 .
	`f‹r
(
add»ss
 -> !
knownAdd»s£s
.
	`cÚšs
(address))

79 .
	`boxed
()

80 .
	`cŞËù
(
ImmubËLi¡
.
	`toImmubËLi¡
());

90 
public
 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
	`hªdËT¿nsãr
(
Li¡
<T¿nsãrSegm’t> 
befÜeT¿nsãrSegm’ts
) {

92 
Li¡
<
T¿nsãrSegm’t
> 
aá”T¿nsãrSegm’ts
 = 
Ãw
 
A¼ayLi¡
<>();

94 
T¿nsãrSegm’t
 
£gm’t
 : 
befÜeT¿nsãrSegm’ts
) {

95 
T¿nsãrSegm’tStus
 
ÃwStus
 = 
£gm’t
.
	`g‘Stus
();

98 ià(
ÃwStus
.
	`g‘Segm’tS‹
(è!ğ
NOT_TRANSFERRED
) {

99 
aá”T¿nsãrSegm’ts
.
	`add
(
£gm’t
);

104 
Li¡
<
LÚg
> 
unknownAdd»s£sInRªge
 =

105 
	`g‘UnknownAdd»s£sInRªge
(
£gm’t
.
	`g‘S¹Add»ss
(),

106 
£gm’t
.
	`g‘EndAdd»ss
());

109 ià(
unknownAdd»s£sInRªge
.
	`isEm±y
()) {

110 
log
.
	`debug
("All‡ddresses‡re…resent inhe„ange: [{}, {}], skippingransfer.",

111 
£gm’t
.
	`g‘S¹Add»ss
(), segm’t.
	`g‘EndAdd»ss
());

112 
tÙ®T¿nsã¼ed
 = 
£gm’t
.
	`g‘TÙ®
();

114 
ÃwStus
 = 
T¿nsãrSegm’tStus


115 .
	`bud”
()

116 .
	`£gm’tS‹
(
TRANSFERRED
)

117 .
	`tÙ®T¿nsã¼ed
(
tÙ®T¿nsã¼ed
)

118 .
	`bud
();

121 
numAdd»s£sToT¿nsãr
 = 
unknownAdd»s£sInRªge
.
	`size
();

123 
SŒ—m
<
T¿nsãrB©chReque¡
> 
b©chSŒ—m
 = 
Li¡s


124 .
	`·¹™iÚ
(
unknownAdd»s£sInRªge
, 
b©chSize
)

125 .
	`¡»am
()

126 .
	`m­
(
grou³dAdd»s£s
 ->

127 
Ãw
 
	`T¿nsãrB©chReque¡
(
grou³dAdd»s£s
, 
O±iÚ®
.
	`em±y
())

130 
ÃwStus
 = 
	`synchrÚousS‹T¿nsãr
(
b©chSŒ—m
, 
numAdd»s£sToT¿nsãr
);

133 
T¿nsãrSegm’t
 
cu¼’tSegm’t
 = TransferSegment

134 .
	`bud”
()

135 .
	`¡¬tAdd»ss
(
£gm’t
.
	`g‘S¹Add»ss
())

136 .
	`’dAdd»ss
(
£gm’t
.
	`g‘EndAdd»ss
())

137 .
	`¡©us
(
ÃwStus
)

138 .
	`bud
();

140 
aá”T¿nsãrSegm’ts
.
	`add
(
cu¼’tSegm’t
);

142 ià(
cu¼’tSegm’t
.
	`g‘Stus
().
	`g‘Segm’tS‹
(è=ğ
FAILED
) {

147  
ImmubËLi¡
.
	`cİyOf
(
aá”T¿nsãrSegm’ts
);

148 
	}
}

158 @
VisibËFÜTe¡šg


159 
T¿nsãrSegm’tStus
 
synchrÚousS‹T¿nsãr
(

160 
SŒ—m
<
T¿nsãrB©chReque¡
> 
b©chSŒ—m
, 
tÙ®N“ded
) {

161 
	gaccT¿nsã¼ed
 = 0L;

163 
	gI‹¿tÜ
<
	gT¿nsãrB©chReque¡
> 
	g™”©Ü
 = 
b©chSŒ—m
.
™”©Ü
();

165 
	g™”©Ü
.
hasNext
()) {

166 
T¿nsãrB©chReque¡
 
	gÃxtB©ch
 = 
™”©Ü
.
Ãxt
();

167 
T¿nsãrB©chRe¥Ú£
 
	g»¥Ú£
 =

168 
b©chProûssÜ
.
Œªsãr
(
ÃxtB©ch
).
još
();

175 ià(
	g»¥Ú£
.
g‘Stus
(è=ğ
T¿nsãrStus
.
FAILED
) {

176 
O±iÚ®
<
T¿nsãrSegm’tExû±iÚ
> 
ÿu£OfFau»
 =

177 
O±iÚ®
.
of
(
»¥Ú£
.
g‘Cau£OfFau»
()

178 .
m­
(
T¿nsãrSegm’tExû±iÚ
::
Ãw
)

179 .
ÜEl£
(
Ãw
 
T¿nsãrSegm’tExû±iÚ
("Failedoransfer.")));

181  
	gT¿nsãrSegm’tStus


182 .
bud”
()

183 .
tÙ®T¿nsã¼ed
(
accT¿nsã¼ed
)

184 .
£gm’tS‹
(
FAILED
)

185 .
ÿu£OfFau»
(causeOfFailure)

186 .
bud
();

188 
	gaccT¿nsã¼ed
 +ğ
»¥Ú£
.
g‘T¿nsãrB©chReque¡
().
g‘Add»s£s
().
size
();

191 ià(
	gaccT¿nsã¼ed
 =ğ
tÙ®N“ded
) {

192  
T¿nsãrSegm’tStus


193 .
bud”
()

194 .
tÙ®T¿nsã¼ed
(
accT¿nsã¼ed
)

195 .
£gm’tS‹
(
TRANSFERRED
)

196 .
bud
();

199 
SŒšg
 
	g”rÜMsg
 = SŒšg.
fÜm©
("Needed: %s, butransferred: %s",

200 
tÙ®N“ded
, 
accT¿nsã¼ed
);

202  
	gT¿nsãrSegm’tStus


203 .
bud”
()

204 .
tÙ®T¿nsã¼ed
(0L)

205 .
£gm’tS‹
(
FAILED
)

206 .
ÿu£OfFau»
(
O±iÚ®
.
of
(
Ãw
 
T¿nsãrSegm’tExû±iÚ
(
”rÜMsg
)))

207 .
bud
();

213 @
	gEqu®sAndHashCode


214 @
	gG‘‹r


215 @
	gToSŒšg


216 @
	gBud”


217 @
	$AÎArgsCÚ¡ruùÜ
(
acûss
 = 
AcûssLev–
.
PRIVATE
)

218 
public
 şas 
	cT¿nsãrSegm’t
 {

222 
´iv©e
 
fš®
 
¡¬tAdd»ss
;

226 
´iv©e
 
fš®
 
’dAdd»ss
;

230 
´iv©e
 
fš®
 
T¿nsãrSegm’tStus
 
¡©us
;

239 
public
 
	`g‘TÙ®
() {

240  
’dAdd»ss
 - 
¡¬tAdd»ss
 + 1L;

243 
public
 şas 
	cT¿nsãrSegm’tBud”
 {

245 
public
 
	`v”ify
() {

246 ià(
¡¬tAdd»ss
 < 0L || 
’dAdd»ss
 < 0L) {

247 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(

248 
SŒšg
.
	`fÜm©
("Start: %s orƒnd: %s " +

249 "ÿÀnÙ bÃg©ive.", 
¡¬tAdd»ss
, 
’dAdd»ss
));

251 ià(
¡¬tAdd»ss
 > 
’dAdd»ss
) {

252 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(

253 
SŒšg
.
	`fÜm©
("Start: %s can‚ot be " +

254 "g»©”hªƒnd: %s.", 
¡¬tAdd»ss
, 
’dAdd»ss
));

257 ià(
¡©us
 =ğ
nuÎ
) {

258 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Status should be defined.");

262 
public
 
T¿nsãrSegm’t
 
	`bud
() {

263 
	`v”ify
();

264  
Ãw
 
	`T¿nsãrSegm’t
(
¡¬tAdd»ss
, 
’dAdd»ss
, 
¡©us
);

267 
	}
}

272 @
	gG‘‹r


273 @
	gToSŒšg


274 @
	gEqu®sAndHashCode


275 @
Bud”


276 
public
 şas 
	cT¿nsãrSegm’tStus
 {

284 
public
 
	eSegm’tS‹
 {

285 
	gNOT_TRANSFERRED
,

286 
	gTRANSFERRED
,

287 
	gRESTORED
,

288 
	gFAILED


294 @
DeçuÉ


295 
´iv©e
 
fš®
 
Segm’tS‹
 
	g£gm’tS‹
 = 
NOT_TRANSFERRED
;

299 @
DeçuÉ


300 
´iv©e
 
fš®
 
	gtÙ®T¿nsã¼ed
 = 0L;

304 @
	gDeçuÉ


305 @
Exşude


306 
´iv©e
 
fš®
 
	gO±iÚ®
<
	gT¿nsãrSegm’tExû±iÚ
> 
	gÿu£OfFau»
 = 
O±iÚ®
.
em±y
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batch/ReadBatch.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gToSŒšg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gR—dB©chExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

13 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

15 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

16 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
.
	gExşude
;

26 @
	gG‘‹r


27 @
	gToSŒšg


28 @
	$Bud”
(
toBud”
 = 
Œue
)

29 
public
 cÏs 
	cR—dB©ch
 {

30 
public
 
	eR—dStus
 {

31 
SUCCEEDED
,

32 
FAILED


38 @
DeçuÉ


39 
´iv©e
 
fš®
 
Li¡
<
LogD©a
> 
d©a
 = 
ImmubËLi¡
.
	`of
();

44 @
DeçuÉ


45 
´iv©e
 
fš®
 
Li¡
<
LÚg
> 
çedAdd»s£s
 = 
ImmubËLi¡
.
	`of
();

50 @
DeçuÉ


51 
´iv©e
 
fš®
 
O±iÚ®
<
SŒšg
> 
de¡š©iÚ
 = O±iÚ®.
	`em±y
();

56 @
DeçuÉ


57 
´iv©e
 
fš®
 
R—dStus
 
¡©us
 = R—dStus.
SUCCEEDED
;

62 @
DeçuÉ


63 @
Exşude


64 
´iv©e
 
fš®
 
O±iÚ®
<
R—dB©chExû±iÚ
> 
ÿu£OfFau»
 = O±iÚ®.
	`em±y
();

71 
public
 
T¿nsãrB©chReque¡
 
	$ü—‹Reque¡
() {

72  
Ãw
 
	`T¿nsãrB©chReque¡
(
çedAdd»s£s
, 
de¡š©iÚ
);

73 
	}
}

79 
public
 
	gLi¡
<
	gLÚg
> 
	$g‘Add»s£s
() {

80  
d©a
.
	`¡»am
()

81 .
	`m­
(
IM‘ad©a
::
g‘Glob®Add»ss
)

82 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

83 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batch/TransferBatchRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

7 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gToSŒšg
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

19 @
	gAÎArgsCÚ¡ruùÜ


20 @
	gG‘‹r


21 @
	gToSŒšg


22 @
	gEqu®sAndHashCode


23 @
Bud”


24 
public
 cÏs 
	cT¿nsãrB©chReque¡
 {

28 @
DeçuÉ


29 
´iv©e
 
fš®
 
	mLi¡
<
	mLÚg
> 
	madd»s£s
 = 
ImmubËLi¡
.
of
();

34 @
DeçuÉ


35 
´iv©e
 
fš®
 
	mO±iÚ®
<
	mSŒšg
> 
	mde¡š©iÚ
 = 
O±iÚ®
.
em±y
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batch/TransferBatchResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

5 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
.
	gExşude
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gS‹T¿nsãrB©chProûssÜExû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
.
	gT¿nsãrStus
.
	gSUCCEEDED
;

23 @
Bud”
(
toBud”
 = 
Œue
)

24 @
G‘‹r


25 @
Equ®sAndHashCode


26 
public
 cÏs 
	cT¿nsãrB©chRe¥Ú£
 {

28 
public
 
	eT¿nsãrStus
 {

29 
SUCCEEDED
,

30 
FAILED


36 @
DeçuÉ


37 @
G‘‹r


38 
´iv©e
 
fš®
 
T¿nsãrB©chReque¡
 
ŒªsãrB©chReque¡
 = T¿nsãrB©chReque¡.
bud”
().
bud
();

42 @
DeçuÉ


43 
´iv©e
 
fš®
 
T¿nsãrStus
 
	g¡©us
 = 
SUCCEEDED
;

48 @
	gDeçuÉ


49 @
Exşude


50 
´iv©e
 
fš®
 
	gO±iÚ®
<
	gS‹T¿nsãrB©chProûssÜExû±iÚ
> 
	gÿu£OfFau»
 = 
O±iÚ®
.
em±y
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/StateTransferBatchProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gR—dB©ch
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

12 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

16 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
.
	gT¿nsãrStus
.
	gSUCCEEDED
;

24 
public
 
š‹rçû
 
	gS‹T¿nsãrB©chProûssÜ
 {

32 
	gCom¶‘abËFutu»
<
	gT¿nsãrB©chRe¥Ú£
> 
Œªsãr
(
T¿nsãrB©chReque¡
 
ŒªsãrB©chReque¡
);

44  
T¿nsãrB©chRe¥Ú£
 
wr™eRecÜds
(
R—dB©ch
 
»adB©ch
, 
LogUn™Cl›Á
 
logUn™Cl›Á
,

45 
wr™eR‘r›sAÎowed
, 
Du¿tiÚ
 
wr™eSË•Du¿tiÚ
) {

46 
	gLi¡
<
	gLÚg
> 
	gtÙ®Add»s£sInReque¡
 = 
»adB©ch
.
g‘Add»s£s
();

47 
	gO±iÚ®
<
	gSŒšg
> 
	gde¡š©iÚ
 = 
»adB©ch
.
g‘De¡š©iÚ
();

48 
	gO±iÚ®
<
	gExû±iÚ
> 
	gÏ¡Wr™eExû±iÚ
 = 
O±iÚ®
.
em±y
();

49 
	gO±iÚ®
<
	gT¿nsãrB©chRe¥Ú£
> 
	gŒªsãrB©chRe¥Ú£
 = 
O±iÚ®
.
em±y
();

51 
	gi
 = 0; i < 
	gwr™eR‘r›sAÎowed
; i++) {

52 
	gLi¡
<
	gLogD©a
> 
	g»maššgD©aToWr™e
 = 
»adB©ch
.
g‘D©a
();

53 
	gŒy
 {

54 
boŞ—n
 
	gwr™eSucûeded
 = 
logUn™Cl›Á
.
wr™eRªge
(
»maššgD©aToWr™e
).
još
();

55 ià(!
	gwr™eSucûeded
) {

56 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Failedo writeo‡†og unit server.");

58 
	gÏ¡Wr™eExû±iÚ
 = 
O±iÚ®
.
em±y
();

59 
	gŒªsãrB©chRe¥Ú£
 = 
O±iÚ®
.
of
(
T¿nsãrB©chRe¥Ú£


60 .
bud”
()

61 .
ŒªsãrB©chReque¡
(
Ãw
 
T¿nsãrB©chReque¡
(
tÙ®Add»s£sInReque¡
, 
de¡š©iÚ
))

62 .
¡©us
(
SUCCEEDED
)

63 .
bud
());

66 } 
ÿtch
 (
Exû±iÚ
 
e
) {

67 
	gÏ¡Wr™eExû±iÚ
 = 
O±iÚ®
.
of
(
e
);

68 
	gSË•
.
¦“pUnš‹¼u±ibly
(
wr™eSË•Du¿tiÚ
);

69 
	gLi¡
<
	gLÚg
> 
	g»maššgAdd»s£sToWr™e
 = 
»adB©ch
.
g‘Add»s£s
();

71 
	g¡¬t
 = 
»maššgAdd»s£sToWr™e
.
g‘
(0);

72 
	g’d
 = 
»maššgAdd»s£sToWr™e
.
g‘
ÔemaššgAdd»s£sToWr™e.
size
() - 1);

73 
	gS‘
<
	gLÚg
> 
	gknownAdd»s£s
 =

74 
logUn™Cl›Á
.
»que¡KnownAdd»s£s
(
¡¬t
, 
’d
).
još
().
g‘KnownAdd»s£s
();

76 
	gS‘
<
	gLÚg
> 
	gnÚWr™‹nAdd»s£s
 =

77 
S‘s
.
difã»nû
(
Ãw
 
HashS‘
<>(
»maššgAdd»s£sToWr™e
), 
knownAdd»s£s
);

79 
	gImmubËLi¡
<
	gLogD©a
> 
	gnÚWr™‹nD©a
 = 
»adB©ch
.
g‘D©a
()

80 .
¡»am
()

81 .
f‹r
(
d©a
 -> 
nÚWr™‹nAdd»s£s
.
cÚšs
(d©a.
g‘Glob®Add»ss
()))

82 .
cŞËù
(
ImmubËLi¡
.
toImmubËLi¡
());

83 
	g»adB©ch
 = 
»adB©ch
.
toBud”
().
d©a
(
nÚWr™‹nD©a
).
bud
();

87 ià(
	gÏ¡Wr™eExû±iÚ
.
isP»£Á
()) {

88 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
Ï¡Wr™eExû±iÚ
.
g‘
());

89 } ià(
	gŒªsãrB©chRe¥Ú£
.
isP»£Á
()) {

90  
	gŒªsãrB©chRe¥Ú£
.
g‘
();

92 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Exhausted„etries writingohe†og unit server.");

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/protocolbatchprocessor/ProtocolBatchProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	g´ÙocŞb©ch´oûssÜ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gOrd”šg
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gR—dB©ch
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	gS‹T¿nsãrB©chProûssÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gR—dB©chExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gS‹T¿nsãrB©chProûssÜExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ssS·ûV›w
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gR—dO±iÚs
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

23 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

29 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

31 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
.
	gT¿nsãrStus
.
	gFAILED
;

39 @
	gSlf4j


40 @
Bud”


41 
public
 cÏs 
	cPrÙocŞB©chProûssÜ
 
im¶em’ts
 
	mS‹T¿nsãrB©chProûssÜ
 {

46 @
DeçuÉ


47 
´iv©e
 
fš®
 
	mmaxR—dR‘r›s
 = 3;

48 @
DeçuÉ


49 
´iv©e
 
fš®
 
Du¿tiÚ
 
	m»adSË•Du¿tiÚ
 = Du¿tiÚ.
ofMlis
(300);

50 @
DeçuÉ


51 
´iv©e
 
fš®
 
	mmaxWr™eR‘r›s
 = 3;

52 @
DeçuÉ


53 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mwr™eSË•Du¿tiÚ
 = Du¿tiÚ.
ofMlis
(300);

57 @
G‘‹r


58 
´iv©e
 
fš®
 
R—dO±iÚs
 
	m»adO±iÚs
 = R—dO±iÚs.
bud”
()

59 .
wa™FÜHŞe
(
Œue
)

60 .
ş›ÁCach—bË
(
çl£
)

61 .
£rv”Cach—bË
(
çl£
)

62 .
bud
();

64 @
G‘‹r


65 
´iv©e
 
fš®
 
LogUn™Cl›Á
 
	mlogUn™Cl›Á
;

67 @
G‘‹r


68 
´iv©e
 
fš®
 
Add»ssS·ûV›w
 
	madd»ssS·ûV›w
;

70 @
Ov”ride


71 
public
 
	mCom¶‘abËFutu»
<
	mT¿nsãrB©chRe¥Ú£
> 
	$Œªsãr
(
T¿nsãrB©chReque¡
 
ŒªsãrB©chReque¡
) {

72  
	`»adRecÜds
(
ŒªsãrB©chReque¡
)

73 .
	`th’Aµly
(
»cÜds
 ->

74 
	`wr™eRecÜds
(
»cÜds
, 
logUn™Cl›Á
, 
maxWr™eR‘r›s
, 
wr™eSË•Du¿tiÚ
))

75 .
	`exû±iÚ®ly
(
”rÜ
 -> 
T¿nsãrB©chRe¥Ú£


76 .
	`bud”
()

77 .
	`¡©us
(
FAILED
)

78 .
	`ÿu£OfFau»
(
O±iÚ®
.
	`of
(
Ãw
 
	`S‹T¿nsãrB©chProûssÜExû±iÚ
(

79 "Faed b©ch: " + 
ŒªsãrB©chReque¡
, 
”rÜ
)))

80 .
	`bud
()

92 @
VisibËFÜTe¡šg


93 
Com¶‘abËFutu»
<
R—dB©ch
> 
	$»adRecÜds
(
T¿nsãrB©chReque¡
 
ŒªsãrB©chReque¡
) {

94  
Com¶‘abËFutu»
.
	`suµlyAsync
(() -> {

96 
O±iÚ®
<
R—dB©chExû±iÚ
> 
Ï‹¡R—dExû±iÚ
 = O±iÚ®.
	`em±y
();

97 
O±iÚ®
<
R—dB©ch
> 
Ï‹¡R—dB©ch
 = O±iÚ®.
	`em±y
();

98 
i
 = 0; i < 
maxR—dR‘r›s
; i++) {

99 
Œy
 {

100 
M­
<
LÚg
, 
ILogD©a
> 
»cÜds
 =

101 
add»ssS·ûV›w
.
	`sim¶ePrÙocŞR—d
(
ŒªsãrB©chReque¡
.
	`g‘Add»s£s
(), 
»adO±iÚs
);

102 
R—dB©ch
 
b©ch
 = 
	`checkR—dRecÜds
(
ŒªsãrB©chReque¡
.
	`g‘Add»s£s
(),

103 
»cÜds
, 
ŒªsãrB©chReque¡
.
	`g‘De¡š©iÚ
());

104 
Ï‹¡R—dB©ch
 = 
O±iÚ®
.
	`of
(
b©ch
);

105 ià(
b©ch
.
	`g‘Stus
(è=ğ
R—dB©ch
.
R—dStus
.
FAILED
) {

106 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Some‡ddresses failedoransfer: " +

107 
b©ch
.
	`g‘FaedAdd»s£s
());

109 
Ï‹¡R—dExû±iÚ
 = 
O±iÚ®
.
	`em±y
();

113 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
e
) {

114 
log
.
	`w¬n
("»adRecÜds:ƒncouÁ”ed‡ wrÚgƒpochƒxû±iÚ oÀŒy {}: ", 
i
, 
e
);

115 
Ï‹¡R—dExû±iÚ
 = 
O±iÚ®
.
	`of
(
Ãw
 
	`R—dB©chExû±iÚ
(
e
));

117 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

118 
log
.
	`w¬n
("»adRecÜds:ƒncouÁ”ed‡Àexû±iÚ oÀŒy {}: ", 
i
, 
e
);

119 
Ï‹¡R—dExû±iÚ
 = 
O±iÚ®
.
	`of
(
Ãw
 
	`R—dB©chExû±iÚ
(
e
));

120 
SË•
.
	`¦“pUnš‹¼u±ibly
(
»adSË•Du¿tiÚ
);

124 ià(
Ï‹¡R—dExû±iÚ
.
	`isP»£Á
()) {

125 
throw
 
Ï‹¡R—dExû±iÚ
.
	`g‘
();

127  
Ï‹¡R—dB©ch
.
	`g‘
();

130 
	}
}

141 @
VisibËFÜTe¡šg


142 
R—dB©ch
 
checkR—dRecÜds
(
Li¡
<
LÚg
> 
add»s£s
,

143 
M­
<
LÚg
, 
ILogD©a
> 
»adResuÉ
,

144 
O±iÚ®
<
SŒšg
> 
de¡š©iÚ
) {

145 
	gLi¡
<
	gLÚg
> 
	gŒªsã¼edAdd»s£s
 =

146 
add»s£s
.
¡»am
()

147 .
f‹r
(
»adResuÉ
::
cÚšsKey
)

148 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

149 ià(
	gŒªsã¼edAdd»s£s
.
equ®s
(
add»s£s
)) {

150 
	gLi¡
<
	gLogD©a
> 
	glogD©a
 = 
»adResuÉ
.
’ŒyS‘
().
¡»am
()

151 .
sÜ‹d
(
M­
.
EÁry
.
com·ršgByKey
())

152 .
m­
(
’Œy
 -> (
LogD©a
è’Œy.
g‘V®ue
()).
cŞËù
(
CŞËùÜs
.
toLi¡
());

153  
	gR—dB©ch
.
bud”
()

154 .
d©a
(
logD©a
)

155 .
de¡š©iÚ
(destination)

156 .
¡©us
(
R—dB©ch
.
R—dStus
.
SUCCEEDED
)

157 .
bud
();

159 
	gHashS‘
<
	gLÚg
> 
	gŒªsã¼edS‘
 = 
Ãw
 
HashS‘
<>(
Œªsã¼edAdd»s£s
);

160 
	gHashS‘
<
	gLÚg
> 
	g’tœeS‘
 = 
Ãw
 
HashS‘
<>(
add»s£s
);

161 
	gLi¡
<
	gLÚg
> 
	gçedAdd»s£s
 = 
Ord”šg


162 .
Çtu¿l
()

163 .
sÜ‹dCİy
(
S‘s
.
difã»nû
(
’tœeS‘
, 
Œªsã¼edS‘
));

164  
	gR—dB©ch
.
bud”
()

165 .
çedAdd»s£s
(failedAddresses)

166 .
de¡š©iÚ
(destination)

167 .
¡©us
(
R—dB©ch
.
R—dStus
.
FAILED
)

168 .
bud
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/exceptions/ReadBatchException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrExû±iÚ
;

9 
public
 cÏs 
	cR—dB©chExû±iÚ
 
ex‹nds
 
	mS‹T¿nsãrExû±iÚ
 {

10 
public
 
	$R—dB©chExû±iÚ
(
ThrowabË
 
throwabË
) {

11 
	`su³r
(
throwabË
);

14 
public
 
	$R—dB©chExû±iÚ
() {

15 
	`su³r
();

16 
	}
}

18 
public
 
	$R—dB©chExû±iÚ
(
SŒšg
 
mes§ge
) {

19 
	`su³r
(
mes§ge
);

20 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/exceptions/StateTransferBatchProcessorException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrExû±iÚ
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

10 
public
 cÏs 
	cS‹T¿nsãrB©chProûssÜExû±iÚ
 
ex‹nds
 
	mS‹T¿nsãrExû±iÚ
 {

11 
public
 
	$S‹T¿nsãrB©chProûssÜExû±iÚ
(
ThrowabË
 
throwabË
) {

12 
	`su³r
(
throwabË
);

15 
public
 
	$S‹T¿nsãrB©chProûssÜExû±iÚ
() {

16 
	`su³r
();

17 
	}
}

19 
public
 
	$S‹T¿nsãrB©chProûssÜExû±iÚ
(
SŒšg
 
mes§ge
) {

20 
	`su³r
(
mes§ge
);

21 
	}
}

23 
public
 
	$S‹T¿nsãrB©chProûssÜExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
throwabË
) {

24 
	`su³r
(
mes§ge
, 
throwabË
);

25 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/exceptions/TransferSegmentException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrExû±iÚ
;

9 
public
 cÏs 
	cT¿nsãrSegm’tExû±iÚ
 
ex‹nds
 
	mS‹T¿nsãrExû±iÚ
 {

10 
public
 
	$T¿nsãrSegm’tExû±iÚ
(
ThrowabË
 
throwabË
) {

11 
	`su³r
(
throwabË
);

14 
public
 
	$T¿nsãrSegm’tExû±iÚ
() {

15 
	`su³r
();

16 
	}
}

18 
public
 
	$T¿nsãrSegm’tExû±iÚ
(
SŒšg
 
mes§ge
) {

19 
	`su³r
(
mes§ge
);

20 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/DataReceiver.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
public
 
š‹rçû
 
	gD©aReûiv”
 {

13 
LogR•liÿtiÚEÁry
 
»ûive
(LogR•liÿtiÚEÁry 
mes§ge
);

15 
LogR•liÿtiÚEÁry
 
»ûive
(
Li¡
<LogR•liÿtiÚEÁry> 
mes§ges
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/DataSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

16 
public
 
š‹rçû
 
	gD©aS’d”
 {

24 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
£nd
(
LogR•liÿtiÚEÁry
 
mes§ge
);

32 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
£nd
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
);

39 
ÚE¼Ü
(
LogR•liÿtiÚE¼Ü
 
”rÜ
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/LogEntryWriter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

19 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

31 @
	gNÙTh»adSaã


32 @
Slf4j


33 
public
 cÏs 
	cLogEÁryWr™”
 {

34 
´iv©e
 
fš®
 
	mMAX_NUM_TX_RETRY
 = 3;

36 @
S‘‹r


37 
´iv©e
 
	mmaxMsgQueSize
 = 
SškMªag”
.
DEFAULT_READER_QUEUE_SIZE
;

39 
´iv©e
 
	mS‘
<
	mUUID
> 
	m¡»amUUIDs
;

40 
	mHashM­
<
	mUUID
, 
	mISŒ—mV›w
> 
	m¡»amV›wM­
;

41 
CÜfuRuÁime
 
	m¹
;

42 
´iv©e
 
	m¤cGlob®SÇpshÙ
;

43 
´iv©e
 
	mÏ¡MsgTs
;

44 
´iv©e
 
P”si¡edWr™”M‘ad©a
 
	m³rsi¡edWr™”M‘ad©a
;

46 
public
 
	$LogEÁryWr™”
(
CÜfuRuÁime
 
¹
, 
LogR•liÿtiÚCÚfig
 
cÚfig
, 
P”si¡edWr™”M‘ad©a
 
³rsi¡edWr™”M‘ad©a
) {

47 
this
.
¹
 =„t;

48 
this
.
³rsi¡edWr™”M‘ad©a
 =…ersistedWriterMetadata;

50 
S‘
<
SŒšg
> 
¡»ams
 = 
cÚfig
.
	`g‘SŒ—msToR•liÿ‹
();

51 
¡»amUUIDs
 = 
Ãw
 
HashS‘
<>();

53 
SŒšg
 
s
 : 
¡»ams
) {

54 
¡»amUUIDs
.
	`add
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
s
));

57 
¤cGlob®SÇpshÙ
 = 
Add»ss
.
NON_ADDRESS
;

58 
Ï¡MsgTs
 = 
Add»ss
.
NON_ADDRESS
;

60 
¡»amV›wM­
 = 
Ãw
 
HashM­
<>();

62 
UUID
 
uuid
 : 
¡»amUUIDs
) {

63 
¡»amV›wM­
.
	`put
(
uuid
, 
¹
.
	`g‘SŒ—msV›w
().
	`g‘Un§ã
(uuid));

73 
	$v”ifyM‘ad©a
(
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
è
throws
 
R•liÿtiÚWr™”Exû±iÚ
 {

74 ià(
m‘ad©a
.
	`g‘Mes§geM‘ad©aTy³
(è!ğ
Mes§geTy³
.
LOG_ENTRY_MESSAGE
) {

75 
log
.
	`”rÜ
("WrÚg mes§gm‘ad©¨{},ƒx³ùšgy³ {} sÇpshÙ {}", 
m‘ad©a
,

76 
Mes§geTy³
.
LOG_ENTRY_MESSAGE
, 
¤cGlob®SÇpshÙ
);

77 
throw
 
Ãw
 
	`R•liÿtiÚWr™”Exû±iÚ
("wrongype of message");

79 
	}
}

85 
	$´oûssMsg
(
LogR•liÿtiÚEÁry
 
txMes§ge
) {

86 
boŞ—n
 
doR‘ry
 = 
Œue
;

87 
numR‘ry
 = 0;

88 
O·queEÁry
 
İaqueEÁry
 = O·queEÁry.
	`de£rŸlize
(
UÅoŞed
.
	`w¿µedBufãr
(
txMes§ge
.
	`g‘Paylßd
()));

89 
M­
<
UUID
, 
Li¡
<
SMREÁry
>> 
m­
 = 
İaqueEÁry
.
	`g‘EÁr›s
();

91 ià(!
¡»amUUIDs
.
	`cÚšsAÎ
(
m­
.
	`keyS‘
())) {

92 
log
.
	`”rÜ
("txMes§gcÚš noisy sŒ—m {},ƒx³ùšg {}", 
m­
.
	`keyS‘
(), 
¡»amUUIDs
);

93 
throw
 
Ãw
 
	`R•liÿtiÚWr™”Exû±iÚ
("Wrong streams set");

97 
•och
 = 
txMes§ge
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
();

98 
msgTs
 = 
txMes§ge
.
	`g‘M‘ad©a
().
time¡amp
;

99 
³rsi¡Ts
 = 
Add»ss
.
NON_ADDRESS
;

101 
doR‘ry
 && 
numR‘ry
++ < 
MAX_NUM_TX_RETRY
) {

102 
Œy
 {

103 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

104 
³rsi¡Ts
 = 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡Proûs£dLogTime¡amp
();

105 ià(
•och
 =ğ
³rsi¡edWr™”M‘ad©a
.
	`g‘S™eEpoch
(è&& 
msgTs
 > 
³rsi¡Ts
 ) {

106 
UUID
 
uuid
 : 
İaqueEÁry
.
	`g‘EÁr›s
().
	`keyS‘
()) {

107 
SMREÁry
 
smrEÁry
 : 
İaqueEÁry
.
	`g‘EÁr›s
().
	`g‘
(
uuid
)) {

108 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`logUpd©e
(
uuid
, 
smrEÁry
);

112 
³rsi¡edWr™”M‘ad©a
.
	`£tS™eEpoch
(
•och
);

113 
³rsi¡edWr™”M‘ad©a
.
	`£tLa¡Proûs£dLogTime¡amp
(
msgTs
);

114 
log
.
	`Œaû
("Will‡ppend msg {}‡s itsimestamp is‚ot†aterhanhe…ersisted one {}",

115 
txMes§ge
.
	`g‘M‘ad©a
(), 
³rsi¡Ts
);

117 
log
.
	`w¬n
("Skip writehis msg {}‡s itsimestamp is†aterhanhe…ersisted one {}",

118 
txMes§ge
.
	`g‘M‘ad©a
(), 
³rsi¡Ts
);

120 
doR‘ry
 = 
çl£
;

121 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

122 
log
.
	`w¬n
("Caughˆªƒxû±iÚ {} , wÈ»Œy", 
e
);

123 } 
fš®ly
 {

124 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

127 
Ï¡MsgTs
 = 
M©h
.
	`max
(
³rsi¡Ts
, 
msgTs
);

128 
	}
}

136 
public
 
	$­¶y
(
LogR•liÿtiÚEÁry
 
msg
è
throws
 
R•liÿtiÚWr™”Exû±iÚ
 {

138 
	`v”ifyM‘ad©a
(
msg
.
	`g‘M‘ad©a
());

141 ià(
msg
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
(è< 
¤cGlob®SÇpshÙ
) {

142 
log
.
	`w¬n
("Received message with snapshot {} is smallerhan current snapshot {}.Ignore it",

143 
msg
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
(), 
¤cGlob®SÇpshÙ
);

144  
Add»ss
.
NON_ADDRESS
;

148 ià(
msg
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
(è> 
¤cGlob®SÇpshÙ
) {

149 
¤cGlob®SÇpshÙ
 = 
msg
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
();

150 
Ï¡MsgTs
 = 
¤cGlob®SÇpshÙ
;

154 ià(
msg
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
(è<ğ
Ï¡MsgTs
) {

155 
log
.
	`w¬n
("Received message with snapshot {} is smallerhan†astMsgTs {}.Ignore it",

156 
msg
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
(), 
Ï¡MsgTs
);

157  
Add»ss
.
NON_ADDRESS
;

162 ià(
msg
.
	`g‘M‘ad©a
().
	`g‘P»viousTime¡amp
(è=ğ
Ï¡MsgTs
) {

163 
	`´oûssMsg
(
msg
);

164  
Ï¡MsgTs
;

167  
Add»ss
.
NON_ADDRESS
;

168 
	}
}

178 
public
 
	$£tTime¡amp
(
¢­shÙ
, 
ackTime¡amp
) {

179 
¤cGlob®SÇpshÙ
 = 
¢­shÙ
;

180 
Ï¡MsgTs
 = 
ackTime¡amp
;

181 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/LogReplicationConfig.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

8 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

9 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

10 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

11 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

12 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 @
	gD©a


16 @
Slf4j


17 
public
 cÏs 
	cLogR•liÿtiÚCÚfig
 {

22 
´iv©e
 
	mS‘
<
	mSŒšg
> 
	m¡»amsToR•liÿ‹
;

27 
´iv©e
 
UUID
 
	ms™eID
 = UUID.
¿ndomUUID
();

32 
´iv©e
 
UUID
 
	m»mÙeS™eID
;

34 
´iv©e
 
fš®
 
SŒšg
 
	mSTREAMS_TO_REPLICATE_KEY
 = "StreamsToReplicate";

35 
´iv©e
 
fš®
 
SŒšg
 
	mREMOTE_SITE_UUID_KEY
 = "RemoteSiteId";

43 
public
 
LogR•liÿtiÚCÚfig
(
S‘
<
SŒšg
> 
¡»amsToR•liÿ‹
, @
NÚNuÎ
 
UUID
 
s™eID
, @NÚNuÎ UUID 
»mÙeS™eID
) {

44 
	mthis
.
	m¡»amsToR•liÿ‹
 = 
¡»amsToR•liÿ‹
;

45 
	mthis
.
	ms™eID
 = 
s™eID
;

46 
	mthis
.
	m»mÙeS™eID
 = 
»mÙeS™eID
;

49 
public
 
LogR•liÿtiÚCÚfig
 
	$äomFe
(
SŒšg
 
feP©h
) {

51 
	`Œy
 (
IÅutSŒ—m
 
šput
 = 
Ãw
 
	`FeIÅutSŒ—m
(
feP©h
)) {

53 
Prİ”t›s
 
´İ
 = 
Ãw
 
	`Prİ”t›s
();

55 ià(
šput
 =ğ
nuÎ
) {

56 
log
.
	`šfo
("Log R•liÿtiÚ CÚfig {}‚Ù found, DEFAULT v®ue wÈbu£d.", 
feP©h
);

57  
	`g‘DeçuÉCÚfig
();

62 
´İ
.
	`lßd
(
šput
);

65 
S‘
<
SŒšg
> 
¡»amsToR•liÿ‹
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
	`asLi¡
(
´İ
.
	`g‘Prİ”ty
(
STREAMS_TO_REPLICATE_KEY
).
	`¥l™
(",")));

66 
UUID
 
»mÙeS™eId
 = UUID.
	`äomSŒšg
(
´İ
.
	`g‘Prİ”ty
(
REMOTE_SITE_UUID_KEY
));

68 
log
.
	`šfo
("Lßded†og„•liÿtiÚ cÚfig: sŒ—m tØ»¶iÿ‹ [{}],„emÙs™id {}", 
¡»amsToR•liÿ‹
, 
»mÙeS™eId
);

69  
Ãw
 
	`LogR•liÿtiÚCÚfig
(
¡»amsToR•liÿ‹
, 
UUID
.
	`¿ndomUUID
(), 
»mÙeS™eId
);

71 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

72 
log
.
	`”rÜ
("Caughˆexû±iÚ wh»adšg†og„•liÿtiÚ cÚfig f{}", 
feP©h
, 
e
);

75  
	`g‘DeçuÉCÚfig
();

76 
	}
}

78 
´iv©e
 
LogR•liÿtiÚCÚfig
 
	$g‘DeçuÉCÚfig
() {

79 
S‘
<
SŒšg
> 
¡»amsToR•liÿ‹
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
	`asLi¡
("Table001", "Table002", "Table003"));

80  
Ãw
 
	`LogR•liÿtiÚCÚfig
(
¡»amsToR•liÿ‹
, 
UUID
.
	`¿ndomUUID
(), UUID.randomUUID());

81 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/LogReplicationError.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

6 
public
 
	eLogR•liÿtiÚE¼Ü
 {

7 
TRIM_SNAPSHOT_SYNC
(0, "Arimƒxception has occurred during snapshot sync."),

8 
TRIM_LOG_ENTRY_SYNC
(1, "Arimƒxception has occurred during†ogƒntry sync."),

9 
LOG_ENTRY_ACK_TIMEOUT
(2, "Log Entry Sync‡ck hasimed out."),

10 
ILLEGAL_TRANSACTION
 (3, "Illegal Transaction‡cross„eplicated‡nd‚on-replicated streams. " +

12 
UNKNOWN
 (4, "Unknownƒxception caused sync cancel.");

14 
´iv©e
 
fš®
 
	mcode
;

15 
´iv©e
 
fš®
 
SŒšg
 
	mdesütiÚ
;

23 
LogR•liÿtiÚE¼Ü
(
code
, 
SŒšg
 
desütiÚ
) {

24 
	mthis
.
	mcode
 = 
code
;

25 
	mthis
.
	mdesütiÚ
 = 
desütiÚ
;

28 
public
 
SŒšg
 
g‘DesütiÚ
() {

29  
	mdesütiÚ
;

32 
public
 
g‘Code
() {

33  
	mcode
;

36 @
Ov”ride


37 
public
 
SŒšg
 
toSŒšg
() {

38  
	mcode
 + ": " + 
	mdesütiÚ
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/PersistedWriterMetadata.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aKey
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aV®
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabË
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTxBud”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

20 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

23 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

29 @
Slf4j


30 
public
 cÏs 
	cP”si¡edWr™”M‘ad©a
 {

31 
´iv©e
 
fš®
 
SŒšg
 
	mÇme¥aû
 = "CORFU_SYSTEM";

32 
´iv©e
 
fš®
 
SŒšg
 
	mTABLE_PREFIX_NAME
 = "CORFU-REPLICATION-WRITER-";

33 
´iv©e
 
fš®
 
	mNUM_RETRY_WRITE
 = 3;

34 
SŒšg
 
	mm‘ad©aTabËName
;

36 
´iv©e
 
CÜfuStÜe
 
	mcÜfuStÜe
;

38 
	mTabË
<
	mLogR•liÿtiÚM‘ad©aKey
, 
	mLogR•liÿtiÚM‘ad©aV®
, LogR•liÿtiÚM‘ad©aV®> 
	mm‘ad©aTabË
;

39 
	mCÜfuTabË
<
	mSŒšg
, 
	mLÚg
> 
	mwr™”M‘aD©aTabË
;

41 
CÜfuRuÁime
 
	mruÁime
;

43 
public
 
	$P”si¡edWr™”M‘ad©a
(
CÜfuRuÁime
 
¹
, 
s™eEpoch
, 
UUID
 
´im¬y
, UUID 
d¡
) {

44 
this
.
ruÁime
 = 
¹
;

45 
this
.
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

46 
m‘ad©aTabËName
 = 
	`g‘P”si¡edWr™”M‘ad©aTabËName
(
´im¬y
, 
d¡
);

47 
Œy
 {

48 
m‘ad©aTabË
 = 
this
.
cÜfuStÜe
.
	`İ’TabË
(
Çme¥aû
,

49 
m‘ad©aTabËName
,

50 
LogR•liÿtiÚM‘ad©aKey
.
şass
,

51 
LogR•liÿtiÚM‘ad©aV®
.
şass
,

52 
nuÎ
,

53 
TabËO±iÚs
.
	`bud”
().
	`bud
());

54 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

55 
log
.
	`”rÜ
("Caught‡nƒxception while openheable");

56 
Sy¡em
.
out
.
	`´št
("\nCaughˆªƒxû±iÚ whİ’hbË " + 
e
);

57 
throw
 
Ãw
 
	`R•liÿtiÚWr™”Exû±iÚ
(
e
);

59 
	`£tupEpoch
(
s™eEpoch
);

63 
	$qu”y
(
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
, 
P”si¡edWr™”M‘ad©aTy³
 
key
) {

64 
LogR•liÿtiÚM‘ad©aKey
 
txKey
 = LogR•liÿtiÚM‘ad©aKey.
	`ÃwBud”
().
	`£tKey
(
key
.
	`g‘V®
()).
	`bud
();

65 
CÜfuRecÜd
 
»cÜd
 = 
cÜfuStÜe
.
	`qu”y
(
Çme¥aû
).
	`g‘RecÜd
(
m‘ad©aTabËName
, 
time¡amp
, 
txKey
);

66 
LogR•liÿtiÚM‘ad©aV®
 
m‘ad©aV®
 = 
nuÎ
;

67 
v®
 = -1;

69 ià(
»cÜd
 !ğ
nuÎ
) {

70 
m‘ad©aV®
 = (
LogR•liÿtiÚM‘ad©aV®
)
»cÜd
.
	`g‘Paylßd
();

73 ià(
m‘ad©aV®
 !ğ
nuÎ
) {

74 
v®
 = 
m‘ad©aV®
.
	`g‘V®
();

77  
v®
;

78 
	}
}

80 
	$­³ndUpd©e
(
TxBud”
 
txBud”
, 
P”si¡edWr™”M‘ad©aTy³
 
key
, 
v®
) {

81 
LogR•liÿtiÚM‘ad©aKey
 
txKey
 = LogR•liÿtiÚM‘ad©aKey.
	`ÃwBud”
().
	`£tKey
(
key
.
	`g‘V®
()).
	`bud
();

82 
LogR•liÿtiÚM‘ad©aV®
 
txV®
 = LogR•liÿtiÚM‘ad©aV®.
	`ÃwBud”
().
	`£tV®
(
v®
).
	`bud
();

83 
txBud”
.
	`upd©e
(
m‘ad©aTabËName
, 
txKey
, 
txV®
, 
nuÎ
);

84 
	}
}

90 
public
 
	$£tupEpoch
(
•och
) {

91 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

92 
Sy¡em
.
out
.
	`´št
("\Áime¡am°" + 
time¡amp
);

93 
³rsi¡Epoch
 = 
	`qu”y
(
time¡amp
, 
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
);

95 ià(
•och
 <ğ
³rsi¡Epoch
)

98 
TxBud”
 
txBud”
 = 
cÜfuStÜe
.
	`tx
(
Çme¥aû
);

100 
P”si¡edWr™”M‘ad©aTy³
 
key
 : P”si¡edWr™”M‘ad©aTy³.
	`v®ues
()) {

101 
v®
 = 
Add»ss
.
NON_ADDRESS
;

102 ià(
key
 =ğ
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
) {

103 
v®
 = 
•och
;

105 
	`­³ndUpd©e
(
txBud”
, 
key
, 
v®
);

108 
txBud”
.
	`comm™
(
time¡amp
);

109 
Sy¡em
.
out
.
	`´št
("\ncomm™edh•och " + 
•och
);

110 
	}
}

112 
public
 
SŒšg
 
	$g‘P”si¡edWr™”M‘ad©aTabËName
(
UUID
 
´im¬yS™e
, UUID 
d¡
) {

113  
TABLE_PREFIX_NAME
 + 
´im¬yS™e
.
	`toSŒšg
(è+ "-to-" + 
d¡
.toString();

114 
	}
}

136 
public
 
	$£tSrcBa£SÇpshÙS¹
(
•och
, 
ts
) {

137 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

138 
³rsi¡Epoch
 = 
	`qu”y
(
time¡amp
, 
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
);

139 
³rsi¡SÇpS¹
 = 
	`qu”y
(
time¡amp
, 
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpS¹
);

142 ià(
•och
 !ğ
³rsi¡Epoch
) {

147 ià(
ts
 <ğ
³rsi¡SÇpS¹
) {

151 
TxBud”
 
txBud”
 = 
cÜfuStÜe
.
	`tx
(
Çme¥aû
);

154 
	`­³ndUpd©e
(
txBud”
, 
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
, 
•och
);

157 
	`­³ndUpd©e
(
txBud”
, 
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpS¹
, 
ts
);

160 
	`­³ndUpd©e
(
txBud”
, 
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpSeqNum
, 
Add»ss
.
NON_ADDRESS
);

161 
txBud”
.
	`comm™
(
time¡amp
);

164 
	}
}

166 
public
 
	$£tSrcBa£SÇpshÙS¹
(
ts
) {

167 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpS¹
.
	`g‘V®
(), 
ts
);

168 
	}
}

174 
public
 
	$£tSrcBa£SÇpshÙDÚe
(
LogR•liÿtiÚEÁry
 
’Œy
) {

175 
Œy
 {

176 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

177 
•och
 = 
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
.
	`g‘V®
());

178 
ts
 = 
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpS¹
.
	`g‘V®
());

179 ià(
•och
 =ğ
’Œy
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
(è&& 
ts
 =ğ’Œy.g‘M‘ad©a().
	`g‘SÇpshÙTime¡amp
()) {

180 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
.
	`g‘V®
(), 
•och
);

181 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpS¹
.
	`g‘V®
(), 
ts
);

182 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpT¿nsãrDÚe
.
	`g‘V®
(), 
ts
);

183 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpAµlyDÚe
.
	`g‘V®
(), 
ts
);

184 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡LogProûs£d
.
	`g‘V®
(), 
ts
);

185 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpSeqNum
.
	`g‘V®
(), 
Add»ss
.
NON_ADDRESS
);

186 
log
.
	`šfo
("upd©Ï¡SÇpT¿nsãrDÚ{} ", 
ts
);

188 
log
.
	`w¬n
("skip update†astSnapTransferDone‡s Epic curent {} !=…ersist {} or BaseSnapStart: current {} !=…ersist {}",

189 
’Œy
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
(), 
•och
,ƒÁry.g‘M‘ad©a().
	`g‘SÇpshÙTime¡amp
(), 
ts
);

191 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

192 
log
.
	`w¬n
("Transaction is‡borted. The snapshot has been updated by someoneƒlse");

193 } 
fš®ly
 {

194 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

196 
	}
}

198 
public
 
	$g‘La¡SÇpS¹Time¡amp
() {

199  
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpS¹
.
	`g‘V®
());

200 
	}
}

202 
public
 
	$g‘La¡SrcBa£SÇpshÙTime¡amp
() {

203  
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpAµlyDÚe
.
	`g‘V®
());

204 
	}
}

211 
public
 
	$£tLa¡Proûs£dLogTime¡amp
(
ts
) {

212 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡LogProûs£d
.
	`g‘V®
(), 
ts
);

213 
	}
}

215 
public
 
	$g‘La¡Proûs£dLogTime¡amp
() {

216  
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
La¡LogProûs£d
.
	`g‘V®
());

217 
	}
}

223 
public
 
	$£tLa¡SÇpT¿nsãrDÚeTime¡amp
(
ts
) {

224 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpT¿nsãrDÚe
.
	`g‘V®
(), 
ts
);

225 
	}
}

227 
public
 
	$g‘La¡SÇpT¿nsãrDÚeTime¡amp
() {

228  
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpT¿nsãrDÚe
.
	`g‘V®
());

229 
	}
}

235 
public
 
	$£tLa¡SÇpSeqNum
(
ts
) {

236 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpSeqNum
.
	`g‘V®
(), 
ts
);

237 
	}
}

239 
public
 
	$g‘La¡SÇpSeqNum
() {

240  
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
La¡SÇpSeqNum
.
	`g‘V®
());

241 
	}
}

243 
public
 
	$£tS™eEpoch
(
ts
) {

244 
wr™”M‘aD©aTabË
.
	`put
(
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
.
	`g‘V®
(), 
ts
);

245 
	}
}

247 
public
 
	$g‘S™eEpoch
() {

248  
wr™”M‘aD©aTabË
.
	`g‘
(
P”si¡edWr™”M‘ad©aTy³
.
S™eEpoch
.
	`g‘V®
());

249 
	}
}

251 
public
 
	eP”si¡edWr™”M‘ad©aTy³
 {

252 
S™eEpoch
("SiteEpic"),

253 
La¡SÇpS¹
("lastSnapStart"),

254 
La¡SÇpT¿nsãrDÚe
("lastSnapTransferDone"),

255 
La¡SÇpAµlyDÚe
("lastSnapApplied"),

256 
La¡SÇpSeqNum
("lastSnapSeqNum"),

257 
La¡LogProûs£d
("lastLogProcessed");

259 @
G‘‹r


260 
SŒšg
 
	gv®
;

261 
P”si¡edWr™”M‘ad©aTy³
(
SŒšg
 
ÃwV®
) {

262 
	gv®
 = 
ÃwV®
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/ReplicationWriterException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
public
 cÏs 
	cR•liÿtiÚWr™”Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

4 
public
 
	$R•liÿtiÚWr™”Exû±iÚ
() { }

6 
public
 
	$R•liÿtiÚWr™”Exû±iÚ
(
SŒšg
 
mes§ge
) {

7 
	`su³r
(
mes§ge
);

8 
	}
}

10 
public
 
	$R•liÿtiÚWr™”Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

11 
	`su³r
(
mes§ge
, 
ÿu£
);

12 
	}
}

14 
public
 
	$R•liÿtiÚWr™”Exû±iÚ
(
ThrowabË
 
ÿu£
) {

15 
	`su³r
(
ÿu£
);

16 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/SinkBufferManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

9 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

11 @
Slf4j


21 
public
 cÏs 
	cSškBufãrMªag”
 {

23 
	mHashM­
<
	mLÚg
, 
	mLogR•liÿtiÚEÁry
> 
	mbufãr
;

24 
SškMªag”
 
	msškMªag”
;

25 
Mes§geTy³
 
	mty³
;

26 
	msize
;

29 
´iv©e
 
	mackCyşeTime
;

32 
´iv©e
 
	mackCyşeCÁ
;

35 
´iv©e
 
	mackCÁ
 = 0;

36 
´iv©e
 
	mackTime
 = 0;

42 
	mÃxtKey
;

44 
public
 
	$SškBufãrMªag”
(
Mes§geTy³
 
ty³
, 
ackCyşeTime
, 
ackCyşeCÁ
, 
size
, 
ÃxtKey
, 
SškMªag”
 
sškMªag”
) {

45 
this
.
ty³
 =ype;

46 
this
.
ackCyşeTime
 =‡ckCycleTime;

47 
this
.
ackCyşeCÁ
 =‡ckCycleCnt;

48 
this
.
size
 = size;

49 
this
.
sškMªag”
 = sinkManager;

50 
this
.
ÃxtKey
 =‚extKey;

51 
bufãr
 = 
Ãw
 
HashM­
<>();

54 
	$g‘Key
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
’Œy
) {

55 
’Œy
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
()) {

56 
SNAPSHOT_MESSAGE
:

57  
’Œy
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙSyncSeqNum
();

58 
LOG_ENTRY_MESSAGE
:

59  
’Œy
.
	`g‘M‘ad©a
().
	`g‘P»viousTime¡amp
();

61 
log
.
	`w¬n
("wrÚgy³ oàm‘ad©¨{}", 
’Œy
.
	`g‘M‘ad©a
());

64 
	}
}

66 
	$g‘NextKey
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
’Œy
) {

67 
’Œy
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
()) {

68 
SNAPSHOT_MESSAGE
:

69  
’Œy
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙSyncSeqNum
() + 1;

70 
LOG_ENTRY_MESSAGE
:

71  
’Œy
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
();

73 
log
.
	`w¬n
("wrÚgy³ oàm‘ad©¨{}", 
’Œy
.
	`g‘M‘ad©a
());

76 
	}
}

78 
	$´oûssBufãr
() {

79 
Œue
) {

80 
LogR•liÿtiÚEÁry
 
d©aMes§ge
 = 
bufãr
.
	`g‘
(
ÃxtKey
);

81 ià(
d©aMes§ge
 =ğ
nuÎ
)

83 
sškMªag”
.
	`»ûiveW™houtBufãršg
(
d©aMes§ge
);

84 
ÃxtKey
 = 
	`g‘NextKey
(
d©aMes§ge
);

86 
	}
}

88 
boŞ—n
 
	$shouldAck
() {

89 
ackCÁ
++;

90 
cu¼’tTime
 = 
java
.
Ïng
.
Sy¡em
.
	`cu¼’tTimeMlis
();

91 ià(
ackCÁ
 =ğ
ackCyşeCÁ
 || (
cu¼’tTime
 - 
ackTime
è>ğ
ackCyşeTime
) {

92 
ackCÁ
 = 0;

93 
ackTime
 = 
cu¼’tTime
;

94  
Œue
;

97  
çl£
;

98 
	}
}

100 
LogR•liÿtiÚEÁryM‘ad©a
 
	$makeAckMes§ge
(
LogR•liÿtiÚEÁry
 
’Œy
) {

101 
ackTime¡amp
;

102 
Mes§geTy³
 
mes§geTy³
;

103 
ty³
) {

104 
SNAPSHOT_MESSAGE
:

105 
ackTime¡amp
 = 
ÃxtKey
 - 1;

106 
mes§geTy³
 = 
Mes§geTy³
.
SNAPSHOT_REPLICATED
;

108 
LOG_ENTRY_MESSAGE
:

109 
ackTime¡amp
 = 
ÃxtKey
;

110 
mes§geTy³
 = 
Mes§geTy³
.
LOG_ENTRY_REPLICATED
;

113 
log
.
	`”rÜ
("WrÚgy³ oàmes§g{}", 
ty³
);

116 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
Ãw
 
	`LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
.
LOG_ENTRY_REPLICATED
,

117 
’Œy
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
(),

118 
’Œy
.
	`g‘M‘ad©a
().
	`g‘SyncReque¡Id
(), 
ÃxtKey
,

119 
’Œy
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
());

120  
m‘ad©a
;

121 
	}
}

130 
public
 
LogR•liÿtiÚEÁry
 
	$´oûssMsgAndBufãr
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
d©aMes§ge
) {

131 ià(
d©aMes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è!ğ
ty³
) {

132 
log
.
	`w¬n
("GÙ msgy³ {} buˆex³ùšgy³ {}", 
d©aMes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(), 
ty³
);

133  
nuÎ
;

136 
key
 = 
	`g‘Key
(
d©aMes§ge
);

138 ià(
	`g‘Key
(
d©aMes§ge
è=ğ
ÃxtKey
) {

139 
sškMªag”
.
	`»ûiveW™houtBufãršg
(
d©aMes§ge
);

140 
ÃxtKey
 = 
	`g‘NextKey
(
d©aMes§ge
);

141 
	`´oûssBufãr
();

143 
bufãr
.
	`put
(
key
, 
d©aMes§ge
);

149 ià(
	`shouldAck
()) {

150 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
	`makeAckMes§ge
(
d©aMes§ge
);

151  
Ãw
 
	`LogR•liÿtiÚEÁry
(
m‘ad©a
,‚ew 
by‹
[0]);

154  
nuÎ
;

155 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/SinkManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
impÜt
 
	gjava
.
	gio
.
	gFe
;

14 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
.
	gLOG_ENTRY_MESSAGE
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
.
	gSNAPSHOT_MESSAGE
;

28 @
Slf4j


29 
public
 cÏs 
	cSškMªag”
 
im¶em’ts
 
	mD©aReûiv”
 {

30 
´iv©e
 
fš®
 
SŒšg
 
	mcÚfig_fe
 = "/config/corfu/corfu_replication_config.properties";

32 
public
 
fš®
 
	mDEFAULT_READER_QUEUE_SIZE
 = 1;

33 
public
 
fš®
 
	mDEFAULT_RESENT_TIMER
 = 5000;

34 
public
 
fš®
 
	mDEFAULT_MAX_RETRY
 = 5;

36 
´iv©e
 
	mackCyşeTime
 = 
DEFAULT_RESENT_TIMER
/ 
DEFAULT_MAX_RETRY
;

37 
´iv©e
 
	mackCyşeCÁ
 = 
DEFAULT_READER_QUEUE_SIZE
;

38 
´iv©e
 
	mbufãrSize
 = 
DEFAULT_READER_QUEUE_SIZE
;

40 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

41 
´iv©e
 
SškBufãrMªag”
 
	msškBufãrMªag”
;

42 
´iv©e
 
SŒ—msSÇpshÙWr™”
 
	m¢­shÙWr™”
;

43 
´iv©e
 
LogEÁryWr™”
 
	mlogEÁryWr™”
;

45 @
G‘‹r


46 
´iv©e
 
P”si¡edWr™”M‘ad©a
 
	m³rsi¡edWr™”M‘ad©a
;

47 
´iv©e
 
RxS‹
 
	mrxS‹
;

49 
´iv©e
 
LogR•liÿtiÚCÚfig
 
	mcÚfig
;

50 
´iv©e
 
UUID
 
	m¢­shÙReque¡Id
 = 
Ãw
 UUID(0L, 0L);

52 
´iv©e
 
	mrxMes§geCouÁ”
 = 0;

53 
´iv©e
 
	ms™eEpoch
 = 0;

56 @
	mVisibËFÜTe¡šg


57 @
G‘‹r


58 
´iv©e
 
Ob£rvabËV®ue
 
	mrxMes§geCouÁ
 = 
Ãw
 Ob£rvabËV®ue(
rxMes§geCouÁ”
);

66 
public
 
	$SškMªag”
(
SŒšg
 
loÿlCÜfuEndpošt
, 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

67 
this
.
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(CÜfuRuÁime.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
())

68 .
	`·r£CÚfigu¿tiÚSŒšg
(
loÿlCÜfuEndpošt
).
	`cÚÃù
();

69 
this
.
rxS‹
 = 
RxS‹
.
LOG_ENTRY_SYNC
;

70 
this
.
cÚfig
 = config;

71 
	`š™
();

74 
´iv©e
 
	$š™
() {

75 
³rsi¡edWr™”M‘ad©a
 = 
Ãw
 
	`P”si¡edWr™”M‘ad©a
(
ruÁime
, 0, 
cÚfig
.
	`g‘S™eID
(), cÚfig.
	`g‘RemÙeS™eID
());

76 
¢­shÙWr™”
 = 
Ãw
 
	`SŒ—msSÇpshÙWr™”
(
ruÁime
, 
cÚfig
, 
³rsi¡edWr™”M‘ad©a
);

77 
logEÁryWr™”
 = 
Ãw
 
	`LogEÁryWr™”
(
ruÁime
, 
cÚfig
, 
³rsi¡edWr™”M‘ad©a
);

78 
logEÁryWr™”
.
	`£tTime¡amp
(
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SrcBa£SÇpshÙTime¡amp
(),

79 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡Proûs£dLogTime¡amp
());

80 
	`»adCÚfig
();

81 
sškBufãrMªag”
 = 
Ãw
 
	`SškBufãrMªag”
(
LOG_ENTRY_MESSAGE
, 
ackCyşeTime
, 
ackCyşeCÁ
, 
bufãrSize
,

82 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡Proûs£dLogTime¡amp
(), 
this
);

83 
	}
}

85 
´iv©e
 
	$»adCÚfig
() {

86 
Œy
 {

87 
Fe
 
cÚfigFe
 = 
Ãw
 
	`Fe
(
cÚfig_fe
);

88 
FeR—d”
 
»ad”
 = 
Ãw
 
	`FeR—d”
(
cÚfigFe
);

90 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

91 
´İs
.
	`lßd
(
»ad”
);

93 
bufãrSize
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("log_wr™”_queue_size", IÁeg”.
	`toSŒšg
(
DEFAULT_READER_QUEUE_SIZE
)));

94 
logEÁryWr™”
.
	`£tMaxMsgQueSize
(
bufãrSize
);

96 
ackCyşeCÁ
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("log_wr™”_ack_cyşe_couÁ", IÁeg”.
	`toSŒšg
(
DEFAULT_READER_QUEUE_SIZE
)));

97 
ackCyşeTime
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("log_wr™”_ack_cyşe_time", IÁeg”.
	`toSŒšg
(
DEFAULT_RESENT_TIMER
)));

98 
»ad”
.
	`şo£
();

99 
log
.
	`šfo
("Log writer config queue size {}‡ckCycleCnt {}‡ckCycleTime {}",

100 
bufãrSize
, 
ackCyşeCÁ
, 
ackCyşeTime
);

101 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

102 
log
.
	`w¬n
("Caughˆªƒxû±iÚ wh»adšghcÚfig fe: {}", 
e
.
	`g‘Cau£
());

104 
	}
}

106 @
Ov”ride


107 
public
 
LogR•liÿtiÚEÁry
 
	$»ûive
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

108 
log
.
	`šfo
("Sšk mªag”„eûived {} whš {}", 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(), 
rxS‹
);

109 
s™eEpoch
 = 
M©h
.
	`max
(s™eEpoch, 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
());

111 ià(!
	`»ûivedV®idMes§ge
(
mes§ge
)) {

113 ià(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
().
	`equ®s
(
Mes§geTy³
.
SNAPSHOT_START
)) {

114 
rxS‹
 = 
RxS‹
.
SNAPSHOT_SYNC
;

117 
log
.
	`w¬n
("Sšk Mªag” iÀ¡©{}‡nd„eûived mes§g{}. Drİpšg Mes§ge.", 
rxS‹
,

118 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
());

119 
Sy¡em
.
out
.
	`´št
("****Sšk Mªag” iÀ¡©" + 
rxS‹
 + "‡nd„eceived message {}. Dropping Message." +

120 
mes§ge
.
	`g‘M‘ad©a
());

121  
nuÎ
;

125 ià(
rxS‹
.
	`equ®s
(
RxS‹
.
LOG_ENTRY_SYNC
)) {

126  
sškBufãrMªag”
.
	`´oûssMsgAndBufãr
(
mes§ge
);

130  
	`»ûiveW™houtBufãršg
(
mes§ge
);

131 
	}
}

133 @
Ov”ride


134 
public
 
LogR•liÿtiÚEÁry
 
»ûive
(
Li¡
<LogR•liÿtiÚEÁry> 
mes§ges
) {

135 
LogR•liÿtiÚEÁry
 
	gmsg
 : 
mes§ges
) {

136 
»ûive
(
msg
);

140 ià(
	gmes§ges
.
size
() > 0) {

141  
	gLogR•liÿtiÚEÁry
.
g’”©eAck
(
mes§ges
.
g‘
(0).
g‘M‘ad©a
());

144  
	gnuÎ
;

150 
´iv©e
 
LogR•liÿtiÚEÁry
 
	$com¶‘eSÇpshÙAµly
(
LogR•liÿtiÚEÁry
 
šputEÁry
) {

151 
log
.
	`debug
("Complete of‡ snapshot‡pply");

153 
rxS‹
 = 
RxS‹
.
LOG_ENTRY_SYNC
;

154 
³rsi¡edWr™”M‘ad©a
.
	`£tSrcBa£SÇpshÙDÚe
(
šputEÁry
);

157 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
Ãw
 
	`LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
.
SNAPSHOT_END
,

158 
s™eEpoch
,

159 
¢­shÙReque¡Id
,

160 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡Proûs£dLogTime¡amp
(),

161 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SrcBa£SÇpshÙTime¡amp
(),

162 
¢­shÙReque¡Id
);

164 
sškBufãrMªag”
 = 
Ãw
 
	`SškBufãrMªag”
(
LOG_ENTRY_MESSAGE
, 
ackCyşeTime
, 
ackCyşeCÁ
, 
bufãrSize
,

165 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SrcBa£SÇpshÙTime¡amp
(), 
this
);

167  
LogR•liÿtiÚEÁry
.
	`g’”©eAck
(
m‘ad©a
);

168 
	}
}

170 
public
 
LogR•liÿtiÚEÁry
 
	$»ûiveW™houtBufãršg
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

172 
rxMes§geCouÁ”
++;

173 
rxMes§geCouÁ
.
	`£tV®ue
(
rxMes§geCouÁ”
);

175 ià(
log
.
	`isT¿ûEÇbËd
()) {

176 
log
.
	`Œaû
("Reûived d©aMes§gby Sšk Mªag”. TÙ® [{}]", 
rxMes§geCouÁ”
);

180 ià(
cÚfig
 !ğ
nuÎ
) {

181 
Œy
 {

182 ià(
rxS‹
 =ğ
RxS‹
.
SNAPSHOT_SYNC
) {

183  
	`­¶ySÇpshÙSync
(
mes§ge
);

184 } ià(
rxS‹
 =ğ
RxS‹
.
LOG_ENTRY_SYNC
) {

185 
	`­¶yLogEÁrySync
(
mes§ge
);

187  
nuÎ
;

189 } 
	`ÿtch
 (
R•liÿtiÚWr™”Exû±iÚ
 
e
) {

190 
log
.
	`”rÜ
("G‘‡Àexû±iÚ: ", 
e
);

192 
log
.
	`šfo
("Requested Snapshot Sync.");

195 
log
.
	`”rÜ
("Required LogReplicationConfig for Sink Manager.");

196 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Required LogReplicationConfig for Sink Manager.");

199  
nuÎ
;

200 
	}
}

202 
´iv©e
 
	$­¶yLogEÁrySync
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
mes§ge
) {

204 
ackTs
 = 
logEÁryWr™”
.
	`­¶y
(
mes§ge
);

210 
	}
}

212 
´iv©e
 
LogR•liÿtiÚEÁry
 
	$­¶ySÇpshÙSync
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

213 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
()) {

214 
SNAPSHOT_START
:

215 
	`š™ŸlizeSÇpshÙSync
(
mes§ge
);

217 
SNAPSHOT_MESSAGE
:

218 
¢­shÙWr™”
.
	`­¶y
(
mes§ge
);

220 
SNAPSHOT_END
:

221 
¢­shÙWr™”
.
	`¢­shÙT¿nsãrDÚe
(
mes§ge
);

222  
	`com¶‘eSÇpshÙAµly
(
mes§ge
);

224 
log
.
	`w¬n
("Mes§gty³ {} should‚Ù b­¶›d‡ ¢­shÙ sync.", 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
());

228  
nuÎ
;

229 
	}
}

231 
´iv©e
 
	$š™ŸlizeSÇpshÙSync
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
’Œy
) {

232 
s™eEpoch
 = 
’Œy
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
();

233 
time¡amp
 = 
’Œy
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
();

235 
log
.
	`debug
("Received snapshot sync start marker for {} on base snapshotimestamp {}",

236 
’Œy
.
	`g‘M‘ad©a
().
	`g‘SyncReque¡Id
(),ƒÁry.g‘M‘ad©a().
	`g‘SÇpshÙTime¡amp
());

239 
³rsi¡edWr™”M‘ad©a
.
	`£tSrcBa£SÇpshÙS¹
(
s™eEpoch
, 
time¡amp
);

242 
¢­shÙWr™”
.
	`»£t
(
s™eEpoch
, 
time¡amp
);

245 
¢­shÙReque¡Id
 = 
’Œy
.
	`g‘M‘ad©a
().
	`g‘SyncReque¡Id
();

246 
	}
}

248 
´iv©e
 
boŞ—n
 
	$»ûivedV®idMes§ge
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
mes§ge
) {

249  
rxS‹
 =ğ
RxS‹
.
SNAPSHOT_SYNC
 && (
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è=ğ
SNAPSHOT_MESSAGE


250 || 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è=ğ
Mes§geTy³
.
SNAPSHOT_START
 || mes§ge.g‘M‘ad©a().g‘Mes§geM‘ad©aTy³(è=ğMes§geTy³.
SNAPSHOT_END
)

251 || 
rxS‹
 =ğ
RxS‹
.
LOG_ENTRY_SYNC
 && 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è=ğ
Mes§geTy³
.
LOG_ENTRY_MESSAGE
;

252 
	}
}

254 
public
 
	$shutdown
() {

255 
this
.
ruÁime
.
	`shutdown
();

256 
	}
}

258 
	eRxS‹
 {

259 
	gSNAPSHOT_SYNC
,

260 
	gLOG_ENTRY_SYNC


	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/SnapshotWriter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
public
 
š‹rçû
 
	gSÇpshÙWr™”
 {

13 
­¶y
(
LogR•liÿtiÚEÁry
 
mes§ge
è
throws
 
	gExû±iÚ
;

15 
­¶y
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
è
throws
 
	gExû±iÚ
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/StreamsSnapshotWriter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gO·queSŒ—m
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

18 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

19 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gA¼ay
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

24 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

31 @
	gSlf4j


32 @
NÙTh»adSaã


33 
public
 cÏs 
	cSŒ—msSÇpshÙWr™”
 
im¶em’ts
 
	mSÇpshÙWr™”
 {

34 
´iv©e
 
fš®
 
	mMAX_NUM_TX_RETRY
 = 4;

35 
fš®
 
SŒšg
 
	mSHADOW_STREAM_NAME_SUFFIX
 = "_shadow";

36 
	mHashM­
<
	mUUID
, 
	mSŒšg
> 
	m¡»amV›wM­
;

37 
	mHashM­
<
	mUUID
, 
	mSŒšg
> 
	mshadowM­
;

38 
CÜfuRuÁime
 
	m¹
;

40 
	ms™eEpoch
;

41 
´iv©e
 
	m¤cGlob®SÇpshÙ
;

42 
´iv©e
 
	m»cvSeq
;

43 
´iv©e
 
	mshadowSŒ—mS¹Add»ss
;

44 @
G‘‹r


45 
´iv©e
 
P”si¡edWr™”M‘ad©a
 
	m³rsi¡edWr™”M‘ad©a
;

46 
	mHashM­
<
	mUUID
, UUID> 
	muuidM­
;

47 
Pha£
 
	mpha£
;

53 
public
 
	$SŒ—msSÇpshÙWr™”
(
CÜfuRuÁime
 
¹
, 
LogR•liÿtiÚCÚfig
 
cÚfig
, 
P”si¡edWr™”M‘ad©a
 
³rsi¡edWr™”M‘ad©a
) {

54 
this
.
¹
 =„t;

55 
this
.
³rsi¡edWr™”M‘ad©a
 =…ersistedWriterMetadata;

56 
¡»amV›wM­
 = 
Ãw
 
HashM­
<>();

57 
uuidM­
 = 
Ãw
 
HashM­
<>();

58 
shadowM­
 = 
Ãw
 
HashM­
<>();

59 
pha£
 = 
Pha£
.
T¿nsãrPha£
;

61 
SŒšg
 
¡»am
 : 
cÚfig
.
	`g‘SŒ—msToR•liÿ‹
()) {

62 
SŒšg
 
shadowSŒ—m
 = 
¡»am
 + 
SHADOW_STREAM_NAME_SUFFIX
;

63 
UUID
 
¡»amID
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am
);

64 
UUID
 
shadowID
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
shadowSŒ—m
);

65 
uuidM­
.
	`put
(
¡»amID
, 
shadowID
);

66 
uuidM­
.
	`put
(
shadowID
, 
¡»amID
);

67 
¡»amV›wM­
.
	`put
(
¡»amID
, 
¡»am
);

68 
shadowM­
.
	`put
(
shadowID
, 
shadowSŒ—m
);

73 
	$ş—rTabË
(
s™eEpoch
, 
UUID
 
¡»amID
) {

74 
boŞ—n
 
doR‘ry
 = 
Œue
;

75 
numR‘ry
 = 0;

76 
doR‘ry
 && 
numR‘ry
++ < 
MAX_NUM_TX_RETRY
) {

77 
Œy
 {

78 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

80 ià(
s™eEpoch
 =ğ
³rsi¡edWr™”M‘ad©a
.
	`g‘S™eEpoch
() &&

81 
¤cGlob®SÇpshÙ
 =ğ
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SÇpS¹Time¡amp
()) {

82 
SMREÁry
 
’Œy
 = 
Ãw
 
	`SMREÁry
("ş—r",‚ew 
A¼ay
[0], 
S”Ÿliz”s
.
PRIMITIVE
);

83 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`logUpd©e
(
¡»amID
, 
’Œy
);

84 
³rsi¡edWr™”M‘ad©a
.
	`£tS™eEpoch
(
s™eEpoch
);

85 
³rsi¡edWr™”M‘ad©a
.
	`£tSrcBa£SÇpshÙS¹
(
¤cGlob®SÇpshÙ
);

89 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

90 
log
.
	`šfo
("CË¬ sŒ—m {} ", 
¡»amID
);

91 
doR‘ry
 = 
çl£
;

92 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

93 
log
.
	`w¬n
("Caughˆªƒxû±iÚ {} wÈ»Œy {}", 
e
, 
numR‘ry
);

96 
	}
}

102 
	$ş—rTabËs
() {

103 
UUID
 
¡»amID
 : 
¡»amV›wM­
.
	`keyS‘
()) {

104 
UUID
 
u£dSŒ—mID
 = 
¡»amID
;

105 ià(
pha£
 =ğ
Pha£
.
T¿nsãrPha£
) {

106 
u£dSŒ—mID
 = 
uuidM­
.
	`g‘
(
¡»amID
);

108 
	`ş—rTabË
(
s™eEpoch
, 
u£dSŒ—mID
);

110 
	}
}

117 
	$v”ifyM‘ad©a
(
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
è
throws
 
R•liÿtiÚWr™”Exû±iÚ
 {

118 ià(
m‘ad©a
.
	`g‘Mes§geM‘ad©aTy³
(è!ğ
Mes§geTy³
.
SNAPSHOT_MESSAGE
 ||

119 
m‘ad©a
.
	`g‘SÇpshÙTime¡amp
(è!ğ
¤cGlob®SÇpshÙ
) {

120 
log
.
	`”rÜ
("snapshotƒxpected {} !=„ecv snapshot {}, metadata {}",

121 
¤cGlob®SÇpshÙ
, 
m‘ad©a
.
	`g‘SÇpshÙTime¡amp
(), metadata);

122 
throw
 
Ãw
 
	`R•liÿtiÚWr™”Exû±iÚ
("Message is out of order");

124 
	}
}

130 
public
 
	$»£t
(
s™eEpoch
, 
¢­shÙ
) {

131 
this
.
s™eEpoch
 = siteEpoch;

132 
¤cGlob®SÇpshÙ
 = 
¢­shÙ
;

133 
»cvSeq
 = 0;

136 
	`ş—rTabËs
();

137 
shadowSŒ—mS¹Add»ss
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

138 
	}
}

147 
´oûssO·queEÁry
(
Li¡
<
SMREÁry
> 
smrEÁr›s
, 
LÚg
 
cu¼’tSeqNum
, 
UUID
 
d¡UUID
) {

148 
	gnumR‘ry
 = 0;

149 
boŞ—n
 
	gdoR‘ry
 = 
Œue
;

150 
	g³rsi¡’tSeqNum
;

152 
	gdoR‘ry
 && 
	gnumR‘ry
++ < 
	gMAX_NUM_TX_RETRY
){

153 
	gŒy
 {

154 
	g¹
.
g‘ObjeùsV›w
().
TXBegš
();

156 
	g³rsi¡’tSeqNum
 = 
³rsi¡edWr™”M‘ad©a
.
g‘La¡SÇpSeqNum
();

158 ià(
	gs™eEpoch
 =ğ
³rsi¡edWr™”M‘ad©a
.
g‘S™eEpoch
() &&

159 
¤cGlob®SÇpshÙ
 =ğ
³rsi¡edWr™”M‘ad©a
.
g‘La¡SÇpS¹Time¡amp
() &&

160 
cu¼’tSeqNum
 =ğ(
³rsi¡’tSeqNum
 + 1)) {

161 
SMREÁry
 
smrEÁry
 : 
smrEÁr›s
) {

162 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
().
logUpd©e
(
d¡UUID
, 
smrEÁry
);

165 
	g³rsi¡edWr™”M‘ad©a
.
£tS™eEpoch
(
s™eEpoch
);

166 
	g³rsi¡edWr™”M‘ad©a
.
£tSrcBa£SÇpshÙS¹
(
¤cGlob®SÇpshÙ
);

167 
	g³rsi¡edWr™”M‘ad©a
.
£tLa¡SÇpSeqNum
(
cu¼’tSeqNum
);

168 
	glog
.
debug
("Proûs th’Œ› {}‡nd s‘ sequ’û‚umb” {} ", 
smrEÁr›s
, 
cu¼’tSeqNum
);

170 
	glog
.
w¬n
("Sk cu¼’ˆs™•och " + 
s™eEpoch
 + " srcGlob®SÇpshÙ " + 
¤cGlob®SÇpshÙ
 + " cu¼’tSeqNum " + 
cu¼’tSeqNum
 +

171 "…”si¡edM‘ad©¨" + 
³rsi¡edWr™”M‘ad©a
.
g‘S™eEpoch
(è+ " s¹SÇpshÙ " +…”si¡edWr™”M‘ad©a.
g‘La¡SÇpS¹Time¡amp
() +

172 "†a¡SÇpSeqNum " + 
³rsi¡edWr™”M‘ad©a
.
g‘La¡SÇpSeqNum
());

179 
	gdoR‘ry
 = 
çl£
;

180 } 
ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

181 
	glog
.
w¬n
("Caughˆªƒxû±iÚ {}, wÈ»Œy {}.", 
e
, 
numR‘ry
);

182 } 
	gfš®ly
 {

183 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

188 @
Ov”ride


189 
public
 
	$­¶y
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

190 
	`v”ifyM‘ad©a
(
mes§ge
.
	`g‘M‘ad©a
());

192 ià(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙSyncSeqNum
(è!ğ
»cvSeq
 ||

193 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è!ğ
Mes§geTy³
.
SNAPSHOT_MESSAGE
) {

194 
log
.
	`”rÜ
("Expecting sequencer {} !=„ecvSeq {} or wrong messageype {}ƒxpecting {}",

195 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙSyncSeqNum
(), 
»cvSeq
,

196 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(), 
Mes§geTy³
.
SNAPSHOT_MESSAGE
);

197 
throw
 
Ãw
 
	`R•liÿtiÚWr™”Exû±iÚ
("Message is out of order or wrongype");

200 
by‹
[] 
·ylßd
 = 
mes§ge
.
	`g‘Paylßd
();

201 
O·queEÁry
 
İaqueEÁry
 = O·queEÁry.
	`de£rŸlize
(
UÅoŞed
.
	`w¿µedBufãr
(
·ylßd
));

203 ià(
İaqueEÁry
.
	`g‘EÁr›s
().
	`keyS‘
().
	`size
() != 1) {

204 
log
.
	`”rÜ
("ThİaqueEÁry ha mÜthª oÃƒÁry {}", 
İaqueEÁry
);

208 
UUID
 
uuid
 = 
İaqueEÁry
.
	`g‘EÁr›s
().
	`keyS‘
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

209 
	`´oûssO·queEÁry
(
İaqueEÁry
.
	`g‘EÁr›s
().
	`g‘
(
uuid
), 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙSyncSeqNum
(), 
uuidM­
.get(uuid));

210 
»cvSeq
++;

211 
	}
}

213 @
Ov”ride


214 
public
 
­¶y
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
è
throws
 
	gExû±iÚ
 {

215 
LogR•liÿtiÚEÁry
 
	gmsg
 : 
mes§ges
) {

216 
­¶y
(
msg
);

224 
public
 
	$­¶yShadowSŒ—m
(
UUID
 
uuid
, 
LÚg
 
£qNum
, 
¢­shÙ
) {

225 
UUID
 
shadowUUID
 = 
uuidM­
.
	`g‘
(
uuid
);

226 
SŒ—mO±iÚs
 
İtiÚs
 = SŒ—mO±iÚs.
	`bud”
()

227 .
	`ignÜeTrimmed
(
çl£
)

228 .
	`ÿcheEÁr›s
(
çl£
)

229 .
	`bud
();

232 
SŒ—m
 
shadowSŒ—m
 = (
Ãw
 
	`O·queSŒ—m
(
¹
,„t.
	`g‘SŒ—msV›w
().
	`g‘
(
shadowUUID
, 
İtiÚs
))).
	`¡»amUpTo
(
¢­shÙ
);

234 
I‹¿tÜ
<
O·queEÁry
> 
™”©Ü
 = 
shadowSŒ—m
.
	`™”©Ü
();

235 
™”©Ü
.
	`hasNext
()) {

236 
O·queEÁry
 
İaqueEÁry
 = 
™”©Ü
.
	`Ãxt
();

237 ià(
İaqueEÁry
.
	`g‘V”siÚ
(è> 
shadowSŒ—mS¹Add»ss
) {

238 
	`´oûssO·queEÁry
(
İaqueEÁry
.
	`g‘EÁr›s
().
	`g‘
(
shadowUUID
), 
£qNum
, 
uuid
);

239 
£qNum
 = seqNum + 1;

243  
£qNum
;

244 
	}
}

250 
public
 
	$­¶yShadowSŒ—ms
(
LÚg
 
£qNum
) {

251 
pha£
 = 
Pha£
.
AµlyPha£
;

252 
¢­shÙ
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

253 
	`ş—rTabËs
();

254 
UUID
 
uuid
 : 
¡»amV›wM­
.
	`keyS‘
()) {

255 
£qNum
 = 
	`­¶yShadowSŒ—m
(
uuid
, seqNum, 
¢­shÙ
);

257 
	}
}

263 
public
 
	$¢­shÙT¿nsãrDÚe
(
LogR•liÿtiÚEÁry
 
’Œy
) {

264 
pha£
 = 
Pha£
.
AµlyPha£
;

266 
ts
 = 
’Œy
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
();

267 
£qNum
 = 0;

268 
Œy
 {

269 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

270 ià(
³rsi¡edWr™”M‘ad©a
.
	`g‘S™eEpoch
(è=ğ
’Œy
.
	`g‘M‘ad©a
().getSiteEpoch() &&

271 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SÇpS¹Time¡amp
(è=ğ
ts
 &&

272 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SÇpT¿nsãrDÚeTime¡amp
(è<ğ
ts
) {

273 
³rsi¡edWr™”M‘ad©a
.
	`£tS™eEpoch
(
’Œy
.
	`g‘M‘ad©a
().
	`g‘S™eEpoch
());

274 
³rsi¡edWr™”M‘ad©a
.
	`£tSrcBa£SÇpshÙS¹
(
ts
);

275 
³rsi¡edWr™”M‘ad©a
.
	`£tLa¡SÇpT¿nsãrDÚeTime¡amp
(
ts
);

276 
£qNum
 = 
³rsi¡edWr™”M‘ad©a
.
	`g‘La¡SÇpSeqNum
() + 1;

278 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

279 
log
.
	`w¬n
("ÿughˆªƒxû±iÚ ", 
e
);

280 } 
fš®ly
 {

281 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

284 ià(
£qNum
 == 0)

287 
	`­¶yShadowSŒ—ms
(
£qNum
);

288 
	}
}

290 
	ePha£
 {

291 
	gT¿nsãrPha£
,

292 
	gAµlyPha£


	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterAdvisor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gçu»d‘eùÜ
.
	gClu¡”G¿ph
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

8 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

18 
public
 
š‹rçû
 
	gClu¡”AdvisÜ
 {

28 
Clu¡”Ty³
 
g‘Ty³
();

39 
	gO±iÚ®
<
	gNodeRªk
> 
çedS”v”
(
Clu¡”S‹
 
şu¡”S‹
);

51 
	gO±iÚ®
<
	gNodeRªk
> 
h—ËdS”v”
(
Clu¡”S‹
 
şu¡”S‹
);

57 
Clu¡”G¿ph
 
g‘G¿ph
(
Clu¡”S‹
 
şu¡”S‹
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterAdvisorFactory.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

10 
public
 cÏs 
	cClu¡”AdvisÜFaùÜy
 {

12 
´iv©e
 
	$Clu¡”AdvisÜFaùÜy
() {

26 
public
 
Clu¡”AdvisÜ
 
	$ü—‹FÜSŒ©egy
(
Clu¡”Ty³
 
¡¿‹gy
, 
SŒšg
 
loÿlEndpošt
) {

27 
¡¿‹gy
) {

28 
COMPLETE_GRAPH
:

29  
Ãw
 
	`Com¶‘eG¿phAdvisÜ
(
loÿlEndpošt
);

30 
STAR_GRAPH
:

31 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
(
¡¿‹gy
.
	`Çme
());

33 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Unknown ClusterType");

36 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterStateAggregator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

11 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

18 @
Bud”


19 
public
 cÏs 
	cClu¡”S‹Agg»g©Ü
 {

21 @
NÚNuÎ


22 
´iv©e
 
fš®
 
SŒšg
 
	mloÿlEndpošt
;

24 @
NÚNuÎ


25 
´iv©e
 
fš®
 
	mLi¡
<
	mClu¡”S‹
> 
	mşu¡”S‹s
;

27 @
NÚNuÎ


28 
´iv©e
 
fš®
 
	mImmubËLi¡
<
	mSŒšg
> 
	muÄe¥ÚsiveNodes
;

46 
public
 
Clu¡”S‹
 
	$g‘Agg»g©edS‹
() {

47 ià(
şu¡”S‹s
.
	`isEm±y
()) {

48 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Insufficient cluster state");

51 ià(
şu¡”S‹s
.
	`size
() == 1) {

52  
şu¡”S‹s
.
	`g‘
(0);

55 
M­
<
SŒšg
, 
NodeS‹
> 
¡©eM­
 = 
şu¡”S‹s
.
	`¡»am
()

56 .
	`m­
(
Clu¡”S‹
::
g‘Nodes
)

57 .
	`»duû
((
´evNodes
, 
cu¼Nodes
) -> {

58 
M­
<
SŒšg
, 
NodeS‹
> 
aùu®S‹
 = 
Ãw
 
HashM­
<>();

60 
SŒšg
 
’dpošt
 : 
cu¼Nodes
.
	`keyS‘
()) {

61 
NodeS‹
 
´evNodeS‹
 = 
´evNodes
.
	`g‘
(
’dpošt
);

62 
NodeS‹
 
cu¼NodeS‹
 = 
cu¼Nodes
.
	`g‘
(
’dpošt
);

65 ià(
cu¼NodeS‹
.
	`isCÚÃùed
(è|| !
´evNodeS‹
.isConnected()) {

66 
aùu®S‹
.
	`put
(
’dpošt
, 
cu¼NodeS‹
);

68 
aùu®S‹
.
	`put
(
’dpošt
, 
´evNodeS‹
);

72  
ImmubËM­
.
	`cİyOf
(
aùu®S‹
);

73 }).
	`ÜEl£
(
ImmubËM­
.
	`of
());

75  
Clu¡”S‹
.
	`bud”
()

76 .
	`loÿlEndpošt
(
loÿlEndpošt
)

77 .
	`uÄe¥ÚsiveNodes
(
uÄe¥ÚsiveNodes
)

78 .
	`nodes
(
¡©eM­
)

79 .
	`bud
();

81 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterStateCollector.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

27 @
	gBud”


28 @
Slf4j


29 
public
 cÏs 
	cClu¡”S‹CŞËùÜ
 {

30 @
NÚNuÎ


31 
´iv©e
 
fš®
 
SŒšg
 
	mloÿlEndpošt
;

32 @
NÚNuÎ


33 
´iv©e
 
fš®
 
	mM­
<
	mSŒšg
, 
	mCom¶‘abËFutu»
<
	mNodeS‹
>> 
	mşu¡”S‹
;

41 
public
 
Clu¡”S‹
 
cŞËùClu¡”S‹
(

42 
•och
, 
ImmubËLi¡
<
SŒšg
> 
uÄe¥ÚsiveNodes
,

43 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
) {

45 
	mM­
<
	mSŒšg
, 
	mNodeS‹
> 
	mnodeS‹s
 = 
Ãw
 
HashM­
<>();

47 
	mnodeS‹s
.
put
(
loÿlEndpošt
, 
cŞËùLoÿlNodeS‹
(
•och
, 
£qu’ûrM‘rics
));

48 
	mnodeS‹s
.
putAÎ
(
cŞËùRemÙeS‹s
());

50  
	mClu¡”S‹
.
bud”
()

51 .
loÿlEndpošt
(localEndpoint)

52 .
nodes
(
ImmubËM­
.
cİyOf
(
nodeS‹s
))

53 .
uÄe¥ÚsiveNodes
(unresponsiveNodes)

54 .
bud
();

62 
public
 
	gImmubËM­
<
	gSŒšg
, 
	gLÚg
> 
	$cŞËùWrÚgEpochs
() {

63 
M­
<
SŒšg
, 
LÚg
> 
wrÚgEpochs
 = 
Ãw
 
HashM­
<>();

65 
şu¡”S‹
.
	`fÜEach
((
£rv”
, 
¡©e
) -> {

66 
Œy
 {

68 
¡©e
.
	`g‘
();

69 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

71 ià(
e
.
	`g‘Cau£
(è
š¡ªûof
 
WrÚgEpochExû±iÚ
) {

72 
wrÚgEpochs
.
	`put
(
£rv”
, ((
WrÚgEpochExû±iÚ
è
e
.
	`g‘Cau£
()).
	`g‘CÜ»ùEpoch
());

77  
ImmubËM­
.
	`cİyOf
(
wrÚgEpochs
);

78 
	}
}

80 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gNodeS‹
> 
	$cŞËùRemÙeS‹s
() {

81 
M­
<
SŒšg
, 
NodeS‹
> 
nodeS‹s
 = 
Ãw
 
HashM­
<>();

83 
şu¡”S‹
.
	`fÜEach
((
£rv”
, 
¡©e
) -> {

84 ià(
£rv”
.
	`equ®s
(
loÿlEndpošt
)) {

88 
Œy
 {

90 
NodeS‹
 
nodeS‹
 = 
¡©e
.
	`g‘
();

93 
nodeS‹s
.
	`put
(
£rv”
, 
nodeS‹
);

94 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

96 
nodeS‹s
.
	`put
(
£rv”
, 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
(server));

100  
nodeS‹s
;

101 
	}
}

103 
´iv©e
 
NodeS‹
 
	$cŞËùLoÿlNodeS‹
(
•och
, 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
) {

104 
log
.
	`Œaû
("Get†ocal‚ode state");

106 
M­
<
SŒšg
, 
CÚÃùiÚStus
> 
loÿlNodeCÚÃùiÚs
 = 
Ãw
 
HashM­
<>();

107 
şu¡”S‹
.
	`fÜEach
((
£rv”
, 
¡©e
) -> {

108 
Œy
 {

110 
¡©e
.
	`g‘
();

111 
loÿlNodeCÚÃùiÚs
.
	`put
(
£rv”
, 
CÚÃùiÚStus
.
OK
);

112 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

113 
CÚÃùiÚStus
 
nodeStus
;

114 ià(
e
.
	`g‘Cau£
(è
š¡ªûof
 
WrÚgEpochExû±iÚ
) {

115 
nodeStus
 = 
CÚÃùiÚStus
.
OK
;

117 
nodeStus
 = 
CÚÃùiÚStus
.
FAILED
;

120 
loÿlNodeCÚÃùiÚs
.
	`put
(
£rv”
, 
nodeStus
);

125 
NodeCÚÃùiv™y
 
loÿlCÚÃùiv™y
 = NodeCÚÃùiv™y.
	`cÚÃùiv™y
(

126 
loÿlEndpošt
, 
ImmubËM­
.
	`cİyOf
(
loÿlNodeCÚÃùiÚs
)

129  
NodeS‹
.
	`bud”
()

130 .
	`cÚÃùiv™y
(
loÿlCÚÃùiv™y
)

131 .
	`£qu’ûrM‘rics
(
£qu’ûrM‘rics
)

132 .
	`bud
();

133 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterStateContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

17 @
	gSlf4j


18 @
Bud”


19 
public
 cÏs 
	cClu¡”S‹CÚ‹xt
 {

22 
´iv©e
 
fš®
 
	mNODE_STATE_DECAY_CONSTANT
 = 3;

27 @
	mG‘‹r


28 @
NÚNuÎ


29 
´iv©e
 
fš®
 
	mAtomicReã»nû
<
	mClu¡”S‹
> 
	mşu¡”V›w
;

37 
public
 
»äeshClu¡”V›w
(@
NÚNuÎ
 
Layout
 
Ïyout
, @NÚNuÎ 
PŞlR•Üt
 
»pÜt
) {

38 
	mlog
.
Œaû
("Reäesh clu¡” v›w,†ayout: {}", 
Ïyout
);

40 
	mşu¡”V›w
.
£t
(
»pÜt
.
g‘Clu¡”S‹
());

47 
public
 
Clu¡”S‹
 
	$g‘Clu¡”V›w
(){

48  
şu¡”V›w
.
	`g‘
();

49 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

10 
public
 
	eClu¡”Ty³
 {

22 
	mCOMPLETE_GRAPH
,

34 
	mSTAR_GRAPH


	@infrastructure/src/main/java/org/corfudb/infrastructure/management/CompleteGraphAdvisor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gçu»d‘eùÜ
.
	gClu¡”G¿ph
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

21 @
Slf4j


22 
public
 cÏs 
	cCom¶‘eG¿phAdvisÜ
 
im¶em’ts
 
	mClu¡”AdvisÜ
 {

24 
´iv©e
 
fš®
 
Clu¡”Ty³
 
	mCLUSTER_TYPE
 = Clu¡”Ty³.
COMPLETE_GRAPH
;

26 
´iv©e
 
fš®
 
SŒšg
 
	mloÿlEndpošt
;

28 
public
 
Com¶‘eG¿phAdvisÜ
(@
NÚNuÎ
 
SŒšg
 
loÿlEndpošt
) {

29 
	mthis
.
	mloÿlEndpošt
 = 
loÿlEndpošt
;

32 @
Ov”ride


33 
public
 
Clu¡”Ty³
 
	$g‘Ty³
() {

34  
CLUSTER_TYPE
;

35 
	}
}

54 @
Ov”ride


55 
public
 
	gO±iÚ®
<
	gNodeRªk
> 
	$çedS”v”
(
Clu¡”S‹
 
şu¡”S‹
) {

57 
log
.
	`Œaû
("D‘eùšg faed‚ode fÜ: Clu¡”S‹ğ{}", 
şu¡”S‹
);

59 
Clu¡”G¿ph
 
g¿ph
 = Clu¡”G¿ph.
	`toClu¡”G¿ph
(
şu¡”S‹
);

61 
Clu¡”G¿ph
 
symm‘ric
 = 
g¿ph
.
	`toSymm‘ric
();

62 
O±iÚ®
<
NodeRªk
> 
maybeDecisiÚMak”
 = 
symm‘ric
.
	`g‘DecisiÚMak”
();

64 ià(!
maybeDecisiÚMak”
.
	`isP»£Á
()) {

65 
log
.
	`”rÜ
("DecisiÚ mak”‚Ù found fÜ g¿ph: {}", 
symm‘ric
.
	`toJsÚ
());

66  
O±iÚ®
.
	`em±y
();

69 
NodeRªk
 
decisiÚMak”
 = 
maybeDecisiÚMak”
.
	`g‘
();

70 ià(!
decisiÚMak”
.
	`is
(
loÿlEndpošt
)) {

71 
SŒšg
 
mes§ge
 = "The‚ode can't be‡ decision maker, skip operation. Decision maker‚ode is: {}";

72 
log
.
	`debug
(
mes§ge
, 
decisiÚMak”
);

73  
O±iÚ®
.
	`em±y
();

76 
O±iÚ®
<
NodeRªk
> 
maybeFaedNode
 = 
symm‘ric
.
	`fšdFaedNode
();

77 ià(!
maybeFaedNode
.
	`isP»£Á
()) {

78  
O±iÚ®
.
	`em±y
();

81 
NodeRªk
 
çedNode
 = 
maybeFaedNode
.
	`g‘
();

83 ià(
decisiÚMak”
.
	`equ®s
(
çedNode
)) {

84 
log
.
	`”rÜ
("DecisiÚ mak”‡nd faed‚od¬§mnode: {}", 
decisiÚMak”
);

85  
O±iÚ®
.
	`em±y
();

88 
ImmubËLi¡
<
SŒšg
> 
uÄe¥ÚsiveNodes
 = 
şu¡”S‹
.
	`g‘UÄe¥ÚsiveNodes
();

89 ià(
uÄe¥ÚsiveNodes
.
	`cÚšs
(
çedNode
.
	`g‘Endpošt
())) {

90 
log
.
	`Œaû
("Faed‚od®»ady iÀthli¡ oàuÄe¥Úsivnodes: {}", 
uÄe¥ÚsiveNodes
);

91  
O±iÚ®
.
	`em±y
();

94 
log
.
	`debug
("Faed‚odfound: {}", 
çedNode
);

95  
O±iÚ®
.
	`of
(
çedNode
);

96 
	}
}

113 @
Ov”ride


114 
public
 
	gO±iÚ®
<
	gNodeRªk
> 
	$h—ËdS”v”
(
Clu¡”S‹
 
şu¡”S‹
) {

116 
log
.
	`Œaû
("D‘eùšghh—Ëd‚ode fÜ: Clu¡”S‹: {}", 
şu¡”S‹
);

118 
ImmubËLi¡
<
SŒšg
> 
uÄe¥ÚsiveNodes
 = 
şu¡”S‹
.
	`g‘UÄe¥ÚsiveNodes
();

119 ià(
uÄe¥ÚsiveNodes
.
	`isEm±y
()) {

120 
log
.
	`Œaû
("All‚odes„esponsive. Nothingo heal");

121  
O±iÚ®
.
	`em±y
();

124 ià(!
uÄe¥ÚsiveNodes
.
	`cÚšs
(
loÿlEndpošt
)) {

125 
log
.
	`Œaû
("Local‚ode is„esponsive. Nothingo heal");

126  
O±iÚ®
.
	`em±y
();

130 
Clu¡”G¿ph
 
symm‘ricG¿ph
 = Clu¡”G¿ph.
	`toClu¡”G¿ph
(
şu¡”S‹
).
	`toSymm‘ric
();

133  
symm‘ricG¿ph
.
	`fšdFuÎyCÚÃùedNode
(
loÿlEndpošt
);

134 
	}
}

142 @
Ov”ride


143 
public
 
Clu¡”G¿ph
 
	$g‘G¿ph
(
Clu¡”S‹
 
şu¡”S‹
) {

144  
Clu¡”G¿ph
.
	`toClu¡”G¿ph
(
şu¡”S‹
).
	`toSymm‘ric
();

145 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/FailureDetector.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

7 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gNÚNuÎ
;

10 
impÜt
 
	glombok
.
	gS‘‹r
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gRemÙeMÚ™ÜšgS”viû
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

23 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

24 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

28 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

32 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

46 @
Slf4j


47 
public
 cÏs 
	cFau»D‘eùÜ
 
im¶em’ts
 
	mID‘eùÜ
 {

53 @
	mG‘‹r


54 @
S‘‹r


55 
´iv©e
 
	mçu»Th»shŞd
 = 3;

57 @
NÚNuÎ


58 
´iv©e
 
fš®
 
SŒšg
 
	mloÿlEndpošt
;

60 @
	mNÚNuÎ


61 @
	mDeçuÉ


62 @
S‘‹r


63 
´iv©e
 
N‘wÜkSŒ‘ch”
 
	mÃtwÜkSŒ‘ch”
 = N‘wÜkSŒ‘ch”.
bud”
().
bud
();

65 
public
 
	$Fau»D‘eùÜ
(
SŒšg
 
loÿlEndpošt
) {

66 
this
.
loÿlEndpošt
 =†ocalEndpoint;

76 
public
 
PŞlR•Üt
 
	`pŞl
(

77 @
NÚnuÎ
 
Layout
 
Ïyout
, @NÚnuÎ 
CÜfuRuÁime
 
cÜfuRuÁime
, @
NÚNuÎ
 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
) {

79 
log
.
	`Œaû
("PŞÈ»pÜt. Layout: {}", 
Ïyout
);

81 
M­
<
SŒšg
, 
ICl›ÁRou‹r
> 
rou‹rM­
;

84 
S‘
<
SŒšg
> 
®lS”v”s
 = 
Ïyout
.
	`g‘AÎS”v”s
();

87 
rou‹rM­
 = 
Ãw
 
HashM­
<>();

88 
®lS”v”s
.
	`fÜEach
(
s
 -> {

89 
ICl›ÁRou‹r
 
rou‹r
 = 
cÜfuRuÁime
.
	`g‘Rou‹r
(
s
);

90 
rou‹r
.
	`£tTimeoutRe¥Ú£
(
ÃtwÜkSŒ‘ch”
.
	`g‘Cu¼’tP”iod
().
	`toMlis
());

91 
rou‹rM­
.
	`put
(
s
, 
rou‹r
);

95  
	`pŞlRound
(

96 
Ïyout
.
	`g‘Epoch
(), 
®lS”v”s
, 
rou‹rM­
, 
£qu’ûrM‘rics
,

97 
ImmubËLi¡
.
	`cİyOf
(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
())

99 
	}
}

117 @
VisibËFÜTe¡šg


118 
PŞlR•Üt
 
pŞlRound
(

119 
•och
, 
S‘
<
SŒšg
> 
®lS”v”s
, 
M­
<SŒšg, 
ICl›ÁRou‹r
> 
rou‹r
,

120 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
, 
ImmubËLi¡
<
SŒšg
> 
ÏyoutUÄe¥ÚsiveNodes
) {

122 ià(
	gçu»Th»shŞd
 < 1) {

123 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Invalid failurehreshold");

126 
	gLi¡
<
	gPŞlR•Üt
> 
	g»pÜts
 = 
Ãw
 
A¼ayLi¡
<>();

127 
	g™”©iÚ
 = 0; i‹¿tiÚ < 
	gçu»Th»shŞd
; iteration++) {

128 
PŞlR•Üt
 
	gcu¼R•Üt
 = 
pŞlI‹¿tiÚ
(

129 
®lS”v”s
, 
rou‹r
, 
•och
, 
£qu’ûrM‘rics
, 
ÏyoutUÄe¥ÚsiveNodes


131 
	g»pÜts
.
add
(
cu¼R•Üt
);

133 
Du¿tiÚ
 
	g»¡IÁ”v®
 = 
ÃtwÜkSŒ‘ch”
.
g‘Re¡IÁ”v®
(
cu¼R•Üt
.
g‘EÏp£dTime
());

134 ià(!
	gcu¼R•Üt
.
g‘FaedNodes
().
isEm±y
()) {

135 
	gÃtwÜkSŒ‘ch”
.
modifyI‹¿tiÚTimeouts
();

137 
	gS‘
<
	gSŒšg
> 
	g®lR—chabËNodes
 = 
cu¼R•Üt
.
g‘AÎR—chabËNodes
();

138 
tuÃRou‹rsRe¥Ú£Timeout
(

139 
rou‹r
, 
®lR—chabËNodes
, 
ÃtwÜkSŒ‘ch”
.
g‘Cu¼’tP”iod
()

144 
	gSË•
.
¦“pUnš‹¼u±ibly
(
»¡IÁ”v®
);

148 
	gM­
<
	gSŒšg
, 
	gLÚg
> 
	gwrÚgEpochsAgg»g©ed
 = 
Ãw
 
HashM­
<>();

149 
	gS‘
<
	gSŒšg
> 
	gcÚÃùedNodesAgg»g©ed
 = 
Ãw
 
HashS‘
<>();

150 
	gS‘
<
	gSŒšg
> 
	gçedNodesAgg»g©ed
 = 
Ãw
 
HashS‘
<>();

152 
	g»pÜts
.
fÜEach
(
»pÜt
 -> {

154 
wrÚgEpochsAgg»g©ed
.
putAÎ
(
»pÜt
.
g‘WrÚgEpochs
());

155 
»pÜt
.
g‘R—chabËNodes
().
fÜEach
(
wrÚgEpochsAgg»g©ed
::
»move
);

158 
cÚÃùedNodesAgg»g©ed
.
addAÎ
(
»pÜt
.
g‘R—chabËNodes
());

159 
çedNodesAgg»g©ed
.
addAÎ
(
»pÜt
.
g‘FaedNodes
());

162 
	gçedNodesAgg»g©ed
.
»moveAÎ
(
cÚÃùedNodesAgg»g©ed
);

164 
	gS‘
<
	gSŒšg
> 
	g®lCÚÃùedNodes
 = 
S‘s
.(
cÚÃùedNodesAgg»g©ed
, 
	gwrÚgEpochsAgg»g©ed
.
keyS‘
());

166 
tuÃPŞlR•ÜtTimeouts
(
rou‹r
, 
çedNodesAgg»g©ed
, 
®lCÚÃùedNodes
);

168 
	gLi¡
<
	gClu¡”S‹
> 
	gşu¡”S‹s
 = 
»pÜts
.
¡»am
()

169 .
m­
(
PŞlR•Üt
::
g‘Clu¡”S‹
)

170 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

172 
Clu¡”S‹Agg»g©Ü
 
	gagg»g©Ü
 = Clu¡”S‹Agg»g©Ü.
bud”
()

173 .
loÿlEndpošt
(localEndpoint)

174 .
şu¡”S‹s
(clusterStates)

175 .
uÄe¥ÚsiveNodes
(
ÏyoutUÄe¥ÚsiveNodes
)

176 .
bud
();

178 
Du¿tiÚ
 
	gtÙ®EÏp£dTime
 = 
»pÜts
.
¡»am
()

179 .
m­
(
PŞlR•Üt
::
g‘EÏp£dTime
)

180 .
»duû
(
Du¿tiÚ
.
ZERO
, Du¿tiÚ::
¶us
);

182 
fš®
 
Clu¡”S‹
 
	gagg»g©edClu¡”S‹
 = 
agg»g©Ü
.
g‘Agg»g©edS‹
();

183  
	gPŞlR•Üt
.
bud”
()

184 .
pŞlEpoch
(
•och
)

185 .
–­£dTime
(
tÙ®EÏp£dTime
)

186 .
pšgRe¥ÚsiveS”v”s
(
agg»g©edClu¡”S‹
.
g‘PšgRe¥ÚsiveNodes
())

187 .
wrÚgEpochs
(
ImmubËM­
.
cİyOf
(
wrÚgEpochsAgg»g©ed
))

188 .
şu¡”S‹
(
agg»g©edClu¡”S‹
)

189 .
bud
();

200 
´iv©e
 
tuÃPŞlR•ÜtTimeouts
(

201 
M­
<
SŒšg
, 
ICl›ÁRou‹r
> 
ş›ÁRou‹rs
, 
S‘
<SŒšg> 
çedNodes
,

202 
S‘
<
SŒšg
> 
®lCÚÃùedNodes
) {

204 
	gÃtwÜkSŒ‘ch”
.
modifyDeü—£dP”iod
();

205 
tuÃRou‹rsRe¥Ú£Timeout
(

206 
ş›ÁRou‹rs
, 
®lCÚÃùedNodes
, 
ÃtwÜkSŒ‘ch”
.
g‘Cu¼’tP”iod
()

211 
tuÃRou‹rsRe¥Ú£Timeout
(
ş›ÁRou‹rs
, 
çedNodes
, 
ÃtwÜkSŒ‘ch”
.
g‘MaxP”iod
());

232 
´iv©e
 
PŞlR•Üt
 
pŞlI‹¿tiÚ
(

233 
S‘
<
SŒšg
> 
®lS”v”s
, 
M­
<SŒšg, 
ICl›ÁRou‹r
> 
ş›ÁRou‹rs
, 
•och
,

234 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
, 
ImmubËLi¡
<
SŒšg
> 
ÏyoutUÄe¥ÚsiveNodes
) {

236 
	glog
.
Œaû
("PŞÈ™”©iÚ. Epoch: {}", 
•och
);

238 
	g¡¬t
 = 
Sy¡em
.
cu¼’tTimeMlis
();

240 
Clu¡”S‹CŞËùÜ
 
	gşu¡”CŞËùÜ
 = Clu¡”S‹CŞËùÜ.
bud”
()

241 .
loÿlEndpošt
(localEndpoint)

242 .
şu¡”S‹
(
pŞlAsync
(
®lS”v”s
, 
ş›ÁRou‹rs
, 
•och
))

243 .
bud
();

246 
Clu¡”S‹
 
	gşu¡”S‹
 = 
şu¡”CŞËùÜ
.
cŞËùClu¡”S‹
(

247 
•och
, 
ÏyoutUÄe¥ÚsiveNodes
, 
£qu’ûrM‘rics


250 
Du¿tiÚ
 
	g–­£dTime
 = Du¿tiÚ.
ofMlis
(
Sy¡em
.
cu¼’tTimeMlis
(è- 
¡¬t
);

252  
	gPŞlR•Üt
.
bud”
()

253 .
pŞlEpoch
(
•och
)

254 .
pšgRe¥ÚsiveS”v”s
(
şu¡”S‹
.
g‘PšgRe¥ÚsiveNodes
())

255 .
wrÚgEpochs
(
şu¡”CŞËùÜ
.
cŞËùWrÚgEpochs
())

256 .
şu¡”S‹
(clusterState)

257 .
–­£dTime
(elapsedTime)

258 .
bud
();

270 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gCom¶‘abËFutu»
<
	gNodeS‹
>> 
pŞlAsync
(

271 
S‘
<
SŒšg
> 
®lS”v”s
, 
M­
<SŒšg, 
ICl›ÁRou‹r
> 
ş›ÁRou‹rs
, 
•och
) {

273 
	gM­
<
	gSŒšg
, 
	gCom¶‘abËFutu»
<
	gNodeS‹
>> 
	gşu¡”S‹
 = 
Ãw
 
HashM­
<>();

274 
	g®lS”v”s
.
fÜEach
(
s
 -> {

275 
Œy
 {

276 
şu¡”S‹
.
put
(
s
, 
Ãw
 
Mªagem’tCl›Á
(
ş›ÁRou‹rs
.
g‘
(s), 
•och
).
£ndNodeS‹Reque¡
());

277 } 
ÿtch
 (
Exû±iÚ
 
e
) {

278 
Com¶‘abËFutu»
<
NodeS‹
> 
cf
 = 
Ãw
 CompletableFuture<>();

279 
cf
.
com¶‘eExû±iÚ®ly
(
e
);

280 
şu¡”S‹
.
put
(
s
, 
cf
);

286 
	gŒy
 {

287 
	gCFUts
.
®lOf
(
şu¡”S‹
.
v®ues
()).
još
();

288 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

292  
	gşu¡”S‹
;

302 
´iv©e
 
tuÃRou‹rsRe¥Ú£Timeout
(

303 
M­
<
SŒšg
, 
ICl›ÁRou‹r
> 
ş›ÁRou‹rs
, 
S‘
<SŒšg> 
’dpošts
, 
Du¿tiÚ
 
timeout
) {

305 
	glog
.
Œaû
("Tunšg„ou‹¸timeouˆ»¥Ú£ fÜƒndpošts:{}Ø{}ms", 
’dpošts
, 
timeout
);

306 
	g’dpošts
.
fÜEach
(
£rv”
 -> {

307 ià(
ş›ÁRou‹rs
.
g‘
(
£rv”
è!ğ
nuÎ
) {

308 
ş›ÁRou‹rs
.
g‘
(
£rv”
).
£tTimeoutRe¥Ú£
(
timeout
.
toMlis
());

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/IDetector.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

14 
public
 
š‹rçû
 
	gID‘eùÜ
 {

22 
PŞlR•Üt
 
pŞl
(@
NÚnuÎ
 
Layout
 
Ïyout
, @NÚnuÎ 
CÜfuRuÁime
 
cÜfuRuÁime
, 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/NetworkStretcher.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

14 @
Bud”


15 
public
 cÏs 
	cN‘wÜkSŒ‘ch”
 {

21 @
	mG‘‹r


22 @
DeçuÉ


23 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mmaxP”iod
 = Du¿tiÚ.
ofSecÚds
(5);

25 @
	mG‘‹r


26 @
DeçuÉ


27 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mmšP”iod
 = Du¿tiÚ.
ofSecÚds
(2);

32 @
	mG‘‹r


33 @
DeçuÉ


34 
´iv©e
 
Du¿tiÚ
 
	mcu¼’tP”iod
 = Du¿tiÚ.
ofSecÚds
(2);

39 @
DeçuÉ


40 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mš™ŸlPŞlIÁ”v®
 = Du¿tiÚ.
ofSecÚds
(1);

46 @
DeçuÉ


47 
´iv©e
 
fš®
 
Du¿tiÚ
 
	m³riodD–
 = Du¿tiÚ.
ofSecÚds
(1);

54 @
VisibËFÜTe¡šg


55 
Du¿tiÚ
 
	$g‘Inü—£dP”iod
() {

56 
Du¿tiÚ
 
šü—£dP”iod
 = 
cu¼’tP”iod
.
	`¶us
(
³riodD–
);

57 ià(
šü—£dP”iod
.
	`toMlis
(è> 
maxP”iod
.toMillis()){

58  
maxP”iod
;

61  
šü—£dP”iod
;

69 
´iv©e
 
Du¿tiÚ
 
	$g‘Deü—£dP”iod
() {

70 
Du¿tiÚ
 
deü—£dP”iod
 = 
cu¼’tP”iod
.
	`mšus
(
³riodD–
);

72 ià(
deü—£dP”iod
.
	`toMlis
(è< 
mšP”iod
.toMillis()) {

73  
mšP”iod
;

76  
deü—£dP”iod
;

77 
	}
}

83 
public
 
	$modifyI‹¿tiÚTimeouts
() {

84 
cu¼’tP”iod
 = 
	`g‘Inü—£dP”iod
();

85 
	}
}

92 
public
 
Du¿tiÚ
 
	$g‘Re¡IÁ”v®
(
Du¿tiÚ
 
–­£dTime
){

94 
Du¿tiÚ
 
»¡IÁ”v®
 = 
cu¼’tP”iod
.
	`mšus
(
–­£dTime
);

95 ià(
»¡IÁ”v®
.
	`toMlis
(è< 
š™ŸlPŞlIÁ”v®
.toMillis()){

96 
»¡IÁ”v®
 = 
š™ŸlPŞlIÁ”v®
;

98  
»¡IÁ”v®
;

99 
	}
}

101 
public
 
	$modifyDeü—£dP”iod
() {

102 
cu¼’tP”iod
 = 
	`g‘Deü—£dP”iod
();

103 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/PollReport.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

7 
impÜt
 
	glombok
.
	gBud”
;

8 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
.
	gNÚNuÎ
;

11 
impÜt
 
	glombok
.
	gToSŒšg
;

12 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

17 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

19 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

27 @
	gBud”


28 @
	gSlf4j


29 @
	gG‘‹r


30 @
ToSŒšg


31 
public
 cÏs 
	cPŞlR•Üt
 {

33 @
DeçuÉ


34 
´iv©e
 
fš®
 
	mpŞlEpoch
 = 
Layout
.
INVALID_EPOCH
;

39 @
DeçuÉ


40 
´iv©e
 
fš®
 
	mImmubËM­
<
	mSŒšg
, 
	mLÚg
> 
	mwrÚgEpochs
 = 
ImmubËM­
.
of
();

45 @
NÚNuÎ


46 
´iv©e
 
fš®
 
Clu¡”S‹
 
	mşu¡”S‹
;

51 @
NÚNuÎ


52 
´iv©e
 
fš®
 
	mImmubËLi¡
<
	mSŒšg
> 
	mpšgRe¥ÚsiveS”v”s
;

57 @
NÚNuÎ


58 
´iv©e
 
fš®
 
Du¿tiÚ
 
	m–­£dTime
;

65 
public
 
	mImmubËS‘
<
	mSŒšg
> 
	$g‘AÎR—chabËNodes
() {

66  
S‘s
.(
	`g‘R—chabËNodes
(), 
wrÚgEpochs
.
	`keyS‘
()).
	`immubËCİy
();

73 
public
 
S‘
<
SŒšg
> 
	$g‘R—chabËNodes
() {

74 
S‘
<
SŒšg
> 
cÚÃùedNodes
 = 
şu¡”S‹
.
	`g‘LoÿlNodeCÚÃùiv™y
().
	`g‘CÚÃùedNodes
();

75  
S‘s
.
	`difã»nû
(
cÚÃùedNodes
, 
wrÚgEpochs
.
	`keyS‘
());

76 
	}
}

82 
public
 
	gS‘
<
	gSŒšg
> 
	$g‘FaedNodes
() {

83 
S‘
<
SŒšg
> 
çedNodes
 = 
şu¡”S‹
.
	`g‘LoÿlNodeCÚÃùiv™y
().
	`g‘FaedNodes
();

85  
S‘s
.
	`difã»nû
(
çedNodes
, 
wrÚgEpochs
.
	`keyS‘
());

86 
	}
}

95 
public
 
	gO±iÚ®
<
	gLÚg
> 
g‘LayoutSlÙUnFËd
(@
NÚNuÎ
 
Layout
 
Ï‹¡Comm™‹dLayout
) {

96 
	glog
.
Œaû
("getLayoutSlotUnFilled. Wrongƒpochs: {},†atest†ayoutƒpoch: {}",

97 
wrÚgEpochs
, 
Ï‹¡Comm™‹dLayout
.
g‘Epoch
()

100 
	gmaxOutOfPha£Epoch
 = 
wrÚgEpochs
.
v®ues
().
¡»am
()

101 .
max
(
LÚg
::
com·»
)

102 .
ÜEl£
(
Ï‹¡Comm™‹dLayout
.
g‘Epoch
());

103 ià(
	gmaxOutOfPha£Epoch
 > 
	gÏ‹¡Comm™‹dLayout
.
g‘Epoch
()) {

104  
	gO±iÚ®
.
of
(
maxOutOfPha£Epoch
);

107  
	gO±iÚ®
.
em±y
();

116 
public
 
boŞ—n
 
	$¬eAÎRe¥ÚsiveS”v”sS—Ëd
() {

117  
wrÚgEpochs
.
	`isEm±y
(è|| wrÚgEpochs.
	`size
(è=ğ
pšgRe¥ÚsiveS”v”s
.size();

118 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/ReconfigurationEventHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gIRecÚfigu¿tiÚHªdËrPŞicy
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

27 @
Slf4j


28 
public
 cÏs 
	cRecÚfigu¿tiÚEv’tHªdËr
 {

30 @
	mG‘‹r


31 @
S‘‹r


32 
´iv©e
 
	mwÜkæowR‘r›s
 = 3;

34 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mDEFAULT_HEAL_TIMEOUT
 = Du¿tiÚ.
ofMšu‹s
(5);

36 
´iv©e
 
fš®
 
	mTIMEOUT_MULTIPLICATIVE_FACTOR
 = 1.5;

48 
public
 
boŞ—n
 
hªdËFau»
(@
NÚnuÎ
 
IRecÚfigu¿tiÚHªdËrPŞicy
 
çu»HªdËrPŞicy
,

49 @
NÚnuÎ
 
Layout
 
cu¼’tLayout
,

50 @
NÚnuÎ
 
CÜfuRuÁime
 
cÜfuRuÁime
,

51 @
NÚnuÎ
 
S‘
<
SŒšg
> 
çedS”v”s
) {

52 
	mŒy
 {

53 
	mcÜfuRuÁime
.
g‘LayoutMªagem’tV›w
().
hªdËFau»
(
çu»HªdËrPŞicy
,

54 
cu¼’tLayout
, 
çedS”v”s
);

55  
	mŒue
;

56 } 
ÿtch
 (
Exû±iÚ
 
e
) {

57 
	mlog
.
”rÜ
("E¼Ü: hªdËFau»: {}", 
e
);

58  
	mçl£
;

70 
´iv©e
 
Du¿tiÚ
 
	$g‘S‹T¿nsãrTimeoutE¡im©e
(
CÜfuRuÁime
 
ruÁime
) {

73 
Tok’
 
ŒimM¬k
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

75 

 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

77 
¿ngeToR•liÿ‹
 = 

 - 
ŒimM¬k
.
	`g‘Sequ’û
();

81 
numSeùiÚs
 = 
¿ngeToR•liÿ‹
 / 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘BulkR—dSize
();

82 
½cTimeout


83 ğ(è(
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘Reque¡Timeout
().
	`toMlis
(è* 
TIMEOUT_MULTIPLICATIVE_FACTOR
);

84 
timeoutInMs
 = 
M©h
.
	`max
(
DEFAULT_HEAL_TIMEOUT
.
	`toMlis
(), 
numSeùiÚs
 * 
½cTimeout
);

85  
Du¿tiÚ
.
	`ofMlis
(
timeoutInMs
);

86 
	}
}

100 
public
 
boŞ—n
 
hªdËH—lšg
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
,

101 @
NÚnuÎ
 
S‘
<
SŒšg
> 
h—ËdS”v”s
,

102 @
NÚnuÎ
 
Du¿tiÚ
 
»ŒyQu”yTimeout
) {

103 
	glog
.
šfo
("HªdË h—lšg: {}", 
h—ËdS”v”s
);

105 
	gŒy
 {

106 
SŒšg
 
	gh—ËdS”v”
 : 
h—ËdS”v”s
) {

108 
Du¿tiÚ
 
wÜkæowTimeout
 = 
g‘S‹T¿nsãrTimeoutE¡im©e
(
ruÁime
);

109 
	glog
.
šfo
("hªdËH—lšg: WÜkæowØh—È{}imeouˆ£ˆtØ{} ms", 
h—ËdS”v”
, 
wÜkæowTimeout
);

111 
	gruÁime
.
g‘Mªagem’tV›w
().
h—lNode
(

112 
h—ËdS”v”
,

113 
wÜkæowR‘r›s
,

114 
wÜkæowTimeout
,

115 
»ŒyQu”yTimeout
);

117  
	gŒue
;

118 } 
ÿtch
 (
Exû±iÚ
 
e
) {

119 
	glog
.
”rÜ
("E¼Ü: hªdËH—lšg: {}", 
e
);

120  
	gçl£
;

138 
public
 
boŞ—n
 
hªdËM”geSegm’ts
(@
NÚnuÎ
 
SŒšg
 
cu¼’tEndpošt
,

139 @
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
,

140 @
NÚnuÎ
 
Layout
 
Ïyout
,

141 @
NÚnuÎ
 
Du¿tiÚ
 
»ŒyQu”yTimeout
) {

143 
	glog
.
šfo
("Handling split segments");

145 
	gŒy
 {

146 
Du¿tiÚ
 
	gwÜkæowTimeout
 = 
g‘S‹T¿nsãrTimeoutE¡im©e
(
ruÁime
);

147 
	glog
.
šfo
("handleMergeSegments: Workflowo merge segments for†ayout {}imeout seto {} ms",

148 
Ïyout
, 
wÜkæowTimeout
);

150 
	gruÁime
.
g‘Mªagem’tV›w
().
m”geSegm’ts
(

151 
cu¼’tEndpošt
,

152 
wÜkæowR‘r›s
,

153 
wÜkæowTimeout
,

154 
»ŒyQu”yTimeout
);

155  
	gŒue
;

156 } 
ÿtch
 (
Exû±iÚ
 
e
) {

157 
	glog
.
”rÜ
("E¼Ü: hªdËM”geSegm’ts: ", 
e
);

158  
	gçl£
;

	@infrastructure/src/main/java/org/corfudb/infrastructure/management/failuredetector/ClusterGraph.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gçu»d‘eùÜ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gNÚNuÎ
;

8 
impÜt
 
	glombok
.
	gToSŒšg
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gFau»D‘eùÜM‘rics
.
	gCÚÃùiv™yG¿ph
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gJsÚUts
;

19 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

20 
impÜt
 
	gjava
.
	gut
.
	gEnumS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

24 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

25 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

27 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

28 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

47 @
	gBud”


48 @
	gToSŒšg


49 @
Slf4j


50 
public
 cÏs 
	cClu¡”G¿ph
 {

52 @
NÚNuÎ


53 
´iv©e
 
fš®
 
	mImmubËM­
<
	mSŒšg
, 
	mNodeCÚÃùiv™y
> 
	mg¿ph
;

55 @
NÚNuÎ


56 
´iv©e
 
fš®
 
SŒšg
 
	mloÿlNode
;

58 @
NÚNuÎ


59 
´iv©e
 
fš®
 
	mImmubËLi¡
<
	mSŒšg
> 
	muÄe¥ÚsiveNodes
;

69 
public
 
Clu¡”G¿ph
 
	$toClu¡”G¿ph
(
Clu¡”S‹
 
şu¡”
) {

70 
M­
<
SŒšg
, 
NodeCÚÃùiv™y
> 
g¿ph
 = 
şu¡”
.
	`g‘Nodes
()

71 .
	`v®ues
()

72 .
	`¡»am
()

73 .
	`m­
(
NodeS‹
::
g‘CÚÃùiv™y
)

74 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(
NodeCÚÃùiv™y
::
g‘Endpošt
, 
FunùiÚ
.
	`id’t™y
()));

76  
Clu¡”G¿ph
.
	`bud”
()

77 .
	`loÿlNode
(
şu¡”
.
	`g‘LoÿlEndpošt
())

78 .
	`uÄe¥ÚsiveNodes
(
şu¡”
.
	`g‘UÄe¥ÚsiveNodes
())

79 .
	`g¿ph
(
ImmubËM­
.
	`cİyOf
(
g¿ph
))

80 .
	`bud
();

98 
public
 
Clu¡”G¿ph
 
	$toSymm‘ric
() {

99 
M­
<
SŒšg
, 
NodeCÚÃùiv™y
> 
symm‘ric
 = 
Ãw
 
HashM­
<>();

101 
g¿ph
.
	`keyS‘
().
	`fÜEach
(
nodeName
 -> {

102 
NodeCÚÃùiv™y
 
node
 = 
g¿ph
.
	`g‘
(
nodeName
);

103 ià(
node
.
	`g‘Ty³
(è=ğ
NodeCÚÃùiv™yTy³
.
UNAVAILABLE
) {

104 
symm‘ric
.
	`put
(
nodeName
, 
node
);

108 
M­
<
SŒšg
, 
CÚÃùiÚStus
> 
ÃwCÚÃùiv™y
 = 
Ãw
 
HashM­
<>();

109 
node
.
	`g‘CÚÃùiv™y
()

111 .
	`keyS‘
()

113 .
	`fÜEach
(
adjNodeName
 -> {

114 
NodeCÚÃùiv™y
 
adjNode
 = 
g¿ph
.
	`g‘
(
adjNodeName
);

118 ià(
adjNode
.
	`g‘Ty³
(è=ğ
NodeCÚÃùiv™yTy³
.
UNAVAILABLE
) {

119 ià(!
	`isLoÿlNode
(
node
)) {

120 
ÃwCÚÃùiv™y
.
	`put
(
adjNodeName
, 
node
.
	`g‘CÚÃùiÚStus
(adjNodeName));

126 
CÚÃùiÚStus
 
nodeCÚÃùiÚ
 = 
	`g‘CÚÃùiÚStus
(
node
, 
adjNode
);

128 
CÚÃùiÚStus
 
İpos™eNodeCÚÃùiÚ
 = 
	`g‘CÚÃùiÚStus
(
adjNode
, 
node
);

132 
CÚÃùiÚStus
 
¡©us
 = CÚÃùiÚStus.
OK
;

133 ià(
EnumS‘
.
	`of
(
nodeCÚÃùiÚ
, 
İpos™eNodeCÚÃùiÚ
).
	`cÚšs
(
CÚÃùiÚStus
.
FAILED
)) {

134 
¡©us
 = 
CÚÃùiÚStus
.
FAILED
;

136 
ÃwCÚÃùiv™y
.
	`put
(
adjNodeName
, 
¡©us
);

139 
NodeCÚÃùiv™y
 
symm‘ricCÚÃùiv™y
 = NodeCÚÃùiv™y.
	`bud”
()

140 .
	`’dpošt
(
nodeName
)

141 .
	`•och
(
node
.
	`g‘Epoch
())

142 .
	`cÚÃùiv™y
(
ImmubËM­
.
	`cİyOf
(
ÃwCÚÃùiv™y
))

143 .
	`ty³
(
node
.
	`g‘Ty³
())

144 .
	`bud
();

146 
symm‘ric
.
	`put
(
nodeName
, 
symm‘ricCÚÃùiv™y
);

150  
Clu¡”G¿ph
.
	`bud”
()

151 .
	`loÿlNode
(
loÿlNode
)

152 .
	`uÄe¥ÚsiveNodes
(
uÄe¥ÚsiveNodes
)

153 .
	`g¿ph
(
ImmubËM­
.
	`cİyOf
(
symm‘ric
))

154 .
	`bud
();

155 
	}
}

157 
´iv©e
 
boŞ—n
 
	$isLoÿlNode
(
NodeCÚÃùiv™y
 
node
) {

158  
node
.
	`g‘Endpošt
().
	`equ®s
(
loÿlNode
);

159 
	}
}

181 
public
 
	gO±iÚ®
<
	gNodeRªk
> 
	$g‘DecisiÚMak”
() {

182 
log
.
	`Œaû
("Get decision maker");

184 
NavigabËS‘
<
NodeRªk
> 
nodes
 = 
	`g‘NodeRªks
();

186 ià(
nodes
.
	`isEm±y
()) {

187 
log
.
	`”rÜ
("Empty graph. Can't…rovide decision maker");

188  
O±iÚ®
.
	`em±y
();

191 
NodeRªk
 
decisiÚMak”
 = 
nodes
.
	`fœ¡
();

193 ià(
decisiÚMak”
.
	`g‘NumCÚÃùiÚs
() < 1) {

194 
log
.
	`Œaû
("The‚ode is fully disconnected fromhe graph. Decision maker doesn'tƒxists");

195  
O±iÚ®
.
	`em±y
();

198 
log
.
	`Œaû
("DecisiÚ mak” ha found: {},‡Î‚od¿nks: {}", 
decisiÚMak”
, 
nodes
);

199  
O±iÚ®
.
	`of
(
decisiÚMak”
);

200 
	}
}

209 
public
 
	gO±iÚ®
<
	gNodeRªk
> 
	$fšdFaedNode
() {

210 
log
.
	`Œaû
("Looking for failed‚ode");

212 
NavigabËS‘
<
NodeRªk
> 
nodes
 = 
	`g‘NodeRªks
();

213 ià(
nodes
.
	`isEm±y
()) {

214 
log
.
	`”rÜ
("Empty graph. Can't…rovide failed‚ode");

215  
O±iÚ®
.
	`em±y
();

218 
NodeRªk
 
Ï¡
 = 
nodes
.
	`Ï¡
();

219 ià(
Ï¡
.
	`g‘NumCÚÃùiÚs
(è=ğ
g¿ph
.
	`size
()) {

220  
O±iÚ®
.
	`em±y
();

226 
O±iÚ®
<
NodeRªk
> 
fuÎyCÚÃùed
 = 
	`fšdFuÎyCÚÃùedNode
(
Ï¡
.
	`g‘Endpošt
());

229 
boŞ—n
 
isFaedNodeFuÎyCÚÃùed
 = 
fuÎyCÚÃùed


230 .
	`m­
(
fcNode
 -> fcNode.
	`equ®s
(
Ï¡
))

231 .
	`ÜEl£
(
çl£
);

233 ià(
isFaedNodeFuÎyCÚÃùed
) {

234 
log
.
	`Œaû
("Fully connected‚ode can't be‡ failed‚ode");

235  
O±iÚ®
.
	`em±y
();

238  
O±iÚ®
.
	`of
(
Ï¡
);

239 
	}
}

247 
public
 
	gO±iÚ®
<
	gNodeRªk
> 
	$fšdFuÎyCÚÃùedNode
(
SŒšg
 
’dpošt
) {

248 
log
.
	`Œaû
("Fšd„e¥Úsivnode. UÄe¥Úsivnodes: {}", 
uÄe¥ÚsiveNodes
);

250 
NodeCÚÃùiv™y
 
node
 = 
	`g‘NodeCÚÃùiv™y
(
’dpošt
);

252 
node
.
	`g‘Ty³
()) {

253 
NOT_READY
:

254 
UNAVAILABLE
:

255 
log
.
	`Œaû
("NÙ cÚÃùed‚ode: {}", 
’dpošt
);

256  
O±iÚ®
.
	`em±y
();

257 
CONNECTED
:

258 
SŒšg
 
adjaûÁ
 : 
node
.
	`g‘CÚÃùiv™y
().
	`keyS‘
()) {

260 ià(
uÄe¥ÚsiveNodes
.
	`cÚšs
(
adjaûÁ
)) {

264 
NodeCÚÃùiv™y
 
adjaûÁNode
 = 
	`g‘NodeCÚÃùiv™y
(
adjaûÁ
);

267 ià(
adjaûÁNode
.
	`g‘Ty³
(è=ğ
NodeCÚÃùiv™yTy³
.
UNAVAILABLE
) {

271 ià(
adjaûÁNode
.
	`g‘CÚÃùiÚStus
(
’dpošt
è!ğ
CÚÃùiÚStus
.
OK
) {

272 
log
.
	`Œaû
("Fully connected‚ode‚ot found");

273  
O±iÚ®
.
	`em±y
();

277 
NodeRªk
 
¿nk
 = 
Ãw
 
	`NodeRªk
(

278 
’dpošt
,

279 
	`g‘NodeCÚÃùiv™y
(
’dpošt
).
	`g‘CÚÃùed
()

282  
O±iÚ®
.
	`of
(
¿nk
);

284 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Unknown‚ode state");

286 
	}
}

294 @
VisibËFÜTe¡šg


295 
public
 
NodeCÚÃùiv™y
 
	$g‘NodeCÚÃùiv™y
(
SŒšg
 
node
) {

296  
g¿ph
.
	`g‘
(
node
);

297 
	}
}

304 
public
 
	$size
() {

305  
g¿ph
.
	`size
();

306 
	}
}

308 
public
 
SŒšg
 
	$toJsÚ
() {

309  
JsÚUts
.
	`toJsÚ
(
	`cÚÃùiv™yG¿ph
());

310 
	}
}

317 
public
 
CÚÃùiv™yG¿ph
 
	$cÚÃùiv™yG¿ph
() {

318  
Ãw
 
	`CÚÃùiv™yG¿ph
Òew 
T»eS‘
<>(
g¿ph
.
	`v®ues
()));

319 
	}
}

321 
´iv©e
 
	gNavigabËS‘
<
	gNodeRªk
> 
	$g‘NodeRªks
() {

322 
NavigabËS‘
<
NodeRªk
> 
nodes
 = 
Ãw
 
T»eS‘
<>();

324 
g¿ph
.
	`keyS‘
().
	`fÜEach
(
node
 -> {

325 
numCÚÃùed
 = 
g¿ph
.
	`g‘
(
node
).
	`g‘CÚÃùed
();

326 
nodes
.
	`add
(
Ãw
 
	`NodeRªk
(
node
, 
numCÚÃùed
));

329  
nodes
;

330 
	}
}

344 
´iv©e
 
CÚÃùiÚStus
 
	$g‘CÚÃùiÚStus
(
NodeCÚÃùiv™y
 
sourûNode
, NodeCÚÃùiv™y 
rg‘Node
) {

346 ià(
sourûNode
 =ğ
nuÎ
 || 
rg‘Node
 ==‚ull) {

347 
SŒšg
 
”rMsg
 = "Sourû o¸rg‘‚odi nuÎ. Sourû: " + 
sourûNode
 + ",¬g‘: " + 
rg‘Node
;

348 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(
”rMsg
);

351 
S‘
<
NodeCÚÃùiv™yTy³
> 
ty³s
 = 
EnumS‘
.
	`of
(
sourûNode
.
	`g‘Ty³
(), 
rg‘Node
.getType());

352 ià(
ty³s
.
	`cÚšs
(
NodeCÚÃùiv™yTy³
.
UNAVAILABLE
)) {

353  
CÚÃùiÚStus
.
FAILED
;

356  
sourûNode
.
	`g‘CÚÃùiÚStus
(
rg‘Node
.
	`g‘Endpošt
());

357 
	}
}

369 
public
 şas 
	cClu¡”G¿phH–³r
 {

371 
´iv©e
 
Clu¡”G¿phH–³r
() {

375 
public
 
Clu¡”G¿ph
 
şu¡”
(
SŒšg
 
loÿlNode
,

376 
ImmubËLi¡
<
SŒšg
> 
uÄe¥ÚsiveNodes
,

377 
NodeCÚÃùiv™y
... 
nodes
) {

378 
	gM­
<
	gSŒšg
, 
	gNodeCÚÃùiv™y
> 
	gg¿ph
 = 
A¼ays
.
¡»am
(
nodes
)

379 .
cŞËù
(
CŞËùÜs
.
toM­
(
NodeCÚÃùiv™y
::
g‘Endpošt
, 
FunùiÚ
.
id’t™y
()));

381  
	gClu¡”G¿ph
.
bud”
()

382 .
loÿlNode
(localNode)

383 .
uÄe¥ÚsiveNodes
(unresponsiveNodes)

384 .
g¿ph
(
ImmubËM­
.
cİyOf
(graph))

385 .
bud
();

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/Action.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

15 @
Slf4j


16 
public
 
ab¡¿ù
 cÏs 
	cAùiÚ
 {

18 
AùiÚStus
 
	m¡©us
 = AùiÚStus.
CREATED
;

24 @
NÚnuÎ


25 
public
 
ab¡¿ù
 
SŒšg
 
g‘Name
();

32 
public
 
ab¡¿ù
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
è
throws
 
	mExû±iÚ
;

37 @
NÚnuÎ


38 
public
 
execu‹
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
, 
numR‘ry
) {

39 
	mx
 = 0; x < 
	mnumR‘ry
; x++) {

40 
	mŒy
 {

41 
chªgeStus
(
AùiÚStus
.
STARTED
);

42 
im¶
(
ruÁime
);

43 
chªgeStus
(
AùiÚStus
.
COMPLETED
);

45 } 
ÿtch
 (
Exû±iÚ
 
e
) {

46 
	mlog
.
”rÜ
("execute: Errorƒxecuting‡ction {} on„etry {}. Invalidating†ayout.",

47 
g‘Name
(), 
x
, 
e
);

48 
chªgeStus
(
AùiÚStus
.
ERROR
);

49 
	mruÁime
.
šv®id©eLayout
();

58 
public
 
AùiÚStus
 
	$g‘Stus
() {

59  
¡©us
;

60 
	}
}

66 
	$chªgeStus
(
AùiÚStus
 
ÃwStus
) {

67 
¡©us
 = 
ÃwStus
;

68 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/ActionStatus.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
;

9 
public
 
	eAùiÚStus
 {

14 
	mCREATED
,

19 
	mSTARTED
,

24 
	mCOMPLETED
,

29 
	mERROR


	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/IWorkflow.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
public
 
š‹rçû
 
	gIWÜkæow
 {

21 
UUID
 
g‘Id
();

27 
SŒšg
 
g‘Name
();

34 
	gLi¡
<
	gAùiÚ
> 
g‘AùiÚs
();

40  
boŞ—n
 
com¶‘ed
() {

41  
g‘AùiÚs
().
¡»am
()

42 .
®lM©ch
(
a
 ->‡.
g‘Stus
().
equ®s
(
AùiÚStus
.
COMPLETED
));

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/Orchestrator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gBiM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gHashBiM­
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gM­s
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gIS”v”Rou‹r
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
.
	gAddNodeWÜkæow
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
.
	gFÜûRemoveWÜkæow
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
.
	gH—lNodeWÜkæow
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
.
	gRemoveNodeWÜkæow
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
.
	gRe¡ÜeRedundªcyM”geSegm’tsWÜkæow
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gAddNodeReque¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eReque¡
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gFÜûRemoveNodeReque¡
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gH—lNodeReque¡
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜMsg
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜRe¥Ú£
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gQu”yReque¡
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gQu”yRe¥Ú£
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRemoveNodeReque¡
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRe¥Ú£
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRe¡ÜeRedundªcyM”geSegm’tsReque¡
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
.
	gSšgËtÚResourû
;

36 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

37 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

38 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

39 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

42 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

43 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

44 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

56 @
Slf4j


57 
public
 cÏs 
	cOrche¡¿tÜ
 {

62 
´iv©e
 
fš®
 
	mACTION_RETRY
 = 3;

64 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

66 
fš®
 
	mSšgËtÚResourû
<
	mCÜfuRuÁime
> 
	mg‘RuÁime
;

68 
fš®
 
	mBiM­
<
	mUUID
, 
	mSŒšg
> 
	maùiveWÜkæows
 = 
M­s
.
synchrÚizedBiM­
(
HashBiM­
.
ü—‹
());

70 
fš®
 
ExecutÜS”viû
 
	mexecutÜ
;

72 
public
 
Orche¡¿tÜ
(@
NÚnuÎ
 
SšgËtÚResourû
<
CÜfuRuÁime
> 
ruÁime
,

73 @
NÚnuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

74 
	mthis
.
	m£rv”CÚ‹xt
 = 
£rv”CÚ‹xt
;

75 
	mthis
.
	mg‘RuÁime
 = 
ruÁime
;

77 
	mexecutÜ
 = 
ExecutÜs
.
ÃwFixedTh»adPoŞ
(
RuÁime
.
g‘RuÁime
()

78 .
avaabËProûssÜs
(), 
Ãw
 
Th»adFaùÜy
() {

80 
fš®
 
AtomicIÁeg”
 
th»adNumb”
 = 
Ãw
 AtomicInteger(0);

82 @
Ov”ride


83 
public
 
Th»ad
 
ÃwTh»ad
(
RuÂabË
 
r
) {

84 
Th»ad
 
th»ad
 = 
Ãw
 Th»ad(
r
);

85 
th»ad
.
£tD«mÚ
(
Œue
);

86 
SŒšg
 
th»adName
 = 
£rv”CÚ‹xt
.
g‘Th»adP»fix
() + "orchestrator-"

87 + 
th»adNumb”
.
g‘AndInüem’t
();

88 
th»ad
.
£tName
(
th»adName
);

89 
th»ad
.
£tUnÿughtExû±iÚHªdËr
(
this
::
hªdËUnÿughtExû±iÚ
);

90  
th»ad
;

93 
hªdËUnÿughtExû±iÚ
(
Th»ad
 
t
, @
NÚnuÎ
 
ThrowabË
 
e
) {

94 
log
.
”rÜ
("handleUncaughtException[{}]: Uncaught {}:{}",

95 
t
.
g‘Name
(),

96 
e
.
g‘CÏss
().
g‘Sim¶eName
(),

97 
e
.
g‘Mes§ge
(),

98 
e
);

103 
public
 
hªdË
(@
NÚnuÎ
 
CÜfuPaylßdMsg
<
Orche¡¿tÜMsg
> 
msg
,

104 @
NÚnuÎ
 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

105 @
NÚnuÎ
 
IS”v”Rou‹r
 
r
) {

107 
Orche¡¿tÜMsg
 
	gÜchReq
 = 
msg
.
g‘Paylßd
();

108 
IWÜkæow
 
	gwÜkæow
;

109 
	gÜchReq
.
g‘Reque¡
().
g‘Ty³
()) {

110 
	gQUERY
:

111 
qu”y
(
msg
, 
ùx
, 
r
);

113 
	gADD_NODE
:

114 
wÜkæow
 = 
Ãw
 
AddNodeWÜkæow
((
AddNodeReque¡
è
ÜchReq
.
g‘Reque¡
());

115 
di¥©ch
(
wÜkæow
, 
msg
, 
ùx
, 
r
);

117 
	gREMOVE_NODE
:

118 
wÜkæow
 = 
Ãw
 
RemoveNodeWÜkæow
((
RemoveNodeReque¡
è
ÜchReq
.
g‘Reque¡
());

119 
di¥©ch
(
wÜkæow
, 
msg
, 
ùx
, 
r
);

121 
	gHEAL_NODE
:

122 
wÜkæow
 = 
Ãw
 
H—lNodeWÜkæow
((
H—lNodeReque¡
è
ÜchReq
.
g‘Reque¡
());

123 
di¥©ch
(
wÜkæow
, 
msg
, 
ùx
, 
r
);

125 
	gFORCE_REMOVE_NODE
:

126 
wÜkæow
 = 
Ãw
 
FÜûRemoveWÜkæow
((
FÜûRemoveNodeReque¡
è
ÜchReq
.
g‘Reque¡
());

127 
di¥©ch
(
wÜkæow
, 
msg
, 
ùx
, 
r
);

129 
	gRESTORE_REDUNDANCY_MERGE_SEGMENTS
:

130 
wÜkæow
 = 
Ãw
 
Re¡ÜeRedundªcyM”geSegm’tsWÜkæow
(

131 (
Re¡ÜeRedundªcyM”geSegm’tsReque¡
è
ÜchReq
.
g‘Reque¡
());

132 
di¥©ch
(
wÜkæow
, 
msg
, 
ùx
, 
r
);

135 
log
.
”rÜ
("hªdË: UnknowÀ»que¡y³ {}", 
ÜchReq
.
g‘Reque¡
().
g‘Ty³
());

149 
qu”y
(
CÜfuPaylßdMsg
<
Orche¡¿tÜMsg
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
IS”v”Rou‹r
 
r
) {

150 
Qu”yReque¡
 
	g»q
 = (Qu”yReque¡è
msg
.
g‘Paylßd
().
g‘Reque¡
();

152 
Re¥Ú£
 
	g»¥
;

153 ià(
	gaùiveWÜkæows
.
cÚšsKey
(
»q
.
g‘Id
())) {

154 
	g»¥
 = 
Ãw
 
Qu”yRe¥Ú£
(
Œue
);

155 
	glog
.
Œaû
("hªdËQu”y:„‘uºšg‡ùivfÜ id {}", 
»q
.
g‘Id
());

157 
	g»¥
 = 
Ãw
 
Qu”yRe¥Ú£
(
çl£
);

158 
	glog
.
Œaû
("hªdËQu”y:„‘uºšg‚Ù‡ùivfÜ id {}", 
»q
.
g‘Id
());

161 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ORCHESTRATOR_RESPONSE


162 .
·ylßdMsg
(
Ãw
 
Orche¡¿tÜRe¥Ú£
(
»¥
)));

177 
synchrÚized
 
di¥©ch
(@
NÚnuÎ
 
IWÜkæow
 
wÜkæow
,

178 @
NÚnuÎ
 
CÜfuPaylßdMsg
<
Orche¡¿tÜMsg
> 
msg
,

179 @
NÚnuÎ
 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

180 @
NÚnuÎ
 
IS”v”Rou‹r
 
r
) {

181 
C»©eReque¡
 
	g»q
 = (C»©eReque¡è
msg
.
g‘Paylßd
().
g‘Reque¡
();

183 
UUID
 
	gid
 = 
aùiveWÜkæows
.
šv”£
().
g‘
(
»q
.
g‘Endpošt
());

184 ià(
	gid
 !ğ
nuÎ
) {

187 
Orche¡¿tÜRe¥Ú£
 
»¥
 = 
Ãw
 OrchestratorResponse(

188 
Ãw
 
C»©eWÜkæowRe¥Ú£
(
id
));

189 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ORCHESTRATOR_RESPONSE


190 .
·ylßdMsg
(
»¥
));

194 
	gaùiveWÜkæows
.
put
(
wÜkæow
.
g‘Id
(), 
»q
.
g‘Endpošt
());

195 
	gexecutÜ
.
execu‹
((è-> 
run
(
wÜkæow
, 
ACTION_RETRY
));

197 
Orche¡¿tÜRe¥Ú£
 
	g»¥
 = 
Ãw
 Orche¡¿tÜRe¥Ú£Òew 
C»©eWÜkæowRe¥Ú£
(
wÜkæow
.
g‘Id
()));

198 
	gr
.
£ndRe¥Ú£
(
ùx
, 
msg
, 
CÜfuMsgTy³
.
ORCHESTRATOR_RESPONSE


199 .
·ylßdMsg
(
»¥
));

210 
run
(@
NÚnuÎ
 
IWÜkæow
 
wÜkæow
, 
aùiÚR‘ry
) {

212 
CÜfuRuÁime
 
	g¹
 = 
nuÎ
;

213 
	gŒy
 {

214 
	gg‘RuÁime
.
g‘
().
šv®id©eLayout
();

215 
Layout
 
	gcu¼Layout
 = 
g‘RuÁime
.
g‘
().
g‘LayoutV›w
().
g‘Layout
();

216 
	gLi¡
<
	gNodeLoÿtÜ
> 
	g£rv”s
 = 
cu¼Layout
.
g‘AÎAùiveS”v”s
().
¡»am
()

217 .
m­
(
NodeLoÿtÜ
::
·r£SŒšg
)

218 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

224 
CÜfuRuÁimeP¬am‘”s
 
	g·¿ms
 = 
£rv”CÚ‹xt
.
g‘Mªagem’tRuÁimeP¬am‘”s
();

225 
	g·¿ms
.
£tCacheDi§bËd
(
Œue
);

226 
	g·¿ms
.
£tLayoutS”v”s
(
£rv”s
);

228 
	g¹
 = 
CÜfuRuÁime
.
äomP¬am‘”s
(
·¿ms
).
cÚÃù
();

230 
	glog
.
šfo
("run: S¹ed wÜkæow {} id {}", 
wÜkæow
.
g‘Name
(), wÜkæow.
g‘Id
());

231 
	gwÜkæowS¹
 = 
Sy¡em
.
cu¼’tTimeMlis
();

232 
AùiÚ
 
	gaùiÚ
 : 
wÜkæow
.
g‘AùiÚs
()) {

234 
log
.
debug
("run: S¹ed‡ùiÚ {} fÜ wÜkæow {}", 
aùiÚ
.
g‘Name
(), 
wÜkæow
.
g‘Id
());

235 
	gaùiÚS¹
 = 
Sy¡em
.
cu¼’tTimeMlis
();

236 
	gaùiÚ
.
execu‹
(
¹
, 
aùiÚR‘ry
);

237 
	gaùiÚEnd
 = 
Sy¡em
.
cu¼’tTimeMlis
();

238 
	glog
.
šfo
("run: finished‡ction {} for workflow {} in {} ms",

239 
aùiÚ
.
g‘Name
(), 
wÜkæow
.
g‘Id
(), 
aùiÚEnd
 - 
aùiÚS¹
);

241 ià(
	gaùiÚ
.
g‘Stus
(è!ğ
AùiÚStus
.
COMPLETED
) {

242 
log
.
”rÜ
("run: Failedoƒxecute‡ction {} for workflow {}, status {}, ",

243 
aùiÚ
.
g‘Name
(), 
wÜkæow
.
g‘Id
(),

244 
aùiÚ
.
g‘Stus
());

249 
	gwÜkæowEnd
 = 
Sy¡em
.
cu¼’tTimeMlis
();

250 
	glog
.
šfo
("run: Com¶‘ed wÜkæow {} iÀ{} ms", 
wÜkæow
.
g‘Id
(), 
wÜkæowEnd
 - 
wÜkæowS¹
);

251 } 
ÿtch
 (
Exû±iÚ
 
e
) {

252 
	glog
.
”rÜ
("run: EncouÁ”ed‡À”rÜ whruÂšg wÜkæow {}", 
wÜkæow
.
g‘Id
(), 
e
);

253 } 
	gfš®ly
 {

254 
	gaùiveWÜkæows
.
»move
(
wÜkæow
.
g‘Id
());

255 
	glog
.
debug
("run:„emoved {} from {}", 
wÜkæow
.
g‘Id
(), 
aùiveWÜkæows
);

256 ià(
	g¹
 !ğ
nuÎ
) {

257 
¹
.
shutdown
();

265 
public
 
	$shutdown
() {

266 
executÜ
.
	`shutdownNow
();

267 
Œy
 {

268 
executÜ
.
	`awa™T”mš©iÚ
(
S”v”CÚ‹xt
.
SHUTDOWN_TIMER
.
	`g‘SecÚds
(), 
TimeUn™
.
SECONDS
);

269 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

270 
log
.
	`debug
("Orche¡¿tÜƒxecutÜ‡wa™T”mš©iÚ iÁ”ru±ed : {}", 
›
);

271 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

273 
log
.
	`šfo
("Orchestrator shutting down.");

274 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/actions/RestoreRedundancyMergeSegments.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gaùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’t
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	g´ÙocŞb©ch´oûssÜ
.
	gPrÙocŞB©chProûssÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gT¿nsãrSegm’tExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gAùiÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
.
	gRedundªcyC®cuÏtÜ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gR‘ryExhau¡edExû±iÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutBud”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutMªagem’tV›w
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gExpÚ’tŸlBackoffR‘ry
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gIR‘ry
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gR‘ryN“dedExû±iÚ
;

30 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

31 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

35 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

36 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

38 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gFAILED
;

39 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gTRANSFERRED
;

45 @
	gSlf4j


46 @
	gG‘‹r


47 @
Bud”


48 
public
 cÏs 
	cRe¡ÜeRedundªcyM”geSegm’ts
 
ex‹nds
 
	mAùiÚ
 {

50 @
	mG‘‹r


51 @
NÚNuÎ


52 
´iv©e
 
fš®
 
SŒšg
 
	mcu¼’tNode
;

54 @
	mG‘‹r


55 @
NÚNuÎ


56 
´iv©e
 
fš®
 
RedundªcyC®cuÏtÜ
 
	m»dundªcyC®cuÏtÜ
;

58 @
DeçuÉ


59 
´iv©e
 
fš®
 
	m»ŒyBa£
 = 3;

61 @
DeçuÉ


62 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mbackoffDu¿tiÚ
 = Du¿tiÚ.
ofSecÚds
(10);

64 @
DeçuÉ


65 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mexŒaWa™
 = Du¿tiÚ.
ofMlis
(20);

67 @
DeçuÉ


68 
´iv©e
 
fš®
 
	m¿ndomP¬t
 = 0.5f;

70 @
DeçuÉ


71 
´iv©e
 
fš®
 
	m»¡ÜeR‘r›s
 = 3;

85 @
VisibËFÜTe¡šg


86 
Layout
 
	$»¡ÜeW™hBackOff
(
CÜfuRuÁime
 
ruÁime
, 
S‹T¿nsãrMªag”
 
ŒªsãrMªag”
)

87 
throws
 
IÁ”ru±edExû±iÚ
 {

90 
CÚsum”
<
ExpÚ’tŸlBackoffR‘ry
> 
»ŒyS‘tšgs
 = 
£‰šgs
 -> {

91 
£‰šgs
.
	`£tBa£
(
»ŒyBa£
);

92 
£‰šgs
.
	`£tExŒaWa™
(
exŒaWa™
.
	`toMlis
());

93 
£‰šgs
.
	`£tBackoffDu¿tiÚ
(
backoffDu¿tiÚ
);

94 
£‰šgs
.
	`£tRªdomPÜtiÚ
(
¿ndomP¬t
);

100 
AtomicIÁeg”
 
»Œ›s
 = 
Ãw
 
	`AtomicIÁeg”
(
»¡ÜeR‘r›s
);

101  
IR‘ry
.
	`bud
(
ExpÚ’tŸlBackoffR‘ry
.
şass
, 
R‘ryExhau¡edExû±iÚ
.class, () -> {

102 
Œy
 {

104 
ruÁime
.
	`šv®id©eLayout
();

105 
Layout
 
cu¼’tLayout
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

107 
log
.
	`šfo
("Stateransfer on {}: Layout beforeransfer: {}",

108 
cu¼’tNode
, 
cu¼’tLayout
);

111 
ŒimM¬k
 = 
	`ŒimLog
(
ruÁime
);

112 
Li¡
<
T¿nsãrSegm’t
> 
Œªsã¼edSegm’ts
 = 
	`g‘T¿nsãrSegm’ts
(
ŒªsãrMªag”
, 
cu¼’tLayout
, 
ŒimM¬k
);

114 
LayoutMªagem’tV›w
 
ÏyoutMªagem’tV›w
 = 
ruÁime
.
	`g‘LayoutMªagem’tV›w
();

117 ià(
Œªsã¼edSegm’ts
.
	`isEm±y
()) {

118 
log
.
	`šfo
("Stateransfer on: {}: Noransfer occurred, " +

119 "Œy m”gšgh£gm’ts.", 
cu¼’tNode
);

120 
ÏyoutMªagem’tV›w
.
	`m”geSegm’ts
(
cu¼’tLayout
);

124 
log
.
	`šfo
("S‹¿nsã¸Ú {}: T¿nsã¼ed segm’ts: {}.", 
cu¼’tNode
,

125 
Œªsã¼edSegm’ts
);

129 
Layout
 
ÃwLayout
 = 
»dundªcyC®cuÏtÜ
.
	`upd©eLayoutAá”RedundªcyRe¡Ü©iÚ
(

130 
Œªsã¼edSegm’ts
, 
cu¼’tLayout
);

132 
log
.
	`šfo
("S‹¿nsã¸Ú {}: New†ayout: {}.", 
cu¼’tNode
, 
ÃwLayout
);

135 ià(
RedundªcyC®cuÏtÜ
.
	`ÿnM”geSegm’ts
(
ÃwLayout
)) {

136 
ÏyoutMªagem’tV›w
.
	`m”geSegm’ts
(
ÃwLayout
);

142 
LayoutBud”
 
bud”
 = 
Ãw
 
	`LayoutBud”
(
ÃwLayout
);

143 
ÃwLayout
 = 
bud”
.
	`£tEpoch
(
cu¼’tLayout
.
	`g‘Epoch
(è+ 1).
	`bud
();

144 
ÏyoutMªagem’tV›w


145 .
	`runLayoutRecÚfigu¿tiÚ
(
cu¼’tLayout
, 
ÃwLayout
,

146 
çl£
);

150 
ruÁime
.
	`šv®id©eLayout
();

151  
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

153 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 | 
QuÜumUÄ—chabËExû±iÚ
 | 
OuŒªkedExû±iÚ
 
e
) {

154 
log
.
	`w¬n
("GÙ: {}. R‘ryšg: {}imes.", 
e
.
	`g‘Mes§ge
(), 
»Œ›s
.
	`g‘
());

155 ià(
»Œ›s
.
	`deüem’tAndG‘
() < 0) {

156 
throw
 
Ãw
 
	`R‘ryExhau¡edExû±iÚ
("R‘r› exhau¡ed.", 
e
);

158 
throw
 
Ãw
 
	`R‘ryN“dedExû±iÚ
();

160 } 
	`ÿtch
 (
T¿nsãrSegm’tExû±iÚ
 
e
) {

161 
throw
 
Ãw
 
	`R‘ryExhau¡edExû±iÚ
("T¿nsã¸£gm’ˆexû±iÚ occu¼ed.", 
e
);

164 }).
	`£tO±iÚs
(
»ŒyS‘tšgs
).
	`run
();

168 
´iv©e
 
Li¡
<
T¿nsãrSegm’t
> 
	$g‘T¿nsãrSegm’ts
(

169 
S‹T¿nsãrMªag”
 
ŒªsãrMªag”
, 
Layout
 
cu¼’tLayout
, 
ŒimM¬k
) {

171 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
´eT¿nsãrLi¡
 =

172 
»dundªcyC®cuÏtÜ
.
	`ü—‹S‹Li¡
(
cu¼’tLayout
, 
ŒimM¬k
);

175 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
ŒªsãrLi¡
 = 
ŒªsãrMªag”


176 .
	`hªdËT¿nsãr
(
´eT¿nsãrLi¡
);

179 
Li¡
<
T¿nsãrSegm’t
> 
çedLi¡
 = 
ŒªsãrLi¡
.
	`¡»am
()

180 .
	`f‹r
(
£gm’t
 -> segm’t.
	`g‘Stus
().
	`g‘Segm’tS‹
(è=ğ
FAILED
)

181 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

184 
O±iÚ®
<
T¿nsãrSegm’tExû±iÚ
> 
ŒªsãrSegm’tFau»
 = 
çedLi¡
.
	`¡»am
()

185 .
	`fšdFœ¡
()

186 .
	`æ©M­
(
ts
 ->s.
	`g‘Stus
().
	`g‘Cau£OfFau»
());

188 
ŒªsãrSegm’tFau»
.
	`ifP»£Á
(
çu»
 -> {

189 
throw
 
çu»
;

193  
ŒªsãrLi¡
.
	`¡»am
()

194 .
	`f‹r
(
£gm’t
 -> segm’t.
	`g‘Stus
().
	`g‘Segm’tS‹
(è=ğ
TRANSFERRED
)

195 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

196 
	}
}

204 @
VisibËFÜTe¡šg


205 
	$ŒimLog
(
CÜfuRuÁime
 
ruÁime
) {

207 
ŒimM¬k
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
();

209 
Layout
 
Ïyout
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

211 
Tok’
 
´efixTok’
 = 
Ãw
 
	`Tok’
(
Ïyout
.
	`g‘Epoch
(), 
ŒimM¬k
 - 1);

213 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
ruÁime


214 .
	`g‘LayoutV›w
()

215 .
	`g‘RuÁimeLayout
(
Ïyout
)

216 .
	`g‘LogUn™Cl›Á
(
cu¼’tNode
);

218 
logUn™Cl›Á
.
	`´efixTrim
(
´efixTok’
).
	`još
();

220 
logUn™Cl›Á
.
	`com·ù
().
	`još
();

222  
ŒimM¬k
;

223 
	}
}

225 @
	gNÚnuÎ


226 @
Ov”ride


227 
public
 
SŒšg
 
	$g‘Name
() {

229 
	}
}

231 @
Ov”ride


232 
public
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
è
throws
 
	gExû±iÚ
 {

235 
	gruÁime
.
šv®id©eLayout
();

236 
Layout
 
	gÏyout
 = 
ruÁime
.
g‘LayoutV›w
().
g‘Layout
();

239 
LogUn™Cl›Á
 
	glogUn™Cl›Á
 =

240 
ruÁime
.
g‘LayoutV›w
().
g‘RuÁimeLayout
(
Ïyout
).
g‘LogUn™Cl›Á
(
cu¼’tNode
);

243 
PrÙocŞB©chProûssÜ
 
	gb©chProûssÜ
 = ProtocolBatchProcessor

244 .
bud”
()

245 .
add»ssS·ûV›w
(
ruÁime
.
g‘Add»ssS·ûV›w
())

246 .
logUn™Cl›Á
(logUnitClient)

247 .
bud
();

250 
S‹T¿nsãrMªag”
 
	gŒªsãrMªag”
 =

251 
S‹T¿nsãrMªag”


252 .
bud”
()

253 .
logUn™Cl›Á
(logUnitClient)

254 .
b©chSize
(
ruÁime
.
g‘P¬am‘”s
().
g‘BulkR—dSize
())

255 .
b©chProûssÜ
(batchProcessor)

256 .
bud
();

260 
	gRedundªcyC®cuÏtÜ
.
ÿnRe¡ÜeRedundªcyOrM”geSegm’ts
(
Ïyout
, 
cu¼’tNode
)) {

261 
	gÏyout
 = 
»¡ÜeW™hBackOff
(
ruÁime
, 
ŒªsãrMªag”
);

263 
	glog
.
šfo
("S‹¿nsã¸Ú {}: Re¡Üed.", 
cu¼’tNode
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/AddNodeWorkflow.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gAùiÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gIWÜkæow
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gaùiÚs
.
	gRe¡ÜeRedundªcyM”geSegm’ts
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
.
	gRedundªcyC®cuÏtÜ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gAddNodeReque¡
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

14 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

15 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gADD_NODE
;

30 @
	gNÙTh»adSaã


31 @
Slf4j


32 
public
 cÏs 
	cAddNodeWÜkæow
 
im¶em’ts
 
	mIWÜkæow
 {

34 
´iv©e
 
fš®
 
AddNodeReque¡
 
	m»que¡
;

36 
Layout
 
	mÃwLayout
;

38 @
G‘‹r


39 
fš®
 
UUID
 
	mid
;

41 @
G‘‹r


42 
	mLi¡
<
	mAùiÚ
> 
	maùiÚs
;

49 
public
 
	$AddNodeWÜkæow
(
AddNodeReque¡
 
»que¡
) {

50 
this
.
id
 = 
UUID
.
	`¿ndomUUID
();

51 
this
.
»que¡
 =„equest;

52 
aùiÚs
 = 
ImmubËLi¡
.
	`of
(
Ãw
 
	`BoÙ¡¿pNode
(),

53 
Ãw
 
	`AddNodeToLayout
(),

54 
Re¡ÜeRedundªcyM”geSegm’ts
.
	`bud”
()

55 .
	`cu¼’tNode
(
»que¡
.
	`g‘Endpošt
())

56 .
	`»dundªcyC®cuÏtÜ
(
Ãw
 
	`RedundªcyC®cuÏtÜ
(
»que¡
.
	`g‘Endpošt
()))

57 .
	`bud
());

60 @
Ov”ride


61 
public
 
SŒšg
 
	$g‘Name
() {

62  
ADD_NODE
.
	`toSŒšg
();

63 
	}
}

69 
´Ùeùed
 cÏs 
	cBoÙ¡¿pNode
 
ex‹nds
 
	gAùiÚ
 {

70 @
Ov”ride


71 
public
 
SŒšg
 
g‘Name
() {

80 @
Ov”ride


81 
public
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
è
throws
 
	gExû±iÚ
 {

82 
	gruÁime
.
g‘LayoutMªagem’tV›w
().
boÙ¡¿pNewNode
(
»que¡
.
g‘Endpošt
()).
g‘
();

93 
´iv©e
 cÏs 
	cAddNodeToLayout
 
ex‹nds
 
	gAùiÚ
 {

94 @
Ov”ride


95 
public
 
SŒšg
 
g‘Name
() {

99 @
Ov”ride


100 
public
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
è
throws
 
	gExû±iÚ
 {

101 
	gruÁime
.
šv®id©eLayout
();

102 
Layout
 
	gcu¼’tLayout
 = 
Ãw
 Layout(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

103 
	gruÁime
.
g‘LayoutMªagem’tV›w
().
addNode
(
cu¼’tLayout
, 
»que¡
.
g‘Endpošt
(),

104 
Œue
,rue,

105 
Œue
, 
çl£
,

108 
	gruÁime
.
šv®id©eLayout
();

109 
	gÃwLayout
 = 
Ãw
 
Layout
(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/ForceRemoveWorkflow.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
;

2 
impÜt
 
	glombok
.
	gG‘‹r
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gAùiÚ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gIWÜkæow
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gFÜûRemoveNodeReque¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

11 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gFORCE_REMOVE_NODE
;

25 @
Slf4j


26 
public
 cÏs 
	cFÜûRemoveWÜkæow
 
im¶em’ts
 
	mIWÜkæow
 {

28 
fš®
 
FÜûRemoveNodeReque¡
 
	m»que¡
;

33 @
G‘‹r


34 
fš®
 
UUID
 
	mid
;

36 @
G‘‹r


37 
fš®
 
	mLi¡
<
	mAùiÚ
> 
	maùiÚs
;

41 
public
 
FÜûRemoveWÜkæow
(@
NÚnuÎ
 
FÜûRemoveNodeReque¡
 
»que¡
) {

42 
	mthis
.
	mid
 = 
UUID
.
¿ndomUUID
();

43 
	mthis
.
	m»que¡
 = 
»que¡
;

44 
	maùiÚs
 = 
CŞËùiÚs
.
sšgËtÚLi¡
(
Ãw
 
FÜûRemoveNode
());

47 @
Ov”ride


48 
public
 
SŒšg
 
	$g‘Name
() {

49  
FORCE_REMOVE_NODE
.
	`toSŒšg
();

50 
	}
}

57 şas 
	cFÜûRemoveNode
 
ex‹nds
 
	gAùiÚ
 {

58 @
Ov”ride


59 
public
 
SŒšg
 
g‘Name
() {

63 @
Ov”ride


64 
public
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
) {

65 
	gruÁime
.
šv®id©eLayout
();

66 
Layout
 
	gcu¼’tLayout
 = 
Ãw
 Layout(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

67 
Layout
 
	gÃwLayout
 = 
Ãw
 Layout(
cu¼’tLayout
);

69 
	gÃwLayout
.
£tEpoch
(
ÃwLayout
.
g‘Epoch
() + 1);

71 
	gÃwLayout
.
g‘LayoutS”v”s
().
»move
(
»que¡
.
g‘Endpošt
());

72 
	gÃwLayout
.
g‘Sequ’ûrs
().
»move
(
»que¡
.
g‘Endpošt
());

73 
	gÃwLayout
.
g‘UÄe¥ÚsiveS”v”s
().
»move
(
»que¡
.
g‘Endpošt
());

75 
	gLayout
.
LayoutSegm’t
 
	g£gm’t
 : 
ÃwLayout
.
g‘Segm’ts
()) {

76 
Layout
.
LayoutSŒe
 
¡re
 : 
£gm’t
.
g‘SŒes
()) {

77 
¡re
.
g‘LogS”v”s
().
»move
(
»que¡
.
g‘Endpošt
());

81 
	glog
.
šfo
("fÜû„emoved {} from {},‚ew†ayouˆ{}", 
»que¡
.
g‘Endpošt
(),

82 
cu¼’tLayout
, 
ÃwLayout
);

84 
	gruÁime
.
g‘LayoutMªagem’tV›w
().
fÜûLayout
(
cu¼’tLayout
, 
ÃwLayout
);

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/HealNodeWorkflow.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gAùiÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gaùiÚs
.
	gRe¡ÜeRedundªcyM”geSegm’ts
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
.
	gRedundªcyC®cuÏtÜ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gAddNodeReque¡
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gH—lNodeReque¡
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

13 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gHEAL_NODE
;

25 @
Slf4j


26 
public
 cÏs 
	cH—lNodeWÜkæow
 
ex‹nds
 
	mAddNodeWÜkæow
 {

28 
´iv©e
 
fš®
 
H—lNodeReque¡
 
	m»que¡
;

30 
public
 
	$H—lNodeWÜkæow
(
H—lNodeReque¡
 
h—lNodeReque¡
) {

31 
	`su³r
(
Ãw
 
	`AddNodeReque¡
(
h—lNodeReque¡
.
	`g‘Endpošt
()));

32 
this
.
»que¡
 = 
h—lNodeReque¡
;

33 
this
.
aùiÚs
 = 
ImmubËLi¡
.
	`of
(
Ãw
 
	`H—lNodeToLayout
(),

34 
Re¡ÜeRedundªcyM”geSegm’ts
.
	`bud”
()

35 .
	`cu¼’tNode
(
»que¡
.
	`g‘Endpošt
())

36 .
	`»dundªcyC®cuÏtÜ
(
Ãw
 
	`RedundªcyC®cuÏtÜ
(
»que¡
.
	`g‘Endpošt
()))

37 .
	`bud
());

40 @
Ov”ride


41 
public
 
SŒšg
 
	$g‘Name
() {

42  
HEAL_NODE
.
	`toSŒšg
();

43 
	}
}

51 şas 
	cH—lNodeToLayout
 
ex‹nds
 
	gAùiÚ
 {

52 @
Ov”ride


53 
public
 
SŒšg
 
g‘Name
() {

57 @
Ov”ride


58 
public
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
è
throws
 
	gExû±iÚ
 {

59 
Layout
 
	gcu¼’tLayout
 = 
Ãw
 Layout(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

60 
	gruÁime
.
g‘LayoutMªagem’tV›w
().
h—lNode
(
cu¼’tLayout
, 
»que¡
.
g‘Endpošt
());

61 
	gruÁime
.
šv®id©eLayout
();

62 
	gÃwLayout
 = 
Ãw
 
Layout
(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/RemoveNodeWorkflow.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gAùiÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gIWÜkæow
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRemoveNodeReque¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

12 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gREMOVE_NODE
;

25 @
Slf4j


26 
public
 cÏs 
	cRemoveNodeWÜkæow
 
im¶em’ts
 
	mIWÜkæow
 {

28 
´iv©e
 
fš®
 
RemoveNodeReque¡
 
	m»que¡
;

33 @
G‘‹r


34 
fš®
 
UUID
 
	mid
;

36 @
G‘‹r


37 
fš®
 
	mLi¡
<
	mAùiÚ
> 
	maùiÚs
;

44 
public
 
RemoveNodeWÜkæow
(@
NÚnuÎ
 
RemoveNodeReque¡
 
»que¡
) {

45 
	mthis
.
	mid
 = 
UUID
.
¿ndomUUID
();

46 
	mthis
.
	m»que¡
 = 
»que¡
;

47 
	maùiÚs
 = 
CŞËùiÚs
.
sšgËtÚLi¡
(
Ãw
 
RemoveNode
());

51 @
Ov”ride


52 
public
 
SŒšg
 
	$g‘Name
() {

53  
REMOVE_NODE
.
	`toSŒšg
();

54 
	}
}

59 şas 
	cRemoveNode
 
ex‹nds
 
	gAùiÚ
 {

60 @
Ov”ride


61 
public
 
SŒšg
 
g‘Name
() {

62  
	gREMOVE_NODE
.
toSŒšg
();

65 @
Ov”ride


66 
public
 
im¶
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
è
throws
 
	gExû±iÚ
 {

67 
Layout
 
	gÏyout
 = 
Ãw
 Layout(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

68 
	gruÁime
.
g‘LayoutMªagem’tV›w
().
»moveNode
(
Ïyout
,

69 
»que¡
.
g‘Endpošt
());

	@infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/RestoreRedundancyMergeSegmentsWorkflow.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gwÜkæows
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gAùiÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gIWÜkæow
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gaùiÚs
.
	gRe¡ÜeRedundªcyM”geSegm’ts
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
.
	gRedundªcyC®cuÏtÜ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRe¡ÜeRedundªcyM”geSegm’tsReque¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gRESTORE_REDUNDANCY_MERGE_SEGMENTS
;

24 @
Slf4j


25 
public
 cÏs 
	cRe¡ÜeRedundªcyM”geSegm’tsWÜkæow
 
im¶em’ts
 
	mIWÜkæow
 {

28 
´iv©e
 
fš®
 
Re¡ÜeRedundªcyM”geSegm’tsReque¡
 
	m»que¡
;

30 @
G‘‹r


31 
´iv©e
 
fš®
 
UUID
 
	mid
;

33 @
G‘‹r


34 
´iv©e
 
fš®
 
	mLi¡
<
	mAùiÚ
> 
	maùiÚs
;

41 
public
 
	$Re¡ÜeRedundªcyM”geSegm’tsWÜkæow
(

42 
Re¡ÜeRedundªcyM”geSegm’tsReque¡
 
»que¡
) {

43 
this
.
id
 = 
UUID
.
	`¿ndomUUID
();

44 
this
.
»que¡
 =„equest;

45 
this
.
aùiÚs
 = 
ImmubËLi¡
.
	`of
(

46 
Re¡ÜeRedundªcyM”geSegm’ts
.
	`bud”
()

47 .
	`cu¼’tNode
(
»que¡
.
	`g‘Endpošt
())

48 .
	`»dundªcyC®cuÏtÜ
(
Ãw
 
	`RedundªcyC®cuÏtÜ
(
»que¡
.
	`g‘Endpošt
()))

49 .
	`bud
());

52 @
Ov”ride


53 
public
 
SŒšg
 
	$g‘Name
() {

54  
RESTORE_REDUNDANCY_MERGE_SEGMENTS
.
	`toSŒšg
();

55 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/paxos/PaxosDataStore.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g·xos
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gD©aStÜe
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gKvD©aStÜe
.
	gKvRecÜd
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gPha£2D©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gRªk
;

10 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

15 @
Bud”


16 
public
 cÏs 
	cPaxosD©aStÜe
 {

18 
public
 
fš®
 
SŒšg
 
	mPREFIX_PHASE_1
 = "PHASE_1";

19 
public
 
fš®
 
SŒšg
 
	mPREFIX_PHASE_2
 = "PHASE_2";

20 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_SUFFIX_PHASE_1
 = "RANK";

21 
´iv©e
 
fš®
 
SŒšg
 
	mKEY_SUFFIX_PHASE_2
 = "DATA";

23 @
NÚNuÎ


24 
´iv©e
 
fš®
 
D©aStÜe
 
	md©aStÜe
;

31 
public
 
	mO±iÚ®
<
	mRªk
> 
	$g‘Pha£1Rªk
(
£rv”Epoch
) {

32 
KvRecÜd
<
Rªk
> 
pha£1RecÜd
 = KvRecÜd.
	`of
(

33 
PREFIX_PHASE_1
, 
£rv”Epoch
 + 
KEY_SUFFIX_PHASE_1
, 
Rªk
.
şass


36 
Rªk
 
¿nk
 = 
d©aStÜe
.
	`g‘
(
pha£1RecÜd
);

37  
O±iÚ®
.
	`ofNuÎabË
(
¿nk
);

45 
public
 
	$£tPha£1Rªk
(
Rªk
 
¿nk
, 
£rv”Epoch
) {

46 
KvRecÜd
<
Rªk
> 
pha£1RecÜd
 = KvRecÜd.
	`of
(

47 
PREFIX_PHASE_1
,

48 
£rv”Epoch
 + 
KEY_SUFFIX_PHASE_1
,

49 
Rªk
.
şass


51 
d©aStÜe
.
	`put
(
pha£1RecÜd
, 
¿nk
);

52 
	}
}

59 
public
 
	gO±iÚ®
<
	gPha£2D©a
> 
	$g‘Pha£2D©a
(
£rv”Epoch
) {

60 
KvRecÜd
<
Pha£2D©a
> 
pha£2RecÜd
 = KvRecÜd.
	`of
(

61 
PREFIX_PHASE_2
,

62 
£rv”Epoch
 + 
KEY_SUFFIX_PHASE_2
,

63 
Pha£2D©a
.
şass


66  
O±iÚ®
.
	`ofNuÎabË
(
d©aStÜe
.
	`g‘
(
pha£2RecÜd
));

67 
	}
}

74 
public
 
	$£tPha£2D©a
(
Pha£2D©a
 
pha£2D©a
, 
£rv”Epoch
) {

75 
KvRecÜd
<
Pha£2D©a
> 
pha£2RecÜd
 = KvRecÜd.
	`of
(

76 
PREFIX_PHASE_2
,

77 
£rv”Epoch
 + 
KEY_SUFFIX_PHASE_2
,

78 
Pha£2D©a
.
şass


80 
d©aStÜe
.
	`put
(
pha£2RecÜd
, 
pha£2D©a
);

81 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/redundancy/RedundancyCalculator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

6 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’t
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSŒe
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutBud”
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁP»diÿ‹
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gNOT_TRANSFERRED
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gRESTORED
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
.
	gNON_ADDRESS
;

29 @
AÎArgsCÚ¡ruùÜ


30 
public
 cÏs 
	cRedundªcyC®cuÏtÜ
 {

32 @
	mNÚNuÎ


33 @
G‘‹r


34 
´iv©e
 
fš®
 
SŒšg
 
	m£rv”
;

36 @
VisibËFÜTe¡šg


37 
boŞ—n
 
	$£gm’tCÚšsS”v”
(
LayoutSegm’t
 
£gm’t
, 
SŒšg
 
£rv”
) {

38  
£gm’t
.
	`g‘Fœ¡SŒe
().
	`g‘LogS”v”s
().
	`cÚšs
(
£rv”
);

50 @
VisibËFÜTe¡šg


51 
Layout
 
	$»¡ÜeRedundªcyFÜSegm’t
(
T¿nsãrSegm’t
 
ŒªsãrSegm’t
, 
Layout
 
Ïyout
) {

52 
Li¡
<
LayoutSegm’t
> 
£gm’ts
 = 
Ïyout
.
	`g‘Segm’ts
().
	`¡»am
().
	`m­
(
ÏyoutSegm’t
 -> {

53 ià(
ÏyoutSegm’t
.
	`g‘End
(è=ğ
ŒªsãrSegm’t
.
	`g‘EndAdd»ss
() + 1L) {

55 
Li¡
<
LayoutSŒe
> 
ÃwSŒes
 = 
ÏyoutSegm’t
.
	`g‘SŒes
()

56 .
	`¡»am
()

57 .
	`m­
(
¡re
 -> {

59 ià(
ÏyoutSegm’t
.
	`g‘Fœ¡SŒe
().
	`equ®s
(
¡re
)) {

60 
ImmubËLi¡
<
SŒšg
> 
£rv”s
 = 
Ãw
 ImmutableList

61 .
Bud”
<
SŒšg
>()

62 .
	`addAÎ
(
¡re
.
	`g‘LogS”v”s
())

63 .
	`add
(
£rv”
)

64 .
	`bud
();

66  
Ãw
 
	`LayoutSŒe
(
£rv”s
);

69  
¡re
;

72 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

74  
Ãw
 
	`LayoutSegm’t
(

75 
ÏyoutSegm’t
.
	`g‘R•liÿtiÚMode
(),†ayoutSegm’t.
	`g‘S¹
(),

76 
ÏyoutSegm’t
.
	`g‘End
(), 
ÃwSŒes
);

78  
Ãw
 
	`LayoutSegm’t
(

79 
ÏyoutSegm’t
.
	`g‘R•liÿtiÚMode
(),†ayoutSegm’t.
	`g‘S¹
(),

80 
ÏyoutSegm’t
.
	`g‘End
(),†ayoutSegm’t.
	`g‘SŒes
());

82 }).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

83 
Layout
 
ÃwLayout
 = 
Ãw
 
	`Layout
(
Ïyout
);

84 
LayoutBud”
 
bud”
 = 
Ãw
 
	`LayoutBud”
(
ÃwLayout
);

85  
bud”
.
	`£tSegm’ts
(
£gm’ts
).
	`bud
();

86 
	}
}

95 
public
 
Layout
 
upd©eLayoutAá”RedundªcyRe¡Ü©iÚ
(

96 
Li¡
<
T¿nsãrSegm’t
> 
£gm’ts
, 
Layout
 
š™Layout
) {

97  
	g£gm’ts


98 .
¡»am
()

99 .
»duû
(
š™Layout
,

100 (
Ïyout
, 
£gm’t
è-> 
»¡ÜeRedundªcyFÜSegm’t
(segment,†ayout),

101 (
ŞdLayout
, 
ÃwLayout
) ->‚ewLayout);

116 
public
 
boŞ—n
 
	$ÿnRe¡ÜeRedundªcy
(
Layout
 
Ïyout
, 
SŒšg
 
£rv”
) {

117 ià(
Ïyout
.
	`g‘Segm’ts
().
	`size
() == 1) {

119  
çl£
;

122 
IÁP»diÿ‹
 
nodeNÙP»£Á
 = 
cu¼’tIndex
 -> 
S‘s
.
	`difã»nû
(

123 
Ïyout
.
	`g‘Segm’ts
().
	`g‘
(
cu¼’tIndex
).
	`g‘AÎLogS”v”s
(),

124 
Ïyout
.
	`g‘Segm’ts
().
	`g‘
(
cu¼’tIndex
 - 1).
	`g‘AÎLogS”v”s
()

125 ).
	`cÚšs
(
£rv”
);

127  
IÁSŒ—m
.
	`¿nge
(1, 
Ïyout
.
	`g‘Segm’ts
().
	`size
())

128 .
	`boxed
()

129 .
	`»duû
(
çl£
,

130 (
nodeP»£ÁSoF¬
, 
cu¼’tIndex
) ->

131 
nodeP»£ÁSoF¬
 || 
nodeNÙP»£Á
.
	`‹¡
(
cu¼’tIndex
),

132 (
nodeP»£ÁBefÜe
, 
nodeP»£ÁNow
) ->

133 
nodeP»£ÁBefÜe
 || 
nodeP»£ÁNow
);

135 
	}
}

145 
public
 
boŞ—n
 
	$ÿnM”geSegm’ts
(
Layout
 
Ïyout
) {

146 ià(
Ïyout
.
	`g‘Segm’ts
().
	`size
() == 1) {

147  
çl£
;

149 
fš®
 
fœ¡Segm’tIndex
 = 0;

150 
fš®
 
£cÚdSegm’tIndex
 = 1;

151  
S‘s
.
	`difã»nû
(

152 
Ïyout
.
	`g‘Segm’ts
().
	`g‘
(
£cÚdSegm’tIndex
).
	`g‘AÎLogS”v”s
(),

153 
Ïyout
.
	`g‘Segm’ts
().
	`g‘
(
fœ¡Segm’tIndex
).
	`g‘AÎLogS”v”s
()).
	`isEm±y
();

155 
	}
}

165 
public
 
boŞ—n
 
	$ÿnRe¡ÜeRedundªcyOrM”geSegm’ts
(
Layout
 
Ïyout
, 
SŒšg
 
£rv”
) {

166  
RedundªcyC®cuÏtÜ
.
	`ÿnRe¡ÜeRedundªcy
(
Ïyout
, 
£rv”
) ||

167 
RedundªcyC®cuÏtÜ
.
	`ÿnM”geSegm’ts
(
Ïyout
);

168 
	}
}

178 
public
 
	gImmubËLi¡
<
	gT¿nsãrSegm’t
> 
	$ü—‹S‹Li¡
(
Layout
 
Ïyout
, 
ŒimM¬k
) {

179  
Ïyout
.
	`g‘Segm’ts
()

180 .
	`¡»am
()

182 .
	`f‹r
(
£gm’t
 -> segm’t.
	`g‘End
(è!ğ
NON_ADDRESS
 && segm’t.g‘End(è> 
ŒimM¬k
)

183 .
	`m­
(
£gm’t
 -> {

186 
£gm’tS¹
 = 
M©h
.
	`max
(
£gm’t
.
	`g‘S¹
(), 
ŒimM¬k
);

189 
£gm’tEnd
 = 
£gm’t
.
	`g‘End
() - 1L;

191 ià(
	`£gm’tCÚšsS”v”
(
£gm’t
, 
	`g‘S”v”
())) {

192 
T¿nsãrSegm’tStus
 
»¡Üed
 = TransferSegmentStatus

193 .
	`bud”
()

194 .
	`£gm’tS‹
(
RESTORED
)

195 .
	`tÙ®T¿nsã¼ed
(
£gm’tEnd
 - 
£gm’tS¹
 + 1L)

196 .
	`bud
();

198  
T¿nsãrSegm’t


199 .
	`bud”
()

200 .
	`¡¬tAdd»ss
(
£gm’tS¹
)

201 .
	`’dAdd»ss
(
£gm’tEnd
)

202 .
	`¡©us
(
»¡Üed
)

203 .
	`bud
();

205 
T¿nsãrSegm’tStus
 
nÙT¿nsã¼ed
 = TransferSegmentStatus

206 .
	`bud”
()

207 .
	`£gm’tS‹
(
NOT_TRANSFERRED
)

208 .
	`tÙ®T¿nsã¼ed
(0L)

209 .
	`bud
();

211  
T¿nsãrSegm’t


212 .
	`bud”
()

213 .
	`¡¬tAdd»ss
(
£gm’tS¹
)

214 .
	`’dAdd»ss
(
£gm’tEnd
)

215 .
	`¡©us
(
nÙT¿nsã¼ed
)

216 .
	`bud
();

220 .
	`cŞËù
(
ImmubËLi¡
.
	`toImmubËLi¡
());

221 
	}
}

	@infrastructure/src/main/java/org/corfudb/infrastructure/utils/Persistence.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	guts
;

3 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

4 
impÜt
 
	gjava
.
	gnio
.
	gchªÃls
.
	gFeChªÃl
;

5 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

6 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

14 
public
 cÏs 
	cP”si¡’û
 {

26 
public
 
	$syncDœeùÜy
(
SŒšg
 
dœ
è
throws
 
IOExû±iÚ
 {

27 
P©h
 
dœP©h
 = 
P©hs
.
	`g‘
(
dœ
);

28 
	`Œy
 (
FeChªÃl
 
chªÃl
 = FeChªÃl.
	`İ’
(
dœP©h
)) {

29 
chªÃl
.
	`fÜû
(
Œue
);

32 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/CorfuAbstractServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

10 
impÜt
 
	gÜg
.
	gmock™o
.
	gM©ch”s
.
	gªy
;

11 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

12 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gtimes
;

13 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gv”ify
;

15 
public
 cÏs 
	cCÜfuAb¡¿ùS”v”Te¡
 {

20 @
Te¡


21 
public
 
	$‹¡Shutdown
() {

22 
fš®
 
HªdËrM‘hods
 
hªdËr
 = 
	`mock
(HªdËrM‘hods.
şass
);

23 
fš®
 
ExecutÜS”viû
 
executÜ
 = 
	`mock
(ExecutÜS”viû.
şass
);

25 
Ab¡¿ùS”v”
 
£rv”
 = 
Ãw
 
	`Ab¡¿ùS”v”
() {

26 @
Ov”ride


27 
public
 
HªdËrM‘hods
 
	`g‘HªdËr
() {

28  
hªdËr
;

31 @
Ov”ride


32 
public
 
boŞ—n
 
	`isS”v”R—dyToHªdËMsg
(
CÜfuMsg
 
msg
) {

33  
	`g‘S‹
(è=ğ
S”v”S‹
.
READY
;

37 
£rv”
.
	`shutdown
();

39 
£rv”
.
	`hªdËMes§ge
(

40 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
WRITE
),

41 
	`mock
(
ChªÃlHªdËrCÚ‹xt
.
şass
),

42 
	`mock
(
IS”v”Rou‹r
.
şass
)

45 
	`v”ify
(
hªdËr
, 
	`times
(0)).
	`hªdË
(
	`ªy
(),‡ny(),‡ny());

47 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/LayoutBasedTestHelper.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

6 
impÜt
 
	glombok
.
	gToSŒšg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

12 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gR•liÿtiÚMode
.
	gCHAIN_REPLICATION
;

19 
public
 cÏs 
	cLayoutBa£dTe¡H–³r
 {

20 
´iv©e
 
SŒšg
 
	m£rv”s
 = "A|B|C";

22 
public
 
Layout
 
ü—‹Te¡Layout
(
Li¡
<Layout.
LayoutSegm’t
> 
£gm’ts
){

24 
	mLi¡
<
	mSŒšg
> 
	ms
 = 
A¼ays
.
¡»am
(
£rv”s
.
¥l™
("|")).
cŞËù
(
CŞËùÜs
.
toLi¡
());

25 
	m•och
 = 0L;

26 
UUID
 
	muuid
 = UUID.
¿ndomUUID
();

27  
Ãw
 
Layout
(
s
, s, 
£gm’ts
,‚ew 
A¼ayLi¡
<>(), 
•och
, 
uuid
);

30 @
	gAÎArgsCÚ¡ruùÜ


31 @
	gEqu®sAndHashCode


32 @
ToSŒšg


33 
public
 cÏs 
	cMockedSegm’t
 {

34 
public
 
fš®
 
	g¡¬tAdd»ss
;

35 
public
 
fš®
 
	g’dAdd»ss
;

36 
public
 
	gS‹T¿nsãrMªag”
.
T¿nsãrSegm’tStus
 
	g¡©us
;

39 
public
 
Layout
 
	$ü—‹NÚP»£ÁLayout
() {

40 
Layout
.
LayoutSŒe
 
¡re1
 = 
Ãw
 Layout.
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("A", "B"));

41 
Layout
.
LayoutSŒe
 
¡re2
 = 
Ãw
 Layout.
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("A", "B"));

42 
Layout
.
LayoutSŒe
 
¡re3
 = 
Ãw
 Layout.
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("localhost", "A", "B"));

44 
Layout
.
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 Layout.
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 2L,

45 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re1
));

47 
Layout
.
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 Layout.
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 2L, 4L,

48 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re2
));

50 
Layout
.
LayoutSegm’t
 
£gm’t3
 = 
Ãw
 Layout.
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 4L, -1L,

51 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re3
));

53  
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
, 
£gm’t3
));

54 
	}
}

56 
public
 
Layout
 
	$ü—‹P»£ÁLayout
() {

58 
Layout
 
Ïyout
 = 
	`ü—‹NÚP»£ÁLayout
();

59 
Layout
.
LayoutSŒe
 
¡re2
 = 
Ãw
 Layout.
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("localhost", "A", "B"));

61 
Layout
.
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 Layout.
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 2L, 4L,

62 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re2
));

64  
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
Ïyout
.
	`g‘Segm’t
(0L),

65 
£gm’t2
, 
Ïyout
.
	`g‘Segm’t
(4L)));

66 
	}
}

68 
public
 
MockedSegm’t
 
	$ŒªsfÜmToMock
(
S‹T¿nsãrMªag”
.
T¿nsãrSegm’t
 
£gm’t
) {

69  
Ãw
 
	`MockedSegm’t
(
£gm’t
.
	`g‘S¹Add»ss
(), segm’t.
	`g‘EndAdd»ss
(), segm’t.
	`g‘Stus
());

70 
	}
}

72 
public
 
	gImmubËLi¡
<
	gMockedSegm’t
> 
ŒªsfÜmLi¡ToMock
(
Li¡
<
S‹T¿nsãrMªag”
.
T¿nsãrSegm’t
> 
£gm’ts
) {

73  
	gImmubËLi¡
.
cİyOf
(
£gm’ts
.
¡»am
().
m­
(
this
::
ŒªsfÜmToMock
).
cŞËù
(
CŞËùÜs
.
toLi¡
()));

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/StreamLogChecksumTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

7 
public
 cÏs 
	cSŒ—mLogChecksumTe¡
 {

9 @
Te¡


10 
public
 
	$‹¡ChecksumBy‹s
() {

11 
	`as£¹Equ®s
(506166820, 
SŒ—mLogFes
.
Checksum
.
	`g‘Checksum
("cÜfuDb".
	`g‘By‹s
()));

12 
	`as£¹Equ®s
(-2036305216, 
SŒ—mLogFes
.
Checksum
.
	`g‘Checksum
("‹¡".
	`g‘By‹s
()));

13 
	`as£¹Equ®s
(-1819997757, 
SŒ—mLogFes
.
Checksum
.
	`g‘Checksum
("checksum".
	`g‘By‹s
()));

16 @
Te¡


17 
public
 
	$‹¡ChecksumIÁ
() {

18 
	`as£¹Equ®s
(-698278101, 
SŒ—mLogFes
.
Checksum
.
	`g‘Checksum
(42));

19 
	`as£¹Equ®s
(2097792135, 
SŒ—mLogFes
.
Checksum
.
	`g‘Checksum
(
IÁeg”
.
MAX_VALUE
));

20 
	`as£¹Equ®s
(-896438081, 
SŒ—mLogFes
.
Checksum
.
	`g‘Checksum
(
IÁeg”
.
MIN_VALUE
));

21 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/StreamLogDataStoreTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gD©aStÜe
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gRuË
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTempÜ¬yFŞd”
;

9 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

14 @
Slf4j


15 
public
 cÏs 
	cSŒ—mLogD©aStÜeTe¡
 {

16 
´iv©e
 
fš®
 
	mINITIAL_ADDRESS
 = 0L;

18 @
RuË


19 
public
 
TempÜ¬yFŞd”
 
	m‹mpDœ
 = 
Ãw
 TemporaryFolder();

21 @
Te¡


22 
public
 
	$‹¡G‘AndSave
() {

23 
SŒ—mLogD©aStÜe
 
¡»amLogDs
 = 
	`g‘SŒ—mLogD©aStÜe
();

25 
fš®
 
Segm’t
 = 333;

26 
¡»amLogDs
.
	`upd©eTaSegm’t
(
Segm’t
);

27 
	`as£¹Equ®s
(
Segm’t
, 
¡»amLogDs
.
	`g‘TaSegm’t
());

29 
fš®
 
¡¬tšgAdd»ss
 = 555;

30 
¡»amLogDs
.
	`upd©eS¹šgAdd»ss
(
¡¬tšgAdd»ss
);

31 
	`as£¹Equ®s
(
¡¬tšgAdd»ss
, 
¡»amLogDs
.
	`g‘S¹šgAdd»ss
());

34 @
Te¡


35 
public
 
	$‹¡Re£t
() {

36 
SŒ—mLogD©aStÜe
 
¡»amLogDs
 = 
	`g‘SŒ—mLogD©aStÜe
();

37 
¡»amLogDs
.
	`»£tS¹šgAdd»ss
();

38 
	`as£¹Equ®s
(
INITIAL_ADDRESS
, 
¡»amLogDs
.
	`g‘S¹šgAdd»ss
());

40 
¡»amLogDs
.
	`»£tTaSegm’t
();

41 
	`as£¹Equ®s
(
INITIAL_ADDRESS
, 
¡»amLogDs
.
	`g‘TaSegm’t
());

42 
	}
}

44 
´iv©e
 
SŒ—mLogD©aStÜe
 
	$g‘SŒ—mLogD©aStÜe
() {

45 
M­
<
SŒšg
, 
Objeù
> 
İts
 = 
Ãw
 
HashM­
<>();

46 
İts
.
	`put
("--log-·th", 
‹mpDœ
.
	`g‘RoÙ
().
	`g‘AbsŞu‹P©h
());

48 
D©aStÜe
 
ds
 = 
Ãw
 
	`D©aStÜe
(
İts
, 
v®
 -> 
log
.
	`šfo
("clean up"));

50  
SŒ—mLogD©aStÜe
.
	`bud”
()

51 .
	`d©aStÜe
(
ds
)

52 .
	`bud
();

53 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/DataTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gOrd”šg
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

7 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

10 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

12 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoR‘uº
;

13 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

15 
public
 cÏs 
	cD©aTe¡
 {

16 
public
 
LogD©a
 
	$ü—‹StubRecÜd
(
add»ss
) {

17 
LogD©a
 
d©a
 = 
	`mock
(LogD©a.
şass
);

18 
	`doR‘uº
(
add»ss
).
	`wh’
(
d©a
).
	`g‘Glob®Add»ss
();

19  
d©a
;

22 
public
 
Li¡
<
LogD©a
> 
	`ü—‹StubLi¡
(Li¡<
LÚg
> 
add»s£s
) {

23  
add»s£s
.
	`¡»am
().
	`m­
(
this
::
ü—‹StubRecÜd
).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

24 
	}
}

26 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
ü—‹StubM­
(
Li¡
<
LogD©a
> 
d©a
) {

27  
	gd©a
.
¡»am
().
m­
(
»c
 -> 
Ãw
 
Ab¡¿ùM­
.
Sim¶eEÁry
<>Ôec.
g‘Glob®Add»ss
(), (
ILogD©a
)„ec))

28 .
cŞËù
(
CŞËùÜs
.
toM­
(
Ab¡¿ùM­
.
Sim¶eEÁry
::
g‘Key
, Ab¡¿ùM­.Sim¶eEÁry::
g‘V®ue
));

31 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
ü—‹StubM­FromLÚgs
(
Li¡
<
LÚg
> 
d©a
){

32  
	gd©a
.
¡»am
().
m­
(
add
 -> 
Ãw
 
Ab¡¿ùM­
.
Sim¶eEÁry
<>×dd, 
ü—‹StubRecÜd
(add)))

33 .
cŞËù
(
CŞËùÜs
.
toM­
(
Ab¡¿ùM­
.
Sim¶eEÁry
::
g‘Key
, Ab¡¿ùM­.Sim¶eEÁry::
g‘V®ue
));

36 
public
 
	gLi¡
<
	gLogD©a
> 
g‘RecÜdsFromStubM­
(
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
) {

37  
	gOrd”šg
.
Çtu¿l
().
sÜ‹dCİy
(
¡ubM­
.
v®ues
().
¡»am
().
m­
(
x
 -> (
LogD©a
èx).
cŞËù
(
CŞËùÜs
.
toLi¡
()));

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/FaultyBatchProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	gS‹T¿nsãrB©chProûssÜ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

9 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

10 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
.
	gT¿nsãrStus
.
	gFAILED
;

22 @
G‘‹r


23 
public
 cÏs 
	cFauÉyB©chProûssÜ
 
im¶em’ts
 
	mS‹T¿nsãrB©chProûssÜ
 {

25 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	mtÙ®Proûs£d
 = 
Ãw
 AtomicInteger(0);

26 
´iv©e
 
fš®
 
	mO±iÚ®
<
	mLÚg
> 
	md–ay
;

27 
´iv©e
 
fš®
 
	mb©chFau»Ord”
;

28 
´iv©e
 
fš®
 
Rªdom
 
	m¿ndom
 = 
Ãw
 Random();

29 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	mec
 = 
ExecutÜs
.
ÃwScheduËdTh»adPoŞ
(1);

31 
public
 
FauÉyB©chProûssÜ
(
b©chFau»Ord”
, 
O±iÚ®
<
LÚg
> 
d–ay
) {

32 
	mthis
.
	mb©chFau»Ord”
 = 
b©chFau»Ord”
;

33 
	mthis
.
	md–ay
 = 
d–ay
;

36 
public
 
	$FauÉyB©chProûssÜ
(
b©chFau»Ord”
) {

37 
this
.
b©chFau»Ord”
 = batchFailureOrder;

38 
this
.
d–ay
 = 
O±iÚ®
.
	`em±y
();

39 
	}
}

42 @
Ov”ride


43 
public
 
	gCom¶‘abËFutu»
<
	gT¿nsãrB©chRe¥Ú£
> 
	$Œªsãr
(
T¿nsãrB©chReque¡
 
ŒªsãrB©chReque¡
) {

44 
Com¶‘abËFutu»
<
T¿nsãrB©chRe¥Ú£
> 
exec
;

45 ià(
tÙ®Proûs£d
.
	`g‘AndInüem’t
(è% 
b©chFau»Ord”
 == 0) {

46 
exec
 = 
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
T¿nsãrB©chRe¥Ú£
.
	`bud”
().
	`¡©us
(
FAILED
).
	`bud
());

48 
exec
 = 
Com¶‘abËFutu»


49 .
	`com¶‘edFutu»
(
T¿nsãrB©chRe¥Ú£


50 .
	`bud”
()

51 .
	`ŒªsãrB©chReque¡
(
ŒªsãrB©chReque¡
)

52 .
	`bud
()

55  
CFUts
.
	`runFutu»Aá”
((è-> 
exec
, 
ec
, 
d–ay
.
	`m­
(
d
 -> ()

56 (
¿ndom
.
	`ÃxtFlßt
(è* 
d
)).
	`ÜEl£
(0L), 
TimeUn™
.
MILLISECONDS
);

57 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/StateTransferManagerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gLi¡s
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’t
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	gS‹T¿nsãrB©chProûssÜ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gKnownAdd»ssRe¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
.
	gSim¶eEÁry
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

21 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gFAILED
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gNOT_TRANSFERRED
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gRESTORED
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gTRANSFERRED
;

26 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoR‘uº
;

27 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

28 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	g¥y
;

30 şas 
	cS‹T¿nsãrMªag”Te¡
 
im¶em’ts
 
	mT¿nsãrSegm’tC»©Ü
 {

32 @
Te¡


33 
public
 
	$g‘UnknownAdd»s£sInRªge
() {

34 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

35 
S‘
<
LÚg
> 
»tV®
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 80L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toS‘
());

37 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Ãw
 
	`KnownAdd»ssRe¥Ú£
(
»tV®
)))

38 .
	`wh’
(
logUn™Cl›Á
)

39 .
	`»que¡KnownAdd»s£s
(0L, 100L);

41 
S‹T¿nsãrMªag”
 
¡©eT¿nsãrMªag”
 =

42 
S‹T¿nsãrMªag”
.
	`bud”
()

43 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

44 .
	`b©chSize
(10)

45 .
	`b©chProûssÜ
(
Ãw
 
	`SucûssfulB©chProûssÜ
())

46 .
	`bud
();

48 
ImmubËLi¡
<
LÚg
> 
unknownAdd»s£sInRªge
 = 
¡©eT¿nsãrMªag”


49 .
	`g‘UnknownAdd»s£sInRªge
(0L, 100L);

51 
ImmubËLi¡
<
LÚg
> 
ex³ùed
 =

52 
ImmubËLi¡
.
	`cİyOf
(
LÚgSŒ—m
.
	`¿nge
(80L, 101L)

53 .
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()));

55 
	`as£¹Th©
(
unknownAdd»s£sInRªge
).
	`isEqu®To
(
ex³ùed
);

60 @
Te¡


61 
public
 
	$hªdËT¿nsãr
() {

63 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

64 
S‹T¿nsãrMªag”
 
mªag”
 = S‹T¿nsãrMªag”.
	`bud”
()

65 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

66 .
	`b©chSize
(10)

67 .
	`b©chProûssÜ
(
Ãw
 
	`SucûssfulB©chProûssÜ
())

68 .
	`bud
();

69 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
£gm’ts
 =

70 
ImmubËLi¡
.
	`of
(

71 
	`ü—‹T¿nsãrSegm’t
(0L, 50L, 
TRANSFERRED
),

72 
	`ü—‹T¿nsãrSegm’t
(51L, 99L, 
FAILED
),

73 
	`ü—‹T¿nsãrSegm’t
(100L, 199L, 
RESTORED
)

76 
Li¡
<
T¿nsãrSegm’tStus
> 
¡©u£sEx³ùed
 =

77 
£gm’ts
.
	`¡»am
().
	`m­
(
£gm’t
 -> segm’t.
	`g‘Stus
()).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

79 
Li¡
<
LÚg
> 
tÙ®T¿nsã¼edEx³ùed
 = 
£gm’ts
.
	`¡»am
()

80 .
	`m­
(
£gm’t
 -> segm’t.
	`g‘Stus
().
	`g‘TÙ®T¿nsã¼ed
())

81 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

83 
Li¡
<
Sim¶eEÁry
<
LÚg
, LÚg>> 
¿ngesEx³ùed
 =

84 
£gm’ts
.
	`¡»am
().
	`m­
(
£gm’t
 -> 
Ãw
 
Sim¶eEÁry
<>(£gm’t.
	`g‘S¹Add»ss
(),

85 
£gm’t
.
	`g‘EndAdd»ss
())).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

87 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
ŒªsãrSegm’ts
 =

88 
mªag”
.
	`hªdËT¿nsãr
(
£gm’ts
);

90 
Li¡
<
T¿nsãrSegm’tStus
> 
¡©u£s
 =

91 
ŒªsãrSegm’ts
.
	`¡»am
()

92 .
	`m­
(
T¿nsãrSegm’t
::
g‘Stus
)

93 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

95 
Li¡
<
LÚg
> 
tÙ®T¿nsã¼ed
 =

96 
ŒªsãrSegm’ts
.
	`¡»am
()

97 .
	`m­
(
£gm’t
 -> segm’t.
	`g‘Stus
()

98 .
	`g‘TÙ®T¿nsã¼ed
()).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

100 
Li¡
<
Sim¶eEÁry
<
LÚg
, LÚg>> 
¿nges
 =

101 
ŒªsãrSegm’ts
.
	`¡»am
().
	`m­
(
£gm’t
 -> 
Ãw
 
Sim¶eEÁry
<>(£gm’t.
	`g‘S¹Add»ss
(),

102 
£gm’t
.
	`g‘EndAdd»ss
())).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

104 
	`as£¹Th©
(
¡©u£s
).
	`isEqu®To
(
¡©u£sEx³ùed
);

105 
	`as£¹Th©
(
tÙ®T¿nsã¼ed
).
	`isEqu®To
(
tÙ®T¿nsã¼edEx³ùed
);

106 
	`as£¹Th©
(
¿nges
).
	`isEqu®To
(
¿ngesEx³ùed
);

107 
S‹T¿nsãrMªag”
 
¥y
 = 
	`¥y
(
mªag”
);

110 
T¿nsãrSegm’t
 
ŒªsãrSegm’t
 =

111 
	`ü—‹T¿nsãrSegm’t
(0L, 50L, 
NOT_TRANSFERRED
);

113 
	`doR‘uº
(
ImmubËLi¡
.
	`of
()).
	`wh’
(
¥y
).
	`g‘UnknownAdd»s£sInRªge
(0L, 50L);

114 
ŒªsãrSegm’ts
 =

115 
¥y
.
	`hªdËT¿nsãr
(
ImmubËLi¡
.
	`of
(
ŒªsãrSegm’t
));

117 
	`as£¹Th©
(
ŒªsãrSegm’ts
.
	`g‘
(0).
	`g‘Stus
().
	`g‘Segm’tS‹
())

118 .
	`isEqu®To
(
TRANSFERRED
);

119 
	`as£¹Th©
(
ŒªsãrSegm’ts
.
	`g‘
(0).
	`g‘Stus
().
	`g‘TÙ®T¿nsã¼ed
())

120 .
	`isEqu®To
(51L);

122 
ImmubËLi¡
<
LÚg
> 
unknownD©a
 =

123 
ImmubËLi¡
.
	`cİyOf
(
LÚgSŒ—m
.
	`¿nge
(25L, 51L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()));

125 
mªag”
 = 
S‹T¿nsãrMªag”
.
	`bud”
()

126 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

127 .
	`b©chSize
(10)

128 .
	`b©chProûssÜ
(
Ãw
 
	`FauÉyB©chProûssÜ
(10))

129 .
	`bud
();

131 
¥y
 = 
	`¥y
(
mªag”
);

133 
	`doR‘uº
(
unknownD©a
).
	`wh’
(
¥y
).
	`g‘UnknownAdd»s£sInRªge
(0L, 50L);

135 
ŒªsãrSegm’ts
 =

136 
¥y
.
	`hªdËT¿nsãr
(
ImmubËLi¡
.
	`of
(
ŒªsãrSegm’t
));

138 
	`as£¹Th©
(
ŒªsãrSegm’ts
.
	`g‘
(0).
	`g‘Stus
().
	`g‘Segm’tS‹
())

139 .
	`isEqu®To
(
FAILED
);

140 
	}
}

142 @
Te¡


143 
public
 
	$synchrÚousS‹T¿nsãrTe¡
() {

144 
S‹T¿nsãrB©chProûssÜ
 
b©chProûssÜ
 = 
Ãw
 
	`SucûssfulB©chProûssÜ
();

145 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

146 
b©chSize
 = 10;

147 
S‹T¿nsãrMªag”
 
mªag”
 = 
Ãw
 
	`S‹T¿nsãrMªag”
(
logUn™Cl›Á
, 
b©chSize
, 
b©chProûssÜ
);

148 
SŒ—m
<
T¿nsãrB©chReque¡
> 
¡»am
 = 
Li¡s


149 .
	`·¹™iÚ
(
LÚgSŒ—m
.
	`¿nge
(0, 100).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()), 
b©chSize
)

150 .
	`¡»am
()

151 .
	`m­
(
·¹™iÚ
 -> 
T¿nsãrB©chReque¡
.
	`bud”
().
	`add»s£s
Õ¬t™iÚ).
	`bud
());

153 
T¿nsãrSegm’tStus
 
¡©us
 = 
mªag”
.
	`synchrÚousS‹T¿nsãr
(
¡»am
, 100);

154 
	`as£¹Th©
(
¡©us
.
	`g‘Segm’tS‹
()).
	`isEqu®To
(
TRANSFERRED
);

155 
	`as£¹Th©
(
¡©us
.
	`g‘TÙ®T¿nsã¼ed
()).
	`isEqu®To
(100L);

157 
¡»am
 = 
Li¡s


158 .
	`·¹™iÚ
(
LÚgSŒ—m
.
	`¿nge
(0, 80).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()), 
b©chSize
)

159 .
	`¡»am
()

160 .
	`m­
(
·¹™iÚ
 -> 
T¿nsãrB©chReque¡
.
	`bud”
().
	`add»s£s
Õ¬t™iÚ).
	`bud
());

161 
¡©us
 = 
mªag”
.
	`synchrÚousS‹T¿nsãr
(
¡»am
, 100);

162 
	`as£¹Th©
(
¡©us
.
	`g‘Segm’tS‹
()).
	`isEqu®To
(
FAILED
);

163 
	`as£¹Th©
(
¡©us
.
	`g‘TÙ®T¿nsã¼ed
()).
	`isEqu®To
(0L);

164 
¡»am
 = 
Li¡s


165 .
	`·¹™iÚ
(
LÚgSŒ—m
.
	`¿nge
(0, 80).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()), 
b©chSize
)

166 .
	`¡»am
()

167 .
	`m­
(
·¹™iÚ
 -> 
T¿nsãrB©chReque¡
.
	`bud”
().
	`add»s£s
Õ¬t™iÚ).
	`bud
());

168 
b©chProûssÜ
 = 
Ãw
 
	`FauÉyB©chProûssÜ
(10);

169 
mªag”
 = 
Ãw
 
	`S‹T¿nsãrMªag”
(
logUn™Cl›Á
, 
b©chSize
, 
b©chProûssÜ
);

170 
¡©us
 = 
mªag”
.
	`synchrÚousS‹T¿nsãr
(
¡»am
, 80);

171 
	`as£¹Th©
(
¡©us
.
	`g‘Segm’tS‹
()).
	`isEqu®To
(
FAILED
);

172 
	`as£¹Th©
(
¡©us
.
	`g‘TÙ®T¿nsã¼ed
()).
	`isEqu®To
(0L);

173 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/SuccessfulBatchProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	gS‹T¿nsãrB©chProûssÜ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

8 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

9 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

18 
public
 cÏs 
	cSucûssfulB©chProûssÜ
 
im¶em’ts
 
	mS‹T¿nsãrB©chProûssÜ
 {

19 
´iv©e
 
fš®
 
Rªdom
 
	m¿ndom
 = 
Ãw
 Random();

20 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	mec
 = 
ExecutÜs
.
ÃwScheduËdTh»adPoŞ
(1);

22 
public
 
fš®
 
	mO±iÚ®
<
	mLÚg
> 
	md–ay
;

24 
public
 
SucûssfulB©chProûssÜ
(
O±iÚ®
<
LÚg
> 
d–ay
) {

25 
	mthis
.
	md–ay
 = 
d–ay
;

28 
public
 
	$SucûssfulB©chProûssÜ
() {

29 
this
.
d–ay
 = 
O±iÚ®
.
	`em±y
();

30 
	}
}

32 @
Ov”ride


33 
public
 
	gCom¶‘abËFutu»
<
	gT¿nsãrB©chRe¥Ú£
> 
	$Œªsãr
(
T¿nsãrB©chReque¡
 
ŒªsãrB©chReque¡
) {

34 
Com¶‘abËFutu»
<
T¿nsãrB©chRe¥Ú£
> 
exec
 = CompletableFuture

35 .
	`com¶‘edFutu»
(
T¿nsãrB©chRe¥Ú£


36 .
	`bud”
()

37 .
	`ŒªsãrB©chReque¡
(
ŒªsãrB©chReque¡
)

38 .
	`bud
()

40  
CFUts
.
	`runFutu»Aá”
((è-> 
exec
, 
ec
, 
d–ay
.
	`m­
(
d
 -> ()

41 (
¿ndom
.
	`ÃxtFlßt
(è* 
d
)).
	`ÜEl£
(0L), 
TimeUn™
.
MILLISECONDS
);

42 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/TransferSegmentCreator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’t
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gT¿nsãrSegm’tExû±iÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gNOT_TRANSFERRED
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gRESTORED
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gTRANSFERRED
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gbud”
;

19 
public
 
š‹rçû
 
	gT¿nsãrSegm’tC»©Ü
 {

21  
T¿nsãrSegm’t
 
ü—‹T¿nsãrSegm’t
(
¡¬t
,

22 
’d
,

23 
Segm’tS‹
 
¡©e
) {

26 ià(
	g¡©e
 =ğ
RESTORED
 || 
¡©e
 =ğ
TRANSFERRED
) {

27  
T¿nsãrSegm’t


28 .
bud”
()

29 .
¡©us
(

30 
bud”
()

31 .
tÙ®T¿nsã¼ed
(
’d
 - 
¡¬t
 + 1)

32 .
£gm’tS‹
(
¡©e
)

33 .
bud
()

35 .
¡¬tAdd»ss
(
¡¬t
)

36 .
’dAdd»ss
(
’d
)

37 .
bud
();

40 if(
	g¡©e
 =ğ
NOT_TRANSFERRED
){

41  
T¿nsãrSegm’t


42 .
bud”
()

43 .
¡©us
(

44 
bud”
()

45 .
tÙ®T¿nsã¼ed
(0L)

46 .
£gm’tS‹
(
¡©e
)

47 .
bud
()

49 .
¡¬tAdd»ss
(
¡¬t
)

50 .
’dAdd»ss
(
’d
)

51 .
bud
();

55  
	gT¿nsãrSegm’t


56 .
bud”
()

57 .
¡©us
(
bud”
()

58 .
tÙ®T¿nsã¼ed
(0L)

59 .
£gm’tS‹
(
¡©e
)

60 .
ÿu£OfFau»
(
O±iÚ®
.
of
(
Ãw
 
T¿nsãrSegm’tExû±iÚ
()))

61 .
bud
()

63 .
¡¬tAdd»ss
(
¡¬t
)

64 .
’dAdd»ss
(
’d
)

65 .
bud
();

70  
T¿nsãrSegm’tStus
 
ü—‹Stus
(

71 
Segm’tS‹
 
¡©e
, 
tÙ®
, 
O±iÚ®
<
T¿nsãrSegm’tExû±iÚ
> 
ç
) {

72  
bud”
().
tÙ®T¿nsã¼ed
(
tÙ®
).
£gm’tS‹
(
¡©e
).
ÿu£OfFau»
(
ç
).
bud
();

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/StateTransferBatchProcessorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gD©aTe¡
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gR—dB©ch
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	g´ÙocŞb©ch´oûssÜ
.
	gPrÙocŞB©chProûssÜ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gKnownAdd»ssRe¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ssS·ûV›w
;

14 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gTe¡
;

16 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

20 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

21 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

23 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

24 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
.
	gT¿nsãrStus
.
	gSUCCEEDED
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
.
	gSAME_DATA
;

27 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoR‘uº
;

28 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoThrow
;

29 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

31 şas 
	cS‹T¿nsãrB©chProûssÜTe¡
 
ex‹nds
 
	mD©aTe¡
 {

33 @
Te¡


34 
public
 
	$wr™eRecÜdsSucûss
() {

36 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

37 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

38 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

39 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

40 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

42 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

43 .
	`bud”
()

44 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

45 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

46 .
	`bud
();

47 
T¿nsãrB©chRe¥Ú£
 
»s
 = 
b©chProûssÜ
.
	`wr™eRecÜds
(
R—dB©ch
.
	`bud”
().
	`d©a
(
¡ubLi¡
).
	`bud
(),

48 
logUn™Cl›Á
, 1, 
Du¿tiÚ
.
	`ofMlis
(500));

49 
	`as£¹Th©
(
»s
.
	`g‘Stus
(è=ğ
SUCCEEDED
).
	`isTrue
();

50 
	`as£¹Th©
(
»s
.
	`g‘T¿nsãrB©chReque¡
().
	`g‘Add»s£s
()).
	`isEqu®To
(
add»s£s
);

53 @
Te¡


54 
public
 
	$wr™eRecÜdsFau»
() {

56 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

57 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

58 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

59 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

60 
	`doThrow
(
Ãw
 
	`Ov”wr™eExû±iÚ
(
SAME_DATA
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

61 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Ãw
 
	`KnownAdd»ssRe¥Ú£
Òew 
HashS‘
<>())))

62 .
	`wh’
(
logUn™Cl›Á
)

63 .
	`»que¡KnownAdd»s£s
(0L, 9L);

64 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

65 .
	`bud”
()

66 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

67 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

68 .
	`bud
();

69 
	`as£¹Th©ThrownBy
((è-> 
b©chProûssÜ
.
	`wr™eRecÜds
(
R—dB©ch
.
	`bud”
().
	`d©a
(
¡ubLi¡
).
	`bud
(),

70 
logUn™Cl›Á
, 1, 
Du¿tiÚ
.
	`ofMlis
(100)))

71 .
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
)

72 .
	`hasRoÙCau£In¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

74 
	}
}

76 @
Te¡


77 
public
 
	$wr™eRecÜdsR‘ry
() {

82 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

83 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

84 
Li¡
<
LogD©a
> 
knownStubLi¡
 = 
¡ubLi¡
.
	`¡»am
()

85 .
	`f‹r
(
d
 -> d.
	`g‘Glob®Add»ss
(è% 2 !ğ0).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

86 
Li¡
<
LÚg
> 
known
 = 
add»s£s
.
	`¡»am
().
	`f‹r
(
a
 ->‡ % 2 =ğ0).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

87 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

88 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

89 
Com¶‘abËFutu»
<
BoŞ—n
> 
çedFutu»
 = 
Ãw
 CompletableFuture<>();

90 
çedFutu»
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`Ov”wr™eExû±iÚ
(
SAME_DATA
));

92 
	`doR‘uº
(
çedFutu»
).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

94 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
)

95 .
	`wr™eRªge
(
knownStubLi¡
);

97 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Ãw
 
	`KnownAdd»ssRe¥Ú£
Òew 
HashS‘
<>(
known
))))

98 .
	`wh’
(
logUn™Cl›Á
)

99 .
	`»que¡KnownAdd»s£s
(0L, 9L);

101 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

102 .
	`bud”
()

103 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

104 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

105 .
	`bud
();

107 
T¿nsãrB©chRe¥Ú£
 
»¥
 =

108 
b©chProûssÜ
.
	`wr™eRecÜds
(
R—dB©ch
.
	`bud”
().
	`d©a
(
¡ubLi¡
).
	`bud
(),

109 
logUn™Cl›Á
, 2, 
Du¿tiÚ
.
	`ofMlis
(100));

111 
	`as£¹Th©
(
»¥
.
	`g‘Stus
()).
	`isEqu®To
(
SUCCEEDED
);

112 
	`as£¹Th©
(
»¥
.
	`g‘T¿nsãrB©chReque¡
().
	`g‘Add»s£s
()).
	`isEqu®To
(
add»s£s
);

113 
	}
}

115 @
Te¡


116 
public
 
	$wr™eRecÜdsR‘ryEm±y
() {

119 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

120 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

121 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

122 
Com¶‘abËFutu»
<
BoŞ—n
> 
çedFutu»
 = 
Ãw
 CompletableFuture<>();

123 
çedFutu»
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Illegal state"));

125 
	`doR‘uº
(
çedFutu»
).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

126 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
ImmubËLi¡
.
	`of
());

127 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Ãw
 
	`KnownAdd»ssRe¥Ú£
Òew 
HashS‘
<>(
add»s£s
))))

128 .
	`wh’
(
logUn™Cl›Á
)

129 .
	`»que¡KnownAdd»s£s
(0L, 9L);

131 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

132 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

133 .
	`bud”
()

134 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

135 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

136 .
	`bud
();

137 
T¿nsãrB©chRe¥Ú£
 
»¥
 =

138 
b©chProûssÜ
.
	`wr™eRecÜds
(
R—dB©ch
.
	`bud”
().
	`d©a
(
¡ubLi¡
).
	`bud
(),

139 
logUn™Cl›Á
, 2, 
Du¿tiÚ
.
	`ofMlis
(100));

140 
	`as£¹Th©
(
»¥
.
	`g‘Stus
()).
	`isEqu®To
(
SUCCEEDED
);

141 
	`as£¹Th©
(
»¥
.
	`g‘T¿nsãrB©chReque¡
().
	`g‘Add»s£s
()).
	`isEqu®To
(
add»s£s
);

143 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/protocolbatchprocessor/ProtocolBatchProcessorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch´oûssÜ
.
	g´ÙocŞb©ch´oûssÜ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gD©aTe¡
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gR—dB©ch
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chReque¡
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gT¿nsãrB©chRe¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gR—dB©chExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gexû±iÚs
.
	gS‹T¿nsãrB©chProûssÜExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ssS·ûV›w
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gR—dO±iÚs
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gTe¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘iÚExû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

23 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

25 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

26 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gb©ch
.
	gR—dB©ch
.
	gR—dStus
.
	gFAILED
;

28 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoAnsw”
;

29 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoR‘uº
;

30 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoThrow
;

31 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

32 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	g¥y
;

34 şas 
	cPrÙocŞB©chProûssÜTe¡
 
ex‹nds
 
	mD©aTe¡
 {

36 @
Te¡


37 
public
 
	$ŒªsãrFuÎ
() {

38 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

39 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

40 
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
 = 
	`ü—‹StubM­
(
¡ubLi¡
);

41 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

42 .
	`wa™FÜHŞe
(
Œue
)

43 .
	`ş›ÁCach—bË
(
çl£
)

44 .
	`£rv”Cach—bË
(
çl£
)

45 .
	`bud
();

46 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

47 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

48 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

49 
	`doR‘uº
(
¡ubM­
).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
add»s£s
, 
»adO±iÚs
);

51 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

52 .
	`bud”
()

53 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

54 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

55 .
	`bud
();

56 
Com¶‘abËFutu»
<
T¿nsãrB©chRe¥Ú£
> 
f
 =

57 
b©chProûssÜ
.
	`Œªsãr
(
Ãw
 
	`T¿nsãrB©chReque¡
(
add»s£s
, 
O±iÚ®
.
	`em±y
()));

58 
T¿nsãrB©chRe¥Ú£
 
još
 = 
f
.
	`još
();

59 
	`as£¹Th©
(
još
.
	`g‘Stus
(è=ğ
T¿nsãrB©chRe¥Ú£
.
T¿nsãrStus
.
SUCCEEDED
).
	`isTrue
();

60 
	`as£¹Th©
(
još
.
	`g‘T¿nsãrB©chReque¡
().
	`g‘Add»s£s
()).
	`isEqu®To
(
add»s£s
);

63 @
Te¡


64 
public
 
	$ŒªsãrFa
() {

65 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

66 
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
 = 
	`ü—‹StubM­FromLÚgs
(
add»s£s
);

67 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

68 .
	`wa™FÜHŞe
(
Œue
)

69 .
	`ş›ÁCach—bË
(
çl£
)

70 .
	`£rv”Cach—bË
(
çl£
)

71 .
	`bud
();

72 
Li¡
<
LogD©a
> 
»cÜdsFromStubM­
 = 
	`g‘RecÜdsFromStubM­
(
¡ubM­
);

73 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

74 
	`doThrow
(
Ãw
 
	`IÎeg®S‹Exû±iÚ
()).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
»cÜdsFromStubM­
);

75 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

76 
	`doR‘uº
(
¡ubM­
).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
add»s£s
, 
»adO±iÚs
);

77 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

78 .
	`bud”
()

79 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

80 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

81 .
	`bud
();

82 
Com¶‘abËFutu»
<
T¿nsãrB©chRe¥Ú£
> 
f
 =

83 
b©chProûssÜ
.
	`Œªsãr
(
Ãw
 
	`T¿nsãrB©chReque¡
(
add»s£s
, 
O±iÚ®
.
	`em±y
()));

84 
T¿nsãrB©chRe¥Ú£
 
još
 = 
f
.
	`još
();

86 
	`as£¹Th©
(
još
.
	`g‘Stus
(è=ğ
T¿nsãrB©chRe¥Ú£
.
T¿nsãrStus
.
FAILED
).
	`isTrue
();

87 
	}
}

89 @
Te¡


90 
public
 
	$‹¡R—dRecÜdsSucûss
() {

91 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

92 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

93 
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
 = 
	`ü—‹StubM­
(
¡ubLi¡
);

94 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

95 .
	`wa™FÜHŞe
(
Œue
)

96 .
	`ş›ÁCach—bË
(
çl£
)

97 .
	`£rv”Cach—bË
(
çl£
)

98 .
	`bud
();

99 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

100 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

101 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

102 
	`doR‘uº
(
¡ubM­
).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
add»s£s
, 
»adO±iÚs
);

103 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

104 .
	`bud”
()

105 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

106 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

107 .
	`bud
();

108 
Com¶‘abËFutu»
<
R—dB©ch
> 
f
 =

109 
b©chProûssÜ
.
	`»adRecÜds
(
Ãw
 
	`T¿nsãrB©chReque¡
(
add»s£s
, 
O±iÚ®
.
	`em±y
()));

110 
R—dB©ch
 
još
 = 
f
.
	`još
();

111 
Li¡
<
LogD©a
> 
ex³ùed
 = 
	`g‘RecÜdsFromStubM­
(
¡ubM­
);

112 
	`as£¹Th©
(
još
.
	`g‘Stus
(è=ğ
R—dB©ch
.
R—dStus
.
SUCCEEDED
).
	`isTrue
();

113 
	`as£¹Th©
(
još
.
	`g‘D©a
()).
	`isEqu®To
(
ex³ùed
);

114 
	}
}

119 @
Te¡


120 
public
 
	$hªdËWrÚgEpochExû±iÚ
() {

121 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

123 
Li¡
<
LogD©a
> 
£cÚdR—dLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

125 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

126 .
	`wa™FÜHŞe
(
Œue
)

127 .
	`ş›ÁCach—bË
(
çl£
)

128 .
	`£rv”Cach—bË
(
çl£
)

129 .
	`bud
();

130 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

132 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
£cÚdR—dLi¡
);

134 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

136 
	`doAnsw”
(
ªsw”
 -> {

137 
throw
 
Ãw
 
	`WrÚgEpochExû±iÚ
(0L);

138 }).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
add»s£s
, 
»adO±iÚs
);

140 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

141 .
	`bud”
()

142 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

143 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

144 .
	`bud
();

145 
PrÙocŞB©chProûssÜ
 
¥y
 = 
	`¥y
(
b©chProûssÜ
);

147 
Com¶‘abËFutu»
<
R—dB©ch
> 
»s
 =

148 
¥y
.
	`»adRecÜds
(
T¿nsãrB©chReque¡
.
	`bud”
().
	`add»s£s
(
add»s£s
).
	`bud
());

150 
	`as£¹Th©ThrownBy
(
»s
::
još
)

151 .
	`isIn¡ªûOf
(
Com¶‘iÚExû±iÚ
.
şass
)

152 .
	`hasRoÙCau£In¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

153 
	}
}

155 @
Te¡


156 
public
 
	$checkR—dRecÜdsCom¶‘e
() {

157 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

158 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

159 
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
 = 
	`ü—‹StubM­
(
¡ubLi¡
);

160 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

161 .
	`wa™FÜHŞe
(
Œue
)

162 .
	`ş›ÁCach—bË
(
çl£
)

163 .
	`£rv”Cach—bË
(
çl£
)

164 .
	`bud
();

165 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

166 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

167 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

168 
	`doR‘uº
(
¡ubM­
).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
add»s£s
, 
»adO±iÚs
);

169 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

170 .
	`bud”
()

171 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

172 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

173 .
	`bud
();

174 
R—dB©ch
 
»s
 = 
b©chProûssÜ
.
	`checkR—dRecÜds
(
add»s£s
, 
¡ubM­
, 
O±iÚ®
.
	`em±y
());

175 
Li¡
<
LogD©a
> 
ex³ùed
 = 
	`g‘RecÜdsFromStubM­
(
¡ubM­
);

176 
	`as£¹Th©
(
»s
.
	`g‘Stus
(è=ğ
R—dB©ch
.
R—dStus
.
SUCCEEDED
).
	`isTrue
();

177 
	`as£¹Th©
(
»s
.
	`g‘D©a
()).
	`isEqu®To
(
ex³ùed
);

178 
	}
}

180 @
Te¡


181 
public
 
	$checkR—dRecÜdsInCom¶‘e
() {

182 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

183 
Li¡
<
LÚg
> 
»adAdd»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`f‹r
(
x
 -> x % 2 =ğ0).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

184 
Li¡
<
LÚg
> 
uÄ—dAdd»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`f‹r
(
x
 -> x % 2 !ğ0).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

185 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
»adAdd»s£s
);

186 
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
 = 
	`ü—‹StubM­
(
¡ubLi¡
);

187 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

188 .
	`wa™FÜHŞe
(
Œue
)

189 .
	`ş›ÁCach—bË
(
çl£
)

190 .
	`£rv”Cach—bË
(
çl£
)

191 .
	`bud
();

192 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

193 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

194 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

195 
	`doR‘uº
(
¡ubM­
).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
»adAdd»s£s
, 
»adO±iÚs
);

196 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

197 .
	`bud”
()

198 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

199 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

200 .
	`bud
();

201 
R—dB©ch
 
»s
 = 
b©chProûssÜ
.
	`checkR—dRecÜds
(
add»s£s
, 
¡ubM­
, 
O±iÚ®
.
	`em±y
());

202 
	`as£¹Th©
(
»s
.
	`g‘Stus
(è=ğ
FAILED
).
	`isTrue
();

203 
	`as£¹Th©
(
»s
.
	`g‘FaedAdd»s£s
()).
	`isEqu®To
(
uÄ—dAdd»s£s
);

204 
	}
}

206 @
Te¡


207 
public
 
	$checkTh©R—dExû±iÚIsPrİag©ed
() {

208 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 10L).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

209 
Li¡
<
LogD©a
> 
¡ubLi¡
 = 
	`ü—‹StubLi¡
(
add»s£s
);

210 
M­
<
LÚg
, 
ILogD©a
> 
¡ubM­
 = 
	`ü—‹StubM­
(
¡ubLi¡
);

211 
R—dO±iÚs
 
»adO±iÚs
 = R—dO±iÚs.
	`bud”
()

212 .
	`wa™FÜHŞe
(
Œue
)

213 .
	`ş›ÁCach—bË
(
çl£
)

214 .
	`£rv”Cach—bË
(
çl£
)

215 .
	`bud
();

217 
LogUn™Cl›Á
 
logUn™Cl›Á
 = 
	`mock
(LogUn™Cl›Á.
şass
);

218 
	`doR‘uº
(
Com¶‘abËFutu»
.
	`com¶‘edFutu»
(
Œue
)).
	`wh’
(
logUn™Cl›Á
).
	`wr™eRªge
(
¡ubLi¡
);

219 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
	`mock
(Add»ssS·ûV›w.
şass
);

220 
	`doThrow
(
Ãw
 
	`WrÚgEpochExû±iÚ
(0L)).
	`wh’
(
add»ssS·ûV›w
).
	`sim¶ePrÙocŞR—d
(
add»s£s
, 
»adO±iÚs
);

221 
PrÙocŞB©chProûssÜ
 
b©chProûssÜ
 = ProtocolBatchProcessor

222 .
	`bud”
()

223 .
	`logUn™Cl›Á
(
logUn™Cl›Á
)

224 .
	`add»ssS·ûV›w
(
add»ssS·ûV›w
)

225 .
	`bud
();

227 
T¿nsãrB©chRe¥Ú£
 
»¥Ú£
 =

228 
b©chProûssÜ
.
	`Œªsãr
(
Ãw
 
	`T¿nsãrB©chReque¡
(
add»s£s
, 
O±iÚ®
.
	`em±y
())).
	`još
();

230 
	`as£¹Th©
(
»¥Ú£
.
	`g‘Stus
()).
	`isEqu®To
(
T¿nsãrB©chRe¥Ú£
.
T¿nsãrStus
.
FAILED
);

231 
	`as£¹Th©ThrownBy
(() -> {

232 
throw
 
»¥Ú£
.
	`g‘Cau£OfFau»
().
	`g‘
();

233 }).
	`isIn¡ªûOf
(
S‹T¿nsãrB©chProûssÜExû±iÚ
.
şass
)

234 .
	`hasRoÙCau£In¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

236 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterGraphTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gçu»d‘eùÜ
.
	gClu¡”G¿ph
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gA
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gB
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gC
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gçu»d‘eùÜ
.
	gClu¡”G¿ph
.
	gClu¡”G¿phH–³r
.
	gşu¡”
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gFAILED
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gcÚÃùiv™y
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	guÇvaabË
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

28 
public
 cÏs 
	cClu¡”G¿phTe¡
 {

30 @
Te¡


31 
public
 
	$‹¡T¿nsfÜm©iÚ
() {

32 
NodeS‹
 
a
 = NodeS‹.
	`bud”
()

33 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
READY
)

34 .
	`cÚÃùiv™y
(cÚÃùiv™y(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, OK, 
C
, 
FAILED
)))

35 .
	`bud
();

37 
NodeS‹
 
b
 = NodeS‹.
	`bud”
()

38 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
READY
)

39 .
	`cÚÃùiv™y
(cÚÃùiv™y(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK, 
C
, 
FAILED
)))

40 .
	`bud
();

42 
NodeS‹
 
c
 = 
	`uÇvaabËNodeS‹
(
C
);

44 
ImmubËM­
<
SŒšg
, 
NodeS‹
> 
nodes
 = ImmubËM­.
	`of
(
A
, 
a
, 
B
, 
b
, 
C
, 
c
);

45 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`bud”
()

46 .
	`loÿlEndpošt
(
A
)

47 .
	`nodes
(
nodes
)

48 .
	`uÄe¥ÚsiveNodes
(
ImmubËLi¡
.
	`of
())

49 .
	`bud
();

51 
Clu¡”G¿ph
 
g¿ph
 = Clu¡”G¿ph.
	`toClu¡”G¿ph
(
şu¡”S‹
);

53 
	`as£¹Equ®s
(
g¿ph
.
	`size
(), 
nodes
.size());

56 @
Te¡


57 
public
 
	$‹¡ToSymm‘ricFÜTwoNodes
() {

58 
NodeCÚÃùiv™y
 
a
 = 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, 
FAILED
));

59 
NodeCÚÃùiv™y
 
b
 = 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK));

61 
Clu¡”G¿ph
 
g¿ph
 = 
	`şu¡”
(
A
, 
ImmubËLi¡
.
	`of
(), 
a
, 
b
);

62 
Clu¡”G¿ph
 
symm‘ric
 = 
g¿ph
.
	`toSymm‘ric
();

64 
	`as£¹Equ®s
(
FAILED
, 
g¿ph
.
	`g‘NodeCÚÃùiv™y
(
A
).
	`g‘CÚÃùiÚStus
(
B
));

65 
	`as£¹Equ®s
(
OK
, 
g¿ph
.
	`g‘NodeCÚÃùiv™y
(
B
).
	`g‘CÚÃùiÚStus
(
A
));

67 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
A
).
	`g‘CÚÃùiÚStus
(
B
));

68 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
B
).
	`g‘CÚÃùiÚStus
(
A
));

69 
	}
}

71 @
Te¡


72 
public
 
	$‹¡ToSymm‘ricFÜTh»eNodes
() {

73 
NodeCÚÃùiv™y
 
a
 = 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, 
FAILED
, 
C
, FAILED));

74 
NodeCÚÃùiv™y
 
b
 = 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK, 
C
, OK));

75 
NodeCÚÃùiv™y
 
c
 = 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK));

77 
Clu¡”G¿ph
 
symm‘ric
 = 
	`şu¡”
(
A
, 
ImmubËLi¡
.
	`of
(), 
a
, 
b
, 
c
).
	`toSymm‘ric
();

78 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
B
).
	`g‘CÚÃùiÚStus
(
A
));

79 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
C
).
	`g‘CÚÃùiÚStus
(
A
));

81 
symm‘ric
 = 
	`şu¡”
(
B
, 
ImmubËLi¡
.
	`of
(), 
a
, 
b
, 
c
).
	`toSymm‘ric
();

82 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
B
).
	`g‘CÚÃùiÚStus
(
A
));

83 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
C
).
	`g‘CÚÃùiÚStus
(
A
));

85 
symm‘ric
 = 
	`şu¡”
(
C
, 
ImmubËLi¡
.
	`of
(), 
a
, 
b
, 
c
).
	`toSymm‘ric
();

86 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
B
).
	`g‘CÚÃùiÚStus
(
A
));

87 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
C
).
	`g‘CÚÃùiÚStus
(
A
));

88 
	}
}

90 @
Te¡


91 
public
 
	$‹¡ToSymm‘ricFÜTh»eNodesW™hUÇvaabËNodeB
() {

92 
NodeCÚÃùiv™y
 
a
 = 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, 
FAILED
, 
C
, FAILED));

93 
NodeCÚÃùiv™y
 
b
 = 
	`uÇvaabË
(
B
);

94 
NodeCÚÃùiv™y
 
c
 = 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, OK, C, OK));

96 
Clu¡”G¿ph
 
g¿ph
 = 
	`şu¡”
(
A
, 
ImmubËLi¡
.
	`of
(), 
a
, 
b
, 
c
);

97 
Clu¡”G¿ph
 
symm‘ric
 = 
g¿ph
.
	`toSymm‘ric
();

99 
NodeCÚÃùiv™y
 
symm‘ricNodeA
 = 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
A
);

100 
	`as£¹Equ®s
(
OK
, 
symm‘ricNodeA
.
	`g‘CÚÃùiÚStus
(
A
));

101 
	`as£¹Equ®s
(
FAILED
, 
symm‘ricNodeA
.
	`g‘CÚÃùiÚStus
(
B
));

102 
	`as£¹Equ®s
(
FAILED
, 
symm‘ricNodeA
.
	`g‘CÚÃùiÚStus
(
C
));

104 
	`as£¹Th©ThrownBy
((è-> 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
B
).
	`g‘CÚÃùiÚStus
(
A
))

105 .
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

107 
	`as£¹Equ®s
(
FAILED
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
C
).
	`g‘CÚÃùiÚStus
(
A
));

108 
	`as£¹Equ®s
(
OK
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
C
).
	`g‘CÚÃùiÚStus
(
B
));

109 
	`as£¹Equ®s
(
OK
, 
symm‘ric
.
	`g‘NodeCÚÃùiv™y
(
C
).
	`g‘CÚÃùiÚStus
(C));

110 
	}
}

112 @
Te¡


113 
public
 
	$‹¡DecisiÚMak”
() {

114 
NodeCÚÃùiv™y
 
a
 = 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, OK, 
C
, OK));

115 
NodeCÚÃùiv™y
 
b
 = 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
FAILED
, B, 
OK
, 
C
, OK));

116 
NodeCÚÃùiv™y
 
c
 = 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK));

118 
Clu¡”G¿ph
 
g¿ph
 = 
	`şu¡”
(
A
, 
ImmubËLi¡
.
	`of
(), 
a
, 
b
, 
c
);

119 
O±iÚ®
<
NodeRªk
> 
decisiÚMak”
 = 
g¿ph
.
	`toSymm‘ric
().
	`g‘DecisiÚMak”
();

121 
	`as£¹True
(
decisiÚMak”
.
	`isP»£Á
());

122 
	`as£¹Equ®s
(
decisiÚMak”
.
	`g‘
(), 
Ãw
 
	`NodeRªk
(
A
, 2));

123 
	}
}

125 @
Te¡


126 
public
 
	$‹¡FaedNode
() {

127 
Clu¡”G¿ph
 
g¿ph
 = 
	`şu¡”
(

128 
A
,

129 
ImmubËLi¡
.
	`of
(),

130 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, OK, 
C
, OK)),

131 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
FAILED
, B, 
OK
, 
C
, OK)),

132 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK))

135 
O±iÚ®
<
NodeRªk
> 
çedNode
 = 
g¿ph
.
	`toSymm‘ric
().
	`fšdFaedNode
();

136 
	`as£¹True
(
çedNode
.
	`isP»£Á
());

137 
	`as£¹Equ®s
(
çedNode
.
	`g‘
(), 
Ãw
 
	`NodeRªk
(
B
, 1));

139 
g¿ph
 = 
	`şu¡”
(

140 
A
,

141 
ImmubËLi¡
.
	`of
(
B
),

142 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, OK, 
C
, OK)),

143 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK, 
C
, 
FAILED
)),

144 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK))

146 
çedNode
 = 
g¿ph
.
	`toSymm‘ric
().
	`fšdFaedNode
();

147 
	`as£¹F®£
(
çedNode
.
	`isP»£Á
());

149 
g¿ph
 = 
	`şu¡”
(

150 
A
,

151 
ImmubËLi¡
.
	`of
(),

152 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, OK, 
C
, OK)),

153 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK, 
C
, 
FAILED
)),

154 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK))

156 
çedNode
 = 
g¿ph
.
	`toSymm‘ric
().
	`fšdFaedNode
();

157 
	`as£¹True
(
çedNode
.
	`isP»£Á
());

158 
	`as£¹Equ®s
(
çedNode
.
	`g‘
(), 
Ãw
 
	`NodeRªk
(
C
, 2));

159 
	}
}

161 @
Te¡


162 
public
 
	$‹¡FšdFuÎyCÚÃùedRe¥ÚsiveNodes
() {

163 
Clu¡”G¿ph
 
g¿ph
 = 
	`şu¡”
(

164 
A
,

165 
ImmubËLi¡
.
	`of
(
B
),

166 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, 
FAILED
, 
C
, OK)),

167 
	`uÇvaabË
(
B
),

168 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK))

170 
g¿ph
 = g¿ph.
	`toSymm‘ric
();

172 
O±iÚ®
<
NodeRªk
> 
»¥ÚsiveNode
 = 
g¿ph
.
	`fšdFuÎyCÚÃùedNode
(
C
);

173 
	`as£¹True
(
»¥ÚsiveNode
.
	`isP»£Á
());

174 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
(
C
, 2), 
»¥ÚsiveNode
.
	`g‘
());

176 
g¿ph
 = 
	`şu¡”
(

177 
A
,

178 
ImmubËLi¡
.
	`of
(
C
),

179 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, 
FAILED
, 
C
, OK)),

180 
	`uÇvaabË
(
B
),

181 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK))

184 
»¥ÚsiveNode
 = 
g¿ph
.
	`toSymm‘ric
().
	`fšdFuÎyCÚÃùedNode
(
C
);

186 
	`as£¹True
(
»¥ÚsiveNode
.
	`isP»£Á
());

187 
	`as£¹Equ®s
(
C
, 
»¥ÚsiveNode
.
	`g‘
().
	`g‘Endpošt
());

188 
	`as£¹Equ®s
(2, 
»¥ÚsiveNode
.
	`g‘
().
	`g‘NumCÚÃùiÚs
());

190 
g¿ph
 = 
	`şu¡”
(

191 
A
,

192 
ImmubËLi¡
.
	`of
(
B
),

193 
	`cÚÃùiv™y
(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, 
FAILED
, 
C
, OK)),

194 
	`cÚÃùiv™y
(
B
, 
ImmubËM­
.
	`of
(
A
, 
FAILED
, B, 
OK
, 
C
, FAILED)),

195 
	`cÚÃùiv™y
(
C
, 
ImmubËM­
.
	`of
(
A
, 
OK
, 
B
, 
FAILED
, C, OK))

197 
g¿ph
 = g¿ph.
	`toSymm‘ric
();

199 
»¥ÚsiveNode
 = 
g¿ph
.
	`fšdFuÎyCÚÃùedNode
(
C
);

201 
	`as£¹True
(
»¥ÚsiveNode
.
	`isP»£Á
());

202 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
(
C
, 2), 
»¥ÚsiveNode
.
	`g‘
());

203 
	}
}

205 
´iv©e
 
NodeS‹
 
	$uÇvaabËNodeS‹
(
SŒšg
 
’dpošt
) {

206  
Ãw
 
	`NodeS‹
(

207 
	`uÇvaabË
(
’dpošt
),

208 
Sequ’ûrM‘rics
.
UNKNOWN


210 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterStateAggregatorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gnodeS‹
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gFAILED
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

16 
public
 cÏs 
	cClu¡”S‹Agg»g©ÜTe¡
 {

18 
´iv©e
 
fš®
 
	m•och
 = 1;

20 @
Te¡


21 
public
 
	$g‘Agg»g©edS‹SšgËNodeClu¡”
() {

22 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

24 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

25 
loÿlEndpošt
,

26 
ImmubËLi¡
.
	`of
(),

27 
	`nodeS‹
("a", 
•och
, 
OK
)

30 
Li¡
<
Clu¡”S‹
> 
şu¡”S‹s
 = 
A¼ays
.
	`asLi¡
(
şu¡”S‹
, clusterState, clusterState);

31 
Clu¡”S‹Agg»g©Ü
 
agg»g©Ü
 = Clu¡”S‹Agg»g©Ü.
	`bud”
()

32 .
	`loÿlEndpošt
(
loÿlEndpošt
)

33 .
	`şu¡”S‹s
(
şu¡”S‹s
)

34 .
	`uÄe¥ÚsiveNodes
(
ImmubËLi¡
.
	`of
())

35 .
	`bud
();

37 
NodeS‹
 
ex³ùedNodeS‹
 = 
şu¡”S‹
.
	`g‘Node
("a").
	`g‘
();

38 
NodeS‹
 
aùu®NodeS‹
 = 
agg»g©Ü
.
	`g‘Agg»g©edS‹
().
	`g‘Node
("a").
	`g‘
();

39 
	`as£¹Th©
(
aùu®NodeS‹
).
	`isEqu®To
(
ex³ùedNodeS‹
);

42 @
Te¡


43 
public
 
	$g‘Agg»g©edS‹
() {

44 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

46 
Clu¡”S‹
 
şu¡”S‹1
 = Clu¡”S‹.
	`budClu¡”S‹
(

47 
loÿlEndpošt
,

48 
ImmubËLi¡
.
	`of
(),

49 
	`nodeS‹
("a", 
•och
, 
OK
, 
FAILED
, FAILED),

50 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("b"),

51 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

54 
Clu¡”S‹
 
şu¡”S‹2
 = Clu¡”S‹.
	`budClu¡”S‹
(

55 
loÿlEndpošt
,

56 
ImmubËLi¡
.
	`of
(),

57 
	`nodeS‹
("a", 
•och
, 
OK
, OK, 
FAILED
),

58 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

59 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

62 
fš®
 
•och
 = 1;

63 
fš®
 
couÁ”
 = 123;

64 
Clu¡”S‹
 
şu¡”S‹3
 = Clu¡”S‹.
	`budClu¡”S‹
(

65 
loÿlEndpošt
,

66 
ImmubËLi¡
.
	`of
(),

67 
	`nodeS‹
("a", 
•och
, 
OK
, 
FAILED
, FAILED),

68 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("b"),

69 
NodeS‹
.
	`g‘NÙR—dyNodeS‹
("c")

72 
Li¡
<
Clu¡”S‹
> 
şu¡”S‹s
 = 
A¼ays
.
	`asLi¡
(

73 
şu¡”S‹1
, 
şu¡”S‹2
, 
şu¡”S‹3


76 
Clu¡”S‹Agg»g©Ü
 
agg»g©Ü
 = Clu¡”S‹Agg»g©Ü.
	`bud”
()

77 .
	`loÿlEndpošt
(
loÿlEndpošt
)

78 .
	`şu¡”S‹s
(
şu¡”S‹s
)

79 .
	`uÄe¥ÚsiveNodes
(
ImmubËLi¡
.
	`of
())

80 .
	`bud
();

83 
NodeS‹
 
ex³ùedLoÿlNodeS‹
 = 
şu¡”S‹3
.
	`g‘Node
(
loÿlEndpošt
).
	`g‘
();

84 
NodeS‹
 
loÿlNodeS‹
 = 
agg»g©Ü
.
	`g‘Agg»g©edS‹
().
	`g‘Node
(
loÿlEndpošt
).
	`g‘
();

85 
	`as£¹Th©
(
loÿlNodeS‹
.
	`isCÚÃùed
()).
	`isTrue
();

86 
	`as£¹Th©
(
loÿlNodeS‹
).
	`isEqu®To
(
ex³ùedLoÿlNodeS‹
);

89 
NodeS‹
 
ex³ùedNodeBS‹
 = 
şu¡”S‹2
.
	`g‘Node
("b").
	`g‘
();

90 
NodeS‹
 
nodeBS‹
 = 
agg»g©Ü
.
	`g‘Agg»g©edS‹
().
	`g‘Node
("b").
	`g‘
();

91 
	`as£¹Th©
(
nodeBS‹
.
	`isCÚÃùed
()).
	`isTrue
();

92 
	`as£¹Th©
(
nodeBS‹
).
	`isEqu®To
(
ex³ùedNodeBS‹
);

95 
NodeS‹
 
ex³ùedNodeCS‹
 = 
şu¡”S‹3
.
	`g‘Node
("c").
	`g‘
();

96 
NodeS‹
 
nodeCS‹
 = 
agg»g©Ü
.
	`g‘Agg»g©edS‹
().
	`g‘Node
("c").
	`g‘
();

97 
	`as£¹Th©
(
nodeCS‹
.
	`isCÚÃùed
()).
	`isF®£
();

98 
	`as£¹Th©
(
nodeCS‹
).
	`isEqu®To
(
ex³ùedNodeCS‹
);

99 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterStateCollectorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gnodeS‹
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gFAILED
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

22 
public
 cÏs 
	cClu¡”S‹CŞËùÜTe¡
 {

23 
´iv©e
 
fš®
 
	m•och
 = 1;

36 @
Te¡


37 
public
 
	$‹¡Agg»g©edS‹
() {

38 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

40 
Clu¡”S‹
 
´edefšedClu¡”
 = Clu¡”S‹.
	`budClu¡”S‹
(

41 
loÿlEndpošt
,

42 
ImmubËLi¡
.
	`of
(),

43 
	`nodeS‹
("a", 
•och
, 
OK
, OK, 
FAILED
),

44 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

45 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

48 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
NodeS‹
>> 
şu¡”CÚÃùiv™y
 = 
Ãw
 
HashM­
<>();

50 
Com¶‘abËFutu»
<
NodeS‹
> 
nodeAS‹Cf
 = Com¶‘abËFutu».
	`com¶‘edFutu»
(

51 
´edefšedClu¡”
.
	`g‘Node
("a").
	`g‘
()

54 
Com¶‘abËFutu»
<
NodeS‹
> 
nodeBS‹Cf
 = Com¶‘abËFutu».
	`com¶‘edFutu»
(

55 
´edefšedClu¡”
.
	`g‘Node
("b").
	`g‘
()

58 
fš®
 
ÃwEpoch
 = 10;

59 
Com¶‘abËFutu»
<
NodeS‹
> 
wrÚgEpochCf
 = 
Ãw
 CompletableFuture<>();

60 
wrÚgEpochCf
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`WrÚgEpochExû±iÚ
(
ÃwEpoch
));

62 
şu¡”CÚÃùiv™y
.
	`put
("a", 
nodeAS‹Cf
);

63 
şu¡”CÚÃùiv™y
.
	`put
("b", 
nodeBS‹Cf
);

64 
şu¡”CÚÃùiv™y
.
	`put
("c", 
wrÚgEpochCf
);

66 
Clu¡”S‹CŞËùÜ
 
cŞËùÜ
 = Clu¡”S‹CŞËùÜ.
	`bud”
()

67 .
	`loÿlEndpošt
(
loÿlEndpošt
)

68 .
	`şu¡”S‹
(
şu¡”CÚÃùiv™y
)

69 .
	`bud
();

71 
Clu¡”S‹
 
şu¡”S‹
 = 
cŞËùÜ
.
	`cŞËùClu¡”S‹
(

72 1, 
ImmubËLi¡
.
	`of
(), 
Sequ’ûrM‘rics
.
UNKNOWN


75 
NodeS‹
 
loÿlNodeS‹
 = 
şu¡”S‹
.
	`g‘Node
(
loÿlEndpošt
).
	`g‘
();

76 
NodeCÚÃùiv™y
 
loÿlNodeCÚÃùiv™y
 = 
loÿlNodeS‹
.
	`g‘CÚÃùiv™y
();

77 
	`as£¹Th©
(
loÿlNodeS‹
.
	`isCÚÃùed
()).
	`isTrue
();

78 
	`as£¹Th©
(
loÿlNodeCÚÃùiv™y
.
	`g‘CÚÃùedNodes
()).
	`cÚšsExaùly
("a", "b", "c");

79 
	`as£¹Th©
(
loÿlNodeCÚÃùiv™y
.
	`g‘FaedNodes
()).
	`isEm±y
();

81 
NodeS‹
 
nodeBS‹
 = 
şu¡”S‹
.
	`g‘Node
("b").
	`g‘
();

82 
NodeCÚÃùiv™y
 
nodeBCÚÃùiv™y
 = 
nodeBS‹
.
	`g‘CÚÃùiv™y
();

83 
	`as£¹Th©
(
nodeBCÚÃùiv™y
.
	`g‘CÚÃùedNodes
()).
	`cÚšsExaùly
("a", "b");

85 
NodeS‹
 
nodeCS‹
 = 
şu¡”S‹
.
	`g‘Node
("c").
	`g‘
();

86 
	`as£¹Th©
(
nodeCS‹
.
	`isCÚÃùed
()).
	`isF®£
();

92 @
Te¡


93 
public
 
	$‹¡WrÚgEpochs
() {

94 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

96 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
NodeS‹
>> 
şu¡”CÚÃùiv™y
 = 
Ãw
 
HashM­
<>();

98 
fš®
 
ÃwEpoch
 = 10;

99 
Com¶‘abËFutu»
<
NodeS‹
> 
wrÚgEpochCf
 = 
Ãw
 CompletableFuture<>();

100 
wrÚgEpochCf
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`WrÚgEpochExû±iÚ
(
ÃwEpoch
));

102 
Com¶‘abËFutu»
<
NodeS‹
> 
nodeAS‹
 = Com¶‘abËFutu».
	`com¶‘edFutu»
(

103 
NodeS‹
.
	`bud”
().
	`bud
()

106 
şu¡”CÚÃùiv™y
.
	`put
("a", 
nodeAS‹
);

107 
şu¡”CÚÃùiv™y
.
	`put
("c", 
wrÚgEpochCf
);

109 
Clu¡”S‹CŞËùÜ
 
cŞËùÜ
 = Clu¡”S‹CŞËùÜ.
	`bud”
()

110 .
	`loÿlEndpošt
(
loÿlEndpošt
)

111 .
	`şu¡”S‹
(
şu¡”CÚÃùiv™y
)

112 .
	`bud
();

114 
ImmubËM­
<
SŒšg
, 
LÚg
> 
wrÚgEpochs
 = 
cŞËùÜ
.
	`cŞËùWrÚgEpochs
();

115 
	`as£¹Th©
(
wrÚgEpochs
.
	`size
()).
	`isOÃ
();

116 
	`as£¹Th©
(
wrÚgEpochs
.
	`g‘
("c")).
	`isEqu®To
(
ÃwEpoch
);

117 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterStateTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gA
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gB
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gC
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gnodeS‹
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gcÚÃùiv™y
;

18 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

20 
public
 cÏs 
	cClu¡”S‹Te¡
 {

22 @
Te¡


23 
public
 
	$isR—dy
() {

24 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

25 
fš®
 
•och1
 = 1;

26 
fš®
 
•och2
 = 2;

28 
Clu¡”S‹
 
šv®idClu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

29 
loÿlEndpošt
,

30 
ImmubËLi¡
.
	`of
(),

31 
	`nodeS‹
("a", 
•och1
, 
OK
),

32 
	`nodeS‹
("b", 
•och2
, 
OK
)

34 
	`as£¹Th©
(
šv®idClu¡”S‹
.
	`isR—dy
()).
	`isF®£
();

36 
Clu¡”S‹
 
v®idClu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

37 
loÿlEndpošt
,

38 
ImmubËLi¡
.
	`of
(),

39 
	`nodeS‹
("a", 
•och1
, 
OK
),

40 
	`nodeS‹
("b", 
•och1
, 
OK
)

42 
	`as£¹Th©
(
v®idClu¡”S‹
.
	`isR—dy
()).
	`isTrue
();

50 @
Te¡


51 
public
 
	$‹¡T¿nsfÜm©iÚ
() {

52 
NodeS‹
 
a
 = NodeS‹.
	`bud”
()

53 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
READY
)

54 .
	`cÚÃùiv™y
(cÚÃùiv™y(
A
, 
ImmubËM­
.
	`of
(A, 
OK
, 
B
, OK, 
C
, OK)))

55 .
	`bud
();

57 
NodeS‹
 
b
 = NodeS‹.
	`bud”
()

58 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
READY
)

59 .
	`cÚÃùiv™y
(cÚÃùiv™y(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK, 
C
, OK)))

60 .
	`bud
();

62 
NodeS‹
 
c
 = NodeS‹.
	`bud”
()

63 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
READY
)

64 .
	`cÚÃùiv™y
(cÚÃùiv™y(
B
, 
ImmubËM­
.
	`of
(
A
, 
OK
, B, OK, 
C
, OK)))

65 .
	`bud
();

67 
ImmubËM­
<
SŒšg
, 
NodeS‹
> 
nodes
 = ImmubËM­.
	`of
(
A
, 
a
, 
B
, 
b
, 
C
, 
c
);

68 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`bud”
()

69 .
	`loÿlEndpošt
(
A
)

70 .
	`nodes
(
nodes
)

71 .
	`uÄe¥ÚsiveNodes
(
ImmubËLi¡
.
	`cİyOf
(
nodes
.
	`keyS‘
()))

72 .
	`bud
();

74 
	`as£¹Equ®s
(
şu¡”S‹
.
	`g‘PšgRe¥ÚsiveNodes
().
	`size
(), 
nodes
.size());

75 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/CompleteGraphAdvisorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gA
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gB
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gC
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gnodeS‹
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
.
	gbudClu¡”S‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gFAILED
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

14 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

18 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

22 
public
 cÏs 
	cCom¶‘eG¿phAdvisÜTe¡
 {

24 
´iv©e
 
fš®
 
	m•och
 = 1;

31 @
Te¡


32 
public
 
	$‹¡UÄe¥ÚsiveAndFuÎyCÚÃùedNode
() {

33 
fš®
 
SŒšg
 
loÿlEndpošt
 = 
A
;

34 
Com¶‘eG¿phAdvisÜ
 
advisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
(
loÿlEndpošt
);

36 
Clu¡”S‹
 
şu¡”S‹
 = 
	`budClu¡”S‹
(

37 
loÿlEndpošt
,

38 
ImmubËLi¡
.
	`of
("b"),

39 
	`nodeS‹
(
A
, 
•och
, 
OK
, OK, OK),

40 
	`nodeS‹
(
B
, 
•och
, 
OK
, OK, 
FAILED
),

41 
	`nodeS‹
(
C
, 
•och
, 
OK
, 
FAILED
, OK)

44 
O±iÚ®
<
NodeRªk
> 
çedS”v”
 = 
advisÜ
.
	`çedS”v”
(
şu¡”S‹
);

45 
	`as£¹F®£
(
çedS”v”
.
	`isP»£Á
());

48 @
Te¡


49 
public
 
	$‹¡FaedS”v”_discÚÃùed_c
() {

50 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

51 
Com¶‘eG¿phAdvisÜ
 
advisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
(
loÿlEndpošt
);

53 
Clu¡”S‹
 
şu¡”S‹
 = 
	`budClu¡”S‹
(

54 
loÿlEndpošt
,

55 
ImmubËLi¡
.
	`of
(),

56 
	`nodeS‹
("a", 
•och
, 
OK
, OK, 
FAILED
),

57 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

58 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

61 
O±iÚ®
<
NodeRªk
> 
çedS”v”
 = 
advisÜ
.
	`çedS”v”
(
şu¡”S‹
);

62 
	`as£¹True
(
çedS”v”
.
	`isP»£Á
());

63 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
("c", 0), 
çedS”v”
.
	`g‘
());

64 
	}
}

66 @
Te¡


67 
public
 
	$‹¡FaedS”v”_asymm‘ricFau»B‘w“n_b_c
() {

68 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

69 
Com¶‘eG¿phAdvisÜ
 
advisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
(
loÿlEndpošt
);

71 
Clu¡”S‹
 
şu¡”S‹
 = 
	`budClu¡”S‹
(

72 
loÿlEndpošt
,

73 
ImmubËLi¡
.
	`of
(),

74 
	`nodeS‹
("a", 
•och
, 
OK
, OK, OK),

75 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

76 
	`nodeS‹
("c", 
•och
, 
OK
, 
FAILED
, OK)

79 
O±iÚ®
<
NodeRªk
> 
çedS”v”
 = 
advisÜ
.
	`çedS”v”
(
şu¡”S‹
);

80 
	`as£¹True
(
çedS”v”
.
	`isP»£Á
());

81 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
("c", 2), 
çedS”v”
.
	`g‘
());

82 
	}
}

88 @
Te¡


89 
public
 
	$‹¡FaedS”v”_®lDiscÚÃùed_äom_b_³r¥eùive
() {

90 
fš®
 
SŒšg
 
loÿlEndpošt
 = "b";

91 
Com¶‘eG¿phAdvisÜ
 
advisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
(
loÿlEndpošt
);

93 
Clu¡”S‹
 
şu¡”S‹
 = 
	`budClu¡”S‹
(

94 
loÿlEndpošt
,

95 
ImmubËLi¡
.
	`of
(),

96 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("a"),

97 
	`nodeS‹
("b", 
•och
, 
OK
, OK, OK),

98 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

101 
O±iÚ®
<
NodeRªk
> 
çedS”v”
 = 
advisÜ
.
	`çedS”v”
(
şu¡”S‹
);

102 
	`as£¹True
(
çedS”v”
.
	`isP»£Á
());

103 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
("c", 0), 
çedS”v”
.
	`g‘
());

104 
	}
}

112 @
Te¡


113 
public
 
	$‹¡Fau»D‘eùiÚFÜTh»eNodes_asymm‘ricP¬t™iÚ_b_c_discÚÃùedFromEachOth”
() {

114 
Com¶‘eG¿phAdvisÜ
 
nodeAAdvisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
("a");

115 
Com¶‘eG¿phAdvisÜ
 
nodeBAdvisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
("b");

116 
Com¶‘eG¿phAdvisÜ
 
nodeCAdvisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
("c");

118 
Clu¡”S‹
 
nodeAClu¡”S‹
 = 
	`budClu¡”S‹
(

120 
ImmubËLi¡
.
	`of
(),

121 
	`nodeS‹
("a", 
•och
, 
OK
, OK, OK),

122 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

123 
	`nodeS‹
("c", 
•och
, 
OK
, 
FAILED
, OK)

126 
Clu¡”S‹
 
nodeBClu¡”S‹
 = 
	`budClu¡”S‹
(

128 
ImmubËLi¡
.
	`of
(),

129 
	`nodeS‹
("a", 
•och
, 
OK
, OK, OK),

130 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

131 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

133 
Clu¡”S‹
 
nodeCClu¡”S‹
 = 
	`budClu¡”S‹
(

135 
ImmubËLi¡
.
	`of
(),

136 
	`nodeS‹
("a", 
•och
, 
OK
, OK, OK),

137 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("b"),

138 
	`nodeS‹
("c", 
•och
, 
OK
, 
FAILED
, OK)

142 
O±iÚ®
<
NodeRªk
> 
nodeAFaedS”v”
 = 
nodeAAdvisÜ
.
	`çedS”v”
(
nodeAClu¡”S‹
);

143 
	`as£¹True
(
nodeAFaedS”v”
.
	`isP»£Á
());

144 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
("c", 2), 
nodeAFaedS”v”
.
	`g‘
());

147 
O±iÚ®
<
NodeRªk
> 
nodeBFaedS”v”
 = 
nodeBAdvisÜ
.
	`çedS”v”
(
nodeBClu¡”S‹
);

148 
	`as£¹F®£
(
nodeBFaedS”v”
.
	`isP»£Á
());

151 
O±iÚ®
<
NodeRªk
> 
nodeCFaedS”v”
 = 
nodeCAdvisÜ
.
	`çedS”v”
(
nodeCClu¡”S‹
);

152 
	`as£¹F®£
(
nodeCFaedS”v”
.
	`isP»£Á
());

153 
	}
}

155 @
Te¡


156 
public
 
	$‹¡H—ËdS”v”
() {

157 
fš®
 
SŒšg
 
loÿlEndpošt
 = "c";

158 
Com¶‘eG¿phAdvisÜ
 
advisÜ
 = 
Ãw
 
	`Com¶‘eG¿phAdvisÜ
(
loÿlEndpošt
);

160 
Clu¡”S‹
 
şu¡”S‹
 = 
	`budClu¡”S‹
(

161 
loÿlEndpošt
,

162 
ImmubËLi¡
.
	`of
(
loÿlEndpošt
),

163 
	`nodeS‹
("a", 
•och
, 
OK
, 
FAILED
, OK),

164 
	`nodeS‹
("b", 
•och
, 
FAILED
, 
OK
, OK),

165 
	`nodeS‹
("c", 
•och
, 
OK
, OK, OK)

168 
O±iÚ®
<
NodeRªk
> 
h—ËdS”v”
 = 
advisÜ
.
	`h—ËdS”v”
(
şu¡”S‹
);

169 
	`as£¹True
(
h—ËdS”v”
.
	`isP»£Á
());

170 
	`as£¹Equ®s
(
Ãw
 
	`NodeRªk
(
loÿlEndpošt
, 
şu¡”S‹
.
	`size
()), 
h—ËdS”v”
.
	`g‘
());

171 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/FailureDetectorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

15 
public
 cÏs 
	cFau»D‘eùÜTe¡
 {

17 @
Te¡


18 
public
 
	$‹¡PŞlRound
() {

19 
fš®
 
SŒšg
 
’dpošt
 = "a";

20 
N‘wÜkSŒ‘ch”
 
ns
 = N‘wÜkSŒ‘ch”.
	`bud”
()

21 .
	`š™ŸlPŞlIÁ”v®
(
Du¿tiÚ
.
	`ofMlis
(100))

22 .
	`cu¼’tP”iod
(
Du¿tiÚ
.
	`ofMlis
(100))

23 .
	`maxP”iod
(
Du¿tiÚ
.
	`ofMlis
(200))

24 .
	`³riodD–
(
Du¿tiÚ
.
	`ofMlis
(50))

25 .
	`bud
();

26 
Fau»D‘eùÜ
 
çu»D‘eùÜ
 = 
Ãw
 
	`Fau»D‘eùÜ
(
’dpošt
);

27 
çu»D‘eùÜ
.
	`£tN‘wÜkSŒ‘ch”
(
ns
);

29 
•och
 = 1;

30 
ImmubËS‘
<
SŒšg
> 
®lS”v”s
 = ImmubËS‘.
	`of
("a", "b", "c");

31 
M­
<
SŒšg
, 
ICl›ÁRou‹r
> 
rou‹rM­
 = 
Ãw
 
HashM­
<>();

32 
Sequ’ûrM‘rics
 
m‘rics
 = Sequ’ûrM‘rics.
READY
;

33 
ImmubËLi¡
<
SŒšg
> 
»¥ÚsiveS”v”s
 = ImmubËLi¡.
	`of
("a", "b");

35 
¡¬t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

36 
PŞlR•Üt
 
»pÜt
 = 
çu»D‘eùÜ
.
	`pŞlRound
(

37 
•och
, 
®lS”v”s
, 
rou‹rM­
, 
m‘rics
, 
»¥ÚsiveS”v”s


39 
Du¿tiÚ
 
time
 = Du¿tiÚ.
	`ofMlis
(
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬t
);

40 
	`as£¹Th©
(
time
).
	`isG»©”Thª
(
Du¿tiÚ
.
	`ofMlis
(450));

41 
	`as£¹Th©
(
time
).
	`isLessThª
(
Du¿tiÚ
.
	`ofSecÚds
(2));

43 
	`as£¹Th©
(
»pÜt
.
	`g‘R—chabËNodes
()).
	`isEm±y
();

44 
	`as£¹Th©
(
»pÜt
.
	`g‘FaedNodes
()).
	`cÚšsExaùly
("a", "b", "c");

46 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/NetworkStretcherTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

7 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

9 
public
 cÏs 
	cN‘wÜkSŒ‘ch”Te¡
 {

11 @
Te¡


12 
public
 
	$‹¡Inü—£dP”iod
() {

13 
N‘wÜkSŒ‘ch”
 
ns
 = N‘wÜkSŒ‘ch”.
	`bud”
().
	`bud
();

14 
	`as£¹Th©
(
ns
.
	`g‘Inü—£dP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(3));

21 @
Te¡


22 
public
 
	$modifyI‹¿tiÚTimeouts
() {

23 
N‘wÜkSŒ‘ch”
 
ns
 = N‘wÜkSŒ‘ch”.
	`bud”
().
	`bud
();

25 
ns
.
	`modifyI‹¿tiÚTimeouts
();

26 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(3));

28 
ns
.
	`modifyI‹¿tiÚTimeouts
();

29 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(4));

31 
ns
.
	`modifyI‹¿tiÚTimeouts
();

32 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(5));

34 
ns
.
	`modifyI‹¿tiÚTimeouts
();

35 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(5));

37 
ns
.
	`modifyDeü—£dP”iod
();

38 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(4));

40 
ns
.
	`modifyDeü—£dP”iod
();

41 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(3));

43 
ns
.
	`modifyDeü—£dP”iod
();

44 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(2));

46 
ns
.
	`modifyDeü—£dP”iod
();

47 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(2));

49 
ns
.
	`modifyI‹¿tiÚTimeouts
();

50 
	`as£¹Th©
(
ns
.
	`g‘Cu¼’tP”iod
()).
	`isEqu®To
(
Du¿tiÚ
.
	`ofSecÚds
(3));

51 
	}
}

53 @
Te¡


54 
public
 
	$‹¡Re¡IÁ”v®
(){

55 
N‘wÜkSŒ‘ch”
 
ns
 = N‘wÜkSŒ‘ch”.
	`bud”
()

56 .
	`cu¼’tP”iod
(
Du¿tiÚ
.
	`ofSecÚds
(2))

57 .
	`š™ŸlPŞlIÁ”v®
(
Du¿tiÚ
.
	`ofSecÚds
(1))

58 .
	`bud
();

60 
Du¿tiÚ
 
–­£dTime1
 = Du¿tiÚ.
	`ofMlis
(500);

61 
Du¿tiÚ
 
»¡IÁ”v®
 = 
ns
.
	`g‘Re¡IÁ”v®
(
–­£dTime1
);

62 
	`as£¹Th©
(
»¡IÁ”v®
.
	`toMlis
()).
	`isEqu®To
(1500);

64 
Du¿tiÚ
 
–­£dTime2
 = Du¿tiÚ.
	`ofMlis
(800);

65 
»¡IÁ”v®
 = 
ns
.
	`g‘Re¡IÁ”v®
(
–­£dTime2
);

66 
	`as£¹Th©
(
»¡IÁ”v®
.
	`toMlis
()).
	`isEqu®To
(1200);

68 
Du¿tiÚ
 
–­£dTime3
 = Du¿tiÚ.
	`ofMlis
(1200);

69 
»¡IÁ”v®
 = 
ns
.
	`g‘Re¡IÁ”v®
(
–­£dTime3
);

70 
	`as£¹Th©
(
»¡IÁ”v®
.
	`toMlis
()).
	`isEqu®To
(1000);

71 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/NodeRankTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeRªk
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

7 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dS‘
;

8 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

12 
public
 cÏs 
	cNodeRªkTe¡
 {

14 @
Te¡


15 
public
 
	$‹¡SÜtšgByNumb”OfCÚÃùiÚs
(){

16 
NodeRªk
 
¿nk1
 = 
Ãw
 
	`NodeRªk
("a", 1);

17 
NodeRªk
 
¿nk2
 = 
Ãw
 
	`NodeRªk
("b", 2);

18 
SÜ‹dS‘
<
NodeRªk
> 
¿nks
 = 
Ãw
 
T»eS‘
<>(
A¼ays
.
	`asLi¡
(
¿nk1
, 
¿nk2
));

20 
	`as£¹Equ®s
(
¿nks
.
	`fœ¡
(), 
¿nk2
);

23 @
Te¡


24 
public
 
	$‹¡SÜtšgByName
(){

25 
NodeRªk
 
¿nk1
 = 
Ãw
 
	`NodeRªk
("a", 1);

26 
NodeRªk
 
¿nk2
 = 
Ãw
 
	`NodeRªk
("b", 1);

27 
SÜ‹dS‘
<
NodeRªk
> 
¿nks
 = 
Ãw
 
T»eS‘
<>(
A¼ays
.
	`asLi¡
(
¿nk1
, 
¿nk2
));

29 
	`as£¹Equ®s
(
¿nks
.
	`fœ¡
(), 
¿nk1
);

30 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/management/NodeStateTestUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

11 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

15 
public
 cÏs 
	cNodeS‹Te¡Ut
 {

17 
´iv©e
 
fš®
 
	mLi¡
<
	mNodeName
> 
	mNODE_NAMES
 = 
A¼ays
.
asLi¡
(
NodeName
.
v®ues
());

19 
public
 
fš®
 
SŒšg
 
	mA
 = 
NodeName
.
a
.
Çme
();

20 
public
 
fš®
 
SŒšg
 
	mB
 = 
NodeName
.
b
.
Çme
();

21 
public
 
fš®
 
SŒšg
 
	mC
 = 
NodeName
.
c
.
Çme
();

23 
´iv©e
 
	$NodeS‹Te¡Ut
() {

27 
public
 
NodeS‹
 
	$nodeS‹
(
SŒšg
 
’dpošt
, 
•och
, 
CÚÃùiÚStus
... 
cÚÃùiÚS‹s
) {

28 
M­
<
SŒšg
, 
CÚÃùiÚStus
> 
cÚÃùiv™y
 = 
Ãw
 
HashM­
<>();

29 
i
 = 0; i < 
cÚÃùiÚS‹s
.
Ëngth
; i++) {

30 
cÚÃùiv™y
.
	`put
(
NODE_NAMES
.
	`g‘
(
i
).
	`Çme
(), 
cÚÃùiÚS‹s
[i]);

33 
NodeCÚÃùiv™y
 
nodeCÚÃùiv™y
 = NodeCÚÃùiv™y.
	`bud”
()

34 .
	`’dpošt
(
’dpošt
)

35 .
	`ty³
(
NodeCÚÃùiv™yTy³
.
CONNECTED
)

36 .
	`cÚÃùiv™y
(
ImmubËM­
.
	`cİyOf
(
cÚÃùiv™y
))

37 .
	`•och
(
•och
)

38 .
	`bud
();

40  
NodeS‹
.
	`bud”
()

41 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
READY
)

42 .
	`cÚÃùiv™y
(
nodeCÚÃùiv™y
)

43 .
	`bud
();

44 
	}
}

46 
public
 
	eNodeName
 {

47 
	ga
, 
	gb
, 
	gc
, 
	gd
, 
	ge
, 
	gf
, 
	gg
, 
	gh
, 
	gi
, 
	gj
, 
	gk


	@infrastructure/src/test/java/org/corfudb/infrastructure/management/PollReportTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gClu¡”S‹
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gNodeS‹Te¡Ut
.
	gnodeS‹
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gFAILED
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

17 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

18 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gwh’
;

20 
public
 cÏs 
	cPŞlR•ÜtTe¡
 {

22 
´iv©e
 
fš®
 
	m•och
 = 1;

24 @
Te¡


25 
public
 
	$‹¡CÚÃùiÚStu£sOÃNode
() {

26 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

28 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

29 
loÿlEndpošt
, 
ImmubËLi¡
.
	`of
(), 
	`nodeS‹
("a", 
•och
, 
OK
)

32 
fš®
 
•och
 = 1;

33 
fš®
 
Du¿tiÚ
 
du¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

34 
PŞlR•Üt
 
pŞlR•Üt
 = PŞlR•Üt.
	`bud”
()

35 .
	`pšgRe¥ÚsiveS”v”s
(
ImmubËLi¡
.
	`of
("a"))

36 .
	`wrÚgEpochs
(
ImmubËM­
.
	`of
("a", 
•och
))

37 .
	`şu¡”S‹
(
şu¡”S‹
)

38 .
	`–­£dTime
(
Du¿tiÚ
.
ZERO
)

39 .
	`bud
();

41 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘R—chabËNodes
()).
	`isEm±y
();

42 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘AÎR—chabËNodes
()).
	`cÚšsExaùly
("a");

45 @
Te¡


46 
public
 
	$‹¡CÚÃùiÚStu£s
() {

47 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

49 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

50 
loÿlEndpošt
,

51 
ImmubËLi¡
.
	`of
(),

52 
	`nodeS‹
("a", 
•och
, 
OK
, 
FAILED
, FAILED),

53 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("b"),

54 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

57 
fš®
 
•och
 = 1;

58 
fš®
 
Du¿tiÚ
 
du¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

59 
PŞlR•Üt
 
pŞlR•Üt
 = PŞlR•Üt.
	`bud”
()

60 .
	`pšgRe¥ÚsiveS”v”s
(
ImmubËLi¡
.
	`of
("a", "b", "c"))

61 .
	`wrÚgEpochs
(
ImmubËM­
.
	`of
("b", 
•och
))

62 .
	`şu¡”S‹
(
şu¡”S‹
)

63 .
	`–­£dTime
(
Du¿tiÚ
.
ZERO
)

64 .
	`bud
();

66 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘R—chabËNodes
()).
	`cÚšsExaùly
("a");

67 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘AÎR—chabËNodes
()).
	`cÚšsExaùly
("a", "b");

68 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘FaedNodes
()).
	`cÚšsExaùly
("c");

69 
	}
}

75 @
Te¡


76 
public
 
	$‹¡IncÚsi¡’cyB‘w“nClu¡”S‹AndWrÚgEpochs
() {

77 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

79 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

80 
loÿlEndpošt
,

81 
ImmubËLi¡
.
	`of
(),

82 
	`nodeS‹
("a", 
•och
, 
OK
, 
FAILED
, FAILED),

83 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

84 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

87 
fš®
 
•och
 = 1;

88 
fš®
 
Du¿tiÚ
 
du¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

89 
PŞlR•Üt
 
pŞlR•Üt
 = PŞlR•Üt.
	`bud”
()

90 .
	`pšgRe¥ÚsiveS”v”s
(
ImmubËLi¡
.
	`of
("a", "b", "c"))

91 .
	`wrÚgEpochs
(
ImmubËM­
.
	`of
("b", 
•och
))

92 .
	`şu¡”S‹
(
şu¡”S‹
)

93 .
	`–­£dTime
(
Du¿tiÚ
.
ZERO
)

94 .
	`bud
();

96 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘R—chabËNodes
()).
	`cÚšsExaùly
("a");

97 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘AÎR—chabËNodes
()).
	`cÚšsExaùly
("a", "b");

98 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘FaedNodes
()).
	`cÚšsExaùly
("c");

99 
	}
}

101 @
Te¡


102 
public
 
	$‹¡IsSlÙUnfËd
() {

103 
fš®
 
SŒšg
 
loÿlEndpošt
 = "a";

105 
Clu¡”S‹
 
şu¡”S‹
 = Clu¡”S‹.
	`budClu¡”S‹
(

106 
loÿlEndpošt
,

107 
ImmubËLi¡
.
	`of
(),

108 
	`nodeS‹
("a", 
•och
, 
OK
, OK, 
FAILED
),

109 
	`nodeS‹
("b", 
•och
, 
OK
, OK, 
FAILED
),

110 
NodeS‹
.
	`g‘UÇvaabËNodeS‹
("c")

113 
fš®
 
•och
 = 1;

114 
PŞlR•Üt
 
pŞlR•Üt
 = PŞlR•Üt.
	`bud”
()

115 .
	`pšgRe¥ÚsiveS”v”s
(
ImmubËLi¡
.
	`of
("a", "b", "c"))

116 .
	`wrÚgEpochs
(
ImmubËM­
.
	`of
("a", 
•och
, "b",ƒpoch, "c",ƒpoch))

117 .
	`şu¡”S‹
(
şu¡”S‹
)

118 .
	`–­£dTime
(
Du¿tiÚ
.
ZERO
)

119 .
	`bud
();

121 
Layout
 
Ï‹¡Comm™‹d
 = 
	`mock
(Layout.
şass
);

122 
	`wh’
(
Ï‹¡Comm™‹d
.
	`g‘Epoch
()).
	`th’R‘uº
(
•och
 - 1);

123 
	`as£¹Th©
(
pŞlR•Üt
.
	`g‘LayoutSlÙUnFËd
(
Ï‹¡Comm™‹d
)).
	`isP»£Á
();

124 
	}
}

	@infrastructure/src/test/java/org/corfudb/infrastructure/redundancy/RedundancyCalculatorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLayoutBa£dTe¡H–³r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’t
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gT¿nsãrSegm’tC»©Ü
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

14 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

18 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gNOT_TRANSFERRED
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	g¡©‘¿nsãr
.
	gS‹T¿nsãrMªag”
.
	gT¿nsãrSegm’tStus
.
	gSegm’tS‹
.
	gRESTORED
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
.
	gNON_ADDRESS
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSŒe
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gR•liÿtiÚMode
.
	gCHAIN_REPLICATION
;

26 
public
 cÏs 
	cRedundªcyC®cuÏtÜTe¡
 
ex‹nds
 
LayoutBa£dTe¡H–³r
 
im¶em’ts
 
	mT¿nsãrSegm’tC»©Ü
 {

28 @
Te¡


29 
public
 
	$‹¡C»©eS‹Li¡TrimM¬kNÙMoved
() {

30 
RedundªcyC®cuÏtÜ
 
»dundªcyC®cuÏtÜ
 =

31 
Ãw
 
	`RedundªcyC®cuÏtÜ
("localhost");

33 
Layout
 
Ïyout
 = 
	`ü—‹NÚP»£ÁLayout
();

35 
ImmubËLi¡
<
LayoutBa£dTe¡H–³r
.
MockedSegm’t
> 
ex³ùed
 = ImmubËLi¡.
	`of
(

36 
Ãw
 
	`MockedSegm’t
(0L, 1L,

37 
	`ü—‹Stus
(
NOT_TRANSFERRED
, 0L, 
O±iÚ®
.
	`em±y
())),

38 
Ãw
 
	`MockedSegm’t
(2L, 3L,

39 
	`ü—‹Stus
(
NOT_TRANSFERRED
, 0L, 
O±iÚ®
.
	`em±y
())));

41 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
»suÉ
 = 
»dundªcyC®cuÏtÜ


42 .
	`ü—‹S‹Li¡
(
Ïyout
, -1L);

44 
	`as£¹Th©
(
	`ŒªsfÜmLi¡ToMock
(
»suÉ
)).
	`isEqu®To
(
ex³ùed
);

46 
Ïyout
 = 
	`ü—‹P»£ÁLayout
();

48 
ex³ùed
 = 
ImmubËLi¡
.
	`of
(

49 
Ãw
 
	`MockedSegm’t
(0L, 1L,

50 
	`ü—‹Stus
(
NOT_TRANSFERRED
, 0L, 
O±iÚ®
.
	`em±y
())),

51 
Ãw
 
	`MockedSegm’t
(2L, 3L,

52 
	`ü—‹Stus
(
RESTORED
, 2L, 
O±iÚ®
.
	`em±y
())));

54 
»suÉ
 = 
»dundªcyC®cuÏtÜ
.
	`ü—‹S‹Li¡
(
Ïyout
, -1L);

56 
	`as£¹Th©
(
	`ŒªsfÜmLi¡ToMock
(
»suÉ
))

57 .
	`isEqu®To
(
ex³ùed
);

60 @
Te¡


61 
public
 
	$‹¡C»©eS‹Li¡TrimM¬kIÁ”£ùsSegm’t
() {

62 
RedundªcyC®cuÏtÜ
 
»dundªcyC®cuÏtÜ
 =

63 
Ãw
 
	`RedundªcyC®cuÏtÜ
("localhost");

65 
Layout
 
Ïyout
 = 
	`ü—‹NÚP»£ÁLayout
();

69 
ImmubËLi¡
<
MockedSegm’t
> 
ex³ùed
 =

70 
ImmubËLi¡
.
	`of
(

71 
Ãw
 
	`MockedSegm’t
(3L, 3L,

72 
	`ü—‹Stus
(
NOT_TRANSFERRED
, 0L, 
O±iÚ®
.
	`em±y
())));

75 
Li¡
<
T¿nsãrSegm’t
> 
»suÉ
 = 
»dundªcyC®cuÏtÜ
.
	`ü—‹S‹Li¡
(
Ïyout
, 3L);

77 
	`as£¹Th©
(
	`ŒªsfÜmLi¡ToMock
(
»suÉ
)).
	`isEqu®To
(
ex³ùed
);

79 
Ïyout
 = 
	`ü—‹P»£ÁLayout
();

81 
ex³ùed
 = 
ImmubËLi¡
.
	`of
(

82 
Ãw
 
	`MockedSegm’t
(3L, 3L,

83 
	`ü—‹Stus
(
RESTORED
, 1L, 
O±iÚ®
.
	`em±y
())));

85 
»suÉ
 = 
»dundªcyC®cuÏtÜ
.
	`ü—‹S‹Li¡
(
Ïyout
, 3L);

87 
	`as£¹Th©
(
	`ŒªsfÜmLi¡ToMock
(
»suÉ
)).
	`isEqu®To
(
ex³ùed
);

89 
	}
}

91 @
Te¡


92 
public
 
	$‹¡Segm’tCÚšsS”v”
() {

95 
LayoutSŒe
 
¡re1
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("localhost", "A", "B"));

96 
LayoutSŒe
 
¡re2
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

97 
LayoutSŒe
 
¡re3
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

99 
LayoutSegm’t
 
£gm’t
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

100 
A¼ays
.
	`asLi¡
(
¡re1
, 
¡re2
, 
¡re3
));

102 
RedundªcyC®cuÏtÜ
 
ÿlcuÏtÜ
 = 
Ãw
 
	`RedundªcyC®cuÏtÜ
("localhost");

104 
As£¹
.
	`as£¹True
(
ÿlcuÏtÜ
.
	`£gm’tCÚšsS”v”
(
£gm’t
, "localhost"));

106 
¡re1
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("A", "B"));

107 
£gm’t
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

108 
A¼ays
.
	`asLi¡
(
¡re1
, 
¡re2
, 
¡re3
));

109 
As£¹
.
	`as£¹F®£
(
ÿlcuÏtÜ
.
	`£gm’tCÚšsS”v”
(
£gm’t
, "localhost"));

110 
	}
}

112 @
Te¡


113 
public
 
	$‹¡RequœesRedundªcyRe¡Ü©iÚ
() {

114 
LayoutSŒe
 
¡re0
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("A"));

115 
LayoutSŒe
 
¡re1
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("A", "B"));

116 
LayoutSŒe
 
¡re2
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("A", "B", "localhost"));

117 
LayoutSegm’t
 
£gm’t0
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 2L,

118 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re0
));

119 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 3L, 6L,

120 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re1
));

121 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 6L, 9L,

122 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡re2
));

125 
Layout
 
Ïyout
 = 
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
));

126 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ
.
	`ÿnRe¡ÜeRedundªcy
(
Ïyout
, "A"))

127 .
	`isF®£
();

129 
Ïyout
 = 
	`ü—‹Te¡Layout
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£gm’t1
));

130 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ
.
	`ÿnRe¡ÜeRedundªcy
(
Ïyout
, "A"))

131 .
	`isF®£
();

133 
Ïyout
 = 
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t0
, 
£gm’t1
, 
£gm’t2
));

134 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ
.
	`ÿnRe¡ÜeRedundªcy
(
Ïyout
, "B"))

135 .
	`isTrue
();

137 
Ïyout
 = 
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t0
, 
£gm’t2
));

138 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ
.
	`ÿnRe¡ÜeRedundªcy
(
Ïyout
, "localhost"))

139 .
	`isTrue
();

142 
	}
}

144 @
Te¡


145 
public
 
	$‹¡C»©eS‹Li¡Com¶ex
() {

147 
LayoutSŒe
 
¡re1
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("localhost", "A", "B"));

148 
LayoutSŒe
 
¡re2
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

149 
LayoutSŒe
 
¡re3
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

150 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 21L,

151 
A¼ays
.
	`asLi¡
(
¡re1
, 
¡re2
, 
¡re3
));

153 
LayoutSŒe
 
¡re11
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("C", "D"));

154 
LayoutSŒe
 
¡re22
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

155 
LayoutSŒe
 
¡re33
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

156 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 21L, 51L,

157 
A¼ays
.
	`asLi¡
(
¡re11
, 
¡re22
, 
¡re33
));

159 
Li¡
<
LayoutSegm’t
> 
ÏyoutSegm’ts
 = 
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
);

161 
Layout
 
‹¡Layout
 = 
	`ü—‹Te¡Layout
(
ÏyoutSegm’ts
);

163 
RedundªcyC®cuÏtÜ
 
ÿlcuÏtÜ
 = 
Ãw
 
	`RedundªcyC®cuÏtÜ
("localhost");

165 
ImmubËLi¡
<
T¿nsãrSegm’t
> 
ŒªsãrSegm’ts
 =

166 
ÿlcuÏtÜ
.
	`ü—‹S‹Li¡
(
‹¡Layout
, -1L);

168 
MockedSegm’t
 
´e£ÁSegm’t
 = 
Ãw
 
	`MockedSegm’t
(0L,

170 
T¿nsãrSegm’tStus
.
	`bud”
().
	`£gm’tS‹
(
RESTORED
).
	`tÙ®T¿nsã¼ed
(21L).
	`bud
());

173 
MockedSegm’t
 
nÚP»£ÁSegm’t
 = 
Ãw
 
	`MockedSegm’t
(21L,

174 50L, 
T¿nsãrSegm’tStus
.
	`bud”
().
	`£gm’tS‹
(
NOT_TRANSFERRED
).
	`tÙ®T¿nsã¼ed
(0L).
	`bud
());

176 
As£¹
.
	`as£¹True
(
	`ŒªsfÜmLi¡ToMock
(
ŒªsãrSegm’ts
).
	`cÚšsAÎ
(
A¼ays
.
	`asLi¡
(
´e£ÁSegm’t
,

177 
nÚP»£ÁSegm’t
)));

179 
T¿nsãrSegm’tStus
 
´e£ÁSegm’tStus
 = 
´e£ÁSegm’t
.
¡©us
;

180 
	`as£¹Th©
(
RESTORED
)

181 .
	`isEqu®To
(
´e£ÁSegm’tStus
.
	`g‘Segm’tS‹
());

183 
T¿nsãrSegm’tStus
 
nÚP»£ÁSegm’tStus
 = 
nÚP»£ÁSegm’t
.
¡©us
;

185 
	`as£¹Th©
(
NOT_TRANSFERRED
)

186 .
	`isEqu®To
(
nÚP»£ÁSegm’tStus
.
	`g‘Segm’tS‹
());

187 
	}
}

189 @
Te¡


190 
public
 
	$‹¡Re¡ÜeRedundªcyFÜSegm’t
() {

191 
T¿nsãrSegm’t
 
£gm’t
 = 
	`ü—‹T¿nsãrSegm’t
(0L, 20L, 
RESTORED
);

193 
LayoutSŒe
 
¡re1
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("A"));

194 
LayoutSŒe
 
¡re2
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

195 
LayoutSŒe
 
¡re3
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

196 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 21L,

197 
A¼ays
.
	`asLi¡
(
¡re1
, 
¡re2
, 
¡re3
));

199 
LayoutSŒe
 
¡re11
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("C", "D"));

200 
LayoutSŒe
 
¡re22
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

201 
LayoutSŒe
 
¡re33
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

202 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 21L, 51L,

203 
A¼ays
.
	`asLi¡
(
¡re11
, 
¡re22
, 
¡re33
));

205 
Li¡
<
LayoutSegm’t
> 
ÏyoutSegm’ts
 = 
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
);

207 
Layout
 
‹¡Layout
 = 
	`ü—‹Te¡Layout
(
ÏyoutSegm’ts
);

209 
RedundªcyC®cuÏtÜ
 
ÿlcuÏtÜ
 = 
Ãw
 
	`RedundªcyC®cuÏtÜ
("localhost");

210 
Layout
 
Ïyout
 = 
ÿlcuÏtÜ
.
	`»¡ÜeRedundªcyFÜSegm’t
(
£gm’t
, 
‹¡Layout
);

211 
	`as£¹Th©
(
Ïyout
.
	`g‘Fœ¡Segm’t
().
	`g‘Fœ¡SŒe
().
	`g‘LogS”v”s
())

212 .
	`cÚšs
("localhost");

214 
	}
}

216 @
Te¡


217 
public
 
	$‹¡Upd©eLayoutAá”RedundªcyRe¡Ü©iÚ
() {

219 
LayoutSŒe
 
¡re1
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("A"));

220 
LayoutSŒe
 
¡re2
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

221 
LayoutSŒe
 
¡re3
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

222 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 21L,

223 
A¼ays
.
	`asLi¡
(
¡re1
, 
¡re2
, 
¡re3
));

225 
LayoutSŒe
 
¡re11
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("C", "D"));

226 
LayoutSŒe
 
¡re22
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("C"));

227 
LayoutSŒe
 
¡re33
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("D"));

228 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 21L, 51L,

229 
A¼ays
.
	`asLi¡
(
¡re11
, 
¡re22
, 
¡re33
));

232 
LayoutSŒe
 
¡re111
 = 
Ãw
 
	`LayoutSŒe
(
A¼ays
.
	`asLi¡
("E", "F"));

233 
LayoutSŒe
 
¡re222
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("G"));

234 
LayoutSŒe
 
¡re333
 = 
Ãw
 
	`LayoutSŒe
(
CŞËùiÚs
.
	`sšgËtÚLi¡
("H"));

235 
LayoutSegm’t
 
£gm’t3
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 51L, 61L,

236 
A¼ays
.
	`asLi¡
(
¡re111
, 
¡re222
, 
¡re333
));

238 
Li¡
<
LayoutSegm’t
> 
ÏyoutSegm’ts
 = 
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
, 
£gm’t3
);

240 
Layout
 
‹¡Layout
 = 
	`ü—‹Te¡Layout
(
ÏyoutSegm’ts
);

242 
Li¡
<
T¿nsãrSegm’t
> 
ŒªsãrSegm’ts
 = 
A¼ays
.
asLi¡


243 (
	`ü—‹T¿nsãrSegm’t
(0L, 20L, 
RESTORED
),

244 
	`ü—‹T¿nsãrSegm’t
(21L, 50L, 
RESTORED
),

245 
	`ü—‹T¿nsãrSegm’t
(51L, 60L, 
RESTORED
));

248 
RedundªcyC®cuÏtÜ
 
ÿlcuÏtÜ
 = 
Ãw
 
	`RedundªcyC®cuÏtÜ
("localhost");

250 
Layout
 
cÚsŞid©edLayout
 =

251 
ÿlcuÏtÜ
.
	`upd©eLayoutAá”RedundªcyRe¡Ü©iÚ
(
ŒªsãrSegm’ts
,

252 
‹¡Layout
);

254 
	`as£¹Th©
(
cÚsŞid©edLayout
.
	`g‘Segm’ts
().
	`¡»am
())

255 .
	`®lM©ch
(
£gm’t
 -> segm’t.
	`g‘Fœ¡SŒe
().
	`g‘LogS”v”s
().
	`cÚšs
("localhost"));

257 
	}
}

259 @
Te¡


260 
public
 
	$‹¡CªM”geSegm’tsOÃSegm’t
() {

261 
LayoutSegm’t
 
£gm’t
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

262 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("localhost"))));

263 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ


264 .
	`ÿnM”geSegm’ts
(
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t
)))).
	`isF®£
();

265 
	}
}

267 @
Te¡


268 
public
 
	$‹¡CªM”geSegm’tsS”v”sNÚP»£Á
() {

269 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

270 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("localhost", "B"))));

272 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

273 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("C", "A"))));

274 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ


275 .
	`ÿnM”geSegm’ts
(
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
)))).
	`isF®£
();

276 
	}
}

278 @
Te¡


279 
public
 
	$‹¡CªM”geSegm’tsS”v”NÙP»£Á
() {

280 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

281 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("localhost", "B"))));

283 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

284 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("C", "B", "localhost"))));

285 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ


286 .
	`ÿnM”geSegm’ts
(
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
)))).
	`isF®£
();

287 
	}
}

289 @
Te¡


290 
public
 
	$‹¡CªM”geSegm’tsDoM”ge
() {

291 
LayoutSegm’t
 
£gm’t1
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

292 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("localhost", "B"))));

294 
LayoutSegm’t
 
£gm’t2
 = 
Ãw
 
	`LayoutSegm’t
(
CHAIN_REPLICATION
, 0L, 1L,

295 
A¼ays
.
	`asLi¡
(
Ãw
 
	`LayoutSŒe
(Arrays.asList("B", "localhost"))));

296 
	`as£¹Th©
(
RedundªcyC®cuÏtÜ


297 .
	`ÿnM”geSegm’ts
(
	`ü—‹Te¡Layout
(
A¼ays
.
	`asLi¡
(
£gm’t1
, 
£gm’t2
)))).
	`isTrue
();

299 
	}
}

301 @
Te¡


302 
public
 
	$‹¡Segm’tV”ifiÿtiÚ
() {

303 
T¿nsãrSegm’tStus
 
¡©us
 = T¿nsãrSegm’tStus.
	`bud”
().
	`bud
();

306 
	`as£¹Th©ThrownBy
(() ->

307 
T¿nsãrSegm’t
.
	`bud”
()

308 .
	`¡¬tAdd»ss
(
NON_ADDRESS
)

309 .
	`’dAdd»ss
(0)

310 .
	`¡©us
(
¡©us
)

311 .
	`bud
()).
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

314 
	`as£¹Th©ThrownBy
(() ->

315 
T¿nsãrSegm’t
.
	`bud”
()

316 .
	`¡¬tAdd»ss
(0)

317 .
	`’dAdd»ss
(
NON_ADDRESS
)

318 .
	`¡©us
(
¡©us
)

319 .
	`bud
()).
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

322 
	`as£¹Th©ThrownBy
(() ->

323 
T¿nsãrSegm’t
.
	`bud”
()

324 .
	`¡¬tAdd»ss
(3)

325 .
	`’dAdd»ss
(2)

326 .
	`¡©us
(
¡©us
)

327 .
	`bud
()).
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

330 
	`as£¹Th©ThrownBy
(() ->

331 
T¿nsãrSegm’t
.
	`bud”
()

332 .
	`¡¬tAdd»ss
(0L)

333 .
	`’dAdd»ss
(1L)

334 .
	`¡©us
(
nuÎ
)

335 .
	`bud
()).
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

338 
	}
}

	@infrastructure/target/generated-sources/org/corfudb/infrastructure/logreplication/proto/LogReplicationWriterMetadata.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
;

6 
public
 
fš®
 cÏs 
	cLogR•liÿtiÚWr™”M‘ad©a
 {

7 
´iv©e
 
	$LogR•liÿtiÚWr™”M‘ad©a
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
LogR•liÿtiÚM‘ad©aKeyOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
	gjava
.
	gÏng
.
SŒšg
 
g‘Key
();

28 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


29 
g‘KeyBy‹s
();

34 
public
 
fš®
 
şass
 
LogR•liÿtiÚM‘ad©aKey
 
ex‹nds


35 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


37 
	gLogR•liÿtiÚM‘ad©aKeyOrBud”
 {

39 
´iv©e
 
LogR•liÿtiÚM‘ad©aKey
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

40 
su³r
(
bud”
);

42 
´iv©e
 
LogR•liÿtiÚM‘ad©aKey
() {

43 
	gkey_
 = "";

46 @
	gjava
.
	gÏng
.
Ov”ride


47 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


48 
g‘UnknownF›lds
() {

49  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

51 
´iv©e
 
LogR•liÿtiÚM‘ad©aKey
(

52 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

53 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

54 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

55 
this
();

56 
	gmubË_b™F›ld0_
 = 0;

57 
	gŒy
 {

58 
boŞ—n
 
	gdÚe
 = 
çl£
;

59 !
	gdÚe
) {

60 
	gg
 = 
šput
.
»adTag
();

61 
	gg
) {

63 
dÚe
 = 
Œue
;

66 ià(!
šput
.
skF›ld
(
g
)) {

67 
dÚe
 = 
Œue
;

72 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

74 
	gkey_
 = 
s
;

79 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

80 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

81 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

82 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

83 
e
).
£tUnfšishedMes§ge
(
this
);

84 } 
	gfš®ly
 {

85 
makeEx‹nsiÚsImmubË
();

88 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


89 
g‘DesütÜ
() {

90  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_desütÜ
;

93 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


94 
š‹º®G‘F›ldAcûssÜTabË
() {

95  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_f›ldAcûssÜTabË


96 .
’su»F›ldAcûssÜsIn™Ÿlized
(

97 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
.
şass
, org.cÜfudb.šäa¡ruùu».log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚWr™”M‘ad©a.LogR•liÿtiÚM‘ad©aKey.
Bud”
.class);

100 
public
 
fš®
 
	gKEY_FIELD_NUMBER
 = 1;

101 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gkey_
;

105 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Key
() {

106 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
key_
;

107 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

108  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

110 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

111 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

112 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

113 
	gkey_
 = 
s
;

114  
	gs
;

120 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


121 
g‘KeyBy‹s
() {

122 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
key_
;

123 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

124 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

125 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

126 (
java
.
Ïng
.
SŒšg
è
»f
);

127 
	gkey_
 = 
b
;

128  
	gb
;

130  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

134 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

135 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

136 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

137 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

138 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

140 
	gmemoizedIsIn™Ÿlized
 = 1;

141  
	gŒue
;

144 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

145 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

146 ià(!
g‘KeyBy‹s
().
isEm±y
()) {

147 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
key_
);

151 
public
 
g‘S”ŸlizedSize
() {

152 
	gsize
 = 
memoizedSize
;

153 ià(
	gsize
 !ğ-1è 
size
;

155 
	gsize
 = 0;

156 ià(!
g‘KeyBy‹s
().
isEm±y
()) {

157 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
key_
);

159 
	gmemoizedSize
 = 
size
;

160  
	gsize
;

163 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

164 @
	gjava
.
	gÏng
.
Ov”ride


165 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

166 ià(
	gobj
 =ğ
this
) {

167  
Œue
;

169 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aKey
)) {

170  
	gsu³r
.
equ®s
(
obj
);

172 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
	gÙh”
 = (
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.LogR•liÿtiÚM‘ad©aKeyè
obj
;

174 
boŞ—n
 
	g»suÉ
 = 
Œue
;

175 
	g»suÉ
 = 
»suÉ
 && 
g‘Key
()

176 .
equ®s
(
Ùh”
.
g‘Key
());

177  
	g»suÉ
;

180 @
	gjava
.
	gÏng
.
Ov”ride


181 
public
 
hashCode
() {

182 ià(
	gmemoizedHashCode
 != 0) {

183  
memoizedHashCode
;

185 
	ghash
 = 41;

186 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

187 
	ghash
 = (37 * 
hash
è+ 
KEY_FIELD_NUMBER
;

188 
	ghash
 = (53 * 
hash
è+ 
g‘Key
().
hashCode
();

189 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

190 
	gmemoizedHashCode
 = 
hash
;

191  
	ghash
;

194 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(

195 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

196 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

197  
	gPARSER
.
·r£From
(
d©a
);

199 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(

200 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

201 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

202 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

203  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

205 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(
by‹
[] 
d©a
)

206 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

207  
	gPARSER
.
·r£From
(
d©a
);

209 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(

210 
by‹
[] 
d©a
,

211 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

212 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

213  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

215 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

216 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

217  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


218 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

220 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(

221 
java
.
io
.
IÅutSŒ—m
 
šput
,

222 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

223 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

224  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


225 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

227 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

228 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

229  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


230 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

232 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£D–im™edFrom
(

233 
java
.
io
.
IÅutSŒ—m
 
šput
,

234 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

235 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

236  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


237 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

239 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(

240 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

241 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

242  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


243 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

245 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
·r£From
(

246 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

247 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

248 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

249  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


250 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

253 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

254 
public
 
Bud”
 
ÃwBud”
() {

255  
	gDEFAULT_INSTANCE
.
toBud”
();

257 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
´ÙÙy³
) {

258  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

260 
public
 
Bud”
 
toBud”
() {

261  
	gthis
 =ğ
DEFAULT_INSTANCE


262 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

265 @
	gjava
.
	gÏng
.
Ov”ride


266 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

267 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

268 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

269  
	gbud”
;

274 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


275 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


277 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aKeyOrBud”
 {

278 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


279 
g‘DesütÜ
() {

280  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_desütÜ
;

283 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


284 
š‹º®G‘F›ldAcûssÜTabË
() {

285  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_f›ldAcûssÜTabË


286 .
’su»F›ldAcûssÜsIn™Ÿlized
(

287 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
.
şass
, org.cÜfudb.šäa¡ruùu».log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚWr™”M‘ad©a.LogR•liÿtiÚM‘ad©aKey.
Bud”
.class);

291 
´iv©e
 
Bud”
() {

292 
maybeFÜûBud”In™Ÿliz©iÚ
();

295 
´iv©e
 
Bud”
(

296 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

297 
su³r
(
·»Á
);

298 
maybeFÜûBud”In™Ÿliz©iÚ
();

300 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

301 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


302 .
	g®waysU£F›ldBud”s
) {

305 
public
 
Bud”
 
ş—r
() {

306 
	gsu³r
.
ş—r
();

307 
	gkey_
 = "";

309  
	gthis
;

312 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


313 
g‘DesütÜFÜTy³
() {

314  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_desütÜ
;

317 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
g‘DeçuÉIn¡ªûFÜTy³
() {

318  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aKey
.
g‘DeçuÉIn¡ªû
();

321 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
bud
() {

322 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
	g»suÉ
 = 
budP¬tŸl
();

323 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

324 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

326  
	g»suÉ
;

329 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
budP¬tŸl
() {

330 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.LogR•liÿtiÚM‘ad©aKey(
this
);

331 
	g»suÉ
.
	gkey_
 = 
key_
;

332 
ÚBut
();

333  
	g»suÉ
;

336 
public
 
Bud”
 
şÚe
() {

337  (
	gBud”
è
	gsu³r
.
şÚe
();

339 
public
 
Bud”
 
£tF›ld
(

340 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

341 
Objeù
 
v®ue
) {

342  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

344 
public
 
Bud”
 
ş—rF›ld
(

345 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

346  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

348 
public
 
Bud”
 
ş—rOÃof
(

349 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

350  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

352 
public
 
Bud”
 
£tR•—‹dF›ld
(

353 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

354 
šdex
, 
Objeù
 
v®ue
) {

355  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

357 
public
 
Bud”
 
addR•—‹dF›ld
(

358 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

359 
Objeù
 
v®ue
) {

360  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

362 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

363 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aKey
) {

364  
m”geFrom
((
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
)
Ùh”
);

366 
	gsu³r
.
m”geFrom
(
Ùh”
);

367  
	gthis
;

371 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
Ùh”
) {

372 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
.
g‘DeçuÉIn¡ªû
()è 
this
;

373 ià(!
	gÙh”
.
g‘Key
().
isEm±y
()) {

374 
	gkey_
 = 
Ùh”
.
key_
;

375 
ÚChªged
();

377 
ÚChªged
();

378  
	gthis
;

381 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

382  
	gŒue
;

385 
public
 
Bud”
 
m”geFrom
(

386 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

387 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

388 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

389 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
	g·r£dMes§ge
 = 
nuÎ
;

390 
	gŒy
 {

391 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

392 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

393 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
è
e
.
g‘UnfšishedMes§ge
();

394 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

395 } 
	gfš®ly
 {

396 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

397 
m”geFrom
(
·r£dMes§ge
);

400  
	gthis
;

403 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gkey_
 = "";

407 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Key
() {

408 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
key_
;

409 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

410 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

411 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

412 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

413 
	gkey_
 = 
s
;

414  
	gs
;

416  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

422 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


423 
g‘KeyBy‹s
() {

424 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
key_
;

425 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

426 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

427 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

428 (
java
.
Ïng
.
SŒšg
è
»f
);

429 
	gkey_
 = 
b
;

430  
	gb
;

432  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

438 
public
 
Bud”
 
£tKey
(

439 
java
.
Ïng
.
SŒšg
 
v®ue
) {

440 ià(
	gv®ue
 =ğ
nuÎ
) {

441 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

444 
	gkey_
 = 
v®ue
;

445 
ÚChªged
();

446  
	gthis
;

451 
public
 
Bud”
 
ş—rKey
() {

453 
	gkey_
 = 
g‘DeçuÉIn¡ªû
().
g‘Key
();

454 
ÚChªged
();

455  
	gthis
;

460 
public
 
Bud”
 
£tKeyBy‹s
(

461 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

462 ià(
	gv®ue
 =ğ
nuÎ
) {

463 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

465 
checkBy‹SŒšgIsUtf8
(
v®ue
);

467 
	gkey_
 = 
v®ue
;

468 
ÚChªged
();

469  
	gthis
;

471 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

472 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

473  
	gthis
;

476 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

477 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

478  
	gthis
;

486 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
	gDEFAULT_INSTANCE
;

488 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
();

491 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
g‘DeçuÉIn¡ªû
() {

492  
	gDEFAULT_INSTANCE
;

495 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogR•liÿtiÚM‘ad©aKey
>

496 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LogR•liÿtiÚM‘ad©aKey
>() {

497 
public
 
LogR•liÿtiÚM‘ad©aKey
 
·r£P¬tŸlFrom
(

498 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

499 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

500 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

501  
Ãw
 
LogR•liÿtiÚM‘ad©aKey
(
šput
, 
ex‹nsiÚRegi¡ry
);

505 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogR•liÿtiÚM‘ad©aKey
> 
·r£r
() {

506  
	gPARSER
;

509 @
	gjava
.
	gÏng
.
Ov”ride


510 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogR•liÿtiÚM‘ad©aKey
> 
g‘P¬£rFÜTy³
() {

511  
	gPARSER
;

514 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aKey
 
g‘DeçuÉIn¡ªûFÜTy³
() {

515  
	gDEFAULT_INSTANCE
;

520 
public
 
š‹rçû
 
LogR•liÿtiÚM‘ad©aV®OrBud”
 
ex‹nds


522 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

527 
g‘V®
();

532 
public
 
fš®
 
şass
 
LogR•liÿtiÚM‘ad©aV®
 
ex‹nds


533 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


535 
	gLogR•liÿtiÚM‘ad©aV®OrBud”
 {

537 
´iv©e
 
LogR•liÿtiÚM‘ad©aV®
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

538 
su³r
(
bud”
);

540 
´iv©e
 
LogR•liÿtiÚM‘ad©aV®
() {

541 
	gv®_
 = 0L;

544 @
	gjava
.
	gÏng
.
Ov”ride


545 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


546 
g‘UnknownF›lds
() {

547  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

549 
´iv©e
 
LogR•liÿtiÚM‘ad©aV®
(

550 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

551 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

552 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

553 
this
();

554 
	gmubË_b™F›ld0_
 = 0;

555 
	gŒy
 {

556 
boŞ—n
 
	gdÚe
 = 
çl£
;

557 !
	gdÚe
) {

558 
	gg
 = 
šput
.
»adTag
();

559 
	gg
) {

561 
dÚe
 = 
Œue
;

564 ià(!
šput
.
skF›ld
(
g
)) {

565 
dÚe
 = 
Œue
;

571 
v®_
 = 
šput
.
»adUIÁ64
();

576 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

577 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

578 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

579 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

580 
e
).
£tUnfšishedMes§ge
(
this
);

581 } 
	gfš®ly
 {

582 
makeEx‹nsiÚsImmubË
();

585 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


586 
g‘DesütÜ
() {

587  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_desütÜ
;

590 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


591 
š‹º®G‘F›ldAcûssÜTabË
() {

592  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_f›ldAcûssÜTabË


593 .
’su»F›ldAcûssÜsIn™Ÿlized
(

594 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
.
şass
, org.cÜfudb.šäa¡ruùu».log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚWr™”M‘ad©a.LogR•liÿtiÚM‘ad©aV®.
Bud”
.class);

597 
public
 
fš®
 
	gVAL_FIELD_NUMBER
 = 1;

598 
´iv©e
 
	gv®_
;

602 
public
 
g‘V®
() {

603  
	gv®_
;

606 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

607 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

608 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

609 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

610 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

612 
	gmemoizedIsIn™Ÿlized
 = 1;

613  
	gŒue
;

616 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

617 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

618 ià(
	gv®_
 != 0L) {

619 
ouut
.
wr™eUIÁ64
(1, 
v®_
);

623 
public
 
g‘S”ŸlizedSize
() {

624 
	gsize
 = 
memoizedSize
;

625 ià(
	gsize
 !ğ-1è 
size
;

627 
	gsize
 = 0;

628 ià(
	gv®_
 != 0L) {

629 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


630 .
compu‹UIÁ64Size
(1, 
v®_
);

632 
	gmemoizedSize
 = 
size
;

633  
	gsize
;

636 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

637 @
	gjava
.
	gÏng
.
Ov”ride


638 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

639 ià(
	gobj
 =ğ
this
) {

640  
Œue
;

642 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aV®
)) {

643  
	gsu³r
.
equ®s
(
obj
);

645 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
	gÙh”
 = (
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.LogR•liÿtiÚM‘ad©aV®è
obj
;

647 
boŞ—n
 
	g»suÉ
 = 
Œue
;

648 
	g»suÉ
 = 
»suÉ
 && (
g‘V®
()

649 =ğ
Ùh”
.
g‘V®
());

650  
	g»suÉ
;

653 @
	gjava
.
	gÏng
.
Ov”ride


654 
public
 
hashCode
() {

655 ià(
	gmemoizedHashCode
 != 0) {

656  
memoizedHashCode
;

658 
	ghash
 = 41;

659 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

660 
	ghash
 = (37 * 
hash
è+ 
VAL_FIELD_NUMBER
;

661 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

662 
g‘V®
());

663 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

664 
	gmemoizedHashCode
 = 
hash
;

665  
	ghash
;

668 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(

669 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

670 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

671  
	gPARSER
.
·r£From
(
d©a
);

673 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(

674 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

675 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

676 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

677  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

679 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(
by‹
[] 
d©a
)

680 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

681  
	gPARSER
.
·r£From
(
d©a
);

683 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(

684 
by‹
[] 
d©a
,

685 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

686 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

687  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

689 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

690 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

691  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


692 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

694 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(

695 
java
.
io
.
IÅutSŒ—m
 
šput
,

696 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

697 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

698  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


699 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

701 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

702 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

703  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


704 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

706 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£D–im™edFrom
(

707 
java
.
io
.
IÅutSŒ—m
 
šput
,

708 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

709 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

710  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


711 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

713 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(

714 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

715 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

716  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


717 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

719 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
·r£From
(

720 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

721 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

722 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

723  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


724 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

727 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

728 
public
 
Bud”
 
ÃwBud”
() {

729  
	gDEFAULT_INSTANCE
.
toBud”
();

731 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
´ÙÙy³
) {

732  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

734 
public
 
Bud”
 
toBud”
() {

735  
	gthis
 =ğ
DEFAULT_INSTANCE


736 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

739 @
	gjava
.
	gÏng
.
Ov”ride


740 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

741 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

742 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

743  
	gbud”
;

748 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


749 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


751 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aV®OrBud”
 {

752 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


753 
g‘DesütÜ
() {

754  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_desütÜ
;

757 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


758 
š‹º®G‘F›ldAcûssÜTabË
() {

759  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_f›ldAcûssÜTabË


760 .
’su»F›ldAcûssÜsIn™Ÿlized
(

761 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
.
şass
, org.cÜfudb.šäa¡ruùu».log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚWr™”M‘ad©a.LogR•liÿtiÚM‘ad©aV®.
Bud”
.class);

765 
´iv©e
 
Bud”
() {

766 
maybeFÜûBud”In™Ÿliz©iÚ
();

769 
´iv©e
 
Bud”
(

770 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

771 
su³r
(
·»Á
);

772 
maybeFÜûBud”In™Ÿliz©iÚ
();

774 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

775 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


776 .
	g®waysU£F›ldBud”s
) {

779 
public
 
Bud”
 
ş—r
() {

780 
	gsu³r
.
ş—r
();

781 
	gv®_
 = 0L;

783  
	gthis
;

786 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


787 
g‘DesütÜFÜTy³
() {

788  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_desütÜ
;

791 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
g‘DeçuÉIn¡ªûFÜTy³
() {

792  
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aV®
.
g‘DeçuÉIn¡ªû
();

795 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
bud
() {

796 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
	g»suÉ
 = 
budP¬tŸl
();

797 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

798 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

800  
	g»suÉ
;

803 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
budP¬tŸl
() {

804 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.LogR•liÿtiÚM‘ad©aV®(
this
);

805 
	g»suÉ
.
	gv®_
 = 
v®_
;

806 
ÚBut
();

807  
	g»suÉ
;

810 
public
 
Bud”
 
şÚe
() {

811  (
	gBud”
è
	gsu³r
.
şÚe
();

813 
public
 
Bud”
 
£tF›ld
(

814 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

815 
Objeù
 
v®ue
) {

816  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

818 
public
 
Bud”
 
ş—rF›ld
(

819 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

820  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

822 
public
 
Bud”
 
ş—rOÃof
(

823 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

824  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

826 
public
 
Bud”
 
£tR•—‹dF›ld
(

827 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

828 
šdex
, 
Objeù
 
v®ue
) {

829  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

831 
public
 
Bud”
 
addR•—‹dF›ld
(

832 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

833 
Objeù
 
v®ue
) {

834  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

836 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

837 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
	gLogR•liÿtiÚM‘ad©aV®
) {

838  
m”geFrom
((
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
)
Ùh”
);

840 
	gsu³r
.
m”geFrom
(
Ùh”
);

841  
	gthis
;

845 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
Ùh”
) {

846 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
.
g‘DeçuÉIn¡ªû
()è 
this
;

847 ià(
	gÙh”
.
g‘V®
() != 0L) {

848 
£tV®
(
Ùh”
.
g‘V®
());

850 
ÚChªged
();

851  
	gthis
;

854 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

855  
	gŒue
;

858 
public
 
Bud”
 
m”geFrom
(

859 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

860 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

861 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

862 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
	g·r£dMes§ge
 = 
nuÎ
;

863 
	gŒy
 {

864 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

865 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

866 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
è
e
.
g‘UnfšishedMes§ge
();

867 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

868 } 
	gfš®ly
 {

869 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

870 
m”geFrom
(
·r£dMes§ge
);

873  
	gthis
;

876 
´iv©e
 
	gv®_
 ;

880 
public
 
g‘V®
() {

881  
	gv®_
;

886 
public
 
Bud”
 
£tV®
(
v®ue
) {

888 
	gv®_
 = 
v®ue
;

889 
ÚChªged
();

890  
	gthis
;

895 
public
 
Bud”
 
ş—rV®
() {

897 
	gv®_
 = 0L;

898 
ÚChªged
();

899  
	gthis
;

901 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

902 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

903  
	gthis
;

906 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

907 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

908  
	gthis
;

916 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
	gDEFAULT_INSTANCE
;

918 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
();

921 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
g‘DeçuÉIn¡ªû
() {

922  
	gDEFAULT_INSTANCE
;

925 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogR•liÿtiÚM‘ad©aV®
>

926 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LogR•liÿtiÚM‘ad©aV®
>() {

927 
public
 
LogR•liÿtiÚM‘ad©aV®
 
·r£P¬tŸlFrom
(

928 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

929 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

930 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

931  
Ãw
 
LogR•liÿtiÚM‘ad©aV®
(
šput
, 
ex‹nsiÚRegi¡ry
);

935 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogR•liÿtiÚM‘ad©aV®
> 
·r£r
() {

936  
	gPARSER
;

939 @
	gjava
.
	gÏng
.
Ov”ride


940 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogR•liÿtiÚM‘ad©aV®
> 
g‘P¬£rFÜTy³
() {

941  
	gPARSER
;

944 
public
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚWr™”M‘ad©a
.
LogR•liÿtiÚM‘ad©aV®
 
g‘DeçuÉIn¡ªûFÜTy³
() {

945  
	gDEFAULT_INSTANCE
;

950 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


951 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_desütÜ
;

952 
´iv©e
 
fš®


953 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


954 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_f›ldAcûssÜTabË
;

955 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


956 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_desütÜ
;

957 
´iv©e
 
fš®


958 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


959 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_f›ldAcûssÜTabË
;

961 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


962 
	$g‘DesütÜ
() {

963  
desütÜ
;

964 
	}
}

965 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


966 
	gdesütÜ
;

968 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

975 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

976 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

977 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

978 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

979 
desütÜ
 = 
roÙ
;

980  
	gnuÎ
;

983 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


984 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

985 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

986 }, 
assigÃr
);

987 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_desütÜ
 =

988 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

989 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_f›ldAcûssÜTabË
 = 
Ãw


990 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

991 
š‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aKey_desütÜ
,

992 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Key", });

993 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_desütÜ
 =

994 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

995 
	gš‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_f›ldAcûssÜTabË
 = 
Ãw


996 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

997 
š‹º®_¡©ic_Üg_cÜfudb_šäa¡ruùu»_log»¶iÿtiÚ_´Ùo_LogR•liÿtiÚM‘ad©aV®_desütÜ
,

998 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Val", });

	@it/src/main/java/org/corfudb/universe/UniverseAppUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
;

3 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

4 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

5 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

7 
public
 cÏs 
	cUniv”£AµUt
 {

14 
public
 
SŒšg
 
	$g‘AµV”siÚ
() {

15 
SŒšg
 
v”siÚ
 = 
Sy¡em
.
	`g‘Prİ”ty
("project.version");

16 ià(
v”siÚ
 !ğ
nuÎ
 && !v”siÚ.
	`isEm±y
()) {

17  
v”siÚ
;

20 
Œy
 {

21 
P©h
 
·th
 = 
P©hs
.
	`g‘
(
CÏssLßd”
.
	`g‘Sy¡emResourû
("cÜfu.v”siÚ").
	`toURI
());

22  
Ãw
 
	`SŒšg
(
Fes
.
	`»adAÎBy‹s
(
·th
));

23 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

24 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Corfu version file‚ot found");

27 
	}
}

	@it/src/main/java/org/corfudb/universe/UniverseManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
;

3 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDeçuÉDock”Cl›Á
;

4 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gexû±iÚs
.
	gDock”C”tifiÿ‹Exû±iÚ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gloggšg
.
	gLoggšgP¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gUniv”£Fixtu»
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gVmUniv”£Fixtu»
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
.
	gUniv”£Mode
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gdock”
.
	gDock”Univ”£
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	g´oûss
.
	gProûssUniv”£
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gAµlŸnûMªag”
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
;

25 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

30 @
Bud”


31 
public
 cÏs 
	cUniv”£Mªag”
 {

33 @
NÚNuÎ


34 
´iv©e
 
fš®
 
SŒšg
 
	mcÜfuS”v”V”siÚ
;

36 @
NÚNuÎ


37 
´iv©e
 
fš®
 
SŒšg
 
	m‹¡Name
;

39 @
	mDeçuÉ


40 @
G‘‹r


41 
´iv©e
 
fš®
 
Univ”£Mode
 
	muniv”£Mode
 = Univ”£Mode.
DOCKER
;

50 
	mpublic
 <
T
 
ex‹nds
 
	mFixtu»
<
	mUniv”£P¬ams
>> 
Univ”£WÜkæow
 
wÜkæow
(

51 
CÚsum”
<
Univ”£WÜkæow
<
T
>> 
aùiÚ
) {

53 
	mUniv”£WÜkæow
<
	mT
> 
	mwf
 = 
wÜkæow
();

54 
	mŒy
 {

55 
	maùiÚ
.
acû±
(
wf
);

56 } 
	mfš®ly
 {

57 
	mwf
.
shutdown
();

60  
	mwf
;

63 
	g´iv©e
 <
T
 
ex‹nds
 
	gFixtu»
<
	gUniv”£P¬ams
>> 
	gUniv”£WÜkæow
<
	gT
> 
	$wÜkæow
() {

65 
T
 
fixtu»
;

66 
univ”£Mode
) {

67 
DOCKER
:

68 
PROCESS
:

69 
fixtu»
 = 
CÏssUts
.
	`ÿ¡
(
Ãw
 
	`Univ”£Fixtu»
());

71 
VM
:

72 
fixtu»
 = 
CÏssUts
.
	`ÿ¡
(
Ãw
 
	`VmUniv”£Fixtu»
());

75 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("UÃx³ùed v®ue: " + 
univ”£Mode
);

78  
Univ”£WÜkæow
.<
T
>
	`bud”
()

79 .
	`cÜfuS”v”V”siÚ
(
cÜfuS”v”V”siÚ
)

80 .
	`univ”£Mode
(
univ”£Mode
)

81 .
	`‹¡Name
(
‹¡Name
)

82 .
	`fixtu»
(
fixtu»
)

83 .
	`bud
()

84 .
	`š™
();

85 
	}
}

97 @
	gSlf4j


98 @
	gBud”


99 @
G‘‹r


100 
public
 
şass
 
	gUniv”£WÜkæow
<
T
 
ex‹nds
 
	gFixtu»
<
	gUniv”£P¬ams
>> {

101 @
NÚNuÎ


102 
´iv©e
 
fš®
 
T
 
	gfixtu»
;

103 @
NÚNuÎ


104 
´iv©e
 
fš®
 
Univ”£Mode
 
	guniv”£Mode
;

105 @
NÚNuÎ


106 
´iv©e
 
SŒšg
 
	gcÜfuS”v”V”siÚ
;

108 @
NÚNuÎ


109 
´iv©e
 
fš®
 
SŒšg
 
	g‹¡Name
;

111 @
G‘‹r


112 
´iv©e
 
Univ”£
 
	guniv”£
;

114 
´iv©e
 
boŞ—n
 
	gš™Ÿlized
;

116 
public
 
	gUniv”£WÜkæow
<
	gT
> 
š™
() {

117 
	guniv”£Mode
) {

118 
	gDOCKER
:

119 
PROCESS
:

120 
Univ”£Fixtu»
 
dock”Fixtu»
 = 
CÏssUts
.
ÿ¡
(
this
.
fixtu»
);

121 
	gdock”Fixtu»
.
g‘Clu¡”
().
£rv”V”siÚ
(
cÜfuS”v”V”siÚ
);

123 
	gVM
:

124 
VmUniv”£Fixtu»
 
vmFixtu»
 = 
CÏssUts
.
ÿ¡
(
fixtu»
);

125 
	gvmFixtu»
.
g‘Clu¡”
().
£rv”V”siÚ
(
cÜfuS”v”V”siÚ
);

128 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("UÃx³ùed v®ue: " + 
univ”£Mode
);

131  
	gthis
;

134 
public
 
	gUniv”£WÜkæow
<
	gT
> 
š™Univ”£
() {

135 
	guniv”£Mode
) {

136 
	gDOCKER
:

137 
š™Dock”Univ”£
();

139 
	gVM
:

140 
š™VmUniv”£
();

142 
	gPROCESS
:

143 
š™ProûssUniv”£
();

146 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("UÃx³ùed v®ue: " + 
univ”£Mode
);

149 
	gš™Ÿlized
 = 
Œue
;

151  
	gthis
;

154 
public
 
	gUniv”£WÜkæow
<
	gT
> 
d•loy
() {

155 
š™Univ”£
();

157 
	guniv”£Mode
) {

158 
	gDOCKER
:

159 
d•loyDock”
();

161 
	gVM
:

162 
d•loyVm
();

164 
	gPROCESS
:

165 
d•loyProûss
();

168 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("UÃx³ùed v®ue: " + 
univ”£Mode
);

171  
	gthis
;

174 
public
 
	gUniv”£WÜkæow
<
	gT
> 
£tupDock”
(
CÚsum”
<
Univ”£Fixtu»
> 
fixtu»Mªag”
) {

175 ià(
	guniv”£Mode
 =ğ
Univ”£Mode
.
DOCKER
) {

176 
fixtu»Mªag”
.
acû±
(
CÏssUts
.
ÿ¡
(
fixtu»
));

179  
	gthis
;

182 
public
 
	gUniv”£WÜkæow
<
	gT
> 
£tupVm
(
CÚsum”
<
VmUniv”£Fixtu»
> 
fixtu»Mªag”
) {

183 ià(
	guniv”£Mode
 =ğ
Univ”£Mode
.
VM
) {

184 
fixtu»Mªag”
.
acû±
(
CÏssUts
.
ÿ¡
(
fixtu»
));

187  
	gthis
;

190 
public
 
	gUniv”£WÜkæow
<
	gT
> 
£tupProûss
(
CÚsum”
<
Univ”£Fixtu»
> 
fixtu»Mªag”
) {

191 ià(
	guniv”£Mode
 =ğ
Univ”£Mode
.
PROCESS
) {

192 
fixtu»Mªag”
.
acû±
(
CÏssUts
.
ÿ¡
(
fixtu»
));

195  
	gthis
;

198 
´iv©e
 
	gUniv”£WÜkæow
<
	gT
> 
d•loyVm
() {

199 
checkMode
(
Univ”£Mode
.
VM
);

201 
	guniv”£
.
d•loy
();

203  
	gthis
;

206 
´iv©e
 
š™VmUniv”£
() {

207 
checkMode
(
Univ”£Mode
.
VM
);

209 ià(
	gš™Ÿlized
) {

210 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Can't initializehe universewice");

213 
VmUniv”£P¬ams
 
	guniv”£P¬ams
 = 
CÏssUts
.
ÿ¡
(
fixtu»
.
d©a
());

215 
AµlŸnûMªag”
 
	gmªag”
 = AµlŸnûMªag”.
bud”
()

216 .
univ”£P¬ams
(universeParams)

217 .
bud
();

220 
	guniv”£
 = 
VmUniv”£
.
bud”
()

221 .
univ”£P¬ams
(universeParams)

222 .
­¶ŸnûMªag”
(
mªag”
)

223 .
bud
();

226 
´iv©e
 
	gUniv”£WÜkæow
<
	gT
> 
d•loyDock”
() {

228 
checkMode
(
Univ”£Mode
.
DOCKER
);

230 
	guniv”£
.
d•loy
();

232  
	gthis
;

235 
´iv©e
 
	gUniv”£WÜkæow
<
	gT
> 
š™Dock”Univ”£
() {

236 
checkMode
(
Univ”£Mode
.
DOCKER
);

238 ià(
	gš™Ÿlized
) {

239 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Can't initializehe universewice");

242 
DeçuÉDock”Cl›Á
 
	gdock”
;

243 
	gŒy
 {

244 
	gdock”
 = 
DeçuÉDock”Cl›Á
.
äomEnv
().
bud
();

245 } 
ÿtch
 (
Dock”C”tifiÿ‹Exû±iÚ
 
e
) {

246 
throw
 
Ãw
 
Univ”£Exû±iÚ
("Can't initialize docker client");

249 
Univ”£Fixtu»
 
	gdock”Fixtu»
 = 
CÏssUts
.
ÿ¡
(
fixtu»
);

250 
LoggšgP¬ams
 
	gloggšgP¬ams
 = 
dock”Fixtu»


251 .
g‘Loggšg
()

252 .
‹¡Name
(testName)

253 .
bud
();

255 
	guniv”£
 = 
Dock”Univ”£
.
bud”
()

256 .
univ”£P¬ams
(
dock”Fixtu»
.
d©a
())

257 .
loggšgP¬ams
(loggingParams)

258 .
dock”
(docker)

259 .
bud
();

261  
	gthis
;

264 
´iv©e
 
	gUniv”£WÜkæow
<
	gT
> 
d•loyProûss
() {

265 
checkMode
(
Univ”£Mode
.
PROCESS
);

267 
	guniv”£
.
d•loy
();

269  
	gthis
;

272 
´iv©e
 
	gUniv”£WÜkæow
<
	gT
> 
š™ProûssUniv”£
() {

273 
checkMode
(
Univ”£Mode
.
PROCESS
);

275 ià(
	gš™Ÿlized
) {

276 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Can't initializehe universewice");

280 
	guniv”£
 = 
ProûssUniv”£
.
bud”
()

281 .
univ”£P¬ams
(
fixtu»
.
d©a
())

282 .
bud
();

284  
	gthis
;

287 
public
 
shutdown
() {

288 ià(
	guniv”£
 !ğ
nuÎ
) {

289 
univ”£
.
shutdown
();

291 
SŒšg
 
	g”r
 = "The universe is‚ull, can't shutdownheest…roperly.";

292 
	glog
.
”rÜ
(
”r
);

296 
´iv©e
 
checkMode
(
Univ”£Mode
 
ex³ùed
) {

297 ià(
	guniv”£Mode
 !ğ
ex³ùed
) {

298 
SŒšg
 
”r
 = "Inv®id mode: " + 
univ”£Mode
 + ". Ex³ùed mode: " + 
ex³ùed
;

299 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
”r
);

	@it/src/main/java/org/corfudb/universe/group/Group.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dM­
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gClu¡”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

12 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

24 
public
 
š‹rçû
 
	gGroup
<
T
 
ex‹nds
 
	gNode
, 
G
ƒx‹nd Group.
	gGroupP¬ams
> {

31 
Group
 
d•loy
();

39 
¡İ
(
Du¿tiÚ
 
timeout
);

45 
kl
();

52 
de¡roy
();

54 
Node
 
add
(
NodeP¬ams
 
nodeP¬ams
);

61 
G
 
g‘P¬ams
();

68 
	gImmubËSÜ‹dM­
<
	gSŒšg
, 
	gT
> 
nodes
();

70 
š‹rçû
 
	gGroupP¬ams
<
T
 
ex‹nds
 
	gNodeP¬ams
> {

71 
SŒšg
 
g‘Name
();

73 
	gClu¡”
.
Clu¡”Ty³
 
g‘Ty³
();

75 
	gImmubËSÜ‹dS‘
<
	gT
> 
g‘NodesP¬ams
();

77 
	gGroupP¬ams
<
	gT
> 
add
(
T
 
nodeP¬ams
);

79 
SŒšg
 
g‘FuÎNodeName
(SŒšg 
nodeName
);

	@it/src/main/java/org/corfudb/universe/group/cluster/AbstractCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

20 @
Slf4j


21 
public
 
ab¡¿ù
 
şass
 
	gAb¡¿ùClu¡”
<

22 
T
 
ex‹nds
 
	gNode
,

23 
N
 
ex‹nds
 
	gNodeP¬ams
,

24 
P
 
ex‹nds
 
	gGroupP¬ams
<
	gN
>,

25 
U
 
ex‹nds
 
	gUniv”£P¬ams
> 
im¶em’ts
 
	gClu¡”
<
	gT
, 
	gP
> {

27 @
	gG‘‹r


28 @
NÚNuÎ


29 
´Ùeùed
 
fš®
 
P
 
	g·¿ms
;

31 @
NÚNuÎ


32 
´Ùeùed
 
fš®
 
U
 
	guniv”£P¬ams
;

34 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	gexecutÜ
;

36 
´Ùeùed
 
Ab¡¿ùClu¡”
(
P
 
·¿ms
, 
U
 
univ”£P¬ams
) {

37 
	gthis
.
	g·¿ms
 = 
·¿ms
;

38 
	gthis
.
	guniv”£P¬ams
 = 
univ”£P¬ams
;

39 
	gthis
.
	gexecutÜ
 = 
ExecutÜs
.
ÃwCachedTh»adPoŞ
();

42 
´Ùeùed
 
	gCom¶‘abËFutu»
<
	gNode
> 
d•loyAsync
(
Node
 
£rv”
) {

43  
	gCom¶‘abËFutu»
.
suµlyAsync
(
£rv”
::
d•loy
, 
executÜ
);

46 
´Ùeùed
 
ab¡¿ù
 
Node
 
budS”v”
(
N
 
nodeP¬ams
);

53 @
Ov”ride


54 
public
 
¡İ
(
Du¿tiÚ
 
timeout
) {

55 
	glog
.
šfo
("Stİ cÜfu clu¡”: {}", 
·¿ms
.
g‘Name
());

57 
nodes
().
v®ues
().
fÜEach
(
node
 -> {

58 
Œy
 {

59 
node
.
¡İ
(
timeout
);

60 } 
ÿtch
 (
Exû±iÚ
 
e
) {

61 
log
.
w¬n
("Cª'ˆ¡İ‚ode: {} iÀgroup: {}", 
node
.
g‘P¬ams
().
g‘Name
(), g‘P¬ams().g‘Name(), 
e
);

69 @
Ov”ride


70 
public
 
kl
() {

71 
nodes
().
v®ues
().
fÜEach
(
node
 -> {

72 
Œy
 {

73 
node
.
kl
();

74 } 
ÿtch
 (
Exû±iÚ
 
e
) {

75 
log
.
w¬n
("Cª'ˆkÈnode: {} iÀgroup: {}", 
node
.
g‘P¬ams
().
g‘Name
(), g‘P¬ams().g‘Name(), 
e
);

80 @
Ov”ride


81 
public
 
de¡roy
() {

82 
	glog
.
šfo
("De¡roy group: {}", 
·¿ms
.
g‘Name
());

84 
nodes
().
v®ues
().
fÜEach
(
node
 -> {

85 
Œy
 {

86 
node
.
de¡roy
();

87 } 
ÿtch
 (
NodeExû±iÚ
 
e
) {

88 
log
.
w¬n
("Cª'ˆde¡roy‚ode: {} iÀgroup: {}", 
node
.
g‘P¬ams
().
g‘Name
(), g‘P¬ams().g‘Name(), 
e
);

93 @
Ov”ride


94 
public
 
Node
 
add
(
NodeP¬ams
 
nodeP¬ams
) {

95 
N
 
	gcÜfuS”v”P¬ams
 = 
CÏssUts
.
ÿ¡
(
nodeP¬ams
);

96 
	g·¿ms
.
add
(
cÜfuS”v”P¬ams
);

98  
d•loyAsync
(
budS”v”
(
cÜfuS”v”P¬ams
)).
još
();

	@it/src/main/java/org/corfudb/universe/group/cluster/AbstractCorfuCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gLoÿlCÜfuCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tNavigabËM­
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tSkLi¡M­
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

21 @
Slf4j


22 
public
 
ab¡¿ù
 
şass
 
	gAb¡¿ùCÜfuClu¡”
<
P
 
ex‹nds
 
	gCÜfuS”v”P¬ams
, 
U
ƒx‹nd 
	gUniv”£P¬ams
>

23 
ex‹nds
 
	gAb¡¿ùClu¡”
<
	gCÜfuS”v”
, 
	gP
, 
	gCÜfuClu¡”P¬ams
<P>, 
	gU
>

24 
im¶em’ts
 
	gCÜfuClu¡”
<
	gCÜfuS”v”
, 
	gCÜfuClu¡”P¬ams
<
	gP
>> {

26 
´iv©e
 
fš®
 
	gCÚcu¼’tNavigabËM­
<
	gSŒšg
, 
	gCÜfuS”v”
> 
	gnodes
 = 
Ãw
 
CÚcu¼’tSkLi¡M­
<>();

28 
public
 
Ab¡¿ùCÜfuClu¡”
(
CÜfuClu¡”P¬ams
<
P
> 
·¿ms
, 
U
 
univ”£P¬ams
) {

29 
su³r
(
·¿ms
, 
univ”£P¬ams
);

32 
´Ùeùed
 
š™
() {

33 
	g·¿ms
.
g‘NodesP¬ams
().
fÜEach
(
£rv”P¬ams
 -> {

34 
CÜfuS”v”
 
£rv”
 = (CÜfuS”v”è
budS”v”
(
£rv”P¬ams
);

35 
nodes
.
put
(
£rv”
.
g‘Endpošt
(), server);

46 @
Ov”ride


47 
public
 
	gAb¡¿ùCÜfuClu¡”
<
	gP
, 
	gU
> 
d•loy
() {

48 
	glog
.
šfo
("D•loy cÜfu clu¡”. P¬ams: {}", 
·¿ms
);

50 
	gLi¡
<
	gCom¶‘abËFutu»
<
	gNode
>> 
	gasyncD•loym’t
 = 
nodes
.
v®ues
().
¡»am
()

51 .
m­
(
this
::
d•loyAsync
)

52 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

54 
	gasyncD•loym’t
.
¡»am
()

55 .
m­
(
Com¶‘abËFutu»
::
još
)

56 .
fÜEach
(
£rv”
 ->

57 
log
.
debug
("CÜfu s”v” wa d•loyed: {}", 
£rv”
.
g‘P¬ams
().
g‘Name
())

60 
	gŒy
 {

61 
boÙ¡¿p
();

62 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

63 
throw
 
Ãw
 
Univ”£Exû±iÚ
("Cª'ˆd•loy cÜfu clu¡”: " + 
·¿ms
.
g‘Name
(), 
ex
);

66  
	gthis
;

69 @
Ov”ride


70 
public
 
LoÿlCÜfuCl›Á
 
g‘LoÿlCÜfuCl›Á
() {

71  
	gLoÿlCÜfuCl›Á
.
bud”
()

72 .
£rv”Endpošts
(
g‘Clu¡”LayoutS”v”s
())

73 .
´om‘heusM‘ricsPÜt
(
O±iÚ®
.
em±y
())

74 .
bud
()

75 .
d•loy
();

78 @
Ov”ride


79 
public
 
LoÿlCÜfuCl›Á
 
g‘LoÿlCÜfuCl›Á
(
m‘ricsPÜt
) {

80  
	gLoÿlCÜfuCl›Á
.
bud”
()

81 .
´om‘heusM‘ricsPÜt
(
O±iÚ®
.
of
(
m‘ricsPÜt
))

82 .
£rv”Endpošts
(
g‘Clu¡”LayoutS”v”s
())

83 .
bud
()

84 .
d•loy
();

87 
´Ùeùed
 
ab¡¿ù
 
	gImmubËSÜ‹dS‘
<
	gSŒšg
> 
g‘Clu¡”LayoutS”v”s
();

89 @
Ov”ride


90 
public
 
	gImmubËSÜ‹dM­
<
	gSŒšg
, 
	gCÜfuS”v”
> 
nodes
() {

91  
	gImmubËSÜ‹dM­
.
cİyOf
(
nodes
);

	@it/src/main/java/org/corfudb/universe/group/cluster/AbstractSupportCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dM­
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”P¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gdock”
.
	gDock”SuµÜtS”v”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tNavigabËM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tSkLi¡M­
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

22 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

24 @
Slf4j


25 
public
 
ab¡¿ù
 
şass
 
Ab¡¿ùSuµÜtClu¡”
 
ex‹nds


26 
	gAb¡¿ùClu¡”
<
	gSuµÜtS”v”
, 
	gSuµÜtS”v”P¬ams
, 
	gSuµÜtClu¡”P¬ams
, 
	gUniv”£P¬ams
> {

28 @
DeçuÉ


29 
´iv©e
 
fš®
 
	gCÚcu¼’tNavigabËM­
<
	gSŒšg
, 
	gSuµÜtS”v”
> 
	gnodes
 =

30 
Ãw
 
CÚcu¼’tSkLi¡M­
<>();

32 @
NÚNuÎ


33 
´iv©e
 
fš®
 
SuµÜtClu¡”P¬ams
 
	gşu¡”P¬ams
;

35 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	gexecutÜ
;

37 
´Ùeùed
 
Ab¡¿ùSuµÜtClu¡”
(

38 
Univ”£P¬ams
 
univ”£P¬ams
, 
SuµÜtClu¡”P¬ams
 
mÚ™ÜšgP¬ams
) {

40 
su³r
(
mÚ™ÜšgP¬ams
, 
univ”£P¬ams
);

41 
	gthis
.
	gşu¡”P¬ams
 = 
mÚ™ÜšgP¬ams
;

42 
	gthis
.
	gexecutÜ
 = 
ExecutÜs
.
ÃwCachedTh»adPoŞ
();

52 @
Ov”ride


53 
public
 
Ab¡¿ùSuµÜtClu¡”
 
d•loy
() {

54 
	glog
.
šfo
("D•loy mÚ™Üšg clu¡”. P¬ams: {}", 
şu¡”P¬ams
);

56 
	gLi¡
<
	gCom¶‘abËFutu»
<
	gNode
>> 
	gasyncMÚD•loym’t
 = 
şu¡”P¬ams


57 .
g‘NodesP¬ams
()

58 .
¡»am
()

59 .
m­
(
£rv”P¬ams
 -> {

60 
Dock”SuµÜtS”v”
 
£rv”
 = (Dock”SuµÜtS”v”è
budS”v”
(
£rv”P¬ams
);

61 
nodes
.
put
(
£rv”
.
g‘P¬ams
().
g‘Name
(), server);

62  
£rv”
;

64 .
m­
(
this
::
d•loyMÚ™ÜšgS”v”Async
)

65 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

67 
	gasyncMÚD•loym’t
.
¡»am
()

68 .
m­
(
Com¶‘abËFutu»
::
još
)

69 .
fÜEach
(
£rv”
 -> 
log
.
debug
("Corfu server was deployed: {}",

70 
£rv”
.
g‘P¬ams
().
g‘Name
()));

72 
	gŒy
 {

73 
boÙ¡¿p
();

74 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

75 
throw
 
Ãw
 
Univ”£Exû±iÚ
("Cª'ˆd•loy clu¡”: " + 
şu¡”P¬ams
.
g‘Name
(), 
ex
);

78  
	gthis
;

81 
´iv©e
 
	gCom¶‘abËFutu»
<
	gNode
> 
d•loyMÚ™ÜšgS”v”Async
(
Node
 
mÚ™ÜšgS”v”
) {

82  
	gCom¶‘abËFutu»
.
suµlyAsync
(
mÚ™ÜšgS”v”
::
d•loy
, 
executÜ
);

86 @
Ov”ride


87 
public
 
	gImmubËSÜ‹dM­
<
	gSŒšg
, 
	gSuµÜtS”v”
> 
nodes
() {

88  
	gImmubËSÜ‹dM­
.
cİyOf
(
nodes
);

	@it/src/main/java/org/corfudb/universe/group/cluster/Cluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

7 
public
 
š‹rçû
 
	gClu¡”
<
T
 
ex‹nds
 
	gNode
, 
G
ƒx‹nd 
	gGroupP¬ams
>ƒx‹nd 
	gGroup
<
	gT
, 
	gG
> {

12 
boÙ¡¿p
();

14 
	eClu¡”Ty³
 {

15 
	gCORFU_CLUSTER
, 
	gSUPPORT_CLUSTER


	@it/src/main/java/org/corfudb/universe/group/cluster/CorfuCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gLoÿlCÜfuCl›Á
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

12 
public
 
š‹rçû
 
	gCÜfuClu¡”
<
T
 
ex‹nds
 
	gNode
, 
G
ƒx‹nd 
	gGroupP¬ams
>ƒx‹nd 
	gClu¡”
<
	gT
, 
	gG
> {

19 
LoÿlCÜfuCl›Á
 
g‘LoÿlCÜfuCl›Á
();

26 
LoÿlCÜfuCl›Á
 
g‘LoÿlCÜfuCl›Á
(
m‘ricsPÜt
);

37  
CÜfuS”v”
 
g‘S”v”ByIndex
(
šdex
) {

38  
nodes
()

39 .
v®ues
()

40 .
¡»am
()

41 .
sk
(
šdex
)

42 .
fšdFœ¡
()

43 .
m­
(
CÜfuS”v”
.
şass
::
ÿ¡
)

44 .
ÜEl£Throw
((è-> 
Ãw
 
NodeExû±iÚ
("CÜfu s”v”‚Ù found by index: " + 
šdex
));

54  
CÜfuS”v”
 
g‘Fœ¡S”v”
() {

55  
g‘S”v”ByIndex
(0);

	@it/src/main/java/org/corfudb/universe/group/cluster/CorfuClusterParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gToSŒšg
;

10 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gÏng3
.
	gRªdomSŒšgUts
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gClu¡”
.
	gClu¡”Ty³
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

17 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

22 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

24 @
	gBud”


25 @
	gEqu®sAndHashCode


26 @
ToSŒšg


27 
public
 
şass
 
	gCÜfuClu¡”P¬ams
<
T
 
ex‹nds
 
	gCÜfuS”v”P¬ams
> 
im¶em’ts
 
	gGroupP¬ams
<
	gT
> {

29 @
	gG‘‹r


30 @
	gDeçuÉ


31 @
NÚNuÎ


32 
´iv©e
 
SŒšg
 
	gÇme
 = 
RªdomSŒšgUts
.
¿ndomAÍhab‘ic
(6).
toLow”Ca£
();

34 @
	gDeçuÉ


35 @
G‘‹r


36 
´iv©e
 
fš®
 
	gnumNodes
 = 3;

41 @
	gNÚNuÎ


42 @
G‘‹r


43 
´iv©e
 
fš®
 
SŒšg
 
	g£rv”V”siÚ
;

45 @
	gDeçuÉ


46 @
NÚNuÎ


47 
´iv©e
 
fš®
 
	gSÜ‹dS‘
<
	gT
> 
	gnodes
 = 
Ãw
 
T»eS‘
<>();

49 @
	gG‘‹r


50 @
	gDeçuÉ


51 @
NÚNuÎ


52 
´iv©e
 
fš®
 
NodeTy³
 
	gnodeTy³
 = NodeTy³.
CORFU_SERVER
;

54 @
	gDeçuÉ


55 @
G‘‹r


56 
´iv©e
 
fš®
 
	gboÙSŒ­R‘r›s
 = 20;

58 @
	gDeçuÉ


59 @
	gG‘‹r


60 @
NÚNuÎ


61 
´iv©e
 
fš®
 
Du¿tiÚ
 
	g»ŒyDu¿tiÚ
 = Du¿tiÚ.
ofSecÚds
(3);

63 @
Ov”ride


64 
public
 
Clu¡”Ty³
 
g‘Ty³
() {

65  
	gClu¡”Ty³
.
	gCORFU_CLUSTER
;

68 @
Ov”ride


69 
public
 
	gImmubËSÜ‹dS‘
<
	gT
> 
g‘NodesP¬ams
() {

70  
	gImmubËSÜ‹dS‘
.
cİyOf
(
nodes
);

73 
public
 
synchrÚized
 
T
 
g‘Node
(
SŒšg
 
£rv”Name
) {

74 
	gM­
<
	gSŒšg
, 
	gT
> 
	gnodesM­
 = 
nodes


75 .
¡»am
()

76 .
cŞËù
(
CŞËùÜs
.
toM­
(
CÜfuS”v”P¬ams
::
g‘Name
, 
n
 ->‚));

78  
	gnodesM­
.
g‘
(
£rv”Name
);

81 @
Ov”ride


82 
public
 
synchrÚized
 
	gCÜfuClu¡”P¬ams
<
	gT
> 
add
(
T
 
nodeP¬ams
) {

83 
	gnodes
.
add
(
CÏssUts
.
ÿ¡
(
nodeP¬ams
));

84  
	gthis
;

87 
public
 
SŒšg
 
g‘FuÎNodeName
(SŒšg 
nodeName
) {

88  
	gÇme
 + "-cÜfu-" + 
	gnodeName
;

91 
public
 
size
() {

92  
g‘NodesP¬ams
().
size
();

95 
public
 
	gLi¡
<
	gSŒšg
> 
g‘Clu¡”Nodes
() {

96  
g‘NodesP¬ams
().
¡»am
()

97 .
m­
(
CÜfuS”v”P¬ams
::
g‘Name
)

98 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

	@it/src/main/java/org/corfudb/universe/group/cluster/SupportClusterParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gToSŒšg
;

10 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gÏng3
.
	gRªdomSŒšgUts
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gClu¡”
.
	gClu¡”Ty³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”P¬ams
;

15 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dS‘
;

16 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

18 @
	gBud”


19 @
	gEqu®sAndHashCode


20 @
ToSŒšg


21 
public
 
şass
 
SuµÜtClu¡”P¬ams
 
im¶em’ts
 
	gGroupP¬ams
<
	gSuµÜtS”v”P¬ams
> {

23 @
	gG‘‹r


24 @
	gDeçuÉ


25 @
NÚNuÎ


26 
´iv©e
 
fš®
 
SŒšg
 
	gÇme
 = 
RªdomSŒšgUts
.
¿ndomAÍhab‘ic
(6).
toLow”Ca£
();

28 @
	gDeçuÉ


29 @
NÚNuÎ


30 
´iv©e
 
fš®
 
	gSÜ‹dS‘
<
	gSuµÜtS”v”P¬ams
> 
	gnodes
 = 
Ãw
 
T»eS‘
<>();

32 @
Ov”ride


33 
public
 
Clu¡”Ty³
 
g‘Ty³
() {

34  
	gClu¡”Ty³
.
	gSUPPORT_CLUSTER
;

37 @
Ov”ride


38 
public
 
	gImmubËSÜ‹dS‘
<
	gSuµÜtS”v”P¬ams
> 
g‘NodesP¬ams
() {

39  
	gImmubËSÜ‹dS‘
.
cİyOf
(
nodes
);

42 @
Ov”ride


43 
public
 
	gGroupP¬ams
<
	gSuµÜtS”v”P¬ams
> 
add
(
SuµÜtS”v”P¬ams
 
nodeP¬ams
) {

44 
	gnodes
.
add
(
nodeP¬ams
);

45  
	gthis
;

48 
public
 
SŒšg
 
g‘FuÎNodeName
(SŒšg 
nodeName
) {

49  
	gÇme
 + "-suµÜt-" + 
	gnodeName
;

	@it/src/main/java/org/corfudb/universe/group/cluster/docker/DockerCorfuCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gdock”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

4 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gBoÙ¡¿pUt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gAb¡¿ùCÜfuClu¡”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gloggšg
.
	gLoggšgP¬ams
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gdock”
.
	gDock”CÜfuS”v”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gDock”Mªag”
;

22 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

25 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

30 @
Slf4j


31 
public
 
şass
 
Dock”CÜfuClu¡”
 
ex‹nds
 
	gAb¡¿ùCÜfuClu¡”
<
	gCÜfuS”v”P¬ams
, 
	gUniv”£P¬ams
> {

33 @
NÚNuÎ


34 
´iv©e
 
fš®
 
Dock”Cl›Á
 
	gdock”
;

35 @
NÚNuÎ


36 
´iv©e
 
fš®
 
LoggšgP¬ams
 
	gloggšgP¬ams
;

37 @
NÚNuÎ


38 
´iv©e
 
fš®
 
Dock”Mªag”
 
	gdock”Mªag”
;

40 @
Bud”


41 
public
 
Dock”CÜfuClu¡”
(
Dock”Cl›Á
 
dock”
, 
CÜfuClu¡”P¬ams
<
CÜfuS”v”P¬ams
> 
·¿ms
,

42 
Univ”£P¬ams
 
univ”£P¬ams
, 
LoggšgP¬ams
 
loggšgP¬ams
) {

43 
su³r
(
·¿ms
, 
univ”£P¬ams
);

44 
	gthis
.
	gdock”
 = 
dock”
;

45 
	gthis
.
	gloggšgP¬ams
 = 
loggšgP¬ams
;

46 
	gthis
.
	gdock”Mªag”
 = 
Dock”Mªag”
.
bud”
().
dock”
(dock”).
bud
();

48 
š™
();

51 @
Ov”ride


52 
´Ùeùed
 
Node
 
budS”v”
(
CÜfuS”v”P¬ams
 
nodeP¬ams
) {

53  
	gDock”CÜfuS”v”
.
bud”
()

54 .
univ”£P¬ams
(universeParams)

55 .
şu¡”P¬ams
(
·¿ms
)

56 .
·¿ms
(
nodeP¬ams
)

57 .
loggšgP¬ams
(loggingParams)

58 .
dock”
(docker)

59 .
dock”Mªag”
(dockerManager)

60 .
bud
();

63 @
Ov”ride


64 
´Ùeùed
 
	gImmubËSÜ‹dS‘
<
	gSŒšg
> 
g‘Clu¡”LayoutS”v”s
() {

65 
	gLi¡
<
	gSŒšg
> 
	g£rv”s
 = 
nodes
()

66 .
v®ues
()

67 .
¡»am
()

68 .
m­
(
CÜfuS”v”
::
g‘Endpošt
)

69 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

71  
	gImmubËSÜ‹dS‘
.
cİyOf
(
£rv”s
);

74 @
Ov”ride


75 
public
 
boÙ¡¿p
() {

76 
Layout
 
	gÏyout
 = 
g‘Layout
();

77 
	glog
.
šfo
("BoÙ¡¿°dock” cÜfu clu¡”. Clu¡”: {}.†ayout: {}", 
·¿ms
.
g‘Name
(), 
Ïyout
.
asJSONSŒšg
());

79 
	gBoÙ¡¿pUt
.
boÙ¡¿p
(
Ïyout
, 
·¿ms
.
g‘BoÙSŒ­R‘r›s
(),…¬ams.
g‘R‘ryDu¿tiÚ
());

82 
´iv©e
 
Layout
 
g‘Layout
() {

83 
	g•och
 = 0;

84 
UUID
 
	gşu¡”Id
 = UUID.
¿ndomUUID
();

85 
	gLi¡
<
	gSŒšg
> 
	g£rv”s
 = 
g‘Clu¡”LayoutS”v”s
().
asLi¡
();

87 
LayoutSegm’t
 
	g£gm’t
 = 
Ãw
 LayoutSegment(

88 
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
,

91 
CŞËùiÚs
.
sšgËtÚLi¡
(
Ãw
 
Layout
.
LayoutSŒe
(
£rv”s
))

93  
Ãw
 
Layout
(
£rv”s
, s”v”s, 
CŞËùiÚs
.
sšgËtÚLi¡
(
£gm’t
), 
•och
, 
şu¡”Id
);

	@it/src/main/java/org/corfudb/universe/group/cluster/docker/DockerSupportCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gdock”
;

3 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gAb¡¿ùSuµÜtClu¡”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gSuµÜtClu¡”P¬ams
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”P¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gdock”
.
	gDock”SuµÜtS”v”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gDock”Mªag”
;

19 @
Slf4j


20 
public
 cÏs 
	cDock”SuµÜtClu¡”
 
ex‹nds
 
	mAb¡¿ùSuµÜtClu¡”
 {

21 @
NÚNuÎ


22 
´iv©e
 
fš®
 
Dock”Cl›Á
 
	mdock”
;

23 @
NÚNuÎ


24 
´iv©e
 
fš®
 
Dock”Mªag”
 
	mdock”Mªag”
;

26 @
Bud”


27 
public
 
	$Dock”SuµÜtClu¡”
(
Dock”Cl›Á
 
dock”
, 
SuµÜtClu¡”P¬ams
 
suµÜtP¬ams
,

28 
Univ”£P¬ams
 
univ”£P¬ams
) {

29 
	`su³r
(
univ”£P¬ams
, 
suµÜtP¬ams
);

30 
this
.
dock”
 = docker;

31 
this
.
dock”Mªag”
 = 
Dock”Mªag”
.
	`bud”
().
	`dock”
(
dock”
).
	`bud
();

34 @
Ov”ride


35 
public
 
	$boÙ¡¿p
() {

37 
	}
}

39 @
Ov”ride


40 
´Ùeùed
 
Node
 
	$budS”v”
(
SuµÜtS”v”P¬ams
 
nodeP¬ams
) {

41  
Dock”SuµÜtS”v”
.
	`bud”
()

42 .
	`univ”£P¬ams
(
univ”£P¬ams
)

43 .
	`şu¡”P¬ams
(
·¿ms
)

44 .
	`·¿ms
(
nodeP¬ams
)

45 .
	`dock”
(
dock”
)

46 .
	`dock”Mªag”
(
dock”Mªag”
)

47 .
	`bud
();

48 
	}
}

	@it/src/main/java/org/corfudb/universe/group/cluster/process/ProcessCorfuCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	g´oûss
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gBoÙ¡¿pUt
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gAb¡¿ùCÜfuClu¡”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	g´oûss
.
	gProûssCÜfuS”v”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

22 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

27 @
Slf4j


28 
public
 
şass
 
ProûssCÜfuClu¡”
 
ex‹nds
 
	gAb¡¿ùCÜfuClu¡”
<
	gCÜfuS”v”P¬ams
, 
	gUniv”£P¬ams
> {

30 @
Bud”


31 
´Ùeùed
 
ProûssCÜfuClu¡”
(

32 
CÜfuClu¡”P¬ams
<
CÜfuS”v”P¬ams
> 
cÜfuClu¡”P¬ams
, 
Univ”£P¬ams
 
univ”£P¬ams
) {

33 
su³r
(
cÜfuClu¡”P¬ams
, 
univ”£P¬ams
);

35 
š™
();

44 @
Ov”ride


45 
´Ùeùed
 
Node
 
budS”v”
(
CÜfuS”v”P¬ams
 
nodeP¬ams
) {

46 
	glog
.
šfo
("D•loy cÜfu s”v”: {}", 
nodeP¬ams
);

47 
CÜfuS”v”P¬ams
 
	g·¿ms
 = 
g‘S”v”P¬ams
(
nodeP¬ams
);

49  
	gProûssCÜfuS”v”
.
bud”
()

50 .
univ”£P¬ams
(universeParams)

51 .
·¿ms
(params)

52 .
bud
();

55 @
Ov”ride


56 
´Ùeùed
 
	gImmubËSÜ‹dS‘
<
	gSŒšg
> 
g‘Clu¡”LayoutS”v”s
() {

57  
	gImmubËSÜ‹dS‘
.
cİyOf
(
budLayout
().
g‘LayoutS”v”s
());

60 @
Ov”ride


61 
public
 
boÙ¡¿p
() {

62 
Layout
 
	gÏyout
 = 
budLayout
();

63 
	glog
.
šfo
("BoÙ¡¿°cÜfu clu¡”. Clu¡”: {}.†ayout: {}", 
·¿ms
.
g‘Name
(), 
Ïyout
.
asJSONSŒšg
());

65 
	gBoÙ¡¿pUt
.
boÙ¡¿p
(
Ïyout
, 
·¿ms
.
g‘BoÙSŒ­R‘r›s
(),…¬ams.
g‘R‘ryDu¿tiÚ
());

71 
´iv©e
 
Layout
 
budLayout
() {

72 
	g•och
 = 0;

73 
UUID
 
	gşu¡”Id
 = UUID.
¿ndomUUID
();

75 
	gLi¡
<
	gSŒšg
> 
	g£rv”s
 = 
·¿ms
.
g‘NodesP¬ams
()

76 .
¡»am
()

77 .
m­
(
·¿ms
 -> "127.0.0.1:" +…¬ams.
g‘PÜt
())

78 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

80 
LayoutSegm’t
 
	g£gm’t
 = 
Ãw
 LayoutSegment(

81 
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
,

84 
CŞËùiÚs
.
sšgËtÚLi¡
(
Ãw
 
Layout
.
LayoutSŒe
(
£rv”s
))

86  
Ãw
 
Layout
(
£rv”s
, s”v”s, 
CŞËùiÚs
.
sšgËtÚLi¡
(
£gm’t
), 
•och
, 
şu¡”Id
);

89 
´iv©e
 
CÜfuS”v”P¬ams
 
g‘S”v”P¬ams
(
NodeP¬ams
 
£rv”P¬ams
) {

90  
	gCÏssUts
.
ÿ¡
(
£rv”P¬ams
, 
CÜfuS”v”P¬ams
.
şass
);

	@it/src/main/java/org/corfudb/universe/group/cluster/vm/RemoteOperationHelper.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gvm
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gProjeù
;

7 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gskdefs
.
	gİtiÚ®
.
	gssh
.
	gSSHExec
;

8 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gskdefs
.
	gİtiÚ®
.
	gssh
.
	gSı
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
.
	gC»d’tŸls
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

12 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 @
	gSlf4j


20 @
Bud”


21 
public
 cÏs 
	cRemÙeO³¿tiÚH–³r
 {

22 
´iv©e
 
fš®
 
Projeù
 
	mPROJECT
 = 
Ãw
 Project();

24 @
NÚNuÎ


25 
´iv©e
 
fš®
 
C»d’tŸls
 
	müed’tŸls
;

27 @
NÚNuÎ


28 
´iv©e
 
fš®
 
IpAdd»ss
 
	mAdd»ss
;

36 
public
 
	$cİyFe
(
P©h
 
loÿlFe
, P©h 
»mÙeDœ
) {

37 
Sı
 
sı
 = 
Ãw
 
	`Sı
();

39 
sı
.
	`£tLoÿlFe
(
loÿlFe
.
	`toSŒšg
());

41 
SŒšg
 
»mÙeDœU¾
 = SŒšg.
	`fÜm©
(

43 
üed’tŸls
.
	`g‘U£ºame
(), c»d’tŸls.
	`g‘PasswÜd
(), 
Add»ss
, 
»mÙeDœ


45 
sı
.
	`£tTodœ
(
»mÙeDœU¾
);

47 
sı
.
	`£tProjeù
(
PROJECT
);

48 
sı
.
	`£tTru¡
(
Œue
);

49 
log
.
	`šfo
("Cİyšg {}Ø{} oÀ{}", 
loÿlFe
, 
»mÙeDœ
, 
Add»ss
);

50 
sı
.
	`execu‹
();

58 
public
 
SŒšg
 
	$execu‹Commªd
(
SŒšg
 
commªd
) {

59 
SŒšg
 
commªdId
 = "univ”£-äamewÜk-commªd-" + 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

61 
SSHExec
 
sshExec
 = 
Ãw
 
	`SSHExec
();

63 
sshExec
.
	`£tU£ºame
(
üed’tŸls
.
	`g‘U£ºame
());

64 
sshExec
.
	`£tPasswÜd
(
üed’tŸls
.
	`g‘PasswÜd
());

65 
sshExec
.
	`£tHo¡
(
Add»ss
.
	`g‘Ip
());

66 
sshExec
.
	`£tCommªd
(
commªd
);

67 
sshExec
.
	`£tProjeù
(
PROJECT
);

68 
sshExec
.
	`£tTru¡
(
Œue
);

70 
sshExec
.
	`£tOuurİ”ty
(
commªdId
);

72 
log
.
	`šfo
("Executšg commªd: {}, oÀ{}", 
commªd
, 
Add»ss
);

73 
sshExec
.
	`execu‹
();

75  
PROJECT
.
	`g‘Prİ”ty
(
commªdId
);

76 
	}
}

83 
public
 
SŒšg
 
	$execu‹SudoCommªd
(
SŒšg
 
commªd
) {

84 
SŒšg
 
cmdLše
 = SŒšg.
	`fÜm©
(

86 
üed’tŸls
.
	`g‘PasswÜd
(), 
commªd


88  
	`execu‹Commªd
(
cmdLše
);

89 
	}
}

	@it/src/main/java/org/corfudb/universe/group/cluster/vm/VmCorfuCluster.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gvm
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gBoÙ¡¿pUt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gAb¡¿ùCÜfuClu¡”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmName
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g¡»ss
.
	gvm
.
	gVmSŒess
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmMªag”
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
;

22 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

25 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

30 @
Slf4j


31 
public
 
şass
 
VmCÜfuClu¡”
 
ex‹nds
 
	gAb¡¿ùCÜfuClu¡”
<
	gVmCÜfuS”v”P¬ams
, 
	gVmUniv”£P¬ams
> {

32 
´iv©e
 
fš®
 
	gImmubËM­
<
	gVmName
, 
	gVmMªag”
> 
	gvms
;

34 @
Bud”


35 
´Ùeùed
 
VmCÜfuClu¡”
(
CÜfuClu¡”P¬ams
<
VmCÜfuS”v”P¬ams
> 
cÜfuClu¡”P¬ams
,

36 
VmUniv”£P¬ams
 
univ”£P¬ams
,

37 
ImmubËM­
<
VmName
, 
VmMªag”
> 
vms
) {

38 
su³r
(
cÜfuClu¡”P¬ams
, 
univ”£P¬ams
);

39 
	gthis
.
	gvms
 = 
vms
;

41 
š™
();

49 @
Ov”ride


50 
´Ùeùed
 
Node
 
budS”v”
(
VmCÜfuS”v”P¬ams
 
nodeP¬ams
) {

51 
	glog
.
šfo
("D•loy cÜfu s”v”: {}", 
nodeP¬ams
);

52 
VmCÜfuS”v”P¬ams
 
	g·¿ms
 = 
g‘VmS”v”P¬ams
(
nodeP¬ams
);

54 
VmMªag”
 
	gvmMªag”
 = 
vms
.
g‘
(
·¿ms
.
g‘VmName
());

56 
RemÙeO³¿tiÚH–³r
 
	gcommªdH–³r
 = RemÙeO³¿tiÚH–³r.
bud”
()

57 .
Add»ss
(
vmMªag”
.
g‘ResŞvedIpAdd»ss
())

58 .
üed’tŸls
(
univ”£P¬ams
.
g‘C»d’tŸls
().
g‘VmC»d’tŸls
())

59 .
bud
();

61 
VmSŒess
 
	g¡»ss
 = VmSŒess.
bud”
()

62 .
·¿ms
(params)

63 .
univ”£P¬ams
(universeParams)

64 .
vmMªag”
(vmManager)

65 .
commªdH–³r
(commandHelper)

66 .
bud
();

68  
	gVmCÜfuS”v”
.
bud”
()

69 .
univ”£P¬ams
(universeParams)

70 .
·¿ms
(params)

71 .
vmMªag”
(vmManager)

72 .
¡»ss
(stress)

73 .
»mÙeO³¿tiÚH–³r
(
commªdH–³r
)

74 .
bud
();

77 @
Ov”ride


78 
´Ùeùed
 
	gImmubËSÜ‹dS‘
<
	gSŒšg
> 
g‘Clu¡”LayoutS”v”s
() {

79  
	gImmubËSÜ‹dS‘
.
cİyOf
(
budLayout
().
g‘LayoutS”v”s
());

82 @
Ov”ride


83 
public
 
boÙ¡¿p
() {

84 
Layout
 
	gÏyout
 = 
budLayout
();

85 
	glog
.
šfo
("BoÙ¡¿°cÜfu clu¡”. Clu¡”: {}.†ayout: {}", 
·¿ms
.
g‘Name
(), 
Ïyout
.
asJSONSŒšg
());

87 
	gBoÙ¡¿pUt
.
boÙ¡¿p
(
Ïyout
, 
·¿ms
.
g‘BoÙSŒ­R‘r›s
(),…¬ams.
g‘R‘ryDu¿tiÚ
());

93 
´iv©e
 
Layout
 
budLayout
() {

94 
	g•och
 = 0;

95 
UUID
 
	gşu¡”Id
 = UUID.
¿ndomUUID
();

97 
	gLi¡
<
	gSŒšg
> 
	g£rv”s
 = 
·¿ms
.
g‘NodesP¬ams
()

98 .
¡»am
()

99 .
m­
(
this
::
g‘VmS”v”P¬ams
)

100 .
m­
(
vmP¬ams
 -> 
vms
.
g‘
(vmP¬ams.
g‘VmName
()).
g‘ResŞvedIpAdd»ss
(è+ ":" + vmP¬ams.
g‘PÜt
())

101 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

103 
	gLayout
.
LayoutSegm’t
 
	g£gm’t
 = 
Ãw
 
Layout
.LayoutSegment(

104 
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
,

107 
CŞËùiÚs
.
sšgËtÚLi¡
(
Ãw
 
Layout
.
LayoutSŒe
(
£rv”s
))

109  
Ãw
 
Layout
(
£rv”s
, s”v”s, 
CŞËùiÚs
.
sšgËtÚLi¡
(
£gm’t
), 
•och
, 
şu¡”Id
);

112 
´iv©e
 
VmCÜfuS”v”P¬ams
 
g‘VmS”v”P¬ams
(
NodeP¬ams
 
£rv”P¬ams
) {

113  
	gCÏssUts
.
ÿ¡
(
£rv”P¬ams
, 
VmCÜfuS”v”P¬ams
.
şass
);

	@it/src/main/java/org/corfudb/universe/logging/LoggingParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gloggšg
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

8 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

9 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

10 
impÜt
 
	gjava
.
	gtime
.
	gLoÿlD©eTime
;

11 
impÜt
 
	gjava
.
	gtime
.
	gfÜm©
.
	gD©eTimeFÜm©‹r
;

16 @
Bud”


17 
public
 cÏs 
	cLoggšgP¬ams
 {

18 
´iv©e
 
fš®
 
D©eTimeFÜm©‹r
 
	mDATE_FORMATTER
 = D©eTimeFÜm©‹r.
ofP©‹º
("yyyy-MM-dd_HH-mm-ss");

19 
´iv©e
 
fš®
 
SŒšg
 
	mCORFU_DB_PATH
 = "corfudb";

20 
´iv©e
 
fš®
 
SŒšg
 
	mBASE_DIR
 = "/tmp/";

22 @
DeçuÉ


23 
´iv©e
 
fš®
 
SŒšg
 
	mtime¡amp
 = 
LoÿlD©eTime
.
now
().
fÜm©
(
DATE_FORMATTER
);

24 @
NÚNuÎ


25 
´iv©e
 
fš®
 
SŒšg
 
	m‹¡Name
;

26 @
	mDeçuÉ


27 @
G‘‹r


28 
´iv©e
 
fš®
 
boŞ—n
 
	m’abËd
 = 
çl£
;

30 @
	mG‘‹r


31 @
DeçuÉ


32 
´iv©e
 
fš®
 
SŒšg
 
	mba£Dœ
 = 
BASE_DIR
;

34 
public
 
P©h
 
	$g‘S”v”LogDœ
() {

35  
P©hs
.
	`g‘
(
ba£Dœ
, 
CORFU_DB_PATH
, 
time¡amp
, 
‹¡Name
);

37 
	}
}

	@it/src/main/java/org/corfudb/universe/node/Node.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gCom·risÚChaš
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

7 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

13 
public
 
š‹rçû
 
	gNode
 {

21 
Node
 
d•loy
();

29 
¡İ
(
Du¿tiÚ
 
timeout
);

36 
kl
();

43 
de¡roy
();

45 
NodeP¬ams
 
g‘P¬ams
();

50 
š‹rçû
 
NodeP¬ams
 
ex‹nds
 
	gCom·¿bË
<
	gNodeP¬ams
> {

51 
SŒšg
 
g‘Name
();

53  
com·»To
(
NodeP¬ams
 
Ùh”
) {

54  
	gCom·risÚChaš
.
¡¬t
()

55 .
com·»
(
this
.
g‘Name
(), 
Ùh”
.getName())

56 .
com·»
(
this
.
g‘NodeTy³
(), 
Ùh”
.getNodeType())

57 .
»suÉ
();

60 
	gS‘
<
	gIÁeg”
> 
g‘PÜts
();

62 
NodeTy³
 
g‘NodeTy³
();

65 
	eNodeTy³
 {

66 
	gCORFU_SERVER
, 
	gCORFU_CLIENT
, 
	gMETRICS_SERVER
, 
	gSHELL_NODE


	@it/src/main/java/org/corfudb/universe/node/NodeException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
;

7 
public
 cÏs 
	cNodeExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

9 
public
 
	$NodeExû±iÚ
() {

12 
public
 
	$NodeExû±iÚ
(
SŒšg
 
mes§ge
) {

13 
	`su³r
(
mes§ge
);

14 
	}
}

16 
public
 
	$NodeExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

17 
	`su³r
(
mes§ge
, 
ÿu£
);

18 
	}
}

20 
public
 
	$NodeExû±iÚ
(
ThrowabË
 
ÿu£
) {

21 
	`su³r
(
ÿu£
);

22 
	}
}

24 
public
 
	$NodeExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
, 
boŞ—n
 
’abËSuµ»ssiÚ
, boŞ—À
wr™abËSckT¿û
) {

25 
	`su³r
(
mes§ge
, 
ÿu£
, 
’abËSuµ»ssiÚ
, 
wr™abËSckT¿û
);

26 
	}
}

	@it/src/main/java/org/corfudb/universe/node/client/ClientParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gS”v”Ut
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

16 @
	gBud”


17 @
	gG‘‹r


18 @
Equ®sAndHashCode


19 
public
 cÏs 
	cCl›ÁP¬ams
 
im¶em’ts
 
	mNodeP¬ams
 {

21 @
	mDeçuÉ


22 @
NÚNuÎ


23 
´iv©e
 
fš®
 
SŒšg
 
	mÇme
 = "corfuClient";

25 @
NÚNuÎ


26 
´iv©e
 
fš®
 
NodeTy³
 
	mnodeTy³
 = NodeTy³.
CORFU_CLIENT
;

28 @
	mDeçuÉ


29 @
G‘‹r


30 
´iv©e
 
fš®
 
	mpÜt
 = 
S”v”Ut
.
g‘RªdomO³nPÜt
();

35 @
	mDeçuÉ


36 @
	mNÚNuÎ


37 @
	mEqu®sAndHashCode
.
Exşude


38 
´iv©e
 
fš®
 
	mnumR‘ry
 = 5;

43 @
	mDeçuÉ


44 @
	mNÚNuÎ


45 @
	mEqu®sAndHashCode
.
Exşude


46 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mtimeout
 = Du¿tiÚ.
ofSecÚds
(30);

51 @
	mDeçuÉ


52 @
	mNÚNuÎ


53 @
	mEqu®sAndHashCode
.
Exşude


54 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mpŞlP”iod
 = Du¿tiÚ.
ofMlis
(50);

56 @
	mDeçuÉ


57 @
	mEqu®sAndHashCode
.
Exşude


58 
´iv©e
 
fš®
 
	mÜd”
 = 0;

60 @
Ov”ride


61 
public
 
	mS‘
<
	mIÁeg”
> 
	$g‘PÜts
() {

62  
ImmubËS‘
.
	`of
();

64 
	}
}

	@it/src/main/java/org/corfudb/universe/node/client/CorfuClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gUÄ—chabËClu¡”Exû±iÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutV›w
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gMªagem’tV›w
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

15 
public
 
š‹rçû
 
CÜfuCl›Á
 
ex‹nds
 
	gNode
 {

16 
Cl›ÁP¬ams
 
g‘P¬ams
();

25 <
	gK
, 
	gV
> 
	gCÜfuTabË
<K, V> 
ü—‹DeçuÉCÜfuTabË
(
SŒšg
 
¡»amName
);

30 
cÚÃù
();

35 
CÜfuRuÁime
 
g‘RuÁime
();

40 
Layout
 
g‘Layout
();

45 
Mªagem’tV›w
 
g‘Mªagem’tV›w
();

50 
ObjeùsV›w
 
g‘ObjeùsV›w
();

55 
šv®id©eLayout
();

63  
sy¡emDownHªdËr
() {

64 
throw
 
Ãw
 
UÄ—chabËClu¡”Exû±iÚ
("Cluster is unavailable");

67 
shutdown
();

	@it/src/main/java/org/corfudb/universe/node/client/LocalCorfuClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gäomP¬am‘”s
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

7 
impÜt
 
	glombok
.
	gBud”
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
.
	gCÜfuRuÁimeP¬am‘”sBud”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gMªagem’tV›w
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

19 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

22 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

28 @
Slf4j


29 
public
 cÏs 
	cLoÿlCÜfuCl›Á
 
im¶em’ts
 
	mCÜfuCl›Á
 {

30 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

32 @
G‘‹r


33 
´iv©e
 
fš®
 
Cl›ÁP¬ams
 
	m·¿ms
;

35 @
G‘‹r


36 
´iv©e
 
fš®
 
	mImmubËSÜ‹dS‘
<
	mSŒšg
> 
	m£rv”Endpošts
;

38 @
Bud”


39 
public
 
LoÿlCÜfuCl›Á
(

40 
Cl›ÁP¬ams
 
·¿ms
, 
ImmubËSÜ‹dS‘
<
SŒšg
> 
£rv”Endpošts
,

41 
O±iÚ®
<
IÁeg”
> 
´om‘heusM‘ricsPÜt
) {

43 
	mthis
.
	m·¿ms
 = 
·¿ms
;

44 
	mthis
.
	m£rv”Endpošts
 = 
£rv”Endpošts
;

46 
	mLi¡
<
	mNodeLoÿtÜ
> 
	mÏyoutS”v”s
 = 
£rv”Endpošts
.
¡»am
()

47 .
sÜ‹d
()

48 .
m­
(
NodeLoÿtÜ
::
·r£SŒšg
)

49 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

51 
CÜfuRuÁimeP¬am‘”sBud”
 
	m·¿m‘”sBud”
 =

52 
CÜfuRuÁimeP¬am‘”s


53 .
bud”
()

54 .
ÏyoutS”v”s
(layoutServers)

55 .
sy¡emDownHªdËr
(
this
::systemDownHandler);

57 
	m´om‘heusM‘ricsPÜt
.
ifP»£Á
(
·¿m‘”sBud”
::
´om‘heusM‘ricsPÜt
);

58 
	mthis
.
	mruÁime
 = 
äomP¬am‘”s
(
·¿m‘”sBud”
.
bud
());

66 @
Ov”ride


67 
public
 
LoÿlCÜfuCl›Á
 
	$d•loy
() {

68 
	`cÚÃù
();

69  
this
;

70 
	}
}

77 @
Ov”ride


78 
public
 
	$¡İ
(
Du¿tiÚ
 
timeout
) {

79 
ruÁime
.
	`shutdown
();

80 
	}
}

85 @
Ov”ride


86 
public
 
	$kl
() {

87 
ruÁime
.
	`shutdown
();

88 
	}
}

93 @
Ov”ride


94 
public
 
	$de¡roy
() {

95 
ruÁime
.
	`shutdown
();

96 
	}
}

98 @
Ov”ride


99 
	gpublic
 <
	gK
, 
	gV
> 
	gCÜfuTabË
<K, V> 
	$ü—‹DeçuÉCÜfuTabË
(
SŒšg
 
¡»amName
) {

100  
ruÁime
.
	`g‘ObjeùsV›w
()

101 .
	`bud
()

102 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
K
, 
V
>>() {

104 .
	`£tSŒ—mName
(
¡»amName
)

105 .
	`İ’
();

106 
	}
}

108 @
Ov”ride


109 
public
 
	$cÚÃù
() {

110 
ruÁime
.
	`cÚÃù
();

111 
	}
}

113 @
Ov”ride


114 
public
 
CÜfuRuÁime
 
	$g‘RuÁime
() {

115  
ruÁime
;

116 
	}
}

118 @
Ov”ride


119 
public
 
Layout
 
	$g‘Layout
() {

120  
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

121 
	}
}

123 @
Ov”ride


124 
public
 
ObjeùsV›w
 
	$g‘ObjeùsV›w
() {

125  
ruÁime
.
	`g‘ObjeùsV›w
();

126 
	}
}

128 @
Ov”ride


129 
public
 
Mªagem’tV›w
 
	$g‘Mªagem’tV›w
() {

130  
ruÁime
.
	`g‘Mªagem’tV›w
();

131 
	}
}

133 @
Ov”ride


134 
public
 
	$šv®id©eLayout
() {

135 
ruÁime
.
	`šv®id©eLayout
();

136 
	}
}

138 @
Ov”ride


139 
public
 
	$shutdown
() {

140 
ruÁime
.
	`shutdown
();

141 
	}
}

	@it/src/main/java/org/corfudb/universe/node/server/AbstractCorfuServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dS‘
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gLoÿlCÜfuCl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

10 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

12 @
	gSlf4j


13 @
G‘‹r


14 
public
 
ab¡¿ù
 
şass
 
	gAb¡¿ùCÜfuS”v”
<
T
 
ex‹nds
 
	gCÜfuS”v”P¬ams
, 
U
ƒx‹nd 
	gUniv”£P¬ams
>

15 
im¶em’ts
 
	gCÜfuS”v”
 {

17 @
NÚNuÎ


18 
´Ùeùed
 
fš®
 
T
 
	g·¿ms
;

20 @
NÚNuÎ


21 
´Ùeùed
 
fš®
 
U
 
	guniv”£P¬ams
;

23 
´Ùeùed
 
Ab¡¿ùCÜfuS”v”
(@
NÚNuÎ
 
T
 
·¿ms
, @NÚNuÎ 
U
 
univ”£P¬ams
) {

24 
	gthis
.
	g·¿ms
 = 
·¿ms
;

25 
	gthis
.
	guniv”£P¬ams
 = 
univ”£P¬ams
;

34 
´Ùeùed
 
SŒšg
 
g‘CommªdLšeP¬ams
() {

35 
SŒšgBud”
 
	gcmd
 = 
Ãw
 StringBuilder();

36 
	gcmd
.
­³nd
("-¨").­³nd(
g‘N‘wÜkIÁ”çû
());

38 
	g·¿ms
.
g‘P”si¡’û
()) {

39 
	gDISK
:

40 
cmd
.
­³nd
(" -È").­³nd(
·¿ms
.
g‘SŒ—mLogDœ
());

42 
	gMEMORY
:

43 
cmd
.
­³nd
(" -m");

46 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Unknown…ersistence mode");

49 ià(
	g·¿ms
.
g‘Mode
(è=ğ
Mode
.
SINGLE
) {

50 
cmd
.
­³nd
(" -s");

53 
	gcmd
.
­³nd
(" --log-size-quÙa-³rûÁage=").­³nd(
·¿ms
.
g‘LogSizeQuÙaP”ûÁage
()).append(" ");

55 
	gcmd
.
­³nd
(" -d ").­³nd(
·¿ms
.
g‘LogLev–
().
toSŒšg
()).append(" ");

57 
	gcmd
.
­³nd
(
·¿ms
.
g‘PÜt
());

59 
SŒšg
 
	gcmdLšeP¬ams
 = 
cmd
.
toSŒšg
();

60 
	glog
.
Œaû
("CÜfu s”v”. Commªd†š·¿m‘”s: {}", 
cmdLšeP¬ams
);

62  
	gcmdLšeP¬ams
;

65 @
Ov”ride


66 
public
 
LoÿlCÜfuCl›Á
 
g‘LoÿlCÜfuCl›Á
() {

67  
	gLoÿlCÜfuCl›Á
.
bud”
()

68 .
£rv”Endpošts
(
ImmubËSÜ‹dS‘
.
of
(
g‘Endpošt
()))

69 .
´om‘heusM‘ricsPÜt
(
O±iÚ®
.
em±y
())

70 .
bud
()

71 .
d•loy
();

74 @
Ov”ride


75 
public
 
com·»To
(
CÜfuS”v”
 
Ùh”
) {

76  
	gIÁeg”
.
com·»
(
g‘P¬ams
().
g‘PÜt
(), 
Ùh”
.getParams().getPort());

	@it/src/main/java/org/corfudb/universe/node/server/CorfuServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gLoÿlCÜfuCl›Á
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 
public
 
š‹rçû
 
CÜfuS”v”
 
ex‹nds
 
	gNode
, 
	gCom·¿bË
<
	gCÜfuS”v”
> {

16 @
Ov”ride


17 
CÜfuS”v”
 
d•loy
();

19 
CÜfuS”v”P¬ams
 
g‘P¬ams
();

27 
discÚÃù
();

36 
discÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
);

43 
·u£
();

50 
»¡¬t
();

57 
¡¬t
();

64 
»cÚÃù
();

71 
SŒšg
 
execu‹
(SŒšg 
commªd
);

79 
»cÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
);

86 
»sume
();

88 
IpAdd»ss
 
g‘IpAdd»ss
();

90 
IpAdd»ss
 
g‘N‘wÜkIÁ”çû
();

92  
SŒšg
 
g‘Endpošt
() {

93  
g‘N‘wÜkIÁ”çû
(è+ ":" + 
g‘P¬ams
().
g‘PÜt
();

96 
LoÿlCÜfuCl›Á
 
g‘LoÿlCÜfuCl›Á
();

98 
	eMode
 {

99 
	gSINGLE
, 
	gCLUSTER


102 
	eP”si¡’û
 {

103 
	gDISK
, 
	gMEMORY


	@it/src/main/java/org/corfudb/universe/node/server/CorfuServerParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

7 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gNÚNuÎ
;

10 
impÜt
 
	glombok
.
	gToSŒšg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeTy³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
.
	gMode
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
.
	gP”si¡’û
;

15 
impÜt
 
	gÜg
.
	g¦f4j
.
	gev’t
.
	gLev–
;

17 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

18 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

19 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

21 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

23 @
Bud”
(
bud”M‘hodName
 = "serverParamsBuilder")

24 @
AÎArgsCÚ¡ruùÜ


25 @
Equ®sAndHashCode


26 @
ToSŒšg


27 @
G‘‹r


28 
public
 cÏs 
	cCÜfuS”v”P¬ams
 
im¶em’ts
 
NodeP¬ams
 {

29 
public
 
fš®
 
SŒšg
 
DOCKER_IMAGE_NAME
 = "corfudb-universe/corfu-server";

31 @
NÚNuÎ


32 
´iv©e
 
fš®
 
SŒšg
 
	m¡»amLogDœ
 = "db";

34 @
DeçuÉ


35 
´iv©e
 
fš®
 
	mpÜt
 = 
S”v”Ut
.
g‘RªdomO³nPÜt
();

37 @
	mDeçuÉ


38 @
NÚNuÎ


39 
´iv©e
 
fš®
 
Mode
 
	mmode
 = Mode.
CLUSTER
;

41 @
	mDeçuÉ


42 @
NÚNuÎ


43 
´iv©e
 
fš®
 
P”si¡’û
 
	m³rsi¡’û
 = P”si¡’û.
DISK
;

45 @
	mDeçuÉ


46 @
	mNÚNuÎ


47 @
	mEqu®sAndHashCode
.
Exşude


48 
´iv©e
 
fš®
 
Lev–
 
	mlogLev–
 = Lev–.
INFO
;

50 @
NÚNuÎ


51 
´iv©e
 
fš®
 
NodeTy³
 
	mnodeTy³
 = NodeTy³.
CORFU_SERVER
;

56 @
NÚNuÎ


57 
´iv©e
 
fš®
 
SŒšg
 
	mşu¡”Name
;

59 @
	mDeçuÉ


60 @
	mNÚNuÎ


61 @
	mEqu®sAndHashCode
.
Exşude


62 
´iv©e
 
fš®
 
Du¿tiÚ
 
	m¡İTimeout
 = Du¿tiÚ.
ofSecÚds
(1);

64 @
DeçuÉ


65 
´iv©e
 
fš®
 
	mO±iÚ®
<
	mCÚš”Resourûs
> 
	mcÚš”Resourûs
 = 
O±iÚ®
.
em±y
();

70 @
NÚNuÎ


71 
´iv©e
 
fš®
 
SŒšg
 
	m£rv”V”siÚ
;

73 @
	mNÚNuÎ


74 @
DeçuÉ


75 
´iv©e
 
fš®
 
P©h
 
	m£rv”J¬DœeùÜy
 = 
P©hs
.
g‘
("target");

77 @
	mNÚNuÎ


78 @
DeçuÉ


79 
´iv©e
 
fš®
 
SŒšg
 
	mdock”Image
 = 
DOCKER_IMAGE_NAME
;

81 @
DeçuÉ


82 
´iv©e
 
fš®
 
	mlogSizeQuÙaP”ûÁage
 = 100;

84 @
Ov”ride


85 
public
 
SŒšg
 
	$g‘Name
() {

86  
şu¡”Name
 + "-cÜfu-node" + 
	`g‘PÜt
();

89 
public
 
SŒšg
 
	$g‘SŒ—mLogDœ
() {

90  
	`g‘Name
(è+ "/" + 
¡»amLogDœ
;

91 
	}
}

93 @
Ov”ride


94 
public
 
	gS‘
<
	gIÁeg”
> 
	$g‘PÜts
() {

95  
ImmubËS‘
.
	`of
(
pÜt
);

96 
	}
}

98 
public
 
SŒšg
 
	$g‘Dock”ImageNameFuÎName
() {

99  
dock”Image
 + ":" + 
£rv”V”siÚ
;

100 
	}
}

102 
public
 
P©h
 
	$g‘Inäa¡ruùu»J¬
() {

103  
£rv”J¬DœeùÜy
.
	`»sŞve
(

104 
SŒšg
.
	`fÜm©
("šäa¡ruùu»-%s-shaded.j¬", 
£rv”V”siÚ
)

106 
	}
}

111 @
	gBud”


112 @
ToSŒšg


113 
public
 şas 
	cCÚš”Resourûs
 {

118 @
	gG‘‹r


119 @
DeçuÉ


120 
´iv©e
 
fš®
 
	gmemÜy
 = 1048 * 1024 * 1024;

	@it/src/main/java/org/corfudb/universe/node/server/ServerUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

5 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

6 
impÜt
 
	gjava
.
	gÃt
.
	gS”v”Sock‘
;

8 
public
 cÏs 
	cS”v”Ut
 {

10 
´iv©e
 
	$S”v”Ut
() {

14 
public
 
	$g‘RªdomO³nPÜt
() {

15 
	`Œy
 (
S”v”Sock‘
 
sock‘
 = 
Ãw
 
	`S”v”Sock‘
(0)) {

16  
sock‘
.
	`g‘LoÿlPÜt
();

17 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

18 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆg‘‡ny o³ÀpÜt", 
e
);

20 
	}
}

	@it/src/main/java/org/corfudb/universe/node/server/SupportServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

5 
public
 
š‹rçû
 
SuµÜtS”v”
 
ex‹nds
 
	gNode
 {

6 @
Ov”ride


7 
SuµÜtS”v”
 
d•loy
();

	@it/src/main/java/org/corfudb/universe/node/server/SupportServerParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

8 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
.
	gNÚNuÎ
;

11 
impÜt
 
	glombok
.
	gToSŒšg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeTy³
;

14 
impÜt
 
	gÜg
.
	g¦f4j
.
	gev’t
.
	gLev–
;

16 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

18 
impÜt
 
	gjava
.
	gut
.
	gM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

21 @
	gBud”


22 @
	gAÎArgsCÚ¡ruùÜ


23 @
	gEqu®sAndHashCode


24 @
ToSŒšg


25 
public
 cÏs 
	cSuµÜtS”v”P¬ams
 
im¶em’ts
 
	mNodeP¬ams
 {

26 
´iv©e
 
fš®
 
	mM­
<
	mNodeTy³
, 
	mIÁeg”
> 
	mPORTS
 = 
ImmubËM­
.<
NodeTy³
, IÁeg”>
bud”
()

27 .
put
(
NodeTy³
.
METRICS_SERVER
, 9090)

28 .
bud
();

30 @
	mDeçuÉ


31 @
	mNÚNuÎ


32 @
G‘‹r


33 
´iv©e
 
fš®
 
	mS‘
<
	mIÁeg”
> 
	mm‘ricPÜts
 = 
Ãw
 
HashS‘
<>();

35 @
	mDeçuÉ


36 @
	mNÚNuÎ


37 @
	mG‘‹r


38 @
	mEqu®sAndHashCode
.
Exşude


39 
´iv©e
 
fš®
 
Lev–
 
	mlogLev–
 = Lev–.
INFO
;

41 @
	mNÚNuÎ


42 @
G‘‹r


43 
´iv©e
 
fš®
 
NodeTy³
 
	mnodeTy³
;

45 @
	mG‘‹r


46 @
NÚNuÎ


47 
´iv©e
 
fš®
 
SŒšg
 
	mşu¡”Name
;

49 @
	mG‘‹r


50 @
	mDeçuÉ


51 @
	mNÚNuÎ


52 @
	mEqu®sAndHashCode
.
Exşude


53 
´iv©e
 
fš®
 
Du¿tiÚ
 
	m¡İTimeout
 = Du¿tiÚ.
ofSecÚds
(1);

55 @
Ov”ride


56 
public
 
SŒšg
 
	$g‘Name
() {

57  
şu¡”Name
 + "-suµÜt-node-" + 
	`g‘NodeTy³
();

60 
public
 
S‘
<
IÁeg”
> 
	$g‘PÜts
() {

61  
ImmubËS‘
.
	`of
(
PORTS
.
	`g‘
(
	`g‘NodeTy³
()));

62 
	}
}

64 
public
 
boŞ—n
 
	$isEÇbËd
() {

65  !
m‘ricPÜts
.
	`isEm±y
();

66 
	}
}

	@it/src/main/java/org/corfudb/universe/node/server/docker/DockerCorfuServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gdock”
;

3 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
.
	gLogsP¬am
;

5 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
;

6 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
.
	gLi¡ImagesP¬am
;

7 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gLogSŒ—m
;

8 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gexû±iÚs
.
	gDock”Exû±iÚ
;

9 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gCÚš”CÚfig
;

10 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gCÚš”C»©iÚ
;

11 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gCÚš”Info
;

12 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gHo¡CÚfig
;

13 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gImage
;

14 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gPÜtBšdšg
;

15 
impÜt
 
	glombok
.
	gBud”
;

16 
impÜt
 
	glombok
.
	gNÚNuÎ
;

17 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gÏng
.
	gSŒšgUts
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gloggšg
.
	gLoggšgP¬ams
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gAb¡¿ùCÜfuS”v”
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gDock”Mªag”
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpTabËsUt
;

31 
impÜt
 
	gjava
.
	gio
.
	gFe
;

32 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

33 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

34 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

35 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSnd¬dO³nO±iÚ
;

36 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

37 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

38 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

39 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

40 
impÜt
 
	gjava
.
	gut
.
	gM­
;

41 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

42 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

43 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

44 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

49 @
Slf4j


50 
public
 
şass
 
Dock”CÜfuS”v”
 
ex‹nds
 
	gAb¡¿ùCÜfuS”v”
<
	gCÜfuS”v”P¬ams
, 
	gUniv”£P¬ams
> {

51 
´iv©e
 
fš®
 
SŒšg
 
	gALL_NETWORK_INTERFACES
 = "0.0.0.0";

53 @
NÚNuÎ


54 
´iv©e
 
fš®
 
Dock”Cl›Á
 
	gdock”
;

56 @
NÚNuÎ


57 
´iv©e
 
fš®
 
Dock”Mªag”
 
	gdock”Mªag”
;

59 @
NÚNuÎ


60 
´iv©e
 
fš®
 
LoggšgP¬ams
 
	gloggšgP¬ams
;

61 @
NÚNuÎ


62 
´iv©e
 
fš®
 
	gCÜfuClu¡”P¬ams
<
	gCÜfuS”v”P¬ams
> 
	gşu¡”P¬ams
;

63 
´iv©e
 
fš®
 
	gAtomicReã»nû
<
	gIpAdd»ss
> 
	gAdd»ss
 = 
Ãw
 
AtomicReã»nû
<>();

64 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	gde¡royed
 = 
Ãw
 AtomicBoolean();

66 @
Bud”


67 
public
 
Dock”CÜfuS”v”
(

68 
Dock”Cl›Á
 
dock”
, 
CÜfuS”v”P¬ams
 
·¿ms
, 
Univ”£P¬ams
 
univ”£P¬ams
,

69 
CÜfuClu¡”P¬ams
<
CÜfuS”v”P¬ams
> 
şu¡”P¬ams
, 
LoggšgP¬ams
 
loggšgP¬ams
,

70 
Dock”Mªag”
 
dock”Mªag”
) {

71 
su³r
(
·¿ms
, 
univ”£P¬ams
);

72 
	gthis
.
	gdock”
 = 
dock”
;

73 
	gthis
.
	gloggšgP¬ams
 = 
loggšgP¬ams
;

74 
	gthis
.
	gşu¡”P¬ams
 = 
şu¡”P¬ams
;

75 
	gthis
.
	gdock”Mªag”
 = 
dock”Mªag”
;

81 @
Ov”ride


82 
public
 
Dock”CÜfuS”v”
 
d•loy
() {

83 
	glog
.
šfo
("D•loyšghCÜfu s”v”. Dock” cÚš”: {}", 
·¿ms
.
g‘Name
());

85 
d•loyCÚš”
();

87  
	gthis
;

96 @
Ov”ride


97 
public
 
¡İ
(
Du¿tiÚ
 
timeout
) {

98 
	glog
.
šfo
("StİpšghCÜfu s”v”. Dock” cÚš”: {}", 
·¿ms
.
g‘Name
());

99 
	gdock”Mªag”
.
¡İ
(
·¿ms
.
g‘Name
(), 
timeout
);

107 @
Ov”ride


108 
public
 
kl
() {

109 
	glog
.
šfo
("KlšghCÜfu s”v”. Dock” cÚš”: {}", 
·¿ms
.
g‘Name
());

110 
	gdock”Mªag”
.
kl
(
·¿ms
.
g‘Name
());

118 @
Ov”ride


119 
public
 
de¡roy
() {

120 
	glog
.
šfo
("De¡royšghCÜfu s”v”. Dock” cÚš”: {}", 
·¿ms
.
g‘Name
());

122 ià(
	gde¡royed
.
g‘AndS‘
(
Œue
)) {

123 
	glog
.
debug
("AÌ—dy de¡royed: {}", 
·¿ms
.
g‘Name
());

127 
cŞËùLogs
();

128 
	gdock”Mªag”
.
de¡roy
(
·¿ms
.
g‘Name
());

138 @
Ov”ride


139 
public
 
discÚÃù
() {

140 
	glog
.
šfo
("DiscÚÃùšghdock” s”v”: {} fromhşu¡” ", 
·¿ms
.
g‘Name
());

142 
	gşu¡”P¬ams
.
g‘NodesP¬ams
()

143 .
¡»am
()

144 .
f‹r
(
ÃighbourS”v”
 -> !ÃighbourS”v”.
equ®s
(
·¿ms
))

145 .
fÜEach
(
ÃighbourS”v”
 -> {

146 
Œy
 {

147 
CÚš”Info
 
£rv”
 = 
dock”
.
š¥eùCÚš”
(
ÃighbourS”v”
.
g‘Name
());

148 
SŒšg
 
ÃighbourIp
 = 
£rv”
.
ÃtwÜkS‘tšgs
().
ÃtwÜks
().
v®ues
().
asLi¡
().
g‘
(0).
Add»ss
();

150 ià(
SŒšgUts
.
isEm±y
(
ÃighbourIp
)) {

151 
throw
 
Ãw
 
NodeExû±iÚ
("Em±y i°add»ss. CÚš”: " + 
ÃighbourS”v”
.
g‘Name
());

155 
dock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(),

156 "bËs", "-A", "INPUT", "-s", 
ÃighbourIp
, "-j", "DROP");

158 
dock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(),

159 "bËs", "-A", "OUTPUT", "-d", 
ÃighbourIp
, "-j", "DROP");

160 } 
ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

161 
Li¡
<
SŒšg
> 
şu¡”Nodes
 = 
şu¡”P¬ams
.
g‘Clu¡”Nodes
();

162 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆdiscÚÃù cÚš”: " + 
·¿ms
.
g‘Name
() +

163 " from dock”‚‘wÜk. CÜfu clu¡”: " + 
şu¡”Nodes
, 
ex
);

175 @
Ov”ride


176 
public
 
discÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
) {

177 
	glog
.
šfo
("Disconnectinghe docker server: {} from specified servers: {}",

178 
·¿ms
.
g‘Name
(), 
£rv”s
);

180 
	g£rv”s
.
¡»am
()

181 .
f‹r
(
ÃighbourS”v”
 -> !ÃighbourS”v”.
g‘P¬ams
().
equ®s
(
·¿ms
))

182 .
fÜEach
(
ÃighbourS”v”
 -> {

183 
Œy
 {

184 
IpAdd»ss
 
ÃighbourIp
 = 
ÃighbourS”v”
.
g‘IpAdd»ss
();

185 
dock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(),

186 
IpTabËsUt
.
drİIÅut
(
ÃighbourIp
));

187 
dock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(),

188 
IpTabËsUt
.
drİOuut
(
ÃighbourIp
));

189 } 
ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

190 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆdiscÚÃù cÚš”: " + 
·¿ms
.
g‘Name
() +

191 " from s”v”: " + 
ÃighbourS”v”
.
g‘P¬ams
().
g‘Name
(), 
ex
);

201 @
Ov”ride


202 
public
 
·u£
() {

203 
	glog
.
šfo
("PausšghCÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

204 
	gdock”Mªag”
.
·u£
(
·¿ms
.
g‘Name
());

212 @
Ov”ride


213 
public
 
¡¬t
() {

214 
	glog
.
šfo
("S¹šghcÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

215 
	gdock”Mªag”
.
¡¬t
(
·¿ms
.
g‘Name
());

223 @
Ov”ride


224 
public
 
»¡¬t
() {

225 
	glog
.
šfo
("Re¡¬tšghcÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

226 
	gdock”Mªag”
.
»¡¬t
(
·¿ms
.
g‘Name
());

234 @
Ov”ride


235 
public
 
»cÚÃù
() {

236 
	glog
.
šfo
("RecÚÃùšghdock” s”v”: {}ØthÃtwÜk.", 
·¿ms
.
g‘Name
());

238 
	gŒy
 {

239 
	gdock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(), 
IpTabËsUt
.
ş—nIÅut
());

240 
	gdock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(), 
IpTabËsUt
.
ş—nOuut
());

241 } 
ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
e
) {

242 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆ»cÚÃù cÚš”Ødock”‚‘wÜk " + 
·¿ms
.
g‘Name
(), 
e
);

246 @
Ov”ride


247 
public
 
SŒšg
 
execu‹
(SŒšg 
commªd
) {

248 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not implemented yet");

256 @
Ov”ride


257 
public
 
»cÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
) {

258 
	glog
.
šfo
("Reconnectinghe docker server: {}o specified servers: {}",

259 
·¿ms
.
g‘Name
(), 
£rv”s
);

261 
	g£rv”s
.
¡»am
()

262 .
f‹r
(
ÃighbourS”v”
 -> !ÃighbourS”v”.
g‘P¬ams
().
equ®s
(
·¿ms
))

263 .
fÜEach
(
ÃighbourS”v”
 -> {

264 
Œy
 {

265 
dock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(),

266 
IpTabËsUt
.
»v”tDrİIÅut
(
ÃighbourS”v”
.
g‘IpAdd»ss
()));

267 
dock”Mªag”
.
execCommªd
(
·¿ms
.
g‘Name
(),

268 
IpTabËsUt
.
»v”tDrİOuut
(
ÃighbourS”v”
.
g‘IpAdd»ss
()));

269 } 
ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

270 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆ»cÚÃù cÚš”: " + 
·¿ms
.
g‘Name
() +

271 "Ø£rv”: " + 
ÃighbourS”v”
.
g‘P¬ams
().
g‘Name
(), 
ex
);

281 @
Ov”ride


282 
public
 
»sume
() {

283 
	glog
.
šfo
("ResumšghcÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

284 
	gdock”Mªag”
.
»sume
(
·¿ms
.
g‘Name
());

287 @
Ov”ride


288 
public
 
IpAdd»ss
 
g‘IpAdd»ss
() {

289  
	gAdd»ss
.
g‘
();

297 
´iv©e
 
SŒšg
 
d•loyCÚš”
() {

298 
CÚš”CÚfig
 
	gcÚš”CÚfig
 = 
budCÚš”CÚfig
();

300 
SŒšg
 
	gid
;

301 
	gŒy
 {

302 
Li¡ImagesP¬am
 
	gcÜfuImageQu”y
 = ListImagesParam

303 .
byName
(
·¿ms
.
g‘Dock”ImageNameFuÎName
());

305 
	gLi¡
<
	gImage
> 
	gcÜfuImages
 = 
dock”
.
li¡Images
(
cÜfuImageQu”y
);

306 ià(
	gcÜfuImages
.
isEm±y
()) {

307 
	gdock”
.
puÎ
(
·¿ms
.
g‘Dock”ImageNameFuÎName
());

310 
CÚš”C»©iÚ
 
	gcÚš”
 = 
dock”
.
ü—‹CÚš”
(
cÚš”CÚfig
, 
·¿ms
.
g‘Name
());

311 
	gid
 = 
cÚš”
.
id
();

313 
	gdock”Mªag”
.
addShutdownHook
(
·¿ms
.
g‘Name
());

315 
	gdock”
.
discÚÃùFromN‘wÜk
(
id
, "bridge");

316 
	gdock”
.
cÚÃùToN‘wÜk
(
id
, 
dock”
.
š¥eùN‘wÜk
(
univ”£P¬ams
.
g‘N‘wÜkName
()).id());

318 
	gdock”Mªag”
.
¡¬t
(
id
);

320 
SŒšg
 
	gAddr
 = 
dock”
.
š¥eùCÚš”
(
id
)

321 .
ÃtwÜkS‘tšgs
()

322 .
ÃtwÜks
()

323 .
v®ues
()

324 .
asLi¡
()

325 .
g‘
(0)

326 .
Add»ss
();

328 ià(
	gSŒšgUts
.
isEm±y
(
Addr
)) {

329 
throw
 
Ãw
 
NodeExû±iÚ
("Em±y I°add»s fÜ cÚš”: " + 
·¿ms
.
g‘Name
());

332 
	gAdd»ss
.
£t
(
IpAdd»ss
.
bud”
().

(
Addr
).
bud
());

333 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 | 
Dock”Exû±iÚ
 
e
) {

334 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆ¡¬ˆ¨cÚš”", 
e
);

337  
	gid
;

340 
´iv©e
 
CÚš”CÚfig
 
budCÚš”CÚfig
() {

342 
	gLi¡
<
	gSŒšg
> 
	gpÜts
 = 
·¿ms
.
g‘PÜts
().
¡»am
()

343 .
m­
(
Objeùs
::
toSŒšg
).
cŞËù
(
CŞËùÜs
.
toLi¡
());

344 
	gM­
<
	gSŒšg
, 
	gLi¡
<
	gPÜtBšdšg
>> 
	gpÜtBšdšgs
 = 
Ãw
 
HashM­
<>();

345 
SŒšg
 
	gpÜt
 : 
pÜts
) {

346 
Li¡
<
PÜtBšdšg
> 
ho¡PÜts
 = 
Ãw
 
A¼ayLi¡
<>();

347 
	gho¡PÜts
.
add
(
PÜtBšdšg
.
of
(
ALL_NETWORK_INTERFACES
, 
pÜt
));

348 
	gpÜtBšdšgs
.
put
(
pÜt
, 
ho¡PÜts
);

351 
	gHo¡CÚfig
.
Bud”
 
	gho¡CÚfigBud”
 = 
Ho¡CÚfig
.
bud”
();

352 
	g·¿ms
.
g‘CÚš”Resourûs
()

353 .
ifP»£Á
(
lim™s
 -> 
ho¡CÚfigBud”
.
memÜy
Öim™s.
g‘MemÜy
()));

355 
Ho¡CÚfig
 
	gho¡CÚfig
 = 
ho¡CÚfigBud”


356 .
´iveged
(
Œue
)

357 .
pÜtBšdšgs
(portBindings)

358 .
bud
();

361 
SŒšg
 
	gcmdLše
 = 
Ãw
 
SŒšgBud”
()

362 .
­³nd
("mkdœ -°" + 
·¿ms
.
g‘SŒ—mLogDœ
())

363 .
­³nd
(" && ")

364 .
­³nd
("java -cp *.jar ")

365 .
­³nd
(
Üg
.
cÜfudb
.
šäa¡ruùu»
.
CÜfuS”v”
.
şass
.
g‘CªÚiÿlName
())

366 .
­³nd
(" ")

367 .
­³nd
(
g‘CommªdLšeP¬ams
())

368 .
toSŒšg
();

370  
	gCÚš”CÚfig
.
bud”
()

371 .
ho¡CÚfig
(hostConfig)

372 .
image
(
·¿ms
.
g‘Dock”ImageNameFuÎName
())

373 .
ho¡Çme
(
·¿ms
.
g‘Name
())

374 .
expo£dPÜts
(
pÜts
.
toA¼ay
(
Ãw
 
SŒšg
[0]))

375 .
cmd
("sh", "-c", 
cmdLše
)

376 .
bud
();

382 
´iv©e
 
cŞËùLogs
() {

383 ià(!
	gloggšgP¬ams
.
isEÇbËd
()) {

384 
	glog
.
debug
("Logging is disabled");

388 
Fe
 
	g£rv”LogDœ
 = 
loggšgP¬ams
.
g‘S”v”LogDœ
().
toFe
();

389 ià(!
	g£rv”LogDœ
.
exi¡s
(è&& s”v”LogDœ.
mkdœs
()) {

390 
	glog
.
šfo
("C»©ed‚ew cÜfu†og dœeùÜy‡ˆ{}.", 
£rv”LogDœ
);

393 
	glog
.
debug
("CŞËù†og fÜ: {}", 
·¿ms
.
g‘Name
());

395 
Œy
 (
LogSŒ—m
 
¡»am
 = 
dock”
.
logs
(
·¿ms
.
g‘Name
(), 
LogsP¬am
.
¡dout
(), LogsP¬am.
¡d”r
())) {

396 
SŒšg
 
	glogs
 = 
¡»am
.
»adFuÎy
();

398 ià(
	gSŒšgUts
.
isEm±y
(
logs
)) {

399 
	glog
.
w¬n
("Em±y†og äom cÚš”: {}", 
·¿ms
.
g‘Name
());

402 
P©h
 
	gfeP©hObj
 = 
loggšgP¬ams
.
g‘S”v”LogDœ
().
»sŞve
(
·¿ms
.
g‘Name
() + ".log");

403 
	gFes
.
wr™e
(
feP©hObj
, 
logs
.
g‘By‹s
(), 
Snd¬dO³nO±iÚ
.
CREATE
, Snd¬dO³nO±iÚ.
APPEND
);

404 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 | 
Dock”Exû±iÚ
 | 
IOExû±iÚ
 
e
) {

405 
	glog
.
”rÜ
("Cª'ˆcŞËù†og äom cÚš”: {}", 
·¿ms
.
g‘Name
(), 
e
);

409 @
Ov”ride


410 
public
 
IpAdd»ss
 
g‘N‘wÜkIÁ”çû
() {

411  
	gIpAdd»ss
.
bud”
().

(
·¿ms
.
g‘Name
()).
bud
();

	@it/src/main/java/org/corfudb/universe/node/server/docker/DockerSupportServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gdock”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
;

5 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gexû±iÚs
.
	gDock”Exû±iÚ
;

6 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gCÚš”CÚfig
;

7 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gCÚš”C»©iÚ
;

8 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gHo¡CÚfig
;

9 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gI·mCÚfig
;

10 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gPÜtBšdšg
;

11 
impÜt
 
	ggroovy
.
	gut
.
	gloggšg
.
	gLog4j
;

12 
impÜt
 
	glombok
.
	gBud”
;

13 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

14 
impÜt
 
	glombok
.
	gG‘‹r
;

15 
impÜt
 
	glombok
.
	gNÚNuÎ
;

16 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gÏng
.
	gSŒšgUts
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gSuµÜtClu¡”P¬ams
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”P¬ams
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gDock”Mªag”
;

24 
impÜt
 
	gjava
.
	gio
.
	gBufã»dWr™”
;

25 
impÜt
 
	gjava
.
	gio
.
	gFe
;

26 
impÜt
 
	gjava
.
	gio
.
	gFeWr™”
;

27 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

28 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

31 
impÜt
 
	gjava
.
	gut
.
	gM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

33 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

35 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

37 @
	gLog4j


38 @
Bud”


39 
public
 
şass
 
	gDock”SuµÜtS”v”
<
N
 
ex‹nds
 
	gSuµÜtS”v”P¬ams
> 
im¶em’ts
 
	gSuµÜtS”v”
 {

40 
´iv©e
 
fš®
 
SŒšg
 
	gALL_NETWORK_INTERFACES
 = "0.0.0.0";

41 
´iv©e
 
fš®
 
SŒšg
 
	gLINUX_OS
 = "linux";

43 
´iv©e
 
fš®
 
	gM­
<
	gNodeTy³
, 
	gSŒšg
> 
	gIMAGE_NAME
 = 
ImmubËM­
.<
NodeTy³
, SŒšg>
bud”
()

44 .
put
(
NodeTy³
.
METRICS_SERVER
, "prom/prometheus")

45 .
put
(
NodeTy³
.
SHELL_NODE
, "ubuntu")

46 .
bud
();

48 
´iv©e
 
fš®
 
	gM­
<
	gNodeTy³
, 
	gSŒšg
> 
	gCMD
 = 
ImmubËM­
.<
NodeTy³
, SŒšg>
bud”
()

49 .
put
(
NodeTy³
.
SHELL_NODE
, "bash")

50 .
bud
();

52 @
	gDeçuÉ


53 @
	gG‘‹r


54 @
NÚNuÎ


55 
´iv©e
 
fš®
 
SŒšg
 
	g´om‘heusCÚfigP©h
 = "/etc/prometheus/prometheus.yml";

57 @
	gG‘‹r


58 @
NÚNuÎ


59 
´Ùeùed
 
fš®
 
N
 
	g·¿ms
;

61 @
	gNÚNuÎ


62 @
G‘‹r


63 
´Ùeùed
 
fš®
 
Univ”£P¬ams
 
	guniv”£P¬ams
;

65 @
NÚNuÎ


66 
´iv©e
 
fš®
 
Dock”Cl›Á
 
	gdock”
;

68 @
NÚNuÎ


69 
´iv©e
 
fš®
 
Dock”Mªag”
 
	gdock”Mªag”
;

71 @
NÚNuÎ


72 
´iv©e
 
fš®
 
SuµÜtClu¡”P¬ams
 
	gşu¡”P¬ams
;

74 @
	gNÚNuÎ


75 @
DeçuÉ


76 
´iv©e
 
fš®
 
	gLi¡
<
	gFe
> 
	gİ’edFes
 = 
Ãw
 
A¼ayLi¡
<>();

78 @
NÚNuÎ


79 
´iv©e
 
fš®
 
	gAtomicReã»nû
<
	gSŒšg
> 
	gAdd»ss
 = 
Ãw
 
AtomicReã»nû
<>();

81 @
Ov”ride


82 
public
 
SuµÜtS”v”
 
d•loy
() {

83 
d•loyCÚš”
();

85  
	gthis
;

88 
´iv©e
 
CÚš”CÚfig
 
budCÚš”CÚfig
() {

89 
	gLi¡
<
	gSŒšg
> 
	gpÜts
 = 
·¿ms
.
g‘PÜts
()

90 .
¡»am
()

91 .
m­
(
Objeùs
::
toSŒšg
)

92 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

93 
	gM­
<
	gSŒšg
, 
	gLi¡
<
	gPÜtBšdšg
>> 
	gpÜtBšdšgs
 = 
Ãw
 
HashM­
<>();

94 
SŒšg
 
	gpÜt
 : 
pÜts
) {

95 
Li¡
<
PÜtBšdšg
> 
ho¡PÜts
 = 
Ãw
 
A¼ayLi¡
<>();

96 
	gho¡PÜts
.
add
(
PÜtBšdšg
.
of
(
ALL_NETWORK_INTERFACES
, 
pÜt
));

97 
	gpÜtBšdšgs
.
put
(
pÜt
, 
ho¡PÜts
);

100 
	gHo¡CÚfig
.
Bšd
 
	gcÚfigu¿tiÚFe
 = 
Ho¡CÚfig
.Bšd.
bud”
()

101 .
äom
(
ü—‹CÚfigu¿tiÚ
(
·¿ms
.
g‘M‘ricPÜts
()))

102 .
to
(
´om‘heusCÚfigP©h
)

103 .
bud
();

105 
Ho¡CÚfig
 
	gho¡CÚfig
 = Ho¡CÚfig.
bud”
()

106 .
´iveged
(
Œue
)

107 .
bšds
(
cÚfigu¿tiÚFe
)

108 .
pÜtBšdšgs
(portBindings)

109 .
bud
();

111 
	gCÚš”CÚfig
.
Bud”
 
	gbud”
 = 
CÚš”CÚfig
.
bud”
();

112 
	gbud”
.
ho¡CÚfig
(hostConfig)

113 .
expo£dPÜts
(
pÜts
.
toA¼ay
(
Ãw
 
SŒšg
[0]))

114 .
image
(
IMAGE_NAME
.
g‘
(
g‘P¬ams
().
g‘NodeTy³
()));

116  
	gbud”
.
bud
();

119 
´iv©e
 
SŒšg
 
ü—‹CÚfigu¿tiÚ
(
S‘
<
IÁeg”
> 
m‘ricsPÜts
) {

120 
	gŒy
 {

121 
SŒšg
 
	gcÜfuRuÁimeIp
 = "host.docker.internal";

122 ià(
	gSy¡em
.
g‘Prİ”ty
("os.Çme").
com·»ToIgnÜeCa£
(
LINUX_OS
) == 0) {

123 
cÜfuRuÁimeIp
 = 
dock”


124 .
š¥eùN‘wÜk
(
univ”£P¬ams
.
g‘N‘wÜkName
())

125 .
am
()

126 .
cÚfig
()

127 .
¡»am
()

128 .
fšdFœ¡
()

129 .
m­
(
I·mCÚfig
::
g©eway
)

130 .
ÜEl£Throw
((è-> 
Ãw
 
NodeExû±iÚ
("Ip‡ddress‚ot found"));

132 
Fe
 
	g‹mpCÚfigu¿tiÚ
 = Fe.
ü—‹TempFe
("prometheus", ".yml");

134 
Œy
 (
Bufã»dWr™”
 
wr™”
 = 
Ãw
 Bufã»dWr™”Òew 
FeWr™”
(
‹mpCÚfigu¿tiÚ
))) {

135 
wr™”
.
wr™e
(
Prom‘heusCÚfig
.
g‘CÚfig
(
cÜfuRuÁimeIp
, 
m‘ricsPÜts
));

136 
	gwr™”
.
æush
();

138 
	gİ’edFes
.
add
(
‹mpCÚfigu¿tiÚ
);

139  
	g‹mpCÚfigu¿tiÚ
.
g‘AbsŞu‹P©h
();

140 } 
ÿtch
 (
Exû±iÚ
 
e
) {

141 
throw
 
Ãw
 
NodeExû±iÚ
(
e
);

145 
´iv©e
 
SŒšg
 
d•loyCÚš”
() {

146 
CÚš”CÚfig
 
	gcÚš”CÚfig
 = 
budCÚš”CÚfig
();

148 
SŒšg
 
	gid
;

149 
	gŒy
 {

150 
CÚš”C»©iÚ
 
	gcÚš”
 = 
dock”
.
ü—‹CÚš”
(
cÚš”CÚfig
, 
·¿ms
.
g‘Name
());

151 
	gid
 = 
cÚš”
.
id
();

153 
	gdock”Mªag”
.
addShutdownHook
(
şu¡”P¬ams
.
g‘Name
());

155 
	gdock”
.
discÚÃùFromN‘wÜk
(
id
, "bridge");

156 
	gdock”
.
cÚÃùToN‘wÜk
(
id
, 
dock”
.
š¥eùN‘wÜk
(
univ”£P¬ams
.
g‘N‘wÜkName
()).id());

158 
	gdock”
.
¡¬tCÚš”
(
id
);

160 
SŒšg
 
	gAddr
 = 
dock”
.
š¥eùCÚš”
(
id
)

161 .
ÃtwÜkS‘tšgs
().
ÃtwÜks
()

162 .
v®ues
().
asLi¡
().
g‘
(0)

163 .
Add»ss
();

165 ià(
	gSŒšgUts
.
isEm±y
(
Addr
)) {

166 
throw
 
Ãw
 
NodeExû±iÚ
("Em±y I°add»s fÜ cÚš”: " + 
şu¡”P¬ams
.
g‘Name
());

169 
	gAdd»ss
.
£t
(
Addr
);

170 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 | 
Dock”Exû±iÚ
 
e
) {

171 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆ¡¬ˆ¨cÚš”", 
e
);

174  
	gid
;

183 @
Ov”ride


184 
public
 
¡İ
(
Du¿tiÚ
 
timeout
) {

185 
	gdock”Mªag”
.
¡İ
(
·¿ms
.
g‘Name
(), 
timeout
);

186 
	gİ’edFes
.
fÜEach
(
Fe
::
d–‘e
);

194 @
Ov”ride


195 
public
 
kl
() {

196 
	gdock”Mªag”
.
kl
(
·¿ms
.
g‘Name
());

197 
	gİ’edFes
.
fÜEach
(
Fe
::
d–‘e
);

205 @
Ov”ride


206 
public
 
de¡roy
() {

207 
	gdock”Mªag”
.
de¡roy
(
·¿ms
.
g‘Name
());

208 
	gİ’edFes
.
fÜEach
(
Fe
::
d–‘e
);

	@it/src/main/java/org/corfudb/universe/node/server/docker/PrometheusConfig.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gdock”
;

3 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

4 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

6 
public
 cÏs 
	cProm‘heusCÚfig
 {

8 
´iv©e
 
	$Prom‘heusCÚfig
() {

12 
´iv©e
 
fš®
 
SŒšg
 
CONFIG
 =

36 
SŒšg
 
	`g‘CÚfig
(SŒšg 
ho¡Çme
, 
S‘
<
IÁeg”
> 
m‘ricsPÜts
) {

37 
as£¹
 !
m‘ricsPÜts
.
	`isEm±y
();

38 
fš®
 
SŒšg
 
m‘ricsExpÜ‹rs
 = 
m‘ricsPÜts
.
	`¡»am
()

39 .
	`m­
(
pÜt
 -> 
SŒšg
.
	`fÜm©
("'%s:%d'", 
ho¡Çme
,…ort))

40 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(","));

41  
SŒšg
.
	`fÜm©
(
CONFIG
, 
m‘ricsExpÜ‹rs
);

42 
	}
}

	@it/src/main/java/org/corfudb/universe/node/server/process/CorfuProcessManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	g´oûss
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

8 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

9 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

16 @
Slf4j


17 
public
 cÏs 
	cCÜfuProûssMªag”
 {

19 @
NÚNuÎ


20 
´iv©e
 
fš®
 
CÜfuS”v”P¬ams
 
	m·¿ms
;

22 @
	mG‘‹r


23 @
NÚNuÎ


24 
´iv©e
 
fš®
 
P©h
 
	mcÜfuDœ
;

25 
´iv©e
 
fš®
 
P©h
 
	m£rv”Dœ
;

26 
´iv©e
 
fš®
 
P©h
 
	mdbDœ
;

27 @
G‘‹r


28 
´iv©e
 
fš®
 
P©h
 
	m£rv”J¬
;

29 
´iv©e
 
fš®
 
P©h
 
	m£rv”J¬R–©iveP©h
;

31 
public
 
CÜfuProûssMªag”
(
P©h
 
cÜfuDœ
, @
NÚNuÎ
 
CÜfuS”v”P¬ams
 
·¿ms
) {

33 
	mthis
.
	mcÜfuDœ
 = 
cÜfuDœ
;

34 
	mthis
.
	m·¿ms
 = 
·¿ms
;

36 
	m£rv”Dœ
 = 
cÜfuDœ
.
»sŞve
(
·¿ms
.
g‘Name
());

37 
	mdbDœ
 = 
cÜfuDœ
.
»sŞve
(
·¿ms
.
g‘SŒ—mLogDœ
());

39 
	m£rv”J¬R–©iveP©h
 = 
P©hs
.
g‘
(
·¿ms
.
g‘Name
(), "corfu-server.jar");

40 
	m£rv”J¬
 = 
cÜfuDœ
.
»sŞve
(
£rv”J¬R–©iveP©h
);

43 
public
 
SŒšg
 
	$ü—‹S”v”DœCommªd
() {

44  "mkdœ -°" + 
£rv”Dœ
;

45 
	}
}

47 
public
 
SŒšg
 
	$ü—‹SŒ—mLogDœCommªd
() {

48  "mkdœ -°" + 
dbDœ
;

49 
	}
}

51 
public
 
SŒšg
 
	$·u£Commªd
() {

56 
SŒšg
.
	`fÜm©
("g»°\"%s\"", 
·¿ms
.
	`g‘Name
()) +

61 
	}
}

63 
public
 
SŒšg
 
	$¡¬tCommªd
(
SŒšg
 
commªdLšeP¬ams
) {

64 
P©h
 
cÜfuLog
 = 
£rv”Dœ
.
	`»sŞve
("corfu.log");

68 
£rv”J¬R–©iveP©h
 +

70 
Üg
.
cÜfudb
.
šäa¡ruùu»
.
CÜfuS”v”
.
şass
.
	`g‘Name
() +

72 
commªdLšeP¬ams
 +

74 
cÜfuLog
 +

76 
	}
}

78 
public
 
SŒšg
 
	$»sumeCommªd
() {

79 
log
.
	`šfo
("ResumšghcÜfu s”v”: {}", 
·¿ms
.
	`g‘Name
());

85 
SŒšg
.
	`fÜm©
("g»°\"%s\"", 
·¿ms
.
	`g‘Name
()) +

90 
	}
}

92 
public
 
SŒšg
 
	$¡İCommªd
() {

93 
log
.
	`šfo
("Stİ cÜfu s”v”. P¬ams: {}", 
·¿ms
);

99 
SŒšg
.
	`fÜm©
("g»°\"%s\"", 
·¿ms
.
	`g‘Name
()) +

104 
	}
}

106 
public
 
SŒšg
 
	$klCommªd
() {

107 
log
.
	`šfo
("KÈthcÜfu s”v”. P¬ams: {}", 
·¿ms
);

112 
SŒšg
.
	`fÜm©
("g»°\"%s\"", 
·¿ms
.
	`g‘Name
()) +

117 
	}
}

119 
public
 
SŒšg
 
	$»moveS”v”DœCommªd
() {

120  
SŒšg
.
	`fÜm©
("rm -rà%s", 
£rv”Dœ
);

121 
	}
}

	@it/src/main/java/org/corfudb/universe/node/server/process/ExecutionHelper.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	g´oûss
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gProjeù
;

5 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gskdefs
.
	gCİy
;

6 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gskdefs
.
	gExec
;

7 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gskdefs
.
	gExecu‹
;

8 
impÜt
 
	gÜg
.
	g­ache
.
	gtoŞs
.
	gªt
.
	gskdefs
.
	gPumpSŒ—mHªdËr
;

10 
impÜt
 
	gjava
.
	gio
.
	gBy‹A¼ayOuutSŒ—m
;

11 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

12 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—m
;

13 
impÜt
 
	gjava
.
	gio
.
	gSŒšgWr™”
;

14 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

15 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

16 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

22 @
Slf4j


23 
public
 cÏs 
	cExecutiÚH–³r
 {

24 
´iv©e
 
fš®
 
Projeù
 
	mPROJECT
 = 
Ãw
 Project();

25 
´iv©e
 
fš®
 
ExecutiÚH–³r
 
	mINSTANCE
 = 
Ãw
 ExecutionHelper();

27 
´iv©e
 
	$ExecutiÚH–³r
() {

31 
public
 
ExecutiÚH–³r
 
	$g‘In¡ªû
() {

32  
INSTANCE
;

33 
	}
}

41 
public
 
	$cİyFe
(
P©h
 
¤cFe
, P©h 
rg‘Fe
) {

42 
Cİy
 
cİy
 = 
Ãw
 
	`Cİy
();

44 
cİy
.
	`£tFe
(
¤cFe
.
	`toFe
());

45 
cİy
.
	`£tTofe
(
rg‘Fe
.
	`toFe
());

46 
cİy
.
	`£tProjeù
(
PROJECT
);

47 
log
.
	`šfo
("Cİyšg {}Ø{}", 
¤cFe
, 
rg‘Fe
);

48 
cİy
.
	`execu‹
();

49 
	}
}

56 
public
 
SŒšg
 
execu‹Commªd
(
O±iÚ®
<
P©h
> 
wÜkDœ
, SŒšg 
commªd
è
throws
 
	gIOExû±iÚ
 {

57 
Execu‹
 
	gexec
 = 
Ãw
 Execute();

59 
	gexec
.
£tCommªdlše
(
Ãw
 
SŒšg
[]{"sh", "-c", 
commªd
});

60 
	gexec
.
£tAÁRun
(
PROJECT
);

61 
By‹A¼ayOuutSŒ—m
 
	gout
 = 
Ãw
 ByteArrayOutputStream();

62 
	gexec
.
£tSŒ—mHªdËr
(
Ãw
 
PumpSŒ—mHªdËr
(
out
, out));

63 
	gwÜkDœ
.
ifP»£Á
(
wd
 -> 
exec
.
£tWÜkšgDœeùÜy
(wd.
toFe
()));

64 
	glog
.
šfo
("Executšg commªd: {}, wÜkDœ: {}", 
commªd
, 
wÜkDœ
);

65 
	gexec
.
execu‹
();

67  
	gout
.
toSŒšg
(
Snd¬dCh¬£ts
.
UTF_8
.
Çme
());

	@it/src/main/java/org/corfudb/universe/node/server/process/ProcessCorfuServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	g´oûss
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gAb¡¿ùCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

15 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

16 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

17 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

18 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

25 @
Slf4j


26 
public
 
şass
 
ProûssCÜfuS”v”
 
ex‹nds
 
	gAb¡¿ùCÜfuS”v”
<
	gCÜfuS”v”P¬ams
, 
	gUniv”£P¬ams
> {

27 
´iv©e
 
fš®
 
IpAdd»ss
 
	gLOCALHOST
 = IpAdd»ss.
bud”
().

("127.0.0.1").
bud
();

29 @
	gNÚNuÎ


30 @
	gDeçuÉ


31 @
G‘‹r


32 
´iv©e
 
fš®
 
IpAdd»ss
 
	gAdd»ss
 = 
LOCALHOST
;

34 @
NÚNuÎ


35 
´iv©e
 
fš®
 
CÜfuProûssMªag”
 
	g´oûssMªag”
;

37 
´iv©e
 
fš®
 
ExecutiÚH–³r
 
	gcommªdH–³r
 = ExecutiÚH–³r.
g‘In¡ªû
();

39 @
Bud”


40 
public
 
ProûssCÜfuS”v”
(

41 @
NÚNuÎ
 
CÜfuS”v”P¬ams
 
·¿ms
, @NÚNuÎ 
Univ”£P¬ams
 
univ”£P¬ams
) {

42 
su³r
(
·¿ms
, 
univ”£P¬ams
);

44 
P©h
 
	gcÜfuDœ
 = 
P©hs
.
g‘
(
Sy¡em
.
g‘Prİ”ty
("user.home"), "corfu");

45 
	gthis
.
	g´oûssMªag”
 = 
Ãw
 
CÜfuProûssMªag”
(
cÜfuDœ
, 
·¿ms
);

53 @
Ov”ride


54 
public
 
CÜfuS”v”
 
d•loy
() {

55 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
ü—‹S”v”DœCommªd
());

56 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
ü—‹SŒ—mLogDœCommªd
());

58 
	gcommªdH–³r
.
cİyFe
(

59 
·¿ms
.
g‘Inäa¡ruùu»J¬
(),

60 
´oûssMªag”
.
g‘S”v”J¬
()

62 
¡¬t
();

63  
	gthis
;

70 @
Ov”ride


71 
public
 
discÚÃù
() {

72 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not supported");

81 @
Ov”ride


82 
public
 
discÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
) {

83 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not supported");

89 @
Ov”ride


90 
public
 
·u£
() {

91 
	glog
.
šfo
("PausšghCÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

93 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
·u£Commªd
());

99 @
Ov”ride


100 
public
 
¡¬t
() {

101 
execu‹Commªd
(

102 
O±iÚ®
.
of
(
´oûssMªag”
.
g‘CÜfuDœ
()),

103 
´oûssMªag”
.
¡¬tCommªd
(
g‘CommªdLšeP¬ams
())

110 @
Ov”ride


111 
public
 
»¡¬t
() {

112 
¡İ
(
·¿ms
.
g‘StİTimeout
());

113 
¡¬t
();

119 @
Ov”ride


120 
public
 
»cÚÃù
() {

121 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not supported");

124 @
Ov”ride


125 
public
 
SŒšg
 
execu‹
(SŒšg 
commªd
) {

126  
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
commªd
);

132 @
Ov”ride


133 
public
 
»cÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
) {

134 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not supported");

140 @
Ov”ride


141 
public
 
»sume
() {

142 
	glog
.
šfo
("ResumšghcÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

144 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
»sumeCommªd
());

150 
´iv©e
 
SŒšg
 
execu‹Commªd
(
O±iÚ®
<
P©h
> 
wÜkDœ
, SŒšg 
cmdLše
) {

151 
	gŒy
 {

152  
	gcommªdH–³r
.
execu‹Commªd
(
wÜkDœ
, 
cmdLše
);

153 } 
ÿtch
 (
IOExû±iÚ
 
e
) {

154 
throw
 
Ãw
 
NodeExû±iÚ
("ExecutiÚƒ¼Ü. Cmd: " + 
cmdLše
, 
e
);

161 @
Ov”ride


162 
public
 
¡İ
(
Du¿tiÚ
 
timeout
) {

163 
	glog
.
šfo
("Stİ cÜfu s”v”. P¬ams: {}", 
·¿ms
);

165 
	gŒy
 {

166 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
¡İCommªd
());

167 } 
ÿtch
 (
Exû±iÚ
 
e
) {

168 
SŒšg
 
	g”r
 = SŒšg.
fÜm©
("Cª'ˆSTOP cÜfu: %s. Proûs nÙ found", 
·¿ms
.
g‘Name
());

169 
throw
 
Ãw
 
NodeExû±iÚ
(
”r
, 
e
);

176 @
Ov”ride


177 
public
 
kl
() {

178 
	glog
.
šfo
("KÈthcÜfu s”v”. P¬ams: {}", 
·¿ms
);

179 
	gŒy
 {

180 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
klCommªd
());

181 } 
ÿtch
 (
Exû±iÚ
 
e
) {

182 
SŒšg
 
	g”r
 = SŒšg.
fÜm©
("Can't KILL corfu: %s. Process‚ot found, ip: %s",

183 
·¿ms
.
g‘Name
(), 
Add»ss


185 
throw
 
Ãw
 
NodeExû±iÚ
(
”r
, 
e
);

194 @
Ov”ride


195 
public
 
de¡roy
() {

196 
	glog
.
šfo
("De¡roy‚ode: {}", 
·¿ms
.
g‘Name
());

197 
kl
();

198 
	gŒy
 {

199 
»moveAµDœ
();

200 } 
ÿtch
 (
Exû±iÚ
 
e
) {

201 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆş—ÀcÜfu dœeùÜ›s", 
e
);

210 
´iv©e
 
»moveAµDœ
() {

211 
execu‹Commªd
(
O±iÚ®
.
em±y
(), 
´oûssMªag”
.
»moveS”v”DœCommªd
());

214 @
Ov”ride


215 
public
 
IpAdd»ss
 
g‘N‘wÜkIÁ”çû
() {

216  
	gAdd»ss
;

	@it/src/main/java/org/corfudb/universe/node/server/vm/VmCorfuServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gvm
.
	gRemÙeO³¿tiÚH–³r
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gAb¡¿ùCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	g´oûss
.
	gCÜfuProûssMªag”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g¡»ss
.
	gvm
.
	gVmSŒess
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmMªag”
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpTabËsUt
;

18 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

19 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

20 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

21 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 @
Slf4j


27 
public
 
şass
 
VmCÜfuS”v”
 
ex‹nds
 
	gAb¡¿ùCÜfuS”v”
<
	gVmCÜfuS”v”P¬ams
, 
	gVmUniv”£P¬ams
> {

29 @
	gNÚNuÎ


30 @
G‘‹r


31 
´iv©e
 
fš®
 
VmMªag”
 
	gvmMªag”
;

33 @
NÚNuÎ


34 
´iv©e
 
fš®
 
IpAdd»ss
 
	gAdd»ss
;

36 @
	gG‘‹r


37 @
NÚNuÎ


38 
´iv©e
 
fš®
 
RemÙeO³¿tiÚH–³r
 
	g»mÙeO³¿tiÚH–³r
;

40 @
NÚNuÎ


41 
´iv©e
 
fš®
 
VmSŒess
 
	g¡»ss
;

43 @
NÚNuÎ


44 
´iv©e
 
fš®
 
CÜfuProûssMªag”
 
	g´oûssMªag”
;

46 @
Bud”


47 
public
 
VmCÜfuS”v”
(

48 
VmCÜfuS”v”P¬ams
 
·¿ms
, 
VmMªag”
 
vmMªag”
, 
VmUniv”£P¬ams
 
univ”£P¬ams
,

49 
VmSŒess
 
¡»ss
, 
RemÙeO³¿tiÚH–³r
 
»mÙeO³¿tiÚH–³r
) {

50 
su³r
(
·¿ms
, 
univ”£P¬ams
);

51 
	gthis
.
	gvmMªag”
 = 
vmMªag”
;

52 
	gthis
.
	gAdd»ss
 = 
g‘IpAdd»ss
();

53 
	gthis
.
	g¡»ss
 = 
¡»ss
;

54 
	gthis
.
	g»mÙeO³¿tiÚH–³r
 = 
»mÙeO³¿tiÚH–³r
;

56 
P©h
 
	gcÜfuDœ
 = 
P©hs
.
g‘
("~");

57 
	gthis
.
	g´oûssMªag”
 = 
Ãw
 
CÜfuProûssMªag”
(
cÜfuDœ
, 
·¿ms
);

65 @
Ov”ride


66 
public
 
CÜfuS”v”
 
d•loy
() {

67 
	glog
.
šfo
("D•loy vm s”v”: {}", 
·¿ms
.
g‘VmName
());

69 
execu‹Commªd
(
´oûssMªag”
.
ü—‹S”v”DœCommªd
());

70 
execu‹Commªd
(
´oûssMªag”
.
ü—‹SŒ—mLogDœCommªd
());

72 
	g»mÙeO³¿tiÚH–³r
.
cİyFe
(

73 
·¿ms
.
g‘Inäa¡ruùu»J¬
(),

74 
´oûssMªag”
.
g‘S”v”J¬
()

77 
¡¬t
();

79  
	gthis
;

86 @
Ov”ride


87 
public
 
discÚÃù
() {

88 
	glog
.
šfo
("DiscÚÃùšghVM s”v”: {} fromhÃtwÜk.", 
·¿ms
.
g‘VmName
());

90 
	guniv”£P¬ams
.
g‘VmIpAdd»s£s
().
v®ues
().
¡»am
()

91 .
f‹r
(
addr
 -> !addr.
equ®s
(
g‘IpAdd»ss
()))

92 .
fÜEach
(
addr
 -> {

93 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
drİIÅut
(
addr
)));

94 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
drİOuut
(
addr
)));

104 @
Ov”ride


105 
public
 
discÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
) {

106 
	glog
.
šfo
("Disconnectinghe VM server: {} fromhe specified servers: {}",

107 
·¿ms
.
g‘Name
(), 
£rv”s
);

109 
	g£rv”s
.
¡»am
()

110 .
f‹r
(
s
 -> !s.
g‘P¬ams
().
equ®s
(
·¿ms
))

111 .
fÜEach
(
s
 -> {

112 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
drİIÅut
(
s
.
g‘IpAdd»ss
())));

113 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
drİOuut
(
s
.
g‘IpAdd»ss
())));

120 @
Ov”ride


121 
public
 
·u£
() {

122 
	glog
.
šfo
("PausšghVM CÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

124 
execu‹Commªd
(
´oûssMªag”
.
·u£Commªd
());

130 @
Ov”ride


131 
public
 
¡¬t
() {

133 
SŒšg
 
	gcmd
 = SŒšg.
fÜm©
(

135 
´oûssMªag”
.
¡¬tCommªd
(
g‘CommªdLšeP¬ams
())

137 
execu‹Commªd
(
cmd
);

143 @
Ov”ride


144 
public
 
»¡¬t
() {

145 
¡İ
(
·¿ms
.
g‘StİTimeout
());

146 
¡¬t
();

152 @
Ov”ride


153 
public
 
»cÚÃù
() {

154 
	glog
.
šfo
("RecÚÃùšghVM s”v”: {}Øthşu¡”.", 
·¿ms
.
g‘VmName
());

156 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
ş—nIÅut
()));

157 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
ş—nOuut
()));

160 @
Ov”ride


161 
public
 
SŒšg
 
execu‹
(SŒšg 
commªd
) {

162  
execu‹Commªd
(
commªd
);

168 @
Ov”ride


169 
public
 
»cÚÃù
(
Li¡
<
CÜfuS”v”
> 
£rv”s
) {

170 
	glog
.
šfo
("Reconnectinghe VM server: {}o specified servers: {}",

171 
·¿ms
.
g‘Name
(), 
£rv”s
);

173 
	g£rv”s
.
¡»am
()

174 .
f‹r
(
s
 -> !s.
g‘P¬ams
().
equ®s
(
·¿ms
))

175 .
fÜEach
(
s
 -> {

176 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
»v”tDrİIÅut
(
s
.
g‘IpAdd»ss
())));

177 
execu‹SudoCommªd
(
SŒšg
.
još
(" ", 
IpTabËsUt
.
»v”tDrİOuut
(
s
.
g‘IpAdd»ss
())));

184 @
Ov”ride


185 
public
 
»sume
() {

186 
	glog
.
šfo
("ResumšghcÜfu s”v”: {}", 
·¿ms
.
g‘Name
());

187 
execu‹Commªd
(
´oûssMªag”
.
»sumeCommªd
());

193 
´iv©e
 
SŒšg
 
execu‹Commªd
(SŒšg 
cmdLše
) {

194  
	g»mÙeO³¿tiÚH–³r
.
execu‹Commªd
(
cmdLše
);

200 
´iv©e
 
SŒšg
 
execu‹SudoCommªd
(SŒšg 
cmdLše
) {

201  
	g»mÙeO³¿tiÚH–³r
.
execu‹SudoCommªd
(
cmdLše
);

207 @
Ov”ride


208 
public
 
IpAdd»ss
 
g‘IpAdd»ss
() {

209  
	gvmMªag”
.
g‘ResŞvedIpAdd»ss
();

215 @
Ov”ride


216 
public
 
¡İ
(
Du¿tiÚ
 
timeout
) {

217 
	glog
.
šfo
("Stİ cÜfu s”v” oÀvm: {},…¬ams: {}", 
·¿ms
.
g‘VmName
(),…arams);

219 
	gŒy
 {

220 
execu‹Commªd
(
´oûssMªag”
.
¡İCommªd
());

221 } 
ÿtch
 (
Exû±iÚ
 
e
) {

222 
SŒšg
 
	g”r
 = SŒšg.
fÜm©
("Can't STOP corfu: %s. Process‚ot found on vm: %s, ip: %s",

223 
·¿ms
.
g‘Name
(),…¬ams.
g‘VmName
(), 
Add»ss


225 
throw
 
Ãw
 
NodeExû±iÚ
(
”r
, 
e
);

232 @
Ov”ride


233 
public
 
kl
() {

234 
	glog
.
šfo
("KÈthcÜfu s”v”. P¬ams: {}", 
·¿ms
);

235 
	gŒy
 {

236 
execu‹Commªd
(
´oûssMªag”
.
klCommªd
());

237 } 
ÿtch
 (
Exû±iÚ
 
e
) {

238 
SŒšg
 
	g”r
 = SŒšg.
fÜm©
("Can't KILL corfu: %s. Process‚ot found on vm: %s, ip: %s",

239 
·¿ms
.
g‘Name
(),…¬ams.
g‘VmName
(), 
Add»ss


241 
throw
 
Ãw
 
NodeExû±iÚ
(
”r
, 
e
);

250 @
Ov”ride


251 
public
 
de¡roy
() {

252 
	glog
.
šfo
("De¡roy‚ode: {}", 
·¿ms
.
g‘Name
());

253 
kl
();

254 
	gŒy
 {

255 
execu‹SudoCommªd
(
IpTabËsUt
.
ş—nAÎ
());

256 
»moveAµDœ
();

257 } 
ÿtch
 (
Exû±iÚ
 
e
) {

258 
throw
 
Ãw
 
NodeExû±iÚ
("Cª'ˆş—ÀcÜfu dœeùÜ›s", 
e
);

267 
´iv©e
 
»moveAµDœ
() {

268 
execu‹Commªd
(
´oûssMªag”
.
»moveS”v”DœCommªd
());

271 @
Ov”ride


272 
public
 
IpAdd»ss
 
g‘N‘wÜkIÁ”çû
() {

273  
	gAdd»ss
;

	@it/src/main/java/org/corfudb/universe/node/server/vm/VmCorfuServerParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
.
	gMode
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
.
	gP”si¡’û
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gNÚNuÎ
;

10 
impÜt
 
	glombok
.
	gToSŒšg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

12 
impÜt
 
	gÜg
.
	g¦f4j
.
	gev’t
.
	gLev–
;

14 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

15 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

16 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

22 @
	gG‘‹r


23 @
Equ®sAndHashCode
(
ÿÎSu³r
 = 
Œue
)

24 @
	$ToSŒšg
(
ÿÎSu³r
 = 
Œue
)

25 
public
 cÏs 
	cVmCÜfuS”v”P¬ams
 
ex‹nds
 
CÜfuS”v”P¬ams
 {

26 @
NÚNuÎ


27 
´iv©e
 
fš®
 
VmName
 
vmName
;

29 @
Bud”


30 
public
 
	$VmCÜfuS”v”P¬ams
(

31 
VmName
 
vmName
, 
pÜt
, 
Mode
 
mode
, 
P”si¡’û
 
³rsi¡’û
,

32 
Lev–
 
logLev–
, 
SŒšg
 
şu¡”Name
, 
Du¿tiÚ
 
¡İTimeout
, SŒšg 
£rv”V”siÚ
,

33 
P©h
 
£rv”J¬DœeùÜy
, 
SŒšg
 
dock”Image
, 
logSizeQuÙaP”ûÁage
) {

35 
	`su³r
(

36 
pÜt
, 
mode
, 
³rsi¡’û
, 
logLev–
, 
şu¡”Name
, 
¡İTimeout
,

37 
O±iÚ®
.
	`em±y
(), 
£rv”V”siÚ
, 
£rv”J¬DœeùÜy
, 
dock”Image
,

38 
logSizeQuÙaP”ûÁage


40 
this
.
vmName
 = vmName;

43 @
Bud”


44 @
Equ®sAndHashCode


45 @
G‘‹r


46 
public
 
şass
 
VmName
 
im¶em’ts
 
Com·¿bË
<VmName> {

50 @
NÚNuÎ


51 
´iv©e
 
fš®
 
SŒšg
 
Çme
;

56 @
NÚNuÎ


57 
´iv©e
 
fš®
 
IÁeg”
 
šdex
;

59 @
Ov”ride


60 
public
 
	`com·»To
(
VmName
 
Ùh”
) {

61  
Çme
.
	`com·»To
(
Ùh”
.name);

64 @
Ov”ride


65 
public
 
SŒšg
 
	`toSŒšg
() {

66  
Çme
;

68 
	}
}

	@it/src/main/java/org/corfudb/universe/node/stress/Stress.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g¡»ss
;

3 
public
 
š‹rçû
 
	gSŒess
 {

8 
¡»ssCPULßd
();

13 
¡»ssIOLßd
();

18 
¡»ssMemÜyLßd
();

23 
¡»ssDiskLßd
();

28 
»Ëa£SŒess
();

	@it/src/main/java/org/corfudb/universe/node/stress/vm/VmStress.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g¡»ss
.
	gvm
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gvm
.
	gRemÙeO³¿tiÚH–³r
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g¡»ss
.
	gSŒess
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmMªag”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
;

13 @
	gSlf4j


14 @
Bud”


15 
public
 cÏs 
	cVmSŒess
 
im¶em’ts
 
	mSŒess
 {

16 @
NÚNuÎ


17 
´iv©e
 
fš®
 
CÜfuS”v”P¬ams
 
	m·¿ms
;

18 @
NÚNuÎ


19 
´iv©e
 
fš®
 
VmMªag”
 
	mvmMªag”
;

20 @
NÚNuÎ


21 
´iv©e
 
fš®
 
RemÙeO³¿tiÚH–³r
 
	mcommªdH–³r
;

22 @
NÚNuÎ


23 
´iv©e
 
fš®
 
VmUniv”£P¬ams
 
	muniv”£P¬ams
;

28 @
Ov”ride


29 
public
 
	$¡»ssCPULßd
() {

30 
log
.
	`šfo
("SŒessšg CPU oÀcÜfu s”v”: {}", 
·¿ms
.
	`g‘Name
());

32 
SŒšg
 
cmd
 = "¡»s -ø" + 
	`g‘NumCpu
();

33 
	`execu‹OnVm
(
cmd
);

39 @
Ov”ride


40 
public
 
	$¡»ssIOLßd
() {

41 
log
.
	`šfo
("SŒessšg I/O oÀcÜfu s”v”: {}", 
·¿ms
.
	`g‘Name
());

43 
SŒšg
 
cmd
 = "¡»s -˜" + 
	`g‘NumCpu
();

44 
	`execu‹OnVm
(
cmd
);

45 
	}
}

50 @
Ov”ride


51 
public
 
	$¡»ssMemÜyLßd
() {

52 
log
.
	`šfo
("SŒessšg MemÜy (RAMèÚ cÜfu s”v”: {}", 
·¿ms
.
	`g‘Name
());

54 
SŒšg
 
cmd
 = "¡»s -m " + 
	`g‘NumCpu
() + " --vm-bytes 1G";

55 
	`execu‹OnVm
(
cmd
);

56 
	}
}

61 @
Ov”ride


62 
public
 
	$¡»ssDiskLßd
() {

63 
log
.
	`šfo
("SŒessšg disk oÀcÜfu s”v”: {}", 
·¿ms
.
	`g‘Name
());

65 
SŒšg
 
cmd
 = "¡»s -d " + 
	`g‘NumCpu
() + " --hdd-bytes 5G";

66 
	`execu‹OnVm
(
cmd
);

67 
	}
}

72 @
Ov”ride


73 
public
 
	$»Ëa£SŒess
() {

74 
log
.
	`šfo
("R–—£h¡»s lßd oÀcÜfu s”v”: {}", 
·¿ms
.
	`g‘Name
());

76 
	`execu‹OnVm
("ps -ef | grep -v grep | grep \"stress\" |‡wk '{print $2}' | xargs kill -9");

77 
	}
}

82 
´iv©e
 
SŒšg
 
	$execu‹OnVm
(
SŒšg
 
cmdLše
) {

83  
commªdH–³r
.
	`execu‹Commªd
(
cmdLše
);

84 
	}
}

86 
´iv©e
 
	$g‘NumCpu
() {

87  
vmMªag”
.
	`g‘Vm
().
	`g‘
().
	`g‘Summ¬y
().
	`g‘CÚfig
().
	`g‘NumCpu
();

88 
	}
}

	@it/src/main/java/org/corfudb/universe/scenario/fixture/Fixture.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
;

11 @
FunùiÚ®IÁ”çû


12 
public
 
š‹rçû
 
	gFixtu»
<
	gT
> {

13 
T
 
d©a
();

	@it/src/main/java/org/corfudb/universe/scenario/fixture/FixtureUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
.
	gCÚš”Resourûs
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
.
	gCÜfuS”v”P¬amsBud”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gS”v”Ut
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmCÜfuS”v”P¬amsBud”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmName
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

24 @
Bud”


25 
public
 cÏs 
	cFixtu»Ut
 {

27 @
DeçuÉ


28 
´iv©e
 
fš®
 
	mO±iÚ®
<
	mIÁeg”
> 
	mš™ŸlPÜt
 = 
O±iÚ®
.
em±y
();

29 
´iv©e
 
	mO±iÚ®
<
	mIÁeg”
> 
	mcu¼PÜt
;

38 
	mImmubËLi¡
<
	mCÜfuS”v”P¬ams
> 
budS”v”s
(

39 
CÜfuClu¡”P¬ams
<
CÜfuS”v”P¬ams
> 
şu¡”
, 
CÜfuS”v”P¬amsBud”
 
£rv”Bud”
) {

41 
	mcu¼PÜt
 = 
š™ŸlPÜt
;

43 
	mLi¡
<
	mCÜfuS”v”P¬ams
> 
	m£rv”sP¬ams
 = 
IÁSŒ—m


44 .
¿ngeClo£d
(1, 
şu¡”
.
g‘NumNodes
())

45 .
m­
(
i
 -> 
g‘PÜt
())

46 .
boxed
()

47 .
sÜ‹d
()

48 .
m­
(
pÜt
 -> 
£rv”Bud”


49 .
pÜt
(port)

50 .
şu¡”Name
(
şu¡”
.
g‘Name
())

51 .
cÚš”Resourûs
(
O±iÚ®
.
of
(
CÚš”Resourûs
.
bud”
().
bud
()))

52 .
£rv”V”siÚ
(
şu¡”
.
g‘S”v”V”siÚ
())

53 .
bud
()

55 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

57  
	mImmubËLi¡
.
cİyOf
(
£rv”sP¬ams
);

67 
´Ùeùed
 
	gImmubËLi¡
<
	gVmCÜfuS”v”P¬ams
> 
budVmS”v”s
(

68 
CÜfuClu¡”P¬ams
<
VmCÜfuS”v”P¬ams
> 
şu¡”
,

69 
VmCÜfuS”v”P¬amsBud”
 
£rv”P¬amsBud”
, 
SŒšg
 
vmNameP»fix
) {

71 
	gcu¼PÜt
 = 
š™ŸlPÜt
;

73 
	gLi¡
<
	gVmCÜfuS”v”P¬ams
> 
	g£rv”sP¬ams
 = 
Ãw
 
A¼ayLi¡
<>();

75 
	gi
 = 0; i < 
	gşu¡”
.
g‘NumNodes
(); i++) {

76 
	gpÜt
 = 
g‘PÜt
();

78 
VmName
 
	gvmName
 = VmName.
bud”
()

79 .
Çme
(
vmNameP»fix
 + (
i
 + 1))

80 .
šdex
(
i
)

81 .
bud
();

83 
VmCÜfuS”v”P¬ams
 
	g£rv”P¬am
 = 
£rv”P¬amsBud”


84 .
şu¡”Name
(
şu¡”
.
g‘Name
())

85 .
vmName
(vmName)

86 .
pÜt
(port)

87 .
£rv”V”siÚ
(
şu¡”
.
g‘S”v”V”siÚ
())

88 .
bud
();

90 
	g£rv”sP¬ams
.
add
(
£rv”P¬am
);

93  
	gImmubËLi¡
.
cİyOf
(
£rv”sP¬ams
);

96 
´iv©e
 
	$g‘PÜt
() {

97 
cu¼PÜt
 = cu¼PÜt.
	`m­
(
ŞdPÜt
 -> oldPort + 1);

98  
cu¼PÜt
.
	`ÜEl£G‘
(
S”v”Ut
::
g‘RªdomO³nPÜt
);

99 
	}
}

	@it/src/main/java/org/corfudb/universe/scenario/fixture/Fixtures.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
.
	gCÜfuClu¡”P¬amsBud”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gSuµÜtClu¡”P¬ams
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gSuµÜtClu¡”P¬ams
.
	gSuµÜtClu¡”P¬amsBud”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gloggšg
.
	gLoggšgP¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeTy³
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCl›ÁP¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCl›ÁP¬ams
.
	gCl›ÁP¬amsBud”
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
.
	gCÜfuS”v”P¬amsBud”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”P¬ams
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gSuµÜtS”v”P¬ams
.
	gSuµÜtS”v”P¬amsBud”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmCÜfuS”v”P¬amsBud”
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmName
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»Ut
.
	gFixtu»UtBud”
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
.
	gUniv”£P¬amsBud”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmCÚfigPrİ”t›sLßd”
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
.
	gC»d’tŸls
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
.
	gVmC»d’tŸlsP¬ams
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
.
	gVmUniv”£P¬amsBud”
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

31 
impÜt
 
	gÜg
.
	g¦f4j
.
	gev’t
.
	gLev–
;

33 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

34 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

36 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

37 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

38 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

39 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

41 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

46 
public
 
š‹rçû
 
	gFixtu»s
 {

48 
IpAdd»ss
 
	gANY_ADDRESS
 = IpAdd»ss.
bud”
().

("0.0.0.0").
bud
();

53 şas 
	cTe¡Fixtu»CÚ¡
 {

56 
public
 
fš®
 
SŒšg
 
	gDEFAULT_STREAM_NAME
 = "stream";

59 
public
 
fš®
 
	gDEFAULT_TABLE_ITER
 = 100;

62 
public
 
fš®
 
	gDEFAULT_WAIT_POLL_ITER
 = 300;

65 
public
 
fš®
 
Du¿tiÚ
 
	gDEFAULT_WAIT_TIME
 = Du¿tiÚ.
ofSecÚds
(1);

67 
´iv©e
 
Te¡Fixtu»CÚ¡
() {

72 @
G‘‹r


73 
şass
 
Univ”£Fixtu»
 
im¶em’ts
 
	gFixtu»
<
	gUniv”£P¬ams
> {

75 
´iv©e
 
fš®
 
Univ”£P¬amsBud”
 
	guniv”£
 = 
Univ”£P¬ams
.
univ”£Bud”
();

77 
´iv©e
 
fš®
 
	gCÜfuClu¡”P¬amsBud”
<
	gCÜfuS”v”P¬ams
> 
	gşu¡”
 = 
CÜfuClu¡”P¬ams


78 .
bud”
();

80 
´iv©e
 
fš®
 
CÜfuS”v”P¬amsBud”
 
	g£rv”
 = 
CÜfuS”v”P¬ams
.
£rv”P¬amsBud”
();

82 
´iv©e
 
fš®
 
SuµÜtS”v”P¬amsBud”
 
	gsuµÜtS”v”
 = 
SuµÜtS”v”P¬ams
.
bud”
();

84 
´iv©e
 
fš®
 
SuµÜtClu¡”P¬amsBud”
 
	gmÚ™ÜšgClu¡”
 = 
SuµÜtClu¡”P¬ams


85 .
bud”
();

87 
´iv©e
 
fš®
 
Cl›ÁP¬amsBud”
 
	gş›Á
 = 
Cl›ÁP¬ams
.
bud”
();

89 
´iv©e
 
fš®
 
Fixtu»UtBud”
 
	gfixtu»UtBud”
 = 
Fixtu»Ut
.
bud”
();

91 
´iv©e
 
fš®
 
	gLoggšgP¬ams
.
LoggšgP¬amsBud”
 
	gloggšg
 = 
LoggšgP¬ams
.
bud”
()

92 .
’abËd
(
çl£
);

94 
´iv©e
 
	gO±iÚ®
<
	gUniv”£P¬ams
> 
	gd©a
 = 
O±iÚ®
.
em±y
();

96 
public
 
Univ”£P¬ams
 
d©a
() {

98 ià(
	gd©a
.
isP»£Á
()) {

99  
	gd©a
.
g‘
();

102 
Univ”£P¬ams
 
	guniv”£P¬ams
 = 
univ”£
.
bud
();

103 
	gCÜfuClu¡”P¬ams
<
	gCÜfuS”v”P¬ams
> 
	gşu¡”P¬ams
 = 
şu¡”
.
bud
();

105 
SuµÜtClu¡”P¬ams
 
	gmÚ™ÜšgClu¡”P¬ams
 = 
mÚ™ÜšgClu¡”
.
bud
();

106 
SuµÜtS”v”P¬ams
 
	gmÚ™ÜšgS”v”P¬ams
 = 
suµÜtS”v”


107 .
şu¡”Name
(
mÚ™ÜšgClu¡”P¬ams
.
g‘Name
())

108 .
nodeTy³
(
NodeTy³
.
METRICS_SERVER
)

109 .
bud
();

111 
Fixtu»Ut
 
	gfixtu»Ut
 = 
fixtu»UtBud”
.
bud
();

112 
	gLi¡
<
	gCÜfuS”v”P¬ams
> 
	g£rv”sP¬ams
 = 
fixtu»Ut
.
budS”v”s
(

113 
şu¡”P¬ams
, 
£rv”


116 
	g£rv”sP¬ams
.
fÜEach
(
şu¡”P¬ams
::
add
);

117 
	guniv”£P¬ams
.
add
(
şu¡”P¬ams
);

119 ià(
	gmÚ™ÜšgS”v”P¬ams
.
isEÇbËd
()) {

120 
	gmÚ™ÜšgClu¡”P¬ams
.
add
(
mÚ™ÜšgS”v”P¬ams
);

121 
	guniv”£P¬ams
.
add
(
mÚ™ÜšgClu¡”P¬ams
);

124 
	gd©a
 = 
O±iÚ®
.
of
(
univ”£P¬ams
);

125  
	guniv”£P¬ams
;

129 @
G‘‹r


130 
şass
 
VmUniv”£Fixtu»
 
im¶em’ts
 
	gFixtu»
<
	gVmUniv”£P¬ams
> {

131 
´iv©e
 
fš®
 
SŒšg
 
	gDEFAULT_VM_PREFIX
 = "corfu-vm-";

133 
´iv©e
 
fš®
 
VmUniv”£P¬amsBud”
 
	guniv”£
;

135 
´iv©e
 
fš®
 
	gCÜfuClu¡”P¬amsBud”
<
	gVmCÜfuS”v”P¬ams
> 
	gşu¡”
 = 
CÜfuClu¡”P¬ams


136 .
bud”
();

138 
´iv©e
 
fš®
 
VmCÜfuS”v”P¬amsBud”
 
	g£rv”s
 = 
VmCÜfuS”v”P¬ams
.
bud”
();

140 
´iv©e
 
fš®
 
Cl›ÁP¬amsBud”
 
	gş›Á
 = 
Cl›ÁP¬ams
.
bud”
();

142 @
S‘‹r


143 
´iv©e
 
SŒšg
 
	gvmP»fix
 = 
DEFAULT_VM_PREFIX
;

145 
´iv©e
 
	gO±iÚ®
<
	gVmUniv”£P¬ams
> 
	gd©a
 = 
O±iÚ®
.
em±y
();

147 
´iv©e
 
fš®
 
Fixtu»UtBud”
 
	gfixtu»UtBud”
 = 
Fixtu»Ut
.
bud”
();

149 
´iv©e
 
fš®
 
Prİ”t›s
 
	gvmPrİ”t›s
 = 
VmCÚfigPrİ”t›sLßd”


150 .
lßdVmPrİ”t›s
()

151 .
g‘
();

153 
public
 
VmUniv”£Fixtu»
() {

154 
Prİ”t›s
 
	güed’tŸls
 = 
VmCÚfigPrİ”t›sLßd”


155 .
lßdVmC»d’tŸlsPrİ”t›s
()

156 .
ÜEl£
(
Ãw
 
Prİ”t›s
());

158 
	g£rv”s


159 .
logLev–
(
Lev–
.
INFO
)

160 .
mode
(
CÜfuS”v”
.
Mode
.
CLUSTER
)

161 .
³rsi¡’û
(
CÜfuS”v”
.
P”si¡’û
.
DISK
)

162 .
¡İTimeout
(
Du¿tiÚ
.
ofSecÚds
(1))

163 .
£rv”J¬DœeùÜy
(
P©hs
.
g‘
("target"))

164 .
dock”Image
(
CÜfuS”v”P¬ams
.
DOCKER_IMAGE_NAME
)

165 .
logSizeQuÙaP”ûÁage
(100);

167 
C»d’tŸls
 
	gvSph”eC»d
 = C»d’tŸls.
bud”
()

168 .
u£ºame
(
üed’tŸls
.
g‘Prİ”ty
("vsphere.username"))

169 .
·sswÜd
(
üed’tŸls
.
g‘Prİ”ty
("vsphere.password"))

170 .
bud
();

172 
C»d’tŸls
 
	gvmC»d
 = C»d’tŸls.
bud”
()

173 .
u£ºame
(
üed’tŸls
.
g‘Prİ”ty
("vm.username"))

174 .
·sswÜd
(
üed’tŸls
.
g‘Prİ”ty
("vm.password"))

175 .
bud
();

177 
VmC»d’tŸlsP¬ams
 
	güed’tŸlP¬ams
 = VmC»d’tŸlsP¬ams.
bud”
()

178 .
vSph”eC»d’tŸls
(
vSph”eC»d
)

179 .
vmC»d’tŸls
(
vmC»d
)

180 .
bud
();

182 
	gLi¡
<
	gSŒšg
> 
	gvSph”eHo¡
 = 
A¼ays


183 .
¡»am
(
vmPrİ”t›s
.
g‘Prİ”ty
("v¥h”e.ho¡").
¥l™
(","))

184 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

186 
	guniv”£
 = 
VmUniv”£P¬ams
.
bud”
()

187 .
vSph”eU¾
(
vmPrİ”t›s
.
g‘Prİ”ty
("vsphere.url"))

188 .
vSph”eHo¡
(vSphereHost)

189 .
ÃtwÜkName
(
vmPrİ”t›s
.
g‘Prİ”ty
("vm.network"))

190 .
‹m¶©eVMName
(
vmPrİ”t›s
.
g‘Prİ”ty
("vm.template", "debian-buster-thin-provisioned"))

191 .
üed’tŸls
(
üed’tŸlP¬ams
)

192 .
ş—nUpEÇbËd
(
Œue
);

195 @
Ov”ride


196 
public
 
VmUniv”£P¬ams
 
d©a
() {

197 ià(
	gd©a
.
isP»£Á
()) {

198  
	gd©a
.
g‘
();

201 
	gvmP»fix
 = 
vmPrİ”t›s
.
g‘Prİ”ty
("vm.´efix", 
vmP»fix
);

203 
	gCÜfuClu¡”P¬ams
<
	gVmCÜfuS”v”P¬ams
> 
	gşu¡”P¬ams
 = 
şu¡”
.
bud
();

205 
Fixtu»Ut
 
	gfixtu»Ut
 = 
fixtu»UtBud”
.
bud
();

206 
	gImmubËLi¡
<
	gVmCÜfuS”v”P¬ams
> 
	g£rv”sP¬ams
 = 
fixtu»Ut
.
budVmS”v”s
(

207 
şu¡”P¬ams
, 
£rv”s
, 
vmP»fix


209 
	g£rv”sP¬ams
.
fÜEach
(
şu¡”P¬ams
::
add
);

211 
	gCÚcu¼’tM­
<
	gVmName
, 
	gIpAdd»ss
> 
	gvmIpAdd»s£s
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

212 
	gi
 = 0; i < 
	gşu¡”P¬ams
.
g‘NumNodes
(); i++) {

213 
VmName
 
	gvmName
 = VmName.
bud”
()

214 .
Çme
(
vmP»fix
 + (
i
 + 1))

215 .
šdex
(
i
)

216 .
bud
();

217 
	gvmIpAdd»s£s
.
put
(
vmName
, 
ANY_ADDRESS
);

220 
VmUniv”£P¬ams
 
	guniv”£P¬ams
 = 
univ”£


221 .
vmIpAdd»s£s
(vmIpAddresses)

222 .
bud
();

224 
	guniv”£P¬ams
.
add
(
şu¡”P¬ams
);

226 
	gd©a
 = 
O±iÚ®
.
of
(
univ”£P¬ams
);

228  
	guniv”£P¬ams
;

	@it/src/main/java/org/corfudb/universe/universe/AbstractUniverse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.universe;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

17 @
Slf4j


18 
public
 
ab¡¿ù
 
şass
 
	gAb¡¿ùUniv”£
<
N
 
ex‹nds
 
	gNodeP¬ams
, 
P
ƒx‹nd 
	gUniv”£P¬ams
>

19 
im¶em’ts
 
	gUniv”£
 {

20 @
	gG‘‹r


21 @
NÚNuÎ


22 
´Ùeùed
 
fš®
 
P
 
	guniv”£P¬ams
;

23 @
G‘‹r


24 
´Ùeùed
 
fš®
 
UUID
 
	guniv”£Id
;

26 
´Ùeùed
 
fš®
 
	gCÚcu¼’tM­
<
	gSŒšg
, 
	gGroup
> 
	ggroups
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

28 
´Ùeùed
 
Ab¡¿ùUniv”£
(
P
 
univ”£P¬ams
) {

29 
	gthis
.
	guniv”£P¬ams
 = 
univ”£P¬ams
;

30 
	gthis
.
	guniv”£Id
 = 
UUID
.
¿ndomUUID
();

32 ià(
	guniv”£P¬ams
.
isCËªUpEÇbËd
()) {

33 
	gRuÁime
.
g‘RuÁime
().
addShutdownHook
(
Ãw
 
Th»ad
(
this
::
shutdown
));

37 
´Ùeùed
 
š™
() {

38 
	guniv”£P¬ams


39 .
g‘Groups
()

40 .
keyS‘
()

41 .
fÜEach
(
groupName
 -> {

42 
GroupP¬ams
 
groupP¬ams
 = 
univ”£P¬ams


43 .
g‘GroupP¬ams
(
groupName
, 
GroupP¬ams
.
şass
);

44 
Group
 
group
 = 
budGroup
(
groupP¬ams
);

45 
groups
.
put
(
groupP¬ams
.
g‘Name
(), 
group
);

49 
´Ùeùed
 
d•loyGroups
() {

50 
	glog
.
šfo
("D•loy groups: {}", 
univ”£P¬ams
.
g‘Groups
().
keyS‘
());

52 
	ggroups
.
v®ues
().
fÜEach
(
Group
::
d•loy
);

55 
´Ùeùed
 
ab¡¿ù
 
Group
 
budGroup
(
GroupP¬ams
<
N
> 
groupP¬ams
);

57 @
Ov”ride


58 
public
 
	gImmubËM­
<
	gSŒšg
, 
	gGroup
> 
groups
() {

59  
	gImmubËM­
.
cİyOf
(
groups
);

62 @
Ov”ride


63 
	gpublic
 <
T
 
ex‹nds
 
	gGroup
> T 
g‘Group
(
SŒšg
 
groupName
) {

64  
	gCÏssUts
.
ÿ¡
(
groups
.
g‘
(
groupName
));

67 
´Ùeùed
 
shutdownGroups
() {

68 
	gImmubËS‘
<
	gSŒšg
> 
	ggroupNames
 = 
univ”£P¬ams
.
g‘Groups
().
keyS‘
();

69 ià(
	ggroupNames
.
isEm±y
()) {

70 
	glog
.
w¬n
("Empty universe,‚othingo shutdown");

74 
	glog
.
šfo
("ShutdowÀ®Èuniv”£ groups: [{}]", 
SŒšg
.
još
(", ", 
groupNames
));

76 
	ggroupNames
.
fÜEach
(
groupName
 -> {

77 
Œy
 {

78 
Group
 
group
 = 
groups
.
g‘
(
groupName
);

79 ià(
group
 =ğ
nuÎ
) {

80 
log
.
w¬n
("Cª'ˆshutdowÀ¨group! Thgrou°dÛ¢'ˆexi¡ šhuniv”£: {}", 
groupName
);

84 
group
.
de¡roy
();

85 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

86 
log
.
šfo
("Cª'ˆ¡İ group: {}", 
groupName
, 
ex
);

	@it/src/main/java/org/corfudb/universe/universe/Universe.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.universe;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
;

20 
public
 
š‹rçû
 
	gUniv”£
 {

28 
Univ”£
 
d•loy
();

35 
shutdown
();

37 
Univ”£
 
add
(
GroupP¬ams
 
groupP¬ams
);

44 
Univ”£P¬ams
 
g‘Univ”£P¬ams
();

51 
	gImmubËM­
<
	gSŒšg
, 
	gGroup
> 
groups
();

53 <
T
 
ex‹nds
 
	gGroup
> T 
g‘Group
(
SŒšg
 
groupName
);

55 
	eUniv”£Mode
 {

56 
	gDOCKER
, 
	gVM
, 
	gPROCESS


	@it/src/main/java/org/corfudb/universe/universe/UniverseException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.universe;

7 
public
 cÏs 
	cUniv”£Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

8 
public
 
	$Univ”£Exû±iÚ
() {

9 
	`su³r
();

12 
public
 
	$Univ”£Exû±iÚ
(
SŒšg
 
mes§ge
) {

13 
	`su³r
(
mes§ge
);

14 
	}
}

16 
public
 
	$Univ”£Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

17 
	`su³r
(
mes§ge
, 
ÿu£
);

18 
	}
}

20 
public
 
	$Univ”£Exû±iÚ
(
ThrowabË
 
ÿu£
) {

21 
	`su³r
(
ÿu£
);

22 
	}
}

24 
´Ùeùed
 
	$Univ”£Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
, 
boŞ—n
 
’abËSuµ»ssiÚ
, boŞ—À
wr™abËSckT¿û
) {

25 
	`su³r
(
mes§ge
, 
ÿu£
, 
’abËSuµ»ssiÚ
, 
wr™abËSckT¿û
);

26 
	}
}

	@it/src/main/java/org/corfudb/universe/universe/UniverseParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.universe;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËSÜ‹dM­
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

8 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
.
	gNÚNuÎ
;

11 
impÜt
 
	glombok
.
	gToSŒšg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

18 @
Bud”
(
toBud”
 = 
Œue
, 
bud”M‘hodName
 = "universeBuilder")

19 @
AÎArgsCÚ¡ruùÜ


20 @
Equ®sAndHashCode


21 @
ToSŒšg


22 
public
 cÏs 
	cUniv”£P¬ams
 {

23 
´iv©e
 
fš®
 
SŒšg
 
NETWORK_PREFIX
 = "CorfuNet-";

25 @
	mG‘‹r


26 @
	mDeçuÉ


27 @
NÚNuÎ


28 
´iv©e
 
fš®
 
SŒšg
 
	mÃtwÜkName
 = 
NETWORK_PREFIX
 + 
UUID
.
¿ndomUUID
().
toSŒšg
();

30 @
	mDeçuÉ


31 @
NÚNuÎ


32 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mGroupP¬ams
> 
	mgroups
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

34 @
	mG‘‹r


35 @
DeçuÉ


36 
´iv©e
 
fš®
 
boŞ—n
 
	mş—nUpEÇbËd
 = 
Œue
;

44 
	mpublic
 <
T
 
ex‹nds
 
	mGroupP¬ams
> T 
g‘GroupP¬ams
(
SŒšg
 
Çme
, 
CÏss
<T> 
groupTy³
) {

45  
	mgroupTy³
.
ÿ¡
(
groups
.
g‘
(
Çme
));

48 
public
 
Univ”£P¬ams
 
	$add
(
GroupP¬ams
 
groupP¬ams
) {

49 
groups
.
	`put
(
groupP¬ams
.
	`g‘Name
(), groupParams);

50  
this
;

51 
	}
}

53 
public
 
	gImmubËM­
<
	gSŒšg
, 
	gGroupP¬ams
> 
	$g‘Groups
() {

54  
ImmubËM­
.
	`cİyOf
(
groups
);

55 
	}
}

57 
public
 
GroupP¬ams
 
	$g‘GroupP¬amByIndex
(
šdex
) {

58  
ImmubËSÜ‹dM­
.
	`cİyOf
(
groups
)

59 .
	`v®ues
()

60 .
	`¡»am
()

61 .
	`sk
(
šdex
)

62 .
	`fšdFœ¡
()

63 .
	`ÜEl£Throw
((è-> 
Ãw
 
	`Univ”£Exû±iÚ
("Grou°nÙ found. Index: " + 
šdex
));

64 
	}
}

	@it/src/main/java/org/corfudb/universe/universe/docker/DockerUniverse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gdock”
;

3 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
;

4 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gN‘wÜkCÚfig
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gClu¡”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gdock”
.
	gDock”CÜfuClu¡”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gdock”
.
	gDock”SuµÜtClu¡”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gloggšg
.
	gLoggšgP¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gAb¡¿ùUniv”£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

18 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

19 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

21 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

27 @
Slf4j


28 
public
 
şass
 
Dock”Univ”£
 
ex‹nds
 
	gAb¡¿ùUniv”£
<
	gNodeP¬ams
, 
	gUniv”£P¬ams
> {

34 
´iv©e
 
fš®
 
FakeDns
 
	gFAKE_DNS
 = FakeDns.
g‘In¡ªû
().
š¡®l
();

35 
´iv©e
 
fš®
 
Dock”Cl›Á
 
	gdock”
;

36 
´iv©e
 
fš®
 
Dock”N‘wÜk
 
	gÃtwÜk
 = 
Ãw
 DockerNetwork();

37 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	gš™Ÿlized
 = 
Ãw
 AtomicBoolean();

38 
´iv©e
 
fš®
 
LoggšgP¬ams
 
	gloggšgP¬ams
;

39 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	gde¡royed
 = 
Ãw
 AtomicBoolean();

41 @
Bud”


42 
public
 
Dock”Univ”£
(
Univ”£P¬ams
 
univ”£P¬ams
, 
Dock”Cl›Á
 
dock”
, 
LoggšgP¬ams
 
loggšgP¬ams
) {

43 
su³r
(
univ”£P¬ams
);

44 
	gthis
.
	gdock”
 = 
dock”
;

45 
	gthis
.
	gloggšgP¬ams
 = 
loggšgP¬ams
;

47 
š™
();

58 @
Ov”ride


59 
public
 
Dock”Univ”£
 
d•loy
() {

60 
	glog
.
šfo
("D•loyšg univ”£: {}", 
univ”£P¬ams
);

62 ià(!
	gš™Ÿlized
.
g‘
()) {

63 
	gÃtwÜk
.
£tup
();

64 
	gš™Ÿlized
.
£t
(
Œue
);

67 
d•loyGroups
();

69  
	gthis
;

72 @
Ov”ride


73 
public
 
shutdown
() {

74 
	glog
.
šfo
("ShutdowÀdock” univ”£: {}", 
univ”£Id
.
toSŒšg
());

76 ià(!
	guniv”£P¬ams
.
isCËªUpEÇbËd
()) {

77 
	glog
.
šfo
("Shutdown is disabled");

81 ià(
	gde¡royed
.
g‘AndS‘
(
Œue
)) {

82 
	glog
.
w¬n
("Docker universe‡lready destroyed");

86 
shutdownGroups
();

89 
	gŒy
 {

90 
	gÃtwÜk
.
shutdown
();

91 } 
ÿtch
 (
Univ”£Exû±iÚ
 
e
) {

92 
	glog
.
debug
("Cª'ˆ»movdock”‚‘wÜk: {}", 
univ”£P¬ams
.
g‘N‘wÜkName
());

96 @
Ov”ride


97 
public
 
Univ”£
 
add
(
GroupP¬ams
 
groupP¬ams
) {

98 
	guniv”£P¬ams
.
add
(
groupP¬ams
);

99 
budGroup
(
groupP¬ams
).
d•loy
();

100  
	gthis
;

103 @
Ov”ride


104 
´Ùeùed
 
Clu¡”
 
budGroup
(
GroupP¬ams
<
NodeP¬ams
> 
groupP¬ams
) {

106 
	ggroupP¬ams
.
g‘Ty³
()) {

108 
	gCORFU_CLUSTER
:

109 
groupP¬ams
.
g‘NodesP¬ams
().
fÜEach
(
node
 ->

110 
FAKE_DNS
.
addFÜw¬dResŞutiÚ
(
node
.
g‘Name
(), 
IÃtAdd»ss
.
g‘LoİbackAdd»ss
())

113  
	gDock”CÜfuClu¡”
.
bud”
()

114 .
univ”£P¬ams
(universeParams)

115 .
·¿ms
(
CÏssUts
.
ÿ¡
(
groupP¬ams
))

116 .
loggšgP¬ams
(loggingParams)

117 .
dock”
(docker)

118 .
bud
();

119 
	gSUPPORT_CLUSTER
:

120 
groupP¬ams
.
g‘NodesP¬ams
().
fÜEach
(
node
 ->

121 
FAKE_DNS
.
addFÜw¬dResŞutiÚ
(
node
.
g‘Name
(), 
IÃtAdd»ss
.
g‘LoİbackAdd»ss
())

124  
	gDock”SuµÜtClu¡”
.
bud”
()

125 .
univ”£P¬ams
(universeParams)

126 .
suµÜtP¬ams
(
CÏssUts
.
ÿ¡
(
groupP¬ams
))

127 .
dock”
(docker)

128 .
bud
();

130 
throw
 
Ãw
 
Univ”£Exû±iÚ
("Unknown‚odeype");

134 
´iv©e
 cÏs 
	cDock”N‘wÜk
 {

135 
´iv©e
 
fš®
 
Logg”
 
	glog
 = 
Logg”FaùÜy
.
g‘Logg”
(
Dock”N‘wÜk
.
şass
);

142 
£tup
() {

143 
SŒšg
 
	gÃtwÜkName
 = 
univ”£P¬ams
.
g‘N‘wÜkName
();

144 
	glog
.
šfo
("S‘u°ÃtwÜk: {}", 
ÃtwÜkName
);

145 
N‘wÜkCÚfig
 
	gÃtwÜkCÚfig
 = N‘wÜkCÚfig.
bud”
()

146 .
checkDu¶iÿ‹
(
Œue
)

147 .
©chabË
(
Œue
)

148 .
Çme
(
ÃtwÜkName
)

149 .
bud
();

151 
	gŒy
 {

152 
	gdock”
.
ü—‹N‘wÜk
(
ÃtwÜkCÚfig
);

153 } 
ÿtch
 (
Exû±iÚ
 
e
) {

154 
throw
 
Ãw
 
Univ”£Exû±iÚ
("CªnÙ s‘u°dock”‚‘wÜk.", 
e
);

163 
shutdown
() {

164 
SŒšg
 
	gÃtwÜkName
 = 
univ”£P¬ams
.
g‘N‘wÜkName
();

165 
	glog
.
šfo
("ShutdowÀÃtwÜk: {}", 
ÃtwÜkName
);

166 
	gŒy
 {

167 
	gdock”
.
»moveN‘wÜk
(
ÃtwÜkName
);

168 } 
ÿtch
 (
Exû±iÚ
 
e
) {

169 
fš®
 
SŒšg
 
	g”r
 = SŒšg.
fÜm©
("CªnÙ shutdowÀdock”‚‘wÜk: %s.", 
ÃtwÜkName
);

170 
throw
 
Ãw
 
Univ”£Exû±iÚ
(
”r
, 
e
);

	@it/src/main/java/org/corfudb/universe/universe/docker/FakeDns.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gdock”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gThrowabËs
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gÃt
.
	gIÃtAdd»s£s
;

6 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

7 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚHªdËr
;

8 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

9 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gM‘hod
;

10 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gProxy
;

11 
impÜt
 
	gjava
.
	gÃt
.
	gIÃtAdd»ss
;

12 
impÜt
 
	gjava
.
	gÃt
.
	gUnknownHo¡Exû±iÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

14 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

32 
public
 cÏs 
	cFakeDns
 {

33 
´iv©e
 
fš®
 
FakeDns
 
	mš¡ªû
 = 
Ãw
 FakeDns();

35 
´iv©e
 
fš®
 
	mM­
<
	mSŒšg
, 
	mIÃtAdd»ss
> 
	mfÜw¬dResŞutiÚs
 = 
Ãw
 
HashM­
<>();

37 
´iv©e
 
fš®
 
	mM­
<
	mIÃtAdd»ss
, 
	mSŒšg
> 
	m»v”£ResŞutiÚs
 = 
Ãw
 
HashM­
<>();

42 
´iv©e
 
boŞ—n
 
	mš¡®Ëd
 = 
çl£
;

44 
´iv©e
 
	$FakeDns
() {

47 
public
 
FakeDns
 
	$g‘In¡ªû
() {

48  
š¡ªû
;

49 
	}
}

51 
public
 
synchrÚized
 
	$addFÜw¬dResŞutiÚ
(
SŒšg
 
ho¡Çme
, 
IÃtAdd»ss
 

) {

52 
fÜw¬dResŞutiÚs
.
	`put
(
ho¡Çme
, 

);

53 
	}
}

58 
public
 
synchrÚized
 
FakeDns
 
	$š¡®l
() {

59 ià(
š¡®Ëd
è 
this
;

60 
Œy
 {

61 
	`š¡®lDns
();

62 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

63 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(
e
);

65 
š¡®Ëd
 = 
Œue
;

67  
this
;

68 
	}
}

70 
´iv©e
 
	$š¡®lDns
(è
throws
 
NoSuchM‘hodExû±iÚ
, 
IÎeg®AcûssExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
,

71 
CÏssNÙFoundExû±iÚ
, 
NoSuchF›ldExû±iÚ
 {

72 
Œy
 {

74 
fš®
 
CÏss
<?> 
ÇmeS”viûIÁ”çû
 = CÏss.
	`fÜName
("java.net.InetAddress$NameService");

75 
F›ld
 
f›ld
 = 
IÃtAdd»ss
.
şass
.
	`g‘Deş¬edF›ld
("nameService");

77 
M‘hod
 
m‘hod
 = 
IÃtAdd»ss
.
şass
.
	`g‘Deş¬edM‘hod
("createNameService");

78 
m‘hod
.
	`£tAcûssibË
(
Œue
);

79 
Objeù
 
çÎbackNameS”viû
 = 
m‘hod
.
	`švoke
(
nuÎ
);

82 
Objeù
 
´oxy
 = 
Proxy
.
	`ÃwProxyIn¡ªû
(

83 
ÇmeS”viûIÁ”çû
.
	`g‘CÏssLßd”
(),

84 
Ãw
 
CÏss
<?>[]{
ÇmeS”viûIÁ”çû
},

85 
Ãw
 
	`NameS”viûLi¡’”
(
çÎbackNameS”viû
)

87 
f›ld
.
	`£tAcûssibË
(
Œue
);

88 
f›ld
.
	`£t
(
IÃtAdd»ss
.
şass
, 
´oxy
);

89 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 | 
NoSuchF›ldExû±iÚ
 
e
) {

91 
fš®
 
CÏss
<?> 
ÇmeS”viûIÁ”çû
 = CÏss.
	`fÜName
("sun.net.spi.nameservice.NameService");

92 
F›ld
 
f›ld
 = 
IÃtAdd»ss
.
şass
.
	`g‘Deş¬edF›ld
("nameServices");

94 
M‘hod
 
m‘hod
 = 
IÃtAdd»ss
.
şass
.
	`g‘Deş¬edM‘hod
("ü—‹NSProvid”", 
SŒšg
.class);

95 
m‘hod
.
	`£tAcûssibË
(
Œue
);

96 
Objeù
 
çÎbackNameS”viû
 = 
m‘hod
.
	`švoke
(
nuÎ
, "default");

99 
Objeù
 
´oxy
 = 
Proxy
.
	`ÃwProxyIn¡ªû
(

100 
ÇmeS”viûIÁ”çû
.
	`g‘CÏssLßd”
(),

101 
Ãw
 
CÏss
<?>[]{
ÇmeS”viûIÁ”çû
},

102 
Ãw
 
	`NameS”viûLi¡’”
(
çÎbackNameS”viû
)

104 
f›ld
.
	`£tAcûssibË
(
Œue
);

106 
f›ld
.
	`£t
(
IÃtAdd»ss
.
şass
, 
A¼ays
.
	`asLi¡
(
´oxy
));

108 
	}
}

115 
´iv©e
 cÏs 
	cNameS”viûLi¡’”
 
im¶em’ts
 
	gInvoÿtiÚHªdËr
 {

117 
´iv©e
 
fš®
 
Objeù
 
	gçÎbackNameS”viû
;

122 
NameS”viûLi¡’”
(
Objeù
 
çÎbackNameS”viû
) {

123 
	gthis
.
	gçÎbackNameS”viû
 = 
çÎbackNameS”viû
;

126 
´iv©e
 
	gIÃtAdd»ss
[] 
lookupAÎHo¡Addr
(
SŒšg
 
ho¡
è
throws
 
	gUnknownHo¡Exû±iÚ
 {

127 
IÃtAdd»ss
 
	gš‘Add»ss
;

128 
synchrÚized
 (
FakeDns
.
this
) {

129 
	gš‘Add»ss
 = 
fÜw¬dResŞutiÚs
.
g‘
(
ho¡
);

131 ià(
	gš‘Add»ss
 !ğ
nuÎ
) {

132  
Ãw
 
IÃtAdd»ss
[]{
š‘Add»ss
};

135 
	gŒy
 {

136 
M‘hod
 
	gm‘hod
 = 
çÎbackNameS”viû
.
g‘CÏss
().
g‘Deş¬edM‘hod
("lookupAÎHo¡Addr", 
SŒšg
.
şass
);

137 
	gm‘hod
.
£tAcûssibË
(
Œue
);

138  (
	gIÃtAdd»ss
[]è
	gm‘hod
.
švoke
(
çÎbackNameS”viû
, 
ho¡
);

139 } 
ÿtch
 (
ReæeùiveO³¿tiÚExû±iÚ
 | 
NoSuchEËm’tExû±iÚ
 | 
Secur™yExû±iÚ
 
e
) {

140 
	gThrowabËs
.
´İag©eIfPossibË
(
e
.
g‘Cau£
(), 
UnknownHo¡Exû±iÚ
.
şass
);

141 
throw
 
Ãw
 
As£¹iÚE¼Ü
("uÃx³ùed„eæeùiÚ issue", 
e
);

145 
´iv©e
 
SŒšg
 
g‘Ho¡ByAddr
(
by‹
[] 
addr
è
throws
 
	gUnknownHo¡Exû±iÚ
 {

146 ià(
	gaddr
[0] == 127) {

147  
IÃtAdd»s£s
.
toAddrSŒšg
(
IÃtAdd»ss
.
g‘ByAdd»ss
(
addr
));

150 
SŒšg
 
	gho¡Çme
;

151 
synchrÚized
 (
FakeDns
.
this
) {

152 
	gho¡Çme
 = 
»v”£ResŞutiÚs
.
g‘
(
IÃtAdd»ss
.
g‘ByAdd»ss
(
addr
));

154 ià(
	gho¡Çme
 !ğ
nuÎ
) {

155  
ho¡Çme
;

158 
	gŒy
 {

159 
M‘hod
 
	gm‘hod
 = 
çÎbackNameS”viû


160 .
g‘CÏss
()

161 .
g‘Deş¬edM‘hod
("g‘Ho¡ByAddr", 
by‹
[].
şass
);

163 
	gm‘hod
.
£tAcûssibË
(
Œue
);

164  (
	gSŒšg
è
	gm‘hod
.
švoke
(
çÎbackNameS”viû
, (
Objeù
è
addr
);

165 } 
ÿtch
 (
ReæeùiveO³¿tiÚExû±iÚ
 | 
NoSuchEËm’tExû±iÚ
 | 
Secur™yExû±iÚ
 
e
) {

166 
	gThrowabËs
.
´İag©eIfPossibË
(
e
.
g‘Cau£
(), 
UnknownHo¡Exû±iÚ
.
şass
);

167 
throw
 
Ãw
 
As£¹iÚE¼Ü
("uÃx³ùed„eæeùiÚ issue", 
e
);

171 @
Ov”ride


172 
public
 
Objeù
 
švoke
(Objeù 
´oxy
, 
M‘hod
 
m‘hod
, Objeù[] 
¬gs
è
throws
 
	gThrowabË
 {

173 
	gm‘hod
.
g‘Name
()) {

175  
lookupAÎHo¡Addr
((
SŒšg
è
¬gs
[0]);

177  
g‘Ho¡ByAddr
((
by‹
[]è
¬gs
[0]);

179 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

	@it/src/main/java/org/corfudb/universe/universe/process/ProcessUniverse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	g´oûss
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gClu¡”
.
	gClu¡”Ty³
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	g´oûss
.
	gProûssCÜfuClu¡”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gAb¡¿ùUniv”£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

28 @
Slf4j


29 
public
 
şass
 
ProûssUniv”£
 
ex‹nds
 
	gAb¡¿ùUniv”£
<
	gNodeP¬ams
, 
	gUniv”£P¬ams
> {

31 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	gde¡royed
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

33 @
Bud”


34 
public
 
ProûssUniv”£
(
Univ”£P¬ams
 
univ”£P¬ams
) {

35 
su³r
(
univ”£P¬ams
);

36 
š™
();

39 @
Ov”ride


40 
public
 
Univ”£
 
d•loy
() {

41 
	glog
.
šfo
("D•loyhuniv”£: {}", 
univ”£Id
);

43 
d•loyGroups
();

45  
	gthis
;

48 @
Ov”ride


49 
´Ùeùed
 
Group
 
budGroup
(
GroupP¬ams
<
NodeP¬ams
> 
groupP¬ams
) {

50 ià(
	ggroupP¬ams
.
g‘Ty³
(è=ğ
Clu¡”Ty³
.
CORFU_CLUSTER
) {

51  
ProûssCÜfuClu¡”
.
bud”
()

52 .
univ”£P¬ams
(universeParams)

53 .
cÜfuClu¡”P¬ams
(
CÏssUts
.
ÿ¡
(
groupP¬ams
))

54 .
bud
();

57 
throw
 
Ãw
 
Univ”£Exû±iÚ
("Unknown‚odeype");

60 @
Ov”ride


61 
public
 
shutdown
() {

62 ià(!
	guniv”£P¬ams
.
isCËªUpEÇbËd
()) {

63 
	glog
.
šfo
("Shutdown is disabled");

67 ià(
	gde¡royed
.
g‘AndS‘
(
Œue
)) {

68 
	glog
.
šfo
("Can't shutdown `process` universe. Already destroyed");

72 
	glog
.
šfo
("ShutdowÀthuniv”£: {},…¬ams: {}", 
univ”£Id
, 
groups
.
keyS‘
());

73 
shutdownGroups
();

76 @
Ov”ride


77 
public
 
Univ”£
 
add
(
GroupP¬ams
 
groupP¬ams
) {

78 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not implemented");

	@it/src/main/java/org/corfudb/universe/universe/vm/ApplianceManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gInv’tÜyNavig©Ü
;

5 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gS”viûIn¡ªû
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gNÚNuÎ
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	g»suÉ
.
	gResuÉ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmName
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gVmUniv”£P¬ams
.
	gC»d’tŸls
;

14 
impÜt
 
	gjava
.
	gÃt
.
	gURL
;

15 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

22 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

28 @
	gBud”


29 @
Slf4j


30 
public
 cÏs 
	cAµlŸnûMªag”
 {

32 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mVmName
, 
	mVmMªag”
> 
	mvms
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

33 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mexecutÜ
 = 
ExecutÜs
.
ÃwCachedTh»adPoŞ
();

35 @
NÚNuÎ


36 
´iv©e
 
fš®
 
VmUniv”£P¬ams
 
	muniv”£P¬ams
;

38 
public
 
	eResourûTy³
 {

39 
HOST_SYSTEM
("HostSystem"),

40 
RESOURCE_TYPE
("ResourcePool"),

41 
DATA_STORE
("Datastore"),

42 
FOLDER
("Folder");

44 
public
 
fš®
 
SŒšg
 
	m»sourû
;

46 
ResourûTy³
(
SŒšg
 
»sourû
) {

47 
	mthis
.
	m»sourû
 = 
»sourû
;

54 
public
 
	$d•loy
() {

55 
log
.
	`šfo
("Vm deployment");

57 
M­
<
VmName
, 
VmMªag”
> 
d•loym’t
 = 
Ãw
 
HashM­
<>();

59 
univ”£P¬ams


60 .
	`g‘VmIpAdd»s£s
()

61 .
	`keyS‘
()

62 .
	`¡»am
()

63 .
	`m­
(
this
::
d•loyVmAsync
)

65 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
())

66 .
	`¡»am
()

67 .
	`m­
(
Com¶‘abËFutu»
::
još
)

68 .
	`fÜEach
(
vm
 -> {

69 
univ”£P¬ams
.
	`upd©eIpAdd»ss
(
vm
.
	`g‘VmName
(), vm.
	`g‘ResŞvedIpAdd»ss
());

70 
d•loym’t
.
	`put
(
vm
.
	`g‘VmName
(), vm);

73 
log
.
	`šfo
("Thd•loyed VM ¬e: {}", 
univ”£P¬ams
.
	`g‘VmIpAdd»s£s
());

75 
vms
.
	`putAÎ
(
d•loym’t
);

76 
	}
}

78 
´iv©e
 
	gCom¶‘abËFutu»
<
	gVmMªag”
> 
	$d•loyVmAsync
(
VmName
 
vmName
) {

79 
log
.
	`šfo
("D•loy vm‡synchrÚou¦y: {}", 
vmName
);

80  
Com¶‘abËFutu»
.
	`suµlyAsync
((è-> 
	`d•loyVm
(
vmName
).
	`g‘
(), 
executÜ
);

81 
	}
}

88 
´iv©e
 
	gResuÉ
<
	gVmMªag”
, 
	gUniv”£Exû±iÚ
> 
	$d•loyVm
(
VmName
 
vmName
) {

89 
log
.
	`šfo
("D•loy VM: {}", 
vmName
);

90  
	`g‘VmMªag”
(
vmName
).
	`æ©M­
(
VmMªag”
::
£tup
);

91 
	}
}

93 
´iv©e
 
	gResuÉ
<
	gVmMªag”
, 
	gUniv”£Exû±iÚ
> 
	$g‘VmMªag”
(
VmName
 
vmName
) {

94 
log
.
	`debug
("G‘ vm mªag” fÜ: {}", 
vmName
);

96  
ResuÉ
.
	`of
(() -> {

97 
Œy
 {

99 
C»d’tŸls
 
vSph”eC»d’tŸls
 = 
univ”£P¬ams


100 .
	`g‘C»d’tŸls
()

101 .
	`g‘VSph”eC»d’tŸls
();

103 
S”viûIn¡ªû
 
si
 = 
Ãw
 
	`S”viûIn¡ªû
(

104 
Ãw
 
	`URL
(
univ”£P¬ams
.
	`g‘VSph”eU¾
()),

105 
vSph”eC»d’tŸls
.
	`g‘U£ºame
(),

106 
vSph”eC»d’tŸls
.
	`g‘PasswÜd
(),

107 
Œue


110  
VmMªag”
.
	`bud”
()

111 .
	`vmName
(
vmName
)

112 .
	`Çvig©Ü
(
Ãw
 
	`Inv’tÜyNavig©Ü
(
si
.
	`g‘RoÙFŞd”
()))

113 .
	`univ”£P¬ams
(
univ”£P¬ams
)

114 .
	`bud
();

115 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

116 
throw
 
Ãw
 
	`Univ”£Exû±iÚ
("Cª'ˆš™ VM Mªag”", 
ex
);

119 
	}
}

121 
public
 
	gImmubËM­
<
	gVmName
, 
	gVmMªag”
> 
	$g‘Vms
() {

122  
ImmubËM­
.
	`cİyOf
(
vms
);

123 
	}
}

125 
	eMªagedEÁ™yTy³
 {

126 
VIRTUAL_MACHINE
("VirtualMachine");

128 
public
 
fš®
 
SŒšg
 
	gty³Name
;

130 
MªagedEÁ™yTy³
(
SŒšg
 
ty³Name
) {

131 
	gthis
.
	gty³Name
 = 
ty³Name
;

	@it/src/main/java/org/corfudb/universe/universe/vm/VmConfigPropertiesLoader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	g»suÉ
.
	gResuÉ
;

6 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

7 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

8 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

9 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

10 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

11 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

16 @
Slf4j


17 
public
 cÏs 
	cVmCÚfigPrİ”t›sLßd”
 {

19 
public
 
fš®
 
P©h
 
	mVM_PROPERTIES
 = 
P©hs
.
g‘
("vm.properties");

20 
public
 
fš®
 
P©h
 
	mVM_CREDENTIALS
 = 
P©hs
.
g‘
("vm.credentials.properties");

22 
´iv©e
 
	$VmCÚfigPrİ”t›sLßd”
() {

26 
public
 
ResuÉ
<
Prİ”t›s
, 
PrİsLßd”Exû±iÚ
> 
	$lßdVmPrİ”t›s
() {

27  
ResuÉ
.
	`of
((è-> 
	`lßdPrİ”t›sFe
(
VM_PROPERTIES
));

28 
	}
}

30 
public
 
	gResuÉ
<
	gPrİ”t›s
, 
	gPrİsLßd”Exû±iÚ
> 
	$lßdVmC»d’tŸlsPrİ”t›s
() {

31  
ResuÉ
.
	`of
((è-> 
	`lßdPrİ”t›sFe
(
VM_CREDENTIALS
));

32 
	}
}

34 
´iv©e
 
Prİ”t›s
 
	$lßdPrİ”t›sFe
(
P©h
 
´İ”t›s
) {

35 
log
.
	`šfo
("Lßd…rİ”t›s: {}", 
´İ”t›s
);

37  
O±iÚ®
.
	`ofNuÎabË
(
CÏssLßd”
.
	`g‘Sy¡emResourû
(
´İ”t›s
.
	`toSŒšg
()))

38 .
	`m­
(
üed’tŸlsU¾
 -> {

39 
Prİ”t›s
 
üed’tŸls
 = 
Ãw
 
	`Prİ”t›s
();

40 
	`Œy
 (
IÅutSŒ—m
 
is
 = 
üed’tŸlsU¾
.
	`İ’SŒ—m
()) {

41 
üed’tŸls
.
	`lßd
(
is
);

42 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

43 
throw
 
Ãw
 
	`PrİsLßd”Exû±iÚ
("Cª'ˆlßd c»d’tŸls", 
e
);

45  
üed’tŸls
;

47 .
	`ÜEl£Throw
((è-> 
Ãw
 
	`PrİsLßd”Exû±iÚ
("CÚfig‚Ù found: " + 
´İ”t›s
));

48 
	}
}

50 
public
 şas 
	cPrİsLßd”Exû±iÚ
 
ex‹nds
 
	gRuÁimeExû±iÚ
 {

51 
public
 
PrİsLßd”Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

52 
su³r
(
mes§ge
, 
ÿu£
);

55 
public
 
PrİsLßd”Exû±iÚ
(
SŒšg
 
mes§ge
) {

56 
su³r
(
mes§ge
);

	@it/src/main/java/org/corfudb/universe/universe/vm/VmManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gM­s
;

5 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gGue¡Info
;

6 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gMªagedObjeùReã»nû
;

7 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gTaskInfo
;

8 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gVœtu®MachšeClÚeS³c
;

9 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gVœtu®MachšePow”S‹
;

10 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gVœtu®MachšeR–oÿ‹S³c
;

11 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gFŞd”
;

12 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gHo¡Sy¡em
;

13 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gInv’tÜyNavig©Ü
;

14 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gTask
;

15 
impÜt
 
	gcom
.
	gvmw¬e
.
	gvim25
.
	gmo
.
	gVœtu®Machše
;

16 
impÜt
 
	glombok
.
	gBud”
;

17 
impÜt
 
	glombok
.
	gG‘‹r
;

18 
impÜt
 
	glombok
.
	gNÚNuÎ
;

19 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	g»suÉ
.
	gResuÉ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmName
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gAµlŸnûMªag”
.
	gMªagedEÁ™yTy³
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gAµlŸnûMªag”
.
	gResourûTy³
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

28 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

29 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

30 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gAµlŸnûMªag”
.
	gResourûTy³
.
	gDATA_STORE
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gAµlŸnûMªag”
.
	gResourûTy³
.
	gHOST_SYSTEM
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
.
	gAµlŸnûMªag”
.
	gResourûTy³
.
	gRESOURCE_TYPE
;

41 @
	gBud”


42 @
Slf4j


43 
public
 cÏs 
	cVmMªag”
 {

45 @
	mNÚNuÎ


46 @
G‘‹r


47 
´iv©e
 
fš®
 
VmName
 
	mvmName
;

52 @
NÚNuÎ


53 
´iv©e
 
fš®
 
Inv’tÜyNavig©Ü
 
	mÇvig©Ü
;

55 @
NÚNuÎ


56 
´iv©e
 
fš®
 
VmUniv”£P¬ams
 
	muniv”£P¬ams
;

63 
public
 
	mResuÉ
<
	mVmMªag”
, 
	mUniv”£Exû±iÚ
> 
	$£tup
() {

64 
log
.
	`šfo
("S‘u°vm: {}", 
vmName
);

66  
	`fšdVm
(
vmName
.
	`g‘Name
()).
	`æ©M­
(
this
::
£tupAùiÚ
);

69 
´iv©e
 
ResuÉ
<
VmMªag”
, 
Univ”£Exû±iÚ
> 
	`£tupAùiÚ
(
O±iÚ®
<
Vœtu®Machše
> 
maybeVm
) {

70  
maybeVm


71 .
	`m­
(
this
::
şÚeAndPow”On
)

73 .
	`ÜEl£G‘
((è-> 
	`şÚeVm
().
	`m­
(
skInfo
 -> 
this
));

74 
	}
}

76 
public
 
	gResuÉ
<
	gVoid
, 
	gUniv”£Exû±iÚ
> 
	$shutdown
() {

77  
	`g‘Vm
().
	`æ©M­
(
vm
 -> 
ResuÉ
.
	`of
(() -> {

78 
Œy
 {

79 
vm
.
	`shutdownGue¡
();

80 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

81 
throw
 
Ãw
 
	`Univ”£Exû±iÚ
(
e
);

84  
nuÎ
;

86 
	}
}

88 
public
 
	gResuÉ
<
	gVoid
, 
	gUniv”£Exû±iÚ
> 
	$»boÙ
() {

89  
	`g‘Vm
().
	`æ©M­
(
vm
 -> 
ResuÉ
.
	`of
(() -> {

90 
Œy
 {

91 
vm
.
	`»boÙGue¡
();

92 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

93 
throw
 
Ãw
 
	`Univ”£Exû±iÚ
(
e
);

96  
nuÎ
;

98 
	}
}

100 
public
 
	gResuÉ
<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
> 
	$»£t
() {

101  
	`g‘Vm
().
	`æ©M­
(
vm
 -> 
	`execu‹Task
(vm::
»£tVM_Task
));

102 
	}
}

104 
public
 
	gResuÉ
<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
> 
	$pow”Off
() {

105  
	`g‘Vm
().
	`æ©M­
(
vm
 -> 
	`execu‹Task
(vm::
pow”OffVM_Task
));

106 
	}
}

108 
public
 
	gResuÉ
<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
> 
	$de¡roy
() {

109  
	`g‘Vm
().
	`æ©M­
(
vm
 -> 
	`execu‹Task
(vm::
de¡roy_Task
));

110 
	}
}

112 
public
 
	gCom¶‘abËFutu»
<
	gIpAdd»ss
> 
	$g‘IpAdd»ss
() {

113 
log
.
	`šfo
("G‘tšg IP‡dd»s fÜ {} from DHCP...¶—£ wa™...", 
vmName
);

115  
Com¶‘abËFutu»
.
	`suµlyAsync
(() -> {

116 
O±iÚ®
<
SŒšg
> 
Add»ss
 = O±iÚ®.
	`em±y
();

117 !
Add»ss
.
	`isP»£Á
()) {

118 
log
.
	`šfo
("Wa™šg fÜ i°add»ss. Vm: {}", 
vmName
);

120 
Œy
 {

121 
TimeUn™
.
SECONDS
.
	`¦“p
(
univ”£P¬ams
.
	`g‘R—dšessTimeout
().
	`g‘SecÚds
());

122 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

123 
Th»ad
.
	`cu¼’tTh»ad
().
	`š‹¼u±
();

124 
throw
 
Ãw
 
	`Univ”£Exû±iÚ
("E¼Ü ", 
e
);

127 
Add»ss
 = 
	`g‘Vm
()

128 .
	`æ©M­
(
vm
 -> 
ResuÉ
.
	`of
(vm::
g‘Gue¡
))

129 .
	`m­
(
Gue¡Info
::
g‘IpAdd»ss
)

130 .
	`m­
(
O±iÚ®
::
of
)

131 .
	`ÜEl£
(
O±iÚ®
.
	`em±y
());

134  
IpAdd»ss
.
	`bud”
().
	`
(
Add»ss
.
	`g‘
()).
	`bud
();

136 
	}
}

138 
public
 
IpAdd»ss
 
	$g‘ResŞvedIpAdd»ss
() {

139  
	`g‘IpAdd»ss
().
	`još
();

140 
	}
}

142 
public
 
	gResuÉ
<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
> 
	$pow”On
() {

143 
log
.
	`šfo
("Pow” oÀvm: {}", 
vmName
);

145  
	`g‘Vm
().
	`æ©M­
(
vm
 -> 
	`execu‹Task
(() -> {

146 
log
.
	`šfo
("Pow”šg oÀthvm: {} ...", 
vmName
);

148 
Ho¡Sy¡em
 
ho¡Sy¡em
 = (Ho¡Sy¡emè
Çvig©Ü


149 .
	`£¬chMªagedEÁ™y
(
HOST_SYSTEM
.
»sourû
, "host");

151  
vm
.
	`pow”OnVM_Task
(
ho¡Sy¡em
);

153 
	}
}

155 
public
 
	gResuÉ
<
	gVœtu®Machše
, 
	gUniv”£Exû±iÚ
> 
	$g‘Vm
() {

156  
	`g‘Vm
(
vmName
.
	`g‘Name
());

157 
	}
}

159 
´iv©e
 
	gResuÉ
<
	gVœtu®Machše
, 
	gUniv”£Exû±iÚ
> 
	$g‘Vm
(
SŒšg
 
Çme
) {

160  
	`fšdVm
(
Çme
).
	`æ©M­
(
maybeVm
 -> {

161 ià(
maybeVm
.
	`isP»£Á
()) {

162  
ResuÉ
.
	`ok
(
maybeVm
.
	`g‘
());

164  
ResuÉ
.
	`”rÜ
(
	`vmNÙFoundE¼Ü
());

167 
	}
}

174 
´iv©e
 
	gResuÉ
<
	gO±iÚ®
<
	gVœtu®Machše
>, 
	gUniv”£Exû±iÚ
> 
	$fšdVm
(
SŒšg
 
Çme
) {

175 
log
.
	`debug
("Fšd vm: {}", 
Çme
);

177  
ResuÉ
.
	`of
(() -> {

178 
Œy
 {

179 
Vœtu®Machše
 
vm
 = (Vœtu®Machšeè
Çvig©Ü
.
	`£¬chMªagedEÁ™y
(

180 
MªagedEÁ™yTy³
.
VIRTUAL_MACHINE
.
ty³Name
, 
Çme


182  
O±iÚ®
.
	`ofNuÎabË
(
vm
);

183 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

184 
throw
 
Ãw
 
	`Univ”£Exû±iÚ
("Cª'ˆfšd‡ vm: " + 
vmName
, 
e
);

187 
	}
}

189 
´iv©e
 
	gResuÉ
<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
> 
execu‹Task
(
VmSuµl›r
<
Task
> 
aùiÚ
) {

190  
	gResuÉ
.<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
>
of
(() -> {

191 
Œy
 {

192 
Task
 
sk
 = 
aùiÚ
.
g‘
();

193 
sk
.
wa™FÜTask
();

194  
sk
.
g‘TaskInfo
();

195 } 
ÿtch
 (
Univ”£Exû±iÚ
 
ex
) {

196 
throw
 
ex
;

197 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

198 
throw
 
Ãw
 
Univ”£Exû±iÚ
(
ex
);

200 }).
m­
(
skInfo
 -> {

201 ià(
skInfo
.
g‘E¼Ü
(è!ğ
nuÎ
) {

202 
throw
 
Ãw
 
Univ”£Exû±iÚ
(
skInfo
.
g‘E¼Ü
().
g‘LoÿlizedMes§ge
());

205  
skInfo
;

214 
public
 
	gResuÉ
<
	gTaskInfo
, 
	gUniv”£Exû±iÚ
> 
	$şÚeVm
() {

215 
log
.
	`šfo
("ClÚvm: {}", 
vmName
);

218  
	`g‘Vm
(
univ”£P¬ams
.
	`g‘Tem¶©eVMName
()).
	`æ©M­
(
vmTem¶©e
 -> {

219 
log
.
	`šfo
("ClÚšghVM {} vŸ vSph”{}", 
vmName
, 
univ”£P¬ams
.
	`g‘VSph”eU¾
());

221 
Œy
 {

223 
Prİ”t›s
 
vmPrİsResuÉ
 = 
VmCÚfigPrİ”t›sLßd”


224 .
	`lßdVmPrİ”t›s
()

225 .
	`g‘
();

227 
ImmubËM­
<
SŒšg
, SŒšg> 
vmPrİs
 = 
M­s
.
	`äomPrİ”t›s
(
vmPrİsResuÉ
);

230 
Vœtu®MachšeClÚeS³c
 
şÚeS³c
 = 
	`ü—‹LšuxCu¡omiz©iÚ
(
vmPrİs
);

232 
SŒšg
 
fŞd”Prİ
 = SŒšg.
	`fÜm©
(

233 "vm%d.%s", 
vmName
.
	`g‘Index
(), 
ResourûTy³
.
FOLDER
.
»sourû


236 
FŞd”
 
fŞd”
;

237 ià(
vmPrİs
.
	`cÚšsKey
(
fŞd”Prİ
)) {

238 
MªagedObjeùReã»nû
 
fŞd”R
 = 
Ãw
 
	`MªagedObjeùReã»nû
();

239 
fŞd”R
.
	`£tTy³
(
ResourûTy³
.
FOLDER
.
»sourû
);

241 
SŒšg
 
´İ
 = 
vmPrİs
.
	`g‘
(
fŞd”Prİ
);

242 
fŞd”R
.
	`£tV®
(
´İ
);

244 
fŞd”
 = 
Ãw
 
	`FŞd”
(
vmTem¶©e
.
	`g‘S”v”CÚÃùiÚ
(), 
fŞd”R
);

246 
fŞd”
 = (
FŞd”
è
vmTem¶©e
.
	`g‘P¬’t
();

249  
	`execu‹Task
((è-> 
vmTem¶©e
.
	`şÚeVM_Task
(
fŞd”
, 
vmName
.
	`g‘Name
(), 
şÚeS³c
));

250 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
ex
) {

251  
ResuÉ
.
	`”rÜ
(
Ãw
 
	`Univ”£Exû±iÚ
(
ex
));

254 
	}
}

261 
´iv©e
 
Vœtu®MachšeClÚeS³c
 
ü—‹LšuxCu¡omiz©iÚ
(
ImmubËM­
<
SŒšg
, SŒšg> 
´İs
) {

262 
	glog
.
šfo
("C»©lšux cu¡omiz©iÚ fÜ: {}", 
vmName
);

263 
	gšdex
 = 
vmName
.
g‘Index
();

265 
Vœtu®MachšeClÚeS³c
 
	gvmClÚeS³c
 = 
Ãw
 VirtualMachineCloneSpec();

267 
SŒšg
 
	gho¡Key
 = SŒšg.
fÜm©
("vm%d.%s", 
šdex
, 
HOST_SYSTEM
.
»sourû
);

268 
SŒšg
 
	gdsKey
 = SŒšg.
fÜm©
("vm%d.%s", 
šdex
, 
DATA_STORE
.
»sourû
);

269 
SŒšg
 
	g»sourûTy³Key
 = SŒšg.
fÜm©
("vm%d.%s", 
šdex
, 
RESOURCE_TYPE
.
»sourû
);

272 
Vœtu®MachšeR–oÿ‹S³c
 
	gvmR–oÿ‹S³c
 = 
Ãw
 VirtualMachineRelocateSpec();

274 ià(
	g´İs
.
keyS‘
().
cÚšsAÎ
(
A¼ays
.
asLi¡
(
ho¡Key
, 
dsKey
, 
»sourûTy³Key
))) {

275 
MªagedObjeùReã»nû
 
	gho¡
 = 
Ãw
 ManagedObjectReference();

276 
	gho¡
.
£tTy³
(
HOST_SYSTEM
.
»sourû
);

277 
	gho¡
.
£tV®
(
´İs
.
g‘
(
ho¡Key
));

278 
	gvmR–oÿ‹S³c
.
£tHo¡
(
ho¡
);

280 
MªagedObjeùReã»nû
 
	gd©aStÜe
 = 
Ãw
 ManagedObjectReference();

281 
	gd©aStÜe
.
£tTy³
(
DATA_STORE
.
»sourû
);

282 
	gd©aStÜe
.
£tV®
(
´İs
.
g‘
(
dsKey
));

283 
	gvmR–oÿ‹S³c
.
£tD©a¡Üe
(
d©aStÜe
);

285 
MªagedObjeùReã»nû
 
	gpoŞ
 = 
Ãw
 ManagedObjectReference();

286 
	gpoŞ
.
£tTy³
(
RESOURCE_TYPE
.
»sourû
);

287 
	gpoŞ
.
£tV®
(
´İs
.
g‘
(
»sourûTy³Key
));

288 
	gvmR–oÿ‹S³c
.
£tPoŞ
(
poŞ
);

291 
	gvmClÚeS³c
.
£tLoÿtiÚ
(
vmR–oÿ‹S³c
);

294 
	gvmClÚeS³c
.
£tPow”On
(
Œue
);

295 
	gvmClÚeS³c
.
£tTem¶©e
(
çl£
);

296  
	gvmClÚeS³c
;

299 
´iv©e
 
	gResuÉ
<
	gVmMªag”
, 
	gUniv”£Exû±iÚ
> 
	$şÚeAndPow”On
(
Vœtu®Machše
 
vm
) {

300 
Œy
 {

301 
Vœtu®MachšePow”S‹
 
pow”S‹
 = 
vm
.
	`g‘Summ¬y
().
ruÁime
.powerState;

302 ià(
pow”S‹
 =ğ
Vœtu®MachšePow”S‹
.
pow”edOn
) {

303  
ResuÉ
.
	`ok
(
this
);

305  
	`pow”On
().
	`m­
(
skInfo
 -> 
this
);

307 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
ex
) {

308  
ResuÉ
.
	`”rÜ
(
Ãw
 
	`Univ”£Exû±iÚ
(
ex
));

310 
	}
}

312 
´iv©e
 
Univ”£Exû±iÚ
 
	$vmNÙFoundE¼Ü
() {

313  
Ãw
 
	`Univ”£Exû±iÚ
("A vm‚Ù found: " + 
vmName
);

314 
	}
}

316 @
FunùiÚ®IÁ”çû


317 
public
 
š‹rçû
 
	gVmSuµl›r
<
	gT
> {

324 
T
 
g‘
(è
throws
 
	gExû±iÚ
;

	@it/src/main/java/org/corfudb/universe/universe/vm/VmUniverse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gGroup
.
	gGroupP¬ams
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gClu¡”
.
	gClu¡”Ty³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gvm
.
	gVmCÜfuClu¡”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNode
.
	gNodeP¬ams
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gAb¡¿ùUniv”£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

28 @
Slf4j


29 
public
 
şass
 
VmUniv”£
 
ex‹nds
 
	gAb¡¿ùUniv”£
<
	gNodeP¬ams
, 
	gVmUniv”£P¬ams
> {

31 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	gde¡royed
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

33 @
	gNÚNuÎ


34 @
G‘‹r


35 
´iv©e
 
fš®
 
AµlŸnûMªag”
 
	g­¶ŸnûMªag”
;

37 @
Bud”


38 
public
 
VmUniv”£
(
VmUniv”£P¬ams
 
univ”£P¬ams
, 
AµlŸnûMªag”
 
­¶ŸnûMªag”
) {

39 
su³r
(
univ”£P¬ams
);

40 
	gthis
.
	g­¶ŸnûMªag”
 = 
­¶ŸnûMªag”
;

42 
	g­¶ŸnûMªag”
.
d•loy
();

43 
š™
();

52 @
Ov”ride


53 
public
 
VmUniv”£
 
d•loy
() {

54 
	glog
.
šfo
("D•loyhuniv”£: {}", 
univ”£Id
);

56 
d•loyGroups
();

58  
	gthis
;

64 @
Ov”ride


65 
´Ùeùed
 
Group
 
budGroup
(
GroupP¬ams
 
groupP¬ams
) {

66 ià(
	ggroupP¬ams
.
g‘Ty³
(è!ğ
Clu¡”Ty³
.
CORFU_CLUSTER
) {

67 
throw
 
Ãw
 
Univ”£Exû±iÚ
("UnknowÀnodty³: " + 
groupP¬ams
.
g‘Ty³
());

70  
	gVmCÜfuClu¡”
.
bud”
()

71 .
univ”£P¬ams
(universeParams)

72 .
cÜfuClu¡”P¬ams
(
CÏssUts
.
ÿ¡
(
groupP¬ams
))

73 .
vms
(
­¶ŸnûMªag”
.
g‘Vms
())

74 .
bud
();

81 @
Ov”ride


82 
public
 
shutdown
() {

83 ià(!
	guniv”£P¬ams
.
isCËªUpEÇbËd
()) {

84 
	glog
.
šfo
("Shutdown is disabled");

88 ià(
	gde¡royed
.
g‘AndS‘
(
Œue
)) {

89 
	glog
.
šfo
("Can't shutdown vm universe. Already destroyed");

93 
	glog
.
šfo
("ShutdowÀthuniv”£: {},…¬ams: {}", 
univ”£Id
, 
groups
);

94 
shutdownGroups
();

97 @
Ov”ride


98 
public
 
Univ”£
 
add
(
GroupP¬ams
 
groupP¬ams
) {

99 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not implemented");

	@it/src/main/java/org/corfudb/universe/universe/vm/VmUniverseParams.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gvm
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

7 
impÜt
 
	glombok
.
	gToSŒšg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gvm
.
	gVmCÜfuS”v”P¬ams
.
	gVmName
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
.
	gIpAdd»ss
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

21 @
	gG‘‹r


22 @
	$ToSŒšg
(
ÿÎSu³r
 = 
Œue
)

23 
public
 cÏs 
	cVmUniv”£P¬ams
 
ex‹nds
 
Univ”£P¬ams
 {

28 @
NÚNuÎ


29 
´iv©e
 
fš®
 
SŒšg
 
vSph”eU¾
;

34 @
NÚNuÎ


35 
´iv©e
 
fš®
 
Li¡
<
SŒšg
> 
vSph”eHo¡
;

37 @
NÚNuÎ


38 
´iv©e
 
fš®
 
VmC»d’tŸlsP¬ams
 
üed’tŸls
;

40 @
NÚNuÎ


41 
´iv©e
 
fš®
 
SŒšg
 
‹m¶©eVMName
;

43 @
NÚNuÎ


44 
´iv©e
 
fš®
 
CÚcu¼’tM­
<
VmName
, 
IpAdd»ss
> 
vmIpAdd»s£s
;

45 @
NÚNuÎ


46 @
DeçuÉ


47 
´iv©e
 
fš®
 
SŒšg
 
domašName
 = "eng.vmware.com";

48 @
NÚNuÎ


49 @
DeçuÉ


50 
´iv©e
 
fš®
 
SŒšg
 
timeZÚe
 = "America/Los_Angeles";

51 @
NÚNuÎ


52 @
DeçuÉ


53 
´iv©e
 
fš®
 
SŒšg
[] 
dnsS”v”s
 = 
Ãw
 String[]{"10.172.40.1", "10.172.40.2"};

54 @
NÚNuÎ


55 @
DeçuÉ


56 
´iv©e
 
fš®
 
SŒšg
[] 
domašSuffixes
 = 
Ãw
 SŒšg[]{"’g.vmw¬e.com", "vmw¬e.com"
	}
};

57 @
	gNÚNuÎ


58 @
DeçuÉ


59 
´iv©e
 
fš®
 
	gSŒšg
[] 
	gg©eways
 = 
Ãw
 
SŒšg
[]{"10.172.211.253"};

60 @
	gNÚNuÎ


61 @
DeçuÉ


62 
´iv©e
 
fš®
 
SŒšg
 
	gsubÃt
 = "255.255.255.0";

63 @
	gNÚNuÎ


64 @
DeçuÉ


65 
´iv©e
 
fš®
 
Du¿tiÚ
 
	g»adšessTimeout
 = Du¿tiÚ.
ofSecÚds
(3);

67 @
Bud”


68 
public
 
VmUniv”£P¬ams
(

69 
VmC»d’tŸlsP¬ams
 
üed’tŸls
, 
SŒšg
 
vSph”eU¾
, 
Li¡
<SŒšg> 
vSph”eHo¡
,

70 
SŒšg
 
‹m¶©eVMName
, 
CÚcu¼’tM­
<
VmName
, 
IpAdd»ss
> 
vmIpAdd»s£s
, SŒšg 
ÃtwÜkName
,

71 
boŞ—n
 
ş—nUpEÇbËd
) {

72 
su³r
(
ÃtwÜkName
, 
Ãw
 
CÚcu¼’tHashM­
<>(), 
ş—nUpEÇbËd
);

73 
	gthis
.
	gvSph”eU¾
 = 
vSph”eU¾
;

74 
	gthis
.
	gvSph”eHo¡
 = 
vSph”eHo¡
;

75 
	gthis
.
	g‹m¶©eVMName
 = 
‹m¶©eVMName
;

76 
	gthis
.
	gvmIpAdd»s£s
 = 
vmIpAdd»s£s
;

77 
	gthis
.
	güed’tŸls
 = 
üed’tŸls
;

81 
public
 
VmUniv”£P¬ams
 
	$upd©eIpAdd»ss
(
VmName
 
vmName
, 
IpAdd»ss
 
Add»ss
) {

82 
vmIpAdd»s£s
.
	`put
(
vmName
, 
Add»ss
);

83  
this
;

84 
	}
}

97 @
	gBud”


98 @
G‘‹r


99 
public
 şas 
	cVmC»d’tŸlsP¬ams
 {

100 @
NÚNuÎ


101 
´iv©e
 
fš®
 
C»d’tŸls
 
	gvmC»d’tŸls
;

102 @
NÚNuÎ


103 
´iv©e
 
fš®
 
C»d’tŸls
 
	gvSph”eC»d’tŸls
;

106 @
	gBud”


107 @
G‘‹r


108 
public
 şas 
	cC»d’tŸls
 {

109 @
NÚNuÎ


110 
´iv©e
 
fš®
 
SŒšg
 
	gu£ºame
;

111 @
NÚNuÎ


112 
´iv©e
 
fš®
 
SŒšg
 
	g·sswÜd
;

	@it/src/main/java/org/corfudb/universe/util/DockerManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
;

3 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gDock”Cl›Á
;

4 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gexû±iÚs
.
	gDock”Exû±iÚ
;

5 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gCÚš”Info
;

6 
impÜt
 
	gcom
.
	g¥Ùify
.
	gdock”
.
	gş›Á
.
	gmes§ges
.
	gExecC»©iÚ
;

7 
impÜt
 
	glombok
.
	gBud”
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gNodeExû±iÚ
;

12 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

17 @
	gBud”


18 @
Slf4j


19 
public
 cÏs 
	cDock”Mªag”
 {

21 @
NÚNuÎ


22 
´iv©e
 
fš®
 
Dock”Cl›Á
 
	mdock”
;

30 
public
 
	$¡İ
(
SŒšg
 
cÚš”Name
, 
Du¿tiÚ
 
timeout
) {

31 
log
.
	`šfo
("StİpšghCÜfu s”v”. Dock” cÚš”: {}", 
cÚš”Name
);

33 
Œy
 {

34 
CÚš”Info
 
cÚš”
 = 
dock”
.
	`š¥eùCÚš”
(
cÚš”Name
);

35 ià(!
cÚš”
.
	`¡©e
().
	`ruÂšg
(è&& !cÚš”.¡©e().
	`·u£d
()) {

36 
log
.
	`w¬n
("ThcÚš” `{}` i ®»ady stİ³d", 
cÚš”
.
	`Çme
());

39 
dock”
.
	`¡İCÚš”
(
cÚš”Name
, (è
timeout
.
	`g‘SecÚds
());

40 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
e
) {

41 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆ¡İ CÜfu s”v”: " + 
cÚš”Name
, 
e
);

50 
public
 
	$kl
(
SŒšg
 
cÚš”Name
) {

51 
log
.
	`šfo
("Klšg dock” cÚš”: {}", 
cÚš”Name
);

53 
Œy
 {

54 
CÚš”Info
 
cÚš”
 = 
dock”
.
	`š¥eùCÚš”
(
cÚš”Name
);

56 ià(!
cÚš”
.
	`¡©e
().
	`ruÂšg
(è&& !cÚš”.¡©e().
	`·u£d
()) {

57 
log
.
	`w¬n
("ThcÚš” `{}` i nÙ„uÂšg", 
cÚš”
.
	`Çme
());

60 
dock”
.
	`klCÚš”
(
cÚš”Name
);

61 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

62 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆkÈCÜfu s”v”: " + 
cÚš”Name
, 
ex
);

64 
	}
}

71 
public
 
	$de¡roy
(
SŒšg
 
cÚš”Name
) {

72 
log
.
	`šfo
("De¡royšg dock” cÚš”: {}", 
cÚš”Name
);

74 
Œy
 {

75 
	`kl
(
cÚš”Name
);

76 } 
	`ÿtch
 (
NodeExû±iÚ
 
ex
) {

77 
log
.
	`w¬n
("Cª'ˆkÈcÚš”: {}", 
cÚš”Name
);

80 
Œy
 {

81 
dock”
.
	`»moveCÚš”
(
cÚš”Name
);

82 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

83 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆde¡roy CÜfu s”v”. AÌ—dy d–‘ed. CÚš”: " + 
cÚš”Name
, 
ex
);

85 
	}
}

92 
public
 
	$·u£
(
SŒšg
 
cÚš”Name
) {

93 
log
.
	`šfo
("Pausšg cÚš”: {}", 
cÚš”Name
);

95 
Œy
 {

96 
CÚš”Info
 
cÚš”
 = 
dock”
.
	`š¥eùCÚš”
(
cÚš”Name
);

97 ià(!
cÚš”
.
	`¡©e
().
	`ruÂšg
()) {

98 
log
.
	`w¬n
("ThcÚš” `{}` i nÙ„uÂšg", 
cÚš”
.
	`Çme
());

101 
dock”
.
	`·u£CÚš”
(
cÚš”Name
);

102 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

103 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆ·u£ cÚš” " + 
cÚš”Name
, 
ex
);

105 
	}
}

112 
public
 
	$¡¬t
(
SŒšg
 
cÚš”Name
) {

113 
log
.
	`šfo
("S¹šg dock” cÚš”: {}", 
cÚš”Name
);

115 
Œy
 {

116 
CÚš”Info
 
cÚš”
 = 
dock”
.
	`š¥eùCÚš”
(
cÚš”Name
);

117 ià(
cÚš”
.
	`¡©e
().
	`ruÂšg
(è|| cÚš”.¡©e().
	`·u£d
()) {

118 
log
.
	`w¬n
("ThcÚš” `{}`‡Ì—dy„uÂšg, should stİ befÜ¡¬t", 
cÚš”
.
	`Çme
());

121 
dock”
.
	`¡¬tCÚš”
(
cÚš”Name
);

122 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

123 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆ¡¬ˆcÚš” " + 
cÚš”Name
, 
ex
);

125 
	}
}

132 
public
 
	$»¡¬t
(
SŒšg
 
cÚš”Name
) {

133 
log
.
	`šfo
("Re¡¬tšghcÜfu s”v”: {}", 
cÚš”Name
);

135 
Œy
 {

136 
CÚš”Info
 
cÚš”
 = 
dock”
.
	`š¥eùCÚš”
(
cÚš”Name
);

137 ià(
cÚš”
.
	`¡©e
().
	`»¡¬tšg
()) {

138 
log
.
	`w¬n
("ThcÚš” `{}` i ®»ady„e¡¬tšg", 
cÚš”
.
	`Çme
());

141 
dock”
.
	`»¡¬tCÚš”
(
cÚš”Name
);

142 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

143 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆ»¡¬ˆcÚš” " + 
cÚš”Name
, 
ex
);

145 
	}
}

152 
public
 
	$»sume
(
SŒšg
 
cÚš”Name
) {

153 
log
.
	`šfo
("Resumšg dock” cÚš”: {}", 
cÚš”Name
);

155 
Œy
 {

156 
CÚš”Info
 
cÚš”
 = 
dock”
.
	`š¥eùCÚš”
(
cÚš”Name
);

157 ià(!
cÚš”
.
	`¡©e
().
	`·u£d
()) {

158 
log
.
	`w¬n
("ThcÚš” `{}` i nÙ…au£d, should…au£ befÜ»sumšg", 
cÚš”
.
	`Çme
());

161 
dock”
.
	`uÅau£CÚš”
(
cÚš”Name
);

162 } 
	`ÿtch
 (
Dock”Exû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
ex
) {

163 
throw
 
Ãw
 
	`NodeExû±iÚ
("Cª'ˆ»sumcÚš” " + 
cÚš”Name
, 
ex
);

165 
	}
}

170 
public
 
	$execCommªd
(
SŒšg
 
cÚš”Name
, SŒšg... 
commªd
è
throws
 
Dock”Exû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

171 
log
.
	`šfo
("Executšg dock” commªd: {}", 
SŒšg
.
	`još
(" ", 
commªd
));

173 
ExecC»©iÚ
 
execC»©iÚ
 = 
dock”
.
	`execC»©e
(

174 
cÚš”Name
,

175 
commªd
,

176 
Dock”Cl›Á
.
ExecC»©eP¬am
.
	`©chStdout
(),

177 
Dock”Cl›Á
.
ExecC»©eP¬am
.
	`©chStd”r
()

180 
dock”
.
	`execS¹
(
execC»©iÚ
.
	`id
());

181 
	}
}

183 
public
 
	$addShutdownHook
(
SŒšg
 
cÚš”Name
) {

185 
RuÁime
.
	`g‘RuÁime
().
	`addShutdownHook
(
Ãw
 
	`Th»ad
(() -> {

186 
Œy
 {

187 
	`de¡roy
(
cÚš”Name
);

188 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

189 
log
.
	`debug
("CÜfu s”v” shutdowÀhook. Cª'ˆkÈcÚš”: {}", 
cÚš”Name
);

192 
	}
}

	@it/src/main/java/org/corfudb/universe/util/IpAddress.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

8 @
	gBud”


9 @
Equ®sAndHashCode


10 
public
 cÏs 
	cIpAdd»ss
 {

12 @
	mG‘‹r


13 @
NÚNuÎ


14 
´iv©e
 
fš®
 
SŒšg
 
	m
;

16 @
Ov”ride


17 
public
 
SŒšg
 
	$toSŒšg
() {

18  

;

20 
	}
}

	@it/src/main/java/org/corfudb/universe/util/IpTablesUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gut
;

6 
public
 cÏs 
	cIpTabËsUt
 {

8 
´iv©e
 
	$IpTabËsUt
() {

18 
public
 
SŒšg
[] 
	$drİIÅut
(
IpAdd»ss
 
Add»ss
) {

19  
Ãw
 
SŒšg
[]{"bËs", "-A", "INPUT", "-s", 
Add»ss
.
	`g‘Ip
(), "-j", "DROP"};

20 
	}
}

28 
public
 
	gSŒšg
[] 
	$drİOuut
(
IpAdd»ss
 
Add»ss
) {

29  
Ãw
 
SŒšg
[]{"bËs", "-A", "OUTPUT", "-d", 
Add»ss
.
	`g‘Ip
(), "-j", "DROP"};

30 
	}
}

38 
public
 
	gSŒšg
[] 
	$»v”tDrİIÅut
(
IpAdd»ss
 
Add»ss
) {

39  
Ãw
 
SŒšg
[]{"bËs", "-D", "INPUT", "-s", 
Add»ss
.
	`g‘Ip
(), "-j", "DROP"};

40 
	}
}

48 
public
 
	gSŒšg
[] 
	$»v”tDrİOuut
(
IpAdd»ss
 
Add»ss
) {

49  
Ãw
 
SŒšg
[]{"bËs", "-D", "OUTPUT", "-d", 
Add»ss
.
	`g‘Ip
(), "-j", "DROP"};

50 
	}
}

57 
public
 
	gSŒšg
[] 
	$ş—nIÅut
() {

58  
Ãw
 
SŒšg
[]{"iptables", "-F", "INPUT"};

59 
	}
}

66 
public
 
	gSŒšg
[] 
	$ş—nOuut
() {

67  
Ãw
 
SŒšg
[]{"iptables", "-F", "OUTPUT"};

68 
	}
}

75 
public
 
SŒšg
 
	$ş—nAÎ
() {

77 
	}
}

	@it/src/test/java/org/corfudb/universe/GenericIntegrationTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gUniv”£Mªag”
.
	gUniv”£WÜkæow
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
.
	gUniv”£Mode
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gRuË
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTe¡Name
;

11 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

20 
public
 
ab¡¿ù
 cÏs 
	cG’”icIÁeg¿tiÚTe¡
 {

21 
´iv©e
 
fš®
 
Univ”£AµUt
 
	mAPP_UTIL
 = 
Ãw
 UniverseAppUtil();

23 @
RuË


24 
public
 
Te¡Name
 
	m‹¡
 = 
Ãw
 TestName();

26 
´iv©e
 
Univ”£Mªag”
 
	muniv”£Mªag”
;

28 @
BefÜe


29 
public
 
	$£tUp
() {

30 
univ”£Mªag”
 = 
Univ”£Mªag”
.
	`bud”
()

31 .
	`‹¡Name
(
‹¡
.
	`g‘M‘hodName
())

32 .
	`univ”£Mode
(
Univ”£Mode
.
DOCKER
)

33 .
	`cÜfuS”v”V”siÚ
(
APP_UTIL
.
	`g‘AµV”siÚ
())

34 .
	`bud
();

37 
public
 <
T
 
ex‹nds
 
Fixtu»
<
Univ”£P¬ams
>> 
Univ”£WÜkæow
 
	`wÜkæow
(

38 
CÚsum”
<
Univ”£WÜkæow
<
T
>> 
aùiÚ
) {

40  
univ”£Mªag”
.
	`wÜkæow
(
aùiÚ
);

41 
	}
}

	@it/src/test/java/org/corfudb/universe/group/CorfuClusterParamsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”P¬ams
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gS”v”Ut
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

11 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dS‘
;

12 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

14 
public
 cÏs 
	cCÜfuClu¡”P¬amsTe¡
 {

16 @
Te¡


17 
public
 
	$‹¡FuÎNodeName
() {

18 
fš®
 
SŒšg
 
şu¡”Name
 = "mycluster";

19 
fš®
 
pÜt
 = 
S”v”Ut
.
	`g‘RªdomO³nPÜt
();

21 
CÜfuS”v”P¬ams
 
·¿m
 = CorfuServerParams

22 .
	`£rv”P¬amsBud”
()

23 .
	`pÜt
(
pÜt
)

24 .
	`şu¡”Name
(
şu¡”Name
)

25 .
	`£rv”V”siÚ
("1.0.0")

26 .
	`bud
();

28 
SÜ‹dS‘
<
CÜfuS”v”P¬ams
> 
cÜfuS”v”s
 = 
Ãw
 
T»eS‘
<>(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
·¿m
));

30 
CÜfuClu¡”P¬ams
 
şu¡”P¬ams
 = CÜfuClu¡”P¬ams.
	`bud”
()

31 .
	`Çme
(
şu¡”Name
)

32 .
	`nodes
(
cÜfuS”v”s
)

33 .
	`£rv”V”siÚ
("1.0.0")

34 .
	`bud
();

36 
SŒšg
 
fqdn
 = 
şu¡”P¬ams
.
	`g‘FuÎNodeName
("node" + 
pÜt
);

38 
	`as£¹Th©
(
fqdn
).
	`isEqu®To
(
şu¡”Name
 + "-cÜfu-" + "node" + 
pÜt
);

40 
	}
}

	@it/src/test/java/org/corfudb/universe/node/server/CorfuServerParamsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

6 
impÜt
 
	gÜg
.
	g¦f4j
.
	gev’t
.
	gLev–
;

8 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

11 
public
 cÏs 
	cCÜfuS”v”P¬amsTe¡
 {

13 @
Te¡


14 
public
 
	$‹¡Equ®s
() {

15 
fš®
 
pÜt
 = 9000;

17 
CÜfuS”v”P¬ams
 
p1
 = CÜfuS”v”P¬ams.
	`£rv”P¬amsBud”
()

18 .
	`şu¡”Name
("test-cluster")

19 .
	`pÜt
(
pÜt
)

20 .
	`logLev–
(
Lev–
.
TRACE
)

21 .
	`mode
(
CÜfuS”v”
.
Mode
.
CLUSTER
)

22 .
	`³rsi¡’û
(
CÜfuS”v”
.
P”si¡’û
.
DISK
)

23 .
	`¡İTimeout
(
Du¿tiÚ
.
	`ofSecÚds
(123))

24 .
	`£rv”V”siÚ
("1.0.0")

25 .
	`bud
();

27 
CÜfuS”v”P¬ams
 
p2
 = CÜfuS”v”P¬ams.
	`£rv”P¬amsBud”
()

28 .
	`şu¡”Name
("test-cluster")

29 .
	`pÜt
(
pÜt
)

30 .
	`logLev–
(
Lev–
.
WARN
)

31 .
	`mode
(
CÜfuS”v”
.
Mode
.
CLUSTER
)

32 .
	`³rsi¡’û
(
CÜfuS”v”
.
P”si¡’û
.
DISK
)

33 .
	`¡İTimeout
(
Du¿tiÚ
.
	`ofSecÚds
(555))

34 .
	`£rv”V”siÚ
("1.0.0")

35 .
	`bud
();

37 
	`as£¹Th©
(
p1
).
	`isEqu®To
(
p2
);

39 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/AllNodesPartitionedIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gCÚÃùiv™yStus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”P¬ams
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

14 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

16 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

21 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜClu¡”Up
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™Unš‹¼u±ibly
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
;

28 @
Slf4j


29 
public
 cÏs 
	cAÎNodesP¬t™iÚedIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

41 @
	$Te¡
(
timeout
 = 300000)

42 
public
 
	$®lNodesP¬t™iÚedTe¡
() {

43 
	`wÜkæow
(
wf
 -> {

44 
wf
.
	`d•loy
();

46 
Univ”£P¬ams
 
·¿ms
 = 
wf
.
	`g‘Fixtu»
().
	`d©a
();

48 
CÜfuClu¡”
<
CÜfuS”v”
, 
CÜfuClu¡”P¬ams
> 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

49 .
	`g‘Group
(
·¿ms
.
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

51 
CÜfuClu¡”P¬ams
 
cÜfuClu¡”P¬ams
 = 
cÜfuClu¡”
.
	`g‘P¬ams
();

53 
	`as£¹Th©
(
cÜfuClu¡”
.
	`nodes
().
	`size
()).
	`isEqu®To
(3);

54 
	`as£¹Th©
(
cÜfuClu¡”
.
	`nodes
().
	`size
()).
	`isEqu®To
(
cÜfuClu¡”P¬ams
.size());

56 
	`as£¹Th©
(
cÜfuClu¡”
.
	`g‘P¬ams
().
	`g‘NodesP¬ams
().
	`size
())

57 .
	`as
("Invalid cluster: %s, butƒxpected 3‚odes",

58 
cÜfuClu¡”P¬ams
.
	`g‘Clu¡”Nodes
()

60 .
	`isEqu®To
(3);

62 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

64 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 =

65 
cÜfuCl›Á
.
	`ü—‹DeçuÉCÜfuTabË
(
Te¡Fixtu»CÚ¡
.
DEFAULT_STREAM_NAME
);

66 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; i++) {

67 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

73 
Li¡
<
CÜfuS”v”
> 
®lS”v”s
 = 
cÜfuClu¡”
.<CÜfuS”v”>
	`nodes
().
	`v®ues
().
	`asLi¡
();

74 
®lS”v”s
.
	`fÜEach
(
£rv”
 -> {

75 
Li¡
<
CÜfuS”v”
> 
Ùh”S”v”s
 = 
Ãw
 
A¼ayLi¡
<>(
®lS”v”s
);

76 
Ùh”S”v”s
.
	`»move
(
£rv”
);

77 
£rv”
.
	`discÚÃù
(
Ùh”S”v”s
);

80 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(20));

83 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


84 .
	`g‘Mªagem’tV›w
()

85 .
	`g‘Clu¡”Stus
();

86 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

88 
M­
<
SŒšg
, 
NodeStus
> 
¡©usM­
 = 
şu¡”StusR•Üt
.
	`g‘Clu¡”NodeStusM­
();

89 
cÜfuClu¡”
.
	`nodes
()

90 .
	`v®ues
()

91 .
	`fÜEach
(
node
 ->

92 
	`as£¹Th©
(
¡©usM­
.
	`g‘
(
node
.
	`g‘Endpošt
())).
	`isEqu®To
(
NodeStus
.
UP
)

95 
M­
<
SŒšg
, 
CÚÃùiv™yStus
> 
cÚÃùiv™yM­
 = 
şu¡”StusR•Üt


96 .
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

98 
cÜfuClu¡”
.
	`nodes
().
	`v®ues
().
	`fÜEach
(
node
 -> {

99 
	`as£¹Th©
(
cÚÃùiv™yM­
.
	`g‘
(
node
.
	`g‘Endpošt
()))

100 .
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

104 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(10));

105 
cÜfuClu¡”
.
	`nodes
().
	`v®ues
().
	`fÜEach
(
CÜfuS”v”
::
»cÚÃù
);

107 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

110 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

111 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

113 
	`wa™FÜClu¡”Up
(
bË
, "0");

116 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; i++) {

117 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

121 
cÜfuCl›Á
.
	`shutdown
();

125 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/ClusterResizeIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCl›ÁP¬ams
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£
.
	gUniv”£Mode
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
;

20 
public
 cÏs 
	cClu¡”ResizeIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

31 @
	$Te¡
(
timeout
 = 300000)

32 
public
 
	$şu¡”ResizeTe¡
() {

33 
	`wÜkæow
(
wf
 -> {

34 
wf
.
	`d•loy
();

35 
Univ”£P¬ams
 
·¿ms
 = 
wf
.
	`g‘Fixtu»
().
	`d©a
();

37 
Cl›ÁP¬ams
 
ş›ÁFixtu»
 = Cl›ÁP¬ams.
	`bud”
().
	`bud
();

39 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

40 .
	`g‘Group
(
·¿ms
.
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

42 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

44 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 =

45 
cÜfuCl›Á
.
	`ü—‹DeçuÉCÜfuTabË
(
Te¡Fixtu»CÚ¡
.
DEFAULT_STREAM_NAME
);

47 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; i++) {

48 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

51 
Li¡
<
CÜfuS”v”
> 
£rv”s
 = 
A¼ays
.
	`asLi¡
(

52 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1),

53 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2)

58 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘Fœ¡S”v”
();

61 
CÜfuS”v”
 
ÿndid©e
 : 
£rv”s
) {

62 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`»moveNode
(

63 
ÿndid©e
.
	`g‘Endpošt
(),

64 
ş›ÁFixtu»
.
	`g‘NumR‘ry
(),

65 
ş›ÁFixtu»
.
	`g‘Timeout
(),

66 
ş›ÁFixtu»
.
	`g‘PŞlP”iod
()

71 
CÜfuS”v”
 
ÿndid©e
 : 
£rv”s
) {

72 
cÜfuCl›Á
.
	`g‘RuÁime
().
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

73 .
	`g‘Ba£Cl›Á
(
ÿndid©e
.
	`g‘Endpošt
()).
	`»£t
();

77 
cÜfuCl›Á
.
	`šv®id©eLayout
();

78 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘AÎS”v”s
())

79 .
	`cÚšsExaùly
(
£rv”0
.
	`g‘Endpošt
());

82 
x
 = 0; x < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; x++) {

83 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
x
))).
	`isEqu®To
(String.valueOf(x));

86 ià(
wf
.
	`g‘Univ”£Mode
(è=ğ
Univ”£Mode
.
VM
) {

87 
SûÇrioUts
.
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(15));

95 
CÜfuS”v”
 
ÿndid©e
 : 
£rv”s
) {

96 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`addNode
(

97 
ÿndid©e
.
	`g‘Endpošt
(),

98 
ş›ÁFixtu»
.
	`g‘NumR‘ry
(),

99 
ş›ÁFixtu»
.
	`g‘Timeout
(),

100 
ş›ÁFixtu»
.
	`g‘PŞlP”iod
()

105 
cÜfuCl›Á
.
	`šv®id©eLayout
();

106 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
())

107 .
	`isEqu®To
(
cÜfuClu¡”
.
	`nodes
().
	`size
());

110 
x
 = 0; x < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; x++) {

111 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
x
))).
	`isEqu®To
(String.valueOf(x));

115 
cÜfuCl›Á
.
	`shutdown
();

118 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/ConcurrentClusterResizeIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCl›ÁP¬ams
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

16 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜClu¡”Up
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutS”v”sChªge
;

24 @
Slf4j


25 
public
 cÏs 
	cCÚcu¼’tClu¡”ResizeIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

36 @
	$Te¡
(
timeout
 = 600000)

37 
public
 
	$cÚcu¼’tClu¡”ResizeTe¡
() {

39 
fš®
 
numNodes
 = 5;

41 
	`wÜkæow
(
wf
 -> {

42 
wf
.
	`£tupDock”
(
fixtu»
 -> fixtu».
	`g‘Clu¡”
().
	`numNodes
(
numNodes
));

43 
wf
.
	`£tupProûss
(
fixtu»
 -> fixtu».
	`g‘Clu¡”
().
	`numNodes
(
numNodes
));

44 
wf
.
	`£tupVm
(
fixtu»
 -> fixtu».
	`g‘Clu¡”
().
	`numNodes
(
numNodes
));

46 
wf
.
	`d•loy
();

48 
Cl›ÁP¬ams
 
ş›ÁFixtu»
 = Cl›ÁP¬ams.
	`bud”
().
	`bud
();

49 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

50 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

52 
	`as£¹Th©
(
cÜfuClu¡”
.
	`nodes
().
	`size
()).
	`isEqu®To
(
numNodes
);

54 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

56 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 =

57 
cÜfuCl›Á
.
	`ü—‹DeçuÉCÜfuTabË
(
Te¡Fixtu»CÚ¡
.
DEFAULT_STREAM_NAME
);

58 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; i++) {

59 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

62 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘Fœ¡S”v”
();

65 
Li¡
<
CÜfuS”v”
> 
£rv”s
 = 
IÁSŒ—m
.
	`¿nge
(1, 
numNodes
)

66 .
	`m­ToObj
(
cÜfuClu¡”
::
g‘S”v”ByIndex
)

67 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

72 
ExecutÜS”viû
 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numNodes
 - 1);

74 
£rv”s
.
	`fÜEach
(
node
 -> {

75 
RuÂabË
 
»moveNodeAùiÚ
 = (è-> 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`»moveNode
(

76 
node
.
	`g‘Endpošt
(),

77 
ş›ÁFixtu»
.
	`g‘NumR‘ry
(),

78 
ş›ÁFixtu»
.
	`g‘Timeout
(),

79 
ş›ÁFixtu»
.
	`g‘PŞlP”iod
()

81 
executÜ
.
	`subm™
(
»moveNodeAùiÚ
);

85 
	`wa™FÜLayoutS”v”sChªge
(
size
 -> siz=ğ1, 
cÜfuCl›Á
);

86 
executÜ
.
	`shutdownNow
();

89 
cÜfuCl›Á
.
	`šv®id©eLayout
();

90 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘AÎS”v”s
()).
	`cÚšsExaùly
(
£rv”0
.
	`g‘Endpošt
());

92 
	`wa™FÜClu¡”Up
(
bË
, "0");

94 
x
 = 0; x < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; x++) {

95 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
x
))).
	`isEqu®To
(String.valueOf(x));

101 
ExecutÜS”viû
 
executÜ2
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numNodes
 - 1);

102 
£rv”s
.
	`fÜEach
(
node
 -> 
executÜ2
.
	`subm™
((è-> 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`addNode
(

103 
node
.
	`g‘Endpošt
(),

104 
ş›ÁFixtu»
.
	`g‘NumR‘ry
(),

105 
ş›ÁFixtu»
.
	`g‘Timeout
(),

106 
ş›ÁFixtu»
.
	`g‘PŞlP”iod
())

111 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AÎS”v”s
().
	`size
(è=ğ
numNodes
, 
cÜfuCl›Á
);

112 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
cÜfuCl›Á
);

114 
	`wa™FÜClu¡”Up
(
bË
, "0");

115 
executÜ2
.
	`shutdownNow
();

118 
x
 = 0; x < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; x++) {

119 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
x
))).
	`isEqu®To
(String.valueOf(x));

122 
cÜfuCl›Á
.
	`shutdown
();

125 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/HandOfGodIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCl›ÁP¬ams
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

20 
public
 cÏs 
	cHªdOfGodIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

30 @
	$Te¡
(
timeout
 = 300000)

31 
public
 
	$hªdOfGodTe¡
() {

32 
	`wÜkæow
(
wf
 -> {

33 
wf
.
	`d•loy
();

35 
Cl›ÁP¬ams
 
ş›ÁFixtu»
 = Cl›ÁP¬ams.
	`bud”
().
	`bud
();

36 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

37 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

39 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

41 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á
.
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

42 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

43 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

47 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

48 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

49 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

52 
£rv”1
.
	`kl
();

53 
£rv”2
.
	`kl
();

56 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(

57 
£rv”1
.
	`g‘Endpošt
(),

58 
ş›ÁFixtu»
.
	`g‘NumR‘ry
(),

59 
ş›ÁFixtu»
.
	`g‘Timeout
(),

60 
ş›ÁFixtu»
.
	`g‘PŞlP”iod
()

63 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(

64 
£rv”2
.
	`g‘Endpošt
(),

65 
ş›ÁFixtu»
.
	`g‘NumR‘ry
(),

66 
ş›ÁFixtu»
.
	`g‘Timeout
(),

67 
ş›ÁFixtu»
.
	`g‘PŞlP”iod
()

71 
cÜfuCl›Á
.
	`šv®id©eLayout
();

72 
Layout
 
Ïyout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

73 
	`as£¹Th©
(
Ïyout
.
	`g‘AÎAùiveS”v”s
()).
	`cÚšsExaùly
(
£rv”0
.
	`g‘Endpošt
());

76 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

77 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

79 
SûÇrioUts
.
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(30));

82 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

83 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

86 
cÜfuCl›Á
.
	`shutdown
();

89 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/NodeDownAndLinkFailureIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜNextEpoch
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

24 @
Slf4j


25 
public
 cÏs 
	cNodeDownAndLškFau»IT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

39 @
	$Te¡
(
timeout
 = 300000)

40 
public
 
	$nodeDownAndLškFau»Te¡
() {

41 
	`wÜkæow
(
wf
 -> {

42 
wf
.
	`d•loy
();

44 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

45 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

47 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

49 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á
.
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

50 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

51 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

55 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

56 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

57 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

59 
cu¼Epoch
 = 
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘Epoch
();

61 
log
.
	`šfo
("Stop server2‡nd wait for†ayout's unresponsive serverso change");

62 
£rv”2
.
	`¡İ
(
Du¿tiÚ
.
	`ofSecÚds
(10));

63 
	`wa™FÜNextEpoch
(
cÜfuCl›Á
, 
cu¼Epoch
 + 1);

64 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘UÄe¥ÚsiveS”v”s
()).
	`cÚšsExaùly
(
£rv”2
.
	`g‘Endpošt
());

65 
cu¼Epoch
++;

71 
log
.
	`šfo
("Create†ink failure between server0‡nd server1");

72 
£rv”0
.
	`discÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”1
));

76 
log
.
	`šfo
("Restarthe stopped‚ode, server0‡nd server1 still…artitioned wait for " +

78 
£rv”2
.
	`¡¬t
();

80 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
()

81 .
	`equ®s
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”1
.
	`g‘Endpošt
())), 
cÜfuCl›Á
);

84 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


85 .
	`g‘Mªagem’tV›w
()

86 .
	`g‘Clu¡”Stus
();

87 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

89 
log
.
	`šfo
("Repairhe…artition between server0‡nd server1");

90 
£rv”0
.
	`»cÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”1
));

92 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

94 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

96 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

97 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

98 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

99 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

101 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

104 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

105 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

108 
cÜfuCl›Á
.
	`shutdown
();

111 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/NodeDownAndPartitionedIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜClu¡”Down
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜClu¡”Up
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™Unš‹¼u±ibly
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

24 
public
 cÏs 
	cNodeDownAndP¬t™iÚedIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

36 @
	$Te¡
(
timeout
 = 300000)

37 
public
 
	$nodeDownAndP¬t™iÚTe¡
() {

38 
	`wÜkæow
(
wf
 -> {

39 
wf
.
	`d•loy
();

41 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

42 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

44 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

46 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


47 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

49 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

50 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

54 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

55 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

56 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

59 
£rv”1
.
	`¡İ
(
Du¿tiÚ
.
	`ofSecÚds
(10));

60 
£rv”2
.
	`discÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”0
, 
£rv”1
));

62 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(20));

65 
cÜfuCl›Á
.
	`šv®id©eLayout
();

66 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


67 .
	`g‘Mªagem’tV›w
()

68 .
	`g‘Clu¡”Stus
();

69 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

72 
	`wa™FÜClu¡”Down
(
bË
);

76 
£rv”1
.
	`¡¬t
();

77 
£rv”2
.
	`»cÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”0
, 
£rv”1
));

78 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

81 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Segm’ts
().
	`size
() == 1 &&

82 
Ïyout
.
	`g‘AÎS”v”s
().
	`size
(è=ğ3, 
cÜfuCl›Á
);

84 
	`wa™FÜClu¡”Up
(
bË
, "0");

86 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

87 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

90 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

91 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

94 
cÜfuCl›Á
.
	`shutdown
();

97 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/NodePausedAndPartitionedIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜClu¡”Down
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™Unš‹¼u±ibly
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

23 
public
 cÏs 
	cNodePau£dAndP¬t™iÚedIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

35 @
	$Te¡
(
timeout
 = 300000)

36 
public
 
	$nodesPau£dAndP¬t™iÚedTe¡
() {

37 
	`wÜkæow
(
wf
 -> {

38 
wf
.
	`d•loy
();

40 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

41 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

43 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

45 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


46 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

48 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; i++) {

49 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

53 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

54 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

55 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

58 
£rv”1
.
	`·u£
();

59 
£rv”2
.
	`discÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”0
, 
£rv”1
));

61 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(20));

64 
cÜfuCl›Á
.
	`šv®id©eLayout
();

65 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


66 .
	`g‘Mªagem’tV›w
()

67 .
	`g‘Clu¡”Stus
();

68 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

71 
	`wa™FÜClu¡”Down
(
bË
);

76 
£rv”1
.
	`»sume
();

77 
£rv”2
.
	`»cÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”0
, 
£rv”1
));

78 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

79 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
cÜfuCl›Á
);

81 
cÜfuCl›Á
.
	`šv®id©eLayout
();

82 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

83 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

86 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_TABLE_ITER
; i++) {

87 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

90 
cÜfuCl›Á
.
	`shutdown
();

93 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/NodeUpAndPartitionedIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

18 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜNextEpoch
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™Unš‹¼u±ibly
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

25 @
Slf4j


26 
public
 cÏs 
	cNodeUpAndP¬t™iÚedIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

48 @
	$Te¡
(
timeout
 = 300000)

49 
public
 
	$nodeUpAndP¬t™iÚedTe¡
() {

50 
	`wÜkæow
(
wf
 -> {

51 
wf
.
	`d•loy
();

53 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

54 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

56 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

58 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


59 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

60 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

61 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

66 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

67 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

68 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

70 
cu¼Epoch
 = 
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘Epoch
();

72 
log
.
	`šfo
("Stop server1");

73 
£rv”1
.
	`¡İ
(
Du¿tiÚ
.
	`ofSecÚds
(10));

74 
	`wa™FÜNextEpoch
(
cÜfuCl›Á
, 
cu¼Epoch
 + 1);

75 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘UÄe¥ÚsiveS”v”s
())

76 .
	`cÚšsExaùly
(
£rv”1
.
	`g‘Endpošt
());

77 
cu¼Epoch
++;

85 
£rv”0
.
	`discÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”1
, 
£rv”2
));

86 
£rv”1
.
	`¡¬t
();

88 
	`wa™FÜLayoutChªge
(
l
 -> {

89 
Li¡
<
SŒšg
> 
uÄe¥Úsive
 = 
l
.
	`g‘UÄe¥ÚsiveS”v”s
();

90  
uÄe¥Úsive
.
	`size
(è=ğ1 && uÄe¥Úsive.
	`cÚšs
(
£rv”0
.
	`g‘Endpošt
());

91 }, 
cÜfuCl›Á
);

94 
Li¡
<
SŒšg
> 
uÄe¥ÚsiveS”v”s
 = 
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘UÄe¥ÚsiveS”v”s
();

95 
	`as£¹Th©
(
uÄe¥ÚsiveS”v”s
)

96 .
	`as
("WrÚg‚umb” oàuÄe¥Úsiv£rv”s: %s", 
uÄe¥ÚsiveS”v”s
)

97 .
	`cÚšsExaùly
(
£rv”0
.
	`g‘Endpošt
());

98 
cu¼Epoch
 += 2;

100 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(20));

104 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


105 .
	`g‘Mªagem’tV›w
()

106 .
	`g‘Clu¡”Stus
();

107 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

110 
£rv”0
.
	`»cÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”1
, 
£rv”2
));

111 
	`wa™FÜNextEpoch
(
cÜfuCl›Á
, 
cu¼Epoch
 + 1);

112 
cu¼Epoch
++;

114 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

116 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

117 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

118 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

119 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

121 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

123 
SË•
.
	`¦“pUnš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(10));

126 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

127 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

130 
cÜfuCl›Á
.
	`shutdown
();

133 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/OneLinkFailureIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

22 
public
 cÏs 
	cOÃLškFau»IT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

34 @
	$Te¡
(
timeout
 = 300000)

35 
public
 
	$ÚeLškFau»Te¡
() {

36 
	`wÜkæow
(
wf
 -> {

37 
wf
.
	`d•loy
();

39 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

40 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

42 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

44 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á
.
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

45 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

46 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

50 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

51 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

54 
£rv”0
.
	`discÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
));

57 
SŒšg
 
£rv”ToKick
 = 
CŞËùiÚs
.
	`max
(

58 
A¼ays
.
	`asLi¡
(
£rv”0
.
	`g‘Endpošt
(), 
£rv”2
.getEndpoint())

60 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ1, 
cÜfuCl›Á
);

62 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
().
	`g‘UÄe¥ÚsiveS”v”s
())

63 .
	`cÚšsExaùly
(
£rv”ToKick
);

66 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


67 .
	`g‘Mªagem’tV›w
()

68 .
	`g‘Clu¡”Stus
();

69 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

72 
SûÇrioUts
.
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(10));

73 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

74 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

78 
£rv”0
.
	`»cÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
));

79 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

81 
fš®
 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

83 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

84 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

85 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

86 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

88 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

91 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

92 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

95 
cÜfuCl›Á
.
	`shutdown
();

98 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/OneNodeDownIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gAs£¹iÚs
.
	gç
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gUniv”£Mªag”
.
	gUniv”£WÜkæow
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£P¬ams
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

23 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

27 
public
 cÏs 
	cOÃNodeDownIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

38 @
	$Te¡
(
timeout
 = 300000)

39 
public
 
	$ÚeNodeDownTe¡
() {

41 
	`wÜkæow
(
wf
 -> {

42 
wf
.
	`d•loy
();

44 
Œy
 {

45 
	`ÚeNodeDown
(
wf
);

46 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

47 
	`ç
("Te¡ faed", 
e
);

52 
´iv©e
 
	`ÚeNodeDown
(
Univ”£WÜkæow
<
Fixtu»
<
Univ”£P¬ams
>> 
wf
è
throws
 
IÁ”ru±edExû±iÚ
 {

53 
SŒšg
 
groupName
 = 
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
();

54 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
().
	`g‘Group
(
groupName
);

56 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

58 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


59 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

61 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

62 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

66 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘Fœ¡S”v”
();

69 
£rv”0
.
	`¡İ
(
Du¿tiÚ
.
	`ofSecÚds
(10));

70 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ1, 
cÜfuCl›Á
);

73 
Layout
 
Ïyout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

74 
	`as£¹Th©
(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
()).
	`cÚšsExaùly
(
£rv”0
.
	`g‘Endpošt
());

77 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


78 .
	`g‘Mªagem’tV›w
()

79 .
	`g‘Clu¡”Stus
();

80 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

82 
M­
<
SŒšg
, 
NodeStus
> 
¡©usM­
 = 
şu¡”StusR•Üt
.
	`g‘Clu¡”NodeStusM­
();

83 
	`as£¹Th©
(
¡©usM­
.
	`g‘
(
£rv”0
.
	`g‘Endpošt
())).
	`isEqu®To
(
NodeStus
.
DOWN
);

86 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

87 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

91 
£rv”0
.
	`¡¬t
();

92 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

94 
fš®
 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

96 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

97 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

98 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

99 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
¦“pDu¿tiÚ
.
	`toMlis
());

101 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

104 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

105 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

107 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/OneNodePausedIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

23 
public
 cÏs 
	cOÃNodePau£dIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

34 @
	$Te¡
(
timeout
 = 300000)

35 
public
 
	$ÚeNodePau£dTe¡
() {

36 
	`wÜkæow
(
wf
 -> {

37 
wf
.
	`d•loy
();

39 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

40 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

42 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

44 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


45 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

47 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

48 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

52 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

55 
£rv”1
.
	`·u£
();

56 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ1, 
cÜfuCl›Á
);

59 
Layout
 
Ïyout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

60 
	`as£¹Th©
(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
())

61 .
	`cÚšsExaùly
(
£rv”1
.
	`g‘Endpošt
());

64 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
()

65 .
	`g‘Clu¡”Stus
();

66 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
())

67 .
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

68 
M­
<
SŒšg
, 
NodeStus
> 
¡©usM­
 = 
şu¡”StusR•Üt


69 .
	`g‘Clu¡”NodeStusM­
();

70 
	`as£¹Th©
(
¡©usM­
.
	`g‘
(
£rv”1
.
	`g‘Endpošt
())).
	`isEqu®To
(
NodeStus
.
DOWN
);

73 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

74 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

78 
£rv”1
.
	`»sume
();

79 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

81 
fš®
 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

83 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

84 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

85 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

86 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

88 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
())

89 .
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

92 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

93 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

96 
cÜfuCl›Á
.
	`shutdown
();

99 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/RotateLinkFailureIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

15 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

16 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

17 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™Unš‹¼u±ibly
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

26 @
Slf4j


27 
public
 cÏs 
	cRÙ©eLškFau»IT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

44 @
	$Te¡
(
timeout
 = 600000)

45 
public
 
	$rÙ©eLškFau»Te¡
() {

46 
	`wÜkæow
(
wf
 -> {

47 
wf
.
	`d•loy
();

49 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

50 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

52 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

54 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


55 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

57 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

58 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

62 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

63 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

64 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

66 
log
.
	`šfo
("1st†ink failure„otation, disconnect between server0‡nd server1. " +

67 "Cu¼’ˆÏyout: {}", 
cÜfuCl›Á
.
	`g‘Layout
()

70 
£rv”0
.
	`discÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”1
));

72 
	`wa™FÜLayoutChªge
(

73 
Ïyout
 -> {

74 
Li¡
<
SŒšg
> 
ex³ùed
 = 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”1
.
	`g‘Endpošt
());

75  
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`equ®s
(
ex³ùed
);

77 
cÜfuCl›Á


80 
SûÇrioUts
.
	`wa™FÜClu¡”Up
(
bË
, "0");

82 
Layout
 
Ï‹¡Layout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

84 
log
.
	`šfo
("Verify data…ath working fine");

85 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

86 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

89 
log
.
	`šfo
("2nd†ink failure„otation, disconnect between server1‡nd server2 " +

91 
£rv”1
.
	`discÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
));

92 
£rv”0
.
	`»cÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”1
));

94 
log
.
	`šfo
("Wait for someimeoƒnsure cluster stabilizes Server1 should stay " +

96 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(30));

97 
	`as£¹Th©
(
cÜfuCl›Á
.
	`g‘Layout
()).
	`isEqu®To
(
Ï‹¡Layout
);

99 
SûÇrioUts
.
	`wa™FÜClu¡”Up
(
bË
, "0");

100 
log
.
	`šfo
("Verify data…ath working fine");

101 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

102 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

105 
log
.
	`šfo
("3rd†ink failure„otation, disconnect between server2‡nd server0 " +

107 
£rv”2
.
	`discÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”0
));

108 
£rv”1
.
	`»cÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
));

110 
log
.
	`šfo
("Server0‡nd server2 has same‚umber of†ink failure ie. 1, " +

112 
	`wa™FÜLayoutChªge
(

113 
Ïyout
 -> {

114 
Li¡
<
SŒšg
> 
ex³ùed
 = 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
.
	`g‘Endpošt
());

115  
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`equ®s
(
ex³ùed
);

117 
cÜfuCl›Á


120 
log
.
	`šfo
("Verify data…ath working fine");

121 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(20));

122 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

123 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

126 
log
.
	`šfo
("4th†ink failure„otation,„eversehe„otating direction, " +

129 
£rv”1
.
	`discÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
));

130 
£rv”2
.
	`»cÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”0
));

132 
log
.
	`šfo
("Wait for someimeoƒnsure cluster stabilizes " +

134 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(30));

136 
log
.
	`šfo
("Verify data…ath working fine");

137 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

138 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

141 
log
.
	`šfo
("Finally stop„otation‡nd heal‡ll†ink failures.");

142 
£rv”1
.
	`»cÚÃù
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”2
));

143 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

145 
fš®
 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

146 
log
.
	`šfo
("Verify cluster status is STABLE");

147 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


148 .
	`g‘Mªagem’tV›w
()

149 .
	`g‘Clu¡”Stus
();

151 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

152 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

153 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

155 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

157 
log
.
	`šfo
("Verify data…ath working fine");

158 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

159 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

162 
cÜfuCl›Á
.
	`shutdown
();

165 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/ScenarioUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gç
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_WAIT_TIME
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gUÄ—chabËClu¡”Exû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.univ”£.
	gUniv”£Exû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

16 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

18 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁP»diÿ‹
;

19 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

21 @
Slf4j


22 
public
 cÏs 
	cSûÇrioUts
 {

24 
public
 
	$wa™FÜNextEpoch
(
CÜfuCl›Á
 
cÜfuCl›Á
, 
ÃxtEpoch
) {

25 
	`wa™FÜLayoutChªge
(
Ïyout
 -> {

26 ià(
Ïyout
.
	`g‘Epoch
(è> 
ÃxtEpoch
) {

27 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Layouˆ•och i ah—d oàÃxˆ•och. Nexˆ•och: " + 
ÃxtEpoch
 +

28 ",†ayouˆ•och: " + 
Ïyout
.
	`g‘Epoch
());

30  
Ïyout
.
	`g‘Epoch
(è=ğ
ÃxtEpoch
;

31 }, 
cÜfuCl›Á
);

41 
public
 
	`wa™FÜLayoutChªge
(
P»diÿ‹
<
Layout
> 
v”if›r
, 
CÜfuCl›Á
 
cÜfuCl›Á
) {

43 
cÜfuCl›Á
.
	`šv®id©eLayout
();

44 
Layout
 
»äeshedLayout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

46 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_WAIT_POLL_ITER
; i++) {

47 ià(
v”if›r
.
	`‹¡
(
»äeshedLayout
)) {

50 
cÜfuCl›Á
.
	`šv®id©eLayout
();

51 
»äeshedLayout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

52 
	`¦“p
();

55 
	`as£¹Th©
(
v”if›r
.
	`‹¡
(
»äeshedLayout
)).
	`isTrue
();

56 
	}
}

65 
public
 
	$wa™FÜUÄe¥ÚsiveS”v”sChªge
(

66 
IÁP»diÿ‹
 
v”if›r
, 
CÜfuCl›Á
 
cÜfuCl›Á
) {

67 
cÜfuCl›Á
.
	`šv®id©eLayout
();

68 
Layout
 
»äeshedLayout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

70 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_WAIT_POLL_ITER
; i++) {

71 ià(
v”if›r
.
	`‹¡
(
»äeshedLayout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
())) {

74 
cÜfuCl›Á
.
	`šv®id©eLayout
();

75 
»äeshedLayout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

76 
	`¦“p
();

79 
	`as£¹Th©
(
v”if›r
.
	`‹¡
(
»äeshedLayout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
())).
	`isTrue
();

80 
	}
}

82 
´iv©e
 
	$¦“p
() {

83 
Œy
 {

84 
TimeUn™
.
SECONDS
.
	`¦“p
(
DEFAULT_WAIT_TIME
.
	`g‘SecÚds
());

85 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

86 
Th»ad
.
	`cu¼’tTh»ad
().
	`š‹¼u±
();

87 
throw
 
Ãw
 
	`Univ”£Exû±iÚ
("IÁ”ru±ed", 
e
);

89 
	}
}

98 
public
 
	$wa™FÜLayoutS”v”sChªge
(
IÁP»diÿ‹
 
v”if›r
, 
CÜfuCl›Á
 
cÜfuCl›Á
) {

99 
cÜfuCl›Á
.
	`šv®id©eLayout
();

100 
Layout
 
»äeshedLayout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

102 
i
 = 0; i < 
Te¡Fixtu»CÚ¡
.
DEFAULT_WAIT_POLL_ITER
; i++) {

103 ià(
v”if›r
.
	`‹¡
(
»äeshedLayout
.
	`g‘AÎS”v”s
().
	`size
())) {

106 
cÜfuCl›Á
.
	`šv®id©eLayout
();

107 
»äeshedLayout
 = 
cÜfuCl›Á
.
	`g‘Layout
();

108 
	`¦“p
();

111 
	`as£¹Th©
(
v”if›r
.
	`‹¡
(
»äeshedLayout
.
	`g‘AÎS”v”s
().
	`size
())).
	`isTrue
();

112 
	}
}

121 @
Suµ»ssW¬nšgs
("unchecked")

122 
	$wa™FÜClu¡”Down
(
CÜfuTabË
 
bË
) {

123 
Œy
 {

124 
bË
.
	`put
(
Ãw
 
	`Objeù
(),‚ew Object());

125 
	`ç
("Cluster should‡lready be down");

126 } 
	`ÿtch
 (
UÄ—chabËClu¡”Exû±iÚ
 
e
) {

127 
log
.
	`šfo
("Successfully waited failure detectoro detect cluster down");

129 
	}
}

131 
	$wa™FÜClu¡”Up
(
CÜfuTabË
 
bË
, 
SŒšg
 
v®ue
) {

132 
i
 = 0; i < 3; i++) {

133 
Œy
 {

134 
bË
.
	`g‘
(
v®ue
);

136 } 
	`ÿtch
 (
UÄ—chabËClu¡”Exû±iÚ
 
e
) {

137 
log
.
	`šfo
("Successfully waited failure detectoro detect cluster up");

140 
	`wa™Unš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(10));

142 
	}
}

150 
	$wa™Unš‹¼u±ibly
(
Du¿tiÚ
 
du¿tiÚ
) {

151 
SË•
.
	`¦“pUnš‹¼u±ibly
(
du¿tiÚ
);

152 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/TwoLinksFailureIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜUÄe¥ÚsiveS”v”sChªge
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

23 
public
 cÏs 
	cTwoLšksFau»IT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

35 @
	$Te¡
(
timeout
 = 300000)

36 
public
 
	$twoLšksFau»Te¡
() {

37 
	`wÜkæow
(
wf
 -> {

38 
wf
.
	`d•loy
();

40 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

41 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

43 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

45 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


46 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

47 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

48 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

52 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

53 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

54 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

57 
£rv”0
.
	`discÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”1
, 
£rv”2
));

58 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
()

59 .
	`equ®s
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
£rv”0
.
	`g‘Endpošt
())), 
cÜfuCl›Á
);

62 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


63 .
	`g‘Mªagem’tV›w
()

64 .
	`g‘Clu¡”Stus
();

65 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

68 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

69 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

73 
£rv”0
.
	`»cÚÃù
(
A¼ays
.
	`asLi¡
(
£rv”1
, 
£rv”2
));

74 
	`wa™FÜUÄe¥ÚsiveS”v”sChªge
(
size
 -> siz=ğ0, 
cÜfuCl›Á
);

76 
fš®
 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

78 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

79 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

80 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

81 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

83 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

86 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

87 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

90 
cÜfuCl›Á
.
	`shutdown
();

93 
	}
}

	@it/src/test/java/org/corfudb/universe/scenario/TwoNodesDownIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”StusR–Ÿb™y
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gCÚÃùiv™yStus
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gG’”icIÁeg¿tiÚTe¡
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	ggroup
.
	gşu¡”
.
	gCÜfuClu¡”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	gş›Á
.
	gCÜfuCl›Á
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gnode
.
	g£rv”
.
	gCÜfuS”v”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

14 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

16 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gM­
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜClu¡”Down
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gSûÇrioUts
.
	gwa™FÜLayoutChªge
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_STREAM_NAME
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guniv”£
.
	gsûÇrio
.
	gfixtu»
.
	gFixtu»s
.
	gTe¡Fixtu»CÚ¡
.
	gDEFAULT_TABLE_ITER
;

26 
public
 cÏs 
	cTwoNodesDownIT
 
ex‹nds
 
	mG’”icIÁeg¿tiÚTe¡
 {

37 @
	$Te¡
(
timeout
 = 300000)

38 
public
 
	$twoNodesDownTe¡
() {

39 
	`wÜkæow
(
wf
 -> {

40 
wf
.
	`d•loy
();

42 
CÜfuClu¡”
 
cÜfuClu¡”
 = 
wf
.
	`g‘Univ”£
()

43 .
	`g‘Group
(
wf
.
	`g‘Fixtu»
().
	`d©a
().
	`g‘GroupP¬amByIndex
(0).
	`g‘Name
());

45 
CÜfuCl›Á
 
cÜfuCl›Á
 = 
cÜfuClu¡”
.
	`g‘LoÿlCÜfuCl›Á
();

47 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuCl›Á


48 .
	`ü—‹DeçuÉCÜfuTabË
(
DEFAULT_STREAM_NAME
);

50 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

51 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

55 
CÜfuS”v”
 
£rv”0
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(0);

56 
CÜfuS”v”
 
£rv”1
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(1);

57 
CÜfuS”v”
 
£rv”2
 = 
cÜfuClu¡”
.
	`g‘S”v”ByIndex
(2);

60 
£rv”1
.
	`¡İ
(
Du¿tiÚ
.
	`ofSecÚds
(10));

61 
£rv”2
.
	`¡İ
(
Du¿tiÚ
.
	`ofSecÚds
(10));

64 
cÜfuCl›Á
.
	`šv®id©eLayout
();

65 
Clu¡”StusR•Üt
 
şu¡”StusR•Üt
 = 
cÜfuCl›Á


66 .
	`g‘Mªagem’tV›w
()

67 .
	`g‘Clu¡”Stus
();

69 
M­
<
SŒšg
, 
NodeStus
> 
nodeStusM­
 = 
şu¡”StusR•Üt
.
	`g‘Clu¡”NodeStusM­
();

70 
M­
<
SŒšg
, 
CÚÃùiv™yStus
> 
cÚÃùiv™yStusM­
 = 
şu¡”StusR•Üt


71 .
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

72 
Clu¡”StusR–Ÿb™y
 
»lŸb™y
 = 
şu¡”StusR•Üt
.
	`g‘Clu¡”StusR–Ÿb™y
();

74 
	`as£¹Th©
(
cÚÃùiv™yStusM­
.
	`g‘
(
£rv”0
.
	`g‘Endpošt
()))

75 .
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

76 
	`as£¹Th©
(
cÚÃùiv™yStusM­
.
	`g‘
(
£rv”1
.
	`g‘Endpošt
()))

77 .
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

78 
	`as£¹Th©
(
cÚÃùiv™yStusM­
.
	`g‘
(
£rv”2
.
	`g‘Endpošt
()))

79 .
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

81 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
£rv”0
.
	`g‘Endpošt
())).
	`isEqu®To
(
NodeStus
.
NA
);

82 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
£rv”1
.
	`g‘Endpošt
())).
	`isEqu®To
(
NodeStus
.
NA
);

83 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
£rv”2
.
	`g‘Endpošt
())).
	`isEqu®To
(
NodeStus
.
NA
);

85 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
UNAVAILABLE
);

86 
	`as£¹Th©
(
»lŸb™y
).
	`isEqu®To
(
Clu¡”StusR–Ÿb™y
.
WEAK_NO_QUORUM
);

89 
	`wa™FÜClu¡”Down
(
bË
);

92 
£rv”1
.
	`¡¬t
();

93 
£rv”2
.
	`¡¬t
();

95 
Layout
 
š™ŸlLayout
 = 
şu¡”StusR•Üt
.
	`g‘Layout
();

96 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Epoch
(è> 
š™ŸlLayout
.getEpoch()

97 && 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
(è=ğ0, 
cÜfuCl›Á
);

99 
fš®
 
Du¿tiÚ
 
¦“pDu¿tiÚ
 = Du¿tiÚ.
	`ofSecÚds
(1);

102 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

103 !
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
STABLE
)) {

104 
şu¡”StusR•Üt
 = 
cÜfuCl›Á
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

105 
SË•
.
	`¦“pUnš‹¼u±ibly
(
¦“pDu¿tiÚ
);

107 
	`as£¹Th©
(
şu¡”StusR•Üt
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

110 
i
 = 0; i < 
DEFAULT_TABLE_ITER
; i++) {

111 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(String.valueOf(i));

114 
cÜfuCl›Á
.
	`shutdown
();

117 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/DataControl.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
;

7 
public
 
š‹rçû
 
	gD©aCÚŒŞ
 {

13 
»que¡SÇpshÙSync
();

	@log-replication/src/main/java/org/corfudb/logreplication/SourceManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aReûiv”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚFSM
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gOb£rvabËAckMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
.
	gLogR•liÿtiÚCl›Á
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gCÜfuD©aS’d”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gDeçuÉR—dProûssÜ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogR•liÿtiÚEv’tM‘ad©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gR—dProûssÜ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
.
	gLogR•liÿtiÚEv’tTy³
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

38 @
	gD©a


39 @
Slf4j


40 
public
 cÏs 
	cSourûMªag”
 
im¶em’ts
 
	mD©aReûiv”
 {

42 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

46 
´iv©e
 
fš®
 
	mDEFAULT_FSM_WORKER_THREADS
 = 1;

51 @
VisibËFÜTe¡šg


52 
´iv©e
 
fš®
 
LogR•liÿtiÚFSM
 
	mlogR•liÿtiÚFSM
;

54 @
VisibËFÜTe¡šg


55 
´iv©e
 
	mcouÁACKs
 = 0;

57 @
VisibËFÜTe¡šg


58 
´iv©e
 
Ob£rvabËAckMsg
 
	mackMes§ges
 = 
Ãw
 ObservableAckMsg();

68 
public
 
	$SourûMªag”
(
CÜfuRuÁime
 
ruÁime
,

69 
D©aS’d”
 
d©aS’d”
,

70 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

72 
	`this
(
ruÁime
, 
d©aS’d”
, 
cÚfig
, 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
DEFAULT_FSM_WORKER_THREADS
, 
Ãw


73 
	`Th»adFaùÜyBud”
().
	`£tNameFÜm©
("¡©e-machše-wÜk”").
	`bud
()));

76 
public
 
	$SourûMªag”
(
SŒšg
 
loÿlEndpošt
, 
LogR•liÿtiÚCl›Á
 
ş›Á
, 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

77 
	`this
(
CÜfuRuÁime
.
	`äomP¬am‘”s
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
()).
	`·r£CÚfigu¿tiÚSŒšg
(
loÿlEndpošt
).
	`cÚÃù
(),

78 
ş›Á
, 
cÚfig
);

79 
	}
}

87 
public
 
	$SourûMªag”
(
CÜfuRuÁime
 
ruÁime
, 
LogR•liÿtiÚCl›Á
 
ş›Á
, 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

88 
	`this
(
ruÁime
, 
Ãw
 
	`CÜfuD©aS’d”
(
ş›Á
), 
cÚfig
);

89 
	}
}

100 
public
 
	$SourûMªag”
(
CÜfuRuÁime
 
ruÁime
,

101 
D©aS’d”
 
d©aS’d”
,

102 
R—dProûssÜ
 
»adProûssÜ
,

103 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

105 
	`this
(
ruÁime
, 
d©aS’d”
, 
»adProûssÜ
, 
cÚfig
, 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
DEFAULT_FSM_WORKER_THREADS
, 
Ãw


106 
	`Th»adFaùÜyBud”
().
	`£tNameFÜm©
("¡©e-machše-wÜk”").
	`bud
()));

107 
	}
}

120 
public
 
	$SourûMªag”
(
CÜfuRuÁime
 
ruÁime
,

121 
D©aS’d”
 
d©aS’d”
,

122 
LogR•liÿtiÚCÚfig
 
cÚfig
,

123 
ExecutÜS”viû
 
logR•liÿtiÚFSMWÜk”s
) {

124 
	`this
(
ruÁime
, 
d©aS’d”
, 
Ãw
 
	`DeçuÉR—dProûssÜ
ÔuÁime), 
cÚfig
, 
logR•liÿtiÚFSMWÜk”s
);

125 
	}
}

139 
public
 
	$SourûMªag”
(
CÜfuRuÁime
 
ruÁime
,

140 
D©aS’d”
 
d©aS’d”
,

141 
R—dProûssÜ
 
»adProûssÜ
,

142 
LogR•liÿtiÚCÚfig
 
cÚfig
,

143 
ExecutÜS”viû
 
logR•liÿtiÚFSMWÜk”s
) {

144 ià(
cÚfig
.
	`g‘SŒ—msToR•liÿ‹
(è=ğ
nuÎ
 || cÚfig.g‘SŒ—msToR•liÿ‹().
	`isEm±y
()) {

146 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Invalid Log Replication: Streamso„eplicate is EMPTY");

152 
this
.
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
ÔuÁime.
	`g‘P¬am‘”s
());

153 
this
.
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
ÔuÁime.
	`g‘LayoutS”v”s
().
	`g‘
(0)).
	`cÚÃù
();

155 
this
.
logR•liÿtiÚFSM
 = 
Ãw
 
	`LogR•liÿtiÚFSM
Ñhis.
ruÁime
, 
cÚfig
, 
d©aS’d”
, 
»adProûssÜ
,

156 
logR•liÿtiÚFSMWÜk”s
);

157 
	}
}

166 
public
 
UUID
 
	$¡¬tSÇpshÙSync
() {

168 
LogR•liÿtiÚEv’t
 
¢­shÙSyncReque¡
 = 
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_REQUEST
);

169 
log
.
	`šfo
("S¹ SÇpshÙ SynøfÜ„eque¡: {}", 
¢­shÙSyncReque¡
.
	`g‘Ev’tID
());

170 
logR•liÿtiÚFSM
.
	`šput
(
¢­shÙSyncReque¡
);

171  
¢­shÙSyncReque¡
.
	`g‘Ev’tID
();

172 
	}
}

180 
public
 
UUID
 
	$¡¬tR•liÿtiÚ
() {

182 
LogR•liÿtiÚEv’t
 
»¶iÿtiÚS¹
 = 
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_START
);

183 
log
.
	`šfo
("S¹ Log EÁry SynøfÜ„eque¡: {}", 
»¶iÿtiÚS¹
.
	`g‘Ev’tID
());

184 
logR•liÿtiÚFSM
.
	`šput
(
»¶iÿtiÚS¹
);

185  
»¶iÿtiÚS¹
.
	`g‘Ev’tID
();

186 
	}
}

193 
public
 
	$ÿnûlSÇpshÙSync
(
UUID
 
¢­shÙSyncId
) {

194 
log
.
	`šfo
("CªûÈSÇpshÙ SynøfÜ„eque¡: {}", 
¢­shÙSyncId
);

196 
logR•liÿtiÚFSM
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
,

197 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
¢­shÙSyncId
)));

198 
	}
}

205 
public
 
	$shutdown
() {

207 
LogR•liÿtiÚEv’t
 
logR•liÿtiÚEv’t
 = 
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_STOP
);

208 
logR•liÿtiÚFSM
.
	`šput
(
logR•liÿtiÚEv’t
);

210 
Œy
 {

211 
	`synchrÚized
 (
logR•liÿtiÚEv’t
) {

212 
logR•liÿtiÚEv’t
.
	`wa™
();

214 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

215 
log
.
	`”rÜ
("Caughˆªƒxû±iÚ ", 
e
);

219 
log
.
	`šfo
("Shutdown Log Replication.");

220 
this
.
ruÁime
.
	`shutdown
();

221 
	}
}

223 @
Ov”ride


224 
public
 
LogR•liÿtiÚEÁry
 
	$»ûive
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

225 
log
.
	`Œaû
("Data Message„eceived on source");

227 
couÁACKs
++;

228 
ackMes§ges
.
	`£tV®ue
(
mes§ge
);

231 if(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è=ğ
Mes§geTy³
.
LOG_ENTRY_REPLICATED
) {

232 
log
.
	`debug
("LogƒÁry synøACK„eûived oÀtime¡am°{}", 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
());

233 
logR•liÿtiÚFSM
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
LOG_ENTRY_SYNC_REPLICATED
,

234 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘SyncReque¡Id
(), mes§ge.g‘M‘ad©a().
	`g‘Time¡amp
())));

235 } ià(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(è=ğ
Mes§geTy³
.
SNAPSHOT_REPLICATED
) {

236 
log
.
	`debug
("SÇpshÙ synøACK„eûived oÀba£ime¡am°{}", 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
());

237 
logR•liÿtiÚFSM
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_COMPLETE
,

238 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘SyncReque¡Id
(), mes§ge.g‘M‘ad©a().
	`g‘Time¡amp
())));

240 
log
.
	`debug
("Reûived d©¨mes§goàty³ {}‚Ù‡ÀACK", 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
());

243  
nuÎ
;

244 
	}
}

246 @
Ov”ride


247 
public
 
LogR•liÿtiÚEÁry
 
»ûive
(
Li¡
<LogR•liÿtiÚEÁry> 
mes§ges
) {

248 
	gmes§ges
.
fÜEach
(
mes§ge
 -> 
»ûive
(message));

249  
	gnuÎ
;

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/IllegalTransitionException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
.
	gLogR•liÿtiÚEv’tTy³
;

9 
public
 cÏs 
	cIÎeg®T¿ns™iÚExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

17 
public
 
	$IÎeg®T¿ns™iÚExû±iÚ
(
LogR•liÿtiÚEv’tTy³
 
ev’tTy³
, 
LogR•liÿtiÚS‹Ty³
 
¡©eTy³
) {

18 
	`su³r
(
SŒšg
.
	`fÜm©
("IÎeg®¿ns™iÚ fÜƒv’ˆ% whš s‹ %s", 
ev’tTy³
, 
¡©eTy³
));

20 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/InLogEntrySyncState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogEÁryS’d”
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

14 @
Slf4j


15 
public
 cÏs 
	cInLogEÁrySyncS‹
 
im¶em’ts
 
	mLogR•liÿtiÚS‹
 {

20 
´iv©e
 
fš®
 
LogR•liÿtiÚFSM
 
	mfsm
;

25 
´iv©e
 
LogEÁryS’d”
 
	mlogEÁryS’d”
;

30 
´iv©e
 
	mFutu»
<?> 
	mlogEÁrySyncFutu»
;

36 
´iv©e
 
UUID
 
	mŒªs™iÚEv’tId
;

44 
public
 
	$InLogEÁrySyncS‹
(
LogR•liÿtiÚFSM
 
logR•liÿtiÚFSM
, 
LogEÁryS’d”
 
logEÁryS’d”
) {

45 
this
.
fsm
 = 
logR•liÿtiÚFSM
;

46 
this
.
logEÁryS’d”
 =†ogEntrySender;

49 @
Ov”ride


50 
public
 
LogR•liÿtiÚS‹
 
	$´oûssEv’t
(
LogR•liÿtiÚEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
 {

51 
ev’t
.
	`g‘Ty³
()) {

52 
SNAPSHOT_SYNC_REQUEST
:

53 
	`ÿnûlLogEÁrySync
("snapshot sync„equest.");

54 
LogR•liÿtiÚS‹
 
¢­shÙSyncS‹
 = 
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
);

55 
¢­shÙSyncS‹
.
	`£tT¿ns™iÚEv’tId
(
ev’t
.
	`g‘Ev’tID
());

56  
¢­shÙSyncS‹
;

57 
SYNC_CANCEL
:

61 ià(
Œªs™iÚEv’tId
 =ğ
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
()) {

62 
	`ÿnûlLogEÁrySync
("sync cancel.");

63 
LogR•liÿtiÚS‹
 
šSÇpshÙSyncS‹
 = 
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
);

64 
šSÇpshÙSyncS‹
.
	`£tT¿ns™iÚEv’tId
(
UUID
.
	`¿ndomUUID
());

65  
šSÇpshÙSyncS‹
;

68 
log
.
	`w¬n
("Log Entry Sync cancel forƒventId {}, but„unning†ogƒntry sync for {}",

69 
ev’t
.
	`g‘Ev’tID
(), 
Œªs™iÚEv’tId
);

70  
this
;

71 
REPLICATION_STOP
:

72 
	`ÿnûlLogEÁrySync
("replication being stopped.");

73  
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

74 
REPLICATION_SHUTDOWN
:

75 
	`ÿnûlLogEÁrySync
("replicationerminated.");

76  
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
STOPPED
);

77 
LOG_ENTRY_SYNC_CONTINUE
:

82 ià(
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
(è=ğ
Œªs™iÚEv’tId
) {

83 
log
.
	`debug
("CÚtšu©iÚ oàlogƒÁry synøfÜ {}", 
ev’t
.
	`g‘Ev’tID
());

84  
this
;

86 
log
.
	`w¬n
("Unexpected†ogƒntry sync continueƒvent {} when in†ogƒntry sync state {}.",

87 
ev’t
.
	`g‘Ev’tID
(), 
Œªs™iÚEv’tId
);

90 
log
.
	`w¬n
("UÃx³ùed†og„•liÿtiÚƒv’ˆ{} wh’ iÀlogƒÁry synø¡©e.", 
ev’t
.
	`g‘Ty³
());

93 
throw
 
Ãw
 
	`IÎeg®T¿ns™iÚExû±iÚ
(
ev’t
.
	`g‘Ty³
(), getType());

95 
	}
}

102 
´iv©e
 
	$ÿnûlLogEÁrySync
(
SŒšg
 
ÿnûlCau£
) {

107 
logEÁryS’d”
.
	`¡İ
();

108 ià(!
logEÁrySyncFutu»
.
	`isDÚe
()) {

109 
Œy
 {

110 
logEÁrySyncFutu»
.
	`g‘
();

111 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

112 
log
.
	`w¬n
("Exû±iÚ whwa™šg oÀlogƒÁry synøtØcom¶‘e.", 
e
);

115 
log
.
	`šfo
("Log EÁry synøha b“ÀÿnûËd dutØ{}", 
ÿnûlCau£
);

116 
	}
}

118 @
Ov”ride


119 
public
 
	$ÚEÁry
(
LogR•liÿtiÚS‹
 
äom
) {

121 
Œy
 {

125 ià(
äom
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC


126 || 
äom
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
) {

127 
logEÁryS’d”
.
	`»£t
(
fsm
.
	`g‘Ba£SÇpshÙ
(), fsm.
	`g‘AckedTime¡amp
());

130 
logEÁryS’d”
.
	`upd©eAckTs
(
fsm
.
	`g‘AckedTime¡amp
());

131 
logEÁrySyncFutu»
 = 
fsm
.
	`g‘LogR•liÿtiÚFSMWÜk”s
().
	`subm™
((è-> 
logEÁryS’d”
.
	`£nd
(
Œªs™iÚEv’tId
));

133 } 
	`ÿtch
 (
ThrowabË
 
t
) {

134 
log
.
	`”rÜ
("E¼Ü oÀ’Œy oàInLogEÁrySyncS‹", 
t
);

136 
	}
}

138 @
Ov”ride


139 
public
 
	$£tT¿ns™iÚEv’tId
(
UUID
 
ev’tId
) {

140 
Œªs™iÚEv’tId
 = 
ev’tId
;

141 
	}
}

143 @
Ov”ride


144 
public
 
UUID
 
	$g‘T¿ns™iÚEv’tId
() {

145  
Œªs™iÚEv’tId
;

146 
	}
}

148 @
Ov”ride


149 
public
 
LogR•liÿtiÚS‹Ty³
 
	$g‘Ty³
() {

150  
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
;

151 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/InSnapshotSyncState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙS’d”
;

9 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

17 @
Slf4j


18 
public
 cÏs 
	cInSÇpshÙSyncS‹
 
im¶em’ts
 
	mLogR•liÿtiÚS‹
 {

23 
´iv©e
 
fš®
 
LogR•liÿtiÚFSM
 
	mfsm
;

34 
´iv©e
 
UUID
 
	mŒªs™iÚEv’tId
;

39 @
	mG‘‹r


40 @
VisibËFÜTe¡šg


41 
´iv©e
 
SÇpshÙS’d”
 
	m¢­shÙS’d”
;

46 
´iv©e
 
	mFutu»
<?> 
	mŒªsm™Futu»
;

54 
public
 
	$InSÇpshÙSyncS‹
(
LogR•liÿtiÚFSM
 
logR•liÿtiÚFSM
, 
SÇpshÙS’d”
 
¢­shÙS’d”
) {

55 
this
.
fsm
 = 
logR•liÿtiÚFSM
;

56 
this
.
¢­shÙS’d”
 = snapshotSender;

59 @
Ov”ride


60 
public
 
LogR•liÿtiÚS‹
 
	$´oûssEv’t
(
LogR•liÿtiÚEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
 {

61 
ev’t
.
	`g‘Ty³
()) {

62 
SNAPSHOT_SYNC_REQUEST
:

66 
	`ÿnûlSÇpshÙSync
("another snapshot sync„equest.");

74 
	`£tT¿ns™iÚEv’tId
(
ev’t
.
	`g‘Ev’tID
());

75 
¢­shÙS’d”
.
	`»£t
();

76  
this
;

77 
SNAPSHOT_SYNC_CONTINUE
:

84 ià(
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
(è=ğ
Œªs™iÚEv’tId
) {

85 
log
.
	`debug
("CÚtšu©iÚ oà¢­shÙ synøfÜ {}", 
ev’t
.
	`g‘Ev’tID
());

86  
this
;

88 
log
.
	`w¬n
("Unexpected snapshot sync continueƒvent {} when in snapshot sync state {}.",

89 
ev’t
.
	`g‘Ev’tID
(), 
Œªs™iÚEv’tId
);

91 
SYNC_CANCEL
:

93 ià(
Œªs™iÚEv’tId
 =ğ
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
()) {

94 
	`ÿnûlSÇpshÙSync
("cancellation„equest.");

96 
LogR•liÿtiÚS‹
 
šSÇpshÙSyncS‹
 = 
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
);

97 
šSÇpshÙSyncS‹
.
	`£tT¿ns™iÚEv’tId
(
UUID
.
	`¿ndomUUID
());

98 
¢­shÙS’d”
.
	`»£t
();

99  
šSÇpshÙSyncS‹
;

102 
log
.
	`w¬n
("Sync Cancel forƒventId {}, but„unning snapshot sync for {}",

103 
ev’t
.
	`g‘Ev’tID
(), 
Œªs™iÚEv’tId
);

104  
this
;

105 
SNAPSHOT_SYNC_COMPLETE
:

106 
UUID
 
¢­shÙSyncReque¡Id
 = 
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
();

117 ià(
¢­shÙSyncReque¡Id
 =ğ
Œªs™iÚEv’tId
) {

118 
	`ÿnûlSÇpshÙSync
("it has completed.");

119 
LogR•liÿtiÚS‹
 
logEÁrySyncS‹
 = 
fsm
.
	`g‘S‹s
()

120 .
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

123 
logEÁrySyncS‹
.
	`£tT¿ns™iÚEv’tId
(
ev’t
.
	`g‘Ev’tID
());

124  
logEÁrySyncS‹
;

127 
log
.
	`w¬n
("Ignoring snapshot sync completeƒvent, for„equest {},‡s ongoing snapshot sync is {}",

128 
¢­shÙSyncReque¡Id
, 
Œªs™iÚEv’tId
);

129  
this
;

130 
REPLICATION_STOP
:

134 
	`ÿnûlSÇpshÙSync
("requesto stop„eplication.");

135  
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

136 
REPLICATION_SHUTDOWN
:

140 
	`ÿnûlSÇpshÙSync
("replicationerminated.");

141  
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
STOPPED
);

143 
log
.
	`w¬n
("UÃx³ùed†og„•liÿtiÚƒv’ˆ{} wh’ iÀ¢­shÙ synø¡©e.", 
ev’t
.
	`g‘Ty³
());

146 
throw
 
Ãw
 
	`IÎeg®T¿ns™iÚExû±iÚ
(
ev’t
.
	`g‘Ty³
(), getType());

148 
	}
}

150 @
Ov”ride


151 
public
 
	$ÚEÁry
(
LogR•liÿtiÚS‹
 
äom
) {

152 
Œy
 {

156 ià(
äom
 !ğ
this
) {

157 
¢­shÙS’d”
.
	`»£t
();

163 
Œªsm™Futu»
 = 
fsm
.
	`g‘LogR•liÿtiÚFSMWÜk”s
().
	`subm™
((è-> 
¢­shÙS’d”
.
	`Œªsm™
(
Œªs™iÚEv’tId
));

165 } 
	`ÿtch
 (
ThrowabË
 
t
) {

166 
log
.
	`”rÜ
("E¼Ü oÀ’Œy oàInSÇpshÙSyncS‹.", 
t
);

168 
	}
}

170 @
Ov”ride


171 
public
 
	$£tT¿ns™iÚEv’tId
(
UUID
 
ev’tId
) {

172 
this
.
Œªs™iÚEv’tId
 = 
ev’tId
;

173 
	}
}

175 @
Ov”ride


176 
public
 
UUID
 
	$g‘T¿ns™iÚEv’tId
(è{  
Œªs™iÚEv’tId
; 
	}
}

184 
´iv©e
 
	$ÿnûlSÇpshÙSync
(
SŒšg
 
ÿnûlCau£
) {

185 
¢­shÙS’d”
.
	`¡İ
();

186 ià(!
Œªsm™Futu»
.
	`isDÚe
()) {

187 
Œy
 {

188 
Œªsm™Futu»
.
	`g‘
();

189 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

190 
log
.
	`w¬n
("Exû±iÚ whwa™šg oÀ¢­shÙ synøtØcom¶‘e.", 
e
);

193 
log
.
	`šfo
("SÇpshÙ synøi ’dšg beÿu£ {}", 
ÿnûlCau£
);

194 
	}
}

196 @
Ov”ride


197 
public
 
LogR•liÿtiÚS‹Ty³
 
	$g‘Ty³
() {

198  
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
;

199 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/InitializedState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

15 @
Slf4j


16 
public
 cÏs 
	cIn™ŸlizedS‹
 
im¶em’ts
 
	mLogR•liÿtiÚS‹
 {

21 
´iv©e
 
fš®
 
LogR•liÿtiÚFSM
 
	mfsm
;

28 
public
 
	$In™ŸlizedS‹
(
LogR•liÿtiÚFSM
 
logR•liÿtiÚFSM
) {

29 
this
.
fsm
 = 
logR•liÿtiÚFSM
;

32 @
Ov”ride


33 
public
 
LogR•liÿtiÚS‹
 
	$´oûssEv’t
(
LogR•liÿtiÚEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
 {

34 
ev’t
.
	`g‘Ty³
()) {

35 
SNAPSHOT_SYNC_REQUEST
:

38 
LogR•liÿtiÚS‹
 
¢­shÙSyncS‹
 = 
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
);

39 
¢­shÙSyncS‹
.
	`£tT¿ns™iÚEv’tId
(
ev’t
.
	`g‘Ev’tID
());

40  
¢­shÙSyncS‹
;

41 
REPLICATION_START
:

44 
LogR•liÿtiÚS‹
 
logEÁrySyncS‹
 = 
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

45 
logEÁrySyncS‹
.
	`£tT¿ns™iÚEv’tId
(
ev’t
.
	`g‘Ev’tID
());

46  
logEÁrySyncS‹
;

47 
REPLICATION_STOP
:

48  
this
;

49 
REPLICATION_SHUTDOWN
:

50  
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
STOPPED
);

52 
log
.
	`w¬n
("UÃx³ùed†og„•liÿtiÚƒv’ˆ{} wh’ iÀš™Ÿlized s‹.", 
ev’t
.
	`g‘Ty³
());

53 
throw
 
Ãw
 
	`IÎeg®T¿ns™iÚExû±iÚ
(
ev’t
.
	`g‘Ty³
(), getType());

56 
	}
}

58 @
Ov”ride


59 
public
 
LogR•liÿtiÚS‹Ty³
 
	$g‘Ty³
(è{  
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
; 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationEvent.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogR•liÿtiÚEv’tM‘ad©a
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 @
D©a


14 
public
 cÏs 
	cLogR•liÿtiÚEv’t
 {

19 
public
 
	eLogR•liÿtiÚEv’tTy³
 {

20 
	mREPLICATION_START
,

21 
	mREPLICATION_STOP
,

22 
	mSNAPSHOT_SYNC_REQUEST
,

23 
	mSNAPSHOT_SYNC_CONTINUE
,

25 
	mSNAPSHOT_SYNC_COMPLETE
,

26 
	mLOG_ENTRY_SYNC_CONTINUE
,

28 
	mSYNC_CANCEL
,

29 
	mLOG_ENTRY_SYNC_REPLICATED
,

31 
	mREPLICATION_SHUTDOWN


38 
´iv©e
 
UUID
 
	gev’tID
;

43 
´iv©e
 
LogR•liÿtiÚEv’tTy³
 
	gty³
;

48 
´iv©e
 
LogR•liÿtiÚEv’tM‘ad©a
 
	gm‘ad©a
;

55 
public
 
	$LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
 
ty³
) {

56 
	`this
(
ty³
, 
LogR•liÿtiÚEv’tM‘ad©a
.
	`em±y
());

57 
	}
}

66 
public
 
	$LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
 
ty³
, 
LogR•liÿtiÚEv’tM‘ad©a
 
m‘ad©a
) {

67 
this
.
ty³
 =ype;

68 
this
.
ev’tID
 = 
UUID
.
	`¿ndomUUID
();

69 
this
.
m‘ad©a
 = metadata;

70 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationFSM.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
.
	gLogR•liÿtiÚEv’tTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
.
	gCrossS™eCÚfigu¿tiÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogEÁryR—d”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogEÁryS’d”
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gR—dProûssÜ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—d”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙS’d”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msLogEÁryR—d”
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msSÇpshÙR—d”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gLškedBlockšgQueue
;

97 @
Slf4j


98 
public
 cÏs 
	cLogR•liÿtiÚFSM
 {

100 
´iv©e
 
CrossS™eCÚfigu¿tiÚ
 
	ms™eCÚfig
;

102 @
G‘‹r


103 
´iv©e
 
	ms™eEpoch
;

108 @
G‘‹r


109 
´iv©e
 vŞ©
LogR•liÿtiÚS‹
 
	m¡©e
;

114 @
G‘‹r


115 
´iv©e
 
	mM­
<
	mLogR•liÿtiÚS‹Ty³
, 
	mLogR•liÿtiÚS‹
> 
	m¡©es
 = 
Ãw
 
HashM­
<>();

120 @
G‘‹r


121 
´iv©e
 
ExecutÜS”viû
 
	mlogR•liÿtiÚFSMWÜk”s
;

126 
´iv©e
 
ExecutÜS”viû
 
	mlogR•liÿtiÚFSMCÚsum”
;

131 
´iv©e
 
fš®
 
	mLškedBlockšgQueue
<
	mLogR•liÿtiÚEv’t
> 
	mev’tQueue
 = 
Ãw
 
LškedBlockšgQueue
<>();

136 @
	mVisibËFÜTe¡šg


137 @
G‘‹r


138 
´iv©e
 
Ob£rvabËV®ue
 
	mnumT¿ns™iÚs
 = 
Ãw
 ObservableValue(0);

143 
LogEÁryR—d”
 
	mlogEÁryR—d”
;

148 
SÇpshÙR—d”
 
	m¢­shÙR—d”
;

153 @
G‘‹r


154 
	mba£SÇpshÙ
 = 
Add»ss
.
NON_ADDRESS
;

159 @
G‘‹r


160 
	mackedTime¡amp
 = 
Add»ss
.
NON_ADDRESS
;

172 
public
 
	$LogR•liÿtiÚFSM
(
CÜfuRuÁime
 
ruÁime
, 
LogR•liÿtiÚCÚfig
 
cÚfig
, 
D©aS’d”
 
d©aS’d”
,

173 
R—dProûssÜ
 
»adProûssÜ
, 
ExecutÜS”viû
 
wÜk”s
) {

175 
	`this
(
ruÁime
, 
Ãw
 
	`SŒ—msSÇpshÙR—d”
ÔuÁime, 
cÚfig
), 
d©aS’d”
,

176 
Ãw
 
	`SŒ—msLogEÁryR—d”
(
ruÁime
, 
cÚfig
), 
»adProûssÜ
, cÚfig, 
wÜk”s
);

191 @
VisibËFÜTe¡šg


192 
public
 
	$LogR•liÿtiÚFSM
(
CÜfuRuÁime
 
ruÁime
, 
SÇpshÙR—d”
 
¢­shÙR—d”
, 
D©aS’d”
 
d©aS’d”
,

193 
LogEÁryR—d”
 
logEÁryR—d”
, 
R—dProûssÜ
 
»adProûssÜ
, 
LogR•liÿtiÚCÚfig
 
cÚfig
,

194 
ExecutÜS”viû
 
wÜk”s
) {

196 
this
.
¢­shÙR—d”
 = snapshotReader;

197 
this
.
logEÁryR—d”
 =†ogEntryReader;

201 
SÇpshÙS’d”
 
¢­shÙS’d”
 = 
Ãw
 
	`SÇpshÙS’d”
(
ruÁime
, 
¢­shÙR—d”
, 
d©aS’d”
, 
»adProûssÜ
, 
this
);

202 
LogEÁryS’d”
 
logEÁryS’d”
 = 
Ãw
 
	`LogEÁryS’d”
(
ruÁime
, 
logEÁryR—d”
, 
d©aS’d”
, 
»adProûssÜ
, 
this
);

205 
	`š™ŸlizeS‹s
(
¢­shÙS’d”
, 
logEÁryS’d”
);

207 
this
.
¡©e
 = 
¡©es
.
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

208 
this
.
logR•liÿtiÚFSMWÜk”s
 = 
wÜk”s
;

209 
this
.
logR•liÿtiÚFSMCÚsum”
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
(
Ãw


210 
	`Th»adFaùÜyBud”
().
	`£tNameFÜm©
("»¶iÿtiÚ-fsm-cÚsum”").
	`bud
());

212 
logR•liÿtiÚFSMCÚsum”
.
	`subm™
(
this
::
cÚsume
);

214 
log
.
	`šfo
("Log Replication FSM initialized, streamso„eplicate {}o„emote site {}",

215 
cÚfig
.
	`g‘SŒ—msToR•liÿ‹
(), cÚfig.
	`g‘S™eID
());

216 
	}
}

224 
´iv©e
 
	$š™ŸlizeS‹s
(
SÇpshÙS’d”
 
¢­shÙS’d”
, 
LogEÁryS’d”
 
logEÁryS’d”
) {

229 
¡©es
.
	`put
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
, 
Ãw
 
	`In™ŸlizedS‹
(
this
));

230 
¡©es
.
	`put
(
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
, 
Ãw
 
	`InSÇpshÙSyncS‹
(
this
, 
¢­shÙS’d”
));

231 
¡©es
.
	`put
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
Ãw
 
	`InLogEÁrySyncS‹
(
this
, 
logEÁryS’d”
));

232 
¡©es
.
	`put
(
LogR•liÿtiÚS‹Ty³
.
STOPPED
, 
Ãw
 
	`Stİ³dS‹
());

233 
	}
}

242 
public
 
synchrÚized
 
	$šput
(
LogR•liÿtiÚEv’t
 
ev’t
) {

243 
Œy
 {

244 ià(
¡©e
.
	`g‘Ty³
().
	`equ®s
(
LogR•liÿtiÚS‹Ty³
.
STOPPED
)) {

248 ià(
ev’t
.
	`g‘Ty³
(è!ğ
LogR•liÿtiÚEv’tTy³
.
LOG_ENTRY_SYNC_CONTINUE
) {

249 
log
.
	`šfo
("Enqueuev’ˆ{} w™h ID {}", 
ev’t
.
	`g‘Ty³
(),ƒv’t.
	`g‘Ev’tID
());

251 
ev’tQueue
.
	`put
(
ev’t
);

252 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ex
) {

253 
log
.
	`”rÜ
("Log R•liÿtiÚ iÁ”ru±ed Exû±iÚ: ", 
ex
);

255 
	}
}

262 
´iv©e
 
	$cÚsume
() {

263 
Œy
 {

265 ià(
¡©e
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
STOPPED
) {

266 
log
.
	`šfo
("Log Replication State Machine has been stopped. No moreƒvents will be…rocessed.");

272 
LogR•liÿtiÚEv’t
 
ev’t
 = 
ev’tQueue
.
	`ke
();

273 ià(
ev’t
.
	`g‘Ty³
(è!ğ
LogR•liÿtiÚEv’tTy³
.
LOG_ENTRY_SYNC_CONTINUE
) {

274 
log
.
	`šfo
("Log R•liÿtiÚ FSM cÚsumev’ˆ{}", 
ev’t
);

277 ià(
ev’t
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚEv’tTy³
.
LOG_ENTRY_SYNC_REPLICATED
) {

278 ià(
¡©e
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
 &&

279 
¡©e
.
	`g‘T¿ns™iÚEv’tId
().
	`equ®s
(
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
())) {

280 
log
.
	`debug
("Log EÁry SynøACK, upd©Ï¡‡ckime¡am°tØ{}", 
ev’t
.
	`g‘M‘ad©a
().
	`g‘SyncTime¡amp
());

281 
ackedTime¡amp
 = 
ev’t
.
	`g‘M‘ad©a
().
	`g‘SyncTime¡amp
();

284 ià(
ev’t
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_COMPLETE
) {

286 ià(
¡©e
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
 &&

287 
¡©e
.
	`g‘T¿ns™iÚEv’tId
().
	`equ®s
(
ev’t
.
	`g‘M‘ad©a
().
	`g‘Reque¡Id
())) {

288 
log
.
	`debug
("SÇpshÙ SynøACK, upd©Ï¡‡ckime¡am°tØ{}", 
ev’t
.
	`g‘M‘ad©a
().
	`g‘SyncTime¡amp
());

289 
ba£SÇpshÙ
 = 
ev’t
.
	`g‘M‘ad©a
().
	`g‘SyncTime¡amp
();

293 
Œy
 {

294 
LogR•liÿtiÚS‹
 
ÃwS‹
 = 
¡©e
.
	`´oûssEv’t
(
ev’t
);

295 
log
.
	`Œaû
("T¿ns™iÚ from {}Ø{}", 
¡©e
, 
ÃwS‹
);

296 
	`Œªs™iÚ
(
¡©e
, 
ÃwS‹
);

297 
¡©e
 = 
ÃwS‹
;

298 
numT¿ns™iÚs
.
	`£tV®ue
ÒumT¿ns™iÚs.
	`g‘V®ue
() + 1);

299 } 
	`ÿtch
 (
IÎeg®T¿ns™iÚExû±iÚ
 
Ëg®S‹
) {

300 
log
.
	`debug
("IÎeg®†og„•liÿtiÚƒv’ˆ{} wh’ iÀ¡©{}", 
ev’t
.
	`g‘Ty³
(), 
¡©e
.getType());

304 ià(
ev’t
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚEv’tTy³
.
REPLICATION_STOP
) {

305 
Sy¡em
.
out
.
	`´št
("\n****notifyhe stop„eplication is done");

306 
	`synchrÚized
 (
ev’t
) {

307 
ev’t
.
	`nÙifyAÎ
();

313 
logR•liÿtiÚFSMCÚsum”
.
	`subm™
(
this
::
cÚsume
);

315 } 
	`ÿtch
 (
ThrowabË
 
t
) {

316 
log
.
	`”rÜ
("E¼Ü oÀev’ˆcÚsum”: ", 
t
);

318 
	}
}

326 
	$Œªs™iÚ
(
LogR•liÿtiÚS‹
 
äom
, LogR•liÿtiÚS‹ 
to
) {

327 
äom
.
	`ÚEx™
(
to
);

328 
to
.
	`ş—r
();

329 
to
.
	`ÚEÁry
(
äom
);

330 
	}
}

337 
public
 
	$¡¬tCÚsum”
(
CrossS™eCÚfigu¿tiÚ
 
s™eCÚfig
) {

338 
this
.
s™eCÚfig
 = siteConfig;

339 ià(
¡©e
.
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
STOPPED
) {

340 
ev’tQueue
.
	`ş—r
();

341 
this
.
¡©e
 = 
¡©es
.
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

342 
logR•liÿtiÚFSMCÚsum”
.
	`subm™
(
this
::
cÚsume
);

344 
	}
}

346 
public
 
	$£tS™eEpoch
(
s™eEpoch
) {

347 
this
.
s™eEpoch
 = siteEpoch;

348 
¢­shÙR—d”
.
	`£tS™eEpoch
(
s™eEpoch
);

349 
logEÁryR—d”
.
	`£tS™eEpoch
(
s™eEpoch
);

350 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
public
 
š‹rçû
 
	gLogR•liÿtiÚS‹
 {

15 
LogR•liÿtiÚS‹Ty³
 
g‘Ty³
();

22 
LogR•liÿtiÚS‹
 
´oûssEv’t
(
LogR•liÿtiÚEv’t
 
ev’t
è
throws
 
	gIÎeg®T¿ns™iÚExû±iÚ
;

29  
ÚEÁry
(
LogR•liÿtiÚS‹
 
äom
) {}

36  
ÚEx™
(
LogR•liÿtiÚS‹
 
to
) {}

41  
ş—r
() {}

48  
£tT¿ns™iÚEv’tId
(
UUID
 
ev’tId
) {}

53  
UUID
 
g‘T¿ns™iÚEv’tId
(è{  
	gnuÎ
; }

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationStateType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

8 
public
 
	eLogR•liÿtiÚS‹Ty³
 {

9 
	mINITIALIZED
,

10 
	mIN_SNAPSHOT_SYNC
,

11 
	mIN_LOG_ENTRY_SYNC
,

12 
	mSTOPPED


	@log-replication/src/main/java/org/corfudb/logreplication/fsm/ObservableAckMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

2 
impÜt
 
	glombok
.
	gD©a
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

5 
impÜt
 
	gjava
.
	gut
.
	gOb£rvabË
;

13 @
D©a


14 
public
 cÏs 
	cOb£rvabËAckMsg
 
ex‹nds
 
	mOb£rvabË


16 
	mmsgCÁ
;

17 
LogR•liÿtiÚEÁry
 
	md©aMes§ge
;

19 
public
 
	$Ob£rvabËAckMsg
() {

20 
this
.
msgCÁ
 = 0;

21 
this
.
d©aMes§ge
 = 
nuÎ
;

24 
public
 
	$£tV®ue
(
LogR•liÿtiÚEÁry
 
d©aMes§ge
)

26 ià(
d©aMes§ge
 !ğ
nuÎ
) {

27 
this
.
d©aMes§ge
 = dataMessage;

28 
msgCÁ
++;

30 
	`£tChªged
();

31 
	`nÙifyOb£rv”s
(
d©aMes§ge
);

32 
	}
}

34 
public
 
Ob£rvabËAckMsg
 
	$g‘V®ue
()

36  
this
;

37 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/fsm/StoppedState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 @
Slf4j


11 
public
 cÏs 
	cStİ³dS‹
 
im¶em’ts
 
	mLogR•liÿtiÚS‹
 {

14 
public
 
	$Stİ³dS‹
 () {

17 @
Ov”ride


18 
public
 
LogR•liÿtiÚS‹
 
	$´oûssEv’t
(
LogR•liÿtiÚEv’t
 
ev’t
) {

19  
nuÎ
;

20 
	}
}

22 @
Ov”ride


23 
public
 
	$ÚEÁry
(
LogR•liÿtiÚS‹
 
äom
) {

24 
log
.
	`šfo
("Unrecoverableƒrror orƒxplicit shutdown. " +

25 "Log R•liÿtiÚ i ‹rmš©ed from s‹ {}. TØ»sume,„e¡¬ˆthJVM.", 
äom
.
	`g‘Ty³
());

26 
	}
}

28 @
Ov”ride


29 
public
 
LogR•liÿtiÚS‹Ty³
 
	$g‘Ty³
() {

30  
LogR•liÿtiÚS‹Ty³
.
STOPPED
;

31 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationDiscoveryService.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gGlob®Mªag”Stus
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gLškedBlockšgQueue
;

17 @
Slf4j


18 
public
 cÏs 
	cCÜfuR•liÿtiÚDiscov”yS”viû
 
im¶em’ts
 
	mRuÂabË
 {

23 
´iv©e
 
fš®
 
CÜfuR•liÿtiÚS”v”Node
 
	m»¶iÿtiÚS”v”Node
;

28 @
G‘‹r


29 
´iv©e
 
fš®
 
CÜfuR•liÿtiÚMªag”
 
	m»¶iÿtiÚMªag”
;

30 
´iv©e
 
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
	ms™eMªag”
;

31 
´iv©e
 
SŒšg
 
	mloÿlEndpošt
;

32 
boŞ—n
 
	mshouldRun
 = 
Œue
;

33 
CrossS™eCÚfigu¿tiÚ
 
	müossS™eCÚfig
;

34 
	mCrossS™eCÚfigu¿tiÚ
.
NodeInfo
 
	mnodeInfo
 = 
nuÎ
;

39 
´iv©e
 
fš®
 
	mLškedBlockšgQueue
<
	mDiscov”yS”viûEv’t
> 
	mev’tQueue
 = 
Ãw
 
LškedBlockšgQueue
<>();

41 
public
 
	$CÜfuR•liÿtiÚDiscov”yS”viû
(
SŒšg
 
’dpošt
, 
CÜfuR•liÿtiÚS”v”Node
 
£rv”Node
, 
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
s™eMªag”
) {

42 
this
.
»¶iÿtiÚS”v”Node
 = 
£rv”Node
;

43 
this
.
»¶iÿtiÚMªag”
 = 
Ãw
 
	`CÜfuR•liÿtiÚMªag”
();

44 
this
.
loÿlEndpošt
 = 
’dpošt
;

45 
this
.
s™eMªag”
 = siteManager;

46 
this
.
s™eMªag”
.
	`£tCÜfuR•liÿtiÚDiscov”yS”viû
(this);

49 
public
 
	$run
() {

50 
s™eMªag”
.
	`¡¬t
();

52 
shouldRun
) {

53 
Œy
 {

55 
	`runS”viû
();

59 
	`synchrÚized
 (
ev’tQueue
) {

60 
Œue
) {

61 
Discov”yS”viûEv’t
 
ev’t
 = 
ev’tQueue
.
	`ke
();

62 ià(
ev’t
.
s™eCÚfigMsg
.
	`g‘Epoch
(è> 
üossS™eCÚfig
.getEpoch()) {

67 
»¶iÿtiÚMªag”
.
	`¡İLogR•liÿtiÚ
(
üossS™eCÚfig
);

68 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

69 
log
.
	`”rÜ
("ÿughˆªƒxû±iÚ ", 
e
);

70 
shouldRun
 = 
çl£
;

71 ià(
e
 
š¡ªûof
 
IÁ”ru±edExû±iÚ
) {

72 
Th»ad
.
	`š‹¼u±ed
();

76 
	}
}

78 
public
 
	$runS”viû
() {

79 
Œy
 {

80 
log
.
	`šfo
("Run Corfu Replication Discovery");

84 
üossS™eCÚfig
 = 
s™eMªag”
.
	`ãtchS™eCÚfig
();

88 
nodeInfo
 = 
üossS™eCÚfig
.
	`g‘NodeInfo
(
loÿlEndpošt
);

91 
nodeInfo
.
	`£tL—d”
(
	`acquœeLock
());

93 ià(
nodeInfo
.
	`isL—d”
()) {

94 ià(
nodeInfo
.
	`g‘RŞeTy³
(è=ğ
Glob®Mªag”Stus
.
ACTIVE
) {

95 
üossS™eCÚfig
.
	`g‘Prim¬yS™e
().
	`£tL—d”
(
nodeInfo
);

96 
log
.
	`šfo
("S¹‡ Sourû (£nd”/»¶iÿtÜèÚ‚od{}.", 
nodeInfo
);

99 
Œy
 {

100 
»¶iÿtiÚMªag”
.
	`£tupR•liÿtiÚL—d”RuÁime
(
nodeInfo
, 
üossS™eCÚfig
);

101 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

102 
log
.
	`”rÜ
("CÜfu R•liÿtiÚ Discov”y S”viû i š‹¼u±ed", 
›
);

103 
throw
 
›
;

106 
»¶iÿtiÚMªag”
.
	`¡¬tLogR•liÿtiÚ
(
üossS™eCÚfig
);

109 } ià(
nodeInfo
.
	`g‘RŞeTy³
(è=ğ
Glob®Mªag”Stus
.
STANDBY
) {

113 
»¶iÿtiÚS”v”Node
.
	`g‘LogR•liÿtiÚS”v”
().
	`g‘SškMªag”
().
	`g‘P”si¡edWr™”M‘ad©a
().

114 
	`£tupEpoch
(
üossS™eCÚfig
.
	`g‘Epoch
());

115 
log
.
	`šfo
("S¹‡ Sšk (»ûiv”èÚ‚od{} ", 
nodeInfo
);

121 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

122 
log
.
	`”rÜ
("CaughˆExû±iÚ whdiscov”šg„emÙs™es,„‘ry. ", 
e
);

123 } 
fš®ly
 {

124 ià(
nodeInfo
 !ğ
nuÎ
 &&‚odeInfo.
	`isL—d”
()) {

125 
	`»Ëa£Lock
();

128 
	}
}

130 
public
 
synchrÚized
 
	$putEv’t
(
Discov”yS”viûEv’t
 
ev’t
) {

131 
ev’tQueue
.
	`add
(
ev’t
);

132 
	`nÙifyAÎ
();

133 
	}
}

140 
´iv©e
 
boŞ—n
 
	$acquœeLock
() {

141  
Œue
;

142 
	}
}

144 
´iv©e
 
	$»Ëa£Lock
() {

146 
	}
}

148 
public
 
	eDiscov”yS”viûEv’tTy³
 {

149 
Discov”yS™e
("SiteChange");

151 @
G‘‹r


152 
SŒšg
 
	gv®
;

153 
Discov”yS”viûEv’tTy³
(
SŒšg
 
ÃwV®
) {

154 
	gv®
 = 
ÃwV®
;

158 şas 
	cDiscov”yS”viûEv’t
 {

159 
Discov”yS”viûEv’tTy³
 
	gty³
;

160 @
G‘‹r


161 
S™eCÚfigu¿tiÚMsg
 
	gs™eCÚfigMsg
;

163 
Discov”yS”viûEv’t
(
Discov”yS”viûEv’tTy³
 
ty³
, 
S™eCÚfigu¿tiÚMsg
 
s™eCÚfigMsg
) {

164 
	gthis
.
	gty³
 = 
ty³
;

165 
	gthis
.
	gs™eCÚfigMsg
 = 
s™eCÚfigMsg
;

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
.
	gLogR•liÿtiÚRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gIR‘ry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gIÁ”v®R‘ry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gR‘ryN“dedExû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 @
Slf4j


14 
public
 cÏs 
	cCÜfuR•liÿtiÚMªag”
 {

17 
	mM­
<
	mSŒšg
, 
	mLogR•liÿtiÚRuÁime
> 
	mlogR•liÿtiÚRuÁimes
 = 
Ãw
 
HashM­
<>();

19 
	eLogR•liÿtiÚNegÙŸtiÚResuÉ
 {

20 
	mSNAPSHOT_SYNC
,

21 
	mLOG_ENTRY_SYNC
,

22 
	mLEADERSHIP_LOST
,

23 
	mCONNECTION_LOST
,

24 
	mERROR
,

25 
	mUNKNOWN


28 
public
 
	$£tupR•liÿtiÚL—d”RuÁime
(
CrossS™eCÚfigu¿tiÚ
.
NodeInfo
 
nodeInfo
, CrossS™eCÚfigu¿tiÚ 
cÚfig
)

29 
throws
 
IÁ”ru±edExû±iÚ
 {

30 
log
.
	`šfo
("£tupR•liÿtiÚL—d”RuÁimcÚfig {}", 
cÚfig
);

32 
Œy
 {

33 
IR‘ry
.
	`bud
(
IÁ”v®R‘ry
.
şass
, () -> {

34 
Œy
 {

35 
M­
.
EÁry
<
SŒšg
, 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
> 
’Œy
 : 
cÚfig
.
	`g‘SndbyS™es
().
	`’ŒyS‘
()) {

36 
’Œy
.
	`g‘V®ue
().
	`£tupLogR•liÿtiÚRemÙeRuÁime
(
nodeInfo
, 
cÚfig
.
	`g‘Epoch
());

37 
log
.
	`šfo
("£tupR•liÿtiÚL—d”RuÁim{}", 
’Œy
);

38 
CrossS™eCÚfigu¿tiÚ
.
NodeInfo
 
Ëad”
 = 
’Œy
.
	`g‘V®ue
().
	`g‘RemÙeL—d”
();

39 
logR•liÿtiÚRuÁimes
.
	`put
(
’Œy
.
	`g‘Key
(), 
Ëad”
.
ruÁime
);

41 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

42 
log
.
	`”rÜ
("Failedo connecto‡„emote site. Retry‡fter 1 second.");

43 
throw
 
Ãw
 
	`R‘ryN“dedExû±iÚ
();

46  
nuÎ
;

47 }).
	`run
();

48 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

49 
log
.
	`”rÜ
("UÄecov”abËƒxû±iÚ wh’‡‰em±šgØcÚÃùØ»mÙs™e.", 
e
);

50 
throw
 
e
;

52 
	}
}

57 
public
 
	$¡¬tLogR•liÿtiÚ
(
CrossS™eCÚfigu¿tiÚ
 
cÚfig
) {

58 
log
.
	`šfo
("S¹ Log R•liÿtiÚØSndby S™e {}", 
logR•liÿtiÚRuÁimes
.
	`keyS‘
());

59 
M­
.
EÁry
<
SŒšg
, 
LogR•liÿtiÚRuÁime
> 
’Œy
: 
logR•liÿtiÚRuÁimes
.
	`’ŒyS‘
()) {

60 
SŒšg
 
’dpošt
 = 
’Œy
.
	`g‘Key
();

61 
LogR•liÿtiÚRuÁime
 
ruÁime
 = 
’Œy
.
	`g‘V®ue
();

64 
ruÁime
.
	`g‘SourûMªag”
().
	`g‘LogR•liÿtiÚFSM
().
	`¡¬tCÚsum”
(
cÚfig
);

66 
LogR•liÿtiÚNegÙŸtiÚResuÉ
 
ÃgÙŸtiÚResuÉ
 = 
	`¡¬tNegÙŸtiÚ
(
ruÁime
);

67 
log
.
	`šfo
("Log R•liÿtiÚ NegÙŸtiÚ w™h {}„esuÉ {}", 
’dpošt
, 
ÃgÙŸtiÚResuÉ
);

68 
	`¡¬tR•liÿtiÚ
(
cÚfig
.
	`g‘Epoch
(), 
ruÁime
, 
ÃgÙŸtiÚResuÉ
);

70 
	}
}

72 
public
 
	$¡İLogR•liÿtiÚ
(
CrossS™eCÚfigu¿tiÚ
 
cÚfig
) {

73 
Sy¡em
.
out
.
	`´št
("Log R•liÿtiÚ stİ " + 
cÚfig
);

75 
M­
.
EÁry
<
SŒšg
, 
LogR•liÿtiÚRuÁime
> 
’Œy
: 
logR•liÿtiÚRuÁimes
.
	`’ŒyS‘
()) {

76 
LogR•liÿtiÚRuÁime
 
ruÁime
 = 
’Œy
.
	`g‘V®ue
();

77 
ruÁime
.
	`¡İ
();

79 
	}
}

81 
´iv©e
 
	$¡¬tR•liÿtiÚ
(
s™eEpoch
, 
LogR•liÿtiÚRuÁime
 
ruÁime
, 
LogR•liÿtiÚNegÙŸtiÚResuÉ
 
ÃgÙŸtiÚResuÉ
) {

82 
ruÁime
.
	`g‘SourûMªag”
().
	`g‘LogR•liÿtiÚFSM
().
	`£tS™eEpoch
(
s™eEpoch
);

84 
ÃgÙŸtiÚResuÉ
) {

85 
SNAPSHOT_SYNC
:

86 
log
.
	`šfo
("Start Snapshot Sync Replication");

88 
ruÁime
.
	`¡¬tSÇpshÙSync
();

90 
LOG_ENTRY_SYNC
:

91 
log
.
	`šfo
("Start Log Entry Sync Replication");

93 
ruÁime
.
	`¡¬tLogEÁrySync
();

95 
LEADERSHIP_LOST
:

96 
CONNECTION_LOST
:

97 
UNKNOWN
:

98 
log
.
	`šfo
("Invalid Negotiation„esult. Re-trigger discovery.");

103 
	}
}

105 
´iv©e
 
LogR•liÿtiÚNegÙŸtiÚResuÉ
 
	$¡¬tNegÙŸtiÚ
(
LogR•liÿtiÚRuÁime
 
logR•liÿtiÚRuÁime
) {

106 
Œy
 {

107 
log
.
	`šfo
("Start Negotiation");

108 
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
 
ÃgÙŸtiÚRe¥Ú£
 = 
logR•liÿtiÚRuÁime
.
	`¡¬tNegÙŸtiÚ
();

109 
log
.
	`šfo
("NegÙŸtiÚ Re¥Ú£„eûived: " + 
ÃgÙŸtiÚRe¥Ú£
);

111  
	`´oûssNegÙŸtiÚRe¥Ú£
(
ÃgÙŸtiÚRe¥Ú£
);

112 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

113 
log
.
	`”rÜ
("Caughˆªƒxû±iÚ duršg†og„•liÿtiÚ‚egÙŸtiÚ", 
e
);

114  
LogR•liÿtiÚNegÙŸtiÚResuÉ
.
ERROR
;

116 
	}
}

118 
´iv©e
 
LogR•liÿtiÚNegÙŸtiÚResuÉ
 
	$´oûssNegÙŸtiÚRe¥Ú£
(
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
 
ÃgÙŸtiÚRe¥Ú£
) {

120  
LogR•liÿtiÚNegÙŸtiÚResuÉ
.
SNAPSHOT_SYNC
;

121 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLev–
;

4 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gşassic
.
	gLogg”
;

5 
impÜt
 
	gch
.
	gqos
.
	glogback
.
	gcÜe
.
	gjÜª
.
	g¥i
.
	gJÜªExû±iÚ
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

11 
impÜt
 
	gÜg
.
	gdocİt
.
	gDocİt
;

12 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

14 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gN‘wÜkUts
.
	gg‘Add»ssFromIÁ”çûName
;

24 @
Slf4j


25 
public
 cÏs 
	cCÜfuR•liÿtiÚS”v”
 
im¶em’ts
 
	mRuÂabË
 {

35 
´iv©e
 
fš®
 
SŒšg
 
	mUSAGE
 =

164 
´iv©e
 vŞ©
CÜfuR•liÿtiÚS”v”Node
 
	maùiveS”v”
;

167 
´iv©e
 vŞ©
boŞ—n
 
	mshutdownS”v”
 = 
çl£
;

170 
´iv©e
 vŞ©
boŞ—n
 
	mş—nupS”v”
 = 
çl£
;

172 
´iv©e
 
fš®
 
	mEXIT_ERROR_CODE
 = 100;

174 @
G‘‹r


175 
´iv©e
 
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
	ms™eMªag”Ad­‹r
 = 
nuÎ
;

177 @
G‘‹r


178 
CÜfuR•liÿtiÚDiscov”yS”viû
 
	m»¶iÿtiÚDiscov”yS”viû
;

180 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
 = 
nuÎ
;

181 
	mSŒšg
[] 
	m¬gs
;

184 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

185 
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
s™eMªag”Ad­‹r
 = 
Ãw
 
	`DeçuÉS™eMªag”
(
çl£
);

186 
CÜfuR•liÿtiÚS”v”
 
cÜfuR•liÿtiÚS”v”
 = 
Ãw
 
	`CÜfuR•liÿtiÚS”v”
(
¬gs
, 
s™eMªag”Ad­‹r
);

187 
cÜfuR•liÿtiÚS”v”
.
	`run
();

190 
public
 
	$CÜfuR•liÿtiÚS”v”
(
SŒšg
[] 
šputs
) {

191 
this
.
¬gs
 = 
šputs
;

192 
this
.
s™eMªag”Ad­‹r
 = 
Ãw
 
	`DeçuÉS™eMªag”
(
Œue
);

193 
	}
}

195 
	$CÜfuR•liÿtiÚS”v”
(
SŒšg
[] 
šputs
, 
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
ad­‹r
) {

196 
this
.
¬gs
 = 
šputs
;

197 
this
.
s™eMªag”Ad­‹r
 = 
ad­‹r
;

198 
	}
}

200 @
Ov”ride


201 
public
 
	$run
() {

202 
Œy
 {

203 
this
.
	`¡¬tS”v”
();

204 } 
	`ÿtch
 (
ThrowabË
 
”r
) {

205 
log
.
	`”rÜ
("Ex™. UÄecov”abËƒ¼Ü", 
”r
);

206 
throw
 
”r
;

208 
	}
}

210 
´iv©e
 
	$¡¬tS”v”
() {

212 
M­
<
SŒšg
, 
Objeù
> 
İts
 = 
Ãw
 
	`Docİt
(
USAGE
)

213 .
	`w™hV”siÚ
(
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
desüibe
)

214 .
	`·r£
(
¬gs
);

216 
	`´štS¹upMsg
(
İts
);

217 
	`cÚfigu»Logg”
(
İts
);

219 
log
.
	`debug
("S¹ed w™h‡rgum’ts: {}", 
İts
);

223 ià(
İts
.
	`g‘
("--ÃtwÜk-š‹rçû"è!ğ
nuÎ
) {

224 
İts
.
	`put
("--add»ss", 
	`g‘Add»ssFromIÁ”çûName
((
SŒšg
èİts.
	`g‘
("--network-interface")));

225 
İts
.
	`put
("--bšd-to-®l-š‹rçûs", 
çl£
);

226 } ià(
İts
.
	`g‘
("--add»ss"è=ğ
nuÎ
) {

229 
İts
.
	`put
("--bšd-to-®l-š‹rçûs", 
Œue
);

230 
İts
.
	`put
("--address", "localhost");

233 
İts
.
	`put
("--bšd-to-®l-š‹rçûs", 
çl£
);

237 
Th»ad
 
shutdownTh»ad
 = 
Ãw
 
	`Th»ad
Òew 
	`CËªupRuÂabË
(
this
));

238 
shutdownTh»ad
.
	`£tName
("ShutdownThread");

239 
RuÁime
.
	`g‘RuÁime
().
	`addShutdownHook
(
shutdownTh»ad
);

242 !
shutdownS”v”
) {

243 
fš®
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xt
(
İts
);

244 
Œy
 {

248 
SŒšg
 
’dpošt
 = 
NodeLoÿtÜ
.
	`·r£SŒšg
(
£rv”CÚ‹xt
.
	`g‘LoÿlEndpošt
()).
	`toEndpoštU¾
();

249 
aùiveS”v”
 = 
Ãw
 
	`CÜfuR•liÿtiÚS”v”Node
(
£rv”CÚ‹xt
);

251 
»¶iÿtiÚDiscov”yS”viû
 = 
Ãw
 
	`CÜfuR•liÿtiÚDiscov”yS”viû
(
’dpošt
, 
aùiveS”v”
, 
s™eMªag”Ad­‹r
);

252 
Th»ad
 
»¶iÿtiÚDiscov”yTh»ad
 = 
Ãw
 
	`Th»ad
(
»¶iÿtiÚDiscov”yS”viû
);

253 
»¶iÿtiÚDiscov”yTh»ad
.
	`¡¬t
();

257 
aùiveS”v”
.
	`¡¬tAndLi¡’
();

258 } 
	`ÿtch
 (
ThrowabË
 
th
) {

259 
log
.
	`”rÜ
("CÜfuS”v”: S”v”ƒx™šg dutØuÄecov”abËƒ¼Ü: ", 
th
);

260 
Sy¡em
.
	`ex™
(
EXIT_ERROR_CODE
);

263 ià(
ş—nupS”v”
) {

264 
ş—nupS”v”
 = 
çl£
;

267 ià(!
shutdownS”v”
) {

268 
log
.
	`šfo
("main: Server„estarting.");

272 
log
.
	`šfo
("main: Serverƒxiting dueo shutdown");

273 
	}
}

283 
´iv©e
 
cÚfigu»Logg”
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

284 
fš®
 
Logg”
 
	groÙ
 = (Logg”è
Logg”FaùÜy
.
g‘Logg”
(Logg”.
ROOT_LOGGER_NAME
);

285 
fš®
 
Lev–
 
	gËv–
 = Lev–.
toLev–
(((
SŒšg
è
İts
.
g‘
("--log-Ëv–")).
toUµ”Ca£
());

286 
	groÙ
.
£tLev–
(
Ëv–
);

294 
	$»¡¬tS”v”
(
boŞ—n
 
»£tD©a
) {

296 ià(
»£tD©a
) {

297 
ş—nupS”v”
 = 
Œue
;

300 
log
.
	`šfo
("RestartServer: Shutting down Log Replication server");

301 
aùiveS”v”
.
	`şo£
();

302 
log
.
	`šfo
("RestartServer: Starting Log Replication server");

303 
	}
}

308 
´iv©e
 
	$ş—nShutdown
() {

309 
log
.
	`šfo
("CleanShutdown: Starting Cleanup.");

310 
shutdownS”v”
 = 
Œue
;

311 
aùiveS”v”
.
	`şo£
();

312 
	}
}

317 
´iv©e
 
	$´štLogo
() {

318 
	`´šn
(" _ ____ _ _ _ _ \n" +

324 
	}
}

331 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

332 
´iv©e
 
	$´šn
(
Objeù
 
lše
) {

333 
Sy¡em
.
out
.
	`´šn
(
lše
.
	`toSŒšg
());

334 
log
.
	`šfo
(
lše
.
	`toSŒšg
());

335 
	}
}

342 
´iv©e
 
´štS¹upMsg
(
M­
<
SŒšg
, 
Objeù
> 
İts
) {

343 
´štLogo
();

344 
´šn
("");

345 
´šn
("------------------------------------");

346 
´šn
("Initializing LOG REPLICATION SERVER");

347 
´šn
("V”siÚ (" + 
G™R•os™ÜyS‹
.
g‘R•os™ÜyS‹
().
comm™IdAbb»v
 + ")");

348 
fš®
 
	gpÜt
 = 
IÁeg”
.
·r£IÁ
((
SŒšg
è
İts
.
g‘
("<port>"));

349 
´šn
("S”všg oÀpÜˆ" + 
pÜt
);

350 
´šn
("------------------------------------");

351 
´šn
("");

355 şas 
	cCËªupRuÂabË
 
im¶em’ts
 
	gRuÂabË
 {

356 
CÜfuR•liÿtiÚS”v”
 
	g£rv”
;

357 
CËªupRuÂabË
(
CÜfuR•liÿtiÚS”v”
 
£rv”
) {

358 
	gthis
.
	g£rv”
 = 
£rv”
;

360 @
Ov”ride


361 
public
 
run
() {

362 
	g£rv”
.
ş—nShutdown
();

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationServerNode.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gboÙ¡¿p
.
	gS”v”BoÙ¡¿p
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gPoŞedBy‹BufAÎoÿtÜ
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃl
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlFutu»
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlIn™Ÿliz”
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlO±iÚ
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gL’gthF›ldBa£dF¿meDecod”
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gL’gthF›ldP»³nd”
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦CÚ‹xt
;

14 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦HªdËr
;

15 
impÜt
 
	glombok
.
	gG‘‹r
;

16 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gBa£S”v”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gN‘tyS”v”Rou‹r
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogR•liÿtiÚS”v”
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”HªdshakeHªdËr
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”Th»adFaùÜy
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gN‘tyCÜfuMes§geDecod”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gN‘tyCÜfuMes§geEncod”
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
.
	gPÏšTextSa¦N‘tyS”v”
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
.
	gS¦CÚ‹xtCÚ¡ruùÜ
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gV”siÚ
;

32 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

33 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLEngše
;

34 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

36 
impÜt
 
	gjava
.
	gut
.
	gM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

38 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

39 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

42 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

44 @
Slf4j


45 
public
 cÏs 
	cCÜfuR•liÿtiÚS”v”Node
 
im¶em’ts
 
	mAutoClo£abË
 {

47 @
G‘‹r


48 
´iv©e
 
fš®
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

50 @
G‘‹r


51 
´iv©e
 
fš®
 
	mM­
<
	mCÏss
, 
	mAb¡¿ùS”v”
> 
	m£rv”M­
;

53 @
G‘‹r


54 
´iv©e
 
fš®
 
N‘tyS”v”Rou‹r
 
	mrou‹r
;

57 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mşo£
;

59 
´iv©e
 
ChªÃlFutu»
 
	mbšdFutu»
;

66 
public
 
CÜfuR•liÿtiÚS”v”Node
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

67 
this
(
£rv”CÚ‹xt
,

68 
ImmubËM­
.<
CÏss
, 
Ab¡¿ùS”v”
>
bud”
()

69 .
put
(
Ba£S”v”
.
şass
, 
Ãw
 Ba£S”v”(
£rv”CÚ‹xt
))

70 .
put
(
LogR•liÿtiÚS”v”
.
şass
, 
Ãw
 LogR•liÿtiÚS”v”(
£rv”CÚ‹xt
))

71 .
bud
()

81 
public
 
CÜfuR•liÿtiÚS”v”Node
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
,

82 @
NÚnuÎ
 
M­
<
CÏss
, 
Ab¡¿ùS”v”
> 
£rv”M­
) {

83 
	gthis
.
	g£rv”CÚ‹xt
 = 
£rv”CÚ‹xt
;

84 
	gthis
.
	g£rv”M­
 = 
£rv”M­
;

85 
	grou‹r
 = 
Ãw
 
N‘tyS”v”Rou‹r
Òew 
A¼ayLi¡
<>(
£rv”M­
.
v®ues
()));

86 
	gthis
.
	g£rv”CÚ‹xt
.
£tS”v”Rou‹r
(
rou‹r
);

87 
	gthis
.
	gşo£
 = 
Ãw
 
AtomicBoŞ—n
(
çl£
);

93 
public
 
ChªÃlFutu»
 
	$¡¬t
() {

94 
bšdFutu»
 = 
	`bšdS”v”
(
£rv”CÚ‹xt
.
	`g‘BossGroup
(),

95 
£rv”CÚ‹xt
.
	`g‘WÜk”Group
(),

96 
this
::
cÚfigu»BoÙ¡¿pO±iÚs
,

97 
£rv”CÚ‹xt
,

98 
rou‹r
,

99 (
SŒšg
è
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
().
	`g‘
("--address"),

100 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
().
	`g‘
("<port>")));

102  
bšdFutu»
.
	`syncUnš‹¼u±ibly
();

103 
	}
}

108 
public
 
	$¡¬tAndLi¡’
() {

110 
this
.
	`¡¬t
().
	`chªÃl
().
	`şo£Futu»
().
	`syncUnš‹¼u±ibly
();

111 
	}
}

116 @
Ov”ride


117 
public
 
	$şo£
() {

119 ià(!
şo£
.
	`com·»AndS‘
(
çl£
, 
Œue
)) {

120 
log
.
	`Œaû
("close: Server‡lready shutdown");

124 
log
.
	`šfo
("close: Shutting down Corfu server‡nd cleaning„esources");

125 
£rv”CÚ‹xt
.
	`şo£
();

126 
bšdFutu»
.
	`chªÃl
().
	`şo£
().
	`syncUnš‹¼u±ibly
();

130 
fš®
 
ExecutÜS”viû
 
shutdownS”viû
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
£rv”M­
.
	`size
(),

131 
Ãw
 
	`S”v”Th»adFaùÜy
("CorfuServer-shutdown-",

132 
Ãw
 
S”v”Th»adFaùÜy
.
	`Exû±iÚHªdËr
()));

136 
Com¶‘abËFutu»
[] 
shutdownFutu»s
 = 
£rv”M­
.
	`v®ues
().
	`¡»am
()

137 .
	`m­
(
£rv”
 -> 
Com¶‘abËFutu»
.
	`runAsync
(() -> {

138 
Œy
 {

139 
log
.
	`šfo
("şo£: Shu‰šg dowÀ{}", 
£rv”
.
	`g‘CÏss
().
	`g‘Sim¶eName
());

140 
£rv”
.
	`shutdown
();

141 
log
.
	`šfo
("şo£: CËªly shutdowÀ{}", 
£rv”
.
	`g‘CÏss
().
	`g‘Sim¶eName
());

142 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

143 
log
.
	`”rÜ
("close: Failedo cleanly shutdown {}",

144 
£rv”
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), 
e
);

146 }, 
shutdownS”viû
))

147 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

149 
Com¶‘abËFutu»
.
	`®lOf
(
shutdownFutu»s
).
	`još
();

150 
shutdownS”viû
.
	`shutdown
();

151 
log
.
	`šfo
("close: Server shutdown‡nd„esources„eleased");

152 
	}
}

157 @
FunùiÚ®IÁ”çû


158 
public
 
š‹rçû
 
	gBoÙ¡¿pCÚfigu»r
 {

165 
cÚfigu»
(
S”v”BoÙ¡¿p
 
£rv”BoÙ¡¿p
);

187 
public
 
ChªÃlFutu»
 
bšdS”v”
(@
NÚnuÎ
 
Ev’tLoİGroup
 
bossGroup
,

188 @
NÚnuÎ
 
Ev’tLoİGroup
 
wÜk”Group
,

189 @
NÚnuÎ
 
BoÙ¡¿pCÚfigu»r
 
boÙ¡¿pCÚfigu»r
,

190 @
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
,

191 @
NÚnuÎ
 
N‘tyS”v”Rou‹r
 
rou‹r
,

192 
SŒšg
 
add»ss
,

193 
pÜt
) {

194 
	gŒy
 {

195 
S”v”BoÙ¡¿p
 
	gboÙ¡¿p
 = 
Ãw
 ServerBootstrap();

196 
	gboÙ¡¿p
.
group
(
bossGroup
, 
wÜk”Group
)

197 .
chªÃl
(
cÚ‹xt
.
g‘ChªÃlIm¶em’tiÚ
().
g‘S”v”ChªÃlCÏss
());

198 
	gboÙ¡¿pCÚfigu»r
.
cÚfigu»
(
boÙ¡¿p
);

200 
	gboÙ¡¿p
.
chdHªdËr
(
g‘S”v”ChªÃlIn™Ÿliz”
(
cÚ‹xt
, 
rou‹r
));

201 
boŞ—n
 
	gbšdToAÎIÁ”çûs
 =

202 
O±iÚ®
.
ofNuÎabË
(
cÚ‹xt
.
g‘S”v”CÚfig
(
BoŞ—n
.
şass
, "--bind-to-all-interfaces"))

203 .
ÜEl£
(
çl£
);

204 ià(
	gbšdToAÎIÁ”çûs
) {

205 
	glog
.
šfo
("Log R•liÿtiÚ S”v”†i¡’šg oÀ®Èš‹rçû Ú…Üt:{}", 
pÜt
);

206  
	gboÙ¡¿p
.
bšd
(
pÜt
).
sync
();

208 
	glog
.
šfo
("Log R•liÿtiÚ S”v”†i¡’šg oÀ{}:{}", 
add»ss
, 
pÜt
);

209  
	gboÙ¡¿p
.
bšd
(
add»ss
, 
pÜt
).
sync
();

211 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

212 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

221 
public
 
cÚfigu»BoÙ¡¿pO±iÚs
(@
NÚnuÎ
 
S”v”BoÙ¡¿p
 
boÙ¡¿p
) {

222 
	gboÙ¡¿p
.
İtiÚ
(
ChªÃlO±iÚ
.
SO_BACKLOG
, 100)

223 .
chdO±iÚ
(
ChªÃlO±iÚ
.
SO_KEEPALIVE
, 
Œue
)

224 .
chdO±iÚ
(
ChªÃlO±iÚ
.
SO_REUSEADDR
, 
Œue
)

225 .
chdO±iÚ
(
ChªÃlO±iÚ
.
TCP_NODELAY
, 
Œue
)

226 .
chdO±iÚ
(
ChªÃlO±iÚ
.
ALLOCATOR
, 
PoŞedBy‹BufAÎoÿtÜ
.
DEFAULT
);

237 
´iv©e
 
ChªÃlIn™Ÿliz”
 
g‘S”v”ChªÃlIn™Ÿliz”
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
,

238 @
NÚnuÎ
 
N‘tyS”v”Rou‹r
 
rou‹r
) {

240 
	glog
.
šfo
("****** get Server Channel Initializer");

243  
Ãw
 
ChªÃlIn™Ÿliz”
() {

244 @
Ov”ride


245 
´Ùeùed
 
š™ChªÃl
(@
NÚnuÎ
 
ChªÃl
 
ch
è
throws
 
	gExû±iÚ
 {

246 
	glog
.
šfo
("**** Init Corfu Replication Server Node Channel");

248 
fš®
 
S¦CÚ‹xt
 
	gs¦CÚ‹xt
;

249 
fš®
 
	gSŒšg
[] 
	g’abËdTlsPrÙocŞs
;

250 
fš®
 
	gSŒšg
[] 
	g’abËdTlsCh”Su™es
;

253 
BoŞ—n
 
	gsEÇbËd
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(BoŞ—n.
şass
, "--enable-tls");

254 
BoŞ—n
 
	gsMutu®AuthEÇbËd
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(BoŞ—n.
şass
,

256 ià(
	gsEÇbËd
) {

258 
SŒšg
 
	gchs
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(SŒšg.
şass
, "--tls-ciphers");

259 ià(
	gchs
 !ğ
nuÎ
) {

260 
’abËdTlsCh”Su™es
 = 
P©‹º
.
compe
(",")

261 .
¥l™AsSŒ—m
(
chs
)

262 .
m­
(
SŒšg
::
Œim
)

263 .
toA¼ay
(
SŒšg
[]::
Ãw
);

265 
	g’abËdTlsCh”Su™es
 = 
Ãw
 
SŒšg
[]{};

269 
SŒšg
 
	g´Ùos
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(SŒšg.
şass
, "--tls-protocols");

270 ià(
	g´Ùos
 !ğ
nuÎ
) {

271 
’abËdTlsPrÙocŞs
 = 
P©‹º
.
compe
(",")

272 .
¥l™AsSŒ—m
(
´Ùos
)

273 .
m­
(
SŒšg
::
Œim
)

274 .
toA¼ay
(
SŒšg
[]::
Ãw
);

276 
	g’abËdTlsPrÙocŞs
 = 
Ãw
 
SŒšg
[]{};

279 
	gŒy
 {

280 
	gs¦CÚ‹xt
 = 
S¦CÚ‹xtCÚ¡ruùÜ
.
cÚ¡ruùS¦CÚ‹xt
(
Œue
,

281 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--keystore"),

282 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--keystore-password-file"),

283 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--truststore"),

284 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
,

286 } 
ÿtch
 (
SSLExû±iÚ
 
e
) {

287 
	glog
.
”rÜ
("Could‚Ù budhSSL cÚ‹xt", 
e
);

288 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Couldn'ˆbudhSSL cÚ‹xt", 
e
);

291 
	g’abËdTlsCh”Su™es
 = 
Ãw
 
SŒšg
[]{};

292 
	g’abËdTlsPrÙocŞs
 = 
Ãw
 
SŒšg
[]{};

293 
	gs¦CÚ‹xt
 = 
nuÎ
;

296 
BoŞ—n
 
	g§¦PÏšTextAuth
 = 
cÚ‹xt
.
g‘S”v”CÚfig
(BoŞ—n.
şass
,

300 ià(
	gsEÇbËd
) {

301 
SSLEngše
 
	g’gše
 = 
s¦CÚ‹xt
.
ÃwEngše
(
ch
.
®loc
());

302 
	g’gše
.
£tEÇbËdCh”Su™es
(
’abËdTlsCh”Su™es
);

303 
	g’gše
.
£tEÇbËdPrÙocŞs
(
’abËdTlsPrÙocŞs
);

304 ià(
	gsMutu®AuthEÇbËd
) {

305 
	g’gše
.
£tN“dCl›ÁAuth
(
Œue
);

307 
	gch
.
p–še
().
addLa¡
("s¦", 
Ãw
 
S¦HªdËr
(
’gše
));

310 
	gch
.
p–še
().
addLa¡
(
Ãw
 
L’gthF›ldP»³nd”
(4));

311 
	gch
.
p–še
().
addLa¡
(
Ãw
 
L’gthF›ldBa£dF¿meDecod”
(
IÁeg”


312 .
MAX_VALUE
, 0, 4,

315 ià(
	g§¦PÏšTextAuth
) {

316 
	gch
.
p–še
().
addLa¡
("§¦/¶aš-‹xt", 
Ãw


317 
PÏšTextSa¦N‘tyS”v”
());

320 
	gch
.
p–še
().
addLa¡
(
Ãw
 
N‘tyCÜfuMes§geDecod”
());

321 
	gch
.
p–še
().
addLa¡
(
Ãw
 
N‘tyCÜfuMes§geEncod”
());

322 
	gch
.
p–še
().
addLa¡
(
Ãw
 
S”v”HªdshakeHªdËr
(
cÚ‹xt
.
g‘NodeId
(),

323 
V”siÚ
.
g‘V”siÚSŒšg
() + "("

324 + 
G™R•os™ÜyS‹
.
g‘R•os™ÜyS‹
().
comm™IdAbb»v
 + ")",

325 
cÚ‹xt
.
g‘S”v”CÚfig
(
SŒšg
.
şass
, "--HandshakeTimeout")));

327 
	gch
.
p–še
().
addLa¡
(
rou‹r
);

329 
	glog
.
šfo
("***** Finished");

334 
LogR•liÿtiÚS”v”
 
	$g‘LogR•liÿtiÚS”v”
() {

335  (
LogR•liÿtiÚS”v”
)
£rv”M­
.
	`g‘
(LogR•liÿtiÚS”v”.
şass
);

336 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationSiteManagerAdapter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
;

7 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
.
	gCÜfuR•liÿtiÚDiscov”yS”viû
.
	gDiscov”yS”viûEv’tTy³
.
	gDiscov”yS™e
;

11 
public
 
ab¡¿ù
 cÏs 
	cCÜfuR•liÿtiÚS™eMªag”Ad­‹r
 {

12 @
	mG‘‹r


13 @
S‘‹r


14 
CÜfuR•liÿtiÚDiscov”yS”viû
 
	mcÜfuR•liÿtiÚDiscov”yS”viû
;

16 @
G‘‹r


17 
S™eCÚfigu¿tiÚMsg
 
	ms™eCÚfigMsg
;

19 @
G‘‹r


20 
CrossS™eCÚfigu¿tiÚ
 
	ms™eCÚfig
;

22 
public
 
synchrÚized
 
CrossS™eCÚfigu¿tiÚ
 
	$ãtchS™eCÚfig
(è
throws
 
IOExû±iÚ
 {

23 
s™eCÚfigMsg
 = 
	`qu”yS™eCÚfig
();

24 
s™eCÚfig
 = 
Ãw
 
	`CrossS™eCÚfigu¿tiÚ
(
s™eCÚfigMsg
);

25  
s™eCÚfig
;

33 
synchrÚized
 
	$upd©eS™eCÚfig
(
S™eCÚfigu¿tiÚMsg
 
ÃwS™eCÚfigMsg
) {

35 ià(
ÃwS™eCÚfigMsg
.
	`g‘Epoch
(è> 
s™eCÚfigMsg
.getEpoch()) {

36 
s™eCÚfigMsg
 = 
ÃwS™eCÚfigMsg
;

37 
s™eCÚfig
 = 
Ãw
 
	`CrossS™eCÚfigu¿tiÚ
(
s™eCÚfigMsg
);

38 
cÜfuR•liÿtiÚDiscov”yS”viû
.
	`putEv’t
(

39 
Ãw
 
CÜfuR•liÿtiÚDiscov”yS”viû
.
	`Discov”yS”viûEv’t
(
Discov”yS™e
, 
ÃwS™eCÚfigMsg
));

41 
	}
}

43 
public
 
ab¡¿ù
 
S™eCÚfigu¿tiÚMsg
 
qu”yS™eCÚfig
();

45 
public
 
ab¡¿ù
 
¡¬t
();

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CrossSiteConfiguration.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gGlob®Mªag”Stus
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
.
	gLogR•liÿtiÚRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
.
	gLogR•liÿtiÚRuÁimeP¬am‘”s
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 @
Slf4j


21 
public
 cÏs 
	cCrossS™eCÚfigu¿tiÚ
 {

22 
fš®
 
SŒšg
 
	mDEFAULT_CORFU_PORT_NUM
 = "9000";

24 @
	mS‘‹r


25 @
G‘‹r


26 
SŒšg
 
	mCÜfuPÜŠum
 = 
DEFAULT_CORFU_PORT_NUM
;

28 @
G‘‹r


29 
´iv©e
 
	m•och
;

31 @
G‘‹r


32 
´iv©e
 
S™eInfo
 
	m´im¬yS™e
;

34 @
G‘‹r


35 
	mM­
<
	mSŒšg
, 
	mS™eInfo
> 
	m¡ªdbyS™es
;

37 
public
 
	$CrossS™eCÚfigu¿tiÚ
(
S™eCÚfigu¿tiÚMsg
 
s™eCÚfigMsg
) {

38 
this
.
•och
 = 
s™eCÚfigMsg
.
	`g‘Epoch
();

39 
¡ªdbyS™es
 = 
Ãw
 
HashM­
<>();

40 
S™eMsg
 
s™eMsg
 : 
s™eCÚfigMsg
.
	`g‘S™eLi¡
()) {

41 
S™eInfo
 
s™eInfo
 = 
Ãw
 
	`S™eInfo
(
s™eMsg
);

42 ià(
s™eMsg
.
	`g‘GmStus
(è=ğ
Glob®Mªag”Stus
.
ACTIVE
) {

43 
´im¬yS™e
 = 
s™eInfo
;

44 } ià(
s™eMsg
.
	`g‘GmStus
(è=ğ
Glob®Mªag”Stus
.
STANDBY
) {

45 
¡ªdbyS™es
.
	`put
(
s™eMsg
.
	`g‘Id
(), 
s™eInfo
);

50 
public
 
	`CrossS™eCÚfigu¿tiÚ
(
•och
, 
S™eInfo
 
´im¬yS™e
, 
M­
<
SŒšg
, S™eInfo> 
¡ªdbyS™es
) {

51 
this
.
•och
 =ƒpoch;

52 
this
.
´im¬yS™e
 =…rimarySite;

53 
this
.
¡ªdbyS™es
 = standbySites;

54 
	}
}

56 
public
 
S™eCÚfigu¿tiÚMsg
 
	$cÚv”t2msg
() {

57 
A¼ayLi¡
<
S™eMsg
> 
s™eMsgs
 = 
Ãw
 ArrayList<>();

58 
s™eMsgs
.
	`add
((
´im¬yS™e
.
	`cÚv”t2msg
()));

60 
S™eInfo
 
s™eInfo
 : 
¡ªdbyS™es
.
	`v®ues
()) {

61 
s™eMsgs
.
	`add
(
s™eInfo
.
	`cÚv”t2msg
());

64 
S™eCÚfigu¿tiÚMsg
 
cÚfigMsg
 = S™eCÚfigu¿tiÚMsg.
	`ÃwBud”
().
	`£tEpoch
(
•och
).
	`addAÎS™e
(
s™eMsgs
).
	`bud
();

66  
cÚfigMsg
;

67 
	}
}

69 
public
 
NodeInfo
 
	$g‘NodeInfo
(
SŒšg
 
’dpošt
) {

70 
Li¡
<
S™eInfo
> 
s™es
 = 
Ãw
 
A¼ayLi¡
<>(
¡ªdbyS™es
.
	`v®ues
());

72 
s™es
.
	`add
(
´im¬yS™e
);

73 
NodeInfo
 
nodeInfo
 = 
	`g‘NodeInfo
(
s™es
, 
’dpošt
);

75 ià(
nodeInfo
 =ğ
nuÎ
) {

76 
log
.
	`w¬n
("NØS™ha nodw™h IP {} ", 
’dpošt
);

79  
nodeInfo
;

80 
	}
}

82 
´iv©e
 
NodeInfo
 
g‘NodeInfo
(
Li¡
<
S™eInfo
> 
s™esInfo
, 
SŒšg
 
’dpošt
) {

83 
S™eInfo
 
	gs™e
 : 
s™esInfo
) {

84 
NodeInfo
 
nodeInfo
 : 
s™e
.
g‘NodesInfo
()) {

85 ià(
nodeInfo
.
g‘Endpošt
().
equ®s
(
’dpošt
)) {

86  
nodeInfo
;

91 
	glog
.
w¬n
("Th”i nØnodeInfØfÜ ipAdd»s {} ", 
’dpošt
);

92  
	gnuÎ
;

95 
public
 şas 
	cS™eInfo
 {

96 @
G‘‹r


97 
SŒšg
 
	gs™eId
;

99 @
G‘‹r


100 
Glob®Mªag”Stus
 
	grŞeTy³
;

102 @
	gG‘‹r


103 @
S‘‹r


104 
NodeInfo
 
	gËad”
;

106 @
G‘‹r


107 
	gLi¡
<
	gNodeInfo
> 
	gnodesInfo
;

109 
public
 
S™eInfo
(
S™eMsg
 
s™eMsg
) {

110 
	gthis
.
	gs™eId
 = 
s™eMsg
.
g‘Id
();

111 
	gthis
.
	grŞeTy³
 = 
s™eMsg
.
g‘GmStus
();

112 
	gthis
.
	gËad”
 = 
nuÎ
;

113 
	gthis
.
	gnodesInfo
 = 
Ãw
 
A¼ayLi¡
<>();

114 
AphInfoMsg
 
	g­hInfoMsg
 : 
s™eMsg
.
g‘AphLi¡
()) {

115 
NodeInfo
 
ÃwNode
 = 
Ãw
 NodeInfo(
­hInfoMsg
.
g‘Add»ss
(), 
IÁeg”
.
toSŒšg
×phInfoMsg.
g‘PÜt
()), 
s™eMsg
.
g‘GmStus
(), IÁeg”.toSŒšg×phInfoMsg.
g‘CÜfuPÜt
()));

116 
	gthis
.
	gnodesInfo
.
add
(
ÃwNode
);

120 
public
 
S™eInfo
(S™eInfØ
šfo
, 
Glob®Mªag”Stus
 
rŞeTy³
) {

121 
	gthis
.
	gs™eId
 = 
šfo
.
s™eId
;

122 
	gthis
.
	grŞeTy³
 = 
rŞeTy³
;

123 
	gthis
.
	gËad”
 = 
šfo
.
Ëad”
;

124 
	gthis
.
	gnodesInfo
 = 
Ãw
 
A¼ayLi¡
<>();

125  
NodeInfo
 
	gnodeInfo
 : 
šfo
.
nodesInfo
) {

126 
NodeInfo
 
ÃwNode
 = 
Ãw
 NodeInfo(
nodeInfo
.
g‘IpAdd»ss
(),‚odeInfo.
g‘PÜtNum
(), 
rŞeTy³
,‚odeInfo.
cÜfuPÜtNum
);

127 
	gthis
.
	gnodesInfo
.
add
(
ÃwNode
);

131 
public
 
S™eInfo
(
SŒšg
 
s™eId
, 
Glob®Mªag”Stus
 
rŞeTy³
) {

132 
	gthis
.
	gs™eId
 = 
s™eId
;

133 
	gthis
.
	grŞeTy³
 = 
rŞeTy³
;

134 
	gnodesInfo
 = 
Ãw
 
A¼ayLi¡
<>();

137 
S™eMsg
 
cÚv”t2msg
() {

138 
	gA¼ayLi¡
<
	gAphInfoMsg
> 
	g­hInfoMsgs
 = 
Ãw
 
A¼ayLi¡
<>();

139 
NodeInfo
 
	gnodeInfo
 : 
nodesInfo
) {

140 
­hInfoMsgs
.
add
(
nodeInfo
.
cÚv”t2msg
());

143 
S™eMsg
 
	gs™eMsg
 = S™eMsg.
ÃwBud”
().
£tId
(
s™eId
).
£tGmStus
(
rŞeTy³
).
addAÎAph
(
­hInfoMsgs
).
bud
();

144  
	gs™eMsg
;

147 
public
 
£tupLogR•liÿtiÚRemÙeRuÁime
(
NodeInfo
 
loÿlNode
, 
s™eEpoch
) {

148 
NodeInfo
 
	gnodeInfo
 : 
nodesInfo
) {

149 
LogR•liÿtiÚRuÁimeP¬am‘”s
 
·¿m‘”s
 = LogR•liÿtiÚRuÁimeP¬am‘”s.
bud”
()

150 .
loÿlCÜfuEndpošt
(
loÿlNode
.
g‘CÜfuEndpošt
())

151 .
»mÙeLogR•liÿtiÚS”v”Endpošt
(
nodeInfo
.
g‘Endpošt
()).
bud
();

152 
LogR•liÿtiÚRuÁime
 
	g»¶iÿtiÚRuÁime
 = 
Ãw
 LogR•liÿtiÚRuÁime(
·¿m‘”s
);

153 
	g»¶iÿtiÚRuÁime
.
cÚÃù
();

154 
	gnodeInfo
.
	gruÁime
 = 
»¶iÿtiÚRuÁime
;

163 
public
 
NodeInfo
 
g‘RemÙeL—d”
(è
throws
 
	gExû±iÚ
 {

164 
NodeInfo
 
	gËad”Node
 = 
nuÎ
;

165 
	gŒy
 {

166 
	g•och
 = -1;

167 
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
 
	g»¥
;

168 
NodeInfo
 
	gnodeInfo
 : 
nodesInfo
) {

169 
»¥
 = 
nodeInfo
.
ruÁime
.
qu”yL—d”sh
();

170 ià(
	g»¥
.
g‘Epoch
(è> 
	g•och
 &&„e¥.
isL—d”
()) {

171 
	gËad”Node
 = 
nodeInfo
;

172 
	g•och
 = 
»¥
.
g‘Epoch
();

175 } 
ÿtch
 (
Exû±iÚ
 
e
) {

176 
	glog
.
”rÜ
("FunùiÚ g‘RemÙeL—d” caughˆªƒxû±iÚ", 
e
);

177 
throw
 
	ge
;

180 ià(
	gËad”Node
 !ğ
nuÎ
) {

181 
Ëad”Node
.
£tL—d”
(
Œue
);

183 
	gthis
.
	gËad”
 = 
Ëad”Node
;

184  
	gËad”Node
;

187 @
Ov”ride


188 
public
 
SŒšg
 
toSŒšg
() {

189  
	gSŒšg
.
fÜm©
("Clu¡”[%s] --- Nodes[%s]: %s", 
g‘S™eId
(), 
nodesInfo
.
size
(),‚odesInfo);

193 @
D©a


194 
public
 şas 
	cNodeInfo
 {

197 
Glob®Mªag”Stus
 
	grŞeTy³
;

199 @
G‘‹r


200 
SŒšg
 
	gAdd»ss
;

202 
SŒšg
 
	gcÜfuPÜtNum
;

204 
SŒšg
 
	gpÜtNum
;

206 
boŞ—n
 
	gËad”
;

208 
LogR•liÿtiÚRuÁime
 
	gruÁime
;

210 
NodeInfo
(
SŒšg
 
Add»ss
, SŒšg 
pÜtNum
, 
Glob®Mªag”Stus
 
rŞeTy³
, SŒšg 
cÜfuPÜtNum
) {

211 
	gthis
.
	gËad”
 = 
çl£
;

212 
	gthis
.
	gAdd»ss
 = 
Add»ss
;

213 
	gthis
.
	grŞeTy³
 = 
rŞeTy³
;

214 
	gthis
.
	gpÜtNum
 = 
pÜtNum
;

215 
	gthis
.
	gcÜfuPÜtNum
 = 
cÜfuPÜtNum
;

218 
public
 
AphInfoMsg
 
cÚv”t2msg
() {

219 
AphInfoMsg
 
	g­hInfoMsg
 = AphInfoMsg.
ÃwBud”
().
£tAdd»ss
(
Add»ss
).
£tPÜt
(
IÁeg”
.
·r£IÁ
(
pÜtNum
)).
£tCÜfuPÜt
(IÁeg”.·r£IÁ(
cÜfuPÜtNum
)).
bud
();

220  
	g­hInfoMsg
;

223 
public
 
SŒšg
 
g‘Endpošt
() {

224  
	gAdd»ss
 + ":" + 
	gpÜtNum
;

227 
public
 
SŒšg
 
g‘CÜfuEndpošt
() {

228  
	gAdd»ss
 + ":" + 
	gcÜfuPÜtNum
;

231 @
Ov”ride


232 
public
 
SŒšg
 
toSŒšg
() {

233  
	gSŒšg
.
fÜm©
("RŞTy³: %s, %s, %s", 
rŞeTy³
, 
g‘Endpošt
(), 
Ëad”
);

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/DefaultSiteManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gGlob®Mªag”Stus
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
;

7 
impÜt
 
	gjava
.
	gio
.
	gFe
;

8 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

9 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	g¦“p
;

17 @
Slf4j


18 
public
 cÏs 
	cDeçuÉS™eMªag”
 
ex‹nds
 
	mCÜfuR•liÿtiÚS™eMªag”Ad­‹r
 {

19 
public
 
	m•och
 = 0;

20 
public
 
fš®
 
	mchªgeInv”®
 = 5000;

21 
public
 
fš®
 
SŒšg
 
	mcÚfig_fe
 = "/config/corfu/corfu_replication_config.properties";

22 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_PRIMARY_SITE_NAME
 = "primary_site";

23 
´iv©e
 
fš®
 
SŒšg
 
	mDEFAULT_STANDBY_SITE_NAME
 = "standby_site";

24 
´iv©e
 
fš®
 
	mNUM_NODES_PER_CLUSTER
 = 3;

26 
´iv©e
 
fš®
 
SŒšg
 
	mPRIMARY_SITE_NAME
 = "primary_site";

27 
´iv©e
 
fš®
 
SŒšg
 
	mSTANDBY_SITE_NAME
 = "standby_site";

28 
´iv©e
 
fš®
 
SŒšg
 
	mPRIMARY_SITE_CORFU_PORTNUM
 = "primary_site_corfu_portnumber";

29 
´iv©e
 
fš®
 
SŒšg
 
	mSTANDBY_SITE_CORFU_PORTNUM
 = "standby_site_corfu_portnumber";

30 
´iv©e
 
fš®
 
SŒšg
 
	mLOG_REPLICATION_SERVICE_PRIMARY_PORT_NUM
 = "primary_site_portnumber";

31 
´iv©e
 
fš®
 
SŒšg
 
	mLOG_REPLICATION_SERVICE_STANDBY_PORT_NUM
 = "standby_site_portnumber";

34 
´iv©e
 
fš®
 
SŒšg
 
	mPRIMARY_SITE_NODE
 = "primary_site_node";

35 
´iv©e
 
fš®
 
SŒšg
 
	mSTANDBY_SITE_NODE
 = "standby_site_node";

37 
S™eMªag”C®lback
 
	ms™eMªag”C®lback
;

38 
Th»ad
 
	mth»ad
 = 
Ãw
 Th»ad(
s™eMªag”C®lback
);

39 
boŞ—n
 
	ms™eFl
 = 
çl£
;

40 
	$DeçuÉS™eMªag”
(
boŞ—n
 
s™eFl
) {

41 
this
.
s™eFl
 = siteFlip;

44 
public
 
	$¡¬t
() {

45 ià(
s™eFl
) {

46 
s™eMªag”C®lback
 = 
Ãw
 
	`S™eMªag”C®lback
(
this
);

47 
th»ad
 = 
Ãw
 
	`Th»ad
(
s™eMªag”C®lback
);

48 
th»ad
.
	`¡¬t
();

51 
	}
}

53 
public
 
CrossS™eCÚfigu¿tiÚ
 
	$»adCÚfig
(è
throws
 
IOExû±iÚ
 {

54 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
 
´im¬yS™e
;

55 
M­
<
SŒšg
, 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
> 
¡ªdbyS™es
 = 
Ãw
 
HashM­
<>();

56 
Œy
 {

57 
Fe
 
cÚfigFe
 = 
Ãw
 
	`Fe
(
cÚfig_fe
);

58 
FeR—d”
 
»ad”
 = 
Ãw
 
	`FeR—d”
(
cÚfigFe
);

60 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

61 
´İs
.
	`lßd
(
»ad”
);

63 
S‘
<
SŒšg
> 
Çmes
 = 
´İs
.
	`¡ršgPrİ”tyNames
();

66 
´im¬yS™e
 = 
Ãw
 
CrossS™eCÚfigu¿tiÚ
.
	`S™eInfo
(
´İs
.
	`g‘Prİ”ty
(
PRIMARY_SITE_NAME
, 
DEFAULT_PRIMARY_SITE_NAME
), 
Glob®Mªag”Stus
.
ACTIVE
);

67 
SŒšg
 
cÜfuPÜtNum
 = 
´İs
.
	`g‘Prİ”ty
(
PRIMARY_SITE_CORFU_PORTNUM
);

68 
SŒšg
 
pÜtNum
 = 
´İs
.
	`g‘Prİ”ty
(
LOG_REPLICATION_SERVICE_PRIMARY_PORT_NUM
);

71 
i
 = 0; i < 
NUM_NODES_PER_CLUSTER
; i++) {

72 
SŒšg
 
nodeName
 = 
PRIMARY_SITE_NODE
 + 
i
;

73 
log
.
	`šfo
("´im¬y s™add»s fÜ‚od{}", 
nodeName
);

74 ià(!
Çmes
.
	`cÚšs
(
nodeName
)) {

77 
SŒšg
 
Add»ss
 = 
´İs
.
	`g‘Prİ”ty
(
nodeName
);

78 
log
.
	`šfo
("´im¬y s™add»s {} fÜ‚od{}", 
Add»ss
, 
nodeName
);

79 
CrossS™eCÚfigu¿tiÚ
.
NodeInfo
 
nodeInfo
 = 
Ãw
 CrossS™eCÚfigu¿tiÚ.
	`NodeInfo
(
Add»ss
, 
pÜtNum
, 
Glob®Mªag”Stus
.
ACTIVE
, 
cÜfuPÜtNum
);

80 
´im¬yS™e
.
nodesInfo
.
	`add
(
nodeInfo
);

84 
¡ªdbyS™es
 = 
Ãw
 
HashM­
<>();

85 
¡ªdbyS™es
.
	`put
(
STANDBY_SITE_NAME
, 
Ãw
 
CrossS™eCÚfigu¿tiÚ
.
	`S™eInfo
(
´İs
.
	`g‘Prİ”ty
(STANDBY_SITE_NAME, 
DEFAULT_STANDBY_SITE_NAME
), 
Glob®Mªag”Stus
.
STANDBY
));

86 
cÜfuPÜtNum
 = 
´İs
.
	`g‘Prİ”ty
(
STANDBY_SITE_CORFU_PORTNUM
);

87 
pÜtNum
 = 
´İs
.
	`g‘Prİ”ty
(
LOG_REPLICATION_SERVICE_STANDBY_PORT_NUM
);

88 
i
 = 0; i < 
NUM_NODES_PER_CLUSTER
; i++) {

89 
SŒšg
 
nodeName
 = 
STANDBY_SITE_NODE
 + 
i
;

90 
log
.
	`šfo
("¡ªdby s™add»s fÜ‚od{}", 
nodeName
);

91 ià(!
Çmes
.
	`cÚšs
(
nodeName
)) {

94 
SŒšg
 
Add»ss
 = 
´İs
.
	`g‘Prİ”ty
(
STANDBY_SITE_NODE
 + 
i
);

95 
log
.
	`šfo
("¡ªdby s™add»s {} fÜ‚od{}", 
Add»ss
, 
i
);

96 
CrossS™eCÚfigu¿tiÚ
.
NodeInfo
 
nodeInfo
 = 
Ãw
 CrossS™eCÚfigu¿tiÚ.
	`NodeInfo
(
Add»ss
, 
pÜtNum
, 
Glob®Mªag”Stus
.
STANDBY
, 
cÜfuPÜtNum
);

97 
¡ªdbyS™es
.
	`g‘
(
STANDBY_SITE_NAME
).
nodesInfo
.
	`add
(
nodeInfo
);

100 
»ad”
.
	`şo£
();

101 
log
.
	`šfo
("Prim¬y S™InfØ{}; Backu°S™InfØ{}", 
´im¬yS™e
, 
¡ªdbyS™es
);

102  
Ãw
 
	`CrossS™eCÚfigu¿tiÚ
(0, 
´im¬yS™e
, 
¡ªdbyS™es
);

103 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

104 
log
.
	`w¬n
("Caughˆªƒxû±iÚ wh»adšghcÚfig fe: {}", 
e
);

105 
throw
 
e
;

107 
	}
}

110 
public
 
S™eCÚfigu¿tiÚMsg
 
	$cÚ¡ruùS™eCÚfigMsg
() {

111 
CrossS™eCÚfigu¿tiÚ
 
üossS™eCÚfigu¿tiÚ
 = 
nuÎ
;

112 
S™eCÚfigu¿tiÚMsg
 
s™eCÚfigu¿tiÚMsg
 = 
nuÎ
;

114 
Œy
 {

115 
üossS™eCÚfigu¿tiÚ
 = 
	`»adCÚfig
();

116 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

117 
Sy¡em
.
out
.
	`´št
("\Àÿughˆªƒxû±iÚ" + 
e
);

120 
s™eCÚfigu¿tiÚMsg
 = 
üossS™eCÚfigu¿tiÚ
.
	`cÚv”t2msg
();

121  
s™eCÚfigu¿tiÚMsg
;

122 
	}
}

124 @
Ov”ride


125 
public
 
S™eCÚfigu¿tiÚMsg
 
	$qu”yS™eCÚfig
() {

126 ià(
s™eCÚfigMsg
 =ğ
nuÎ
) {

127 
s™eCÚfigMsg
 = 
	`cÚ¡ruùS™eCÚfigMsg
();

130  
s™eCÚfigMsg
;

131 
	}
}

137 
public
 
CrossS™eCÚfigu¿tiÚ
 
	$chªgePrim¬y
(
CrossS™eCÚfigu¿tiÚ
 
s™eCÚfig
) {

138 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
 
ŞdPrim¬y
 = 
Ãw
 CrossS™eCÚfigu¿tiÚ.
	`S™eInfo
(
s™eCÚfig
.
	`g‘Prim¬yS™e
(),

139 
Glob®Mªag”Stus
.
STANDBY
);

140 
M­
<
SŒšg
, 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
> 
¡ªdbys
 = 
Ãw
 
HashM­
<>();

141 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
 
ÃwPrim¬y
 = 
nuÎ
;

142 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
 
¡ªdby
;

144 
¡ªdbys
.
	`put
(
ŞdPrim¬y
.
	`g‘S™eId
(), oldPrimary);

145 
SŒšg
 
’dpošt
 : 
s™eCÚfig
.
	`g‘SndbyS™es
().
	`keyS‘
()) {

146 
CrossS™eCÚfigu¿tiÚ
.
S™eInfo
 
šfo
 = 
s™eCÚfig
.
	`g‘SndbyS™es
().
	`g‘
(
’dpošt
);

147 ià(
ÃwPrim¬y
 =ğ
nuÎ
) {

148 
ÃwPrim¬y
 = 
Ãw
 
CrossS™eCÚfigu¿tiÚ
.
	`S™eInfo
(
šfo
, 
Glob®Mªag”Stus
.
ACTIVE
);

150 
¡ªdby
 = 
Ãw
 
CrossS™eCÚfigu¿tiÚ
.
	`S™eInfo
(
šfo
, 
Glob®Mªag”Stus
.
STANDBY
);

151 
¡ªdbys
.
	`put
(
¡ªdby
.
	`g‘S™eId
(), standby);

155 
CrossS™eCÚfigu¿tiÚ
 
ÃwS™eCÚf
 = 
Ãw
 
	`CrossS™eCÚfigu¿tiÚ
(1, 
ÃwPrim¬y
, 
¡ªdbys
);

156  
ÃwS™eCÚf
;

157 
	}
}

162 şas 
	cS™eMªag”C®lback
 
im¶em’ts
 
	gRuÂabË
 {

163 
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
	gs™eMªag”
;

164 
S™eMªag”C®lback
(
CÜfuR•liÿtiÚS™eMªag”Ad­‹r
 
s™eMªag”Ad­‹r
) {

165 
	gthis
.
	gs™eMªag”
 = 
s™eMªag”Ad­‹r
;

168 @
Ov”ride


169 
public
 
run
() {

170 
boŞ—n
 
	gshouldChªgeOnû
 = 
çl£
;

171 
	gŒue
) {

172 
	gŒy
 {

173 
¦“p
(
chªgeInv”®
);

174 ià(
	gshouldChªgeOnû
) {

175 
CrossS™eCÚfigu¿tiÚ
 
	gÃwCÚfig
 = 
chªgePrim¬y
(
s™eMªag”
.
g‘S™eCÚfig
());

176 
	gs™eMªag”
.
upd©eS™eCÚfig
(
ÃwCÚfig
.
cÚv”t2msg
());

177 
	gSy¡em
.
	gout
.
´št
("\n*** changehe site config");

178 
	gshouldChªgeOnû
 = 
çl£
;

180 } 
ÿtch
 (
Exû±iÚ
 
e
) {

181 
	glog
.
”rÜ
("ÿughˆªƒxû±iÚ " + 
e
);

	@log-replication/src/main/java/org/corfudb/logreplication/infrastructure/LogReplicationServerContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
;

3 
public
 cÏs 
	cLogR•liÿtiÚS”v”CÚ‹xt
 {

	@log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gAb¡¿ùCl›Á
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

17 @
Slf4j


18 
public
 cÏs 
	cLogR•liÿtiÚCl›Á
 
ex‹nds
 
	mAb¡¿ùCl›Á
 {

20 @
	mG‘‹r


21 @
S‘‹r


22 
´iv©e
 
ICl›ÁRou‹r
 
	mrou‹r
;

24 
public
 
	$LogR•liÿtiÚCl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

25 
	`su³r
(
rou‹r
, 
•och
);

26 
	`£tRou‹r
(
rou‹r
);

29 
public
 
	$LogR•liÿtiÚCl›Á
(
ICl›ÁRou‹r
 
rou‹r
) {

30 
	`this
(
rou‹r
, 0);

31 
	}
}

33 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
> 
	$£ndNegÙŸtiÚReque¡
() {

34  
	`g‘Rou‹r
().
	`£ndMes§geAndG‘Com¶‘abË
(

35 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
LOG_REPLICATION_NEGOTIATION_REQUEST
).
	`£tEpoch
(0));

36 
	}
}

38 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
> 
	$£ndQu”yL—d”sh
() {

39  
	`g‘Rou‹r
().
	`£ndMes§geAndG‘Com¶‘abË
(

40 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
LOG_REPLICATION_QUERY_LEADERSHIP
).
	`£tEpoch
(0));

41 
	}
}

43 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	$£ndLogEÁry
(
LogR•liÿtiÚEÁry
 
logR•liÿtiÚEÁry
) {

44 
CÜfuMsg
 
msg
 = 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
LOG_REPLICATION_ENTRY
, 
logR•liÿtiÚEÁry
).
	`£tEpoch
(0);

45  
	`g‘Rou‹r
().
	`£ndMes§geAndG‘Com¶‘abË
(
msg
);

46 
	}
}

48 @
Ov”ride


49 
public
 
	$£tRou‹r
(
ICl›ÁRou‹r
 
rou‹r
) {

50 
this
.
rou‹r
 =„outer;

51 
	}
}

53 @
Ov”ride


54 
public
 
ICl›ÁRou‹r
 
	$g‘Rou‹r
() {

55  
rou‹r
;

56 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gCl›ÁHªdËr
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gCl›ÁMsgHªdËr
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›Á
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gIHªdËr
;

18 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

24 @
Slf4j


25 
public
 
şass
 
LogR•liÿtiÚHªdËr
 
im¶em’ts
 
	gICl›Á
, 
	gIHªdËr
<
	gLogR•liÿtiÚCl›Á
> {

27 @
	gS‘‹r


28 @
G‘‹r


29 
ICl›ÁRou‹r
 
	grou‹r
;

31 @
G‘‹r


32 
public
 
Cl›ÁMsgHªdËr
 
	gmsgHªdËr
 = 
Ãw
 Cl›ÁMsgHªdËr(
this
)

33 .
g’”©eHªdËrs
(
M‘hodHªdËs
.
lookup
(), 
this
);

42 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_REPLICATION_ENTRY
)

43 
´iv©e
 
Objeù
 
hªdËLogR•liÿtiÚAck
(
CÜfuPaylßdMsg
<
LogR•liÿtiÚEÁry
> 
msg
,

44 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

45 
	glog
.
šfo
("Handle†og„eplication ACK");

46  
	gmsg
.
g‘Paylßd
();

49 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_REPLICATION_NEGOTIATION_RESPONSE
)

50 
´iv©e
 
Objeù
 
hªdËLogR•liÿtiÚNegÙŸtiÚ
(
CÜfuPaylßdMsg
<
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
> 
msg
,

51 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

52 
	glog
.
šfo
("Handle†og„eplication Negotiation Response");

53  
	gmsg
.
g‘Paylßd
();

56 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_REPLICATION_QUERY_LEADERSHIP_RESPONSE
)

57 
´iv©e
 
Objeù
 
hªdËLogR•liÿtiÚQu”yL—d”shRe¥Ú£
(
CÜfuPaylßdMsg
<
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
> 
msg
,

58 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

59 
	glog
.
šfo
("********HªdË†og„•liÿtiÚ qu”y†—d”sh„e¥Ú£ msg {}", 
msg
);

60  
	gmsg
.
g‘Paylßd
();

63 @
Ov”ride


64 
public
 
LogR•liÿtiÚCl›Á
 
g‘Cl›Á
(
•och
) {

65  
Ãw
 
LogR•liÿtiÚCl›Á
(
rou‹r
, 
•och
);

	@log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationRuntime.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gSourûMªag”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gNodeRou‹rPoŞ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gN‘tyCl›ÁRou‹r
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

18 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

19 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

22 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

24 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

27 @
Slf4j


28 
public
 cÏs 
	cLogR•liÿtiÚRuÁime
 {

32 @
G‘‹r


33 
´iv©e
 
fš®
 
LogR•liÿtiÚRuÁimeP¬am‘”s
 
	m·¿m‘”s
;

38 
´iv©e
 
NodeRou‹rPoŞ
 
	mnodeRou‹rPoŞ
;

43 
´iv©e
 
LogR•liÿtiÚCl›Á
 
	mş›Á
;

48 @
G‘‹r


49 
´iv©e
 
SourûMªag”
 
	msourûMªag”
;

54 @
G‘‹r


55 
´iv©e
 
fš®
 
Ev’tLoİGroup
 
	mÃ‰yEv’tLoİ
;

57 
public
 
LogR•liÿtiÚRuÁime
(@
NÚnuÎ
 
LogR•liÿtiÚRuÁimeP¬am‘”s
 
·¿m‘”s
) {

58 
	mthis
.
	m·¿m‘”s
 = 
·¿m‘”s
;

61 
	mÃ‰yEv’tLoİ
 = 
g‘NewEv’tLoİGroup
();

64 
	mnodeRou‹rPoŞ
 = 
Ãw
 
NodeRou‹rPoŞ
(
g‘Rou‹rFunùiÚ
);

73 
´iv©e
 
Ev’tLoİGroup
 
	$g‘NewEv’tLoİGroup
() {

75 
numTh»ads
 = 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2;

76 
Th»adFaùÜy
 
çùÜy
 = 
Ãw
 
	`Th»adFaùÜyBud”
()

77 .
	`£tD«mÚ
(
Œue
)

78 .
	`£tNameFÜm©
(
·¿m‘”s
.
	`g‘N‘tyEv’tLoİTh»adFÜm©
())

79 .
	`£tUnÿughtExû±iÚHªdËr
(
this
::
hªdËUnÿughtTh»ad
)

80 .
	`bud
();

81  
·¿m‘”s
.
	`g‘Sock‘Ty³
().
	`g‘G’”©Ü
().
	`g’”©e
(
numTh»ads
, 
çùÜy
);

82 
	}
}

89 @
G‘‹r


90 
´iv©e
 
fš®
 
	gFunùiÚ
<
	gSŒšg
, 
	gICl›ÁRou‹r
> 
	gg‘Rou‹rFunùiÚ
 = (
add»ss
) -> {

91 
NodeLoÿtÜ
 
node
 = NodeLoÿtÜ.
·r£SŒšg
(
add»ss
);

93 
N‘tyCl›ÁRou‹r
 
	gÃwRou‹r
 = 
Ãw
 N‘tyCl›ÁRou‹r(
node
,

94 
g‘N‘tyEv’tLoİ
(),

95 
g‘P¬am‘”s
());

96 
	glog
.
debug
("CÚÃùšgØÃw„ou‹¸{}", 
node
);

97 
	gŒy
 {

98 
	gÃwRou‹r
.
addCl›Á
(
Ãw
 
LogR•liÿtiÚHªdËr
());

99 } 
ÿtch
 (
Exû±iÚ
 
e
) {

100 
	glog
.
w¬n
("E¼Ü cÚÃùšgØrou‹r", 
e
);

101 
throw
 
	ge
;

103  
	gÃwRou‹r
;

112 
´iv©e
 
hªdËUnÿughtTh»ad
(@
NÚnuÎ
 
Th»ad
 
th»ad
, @NÚnuÎ 
ThrowabË
 
throwabË
) {

113 ià(
	g·¿m‘”s
.
g‘UnÿughtExû±iÚHªdËr
(è!ğ
nuÎ
) {

114 
·¿m‘”s
.
g‘UnÿughtExû±iÚHªdËr
().
unÿughtExû±iÚ
(
th»ad
, 
throwabË
);

116 
	glog
.
”rÜ
("handleUncaughtThread: {}erminated withhrowable ofype {}",

117 
th»ad
.
g‘Name
(),

118 
throwabË
.
g‘CÏss
().
g‘Sim¶eName
(),

119 
throwabË
);

123 
public
 
	$cÚÃù
 () {

124 
log
.
	`šfo
("Connected");

125 
ICl›ÁRou‹r
 
rou‹r
 = 
	`g‘Rou‹r
(
·¿m‘”s
.
	`g‘RemÙeLogR•liÿtiÚS”v”Endpošt
());

126 
ş›Á
 = 
Ãw
 
	`LogR•liÿtiÚCl›Á
(
rou‹r
);

129 
S‘
<
SŒšg
> 
bËsToR•liÿ‹
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
	`asLi¡
("Table001", "Table002", "Table003"));

130 
LogR•liÿtiÚCÚfig
 
cÚfig
 = 
Ãw
 
	`LogR•liÿtiÚCÚfig
(
bËsToR•liÿ‹
, 
UUID
.
	`¿ndomUUID
(), UUID.randomUUID());

131 
log
.
	`šfo
("S‘ Sourû Mªag”ØcÚÃùØloÿÈCÜfu oÀ{}", 
·¿m‘”s
.
	`g‘LoÿlCÜfuEndpošt
());

132 
sourûMªag”
 = 
Ãw
 
	`SourûMªag”
(
·¿m‘”s
.
	`g‘LoÿlCÜfuEndpošt
(),

133 
ş›Á
, 
cÚfig
);

134 
	}
}

136 
public
 
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
 
	$qu”yL—d”sh
(è
throws
 
Exû±iÚ
 {

137 
log
.
	`šfo
("***** Send QueryLeadership Request");

138  
ş›Á
.
	`£ndQu”yL—d”sh
().
	`g‘
();

139 
	}
}

142 
public
 
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
 
	$¡¬tNegÙŸtiÚ
(è
throws
 
Exû±iÚ
 {

143 
log
.
	`šfo
("Send Notification Request");

144  
ş›Á
.
	`£ndNegÙŸtiÚReque¡
().
	`g‘
();

145 
	}
}

153 
public
 
ICl›ÁRou‹r
 
	$g‘Rou‹r
(
SŒšg
 
add»ss
) {

154  
nodeRou‹rPoŞ
.
	`g‘Rou‹r
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
add»ss
));

155 
	}
}

157 
public
 
	$¡¬tSÇpshÙSync
() {

158 
UUID
 
¢­shÙSyncReque¡Id
 = 
sourûMªag”
.
	`¡¬tSÇpshÙSync
();

159 
log
.
	`šfo
("S¹ SÇpshÙ Sync[{}]", 
¢­shÙSyncReque¡Id
);

160 
	}
}

162 
public
 
	$¡¬tLogEÁrySync
() {

163 
sourûMªag”
.
	`¡¬tR•liÿtiÚ
();

164 
	}
}

170 
public
 
	$¡İ
() {

171 
sourûMªag”
.
	`shutdown
();

172 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationRuntimeParameters.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gex³rim’l
.
	gSu³rBud”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gRuÁimeP¬am‘”s
;

8 @
	gD©a


9 @
Su³rBud”


10 
public
 cÏs 
	cLogR•liÿtiÚRuÁimeP¬am‘”s
 
ex‹nds
 
	mRuÁimeP¬am‘”s
 {

12 
´iv©e
 
SŒšg
 
	mloÿlCÜfuEndpošt
;

14 
´iv©e
 
SŒšg
 
	m»mÙeLogR•liÿtiÚS”v”Endpošt
;

	@log-replication/src/main/java/org/corfudb/logreplication/send/CorfuDataSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gruÁime
.
	gLogR•liÿtiÚCl›Á
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

13 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	g¦“p
;

15 @
Slf4j


16 
public
 cÏs 
	cCÜfuD©aS’d”
 
im¶em’ts
 
	mD©aS’d”
 {

18 
´iv©e
 
fš®
 
LogR•liÿtiÚCl›Á
 
	mş›Á
;

20 
public
 
	$CÜfuD©aS’d”
(
LogR•liÿtiÚCl›Á
 
ş›Á
) {

21 
this
.
ş›Á
 = client;

24 @
Ov”ride


25 
public
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
	$£nd
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

26 
log
.
	`šfo
("Send single†ogƒntry");

28  
ş›Á
.
	`£ndLogEÁry
(
mes§ge
);

29 
	}
}

31 @
Ov”ride


32 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
£nd
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
) {

33 
	glog
.
šfo
("Send multiple†ogƒntries");

34 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	gÏ¡S’tMes§ge
 = 
Ãw
 
Com¶‘abËFutu»
<>();

35 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	gtmp
;

37 
LogR•liÿtiÚEÁry
 
	gmes§ge
 : 
mes§ges
) {

39 
tmp
 = 
£nd
(
mes§ge
);

41 ià(
	gmes§ge
.
g‘M‘ad©a
().
g‘Mes§geM‘ad©aTy³
().
equ®s
(
Mes§geTy³
.
SNAPSHOT_END
) ||

42 
	gmes§ge
.
g‘M‘ad©a
().
g‘Mes§geM‘ad©aTy³
().
equ®s
(
Mes§geTy³
.
LOG_ENTRY_MESSAGE
)) {

43 
	gÏ¡S’tMes§ge
 = 
tmp
;

47  
	gÏ¡S’tMes§ge
;

50 @
Ov”ride


51 
public
 
	$ÚE¼Ü
(
LogR•liÿtiÚE¼Ü
 
”rÜ
) {

53 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/DefaultReadProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

12 
public
 cÏs 
	cDeçuÉR—dProûssÜ
 
im¶em’ts
 
	mR—dProûssÜ
 {

14 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

16 
public
 
	$DeçuÉR—dProûssÜ
(
CÜfuRuÁime
 
ruÁime
) {

17 
this
.
ruÁime
 =„untime;

20 @
Ov”ride


21 
public
 
Li¡
<
by‹
[]> 
	`´oûss
(Li¡<
ILogD©a
> 
logEÁr›s
) {

23  
logEÁr›s
.
	`¡»am
().
	`m­
(
logEÁry
 -> (
by‹
[]îogEÁry.
	`g‘Paylßd
(
ruÁime
)).

24 
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

25 
	}
}

27 @
Ov”ride


28 
public
 
	gby‹
[] 
	$´oûss
(
ILogD©a
 
logEÁry
) {

30  (
by‹
[])
logEÁry
.
	`g‘Paylßd
(
ruÁime
);

31 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/IllegalTransactionStreamsException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
public
 cÏs 
	cIÎeg®T¿n§ùiÚSŒ—msExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

5 
public
 
	$IÎeg®T¿n§ùiÚSŒ—msExû±iÚ
 (
SŒšg
 
mes§ge
) {

6 
	`su³r
(
mes§ge
);

8 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/LogEntryReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

12 
public
 
š‹rçû
 
	gLogEÁryR—d”
 {

21 
LogR•liÿtiÚEÁry
 
»ad
(
UUID
 
logEÁryReque¡Id
);

23 
»£t
(
Ï¡S’tBa£SÇpshÙTime¡amp
, 
Ï¡AckedTime¡amp
);

25 
£tS™eEpoch
(
s™eEpoch
);

	@log-replication/src/main/java/org/corfudb/logreplication/send/LogEntrySender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚFSM
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
.
	gLogR•liÿtiÚEv’tTy³
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

17 
impÜt
 
	gjava
.
	gio
.
	gFe
;

18 
impÜt
 
	gjava
.
	gio
.
	gFeR—d”
;

19 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

24 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gRejeùedExecutiÚExû±iÚ
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

38 @
Slf4j


39 
public
 cÏs 
	cLogEÁryS’d”
 {

40 
public
 
fš®
 
SŒšg
 
	mcÚfig_fe
 = "/config/corfu/corfu_replication_config.properties";

41 
public
 
fš®
 
	mDEFAULT_READER_QUEUE_SIZE
 = 1;

42 
public
 
fš®
 
	mDEFAULT_RESENT_TIMER
 = 5000;

43 
public
 
fš®
 
	mDEFAULT_MAX_RETRY
 = 5;

44 
public
 
fš®
 
	mDEFAULT_TIMEOUT
 = 5000;

49 
fš®
 
´iv©e
 
	mTIME_INCREMENT
 = 10;

51 
´iv©e
 
	m»ad”B©chSize
 = 
DEFAULT_READER_QUEUE_SIZE
;

56 
´iv©e
 
	mmsgTim”
 = 
DEFAULT_RESENT_TIMER
;

61 
´iv©e
 
	mmaxR‘ry
 = 
DEFAULT_MAX_RETRY
;

66 
´iv©e
 
boŞ—n
 
	m”rÜOnMsgTimeout
 = 
Œue
;

71 
	mcu¼’tTime
;

76 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

81 
´iv©e
 
LogEÁryR—d”
 
	mlogEÁryR—d”
;

86 
´iv©e
 
D©aS’d”
 
	md©aS’d”
;

91 @
G‘‹r


92 
LogR•liÿtiÚEÁryQueue
 
	m³ndšgEÁr›s
;

94 
´iv©e
 
	mackTs
 = 
Add»ss
.
NON_ADDRESS
;

99 
´iv©e
 
LogR•liÿtiÚFSM
 
	mlogR•liÿtiÚFSM
;

102 
´iv©e
 vŞ©
boŞ—n
 
	mskAùive
 = 
çl£
;

105 
´iv©e
 
	mM­
<
	mLÚg
, 
	mCom¶‘abËFutu»
<
	mLogR•liÿtiÚEÁry
>> 
	m³ndšgLogEÁr›sAcked
 = 
Ãw
 
HashM­
<>();

106 
´iv©e
 
	mLi¡
<
	mCom¶‘abËFutu»
<
	mLogR•liÿtiÚEÁry
>> 
	m³ndšgFÜAck
 = 
Ãw
 
A¼ayLi¡
<>();

111 
public
 
	$¡İ
() {

112 
skAùive
 = 
çl£
;

123 
public
 
	$LogEÁryS’d”
(
CÜfuRuÁime
 
ruÁime
, 
LogEÁryR—d”
 
logEÁryR—d”
, 
D©aS’d”
 
d©aS’d”
,

124 
R—dProûssÜ
 
»adProûssÜ
, 
LogR•liÿtiÚFSM
 
logR•liÿtiÚFSM
) {

126 
	`»adCÚfig
();

127 
this
.
ruÁime
 =„untime;

128 
this
.
logEÁryR—d”
 =†ogEntryReader;

129 
this
.
d©aS’d”
 = dataSender;

130 
this
.
logR•liÿtiÚFSM
 =†ogReplicationFSM;

131 
this
.
³ndšgEÁr›s
 = 
Ãw
 
	`LogR•liÿtiÚEÁryQueue
(
»ad”B©chSize
);

132 
	}
}

134 
´iv©e
 
	$»adCÚfig
() {

135 
Œy
 {

136 
Fe
 
cÚfigFe
 = 
Ãw
 
	`Fe
(
cÚfig_fe
);

137 
FeR—d”
 
»ad”
 = 
Ãw
 
	`FeR—d”
(
cÚfigFe
);

139 
Prİ”t›s
 
´İs
 = 
Ãw
 
	`Prİ”t›s
();

140 
´İs
.
	`lßd
(
»ad”
);

142 
maxR‘ry
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("log_»ad”_max_»Œy", IÁeg”.
	`toSŒšg
(
DEFAULT_MAX_RETRY
)));

143 
»ad”B©chSize
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("log_»ad”_queue_size", IÁeg”.
	`toSŒšg
(
DEFAULT_READER_QUEUE_SIZE
)));

144 
msgTim”
 = 
IÁeg”
.
	`·r£IÁ
(
´İs
.
	`g‘Prİ”ty
("log_»ad”_»£nd_tim”", IÁeg”.
	`toSŒšg
(
DEFAULT_RESENT_TIMER
)));

145 
”rÜOnMsgTimeout
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
´İs
.
	`g‘Prİ”ty
("log_reader_error_on_message_timeout", "true"));

146 
»ad”
.
	`şo£
();

148 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

149 
log
.
	`w¬n
("ThcÚfig fi nÙ‡vaabË {} , wÈu£hdeçuÉ vauË fÜ cÚfig.", 
e
.
	`g‘Cau£
());

150 } 
fš®ly
 {

151 
log
.
	`šfo
("log„eader config max_retry {}„eader_queue_size {}ƒntry_resend_timer {} waitAck {}",

152 
maxR‘ry
, 
»ad”B©chSize
, 
msgTim”
, 
”rÜOnMsgTimeout
);

154 
	}
}

163 
	$»£nd
() {

164 
i
 = 0; i < 
³ndšgEÁr›s
.
li¡
.
	`size
(è&& 
skAùive
; i++) {

165 
LogR•liÿtiÚP’dšgEÁry
 
’Œy
 = 
³ndšgEÁr›s
.
li¡
.
	`g‘
(
i
);

166 ià(
’Œy
.
	`timeout
(
	`g‘Cu¼’tTime
(), 
msgTim”
)) {

167 ià(
”rÜOnMsgTimeout
 && 
’Œy
.
»Œy
 >ğ
maxR‘ry
) {

168 
log
.
	`w¬n
("EÁry {} oàty³ {} ha b“À»£Á maxime {} fÜim” {}.", 
’Œy
.
	`g‘D©a
().
	`g‘M‘ad©a
().
	`g‘Time¡amp
(),

169 
’Œy
.
	`g‘D©a
().
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(), 
maxR‘ry
, 
msgTim”
);

170 
throw
 
Ãw
 
	`LogEÁrySyncTimeoutExû±iÚ
("timeout");

173 
’Œy
.
	`»Œy
(
	`g‘Cu¼’tTime
());

174 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
cf
 = 
d©aS’d”
.
	`£nd
(
’Œy
.
	`g‘D©a
());

175 
³ndšgLogEÁr›sAcked
.
	`put
(
’Œy
.
	`g‘D©a
().
	`g‘M‘ad©a
().
	`g‘Time¡amp
(), 
cf
);

176 
log
.
	`šfo
("»£nd mes§g" + 
’Œy
.
	`g‘D©a
().
	`g‘M‘ad©a
().
	`g‘Time¡amp
());

179 
	}
}

184 
public
 
	$£nd
(
UUID
 
logEÁrySyncEv’tId
) {

185 
cu¼’tTime
 = 
java
.
Ïng
.
Sy¡em
.
	`cu¼’tTimeMlis
();

186 
skAùive
 = 
Œue
;

188 
Œy
 {

190 ià(!
³ndšgEÁr›s
.
li¡
.
	`isEm±y
()) {

191 
Œy
 {

192 
LogR•liÿtiÚEÁry
 
ack
 = (LogR•liÿtiÚEÁry)
Com¶‘abËFutu»
.
	`ªyOf
(
³ndšgLogEÁr›sAcked


193 .
	`v®ues
().
	`toA¼ay
(
Ãw
 
Com¶‘abËFutu»
<?>[
³ndšgLogEÁr›sAcked
.
	`size
()])).
	`g‘
(
DEFAULT_TIMEOUT
, 
TimeUn™
.
MILLISECONDS
);

194 
log
.
	`Œaû
("Reûived Log EÁry‡ck ({}èfÜ {}", 
ack
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(),

195 
ack
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
());

196 
	`upd©eAckTs
(
ack
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
());

200 
³ndšgLogEÁr›sAcked
 =…’dšgLogEÁr›sAcked.
	`’ŒyS‘
().
	`¡»am
()

201 .
	`f‹r
(
’Œy
 ->ƒÁry.
	`g‘Key
(è> 
ack
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
())

202 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(
x
 -> x.
	`g‘Key
(), x -> x.
	`g‘V®ue
()));

204 
log
.
	`Œaû
("TÙ®…’dšg†ogƒÁry‡cks: {}, fÜime¡amps: {}", 
³ndšgLogEÁr›sAcked
.
	`size
(),…’dšgLogEÁr›sAcked.
	`keyS‘
());

208 
logR•liÿtiÚFSM
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
LOG_ENTRY_SYNC_REPLICATED
,

209 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
ack
.
	`g‘M‘ad©a
().
	`g‘SyncReque¡Id
(),‡ck.g‘M‘ad©a().
	`g‘Time¡amp
())));

211 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
‹
) {

212 
log
.
	`šfo
("Log EÁry ACKimed out,…’dšg‡ck fÜ {}", 
³ndšgLogEÁr›sAcked
.
	`keyS‘
());

213 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

214 
log
.
	`”rÜ
("Exû±iÚ caughˆwhwa™šg oÀlogƒÁry ACK.", 
e
);

215 
	`ÿnûlLogEÁrySync
(
LogR•liÿtiÚE¼Ü
.
UNKNOWN
, 
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
, 
logEÁrySyncEv’tId
);

219 
	`»£nd
();

221 } 
	`ÿtch
 (
LogEÁrySyncTimeoutExû±iÚ
 
‹
) {

222 
log
.
	`”rÜ
("LogEÁrySyncTimeoutExû±iÚ‡á” sev”®„‘r›s.", 
‹
);

223 
	`ÿnûlLogEÁrySync
(
LogR•liÿtiÚE¼Ü
.
LOG_ENTRY_ACK_TIMEOUT
, 
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
, 
logEÁrySyncEv’tId
);

227 
skAùive
 && 
³ndšgEÁr›s
.
li¡
.
	`size
(è< 
»ad”B©chSize
) {

228 
LogR•liÿtiÚEÁry
 
mes§ge
;

230 
Œy
 {

231 
mes§ge
 = 
logEÁryR—d”
.
	`»ad
(
logEÁrySyncEv’tId
);

233 ià(
mes§ge
 !ğ
nuÎ
) {

234 
³ndšgEÁr›s
.
	`­³nd
(
mes§ge
, 
	`g‘Cu¼’tTime
());

235 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
cf
 = 
d©aS’d”
.
	`£nd
(
mes§ge
);

236 
³ndšgLogEÁr›sAcked
.
	`put
(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
(), 
cf
);

237 
log
.
	`Œaû
("£nd mes§g" + 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Time¡amp
());

242 
skAùive
 = 
çl£
;

250 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

251 
log
.
	`”rÜ
("CaughˆTrimmed Exû±iÚ wh»adšg fÜ {}", 
logEÁrySyncEv’tId
);

252 
	`ÿnûlLogEÁrySync
(
LogR•liÿtiÚE¼Ü
.
TRIM_LOG_ENTRY_SYNC
, 
LogR•liÿtiÚEv’t
.
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
, 
logEÁrySyncEv’tId
);

254 } 
	`ÿtch
 (
IÎeg®T¿n§ùiÚSŒ—msExû±iÚ
 
£
) {

257 
log
.
	`”rÜ
("IÎeg®T¿n§ùiÚSŒ—msExû±iÚ,†og„•liÿtiÚ wÈbTERMINATED.", 
£
);

258 
	`ÿnûlLogEÁrySync
(
LogR•liÿtiÚE¼Ü
.
ILLEGAL_TRANSACTION
, 
LogR•liÿtiÚEv’tTy³
.
REPLICATION_SHUTDOWN
, 
logEÁrySyncEv’tId
);

260 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

261 
log
.
	`”rÜ
("Caughˆexû±iÚ‡ˆLogEÁryS’d”", 
e
);

262 
	`ÿnûlLogEÁrySync
(
LogR•liÿtiÚE¼Ü
.
UNKNOWN
, 
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
, 
logEÁrySyncEv’tId
);

267 
logR•liÿtiÚFSM
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’t
.
LogR•liÿtiÚEv’tTy³
.
LOG_ENTRY_SYNC_CONTINUE
,

268 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
logEÁrySyncEv’tId
)));

269 
	}
}

271 
´iv©e
 
	$ÿnûlLogEÁrySync
(
LogR•liÿtiÚE¼Ü
 
”rÜ
, 
LogR•liÿtiÚEv’tTy³
 
Œªs™iÚ
, 
UUID
 
logEÁrySyncEv’tId
) {

272 
d©aS’d”
.
	`ÚE¼Ü
(
”rÜ
);

273 
logR•liÿtiÚFSM
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
Œªs™iÚ
,‚ew 
	`LogR•liÿtiÚEv’tM‘ad©a
(
logEÁrySyncEv’tId
)));

275 
	}
}

280 
public
 
	$»£t
(
ba£SÇpshÙ
, 
ackTs
) {

281 
skAùive
 = 
Œue
;

282 
logEÁryR—d”
.
	`»£t
(
ba£SÇpshÙ
, 
ackTs
);

283 
³ndšgEÁr›s
.
	`eviùAÎ
();

284 
	}
}

290 
public
 
	$upd©eAckTs
(
LÚg
 
ackTime¡amp
) {

291 ià(
ackTime¡amp
 <ğ
ackTs
)

293 
ackTs
 = 
ackTime¡amp
;

294 
log
.
	`šfo
("P’dšgƒÁr› befÜeviùiÚ‡ˆ{} i {}", 
ackTs
, 
³ndšgEÁr›s
.
li¡
.
	`size
());

295 
³ndšgEÁr›s
.
	`eviùAÎ
(
ackTs
);

296 
log
.
	`šfo
("P’dšgƒÁr› AFTERƒviùiÚ‡ˆ{} i {}", 
ackTs
, 
³ndšgEÁr›s
.
li¡
.
	`size
());

298 
log
.
	`Œaû
("ackTS " + 
ackTs
 + " queusiz" + 
³ndšgEÁr›s
.
li¡
.
	`size
());

299 
	}
}

301 
´iv©e
 
	$g‘Cu¼’tTime
() {

302 
cu¼’tTime
 +ğ
TIME_INCREMENT
;

303  
cu¼’tTime
;

304 
	}
}

310 @
D©a


311 
public
 şas 
	cLogR•liÿtiÚP’dšgEÁry
 {

313 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gd©a
;

316 
	gtime
;

319 
	g»Œy
;

321 
public
 
LogR•liÿtiÚP’dšgEÁry
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
d©a
, 
time
) {

322 
	gthis
.
	gd©a
 = 
d©a
;

323 
	gthis
.
	gtime
 = 
time
;

324 
	gthis
.
	g»Œy
 = 0;

327 
boŞ—n
 
timeout
(
ùime
, 
tim”
) {

328 
	glog
.
Œaû
("cu¼’ˆtim{} - origš®im{} = {}im” {}", 
ùime
, 
this
.
time
, 
tim”
);

329  (
	gùime
 - 
	gthis
.
	gtime
è> 
	gtim”
;

332 
»Œy
(
time
) {

333 
	gthis
.
	gtime
 = 
time
;

334 
	g»Œy
++;

343 
public
 şas 
	cLogR•liÿtiÚEÁryQueue
 {

345 
	gsize
;

346 
	gA¼ayLi¡
<
	gLogR•liÿtiÚP’dšgEÁry
> 
	gli¡
;

348 
public
 
LogR•liÿtiÚEÁryQueue
(
size
) {

349 
	gthis
.
	gsize
 = 
size
;

350 
	gli¡
 = 
Ãw
 
A¼ayLi¡
<>();

353 
public
 
eviùAÎ
() {

354 
	gli¡
 = 
Ãw
 
A¼ayLi¡
<>();

357 
eviùAÎ
(
add»ss
) {

358 
	glog
.
Œaû
("eviù‡dd»s " + 
add»ss
);

359 
	gli¡
.
»moveIf
(
a
->×.
d©a
.
g‘M‘ad©a
().
g‘Time¡amp
(è<ğ
add»ss
));

362 
­³nd
(
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
d©a
, 
tim”
) {

363 
LogR•liÿtiÚP’dšgEÁry
 
	g’Œy
 = 
Ãw
 LogR•liÿtiÚP’dšgEÁry(
d©a
, 
tim”
);

364 
	gli¡
.
add
(
’Œy
);

	@log-replication/src/main/java/org/corfudb/logreplication/send/LogEntrySyncTimeoutException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
public
 cÏs 
	cLogEÁrySyncTimeoutExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

5 
public
 
	$LogEÁrySyncTimeoutExû±iÚ
(
SŒšg
 
mes§ge
) {

6 
	`su³r
(
mes§ge
);

8 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/LogReplicationEventMetadata.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
public
 cÏs 
	cLogR•liÿtiÚEv’tM‘ad©a
 {

10 
´iv©e
 
fš®
 
UUID
 
	mNIL_UUID
 = 
Ãw
 UUID(0,0);

18 
´iv©e
 
UUID
 
	m»que¡Id
;

25 
´iv©e
 
	msyncTime¡amp
;

32 
public
 
LogR•liÿtiÚEv’tM‘ad©a
 
	$em±y
() {

33  
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
NIL_UUID
, 0L);

41 
public
 
	$LogR•liÿtiÚEv’tM‘ad©a
(
UUID
 
»que¡Id
) {

42 
this
.
»que¡Id
 =„equestId;

43 
	}
}

51 
public
 
	$LogR•liÿtiÚEv’tM‘ad©a
(
UUID
 
»que¡Id
, 
syncTime¡amp
) {

52 
this
.
»que¡Id
 =„equestId;

53 
this
.
syncTime¡amp
 = syncTimestamp;

54 
	}
}

56 
public
 
UUID
 
	$g‘Reque¡Id
() {

57  
this
.
»que¡Id
;

58 
	}
}

60 
public
 
	$g‘SyncTime¡amp
() {

61  
this
.
syncTime¡amp
;

62 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/ReadProcessor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
public
 
š‹rçû
 
	gR—dProûssÜ
 {

20 
	gLi¡
<
	gby‹
[]> 
´oûss
(
Li¡
<
ILogD©a
> 
logEÁr›s
);

27 
	gby‹
[] 
´oûss
(
ILogD©a
 
logEÁry
);

	@log-replication/src/main/java/org/corfudb/logreplication/send/ReplicationReaderException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
public
 cÏs 
	cR•liÿtiÚR—d”Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

4 
public
 
	$R•liÿtiÚR—d”Exû±iÚ
() { }

6 
public
 
	$R•liÿtiÚR—d”Exû±iÚ
(
SŒšg
 
mes§ge
) {

7 
	`su³r
(
mes§ge
);

8 
	}
}

10 
public
 
	$R•liÿtiÚR—d”Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

11 
	`su³r
(
mes§ge
, 
ÿu£
);

12 
	}
}

14 
public
 
	$R•liÿtiÚR—d”Exû±iÚ
(
ThrowabË
 
ÿu£
) {

15 
	`su³r
(
ÿu£
);

16 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/SnapshotReadMessage.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

6 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 @
D©a


12 
public
 cÏs 
	cSÇpshÙR—dMes§ge
 {

17 
´iv©e
 
boŞ—n
 
	m’dR—d
;

22 
´iv©e
 
	mLi¡
<
	mLogR•liÿtiÚEÁry
> 
	mmes§ges
;

30 
public
 
SÇpshÙR—dMes§ge
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
, 
boŞ—n
 
’dR—d
) {

31 
	mthis
.
	mmes§ges
 = 
mes§ges
;

32 
	mthis
.
	m’dR—d
 = 
’dR—d
;

35 if(
	mmes§ges
.
isEm±y
(è&& !
	m’dR—d
) {

36 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("List of messages isƒmpty‡nd‚oƒnd„ead marker found.");

	@log-replication/src/main/java/org/corfudb/logreplication/send/SnapshotReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
public
 
š‹rçû
 
	gSÇpshÙR—d”
 {

22 @
NÚNuÎ


23 
SÇpshÙR—dMes§ge
 
»ad
(
UUID
 
¢­shÙReque¡Id
);

30 
»£t
(
¢­shÙTime¡amp
);

32 
£tS™eEpoch
(
s™eEpoch
);

	@log-replication/src/main/java/org/corfudb/logreplication/send/SnapshotSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
.
	gLogR•liÿtiÚEv’tTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚFSM
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

19 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

38 @
Slf4j


39 
public
 cÏs 
	cSÇpshÙS’d”
 {

42 
public
 
fš®
 
	mSNAPSHOT_BATCH_SIZE
 = 5;

43 
public
 
fš®
 
	mDEFAULT_TIMEOUT
 = 5000;

45 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

46 
´iv©e
 
SÇpshÙR—d”
 
	m¢­shÙR—d”
;

47 
´iv©e
 
D©aS’d”
 
	md©aS’d”
;

48 
´iv©e
 
R—dProûssÜ
 
	m»adProûssÜ
;

49 
´iv©e
 
LogR•liÿtiÚFSM
 
	mfsm
;

50 
´iv©e
 
	mba£SÇpshÙTime¡amp
;

52 
´iv©e
 
boŞ—n
 
	m¡¬tSÇpshÙSync
 = 
Œue
;

54 @
	mG‘‹r


55 @
VisibËFÜTe¡šg


57 
´iv©e
 
Ob£rvabËV®ue
 
	mob£rvedCouÁ”
 = 
Ãw
 ObservableValue(0);

59 
´iv©e
 vŞ©
boŞ—n
 
	m¡İSÇpshÙSync
 = 
çl£
;

61 
public
 
	$SÇpshÙS’d”
(
CÜfuRuÁime
 
ruÁime
, 
SÇpshÙR—d”
 
¢­shÙR—d”
, 
D©aS’d”
 
d©aS’d”
,

62 
R—dProûssÜ
 
»adProûssÜ
, 
LogR•liÿtiÚFSM
 
fsm
) {

63 
this
.
ruÁime
 =„untime;

64 
this
.
¢­shÙR—d”
 = snapshotReader;

65 
this
.
d©aS’d”
 = dataSender;

66 
this
.
»adProûssÜ
 =„eadProcessor;

67 
this
.
fsm
 = fsm;

70 
´iv©e
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
¢­shÙSyncAck
;

77 
public
 
	$Œªsm™
(
UUID
 
¢­shÙSyncEv’tId
) {

79 
log
.
	`šfo
("RuÂšg sÇpshÙ synøfÜ {} oÀba£SÇpshÙ {}", 
¢­shÙSyncEv’tId
,

80 
ba£SÇpshÙTime¡amp
);

82 
boŞ—n
 
com¶‘ed
 = 
çl£
;

83 
boŞ—n
 
ÿnûl
 = 
çl£
;

84 
mes§gesS’t
 = 0;

87 
SÇpshÙR—dMes§ge
 
¢­shÙR—dMes§ge
;

90 ià(
Add»ss
.
	`isAdd»ss
(
ba£SÇpshÙTime¡amp
)) {

93 
mes§gesS’t
 < 
SNAPSHOT_BATCH_SIZE
 && !
com¶‘ed
 && !
¡İSÇpshÙSync
) {

95 
Œy
 {

96 
¢­shÙR—dMes§ge
 = 
¢­shÙR—d”
.
	`»ad
(
¢­shÙSyncEv’tId
);

97 
com¶‘ed
 = 
¢­shÙR—dMes§ge
.
	`isEndR—d
();

100 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

101 
log
.
	`w¬n
("CªûÈ¢­shÙ synødutØŒimmedƒxû±iÚ.", 
‹
);

102 
	`¢­shÙSyncCªûl
(
¢­shÙSyncEv’tId
, 
LogR•liÿtiÚE¼Ü
.
TRIM_SNAPSHOT_SYNC
);

103 
ÿnûl
 = 
Œue
;

105 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

106 
log
.
	`”rÜ
("Caughˆexû±iÚ duršg sÇpshÙ sync", 
e
);

107 
	`¢­shÙSyncCªûl
(
¢­shÙSyncEv’tId
, 
LogR•liÿtiÚE¼Ü
.
UNKNOWN
);

108 
ÿnûl
 = 
Œue
;

112 
Li¡
<
LogR•liÿtiÚEÁry
> 
d©aToS’d
 = 
	`´oûssR—ds
(
¢­shÙR—dMes§ge
.
	`g‘Mes§ges
(), 
¢­shÙSyncEv’tId
, 
com¶‘ed
);

115 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
³ndšgAck
 = 
d©aS’d”
.
	`£nd
(
d©aToS’d
);

117 ià(
com¶‘ed
) {

119 
¢­shÙSyncAck
 = 
³ndšgAck
;

122 
mes§gesS’t
 +ğ
d©aToS’d
.
	`size
();

123 
ob£rvedCouÁ”
.
	`£tV®ue
(
mes§gesS’t
);

126 ià(
com¶‘ed
) {

128 
Œy
 {

129 
LogR•liÿtiÚEÁry
 
ack
 = 
¢­shÙSyncAck
.
	`g‘
(
DEFAULT_TIMEOUT
, 
TimeUn™
.
MILLISECONDS
);

130 ià(
ack
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
(è=ğ
ba£SÇpshÙTime¡amp
) {

132 
log
.
	`šfo
("SÇpshÙ synøcom¶‘ed fÜ {} oÀtime¡am°{},‡ck[{}::{}]", 
¢­shÙSyncEv’tId
,

133 
ba£SÇpshÙTime¡amp
, 
ack
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
(),

134 
ack
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
());

135 
	`¢­shÙSyncCom¶‘e
(
¢­shÙSyncEv’tId
);

137 
log
.
	`w¬n
("Ex³ùed‡ck fÜ {}, buˆ»ûived fÜ‡ difã»Á sÇpshÙ {}", 
ba£SÇpshÙTime¡amp
,

138 
ack
.
	`g‘M‘ad©a
().
	`g‘SÇpshÙTime¡amp
());

139 
throw
 
Ãw
 
	`Exû±iÚ
("Wrong base snapshot‡ck");

141 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

142 
log
.
	`”rÜ
("Exception caught while blocking on snapshot sync {},‡ck for {}",

143 
¢­shÙSyncEv’tId
, 
ba£SÇpshÙTime¡amp
, 
e
);

144 ià(
¢­shÙSyncAck
.
	`isCom¶‘edExû±iÚ®ly
()) {

145 
log
.
	`”rÜ
("...");

147 
	`¢­shÙSyncCªûl
(
¢­shÙSyncEv’tId
, 
LogR•liÿtiÚE¼Ü
.
UNKNOWN
);

148 } 
fš®ly
 {

149 
¢­shÙSyncAck
 = 
nuÎ
;

151 } ià(!
ÿnûl
) {

157 
log
.
	`Œaû
("SÇpshÙ synøcÚtšufÜ {} oÀtime¡am°{}", 
¢­shÙSyncEv’tId
, 
ba£SÇpshÙTime¡amp
);

158 
fsm
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_CONTINUE
,

159 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
¢­shÙSyncEv’tId
)));

162 
log
.
	`šfo
("SÇpshÙ synøcom¶‘ed fÜ {}‡ th”i nØd©¨šhlog.", 
¢­shÙSyncEv’tId
);

165 
Li¡
<
LogR•liÿtiÚEÁry
> 
¢­shÙSyncEÁr›s
 = 
Ãw
 
A¼ayLi¡
<>();

166 
¢­shÙSyncEÁr›s
.
	`add
(
	`g‘SÇpshÙSyncS¹M¬k”
(
¢­shÙSyncEv’tId
));

167 
¢­shÙSyncEÁr›s
.
	`add
(
	`g‘SÇpshÙSyncEndM¬k”
(
¢­shÙSyncEv’tId
));

168 
d©aS’d”
.
	`£nd
(
¢­shÙSyncEÁr›s
);

169 
	`¢­shÙSyncCom¶‘e
(
¢­shÙSyncEv’tId
);

171 
	}
}

173 
´iv©e
 
	gLi¡
<
	gLogR•liÿtiÚEÁry
> 
´oûssR—ds
(
Li¡
<
LogR•liÿtiÚEÁry
> 
logR•liÿtiÚEÁr›s
, 
UUID
 
¢­shÙSyncEv’tId
, 
boŞ—n
 
com¶‘ed
) {

175 
	gLi¡
<
	gLogR•liÿtiÚEÁry
> 
	gd©aToS’d
 = 
Ãw
 
A¼ayLi¡
<>();

178 ià(
	g¡¬tSÇpshÙSync
) {

179 
LogR•liÿtiÚEÁry
 
	g¡¬tD©aMes§ge
 = 
g‘SÇpshÙSyncS¹M¬k”
(
¢­shÙSyncEv’tId
);

180 
	gd©aToS’d
.
add
(
¡¬tD©aMes§ge
);

181 
	g¡¬tSÇpshÙSync
 = 
çl£
;

184 
	gd©aToS’d
.
addAÎ
(
logR•liÿtiÚEÁr›s
);

187 ià(
	gcom¶‘ed
) {

188 
LogR•liÿtiÚEÁry
 
	g’dD©aMes§ge
 = 
g‘SÇpshÙSyncEndM¬k”
(
¢­shÙSyncEv’tId
);

189 
	gd©aToS’d
.
add
(
’dD©aMes§ge
);

192  
	gd©aToS’d
;

202 
´iv©e
 
LogR•liÿtiÚEÁry
 
	$g‘SÇpshÙSyncS¹M¬k”
(
UUID
 
¢­shÙSyncEv’tId
) {

203 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
Ãw
 
	`LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
.
SNAPSHOT_START
, 
fsm
.
	`g‘S™eEpoch
(),

204 
¢­shÙSyncEv’tId
, 
Add»ss
.
NON_ADDRESS
, 
ba£SÇpshÙTime¡amp
, snapshotSyncEventId);

205 
LogR•liÿtiÚEÁry
 
em±yEÁry
 = 
Ãw
 
	`LogR•liÿtiÚEÁry
(
m‘ad©a
,‚ew 
by‹
[0]);

206  
em±yEÁry
;

207 
	}
}

209 
´iv©e
 
LogR•liÿtiÚEÁry
 
	$g‘SÇpshÙSyncEndM¬k”
(
UUID
 
¢­shÙSyncEv’tId
) {

210 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
Ãw
 
	`LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
.
SNAPSHOT_END
, 
fsm
.
	`g‘S™eEpoch
(),

211 
¢­shÙSyncEv’tId
, 
Add»ss
.
NON_ADDRESS
, 
ba£SÇpshÙTime¡amp
, snapshotSyncEventId);

212 
LogR•liÿtiÚEÁry
 
em±yEÁry
 = 
Ãw
 
	`LogR•liÿtiÚEÁry
(
m‘ad©a
,‚ew 
by‹
[0]);

213  
em±yEÁry
;

214 
	}
}

221 
´iv©e
 
	$¢­shÙSyncCom¶‘e
(
UUID
 
¢­shÙSyncEv’tId
) {

224 
fsm
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_COMPLETE
,

225 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
¢­shÙSyncEv’tId
, 
ba£SÇpshÙTime¡amp
)));

226 
	}
}

234 
´iv©e
 
	$¢­shÙSyncCªûl
(
UUID
 
¢­shÙSyncEv’tId
, 
LogR•liÿtiÚE¼Ü
 
”rÜ
) {

236 
d©aS’d”
.
	`ÚE¼Ü
(
”rÜ
);

240 
fsm
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
,

241 
Ãw
 
	`LogR•liÿtiÚEv’tM‘ad©a
(
¢­shÙSyncEv’tId
)));

242 
	}
}

247 
public
 
	$»£t
() {

250 
ba£SÇpshÙTime¡amp
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

253 
¢­shÙR—d”
.
	`»£t
(
ba£SÇpshÙTime¡amp
);

255 
¡İSÇpshÙSync
 = 
çl£
;

256 
¡¬tSÇpshÙSync
 = 
Œue
;

257 
	}
}

262 
public
 
	$¡İ
() {

263 
¡İSÇpshÙSync
 = 
Œue
;

264 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/StreamsLogEntryReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gO·queSŒ—m
;

15 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

16 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

17 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

18 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

19 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

21 @
	gSlf4j


22 @
NÙTh»adSaã


26 
public
 cÏs 
	cSŒ—msLogEÁryR—d”
 
im¶em’ts
 
	mLogEÁryR—d”
 {

28 
´iv©e
 
CÜfuRuÁime
 
	m¹
;

29 
´iv©e
 
fš®
 
Mes§geTy³
 
	mMSG_TYPE
 = Mes§geTy³.
LOG_ENTRY_MESSAGE
;

31 
´iv©e
 
	mS‘
<
	mUUID
> 
	m¡»amUUIDs
;

34 
´iv©e
 
TxO·queSŒ—m
 
	mtxSŒ—m
;

38 
´iv©e
 
	mglob®Ba£SÇpshÙ
;

40 
´iv©e
 
	m´eMsgTs
;

42 
´iv©e
 
	mcu¼’tMsgTs
;

44 
´iv©e
 
	m£qu’û
;

46 
´iv©e
 
	ms™eEpoch
;

48 
public
 
	$SŒ—msLogEÁryR—d”
(
CÜfuRuÁime
 
ruÁime
, 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

49 
this
.
¹
 = 
ruÁime
;

50 
S‘
<
SŒšg
> 
¡»ams
 = 
cÚfig
.
	`g‘SŒ—msToR•liÿ‹
();

51 
¡»amUUIDs
 = 
Ãw
 
HashS‘
<>();

52 
SŒšg
 
s
 : 
¡»ams
) {

53 
¡»amUUIDs
.
	`add
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
s
));

57 
txSŒ—m
 = 
Ãw
 
	`TxO·queSŒ—m
(
¹
);

60 
LogR•liÿtiÚEÁry
 
	$g’”©eMes§ge
(
O·queEÁry
 
’Œy
, 
UUID
 
logEÁryReque¡Id
) {

61 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`bufãr
();

62 
O·queEÁry
.
	`£rŸlize
(
buf
, 
’Œy
);

64 
cu¼’tMsgTs
 = 
’Œy
.
	`g‘V”siÚ
();

65 
LogR•liÿtiÚEÁry
 
txMes§ge
 = 
Ãw
 
	`LogR•liÿtiÚEÁry
(
MSG_TYPE
, 
s™eEpoch
,
logEÁryReque¡Id
,

66 
cu¼’tMsgTs
, 
´eMsgTs
, 
glob®Ba£SÇpshÙ
, 
£qu’û
, 
buf
.
	`¬¿y
());

67 
´eMsgTs
 = 
cu¼’tMsgTs
;

68 
£qu’û
++;

69  
txMes§ge
;

70 
	}
}

72 
boŞ—n
 
	$shouldProûss
(
O·queEÁry
 
’Œy
è
throws
 
R•liÿtiÚR—d”Exû±iÚ
 {

73 
S‘
<
UUID
> 
tmpUUIDs
 = 
’Œy
.
	`g‘EÁr›s
().
	`keyS‘
();

76 ià(
¡»amUUIDs
.
	`cÚšsAÎ
(
tmpUUIDs
))

77  
Œue
;

80 
tmpUUIDs
.
	`»šAÎ
(
¡»amUUIDs
);

81 ià(
tmpUUIDs
.
	`isEm±y
())

82  
çl£
;

86 
log
.
	`”rÜ
("There‡re‚oisy streams {} inheƒntry,ƒxpected streams set {}",

87 
’Œy
.
	`g‘EÁr›s
().
	`keyS‘
(), 
¡»amUUIDs
);

88 
throw
 
Ãw
 
	`IÎeg®T¿n§ùiÚSŒ—msExû±iÚ
("There‡re‚oisy streams inheransaction†ogƒntry");

90 
	}
}

92 
public
 
	$£tGlob®Ba£SÇpshÙ
(
¢­shÙ
, 
ackTime¡amp
) {

93 
glob®Ba£SÇpshÙ
 = 
¢­shÙ
;

94 
´eMsgTs
 = 
M©h
.
	`max
(
¢­shÙ
, 
ackTime¡amp
);

95 
log
.
	`šfo
("¢­shÙ {}‡ckTime¡am°{}…»MsgT {}", 
¢­shÙ
, 
ackTime¡amp
, 
´eMsgTs
);

96 
txSŒ—m
.
	`£ek
(
´eMsgTs
 + 1);

97 
£qu’û
 = 0;

98 
	}
}

100 @
Ov”ride


101 
public
 
LogR•liÿtiÚEÁry
 
	$»ad
(
UUID
 
logEÁryReque¡Id
è
throws
 
TrimmedExû±iÚ
, 
IÎeg®T¿n§ùiÚSŒ—msExû±iÚ
 {

102 
Œy
 {

103 
txSŒ—m
.
	`hasNext
()) {

104 
O·queEÁry
 
İaqueEÁry
 = 
txSŒ—m
.
	`Ãxt
();

105 ià(!
	`shouldProûss
(
İaqueEÁry
)) {

108 
LogR•liÿtiÚEÁry
 
txMes§ge
 = 
	`g’”©eMes§ge
(
İaqueEÁry
, 
logEÁryReque¡Id
);

110  
txMes§ge
;

112 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

113 
log
.
	`w¬n
("Caughˆªƒxû±iÚ {}", 
e
);

115 
throw
 
e
;

120  
nuÎ
;

121 
	}
}

123 @
Ov”ride


124 
public
 
	$»£t
(
Ï¡S’tBa£SÇpshÙTime¡amp
, 
Ï¡AckedTime¡amp
) {

125 
	`£tGlob®Ba£SÇpshÙ
(
Ï¡S’tBa£SÇpshÙTime¡amp
, 
Ï¡AckedTime¡amp
);

126 
	}
}

131 
public
 şas 
	cTxO·queSŒ—m
 {

132 
CÜfuRuÁime
 
	g¹
;

133 
O·queSŒ—m
 
	gtxSŒ—m
;

134 
I‹¿tÜ
 
	g™”©Ü
;

136 
public
 
TxO·queSŒ—m
(
CÜfuRuÁime
 
¹
) {

138 
	gthis
.
	g¹
 = 
¹
;

139 
	gtxSŒ—m
 = 
Ãw
 
O·queSŒ—m
(
¹
,„t.
g‘SŒ—msV›w
().
g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
));

140 
¡»amUpTo
();

147 
¡»amUpTo
(
¢­shÙ
) {

148 
	glog
.
Œaû
("SŒ—mUpTØ{}", 
¢­shÙ
);

149 
	g™”©Ü
 = 
txSŒ—m
.
¡»amUpTo
(
¢­shÙ
).
™”©Ü
();

155 
¡»amUpTo
() {

156 
¡»amUpTo
(
¹
.
g‘Add»ssS·ûV›w
().
g‘LogTa
());

162 
boŞ—n
 
hasNext
() {

163 ià(!
	g™”©Ü
.
hasNext
()) {

164 
¡»amUpTo
();

166  
	g™”©Ü
.
hasNext
();

172 
O·queEÁry
 
Ãxt
() {

173 ià(!
hasNext
())

174  
	gnuÎ
;

176 
O·queEÁry
 
	gİaqueEÁry
 = (O·queEÁry)
™”©Ü
.
Ãxt
();

177 
	glog
.
Œaû
("Add»s {} O·queEÁry {}", 
İaqueEÁry
.
g‘V”siÚ
(), opaqueEntry);

178  
	gİaqueEÁry
;

186 
public
 
£ek
(
fœ¡Add»ss
) {

187 
	glog
.
Œaû
("£ek h—d {}", 
fœ¡Add»ss
);

188 
	gtxSŒ—m
.
£ek
(
fœ¡Add»ss
);

189 
¡»amUpTo
();

193 @
Ov”ride


194 
public
 
	$£tS™eEpoch
(
s™eEpoch
) {

195 
this
.
s™eEpoch
 = siteEpoch;

196 
	}
}

	@log-replication/src/main/java/org/corfudb/logreplication/send/StreamsSnapshotReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚFSM
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gO·queSŒ—m
;

19 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gPriÜ™yQueue
;

26 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

27 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

28 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

31 @
	gSlf4j


32 @
NÙTh»adSaã


39 
public
 cÏs 
	cSŒ—msSÇpshÙR—d”
 
im¶em’ts
 
	mSÇpshÙR—d”
 {

40 
public
 
fš®
 
	mMAX_NUM_SMR_ENTRY
 = 5;

41 
´iv©e
 
	m¢­shÙTime¡amp
;

42 
´iv©e
 
	mS‘
<
	mSŒšg
> 
	m¡»ams
;

43 
´iv©e
 
	mPriÜ™yQueue
<
	mSŒšg
> 
	m¡»amsToS’d
;

44 
´iv©e
 
CÜfuRuÁime
 
	m¹
;

45 
´iv©e
 
	m´eMsgTs
;

46 
´iv©e
 
	mcu¼’tMsgTs
;

47 
´iv©e
 
O·queSŒ—mI‹¿tÜ
 
	mcu¼’tSŒ—mInfo
;

48 
´iv©e
 
	m£qu’û
;

51 @
S‘‹r


52 
´iv©e
 
	ms™eEpoch
;

57 
public
 
	$SŒ—msSÇpshÙR—d”
(
CÜfuRuÁime
 
¹
, 
LogR•liÿtiÚCÚfig
 
cÚfig
) {

58 
this
.
¹
 =„t;

59 
¡»ams
 = 
cÚfig
.
	`g‘SŒ—msToR•liÿ‹
();

68 
O·queEÁry
 
	$g’”©eO·queEÁry
(
v”siÚ
, 
UUID
 
¡»amID
, 
Li¡
 
smrEÁr›s
) {

69 
M­
<
UUID
, 
Li¡
<
SMREÁry
>> 
m­
 = 
Ãw
 
HashM­
<>();

70 
m­
.
	`put
(
¡»amID
, 
smrEÁr›s
);

71  
Ãw
 
	`O·queEÁry
(
v”siÚ
, 
m­
);

72 
	}
}

81 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
g’”©eMes§ge
(
O·queSŒ—mI‹¿tÜ
 
¡»am
, 
Li¡
<
SMREÁry
> 
’Œ›s
, 
UUID
 
¢­shÙReque¡Id
) {

82 
	gcu¼’tMsgTs
 = 
¡»am
.
maxV”siÚ
;

83 
O·queEÁry
 
	gİaqueEÁry
 = 
g’”©eO·queEÁry
(
cu¼’tMsgTs
, 
¡»am
.
uuid
, 
’Œ›s
);

84 ià(!
	g¡»am
.
	g™”©Ü
.
hasNext
()) {

86 
	gcu¼’tMsgTs
 = 
¢­shÙTime¡amp
;

89 
By‹Buf
 
	gbuf
 = 
UÅoŞed
.
bufãr
();

90 
	gO·queEÁry
.
£rŸlize
(
buf
, 
İaqueEÁry
);

92 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gtxMsg
 = 
Ãw
 
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.LogReplicationEntry

93 (
Mes§geTy³
.
SNAPSHOT_MESSAGE
, 
	gs™eEpoch
, 
	g¢­shÙReque¡Id
, 
	gcu¼’tMsgTs
,

94 
	g´eMsgTs
, 
	g¢­shÙTime¡amp
, 
	g£qu’û
, 
	gbuf
.
¬¿y
());

95 
	g´eMsgTs
 = 
cu¼’tMsgTs
;

96 
	g£qu’û
++;

97 
	glog
.
debug
("G’”©TxMsg {}", 
txMsg
.
g‘M‘ad©a
());

99  
	gtxMsg
;

108 
	gLi¡
<
	gSMREÁry
> 
	$Ãxt
(
O·queSŒ—mI‹¿tÜ
 
¡»am
, 
numEÁr›s
) {

110 
Li¡
<
SMREÁry
> 
li¡
 = 
Ãw
 
A¼ayLi¡
<>();

111 
Œy
 {

112 
¡»am
.
™”©Ü
.
	`hasNext
(è&& 
li¡
.
	`size
(è< 
numEÁr›s
) {

113 
O·queEÁry
 
’Œy
 = (O·queEÁryè
¡»am
.
™”©Ü
.
	`Ãxt
();

114 
¡»am
.
maxV”siÚ
 = 
M©h
.
	`max
(¡»am.maxV”siÚ, 
’Œy
.
	`g‘V”siÚ
());

115 
li¡
.
	`addAÎ
(
’Œy
.
	`g‘EÁr›s
().
	`g‘
(
¡»am
.
uuid
));

117 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
e
) {

118 
log
.
	`”rÜ
("C©ch‡ÀTrimmedExû±iÚƒxû±iÚ ", 
e
);

119 
throw
 
e
;

121  
li¡
;

122 
	}
}

130 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	$»ad
(
O·queSŒ—mI‹¿tÜ
 
¡»am
, 
UUID
 
syncReque¡Id
) {

131 
Li¡
<
SMREÁry
> 
’Œ›s
 = 
	`Ãxt
(
¡»am
, 
MAX_NUM_SMR_ENTRY
);

132 
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
txMsg
 = 
	`g’”©eMes§ge
(
¡»am
, 
’Œ›s
, 
syncReque¡Id
);

133 
log
.
	`šfo
("SucûssfuÎy…as ¡»am {} fÜ sÇpshÙTime¡am°{}", 
¡»am
.
Çme
, 
¢­shÙTime¡amp
);

134  
txMsg
;

135 
	}
}

143 @
Ov”ride


144 
public
 
SÇpshÙR—dMes§ge
 
	$»ad
(
UUID
 
syncReque¡Id
) {

146 
boŞ—n
 
’dSÇpshÙSync
 = 
çl£
;

147 
Li¡
 
msgs
 = 
Ãw
 
A¼ayLi¡
<
LogR•liÿtiÚEÁry
>();

151 ià(
cu¼’tSŒ—mInfo
 =ğ
nuÎ
) {

152 !
¡»amsToS’d
.
	`isEm±y
()) {

154 
cu¼’tSŒ—mInfo
 = 
Ãw
 
	`O·queSŒ—mI‹¿tÜ
(
¡»amsToS’d
.
	`pŞl
(), 
¹
, 
¢­shÙTime¡amp
);

157 ià(
cu¼’tSŒ—mInfo
.
™”©Ü
.
	`hasNext
()) {

161 
log
.
	`šfo
("Snapshot„eader will skip„eading stream {}‡shere‡re‚oƒntrieso send",

162 
cu¼’tSŒ—mInfo
.
uuid
);

167 ià(
cu¼’tSŒ—mInfo
.
™”©Ü
.
	`hasNext
()) {

168 
msgs
.
	`add
(
	`»ad
(
cu¼’tSŒ—mInfo
, 
syncReque¡Id
));

171 ià(!
cu¼’tSŒ—mInfo
.
™”©Ü
.
	`hasNext
()) {

172 
log
.
	`debug
("SÇpshÙ„—d” fšished„—dšg sŒ—m {}", 
cu¼’tSŒ—mInfo
.
uuid
);

173 
cu¼’tSŒ—mInfo
 = 
nuÎ
;

175 ià(
¡»amsToS’d
.
	`isEm±y
()) {

176 
log
.
	`šfo
("SÇpshÙ„—d” fšished„—dšg‡Î sŒ—m {}", 
¡»ams
);

177 
’dSÇpshÙSync
 = 
Œue
;

181  
Ãw
 
	`SÇpshÙR—dMes§ge
(
msgs
, 
’dSÇpshÙSync
);

182 
	}
}

184 @
Ov”ride


185 
public
 
	$»£t
(
¢­shÙTime¡amp
) {

186 
¡»amsToS’d
 = 
Ãw
 
PriÜ™yQueue
<>(
¡»ams
);

187 
´eMsgTs
 = 
Add»ss
.
NON_ADDRESS
;

188 
cu¼’tMsgTs
 = 
Add»ss
.
NON_ADDRESS
;

189 
this
.
¢­shÙTime¡amp
 = snapshotTimestamp;

190 
cu¼’tSŒ—mInfo
 = 
nuÎ
;

191 
£qu’û
 = 0;

192 
	}
}

197 
public
 şas 
	cO·queSŒ—mI‹¿tÜ
 {

198 
SŒšg
 
	gÇme
;

199 
UUID
 
	guuid
;

200 
I‹¿tÜ
 
	g™”©Ü
;

201 
	gmaxV”siÚ
;

203 
O·queSŒ—mI‹¿tÜ
(
SŒšg
 
Çme
, 
CÜfuRuÁime
 
¹
, 
¢­shÙ
) {

204 
	gthis
.
	gÇme
 = 
Çme
;

205 
	guuid
 = 
CÜfuRuÁime
.
g‘SŒ—mID
(
Çme
);

206 
SŒ—mO±iÚs
 
	gİtiÚs
 = SŒ—mO±iÚs.
bud”
()

207 .
ignÜeTrimmed
(
çl£
)

208 .
ÿcheEÁr›s
(
çl£
)

209 .
bud
();

210 
SŒ—m
 
	g¡»am
 = (
Ãw
 
O·queSŒ—m
(
¹
,„t.
g‘SŒ—msV›w
().
g‘
(
uuid
, 
İtiÚs
))).
¡»amUpTo
(
¢­shÙ
);

211 
	g™”©Ü
 = 
¡»am
.
™”©Ü
();

212 
	gmaxV”siÚ
 = 0;

216 @
Ov”ride


217 
public
 
	$£tS™eEpoch
(
s™eEpoch
) {

218 
this
.
s™eEpoch
 = siteEpoch;

219 
	}
}

	@log-replication/src/test/java/org/corfudb/AppTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

3 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gTe¡
;

4 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gTe¡Ca£
;

5 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gTe¡Su™e
;

10 
public
 cÏs 
	cAµTe¡


11 
ex‹nds
 
	mTe¡Ca£


18 
public
 
	$AµTe¡
Ğ
SŒšg
 
‹¡Name
 )

20 
	`su³r
Ğ
‹¡Name
 );

26 
public
 
Te¡
 
	$su™e
()

28  
Ãw
 
	`Te¡Su™e
Ğ
AµTe¡
.
şass
 );

29 
	}
}

34 
public
 
	$‹¡Aµ
()

36 
	`as£¹True
Ğ
Œue
 );

37 
	}
}

	@log-replication/target/generated-sources/org/corfudb/logreplication/proto/LogReplicationSiteInfo.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
;

6 
public
 
fš®
 cÏs 
	cLogR•liÿtiÚS™eInfo
 {

7 
´iv©e
 
	$LogR•liÿtiÚS™eInfo
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

20 
public
 
Glob®Mªag”Stus


21 
im¶em’ts
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gPrÙocŞMes§geEnum
 {

25 
INVALID
(0),

29 
ACTIVE
(1),

33 
STANDBY
(2),

37 
NONE
(3),

38 
UNRECOGNIZED
(-1),

44 
public
 
fš®
 
	gINVALID_VALUE
 = 0;

48 
public
 
fš®
 
	gACTIVE_VALUE
 = 1;

52 
public
 
fš®
 
	gSTANDBY_VALUE
 = 2;

56 
public
 
fš®
 
	gNONE_VALUE
 = 3;

59 
public
 
fš®
 
g‘Numb”
() {

60 ià(
	gthis
 =ğ
UNRECOGNIZED
) {

61 
throw
 
Ãw
 
java
.
Ïng
.
IÎeg®Argum’tExû±iÚ
(

64  
	gv®ue
;

70 @
	gjava
.
	gÏng
.
D•»ÿ‹d


71 
public
 
Glob®Mªag”Stus
 
v®ueOf
(
v®ue
) {

72  
fÜNumb”
(
v®ue
);

75 
public
 
Glob®Mªag”Stus
 
fÜNumb”
(
v®ue
) {

76 
	gv®ue
) {

77 0:  
INVALID
;

78 1:  
ACTIVE
;

79 2:  
STANDBY
;

80 3:  
NONE
;

81 :  
nuÎ
;

85 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gIÁ”Çl
.
	gEnumL™eM­
<
	gGlob®Mªag”Stus
>

86 
š‹º®G‘V®ueM­
() {

87  
	gš‹º®V®ueM­
;

89 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gIÁ”Çl
.
	gEnumL™eM­
<

90 
	gGlob®Mªag”Stus
> 
	gš‹º®V®ueM­
 =

91 
Ãw
 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
EnumL™eM­
<
Glob®Mªag”Stus
>() {

92 
public
 
Glob®Mªag”Stus
 
fšdV®ueByNumb”
(
numb”
) {

93  
Glob®Mªag”Stus
.
fÜNumb”
(
numb”
);

97 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumV®ueDesütÜ


98 
g‘V®ueDesütÜ
() {

99  
g‘DesütÜ
().
g‘V®ues
().
g‘
(
Üdš®
());

101 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumDesütÜ


102 
g‘DesütÜFÜTy³
() {

103  
g‘DesütÜ
();

105 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
EnumDesütÜ


106 
g‘DesütÜ
() {

107  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
g‘DesütÜ
().
g‘EnumTy³s
().
g‘
(0);

110 
´iv©e
 
fš®
 
	gGlob®Mªag”Stus
[] 
	gVALUES
 = 
v®ues
();

112 
public
 
Glob®Mªag”Stus
 
v®ueOf
(

113 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
EnumV®ueDesütÜ
 
desc
) {

114 ià(
	gdesc
.
g‘Ty³
(è!ğ
g‘DesütÜ
()) {

115 
throw
 
Ãw
 
java
.
Ïng
.
IÎeg®Argum’tExû±iÚ
(

118 ià(
	gdesc
.
g‘Index
() == -1) {

119  
UNRECOGNIZED
;

121  
	gVALUES
[
desc
.
g‘Index
()];

124 
´iv©e
 
fš®
 
	gv®ue
;

126 
´iv©e
 
Glob®Mªag”Stus
(
v®ue
) {

127 
	gthis
.
	gv®ue
 = 
v®ue
;

133 
public
 
š‹rçû
 
S™eCÚfigu¿tiÚMsgOrBud”
 
ex‹nds


135 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

140 
g‘Epoch
();

145 
g‘V”siÚ
();

150 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
>

151 
g‘S™eLi¡
();

155 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
g‘S™e
(
šdex
);

159 
g‘S™eCouÁ
();

163 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsgOrBud”
>

164 
g‘S™eOrBud”Li¡
();

168 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsgOrBud”
 
g‘S™eOrBud”
(

169 
šdex
);

174 
	gjava
.
	gÏng
.
SŒšg
 
g‘Fed”©iÚId
();

178 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


179 
g‘Fed”©iÚIdBy‹s
();

184 
	gjava
.
	gÏng
.
SŒšg
 
g‘C”ts
();

188 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


189 
g‘C”tsBy‹s
();

198 
public
 
fš®
 
şass
 
S™eCÚfigu¿tiÚMsg
 
ex‹nds


199 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


201 
	gS™eCÚfigu¿tiÚMsgOrBud”
 {

203 
´iv©e
 
S™eCÚfigu¿tiÚMsg
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

204 
su³r
(
bud”
);

206 
´iv©e
 
S™eCÚfigu¿tiÚMsg
() {

207 
	g•och_
 = 0L;

208 
	gv”siÚ_
 = 0L;

209 
	gs™e_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

210 
	gãd”©iÚId_
 = "";

211 
	gû¹s_
 = "";

214 @
	gjava
.
	gÏng
.
Ov”ride


215 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


216 
g‘UnknownF›lds
() {

217  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

219 
´iv©e
 
S™eCÚfigu¿tiÚMsg
(

220 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

221 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

222 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

223 
this
();

224 
	gmubË_b™F›ld0_
 = 0;

225 
	gŒy
 {

226 
boŞ—n
 
	gdÚe
 = 
çl£
;

227 !
	gdÚe
) {

228 
	gg
 = 
šput
.
»adTag
();

229 
	gg
) {

231 
dÚe
 = 
Œue
;

234 ià(!
šput
.
skF›ld
(
g
)) {

235 
dÚe
 = 
Œue
;

241 
•och_
 = 
šput
.
»adUIÁ64
();

246 
v”siÚ_
 = 
šput
.
»adUIÁ64
();

250 ià(!((
mubË_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

251 
s™e_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
>();

252 
	gmubË_b™F›ld0_
 |= 0x00000004;

254 
	gs™e_
.
add
(

255 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
·r£r
(), 
ex‹nsiÚRegi¡ry
));

259 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

261 
	gãd”©iÚId_
 = 
s
;

265 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

267 
	gû¹s_
 = 
s
;

272 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

273 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

274 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

275 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

276 
e
).
£tUnfšishedMes§ge
(
this
);

277 } 
	gfš®ly
 {

278 ià(((
	gmubË_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

279 
s™e_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(site_);

281 
makeEx‹nsiÚsImmubË
();

284 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


285 
g‘DesütÜ
() {

286  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_desütÜ
;

289 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


290 
š‹º®G‘F›ldAcûssÜTabË
() {

291  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_f›ldAcûssÜTabË


292 .
’su»F›ldAcûssÜsIn™Ÿlized
(

293 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
.
şass
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.S™eCÚfigu¿tiÚMsg.
Bud”
.class);

296 
´iv©e
 
	gb™F›ld0_
;

297 
public
 
fš®
 
	gEPOCH_FIELD_NUMBER
 = 1;

298 
´iv©e
 
	g•och_
;

302 
public
 
g‘Epoch
() {

303  
	g•och_
;

306 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 2;

307 
´iv©e
 
	gv”siÚ_
;

311 
public
 
g‘V”siÚ
() {

312  
	gv”siÚ_
;

315 
public
 
fš®
 
	gSITE_FIELD_NUMBER
 = 3;

316 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
> 
	gs™e_
;

320 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
> 
g‘S™eLi¡
() {

321  
	gs™e_
;

326 
public
 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsgOrBud”
>

327 
g‘S™eOrBud”Li¡
() {

328  
	gs™e_
;

333 
public
 
g‘S™eCouÁ
() {

334  
	gs™e_
.
size
();

339 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
g‘S™e
(
šdex
) {

340  
	gs™e_
.
g‘
(
šdex
);

345 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsgOrBud”
 
g‘S™eOrBud”
(

346 
šdex
) {

347  
	gs™e_
.
g‘
(
šdex
);

350 
public
 
fš®
 
	gFEDERATION_ID_FIELD_NUMBER
 = 4;

351 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gãd”©iÚId_
;

355 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Fed”©iÚId
() {

356 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ãd”©iÚId_
;

357 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

358  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

360 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

361 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

362 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

363 
	gãd”©iÚId_
 = 
s
;

364  
	gs
;

370 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


371 
g‘Fed”©iÚIdBy‹s
() {

372 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ãd”©iÚId_
;

373 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

374 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

375 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

376 (
java
.
Ïng
.
SŒšg
è
»f
);

377 
	gãd”©iÚId_
 = 
b
;

378  
	gb
;

380  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

384 
public
 
fš®
 
	gCERTS_FIELD_NUMBER
 = 5;

385 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gû¹s_
;

389 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C”ts
() {

390 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹s_
;

391 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

392  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

394 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

395 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

396 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

397 
	gû¹s_
 = 
s
;

398  
	gs
;

404 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


405 
g‘C”tsBy‹s
() {

406 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹s_
;

407 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

408 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

409 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

410 (
java
.
Ïng
.
SŒšg
è
»f
);

411 
	gû¹s_
 = 
b
;

412  
	gb
;

414  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

418 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

419 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

420 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

421 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

422 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

424 
	gmemoizedIsIn™Ÿlized
 = 1;

425  
	gŒue
;

428 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

429 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

430 ià(
	g•och_
 != 0L) {

431 
ouut
.
wr™eUIÁ64
(1, 
•och_
);

433 ià(
	gv”siÚ_
 != 0L) {

434 
ouut
.
wr™eUIÁ64
(2, 
v”siÚ_
);

436 
	gi
 = 0; i < 
	gs™e_
.
size
(); i++) {

437 
	gouut
.
wr™eMes§ge
(3, 
s™e_
.
g‘
(
i
));

439 ià(!
g‘Fed”©iÚIdBy‹s
().
isEm±y
()) {

440 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 4, 
ãd”©iÚId_
);

442 ià(!
g‘C”tsBy‹s
().
isEm±y
()) {

443 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 5, 
û¹s_
);

447 
public
 
g‘S”ŸlizedSize
() {

448 
	gsize
 = 
memoizedSize
;

449 ià(
	gsize
 !ğ-1è 
size
;

451 
	gsize
 = 0;

452 ià(
	g•och_
 != 0L) {

453 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


454 .
compu‹UIÁ64Size
(1, 
•och_
);

456 ià(
	gv”siÚ_
 != 0L) {

457 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


458 .
compu‹UIÁ64Size
(2, 
v”siÚ_
);

460 
	gi
 = 0; i < 
	gs™e_
.
size
(); i++) {

461 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


462 .
compu‹Mes§geSize
(3, 
s™e_
.
g‘
(
i
));

464 ià(!
g‘Fed”©iÚIdBy‹s
().
isEm±y
()) {

465 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(4, 
ãd”©iÚId_
);

467 ià(!
g‘C”tsBy‹s
().
isEm±y
()) {

468 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(5, 
û¹s_
);

470 
	gmemoizedSize
 = 
size
;

471  
	gsize
;

474 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

475 @
	gjava
.
	gÏng
.
Ov”ride


476 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

477 ià(
	gobj
 =ğ
this
) {

478  
Œue
;

480 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
)) {

481  
	gsu³r
.
equ®s
(
obj
);

483 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
	gÙh”
 = (
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.S™eCÚfigu¿tiÚMsgè
obj
;

485 
boŞ—n
 
	g»suÉ
 = 
Œue
;

486 
	g»suÉ
 = 
»suÉ
 && (
g‘Epoch
()

487 =ğ
Ùh”
.
g‘Epoch
());

488 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

489 =ğ
Ùh”
.
g‘V”siÚ
());

490 
	g»suÉ
 = 
»suÉ
 && 
g‘S™eLi¡
()

491 .
equ®s
(
Ùh”
.
g‘S™eLi¡
());

492 
	g»suÉ
 = 
»suÉ
 && 
g‘Fed”©iÚId
()

493 .
equ®s
(
Ùh”
.
g‘Fed”©iÚId
());

494 
	g»suÉ
 = 
»suÉ
 && 
g‘C”ts
()

495 .
equ®s
(
Ùh”
.
g‘C”ts
());

496  
	g»suÉ
;

499 @
	gjava
.
	gÏng
.
Ov”ride


500 
public
 
hashCode
() {

501 ià(
	gmemoizedHashCode
 != 0) {

502  
memoizedHashCode
;

504 
	ghash
 = 41;

505 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

506 
	ghash
 = (37 * 
hash
è+ 
EPOCH_FIELD_NUMBER
;

507 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

508 
g‘Epoch
());

509 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

510 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

511 
g‘V”siÚ
());

512 ià(
g‘S™eCouÁ
() > 0) {

513 
	ghash
 = (37 * 
hash
è+ 
SITE_FIELD_NUMBER
;

514 
	ghash
 = (53 * 
hash
è+ 
g‘S™eLi¡
().
hashCode
();

516 
	ghash
 = (37 * 
hash
è+ 
FEDERATION_ID_FIELD_NUMBER
;

517 
	ghash
 = (53 * 
hash
è+ 
g‘Fed”©iÚId
().
hashCode
();

518 
	ghash
 = (37 * 
hash
è+ 
CERTS_FIELD_NUMBER
;

519 
	ghash
 = (53 * 
hash
è+ 
g‘C”ts
().
hashCode
();

520 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

521 
	gmemoizedHashCode
 = 
hash
;

522  
	ghash
;

525 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(

526 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

527 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

528  
	gPARSER
.
·r£From
(
d©a
);

530 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(

531 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

532 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

533 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

534  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

536 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(
by‹
[] 
d©a
)

537 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

538  
	gPARSER
.
·r£From
(
d©a
);

540 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(

541 
by‹
[] 
d©a
,

542 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

543 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

544  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

546 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

547 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

548  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


549 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

551 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(

552 
java
.
io
.
IÅutSŒ—m
 
šput
,

553 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

554 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

555  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


556 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

558 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

559 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

560  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


561 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

563 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£D–im™edFrom
(

564 
java
.
io
.
IÅutSŒ—m
 
šput
,

565 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

566 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

567  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


568 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

570 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(

571 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

572 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

573  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


574 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

576 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
·r£From
(

577 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

578 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

579 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

580  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


581 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

584 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

585 
public
 
Bud”
 
ÃwBud”
() {

586  
	gDEFAULT_INSTANCE
.
toBud”
();

588 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
´ÙÙy³
) {

589  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

591 
public
 
Bud”
 
toBud”
() {

592  
	gthis
 =ğ
DEFAULT_INSTANCE


593 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

596 @
	gjava
.
	gÏng
.
Ov”ride


597 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

598 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

599 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

600  
	gbud”
;

609 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


610 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


612 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsgOrBud”
 {

613 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


614 
g‘DesütÜ
() {

615  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_desütÜ
;

618 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


619 
š‹º®G‘F›ldAcûssÜTabË
() {

620  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_f›ldAcûssÜTabË


621 .
’su»F›ldAcûssÜsIn™Ÿlized
(

622 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
.
şass
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.S™eCÚfigu¿tiÚMsg.
Bud”
.class);

626 
´iv©e
 
Bud”
() {

627 
maybeFÜûBud”In™Ÿliz©iÚ
();

630 
´iv©e
 
Bud”
(

631 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

632 
su³r
(
·»Á
);

633 
maybeFÜûBud”In™Ÿliz©iÚ
();

635 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

636 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


637 .
	g®waysU£F›ldBud”s
) {

638 
g‘S™eF›ldBud”
();

641 
public
 
Bud”
 
ş—r
() {

642 
	gsu³r
.
ş—r
();

643 
	g•och_
 = 0L;

645 
	gv”siÚ_
 = 0L;

647 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

648 
s™e_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

649 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

651 
	gs™eBud”_
.
ş—r
();

653 
	gãd”©iÚId_
 = "";

655 
	gû¹s_
 = "";

657  
	gthis
;

660 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


661 
g‘DesütÜFÜTy³
() {

662  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_desütÜ
;

665 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

666  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
.
g‘DeçuÉIn¡ªû
();

669 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
bud
() {

670 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
	g»suÉ
 = 
budP¬tŸl
();

671 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

672 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

674  
	g»suÉ
;

677 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
budP¬tŸl
() {

678 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.S™eCÚfigu¿tiÚMsg(
this
);

679 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

680 
	gto_b™F›ld0_
 = 0;

681 
	g»suÉ
.
	g•och_
 = 
•och_
;

682 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

683 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

684 ià(((
b™F›ld0_
 & 0x00000004) == 0x00000004)) {

685 
s™e_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(site_);

686 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

688 
	g»suÉ
.
	gs™e_
 = 
s™e_
;

690 
	g»suÉ
.
	gs™e_
 = 
s™eBud”_
.
bud
();

692 
	g»suÉ
.
	gãd”©iÚId_
 = 
ãd”©iÚId_
;

693 
	g»suÉ
.
	gû¹s_
 = 
û¹s_
;

694 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

695 
ÚBut
();

696  
	g»suÉ
;

699 
public
 
Bud”
 
şÚe
() {

700  (
	gBud”
è
	gsu³r
.
şÚe
();

702 
public
 
Bud”
 
£tF›ld
(

703 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

704 
Objeù
 
v®ue
) {

705  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

707 
public
 
Bud”
 
ş—rF›ld
(

708 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

709  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

711 
public
 
Bud”
 
ş—rOÃof
(

712 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

713  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

715 
public
 
Bud”
 
£tR•—‹dF›ld
(

716 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

717 
šdex
, 
Objeù
 
v®ue
) {

718  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

720 
public
 
Bud”
 
addR•—‹dF›ld
(

721 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

722 
Objeù
 
v®ue
) {

723  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

725 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

726 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eCÚfigu¿tiÚMsg
) {

727  
m”geFrom
((
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
)
Ùh”
);

729 
	gsu³r
.
m”geFrom
(
Ùh”
);

730  
	gthis
;

734 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
Ùh”
) {

735 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
.
g‘DeçuÉIn¡ªû
()è 
this
;

736 ià(
	gÙh”
.
g‘Epoch
() != 0L) {

737 
£tEpoch
(
Ùh”
.
g‘Epoch
());

739 ià(
	gÙh”
.
g‘V”siÚ
() != 0L) {

740 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

742 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

743 ià(!
Ùh”
.
s™e_
.
isEm±y
()) {

744 ià(
s™e_
.
isEm±y
()) {

745 
s™e_
 = 
Ùh”
.site_;

746 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

748 
’su»S™eIsMubË
();

749 
	gs™e_
.
addAÎ
(
Ùh”
.
s™e_
);

751 
ÚChªged
();

754 ià(!
	gÙh”
.
	gs™e_
.
isEm±y
()) {

755 ià(
	gs™eBud”_
.
isEm±y
()) {

756 
	gs™eBud”_
.
di¥o£
();

757 
	gs™eBud”_
 = 
nuÎ
;

758 
	gs™e_
 = 
Ùh”
.
s™e_
;

759 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

760 
	gs™eBud”_
 =

761 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
®waysU£F›ldBud”s
 ?

762 
g‘S™eF›ldBud”
(è: 
nuÎ
;

764 
	gs™eBud”_
.
addAÎMes§ges
(
Ùh”
.
s™e_
);

768 ià(!
	gÙh”
.
g‘Fed”©iÚId
().
isEm±y
()) {

769 
	gãd”©iÚId_
 = 
Ùh”
.
ãd”©iÚId_
;

770 
ÚChªged
();

772 ià(!
	gÙh”
.
g‘C”ts
().
isEm±y
()) {

773 
	gû¹s_
 = 
Ùh”
.
û¹s_
;

774 
ÚChªged
();

776 
ÚChªged
();

777  
	gthis
;

780 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

781  
	gŒue
;

784 
public
 
Bud”
 
m”geFrom
(

785 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

786 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

787 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

788 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
	g·r£dMes§ge
 = 
nuÎ
;

789 
	gŒy
 {

790 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

791 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

792 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
è
e
.
g‘UnfšishedMes§ge
();

793 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

794 } 
	gfš®ly
 {

795 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

796 
m”geFrom
(
·r£dMes§ge
);

799  
	gthis
;

801 
´iv©e
 
	gb™F›ld0_
;

803 
´iv©e
 
	g•och_
 ;

807 
public
 
g‘Epoch
() {

808  
	g•och_
;

813 
public
 
Bud”
 
£tEpoch
(
v®ue
) {

815 
	g•och_
 = 
v®ue
;

816 
ÚChªged
();

817  
	gthis
;

822 
public
 
Bud”
 
ş—rEpoch
() {

824 
	g•och_
 = 0L;

825 
ÚChªged
();

826  
	gthis
;

829 
´iv©e
 
	gv”siÚ_
 ;

833 
public
 
g‘V”siÚ
() {

834  
	gv”siÚ_
;

839 
public
 
Bud”
 
£tV”siÚ
(
v®ue
) {

841 
	gv”siÚ_
 = 
v®ue
;

842 
ÚChªged
();

843  
	gthis
;

848 
public
 
Bud”
 
ş—rV”siÚ
() {

850 
	gv”siÚ_
 = 0L;

851 
ÚChªged
();

852  
	gthis
;

855 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
> 
	gs™e_
 =

856 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

857 
´iv©e
 
’su»S™eIsMubË
() {

858 ià(!((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

859 
s™e_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
>(site_);

860 
	gb™F›ld0_
 |= 0x00000004;

864 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gR•—‹dF›ldBud”V3
<

865 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.S™eMsg.
	gBud”
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.
	gS™eMsgOrBud”
> 
	gs™eBud”_
;

870 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
> 
g‘S™eLi¡
() {

871 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

872  
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(
s™e_
);

874  
	gs™eBud”_
.
g‘Mes§geLi¡
();

880 
public
 
g‘S™eCouÁ
() {

881 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

882  
s™e_
.
size
();

884  
	gs™eBud”_
.
g‘CouÁ
();

890 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
g‘S™e
(
šdex
) {

891 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

892  
s™e_
.
g‘
(
šdex
);

894  
	gs™eBud”_
.
g‘Mes§ge
(
šdex
);

900 
public
 
Bud”
 
£tS™e
(

901 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
 
v®ue
) {

902 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

903 ià(
v®ue
 =ğ
nuÎ
) {

904 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

906 
’su»S™eIsMubË
();

907 
	gs™e_
.
£t
(
šdex
, 
v®ue
);

908 
ÚChªged
();

910 
	gs™eBud”_
.
£tMes§ge
(
šdex
, 
v®ue
);

912  
	gthis
;

917 
public
 
Bud”
 
£tS™e
(

918 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
Bud”
 
bud”FÜV®ue
) {

919 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

920 
’su»S™eIsMubË
();

921 
	gs™e_
.
£t
(
šdex
, 
bud”FÜV®ue
.
bud
());

922 
ÚChªged
();

924 
	gs™eBud”_
.
£tMes§ge
(
šdex
, 
bud”FÜV®ue
.
bud
());

926  
	gthis
;

931 
public
 
Bud”
 
addS™e
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
 
v®ue
) {

932 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

933 ià(
v®ue
 =ğ
nuÎ
) {

934 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

936 
’su»S™eIsMubË
();

937 
	gs™e_
.
add
(
v®ue
);

938 
ÚChªged
();

940 
	gs™eBud”_
.
addMes§ge
(
v®ue
);

942  
	gthis
;

947 
public
 
Bud”
 
addS™e
(

948 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
 
v®ue
) {

949 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

950 ià(
v®ue
 =ğ
nuÎ
) {

951 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

953 
’su»S™eIsMubË
();

954 
	gs™e_
.
add
(
šdex
, 
v®ue
);

955 
ÚChªged
();

957 
	gs™eBud”_
.
addMes§ge
(
šdex
, 
v®ue
);

959  
	gthis
;

964 
public
 
Bud”
 
addS™e
(

965 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
Bud”
 
bud”FÜV®ue
) {

966 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

967 
’su»S™eIsMubË
();

968 
	gs™e_
.
add
(
bud”FÜV®ue
.
bud
());

969 
ÚChªged
();

971 
	gs™eBud”_
.
addMes§ge
(
bud”FÜV®ue
.
bud
());

973  
	gthis
;

978 
public
 
Bud”
 
addS™e
(

979 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
Bud”
 
bud”FÜV®ue
) {

980 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

981 
’su»S™eIsMubË
();

982 
	gs™e_
.
add
(
šdex
, 
bud”FÜV®ue
.
bud
());

983 
ÚChªged
();

985 
	gs™eBud”_
.
addMes§ge
(
šdex
, 
bud”FÜV®ue
.
bud
());

987  
	gthis
;

992 
public
 
Bud”
 
addAÎS™e
(

993 
java
.
Ïng
.
I‹¿bË
<? 
ex‹nds
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
> 
v®ues
) {

994 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

995 
’su»S™eIsMubË
();

996 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAb¡¿ùMes§geL™e
.
	gBud”
.
addAÎ
(

997 
v®ues
, 
s™e_
);

998 
ÚChªged
();

1000 
	gs™eBud”_
.
addAÎMes§ges
(
v®ues
);

1002  
	gthis
;

1007 
public
 
Bud”
 
ş—rS™e
() {

1008 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

1009 
s™e_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

1010 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1011 
ÚChªged
();

1013 
	gs™eBud”_
.
ş—r
();

1015  
	gthis
;

1020 
public
 
Bud”
 
»moveS™e
(
šdex
) {

1021 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

1022 
’su»S™eIsMubË
();

1023 
	gs™e_
.
»move
(
šdex
);

1024 
ÚChªged
();

1026 
	gs™eBud”_
.
»move
(
šdex
);

1028  
	gthis
;

1033 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
.
Bud”
 
g‘S™eBud”
(

1034 
šdex
) {

1035  
g‘S™eF›ldBud”
().
g‘Bud”
(
šdex
);

1040 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsgOrBud”
 
g‘S™eOrBud”
(

1041 
šdex
) {

1042 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

1043  
s™e_
.
g‘
(
šdex
); } {

1044  
	gs™eBud”_
.
g‘Mes§geOrBud”
(
šdex
);

1050 
public
 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsgOrBud”
>

1051 
g‘S™eOrBud”Li¡
() {

1052 ià(
	gs™eBud”_
 !ğ
nuÎ
) {

1053  
s™eBud”_
.
g‘Mes§geOrBud”Li¡
();

1055  
	gjava
.
	gut
.
	gCŞËùiÚs
.
unmodifŸbËLi¡
(
s™e_
);

1061 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
.
Bud”
 
addS™eBud”
() {

1062  
g‘S™eF›ldBud”
().
addBud”
(

1063 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
g‘DeçuÉIn¡ªû
());

1068 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
.
Bud”
 
addS™eBud”
(

1069 
šdex
) {

1070  
g‘S™eF›ldBud”
().
addBud”
(

1071 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
g‘DeçuÉIn¡ªû
());

1076 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
.
	gBud”
>

1077 
g‘S™eBud”Li¡
() {

1078  
g‘S™eF›ldBud”
().
g‘Bud”Li¡
();

1080 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gR•—‹dF›ldBud”V3
<

1081 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.S™eMsg.
	gBud”
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.
	gS™eMsgOrBud”
>

1082 
g‘S™eF›ldBud”
() {

1083 ià(
	gs™eBud”_
 =ğ
nuÎ
) {

1084 
s™eBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
R•—‹dF›ldBud”V3
<

1085 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
, 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
.
	gBud”
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.
	gS™eMsgOrBud”
>(

1086 
	gs™e_
,

1087 ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004),

1088 
g‘P¬’tFÜChd»n
(),

1089 
isCËª
());

1090 
	gs™e_
 = 
nuÎ
;

1092  
	gs™eBud”_
;

1095 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gãd”©iÚId_
 = "";

1099 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Fed”©iÚId
() {

1100 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ãd”©iÚId_
;

1101 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

1102 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1103 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1104 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1105 
	gãd”©iÚId_
 = 
s
;

1106  
	gs
;

1108  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1114 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1115 
g‘Fed”©iÚIdBy‹s
() {

1116 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ãd”©iÚId_
;

1117 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1118 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1119 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1120 (
java
.
Ïng
.
SŒšg
è
»f
);

1121 
	gãd”©iÚId_
 = 
b
;

1122  
	gb
;

1124  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1130 
public
 
Bud”
 
£tFed”©iÚId
(

1131 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1132 ià(
	gv®ue
 =ğ
nuÎ
) {

1133 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1136 
	gãd”©iÚId_
 = 
v®ue
;

1137 
ÚChªged
();

1138  
	gthis
;

1143 
public
 
Bud”
 
ş—rFed”©iÚId
() {

1145 
	gãd”©iÚId_
 = 
g‘DeçuÉIn¡ªû
().
g‘Fed”©iÚId
();

1146 
ÚChªged
();

1147  
	gthis
;

1152 
public
 
Bud”
 
£tFed”©iÚIdBy‹s
(

1153 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1154 ià(
	gv®ue
 =ğ
nuÎ
) {

1155 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1157 
checkBy‹SŒšgIsUtf8
(
v®ue
);

1159 
	gãd”©iÚId_
 = 
v®ue
;

1160 
ÚChªged
();

1161  
	gthis
;

1164 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gû¹s_
 = "";

1168 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C”ts
() {

1169 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹s_
;

1170 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

1171 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1172 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1173 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1174 
	gû¹s_
 = 
s
;

1175  
	gs
;

1177  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1183 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1184 
g‘C”tsBy‹s
() {

1185 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹s_
;

1186 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1187 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1188 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1189 (
java
.
Ïng
.
SŒšg
è
»f
);

1190 
	gû¹s_
 = 
b
;

1191  
	gb
;

1193  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1199 
public
 
Bud”
 
£tC”ts
(

1200 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1201 ià(
	gv®ue
 =ğ
nuÎ
) {

1202 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1205 
	gû¹s_
 = 
v®ue
;

1206 
ÚChªged
();

1207  
	gthis
;

1212 
public
 
Bud”
 
ş—rC”ts
() {

1214 
	gû¹s_
 = 
g‘DeçuÉIn¡ªû
().
g‘C”ts
();

1215 
ÚChªged
();

1216  
	gthis
;

1221 
public
 
Bud”
 
£tC”tsBy‹s
(

1222 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1223 ià(
	gv®ue
 =ğ
nuÎ
) {

1224 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1226 
checkBy‹SŒšgIsUtf8
(
v®ue
);

1228 
	gû¹s_
 = 
v®ue
;

1229 
ÚChªged
();

1230  
	gthis
;

1232 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1233 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1234  
	gthis
;

1237 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1238 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1239  
	gthis
;

1247 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
	gDEFAULT_INSTANCE
;

1249 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
();

1252 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
g‘DeçuÉIn¡ªû
() {

1253  
	gDEFAULT_INSTANCE
;

1256 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gS™eCÚfigu¿tiÚMsg
>

1257 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
S™eCÚfigu¿tiÚMsg
>() {

1258 
public
 
S™eCÚfigu¿tiÚMsg
 
·r£P¬tŸlFrom
(

1259 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1260 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1261 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1262  
Ãw
 
S™eCÚfigu¿tiÚMsg
(
šput
, 
ex‹nsiÚRegi¡ry
);

1266 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gS™eCÚfigu¿tiÚMsg
> 
·r£r
() {

1267  
	gPARSER
;

1270 @
	gjava
.
	gÏng
.
Ov”ride


1271 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gS™eCÚfigu¿tiÚMsg
> 
g‘P¬£rFÜTy³
() {

1272  
	gPARSER
;

1275 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eCÚfigu¿tiÚMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1276  
	gDEFAULT_INSTANCE
;

1281 
public
 
š‹rçû
 
S™eMsgOrBud”
 
ex‹nds


1283 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1288 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
();

1292 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1293 
g‘NameBy‹s
();

1298 
g‘GmStusV®ue
();

1302 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
 
g‘GmStus
();

1307 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
>

1308 
g‘AphLi¡
();

1312 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
g‘Aph
(
šdex
);

1316 
g‘AphCouÁ
();

1320 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsgOrBud”
>

1321 
g‘AphOrBud”Li¡
();

1325 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsgOrBud”
 
g‘AphOrBud”
(

1326 
šdex
);

1331 
boŞ—n
 
g‘IsLoÿl
();

1336 
	gjava
.
	gÏng
.
SŒšg
 
g‘Id
();

1340 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1341 
g‘IdBy‹s
();

1346 
g‘Sy¡emId
();

1351 
boŞ—n
 
g‘IsFed”©ed
();

1356 
	gjava
.
	gÏng
.
SŒšg
 
g‘S™eV”siÚ
();

1360 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1361 
g‘S™eV”siÚBy‹s
();

1366 
	gjava
.
	gÏng
.
SŒšg
 
g‘VIp
();

1370 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1371 
g‘VIpBy‹s
();

1376 
	gjava
.
	gÏng
.
SŒšg
 
g‘NodeTy³
();

1380 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1381 
g‘NodeTy³By‹s
();

1386 
g‘V”siÚ
();

1395 
public
 
fš®
 
şass
 
S™eMsg
 
ex‹nds


1396 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1398 
	gS™eMsgOrBud”
 {

1400 
´iv©e
 
S™eMsg
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1401 
su³r
(
bud”
);

1403 
´iv©e
 
S™eMsg
() {

1404 
	gÇme_
 = "";

1405 
	ggmStus_
 = 0;

1406 
	g­h_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

1407 
	gisLoÿl_
 = 
çl£
;

1408 
	gid_
 = "";

1409 
	gsy¡emId_
 = 0;

1410 
	gisFed”©ed_
 = 
çl£
;

1411 
	gs™eV”siÚ_
 = "";

1412 
	gvIp_
 = "";

1413 
	gnodeTy³_
 = "";

1414 
	gv”siÚ_
 = 0L;

1417 @
	gjava
.
	gÏng
.
Ov”ride


1418 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1419 
g‘UnknownF›lds
() {

1420  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

1422 
´iv©e
 
S™eMsg
(

1423 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1424 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1425 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1426 
this
();

1427 
	gmubË_b™F›ld0_
 = 0;

1428 
	gŒy
 {

1429 
boŞ—n
 
	gdÚe
 = 
çl£
;

1430 !
	gdÚe
) {

1431 
	gg
 = 
šput
.
»adTag
();

1432 
	gg
) {

1434 
dÚe
 = 
Œue
;

1437 ià(!
šput
.
skF›ld
(
g
)) {

1438 
dÚe
 = 
Œue
;

1443 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

1445 
	gÇme_
 = 
s
;

1449 
¿wV®ue
 = 
šput
.
»adEnum
();

1451 
	ggmStus_
 = 
¿wV®ue
;

1455 ià(!((
mubË_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

1456 
­h_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
>();

1457 
	gmubË_b™F›ld0_
 |= 0x00000004;

1459 
	g­h_
.
add
(

1460 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
·r£r
(), 
ex‹nsiÚRegi¡ry
));

1465 
isLoÿl_
 = 
šput
.
»adBoŞ
();

1469 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

1471 
	gid_
 = 
s
;

1476 
sy¡emId_
 = 
šput
.
»adIÁ32
();

1481 
isFed”©ed_
 = 
šput
.
»adBoŞ
();

1485 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

1487 
	gs™eV”siÚ_
 = 
s
;

1491 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

1493 
	gvIp_
 = 
s
;

1497 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

1499 
	gnodeTy³_
 = 
s
;

1504 
v”siÚ_
 = 
šput
.
»adUIÁ64
();

1509 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1510 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

1511 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

1512 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

1513 
e
).
£tUnfšishedMes§ge
(
this
);

1514 } 
	gfš®ly
 {

1515 ià(((
	gmubË_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

1516 
­h_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(aph_);

1518 
makeEx‹nsiÚsImmubË
();

1521 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1522 
g‘DesütÜ
() {

1523  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_desütÜ
;

1526 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1527 
š‹º®G‘F›ldAcûssÜTabË
() {

1528  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_f›ldAcûssÜTabË


1529 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1530 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
şass
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.S™eMsg.
Bud”
.class);

1533 
´iv©e
 
	gb™F›ld0_
;

1534 
public
 
fš®
 
	gNAME_FIELD_NUMBER
 = 1;

1535 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gÇme_
;

1539 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
() {

1540 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

1541 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1542  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1544 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1545 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1546 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1547 
	gÇme_
 = 
s
;

1548  
	gs
;

1554 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1555 
g‘NameBy‹s
() {

1556 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

1557 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1558 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1559 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1560 (
java
.
Ïng
.
SŒšg
è
»f
);

1561 
	gÇme_
 = 
b
;

1562  
	gb
;

1564  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1568 
public
 
fš®
 
	gGM_STATUS_FIELD_NUMBER
 = 2;

1569 
´iv©e
 
	ggmStus_
;

1573 
public
 
g‘GmStusV®ue
() {

1574  
	ggmStus_
;

1579 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
 
g‘GmStus
() {

1580 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
 
	g»suÉ
 = 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.Glob®Mªag”Stus.
v®ueOf
(
gmStus_
);

1581  
	g»suÉ
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
.
UNRECOGNIZED
 : 
»suÉ
;

1584 
public
 
fš®
 
	gAPH_FIELD_NUMBER
 = 3;

1585 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
> 
	g­h_
;

1589 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
> 
g‘AphLi¡
() {

1590  
	g­h_
;

1595 
public
 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsgOrBud”
>

1596 
g‘AphOrBud”Li¡
() {

1597  
	g­h_
;

1602 
public
 
g‘AphCouÁ
() {

1603  
	g­h_
.
size
();

1608 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
g‘Aph
(
šdex
) {

1609  
	g­h_
.
g‘
(
šdex
);

1614 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsgOrBud”
 
g‘AphOrBud”
(

1615 
šdex
) {

1616  
	g­h_
.
g‘
(
šdex
);

1619 
public
 
fš®
 
	gIS_LOCAL_FIELD_NUMBER
 = 4;

1620 
´iv©e
 
boŞ—n
 
	gisLoÿl_
;

1624 
public
 
boŞ—n
 
g‘IsLoÿl
() {

1625  
	gisLoÿl_
;

1628 
public
 
fš®
 
	gID_FIELD_NUMBER
 = 5;

1629 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gid_
;

1633 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Id
() {

1634 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
id_
;

1635 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1636  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1638 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1639 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1640 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1641 
	gid_
 = 
s
;

1642  
	gs
;

1648 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1649 
g‘IdBy‹s
() {

1650 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
id_
;

1651 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1652 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1653 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1654 (
java
.
Ïng
.
SŒšg
è
»f
);

1655 
	gid_
 = 
b
;

1656  
	gb
;

1658  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1662 
public
 
fš®
 
	gSYSTEM_ID_FIELD_NUMBER
 = 6;

1663 
´iv©e
 
	gsy¡emId_
;

1667 
public
 
g‘Sy¡emId
() {

1668  
	gsy¡emId_
;

1671 
public
 
fš®
 
	gIS_FEDERATED_FIELD_NUMBER
 = 7;

1672 
´iv©e
 
boŞ—n
 
	gisFed”©ed_
;

1676 
public
 
boŞ—n
 
g‘IsFed”©ed
() {

1677  
	gisFed”©ed_
;

1680 
public
 
fš®
 
	gSITE_VERSION_FIELD_NUMBER
 = 8;

1681 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gs™eV”siÚ_
;

1685 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘S™eV”siÚ
() {

1686 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
s™eV”siÚ_
;

1687 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1688  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1690 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1691 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1692 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1693 
	gs™eV”siÚ_
 = 
s
;

1694  
	gs
;

1700 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1701 
g‘S™eV”siÚBy‹s
() {

1702 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
s™eV”siÚ_
;

1703 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1704 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1705 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1706 (
java
.
Ïng
.
SŒšg
è
»f
);

1707 
	gs™eV”siÚ_
 = 
b
;

1708  
	gb
;

1710  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1714 
public
 
fš®
 
	gVIP_IP_FIELD_NUMBER
 = 9;

1715 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gvIp_
;

1719 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘VIp
() {

1720 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
vIp_
;

1721 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1722  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1724 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1725 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1726 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1727 
	gvIp_
 = 
s
;

1728  
	gs
;

1734 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1735 
g‘VIpBy‹s
() {

1736 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
vIp_
;

1737 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1738 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1739 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1740 (
java
.
Ïng
.
SŒšg
è
»f
);

1741 
	gvIp_
 = 
b
;

1742  
	gb
;

1744  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1748 
public
 
fš®
 
	gNODE_TYPE_FIELD_NUMBER
 = 10;

1749 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gnodeTy³_
;

1753 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘NodeTy³
() {

1754 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeTy³_
;

1755 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1756  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1758 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1759 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1760 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1761 
	gnodeTy³_
 = 
s
;

1762  
	gs
;

1768 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1769 
g‘NodeTy³By‹s
() {

1770 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeTy³_
;

1771 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1772 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1773 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1774 (
java
.
Ïng
.
SŒšg
è
»f
);

1775 
	gnodeTy³_
 = 
b
;

1776  
	gb
;

1778  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1782 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 11;

1783 
´iv©e
 
	gv”siÚ_
;

1787 
public
 
g‘V”siÚ
() {

1788  
	gv”siÚ_
;

1791 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

1792 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1793 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

1794 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

1795 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

1797 
	gmemoizedIsIn™Ÿlized
 = 1;

1798  
	gŒue
;

1801 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

1802 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1803 ià(!
g‘NameBy‹s
().
isEm±y
()) {

1804 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
Çme_
);

1806 ià(
	ggmStus_
 !ğ
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
.
INVALID
.
g‘Numb”
()) {

1807 
ouut
.
wr™eEnum
(2, 
gmStus_
);

1809 
	gi
 = 0; i < 
	g­h_
.
size
(); i++) {

1810 
	gouut
.
wr™eMes§ge
(3, 
­h_
.
g‘
(
i
));

1812 ià(
	gisLoÿl_
 !ğ
çl£
) {

1813 
ouut
.
wr™eBoŞ
(4, 
isLoÿl_
);

1815 ià(!
g‘IdBy‹s
().
isEm±y
()) {

1816 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 5, 
id_
);

1818 ià(
	gsy¡emId_
 != 0) {

1819 
ouut
.
wr™eIÁ32
(6, 
sy¡emId_
);

1821 ià(
	gisFed”©ed_
 !ğ
çl£
) {

1822 
ouut
.
wr™eBoŞ
(7, 
isFed”©ed_
);

1824 ià(!
g‘S™eV”siÚBy‹s
().
isEm±y
()) {

1825 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 8, 
s™eV”siÚ_
);

1827 ià(!
g‘VIpBy‹s
().
isEm±y
()) {

1828 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 9, 
vIp_
);

1830 ià(!
g‘NodeTy³By‹s
().
isEm±y
()) {

1831 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 10, 
nodeTy³_
);

1833 ià(
	gv”siÚ_
 != 0L) {

1834 
ouut
.
wr™eUIÁ64
(11, 
v”siÚ_
);

1838 
public
 
g‘S”ŸlizedSize
() {

1839 
	gsize
 = 
memoizedSize
;

1840 ià(
	gsize
 !ğ-1è 
size
;

1842 
	gsize
 = 0;

1843 ià(!
g‘NameBy‹s
().
isEm±y
()) {

1844 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
Çme_
);

1846 ià(
	ggmStus_
 !ğ
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
.
INVALID
.
g‘Numb”
()) {

1847 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1848 .
compu‹EnumSize
(2, 
gmStus_
);

1850 
	gi
 = 0; i < 
	g­h_
.
size
(); i++) {

1851 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1852 .
compu‹Mes§geSize
(3, 
­h_
.
g‘
(
i
));

1854 ià(
	gisLoÿl_
 !ğ
çl£
) {

1855 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1856 .
compu‹BoŞSize
(4, 
isLoÿl_
);

1858 ià(!
g‘IdBy‹s
().
isEm±y
()) {

1859 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(5, 
id_
);

1861 ià(
	gsy¡emId_
 != 0) {

1862 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1863 .
compu‹IÁ32Size
(6, 
sy¡emId_
);

1865 ià(
	gisFed”©ed_
 !ğ
çl£
) {

1866 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1867 .
compu‹BoŞSize
(7, 
isFed”©ed_
);

1869 ià(!
g‘S™eV”siÚBy‹s
().
isEm±y
()) {

1870 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(8, 
s™eV”siÚ_
);

1872 ià(!
g‘VIpBy‹s
().
isEm±y
()) {

1873 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(9, 
vIp_
);

1875 ià(!
g‘NodeTy³By‹s
().
isEm±y
()) {

1876 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(10, 
nodeTy³_
);

1878 ià(
	gv”siÚ_
 != 0L) {

1879 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1880 .
compu‹UIÁ64Size
(11, 
v”siÚ_
);

1882 
	gmemoizedSize
 = 
size
;

1883  
	gsize
;

1886 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

1887 @
	gjava
.
	gÏng
.
Ov”ride


1888 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

1889 ià(
	gobj
 =ğ
this
) {

1890  
Œue
;

1892 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
)) {

1893  
	gsu³r
.
equ®s
(
obj
);

1895 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
	gÙh”
 = (
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.S™eMsgè
obj
;

1897 
boŞ—n
 
	g»suÉ
 = 
Œue
;

1898 
	g»suÉ
 = 
»suÉ
 && 
g‘Name
()

1899 .
equ®s
(
Ùh”
.
g‘Name
());

1900 
	g»suÉ
 = 
»suÉ
 && 
gmStus_
 =ğ
Ùh”
.gmStatus_;

1901 
	g»suÉ
 = 
»suÉ
 && 
g‘AphLi¡
()

1902 .
equ®s
(
Ùh”
.
g‘AphLi¡
());

1903 
	g»suÉ
 = 
»suÉ
 && (
g‘IsLoÿl
()

1904 =ğ
Ùh”
.
g‘IsLoÿl
());

1905 
	g»suÉ
 = 
»suÉ
 && 
g‘Id
()

1906 .
equ®s
(
Ùh”
.
g‘Id
());

1907 
	g»suÉ
 = 
»suÉ
 && (
g‘Sy¡emId
()

1908 =ğ
Ùh”
.
g‘Sy¡emId
());

1909 
	g»suÉ
 = 
»suÉ
 && (
g‘IsFed”©ed
()

1910 =ğ
Ùh”
.
g‘IsFed”©ed
());

1911 
	g»suÉ
 = 
»suÉ
 && 
g‘S™eV”siÚ
()

1912 .
equ®s
(
Ùh”
.
g‘S™eV”siÚ
());

1913 
	g»suÉ
 = 
»suÉ
 && 
g‘VIp
()

1914 .
equ®s
(
Ùh”
.
g‘VIp
());

1915 
	g»suÉ
 = 
»suÉ
 && 
g‘NodeTy³
()

1916 .
equ®s
(
Ùh”
.
g‘NodeTy³
());

1917 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

1918 =ğ
Ùh”
.
g‘V”siÚ
());

1919  
	g»suÉ
;

1922 @
	gjava
.
	gÏng
.
Ov”ride


1923 
public
 
hashCode
() {

1924 ià(
	gmemoizedHashCode
 != 0) {

1925  
memoizedHashCode
;

1927 
	ghash
 = 41;

1928 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

1929 
	ghash
 = (37 * 
hash
è+ 
NAME_FIELD_NUMBER
;

1930 
	ghash
 = (53 * 
hash
è+ 
g‘Name
().
hashCode
();

1931 
	ghash
 = (37 * 
hash
è+ 
GM_STATUS_FIELD_NUMBER
;

1932 
	ghash
 = (53 * 
hash
è+ 
gmStus_
;

1933 ià(
g‘AphCouÁ
() > 0) {

1934 
	ghash
 = (37 * 
hash
è+ 
APH_FIELD_NUMBER
;

1935 
	ghash
 = (53 * 
hash
è+ 
g‘AphLi¡
().
hashCode
();

1937 
	ghash
 = (37 * 
hash
è+ 
IS_LOCAL_FIELD_NUMBER
;

1938 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

1939 
g‘IsLoÿl
());

1940 
	ghash
 = (37 * 
hash
è+ 
ID_FIELD_NUMBER
;

1941 
	ghash
 = (53 * 
hash
è+ 
g‘Id
().
hashCode
();

1942 
	ghash
 = (37 * 
hash
è+ 
SYSTEM_ID_FIELD_NUMBER
;

1943 
	ghash
 = (53 * 
hash
è+ 
g‘Sy¡emId
();

1944 
	ghash
 = (37 * 
hash
è+ 
IS_FEDERATED_FIELD_NUMBER
;

1945 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

1946 
g‘IsFed”©ed
());

1947 
	ghash
 = (37 * 
hash
è+ 
SITE_VERSION_FIELD_NUMBER
;

1948 
	ghash
 = (53 * 
hash
è+ 
g‘S™eV”siÚ
().
hashCode
();

1949 
	ghash
 = (37 * 
hash
è+ 
VIP_IP_FIELD_NUMBER
;

1950 
	ghash
 = (53 * 
hash
è+ 
g‘VIp
().
hashCode
();

1951 
	ghash
 = (37 * 
hash
è+ 
NODE_TYPE_FIELD_NUMBER
;

1952 
	ghash
 = (53 * 
hash
è+ 
g‘NodeTy³
().
hashCode
();

1953 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

1954 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

1955 
g‘V”siÚ
());

1956 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

1957 
	gmemoizedHashCode
 = 
hash
;

1958  
	ghash
;

1961 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(

1962 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

1963 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1964  
	gPARSER
.
·r£From
(
d©a
);

1966 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(

1967 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

1968 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1969 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1970  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1972 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(
by‹
[] 
d©a
)

1973 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1974  
	gPARSER
.
·r£From
(
d©a
);

1976 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(

1977 
by‹
[] 
d©a
,

1978 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1979 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1980  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1982 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1983 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1984  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1985 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1987 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(

1988 
java
.
io
.
IÅutSŒ—m
 
šput
,

1989 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1990 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1991  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1992 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1994 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1995 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1996  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1997 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

1999 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£D–im™edFrom
(

2000 
java
.
io
.
IÅutSŒ—m
 
šput
,

2001 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2002 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2003  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2004 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2006 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(

2007 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2008 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2009  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2010 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2012 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
·r£From
(

2013 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2014 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2015 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2016  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2017 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2020 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2021 
public
 
Bud”
 
ÃwBud”
() {

2022  
	gDEFAULT_INSTANCE
.
toBud”
();

2024 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
 
´ÙÙy³
) {

2025  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2027 
public
 
Bud”
 
toBud”
() {

2028  
	gthis
 =ğ
DEFAULT_INSTANCE


2029 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2032 @
	gjava
.
	gÏng
.
Ov”ride


2033 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2034 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2035 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2036  
	gbud”
;

2045 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


2046 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


2048 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsgOrBud”
 {

2049 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2050 
g‘DesütÜ
() {

2051  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_desütÜ
;

2054 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2055 
š‹º®G‘F›ldAcûssÜTabË
() {

2056  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_f›ldAcûssÜTabË


2057 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2058 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
şass
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.S™eMsg.
Bud”
.class);

2062 
´iv©e
 
Bud”
() {

2063 
maybeFÜûBud”In™Ÿliz©iÚ
();

2066 
´iv©e
 
Bud”
(

2067 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2068 
su³r
(
·»Á
);

2069 
maybeFÜûBud”In™Ÿliz©iÚ
();

2071 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

2072 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2073 .
	g®waysU£F›ldBud”s
) {

2074 
g‘AphF›ldBud”
();

2077 
public
 
Bud”
 
ş—r
() {

2078 
	gsu³r
.
ş—r
();

2079 
	gÇme_
 = "";

2081 
	ggmStus_
 = 0;

2083 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2084 
­h_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

2085 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2087 
	g­hBud”_
.
ş—r
();

2089 
	gisLoÿl_
 = 
çl£
;

2091 
	gid_
 = "";

2093 
	gsy¡emId_
 = 0;

2095 
	gisFed”©ed_
 = 
çl£
;

2097 
	gs™eV”siÚ_
 = "";

2099 
	gvIp_
 = "";

2101 
	gnodeTy³_
 = "";

2103 
	gv”siÚ_
 = 0L;

2105  
	gthis
;

2108 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2109 
g‘DesütÜFÜTy³
() {

2110  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_desütÜ
;

2113 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2114  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
.
g‘DeçuÉIn¡ªû
();

2117 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
bud
() {

2118 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
	g»suÉ
 = 
budP¬tŸl
();

2119 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

2120 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

2122  
	g»suÉ
;

2125 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
budP¬tŸl
() {

2126 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.S™eMsg(
this
);

2127 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

2128 
	gto_b™F›ld0_
 = 0;

2129 
	g»suÉ
.
	gÇme_
 = 
Çme_
;

2130 
	g»suÉ
.
	ggmStus_
 = 
gmStus_
;

2131 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2132 ià(((
b™F›ld0_
 & 0x00000004) == 0x00000004)) {

2133 
­h_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(aph_);

2134 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2136 
	g»suÉ
.
	g­h_
 = 
­h_
;

2138 
	g»suÉ
.
	g­h_
 = 
­hBud”_
.
bud
();

2140 
	g»suÉ
.
	gisLoÿl_
 = 
isLoÿl_
;

2141 
	g»suÉ
.
	gid_
 = 
id_
;

2142 
	g»suÉ
.
	gsy¡emId_
 = 
sy¡emId_
;

2143 
	g»suÉ
.
	gisFed”©ed_
 = 
isFed”©ed_
;

2144 
	g»suÉ
.
	gs™eV”siÚ_
 = 
s™eV”siÚ_
;

2145 
	g»suÉ
.
	gvIp_
 = 
vIp_
;

2146 
	g»suÉ
.
	gnodeTy³_
 = 
nodeTy³_
;

2147 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

2148 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

2149 
ÚBut
();

2150  
	g»suÉ
;

2153 
public
 
Bud”
 
şÚe
() {

2154  (
	gBud”
è
	gsu³r
.
şÚe
();

2156 
public
 
Bud”
 
£tF›ld
(

2157 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2158 
Objeù
 
v®ue
) {

2159  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

2161 
public
 
Bud”
 
ş—rF›ld
(

2162 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

2163  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

2165 
public
 
Bud”
 
ş—rOÃof
(

2166 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

2167  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

2169 
public
 
Bud”
 
£tR•—‹dF›ld
(

2170 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2171 
šdex
, 
Objeù
 
v®ue
) {

2172  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

2174 
public
 
Bud”
 
addR•—‹dF›ld
(

2175 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2176 
Objeù
 
v®ue
) {

2177  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

2179 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

2180 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gS™eMsg
) {

2181  
m”geFrom
((
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
)
Ùh”
);

2183 
	gsu³r
.
m”geFrom
(
Ùh”
);

2184  
	gthis
;

2188 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
 
Ùh”
) {

2189 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
.
g‘DeçuÉIn¡ªû
()è 
this
;

2190 ià(!
	gÙh”
.
g‘Name
().
isEm±y
()) {

2191 
	gÇme_
 = 
Ùh”
.
Çme_
;

2192 
ÚChªged
();

2194 ià(
	gÙh”
.
	ggmStus_
 != 0) {

2195 
£tGmStusV®ue
(
Ùh”
.
g‘GmStusV®ue
());

2197 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2198 ià(!
Ùh”
.
­h_
.
isEm±y
()) {

2199 ià(
­h_
.
isEm±y
()) {

2200 
­h_
 = 
Ùh”
.aph_;

2201 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2203 
’su»AphIsMubË
();

2204 
	g­h_
.
addAÎ
(
Ùh”
.
­h_
);

2206 
ÚChªged
();

2209 ià(!
	gÙh”
.
	g­h_
.
isEm±y
()) {

2210 ià(
	g­hBud”_
.
isEm±y
()) {

2211 
	g­hBud”_
.
di¥o£
();

2212 
	g­hBud”_
 = 
nuÎ
;

2213 
	g­h_
 = 
Ùh”
.
­h_
;

2214 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2215 
	g­hBud”_
 =

2216 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
®waysU£F›ldBud”s
 ?

2217 
g‘AphF›ldBud”
(è: 
nuÎ
;

2219 
	g­hBud”_
.
addAÎMes§ges
(
Ùh”
.
­h_
);

2223 ià(
	gÙh”
.
g‘IsLoÿl
(è!ğ
çl£
) {

2224 
£tIsLoÿl
(
Ùh”
.
g‘IsLoÿl
());

2226 ià(!
	gÙh”
.
g‘Id
().
isEm±y
()) {

2227 
	gid_
 = 
Ùh”
.
id_
;

2228 
ÚChªged
();

2230 ià(
	gÙh”
.
g‘Sy¡emId
() != 0) {

2231 
£tSy¡emId
(
Ùh”
.
g‘Sy¡emId
());

2233 ià(
	gÙh”
.
g‘IsFed”©ed
(è!ğ
çl£
) {

2234 
£tIsFed”©ed
(
Ùh”
.
g‘IsFed”©ed
());

2236 ià(!
	gÙh”
.
g‘S™eV”siÚ
().
isEm±y
()) {

2237 
	gs™eV”siÚ_
 = 
Ùh”
.
s™eV”siÚ_
;

2238 
ÚChªged
();

2240 ià(!
	gÙh”
.
g‘VIp
().
isEm±y
()) {

2241 
	gvIp_
 = 
Ùh”
.
vIp_
;

2242 
ÚChªged
();

2244 ià(!
	gÙh”
.
g‘NodeTy³
().
isEm±y
()) {

2245 
	gnodeTy³_
 = 
Ùh”
.
nodeTy³_
;

2246 
ÚChªged
();

2248 ià(
	gÙh”
.
g‘V”siÚ
() != 0L) {

2249 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

2251 
ÚChªged
();

2252  
	gthis
;

2255 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2256  
	gŒue
;

2259 
public
 
Bud”
 
m”geFrom
(

2260 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2261 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2262 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2263 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
	g·r£dMes§ge
 = 
nuÎ
;

2264 
	gŒy
 {

2265 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

2266 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2267 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
è
e
.
g‘UnfšishedMes§ge
();

2268 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

2269 } 
	gfš®ly
 {

2270 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

2271 
m”geFrom
(
·r£dMes§ge
);

2274  
	gthis
;

2276 
´iv©e
 
	gb™F›ld0_
;

2278 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gÇme_
 = "";

2282 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
() {

2283 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

2284 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

2285 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2286 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2287 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2288 
	gÇme_
 = 
s
;

2289  
	gs
;

2291  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2297 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2298 
g‘NameBy‹s
() {

2299 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

2300 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

2301 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2302 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2303 (
java
.
Ïng
.
SŒšg
è
»f
);

2304 
	gÇme_
 = 
b
;

2305  
	gb
;

2307  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2313 
public
 
Bud”
 
£tName
(

2314 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2315 ià(
	gv®ue
 =ğ
nuÎ
) {

2316 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2319 
	gÇme_
 = 
v®ue
;

2320 
ÚChªged
();

2321  
	gthis
;

2326 
public
 
Bud”
 
ş—rName
() {

2328 
	gÇme_
 = 
g‘DeçuÉIn¡ªû
().
g‘Name
();

2329 
ÚChªged
();

2330  
	gthis
;

2335 
public
 
Bud”
 
£tNameBy‹s
(

2336 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2337 ià(
	gv®ue
 =ğ
nuÎ
) {

2338 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2340 
checkBy‹SŒšgIsUtf8
(
v®ue
);

2342 
	gÇme_
 = 
v®ue
;

2343 
ÚChªged
();

2344  
	gthis
;

2347 
´iv©e
 
	ggmStus_
 = 0;

2351 
public
 
g‘GmStusV®ue
() {

2352  
	ggmStus_
;

2357 
public
 
Bud”
 
£tGmStusV®ue
(
v®ue
) {

2358 
	ggmStus_
 = 
v®ue
;

2359 
ÚChªged
();

2360  
	gthis
;

2365 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
 
g‘GmStus
() {

2366 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
 
	g»suÉ
 = 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.Glob®Mªag”Stus.
v®ueOf
(
gmStus_
);

2367  
	g»suÉ
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
.
UNRECOGNIZED
 : 
»suÉ
;

2372 
public
 
Bud”
 
£tGmStus
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
Glob®Mªag”Stus
 
v®ue
) {

2373 ià(
	gv®ue
 =ğ
nuÎ
) {

2374 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2377 
	ggmStus_
 = 
v®ue
.
g‘Numb”
();

2378 
ÚChªged
();

2379  
	gthis
;

2384 
public
 
Bud”
 
ş—rGmStus
() {

2386 
	ggmStus_
 = 0;

2387 
ÚChªged
();

2388  
	gthis
;

2391 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
> 
	g­h_
 =

2392 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

2393 
´iv©e
 
’su»AphIsMubË
() {

2394 ià(!((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

2395 
­h_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
>(aph_);

2396 
	gb™F›ld0_
 |= 0x00000004;

2400 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gR•—‹dF›ldBud”V3
<

2401 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.AphInfoMsg.
	gBud”
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.
	gAphInfoMsgOrBud”
> 
	g­hBud”_
;

2406 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
> 
g‘AphLi¡
() {

2407 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2408  
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(
­h_
);

2410  
	g­hBud”_
.
g‘Mes§geLi¡
();

2416 
public
 
g‘AphCouÁ
() {

2417 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2418  
­h_
.
size
();

2420  
	g­hBud”_
.
g‘CouÁ
();

2426 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
g‘Aph
(
šdex
) {

2427 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2428  
­h_
.
g‘
(
šdex
);

2430  
	g­hBud”_
.
g‘Mes§ge
(
šdex
);

2436 
public
 
Bud”
 
£tAph
(

2437 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
v®ue
) {

2438 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2439 ià(
v®ue
 =ğ
nuÎ
) {

2440 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2442 
’su»AphIsMubË
();

2443 
	g­h_
.
£t
(
šdex
, 
v®ue
);

2444 
ÚChªged
();

2446 
	g­hBud”_
.
£tMes§ge
(
šdex
, 
v®ue
);

2448  
	gthis
;

2453 
public
 
Bud”
 
£tAph
(

2454 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
Bud”
 
bud”FÜV®ue
) {

2455 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2456 
’su»AphIsMubË
();

2457 
	g­h_
.
£t
(
šdex
, 
bud”FÜV®ue
.
bud
());

2458 
ÚChªged
();

2460 
	g­hBud”_
.
£tMes§ge
(
šdex
, 
bud”FÜV®ue
.
bud
());

2462  
	gthis
;

2467 
public
 
Bud”
 
addAph
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
v®ue
) {

2468 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2469 ià(
v®ue
 =ğ
nuÎ
) {

2470 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2472 
’su»AphIsMubË
();

2473 
	g­h_
.
add
(
v®ue
);

2474 
ÚChªged
();

2476 
	g­hBud”_
.
addMes§ge
(
v®ue
);

2478  
	gthis
;

2483 
public
 
Bud”
 
addAph
(

2484 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
v®ue
) {

2485 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2486 ià(
v®ue
 =ğ
nuÎ
) {

2487 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2489 
’su»AphIsMubË
();

2490 
	g­h_
.
add
(
šdex
, 
v®ue
);

2491 
ÚChªged
();

2493 
	g­hBud”_
.
addMes§ge
(
šdex
, 
v®ue
);

2495  
	gthis
;

2500 
public
 
Bud”
 
addAph
(

2501 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
Bud”
 
bud”FÜV®ue
) {

2502 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2503 
’su»AphIsMubË
();

2504 
	g­h_
.
add
(
bud”FÜV®ue
.
bud
());

2505 
ÚChªged
();

2507 
	g­hBud”_
.
addMes§ge
(
bud”FÜV®ue
.
bud
());

2509  
	gthis
;

2514 
public
 
Bud”
 
addAph
(

2515 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
Bud”
 
bud”FÜV®ue
) {

2516 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2517 
’su»AphIsMubË
();

2518 
	g­h_
.
add
(
šdex
, 
bud”FÜV®ue
.
bud
());

2519 
ÚChªged
();

2521 
	g­hBud”_
.
addMes§ge
(
šdex
, 
bud”FÜV®ue
.
bud
());

2523  
	gthis
;

2528 
public
 
Bud”
 
addAÎAph
(

2529 
java
.
Ïng
.
I‹¿bË
<? 
ex‹nds
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
> 
v®ues
) {

2530 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2531 
’su»AphIsMubË
();

2532 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAb¡¿ùMes§geL™e
.
	gBud”
.
addAÎ
(

2533 
v®ues
, 
­h_
);

2534 
ÚChªged
();

2536 
	g­hBud”_
.
addAÎMes§ges
(
v®ues
);

2538  
	gthis
;

2543 
public
 
Bud”
 
ş—rAph
() {

2544 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2545 
­h_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

2546 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2547 
ÚChªged
();

2549 
	g­hBud”_
.
ş—r
();

2551  
	gthis
;

2556 
public
 
Bud”
 
»moveAph
(
šdex
) {

2557 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2558 
’su»AphIsMubË
();

2559 
	g­h_
.
»move
(
šdex
);

2560 
ÚChªged
();

2562 
	g­hBud”_
.
»move
(
šdex
);

2564  
	gthis
;

2569 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
.
Bud”
 
g‘AphBud”
(

2570 
šdex
) {

2571  
g‘AphF›ldBud”
().
g‘Bud”
(
šdex
);

2576 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsgOrBud”
 
g‘AphOrBud”
(

2577 
šdex
) {

2578 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2579  
­h_
.
g‘
(
šdex
); } {

2580  
	g­hBud”_
.
g‘Mes§geOrBud”
(
šdex
);

2586 
public
 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsgOrBud”
>

2587 
g‘AphOrBud”Li¡
() {

2588 ià(
	g­hBud”_
 !ğ
nuÎ
) {

2589  
­hBud”_
.
g‘Mes§geOrBud”Li¡
();

2591  
	gjava
.
	gut
.
	gCŞËùiÚs
.
unmodifŸbËLi¡
(
­h_
);

2597 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
.
Bud”
 
addAphBud”
() {

2598  
g‘AphF›ldBud”
().
addBud”
(

2599 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
g‘DeçuÉIn¡ªû
());

2604 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
.
Bud”
 
addAphBud”
(

2605 
šdex
) {

2606  
g‘AphF›ldBud”
().
addBud”
(

2607 
šdex
, 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
g‘DeçuÉIn¡ªû
());

2612 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
.
	gBud”
>

2613 
g‘AphBud”Li¡
() {

2614  
g‘AphF›ldBud”
().
g‘Bud”Li¡
();

2616 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gR•—‹dF›ldBud”V3
<

2617 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.AphInfoMsg.
	gBud”
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.
	gAphInfoMsgOrBud”
>

2618 
g‘AphF›ldBud”
() {

2619 ià(
	g­hBud”_
 =ğ
nuÎ
) {

2620 
­hBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
R•—‹dF›ldBud”V3
<

2621 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
, 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
.
	gBud”
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.
	gAphInfoMsgOrBud”
>(

2622 
	g­h_
,

2623 ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004),

2624 
g‘P¬’tFÜChd»n
(),

2625 
isCËª
());

2626 
	g­h_
 = 
nuÎ
;

2628  
	g­hBud”_
;

2631 
´iv©e
 
boŞ—n
 
	gisLoÿl_
 ;

2635 
public
 
boŞ—n
 
g‘IsLoÿl
() {

2636  
	gisLoÿl_
;

2641 
public
 
Bud”
 
£tIsLoÿl
(
boŞ—n
 
v®ue
) {

2643 
	gisLoÿl_
 = 
v®ue
;

2644 
ÚChªged
();

2645  
	gthis
;

2650 
public
 
Bud”
 
ş—rIsLoÿl
() {

2652 
	gisLoÿl_
 = 
çl£
;

2653 
ÚChªged
();

2654  
	gthis
;

2657 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gid_
 = "";

2661 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Id
() {

2662 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
id_
;

2663 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

2664 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2665 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2666 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2667 
	gid_
 = 
s
;

2668  
	gs
;

2670  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2676 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2677 
g‘IdBy‹s
() {

2678 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
id_
;

2679 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

2680 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2681 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2682 (
java
.
Ïng
.
SŒšg
è
»f
);

2683 
	gid_
 = 
b
;

2684  
	gb
;

2686  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2692 
public
 
Bud”
 
£tId
(

2693 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2694 ià(
	gv®ue
 =ğ
nuÎ
) {

2695 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2698 
	gid_
 = 
v®ue
;

2699 
ÚChªged
();

2700  
	gthis
;

2705 
public
 
Bud”
 
ş—rId
() {

2707 
	gid_
 = 
g‘DeçuÉIn¡ªû
().
g‘Id
();

2708 
ÚChªged
();

2709  
	gthis
;

2714 
public
 
Bud”
 
£tIdBy‹s
(

2715 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2716 ià(
	gv®ue
 =ğ
nuÎ
) {

2717 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2719 
checkBy‹SŒšgIsUtf8
(
v®ue
);

2721 
	gid_
 = 
v®ue
;

2722 
ÚChªged
();

2723  
	gthis
;

2726 
´iv©e
 
	gsy¡emId_
 ;

2730 
public
 
g‘Sy¡emId
() {

2731  
	gsy¡emId_
;

2736 
public
 
Bud”
 
£tSy¡emId
(
v®ue
) {

2738 
	gsy¡emId_
 = 
v®ue
;

2739 
ÚChªged
();

2740  
	gthis
;

2745 
public
 
Bud”
 
ş—rSy¡emId
() {

2747 
	gsy¡emId_
 = 0;

2748 
ÚChªged
();

2749  
	gthis
;

2752 
´iv©e
 
boŞ—n
 
	gisFed”©ed_
 ;

2756 
public
 
boŞ—n
 
g‘IsFed”©ed
() {

2757  
	gisFed”©ed_
;

2762 
public
 
Bud”
 
£tIsFed”©ed
(
boŞ—n
 
v®ue
) {

2764 
	gisFed”©ed_
 = 
v®ue
;

2765 
ÚChªged
();

2766  
	gthis
;

2771 
public
 
Bud”
 
ş—rIsFed”©ed
() {

2773 
	gisFed”©ed_
 = 
çl£
;

2774 
ÚChªged
();

2775  
	gthis
;

2778 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gs™eV”siÚ_
 = "";

2782 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘S™eV”siÚ
() {

2783 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
s™eV”siÚ_
;

2784 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

2785 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2786 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2787 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2788 
	gs™eV”siÚ_
 = 
s
;

2789  
	gs
;

2791  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2797 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2798 
g‘S™eV”siÚBy‹s
() {

2799 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
s™eV”siÚ_
;

2800 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

2801 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2802 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2803 (
java
.
Ïng
.
SŒšg
è
»f
);

2804 
	gs™eV”siÚ_
 = 
b
;

2805  
	gb
;

2807  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2813 
public
 
Bud”
 
£tS™eV”siÚ
(

2814 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2815 ià(
	gv®ue
 =ğ
nuÎ
) {

2816 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2819 
	gs™eV”siÚ_
 = 
v®ue
;

2820 
ÚChªged
();

2821  
	gthis
;

2826 
public
 
Bud”
 
ş—rS™eV”siÚ
() {

2828 
	gs™eV”siÚ_
 = 
g‘DeçuÉIn¡ªû
().
g‘S™eV”siÚ
();

2829 
ÚChªged
();

2830  
	gthis
;

2835 
public
 
Bud”
 
£tS™eV”siÚBy‹s
(

2836 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2837 ià(
	gv®ue
 =ğ
nuÎ
) {

2838 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2840 
checkBy‹SŒšgIsUtf8
(
v®ue
);

2842 
	gs™eV”siÚ_
 = 
v®ue
;

2843 
ÚChªged
();

2844  
	gthis
;

2847 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gvIp_
 = "";

2851 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘VIp
() {

2852 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
vIp_
;

2853 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

2854 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2855 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2856 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2857 
	gvIp_
 = 
s
;

2858  
	gs
;

2860  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2866 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2867 
g‘VIpBy‹s
() {

2868 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
vIp_
;

2869 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

2870 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2871 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2872 (
java
.
Ïng
.
SŒšg
è
»f
);

2873 
	gvIp_
 = 
b
;

2874  
	gb
;

2876  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2882 
public
 
Bud”
 
£tVIp
(

2883 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2884 ià(
	gv®ue
 =ğ
nuÎ
) {

2885 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2888 
	gvIp_
 = 
v®ue
;

2889 
ÚChªged
();

2890  
	gthis
;

2895 
public
 
Bud”
 
ş—rVIp
() {

2897 
	gvIp_
 = 
g‘DeçuÉIn¡ªû
().
g‘VIp
();

2898 
ÚChªged
();

2899  
	gthis
;

2904 
public
 
Bud”
 
£tVIpBy‹s
(

2905 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2906 ià(
	gv®ue
 =ğ
nuÎ
) {

2907 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2909 
checkBy‹SŒšgIsUtf8
(
v®ue
);

2911 
	gvIp_
 = 
v®ue
;

2912 
ÚChªged
();

2913  
	gthis
;

2916 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gnodeTy³_
 = "";

2920 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘NodeTy³
() {

2921 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeTy³_
;

2922 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

2923 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2924 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2925 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2926 
	gnodeTy³_
 = 
s
;

2927  
	gs
;

2929  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2935 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2936 
g‘NodeTy³By‹s
() {

2937 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeTy³_
;

2938 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

2939 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2940 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2941 (
java
.
Ïng
.
SŒšg
è
»f
);

2942 
	gnodeTy³_
 = 
b
;

2943  
	gb
;

2945  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2951 
public
 
Bud”
 
£tNodeTy³
(

2952 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2953 ià(
	gv®ue
 =ğ
nuÎ
) {

2954 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2957 
	gnodeTy³_
 = 
v®ue
;

2958 
ÚChªged
();

2959  
	gthis
;

2964 
public
 
Bud”
 
ş—rNodeTy³
() {

2966 
	gnodeTy³_
 = 
g‘DeçuÉIn¡ªû
().
g‘NodeTy³
();

2967 
ÚChªged
();

2968  
	gthis
;

2973 
public
 
Bud”
 
£tNodeTy³By‹s
(

2974 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2975 ià(
	gv®ue
 =ğ
nuÎ
) {

2976 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2978 
checkBy‹SŒšgIsUtf8
(
v®ue
);

2980 
	gnodeTy³_
 = 
v®ue
;

2981 
ÚChªged
();

2982  
	gthis
;

2985 
´iv©e
 
	gv”siÚ_
 ;

2989 
public
 
g‘V”siÚ
() {

2990  
	gv”siÚ_
;

2995 
public
 
Bud”
 
£tV”siÚ
(
v®ue
) {

2997 
	gv”siÚ_
 = 
v®ue
;

2998 
ÚChªged
();

2999  
	gthis
;

3004 
public
 
Bud”
 
ş—rV”siÚ
() {

3006 
	gv”siÚ_
 = 0L;

3007 
ÚChªged
();

3008  
	gthis
;

3010 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

3011 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3012  
	gthis
;

3015 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

3016 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3017  
	gthis
;

3025 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
	gDEFAULT_INSTANCE
;

3027 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
S™eMsg
();

3030 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
g‘DeçuÉIn¡ªû
() {

3031  
	gDEFAULT_INSTANCE
;

3034 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gS™eMsg
>

3035 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
S™eMsg
>() {

3036 
public
 
S™eMsg
 
·r£P¬tŸlFrom
(

3037 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3038 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3039 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

3040  
Ãw
 
S™eMsg
(
šput
, 
ex‹nsiÚRegi¡ry
);

3044 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gS™eMsg
> 
·r£r
() {

3045  
	gPARSER
;

3048 @
	gjava
.
	gÏng
.
Ov”ride


3049 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gS™eMsg
> 
g‘P¬£rFÜTy³
() {

3050  
	gPARSER
;

3053 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
S™eMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3054  
	gDEFAULT_INSTANCE
;

3059 
public
 
š‹rçû
 
AphInfoMsgOrBud”
 
ex‹nds


3061 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

3066 
	gjava
.
	gÏng
.
SŒšg
 
g‘Uuid
();

3070 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3071 
g‘UuidBy‹s
();

3076 
	gjava
.
	gÏng
.
SŒšg
 
g‘Add»ss
();

3080 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3081 
g‘Add»ssBy‹s
();

3086 
g‘PÜt
();

3091 
	gjava
.
	gÏng
.
SŒšg
 
g‘C”tifiÿ‹
();

3095 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3096 
g‘C”tifiÿ‹By‹s
();

3101 
	gjava
.
	gÏng
.
SŒšg
 
g‘NodeId
();

3105 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3106 
g‘NodeIdBy‹s
();

3111 
g‘CÜfuPÜt
();

3120 
public
 
fš®
 
şass
 
AphInfoMsg
 
ex‹nds


3121 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


3123 
	gAphInfoMsgOrBud”
 {

3125 
´iv©e
 
AphInfoMsg
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

3126 
su³r
(
bud”
);

3128 
´iv©e
 
AphInfoMsg
() {

3129 
	guuid_
 = "";

3130 
	gadd»ss_
 = "";

3131 
	gpÜt_
 = 0;

3132 
	gû¹ifiÿ‹_
 = "";

3133 
	gnodeId_
 = "";

3134 
	gcÜfuPÜt_
 = 0;

3137 @
	gjava
.
	gÏng
.
Ov”ride


3138 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


3139 
g‘UnknownF›lds
() {

3140  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

3142 
´iv©e
 
AphInfoMsg
(

3143 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3144 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3145 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3146 
this
();

3147 
	gmubË_b™F›ld0_
 = 0;

3148 
	gŒy
 {

3149 
boŞ—n
 
	gdÚe
 = 
çl£
;

3150 !
	gdÚe
) {

3151 
	gg
 = 
šput
.
»adTag
();

3152 
	gg
) {

3154 
dÚe
 = 
Œue
;

3157 ià(!
šput
.
skF›ld
(
g
)) {

3158 
dÚe
 = 
Œue
;

3163 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

3165 
	guuid_
 = 
s
;

3169 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

3171 
	gadd»ss_
 = 
s
;

3176 
pÜt_
 = 
šput
.
»adIÁ32
();

3180 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

3182 
	gû¹ifiÿ‹_
 = 
s
;

3186 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

3188 
	gnodeId_
 = 
s
;

3193 
cÜfuPÜt_
 = 
šput
.
»adIÁ32
();

3198 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3199 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

3200 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

3201 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

3202 
e
).
£tUnfšishedMes§ge
(
this
);

3203 } 
	gfš®ly
 {

3204 
makeEx‹nsiÚsImmubË
();

3207 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3208 
g‘DesütÜ
() {

3209  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_desütÜ
;

3212 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3213 
š‹º®G‘F›ldAcûssÜTabË
() {

3214  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_f›ldAcûssÜTabË


3215 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3216 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
şass
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.AphInfoMsg.
Bud”
.class);

3219 
public
 
fš®
 
	gUUID_FIELD_NUMBER
 = 1;

3220 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	guuid_
;

3224 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Uuid
() {

3225 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
uuid_
;

3226 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3227  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3229 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3230 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3231 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3232 
	guuid_
 = 
s
;

3233  
	gs
;

3239 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3240 
g‘UuidBy‹s
() {

3241 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
uuid_
;

3242 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3243 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3244 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3245 (
java
.
Ïng
.
SŒšg
è
»f
);

3246 
	guuid_
 = 
b
;

3247  
	gb
;

3249  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3253 
public
 
fš®
 
	gADDRESS_FIELD_NUMBER
 = 2;

3254 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gadd»ss_
;

3258 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Add»ss
() {

3259 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
add»ss_
;

3260 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3261  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3263 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3264 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3265 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3266 
	gadd»ss_
 = 
s
;

3267  
	gs
;

3273 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3274 
g‘Add»ssBy‹s
() {

3275 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
add»ss_
;

3276 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3277 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3278 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3279 (
java
.
Ïng
.
SŒšg
è
»f
);

3280 
	gadd»ss_
 = 
b
;

3281  
	gb
;

3283  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3287 
public
 
fš®
 
	gPORT_FIELD_NUMBER
 = 3;

3288 
´iv©e
 
	gpÜt_
;

3292 
public
 
g‘PÜt
() {

3293  
	gpÜt_
;

3296 
public
 
fš®
 
	gCERTIFICATE_FIELD_NUMBER
 = 4;

3297 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gû¹ifiÿ‹_
;

3301 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C”tifiÿ‹
() {

3302 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹ifiÿ‹_
;

3303 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3304  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3306 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3307 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3308 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3309 
	gû¹ifiÿ‹_
 = 
s
;

3310  
	gs
;

3316 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3317 
g‘C”tifiÿ‹By‹s
() {

3318 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹ifiÿ‹_
;

3319 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3320 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3321 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3322 (
java
.
Ïng
.
SŒšg
è
»f
);

3323 
	gû¹ifiÿ‹_
 = 
b
;

3324  
	gb
;

3326  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3330 
public
 
fš®
 
	gNODE_ID_FIELD_NUMBER
 = 5;

3331 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gnodeId_
;

3335 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘NodeId
() {

3336 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeId_
;

3337 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3338  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3340 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3341 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3342 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3343 
	gnodeId_
 = 
s
;

3344  
	gs
;

3350 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3351 
g‘NodeIdBy‹s
() {

3352 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeId_
;

3353 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

3354 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3355 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3356 (
java
.
Ïng
.
SŒšg
è
»f
);

3357 
	gnodeId_
 = 
b
;

3358  
	gb
;

3360  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3364 
public
 
fš®
 
	gCORFU_PORT_FIELD_NUMBER
 = 6;

3365 
´iv©e
 
	gcÜfuPÜt_
;

3369 
public
 
g‘CÜfuPÜt
() {

3370  
	gcÜfuPÜt_
;

3373 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

3374 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3375 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

3376 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

3377 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

3379 
	gmemoizedIsIn™Ÿlized
 = 1;

3380  
	gŒue
;

3383 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

3384 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3385 ià(!
g‘UuidBy‹s
().
isEm±y
()) {

3386 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
uuid_
);

3388 ià(!
g‘Add»ssBy‹s
().
isEm±y
()) {

3389 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
add»ss_
);

3391 ià(
	gpÜt_
 != 0) {

3392 
ouut
.
wr™eIÁ32
(3, 
pÜt_
);

3394 ià(!
g‘C”tifiÿ‹By‹s
().
isEm±y
()) {

3395 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 4, 
û¹ifiÿ‹_
);

3397 ià(!
g‘NodeIdBy‹s
().
isEm±y
()) {

3398 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 5, 
nodeId_
);

3400 ià(
	gcÜfuPÜt_
 != 0) {

3401 
ouut
.
wr™eIÁ32
(6, 
cÜfuPÜt_
);

3405 
public
 
g‘S”ŸlizedSize
() {

3406 
	gsize
 = 
memoizedSize
;

3407 ià(
	gsize
 !ğ-1è 
size
;

3409 
	gsize
 = 0;

3410 ià(!
g‘UuidBy‹s
().
isEm±y
()) {

3411 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
uuid_
);

3413 ià(!
g‘Add»ssBy‹s
().
isEm±y
()) {

3414 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
add»ss_
);

3416 ià(
	gpÜt_
 != 0) {

3417 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3418 .
compu‹IÁ32Size
(3, 
pÜt_
);

3420 ià(!
g‘C”tifiÿ‹By‹s
().
isEm±y
()) {

3421 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(4, 
û¹ifiÿ‹_
);

3423 ià(!
g‘NodeIdBy‹s
().
isEm±y
()) {

3424 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(5, 
nodeId_
);

3426 ià(
	gcÜfuPÜt_
 != 0) {

3427 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3428 .
compu‹IÁ32Size
(6, 
cÜfuPÜt_
);

3430 
	gmemoizedSize
 = 
size
;

3431  
	gsize
;

3434 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

3435 @
	gjava
.
	gÏng
.
Ov”ride


3436 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

3437 ià(
	gobj
 =ğ
this
) {

3438  
Œue
;

3440 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
)) {

3441  
	gsu³r
.
equ®s
(
obj
);

3443 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
	gÙh”
 = (
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.AphInfoMsgè
obj
;

3445 
boŞ—n
 
	g»suÉ
 = 
Œue
;

3446 
	g»suÉ
 = 
»suÉ
 && 
g‘Uuid
()

3447 .
equ®s
(
Ùh”
.
g‘Uuid
());

3448 
	g»suÉ
 = 
»suÉ
 && 
g‘Add»ss
()

3449 .
equ®s
(
Ùh”
.
g‘Add»ss
());

3450 
	g»suÉ
 = 
»suÉ
 && (
g‘PÜt
()

3451 =ğ
Ùh”
.
g‘PÜt
());

3452 
	g»suÉ
 = 
»suÉ
 && 
g‘C”tifiÿ‹
()

3453 .
equ®s
(
Ùh”
.
g‘C”tifiÿ‹
());

3454 
	g»suÉ
 = 
»suÉ
 && 
g‘NodeId
()

3455 .
equ®s
(
Ùh”
.
g‘NodeId
());

3456 
	g»suÉ
 = 
»suÉ
 && (
g‘CÜfuPÜt
()

3457 =ğ
Ùh”
.
g‘CÜfuPÜt
());

3458  
	g»suÉ
;

3461 @
	gjava
.
	gÏng
.
Ov”ride


3462 
public
 
hashCode
() {

3463 ià(
	gmemoizedHashCode
 != 0) {

3464  
memoizedHashCode
;

3466 
	ghash
 = 41;

3467 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

3468 
	ghash
 = (37 * 
hash
è+ 
UUID_FIELD_NUMBER
;

3469 
	ghash
 = (53 * 
hash
è+ 
g‘Uuid
().
hashCode
();

3470 
	ghash
 = (37 * 
hash
è+ 
ADDRESS_FIELD_NUMBER
;

3471 
	ghash
 = (53 * 
hash
è+ 
g‘Add»ss
().
hashCode
();

3472 
	ghash
 = (37 * 
hash
è+ 
PORT_FIELD_NUMBER
;

3473 
	ghash
 = (53 * 
hash
è+ 
g‘PÜt
();

3474 
	ghash
 = (37 * 
hash
è+ 
CERTIFICATE_FIELD_NUMBER
;

3475 
	ghash
 = (53 * 
hash
è+ 
g‘C”tifiÿ‹
().
hashCode
();

3476 
	ghash
 = (37 * 
hash
è+ 
NODE_ID_FIELD_NUMBER
;

3477 
	ghash
 = (53 * 
hash
è+ 
g‘NodeId
().
hashCode
();

3478 
	ghash
 = (37 * 
hash
è+ 
CORFU_PORT_FIELD_NUMBER
;

3479 
	ghash
 = (53 * 
hash
è+ 
g‘CÜfuPÜt
();

3480 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

3481 
	gmemoizedHashCode
 = 
hash
;

3482  
	ghash
;

3485 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(

3486 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

3487 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3488  
	gPARSER
.
·r£From
(
d©a
);

3490 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(

3491 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

3492 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3493 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3494  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3496 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(
by‹
[] 
d©a
)

3497 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3498  
	gPARSER
.
·r£From
(
d©a
);

3500 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(

3501 
by‹
[] 
d©a
,

3502 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3503 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3504  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3506 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3507 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3508  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3509 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3511 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(

3512 
java
.
io
.
IÅutSŒ—m
 
šput
,

3513 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3514 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3515  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3516 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3518 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3519 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3520  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3521 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

3523 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£D–im™edFrom
(

3524 
java
.
io
.
IÅutSŒ—m
 
šput
,

3525 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3526 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3527  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3528 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3530 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(

3531 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

3532 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3533  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3534 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3536 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
·r£From
(

3537 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3538 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3539 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3540  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3541 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3544 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

3545 
public
 
Bud”
 
ÃwBud”
() {

3546  
	gDEFAULT_INSTANCE
.
toBud”
();

3548 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
´ÙÙy³
) {

3549  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

3551 
public
 
Bud”
 
toBud”
() {

3552  
	gthis
 =ğ
DEFAULT_INSTANCE


3553 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

3556 @
	gjava
.
	gÏng
.
Ov”ride


3557 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

3558 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3559 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

3560  
	gbud”
;

3569 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


3570 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


3572 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsgOrBud”
 {

3573 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3574 
g‘DesütÜ
() {

3575  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_desütÜ
;

3578 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3579 
š‹º®G‘F›ldAcûssÜTabË
() {

3580  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_f›ldAcûssÜTabË


3581 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3582 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
şass
, org.cÜfudb.log»¶iÿtiÚ.´Ùo.LogR•liÿtiÚS™eInfo.AphInfoMsg.
Bud”
.class);

3586 
´iv©e
 
Bud”
() {

3587 
maybeFÜûBud”In™Ÿliz©iÚ
();

3590 
´iv©e
 
Bud”
(

3591 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3592 
su³r
(
·»Á
);

3593 
maybeFÜûBud”In™Ÿliz©iÚ
();

3595 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

3596 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3597 .
	g®waysU£F›ldBud”s
) {

3600 
public
 
Bud”
 
ş—r
() {

3601 
	gsu³r
.
ş—r
();

3602 
	guuid_
 = "";

3604 
	gadd»ss_
 = "";

3606 
	gpÜt_
 = 0;

3608 
	gû¹ifiÿ‹_
 = "";

3610 
	gnodeId_
 = "";

3612 
	gcÜfuPÜt_
 = 0;

3614  
	gthis
;

3617 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3618 
g‘DesütÜFÜTy³
() {

3619  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_desütÜ
;

3622 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3623  
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
.
g‘DeçuÉIn¡ªû
();

3626 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
bud
() {

3627 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
	g»suÉ
 = 
budP¬tŸl
();

3628 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

3629 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

3631  
	g»suÉ
;

3634 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
budP¬tŸl
() {

3635 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.AphInfoMsg(
this
);

3636 
	g»suÉ
.
	guuid_
 = 
uuid_
;

3637 
	g»suÉ
.
	gadd»ss_
 = 
add»ss_
;

3638 
	g»suÉ
.
	gpÜt_
 = 
pÜt_
;

3639 
	g»suÉ
.
	gû¹ifiÿ‹_
 = 
û¹ifiÿ‹_
;

3640 
	g»suÉ
.
	gnodeId_
 = 
nodeId_
;

3641 
	g»suÉ
.
	gcÜfuPÜt_
 = 
cÜfuPÜt_
;

3642 
ÚBut
();

3643  
	g»suÉ
;

3646 
public
 
Bud”
 
şÚe
() {

3647  (
	gBud”
è
	gsu³r
.
şÚe
();

3649 
public
 
Bud”
 
£tF›ld
(

3650 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3651 
Objeù
 
v®ue
) {

3652  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

3654 
public
 
Bud”
 
ş—rF›ld
(

3655 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

3656  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

3658 
public
 
Bud”
 
ş—rOÃof
(

3659 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

3660  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

3662 
public
 
Bud”
 
£tR•—‹dF›ld
(

3663 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3664 
šdex
, 
Objeù
 
v®ue
) {

3665  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

3667 
public
 
Bud”
 
addR•—‹dF›ld
(

3668 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3669 
Objeù
 
v®ue
) {

3670  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

3672 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

3673 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
	gAphInfoMsg
) {

3674  
m”geFrom
((
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
)
Ùh”
);

3676 
	gsu³r
.
m”geFrom
(
Ùh”
);

3677  
	gthis
;

3681 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
Ùh”
) {

3682 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
.
g‘DeçuÉIn¡ªû
()è 
this
;

3683 ià(!
	gÙh”
.
g‘Uuid
().
isEm±y
()) {

3684 
	guuid_
 = 
Ùh”
.
uuid_
;

3685 
ÚChªged
();

3687 ià(!
	gÙh”
.
g‘Add»ss
().
isEm±y
()) {

3688 
	gadd»ss_
 = 
Ùh”
.
add»ss_
;

3689 
ÚChªged
();

3691 ià(
	gÙh”
.
g‘PÜt
() != 0) {

3692 
£tPÜt
(
Ùh”
.
g‘PÜt
());

3694 ià(!
	gÙh”
.
g‘C”tifiÿ‹
().
isEm±y
()) {

3695 
	gû¹ifiÿ‹_
 = 
Ùh”
.
û¹ifiÿ‹_
;

3696 
ÚChªged
();

3698 ià(!
	gÙh”
.
g‘NodeId
().
isEm±y
()) {

3699 
	gnodeId_
 = 
Ùh”
.
nodeId_
;

3700 
ÚChªged
();

3702 ià(
	gÙh”
.
g‘CÜfuPÜt
() != 0) {

3703 
£tCÜfuPÜt
(
Ùh”
.
g‘CÜfuPÜt
());

3705 
ÚChªged
();

3706  
	gthis
;

3709 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3710  
	gŒue
;

3713 
public
 
Bud”
 
m”geFrom
(

3714 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3715 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3716 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3717 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
	g·r£dMes§ge
 = 
nuÎ
;

3718 
	gŒy
 {

3719 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

3720 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3721 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
è
e
.
g‘UnfšishedMes§ge
();

3722 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

3723 } 
	gfš®ly
 {

3724 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

3725 
m”geFrom
(
·r£dMes§ge
);

3728  
	gthis
;

3731 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	guuid_
 = "";

3735 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Uuid
() {

3736 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
uuid_
;

3737 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

3738 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3739 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3740 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3741 
	guuid_
 = 
s
;

3742  
	gs
;

3744  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3750 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3751 
g‘UuidBy‹s
() {

3752 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
uuid_
;

3753 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

3754 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3755 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3756 (
java
.
Ïng
.
SŒšg
è
»f
);

3757 
	guuid_
 = 
b
;

3758  
	gb
;

3760  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3766 
public
 
Bud”
 
£tUuid
(

3767 
java
.
Ïng
.
SŒšg
 
v®ue
) {

3768 ià(
	gv®ue
 =ğ
nuÎ
) {

3769 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3772 
	guuid_
 = 
v®ue
;

3773 
ÚChªged
();

3774  
	gthis
;

3779 
public
 
Bud”
 
ş—rUuid
() {

3781 
	guuid_
 = 
g‘DeçuÉIn¡ªû
().
g‘Uuid
();

3782 
ÚChªged
();

3783  
	gthis
;

3788 
public
 
Bud”
 
£tUuidBy‹s
(

3789 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

3790 ià(
	gv®ue
 =ğ
nuÎ
) {

3791 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3793 
checkBy‹SŒšgIsUtf8
(
v®ue
);

3795 
	guuid_
 = 
v®ue
;

3796 
ÚChªged
();

3797  
	gthis
;

3800 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gadd»ss_
 = "";

3804 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Add»ss
() {

3805 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
add»ss_
;

3806 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

3807 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3808 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3809 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3810 
	gadd»ss_
 = 
s
;

3811  
	gs
;

3813  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3819 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3820 
g‘Add»ssBy‹s
() {

3821 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
add»ss_
;

3822 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

3823 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3824 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3825 (
java
.
Ïng
.
SŒšg
è
»f
);

3826 
	gadd»ss_
 = 
b
;

3827  
	gb
;

3829  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3835 
public
 
Bud”
 
£tAdd»ss
(

3836 
java
.
Ïng
.
SŒšg
 
v®ue
) {

3837 ià(
	gv®ue
 =ğ
nuÎ
) {

3838 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3841 
	gadd»ss_
 = 
v®ue
;

3842 
ÚChªged
();

3843  
	gthis
;

3848 
public
 
Bud”
 
ş—rAdd»ss
() {

3850 
	gadd»ss_
 = 
g‘DeçuÉIn¡ªû
().
g‘Add»ss
();

3851 
ÚChªged
();

3852  
	gthis
;

3857 
public
 
Bud”
 
£tAdd»ssBy‹s
(

3858 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

3859 ià(
	gv®ue
 =ğ
nuÎ
) {

3860 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3862 
checkBy‹SŒšgIsUtf8
(
v®ue
);

3864 
	gadd»ss_
 = 
v®ue
;

3865 
ÚChªged
();

3866  
	gthis
;

3869 
´iv©e
 
	gpÜt_
 ;

3873 
public
 
g‘PÜt
() {

3874  
	gpÜt_
;

3879 
public
 
Bud”
 
£tPÜt
(
v®ue
) {

3881 
	gpÜt_
 = 
v®ue
;

3882 
ÚChªged
();

3883  
	gthis
;

3888 
public
 
Bud”
 
ş—rPÜt
() {

3890 
	gpÜt_
 = 0;

3891 
ÚChªged
();

3892  
	gthis
;

3895 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gû¹ifiÿ‹_
 = "";

3899 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C”tifiÿ‹
() {

3900 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹ifiÿ‹_
;

3901 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

3902 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3903 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3904 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3905 
	gû¹ifiÿ‹_
 = 
s
;

3906  
	gs
;

3908  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3914 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3915 
g‘C”tifiÿ‹By‹s
() {

3916 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
û¹ifiÿ‹_
;

3917 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

3918 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3919 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3920 (
java
.
Ïng
.
SŒšg
è
»f
);

3921 
	gû¹ifiÿ‹_
 = 
b
;

3922  
	gb
;

3924  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3930 
public
 
Bud”
 
£tC”tifiÿ‹
(

3931 
java
.
Ïng
.
SŒšg
 
v®ue
) {

3932 ià(
	gv®ue
 =ğ
nuÎ
) {

3933 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3936 
	gû¹ifiÿ‹_
 = 
v®ue
;

3937 
ÚChªged
();

3938  
	gthis
;

3943 
public
 
Bud”
 
ş—rC”tifiÿ‹
() {

3945 
	gû¹ifiÿ‹_
 = 
g‘DeçuÉIn¡ªû
().
g‘C”tifiÿ‹
();

3946 
ÚChªged
();

3947  
	gthis
;

3952 
public
 
Bud”
 
£tC”tifiÿ‹By‹s
(

3953 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

3954 ià(
	gv®ue
 =ğ
nuÎ
) {

3955 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3957 
checkBy‹SŒšgIsUtf8
(
v®ue
);

3959 
	gû¹ifiÿ‹_
 = 
v®ue
;

3960 
ÚChªged
();

3961  
	gthis
;

3964 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gnodeId_
 = "";

3968 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘NodeId
() {

3969 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeId_
;

3970 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

3971 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3972 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3973 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3974 
	gnodeId_
 = 
s
;

3975  
	gs
;

3977  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3983 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3984 
g‘NodeIdBy‹s
() {

3985 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
nodeId_
;

3986 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

3987 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3988 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3989 (
java
.
Ïng
.
SŒšg
è
»f
);

3990 
	gnodeId_
 = 
b
;

3991  
	gb
;

3993  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3999 
public
 
Bud”
 
£tNodeId
(

4000 
java
.
Ïng
.
SŒšg
 
v®ue
) {

4001 ià(
	gv®ue
 =ğ
nuÎ
) {

4002 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

4005 
	gnodeId_
 = 
v®ue
;

4006 
ÚChªged
();

4007  
	gthis
;

4012 
public
 
Bud”
 
ş—rNodeId
() {

4014 
	gnodeId_
 = 
g‘DeçuÉIn¡ªû
().
g‘NodeId
();

4015 
ÚChªged
();

4016  
	gthis
;

4021 
public
 
Bud”
 
£tNodeIdBy‹s
(

4022 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

4023 ià(
	gv®ue
 =ğ
nuÎ
) {

4024 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

4026 
checkBy‹SŒšgIsUtf8
(
v®ue
);

4028 
	gnodeId_
 = 
v®ue
;

4029 
ÚChªged
();

4030  
	gthis
;

4033 
´iv©e
 
	gcÜfuPÜt_
 ;

4037 
public
 
g‘CÜfuPÜt
() {

4038  
	gcÜfuPÜt_
;

4043 
public
 
Bud”
 
£tCÜfuPÜt
(
v®ue
) {

4045 
	gcÜfuPÜt_
 = 
v®ue
;

4046 
ÚChªged
();

4047  
	gthis
;

4052 
public
 
Bud”
 
ş—rCÜfuPÜt
() {

4054 
	gcÜfuPÜt_
 = 0;

4055 
ÚChªged
();

4056  
	gthis
;

4058 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

4059 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4060  
	gthis
;

4063 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

4064 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4065  
	gthis
;

4073 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
	gDEFAULT_INSTANCE
;

4075 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
log»¶iÿtiÚ
.
´Ùo
.
LogR•liÿtiÚS™eInfo
.
AphInfoMsg
();

4078 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
g‘DeçuÉIn¡ªû
() {

4079  
	gDEFAULT_INSTANCE
;

4082 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gAphInfoMsg
>

4083 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
AphInfoMsg
>() {

4084 
public
 
AphInfoMsg
 
·r£P¬tŸlFrom
(

4085 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4086 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4087 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

4088  
Ãw
 
AphInfoMsg
(
šput
, 
ex‹nsiÚRegi¡ry
);

4092 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gAphInfoMsg
> 
·r£r
() {

4093  
	gPARSER
;

4096 @
	gjava
.
	gÏng
.
Ov”ride


4097 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gAphInfoMsg
> 
g‘P¬£rFÜTy³
() {

4098  
	gPARSER
;

4101 
public
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g´Ùo
.
	gLogR•liÿtiÚS™eInfo
.
AphInfoMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4102  
	gDEFAULT_INSTANCE
;

4107 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4108 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_desütÜ
;

4109 
´iv©e
 
fš®


4110 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4111 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_f›ldAcûssÜTabË
;

4112 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4113 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_desütÜ
;

4114 
´iv©e
 
fš®


4115 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4116 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_f›ldAcûssÜTabË
;

4117 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4118 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_desütÜ
;

4119 
´iv©e
 
fš®


4120 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4121 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_f›ldAcûssÜTabË
;

4123 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


4124 
	$g‘DesütÜ
() {

4125  
desütÜ
;

4126 
	}
}

4127 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


4128 
	gdesütÜ
;

4130 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

4152 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

4153 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

4154 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

4155 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

4156 
desütÜ
 = 
roÙ
;

4157  
	gnuÎ
;

4160 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


4161 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

4162 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

4163 }, 
assigÃr
);

4164 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_desütÜ
 =

4165 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

4166 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_f›ldAcûssÜTabË
 = 
Ãw


4167 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

4168 
š‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eCÚfigu¿tiÚMsg_desütÜ
,

4169 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Epoch", "Version", "Site", "FederationId", "Certs", });

4170 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_desütÜ
 =

4171 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

4172 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_f›ldAcûssÜTabË
 = 
Ãw


4173 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

4174 
š‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_S™eMsg_desütÜ
,

4175 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Name", "GmStatus", "Aph", "IsLocal", "Id", "SystemId", "IsFederated", "SiteVersion", "VipIp", "NodeType", "Version", });

4176 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_desütÜ
 =

4177 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(2);

4178 
	gš‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_f›ldAcûssÜTabË
 = 
Ãw


4179 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

4180 
š‹º®_¡©ic_Üg_cÜfudb_log»¶iÿtiÚ_´Ùo_AphInfoMsg_desütÜ
,

4181 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Uuid", "Address", "Port", "Certificate", "NodeId", "CorfuPort", });

	@runtime/src/main/java/org/corfudb/comm/ChannelImplementation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcomm
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃl
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gDeçuÉEv’tLoİGroup
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gS”v”ChªÃl
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	g•Şl
.
	gEpŞl
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	g•Şl
.
	gEpŞlEv’tLoİGroup
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	g•Şl
.
	gEpŞlS”v”Sock‘ChªÃl
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	g•Şl
.
	gEpŞlSock‘ChªÃl
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gkqueue
.
	gKQueue
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gkqueue
.
	gKQueueEv’tLoİGroup
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gkqueue
.
	gKQueueS”v”Sock‘ChªÃl
;

14 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gkqueue
.
	gKQueueSock‘ChªÃl
;

15 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gloÿl
.
	gLoÿlChªÃl
;

16 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gloÿl
.
	gLoÿlS”v”ChªÃl
;

17 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gnio
.
	gNioEv’tLoİGroup
;

18 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gsock‘
.
	gnio
.
	gNioS”v”Sock‘ChªÃl
;

19 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gsock‘
.
	gnio
.
	gNioSock‘ChªÃl
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

21 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

22 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

23 
impÜt
 
	glombok
.
	gG‘‹r
;

26 @
AÎArgsCÚ¡ruùÜ


27 
public
 
	eChªÃlIm¶em’tiÚ
 {

31 
AUTO
(
EpŞl
.
isAvaabË
(è? 
EpŞlSock‘ChªÃl
.
şass
 :

32 
KQueue
.
isAvaabË
(è? 
KQueueSock‘ChªÃl
.
şass
 :

33 
NioSock‘ChªÃl
.
şass
,

34 
EpŞl
.
isAvaabË
(è? 
EpŞlS”v”Sock‘ChªÃl
.
şass
 :

35 
KQueue
.
isAvaabË
(è? 
KQueueS”v”Sock‘ChªÃl
.
şass
 :

36 
NioS”v”Sock‘ChªÃl
.
şass
,

37 (
numTh»ads
, 
çùÜy
) ->

38 
EpŞl
.
isAvaabË
(è? 
Ãw
 
EpŞlEv’tLoİGroup
(
numTh»ads
, 
çùÜy
) :

39 
KQueue
.
isAvaabË
(è? 
Ãw
 
KQueueEv’tLoİGroup
(
numTh»ads
, 
çùÜy
) :

40 
Ãw
 
NioEv’tLoİGroup
(
numTh»ads
, 
çùÜy
)),

41 
NIO
(
NioSock‘ChªÃl
.
şass
, 
NioS”v”Sock‘ChªÃl
.şass, 
NioEv’tLoİGroup
::
Ãw
),

42 
EPOLL
(
EpŞlSock‘ChªÃl
.
şass
, 
EpŞlS”v”Sock‘ChªÃl
.şass, 
EpŞlEv’tLoİGroup
::
Ãw
),

43 
KQUEUE
(
KQueueSock‘ChªÃl
.
şass
, 
KQueueS”v”Sock‘ChªÃl
.şass, 
KQueueEv’tLoİGroup
::
Ãw
),

44 
LOCAL
(
LoÿlChªÃl
.
şass
, 
LoÿlS”v”ChªÃl
.şass, 
DeçuÉEv’tLoİGroup
::
Ãw
)

50 @
G‘‹r


51 
fš®
 
	mCÏss
<? 
ex‹nds
 
	mChªÃl
> 
	mchªÃlCÏss
;

56 @
G‘‹r


57 
fš®
 
	mCÏss
<? 
ex‹nds
 
	mS”v”ChªÃl
> 
	m£rv”ChªÃlCÏss
;

62 @
G‘‹r


63 
fš®
 
Ev’tLoİGroupG’”©Ü
 
	mg’”©Ü
;

68 @
FunùiÚ®IÁ”çû


69 
public
 
š‹rçû
 
	mEv’tLoİGroupG’”©Ü
 {

70 
Ev’tLoİGroup
 
g’”©e
(
numTh»ads
, @
NÚnuÎ
 
Th»adFaùÜy
 
çùÜy
);

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/CheckpointEntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

13 
impÜt
 
	glombok
.
	gG‘‹r
;

14 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

15 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

16 
impÜt
 
	glombok
.
	gS‘‹r
;

17 
impÜt
 
	glombok
.
	gToSŒšg
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gCÜfuS”Ÿliz”
;

26 @
ToSŒšg
(
ÿÎSu³r
 = 
Œue
)

27 @
NoArgsCÚ¡ruùÜ


28 
public
 cÏs 
	cCheckpoštEÁry
 
ex‹nds
 
LogEÁry
 {

30 @
RequœedArgsCÚ¡ruùÜ


31 
public
 
	eCheckpoštEÁryTy³
 {

32 
START
(0),

33 
CONTINUATION
(1),

34 
END
(2);

36 
public
 
fš®
 
	mty³
;

38 
public
 
by‹
 
asBy‹
() {

39  (
	mby‹
è
	mty³
;

42 
public
 
fš®
 
	mM­
<
	mBy‹
, 
	mCheckpoštEÁryTy³
> 
	mty³M­
 =

43 
A¼ays
.
¡»am
(
CheckpoštEÁryTy³
.
v®ues
())

44 .
cŞËù
(
CŞËùÜs
.
toM­
(

45 
CheckpoštEÁryTy³
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

48 @
RequœedArgsCÚ¡ruùÜ


49 
public
 
	eCheckpoštDiùKey
 {

50 
START_TIME
(0),

51 
END_TIME
(1),

52 
START_LOG_ADDRESS
(2),

53 
ENTRY_COUNT
(3),

54 
BYTE_COUNT
(4),

55 
SNAPSHOT_ADDRESS
(5);

57 
public
 
fš®
 
	gty³
;

59 
public
 
by‹
 
asBy‹
() {

60  (
	gby‹
è
	gty³
;

63 
public
 
fš®
 
	gM­
<
	gBy‹
, 
	gCheckpoštDiùKey
> 
	gty³M­
 =

64 
A¼ays
.
¡»am
(
CheckpoštDiùKey
.
v®ues
())

65 .
cŞËù
(
CŞËùÜs
.
toM­
(

66 
CheckpoštDiùKey
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

71 @
G‘‹r


72 
CheckpoštEÁryTy³
 
	gıTy³
;

78 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

79 @
G‘‹r


80 
UUID
 
	gcheckpoštId
;

82 @
G‘‹r


83 
UUID
 
	g¡»amId
;

87 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

88 @
G‘‹r


89 
SŒšg
 
	gcheckpoštAuthÜId
;

93 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

94 @
G‘‹r


95 
	gM­
<
	gCheckpoštDiùKey
, 
	gSŒšg
> 
	gdiù
;

102 
´iv©e
 
MuÉiSMREÁry
 
	gsmrEÁr›s
;

104 
´iv©e
 
	gby‹
[] 
	g¡»amUpd©es
;

109 @
G‘‹r


110 
	gsmrEÁr›sBy‹s
 = 0;

112 
public
 
CheckpoštEÁry
(
CheckpoštEÁryTy³
 
ty³
, 
SŒšg
 
authÜId
, 
UUID
 
checkpoštId
,

113 
UUID
 
¡»amId
, 
M­
<
CheckpoštDiùKey
,
SŒšg
> 
diù
, 
MuÉiSMREÁry
 
smrEÁr›s
) {

114 
su³r
(
LogEÁryTy³
.
CHECKPOINT
);

115 
	gthis
.
	gıTy³
 = 
ty³
;

116 
	gthis
.
	gcheckpoštId
 = 
checkpoštId
;

117 
	gthis
.
	g¡»amId
 = 
¡»amId
;

118 
	gthis
.
	gcheckpoštAuthÜId
 = 
authÜId
;

119 
	gthis
.
	gdiù
 = 
diù
;

120 
	gthis
.
	gsmrEÁr›s
 = 
smrEÁr›s
;

131 @
Ov”ride


132 
	$de£rŸlizeBufãr
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

133 
su³r
.
	`de£rŸlizeBufãr
(
b
, 
¹
);

134 
ıTy³
 = 
CheckpoštEÁryTy³
.
ty³M­
.
	`g‘
(
b
.
	`»adBy‹
());

135 
checkpoštId
 = 
Ãw
 
	`UUID
(
b
.
	`»adLÚg
(), b.readLong());

136 
¡»amId
 = 
Ãw
 
	`UUID
(
b
.
	`»adLÚg
(), b.readLong());

137 
checkpoštAuthÜId
 = 
	`de£rŸlizeSŒšg
(
b
);

138 
diù
 = 
Ãw
 
HashM­
<>();

139 
m­EÁr›s
 = 
b
.
	`»adShÜt
();

140 
i
 = 0; i < 
m­EÁr›s
; i++) {

141 
CheckpoštDiùKey
 
k
 = CheckpoštDiùKey.
ty³M­
.
	`g‘
(
b
.
	`»adBy‹
());

142 
SŒšg
 
v
 = 
	`de£rŸlizeSŒšg
(
b
);

143 
diù
.
	`put
(
k
, 
v
);

145 
smrEÁr›s
 = 
nuÎ
;

146 
by‹
 
hasSmrEÁr›s
 = 
b
.
	`»adBy‹
();

148 ià(
hasSmrEÁr›s
 > 0) {

149 
By‹Buf
 
ÃwBuf
 = 
UÅoŞed
.
	`bufãr
();

150 
ÃwBuf
.
	`wr™eBy‹
(
CÜfuS”Ÿliz”
.
cÜfuPaylßdMagic
);

151 
ÃwBuf
.
	`wr™eBy‹s
(
b
);

155 
¡¬t
 = 
ÃwBuf
.
	`»ad”Index
();

156 
MuÉiSMREÁry
.
	`£ekToEnd
(
ÃwBuf
);

157 
muÉiSMRL’
 = 
ÃwBuf
.
	`»ad”Index
(è- 
¡¬t
;

158 
ÃwBuf
.
	`»ad”Index
(
¡¬t
);

159 
¡»amUpd©es
 = 
Ãw
 
by‹
[
muÉiSMRL’
];

160 
ÃwBuf
.
	`»adBy‹s
(
¡»amUpd©es
);

163 
smrEÁr›sBy‹s
 = 
ÃwBuf
.
	`»adIÁ
();

165 
smrEÁr›sBy‹s
 = 
b
.
	`»adIÁ
();

167 
	}
}

169 
public
 
MuÉiSMREÁry
 
	$g‘SmrEÁr›s
() {

170  
	`g‘SmrEÁr›s
(
çl£
);

171 
	}
}

173 
public
 
synchrÚized
 
MuÉiSMREÁry
 
	$g‘SmrEÁr›s
(
boŞ—n
 
İaque
) {

174 ià(
¡»amUpd©es
 !ğ
nuÎ
) {

175 
By‹Buf
 
b
 = 
UÅoŞed
.
	`w¿µedBufãr
(
¡»amUpd©es
);

176 
b
.
	`»adBy‹
();

177 ià(
İaque
) {

178 
smrEÁr›s
 = (
MuÉiSMREÁry
èMuÉiSMREÁry.
	`de£rŸlize
(
b
, 
ruÁime
, 
Œue
);

180 
smrEÁr›s
 = (
MuÉiSMREÁry
èMuÉiSMREÁry.
	`de£rŸlize
(
b
, 
ruÁime
, 
çl£
);

182 
¡»amUpd©es
 = 
nuÎ
;

185  
smrEÁr›s
;

186 
	}
}

196 @
Ov”ride


197 
public
 
	$£rŸlize
(
By‹Buf
 
b
) {

198 
su³r
.
	`£rŸlize
(
b
);

200 ià(
ıTy³
 =ğ
CheckpoštEÁryTy³
.
END


201 && 
	`g‘Diù
().
	`g‘
(
CheckpoštDiùKey
.
START_LOG_ADDRESS
è=ğ
nuÎ
) {

202 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(
diù
.
	`g‘
(
CheckpoštDiùKey
.
START_LOG_ADDRESS
));

205 
b
.
	`wr™eBy‹
(
ıTy³
.
	`asBy‹
());

206 
b
.
	`wr™eLÚg
(
checkpoštId
.
	`g‘Mo¡SignifiÿÁB™s
());

207 
b
.
	`wr™eLÚg
(
checkpoštId
.
	`g‘L—¡SignifiÿÁB™s
());

208 
b
.
	`wr™eLÚg
(
¡»amId
.
	`g‘Mo¡SignifiÿÁB™s
());

209 
b
.
	`wr™eLÚg
(
¡»amId
.
	`g‘L—¡SignifiÿÁB™s
());

210 
	`£rŸlizeSŒšg
(
checkpoštAuthÜId
, 
b
);

211 
b
.
	`wr™eShÜt
(
diù
 =ğ
nuÎ
 ? 0 : diù.
	`size
());

212 ià(
diù
 !ğ
nuÎ
) {

213 
diù
.
	`’ŒyS‘
().
	`¡»am
()

214 .
	`fÜEach
(
x
 -> {

215 
b
.
	`wr™eBy‹
(
x
.
	`g‘Key
().
	`asBy‹
());

216 
	`£rŸlizeSŒšg
(
x
.
	`g‘V®ue
(), 
b
);

219 ià(
smrEÁr›s
 !ğ
nuÎ
) {

220 
b
.
	`wr™eBy‹
(1);

221 
by‹S¹
 = 
b
.
	`»adabËBy‹s
();

222 
smrEÁr›s
.
	`£rŸlize
(
b
);

223 
smrEÁr›sBy‹s
 = 
b
.
	`»adabËBy‹s
(è- 
by‹S¹
;

225 
b
.
	`wr™eShÜt
(0);

226 
smrEÁr›sBy‹s
 = 0;

228 
b
.
	`wr™eIÁ
(
smrEÁr›sBy‹s
);

229 
	}
}

236 
´iv©e
 
SŒšg
 
	$de£rŸlizeSŒšg
(
By‹Buf
 
b
) {

237 
Ën
 = 
b
.
	`»adShÜt
();

238 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
Ën
];

239 
b
.
	`»adBy‹s
(
by‹s
, 0, 
Ën
);

240  
Ãw
 
	`SŒšg
(
by‹s
);

241 
	}
}

247 
´iv©e
 
	$£rŸlizeSŒšg
(
SŒšg
 
s
, 
By‹Buf
 
b
) {

248 
b
.
	`wr™eShÜt
(
s
.
	`Ëngth
());

249 
b
.
	`wr™eBy‹s
(
s
.
	`g‘By‹s
());

250 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/ISMRConsumable.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

14 
public
 
š‹rçû
 
	gISMRCÚsumabË
 {

15 
	gLi¡
<
	gSMREÁry
> 
g‘SMRUpd©es
(
UUID
 
id
);

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/LogEntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

11 
impÜt
 
	glombok
.
	gG‘‹r
;

12 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

13 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

14 
impÜt
 
	glombok
.
	gS‘‹r
;

15 
impÜt
 
	glombok
.
	gToSŒšg
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gICÜfuS”ŸlizabË
;

24 @
ToSŒšg
(
exşude
 = {"runtime"})

25 @
NoArgsCÚ¡ruùÜ


26 
public
 cÏs 
	cLogEÁry
 
im¶em’ts
 
ICÜfuS”ŸlizabË
 {

28 
fš®
 
M­
<
By‹
, 
LogEÁryTy³
> 
ty³M­
 =

29 
A¼ays
.
¡»am
(
LogEÁryTy³
.
v®ues
())

30 .
cŞËù
(
CŞËùÜs
.
toM­
(
LogEÁryTy³
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

35 @
S‘‹r


36 
´Ùeùed
 
CÜfuRuÁime
 
	mruÁime
;

41 @
G‘‹r


42 
LogEÁryTy³
 
	mty³
;

47 @
	mG‘‹r


48 @
S‘‹r


49 
	mglob®Add»ss
 = 
Add»ss
.
NON_ADDRESS
;

51 @
	mG‘‹r


52 @
S‘‹r


53 
boŞ—n
 
	mİaque
 = 
çl£
;

60 
public
 
	$LogEÁry
(
LogEÁryTy³
 
ty³
) {

61 
this
.
ty³
 =ype;

71 
public
 
ICÜfuS”ŸlizabË
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

72  
	`de£rŸlize
(
b
, 
¹
, 
çl£
);

73 
	}
}

75 
public
 
ICÜfuS”ŸlizabË
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
, 
boŞ—n
 
İaque
) {

76 
Œy
 {

77 
by‹
 
ty³
 = 
b
.
	`»adBy‹
();

78 
LogEÁryTy³
 
Ët
 = 
ty³M­
.
	`g‘
(
ty³
);

79 
LogEÁry
 
l
 = 
Ët
.
’ŒyTy³
.
	`ÃwIn¡ªû
();

80 
l
.
ty³
 = 
Ët
;

81 
l
.
ruÁime
 = 
¹
;

82 
l
.
İaque
 = opaque;

83 
l
.
	`de£rŸlizeBufãr
(
b
, 
¹
);

84  
l
;

85 } 
	`ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 | 
IÎeg®AcûssExû±iÚ
 
›
) {

86 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("E¼Ü de£rŸlizšgƒÁry", 
›
);

88 
	}
}

96 
	$de£rŸlizeBufãr
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

98 
	}
}

105 @
Ov”ride


106 
public
 
	$£rŸlize
(
By‹Buf
 
b
) {

107 
b
.
	`wr™eBy‹
(
ty³
.
	`asBy‹
());

108 
	}
}

110 @
RequœedArgsCÚ¡ruùÜ


111 
public
 
	eLogEÁryTy³
 {

113 
NOP
(0, 
LogEÁry
.
şass
),

114 
SMR
(1, 
SMREÁry
.
şass
),

115 
MULTIOBJSMR
(7, 
MuÉiObjeùSMREÁry
.
şass
),

116 
MULTISMR
(8, 
MuÉiSMREÁry
.
şass
),

117 
CHECKPOINT
(10, 
CheckpoštEÁry
.
şass
);

119 
public
 
fš®
 
	gty³
;

120 
public
 
fš®
 
	gCÏss
<? 
ex‹nds
 
	gLogEÁry
> 
	g’ŒyTy³
;

122 
public
 
by‹
 
asBy‹
() {

123  (
	gby‹
è
	gty³
;

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/MultiObjectSMREntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

6 
impÜt
 
	glombok
.
	gToSŒšg
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gCÜfuS”Ÿliz”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

12 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

19 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gP»cÚd™iÚs
.
	gcheckS‹
;

28 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

29 @
	gToSŒšg


30 @
Slf4j


31 
public
 cÏs 
	cMuÉiObjeùSMREÁry
 
ex‹nds
 
LogEÁry
 
im¶em’ts
 
	mISMRCÚsumabË
 {

34 
´iv©e
 
	mM­
<
	mUUID
, 
	mMuÉiSMREÁry
> 
	m¡»amUpd©es
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

40 
´iv©e
 
fš®
 
	mM­
<
	mUUID
, 
	mby‹
[]> 
	m¡»amBufãrs
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

42 
public
 
	$MuÉiObjeùSMREÁry
() {

43 
this
.
ty³
 = 
LogEÁryTy³
.
MULTIOBJSMR
;

54 
public
 
	$addTo
(
UUID
 
¡»amID
, 
SMREÁry
 
upd©eEÁry
) {

55 
	`checkS‹
(
¡»amBufãrs
.
	`isEm±y
(), "Shouldn't be called on‡ deserialized object");

56 
MuÉiSMREÁry
 
muÉiSMREÁry
 = 
¡»amUpd©es
.
	`compu‹IfAb£Á
(
¡»amID
, 
k
 -> 
Ãw
 
	`MuÉiSMREÁry
());

57 
muÉiSMREÁry
.
	`addTo
(
upd©eEÁry
);

58 
	}
}

67 
public
 
	$m”geIÁo
(
MuÉiObjeùSMREÁry
 
Ùh”
) {

68 
	`checkS‹
(
¡»amBufãrs
.
	`isEm±y
(), "Shouldn't be called on‡ deserialized object");

70 ià(
Ùh”
 =ğ
nuÎ
) {

74 
Ùh”
.
	`g‘EÁryM­
().
	`fÜEach
((
Ùh”SŒ—mID
, 
Ùh”MuÉiSmrEÁry
) -> {

75 
MuÉiSMREÁry
 
muÉiSMREÁry
 = 
¡»amUpd©es
.
	`compu‹IfAb£Á
(
Ùh”SŒ—mID
, 
k
 -> 
Ãw
 
	`MuÉiSMREÁry
());

76 
muÉiSMREÁry
.
	`m”geIÁo
(
Ùh”MuÉiSmrEÁry
);

78 
	}
}

88 @
Ov”ride


89 
public
 
	$de£rŸlizeBufãr
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

90 
su³r
.
	`de£rŸlizeBufãr
(
b
, 
¹
);

91 
numSŒ—ms
 = 
b
.
	`»adIÁ
();

92 
i
 = 0; i < 
numSŒ—ms
; i++) {

93 
UUID
 
¡»amId
 = 
Ãw
 
	`UUID
(
b
.
	`»adLÚg
(), b.readLong());

98 
¡¬t
 = 
b
.
	`»ad”Index
();

99 
MuÉiSMREÁry
.
	`£ekToEnd
(
b
);

100 
muÉiSMRL’
 = 
b
.
	`»ad”Index
(è- 
¡¬t
;

101 
b
.
	`»ad”Index
(
¡¬t
);

102 
by‹
[] 
¡»amUpd©es
 = 
Ãw
 by‹[
muÉiSMRL’
];

103 
b
.
	`»adBy‹s
(
¡»amUpd©es
);

104 
¡»amBufãrs
.
	`put
(
¡»amId
, 
¡»amUpd©es
);

106 
	}
}

108 @
Ov”ride


109 
public
 
	$£rŸlize
(
By‹Buf
 
b
) {

110 
su³r
.
	`£rŸlize
(
b
);

111 
b
.
	`wr™eIÁ
(
¡»amUpd©es
.
	`size
());

112 
¡»amUpd©es
.
	`’ŒyS‘
().
	`¡»am
()

113 .
	`fÜEach
(
x
 -> {

114 
b
.
	`wr™eLÚg
(
x
.
	`g‘Key
().
	`g‘Mo¡SignifiÿÁB™s
());

115 
b
.
	`wr™eLÚg
(
x
.
	`g‘Key
().
	`g‘L—¡SignifiÿÁB™s
());

116 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
x
.
	`g‘V®ue
(), 
b
);

118 
	}
}

126 @
Ov”ride


127 
public
 
	gLi¡
<
	gSMREÁry
> 
	$g‘SMRUpd©es
(
UUID
 
id
) {

132 
MuÉiSMREÁry
 
»sMuÉiSmrEÁry
 = 
¡»amUpd©es
.
	`compu‹IfAb£Á
(
id
, 
k
 -> {

133 ià(!
¡»amBufãrs
.
	`cÚšsKey
(
id
)) {

134  
nuÎ
;

138 
by‹
[] 
¡»amUpd©esBuf
 = 
¡»amBufãrs
.
	`g‘
(
id
);

139 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`w¿µedBufãr
(
¡»amUpd©esBuf
);

140 
by‹
 
magicBy‹
 = 
buf
.
	`»adBy‹
();

141 
	`checkS‹
(
magicBy‹
 =ğ
CÜfuS”Ÿliz”
.
cÜfuPaylßdMagic
, "Not‡ ICorfuSerializable object");

142 
MuÉiSMREÁry
 
muÉiSMREÁry
 = (MuÉiSMREÁryèMuÉiSMREÁry.
	`de£rŸlize
(
buf
, 
nuÎ
, 
	`isO·que
());

143 
muÉiSMREÁry
.
	`£tGlob®Add»ss
(
	`g‘Glob®Add»ss
());

144 
¡»amBufãrs
.
	`»move
(
id
);

145  
muÉiSMREÁry
;

148  
»sMuÉiSmrEÁry
 =ğ
nuÎ
 ? 
CŞËùiÚs
.
	`em±yLi¡
(è:„esMuÉiSmrEÁry.
	`g‘Upd©es
();

149 
	}
}

154 @
Ov”ride


155 
public
 
	$£tGlob®Add»ss
(
add»ss
) {

156 
su³r
.
	`£tGlob®Add»ss
(
add»ss
);

157 
¡»amUpd©es
.
	`v®ues
().
	`fÜEach
(
x
 -> x.
	`£tGlob®Add»ss
(
add»ss
));

158 
	}
}

164 
public
 
	gM­
<
	gUUID
, 
	gMuÉiSMREÁry
> 
	$g‘EÁryM­
() {

168 
UUID
 
id
 : 
Ãw
 
HashS‘
<>(
¡»amBufãrs
.
	`keyS‘
())) {

169 
	`g‘SMRUpd©es
(
id
);

172  
this
.
¡»amUpd©es
;

173 
	}
}

175 @
VisibËFÜTe¡šg


176 
	gM­
<
	gUUID
, 
	gby‹
[]> 
	$g‘SŒ—mBufãrs
() {

177  
¡»amBufãrs
;

178 
	}
}

180 @
VisibËFÜTe¡šg


181 
	gM­
<
	gUUID
, 
	gMuÉiSMREÁry
> 
	$g‘SŒ—mUpd©es
() {

182  
¡»amUpd©es
;

183 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/MultiSMREntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

11 
impÜt
 
	glombok
.
	gG‘‹r
;

12 
impÜt
 
	glombok
.
	gToSŒšg
;

13 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gCÜfuS”Ÿliz”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

19 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gP»cÚd™iÚs
.
	gcheckS‹
;

27 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

28 @
	gToSŒšg


29 @
	gSlf4j


30 @
Equ®sAndHashCode


31 
public
 cÏs 
	cMuÉiSMREÁry
 
ex‹nds
 
LogEÁry
 
im¶em’ts
 
	mISMRCÚsumabË
 {

33 @
G‘‹r


34 
	mLi¡
<
	mSMREÁry
> 
	mupd©es
 = 
CŞËùiÚs
.
synchrÚizedLi¡
(
Ãw
 
A¼ayLi¡
<>());

36 
public
 
	$MuÉiSMREÁry
() {

37 
this
.
ty³
 = 
LogEÁryTy³
.
MULTISMR
;

40 
public
 
	`MuÉiSMREÁry
(
Li¡
<
SMREÁry
> 
upd©es
) {

41 
this
.
ty³
 = 
LogEÁryTy³
.
MULTISMR
;

42 
this
.
upd©es
 = updates;

43 
	}
}

45 
public
 
	$addTo
(
SMREÁry
 
’Œy
) {

46 
	`g‘Upd©es
().
	`add
(
’Œy
);

47 
	}
}

49 
public
 
	$m”geIÁo
(
MuÉiSMREÁry
 
Ùh”
) {

50 
	`g‘Upd©es
().
	`addAÎ
(
Ùh”
.getUpdates());

51 
	}
}

58 @
Ov”ride


59 
	$de£rŸlizeBufãr
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

60 
su³r
.
	`de£rŸlizeBufãr
(
b
, 
¹
);

62 
numUpd©es
 = 
b
.
	`»adIÁ
();

63 
upd©es
 = 
Ãw
 
A¼ayLi¡
<>();

64 
i
 = 0; i < 
numUpd©es
; i++) {

65 
b
.
	`»adBy‹
();

66 
upd©es
.
	`add
((
SMREÁry
èSMREÁry.
	`de£rŸlize
(
b
, 
¹
, 
	`isO·que
()));

68 
	}
}

74 
public
 
	$£ekToEnd
(
By‹Buf
 
b
) {

76 
by‹
 
magicBy‹
 = 
b
.
	`»adBy‹
();

77 
	`checkS‹
(
magicBy‹
 =ğ
CÜfuS”Ÿliz”
.
cÜfuPaylßdMagic
, "Not‡ ICorfuSerializable object");

79 
by‹
 
ty³
 = 
b
.
	`»adBy‹
();

80 
	`checkS‹
(
ty³
 =ğ
LogEÁryTy³
.
MULTISMR
.
	`asBy‹
(), "Not‡ MULTISMR!");

81 
numUpd©es
 = 
b
.
	`»adIÁ
();

82 
i
 = 0; i < 
numUpd©es
; i++) {

83 
SMREÁry
.
	`£ekToEnd
(
b
);

85 
	}
}

87 @
Ov”ride


88 
public
 
	$£rŸlize
(
By‹Buf
 
b
) {

89 
su³r
.
	`£rŸlize
(
b
);

90 
b
.
	`wr™eIÁ
(
upd©es
.
	`size
());

91 
upd©es
.
	`¡»am
()

92 .
	`fÜEach
(
x
 -> 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(x, 
b
));

93 
	}
}

95 @
Ov”ride


96 
public
 
	$£tGlob®Add»ss
(
add»ss
) {

97 
su³r
.
	`£tGlob®Add»ss
(
add»ss
);

98 
this
.
	`g‘Upd©es
().
	`fÜEach
(
x
 -> x.
	`£tGlob®Add»ss
(
add»ss
));

99 
	}
}

101 @
Ov”ride


102 
public
 
	gLi¡
<
	gSMREÁry
> 
	$g‘SMRUpd©es
(
UUID
 
id
) {

103  
upd©es
;

104 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/OpaqueEntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gI‹¿bËs
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gLi¡s
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

13 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

16 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gCÜfuS”Ÿliz”
.
	gcÜfuPaylßdMagic
;

28 
public
 cÏs 
	cO·queEÁry
 {

30 
´iv©e
 
O·queEÁry
 
	mem±y
 = 
Ãw
 O·queEÁry(
Add»ss
.
NON_EXIST
, 
CŞËùiÚs
.
em±yM­
());

32 @
G‘‹r


33 
fš®
 
	mM­
<
	mUUID
, 
	mLi¡
<
	mSMREÁry
>> 
	m’Œ›s
;

35 @
G‘‹r


37 
fš®
 
	mv”siÚ
;

39 
public
 
O·queEÁry
(
v”siÚ
, 
M­
<
UUID
, 
Li¡
<
SMREÁry
>> 
upd©es
) {

40 
	mthis
.
	m’Œ›s
 = 
upd©es
;

41 
	mthis
.
	mv”siÚ
 = 
v”siÚ
;

44 
public
 
	$£rŸlize
(
By‹Buf
 
buf
, 
O·queEÁry
 
’Œy
) {

45 
buf
.
	`wr™eLÚg
(
’Œy
.
	`g‘V”siÚ
());

46 
buf
.
	`wr™eIÁ
(
’Œy
.
	`g‘EÁr›s
().
	`size
());

47 
M­
.
EÁry
<
UUID
, 
Li¡
<
SMREÁry
>> 
¡»amUpd©es
 : 
’Œy
.
	`g‘EÁr›s
().
	`’ŒyS‘
()) {

48 
UUID
 
¡»amId
 = 
¡»amUpd©es
.
	`g‘Key
();

49 
Li¡
<
SMREÁry
> 
¡»amEÁr›s
 = 
¡»amUpd©es
.
	`g‘V®ue
();

50 
buf
.
	`wr™eLÚg
(
¡»amId
.
	`g‘Mo¡SignifiÿÁB™s
());

51 
buf
.
	`wr™eLÚg
(
¡»amId
.
	`g‘L—¡SignifiÿÁB™s
());

52 
buf
.
	`wr™eIÁ
(
¡»amEÁr›s
.
	`size
());

53 
SMREÁry
 
smrEÁry
 : 
¡»amEÁr›s
) {

54 
smrEÁry
.
	`£rŸlize
(
buf
);

57 
	}
}

59 
public
 
O·queEÁry
 
	$de£rŸlize
(
By‹Buf
 
buf
) {

60 
v”siÚ
 = 
buf
.
	`»adLÚg
();

61 
numSŒ—ms
 = 
buf
.
	`»adIÁ
();

62 
M­
<
UUID
, 
Li¡
<
SMREÁry
>> 
upd©es
 = 
Ãw
 
HashM­
<>(
numSŒ—ms
);

64 
x
 = 0; x < 
numSŒ—ms
; x++) {

65 
UUID
 
¡»amId
 = 
Ãw
 
	`UUID
(
buf
.
	`»adLÚg
(), buf.readLong());

66 
numSŒ—mUpd©es
 = 
buf
.
	`»adIÁ
();

67 
Li¡
<
SMREÁry
> 
¡»amUpd©es
 = 
Ãw
 
A¼ayLi¡
<>(
numSŒ—mUpd©es
);

68 
i
 = 0; i < 
numSŒ—mUpd©es
; i++) {

69 
¡»amUpd©es
.
	`add
((
SMREÁry
èSMREÁry.
	`de£rŸlize
(
buf
, 
nuÎ
, 
Œue
));

71 
upd©es
.
	`put
(
¡»amId
, 
¡»amUpd©es
);

74  
Ãw
 
	`O·queEÁry
(
v”siÚ
, 
upd©es
);

75 
	}
}

77 
public
 
O·queEÁry
 
	$uÅack
(
ILogD©a
 
logD©a
) {

78 
by‹
[] 
·ylßd
 = ((
LogD©a
è
logD©a
).
	`g‘D©a
();

79 ià(
·ylßd
 =ğ
nuÎ
è 
em±y
;

81 
By‹Buf
 
·ylßdBuf
 = 
UÅoŞed
.
	`w¿µedBufãr
(
·ylßd
);

83 ià(
logD©a
.
	`hasPaylßdCodec
()) {

85 
By‹Buf
 
com´es£dBuf
 = 
ICÜfuPaylßd
.
	`äomBufãr
(
·ylßd
, By‹Buf.
şass
);

86 
by‹
[] 
com´es£dA¼ayBuf
ğ
Ãw
 by‹[
com´es£dBuf
.
	`»adabËBy‹s
()];

87 
com´es£dBuf
.
	`»adBy‹s
(
com´es£dA¼ayBuf
);

88 
·ylßdBuf
 = 
UÅoŞed
.
	`w¿µedBufãr
(
logD©a
.
	`g‘PaylßdCodecTy³
()

89 .
	`g‘In¡ªû
().
	`decom´ess
(
By‹Bufãr
.
	`w¿p
(
com´es£dA¼ayBuf
)));

92 ià(
·ylßdBuf
.
	`»adBy‹
(è!ğ
cÜfuPaylßdMagic
) {

93 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Must be ICorfuSerializable");

96 
v”siÚ
 = 
logD©a
.
	`g‘Glob®Add»ss
();

98 
LogEÁry
 
’Œy
 = (LogEÁryèLogEÁry.
	`de£rŸlize
(
·ylßdBuf
, 
nuÎ
, 
Œue
);

99 
M­
<
UUID
, 
Li¡
<
SMREÁry
>> 
»s
 = 
Ãw
 
HashM­
<>();

101 
’Œy
.
	`g‘Ty³
()) {

103 
SMR
:

104 
UUID
 
id
 = 
I‹¿bËs
.
	`g‘OÆyEËm’t
(
logD©a
.
	`g‘SŒ—ms
());

105 
Li¡
<
SMREÁry
> 
smrEÁry
 = 
Li¡s
.
	`ÃwA¼ayLi¡
((SMREÁryè
’Œy
);

106 
»s
.
	`put
(
id
, 
smrEÁry
);

108 
MULTISMR
:

109 
id
 = 
I‹¿bËs
.
	`g‘OÆyEËm’t
(
logD©a
.
	`g‘SŒ—ms
());

110 
MuÉiSMREÁry
 
muÉiSMREÁry
 = (MuÉiSMREÁryè
’Œy
;

111 
»s
.
	`put
(
id
, 
muÉiSMREÁry
.
	`g‘Upd©es
());

113 
MULTIOBJSMR
:

114 
MuÉiObjeùSMREÁry
 
muÉiObjeùSMREÁry
 = (MuÉiObjeùSMREÁryè
’Œy
;

115 
M­
.
EÁry
<
UUID
, 
MuÉiSMREÁry
> 
m­EÁry
 : 
muÉiObjeùSMREÁry
.
	`g‘EÁryM­
().
	`’ŒyS‘
()) {

116 
»s
.
	`put
(
m­EÁry
.
	`g‘Key
(), m­EÁry.
	`g‘V®ue
().
	`g‘Upd©es
());

119 
CHECKPOINT
:

120 
CheckpoštEÁry
 
ıEÁr›s
 = (CheckpoštEÁryè
’Œy
;

121 ià(
ıEÁr›s
.
	`g‘CpTy³
(è!ğ
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
CONTINUATION
è 
em±y
;

123 
v”siÚ
 = 
LÚg
.
	`decode
(
ıEÁr›s
.
	`g‘Diù
().
	`g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
SNAPSHOT_ADDRESS
));

124 
»s
.
	`put
(
logD©a
.
	`g‘Checkpoš‹dSŒ—mId
(), 
ıEÁr›s
.
	`g‘SmrEÁr›s
(
Œue
).
	`g‘Upd©es
());

127 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("UnknowÀty³ " + 
’Œy
.
	`g‘Ty³
());

129  
Ãw
 
	`O·queEÁry
(
v”siÚ
, 
»s
);

130 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/logprotocol/SMREntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

11 
impÜt
 
	glombok
.
	gG‘‹r
;

12 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

13 
impÜt
 
	glombok
.
	gNÚNuÎ
;

14 
impÜt
 
	glombok
.
	gToSŒšg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gCÜfuS”Ÿliz”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

20 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gba£
.
	gP»cÚd™iÚs
.
	gcheckS‹
;

25 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

26 @
ToSŒšg
(
ÿÎSu³r
 = 
Œue
)

27 @
NoArgsCÚ¡ruùÜ


28 @
Equ®sAndHashCode


29 
public
 cÏs 
	cSMREÁry
 
ex‹nds
 
LogEÁry
 
im¶em’ts
 
ISMRCÚsumabË
 {

34 @
Suµ»ssW¬nšgs
("checkstyle:MemberName")

35 @
G‘‹r


36 
´iv©e
 
SŒšg
 
SMRM‘hod
;

41 @
Suµ»ssW¬nšgs
("checkstyle:MemberName")

42 @
G‘‹r


43 
´iv©e
 
	mObjeù
[] 
	mSMRArgum’ts
;

48 @
G‘‹r


49 
´iv©e
 
IS”Ÿliz”
 
	m£rŸliz”Ty³
;

51 @
G‘‹r


52 
´iv©e
 
by‹
 
	m£rŸliz”Id
 = -1;

57 @
G‘‹r


58 
public
 
Œªs›Á
 
Objeù
 
	mundoRecÜd
;

63 @
G‘‹r


64 
public
 
boŞ—n
 
	mundßbË
;

67 @
G‘‹r


68 
public
 
Œªs›Á
 
Objeù
 
	mupÿÎResuÉ
;

71 @
G‘‹r


72 
public
 
Œªs›Á
 
boŞ—n
 
	mhaveUpÿÎResuÉ
 = 
çl£
;

75 
public
 
	$£tUpÿÎResuÉ
(
Objeù
 
»suÉ
) {

76 
upÿÎResuÉ
 = 
»suÉ
;

77 
haveUpÿÎResuÉ
 = 
Œue
;

81 
public
 
	$£tUndoRecÜd
(
Objeù
 
objeù
) {

82 
this
.
undoRecÜd
 = 
objeù
;

83 
undßbË
 = 
Œue
;

84 
	}
}

87 
public
 
	$ş—rUndoRecÜd
() {

88 
this
.
undoRecÜd
 = 
nuÎ
;

89 
undßbË
 = 
çl£
;

90 
	}
}

94 
public
 
SMREÁry
(
SŒšg
 
smrM‘hod
, @
NÚNuÎ
 
Objeù
[] 
smrArgum’ts
, 
IS”Ÿliz”
 
£rŸliz”
) {

95 
su³r
(
LogEÁryTy³
.
SMR
);

96 
	gthis
.
	gSMRM‘hod
 = 
smrM‘hod
;

97 
	gthis
.
	gSMRArgum’ts
 = 
smrArgum’ts
;

98 
	gthis
.
	g£rŸliz”Ty³
 = 
£rŸliz”
;

108 @
Ov”ride


109 
	$de£rŸlizeBufãr
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

110 
su³r
.
	`de£rŸlizeBufãr
(
b
, 
¹
);

111 
m‘hodL’gth
 = 
b
.
	`»adShÜt
();

112 
by‹
[] 
m‘hodBy‹s
 = 
Ãw
 by‹[
m‘hodL’gth
];

113 
b
.
	`»adBy‹s
(
m‘hodBy‹s
, 0, 
m‘hodL’gth
);

114 
SMRM‘hod
 = 
Ãw
 
	`SŒšg
(
m‘hodBy‹s
);

115 
by‹
 
£rŸliz”Id
 = 
b
.
	`»adBy‹
();

116 
by‹
 
numArgum’ts
 = 
b
.
	`»adBy‹
();

117 
Objeù
[] 
¬gum’ts
 = 
Ãw
 Objeù[
numArgum’ts
];

119 ià(!
İaque
) {

120 
£rŸliz”Ty³
 = 
S”Ÿliz”s
.
	`g‘S”Ÿliz”
(
£rŸliz”Id
);

122 
this
.
£rŸliz”Id
 = serializerId;

125 
by‹
 
¬g
 = 0;‡rg < 
numArgum’ts
;‡rg++) {

126 
Ën
 = 
b
.
	`»adIÁ
();

127 
By‹Buf
 
objBuf
 = 
b
.
	`¦iû
(b.
	`»ad”Index
(), 
Ën
);

128 ià(
İaque
) {

129 
by‹
[] 
¬gBy‹s
 = 
Ãw
 by‹[
Ën
];

130 
objBuf
.
	`»adBy‹s
(
¬gBy‹s
);

131 
¬gum’ts
[
¬g
] = 
¬gBy‹s
;

133 
¬gum’ts
[
¬g
] = 
£rŸliz”Ty³
.
	`de£rŸlize
(
objBuf
, 
¹
);

135 
b
.
	`skBy‹s
(
Ën
);

137 
SMRArgum’ts
 = 
¬gum’ts
;

138 
	}
}

144 
public
 
	$£ekToEnd
(
By‹Buf
 
b
) {

146 
by‹
 
magicBy‹
 = 
b
.
	`»adBy‹
();

147 
	`checkS‹
(
magicBy‹
 =ğ
CÜfuS”Ÿliz”
.
cÜfuPaylßdMagic
, "Not‡ ICorfuSerializable object");

149 
by‹
 
ty³
 = 
b
.
	`»adBy‹
();

150 
	`checkS‹
(
ty³
 =ğ
LogEÁryTy³
.
SMR
.
	`asBy‹
(), "Not‡ SMREntry!");

152 
m‘hodL’gth
 = 
b
.
	`»adShÜt
();

153 
b
.
	`skBy‹s
(
m‘hodL’gth
);

155 
b
.
	`»adBy‹
();

157 
numArgs
 = 
b
.
	`»adBy‹
();

158 
¬g
 = 0;‡rg < 
numArgs
;‡rg++) {

159 
Ën
 = 
b
.
	`»adIÁ
();

160 
b
.
	`skBy‹s
(
Ën
);

162 
	}
}

164 @
Ov”ride


165 
public
 
	$£rŸlize
(
By‹Buf
 
b
) {

166 
su³r
.
	`£rŸlize
(
b
);

167 
b
.
	`wr™eShÜt
(
SMRM‘hod
.
	`Ëngth
());

168 
b
.
	`wr™eBy‹s
(
SMRM‘hod
.
	`g‘By‹s
());

169 ià(
İaque
) {

171 ià(
£rŸliz”Id
 == -1) {

172 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("opaqueƒntry doesn't have‡ serializer id");

174 
b
.
	`wr™eBy‹
(
£rŸliz”Id
);

176 
b
.
	`wr™eBy‹
(
£rŸliz”Ty³
.
	`g‘Ty³
());

178 
b
.
	`wr™eBy‹
(
SMRArgum’ts
.
Ëngth
);

179 
A¼ays
.
	`¡»am
(
SMRArgum’ts
)

180 .
	`fÜEach
(
x
 -> {

181 
ËngthIndex
 = 
b
.
	`wr™”Index
();

182 
b
.
	`wr™eIÁ
(0);

183 ià(
İaque
) {

184 
b
.
	`wr™eBy‹s
((
by‹
[]è
x
);

186 
£rŸliz”Ty³
.
	`£rŸlize
(
x
, 
b
);

188 
Ëngth
 = 
b
.
	`wr™”Index
(è- 
ËngthIndex
 - 4;

189 
b
.
	`wr™”Index
(
ËngthIndex
);

190 
b
.
	`wr™eIÁ
(
Ëngth
);

191 
b
.
	`wr™”Index
(
ËngthIndex
 + 
Ëngth
 + 4);

193 
	}
}

195 @
Ov”ride


196 
public
 
	gLi¡
<
	gSMREÁry
> 
	$g‘SMRUpd©es
(
UUID
 
id
) {

199  
CŞËùiÚs
.
	`sšgËtÚLi¡
(
this
);

200 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ClientHandshakeHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlDu¶exHªdËr
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlPromi£
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gR—dTimeoutExû±iÚ
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gR—dTimeoutHªdËr
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gQueue
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

26 @
Slf4j


27 
public
 cÏs 
	cCl›ÁHªdshakeHªdËr
 
ex‹nds
 
	mChªÃlDu¶exHªdËr
 {

29 
´iv©e
 
fš®
 
UUID
 
	mş›ÁId
;

30 
´iv©e
 
fš®
 
UUID
 
	mnodeId
;

31 
´iv©e
 
fš®
 
	mhªdshakeTimeout
;

32 
´iv©e
 
fš®
 
HªdshakeS‹
 
	mhªdshakeS‹
;

33 
´iv©e
 
fš®
 
	mQueue
<
	mCÜfuMsg
> 
	mmes§ges
 = 
Ãw
 
LškedLi¡
<>();

34 
´iv©e
 
fš®
 
SŒšg
 
	mREAD_TIMEOUT_HANDLER
 = "readTimeoutHandler";

39 
public
 
	eCl›ÁHªdshakeEv’t
 {

40 
	mCONNECTED
,

41 
	mFAILED


51 
public
 
Cl›ÁHªdshakeHªdËr
(@
NÚNuÎ
 
UUID
 
ş›ÁId
, UUID 
£rv”Id
, 
hªdshakeTimeout
) {

52 
	gthis
.
	gş›ÁId
 = 
ş›ÁId
;

53 ià(
	g£rv”Id
 =ğ
nuÎ
) {

56 
this
.
nodeId
 = 
UUID
.
äomSŒšg
("00000000-0000-0000-0000-000000000000");

58 
	gthis
.
	gnodeId
 = 
£rv”Id
;

60 
	gthis
.
	ghªdshakeTimeout
 = 
hªdshakeTimeout
;

61 
	gthis
.
	ghªdshakeS‹
 = 
Ãw
 
HªdshakeS‹
();

71 @
Ov”ride


72 
public
 
	$chªÃlR—d
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
m
)

73 
throws
 
Exû±iÚ
 {

75 ià(
this
.
hªdshakeS‹
.
	`çed
()) {

80 ià(
this
.
hªdshakeS‹
.
	`com¶‘ed
()) {

83 
su³r
.
	`chªÃlR—d
(
ùx
, 
m
);

87 
CÜfuPaylßdMsg
<
HªdshakeRe¥Ú£
> 
hªdshakeRe¥Ú£
;

89 
Œy
 {

90 
hªdshakeRe¥Ú£
 = (
CÜfuPaylßdMsg
<
HªdshakeRe¥Ú£
>è
m
;

91 
log
.
	`šfo
("channelRead: Handshake Response„eceived. Removing {} from…ipeline.",

92 
READ_TIMEOUT_HANDLER
);

95 
ùx
.
	`p–še
().
	`»move
(
READ_TIMEOUT_HANDLER
).
	`hªdËrRemoved
(ctx);

96 } 
	`ÿtch
 (
CÏssCa¡Exû±iÚ
 
e
) {

97 
log
.
	`w¬n
("channelRead: Non-handshake message„eceived by handshake handler. " +

98 "S’d up¡»am oÆy iàhªdshaksucûeded.", 
e
);

99 ià(
this
.
hªdshakeS‹
.
	`com¶‘ed
()) {

101 
su³r
.
	`chªÃlR—d
(
ùx
, 
m
);

104 
Œy
 {

105 
CÜfuMsg
 
msg
 = (CÜfuMsgè
m
;

106 
log
.
	`debug
("chªÃlR—d: Drİpšg mes§ge: {}", 
msg
.
	`g‘MsgTy³
().
	`Çme
());

107 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

108 
log
.
	`”rÜ
("channelRead: Message„eceived is‚ot‡ valid CorfuMsgype.");

114 
UUID
 
£rv”Id
 = 
hªdshakeRe¥Ú£
.
	`g‘Paylßd
().
	`g‘S”v”Id
();

115 
SŒšg
 
cÜfuV”siÚ
 = 
hªdshakeRe¥Ú£
.
	`g‘Paylßd
().
	`g‘CÜfuV”siÚ
();

119 ià(
this
.
nodeId
.
	`equ®s
(
UUID
.
	`äomSŒšg
("00000000-0000-0000-0000-000000000000"))) {

120 
log
.
	`šfo
("channelRead:‚ode id matching is‚ot„equested by client.");

121 } ià(!
this
.
nodeId
.
	`equ®s
(
£rv”Id
)) {

124 
log
.
	`”rÜ
("channelRead: Handshake validation failed. Server‚ode id mismatch.");

125 
log
.
	`debug
("channelRead: Client opened socketo server [{}] instead, connectedo: [{}]",

126 
this
.
nodeId
, 
£rv”Id
);

127 
this
.
	`fœeHªdshakeFaed
(
ùx
);

131 
log
.
	`šfo
("chªÃlR—d: Hªdshaksucûeded. S”v” CÜfu V”siÚ: [{}]", 
cÜfuV”siÚ
);

132 
log
.
	`debug
("chªÃlR—d: Th”¬[{}] mes§ge š queutØbæushed.", 
this
.
mes§ges
.
	`size
());

134 !
mes§ges
.
	`isEm±y
()) {

135 
ùx
.
	`wr™eAndFlush
(
mes§ges
.
	`pŞl
());

139 
log
.
	`šfo
("channelRead: Removing handshake handler from…ipeline.");

140 
ùx
.
	`p–še
().
	`»move
(
this
);

141 
this
.
	`fœeHªdshakeSucûeded
(
ùx
);

142 
	}
}

150 @
Ov”ride


151 
public
 
	$chªÃlAùive
(
ChªÃlHªdËrCÚ‹xt
 
ùx
)

152 
throws
 
Exû±iÚ
 {

153 
log
.
	`šfo
("chªÃlAùive: Outgošg cÚÃùiÚƒ¡ablishedo: {}", 
ùx
.
	`chªÃl
().
	`»mÙeAdd»ss
());

156 
CÜfuMsg
 
hªdshake
 = 
CÜfuMsgTy³
.
HANDSHAKE_INITIATE
.
	`·ylßdMsg
(
Ãw
 
	`HªdshakeMsg
(
this
.
ş›ÁId
,his.
nodeId
));

158 
log
.
	`debug
("channelActive: Initiate handshake. Send handshake message.");

159 
ùx
.
	`wr™eAndFlush
(
hªdshake
);

160 
log
.
	`debug
("chªÃlAùive: Add {}ØchªÃÈp–še.", 
READ_TIMEOUT_HANDLER
);

161 
ùx
.
	`p–še
().
	`addBefÜe
(ùx.
	`Çme
(), 
READ_TIMEOUT_HANDLER
, 
Ãw
 
	`R—dTimeoutHªdËr
(
this
.
hªdshakeTimeout
));

162 
	}
}

170 @
Ov”ride


171 
public
 
	$chªÃlIÇùive
(
ChªÃlHªdËrCÚ‹xt
 
ùx
è
throws
 
Exû±iÚ
 {

172 
log
.
	`debug
("channelInactive: Channel closed.");

173 ià(!
this
.
hªdshakeS‹
.
	`com¶‘ed
()) {

174 
this
.
	`fœeHªdshakeFaed
(
ùx
);

176 
	}
}

185 @
Ov”ride


186 
public
 
	$exû±iÚCaught
(
ChªÃlHªdËrCÚ‹xt
 
ùx
,

187 
java
.
Ïng
.
ThrowabË
 
ÿu£
è
throws
 
Exû±iÚ
 {

188 
log
.
	`”rÜ
("exû±iÚCaught: Exû±iÚ {} caught.", 
ÿu£
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), cause);

189 ià(
ÿu£
 
š¡ªûof
 
R—dTimeoutExû±iÚ
) {

191 ià(
this
.
hªdshakeS‹
.
	`çed
()) {

192 
log
.
	`debug
("exceptionCaught: Handshakeimeout checker:‡lready failed.");

196 ià(!
this
.
hªdshakeS‹
.
	`com¶‘ed
()) {

199 
log
.
	`”rÜ
("exceptionCaught: Handshakeimeout checker:imed out." +

201 
this
.
hªdshakeS‹
.
	`£t
(
Œue
, 
çl£
);

204 
log
.
	`debug
("exceptionCaught: Handshakeimeout checker: discarded " +

208 ià(
ùx
.
	`chªÃl
().
	`isO³n
()) {

209 
ùx
.
	`chªÃl
().
	`şo£
();

211 
this
.
	`fœeHªdshakeFaed
(
ùx
);

213 
	}
}

223 @
Ov”ride


224 
public
 
	$wr™e
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
msg
, 
ChªÃlPromi£
 
´omi£
)

225 
throws
 
Exû±iÚ
 {

226 ià(
this
.
hªdshakeS‹
.
	`çed
()) {

233 ià(
this
.
hªdshakeS‹
.
	`com¶‘ed
()) {

234 
su³r
.
	`wr™e
(
ùx
, 
msg
, 
´omi£
);

238 
this
.
mes§ges
.
	`ofãr
((
CÜfuMsg
è
msg
);

240 
	}
}

247 
´iv©e
 
	$fœeHªdshakeFaed
(
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

248 
this
.
hªdshakeS‹
.
	`£t
(
Œue
,rue);

249 
log
.
	`”rÜ
("fireHandshakeFailed: Handshake Failed. Close Channel.");

251 
ùx
.
	`fœeU£rEv’tTrigg”ed
(
Cl›ÁHªdshakeEv’t
.
FAILED
);

252 
ùx
.
	`chªÃl
().
	`şo£
();

253 
	}
}

258 
´iv©e
 
	$fœeHªdshakeSucûeded
(
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

259 
this
.
hªdshakeS‹
.
	`£t
(
çl£
, 
Œue
);

261 
ùx
.
	`fœeU£rEv’tTrigg”ed
(
Cl›ÁHªdshakeEv’t
.
CONNECTED
);

262 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ClusterState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gSšguÏr
;

10 
impÜt
 
	glombok
.
	gToSŒšg
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

18 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

27 @
	gBud”


28 @
	gAÎArgsCÚ¡ruùÜ


29 @
	gToSŒšg


30 @
	gG‘‹r


31 @
Slf4j


32 
public
 cÏs 
	cClu¡”S‹
 {

41 @
SšguÏr


42 
´iv©e
 
fš®
 
	mImmubËM­
<
	mSŒšg
, 
	mNodeS‹
> 
	mnodes
;

44 @
NÚNuÎ


45 
´iv©e
 
fš®
 
	mImmubËLi¡
<
	mSŒšg
> 
	muÄe¥ÚsiveNodes
;

47 @
NÚNuÎ


48 
´iv©e
 
fš®
 
SŒšg
 
	mloÿlEndpošt
;

50 
public
 
	$size
() {

51  
nodes
.
	`size
();

54 
public
 
O±iÚ®
<
NodeS‹
> 
	$g‘Node
(
SŒšg
 
’dpošt
) {

55  
O±iÚ®
.
	`ofNuÎabË
(
nodes
.
	`g‘
(
’dpošt
));

56 
	}
}

64 
public
 
boŞ—n
 
	$isR—dy
() {

65 ià(
nodes
.
	`isEm±y
()) {

66 
log
.
	`”rÜ
("Invalid ClusterState: isƒmpty");

67  
çl£
;

70 ià(!
	`checkEpochs
()) {

71 
log
.
	`šfo
("Clu¡”S‹ i nÙ cÚsi¡’t: {}", 
nodes
);

72  
çl£
;

76 
NodeS‹
 
nodeS‹
 : 
nodes
.
	`v®ues
()) {

77 ià(
nodeS‹
.
	`g‘CÚÃùiv™y
().
	`g‘Ty³
(è=ğ
NodeCÚÃùiv™yTy³
.
NOT_READY
) {

78  
çl£
;

82  
Œue
;

83 
	}
}

85 
´iv©e
 
boŞ—n
 
	$checkEpochs
() {

86 
cu¼’tEpoch
 = -1;

88 
NodeS‹
 
nodeS‹
 : 
nodes
.
	`v®ues
()) {

89 
NodeCÚÃùiv™y
 
cÚÃùiv™y
 = 
nodeS‹
.
	`g‘CÚÃùiv™y
();

90 ià(
cu¼’tEpoch
 == -1) {

91 
cu¼’tEpoch
 = 
cÚÃùiv™y
.
	`g‘Epoch
();

95 ià(
cÚÃùiv™y
.
	`g‘Epoch
(è!ğ
cu¼’tEpoch
) {

96  
çl£
;

99  
Œue
;

100 
	}
}

102 
public
 
NodeCÚÃùiv™y
 
	$g‘LoÿlNodeCÚÃùiv™y
() {

103 
NodeS‹
 
nodeS‹
 = 
	`g‘Node
(
loÿlEndpošt
)

104 .
	`ÜEl£Throw
((è-> 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("NodnÙ found: " + 
loÿlEndpošt
));

106  
nodeS‹
.
	`g‘CÚÃùiv™y
();

107 
	}
}

109 
public
 
	gImmubËLi¡
<
	gSŒšg
> 
	$g‘PšgRe¥ÚsiveNodes
(){

110  
ImmubËLi¡
.
	`cİyOf
(
	`g‘LoÿlNodeCÚÃùiv™y
().
	`g‘CÚÃùedNodes
());

111 
	}
}

113 
public
 
Clu¡”S‹
 
budClu¡”S‹
(

114 
SŒšg
 
loÿlEndpošt
, 
ImmubËLi¡
<SŒšg> 
uÄe¥ÚsiveS”v”s
, 
NodeS‹
... 
¡©es
) {

116 
	gM­
<
	gSŒšg
, 
	gNodeS‹
> 
	gg¿ph
 = 
A¼ays
.
¡»am
(
¡©es
)

117 .
cŞËù
(
CŞËùÜs
.
toM­
(

118 
¡©e
 -> s‹.
g‘CÚÃùiv™y
().
g‘Endpošt
(),

119 
FunùiÚ
.
id’t™y
()

122  
	gClu¡”S‹
.
bud”
()

123 .
loÿlEndpošt
(localEndpoint)

124 .
nodes
(
ImmubËM­
.
cİyOf
(
g¿ph
))

125 .
uÄe¥ÚsiveNodes
(
uÄe¥ÚsiveS”v”s
)

126 .
bud
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

11 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

12 
impÜt
 
	glombok
.
	gD©a
;

13 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

14 
impÜt
 
	glombok
.
	gex³rim’l
.
	gAcûssÜs
;

19 @
	gD©a


20 @
AcûssÜs
(
chaš
 = 
Œue
)

21 @
NoArgsCÚ¡ruùÜ


22 @
AÎArgsCÚ¡ruùÜ


23 
public
 cÏs 
	cCÜfuMsg
 {

28 
fš®
 
m¬k”F›ld
 = 0xC0FC0FC0;

29 
	mM­
<
	mBy‹
, 
	mCÜfuMsgTy³
> 
	mty³M­
 =

30 
A¼ays
.<
CÜfuMsgTy³
>
¡»am
(CÜfuMsgTy³.
v®ues
())

31 .
cŞËù
(
CŞËùÜs
.
toM­
(
CÜfuMsgTy³
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

35 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviationaswordinname", "checkstyle:membername"})

36 
UUID
 
	gş›ÁID
;

41 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviationaswordinname", "checkstyle:membername"})

42 
	g»que¡ID
;

47 
	g•och
;

52 
By‹Buf
 
	gbuf
;

57 
CÜfuMsgTy³
 
	gmsgTy³
;

62 
PriÜ™yLev–
 
	g´iÜ™yLev–
 = PriÜ™yLev–.
NORMAL
;

72 
public
 
	$CÜfuMsg
(
CÜfuMsgTy³
 
ty³
) {

73 
this
.
msgTy³
 = 
ty³
;

74 
	}
}

85 
public
 
CÜfuMsg
 
	$de£rŸlize
(
By‹Buf
 
bufãr
) {

86 
m¬k”
 = 
bufãr
.
	`»adIÁ
();

87 ià(
m¬k”
 !ğ
m¬k”F›ld
) {

88 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Attempto deserialize‡ message which is‚ot‡ CorfuMsg, "

89 + "M¬k” = " + 
m¬k”
 + " butƒxpected 0xC0FC0FC0");

91 
UUID
 
ş›ÁId
 = 
Ãw
 
	`UUID
(
bufãr
.
	`»adLÚg
(), buffer.readLong());

92 
»que¡Id
 = 
bufãr
.
	`»adLÚg
();

93 
•och
 = 
bufãr
.
	`»adLÚg
();

94 
PriÜ™yLev–
 
´iÜ™y
 = PriÜ™yLev–.
ty³M­
.
	`g‘
(
bufãr
.
	`»adBy‹
());

95 
CÜfuMsgTy³
 
mes§ge
 = 
ty³M­
.
	`g‘
(
bufãr
.
	`»adBy‹
());

96 
CÜfuMsg
 
msg
 = 
mes§ge
.
	`g‘CÚ¡ruùÜ
().
	`cÚ¡ruù
();

98 
msg
.
ş›ÁID
 = 
ş›ÁId
;

99 
msg
.
»que¡ID
 = 
»que¡Id
;

100 
msg
.
•och
 =ƒpoch;

101 
msg
.
´iÜ™yLev–
 = 
´iÜ™y
;

102 
msg
.
msgTy³
 = 
mes§ge
;

103 
msg
.
	`äomBufãr
(
bufãr
);

104 
msg
.
buf
 = 
bufãr
;

105  
msg
;

106 
	}
}

113 
public
 
	$£rŸlize
(
By‹Buf
 
bufãr
) {

114 
bufãr
.
	`wr™eIÁ
(
m¬k”F›ld
);

115 ià(
ş›ÁID
 =ğ
nuÎ
) {

116 
bufãr
.
	`wr™eLÚg
(0L);

117 
bufãr
.
	`wr™eLÚg
(0L);

119 
bufãr
.
	`wr™eLÚg
(
ş›ÁID
.
	`g‘Mo¡SignifiÿÁB™s
());

120 
bufãr
.
	`wr™eLÚg
(
ş›ÁID
.
	`g‘L—¡SignifiÿÁB™s
());

122 
bufãr
.
	`wr™eLÚg
(
»que¡ID
);

123 
bufãr
.
	`wr™eLÚg
(
•och
);

124 
bufãr
.
	`wr™eBy‹
(
´iÜ™yLev–
.
	`asBy‹
());

125 
bufãr
.
	`wr™eBy‹
(
msgTy³
.
	`asBy‹
());

126 
	}
}

132 
public
 
	$äomBufãr
(
By‹Buf
 
bufãr
) {

134 
	}
}

139 
public
 
	$cİyBa£F›lds
(
CÜfuMsg
 
msg
) {

140 
this
.
ş›ÁID
 = 
msg
.clientID;

141 
this
.
•och
 = 
msg
.epoch;

142 
this
.
»que¡ID
 = 
msg
.requestID;

143 
this
.
´iÜ™yLev–
 = 
msg
.priorityLevel;

144 
	}
}

149 
public
 
	$»Ëa£
() {

150 ià(
buf
 !ğ
nuÎ
) {

151 
buf
.
	`»Ëa£
();

153 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuMsgType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜRe¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

14 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gLambdaM‘açùÜy
;

15 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdË
;

16 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

17 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodTy³
;

18 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gCÚ¡ruùÜ
;

23 @
	gRequœedArgsCÚ¡ruùÜ


24 @
AÎArgsCÚ¡ruùÜ


25 
public
 
	eCÜfuMsgTy³
 {

27 
PING
(0, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

28 
PONG
(1, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

29 
RESET
(2, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

30 
SEAL
(3, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(è{}, 
Œue
),

31 
ACK
(4, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

32 
WRONG_EPOCH
(5, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(è{}, 
Œue
),

33 
NACK
(6, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

34 
VERSION_REQUEST
(7, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

35 
VERSION_RESPONSE
(8, 
Ãw
 
Ty³Tok’
<
JSONPaylßdMsg
<
V”siÚInfo
>>(è{}, 
Œue
),

36 
NOT_READY
(9, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

39 
LAYOUT_REQUEST
(10, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(){}, 
Œue
),

40 
LAYOUT_RESPONSE
(11, 
Ty³Tok’
.
of
(
LayoutMsg
.
şass
), 
Œue
),

41 
LAYOUT_PREPARE
(12, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutP»·»Reque¡
>>(){}, 
Œue
),

42 
LAYOUT_PREPARE_REJECT
(13, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutP»·»Re¥Ú£
>>(){}),

43 
LAYOUT_PROPOSE
(14, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutPrİo£Reque¡
>>(){}, 
Œue
),

44 
LAYOUT_PROPOSE_REJECT
(15, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutPrİo£Re¥Ú£
>>(){}),

45 
LAYOUT_COMMITTED
(16, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutComm™‹dReque¡
>>(){}, 
Œue
),

46 
LAYOUT_QUERY
(17, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(){}),

47 
LAYOUT_BOOTSTRAP
(18, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutBoÙ¡¿pReque¡
>>(){}, 
Œue
),

48 
LAYOUT_NOBOOTSTRAP
(19, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

51 
TOKEN_REQ
(20, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Tok’Reque¡
>>(){}),

52 
TOKEN_RES
(21, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Tok’Re¥Ú£
>>(){}),

53 
BOOTSTRAP_SEQUENCER
(22, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Sequ’ûrRecov”yMsg
>>(){}),

54 
SEQUENCER_TRIM_REQ
(23, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>() {}),

55 
SEQUENCER_METRICS_REQUEST
(24, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

56 
SEQUENCER_METRICS_RESPONSE
(25, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Sequ’ûrM‘rics
>>(){}, 
Œue
),

57 
STREAMS_ADDRESS_REQUEST
(26, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
SŒ—msAdd»ssReque¡
>>(){}),

58 
STREAMS_ADDRESS_RESPONSE
(27, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
SŒ—msAdd»ssRe¥Ú£
>>(){}),

61 
WRITE
(30, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Wr™eReque¡
>>() {}),

62 
READ_REQUEST
(31, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
R—dReque¡
>>() {}),

63 
READ_RESPONSE
(32, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
R—dRe¥Ú£
>>() {}),

64 
MULTIPLE_READ_REQUEST
(35, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
MuÉËR—dReque¡
>>() {}),

65 
PREFIX_TRIM
(38, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
TrimReque¡
>>() {}),

66 
TAIL_REQUEST
(41, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
TasReque¡
>>(){}),

67 
TAIL_RESPONSE
(42, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
TasRe¥Ú£
>>(){}),

68 
COMPACT_REQUEST
(43, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

69 
FLUSH_CACHE
(44, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

70 
TRIM_MARK_REQUEST
(45, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

71 
TRIM_MARK_RESPONSE
(46, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(){}),

72 
RESET_LOGUNIT
(47, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(){}, 
Œue
),

73 
LOG_ADDRESS_SPACE_REQUEST
(48, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

74 
LOG_ADDRESS_SPACE_RESPONSE
(49, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
SŒ—msAdd»ssRe¥Ú£
>>(){}),

76 
WRITE_OK
(50, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

77 
ERROR_TRIMMED
(51, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

78 
ERROR_OVERWRITE
(52, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
IÁeg”
>>(){}, 
Œue
),

79 
ERROR_OOS
(53, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

80 
ERROR_RANK
(54, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

81 
ERROR_NOENTRY
(55, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

82 
RANGE_WRITE
(56, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
RªgeWr™eMsg
>>(){}),

83 
ERROR_DATA_CORRUPTION
(57, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LÚg
>>(){}),

84 
ERROR_DATA_OUTRANKED
(58, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

85 
ERROR_VALUE_ADOPTED
(59,
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
R—dRe¥Ú£
>>() {}),

88 
LAYOUT_ALREADY_BOOTSTRAP
(60, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

89 
LAYOUT_PREPARE_ACK
(61, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LayoutP»·»Re¥Ú£
>>(){}, 
Œue
),

90 
RESTART
(62, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

91 
KEEP_ALIVE
(63, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

94 
MANAGEMENT_BOOTSTRAP_REQUEST
(70, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Layout
>>(){}, 
Œue
),

95 
MANAGEMENT_NOBOOTSTRAP_ERROR
(71, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

96 
MANAGEMENT_ALREADY_BOOTSTRAP_ERROR
(72, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

97 
MANAGEMENT_HEALING_DETECTED
(73, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
D‘eùÜMsg
>>(){}, 
Œue
),

98 
MANAGEMENT_FAILURE_DETECTED
(74, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
D‘eùÜMsg
>>(){}, 
Œue
),

99 
ORCHESTRATOR_REQUEST
(77, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Orche¡¿tÜMsg
>>(è{}, 
Œue
),

100 
ORCHESTRATOR_RESPONSE
(78, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Orche¡¿tÜRe¥Ú£
>>(è{}, 
Œue
),

101 
MANAGEMENT_LAYOUT_REQUEST
(79, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
), 
Œue
),

104 
HANDSHAKE_INITIATE
(80, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
HªdshakeMsg
>>(è{}, 
Œue
),

105 
HANDSHAKE_RESPONSE
(81, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
HªdshakeRe¥Ú£
>>(è{}, 
Œue
),

107 
NODE_STATE_REQUEST
(82, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

108 
NODE_STATE_RESPONSE
(83, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
NodeS‹
>>(){}, 
Œue
),

110 
FAILURE_DETECTOR_METRICS_REQUEST
(84, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

111 
FAILURE_DETECTOR_METRICS_RESPONSE
(85, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
NodeS‹
>>(){}, 
Œue
),

113 
KNOWN_ADDRESS_REQUEST
(86, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
KnownAdd»ssReque¡
>>() {}),

114 
KNOWN_ADDRESS_RESPONSE
(87, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
KnownAdd»ssRe¥Ú£
>>() {}),

116 
ERROR_SERVER_EXCEPTION
(200, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
Exû±iÚMsg
>>(è{}, 
Œue
),

118 
LOG_REPLICATION_ENTRY
(201, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LogR•liÿtiÚEÁry
>>(è{}, 
Œue
),

119 
LOG_REPLICATION_NEGOTIATION_REQUEST
(202, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

120 
LOG_REPLICATION_NEGOTIATION_RESPONSE
(203, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
>>(è{}, 
Œue
),

122 
LOG_REPLICATION_QUERY_LEADERSHIP
(204, 
Ty³Tok’
.
of
(
CÜfuMsg
.
şass
)),

123 
LOG_REPLICATION_QUERY_LEADERSHIP_RESPONSE
(205, 
Ãw
 
Ty³Tok’
<
CÜfuPaylßdMsg
<
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
>>(){}, 
Œue
),

127 
public
 
fš®
 
	mty³
;

128 
public
 
fš®
 
	mTy³Tok’
<? 
ex‹nds
 
	mCÜfuMsg
> 
	mmes§geTy³
;

129 
public
 
BoŞ—n
 
	mignÜeEpoch
 = 
çl£
;

131 
	mpublic
 <
	mT
> 
	mCÜfuPaylßdMsg
<T> 
·ylßdMsg
(
T
 
·ylßd
) {

133  
Ãw
 
	mCÜfuPaylßdMsg
<
	mT
>(
	mthis
, 
	m·ylßd
);

136 
public
 
CÜfuMsg
 
msg
() {

137  
Ãw
 
CÜfuMsg
(
this
);

140 @
FunùiÚ®IÁ”çû


141 
š‹rçû
 
	mMes§geCÚ¡ruùÜ
<
	mT
> {

142 
T
 
cÚ¡ruù
();

145 @
G‘‹r
(
Ïzy
 = 
Œue
)

146 
´iv©e
 
fš®
 
Mes§geCÚ¡ruùÜ
<? 
ex‹nds
 
CÜfuMsg
> 
cÚ¡ruùÜ
 = 
»sŞveCÚ¡ruùÜ
();

148 
public
 
by‹
 
asBy‹
() {

149  (
	mby‹
è
	mty³
;

153 
´iv©e
 
	mjava
.
	mÏng
.
	mšvoke
.
	mM‘hodHªdËs
.
Lookup
 
	mlookup
 = 
M‘hodHªdËs
.
lookup
();

156 @
Suµ»ssW¬nšgs
("unchecked")

157 
´iv©e
 
	mMes§geCÚ¡ruùÜ
<? 
ex‹nds
 
	mCÜfuMsg
> 
»sŞveCÚ¡ruùÜ
() {

159 
	mŒy
 {

160 
CÚ¡ruùÜ
 
	mt
 = 
mes§geTy³
.
g‘RawTy³
().
g‘CÚ¡ruùÜ
();

161 
M‘hodHªdË
 
	mmh
 = 
lookup
.
uÄeæeùCÚ¡ruùÜ
(
t
);

162 
M‘hodTy³
 
	mmt
 = M‘hodTy³.
m‘hodTy³
(
Objeù
.
şass
);

163 
	mŒy
 {

164  (
	mMes§geCÚ¡ruùÜ
<? 
ex‹nds
 
	mCÜfuMsg
>è
	mLambdaM‘açùÜy
.
m‘açùÜy
(

165 
lookup
, "construct",

166 
M‘hodTy³
.
m‘hodTy³
(
Mes§geCÚ¡ruùÜ
.
şass
),

167 
mt
, 
mh
, mh.
ty³
())

168 .
g‘T¬g‘
().
švokeExaù
();

169 } 
ÿtch
 (
ThrowabË
 
th
) {

170 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
th
);

172 } 
ÿtch
 (
NoSuchM‘hodExû±iÚ
 
nsme
) {

173 
throw
 
Ãw
 
RuÁimeExû±iÚ
("CorfuMsgs must include‡‚o-arg constructor!");

174 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

175 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuPayload.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

12 @
	gInh”™ed


13 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

14 @
	$T¬g‘
(
EËm’tTy³
.
TYPE
)

15 
public
 @
š‹rçû
 
CÜfuPaylßd
 {

17 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuPayloadMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gP¬am‘”izedTy³
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

23 @
NoArgsCÚ¡ruùÜ


24 
public
 
şass
 
	gCÜfuPaylßdMsg
<
	gT
> 
ex‹nds
 
	gCÜfuMsg
 {

29 @
G‘‹r


30 
´iv©e
 
T
 
	g·ylßd
;

33 
public
 
CÜfuPaylßdMsg
(
CÜfuMsgTy³
 
msgTy³
, 
T
 
·ylßd
) {

34 
su³r
(
msgTy³
);

35 
	gthis
.
	g·ylßd
 = 
·ylßd
;

43 @
Ov”ride


44 
public
 
£rŸlize
(
By‹Buf
 
bufãr
) {

45 
	gsu³r
.
£rŸlize
(
bufãr
);

46 
	gICÜfuPaylßd
.
£rŸlize
(
bufãr
, 
·ylßd
);

55 @
	gOv”ride


56 @
Suµ»ssW¬nšgs
("unchecked")

57 
public
 
äomBufãr
(
By‹Buf
 
bufãr
) {

58 
	g·ylßd
 = (
T
è
ICÜfuPaylßd
.
äomBufãr
(
bufãr
,

59 (
CÏss
)((
P¬am‘”izedTy³
)
msgTy³
.
mes§geTy³
.
g‘Ty³
())

60 .
g‘Aùu®Ty³Argum’ts
()[0]);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/DataType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

10 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

11 
impÜt
 
	glombok
.
	gG‘‹r
;

16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
D©aTy³
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gD©aTy³
> {

18 
DATA
(0, 
Œue
),

19 
EMPTY
(1, 
Œue
),

20 
HOLE
(2, 
Œue
),

21 
TRIMMED
(3, 
Œue
),

22 
RANK_ONLY
(4, 
Œue
);

24 
fš®
 
	gv®
;

26 @
G‘‹r


27 
´iv©e
 
boŞ—n
 
	gm‘ad©aAw¬e
;

29 
by‹
 
asBy‹
() {

30  (
	gby‹
è
	gv®
;

33 @
Ov”ride


34 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

35 
	gbuf
.
wr™eBy‹
(
asBy‹
());

38 
public
 
fš®
 
	gM­
<
	gBy‹
, 
	gD©aTy³
> 
	gty³M­
 =

39 
A¼ays
.
¡»am
(
D©aTy³
.
v®ues
())

40 .
cŞËù
(
CŞËùÜs
.
toM­
(
D©aTy³
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/DetectorMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

7 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

8 
impÜt
 
	glombok
.
	gD©a
;

14 @
	gD©a


15 @
AÎArgsCÚ¡ruùÜ


16 
public
 
şass
 
D‘eùÜMsg
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gD‘eùÜMsg
> {

17 
´iv©e
 
LÚg
 
	gd‘eùÜEpoch
;

18 
´iv©e
 
	gS‘
<
	gSŒšg
> 
	gçedNodes
;

19 
´iv©e
 
	gS‘
<
	gSŒšg
> 
	gh—ËdNodes
;

21 
public
 
D‘eùÜMsg
(
By‹Buf
 
buf
) {

22 
	gd‘eùÜEpoch
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

23 
	gçedNodes
 = 
ICÜfuPaylßd
.
£tFromBufãr
(
buf
, 
SŒšg
.
şass
);

24 
	gh—ËdNodes
 = 
ICÜfuPaylßd
.
£tFromBufãr
(
buf
, 
SŒšg
.
şass
);

27 @
Ov”ride


28 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

29 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
d‘eùÜEpoch
);

30 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
çedNodes
);

31 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
h—ËdNodes
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ExceptionMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

12 
public
 
şass
 
Exû±iÚMsg
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gExû±iÚMsg
> {

15 @
G‘‹r


16 
fš®
 
ThrowabË
 
	gthrowabË
;

22 
public
 
Exû±iÚMsg
(
ThrowabË
 
t
) {

23 
	gthrowabË
 = 
t
;

27 
public
 şas 
	cS”Ÿliz©iÚFaedExû±iÚ
 
ex‹nds
 
	gExû±iÚ
 {

30 @
G‘‹r


31 
public
 
fš®
 
SŒšg
 
	gexû±iÚCÏssName
;

37 
public
 
S”Ÿliz©iÚFaedExû±iÚ
(@
NÚnuÎ
 
CÏss
<? 
ex‹nds
 
ThrowabË
> 
exû±iÚCls
) {

38 
su³r
("Exû±iÚ " + 
exû±iÚCls
.
g‘Name
() + " failed serialization");

39 
	gthis
.
	gexû±iÚCÏssName
 = 
exû±iÚCls
.
g‘Name
();

44 
public
 şas 
	cDe£rŸliz©iÚFaedExû±iÚ
 
ex‹nds
 
	gExû±iÚ
 {

47 
public
 
De£rŸliz©iÚFaedExû±iÚ
() {

48 
su³r
("Remoteƒxception failed deserialization");

56 
public
 
	$Exû±iÚMsg
(
By‹Buf
 
b
) {

57 
ThrowabË
 
t
;

58 
Œy
 {

59 
t
 = (
ThrowabË
è
S”Ÿliz”s
.
JAVA
.
	`de£rŸlize
(
b
, 
nuÎ
);

60 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

61 
t
 = 
Ãw
 
	`De£rŸliz©iÚFaedExû±iÚ
();

63 
throwabË
 = 
t
;

64 
	}
}

70 @
Ov”ride


71 
public
 
	$doS”Ÿlize
(
By‹Buf
 
buf
) {

72 
Œy
 {

73 
S”Ÿliz”s
.
JAVA
.
	`£rŸlize
(
throwabË
, 
buf
);

74 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

75 
S”Ÿliz”s
.
JAVA
.
	`£rŸlize
(
Ãw
 
	`S”Ÿliz©iÚFaedExû±iÚ
(
throwabË
.
	`g‘CÏss
()), 
buf
);

77 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/HandshakeMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

8 
impÜt
 
	glombok
.
	gD©a
;

15 @
	gCÜfuPaylßd


16 @
	gD©a


17 @
AÎArgsCÚ¡ruùÜ


18 
public
 
şass
 
HªdshakeMsg
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gHªdshakeMsg
> {

19 
´iv©e
 
UUID
 
	gş›ÁId
;

20 
´iv©e
 
UUID
 
	g£rv”Id
;

27 
public
 
HªdshakeMsg
(
By‹Buf
 
buf
) {

28 
	gş›ÁId
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
UUID
.
şass
);

29 
	g£rv”Id
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
UUID
.
şass
);

32 @
Ov”ride


33 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

34 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
ş›ÁId
);

35 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
£rv”Id
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/HandshakeResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

8 
impÜt
 
	glombok
.
	gD©a
;

15 @
	gCÜfuPaylßd


16 @
	gD©a


17 @
AÎArgsCÚ¡ruùÜ


18 
public
 
şass
 
HªdshakeRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gHªdshakeRe¥Ú£
> {

19 
´iv©e
 
UUID
 
	g£rv”Id
;

20 
´iv©e
 
SŒšg
 
	gcÜfuV”siÚ
;

22 
public
 
HªdshakeRe¥Ú£
(
By‹Buf
 
buf
) {

23 
	g£rv”Id
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
UUID
.
şass
);

24 
	gcÜfuV”siÚ
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
);

27 @
Ov”ride


28 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

29 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
£rv”Id
);

30 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
cÜfuV”siÚ
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/HandshakeState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

8 
public
 cÏs 
	cHªdshakeS‹
 {

14 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mhªdshakeFaed
;

16 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mhªdshakeCom¶‘e
;

21 
public
 
	$HªdshakeS‹
() {

22 
this
.
hªdshakeFaed
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

23 
this
.
hªdshakeCom¶‘e
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

31 
public
 
	$£t
(
boŞ—n
 
çed
, boŞ—À
com¶‘e
){

32 
this
.
hªdshakeFaed
.
	`£t
(
çed
);

33 
this
.
hªdshakeCom¶‘e
.
	`£t
(
com¶‘e
);

34 
	}
}

41 
public
 
boŞ—n
 
	$çed
() {

42  
this
.
hªdshakeFaed
.
	`g‘
();

43 
	}
}

50 
public
 
boŞ—n
 
	$com¶‘ed
() {

51  
this
.
hªdshakeCom¶‘e
.
	`g‘
();

52 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ICorfuPayload.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gBoundTy³
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gRªge
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gRªgeS‘
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufIÅutSŒ—m
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufOuutSŒ—m
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
.
	gCheckpoštEÁryTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
.
	gD©aRªk
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gJsÚUts
;

24 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

26 
impÜt
 
	gjava
.
	gio
.
	gD©aOuutSŒ—m
;

27 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

28 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gC®lS™e
;

29 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gLambdaM‘açùÜy
;

30 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdË
;

31 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

32 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
.
	gLookup
;

33 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodTy³
;

34 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gCÚ¡ruùÜ
;

35 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

36 
impÜt
 
	gjava
.
	gut
.
	gEnumM­
;

37 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

38 
impÜt
 
	gjava
.
	gut
.
	gM­
;

39 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

40 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

46 
public
 
š‹rçû
 
	gICÜfuPaylßd
<
	gT
> {

48 @
FunùiÚ®IÁ”çû


49 
š‹rçû
 
	gPaylßdCÚ¡ruùÜ
<
	gT
> {

50 
T
 
cÚ¡ruù
(
By‹Buf
 
buf
);

53 
	gCÚcu¼’tHashM­
<
	gCÏss
<?>, 
	gPaylßdCÚ¡ruùÜ
<?>> 
	gcÚ¡ruùÜM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>(

54 
ImmubËM­
.<
CÏss
<?>, 
	gPaylßdCÚ¡ruùÜ
<?>>
bud”
()

55 .
put
(
By‹
.
şass
, 
By‹Buf
::
»adBy‹
)

56 .
put
(
IÁeg”
.
şass
, 
By‹Buf
::
»adIÁ
)

57 .
put
(
LÚg
.
şass
, 
By‹Buf
::
»adLÚg
)

58 .
put
(
BoŞ—n
.
şass
, 
By‹Buf
::
»adBoŞ—n
)

59 .
put
(
DoubË
.
şass
, 
By‹Buf
::
»adDoubË
)

60 .
put
(
Flßt
.
şass
, 
By‹Buf
::
»adFlßt
)

61 .
put
(
SŒšg
.
şass
, 
x
 -> {

62 
numBy‹s
 = 
x
.
»adIÁ
();

63 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
numBy‹s
];

64 
x
.
»adBy‹s
(
by‹s
);

65  
Ãw
 
SŒšg
(
by‹s
);

67 .
put
(
Layout
.
şass
, 
x
 -> {

68 
Ëngth
 = 
x
.
»adIÁ
();

69 
by‹
[] 
by‹A¼ay
 = 
Ãw
 by‹[
Ëngth
];

70 
x
.
»adBy‹s
(
by‹A¼ay
, 0, 
Ëngth
);

71 
SŒšg
 
¡r
 = 
Ãw
 SŒšg(
by‹A¼ay
, 
Snd¬dCh¬£ts
.
UTF_8
);

72  
JsÚUts
.
·r£r
.
äomJsÚ
(
¡r
, 
Layout
.
şass
);

74 .
put
(
D©aRªk
.
şass
, 
x
 -> 
Ãw
 D©aRªk(x.
»adLÚg
(),‚ew 
UUID
(x.readLong(), x.readLong())))

75 .
put
(
CheckpoštEÁryTy³
.
şass
, 
x
 -> CheckpoštEÁryTy³.
ty³M­
.
g‘
(x.
»adBy‹
()))

76 .
put
(
Codec
.
Ty³
.
şass
, 
x
 -> Codec.
g‘CodecTy³ById
(x.
»adIÁ
()))

77 .
put
(
UUID
.
şass
, 
x
 -> 
Ãw
 UUID(x.
»adLÚg
(), x.readLong()))

78 .
put
(
by‹
[].
şass
, 
x
 -> {

79 
Ëngth
 = 
x
.
»adIÁ
();

80 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
Ëngth
];

81 
x
.
»adBy‹s
(
by‹s
);

82  
by‹s
;

84 .
put
(
By‹Buf
.
şass
, 
x
 -> {

85 
by‹s
 = 
x
.
»adIÁ
();

86 
By‹Buf
 
b
 = 
x
.
»šedSliû
(x.
»ad”Index
(), 
by‹s
);

87 
x
.
»ad”Index
(x.»ad”Index(è+ 
by‹s
);

88  
b
;

90 .
put
(
SŒ—mAdd»ssRªge
.
şass
, 
bufãr
 ->

91 
Ãw
 
SŒ—mAdd»ssRªge
Òew 
UUID
(
bufãr
.
»adLÚg
(), buffer.readLong()),

92 
bufãr
.
»adLÚg
(), buffer.readLong()))

93 .
put
(
SŒ—mAdd»ssS·û
.
şass
, 
bufãr
 -> {

94 
ŒimM¬k
 = 
bufãr
.
»adLÚg
();

95 
Rßršg64NavigabËM­
 
m­
 = 
Ãw
 Roaring64NavigableMap();

96 
Œy
 (
By‹BufIÅutSŒ—m
 
šputSŒ—m
 = 
Ãw
 By‹BufIÅutSŒ—m(
bufãr
)) {

97 
m­
.
de£rŸlize
(
šputSŒ—m
);

98  
Ãw
 
SŒ—mAdd»ssS·û
(
ŒimM¬k
, 
m­
);

99 } 
ÿtch
 (
IOExû±iÚ
 
iÛ
) {

100 
throw
 
Ãw
 
S”Ÿliz”Exû±iÚ
("Exception when‡ttemptingo " +

101 "de£rŸliz¡»am‡dd»s ¥aû.", 
iÛ
);

104 .
put
(
LogR•liÿtiÚEÁryM‘ad©a
.
şass
, 
bufãr
 -> {

105 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
Ãw
 LogReplicationEntryMetadata();

106 
m‘ad©a
.
£tS™eEpoch
(
bufãr
.
»adLÚg
());

107 
m‘ad©a
.
£tMes§geM‘ad©aTy³
(
Mes§geTy³
.
äomV®ue
(
bufãr
.
»adIÁ
()));

108 
m‘ad©a
.
£tTime¡amp
(
bufãr
.
»adLÚg
());

109 
m‘ad©a
.
£tP»viousTime¡amp
(
bufãr
.
»adLÚg
());

110 
m‘ad©a
.
£tSyncReque¡Id
(
Ãw
 
UUID
(
bufãr
.
»adLÚg
(), buffer.readLong()));

111 
m‘ad©a
.
£tSÇpshÙTime¡amp
(
bufãr
.
»adLÚg
());

112 
m‘ad©a
.
£tSÇpshÙSyncSeqNum
(
bufãr
.
»adLÚg
());

113  
m‘ad©a
;

115 .
bud
()

122 
Lookup
 
	glookup
 = 
M‘hodHªdËs
.
lookup
();

124 <
	gT
> 
T
 
äomBufãr
(
by‹
[] 
d©a
, 
CÏss
<T> 
şs
) {

125 
By‹Buf
 
	gbufãr
 = 
UÅoŞed
.
w¿µedBufãr
(
d©a
);

126  
äomBufãr
(
bufãr
, 
şs
);

137 @
Suµ»ssW¬nšgs
("unchecked")

138 <
	gT
> 
T
 
äomBufãr
(
By‹Buf
 
buf
, 
CÏss
<T> 
şs
) {

139 ià(
	gcÚ¡ruùÜM­
.
cÚšsKey
(
şs
)) {

140  (
	gT
è
	gcÚ¡ruùÜM­
.
g‘
(
şs
).
cÚ¡ruù
(
buf
);

143 ià(
	gşs
.
isEnum
()) {

145 
	gŒy
 {

146 
	gM­
<
	gBy‹
, 
	gT
> 
	g’umM­
 = (
M­
<
By‹
, T>è
	gşs
.
g‘Deş¬edF›ld
("ty³M­").
g‘
(
nuÎ
);

147 
	gcÚ¡ruùÜM­
.
put
(
şs
, 
x
 -> 
’umM­
.
g‘
(x.
»adBy‹
()));

148  (
	gT
è
	gcÚ¡ruùÜM­
.
g‘
(
şs
).
cÚ¡ruù
(
buf
);

149 } 
ÿtch
 (
NoSuchF›ldExû±iÚ
 
e
) {

150 
throw
 
Ãw
 
RuÁimeExû±iÚ
("onlyƒnums with‡ypeMap‡re supported!");

151 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

152 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

156 ià(!
	gICÜfuPaylßd
.
	gşass
.
isAssigÇbËFrom
(
şs
)) {

157 
throw
 
Ãw
 
RuÁimeExû±iÚ
("UnknowÀşas " + 
şs
 + " for deserialization");

161 
	gŒy
 {

162 
	gCÚ¡ruùÜ
<?> 
	gt
 = 
şs
.
g‘CÚ¡ruùÜ
(
By‹Buf
.
şass
);

163 
M‘hodHªdË
 
	gmh
 = 
lookup
.
uÄeæeùCÚ¡ruùÜ
(
t
);

164 
M‘hodTy³
 
	gmt
 = M‘hodTy³.
m‘hodTy³
(
Objeù
.
şass
, 
By‹Buf
.class);

166 
	gŒy
 {

167 
C®lS™e
 
	gm‘açùÜy
 = 
LambdaM‘açùÜy
.
m‘açùÜy
(

168 
lookup
,

170 
M‘hodTy³
.
m‘hodTy³
(
PaylßdCÚ¡ruùÜ
.
şass
),

171 
mt
, 
mh
, mh.
ty³
()

173 
	gcÚ¡ruùÜM­
.
put
(
şs
, (
PaylßdCÚ¡ruùÜ
<
T
>è
m‘açùÜy
.
g‘T¬g‘
().
švokeExaù
());

174  (
	gT
è
	gcÚ¡ruùÜM­
.
g‘
(
şs
).
cÚ¡ruù
(
buf
);

175 } 
ÿtch
 (
ThrowabË
 
th
) {

176 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
th
);

178 } 
ÿtch
 (
NoSuchM‘hodExû±iÚ
 
nsme
) {

179 
throw
 
Ãw
 
RuÁimeExû±iÚ
("CorfuPayloads must include‡ ByteBuf " +

180 "cÚ¡ruùÜ! fÜ cÏss: " + 
şs
.
toSŒšg
());

181 } 
ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

182 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

189 @
Suµ»ssW¬nšgs
("unchecked")

190 <
	gT
> 
T
 
äomBufãr
(
By‹Buf
 
buf
, 
Ty³Tok’
<T> 
tok’
) {

191 
	gCÏss
<?> 
	g¿wTy³
 = 
tok’
.
g‘RawTy³
();

193 ià(
	g¿wTy³
.
isAssigÇbËFrom
(
M­
.
şass
)) {

194  (
	gT
è
m­FromBufãr
(

195 
buf
,

196 
tok’
.
»sŞveTy³
(
M­
.
şass
.
g‘Ty³P¬am‘”s
()[0]).
g‘RawTy³
(),

197 
tok’
.
»sŞveTy³
(
M­
.
şass
.
g‘Ty³P¬am‘”s
()[1]).
g‘RawTy³
()

201 ià(
	g¿wTy³
.
isAssigÇbËFrom
(
S‘
.
şass
)) {

202  (
	gT
è
£tFromBufãr
(

203 
buf
,

204 
tok’
.
»sŞveTy³
(
S‘
.
şass
.
g‘Ty³P¬am‘”s
()[0]).
g‘RawTy³
()

208  (
	gT
è
äomBufãr
(
buf
, 
¿wTy³
);

223 <
	gK
, 
	gV
> 
	gM­
<K, V> 
m­FromBufãr
(
By‹Buf
 
buf
, 
CÏss
<
K
> 
keyCÏss
, CÏss<
V
> 
v®ueCÏss
) {

224 
	gnumEÁr›s
 = 
buf
.
»adIÁ
();

225 
	gImmubËM­
.
	gBud”
<
	gK
, 
	gV
> 
	gbud”
 = 
ImmubËM­
.
bud”
();

226 
	gi
 = 0; i < 
	gnumEÁr›s
; i++) {

227 
	gbud”
.
put
(
äomBufãr
(
buf
, 
keyCÏss
), fromBufãr(buf, 
v®ueCÏss
));

229  
	gbud”
.
bud
();

241 <
	gV
> 
	gS‘
<V> 
£tFromBufãr
(
By‹Buf
 
buf
, 
CÏss
<
V
> 
v®ueCÏss
) {

242 
	gnumEÁr›s
 = 
buf
.
»adIÁ
();

243 
	gImmubËS‘
.
	gBud”
<
	gV
> 
	gbud”
 = 
ImmubËS‘
.
bud”
();

244 
	gi
 = 0; i < 
	gnumEÁr›s
; i++) {

245 
	gbud”
.
add
(
äomBufãr
(
buf
, 
v®ueCÏss
));

247  
	gbud”
.
bud
();

259 <
	gV
> 
	gLi¡
<V> 
li¡FromBufãr
(
By‹Buf
 
buf
, 
CÏss
<
V
> 
v®ueCÏss
) {

260 
	gnumEÁr›s
 = 
buf
.
»adIÁ
();

261 
	gImmubËLi¡
.
	gBud”
<
	gV
> 
	gbud”
 = 
ImmubËLi¡
.
bud”
();

262 
	gi
 = 0; i < 
	gnumEÁr›s
; i++) {

263 
	gbud”
.
add
(
äomBufãr
(
buf
, 
v®ueCÏss
));

265  
	gbud”
.
bud
();

278 <
K
 
ex‹nds
 
	gEnum
<
	gK
> & 
	gITy³dEnum
<K>, 
	gV
> 
	gEnumM­
<K, V> 
’umM­FromBufãr
(

279 
By‹Buf
 
buf
, 
CÏss
<
K
> 
keyCÏss
) {

281 
	gEnumM­
<
	gK
, 
	gV
> 
	gm‘ad©aM­
 = 
Ãw
 
EnumM­
<>(
keyCÏss
);

282 
by‹
 
	gnumEÁr›s
 = 
buf
.
»adBy‹
();

283 
	gnumEÁr›s
 > 0 && 
	gbuf
.
isR—dabË
()) {

284 
K
 
	gty³
 = 
äomBufãr
(
buf
, 
keyCÏss
);

285 
V
 
	gv®ue
 = (Vè
äomBufãr
(
buf
, 
ty³
.
g‘CompÚ’tTy³
());

286 
	gm‘ad©aM­
.
put
(
ty³
, 
v®ue
);

287 
	gnumEÁr›s
--;

289  
	gm‘ad©aM­
;

299 @
Suµ»ssW¬nšgs
("unchecked")

300 <
	gT
> 
£rŸlize
(
By‹Buf
 
bufãr
, 
T
 
·ylßd
) {

303 ià(
·ylßd
 
š¡ªûof
 
	gICÜfuPaylßd
) {

304 ((
	gICÜfuPaylßd
<?>è
	g·ylßd
).
doS”Ÿlize
(
bufãr
);

305 } ià(
·ylßd
 
š¡ªûof
 
	gBy‹
) {

306 
	gbufãr
.
wr™eBy‹
((
By‹
è
·ylßd
);

307 } ià(
·ylßd
 
š¡ªûof
 
	gShÜt
) {

308 
	gbufãr
.
wr™eShÜt
((
ShÜt
è
·ylßd
);

309 } ià(
·ylßd
 
š¡ªûof
 
	gIÁeg”
) {

310 
	gbufãr
.
wr™eIÁ
((
IÁeg”
è
·ylßd
);

311 } ià(
·ylßd
 
š¡ªûof
 
	gLÚg
) {

312 
	gbufãr
.
wr™eLÚg
((
LÚg
è
·ylßd
);

313 } ià(
·ylßd
 
š¡ªûof
 
	gBoŞ—n
) {

314 
	gbufãr
.
wr™eBoŞ—n
((
BoŞ—n
è
·ylßd
);

315 } ià(
·ylßd
 
š¡ªûof
 
	gDoubË
) {

316 
	gbufãr
.
wr™eDoubË
((
DoubË
è
·ylßd
);

317 } ià(
·ylßd
 
š¡ªûof
 
	gFlßt
) {

318 
	gbufãr
.
wr™eFlßt
((
Flßt
è
·ylßd
);

319 } ià(
·ylßd
 
š¡ªûof
 
	gby‹
[]) {

320 
	gbufãr
.
wr™eIÁ
(((
by‹
[]è
·ylßd
).
Ëngth
);

321 
	gbufãr
.
wr™eBy‹s
((
by‹
[]è
·ylßd
);

322 } ià(
·ylßd
 
š¡ªûof
 
	gSŒšg
) {

324 
	gby‹
[] 
	gs
 = ((
SŒšg
è
·ylßd
).
g‘By‹s
();

325 
	gbufãr
.
wr™eIÁ
(
s
.
Ëngth
);

326 
	gbufãr
.
wr™eBy‹s
(
s
);

327 } ià(
·ylßd
 
š¡ªûof
 
	gUUID
) {

328 
	gbufãr
.
wr™eLÚg
(((
UUID
è
·ylßd
).
g‘Mo¡SignifiÿÁB™s
());

329 
	gbufãr
.
wr™eLÚg
(((
UUID
è
·ylßd
).
g‘L—¡SignifiÿÁB™s
());

330 } ià(
·ylßd
 
š¡ªûof
 
	gEnumM­
) {

332 
	gEnumM­
<?, ?> 
	gm­
 = (
EnumM­
<?, ?>è
	g·ylßd
;

333 
	gbufãr
.
wr™eBy‹
(
m­
.
size
());

334 
	gm­
.
’ŒyS‘
().
fÜEach
(
x
 -> {

335 
£rŸlize
(
bufãr
, 
x
.
g‘Key
());

336 
£rŸlize
(
bufãr
, 
x
.
g‘V®ue
());

338 } ià(
·ylßd
 
š¡ªûof
 
	gRªgeS‘
) {

339 
	gS‘
<
	gRªge
<?>> 
	grs
 = (((
RªgeS‘
è
·ylßd
).
asRªges
());

340 
	gbufãr
.
wr™eIÁ
(
rs
.
size
());

341 
	grs
.
fÜEach
(
x
 -> {

342 
bufãr
.
wr™eBoŞ—n
(
x
.
uµ”BoundTy³
(è=ğ
BoundTy³
.
CLOSED
);

343 
£rŸlize
(
bufãr
, 
x
.
uµ”Endpošt
());

344 
bufãr
.
wr™eBoŞ—n
(
x
.
uµ”BoundTy³
(è=ğ
BoundTy³
.
CLOSED
);

345 
£rŸlize
(
bufãr
, 
x
.
low”Endpošt
());

347 } ià(
·ylßd
 
š¡ªûof
 
	gRªge
) {

348 
	gRªge
<?> 
	gr
 = (
Rªge
<?>è
·ylßd
;

349 
	gbufãr
.
wr™eBoŞ—n
(
r
.
uµ”BoundTy³
(è=ğ
BoundTy³
.
CLOSED
);

350 
£rŸlize
(
bufãr
, 
r
.
uµ”Endpošt
());

351 
	gbufãr
.
wr™eBoŞ—n
(
r
.
uµ”BoundTy³
(è=ğ
BoundTy³
.
CLOSED
);

352 
£rŸlize
(
bufãr
, 
r
.
low”Endpošt
());

353 } ià(
·ylßd
 
š¡ªûof
 
	gM­
) {

354 
	gM­
<?, ?> 
	gm­
 = (
M­
<?, ?>è
	g·ylßd
;

355 
	gbufãr
.
wr™eIÁ
(
m­
.
size
());

356 
	gm­
.
fÜEach
((
key
, 
v®ue
) -> {

357 
£rŸlize
(
bufãr
, 
key
);

358 
£rŸlize
(
bufãr
, 
v®ue
);

360 } ià(
·ylßd
 
š¡ªûof
 
	gS‘
) {

361 
	gS‘
<?> 
	g£t
 = (
S‘
<?>è
·ylßd
;

362 
	gbufãr
.
wr™eIÁ
(
£t
.
size
());

363 
	g£t
.
fÜEach
(
x
 -> 
£rŸlize
(
bufãr
, x));

364 } ià(
·ylßd
 
š¡ªûof
 
	gLi¡
) {

365 
	gLi¡
<?> 
	gli¡
 = (
Li¡
<?>è
·ylßd
;

366 
	gbufãr
.
wr™eIÁ
(
li¡
.
size
());

367 
	gli¡
.
fÜEach
(
x
 -> 
£rŸlize
(
bufãr
, x));

368 } ià(
·ylßd
 
š¡ªûof
 
	gLayout
) {

369 
	gby‹
[] 
	gb
 = 
JsÚUts
.
·r£r
.
toJsÚ
(
·ylßd
).
g‘By‹s
();

370 
	gbufãr
.
wr™eIÁ
(
b
.
Ëngth
);

371 
	gbufãr
.
wr™eBy‹s
(
b
);

372 } ià(
·ylßd
 
š¡ªûof
 
	gBy‹Buf
) {

373 
By‹Buf
 
	gb
 = ((By‹Bufè
·ylßd
).
¦iû
();

374 
	gb
.
»£tR—d”Index
();

375 
	gby‹s
 = 
b
.
»adabËBy‹s
();

376 
	gbufãr
.
wr™eIÁ
(
by‹s
);

377 
	gbufãr
.
wr™eBy‹s
(
b
, 
by‹s
);

378 } ià(
·ylßd
 
š¡ªûof
 
	gD©aRªk
) {

379 
D©aRªk
 
	g¿nk
 = (D©aRªkè
·ylßd
;

380 
	gbufãr
.
wr™eLÚg
(
¿nk
.
g‘Rªk
());

381 
	gbufãr
.
wr™eLÚg
(
¿nk
.
g‘Uuid
().
g‘Mo¡SignifiÿÁB™s
());

382 
	gbufãr
.
wr™eLÚg
(
¿nk
.
g‘Uuid
().
g‘L—¡SignifiÿÁB™s
());

383 } ià(
·ylßd
 
š¡ªûof
 
	gCheckpoštEÁryTy³
) {

384 
	gbufãr
.
wr™eBy‹
(((
CheckpoštEÁryTy³
è
·ylßd
).
asBy‹
());

385 } ià(
·ylßd
 
š¡ªûof
 
	gCodec
.
	gTy³
) {

386 
	gbufãr
.
wr™eIÁ
(((
Codec
.
Ty³
è
·ylßd
).
g‘Id
());

387 } ià(
·ylßd
 
š¡ªûof
 
	gPriÜ™yLev–
) {

388 
	gbufãr
.
wr™eBy‹
(((
PriÜ™yLev–
è
·ylßd
).
asBy‹
());

389 } ià(
·ylßd
 
š¡ªûof
 
	gSŒ—mAdd»ssS·û
) {

390 
SŒ—mAdd»ssS·û
 
	g¡»amAdd»ssS·û
 = (SŒ—mAdd»ssS·ûè
·ylßd
;

391 
	gbufãr
.
wr™eLÚg
(
¡»amAdd»ssS·û
.
g‘TrimM¬k
());

392 
£rŸlize
(
bufãr
, 
¡»amAdd»ssS·û
.
g‘Add»ssM­
());

393 } ià(
·ylßd
 
š¡ªûof
 
	gSŒ—mAdd»ssRªge
) {

394 
SŒ—mAdd»ssRªge
 
	g¡»amRªge
 = (SŒ—mAdd»ssRªgeè
·ylßd
;

395 
	gbufãr
.
wr™eLÚg
(
¡»amRªge
.
g‘SŒ—mID
().
g‘Mo¡SignifiÿÁB™s
());

396 
	gbufãr
.
wr™eLÚg
(
¡»amRªge
.
g‘SŒ—mID
().
g‘L—¡SignifiÿÁB™s
());

397 
	gbufãr
.
wr™eLÚg
(
¡»amRªge
.
g‘S¹
());

398 
	gbufãr
.
wr™eLÚg
(
¡»amRªge
.
g‘End
());

399 } ià(
·ylßd
 
š¡ªûof
 
	gRßršg64NavigabËM­
) {

400 
Rßršg64NavigabËM­
 
	gmrb
 = (Rßršg64NavigabËM­è
·ylßd
;

402 
	gmrb
.
runO±imize
();

403 
Œy
 (
By‹BufOuutSŒ—m
 
ouutSŒ—m
 = 
Ãw
 By‹BufOuutSŒ—m(
bufãr
);

404 
D©aOuutSŒ—m
 
d©aOuutSŒ—m
 = 
Ãw
 D©aOuutSŒ—m(
ouutSŒ—m
)){

405 
mrb
.
£rŸlize
(
d©aOuutSŒ—m
);

406 } 
ÿtch
 (
IOExû±iÚ
 
iÛ
) {

407 
throw
 
Ãw
 
S”Ÿliz”Exû±iÚ
("Unexpectedƒrror while serializingo‡ byte‡rray");

409 } ià(
·ylßd
 
š¡ªûof
 
	gLogR•liÿtiÚEÁryM‘ad©a
) {

410 
LogR•liÿtiÚEÁryM‘ad©a
 
	gm‘ad©a
 = (LogR•liÿtiÚEÁryM‘ad©aè
·ylßd
;

411 
	gbufãr
.
wr™eLÚg
(
m‘ad©a
.
g‘S™eEpoch
());

412 
	gbufãr
.
wr™eIÁ
(
m‘ad©a
.
g‘Mes§geM‘ad©aTy³
().
g‘V®
());

413 
	gbufãr
.
wr™eLÚg
(
m‘ad©a
.
g‘Time¡amp
());

414 
	gbufãr
.
wr™eLÚg
(
m‘ad©a
.
g‘P»viousTime¡amp
());

415 
£rŸlize
(
bufãr
, 
m‘ad©a
.
g‘SyncReque¡Id
());

416 
	gbufãr
.
wr™eLÚg
(
m‘ad©a
.
g‘SÇpshÙTime¡amp
());

417 
	gbufãr
.
wr™eLÚg
(
m‘ad©a
.
g‘SÇpshÙSyncSeqNum
());

419 
throw
 
Ãw
 
RuÁimeExû±iÚ
("UnknowÀşas " + 
·ylßd
.
g‘CÏss
() + " for serialization");

423 
doS”Ÿlize
(
By‹Buf
 
buf
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ILogData.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 
public
 
š‹rçû
 
ILogD©a
 
ex‹nds
 
	gIM‘ad©a
, 
	gCom·¿bË
<
	gILogD©a
> {

18 
Objeù
 
g‘Paylßd
(
CÜfuRuÁime
 
t
);

20 
D©aTy³
 
g‘Ty³
();

22 @
Ov”ride


23  
com·»To
(
ILogD©a
 
o
) {

24  
g‘Glob®Add»ss
().
com·»To
(
o
.getGlobalAddress());

32 şas 
	cS”Ÿliz©iÚHªdË
 
im¶em’ts
 
	gAutoClo£abË
 {

37 
fš®
 
ILogD©a
 
	gd©a
;

45 
public
 
ILogD©a
 
g‘S”Ÿlized
() {

46  
	gd©a
;

55 
public
 
S”Ÿliz©iÚHªdË
(
ILogD©a
 
d©a
) {

56 
	gthis
.
	gd©a
 = 
d©a
;

57 
	gd©a
.
acquœeBufãr
();

63 @
Ov”ride


64 
public
 
şo£
() {

65 
	gd©a
.
»Ëa£Bufãr
();

69 
»Ëa£Bufãr
();

71 
acquœeBufãr
();

73  
S”Ÿliz©iÚHªdË
 
	$g‘S”ŸlizedFÜm
() {

74  
Ãw
 
	`S”Ÿliz©iÚHªdË
(
this
);

75 
	}
}

80  
LogEÁry
 
	$g‘LogEÁry
(
CÜfuRuÁime
 
ruÁime
) {

81  (
LogEÁry
è
	`g‘Paylßd
(
ruÁime
);

82 
	}
}

87  
boŞ—n
 
	$hasBackpoš‹r
(
UUID
 
¡»amId
) {

88  
	`g‘Backpoš‹rM­
(è!ğ
nuÎ


89 && 
	`g‘Backpoš‹rM­
().
	`cÚšsKey
(
¡»amId
);

90 
	}
}

95  
LÚg
 
	$g‘Backpoš‹r
(
UUID
 
¡»amId
) {

96 ià(!
	`hasBackpoš‹r
(
¡»amId
)) {

97  
nuÎ
;

99  
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amId
);

100 
	}
}

107 
g‘SizeE¡im©e
();

114 
u£Tok’
(
ITok’
 
tok’
);

119  
boŞ—n
 
	$isHŞe
() {

120  
	`g‘Ty³
(è=ğ
D©aTy³
.
HOLE
;

121 
	}
}

126  
boŞ—n
 
	$isEm±y
() {

127  
	`g‘Ty³
(è=ğ
D©aTy³
.
EMPTY
;

128 
	}
}

133  
boŞ—n
 
	$isTrimmed
() {

134  
	`g‘Ty³
(è=ğ
D©aTy³
.
TRIMMED
;

135 
	}
}

140  
boŞ—n
 
	$isD©a
(è{  
	`g‘Ty³
(è=ğ
D©aTy³
.
DATA
; 
	}
}

148 
	$g‘S”ŸlizedSize
(
Objeù
 
obj
, 
SŒšg
 
codecTy³
) {

149 
ILogD©a
 
ld
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
obj
, 
codecTy³
);

150 
ld
.
	`acquœeBufãr
();

151 
size
 = 
ld
.
	`g‘SizeE¡im©e
();

152 
ld
.
	`»Ëa£Bufãr
();

153  
size
;

154 
	}
}

156  
	$£tId
(
UUID
 
ş›ÁId
) {

157 
	`£tCl›ÁId
(
ş›ÁId
);

158 
	`£tTh»adId
(
Th»ad
.
	`cu¼’tTh»ad
().
	`g‘Id
());

159 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/IMetadata.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	gesÙ”icsoáw¬e
.
	gkryo
.
	gNÙNuÎ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

7 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

8 
impÜt
 
	gjava
.
	gut
.
	gEnumM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

11 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

12 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

16 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

18 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

19 
impÜt
 
	glombok
.
	gG‘‹r
;

20 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

21 
impÜt
 
	glombok
.
	gV®ue
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
.
	gLogUn™M‘ad©aTy³
.
	gCHECKPOINTED_STREAM_ID
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
.
	gLogUn™M‘ad©aTy³
.
	gCHECKPOINTED_STREAM_START_LOG_ADDRESS
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
.
	gLogUn™M‘ad©aTy³
.
	gCHECKPOINT_ID
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
.
	gLogUn™M‘ad©aTy³
.
	gCHECKPOINT_TYPE
;

36 
public
 
š‹rçû
 
	gIM‘ad©a
 {

38 
	gM­
<
	gBy‹
, 
	gLogUn™M‘ad©aTy³
> 
	gm‘ad©aTy³M­
 =

39 
A¼ays
.<
LogUn™M‘ad©aTy³
>
¡»am
(LogUn™M‘ad©aTy³.
v®ues
())

40 .
cŞËù
(
CŞËùÜs
.
toM­
(
LogUn™M‘ad©aTy³
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

42 
	gEnumM­
<
	gIM‘ad©a
.
	gLogUn™M‘ad©aTy³
, 
	gObjeù
> 
g‘M‘ad©aM­
();

49 @
Suµ»ssW¬nšgs
("unchecked")

50  
	gS‘
<
	gUUID
> 
g‘SŒ—ms
() {

51  ((
	gM­
<
	gUUID
, 
	gLÚg
>è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(

52 
LogUn™M‘ad©aTy³
.
BACKPOINTER_MAP
, 
CŞËùiÚs
.
em±yM­
())).
keyS‘
();

60  
boŞ—n
 
cÚšsSŒ—m
(
UUID
 
¡»am
) {

61  
g‘Backpoš‹rM­
().
keyS‘
().
cÚšs
(
¡»am
);

69 @
Suµ»ssW¬nšgs
("unchecked")

70 @
NuÎabË


71  
D©aRªk
 
g‘Rªk
() {

72  (
	gD©aRªk
è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
RANK
,

73 
nuÎ
);

81  
£tRªk
(@
NuÎabË
 
D©aRªk
 
¿nk
) {

82 
	gEnumM­
<
	gLogUn™M‘ad©aTy³
, 
	gObjeù
> 
	gm­
 = 
g‘M‘ad©aM­
();

83 ià(
	g¿nk
 !ğ
nuÎ
) {

84 
m­
.
put
(
LogUn™M‘ad©aTy³
.
RANK
, 
¿nk
);

86 ià(
	gm­
.
cÚšsKey
(
LogUn™M‘ad©aTy³
.
RANK
)) {

87 
	gm­
.
»move
(
LogUn™M‘ad©aTy³
.
RANK
);

92 @
Suµ»ssW¬nšgs
("unchecked")

93  
	gM­
<
	gUUID
, 
	gLÚg
> 
g‘Backpoš‹rM­
() {

94  (
	gM­
<
	gUUID
, 
	gLÚg
>è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
BACKPOINTER_MAP
,

95 
CŞËùiÚs
.
EMPTY_MAP
);

98  
£tBackpoš‹rM­
(
M­
<
UUID
, 
LÚg
> 
backpoš‹rM­
) {

99 
g‘M‘ad©aM­
().
put
(
LogUn™M‘ad©aTy³
.
BACKPOINTER_MAP
, 
backpoš‹rM­
);

102  
£tGlob®Add»ss
(
LÚg
 
add»ss
) {

103 
g‘M‘ad©aM­
().
put
(
LogUn™M‘ad©aTy³
.
GLOBAL_ADDRESS
, 
add»ss
);

106  
£tEpoch
(
LÚg
 
•och
) {

107 
g‘M‘ad©aM­
().
put
(
LogUn™M‘ad©aTy³
.
EPOCH
, 
•och
);

110  
£tCl›ÁId
(
UUID
 
ş›ÁId
è{
g‘M‘ad©aM­
().
put
(
LogUn™M‘ad©aTy³
.
CLIENT_ID
, clientId); }

112 @
Suµ»ssW¬nšgs
("unchecked")

113 @
NuÎabË


114  
UUID
 
g‘Cl›ÁId
() {

115  (
	gUUID
è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
CLIENT_ID
,

116 
nuÎ
);

119  
£tTh»adId
(
LÚg
 
th»adId
è{
g‘M‘ad©aM­
().
put
(
LogUn™M‘ad©aTy³
.
THREAD_ID
,hreadId); }

121 @
Suµ»ssW¬nšgs
("unchecked")

122 @
NuÎabË


123  
LÚg
 
g‘Th»adId
() {

124  (
	gLÚg
è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
THREAD_ID
,

125 
nuÎ
);

133 @
Suµ»ssW¬nšgs
("unchecked")

134  
LÚg
 
g‘Glob®Add»ss
() {

135  
	gO±iÚ®
.
ofNuÎabË
((
LÚg
è
g‘M‘ad©aM­
()

136 .
g‘
(
LogUn™M‘ad©aTy³
.
GLOBAL_ADDRESS
)).
ÜEl£
(
Add»ss
.
NON_ADDRESS
);

144  
LÚg
 
g‘Epoch
() {

145 ià(
g‘M‘ad©aM­
(è=ğ
nuÎ


146 || 
g‘M‘ad©aM­
().
g‘
(
LogUn™M‘ad©aTy³
.
EPOCH
è=ğ
nuÎ
) {

147  
Layout
.
INVALID_EPOCH
;

149  
	gO±iÚ®
.
ofNuÎabË
((
LÚg
è
g‘M‘ad©aM­
()

150 .
g‘
(
LogUn™M‘ad©aTy³
.
EPOCH
)).
ÜEl£
(
Layout
.
INVALID_EPOCH
);

154  
Tok’
 
g‘Tok’
() {

155  
Ãw
 
Tok’
(
g‘Epoch
(), 
g‘Glob®Add»ss
());

158  
boŞ—n
 
hasCheckpoštM‘ad©a
() {

159  
g‘CheckpoštTy³
(è!ğ
nuÎ
 && 
g‘CheckpoštId
() !=‚ull;

165 @
NuÎabË


166  
	gCheckpoštEÁry
.
CheckpoštEÁryTy³
 
g‘CheckpoštTy³
() {

167  (
	gCheckpoštEÁry
.
	gCheckpoštEÁryTy³
è
g‘M‘ad©aM­
()

168 .
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
CHECKPOINT_TYPE
,

169 
nuÎ
);

172  
£tCheckpoštTy³
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
 
ty³
) {

173 
g‘M‘ad©aM­
().
put
(
CHECKPOINT_TYPE
, 
ty³
);

176 @
	gNuÎabË


177 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviationaswordinname", "checkstyle:membername"})

178  
UUID
 
g‘CheckpoštId
() {

179  (
	gUUID
è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
CHECKPOINT_ID
,

180 
nuÎ
);

183 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviationaswordinname", "checkstyle:membername"})

184  
£tCheckpoštId
(
UUID
 
id
) {

185 
g‘M‘ad©aM­
().
put
(
CHECKPOINT_ID
, 
id
);

188  
UUID
 
g‘Checkpoš‹dSŒ—mId
() {

189  (
	gUUID
è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
CHECKPOINTED_STREAM_ID
,

190 
nuÎ
);

193  
£tCheckpoš‹dSŒ—mId
(
UUID
 
Id
) {

194 
g‘M‘ad©aM­
().
put
(
CHECKPOINTED_STREAM_ID
, 
Id
);

200  
LÚg
 
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
() {

201  (
	gLÚg
è
g‘M‘ad©aM­
()

202 .
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
CHECKPOINTED_STREAM_START_LOG_ADDRESS
,

203 
Add»ss
.
NO_BACKPOINTER
);

206  
£tCheckpoš‹dSŒ—mS¹LogAdd»ss
(
LÚg
 
¡¬tLogAdd»ss
) {

207 
g‘M‘ad©aM­
().
put
(
CHECKPOINTED_STREAM_START_LOG_ADDRESS
, 
¡¬tLogAdd»ss
);

215  
£tPaylßdCodecTy³
(
Codec
.
Ty³
 
ty³
) {

216 
g‘M‘ad©aM­
().
put
(
LogUn™M‘ad©aTy³
.
PAYLOAD_CODEC
, 
ty³
);

224  
	gCodec
.
Ty³
 
g‘PaylßdCodecTy³
() {

225  (
	gCodec
.
	gTy³
è
g‘M‘ad©aM­
().
g‘OrDeçuÉ
(
LogUn™M‘ad©aTy³
.
PAYLOAD_CODEC
, 
Codec
.
Ty³
.
NONE
);

233  
boŞ—n
 
hasPaylßdCodec
() {

234  
g‘PaylßdCodecTy³
(è!ğ
Codec
.
Ty³
.
NONE
;

237 @
RequœedArgsCÚ¡ruùÜ


238 
LogUn™M‘ad©aTy³
 
im¶em’ts
 
	gITy³dEnum
 {

239 
RANK
(1, 
Ty³Tok’
.
of
(
D©aRªk
.
şass
)),

240 
BACKPOINTER_MAP
(3, 
Ãw
 
Ty³Tok’
<
M­
<
UUID
, 
LÚg
>>() {}),

241 
GLOBAL_ADDRESS
(4, 
Ty³Tok’
.
of
(
LÚg
.
şass
)),

242 
CHECKPOINT_TYPE
(6, 
Ty³Tok’
.
of
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
şass
)),

243 
CHECKPOINT_ID
(7, 
Ty³Tok’
.
of
(
UUID
.
şass
)),

244 
CHECKPOINTED_STREAM_ID
(8, 
Ty³Tok’
.
of
(
UUID
.
şass
)),

245 
CHECKPOINTED_STREAM_START_LOG_ADDRESS
(9, 
Ty³Tok’
.
of
(
LÚg
.
şass
)),

246 
CLIENT_ID
(10, 
Ty³Tok’
.
of
(
UUID
.
şass
)),

247 
THREAD_ID
(11, 
Ty³Tok’
.
of
(
LÚg
.
şass
)),

248 
EPOCH
(12, 
Ty³Tok’
.
of
(
LÚg
.
şass
)),

249 
PAYLOAD_CODEC
(13, 
Ty³Tok’
.
of
(
Codec
.
Ty³
.
şass
));

250 
fš®
 
	gty³
;

251 @
G‘‹r


252 
fš®
 
	gTy³Tok’
<?> 
	gcompÚ’tTy³
;

254 
public
 
by‹
 
asBy‹
() {

255  (
	gby‹
è
	gty³
;

258 
public
 
	gM­
<
	gBy‹
, 
	gLogUn™M‘ad©aTy³
> 
	gty³M­
 =

259 
A¼ays
.<
LogUn™M‘ad©aTy³
>
¡»am
(LogUn™M‘ad©aTy³.
v®ues
())

260 .
cŞËù
(
CŞËùÜs
.
toM­
(
LogUn™M‘ad©aTy³
::
asBy‹
,

261 
FunùiÚ
.
id’t™y
()));

264 @
	gV®ue


265 @
AÎArgsCÚ¡ruùÜ


266 
şass
 
D©aRªk
 
im¶em’ts
 
	gCom·¿bË
<
	gD©aRªk
> {

267 
public
 
	g¿nk
;

268 @
NÙNuÎ


269 
public
 
UUID
 
	guuid
;

271 
public
 
D©aRªk
(
¿nk
) {

272 
this
(
¿nk
, 
UUID
.
¿ndomUUID
());

275 
public
 
D©aRªk
 
budHigh”Rªk
() {

276  
Ãw
 
D©aRªk
(
¿nk
 + 1, 
uuid
);

279 @
Ov”ride


280 
public
 
com·»To
(
D©aRªk
 
o
) {

281 
	g¿nkCom·»d
 = 
LÚg
.
com·»
(
this
.
¿nk
, 
o
.rank);

282 ià(
	g¿nkCom·»d
 == 0) {

283  
uuid
.
com·»To
(
o
.
g‘Uuid
());

285  
	g¿nkCom·»d
;

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/IToken.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

4 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
public
 
š‹rçû
 
	gITok’
 {

20 
g‘Sequ’û
();

26 
g‘Epoch
();

32  
	gM­
<
	gUUID
, 
	gLÚg
> 
g‘Backpoš‹rM­
() {

33  
	gCŞËùiÚs
.
em±yM­
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ITypedEnum.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

9 
public
 
š‹rçû
 
	gITy³dEnum
<
T
 
ex‹nds
 
	gEnum
<
	gT
>>ƒx‹nd 
	gICÜfuPaylßd
<T> {

11 
	gTy³Tok’
<?> 
g‘CompÚ’tTy³
();

13 
by‹
 
asBy‹
();

15 @
Ov”ride


16  
doS”Ÿlize
(
By‹Buf
 
buf
) {

17 
	gbuf
.
wr™eBy‹
(
this
.
asBy‹
());

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/InboundMsgFilterHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlDu¶exHªdËr
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

11 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

22 @
Slf4j


23 
public
 cÏs 
	cInboundMsgF‹rHªdËr
 
ex‹nds
 
	mChªÃlDu¶exHªdËr
 {

25 
´iv©e
 
fš®
 
	mLi¡
<
	mMsgHªdlšgF‹r
> 
	mhªdlšgF‹rs
;

27 
public
 
InboundMsgF‹rHªdËr
(@
NÚNuÎ
 
Li¡
<
MsgHªdlšgF‹r
> 
hªdlšgF‹rs
) {

28 
	mthis
.
	mhªdlšgF‹rs
 = 
hªdlšgF‹rs
;

31 @
Ov”ride


32 
public
 
	$chªÃlR—d
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
msg
è
throws
 
Exû±iÚ
 {

33 
CÜfuMsg
 
cÜfuMsg
 = (CÜfuMsgè
msg
;

35 
Li¡
<
CÜfuMsg
> 
ŒªsfÜmedByF‹rs
 = 
	`­¶yF‹rs
(
cÜfuMsg
);

36 
log
.
	`šfo
("Applied {} filtering„ule(s) onhe inbound message. " +

38 
hªdlšgF‹rs
.
	`size
(),

39 
cÜfuMsg
.
	`g‘Reque¡ID
(),

40 
cÜfuMsg
.
	`g‘MsgTy³
());

42 
CÜfuMsg
 
aCÜfuMsg
 : 
ŒªsfÜmedByF‹rs
) {

43 
su³r
.
	`chªÃlR—d
(
ùx
, 
aCÜfuMsg
);

45 
	}
}

54 
´iv©e
 
	gLi¡
<
	gCÜfuMsg
> 
	$­¶yF‹rs
(
CÜfuMsg
 
cÜfuMsg
) {

55 
Li¡
<
CÜfuMsg
> 
»suÉs
 = 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
cÜfuMsg
);

56 
MsgHªdlšgF‹r
 
f‹r
 : 
hªdlšgF‹rs
) {

57 
»suÉs
 =„esuÉs.
	`¡»am
()

58 .
	`m­
(
f‹r
)

59 .
	`æ©M­
(
Li¡
::
¡»am
)

60 .
	`f‹r
(
Objeùs
::
nÚNuÎ
)

61 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

63  
»suÉs
;

64 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/JSONPayloadMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚBud”
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

8 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gP¬am‘”izedTy³
;

9 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

11 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

16 @
	gNoArgsCÚ¡ruùÜ


17 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviationaswordinname", "checkstyle:membername"})

18 
public
 
şass
 
	gJSONPaylßdMsg
<
	gT
> 
ex‹nds
 
	gCÜfuMsg
 {

20 
fš®
 
GsÚ
 
	g·r£r
 = 
Ãw
 
GsÚBud”
().
ü—‹
();

25 
´iv©e
 
T
 
	g·ylßd
;

30 
´iv©e
 
SŒšg
 
	gd©aSŒšg
;

32 
public
 
JSONPaylßdMsg
(
T
 
·ylßd
, 
CÜfuMsgTy³
 
ty³
) {

33 
	gthis
.
	gmsgTy³
 = 
ty³
;

34 
	gthis
.
	g·ylßd
 = 
·ylßd
;

42 @
Ov”ride


43 
public
 
£rŸlize
(
By‹Buf
 
bufãr
) {

44 
	gsu³r
.
£rŸlize
(
bufãr
);

45 
	gby‹
[] 
	gb
 = 
·r£r
.
toJsÚ
(
·ylßd
).
g‘By‹s
();

46 
	gbufãr
.
wr™eIÁ
(
b
.
Ëngth
);

47 
	gbufãr
.
wr™eBy‹s
(
b
);

56 @
Ov”ride


57 
public
 
äomBufãr
(
By‹Buf
 
bufãr
) {

58 
	gsu³r
.
äomBufãr
(
bufãr
);

59 
	gËngth
 = 
bufãr
.
»adIÁ
();

60 
	gby‹
[] 
	gby‹A¼ay
 = 
Ãw
 
by‹
[
Ëngth
];

61 
	gbufãr
.
»adBy‹s
(
by‹A¼ay
, 0, 
Ëngth
);

62 
	gd©aSŒšg
 = 
Ãw
 
SŒšg
(
by‹A¼ay
, 
Snd¬dCh¬£ts
.
UTF_8
);

72 @
Suµ»ssW¬nšgs
("unchecked")

73 
public
 
T
 
g‘Paylßd
() {

74  
	g·r£r
.
äomJsÚ
(
d©aSŒšg
,

75 ((
P¬am‘”izedTy³
)
msgTy³
.
mes§geTy³
.
g‘Ty³
()).
g‘Aùu®Ty³Argum’ts
()[0]);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/KnownAddressRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gD©a
;

12 @
	gD©a


13 @
AÎArgsCÚ¡ruùÜ


14 
public
 
şass
 
KnownAdd»ssReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gKnownAdd»ssReque¡
> {

16 
´iv©e
 
fš®
 
LÚg
 
	g¡¬tRªge
;

17 
´iv©e
 
fš®
 
LÚg
 
	g’dRªge
;

24 
public
 
KnownAdd»ssReque¡
(
By‹Buf
 
buf
) {

25 
	g¡¬tRªge
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

26 
	g’dRªge
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

29 @
Ov”ride


30 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

31 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡¬tRªge
);

32 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
’dRªge
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/KnownAddressResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

7 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

8 
impÜt
 
	glombok
.
	gD©a
;

14 @
	gD©a


15 @
AÎArgsCÚ¡ruùÜ


16 
public
 
şass
 
KnownAdd»ssRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gKnownAdd»ssRe¥Ú£
> {

18 
´iv©e
 
fš®
 
	gS‘
<
	gLÚg
> 
	gknownAdd»s£s
;

25 
public
 
KnownAdd»ssRe¥Ú£
(
By‹Buf
 
buf
) {

26 
	gknownAdd»s£s
 = 
ICÜfuPaylßd
.
£tFromBufãr
(
buf
, 
LÚg
.
şass
);

29 @
Ov”ride


30 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

31 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
knownAdd»s£s
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutBootstrapRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

15 @
	gD©a


16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
şass
 
LayoutBoÙ¡¿pReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLayoutBoÙ¡¿pReque¡
> {

18 
´iv©e
 
Layout
 
	gÏyout
;

20 
public
 
LayoutBoÙ¡¿pReque¡
(
By‹Buf
 
buf
) {

21 
	gÏyout
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
Layout
.
şass
);

24 @
Ov”ride


25 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

26 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
Ïyout
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutCommittedRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

16 @
	gD©a


17 @
AÎArgsCÚ¡ruùÜ


18 
public
 
şass
 
LayoutComm™‹dReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLayoutComm™‹dReque¡
> {

19 
´iv©e
 
BoŞ—n
 
	gfÜû
;

20 
´iv©e
 
	g•och
;

21 
´iv©e
 
Layout
 
	gÏyout
;

23 
public
 
LayoutComm™‹dReque¡
(
•och
, 
Layout
 
Ïyout
) {

24 
	gthis
.
	g•och
 = 
•och
;

25 
	gthis
.
	gÏyout
 = 
Ïyout
;

26 
	gthis
.
	gfÜû
 = 
çl£
;

29 
public
 
LayoutComm™‹dReque¡
(
By‹Buf
 
buf
) {

30 
	gfÜû
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
BoŞ—n
.
şass
);

31 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

32 
	gÏyout
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
Layout
.
şass
);

35 @
Ov”ride


36 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

37 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
fÜû
);

38 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

39 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
Ïyout
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚBud”
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

8 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

10 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

12 
impÜt
 
	glombok
.
	gS‘‹r
;

13 
impÜt
 
	glombok
.
	gToSŒšg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

20 @
	gG‘‹r


21 @
	gS‘‹r


22 @
	gNoArgsCÚ¡ruùÜ


23 @
	$ToSŒšg
(
ÿÎSu³r
 = 
Œue
)

24 
public
 cÏs 
	cLayoutMsg
 
ex‹nds
 
CÜfuMsg
 {

25 
fš®
 
GsÚ
 
·r£r
 = 
Ãw
 
	`GsÚBud”
().
	`ü—‹
();

29 @
G‘‹r


30 
Layout
 
Ïyout
;

32 
public
 
	$LayoutMsg
(
Layout
 
Ïyout
, 
CÜfuMsgTy³
 
ty³
) {

33 
this
.
msgTy³
 = 
ty³
;

34 
this
.
Ïyout
 =†ayout;

42 @
Ov”ride


43 
public
 
	$£rŸlize
(
By‹Buf
 
bufãr
) {

44 
su³r
.
	`£rŸlize
(
bufãr
);

45 
by‹
[] 
b
 = 
·r£r
.
	`toJsÚ
(
Ïyout
).
	`g‘By‹s
();

46 
bufãr
.
	`wr™eIÁ
(
b
.
Ëngth
);

47 
bufãr
.
	`wr™eBy‹s
(
b
);

48 
	}
}

56 @
Ov”ride


57 
public
 
	$äomBufãr
(
By‹Buf
 
bufãr
) {

58 
su³r
.
	`äomBufãr
(
bufãr
);

59 
Ëngth
 = 
bufãr
.
	`»adIÁ
();

60 
by‹
[] 
by‹A¼ay
 = 
Ãw
 by‹[
Ëngth
];

61 
bufãr
.
	`»adBy‹s
(
by‹A¼ay
, 0, 
Ëngth
);

62 
SŒšg
 
¡r
 = 
Ãw
 
	`SŒšg
(
by‹A¼ay
, 
Snd¬dCh¬£ts
.
UTF_8
);

63 
Ïyout
 = 
·r£r
.
	`äomJsÚ
(
¡r
, 
Layout
.
şass
);

64 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutPrepareRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gD©a
;

12 @
	gD©a


13 @
AÎArgsCÚ¡ruùÜ


14 
public
 
şass
 
LayoutP»·»Reque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLayoutP»·»Reque¡
> {

16 
´iv©e
 
	g•och
;

18 
´iv©e
 
	g¿nk
;

20 
public
 
LayoutP»·»Reque¡
(
By‹Buf
 
buf
) {

21 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

22 
	g¿nk
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

25 @
Ov”ride


26 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

27 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

28 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¿nk
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutPrepareResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

20 @
	gD©a


21 @
AÎArgsCÚ¡ruùÜ


22 
public
 
şass
 
LayoutP»·»Re¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLayoutP»·»Re¥Ú£
> {

23 
´iv©e
 
	g¿nk
;

24 
´iv©e
 
Layout
 
	gÏyout
;

29 
public
 
LayoutP»·»Re¥Ú£
(
By‹Buf
 
buf
) {

30 
	g¿nk
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

31 
boŞ—n
 
	gÏyoutP»£Á
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
BoŞ—n
.
şass
);

32 ià(
	gÏyoutP»£Á
) {

33 
	gÏyout
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
Layout
.
şass
);

37 @
Ov”ride


38 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

39 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¿nk
);

40 
boŞ—n
 
	gÏyoutP»£Á
 = 
Ïyout
 !ğ
nuÎ
;

41 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
ÏyoutP»£Á
);

42 ià(
	gÏyoutP»£Á
) {

43 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
Ïyout
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutProposeRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

12 @
	gD©a


13 @
AÎArgsCÚ¡ruùÜ


14 
public
 
şass
 
LayoutPrİo£Reque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLayoutPrİo£Reque¡
> {

16 
´iv©e
 
	g•och
;

18 
´iv©e
 
	g¿nk
;

20 
´iv©e
 
Layout
 
	gÏyout
;

25 
public
 
LayoutPrİo£Reque¡
(
By‹Buf
 
buf
) {

26 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

27 
	g¿nk
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

28 
	gÏyout
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
Layout
.
şass
);

31 @
Ov”ride


32 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

33 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

34 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¿nk
);

35 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
Ïyout
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutProposeResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

14 @
	gD©a


15 @
AÎArgsCÚ¡ruùÜ


16 
public
 
şass
 
LayoutPrİo£Re¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLayoutPrİo£Re¥Ú£
> {

17 
´iv©e
 
	g¿nk
;

19 
public
 
LayoutPrİo£Re¥Ú£
(
By‹Buf
 
buf
) {

20 
	g¿nk
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

23 @
Ov”ride


24 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

25 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¿nk
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/LogData.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

6 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

7 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gCh¬£t
;

8 
impÜt
 
	gjava
.
	gut
.
	gEnumM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

11 
impÜt
 
	glombok
.
	gG‘‹r
;

12 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWr™eSizeExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

24 @
Slf4j


25 
public
 
şass
 
LogD©a
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLogD©a
>, 
	gIM‘ad©a
, 
	gILogD©a
 {

27 
public
 
fš®
 
	gNOT_KNOWN
 = -1;

29 @
G‘‹r


30 
fš®
 
D©aTy³
 
	gty³
;

32 @
G‘‹r


33 
	gby‹
[] 
	gd©a
;

35 
´iv©e
 
By‹Buf
 
	g£rŸlizedCache
 = 
nuÎ
;

37 
´iv©e
 
	gÏ¡KnownSize
 = 
NOT_KNOWN
;

39 
´iv©e
 
fš®
 
Œªs›Á
 
	gAtomicReã»nû
<
	gObjeù
> 
	g·ylßd
 = 
Ãw
 
AtomicReã»nû
<>();

41 
public
 
LogD©a
 
g‘Trimmed
(
add»ss
) {

42 
LogD©a
 
	glogD©a
 = 
Ãw
 LogD©a(
D©aTy³
.
TRIMMED
);

43 
	glogD©a
.
£tGlob®Add»ss
(
add»ss
);

44  
	glogD©a
;

47 
public
 
LogD©a
 
g‘HŞe
(
add»ss
) {

48 
LogD©a
 
	glogD©a
 = 
Ãw
 LogD©a(
D©aTy³
.
HOLE
);

49 
	glogD©a
.
£tGlob®Add»ss
(
add»ss
);

50  
	glogD©a
;

53 
public
 
LogD©a
 
g‘HŞe
(
Tok’
 
tok’
) {

54 
LogD©a
 
	glogD©a
 = 
Ãw
 LogD©a(
D©aTy³
.
HOLE
);

55 
	glogD©a
.
u£Tok’
(
tok’
);

56  
	glogD©a
;

59 
public
 
LogD©a
 
g‘Em±y
(
add»ss
) {

60 
LogD©a
 
	glogD©a
 = 
Ãw
 LogD©a(
D©aTy³
.
EMPTY
);

61 
	glogD©a
.
£tGlob®Add»ss
(
add»ss
);

62  
	glogD©a
;

68 
public
 
Objeù
 
g‘Paylßd
(
CÜfuRuÁime
 
ruÁime
) {

69 
Objeù
 
	gv®ue
 = 
·ylßd
.
g‘
();

70 ià(
	gv®ue
 =ğ
nuÎ
) {

71 
synchrÚized
 (
this
.
·ylßd
) {

72 
v®ue
 = 
this
.
·ylßd
.
g‘
();

73 ià(
	gv®ue
 =ğ
nuÎ
) {

74 ià(
d©a
 =ğ
nuÎ
) {

75 
this
.
·ylßd
.
£t
(
nuÎ
);

77 
By‹Buf
 
	g£rŸlizedBuf
 = 
UÅoŞed
.
w¿µedBufãr
(
d©a
);

78 ià(
hasPaylßdCodec
()) {

80 
By‹Buf
 
	gcom´es£dBuf
 = 
ICÜfuPaylßd
.
äomBufãr
(
d©a
, By‹Buf.
şass
);

81 
	gby‹
[] 
	gcom´es£dA¼ayBuf
ğ
Ãw
 
by‹
[
com´es£dBuf
.
»adabËBy‹s
()];

82 
	gcom´es£dBuf
.
»adBy‹s
(
com´es£dA¼ayBuf
);

83 
	g£rŸlizedBuf
 = 
UÅoŞed
.
w¿µedBufãr
(
g‘PaylßdCodecTy³
()

84 .
g‘In¡ªû
().
decom´ess
(
By‹Bufãr
.
w¿p
(
com´es£dA¼ayBuf
)));

87 
fš®
 
Objeù
 
	gaùu®V®ue
;

88 
	gŒy
 {

89 
	gaùu®V®ue
 =

90 
S”Ÿliz”s
.
CORFU
.
de£rŸlize
(
£rŸlizedBuf
, 
ruÁime
);

92 ià(
aùu®V®ue
 
š¡ªûof
 
	gLogEÁry
) {

93 ((
	gLogEÁry
è
	gaùu®V®ue
).
£tGlob®Add»ss
(
g‘Glob®Add»ss
());

94 ((
	gLogEÁry
è
	gaùu®V®ue
).
£tRuÁime
(
ruÁime
);

96 
	gv®ue
 = 
aùu®V®ue
 =ğ
nuÎ
 ? 
this
.
·ylßd
 :‡ctualValue;

97 
	gthis
.
	g·ylßd
.
£t
(
v®ue
);

98 
	gÏ¡KnownSize
 = 
d©a
.
Ëngth
;

99 } 
ÿtch
 (
ThrowabË
 
throwabË
) {

100 
	glog
.
”rÜ
("Exception caught‡t‡ddress {}, {}, {}",

101 
g‘Glob®Add»ss
(), 
g‘SŒ—ms
(), 
g‘Ty³
());

102 
	glog
.
”rÜ
("Raw data buffer {}",

103 
£rŸlizedBuf
.
»£tR—d”Index
().
toSŒšg
(
Ch¬£t
.
deçuÉCh¬£t
()));

104 
throw
 
	gthrowabË
;

105 } 
	gfš®ly
 {

106 
	g£rŸlizedBuf
.
»Ëa£
();

107 
	gd©a
 = 
nuÎ
;

114  
	gv®ue
;

117 @
Ov”ride


118 
public
 
synchrÚized
 
»Ëa£Bufãr
() {

119 ià(
	g£rŸlizedCache
 !ğ
nuÎ
) {

120 
£rŸlizedCache
.
»Ëa£
();

121 ià(
	g£rŸlizedCache
.
»fCÁ
() == 0) {

122 
£rŸlizedCache
 = 
nuÎ
;

127 @
Ov”ride


128 
public
 
synchrÚized
 
acquœeBufãr
() {

129 ià(
	g£rŸlizedCache
 =ğ
nuÎ
) {

130 
£rŸlizedCache
 = 
UÅoŞed
.
bufãr
();

131 
doS”ŸlizeIÁ”Çl
(
£rŸlizedCache
);

132 
	gÏ¡KnownSize
 = 
£rŸlizedCache
.
¬¿y
().
Ëngth
;

134 
	g£rŸlizedCache
.
»š
();

138 @
Ov”ride


139 
public
 
g‘SizeE¡im©e
() {

140 
	gby‹
[] 
	g‹mpD©a
 = 
d©a
;

141 ià(
	g‹mpD©a
 !ğ
nuÎ
) {

142  
‹mpD©a
.
Ëngth
;

143 } ià(
	gÏ¡KnownSize
 !ğ
NOT_KNOWN
) {

144  
Ï¡KnownSize
;

146 
	glog
.
w¬n
("getSizeEstimate: LogData sizeƒstimate is defaultingo 1,"

151 @
G‘‹r


152 
fš®
 
	gEnumM­
<
	gLogUn™M‘ad©aTy³
, 
	gObjeù
> 
	gm‘ad©aM­
;

157 
public
 
LogD©a
(
By‹Buf
 
buf
) {

158 
	gty³
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
D©aTy³
.
şass
);

159 ià(
	gty³
 =ğ
D©aTy³
.
DATA
) {

160 
d©a
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
by‹
[].
şass
);

162 
	gd©a
 = 
nuÎ
;

165 ià(
	gty³
.
isM‘ad©aAw¬e
()) {

166 
	gm‘ad©aM­
 = 
ICÜfuPaylßd
.
’umM­FromBufãr
(
buf
, 
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
şass
);

168 
	gm‘ad©aM­
 = 
Ãw
 
EnumM­
<>(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
şass
);

177 
public
 
LogD©a
(
D©aTy³
 
ty³
) {

178 
	gthis
.
	gty³
 = 
ty³
;

179 
	gthis
.
	gd©a
 = 
nuÎ
;

180 
	gthis
.
	gm‘ad©aM­
 = 
Ãw
 
EnumM­
<>(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
şass
);

183 
public
 
LogD©a
(
D©aTy³
 
ty³
, 
fš®
 
Objeù
 
objeù
, fš® 
codecId
) {

184 
this
(
ty³
, 
objeù
, 
Codec
.
g‘CodecTy³ById
(
codecId
).
toSŒšg
());

193 
public
 
LogD©a
(
D©aTy³
 
ty³
, 
fš®
 
Objeù
 
objeù
) {

194 ià(
objeù
 
š¡ªûof
 
	gBy‹Buf
) {

195 
	gthis
.
	gty³
 = 
ty³
;

196 
	gthis
.
	gd©a
 = 
by‹A¼ayFromBuf
((
By‹Buf
è
objeù
);

197 
	gthis
.
	gm‘ad©aM­
 = 
Ãw
 
EnumM­
<>(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
şass
);

199 
	gthis
.
	gty³
 = 
ty³
;

200 
	gthis
.
	gd©a
 = 
nuÎ
;

201 
	gthis
.
	g·ylßd
.
£t
(
objeù
);

202 
	gthis
.
	gm‘ad©aM­
 = 
Ãw
 
EnumM­
<>(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
şass
);

203 ià(
objeù
 
š¡ªûof
 
	gCheckpoštEÁry
) {

204 
CheckpoštEÁry
 
	gı
 = (CheckpoštEÁryè
objeù
;

205 
£tCheckpoštTy³
(
ı
.
g‘CpTy³
());

206 
£tCheckpoštId
(
ı
.
g‘CheckpoštId
());

207 
£tCheckpoš‹dSŒ—mId
(
ı
.
g‘SŒ—mId
());

208 
£tCheckpoš‹dSŒ—mS¹LogAdd»ss
(

209 
LÚg
.
·r£LÚg
(
ı
.
g‘Diù
()

210 .
g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
)));

222 
public
 
LogD©a
(
D©aTy³
 
ty³
, 
fš®
 
Objeù
 
objeù
, fš® 
SŒšg
 
codecTy³
) {

223 
this
(
ty³
, 
objeù
);

224 
£tPaylßdCodecTy³
(
Codec
.
Ty³
.
v®ueOf
(
codecTy³
));

232 @
Ov”ride


233 
public
 
u£Tok’
(
ITok’
 
tok’
) {

234 
£tGlob®Add»ss
(
tok’
.
g‘Sequ’û
());

235 
£tEpoch
(
tok’
.
g‘Epoch
());

236 ià(
	gtok’
.
g‘Backpoš‹rM­
().
size
() > 0) {

237 
£tBackpoš‹rM­
(
tok’
.
g‘Backpoš‹rM­
());

239 ià(
	g·ylßd
.
g‘
(è
š¡ªûof
 
	gLogEÁry
) {

240 ((
	gLogEÁry
è
	g·ylßd
.
g‘
()).
£tGlob®Add»ss
(
tok’
.
g‘Sequ’û
());

249 
public
 
	gby‹
[] 
by‹A¼ayFromBuf
(
fš®
 
By‹Buf
 
buf
) {

250 
By‹Buf
 
	g»adOÆyCİy
 = 
buf
.
asR—dOÆy
();

251 
	g»adOÆyCİy
.
»£tR—d”Index
();

252 
	gby‹
[] 
	goutA¼ay
 = 
Ãw
 
by‹
[
»adOÆyCİy
.
»adabËBy‹s
()];

253 
	g»adOÆyCİy
.
»adBy‹s
(
outA¼ay
);

254  
	goutA¼ay
;

257 @
Ov”ride


258 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

259 ià(
	g£rŸlizedCache
 !ğ
nuÎ
) {

260 
£rŸlizedCache
.
»£tR—d”Index
();

261 
	gbuf
.
wr™eBy‹s
(
£rŸlizedCache
);

263 
doS”ŸlizeIÁ”Çl
(
buf
);

267 
doS”ŸlizeIÁ”Çl
(
By‹Buf
 
buf
) {

268 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
ty³
);

269 ià(
	gty³
 =ğ
D©aTy³
.
DATA
) {

270 ià(
d©a
 =ğ
nuÎ
) {

271 
ËngthIndex
 = 
buf
.
wr™”Index
();

272 
	gbuf
.
wr™eIÁ
(0);

273 ià(
hasPaylßdCodec
()) {

275 
By‹Buf
 
	g£rŸlizeBuf
 = 
UÅoŞed
.
bufãr
();

276 
	gS”Ÿliz”s
.
	gCORFU
.
£rŸlize
(
·ylßd
.
g‘
(), 
£rŸlizeBuf
);

277 
doCom´essIÁ”Çl
(
£rŸlizeBuf
, 
buf
);

279 
	gS”Ÿliz”s
.
	gCORFU
.
£rŸlize
(
·ylßd
.
g‘
(), 
buf
);

281 
	gsize
 = 
buf
.
wr™”Index
(è- (
ËngthIndex
 + 4);

282 
	gbuf
.
wr™”Index
(
ËngthIndex
);

283 
	gbuf
.
wr™eIÁ
(
size
);

284 
	gbuf
.
wr™”Index
(
ËngthIndex
 + 
size
 + 4);

286 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
d©a
);

290 ià(
	gty³
.
isM‘ad©aAw¬e
()) {

291 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
m‘ad©aM­
);

295 
´iv©e
 
doCom´essIÁ”Çl
(
By‹Buf
 
bufD©a
, By‹Buà
buf
) {

296 
By‹Bufãr
 
	gw¿µedBy‹Buf
 = By‹Bufãr.
w¿p
(
bufD©a
.
¬¿y
(), 0, bufD©a.
»adabËBy‹s
());

297 
By‹Bufãr
 
	gcom´es£dBuf
 = 
g‘PaylßdCodecTy³
().
g‘In¡ªû
().
com´ess
(
w¿µedBy‹Buf
);

298 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
UÅoŞed
.
w¿µedBufãr
(
com´es£dBuf
));

307 @
Ov”ride


308 
public
 
boŞ—n
 
equ®s
(
Objeù
 
o
) {

309 ià(
	go
 =ğ
this
) {

310  
Œue
;

311 } ià(!(
o
 
š¡ªûof
 
	gLogD©a
)) {

312  
	gçl£
;

314 
LogD©a
 
	gÙh”
 = (LogD©aè
o
;

315 ià(
com·»To
(
Ùh”
) == 0) {

316 
boŞ—n
 
§meCl›ÁId
 = 
g‘Cl›ÁId
(è=ğ
nuÎ
 ? 
Ùh”
.getClientId() ==‚ull :

317 
g‘Cl›ÁId
().
equ®s
(
Ùh”
.getClientId());

318 
boŞ—n
 
	g§meTh»adId
 = 
g‘Th»adId
(è=ğ
nuÎ
 ? 
Ùh”
.getThreadId() ==‚ull :

319 
g‘Th»adId
().
equ®s
(
Ùh”
.getThreadId());

321  
	g§meCl›ÁId
 && 
	g§meTh»adId
;

324  
	gçl£
;

328 @
Ov”ride


329 
public
 
SŒšg
 
toSŒšg
() {

330  "LogD©a[" + 
g‘Glob®Add»ss
() + "]";

338 
public
 
checkMaxWr™eSize
(
lim™
) {

339 
Œy
 (
ILogD©a
.
S”Ÿliz©iÚHªdË
 
sh
 = 
this
.
g‘S”ŸlizedFÜm
()) {

340 ià(
lim™
 !ğ0 && 
g‘SizeE¡im©e
() >†imit) {

341 
throw
 
Ãw
 
Wr™eSizeExû±iÚ
(
g‘SizeE¡im©e
(), 
lim™
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/MsgHandlingFilter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

11 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

12 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

31 @
D©a


32 
public
 
şass
 
MsgHªdlšgF‹r
 
im¶em’ts
 
	gFunùiÚ
<
	gCÜfuMsg
, 
	gLi¡
<CorfuMsg>> {

33 
´iv©e
 
fš®
 
Rªdom
 
	g¿ndom
 = 
Ãw
 Random();

36 
´iv©e
 
fš®
 
	gFunùiÚ
<
	gCÜfuMsg
, 
	gBoŞ—n
> 
	gf‹r
;

39 
´iv©e
 
fš®
 
	gLi¡
<
	gFunùiÚ
<
	gCÜfuMsg
, CÜfuMsg>> 
	gŒªsfÜmFunùiÚs
;

41 @
Ov”ride


42 
public
 
	gLi¡
<
	gCÜfuMsg
> 
­¶y
(
CÜfuMsg
 
cÜfuMsg
) {

44 ià(!
	gf‹r
.
­¶y
(
cÜfuMsg
)è 
	gCŞËùiÚs
.
sšgËtÚLi¡
(corfuMsg);

47 
	gLi¡
<
	gCÜfuMsg
> 
	g»suÉ
 = 
Ãw
 
A¼ayLi¡
<>();

48 
	gFunùiÚ
<
	gCÜfuMsg
, CÜfuMsg> 
	gaT¿nsfÜmFunùiÚ
 : 
ŒªsfÜmFunùiÚs
) {

49 ià(
aT¿nsfÜmFunùiÚ
 !ğ
nuÎ
) {

50 
»suÉ
.
add
(
aT¿nsfÜmFunùiÚ
.
­¶y
(
cÜfuMsg
));

54  
	g»suÉ
;

69 
public
 
MsgHªdlšgF‹r
(@
NÚNuÎ
 
FunùiÚ
<
CÜfuMsg
, 
BoŞ—n
> 
f‹r
,

70 @
NÚNuÎ
 
FunùiÚ
<
CÜfuMsg
, CÜfuMsg> 
ŒªsfÜmFunùiÚ
) {

71 
this
(
f‹r
, 
A¼ays
.
asLi¡
(
ŒªsfÜmFunùiÚ
));

86 
public
 
MsgHªdlšgF‹r
(@
NÚNuÎ
 
FunùiÚ
<
CÜfuMsg
, 
BoŞ—n
> 
f‹r
,

87 @
NÚNuÎ
 
Li¡
<
FunùiÚ
<
CÜfuMsg
, CÜfuMsg>> 
ŒªsfÜmFunùiÚs
) {

88 
	gthis
.
	gf‹r
 = 
f‹r
;

89 
	gthis
.
	gŒªsfÜmFunùiÚs
 = 
Ãw
 
A¼ayLi¡
<>();

90 
	gthis
.
	gŒªsfÜmFunùiÚs
.
addAÎ
(
ŒªsfÜmFunùiÚs
);

101 
public
 
MsgHªdlšgF‹r
 
msgDrİUnifÜmRªdomF‹rFÜ
(
S‘
<
CÜfuMsgTy³
> 
toBeDrİ³dTy³S‘
,

102 
DoubË
 
drİpšgProbab™y
) {

103 
	gFunùiÚ
<
	gCÜfuMsg
, 
	gBoŞ—n
> 
	gf‹r
 =

104 
cÜfuMsg
 -> 
toBeDrİ³dTy³S‘
.
cÚšs
(cÜfuMsg.
g‘MsgTy³
());

105 
	gFunùiÚ
<
	gCÜfuMsg
, CÜfuMsg> 
	gdrİpšgProûss
 =

106 
cÜfuMsg
 -> 
DoubË
.
com·»
(
¿ndom
.
ÃxtDoubË
(), 
drİpšgProbab™y
) < 0 ?

107 
	gnuÎ
 :

108 
cÜfuMsg
;

110  
Ãw
 
MsgHªdlšgF‹r
(
f‹r
, 
drİpšgProûss
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/MultipleReadRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 @
	gG‘‹r


15 @
AÎArgsCÚ¡ruùÜ


16 
public
 
şass
 
MuÉËR—dReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gMuÉËR—dReque¡
> {

19 
´iv©e
 
fš®
 
	gLi¡
<
	gLÚg
> 
	gadd»s£s
;

22 
´iv©e
 
fš®
 
boŞ—n
 
	gÿcheR—dResuÉ
;

29 
public
 
MuÉËR—dReque¡
(
By‹Buf
 
buf
) {

30 
	gadd»s£s
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
LÚg
.
şass
);

31 
	gÿcheR—dResuÉ
 = 
buf
.
»adBoŞ—n
();

34 @
Ov”ride


35 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

36 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
add»s£s
);

37 
	gbuf
.
wr™eBoŞ—n
(
ÿcheR—dResuÉ
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/NettyCorfuMessageDecoder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gBy‹ToMes§geDecod”
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

16 @
Slf4j


17 
public
 cÏs 
	cN‘tyCÜfuMes§geDecod”
 
ex‹nds
 
	mBy‹ToMes§geDecod”
 {

19 @
Ov”ride


20 
´Ùeùed
 
decode
(
ChªÃlHªdËrCÚ‹xt
 
chªÃlHªdËrCÚ‹xt
, 
By‹Buf
 
by‹Buf
,

21 
Li¡
<
Objeù
> 
li¡
è
throws
 
	mExû±iÚ
 {

22 
	mli¡
.
add
(
CÜfuMsg
.
de£rŸlize
(
by‹Buf
));

25 @
Ov”ride


26 
´Ùeùed
 
decodeLa¡
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
By‹Buf
 
š
,

27 
Li¡
<
Objeù
> 
out
è
throws
 
	gExû±iÚ
 {

31 ià(
	gš
 !ğ
UÅoŞed
.
EMPTY_BUFFER
) {

32 
this
.
decode
(
ùx
, 
š
, 
out
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/NettyCorfuMessageEncoder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gMes§geToBy‹Encod”
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gLÚgAccumuÏtÜ
;

14 @
Slf4j


15 
public
 
şass
 
N‘tyCÜfuMes§geEncod”
 
ex‹nds
 
	gMes§geToBy‹Encod”
<
	gCÜfuMsg
> {

18 
fš®
 
LÚgAccumuÏtÜ
 
	gmaxV®ue
 = 
Ãw
 LÚgAccumuÏtÜ(
M©h
::
max
, 
LÚg
.
MIN_VALUE
);

20 @
Ov”ride


21 
´Ùeùed
 
’code
(
ChªÃlHªdËrCÚ‹xt
 
chªÃlHªdËrCÚ‹xt
,

22 
CÜfuMsg
 
cÜfuMsg
,

23 
By‹Buf
 
by‹Buf
è
throws
 
	gExû±iÚ
 {

24 
	gŒy
 {

25 
	gcÜfuMsg
.
£rŸlize
(
by‹Buf
);

26 if(
	glog
.
isDebugEÇbËd
()) {

27 
	g´ev
 = 
maxV®ue
.
g‘
();

28 
	gmaxV®ue
.
accumuÏ‹
(
by‹Buf
.
»adabËBy‹s
());

29 
	gcu¼
 = 
maxV®ue
.
g‘
();

31 ià(
	g´ev
 < 
	gcu¼
) {

32 
	glog
.
debug
("’code: New max wr™bufã¸found {}", 
cu¼
);

36 } 
ÿtch
 (
Exû±iÚ
 
e
) {

37 
	glog
.
”rÜ
("’code: E¼Ü duršg s”Ÿliz©iÚ!", 
e
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/NodeState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gToSŒšg
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

24 @
	gG‘‹r


25 @
	gBud”


26 @
	gToSŒšg


27 @
	gAÎArgsCÚ¡ruùÜ


28 @
Equ®sAndHashCode


29 
public
 
şass
 
NodeS‹
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gNodeS‹
> {

31 
´iv©e
 
fš®
 
NodeCÚÃùiv™y
 
	gcÚÃùiv™y
;

37 
´iv©e
 
fš®
 
Sequ’ûrM‘rics
 
	g£qu’ûrM‘rics
;

39 
public
 
NodeS‹
(
By‹Buf
 
buf
) {

40 
	gcÚÃùiv™y
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
NodeCÚÃùiv™y
.
şass
);

41 
	g£qu’ûrM‘rics
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
Sequ’ûrM‘rics
.
şass
);

44 @
Ov”ride


45 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

46 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
cÚÃùiv™y
);

47 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
£qu’ûrM‘rics
);

50 
public
 
NodeS‹
 
g‘UÇvaabËNodeS‹
(
SŒšg
 
’dpošt
){

51  
Ãw
 
NodeS‹
(

52 
NodeCÚÃùiv™y
.
uÇvaabË
(
’dpošt
),

53 
Sequ’ûrM‘rics
.
UNKNOWN


57 
public
 
NodeS‹
 
g‘NÙR—dyNodeS‹
(
SŒšg
 
’dpošt
){

58  
Ãw
 
NodeS‹
(

59 
NodeCÚÃùiv™y
.
nÙR—dy
(
’dpošt
),

60 
Sequ’ûrM‘rics
.
UNKNOWN


64 
public
 
boŞ—n
 
isCÚÃùed
() {

65  
	gcÚÃùiv™y
.
g‘Ty³
(è=ğ
NodeCÚÃùiv™yTy³
.
CONNECTED
;

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/PriorityLevel.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
	ePriÜ™yLev–
 {

19 
NORMAL
(0),

22 
HIGH
(1);

24 
public
 
fš®
 
	mty³
;

26 
public
 
by‹
 
asBy‹
() {

27  (
	mby‹
è
	mty³
;

30 
public
 
fš®
 
	mM­
<
	mBy‹
, 
	mPriÜ™yLev–
> 
	mty³M­
 =

31 
A¼ays
.
¡»am
(
PriÜ™yLev–
.
v®ues
()).
cŞËù
(
CŞËùÜs
.
toM­
(PriÜ™yLev–::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/RangeWriteMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 @
	gD©a


16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
şass
 
RªgeWr™eMsg
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gRªgeWr™eMsg
> {

19 
´iv©e
 
	gLi¡
<
	gLogD©a
> 
	g’Œ›s
;

21 
public
 
RªgeWr™eMsg
(
By‹Buf
 
buf
) {

22 
	g’Œ›s
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
LogD©a
.
şass
);

25 @
Ov”ride


26 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

27 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
’Œ›s
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ReadRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

11 @
	gG‘‹r


12 @
AÎArgsCÚ¡ruùÜ


13 
public
 
şass
 
R—dReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gR—dReque¡
> {

16 
´iv©e
 
fš®
 
	gadd»ss
;

19 
´iv©e
 
fš®
 
boŞ—n
 
	gÿcheR—dResuÉ
;

26 
public
 
R—dReque¡
(
By‹Buf
 
buf
) {

27 
	gadd»ss
 = 
buf
.
»adLÚg
();

28 
	gÿcheR—dResuÉ
 = 
buf
.
»adBoŞ—n
();

31 @
Ov”ride


32 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

33 
	gbuf
.
wr™eLÚg
(
add»ss
);

34 
	gbuf
.
wr™eBoŞ—n
(
ÿcheR—dResuÉ
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/ReadResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

9 
impÜt
 
	glombok
.
	gD©a
;

10 
impÜt
 
	glombok
.
	gG‘‹r
;

15 @
	gD©a


16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
şass
 
R—dRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gR—dRe¥Ú£
> {

19 @
G‘‹r


20 
	gM­
<
	gLÚg
, 
	gLogD©a
> 
	gadd»s£s
;

22 
public
 
R—dRe¥Ú£
(
By‹Buf
 
buf
) {

23 
	gadd»s£s
 = 
ICÜfuPaylßd
.
m­FromBufãr
(
buf
, 
LÚg
.
şass
, 
LogD©a
.class);

26 
public
 
R—dRe¥Ú£
() {

27 
	gadd»s£s
 = 
Ãw
 
HashM­
<
LÚg
, 
	gLogD©a
>();

30 
public
 
put
(
LÚg
 
add»ss
, 
LogD©a
 
d©a
) {

31 
	gadd»s£s
.
put
(
add»ss
, 
d©a
);

34 @
Ov”ride


35 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

36 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
add»s£s
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/SequencerMetrics.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gD©a
;

12 @
D©a


13 
public
 
şass
 
Sequ’ûrM‘rics
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gSequ’ûrM‘rics
> {

15 
public
 
fš®
 
Sequ’ûrM‘rics
 
	gREADY
 = 
Ãw
 Sequ’ûrM‘rics(
Sequ’ûrStus
.
READY
);

16 
public
 
fš®
 
Sequ’ûrM‘rics
 
	gNOT_READY
 = 
Ãw
 Sequ’ûrM‘rics(
Sequ’ûrStus
.
NOT_READY
);

17 
public
 
fš®
 
Sequ’ûrM‘rics
 
	gUNKNOWN
 = 
Ãw
 Sequ’ûrM‘rics(
Sequ’ûrStus
.
UNKNOWN
);

19 
public
 
	eSequ’ûrStus
 {

21 
	gREADY
,

23 
	gNOT_READY
,

25 
	gUNKNOWN


31 
´iv©e
 
fš®
 
Sequ’ûrStus
 
	g£qu’ûrStus
;

33 
public
 
Sequ’ûrM‘rics
(
Sequ’ûrStus
 
£qu’ûrStus
) {

34 
	gthis
.
	g£qu’ûrStus
 = 
£qu’ûrStus
;

37 
public
 
Sequ’ûrM‘rics
(
By‹Buf
 
buf
) {

38 
	g£qu’ûrStus
 = 
Sequ’ûrStus
.
v®ueOf
(
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
));

41 @
Ov”ride


42 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

43 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
£qu’ûrStus
.
toSŒšg
());

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/SequencerRecoveryMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

9 
impÜt
 
	glombok
.
	gD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

15 @
	gD©a


16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
şass
 
Sequ’ûrRecov”yMsg
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gSequ’ûrRecov”yMsg
> {

19 
´iv©e
 
fš®
 
LÚg
 
	gglob®Ta
;

20 
´iv©e
 
fš®
 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
	g¡»amsAdd»ssM­
;

21 
´iv©e
 
fš®
 
LÚg
 
	g£qu’ûrEpoch
;

28 
´iv©e
 
BoŞ—n
 
	gboÙ¡¿pW™houtTasUpd©e
;

30 
public
 
Sequ’ûrRecov”yMsg
(
By‹Buf
 
buf
) {

31 
	gglob®Ta
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

32 
	g¡»amsAdd»ssM­
 = 
ICÜfuPaylßd
.
m­FromBufãr
(
buf
, 
UUID
.
şass
, 
SŒ—mAdd»ssS·û
.class);

33 
	g£qu’ûrEpoch
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

34 
	gboÙ¡¿pW™houtTasUpd©e
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
BoŞ—n
.
şass
);

37 @
Ov”ride


38 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

40 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
glob®Ta
);

41 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡»amsAdd»ssM­
);

42 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
£qu’ûrEpoch
);

43 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
boÙ¡¿pW™houtTasUpd©e
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/StreamAddressRange.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	glombok
.
	gV®ue
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 @
V®ue


16 
public
 cÏs 
	cSŒ—mAdd»ssRªge
 {

18 
´iv©e
 
fš®
 
UUID
 
	m¡»amID
;

20 
´iv©e
 
fš®
 
	m¡¬t
;

23 
´iv©e
 
fš®
 
	m’d
;

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/StreamsAddressRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	glombok
.
	gNÚNuÎ
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 @
	gD©a


17 @
	gAÎArgsCÚ¡ruùÜ


18 @
CÜfuPaylßd


19 
public
 
şass
 
SŒ—msAdd»ssReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gSŒ—msAdd»ssReque¡
>{

21 
public
 
fš®
 
by‹
 
	gSTREAMS
 = 0;

23 
public
 
fš®
 
by‹
 
	gALL_STREAMS
 = 1;

26 
fš®
 
by‹
 
	g»qTy³
;

28 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒ—mAdd»ssRªge
> 
	g¡»amsRªges
;

30 
public
 
SŒ—msAdd»ssReque¡
(@
NÚNuÎ
 
Li¡
<
SŒ—mAdd»ssRªge
> 
¡»amsRªges
) {

31 
	g»qTy³
 = 
STREAMS
;

32 
	gthis
.
	g¡»amsRªges
 = 
¡»amsRªges
;

35 
public
 
SŒ—msAdd»ssReque¡
(
By‹
 
»qTy³
) {

36 
	gthis
.
	g»qTy³
 = 
»qTy³
;

37 
	gthis
.
	g¡»amsRªges
 = 
CŞËùiÚs
.
EMPTY_LIST
;

45 
public
 
SŒ—msAdd»ssReque¡
(
By‹Buf
 
buf
) {

46 
	g»qTy³
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
By‹
.
şass
);

47 ià(
	g»qTy³
 !ğ
ALL_STREAMS
) {

48 
¡»amsRªges
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
SŒ—mAdd»ssRªge
.
şass
);

50 
	g¡»amsRªges
 = 
CŞËùiÚs
.
EMPTY_LIST
;

54 @
Ov”ride


55 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

56 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
»qTy³
);

57 ià(
	g»qTy³
 !ğ
ALL_STREAMS
) {

58 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡»amsRªges
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/StreamsAddressResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gV®ue
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

17 @
V®ue


18 
public
 
şass
 
SŒ—msAdd»ssRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gSŒ—msAdd»ssRe¥Ú£
>{

20 
´iv©e
 
	glogTa
;

22 
´iv©e
 
fš®
 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
	gadd»ssM­
;

24 
public
 
SŒ—msAdd»ssRe¥Ú£
(
logTa
, 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amsAdd»s£sM­
) {

25 
	gthis
.
	glogTa
 = 
logTa
;

26 
	gthis
.
	gadd»ssM­
 = 
¡»amsAdd»s£sM­
;

34 
public
 
SŒ—msAdd»ssRe¥Ú£
(
By‹Buf
 
buf
) {

35 
	gthis
.
	glogTa
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

36 
	gthis
.
	gadd»ssM­
 = 
ICÜfuPaylßd
.
m­FromBufãr
(
buf
, 
UUID
.
şass
, 
SŒ—mAdd»ssS·û
.class);

39 @
Ov”ride


40 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

41 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
this
.
logTa
);

42 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
this
.
add»ssM­
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TailsRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

7 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

20 @
	gD©a


21 @
AÎArgsCÚ¡ruùÜ


22 
public
 
şass
 
TasReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTasReque¡
> {

24 
public
 
fš®
 
by‹
 
	gLOG_TAIL
 = 0;

25 
public
 
fš®
 
by‹
 
	gSTREAMS_TAILS
 = 1;

27 
public
 
fš®
 
by‹
 
	gALL_STREAMS_TAIL
 = 2;

30 
´iv©e
 
fš®
 
by‹
 
	g»qTy³
;

33 
´iv©e
 
fš®
 
	gLi¡
<
	gUUID
> 
	g¡»ams
;

40 
public
 
TasReque¡
(
Li¡
<
UUID
> 
¡»ams
) {

41 
	g»qTy³
 = 
STREAMS_TAILS
;

42 
	gthis
.
	g¡»ams
 = 
¡»ams
;

45 
public
 
TasReque¡
(
by‹
 
»qTy³
) {

46 
	gthis
.
	g»qTy³
 = 
»qTy³
;

47 
	gthis
.
	g¡»ams
 = 
CŞËùiÚs
.
EMPTY_LIST
;

55 
public
 
TasReque¡
(
By‹Buf
 
buf
) {

56 
	g»qTy³
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
By‹
.
şass
);

58 
	g»qTy³
) {

59 
	gSTREAMS_TAILS
:

60 
¡»ams
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
UUID
.
şass
);

64 
¡»ams
 = 
CŞËùiÚs
.
EMPTY_LIST
;

69 @
Ov”ride


70 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

71 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
»qTy³
);

72 ià(
	g»qTy³
 =ğ
STREAMS_TAILS
) {

73 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡»ams
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TailsResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

10 
impÜt
 
	glombok
.
	gD©a
;

11 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

23 @
	gD©a


24 @
	gRequœedArgsCÚ¡ruùÜ


25 @
AÎArgsCÚ¡ruùÜ


26 
public
 
şass
 
TasRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTasRe¥Ú£
> {

28 
	g•och
 = 
Layout
.
INVALID_EPOCH
;

30 
fš®
 
	glogTa
;

32 
fš®
 
	gM­
<
	gUUID
, 
	gLÚg
> 
	g¡»amTas
;

34 
public
 
TasRe¥Ú£
(
logTa
) {

35 
	gthis
.
	glogTa
 = 
logTa
;

36 
	g¡»amTas
 = 
CŞËùiÚs
.
EMPTY_MAP
;

39 
public
 
TasRe¥Ú£
(
By‹Buf
 
buf
) {

40 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

41 
	glogTa
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

42 
	g¡»amTas
 = 
ICÜfuPaylßd
.
m­FromBufãr
(
buf
, 
UUID
.
şass
, 
LÚg
.class);

45 @
Ov”ride


46 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

47 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

48 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
logTa
);

49 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡»amTas
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/Token.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

14 @
	gD©a


15 @
	gAÎArgsCÚ¡ruùÜ


16 @
Equ®sAndHashCode


17 
public
 
şass
 
Tok’
 
im¶em’ts
 
	gITok’
, 
	gCom·¿bË
<
	gTok’
> {

19 
public
 
fš®
 
Tok’
 
	gUNINITIALIZED
 = 
Ãw
 Tok’(
Add»ss
.
NON_ADDRESS
, Address.NON_ADDRESS);

21 
´iv©e
 
fš®
 
	g•och
;

22 
´iv©e
 
fš®
 
	g£qu’û
;

24 @
Ov”ride


25 
public
 
com·»To
(
Tok’
 
o
) {

26 
	g•ochCmp
 = 
LÚg
.
com·»
(
•och
, 
o
.
g‘Epoch
());

27 ià(
	g•ochCmp
 == 0) {

28  
LÚg
.
com·»
(
£qu’û
, 
o
.
g‘Sequ’û
());

30  
	g•ochCmp
;

39 
public
 
Tok’
 
mš
(Tok’ 
a
, Tok’ 
b
) {

40 ià(
	ga
.
com·»To
(
b
) <= 0) {

41  
a
;

43  
	gb
;

47 
public
 
Tok’
 
of
(
•och
, 
£qu’û
) {

48  
Ãw
 
Tok’
(
•och
, 
£qu’û
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TokenRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

9 
impÜt
 
	glombok
.
	gD©a
;

25 @
	gD©a


26 @
AÎArgsCÚ¡ruùÜ


27 
public
 
şass
 
Tok’Reque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTok’Reque¡
> {

29 
public
 
fš®
 
by‹
 
	gTK_QUERY
 = 0;

30 
public
 
fš®
 
by‹
 
	gTK_RAW
 = 1;

32 
public
 
fš®
 
by‹
 
	gTK_MULTI_STREAM
 = 3;

33 
public
 
fš®
 
by‹
 
	gTK_TX
 = 4;

36 
fš®
 
by‹
 
	g»qTy³
;

39 
fš®
 
LÚg
 
	gnumTok’s
;

42 
fš®
 
	gLi¡
<
	gUUID
> 
	g¡»ams
;

45 
fš®
 
TxResŞutiÚInfo
 
	gtxnResŞutiÚ
;

54 
public
 
Tok’Reque¡
(
LÚg
 
numTok’s
, 
Li¡
<
UUID
> 
¡»ams
,

55 
TxResŞutiÚInfo
 
cÚæiùInfo
) {

56 
	g»qTy³
 = 
TK_TX
;

57 
	gthis
.
	gnumTok’s
 = 
numTok’s
;

58 
	gthis
.
	g¡»ams
 = 
¡»ams
;

59 
	gtxnResŞutiÚ
 = 
cÚæiùInfo
;

68 
public
 
Tok’Reque¡
(
LÚg
 
numTok’s
, 
Li¡
<
UUID
> 
¡»ams
) {

69 ià(
	gnumTok’s
 == 0) {

70 
this
.
»qTy³
 = 
TK_QUERY
;

71 } ià(
	g¡»ams
 =ğ
nuÎ
 || 
¡»ams
.
isEm±y
()) {

72 
this
.
»qTy³
 = 
TK_RAW
;

74 
	gthis
.
	g»qTy³
 = 
TK_MULTI_STREAM
;

76 
	gthis
.
	gnumTok’s
 = 
numTok’s
;

77 
	gthis
.
	g¡»ams
 = 
¡»ams
;

78 
	gtxnResŞutiÚ
 = 
nuÎ
;

86 
public
 
Tok’Reque¡
(
By‹Buf
 
buf
) {

87 
	g»qTy³
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
By‹
.
şass
);

89 
	g»qTy³
) {

91 
	gTK_QUERY
:

92 
numTok’s
 = 0L;

93 
	g¡»ams
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
UUID
.
şass
);

94 
	gtxnResŞutiÚ
 = 
nuÎ
;

97 
	gTK_RAW
:

98 
numTok’s
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

99 
	g¡»ams
 = 
nuÎ
;

100 
	gtxnResŞutiÚ
 = 
nuÎ
;

103 
	gTK_MULTI_STREAM
:

104 
numTok’s
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

105 
	g¡»ams
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
UUID
.
şass
);

106 
	gtxnResŞutiÚ
 = 
nuÎ
;

109 
	gTK_TX
:

110 
numTok’s
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

111 
	g¡»ams
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
UUID
.
şass
);

112 
	gtxnResŞutiÚ
 = 
Ãw
 
TxResŞutiÚInfo
(
buf
);

116 
numTok’s
 = -1L;

117 
	g¡»ams
 = 
nuÎ
;

118 
	gtxnResŞutiÚ
 = 
nuÎ
;

123 @
Ov”ride


124 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

125 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
»qTy³
);

126 ià(
	g»qTy³
 !ğ
TK_QUERY
) {

127 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
numTok’s
);

130 ià(
	g»qTy³
 !ğ
TK_RAW
) {

131 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡»ams
);

134 ià(
	g»qTy³
 =ğ
TK_TX
) {

135 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
txnResŞutiÚ
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TokenResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

6 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
impÜt
 
	glombok
.
	gAcûssLev–
;

11 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

12 
impÜt
 
	glombok
.
	gD©a
;

13 
impÜt
 
	glombok
.
	gG‘‹r
;

18 @
	gD©a


19 @
AÎArgsCÚ¡ruùÜ


20 
public
 
şass
 
Tok’Re¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTok’Re¥Ú£
>, 
	gITok’
 {

22 
public
 
	gby‹
[] 
	gNO_CONFLICT_KEY
 = 
Ãw
 
by‹
[]{ 0 };

23 
public
 
UUID
 
	gNO_CONFLICT_STREAM
 = 
Ãw
 UUID(0, 0);

31 
public
 
Tok’Re¥Ú£
(
Tok’
 
tok’
, 
M­
<
UUID
, 
LÚg
> 
backpoš‹rM­
) {

32 
	gthis
.
	g»¥Ty³
 = 
Tok’Ty³
.
NORMAL
;

33 
	gthis
.
	gcÚæiùKey
 = 
NO_CONFLICT_KEY
;

34 
	gthis
.
	gcÚæiùSŒ—m
 = 
NO_CONFLICT_STREAM
;

35 
	gthis
.
	gtok’
 = 
tok’
;

36 
	gthis
.
	gbackpoš‹rM­
 = 
backpoš‹rM­
;

37 
	gthis
.
	g¡»amTas
 = 
CŞËùiÚs
.
em±yM­
();

41 
fš®
 
Tok’Ty³
 
	g»¥Ty³
;

44 
fš®
 
	gby‹
[] 
	gcÚæiùKey
;

47 
fš®
 
UUID
 
	gcÚæiùSŒ—m
;

50 
fš®
 
Tok’
 
	gtok’
;

53 
fš®
 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gbackpoš‹rM­
;

55 @
G‘‹r
(
AcûssLev–
.
NONE
)

56 
fš®
 
	gM­
<
	gUUID
, 
	gLÚg
> 
	g¡»amTas
;

63 
public
 
Tok’Re¥Ú£
(
By‹Buf
 
buf
) {

64 
	g»¥Ty³
 = 
Tok’Ty³
.
v®ues
()[
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
By‹
.
şass
)];

65 
	gcÚæiùKey
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
by‹
[].
şass
);

66 
	gcÚæiùSŒ—m
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
UUID
.
şass
);

67 
LÚg
 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, LÚg.
şass
);

68 
LÚg
 
	g£qu’û
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, LÚg.
şass
);

69 
	gtok’
 = 
Ãw
 
Tok’
(
•och
, 
£qu’û
);

70 
	gbackpoš‹rM­
 = 
ICÜfuPaylßd
.
m­FromBufãr
(
buf
, 
UUID
.
şass
, 
LÚg
.class);

71 
	g¡»amTas
 = 
ICÜfuPaylßd
.
m­FromBufãr
(
buf
, 
UUID
.
şass
, 
LÚg
.class);

74 @
Ov”ride


75 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

76 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
»¥Ty³
);

77 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
cÚæiùKey
);

78 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
cÚæiùSŒ—m
);

79 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
tok’
.
g‘Epoch
());

80 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
this
.
g‘Sequ’û
());

81 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
backpoš‹rM­
);

82 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
¡»amTas
);

85 @
Ov”ride


86 
public
 
g‘Sequ’û
() {

87  
	gtok’
.
g‘Sequ’û
();

90 @
Ov”ride


91 
public
 
g‘Epoch
() {

92  
	gtok’
.
g‘Epoch
();

95 
public
 
LÚg
 
g‘SŒ—mTa
(
UUID
 
¡»amId
) {

96  
	g¡»amTas
.
g‘
(
¡»amId
);

99 @
VisibËFÜTe¡šg


100 
public
 
g‘SŒ—mTasCouÁ
() {

101  
	g¡»amTas
.
size
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TokenType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

10 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

16 @
RequœedArgsCÚ¡ruùÜ


17 
public
 
Tok’Ty³
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTok’Ty³
> {

20 
NORMAL
((
by‹
) 0),

23 
TX_ABORT_CONFLICT
((
by‹
) 1),

27 
TX_ABORT_NEWSEQ
((
by‹
) 2),

31 
TX_ABORT_SEQ_OVERFLOW
((
by‹
) 3),

35 
TX_ABORT_SEQ_TRIM
((
by‹
) 4);

37 
fš®
 
	gv®
;

39 
by‹
 
asBy‹
() {

40  (
	gby‹
è
	gv®
;

43 @
Ov”ride


44 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

45 
	gbuf
.
wr™eBy‹
(
asBy‹
());

48 
	gM­
<
	gBy‹
, 
	gTok’Ty³
> 
	gty³M­
 =

49 
A¼ays
.
¡»am
(
Tok’Ty³
.
v®ues
())

50 .
cŞËù
(
CŞËùÜs
.
toM­
(
Tok’Ty³
::
asBy‹
, 
FunùiÚ
.
id’t™y
()));

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TrimRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

11 @
	gCÜfuPaylßd


12 @
	gD©a


13 @
RequœedArgsCÚ¡ruùÜ


14 
public
 
şass
 
TrimReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTrimReque¡
> {

16 
fš®
 
Tok’
 
	gadd»ss
;

23 
public
 
TrimReque¡
(
By‹Buf
 
buf
) {

24 
	g•och
 = 
buf
.
»adLÚg
();

25 
	g£qu’û
 = 
buf
.
»adLÚg
();

26 
	gadd»ss
 = 
Ãw
 
Tok’
(
•och
, 
£qu’û
);

29 @
Ov”ride


30 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

31 
	gbuf
.
wr™eLÚg
(
add»ss
.
g‘Epoch
());

32 
	gbuf
.
wr™eLÚg
(
add»ss
.
g‘Sequ’û
());

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/TxResolutionInfo.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

7 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

12 
impÜt
 
	glombok
.
	gG‘‹r
;

13 
impÜt
 
	glombok
.
	gS‘‹r
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

20 
public
 
şass
 
TxResŞutiÚInfo
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gTxResŞutiÚInfo
> {

22 @
	gG‘‹r


23 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviationaswordinname", "checkstyle:membername"})

24 
fš®
 
UUID
 
	gTXid
;

27 @
	gG‘‹r


28 @
S‘‹r


29 
Tok’
 
	g¢­shÙTime¡amp
;

33 @
G‘‹r


34 
fš®
 
	gM­
<
	gUUID
, 
	gS‘
<
	gby‹
[]>> 
	gcÚæiùS‘
;

36 @
G‘‹r


37 
fš®
 
	gM­
<
	gUUID
, 
	gS‘
<
	gby‹
[]>> 
	gwr™eCÚæiùP¬ams
;

45 
public
 
TxResŞutiÚInfo
(
UUID
 
txId
, 
Tok’
 
¢­shÙTime¡amp
) {

46 
	gthis
.
	gTXid
 = 
txId
;

47 
	gthis
.
	g¢­shÙTime¡amp
 = 
¢­shÙTime¡amp
;

48 
	gthis
.
	gcÚæiùS‘
 = 
CŞËùiÚs
.
em±yM­
();

49 
	gthis
.
	gwr™eCÚæiùP¬ams
 = 
CŞËùiÚs
.
em±yM­
();

60 
public
 
TxResŞutiÚInfo
(
UUID
 
txId
, 
Tok’
 
¢­shÙTime¡amp
, 
M­
<UUID, 
S‘
<
by‹
[]>>

61 
cÚæiùM­
, 
M­
<
UUID
, 
S‘
<
by‹
[]>> 
wr™eCÚæiùP¬ams
) {

62 
	gthis
.
	gTXid
 = 
txId
;

63 
	gthis
.
	g¢­shÙTime¡amp
 = 
¢­shÙTime¡amp
;

64 
	gthis
.
	gcÚæiùS‘
 = 
cÚæiùM­
;

65 
	gthis
.
	gwr™eCÚæiùP¬ams
 = 
wr™eCÚæiùP¬ams
;

78 
public
 
TxResŞutiÚInfo
(
By‹Buf
 
buf
) {

79 
	gTXid
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
UUID
.
şass
);

80 
fš®
 
	g•och
 = 
buf
.
»adLÚg
();

81 
fš®
 
	g£qu’û
 = 
buf
.
»adLÚg
();

82 
	g¢­shÙTime¡amp
 = 
Ãw
 
Tok’
(
•och
, 
£qu’û
);

85 
	gnumEÁr›s
 = 
buf
.
»adIÁ
();

86 
	gImmubËM­
.
	gBud”
<
	gUUID
, 
	gS‘
<
	gby‹
[]>> 
	gcÚæiùM­Bud”
 = 
Ãw
 
ImmubËM­
.
Bud”
<>();

87 
	gi
 = 0; i < 
	gnumEÁr›s
; i++) {

88 
UUID
 
	gk
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, UUID.
şass
);

89 
	gS‘
<
	gby‹
[]> 
	gv
 = 
ICÜfuPaylßd
.
£tFromBufãr
(
buf
, 
by‹
[].
şass
);

90 
	gcÚæiùM­Bud”
.
put
(
k
, 
v
);

92 
	gcÚæiùS‘
 = 
cÚæiùM­Bud”
.
bud
();

95 
	gnumEÁr›s
 = 
buf
.
»adIÁ
();

96 
	gImmubËM­
.
	gBud”
<
	gUUID
, 
	gS‘
<
	gby‹
[]>> 
	gwr™eM­Bud”
 = 
Ãw
 
ImmubËM­
.
Bud”
<>();

97 
	gi
 = 0; i < 
	gnumEÁr›s
; i++) {

98 
UUID
 
	gk
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, UUID.
şass
);

99 
	gS‘
<
	gby‹
[]> 
	gv
 = 
ICÜfuPaylßd
.
£tFromBufãr
(
buf
, 
by‹
[].
şass
);

100 
	gwr™eM­Bud”
.
put
(
k
, 
v
);

103 
	gwr™eCÚæiùP¬ams
 = 
wr™eM­Bud”
.
bud
();

111 @
Ov”ride


112 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

113 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
TXid
);

114 
	gbuf
.
wr™eLÚg
(
¢­shÙTime¡amp
.
g‘Epoch
());

115 
	gbuf
.
wr™eLÚg
(
¢­shÙTime¡amp
.
g‘Sequ’û
());

118 
	gbuf
.
wr™eIÁ
(
cÚæiùS‘
.
size
());

119 
	gcÚæiùS‘
.
’ŒyS‘
().
¡»am
().
fÜEach
(
x
 -> {

120 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
x
.
g‘Key
());

121 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
x
.
g‘V®ue
());

125 
	gbuf
.
wr™eIÁ
(
wr™eCÚæiùP¬ams
.
size
());

126 
	gwr™eCÚæiùP¬ams
.
’ŒyS‘
().
¡»am
().
fÜEach
(
x
 -> {

127 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
x
.
g‘Key
());

128 
ICÜfuPaylßd
.
£rŸlize
(
buf
, 
x
.
g‘V®ue
());

132 @
Ov”ride


133 
public
 
SŒšg
 
toSŒšg
() {

134  "TXINFO[" + 
	gUts
.
toR—dabËId
(
TXid
) + "](ts="

135 + 
	g¢­shÙTime¡amp
 + ")";

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/VersionInfo.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gMªagem’tFaùÜy
;

4 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
public
 cÏs 
	cV”siÚInfo
 {

14 @
G‘‹r


15 
	mM­
<
	mSŒšg
, 
	mObjeù
> 
	mİtiÚsM­
;

17 @
G‘‹r


18 
	mupTime
 = 
Mªagem’tFaùÜy
.
g‘RuÁimeMXB—n
().
g‘U±ime
();

20 @
G‘‹r


21 
SŒšg
 
	m¡¬tupArgs
 = 
Sy¡em
.
g‘Prİ”ty
("sun.java.command");

23 @
G‘‹r


24 
SŒšg
 
	mjvmU£d
 = 
Sy¡em
.
g‘Prİ”ty
("java.home") + "/bin/java";

26 @
G‘‹r


27 
SŒšg
 
	mv”siÚ
;

29 @
G‘‹r


30 
SŒšg
 
	mnodeId
;

37 
public
 
V”siÚInfo
(
M­
<
SŒšg
,
Objeù
> 
İtiÚsM­
, @
NÚnuÎ
 SŒšg 
nodeId
) {

38 
	mthis
.
	mİtiÚsM­
 = 
Ãw
 
HashM­
<>(
İtiÚsM­
);

40 
	mthis
.
	mİtiÚsM­
.
’ŒyS‘
()

41 .
»moveIf
(
e
 -> {

42 
Objeù
 
v
 = 
e
.
g‘V®ue
();

43  !(
v
 
š¡ªûof
 
IÁeg”
 || v in¡ªûoà
LÚg
 || v in¡ªûoà
SŒšg
);

45 
	mthis
.
	mnodeId
 = 
nodeId
;

46 
	mthis
.
	mv”siÚ
 = 
CÜfuRuÁime
.
g‘V”siÚSŒšg
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/WriteRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	gjava
.
	gut
.
	gEnumM­
;

13 @
	gBud”


14 @
AÎArgsCÚ¡ruùÜ


15 
public
 
şass
 
Wr™eReque¡
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gWr™eReque¡
>, 
	gIM‘ad©a
 {

17 @
G‘‹r


18 
fš®
 
ILogD©a
 
	gd©a
;

20 @
Suµ»ssW¬nšgs
("unchecked")

21 
public
 
Wr™eReque¡
(
By‹Buf
 
buf
) {

22 
	gthis
.
	gd©a
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LogD©a
.
şass
);

25 
public
 
Wr™eReque¡
(
D©aTy³
 
d©aTy³
, 
By‹Buf
 
buf
) {

26 
	gthis
.
	gd©a
 = 
Ãw
 
LogD©a
(
d©aTy³
, 
buf
);

29 @
Ov”ride


30 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

31 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
d©a
);

34 @
Ov”ride


35 
public
 
	gEnumM­
<
	gLogUn™M‘ad©aTy³
, 
	gObjeù
> 
g‘M‘ad©aM­
() {

36  
	gd©a
.
g‘M‘ad©aM­
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/failuredetector/FailureDetectorMetrics.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gJsÚUts
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

11 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

18 @
	gBud”


19 @
AÎArgsCÚ¡ruùÜ


20 
public
 
şass
 
Fau»D‘eùÜM‘rics
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gFau»D‘eùÜM‘rics
> {

22 
´iv©e
 
fš®
 
SŒšg
 
	gloÿlNode
;

23 
´iv©e
 
fš®
 
CÚÃùiv™yG¿ph
 
	gg¿ph
;

26 
´iv©e
 
fš®
 
Fau»D‘eùÜAùiÚ
 
	gaùiÚ
;

27 
´iv©e
 
fš®
 
NodeRªk
 
	gçed
;

28 
´iv©e
 
fš®
 
NodeRªk
 
	gh—Ëd
;

31 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒšg
> 
	gÏyout
;

32 
´iv©e
 
fš®
 
	gLi¡
<
	gSŒšg
> 
	guÄe¥ÚsiveNodes
;

33 
´iv©e
 
fš®
 
	g•och
;

35 
public
 
SŒšg
 
toJsÚ
(){

36  
	gJsÚUts
.
toJsÚ
(
this
);

39 
public
 
Fau»D‘eùÜM‘rics
(
By‹Buf
 
buf
) {

40 
	gloÿlNode
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
);

41 
	gg¿ph
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
CÚÃùiv™yG¿ph
.
şass
);

42 
	gaùiÚ
 = 
Fau»D‘eùÜAùiÚ
.
v®ueOf
(
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
));

43 
	gçed
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
NodeRªk
.
şass
);

44 
	gh—Ëd
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
NodeRªk
.
şass
);

45 
	gÏyout
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
SŒšg
.
şass
);

46 
	guÄe¥ÚsiveNodes
 = 
ICÜfuPaylßd
.
li¡FromBufãr
(
buf
, 
SŒšg
.
şass
);

47 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

50 @
Ov”ride


51 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

52 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
loÿlNode
);

53 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
g¿ph
);

54 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
aùiÚ
.
Çme
());

55 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
çed
 =ğ
nuÎ
 ? 
NodeRªk
.
EMPTY_NODE_RANK
: failed);

56 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
h—Ëd
 =ğ
nuÎ
 ? 
NodeRªk
.
EMPTY_NODE_RANK
: healed);

57 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
Ïyout
);

58 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
uÄe¥ÚsiveNodes
);

59 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

62 
public
 
	eFau»D‘eùÜAùiÚ
 {

63 
	gFAIL
, 
	gHEAL
, 
	gEXTERNAL_UPDATE


69 @
AÎArgsCÚ¡ruùÜ


70 
public
 
şass
 
CÚÃùiv™yG¿ph
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gCÚÃùiv™yG¿ph
> {

71 
´iv©e
 
fš®
 
	gNavigabËS‘
<
	gNodeCÚÃùiv™y
> 
	gg¿ph
;

73 
public
 
CÚÃùiv™yG¿ph
(
By‹Buf
 
buf
){

74 
	gg¿ph
 = 
Ãw
 
T»eS‘
<>(
ICÜfuPaylßd
.
£tFromBufãr
(
buf
, 
NodeCÚÃùiv™y
.
şass
));

77 @
Ov”ride


78 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

79 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
g¿ph
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/failuredetector/NodeConnectivity.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gNÚNuÎ
;

10 
impÜt
 
	glombok
.
	gToSŒšg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

16 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

23 @
	gBud”


24 @
	gAÎArgsCÚ¡ruùÜ


25 @
	gToSŒšg


26 @
Equ®sAndHashCode


27 
public
 
şass
 
NodeCÚÃùiv™y
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gNodeCÚÃùiv™y
>, 
	gCom·¿bË
<NodeConnectivity> {

31 @
	gG‘‹r


32 @
NÚNuÎ


33 
´iv©e
 
fš®
 
SŒšg
 
	g’dpošt
;

35 @
	gG‘‹r


36 @
NÚNuÎ


37 
´iv©e
 
fš®
 
NodeCÚÃùiv™yTy³
 
	gty³
;

42 @
	gG‘‹r


43 @
NÚNuÎ


44 
´iv©e
 
fš®
 
	gImmubËM­
<
	gSŒšg
, 
	gCÚÃùiÚStus
> 
	gcÚÃùiv™y
;

46 @
G‘‹r


47 
´iv©e
 
fš®
 
	g•och
;

49 
public
 
NodeCÚÃùiv™y
(
By‹Buf
 
buf
) {

50 
	g’dpošt
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
);

51 
	gty³
 = 
NodeCÚÃùiv™yTy³
.
v®ueOf
(
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
));

53 
	gM­
<
	gSŒšg
, 
	gCÚÃùiÚStus
> 
	gcÚÃùiv™yM­
 = 
Ãw
 
HashM­
<>();

54 
	gICÜfuPaylßd


55 .
m­FromBufãr
(
buf
, 
SŒšg
.
şass
, String.class)

57 .
fÜEach
((
node
, 
¡©us
è-> 
cÚÃùiv™yM­
.
put
Òode, 
CÚÃùiÚStus
.
v®ueOf
(status)));

58 
	gcÚÃùiv™y
 = 
ImmubËM­
.
cİyOf
(
cÚÃùiv™yM­
);

59 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

62 @
Ov”ride


63 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

64 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
’dpošt
);

65 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
ty³
.
Çme
());

67 
	gM­
<
	gSŒšg
, SŒšg> 
	gcÚÃùiv™ySŒšgs
 = 
Ãw
 
HashM­
<>();

68 
	gcÚÃùiv™y
.
fÜEach
((
node
, 
¡©e
è-> 
cÚÃùiv™ySŒšgs
.
put
Òode, s‹.
Çme
()));

70 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
cÚÃùiv™ySŒšgs
);

71 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

77 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÚÃùedNodes
() {

78  
	gcÚÃùiv™y


79 .
keyS‘
()

80 .
¡»am
()

81 .
f‹r
(
adjaûÁ
 -> 
cÚÃùiv™y
.
g‘
×djaûÁè=ğ
CÚÃùiÚStus
.
OK
)

82 .
cŞËù
(
CŞËùÜs
.
toS‘
());

89 
public
 
	gS‘
<
	gSŒšg
> 
g‘FaedNodes
() {

90  
	gcÚÃùiv™y


91 .
keyS‘
()

92 .
¡»am
()

93 .
f‹r
(
adjaûÁ
 -> 
cÚÃùiv™y
.
g‘
×djaûÁè=ğ
CÚÃùiÚStus
.
FAILED
)

94 .
cŞËù
(
CŞËùÜs
.
toS‘
());

103 
public
 
CÚÃùiÚStus
 
g‘CÚÃùiÚStus
(
SŒšg
 
node
) {

104 ià(
	gty³
 =ğ
NodeCÚÃùiv™yTy³
.
UNAVAILABLE
) {

106 
SŒšg
 
”rÜ
 = SŒšg.
fÜm©
(

108 
’dpošt
, 
node
, 
cÚÃùiv™y
);

109 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
”rÜ
);

112 ià(!
	gcÚÃùiv™y
.
cÚšsKey
(
node
)) {

113 
SŒšg
 
	g”rÜ
 = SŒšg.
fÜm©
(

115 
’dpošt
, 
node
, 
cÚÃùiv™y
);

116 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
”rÜ
);

119  
	gcÚÃùiv™y
.
g‘
(
node
);

127 
public
 
g‘CÚÃùed
() {

128  
	gcÚÃùiv™y
.
keyS‘
().
¡»am
()

129 .
m­ToIÁ
(
node
 -> 
cÚÃùiv™y
.
g‘
Òodeè=ğ
CÚÃùiÚStus
.
OK
 ? 1 : 0)

130 .
sum
();

140 @
Ov”ride


141 
public
 
com·»To
(
NodeCÚÃùiv™y
 
Ùh”
) {

142  
	g’dpošt
.
com·»To
(
Ùh”
.
’dpošt
);

151 
public
 
NodeCÚÃùiv™y
 
cÚÃùiv™y
(
SŒšg
 
’dpošt
, 
ImmubËM­
<SŒšg, 
CÚÃùiÚStus
> connectivity) {

152  
	gNodeCÚÃùiv™y
.
bud”
()

153 .
’dpošt
(endpoint)

154 .
ty³
(
NodeCÚÃùiv™yTy³
.
CONNECTED
)

155 .
cÚÃùiv™y
(connectivity)

156 .
bud
();

164 
public
 
NodeCÚÃùiv™y
 
uÇvaabË
(
SŒšg
 
’dpošt
) {

165  
	gNodeCÚÃùiv™y
.
bud”
()

166 .
’dpošt
(endpoint)

167 .
ty³
(
NodeCÚÃùiv™yTy³
.
UNAVAILABLE
)

168 .
cÚÃùiv™y
(
ImmubËM­
.
of
())

169 .
bud
();

177 
public
 
NodeCÚÃùiv™y
 
nÙR—dy
(
SŒšg
 
’dpošt
) {

178  
	gNodeCÚÃùiv™y
.
bud”
()

179 .
’dpošt
(endpoint)

180 .
ty³
(
NodeCÚÃùiv™yTy³
.
NOT_READY
)

181 .
cÚÃùiv™y
(
ImmubËM­
.
of
())

182 .
bud
();

185 
public
 
	eNodeCÚÃùiv™yTy³
 {

190 
	gNOT_READY
,

194 
	gCONNECTED
,

198 
	gUNAVAILABLE


204 
public
 
	eCÚÃùiÚStus
 {

208 
	gOK
,

212 
	gFAILED
;

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/failuredetector/NodeRank.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
.
	gToSŒšg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

16 @
	gAÎArgsCÚ¡ruùÜ


17 @
	gEqu®sAndHashCode


18 @
	gG‘‹r


19 @
ToSŒšg


20 
public
 
şass
 
NodeRªk
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gNodeRªk
>, 
	gCom·¿bË
<NodeRank> {

21 
public
 
fš®
 
NodeRªk
 
	gEMPTY_NODE_RANK
 = 
Ãw
 NodeRªk("--", 
IÁeg”
.
MIN_VALUE
);

23 
´iv©e
 
fš®
 
SŒšg
 
	g’dpošt
;

27 
´iv©e
 
fš®
 
	gnumCÚÃùiÚs
;

35 @
Ov”ride


36 
public
 
com·»To
(
NodeRªk
 
Ùh”
) {

38 
	gcÚÃùiÚRªk
 = 
IÁeg”
.
com·»
(
Ùh”
.
numCÚÃùiÚs
,‚umConnections);

39 ià(
	gcÚÃùiÚRªk
 != 0) {

40  
cÚÃùiÚRªk
;

44  
	g’dpošt
.
com·»To
(
Ùh”
.
’dpošt
);

47 
public
 
boŞ—n
 
is
(
SŒšg
 
’dpošt
) {

48  
	gthis
.
	g’dpošt
.
equ®s
(
’dpošt
);

51 
public
 
NodeRªk
(
By‹Buf
 
buf
){

52 
	g’dpošt
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
SŒšg
.
şass
);

53 
	gnumCÚÃùiÚs
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
IÁeg”
.
şass
);

56 @
Ov”ride


57 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

58 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
’dpošt
);

59 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
numCÚÃùiÚs
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationEntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 @
D©a


10 
public
 
şass
 
LogR•liÿtiÚEÁry
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLogR•liÿtiÚEÁry
> {

12 
´iv©e
 
LogR•liÿtiÚEÁryM‘ad©a
 
	gm‘ad©a
;

14 
´iv©e
 
	gby‹
[] 
	g·ylßd
;

16 
public
 
LogR•liÿtiÚEÁry
(
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
, 
by‹
[] 
·ylßd
) {

17 
	gthis
.
	g·ylßd
 = 
·ylßd
;

18 
	gthis
.
	gm‘ad©a
 = 
m‘ad©a
;

21 
public
 
LogR•liÿtiÚEÁry
(
Mes§geTy³
 
ty³
, 
•och
, 
UUID
 
syncReque¡Id
, 
’ŒyTS
, 
´eTS
, 
¢­shÙ
, 
£qu’û
,

22 
by‹
[] 
·ylßd
) {

23 
	gthis
.
	gm‘ad©a
 = 
Ãw
 
LogR•liÿtiÚEÁryM‘ad©a
(
ty³
, 
•och
, 
syncReque¡Id
, 
’ŒyTS
, 
´eTS
, 
¢­shÙ
, 
£qu’û
);

24 
	gthis
.
	g·ylßd
 = 
·ylßd
;

27 
public
 
LogR•liÿtiÚEÁry
(
By‹Buf
 
buf
) {

28 
	gm‘ad©a
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LogR•liÿtiÚEÁryM‘ad©a
.
şass
);

29 
	g·ylßd
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
by‹
[].
şass
);

32 
public
 
LogR•liÿtiÚEÁry
 
g’”©eAck
(
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
) {

33  
Ãw
 
LogR•liÿtiÚEÁry
(
m‘ad©a
,‚ew 
by‹
[0]);

36 @
Ov”ride


37 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

38 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
m‘ad©a
);

39 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
·ylßd
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationEntryMetadata.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 @
D©a


9 
public
 cÏs 
	cLogR•liÿtiÚEÁryM‘ad©a
 {

13 
´iv©e
 
	ms™eEpoch
;

20 
´iv©e
 
Mes§geTy³
 
	mmes§geM‘ad©aTy³
;

26 
public
 
	mtime¡amp
;

31 
´iv©e
 
	m´eviousTime¡amp
;

36 
´iv©e
 
UUID
 
	msyncReque¡Id
;

42 
´iv©e
 
	m¢­shÙTime¡amp
;

44 
´iv©e
 
	m¢­shÙSyncSeqNum
;

47 
public
 
	$LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
 
ty³
, 
•och
, 
UUID
 
syncReque¡Id
, 
’ŒyTimeSmp
, 
´eviousEÁryTime¡amp
, 
¢­shÙTime¡amp
, 
£qu’û
) {

48 
	`this
(
ty³
, 
•och
, 
syncReque¡Id
, 
’ŒyTimeSmp
, 
¢­shÙTime¡amp
);

49 
this
.
´eviousTime¡amp
 = 
´eviousEÁryTime¡amp
;

50 
this
.
¢­shÙSyncSeqNum
 = 
£qu’û
;

53 
public
 
	$LogR•liÿtiÚEÁryM‘ad©a
(è{ 
	}
}

56 
public
 
	$LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
 
ty³
, 
•och
, 
UUID
 
syncReque¡Id
, 
’ŒyTimeSmp
, 
¢­shÙTime¡amp
) {

57 
this
.
mes§geM‘ad©aTy³
 = 
ty³
;

58 
this
.
s™eEpoch
 = 
•och
;

59 
this
.
syncReque¡Id
 = syncRequestId;

60 
this
.
time¡amp
 = 
’ŒyTimeSmp
;

61 
this
.
¢­shÙTime¡amp
 = snapshotTimestamp;

62 
	}
}

65 
public
 
	$LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
 
ty³
, 
•och
, 
UUID
 
syncReque¡Id
, 
’ŒyTimeSmp
, 
¢­shÙTime¡amp
, UUID 
¢­shÙReque¡Id
) {

66 
	`this
(
ty³
, 
•och
, 
syncReque¡Id
, 
’ŒyTimeSmp
, 
Add»ss
.
NON_EXIST
, 
¢­shÙTime¡amp
, Address.NON_EXIST);

67 
this
.
syncReque¡Id
 = 
¢­shÙReque¡Id
;

68 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationNegotiationResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

6 
public
 
şass
 
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLogR•liÿtiÚNegÙŸtiÚRe¥Ú£
> {

8 
´iv©e
 
	gba£SÇpshÙTime¡amp
;

9 
´iv©e
 
	glogEÁryTime¡amp
;

11 
public
 
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
(
By‹Buf
 
buf
) {

12 
	gba£SÇpshÙTime¡amp
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

13 
	glogEÁryTime¡amp
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

16 
public
 
LogR•liÿtiÚNegÙŸtiÚRe¥Ú£
(
ba£SÇpshÙTime¡amp
, 
logEÁryTime¡amp
) {

17 
	gthis
.
	gba£SÇpshÙTime¡amp
 = 
ba£SÇpshÙTime¡amp
;

18 
	gthis
.
	glogEÁryTime¡amp
 = 
logEÁryTime¡amp
;

21 @
Ov”ride


22 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

23 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
ba£SÇpshÙTime¡amp
);

24 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
logEÁryTime¡amp
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationQueryLeaderShipResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

8 @
D©a


9 
public
 
şass
 
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gLogR•liÿtiÚQu”yL—d”ShRe¥Ú£
> {

10 
	g•och
;

11 
boŞ—n
 
	gisL—d”
;

13 
public
 
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
(
•och
, 
boŞ—n
 
isL—d”
) {

14 
	gthis
.
	g•och
 = 
•och
;

15 
	gthis
.
	gisL—d”
 = 
isL—d”
;

18 
public
 
LogR•liÿtiÚQu”yL—d”ShRe¥Ú£
(
By‹Buf
 
buf
) {

19 
	g•och
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
LÚg
.
şass
);

20 
	gisL—d”
 = 
ICÜfuPaylßd
.
äomBufãr
(
buf
, 
BoŞ—n
.
şass
);

23 @
Ov”ride


24 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

25 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
•och
);

26 
	gICÜfuPaylßd
.
£rŸlize
(
buf
, 
isL—d”
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/MessageType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

11 
public
 
	eMes§geTy³
 {

12 
LOG_ENTRY_MESSAGE
(1),

13 
SNAPSHOT_MESSAGE
(2),

14 
SNAPSHOT_START
(3),

15 
LOG_ENTRY_REPLICATED
(4),

16 
SNAPSHOT_REPLICATED
(5),

17 
SNAPSHOT_END
(6);

19 @
G‘‹r


20 
	mv®
;

22 
Mes§geTy³
(
ÃwV®
) {

23 
	mv®
 = 
ÃwV®
;

26 
public
 
Mes§geTy³
 
äomV®ue
(
ÃwV®
) {

27 
Mes§geTy³
 
	mmes§geTy³
: 
v®ues
()) {

28 ià(
mes§geTy³
.
g‘V®
(è=ğ
ÃwV®
) {

29  
mes§geTy³
;

32 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("wrÚg v®u" + 
ÃwV®
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/AddNodeRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gADD_NODE
;

15 
public
 cÏs 
	cAddNodeReque¡
 
im¶em’ts
 
	mC»©eReque¡
 {

17 @
G‘‹r


18 
public
 
SŒšg
 
	m’dpošt
;

20 
public
 
	$AddNodeReque¡
(
SŒšg
 
’dpošt
) {

21 
this
.
’dpošt
 =ƒndpoint;

24 
public
 
	$AddNodeReque¡
(
by‹
[] 
buf
) {

25 
’dpošt
 = 
Ãw
 
	`SŒšg
(
buf
, 
Snd¬dCh¬£ts
.
UTF_8
);

26 
	}
}

28 @
Ov”ride


29 
public
 
Orche¡¿tÜReque¡Ty³
 
	$g‘Ty³
() {

30  
ADD_NODE
;

31 
	}
}

33 @
Ov”ride


34 
public
 
	gby‹
[] 
	$g‘S”Ÿlized
() {

35  
’dpošt
.
	`g‘By‹s
(
Snd¬dCh¬£ts
.
UTF_8
);

36 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/CreateRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

7 
public
 
š‹rçû
 
C»©eReque¡
 
ex‹nds
 
	gReque¡
 {

14 
SŒšg
 
g‘Endpošt
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/CreateWorkflowResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜRe¥Ú£Ty³
.
	gWORKFLOW_CREATED
;

15 
public
 cÏs 
	cC»©eWÜkæowRe¥Ú£
 
im¶em’ts
 
	mRe¥Ú£
 {

17 @
G‘‹r


18 
public
 
UUID
 
	mwÜkæowId
;

20 
public
 
	$C»©eWÜkæowRe¥Ú£
(
UUID
 
wÜkæowId
) {

21 
this
.
wÜkæowId
 = workflowId;

24 
public
 
	$C»©eWÜkæowRe¥Ú£
(
by‹
[] 
buf
) {

25 
By‹Bufãr
 
by‹s
 = By‹Bufãr.
	`w¿p
(
buf
);

26 
this
.
wÜkæowId
 = 
Ãw
 
	`UUID
(
by‹s
.
	`g‘LÚg
(), bytes.getLong());

27 
	}
}

29 @
Ov”ride


30 
public
 
Orche¡¿tÜRe¥Ú£Ty³
 
	$g‘Ty³
() {

31  
WORKFLOW_CREATED
;

32 
	}
}

34 @
Ov”ride


35 
public
 
	gby‹
[] 
	$g‘S”Ÿlized
() {

36 
By‹Bufãr
 
buf
 = By‹Bufãr.
	`®loÿ‹
(
LÚg
.
BYTES
 * 2);

37 
buf
.
	`putLÚg
(
wÜkæowId
.
	`g‘Mo¡SignifiÿÁB™s
());

38 
buf
.
	`putLÚg
(
wÜkæowId
.
	`g‘L—¡SignifiÿÁB™s
());

39  
buf
.
	`¬¿y
();

40 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/ForceRemoveNodeRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gFORCE_REMOVE_NODE
;

12 
public
 cÏs 
	cFÜûRemoveNodeReque¡
 
ex‹nds
 
	mRemoveNodeReque¡
 {

18 
public
 
FÜûRemoveNodeReque¡
(@
NÚnuÎ
 
SŒšg
 
’dpošt
) {

19 
su³r
(
’dpošt
);

26 
public
 
FÜûRemoveNodeReque¡
(@
NÚnuÎ
 
by‹
[] 
buf
) {

27 
su³r
(
buf
);

30 @
Ov”ride


31 
public
 
Orche¡¿tÜReque¡Ty³
 
	$g‘Ty³
() {

32  
FORCE_REMOVE_NODE
;

33 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/HealNodeRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gHEAL_NODE
;

5 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

6 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gJsÚUts
;

18 
public
 cÏs 
	cH—lNodeReque¡
 
im¶em’ts
 
	mC»©eReque¡
 {

20 @
G‘‹r


21 
public
 
SŒšg
 
	m’dpošt
;

23 @
G‘‹r


24 
boŞ—n
 
	mÏyoutS”v”
;

26 @
G‘‹r


27 
boŞ—n
 
	m£qu’ûrS”v”
;

29 @
G‘‹r


30 
boŞ—n
 
	mlogUn™S”v”
;

32 @
G‘‹r


33 
	m¡reIndex
;

35 
public
 
	$H—lNodeReque¡
(
SŒšg
 
’dpošt
,

36 
boŞ—n
 
ÏyoutS”v”
,

37 
boŞ—n
 
£qu’ûrS”v”
,

38 
boŞ—n
 
logUn™S”v”
,

39 
¡reIndex
) {

40 
this
.
’dpošt
 =ƒndpoint;

41 
this
.
ÏyoutS”v”
 =†ayoutServer;

42 
this
.
£qu’ûrS”v”
 = sequencerServer;

43 
this
.
logUn™S”v”
 =†ogUnitServer;

44 
this
.
¡reIndex
 = stripeIndex;

47 
public
 
	$H—lNodeReque¡
(
by‹
[] 
buf
) {

48 
SŒšg
 
¡r
 = 
Ãw
 
	`SŒšg
(
buf
, 
Snd¬dCh¬£ts
.
UTF_8
);

49 
M­
<
SŒšg
, SŒšg> 
·¿ms
 = 
JsÚUts
.
·r£r
.
	`äomJsÚ
(
¡r
, 
HashM­
.
şass
);

50 
’dpošt
 = 
·¿ms
.
	`g‘
("endpoint");

51 
ÏyoutS”v”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
·¿ms
.
	`g‘
("layoutServer"));

52 
£qu’ûrS”v”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
·¿ms
.
	`g‘
("sequencerServer"));

53 
logUn™S”v”
 = 
BoŞ—n
.
	`·r£BoŞ—n
(
·¿ms
.
	`g‘
("logUnitServer"));

54 
¡reIndex
 = 
IÁeg”
.
	`·r£IÁ
(
·¿ms
.
	`g‘
("stripeIndex"));

55 
	}
}

57 @
Ov”ride


58 
public
 
Orche¡¿tÜReque¡Ty³
 
	$g‘Ty³
() {

59  
HEAL_NODE
;

60 
	}
}

62 @
Ov”ride


63 
public
 
	gby‹
[] 
	$g‘S”Ÿlized
() {

64 
M­
<
SŒšg
, SŒšg> 
·¿ms
 = 
Ãw
 
HashM­
<>();

65 
·¿ms
.
	`put
("’dpošt", 
’dpošt
);

66 
·¿ms
.
	`put
("ÏyoutS”v”", 
SŒšg
.
	`v®ueOf
(
ÏyoutS”v”
));

67 
·¿ms
.
	`put
("£qu’ûrS”v”", 
SŒšg
.
	`v®ueOf
(
£qu’ûrS”v”
));

68 
·¿ms
.
	`put
("logUn™S”v”", 
SŒšg
.
	`v®ueOf
(
logUn™S”v”
));

69 
·¿ms
.
	`put
("¡reIndex", 
SŒšg
.
	`v®ueOf
(
¡reIndex
));

70 
SŒšg
 
jsÚSŒšg
 = 
JsÚUts
.
·r£r
.
	`toJsÚ
(
·¿ms
);

71  
jsÚSŒšg
.
	`g‘By‹s
();

72 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorMsg.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

16 
public
 
şass
 
Orche¡¿tÜMsg
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gOrche¡¿tÜMsg
> {

18 @
G‘‹r


19 
public
 
fš®
 
Reque¡
 
	g»que¡
;

21 
public
 
Orche¡¿tÜMsg
(
Reque¡
 
»que¡
) {

22 
	gthis
.
	g»que¡
 = 
»que¡
;

25 
public
 
Orche¡¿tÜMsg
(
By‹Buf
 
buf
) {

26 
Orche¡¿tÜReque¡Ty³
 
	g»que¡Ty³
 = Orche¡¿tÜReque¡Ty³.
ty³M­
.
g‘
(
buf
.
»adIÁ
());

27 
	gby‹
[] 
	gby‹s
 = 
Ãw
 
by‹
[
buf
.
»adIÁ
()];

28 
	gbuf
.
»adBy‹s
(
by‹s
);

29 
	g»que¡
 = 
»que¡Ty³
.
g‘Reque¡G’”©Ü
().
­¶y
(
by‹s
);

32 @
Ov”ride


33 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

34 
	gbuf
.
wr™eIÁ
(
»que¡
.
g‘Ty³
().getType());

35 
	gby‹
[] 
	gby‹s
 = 
»que¡
.
g‘S”Ÿlized
();

36 
	gbuf
.
wr™eIÁ
(
by‹s
.
Ëngth
);

37 
	gbuf
.
wr™eBy‹s
(
by‹s
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorRequestType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

16 @
AÎArgsCÚ¡ruùÜ


17 
public
 
	eOrche¡¿tÜReque¡Ty³
 {

22 
QUERY
(0, 
Qu”yReque¡
::
Ãw
),

27 
ADD_NODE
(1, 
AddNodeReque¡
::
Ãw
),

32 
REMOVE_NODE
(2, 
RemoveNodeReque¡
::
Ãw
),

37 
HEAL_NODE
(3, 
H—lNodeReque¡
::
Ãw
),

42 
FORCE_REMOVE_NODE
(4, 
FÜûRemoveNodeReque¡
::
Ãw
),

47 
RESTORE_REDUNDANCY_MERGE_SEGMENTS
(5, 
Re¡ÜeRedundªcyM”geSegm’tsReque¡
::
Ãw
);

50 @
G‘‹r


51 
public
 
fš®
 
	mty³
;

53 @
G‘‹r


54 
fš®
 
	mFunùiÚ
<
	mby‹
[], 
	mReque¡
> 
	m»que¡G’”©Ü
;

59 
fš®
 
	mM­
<
	mIÁeg”
, 
	mOrche¡¿tÜReque¡Ty³
> 
	mty³M­
 =

60 
A¼ays
.
¡»am
(
Orche¡¿tÜReque¡Ty³
.
v®ues
())

61 .
cŞËù
(
CŞËùÜs
.
toM­
(
Orche¡¿tÜReque¡Ty³
::
g‘Ty³
, 
FunùiÚ
.
id’t™y
()));

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

14 
public
 
şass
 
Orche¡¿tÜRe¥Ú£
 
im¶em’ts
 
	gICÜfuPaylßd
<
	gOrche¡¿tÜRe¥Ú£
> {

16 @
G‘‹r


17 
public
 
fš®
 
Re¥Ú£
 
	g»¥Ú£
;

19 
public
 
Orche¡¿tÜRe¥Ú£
(
Re¥Ú£
 
»¥Ú£
) {

20 
	gthis
.
	g»¥Ú£
 = 
»¥Ú£
;

23 
public
 
Orche¡¿tÜRe¥Ú£
(
By‹Buf
 
buf
) {

24 
Orche¡¿tÜRe¥Ú£Ty³
 
	g»¥Ú£Ty³
 = Orche¡¿tÜRe¥Ú£Ty³.
ty³M­
.
g‘
(
buf
.
»adIÁ
());

25 
	gby‹
[] 
	gby‹s
 = 
Ãw
 
by‹
[
buf
.
»adIÁ
()];

26 
	gbuf
.
»adBy‹s
(
by‹s
);

27 
	g»¥Ú£
 = 
»¥Ú£Ty³
.
g‘Re¥Ú£G’”©Ü
().
­¶y
(
by‹s
);

30 @
Ov”ride


31 
public
 
doS”Ÿlize
(
By‹Buf
 
buf
) {

32 
	gbuf
.
wr™eIÁ
(
»¥Ú£
.
g‘Ty³
().getType());

33 
	gby‹
[] 
	gby‹s
 = 
»¥Ú£
.
g‘S”Ÿlized
();

34 
	gbuf
.
wr™eIÁ
(
by‹s
.
Ëngth
);

35 
	gbuf
.
wr™eBy‹s
(
by‹s
);

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorResponseType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

17 @
AÎArgsCÚ¡ruùÜ


18 
public
 
	eOrche¡¿tÜRe¥Ú£Ty³
 {

22 
WORKFLOW_STATUS
(0, 
Qu”yRe¥Ú£
::
Ãw
),

27 
WORKFLOW_CREATED
(1, 
C»©eWÜkæowRe¥Ú£
::
Ãw
);

29 @
G‘‹r


30 
public
 
fš®
 
	mty³
;

32 @
G‘‹r


33 
fš®
 
	mFunùiÚ
<
	mby‹
[], 
	mRe¥Ú£
> 
	m»¥Ú£G’”©Ü
;

38 
fš®
 
	mM­
<
	mIÁeg”
, 
	mOrche¡¿tÜRe¥Ú£Ty³
> 
	mty³M­
 =

39 
A¼ays
.
¡»am
(
Orche¡¿tÜRe¥Ú£Ty³
.
v®ues
())

40 .
cŞËù
(
CŞËùÜs
.
toM­
(
Orche¡¿tÜRe¥Ú£Ty³
::
g‘Ty³
,

41 
java
.
ut
.
funùiÚ
.
FunùiÚ
.
id’t™y
()));

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/QueryRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gQUERY
;

15 
public
 cÏs 
	cQu”yReque¡
 
im¶em’ts
 
	mReque¡
 {

17 @
G‘‹r


18 
public
 
UUID
 
	mid
;

20 
public
 
	$Qu”yReque¡
(
UUID
 
id
) {

21 
this
.
id
 = id;

24 
public
 
	$Qu”yReque¡
(
by‹
[] 
buf
) {

25 
By‹Bufãr
 
by‹s
 = By‹Bufãr.
	`w¿p
(
buf
);

26 
this
.
id
 = 
Ãw
 
	`UUID
(
by‹s
.
	`g‘LÚg
(), bytes.getLong());

27 
	}
}

29 @
Ov”ride


30 
public
 
Orche¡¿tÜReque¡Ty³
 
	$g‘Ty³
() {

31  
QUERY
;

32 
	}
}

34 @
Ov”ride


35 
public
 
	gby‹
[] 
	$g‘S”Ÿlized
() {

36 
By‹Bufãr
 
buf
 = By‹Bufãr.
	`®loÿ‹
(
LÚg
.
BYTES
 * 2);

37 
buf
.
	`putLÚg
(
id
.
	`g‘Mo¡SignifiÿÁB™s
());

38 
buf
.
	`putLÚg
(
id
.
	`g‘L—¡SignifiÿÁB™s
());

39  
buf
.
	`¬¿y
();

40 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/QueryResponse.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜRe¥Ú£Ty³
.
	gWORKFLOW_STATUS
;

12 
public
 cÏs 
	cQu”yRe¥Ú£
 
im¶em’ts
 
	mRe¥Ú£
 {

14 @
G‘‹r


15 
fš®
 
boŞ—n
 
	maùive
;

17 
public
 
	$Qu”yRe¥Ú£
(
boŞ—n
 
aùive
) {

18 
this
.
aùive
 =‡ctive;

21 
public
 
	$Qu”yRe¥Ú£
(
by‹
[] 
buf
) {

22 ià(
buf
[0] == 0) {

23 
this
.
aùive
 = 
çl£
;

25 
this
.
aùive
 = 
Œue
;

27 
	}
}

29 @
Ov”ride


30 
public
 
Orche¡¿tÜRe¥Ú£Ty³
 
	$g‘Ty³
() {

31  
WORKFLOW_STATUS
;

32 
	}
}

34 @
Ov”ride


35 
public
 
	gby‹
[] 
	$g‘S”Ÿlized
() {

36 
by‹
[] 
buf
 = 
Ãw
 byte[1];

37 ià(
aùive
) {

38 
buf
[0] = 1;

40 
buf
[0] = 0;

42  
buf
;

43 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/RemoveNodeRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gREMOVE_NODE
;

13 
public
 cÏs 
	cRemoveNodeReque¡
 
ex‹nds
 
	mAddNodeReque¡
 {

19 
public
 
RemoveNodeReque¡
(@
NÚnuÎ
 
SŒšg
 
’dpošt
) {

20 
su³r
(
’dpošt
);

27 
public
 
	$RemoveNodeReque¡
(
by‹
[] 
buf
) {

28 
	`su³r
(
buf
);

29 
	}
}

31 @
Ov”ride


32 
public
 
Orche¡¿tÜReque¡Ty³
 
	$g‘Ty³
() {

33  
REMOVE_NODE
;

34 
	}
}

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/Request.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

10 
public
 
š‹rçû
 
	gReque¡
 {

17 
Orche¡¿tÜReque¡Ty³
 
g‘Ty³
();

24 
	gby‹
[] 
g‘S”Ÿlized
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/Response.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

7 
public
 
š‹rçû
 
	gRe¥Ú£
 {

12 
Orche¡¿tÜRe¥Ú£Ty³
 
g‘Ty³
();

18 
	gby‹
[] 
g‘S”Ÿlized
();

	@runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/RestoreRedundancyMergeSegmentsRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜReque¡Ty³
.
	gRESTORE_REDUNDANCY_MERGE_SEGMENTS
;

5 
impÜt
 
	gjava
.
	gnio
.
	gch¬£t
.
	gSnd¬dCh¬£ts
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

13 
public
 cÏs 
	cRe¡ÜeRedundªcyM”geSegm’tsReque¡
 
im¶em’ts
 
	mC»©eReque¡
 {

18 @
G‘‹r


19 
´iv©e
 
fš®
 
SŒšg
 
	m’dpošt
;

21 
public
 
	$Re¡ÜeRedundªcyM”geSegm’tsReque¡
(
SŒšg
 
’dpošt
) {

22 
this
.
’dpošt
 =ƒndpoint;

25 
public
 
	$Re¡ÜeRedundªcyM”geSegm’tsReque¡
(
by‹
[] 
buf
) {

26 
’dpošt
 = 
Ãw
 
	`SŒšg
(
buf
, 
Snd¬dCh¬£ts
.
UTF_8
);

27 
	}
}

29 @
Ov”ride


30 
public
 
Orche¡¿tÜReque¡Ty³
 
	$g‘Ty³
() {

31  
RESTORE_REDUNDANCY_MERGE_SEGMENTS
;

32 
	}
}

34 @
Ov”ride


35 
public
 
	gby‹
[] 
	$g‘S”Ÿlized
() {

36  
’dpošt
.
	`g‘By‹s
(
Snd¬dCh¬£ts
.
UTF_8
);

37 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/BootstrapUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£HªdËr
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutHªdËr
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tHªdËr
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gN‘tyCl›ÁRou‹r
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gR‘ryExhau¡edExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

20 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

28 @
Slf4j


29 
public
 cÏs 
	cBoÙ¡¿pUt
 {

31 
´iv©e
 
	$BoÙ¡¿pUt
() {

44 
public
 
	`boÙ¡¿p
(@
NÚNuÎ
 
Layout
 
Ïyout
,

45 
»Œ›s
,

46 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
) {

47 
	`boÙ¡¿p
(
Ïyout
, 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
(), 
»Œ›s
, 
»ŒyDu¿tiÚ
);

48 
	}
}

56 
´iv©e
 
	$boÙ¡¿pLayoutS”v”
(
ICl›ÁRou‹r
 
rou‹r
, 
Layout
 
Ïyout
)

57 
throws
 
ExecutiÚExû±iÚ
, 
IÁ”ru±edExû±iÚ
, 
AÌ—dyBoÙ¡¿µedExû±iÚ
 {

58 
LayoutCl›Á
 
ÏyoutCl›Á
 = 
Ãw
 
	`LayoutCl›Á
(
rou‹r
, 
Ïyout
.
	`g‘Epoch
());

60 
Œy
 {

61 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ÏyoutCl›Á
.
	`boÙ¡¿pLayout
(
Ïyout
),

62 
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

63 } 
	`ÿtch
 (
AÌ—dyBoÙ¡¿µedExû±iÚ
 
abe
) {

64 ià(!
ÏyoutCl›Á
.
	`g‘Layout
().
	`g‘
().
	`equ®s
(
Ïyout
)) {

65 
log
.
	`”rÜ
("BootstrapUtil: Layout Server {}:{}‡lready bootstrapped with different "

66 + "Ïyout.", 
rou‹r
.
	`g‘Ho¡
(),„ou‹r.
	`g‘PÜt
());

67 
throw
 
abe
;

70 
	}
}

78 
´iv©e
 
	$boÙ¡¿pMªagem’tS”v”
(
ICl›ÁRou‹r
 
rou‹r
, 
Layout
 
Ïyout
)

79 
throws
 
ExecutiÚExû±iÚ
, 
IÁ”ru±edExû±iÚ
, 
AÌ—dyBoÙ¡¿µedExû±iÚ
 {

80 
Mªagem’tCl›Á
 
mªagem’tCl›Á


81 ğ
Ãw
 
	`Mªagem’tCl›Á
(
rou‹r
, 
Ïyout
.
	`g‘Epoch
());

83 
Œy
 {

84 
CFUts
.
	`g‘Unš‹¼u±ibly
(
mªagem’tCl›Á
.
	`boÙ¡¿pMªagem’t
(
Ïyout
),

85 
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

86 } 
	`ÿtch
 (
AÌ—dyBoÙ¡¿µedExû±iÚ
 
abe
) {

87 ià(!
mªagem’tCl›Á
.
	`g‘Layout
().
	`g‘
().
	`equ®s
(
Ïyout
)) {

88 
log
.
	`”rÜ
("BootstrapUtil: Management Server {}:{}‡lready bootstrapped with "

89 + "difã»Á†ayout.", 
rou‹r
.
	`g‘Ho¡
(),„ou‹r.
	`g‘PÜt
());

90 
throw
 
abe
;

93 
	}
}

105 
public
 
boÙ¡¿p
(@
NÚNuÎ
 
Layout
 
Ïyout
,

106 @
NÚNuÎ
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
,

107 
»Œ›s
,

108 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
) {

109 
SŒšg
 
	g£rv”
 : 
Ïyout
.
g‘AÎS”v”s
()) {

110 
»Œy
 = 
»Œ›s
;

112 
ICl›ÁRou‹r
 
	grou‹r
 = 
Ãw
 
N‘tyCl›ÁRou‹r
(
NodeLoÿtÜ
.
·r£SŒšg
(
£rv”
),

113 
cÜfuRuÁimeP¬am‘”s
);

114 
	grou‹r
.
addCl›Á
(
Ãw
 
LayoutHªdËr
())

115 .
addCl›Á
(
Ãw
 
Mªagem’tHªdËr
())

116 .
addCl›Á
(
Ãw
 
Ba£HªdËr
());

118 
	g»Œy
-- > 0) {

119 
	gŒy
 {

120 
	glog
.
šfo
("A‰em±šgØboÙ¡¿°node: {} w™h†ayout:{}", 
£rv”
, 
Ïyout
);

121 
boÙ¡¿pLayoutS”v”
(
rou‹r
, 
Ïyout
);

122 
boÙ¡¿pMªagem’tS”v”
(
rou‹r
, 
Ïyout
);

124 } 
ÿtch
 (
AÌ—dyBoÙ¡¿µedExû±iÚ
 
abe
) {

125 
	glog
.
”rÜ
("BoÙ¡¿µšg‚ode: {} faed w™hƒxû±iÚ:", 
£rv”
, 
abe
);

126 
	glog
.
”rÜ
("Cannot„etry since‡lready bootstrapped.");

127 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
abe
);

128 } 
ÿtch
 (
Exû±iÚ
 
e
) {

129 
	glog
.
”rÜ
("BoÙ¡¿µšg‚ode: {} faed w™hƒxû±iÚ:", 
£rv”
, 
e
);

130 ià(
	g»Œy
 == 0) {

131 
throw
 
Ãw
 
R‘ryExhau¡edExû±iÚ
("Bootstrapping‚ode:„etryƒxhausted");

133 
	glog
.
w¬n
("R‘ryšg boÙ¡¿°{}ime š {}ms.", 
»Œy
, 
»ŒyDu¿tiÚ
.
toMlis
());

134 
	gSË•
.
¦“pUnš‹¼u±ibly
(
»ŒyDu¿tiÚ
);

138 
	grou‹r
.
¡İ
();

140 
	glog
.
šfo
("SucûssfuÎy BoÙ¡¿µed†ayout:{} .", 
Ïyout
);

	@runtime/src/main/java/org/corfudb/runtime/CheckpointWriter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gI‹¿bËs
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiSMREÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gCacheO±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—msV›w
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

27 
impÜt
 
	gjava
.
	gtime
.
	gLoÿlD©eTime
;

28 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

29 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gM­
;

31 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

32 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiCÚsum”
;

33 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

34 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

43 @
Slf4j


44 
public
 
şass
 
	gCheckpoštWr™”
<
T
 
ex‹nds
 
	gSŒ—mšgM­
> {

47 
´iv©e
 
fš®
 
UUID
 
	g¡»amId
;

48 
´iv©e
 
fš®
 
SŒšg
 
	gauthÜ
;

49 @
G‘‹r


50 
´iv©e
 
UUID
 
	gcheckpoštId
;

51 
´iv©e
 
LoÿlD©eTime
 
	g¡¬tTime
;

52 
´iv©e
 
	g¡¬tAdd»ss
;

53 
´iv©e
 
	g’dAdd»ss
;

54 
´iv©e
 
	gnumEÁr›s
 = 0;

55 
´iv©e
 
	gnumBy‹s
 = 0;

57 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

58 
´iv©e
 
fš®
 
UUID
 
	gcheckpoštSŒ—mID
;

59 
´iv©e
 
fš®
 
	gM­
<
	gCheckpoštEÁry
.
	gCheckpoštDiùKey
, 
	gSŒšg
> 
	gmdkv
 = 
Ãw
 
HashM­
<>();

64 @
	gG‘‹r


65 @
S‘‹r


66 
	gFunùiÚ
<
	gObjeù
,Objeù> 
	gkeyMutÜ
 = (
x
) -> x;

71 @
	gG‘‹r


72 @
S‘‹r


73 
	gFunùiÚ
<
	gObjeù
,Objeù> 
	gv®ueMutÜ
 = (
x
) -> x;

77 @
	gG‘‹r


78 @
S‘‹r


79 
´iv©e
 
	gb©chSize
 = 50;

83 @
	gG‘‹r


84 @
S‘‹r


85 
	gBiCÚsum”
<
	gCheckpoštEÁry
,
	gLÚg
> 
	gpo¡Aµ’dFunc
 = (
ı
, 
	gl
) -> { };

89 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	g¹
;

93 
fš®
 
SŒ—msV›w
 
	gsv
;

98 
´iv©e
 
fš®
 
T
 
	gm­
;

100 @
	gG‘‹r


101 @
S‘‹r


102 
IS”Ÿliz”
 
	g£rŸliz”
 = 
S”Ÿliz”s
.
g‘DeçuÉS”Ÿliz”
();

110 
public
 
CheckpoštWr™”
(
CÜfuRuÁime
 
¹
, 
UUID
 
¡»amId
, 
SŒšg
 
authÜ
, 
T
 
m­
) {

111 
	gthis
.
	g¹
 = 
¹
;

112 
	gthis
.
	g¡»amId
 = 
¡»amId
;

113 
	gthis
.
	gauthÜ
 = 
authÜ
;

114 
	gthis
.
	gm­
 = 
m­
;

115 
	gcheckpoštId
 = 
UUID
.
¿ndomUUID
();

116 
	gcheckpoštSŒ—mID
 = 
CÜfuRuÁime
.
g‘CheckpoštSŒ—mIdFromId
(
¡»amId
);

117 
	gsv
 = 
¹
.
g‘SŒ—msV›w
();

126 
public
 
Tok’
 
­³ndCheckpošt
() {

131 
Tok’
 
	g¢­shÙ
 = 
fÜûNoOpEÁry
();

132  
­³ndCheckpošt
(
¢­shÙ
);

142 @
VisibËFÜTe¡šg


143 
public
 
Tok’
 
­³ndCheckpošt
(Tok’ 
¢­shÙTime¡amp
) {

144 
	g¡¬t
 = 
Sy¡em
.
cu¼’tTimeMlis
();

146 
	g¹
.
g‘ObjeùsV›w
().
TXBud
()

147 .
ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

148 .
¢­shÙ
(
¢­shÙTime¡amp
)

149 .
bud
()

150 .
begš
();

152 
	glog
.
šfo
("­³ndCheckpošt: S¹ed checkpošˆfÜ {}‡ˆ¢­shÙ {}", 
¡»amId
, 
¢­shÙTime¡amp
);

154 
Œy
 (
SŒ—m
<
M­
.
EÁry
> 
’Œ›s
 = 
this
.
m­
.
’ŒySŒ—m
()) {

161 
¡¬tCheckpošt
(
¢­shÙTime¡amp
);

162 
	g’ŒyCouÁ
 = 
­³ndObjeùS‹
(
’Œ›s
);

163 
fšishCheckpošt
();

164 
	gıDu¿tiÚ
 = 
Sy¡em
.
cu¼’tTimeMlis
(è- 
¡¬t
;

165 
	glog
.
šfo
("appendCheckpoint: completed checkpoint for {},ƒntries({}), " +

167 
¡»amId
, 
’ŒyCouÁ
, 
numBy‹s
, 
¢­shÙTime¡amp
, 
ıDu¿tiÚ
);

168 } 
	gfš®ly
 {

169 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

172  
	g¢­shÙTime¡amp
;

175 
´iv©e
 
Tok’
 
fÜûNoOpEÁry
() {

176 
Tok’Re¥Ú£
 
	gwr™eTok’
 = 
¹
.
g‘Sequ’ûrV›w
().
Ãxt
(
¡»amId
);

177 
LogD©a
 
	glogD©a
 = 
Ãw
 LogD©a(
D©aTy³
.
HOLE
);

178 
	g¹
.
g‘Add»ssS·ûV›w
().
wr™e
(
wr™eTok’
, 
logD©a
, 
CacheO±iÚ
.
WRITE_AROUND
);

179  
	gwr™eTok’
.
g‘Tok’
();

189 
public
 
¡¬tCheckpošt
(
Tok’
 
txnSÇpshÙ
) {

190 
	gvloV”siÚ
 = 
txnSÇpshÙ
.
g‘Sequ’û
();

191 
	g¡¬tTime
 = 
LoÿlD©eTime
.
now
();

192 
	gthis
.
	gmdkv
.
put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_TIME
, 
¡¬tTime
.
toSŒšg
());

194 
	gthis
.
	gmdkv
.
put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
, 
LÚg
.
toSŒšg
(
vloV”siÚ
));

195 
	gthis
.
	gmdkv
.
put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
SNAPSHOT_ADDRESS
,

196 
LÚg
.
toSŒšg
(
txnSÇpshÙ
.
g‘Sequ’û
()));

198 
	gImmubËM­
<
	gCheckpoštEÁry
.
	gCheckpoštDiùKey
,
	gSŒšg
> 
	gmdkv
 =

199 
ImmubËM­
.
cİyOf
(
this
.
mdkv
);

200 
CheckpoštEÁry
 
	gı
 = 
Ãw
 CheckpoštEÁry(CheckpoštEÁry.
CheckpoštEÁryTy³
.
START
,

201 
authÜ
, 
checkpoštId
, 
¡»amId
, 
mdkv
, 
nuÎ
);

202 
	g¡¬tAdd»ss
 = 
nÚCachedAµ’d
(
ı
, 
checkpoštSŒ—mID
);

204 
	gpo¡Aµ’dFunc
.
acû±
(
ı
, 
¡¬tAdd»ss
);

210 
´iv©e
 
nÚCachedAµ’d
(
Objeù
 
objeù
, 
UUID
 ... 
¡»amIDs
) {

211  
	gsv
.
­³nd
(
objeù
, 
nuÎ
, 
CacheO±iÚ
.
WRITE_AROUND
, 
¡»amIDs
);

238 
public
 
­³ndObjeùS‹
(
SŒ—m
<
M­
.
EÁry
> 
’ŒySŒ—m
) {

239 
	gImmubËM­
<
	gCheckpoštEÁry
.
	gCheckpoštDiùKey
, 
	gSŒšg
> 
	gmdkv
 =

240 
ImmubËM­
.
cİyOf
(
this
.
mdkv
);

242 
fš®
 
	gI‹¿bË
<
	gLi¡
<
	gM­
.
	gEÁry
>> 
	g·¹™iÚs
 =

243 
I‹¿bËs
.
·¹™iÚ
(
’ŒySŒ—m
::
™”©Ü
, 
b©chSize
);

244 
	g’ŒyCouÁ
 = 0;

246 
	gLi¡
<
	gM­
.
	gEÁry
> 
	g·¹™iÚ
 : 
·¹™iÚs
) {

247 
MuÉiSMREÁry
 
smrEÁr›s
 = 
Ãw
 MultiSMREntry();

248 
	gM­
.
EÁry
 
	g’Œy
 : 
·¹™iÚ
) {

249 
smrEÁr›s
.
addTo
(
Ãw
 
SMREÁry
("put",

250 
Ãw
 
Objeù
[]{
keyMutÜ
.
­¶y
(
’Œy
.
g‘Key
()),

251 
v®ueMutÜ
.
­¶y
(
’Œy
.
g‘V®ue
())},

252 
£rŸliz”
));

253 
	g’ŒyCouÁ
++;

256 
CheckpoštEÁry
 
	gı
 = 
Ãw
 CheckpointEntry(CheckpointEntry

257 .
CheckpoštEÁryTy³
.
CONTINUATION
,

258 
authÜ
, 
checkpoštId
, 
¡»amId
, 
mdkv
, 
smrEÁr›s
);

259 
	gpos
 = 
nÚCachedAµ’d
(
ı
, 
checkpoštSŒ—mID
);

260 
	gpo¡Aµ’dFunc
.
acû±
(
ı
, 
pos
);

261 
	gnumEÁr›s
++;

264 
	gnumBy‹s
 +ğ
ı
.
g‘SmrEÁr›sBy‹s
();

267  
	g’ŒyCouÁ
;

277 
public
 
fšishCheckpošt
() {

278 
LoÿlD©eTime
 
	g’dTime
 = LoÿlD©eTime.
now
();

279 
	gmdkv
.
put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
END_TIME
, 
’dTime
.
toSŒšg
());

280 
	gnumEÁr›s
++;

281 
	gnumBy‹s
++;

282 
	gmdkv
.
put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
ENTRY_COUNT
, 
LÚg
.
toSŒšg
(
numEÁr›s
));

283 
	gmdkv
.
put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
BYTE_COUNT
, 
LÚg
.
toSŒšg
(
numBy‹s
));

285 
CheckpoštEÁry
 
	gı
 = 
Ãw
 CheckpoštEÁry(CheckpoštEÁry.
CheckpoštEÁryTy³
.
END
,

286 
authÜ
, 
checkpoštId
, 
¡»amId
, 
mdkv
, 
nuÎ
);

288 
	g’dAdd»ss
 = 
nÚCachedAµ’d
(
ı
, 
checkpoštSŒ—mID
);

290 
	gpo¡Aµ’dFunc
.
acû±
(
ı
, 
’dAdd»ss
);

	@runtime/src/main/java/org/corfudb/runtime/CorfuRuntime.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

8 
impÜt
 
	glombok
.
	gD©a
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
.
	gSšguÏr
;

11 
impÜt
 
	glombok
.
	gToSŒšg
;

12 
impÜt
 
	glombok
.
	gex³rim’l
.
	gAcûssÜs
;

13 
impÜt
 
	glombok
.
	gex³rim’l
.
	gSu³rBud”
;

14 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gV”siÚInfo
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£Cl›Á
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutCl›Á
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutHªdËr
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™HªdËr
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tHªdËr
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gN‘tyCl›ÁRou‹r
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gSequ’ûrHªdËr
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgClu¡”Exû±iÚ
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ssS·ûV›w
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSequ’ûrV›w
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—msV›w
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gMªagem’tV›w
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutV›w
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutMªagem’tV›w
;

38 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

39 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

40 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

41 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

42 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

43 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

44 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUuidUts
;

45 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gV”siÚ
;

47 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

48 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

49 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

50 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

51 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

52 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

53 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

54 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

55 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

56 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

57 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

58 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

59 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

60 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

61 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

62 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

63 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

68 @
	gSlf4j


69 @
	$AcûssÜs
(
chaš
 = 
Œue
)

70 
public
 cÏs 
	cCÜfuRuÁime
 {

75 @
Su³rBud”


76 @
D©a


77 @
ToSŒšg


78 
public
 şas 
	cCÜfuRuÁimeP¬am‘”s
 
ex‹nds
 
RuÁimeP¬am‘”s
 {

83 @
DeçuÉ


84 
maxWr™eSize
 = 0;

89 @
DeçuÉ


90 
bulkR—dSize
 = 10;

98 @
DeçuÉ


99 
Du¿tiÚ
 
ç¡Lßd”Timeout
 = Du¿tiÚ.
	`ofMšu‹s
(30);

107 @
D•»ÿ‹d


108 @
DeçuÉ
 
hŞeFlR‘ry
 = 10;

111 @
DeçuÉ
 
Du¿tiÚ
 
hŞeFlR‘ryTh»shŞd
 = Du¿tiÚ.
	`ofSecÚds
(1L);

116 @
DeçuÉ
 
Du¿tiÚ
 
hŞeFlTimeout
 = Du¿tiÚ.
	`ofSecÚds
(10);

121 @
DeçuÉ


122 
boŞ—n
 
ÿcheDi§bËd
 = 
çl£
;

127 @
DeçuÉ


128 
maxCacheEÁr›s
;

133 @
DeçuÉ


134 
maxCacheWeight
;

142 @
DeçuÉ


143 
ÿcheCÚcu¼’cyLev–
 = 0;

148 @
DeçuÉ


149 
ÿcheExpœyTime
 = 
LÚg
.
MAX_VALUE
;

157 @
DeçuÉ


158 
boŞ—n
 
fŞlowBackpoš‹rsEÇbËd
 = 
çl£
;

163 @
DeçuÉ


164 
boŞ—n
 
hŞeFlšgDi§bËd
 = 
çl£
;

170 @
DeçuÉ


171 
wr™eR‘ry
 = 5;

177 @
DeçuÉ


178 
ŒimR‘ry
 = 2;

184 @
DeçuÉ


185 
checkpoštR‘r›s
 = 5;

191 @
DeçuÉ


192 
¡»amB©chSize
 = 10;

198 @
DeçuÉ


199 
checkpoštR—dB©chSize
 = 5;

205 @
DeçuÉ


206 
Du¿tiÚ
 
ruÁimeGCP”iod
 = Du¿tiÚ.
	`ofMšu‹s
(20);

213 @
DeçuÉ


214 
UUID
 
şu¡”Id
 = 
nuÎ
;

225 @
DeçuÉ


226 
sy¡emDownHªdËrTrigg”Lim™
 = 20;

231 @
SšguÏr


232 
Li¡
<
NodeLoÿtÜ
> 
ÏyoutS”v”s
;

238 @
DeçuÉ


239 
šv®id©eR‘ry
 = 5;

247 @
DeçuÉ


248 
´iv©e
 
PriÜ™yLev–
 
´iÜ™yLev–
 = PriÜ™yLev–.
NORMAL
;

253 @
DeçuÉ


254 
´iv©e
 
SŒšg
 
codecTy³
 = 
Codec
.
Ty³
.
ZSTD
.
	`toSŒšg
();

260 @
G‘‹r


261 
´iv©e
 
fš®
 
CÜfuRuÁimeP¬am‘”s
 
·¿m‘”s
;

266 @
G‘‹r


267 
´iv©e
 
fš®
 
Ev’tLoİGroup
 
Ã‰yEv’tLoİ
;

272 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

273 
´iv©e
 
fš®
 
LayoutV›w
 
ÏyoutV›w
 = 
Ãw
 
	`LayoutV›w
(
this
);

277 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

278 
´iv©e
 
fš®
 
Sequ’ûrV›w
 
£qu’ûrV›w
 = 
Ãw
 
	`Sequ’ûrV›w
(
this
);

282 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

283 
´iv©e
 
fš®
 
Add»ssS·ûV›w
 
add»ssS·ûV›w
 = 
Ãw
 
	`Add»ssS·ûV›w
(
this
);

287 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

288 
´iv©e
 
fš®
 
SŒ—msV›w
 
¡»amsV›w
 = 
Ãw
 
	`SŒ—msV›w
(
this
);

293 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

294 
´iv©e
 
fš®
 
ObjeùsV›w
 
objeùsV›w
 = 
Ãw
 
	`ObjeùsV›w
(
this
);

298 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

299 
´iv©e
 
fš®
 
LayoutMªagem’tV›w
 
ÏyoutMªagem’tV›w
 = 
Ãw
 
	`LayoutMªagem’tV›w
(
this
);

303 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

304 
´iv©e
 
fš®
 
Mªagem’tV›w
 
mªagem’tV›w
 = 
Ãw
 
	`Mªagem’tV›w
(
this
);

306 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

307 
´iv©e
 
fš®
 
TabËRegi¡ry
 
bËRegi¡ry
 = 
Ãw
 
	`TabËRegi¡ry
(
this
);

313 @
G‘‹r


314 
´iv©e
 vŞ©
Li¡
<
SŒšg
> 
boÙ¡¿pLayoutS”v”s
;

319 @
G‘‹r


320 
´iv©e
 vŞ©
Li¡
<
SŒšg
> 
ÏyoutS”v”s
;

325 @
G‘‹r


326 
´iv©e
 
NodeRou‹rPoŞ
 
nodeRou‹rPoŞ
;

331 
public
 vŞ©
Com¶‘abËFutu»
<
Layout
> 
Ïyout
;

337 @
G‘‹r


338 
public
 vŞ©
UUID
 
şu¡”Id
;

340 @
G‘‹r


341 
fš®
 
V›wsG¬bageCŞËùÜ
 
g¬bageCŞËùÜ
 = 
Ãw
 
	`V›wsG¬bageCŞËùÜ
(
this
);

347 @
G‘‹r


348 
´iv©e
 vŞ©
boŞ—n
 
isShutdown
 = 
çl£
;

354 
fš®
 
ExecutÜS”viû
 
ruÁimeExecutÜ
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
(
Ãw
 
	`Th»adFaùÜyBud”
()

355 .
	`£tD«mÚ
(
Œue
)

356 .
	`£tNameFÜm©
("CorfuRuntime-%d")

357 .
	`bud
());

362 
´iv©e
 vŞ©
Layout
 
Ï‹¡Layout
 = 
nuÎ
;

364 @
G‘‹r


365 
´iv©e
 
fš®
 
M‘ricRegi¡ry
 
deçuÉM‘rics
 = 
Ãw
 
	`M‘ricRegi¡ry
();

374 @
D•»ÿ‹d


375 
public
 
CÜfuRuÁime
 
	$»gi¡”Sy¡emDownHªdËr
(
RuÂabË
 
hªdËr
) {

376 
this
.
	`g‘P¬am‘”s
().
	`£tSy¡emDownHªdËr
(
hªdËr
);

377  
this
;

378 
	}
}

387 @
D•»ÿ‹d


388 
public
 
CÜfuRuÁime
 
	$»gi¡”BefÜeRpcHªdËr
(
RuÂabË
 
hªdËr
) {

389 
this
.
	`g‘P¬am‘”s
().
	`£tBefÜeRpcHªdËr
(
hªdËr
);

390  
this
;

391 
	}
}

398 
public
 
	gBiFunùiÚ
<
	gCÜfuRuÁime
, 
	gSŒšg
, 
	gICl›ÁRou‹r
> 
	gov”rideG‘Rou‹rFunùiÚ
 = 
nuÎ
;

405 @
G‘‹r


406 
´iv©e
 
fš®
 
	gFunùiÚ
<
	gSŒšg
, 
	gICl›ÁRou‹r
> 
	gg‘Rou‹rFunùiÚ
 =

407 
ov”rideG‘Rou‹rFunùiÚ
 !ğ
nuÎ
 ? (
add»ss
) ->

408 
ov”rideG‘Rou‹rFunùiÚ
.
	$­¶y
(
this
, 
add»ss
) : (address) -> {

409 
NodeLoÿtÜ
 
node
 = NodeLoÿtÜ.
	`·r£SŒšg
(
add»ss
);

411 
N‘tyCl›ÁRou‹r
 
ÃwRou‹r
 = 
Ãw
 
	`N‘tyCl›ÁRou‹r
(
node
,

412 
	`g‘N‘tyEv’tLoİ
(),

413 
	`g‘P¬am‘”s
());

414 
log
.
	`debug
("CÚÃùšgØÃw„ou‹¸{}", 
node
);

415 
Œy
 {

416 
ÃwRou‹r
.
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
())

417 .
	`addCl›Á
(
Ãw
 
	`Sequ’ûrHªdËr
())

418 .
	`addCl›Á
(
Ãw
 
	`LogUn™HªdËr
())

419 .
	`addCl›Á
(
Ãw
 
	`Mªagem’tHªdËr
());

420 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

421 
log
.
	`w¬n
("E¼Ü cÚÃùšgØrou‹r", 
e
);

422 
throw
 
e
;

424  
ÃwRou‹r
;

425 
	}
};

434 
public
 
CÜfuRuÁime
 
äomP¬am‘”s
(@
NÚnuÎ
 
CÜfuRuÁimeP¬am‘”s
 
·¿m‘”s
) {

435  
Ãw
 
CÜfuRuÁime
(
·¿m‘”s
);

443 
´iv©e
 
CÜfuRuÁime
(@
NÚnuÎ
 
CÜfuRuÁimeP¬am‘”s
 
·¿m‘”s
) {

445 
	gthis
.
	g·¿m‘”s
 = 
·¿m‘”s
;

448 
	gboÙ¡¿pLayoutS”v”s
 = 
·¿m‘”s
.
g‘LayoutS”v”s
().
¡»am
()

449 .
m­
(
NodeLoÿtÜ
::
toSŒšg
)

450 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

453 
	gÏyoutS”v”s
 = 
Ãw
 
A¼ayLi¡
<>(
boÙ¡¿pLayoutS”v”s
);

456 
	gşu¡”Id
 = 
·¿m‘”s
.
g‘Clu¡”Id
();

459 
	gÃ‰yEv’tLoİ
 = 
·¿m‘”s
.
Ã‰yEv’tLoİ
 =ğ
nuÎ
 ? 
g‘NewEv’tLoİGroup
()

460 : 
·¿m‘”s
.
Ã‰yEv’tLoİ
;

463 
	gnodeRou‹rPoŞ
 = 
Ãw
 
NodeRou‹rPoŞ
(
g‘Rou‹rFunùiÚ
);

466 
	gM‘ricsUts
.
m‘ricsR•ÜtšgS‘up
(
deçuÉM‘rics
);

467 ià(
	g·¿m‘”s
.
g‘Prom‘heusM‘ricsPÜt
(è!ğ
M‘ricsUts
.
NO_METRICS_PORT
) {

469 
M‘ricsUts
.
m‘ricsR•ÜtšgS‘up
(

470 
deçuÉM‘rics
,
·¿m‘”s
.
g‘Prom‘heusM‘ricsPÜt
());

473 
	glog
.
šfo
("CÜfu„uÁimv”siÚ {} in™Ÿlized.", 
g‘V”siÚSŒšg
());

482 
´iv©e
 
Ev’tLoİGroup
 
	$g‘NewEv’tLoİGroup
() {

484 
numTh»ads
 = 
·¿m‘”s
.
Ã‰yEv’tLoİTh»ads
 == 0

485 ? 
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2 :

486 
·¿m‘”s
.
Ã‰yEv’tLoİTh»ads
;

487 
Th»adFaùÜy
 
çùÜy
 = 
Ãw
 
	`Th»adFaùÜyBud”
()

488 .
	`£tD«mÚ
(
Œue
)

489 .
	`£tNameFÜm©
(
·¿m‘”s
.
Ã‰yEv’tLoİTh»adFÜm©
)

490 .
	`£tUnÿughtExû±iÚHªdËr
(
this
::
hªdËUnÿughtTh»ad
)

491 .
	`bud
();

492  
·¿m‘”s
.
sock‘Ty³
.
	`g‘G’”©Ü
().
	`g’”©e
(
numTh»ads
, 
çùÜy
);

493 
	}
}

501 
´iv©e
 
hªdËUnÿughtTh»ad
(@
NÚnuÎ
 
Th»ad
 
th»ad
, @NÚnuÎ 
ThrowabË
 
throwabË
) {

502 ià(
	g·¿m‘”s
.
g‘UnÿughtExû±iÚHªdËr
(è!ğ
nuÎ
) {

503 
·¿m‘”s
.
g‘UnÿughtExû±iÚHªdËr
().
unÿughtExû±iÚ
(
th»ad
, 
throwabË
);

505 
	glog
.
”rÜ
("handleUncaughtThread: {}erminated withhrowable ofype {}",

506 
th»ad
.
g‘Name
(),

507 
throwabË
.
g‘CÏss
().
g‘Sim¶eName
(),

508 
throwabË
);

517 
public
 
	$shutdown
() {

519 
isShutdown
 = 
Œue
;

520 
g¬bageCŞËùÜ
.
	`¡İ
();

521 
ruÁimeExecutÜ
.
	`shutdownNow
();

522 ià(
Ïyout
 !ğ
nuÎ
) {

523 
Œy
 {

524 
Ïyout
.
	`ÿnûl
(
Œue
);

525 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

526 
log
.
	`”rÜ
("RuÁimshu‰šg down. Exû±iÚ iÀ‹rmš©šg f‘chLayout: {}", 
e
);

530 
	`¡İ
(
Œue
);

533 ià(
·¿m‘”s
.
shutdownN‘tyEv’tLoİ
) {

534 
Ã‰yEv’tLoİ
.
	`shutdownG¿ûfuÎy
();

536 
	}
}

541 
public
 
	$¡İ
() {

542 
	`¡İ
(
çl£
);

543 
	}
}

548 
public
 
	$¡İ
(
boŞ—n
 
shutdown
) {

549 
nodeRou‹rPoŞ
.
	`shutdown
();

550 ià(!
shutdown
) {

551 
nodeRou‹rPoŞ
 = 
Ãw
 
	`NodeRou‹rPoŞ
(
g‘Rou‹rFunùiÚ
);

553 
	}
}

561 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

562 
public
 
UUID
 
	$g‘SŒ—mID
(
SŒšg
 
¡ršg
) {

563  
UUID
.
	`ÇmeUUIDFromBy‹s
(
¡ršg
.
	`g‘By‹s
());

564 
	}
}

566 
public
 
UUID
 
	$g‘CheckpoštSŒ—mIdFromId
(
UUID
 
¡»amId
) {

567  
	`g‘SŒ—mID
(
¡»amId
.
	`toSŒšg
(è+ 
SŒ—msV›w
.
CHECKPOINT_SUFFIX
);

568 
	}
}

570 
public
 
UUID
 
	$g‘CheckpoštSŒ—mIdFromName
(
SŒšg
 
¡»amName
) {

571  
	`g‘CheckpoštSŒ—mIdFromId
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
));

572 
	}
}

577 
public
 
SŒšg
 
	$g‘V”siÚSŒšg
() {

578 ià(
V”siÚ
.
	`g‘V”siÚSŒšg
().
	`cÚšs
("SNAPSHOT")

579 || 
V”siÚ
.
	`g‘V”siÚSŒšg
().
	`cÚšs
("source")) {

580  
V”siÚ
.
	`g‘V”siÚSŒšg
() + "("

581 + 
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
comm™IdAbb»v
 + ")";

583  
V”siÚ
.
	`g‘V”siÚSŒšg
();

584 
	}
}

593 
public
 
CÜfuRuÁime
 
	$£tT¿n§ùiÚLoggšg
(
boŞ—n
 
’abË
) {

594 
this
.
	`g‘ObjeùsV›w
().
	`£tT¿n§ùiÚLoggšg
(
’abË
);

595  
this
;

596 
	}
}

604 
public
 
CÜfuRuÁime
 
	$·r£CÚfigu¿tiÚSŒšg
(
SŒšg
 
cÚfigu¿tiÚSŒšg
) {

606 
boÙ¡¿pLayoutS”v”s
 = 
P©‹º
.
	`compe
(",")

607 .
	`¥l™AsSŒ—m
(
cÚfigu¿tiÚSŒšg
)

608 .
	`m­
(
SŒšg
::
Œim
)

609 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

610 
ÏyoutS”v”s
 = 
Ãw
 
A¼ayLi¡
<>(
boÙ¡¿pLayoutS”v”s
);

611  
this
;

612 
	}
}

620 
public
 
CÜfuRuÁime
 
	$addLayoutS”v”
(
SŒšg
 
ÏyoutS”v”
) {

621 
boÙ¡¿pLayoutS”v”s
.
	`add
(
ÏyoutS”v”
);

622 
ÏyoutS”v”s
.
	`add
(
ÏyoutS”v”
);

623  
this
;

624 
	}
}

632 
public
 
ICl›ÁRou‹r
 
	$g‘Rou‹r
(
SŒšg
 
add»ss
) {

633  
nodeRou‹rPoŞ
.
	`g‘Rou‹r
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
add»ss
));

634 
	}
}

641 
public
 
synchrÚized
 
	gCom¶‘abËFutu»
<
	gLayout
> 
	$šv®id©eLayout
() {

643 ià(
Ïyout
.
	`isDÚe
()) {

644 
Li¡
<
SŒšg
> 
£rv”s
 = 
O±iÚ®
.
	`ofNuÎabË
(
Ï‹¡Layout
)

645 .
	`m­
(
Layout
::
g‘LayoutS”v”s
)

646 .
	`ÜEl£
(
boÙ¡¿pLayoutS”v”s
);

648 
Ïyout
 = 
	`ãtchLayout
(
£rv”s
);

651  
Ïyout
;

652 
	}
}

664 
´iv©e
 
checkClu¡”Id
(@
NÚnuÎ
 
Layout
 
Ïyout
) {

666 ià(
	gşu¡”Id
 =ğ
nuÎ
) {

667 
şu¡”Id
 = 
Ïyout
.
g‘Clu¡”Id
();

668 ià(
	gşu¡”Id
 !ğ
nuÎ
) {

669 
log
.
šfo
("CÚÃùedØÃw clu¡” {}", 
UuidUts
.
asBa£64
(
şu¡”Id
));

671 } ià(!
	gşu¡”Id
.
equ®s
(
Ïyout
.
g‘Clu¡”Id
())) {

673 
throw
 
Ãw
 
WrÚgClu¡”Exû±iÚ
(
şu¡”Id
, 
Ïyout
.
g‘Clu¡”Id
());

685 
´iv©e
 
´uÃRemovedRou‹rs
(@
NÚnuÎ
 
Layout
 
Ïyout
) {

686 
	gnodeRou‹rPoŞ
.
g‘NodeRou‹rs
().
keyS‘
().
¡»am
()

688 .
f‹r
(
’dpošt
 -> !
Ïyout
.
g‘AÎS”v”s
()

691 .
cÚšs
(
’dpošt
.
toEndpoštU¾
()))

692 .
fÜEach
(
’dpošt
 -> {

693 
Œy
 {

694 
ICl›ÁRou‹r
 
rou‹r
 = 
nodeRou‹rPoŞ
.
g‘NodeRou‹rs
().
»move
(
’dpošt
);

695 ià(
rou‹r
 !ğ
nuÎ
) {

698 
rou‹r
.
¡İ
();

700 } 
ÿtch
 (
Exû±iÚ
 
e
) {

701 
log
.
w¬n
("fetchLayout: Exception in stopping‡nd„emoving "

702 + "rou‹¸cÚÃùiÚØnod{} :", 
’dpošt
, 
e
);

715 
´iv©e
 
	gCom¶‘abËFutu»
<
	gLayout
> 
ãtchLayout
(
Li¡
<
SŒšg
> 
£rv”s
) {

717  
	gCom¶‘abËFutu»
.
suµlyAsync
(() -> {

719 
Li¡
<
SŒšg
> 
ÏyoutS”v”sCİy
 = 
Ãw
 
A¼ayLi¡
<>(
£rv”s
);

720 
·¿m‘”s
.
g‘BefÜeRpcHªdËr
().
run
();

721 
sy¡emDownTrigg”CouÁ”
 = 0;

723 
Œue
) {

725 
CŞËùiÚs
.
shufæe
(
ÏyoutS”v”sCİy
);

727 
SŒšg
 
s
 : 
ÏyoutS”v”sCİy
) {

728 
log
.
Œaû
("Tryšg cÚÃùiÚØÏyouˆ£rv” {}", 
s
);

729 
Œy
 {

730 
ICl›ÁRou‹r
 
rou‹r
 = 
g‘Rou‹r
(
s
);

732 
Com¶‘abËFutu»
<
Layout
> 
ÏyoutFutu»
 =

733 
Ãw
 
LayoutCl›Á
(
rou‹r
, 
Layout
.
INVALID_EPOCH
).
g‘Layout
();

735 
Layout
 
l
 = 
ÏyoutFutu»
.
g‘
();

739 ià(
Ï‹¡Layout
 !ğ
nuÎ
 &&†©e¡Layout.
g‘Epoch
(è> 
l
.getEpoch()) {

740 
log
.
w¬n
("fetchLayout: Received‡†ayout withƒpoch {} from server "

743 
l
.
g‘Epoch
(), 
rou‹r
.
g‘Ho¡
(),„ou‹r.
g‘PÜt
(),

744 
Ï‹¡Layout
.
g‘Epoch
());

748 
checkClu¡”Id
(
l
);

751 
this
.
ÏyoutS”v”s
 = 
l
.
g‘LayoutS”v”s
();

753 
Ïyout
 = 
ÏyoutFutu»
;

754 
Ï‹¡Layout
 = 
l
;

755 
log
.
debug
("Layouˆ£rv” {}„e¥Úded w™h†ayouˆ{}", 
s
, 
l
);

758 
´uÃRemovedRou‹rs
(
l
);

760  
l
;

761 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

762 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(

763 "IÁ”ru±ed duršg†ayouˆãtch", 
›
);

764 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
“
){

765 ià(
“
.
g‘Cau£
(è
š¡ªûof
 
TimeoutExû±iÚ
) {

766 
log
.
w¬n
("Tr›dØg‘†ayouˆäom {} buˆçed byimeout", 
s
);

768 
log
.
w¬n
("Tr›dØg‘†ayouˆäom {} buˆçed w™hƒxû±iÚ:", 
s
, 
“
);

771 
ÿtch
 (
Exû±iÚ
 
e
) {

772 
log
.
w¬n
("Tr›dØg‘†ayouˆäom {} buˆçed w™hƒxû±iÚ:", 
s
, 
e
);

776 
log
.
w¬n
("Couldn't connecto‡ny up-to-date†ayout servers,„etrying in {}, "

778 
·¿m‘”s
.
cÚÃùiÚR‘ryR©e
, 
sy¡emDownTrigg”CouÁ”
,

779 
·¿m‘”s
.
g‘Sy¡emDownHªdËrTrigg”Lim™
());

781 ià(++
sy¡emDownTrigg”CouÁ”
 >ğ
·¿m‘”s
.
g‘Sy¡emDownHªdËrTrigg”Lim™
()) {

782 
log
.
šfo
("fetchLayout: Invokinghe systemDownHandler.");

783 
·¿m‘”s
.
g‘Sy¡emDownHªdËr
().
run
();

786 
SË•
.
¦“pUnš‹¼u±ibly
(
·¿m‘”s
.
cÚÃùiÚR‘ryR©e
);

787 ià(
isShutdown
) {

788  
nuÎ
;

791 }, 
ruÁimeExecutÜ
);

794 @
Suµ»ssW¬nšgs
("unchecked")

795 
´iv©e
 
	$checkV”siÚ
() {

796 
Œy
 {

797 
Layout
 
cu¼’tLayout
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(
Ïyout
);

798 
Li¡
<
Com¶‘abËFutu»
<
V”siÚInfo
>> 
v”siÚs
 =

799 
cu¼’tLayout
.
	`g‘LayoutS”v”s
()

800 .
	`¡»am
().
	`m­
(
s
 -> 
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘Ba£Cl›Á
(s))

801 .
	`m­
(
Ba£Cl›Á
::
g‘V”siÚInfo
)

802 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

804 
Com¶‘abËFutu»
<
V”siÚInfo
> 
v”siÚCf
 : 
v”siÚs
) {

805 
fš®
 
V”siÚInfo
 
v”siÚ
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(
v”siÚCf
,

806 
TimeoutExû±iÚ
.
şass
, 
N‘wÜkExû±iÚ
.class);

807 ià(
v”siÚ
.
	`g‘V”siÚ
(è=ğ
nuÎ
) {

808 
log
.
	`”rÜ
("Unexpected server version, server isoo oldo„eturn"

810 } ià(!
v”siÚ
.
	`g‘V”siÚ
().
	`equ®s
(
	`g‘V”siÚSŒšg
())) {

811 
log
.
	`”rÜ
("connect:ƒxpected version {}, but server version is {}",

812 
	`g‘V”siÚSŒšg
(), 
v”siÚ
.
	`g‘V”siÚ
());

814 
log
.
	`šfo
("connect: client version {}, server version is {}",

815 
	`g‘V”siÚSŒšg
(), 
v”siÚ
.
	`g‘V”siÚ
());

818 } 
	`ÿtch
 (
TimeoutExû±iÚ
 | 
N‘wÜkExû±iÚ
 
e
) {

819 
log
.
	`”rÜ
("cÚÃù: faedØg‘ v”siÚ. Couldn'ˆcÚÃùØ£rv”.", 
e
);

820 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

824 
log
.
	`”rÜ
("cÚÃù: faedØg‘ v”siÚ.", 
ex
);

826 
	}
}

832 
public
 
synchrÚized
 
CÜfuRuÁime
 
	$cÚÃù
() {

834 
log
.
	`šfo
("cÚÃù:„uÁim·¿m‘” {}", 
	`g‘P¬am‘”s
());

836 ià(
Ïyout
 =ğ
nuÎ
) {

837 
log
.
	`šfo
("CÚÃùšgØCÜfu s”v” in¡ªû,†ayouˆ£rv”s={}", 
boÙ¡¿pLayoutS”v”s
);

839 
Ïyout
 = 
	`ãtchLayout
(
boÙ¡¿pLayoutS”v”s
);

840 
Œy
 {

841 
Ïyout
.
	`g‘
();

842 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

844 
log
.
	`”rÜ
("F©®ƒ¼Ü cÚÃùšgØCÜfu s”v” in¡ªû.", 
e
);

845 
throw
 
Ãw
 
	`UÄecov”abËCÜfuE¼Ü
(
e
);

849 
	`checkV”siÚ
();

851 
g¬bageCŞËùÜ
.
	`¡¬t
();

853  
this
;

854 
	}
}

866 @
D•»ÿ‹d


867 
public
 
	$CÜfuRuÁime
() {

868 
	`this
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

869 
	}
}

877 @
D•»ÿ‹d


878 
public
 
	$CÜfuRuÁime
(
SŒšg
 
cÚfigu¿tiÚSŒšg
) {

879 
	`this
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

880 
this
.
	`·r£CÚfigu¿tiÚSŒšg
(
cÚfigu¿tiÚSŒšg
);

881 
	}
}

891 @
D•»ÿ‹d


892 
public
 
CÜfuRuÁime
 
	$’abËTls
(
SŒšg
 
keyStÜe
, SŒšg 
ksPasswÜdFe
, SŒšg 
Œu¡StÜe
,

893 
SŒšg
 
tsPasswÜdFe
) {

894 
log
.
	`w¬n
("enableTls: Deprecated,…lease set…arameters instead");

895 
·¿m‘”s
.
keyStÜe
 = keyStore;

896 
·¿m‘”s
.
ksPasswÜdFe
 = ksPasswordFile;

897 
·¿m‘”s
.
Œu¡StÜe
 =rustStore;

898 
·¿m‘”s
.
tsPasswÜdFe
 =sPasswordFile;

899 
·¿m‘”s
.
sEÇbËd
 = 
Œue
;

900  
this
;

901 
	}
}

908 @
D•»ÿ‹d


909 
public
 
CÜfuRuÁime
 
	$’abËSa¦PÏšText
(
SŒšg
 
u£ºameFe
, SŒšg 
·sswÜdFe
) {

910 
log
.
	`w¬n
("enableSaslPlainText: Deprecated,…lease set…arameters instead");

911 
·¿m‘”s
.
u£ºameFe
 = usernameFile;

912 
·¿m‘”s
.
·sswÜdFe
 =…asswordFile;

913 
·¿m‘”s
.
§¦PÏšTextEÇbËd
 = 
Œue
;

914  
this
;

915 
	}
}

924 @
D•»ÿ‹d


925 
public
 
CÜfuRuÁime
 
	$£tCacheDi§bËd
(
boŞ—n
 
di§bË
) {

926 
log
.
	`w¬n
("setCacheDisabled: Deprecated,…lease set…arameters instead");

927 
·¿m‘”s
.
	`£tCacheDi§bËd
(
di§bË
);

928  
this
;

929 
	}
}

938 @
D•»ÿ‹d


939 
public
 
CÜfuRuÁime
 
	$£tHŞeFlšgDi§bËd
(
boŞ—n
 
di§bË
) {

940 
log
.
	`w¬n
("setHoleFillingDisabled: Deprecated,…lease set…arameters instead");

941 
·¿m‘”s
.
	`£tHŞeFlšgDi§bËd
(
di§bË
);

942  
this
;

943 
	}
}

951 @
D•»ÿ‹d


952 
public
 
CÜfuRuÁime
 
	$£tCacheExpœyTime
(
expœyTime
) {

953 
log
.
	`w¬n
("setCacheExpiryTime: Deprecated,…lease set…arameters instead");

954 
·¿m‘”s
.
	`£tCacheExpœyTime
(
expœyTime
);

955  
this
;

956 
	}
}

964 @
D•»ÿ‹d


965 
public
 
CÜfuRuÁime
 
	$£tBulkR—dSize
(
size
) {

966 
log
.
	`w¬n
("setBulkReadSize: Deprecated,…lease set…arameters instead");

967 
·¿m‘”s
.
	`£tBulkR—dSize
(
size
);

968  
this
;

969 
	}
}

978 @
D•»ÿ‹d


979 
public
 
CÜfuRuÁime
 
	$£tWr™eR‘ry
(
wr™eR‘ry
) {

980 
log
.
	`w¬n
("setWriteRetry: Deprecated,…lease set…arameters instead");

981 
·¿m‘”s
.
	`£tWr™eR‘ry
(
wr™eR‘ry
);

982  
this
;

983 
	}
}

991 @
D•»ÿ‹d


992 
public
 
CÜfuRuÁime
 
	$£tTrimR‘ry
(
ŒimR‘ry
) {

993 
log
.
	`w¬n
("setTrimRetry: Deprecated,…lease set…arameters instead");

994 
·¿m‘”s
.
	`£tWr™eR‘ry
(
ŒimR‘ry
);

995  
this
;

996 
	}
}

1004 @
D•»ÿ‹d


1005 
public
 
CÜfuRuÁime
 
	$£tTimeoutInMšu‹sFÜFa¡Lßdšg
(
timeout
) {

1006 
log
.
	`w¬n
("setTrimRetry: Deprecated,…lease set…arameters instead");

1007 
·¿m‘”s
.
	`£tFa¡Lßd”Timeout
(
Du¿tiÚ
.
	`ofMšu‹s
(
timeout
));

1008  
this
;

1009 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/MultiCheckpointWriter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuCompeProxy
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

16 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

24 @
Slf4j


25 
public
 
şass
 
	gMuÉiCheckpoštWr™”
<
T
 
ex‹nds
 
	gSŒ—mšgM­
> {

26 @
G‘‹r


27 
´iv©e
 
	gLi¡
<
	gICÜfuSMR
<
	gT
>> 
	gm­s
 = 
Ãw
 
A¼ayLi¡
<>();

30 
´iv©e
 
fš®
 
M‘ricRegi¡ry
 
	gm‘ricRegi¡ry
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

31 
´iv©e
 
fš®
 
SŒšg
 
	gMULTI_CHECKPOINT_TIMER_NAME
 = 
CÜfuCompÚ’t
.
GARBAGE_COLLECTION
 +

33 
´iv©e
 
fš®
 
Tim”
 
	g­³ndCheckpoštsTim”
 = 
m‘ricRegi¡ry
.
tim”
(
MULTI_CHECKPOINT_TIMER_NAME
);

36 @
Suµ»ssW¬nšgs
("unchecked")

37 
public
 
addM­
(
T
 
m­
) {

38 
	gm­s
.
add
((
ICÜfuSMR
<
T
>è
m­
);

43 
public
 
addAÎM­s
(
CŞËùiÚ
<
T
> 
m­s
) {

44 
T
 
	gm­
 : 
m­s
) {

45 
addM­
(
m­
);

56 
public
 
Tok’
 
­³ndCheckpošts
(
CÜfuRuÁime
 
¹
, 
SŒšg
 
authÜ
) {

57 
	gnumR‘r›s
 = 
¹
.
g‘P¬am‘”s
().
g‘CheckpoštR‘r›s
();

58 
	g»Œy
 = 0;

59 
	glog
.
šfo
("­³ndCheckpošts:‡µ’dšg checkpošt fÜ {} m­s", 
m­s
.
size
());

61 
Tok’
 
	gmšSÇpshÙ
 = Tok’.
UNINITIALIZED
;

63 
fš®
 
	gıS¹
 = 
Sy¡em
.
cu¼’tTimeMlis
();

64 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
­³ndCheckpoštsTim”
)) {

65 
ICÜfuSMR
<
T
> 
m­
 : 
m­s
) {

66 
UUID
 
¡»amId
 = 
m­
.
g‘CÜfuSŒ—mID
();

68 
	gCheckpoštWr™”
<
	gT
> 
	gıw
 = 
Ãw
 
CheckpoštWr™”
(
¹
, 
¡»amId
, 
authÜ
, (
T
è
m­
);

69 
IS”Ÿliz”
 
	g£rŸliz”
 = ((
CÜfuCompeProxy
è
m­
.
g‘CÜfuSMRProxy
())

70 .
g‘S”Ÿliz”
();

71 
	gıw
.
£tS”Ÿliz”
(
£rŸliz”
);

73 
Tok’
 
	gmšCPSÇpshÙ
 = Tok’.
UNINITIALIZED
;

74 
	g»Œy
 < 
	gnumR‘r›s
) {

75 
	gŒy
 {

76 
	gmšCPSÇpshÙ
 = 
ıw
.
­³ndCheckpošt
();

78 } 
ÿtch
 (
WrÚgEpochExû±iÚ
 
w“
) {

79 
	glog
.
šfo
("Epoch changedo {} during‡ppend checkpoint snapshot„esolution. Sequencer" +

80 " faov” cª†—dØpÙ’tŸÈ•och„eg»ssiÚ,„‘ry {}/{}", 
w“
.
g‘CÜ»ùEpoch
(),

81 
»Œy
, 
numR‘r›s
);

82 
	g»Œy
++;

83 ià(
	g»Œy
 =ğ
numR‘r›s
) {

84 
SŒšg
 
msg
 = SŒšg.
fÜm©
("Epochs changed during checkpoint cycle, " +

86 "AbÜtšg.", 
numR‘r›s
);

87 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
msg
);

92 ià(
	gmšSÇpshÙ
 =ğ
Tok’
.
UNINITIALIZED
) {

93 
mšSÇpshÙ
 = 
mšCPSÇpshÙ
;

94 } ià(
	gmšCPSÇpshÙ
.
com·»To
(
mšSÇpshÙ
) < 0) {

96 
SŒšg
 
	gmsg
 = SŒšg.
fÜm©
("Potentialƒpoch„egression. Subsequent checkpoint„eturned‡ greater" +

97 "¢­shÙ {}hª…»viou {}.", 
mšCPSÇpshÙ
, 
mšSÇpshÙ
);

98 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
(
msg
);

101 } 
	gfš®ly
 {

103 
	glog
.
Œaû
("appendCheckpoints: finished,‡uthor '{}'‡t min globalAddress {}",

104 
authÜ
, 
mšSÇpshÙ
);

105 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

107 
fš®
 
	gıStİ
 = 
Sy¡em
.
cu¼’tTimeMlis
();

109 
	glog
.
šfo
("­³ndCheckpošts:ook {} m tØ­³nd {} checkpošts", 
ıStİ
 - 
ıS¹
,

110 
m­s
.
size
());

111  
	gmšSÇpshÙ
;

	@runtime/src/main/java/org/corfudb/runtime/NodeRouterPool.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

4 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

5 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

7 
impÜt
 
	glombok
.
	gAcûssLev–
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

20 @
Slf4j


21 
public
 cÏs 
	cNodeRou‹rPoŞ
 {

23 @
	$G‘‹r
(
AcûssLev–
.
PROTECTED
)

24 
´iv©e
 
fš®
 
M­
<
NodeLoÿtÜ
, 
ICl›ÁRou‹r
> 
nodeRou‹rs
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

31 @
G‘‹r


32 @
S‘‹r


33 
´iv©e
 
FunùiÚ
<
SŒšg
, 
ICl›ÁRou‹r
> 
ü—‹Rou‹rFunùiÚ
;

35 
public
 
	`NodeRou‹rPoŞ
(
FunùiÚ
<
SŒšg
, 
ICl›ÁRou‹r
> 
ü—‹Rou‹rFunùiÚ
) {

36 
this
.
ü—‹Rou‹rFunùiÚ
 = createRouterFunction;

46 
public
 
ICl›ÁRou‹r
 
	$g‘Rou‹r
(
NodeLoÿtÜ
 
’dpošt
) {

47  
nodeRou‹rs
.
	`compu‹IfAb£Á
(
’dpošt
,

48 
s
 -> 
ü—‹Rou‹rFunùiÚ
.
	`­¶y
(s.
	`toEndpoštU¾
()));

49 
	}
}

54 
public
 
	$shutdown
() {

55 
ICl›ÁRou‹r
 
r
 : 
nodeRou‹rs
.
	`v®ues
()) {

56 
r
.
	`¡İ
();

58 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/RebootUtil.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.*;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gR‘ryExhau¡edExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

21 @
Slf4j


22 
public
 cÏs 
	cReboÙUt
 {

24 
´iv©e
 
	$ReboÙUt
() {

38 
public
 
	`»£t
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

39 
»Œ›s
,

40 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
) {

41 
	`»boÙ
(
’dpošt
, 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
(), 
»Œ›s
, 
»ŒyDu¿tiÚ
, 
Œue
);

42 
	}
}

55 
public
 
»£t
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

56 @
NÚNuÎ
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
,

57 
»Œ›s
,

58 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
) {

60 
»boÙ
(
’dpošt
, 
cÜfuRuÁimeP¬am‘”s
, 
»Œ›s
, 
»ŒyDu¿tiÚ
, 
Œue
);

73 
public
 
»¡¬t
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

74 
»Œ›s
,

75 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
) {

77 
»boÙ
(
’dpošt
, 
CÜfuRuÁimeP¬am‘”s
.
bud”
().
bud
(), 
»Œ›s
, 
»ŒyDu¿tiÚ
, 
çl£
);

91 
public
 
»¡¬t
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

92 @
NÚNuÎ
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
,

93 
»Œ›s
,

94 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
) {

96 
»boÙ
(
’dpošt
, 
cÜfuRuÁimeP¬am‘”s
, 
»Œ›s
, 
»ŒyDu¿tiÚ
, 
çl£
);

99 
´iv©e
 
»boÙ
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

100 @
NÚNuÎ
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
,

101 
»Œ›s
,

102 @
NÚNuÎ
 
Du¿tiÚ
 
»ŒyDu¿tiÚ
,

103 
boŞ—n
 
»£tD©a
) {

105 
ICl›ÁRou‹r
 
	grou‹r
 = 
Ãw
 
N‘tyCl›ÁRou‹r
(
NodeLoÿtÜ
.
·r£SŒšg
(
’dpošt
),

106 
cÜfuRuÁimeP¬am‘”s
);

107 
	grou‹r
.
addCl›Á
(
Ãw
 
Ba£HªdËr
());

108 
Ba£Cl›Á
 
	gba£Cl›Á
 = 
Ãw
 Ba£Cl›Á(
rou‹r
, 
Layout
.
INVALID_EPOCH
);

110 
	g»Œ›s
-- > 0) {

111 
	gŒy
 {

112 ià(
	g»£tD©a
) {

113 
	glog
.
šfo
("A‰em±šgØ»£ˆ£rv”: {}", 
’dpošt
);

114 
	gCFUts
.
g‘Unš‹¼u±ibly
(
ba£Cl›Á
.
»£t
());

116 
	glog
.
šfo
("A‰em±šgØ»¡¬ˆ£rv”: {}", 
’dpošt
);

117 
	gCFUts
.
g‘Unš‹¼u±ibly
(
ba£Cl›Á
.
»¡¬t
());

120 } 
ÿtch
 (
Exû±iÚ
 
e
) {

121 
	glog
.
”rÜ
("ReboÙšg‚ode: {} faed w™hƒxû±iÚ:", 
’dpošt
, 
e
);

122 ià(
	g»Œ›s
 == 0) {

123 
throw
 
Ãw
 
R‘ryExhau¡edExû±iÚ
("Rebooting‚ode:„etryƒxhausted");

125 
	glog
.
w¬n
("R‘ryšg„eboÙ {}ime š {}ms.", 
»Œ›s
, 
»ŒyDu¿tiÚ
.
toMlis
());

126 
	gSË•
.
¦“pUnš‹¼u±ibly
(
»ŒyDu¿tiÚ
);

129 
	glog
.
šfo
("SucûssfuÎy„eboÙed s”v”:{}", 
’dpošt
);

130 
	grou‹r
.
¡İ
();

	@runtime/src/main/java/org/corfudb/runtime/RuntimeParameters.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlO±iÚ
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

6 
impÜt
 
	glombok
.
	gBud”
;

7 
impÜt
 
	glombok
.
	gD©a
;

8 
impÜt
 
	glombok
.
	gSšguÏr
;

9 
impÜt
 
	glombok
.
	gToSŒšg
;

10 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

11 
impÜt
 
	glombok
.
	gex³rim’l
.
	gSu³rBud”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcomm
.
	gChªÃlIm¶em’tiÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gMsgHªdlšgF‹r
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gN‘tyCl›ÁRou‹r
;

17 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	gUnÿughtExû±iÚHªdËr
;

18 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

23 @
	gSu³rBud”


24 @
	gD©a


25 @
ToSŒšg


26 
public
 cÏs 
	cRuÁimeP¬am‘”s
 {

28 @
DeçuÉ


29 
´iv©e
 
fš®
 
	mÃ‰yShutdownQu™eP”iod
 = 100;

30 @
DeçuÉ


31 
´iv©e
 
fš®
 
	mÃ‰yShutdownTimeout
 = 300;

36 @
DeçuÉ


37 
boŞ—n
 
	msEÇbËd
 = 
çl£
;

42 
SŒšg
 
	mkeyStÜe
;

47 
SŒšg
 
	mksPasswÜdFe
;

52 
SŒšg
 
	mŒu¡StÜe
;

57 
SŒšg
 
	mtsPasswÜdFe
;

62 @
DeçuÉ


63 
boŞ—n
 
	m§¦PÏšTextEÇbËd
 = 
çl£
;

68 
SŒšg
 
	mu£ºameFe
;

73 
SŒšg
 
	m·sswÜdFe
;

80 @
DeçuÉ


81 
	mhªdshakeTimeout
 = 10;

89 @
DeçuÉ


90 
Du¿tiÚ
 
	m»que¡Timeout
 = Du¿tiÚ.
ofSecÚds
(5);

96 @
DeçuÉ


97 
	midËCÚÃùiÚTimeout
 = 7;

104 @
DeçuÉ


105 
	mk“pAliveP”iod
 = 2;

110 @
DeçuÉ


111 
Du¿tiÚ
 
	mcÚÃùiÚTimeout
 = Du¿tiÚ.
ofMlis
(500);

116 @
DeçuÉ


117 
Du¿tiÚ
 
	mcÚÃùiÚR‘ryR©e
 = Du¿tiÚ.
ofSecÚds
(1);

122 @
DeçuÉ


123 
UUID
 
	mş›ÁId
 = UUID.
¿ndomUUID
();

129 @
DeçuÉ


130 
ChªÃlIm¶em’tiÚ
 
	msock‘Ty³
 = ChªÃlIm¶em’tiÚ.
NIO
;

138 
Ev’tLoİGroup
 
	mÃ‰yEv’tLoİ
;

146 @
DeçuÉ


147 
SŒšg
 
	mÃ‰yEv’tLoİTh»adFÜm©
 = "netty-%d";

154 @
DeçuÉ


155 
	mÃ‰yEv’tLoİTh»ads
 = 0;

161 @
DeçuÉ


162 
boŞ—n
 
	mshutdownN‘tyEv’tLoİ
 = 
Œue
;

168 @
SšguÏr


169 
	mM­
<
	mChªÃlO±iÚ
, 
	mObjeù
> 
	mcu¡omN‘tyChªÃlO±iÚs
;

175 
fš®
 
	mM­
<
	mChªÃlO±iÚ
, 
	mObjeù
> 
	mDEFAULT_CHANNEL_OPTIONS
 =

176 
ImmubËM­
.<
ChªÃlO±iÚ
, 
	mObjeù
>
bud”
()

177 .
put
(
ChªÃlO±iÚ
.
TCP_NODELAY
, 
Œue
)

178 .
put
(
ChªÃlO±iÚ
.
SO_REUSEADDR
, 
Œue
)

179 .
bud
();

187 
UnÿughtExû±iÚHªdËr
 
	munÿughtExû±iÚHªdËr
;

194 @
DeçuÉ


195 
	mLi¡
<
	mMsgHªdlšgF‹r
> 
	mÃ‰yCl›ÁInboundMsgF‹rs
 = 
nuÎ
;

201 @
DeçuÉ


202 
´iv©e
 
	m´om‘heusM‘ricsPÜt
 = 
M‘ricsUts
.
NO_METRICS_PORT
;

218 @
DeçuÉ


219 vŞ©
RuÂabË
 
	msy¡emDownHªdËr
 = () -> {

225 @
DeçuÉ


226 vŞ©
RuÂabË
 
	gbefÜeRpcHªdËr
 = () -> {

236 
public
 
	gM­
<
	gChªÃlO±iÚ
, 
	gObjeù
> 
	$g‘N‘tyChªÃlO±iÚs
() {

237  
cu¡omN‘tyChªÃlO±iÚs
.
	`size
() == 0

238 ? 
DEFAULT_CHANNEL_OPTIONS
 : 
cu¡omN‘tyChªÃlO±iÚs
;

239 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/ViewsGarbageCollector.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

9 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

24 @
	gSlf4j


25 @
NÙTh»adSaã


26 
public
 cÏs 
	cV›wsG¬bageCŞËùÜ
 {

29 
´iv©e
 
	mŒimM¬k
 = 
Add»ss
.
NON_ADDRESS
;

31 @
G‘‹r


32 
´iv©e
 
boŞ—n
 
	m¡¬‹d
;

34 
fš®
 
ScheduËdExecutÜS”viû
 
	mgcTh»ad
 = 
ExecutÜs
.
ÃwSšgËTh»adScheduËdExecutÜ
(

35 
Ãw
 
Th»adFaùÜyBud”
().
£tD«mÚ
(
Œue
)

36 .
£tNameFÜm©
("ViewsGarbageCollector")

37 .
bud
());

39 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

41 
public
 
	$V›wsG¬bageCŞËùÜ
(
CÜfuRuÁime
 
ruÁime
) {

42 
this
.
ruÁime
 =„untime;

43 
this
.
¡¬‹d
 = 
çl£
;

46 
public
 
	$¡¬t
() {

47 
gcTh»ad
.
	`scheduËAtFixedR©e
((è-> 
	`runRuÁimeGC
(),

48 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘RuÁimeGCP”iod
().
	`toMšu‹s
(),

49 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘RuÁimeGCP”iod
().
	`toMšu‹s
(),

50 
TimeUn™
.
MINUTES
);

51 
this
.
¡¬‹d
 = 
Œue
;

52 
	}
}

54 
public
 
	$¡İ
() {

55 
gcTh»ad
.
	`shutdownNow
();

56 
this
.
¡¬‹d
 = 
çl£
;

57 
	}
}

66 
public
 
	$runRuÁimeGC
() {

67 
Œy
 {

69 
cu¼TrimM¬k
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
();

70 
log
.
	`šfo
("runRuÁimeGC: s¹šg gøcyşe,‡‰em±šgØ»mov{}Ø{}", 
ŒimM¬k
,

71 
cu¼TrimM¬k
);

72 
¡¬tTs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

80 
ruÁime
.
	`g‘ObjeùsV›w
().
	`gc
(
cu¼TrimM¬k
);

81 
ruÁime
.
	`g‘SŒ—msV›w
().
	`gc
(
cu¼TrimM¬k
);

82 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
(
cu¼TrimM¬k
);

83 
’dTs
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

84 
ŒimM¬k
 = 
cu¼TrimM¬k
;

85 
log
.
	`šfo
("runRuntimeGC: completed gc in {}ms on {} object(s),‚ewrimMark {}",

86 
’dTs
 - 
¡¬tTs
, 
ruÁime
.
	`g‘ObjeùsV›w
().
	`g‘ObjeùCache
().
	`size
(), 
ŒimM¬k
);

87 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

88 ià(
e
.
	`g‘Cau£
(è
š¡ªûof
 
IÁ”ru±edExû±iÚ
) {

89 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
((
IÁ”ru±edExû±iÚ
è
e
.
	`g‘Cau£
());

91 
log
.
	`”rÜ
("EncouÁ”ed‡À”rÜ whruÂšg„uÁimGC", 
e
);

94 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/clients/AbstractClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

16 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùCl›Á
 
im¶em’ts
 
	mICl›Á
 {

18 @
G‘‹r


19 
´iv©e
 
fš®
 
	m•och
;

21 @
	mG‘‹r


22 @
S‘‹r


23 
´iv©e
 
ICl›ÁRou‹r
 
	mrou‹r
;

25 @
S‘‹r


26 
´iv©e
 
PriÜ™yLev–
 
	m´iÜ™yLev–
 = PriÜ™yLev–.
NORMAL
;

28 
public
 
	$Ab¡¿ùCl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

29 
this
.
rou‹r
 =„outer;

30 
this
.
•och
 =ƒpoch;

33 <
T
> 
Com¶‘abËFutu»
<T> 
	$£ndMes§geW™hFutu»
(
CÜfuMsg
 
msg
) {

34  
rou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
msg
.
	`£tEpoch
(
•och
)

35 .
	`£tPriÜ™yLev–
(
´iÜ™yLev–
));

36 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/clients/BaseClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gV”siÚInfo
;

22 @
Slf4j


23 
public
 cÏs 
	cBa£Cl›Á
 
im¶em’ts
 
	mICl›Á
 {

28 @
	mG‘‹r


29 @
S‘‹r


30 
´iv©e
 
ICl›ÁRou‹r
 
	mrou‹r
;

32 
´iv©e
 
fš®
 
	m•och
;

34 
public
 
	$Ba£Cl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

35 
this
.
rou‹r
 =„outer;

36 
this
.
•och
 =ƒpoch;

45 
public
 
boŞ—n
 
	$pšgSync
() {

46 
Œy
 {

47  
	`pšg
().
	`g‘
();

48 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

49 
log
.
	`”rÜ
("Pšg faed dutØexû±iÚ", 
e
);

50  
çl£
;

52 
	}
}

60 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$£®RemÙeS”v”
(
ÃwEpoch
) {

61 
CÜfuMsg
 
msg
 = 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
SEAL
, 
ÃwEpoch
).
	`£tEpoch
(
•och
);

62 
log
.
	`šfo
("sealRemoteServer: send SEAL from me(clientId={})o‚ewƒpoch {}",

63 
msg
.
	`g‘Cl›ÁID
(), 
•och
);

64  
rou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
msg
);

65 
	}
}

67 
public
 
	gCom¶‘abËFutu»
<
	gV”siÚInfo
> 
	$g‘V”siÚInfo
() {

68  
rou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(

69 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
VERSION_REQUEST
).
	`£tEpoch
(
•och
));

70 
	}
}

78 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$pšg
() {

79  
rou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(

80 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
PING
).
	`£tEpoch
(
•och
));

81 
	}
}

90 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$»£t
() {

91  
rou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
RESET
)

92 .
	`£tEpoch
(
•och
));

93 
	}
}

101 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$»¡¬t
() {

102  
rou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
RESTART
)

103 .
	`£tEpoch
(
•och
));

104 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/clients/BaseHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gS‘‹r
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gExû±iÚMsg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gJSONPaylßdMsg
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gV”siÚInfo
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”v”NÙR—dyExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

26 @
Slf4j


27 
public
 cÏs 
	cBa£HªdËr
 
im¶em’ts
 
	mICl›Á
 {

32 @
	mG‘‹r


33 @
S‘‹r


34 
public
 
ICl›ÁRou‹r
 
	mrou‹r
;

41 @
G‘‹r


42 
public
 
Cl›ÁMsgHªdËr
 
	mmsgHªdËr
 = 
Ãw
 Cl›ÁMsgHªdËr(
this
)

43 .
g’”©eHªdËrs
(
M‘hodHªdËs
.
lookup
(), 
this
);

53 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
PING
)

54 
´iv©e
 
Objeù
 
	$hªdËPšg
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

55 
r
.
	`£ndRe¥Ú£ToS”v”
(
ùx
, 
msg
, 
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
PONG
));

56  
nuÎ
;

67 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
PONG
)

68 
´iv©e
 
Objeù
 
	$hªdËPÚg
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

69  
Œue
;

70 
	}
}

80 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ACK
)

81 
´iv©e
 
Objeù
 
	$hªdËAck
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

82  
Œue
;

83 
	}
}

93 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
NACK
)

94 
´iv©e
 
Objeù
 
	$hªdËNack
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

95  
çl£
;

96 
	}
}

106 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
WRONG_EPOCH
)

107 
´iv©e
 
Objeù
 
	`hªdËWrÚgEpoch
(
CÜfuPaylßdMsg
<
LÚg
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
,

108 
ICl›ÁRou‹r
 
r
) {

109 
throw
 
Ãw
 
	`WrÚgEpochExû±iÚ
(
msg
.
	`g‘Paylßd
());

110 
	}
}

120 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
VERSION_RESPONSE
)

121 
´iv©e
 
Objeù
 
	`hªdËV”siÚRe¥Ú£
(
JSONPaylßdMsg
<
V”siÚInfo
> 
msg
,

122 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

123  
msg
.
	`g‘Paylßd
();

124 
	}
}

126 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
NOT_READY
)

127 
´iv©e
 
Objeù
 
	$hªdËNÙR—dy
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

128 
throw
 
Ãw
 
	`S”v”NÙR—dyExû±iÚ
();

129 
	}
}

134 @
	$Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_SERVER_EXCEPTION
)

135 
´iv©e
 
Objeù
 
	`hªdËS”v”Exû±iÚ
(
CÜfuPaylßdMsg
<
Exû±iÚMsg
> 
msg
,

136 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

137 
throws
 
ThrowabË
 {

138 
log
.
	`w¬n
("S”v”h»wƒxû±iÚ fÜ„eque¡ {}", 
msg
.
	`g‘Reque¡ID
(),

139 
msg
.
	`g‘Paylßd
().
	`g‘ThrowabË
());

140 
throw
 
msg
.
	`g‘Paylßd
().
	`g‘ThrowabË
();

141 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/clients/ClientHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gEËm’tTy³
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gT¬g‘
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

18 @
T¬g‘
(
EËm’tTy³
.
METHOD
)

19 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

20 @
Inh”™ed


21 
	gpublic
 @
š‹rçû
 
	gCl›ÁHªdËr
 {

28 
CÜfuMsgTy³
 
ty³
();

	@runtime/src/main/java/org/corfudb/runtime/clients/ClientMsgHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

9 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gLambdaM‘açùÜy
;

10 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdË
;

11 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

12 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodTy³
;

13 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gModif›r
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

24 @
Slf4j


25 
public
 cÏs 
	cCl›ÁMsgHªdËr
 {

27 @
FunùiÚ®IÁ”çû


28 
public
 
š‹rçû
 
	mHªdËr
<
T
 
ex‹nds
 
	mCÜfuMsg
> {

29 
Objeù
 
hªdË
(
T
 
cÜfuMsg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
è
throws
 
	mExû±iÚ
;

35 
´iv©e
 
fš®
 
	gM­
<
	gCÜfuMsgTy³
, 
	gCl›ÁMsgHªdËr
.
	gHªdËr
> 
	ghªdËrM­
;

40 
´iv©e
 
fš®
 
ICl›Á
 
	gş›Á
;

45 
public
 
	$Cl›ÁMsgHªdËr
(
ICl›Á
 
ş›Á
) {

46 
this
.
ş›Á
 = client;

47 
hªdËrM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

48 
	}
}

58 
	gpublic
 <
T
 
ex‹nds
 
	gCÜfuMsg
> 
Cl›ÁMsgHªdËr
 
addHªdËr
(
CÜfuMsgTy³
 
mes§geTy³
,

59 
Cl›ÁMsgHªdËr
.
HªdËr
<
T
> 
hªdËr
) {

60 
	ghªdËrM­
.
put
(
mes§geTy³
, 
hªdËr
);

61  
	gthis
;

71 @
Suµ»ssW¬nšgs
("unchecked")

72 
public
 
boŞ—n
 
	$hªdË
(
CÜfuMsg
 
mes§ge
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

73 ià(
hªdËrM­
.
	`cÚšsKey
(
mes§ge
.
	`g‘MsgTy³
())) {

74 
Œy
 {

75 
Objeù
 
»t
 = 
hªdËrM­
.
	`g‘
(
mes§ge
.
	`g‘MsgTy³
())

76 .
	`hªdË
(
mes§ge
, 
ùx
, 
ş›Á
.
	`g‘Rou‹r
());

77 ià(
»t
 !ğ
nuÎ
) {

78 
ş›Á
.
	`g‘Rou‹r
().
	`com¶‘eReque¡
(
mes§ge
.
	`g‘Reque¡ID
(), 
»t
);

80 } 
	`ÿtch
 (
ThrowabË
 
e
) {

81 
ş›Á
.
	`g‘Rou‹r
().
	`com¶‘eExû±iÚ®ly
(
mes§ge
.
	`g‘Reque¡ID
(), 
e
);

83  
Œue
;

85  
çl£
;

86 
	}
}

96 
public
 
Cl›ÁMsgHªdËr
 
g’”©eHªdËrs
(@
NÚNuÎ
 
fš®
 
M‘hodHªdËs
.
Lookup
 
ÿÎ”
,

97 @
NÚNuÎ
 
fš®
 
Objeù
 
o
) {

98 
	gA¼ays
.
¡»am
(
o
.
g‘CÏss
().
g‘Deş¬edM‘hods
())

99 .
f‹r
(
x
 -> x.
isAÂÙ©iÚP»£Á
(
Cl›ÁHªdËr
.
şass
))

100 .
fÜEach
(
x
 -> {

101 
Cl›ÁHªdËr
 
a
 = 
x
.
g‘AÂÙ©iÚ
(Cl›ÁHªdËr.
şass
);

102 ià(!
x
.
g‘P¬am‘”Ty³s
()[0]

103 .
isAssigÇbËFrom
(
a
.
ty³
().
mes§geTy³
.
g‘RawTy³
())) {

104 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Incorrect messageype,ƒxpected "

105 + 
a
.
ty³
().
mes§geTy³
.
g‘RawTy³
() + " but…rovided "

106 + 
x
.
g‘P¬am‘”Ty³s
()[0]);

108 ià(
hªdËrM­
.
cÚšsKey
(
a
.
ty³
())) {

109 
throw
 
Ãw
 
RuÁimeExû±iÚ
("HªdË¸fÜ " + 
a
.
ty³
()

113 
Œy
 {

114 ià(
Modif›r
.
isStic
(
x
.
g‘Modif›rs
())) {

115 
M‘hodHªdË
 
mh
 = 
ÿÎ”
.
uÄeæeù
(
x
);

116 
M‘hodTy³
 
mt
 = 
mh
.
ty³
().
chªgeP¬am‘”Ty³
(0, 
CÜfuMsg
.
şass
);

117 
hªdËrM­
.
put
(
a
.
ty³
(), (
Cl›ÁMsgHªdËr
.
HªdËr
è
LambdaM‘açùÜy


118 .
m‘açùÜy
(
ÿÎ”
, "handle",

119 
M‘hodTy³
.
m‘hodTy³
(
Cl›ÁMsgHªdËr
.
HªdËr
.
şass
),

120 
mt
, 
mh
, mh.
ty³
())

121 .
g‘T¬g‘
().
švokeExaù
());

124 
M‘hodTy³
 
mt
 = MethodType

125 .
m‘hodTy³
(
x
.
g‘R‘uºTy³
(), x.
g‘P¬am‘”Ty³s
());

126 
M‘hodHªdË
 
mh
 = 
ÿÎ”
.
fšdVœtu®
(
o
.
g‘CÏss
(), 
x
.
g‘Name
(), 
mt
);

127 
M‘hodTy³
 
mtG’”ic
 = 
mh
.
ty³
()

128 .
chªgeP¬am‘”Ty³
(1, 
CÜfuMsg
.
şass
)

129 .
chªgeR‘uºTy³
(
Objeù
.
şass
);

130 
hªdËrM­
.
put
(
a
.
ty³
(), (
Cl›ÁMsgHªdËr
.
HªdËr
è
LambdaM‘açùÜy


131 .
m‘açùÜy
(
ÿÎ”
, "handle",

132 
M‘hodTy³
.
m‘hodTy³
(
Cl›ÁMsgHªdËr
.
HªdËr
.
şass
,

133 
o
.
g‘CÏss
()),

134 
mtG’”ic
.
drİP¬am‘”Ty³s
(0, 1), 
mh
, mh.
ty³
()

135 .
drİP¬am‘”Ty³s
(0, 1))

136 .
g‘T¬g‘
().
bšdTo
(
o
).
švoke
());

138 } 
ÿtch
 (
ThrowabË
 
e
) {

139 
log
.
”rÜ
("Exû±iÚ duršg incomšg mes§ghªdlšg", 
e
);

140 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

143  
	gthis
;

151 
public
 
	gS‘
<
	gCÜfuMsgTy³
> 
	$g‘HªdËdTy³s
() {

152  
hªdËrM­
.
	`keyS‘
();

153 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/clients/IClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

15 
public
 
š‹rçû
 
	gICl›Á
 {

22 
£tRou‹r
(
ICl›ÁRou‹r
 
rou‹r
);

28  
£tPriÜ™yLev–
(
PriÜ™yLev–
 
Ëv–
) {

35 
ICl›ÁRou‹r
 
g‘Rou‹r
();

37  
Cl›ÁMsgHªdËr
 
g‘MsgHªdËr
() {

38 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Message handler‚ot…rovided, "

48  
hªdËMes§ge
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

49 
g‘MsgHªdËr
().
hªdË
(
msg
, 
ùx
);

57  
	gS‘
<
	gCÜfuMsgTy³
> 
g‘HªdËdTy³s
() {

58  
g‘MsgHªdËr
().
g‘HªdËdTy³s
();

	@runtime/src/main/java/org/corfudb/runtime/clients/IClientRouter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

17 
public
 
š‹rçû
 
	gICl›ÁRou‹r
 {

26 
ICl›ÁRou‹r
 
addCl›Á
(
ICl›Á
 
ş›Á
);

37 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
£ndMes§geAndG‘Com¶‘abË
(
ChªÃlHªdËrCÚ‹xt
 
ùx
,

38 
CÜfuMsg
 
mes§ge
);

49  <
	gT
> 
	gCom¶‘abËFutu»
<T> 
£ndMes§geAndG‘Com¶‘abË
(
CÜfuMsg
 
mes§ge
) {

50  
£ndMes§geAndG‘Com¶‘abË
(
nuÎ
, 
mes§ge
);

59 
£ndMes§ge
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
mes§ge
);

67  
£ndMes§ge
(
CÜfuMsg
 
mes§ge
) {

68 
£ndMes§ge
(
nuÎ
, 
mes§ge
);

78 
£ndRe¥Ú£ToS”v”
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
šMsg
, CÜfuMsg 
outMsg
);

87 <
	gT
> 
com¶‘eReque¡
(
»que¡ID
, 
T
 
com¶‘iÚ
);

95 
com¶‘eExû±iÚ®ly
(
»que¡ID
, 
ThrowabË
 
ÿu£
);

100 
¡¬t
();

105 
¡İ
();

107 
¡İ
(
boŞ—n
 
shutdown
);

112 
SŒšg
 
g‘Ho¡
();

117 
IÁeg”
 
g‘PÜt
();

124 
£tTimeoutCÚÃù
(
timeoutCÚÃù
);

131 
£tTimeoutR‘ry
(
timeoutR‘ry
);

138 
£tTimeoutRe¥Ú£
(
timeoutRe¥Ú£
);

	@runtime/src/main/java/org/corfudb/runtime/clients/IHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

9 
public
 
š‹rçû
 
	gIHªdËr
<
C
 
ex‹nds
 
	gAb¡¿ùCl›Á
> {

17 
C
 
g‘Cl›Á
(
•och
);

	@runtime/src/main/java/org/corfudb/runtime/clients/LayoutClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

5 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutBoÙ¡¿pReque¡
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutComm™‹dReque¡
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Reque¡
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Re¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutPrİo£Reque¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

23 
public
 cÏs 
	cLayoutCl›Á
 
ex‹nds
 
	mAb¡¿ùCl›Á
 {

25 
public
 
	$LayoutCl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

26 
	`su³r
(
rou‹r
, 
•och
);

34 
public
 
Com¶‘abËFutu»
<
Layout
> 
	$g‘Layout
() {

35  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LAYOUT_REQUEST
.
	`·ylßdMsg
(
	`g‘Epoch
()));

36 
	}
}

45 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$boÙ¡¿pLayout
(
Layout
 
l
) {

46  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP


47 .
	`·ylßdMsg
(
Ãw
 
	`LayoutBoÙ¡¿pReque¡
(
l
)));

48 
	}
}

59 
public
 
	gCom¶‘abËFutu»
<
	gLayoutP»·»Re¥Ú£
> 
	$´•¬e
(
•och
, 
¿nk
) {

60  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LAYOUT_PREPARE


61 .
	`·ylßdMsg
(
Ãw
 
	`LayoutP»·»Reque¡
(
•och
, 
¿nk
)));

62 
	}
}

75 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$´İo£
(
•och
, 
¿nk
, 
Layout
 
Ïyout
) {

76  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LAYOUT_PROPOSE


77 .
	`·ylßdMsg
(
Ãw
 
	`LayoutPrİo£Reque¡
(
•och
, 
¿nk
, 
Ïyout
)));

79 
	}
}

88 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$comm™‹d
(
•och
, 
Layout
 
Ïyout
) {

89  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LAYOUT_COMMITTED


90 .
	`·ylßdMsg
(
Ãw
 
	`LayoutComm™‹dReque¡
(
•och
, 
Ïyout
)));

91 
	}
}

98 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
fÜû
(@
NÚnuÎ
 
Layout
 
Ïyout
) {

99  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LAYOUT_COMMITTED


100 .
·ylßdMsg
(
Ãw
 
LayoutComm™‹dReque¡
(
Œue
, 
Ïyout
.
g‘Epoch
(),†ayout)));

	@runtime/src/main/java/org/corfudb/runtime/clients/LayoutHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gS‘‹r
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Reque¡
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Re¥Ú£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutPrİo£Re¥Ú£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoBoÙ¡¿pExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

27 
public
 
şass
 
LayoutHªdËr
 
im¶em’ts
 
	gICl›Á
, 
	gIHªdËr
<
	gLayoutCl›Á
> {

29 @
	gS‘‹r


30 @
G‘‹r


31 
ICl›ÁRou‹r
 
	grou‹r
;

33 @
Ov”ride


34 
public
 
LayoutCl›Á
 
g‘Cl›Á
(
•och
) {

35  
Ãw
 
LayoutCl›Á
(
rou‹r
, 
•och
);

41 @
G‘‹r


42 
public
 
Cl›ÁMsgHªdËr
 
	gmsgHªdËr
 = 
Ãw
 Cl›ÁMsgHªdËr(
this
)

43 .
g’”©eHªdËrs
(
M‘hodHªdËs
.
lookup
(), 
this
);

46 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_RESPONSE
)

47 
´iv©e
 
Objeù
 
hªdËLayoutRe¥Ú£
(
CÜfuMsg
 
msg
,

48 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

49  ((
	gLayoutMsg
è
	gmsg
).
g‘Layout
();

52 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_PREPARE_ACK
)

53 
´iv©e
 
Objeù
 
hªdËLayoutP»·»Ack
(
CÜfuPaylßdMsg
<
LayoutP»·»Reque¡
> 
msg
,

54 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

55  
	gmsg
.
g‘Paylßd
();

58 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_NOBOOTSTRAP
)

59 
´iv©e
 
Objeù
 
hªdËNoBoÙ¡¿p
(
CÜfuMsg
 
msg
,

60 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

61 
throws
 
	gExû±iÚ
 {

62 
throw
 
Ãw
 
NoBoÙ¡¿pExû±iÚ
();

65 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_PREPARE_REJECT
)

66 
´iv©e
 
Objeù
 
hªdËP»·»Rejeù
(
CÜfuPaylßdMsg
<
LayoutP»·»Re¥Ú£
> 
msg
,

67 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

68 
throws
 
	gExû±iÚ
 {

69 
LayoutP»·»Re¥Ú£
 
	g»¥Ú£
 = 
msg
.
g‘Paylßd
();

70 
throw
 
Ãw
 
OuŒªkedExû±iÚ
(
»¥Ú£
.
g‘Rªk
(),„e¥Ú£.
g‘Layout
());

73 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_PROPOSE_REJECT
)

74 
´iv©e
 
Objeù
 
hªdËPrİo£Rejeù
(
CÜfuPaylßdMsg
<
LayoutPrİo£Re¥Ú£
> 
msg
,

75 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

76 
throws
 
	gExû±iÚ
 {

77 
LayoutPrİo£Re¥Ú£
 
	g»¥Ú£
 = 
msg
.
g‘Paylßd
();

78 
throw
 
Ãw
 
OuŒªkedExû±iÚ
(
»¥Ú£
.
g‘Rªk
());

81 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LAYOUT_ALREADY_BOOTSTRAP
)

82 
´iv©e
 
Objeù
 
hªdËAÌ—dyBoÙ¡¿p
(
CÜfuMsg
 
msg
,

83 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

84 
throws
 
	gExû±iÚ
 {

85 
throw
 
Ãw
 
AÌ—dyBoÙ¡¿µedExû±iÚ
();

	@runtime/src/main/java/org/corfudb/runtime/clients/LogUnitClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

14 
impÜt
 
	glombok
.
	gG‘‹r
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gKnownAdd»ssReque¡
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gKnownAdd»ssRe¥Ú£
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gMuÉËR—dReque¡
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gRªgeWr™eMsg
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dReque¡
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasReque¡
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTrimReque¡
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gWr™eReque¡
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

44 
public
 cÏs 
	cLogUn™Cl›Á
 
ex‹nds
 
	mAb¡¿ùCl›Á
 {

46 
public
 
	$LogUn™Cl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

47 
	`su³r
(
rou‹r
, 
•och
);

50 
public
 
SŒšg
 
	$g‘Ho¡
() {

51  
	`g‘Rou‹r
().
	`g‘Ho¡
();

52 
	}
}

54 
public
 
IÁeg”
 
	$g‘PÜt
() {

55  
	`g‘Rou‹r
().
	`g‘PÜt
();

56 
	}
}

58 @
G‘‹r


59 
M‘ricRegi¡ry
 
	gm‘ricRegi¡ry
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

61 
´iv©e
 
	gTim”
.
CÚ‹xt
 
	$g‘Tim”CÚ‹xt
(
SŒšg
 
İName
) {

62 
fš®
 
SŒšg
 
tim”Name
 = SŒšg.
	`fÜm©
("%s%s:%s-%s",

63 
CÜfuCompÚ’t
.
LOG_UNIT_CLIENT
.
	`toSŒšg
(),

64 
	`g‘Ho¡
(),

65 
	`g‘PÜt
().
	`toSŒšg
(),

66 
İName
);

67 
Tim”
 
t
 = 
	`g‘M‘ricRegi¡ry
().
	`tim”
(
tim”Name
);

68  
t
.
	`time
();

69 
	}
}

80 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
wr™e
(
add»ss
,

81 
IM‘ad©a
.
D©aRªk
 
¿nk
,

82 
Objeù
 
wr™eObjeù
,

83 
M­
<
UUID
, 
LÚg
> 
backpoš‹rM­
) {

84 
	gTim”
.
CÚ‹xt
 
	gcÚ‹xt
 = 
g‘Tim”CÚ‹xt
("writeObject");

85 
By‹Buf
 
	g·ylßd
 = 
UÅoŞed
.
bufãr
();

86 
	gS”Ÿliz”s
.
	gCORFU
.
£rŸlize
(
wr™eObjeù
, 
·ylßd
);

87 
Wr™eReque¡
 
	gwr
 = 
Ãw
 Wr™eReque¡(
D©aTy³
.
DATA
, 
·ylßd
);

88 
	gwr
.
£tRªk
(
¿nk
);

89 
	gwr
.
£tBackpoš‹rM­
(
backpoš‹rM­
);

90 
	gwr
.
£tGlob®Add»ss
(
add»ss
);

91 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	gcf
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
WRITE
.
·ylßdMsg
(
wr
));

92  
	gcf
.
th’Aµly
(
x
 -> {

93 
cÚ‹xt
.
¡İ
();

94  
x
;

104 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$wr™e
(
ILogD©a
 
·ylßd
) {

105  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
Ãw
 
	`Wr™eReque¡
(
·ylßd
)));

106 
	}
}

114 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
wr™eRªge
(
Li¡
<
LogD©a
> 
¿nge
) {

115 ià(
	g¿nge
.
isEm±y
()) {

116 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Can't write‡nƒmpty„ange");

119 
	gba£
 = 
¿nge
.
g‘
(0).
g‘Glob®Add»ss
();

120 
	gx
 = 0; x < 
	g¿nge
.
size
(); x++) {

121 
LogD©a
 
	gcu¼
 = 
¿nge
.
g‘
(
x
);

122 ià(!
	gcu¼
.
g‘Glob®Add»ss
().
equ®s
(
ba£
 + 
x
)) {

123 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Entries‚ot in sequential order!");

124 } ià(
	gcu¼
.
isEm±y
()) {

125 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Can't writeƒmptyƒntries!");

129  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
RANGE_WRITE
.
·ylßdMsg
(
Ãw
 
RªgeWr™eMsg
(
¿nge
)));

139 
public
 
	gCom¶‘abËFutu»
<
	gR—dRe¥Ú£
> 
	$»ad
(
add»ss
) {

140  
	`»ad
(
add»ss
, 
Œue
);

141 
	}
}

150 
public
 
	gCom¶‘abËFutu»
<
	gR—dRe¥Ú£
> 
	$»ad
(
add»ss
, 
boŞ—n
 
ÿch—bË
) {

151 
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
	`g‘Tim”CÚ‹xt
("read");

152 
Com¶‘abËFutu»
<
R—dRe¥Ú£
> 
cf
 = 
	`£ndMes§geW™hFutu»
(

153 
CÜfuMsgTy³
.
READ_REQUEST
.
	`·ylßdMsg
(
Ãw
 
	`R—dReque¡
(
add»ss
, 
ÿch—bË
)));

155  
cf
.
	`th’Aµly
(
x
 -> {

156 
cÚ‹xt
.
	`¡İ
();

157  
x
;

159 
	}
}

169 
public
 
	gCom¶‘abËFutu»
<
	gR—dRe¥Ú£
> 
»adAÎ
(
Li¡
<
LÚg
> 
add»s£s
) {

170  
»adAÎ
(
add»s£s
, 
çl£
);

180 
public
 
	gCom¶‘abËFutu»
<
	gR—dRe¥Ú£
> 
»adAÎ
(
Li¡
<
LÚg
> 
add»s£s
, 
boŞ—n
 
ÿch—bË
) {

181 
	gTim”
.
CÚ‹xt
 
	gcÚ‹xt
 = 
g‘Tim”CÚ‹xt
("readAll");

182 
	gCom¶‘abËFutu»
<
	gR—dRe¥Ú£
> 
	gcf
 = 
£ndMes§geW™hFutu»
(

183 
CÜfuMsgTy³
.
MULTIPLE_READ_REQUEST
.
·ylßdMsg
(
Ãw
 
MuÉËR—dReque¡
(
add»s£s
, 
ÿch—bË
)));

184  
	gcf
.
th’Aµly
(
x
 -> {

185 
cÚ‹xt
.
¡İ
();

186  
x
;

196 
public
 
	gCom¶‘abËFutu»
<
	gTasRe¥Ú£
> 
	$g‘LogTa
() {

197  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
TAIL_REQUEST
.
	`·ylßdMsg
(
Ãw
 
	`TasReque¡
(
TasReque¡
.
LOG_TAIL
)));

198 
	}
}

206 
public
 
	gCom¶‘abËFutu»
<
	gTasRe¥Ú£
> 
	$g‘AÎTas
() {

207  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
TAIL_REQUEST
.
	`·ylßdMsg
(
TasReque¡
.
ALL_STREAMS_TAIL
));

208 
	}
}

215 
public
 
	gCom¶‘abËFutu»
<
	gSŒ—msAdd»ssRe¥Ú£
> 
	$g‘LogAdd»ssS·û
() {

216  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
LOG_ADDRESS_SPACE_REQUEST
.
	`msg
());

217 
	}
}

224 
public
 
	gCom¶‘abËFutu»
<
	gLÚg
> 
	$g‘TrimM¬k
() {

225  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
TRIM_MARK_REQUEST
.
	`msg
());

226 
	}
}

235 
public
 
	gCom¶‘abËFutu»
<
	gKnownAdd»ssRe¥Ú£
> 
	$»que¡KnownAdd»s£s
(
¡¬tRªge
,

236 
’dRªge
) {

237  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
KNOWN_ADDRESS_REQUEST


238 .
	`·ylßdMsg
(
Ãw
 
	`KnownAdd»ssReque¡
(
¡¬tRªge
, 
’dRªge
)));

239 
	}
}

247 
public
 
	gCom¶‘abËFutu»
<
	gVoid
> 
	$´efixTrim
(
Tok’
 
add»ss
) {

248  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
PREFIX_TRIM


249 .
	`·ylßdMsg
(
Ãw
 
	`TrimReque¡
(
add»ss
)));

250 
	}
}

255 
public
 
	gCom¶‘abËFutu»
<
	gVoid
> 
	$com·ù
() {

256  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
COMPACT_REQUEST
.
	`msg
());

257 
	}
}

262 
public
 
	gCom¶‘abËFutu»
<
	gVoid
> 
	$æushCache
() {

263  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
FLUSH_CACHE
.
	`msg
());

264 
	}
}

273 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$»£tLogUn™
(
•och
) {

274  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
RESET_LOGUNIT
.
	`·ylßdMsg
(
•och
));

275 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/clients/LogUnitHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gKnownAdd»ssRe¥Ú£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aOuŒªkedExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOutOfS·ûExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gV®ueAdİ‹dExû±iÚ
;

31 
public
 
şass
 
LogUn™HªdËr
 
im¶em’ts
 
	gICl›Á
, 
	gIHªdËr
<
	gLogUn™Cl›Á
> {

33 @
	gS‘‹r


34 @
G‘‹r


35 
ICl›ÁRou‹r
 
	grou‹r
;

37 @
Ov”ride


38 
public
 
LogUn™Cl›Á
 
g‘Cl›Á
(
•och
) {

39  
Ãw
 
LogUn™Cl›Á
(
rou‹r
, 
•och
);

45 @
G‘‹r


46 
public
 
Cl›ÁMsgHªdËr
 
	gmsgHªdËr
 = 
Ãw
 Cl›ÁMsgHªdËr(
this
)

47 .
g’”©eHªdËrs
(
M‘hodHªdËs
.
lookup
(), 
this
);

57 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
WRITE_OK
)

58 
´iv©e
 
Objeù
 
hªdËOk
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

59  
	gŒue
;

70 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_TRIMMED
)

71 
´iv©e
 
Objeù
 
hªdËTrimmed
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

72 
throws
 
	gExû±iÚ
 {

73 
throw
 
Ãw
 
TrimmedExû±iÚ
();

84 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_OVERWRITE
)

85 
´iv©e
 
Objeù
 
hªdËOv”wr™e
(
CÜfuPaylßdMsg
<
IÁeg”
> 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

86 
throws
 
	gExû±iÚ
 {

87 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
äomId
(
msg
.
g‘Paylßd
()));

98 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_DATA_OUTRANKED
)

99 
´iv©e
 
Objeù
 
hªdËD©aOuŒªked
(
CÜfuMsg
 
msg
,

100 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

101 
throws
 
	gExû±iÚ
 {

102 
throw
 
Ãw
 
D©aOuŒªkedExû±iÚ
();

113 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_VALUE_ADOPTED
)

114 
´iv©e
 
Objeù
 
hªdËV®ueAdİ‹dRe¥Ú£
(
CÜfuPaylßdMsg
<
R—dRe¥Ú£
> 
msg
,

115 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

116 
throw
 
Ãw
 
V®ueAdİ‹dExû±iÚ
(
msg
.
g‘Paylßd
());

127 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_OOS
)

128 
´iv©e
 
Objeù
 
hªdËOos
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

129 
throws
 
	gExû±iÚ
 {

130 
throw
 
Ãw
 
OutOfS·ûExû±iÚ
();

141 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_RANK
)

142 
´iv©e
 
Objeù
 
hªdËOuŒªked
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

143 
throws
 
	gExû±iÚ
 {

144 
throw
 
Ãw
 
Exû±iÚ
("rank");

155 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_NOENTRY
)

156 
´iv©e
 
Objeù
 
hªdËNoEÁry
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

157 
throws
 
	gExû±iÚ
 {

158 
throw
 
Ãw
 
Exû±iÚ
("Triedo write commit on‡‚on-existentƒntry");

168 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
READ_RESPONSE
)

169 
´iv©e
 
Objeù
 
hªdËR—dRe¥Ú£
(
CÜfuPaylßdMsg
<
R—dRe¥Ú£
> 
msg
,

170 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

171  
	gmsg
.
g‘Paylßd
();

181 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ERROR_DATA_CORRUPTION
)

182 
´iv©e
 
Objeù
 
hªdËR—dD©aCÜru±iÚ
(
CÜfuPaylßdMsg
<
LÚg
> 
msg
,

183 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

184 
	g»ad
 = 
msg
.
g‘Paylßd
().
lÚgV®ue
();

185 
throw
 
Ãw
 
D©aCÜru±iÚExû±iÚ
(
SŒšg
.
fÜm©
("EncouÁ”ed cÜru±ed d©¨wh»adšg %s", 
»ad
));

195 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
TAIL_RESPONSE
)

196 
´iv©e
 
Objeù
 
hªdËTaRe¥Ú£
(
CÜfuPaylßdMsg
<
TasRe¥Ú£
> 
msg
,

197 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

198  
	gmsg
.
g‘Paylßd
();

201 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
LOG_ADDRESS_SPACE_RESPONSE
)

202 
´iv©e
 
Objeù
 
hªdËSŒ—msAdd»ssRe¥Ú£
(
CÜfuPaylßdMsg
<
TasRe¥Ú£
> 
msg
,

203 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

204  
	gmsg
.
g‘Paylßd
();

213 @
Cl›ÁHªdËr
(
ty³
=
CÜfuMsgTy³
.
TRIM_MARK_RESPONSE
)

214 
´iv©e
 
Objeù
 
hªdËTrimM¬kRe¥Ú£
(
CÜfuPaylßdMsg
<
LÚg
> 
msg
,

215 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

216  
	gmsg
.
g‘Paylßd
();

227 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
KNOWN_ADDRESS_RESPONSE
)

228 
´iv©e
 
Objeù
 
hªdËKnownAdd»s£sRe¥Ú£
(
CÜfuPaylßdMsg
<
KnownAdd»ssRe¥Ú£
> 
msg
,

229 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

230  
	gmsg
.
g‘Paylßd
();

	@runtime/src/main/java/org/corfudb/runtime/clients/ManagementClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

4 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

9 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD‘eùÜMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gFau»D‘eùÜM‘rics
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gAddNodeReque¡
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gFÜûRemoveNodeReque¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gH—lNodeReque¡
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRe¡ÜeRedundªcyM”geSegm’tsReque¡
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜMsg
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜRe¥Ú£
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gQu”yReque¡
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gQu”yRe¥Ú£
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gRemoveNodeReque¡
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

36 
public
 cÏs 
	cMªagem’tCl›Á
 
ex‹nds
 
	mAb¡¿ùCl›Á
 {

38 
public
 
	$Mªagem’tCl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

39 
	`su³r
(
rou‹r
, 
•och
);

49 
public
 
Com¶‘abËFutu»
<
BoŞ—n
> 
	$boÙ¡¿pMªagem’t
(
Layout
 
l
) {

50  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
.
	`·ylßdMsg
(
l
));

51 
	}
}

59 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
hªdËFau»
(
d‘eùÜEpoch
, 
S‘
<
SŒšg
> 
çedNodes
) {

60  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED


61 .
·ylßdMsg
(
Ãw
 
D‘eùÜMsg
(
d‘eùÜEpoch
, 
çedNodes
, 
CŞËùiÚs
.
em±yS‘
())));

70 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
hªdËH—lšg
(
d‘eùÜEpoch
, 
S‘
<
SŒšg
> 
h—ËdNodes
) {

71  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
MANAGEMENT_HEALING_DETECTED


72 .
·ylßdMsg
(
Ãw
 
D‘eùÜMsg
(
d‘eùÜEpoch
, 
CŞËùiÚs
.
em±yS‘
(), 
h—ËdNodes
)));

75 
public
 
	gCom¶‘abËFutu»
<
	gNodeS‹
> 
	$£ndNodeS‹Reque¡
() {

76  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
NODE_STATE_REQUEST
.
	`msg
());

77 
	}
}

84 
public
 
	gCom¶‘abËFutu»
<
	gLayout
> 
	$g‘Layout
() {

85  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
MANAGEMENT_LAYOUT_REQUEST
.
	`msg
());

86 
	}
}

94 
public
 
C»©eWÜkæowRe¥Ú£
 
addNodeReque¡
(@
NÚnuÎ
 
SŒšg
 
’dpošt
è
throws
 
	gTimeoutExû±iÚ
 {

95 
Orche¡¿tÜMsg
 
	g»q
 = 
Ãw
 Orche¡¿tÜMsgÒew 
AddNodeReque¡
(
’dpošt
));

96 
	gCom¶‘abËFutu»
<
	gOrche¡¿tÜRe¥Ú£
> 
	g»¥
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³


97 .
ORCHESTRATOR_REQUEST


98 .
·ylßdMsg
(
»q
));

99  (
	gC»©eWÜkæowRe¥Ú£
è
	gCFUts
.
g‘Unš‹¼u±ibly
(
»¥
, 
TimeoutExû±iÚ
.
şass
).
g‘Re¥Ú£
();

113 
public
 
C»©eWÜkæowRe¥Ú£
 
h—lNodeReque¡
(@
NÚnuÎ
 
SŒšg
 
’dpošt
,

114 
boŞ—n
 
isLayoutS”v”
,

115 
boŞ—n
 
isSequ’ûrS”v”
,

116 
boŞ—n
 
isLogUn™S”v”
,

117 
¡reIndex
è
throws
 
	gTimeoutExû±iÚ
 {

118 
Orche¡¿tÜMsg
 
	g»q
 = 
Ãw
 OrchestratorMsg(

119 
Ãw
 
H—lNodeReque¡
(
’dpošt
,

120 
isLayoutS”v”
,

121 
isSequ’ûrS”v”
,

122 
isLogUn™S”v”
,

123 
¡reIndex
));

124 
	gCom¶‘abËFutu»
<
	gOrche¡¿tÜRe¥Ú£
> 
	g»¥
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³


125 .
ORCHESTRATOR_REQUEST


126 .
·ylßdMsg
(
»q
));

127  (
	gC»©eWÜkæowRe¥Ú£
è
	gCFUts
.
g‘Unš‹¼u±ibly
(
»¥
, 
TimeoutExû±iÚ
.
şass
).
g‘Re¥Ú£
();

137 
public
 
C»©eWÜkæowRe¥Ú£
 
m”geSegm’ts
(@
NÚnuÎ
 
SŒšg
 
’dpošt
è
throws
 
	gTimeoutExû±iÚ
 {

138 
Orche¡¿tÜMsg
 
	g»q
 = 
Ãw
 Orche¡¿tÜMsgÒew 
Re¡ÜeRedundªcyM”geSegm’tsReque¡
(
’dpošt
));

139 
	gCom¶‘abËFutu»
<
	gOrche¡¿tÜRe¥Ú£
> 
	g»¥
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³


140 .
ORCHESTRATOR_REQUEST


141 .
·ylßdMsg
(
»q
));

142  (
	gC»©eWÜkæowRe¥Ú£
è
	gCFUts
.
g‘Unš‹¼u±ibly
(
»¥
, 
TimeoutExû±iÚ
.
şass
).
g‘Re¥Ú£
();

151 
public
 
Qu”yRe¥Ú£
 
qu”yReque¡
(@
NÚnuÎ
 
UUID
 
wÜkæowId
è
throws
 
	gTimeoutExû±iÚ
 {

152 
Orche¡¿tÜMsg
 
	g»q
 = 
Ãw
 Orche¡¿tÜMsgÒew 
Qu”yReque¡
(
wÜkæowId
));

153 
	gCom¶‘abËFutu»
<
	gOrche¡¿tÜRe¥Ú£
> 
	g»¥
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³


154 .
ORCHESTRATOR_REQUEST


155 .
·ylßdMsg
(
»q
));

156  (
	gQu”yRe¥Ú£
è
	gCFUts
.
g‘Unš‹¼u±ibly
(
»¥
, 
TimeoutExû±iÚ
.
şass
).
g‘Re¥Ú£
();

165 
public
 
C»©eWÜkæowRe¥Ú£
 
»moveNode
(@
NÚnuÎ
 
SŒšg
 
’dpošt
è
throws
 
	gTimeoutExû±iÚ
 {

166 
Orche¡¿tÜMsg
 
	g»q
 = 
Ãw
 Orche¡¿tÜMsgÒew 
RemoveNodeReque¡
(
’dpošt
));

167 
	gCom¶‘abËFutu»
<
	gOrche¡¿tÜRe¥Ú£
> 
	g»¥
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³


168 .
ORCHESTRATOR_REQUEST


169 .
·ylßdMsg
(
»q
));

170  (
	gC»©eWÜkæowRe¥Ú£
è
	gCFUts
.
g‘Unš‹¼u±ibly
(
»¥
, 
TimeoutExû±iÚ
.
şass
).
g‘Re¥Ú£
();

181 
public
 
C»©eWÜkæowRe¥Ú£
 
fÜûRemoveNode
(@
NÚnuÎ
 
SŒšg
 
’dpošt
è
throws
 
	gTimeoutExû±iÚ
 {

182 
Orche¡¿tÜMsg
 
	g»q
 = 
Ãw
 Orche¡¿tÜMsgÒew 
FÜûRemoveNodeReque¡
(
’dpošt
));

183 
	gCom¶‘abËFutu»
<
	gOrche¡¿tÜRe¥Ú£
> 
	g»¥
 = 
£ndMes§geW™hFutu»
(
CÜfuMsgTy³


184 .
ORCHESTRATOR_REQUEST


185 .
·ylßdMsg
(
»q
));

186  (
	gC»©eWÜkæowRe¥Ú£
è
	gCFUts
.
g‘Unš‹¼u±ibly
(
»¥
, 
TimeoutExû±iÚ
.
şass
).
g‘Re¥Ú£
();

	@runtime/src/main/java/org/corfudb/runtime/clients/ManagementHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.*;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gOrche¡¿tÜRe¥Ú£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoBoÙ¡¿pExû±iÚ
;

22 
public
 
şass
 
Mªagem’tHªdËr
 
im¶em’ts
 
	gICl›Á
, 
	gIHªdËr
<
	gMªagem’tCl›Á
> {

24 @
	gS‘‹r


25 @
G‘‹r


26 
ICl›ÁRou‹r
 
	grou‹r
;

28 @
Ov”ride


29 
public
 
Mªagem’tCl›Á
 
g‘Cl›Á
(
•och
) {

30  
Ãw
 
Mªagem’tCl›Á
(
rou‹r
, 
•och
);

36 @
G‘‹r


37 
public
 
Cl›ÁMsgHªdËr
 
	gmsgHªdËr
 = 
Ãw
 Cl›ÁMsgHªdËr(
this
)

38 .
g’”©eHªdËrs
(
M‘hodHªdËs
.
lookup
(), 
this
);

41 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
ORCHESTRATOR_RESPONSE
)

42 
´iv©e
 
Objeù
 
hªdËOrche¡¿tÜRe¥Ú£
(
CÜfuPaylßdMsg
<
Orche¡¿tÜRe¥Ú£
> 
msg
,

43 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

44  
	gmsg
.
g‘Paylßd
();

47 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MANAGEMENT_NOBOOTSTRAP_ERROR
)

48 
´iv©e
 
Objeù
 
hªdËNoBoÙ¡¿pE¼Ü
(
CÜfuMsg
 
msg
,

49 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

50 
throws
 
	gExû±iÚ
 {

51 
throw
 
Ãw
 
NoBoÙ¡¿pExû±iÚ
();

54 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
MANAGEMENT_ALREADY_BOOTSTRAP_ERROR
)

55 
´iv©e
 
Objeù
 
hªdËAÌ—dyBoÙ¡¿µedE¼Ü
(
CÜfuMsg
 
msg
,

56 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
)

57 
throws
 
	gExû±iÚ
 {

58 
throw
 
Ãw
 
AÌ—dyBoÙ¡¿µedExû±iÚ
();

61 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
NODE_STATE_RESPONSE
)

62 
´iv©e
 
Objeù
 
hªdËNodeS‹Re¥Ú£
(
CÜfuPaylßdMsg
<
NodeS‹
> 
msg
,

63 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

64  
	gmsg
.
g‘Paylßd
();

67 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
FAILURE_DETECTOR_METRICS_RESPONSE
)

68 
´iv©e
 
Objeù
 
hªdËFau»D‘eùÜM‘ricsRe¥Ú£
(
CÜfuPaylßdMsg
<
NodeS‹
> 
msg
,

69 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

70  
	gmsg
.
g‘Paylßd
();

	@runtime/src/main/java/org/corfudb/runtime/clients/NettyClientRouter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gboÙ¡¿p
.
	gBoÙ¡¿p
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃl
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlFutu»
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËr
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlIn™Ÿliz”
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlO±iÚ
;

14 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

15 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gSim¶eChªÃlInboundHªdËr
;

16 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gL’gthF›ldBa£dF¿meDecod”
;

17 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gcodec
.
	gL’gthF›ldP»³nd”
;

18 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦CÚ‹xt
;

19 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gIdËS‹
;

20 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gIdËS‹Ev’t
;

21 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gIdËS‹HªdËr
;

23 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

24 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

35 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

36 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

38 
impÜt
 
	glombok
.
	gG‘‹r
;

39 
impÜt
 
	glombok
.
	gNÚNuÎ
;

40 
impÜt
 
	glombok
.
	gS‘‹r
;

41 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

43 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCl›ÁHªdshakeHªdËr
;

44 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCl›ÁHªdshakeHªdËr
.
	gCl›ÁHªdshakeEv’t
;

45 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

46 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

47 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gInboundMsgF‹rHªdËr
;

48 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gN‘tyCÜfuMes§geDecod”
;

49 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gN‘tyCÜfuMes§geEncod”
;

50 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

51 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

52 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gRuÁimeP¬am‘”s
;

53 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

54 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

55 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

56 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	gSa¦Uts
;

57 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
.
	gPÏšTextSa¦N‘tyCl›Á
;

58 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
.
	gS¦CÚ‹xtCÚ¡ruùÜ
;

59 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

60 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

61 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

62 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

63 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

71 @
	gSlf4j


72 @
	gChªÃlHªdËr
.
Sh¬abË


73 
public
 
şass
 
N‘tyCl›ÁRou‹r
 
ex‹nds
 
	gSim¶eChªÃlInboundHªdËr
<
	gCÜfuMsg
>

74 
im¶em’ts
 
	gICl›ÁRou‹r
 {

79 @
	gG‘‹r


80 @
S‘‹r


81 
public
 
	gtimeoutCÚÃù
;

86 @
	gG‘‹r


87 @
S‘‹r


88 
public
 
	gtimeoutRe¥Ú£
;

93 @
	gG‘‹r


94 @
S‘‹r


95 
public
 
	gtimeoutR‘ry
;

100 @
	gG‘‹r


101 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

102 
public
 
AtomicLÚg
 
	g»que¡ID
;

106 
public
 
fš®
 
	gM­
<
	gCÜfuMsgTy³
, 
	gICl›Á
> 
	ghªdËrM­
;

110 
public
 
fš®
 
	gLi¡
<
	gICl›Á
> 
	gş›ÁLi¡
;

115 
public
 
fš®
 
	gM­
<
	gLÚg
, 
	gCom¶‘abËFutu»
> 
	gout¡ªdšgReque¡s
;

120 
´iv©e
 vŞ©
ChªÃl
 
	gchªÃl
 = 
nuÎ
;

125 
public
 vŞ©
boŞ—n
 
	gshutdown
;

130 @
G‘‹r


131 
´iv©e
 
fš®
 
NodeLoÿtÜ
 
	gnode
;

136 
´iv©e
 
fš®
 
RuÁimeP¬am‘”s
 
	g·¿m‘”s
;

142 @
G‘‹r


143 vŞ©
	gCom¶‘abËFutu»
<
	gVoid
> 
	gcÚÃùiÚFutu»
;

145 
´iv©e
 
S¦CÚ‹xt
 
	gs¦CÚ‹xt
;

146 
´iv©e
 
fš®
 
	gM­
<
	gCÜfuMsgTy³
, 
	gSŒšg
> 
	gtim”NameCache
;

148 
public
 
N‘tyCl›ÁRou‹r
(@
NÚnuÎ
 
NodeLoÿtÜ
 
node
,

149 @
NÚnuÎ
 
Ev’tLoİGroup
 
ev’tLoİGroup
,

150 @
NÚnuÎ
 
RuÁimeP¬am‘”s
 
·¿m‘”s
) {

151 
	glog
.
šfo
("C»©šg Cl›Á Rou‹¸{} ", 
·¿m‘”s
);

152 
	gthis
.
	gnode
 = 
node
;

153 
	gthis
.
	g·¿m‘”s
 = 
·¿m‘”s
;

156 
	gImmubËM­
.
	gBud”
<
	gCÜfuMsgTy³
, 
	gSŒšg
> 
	gm­Bud”
 = 
ImmubËM­
.
bud”
();

157 
CÜfuMsgTy³
 
	gty³
 : CÜfuMsgTy³.
v®ues
()) {

158 
m­Bud”
.
put
(
ty³
,

159 
CÜfuCompÚ’t
.
CLIENT_ROUTER
.
toSŒšg
(è+ 
ty³
.
Çme
().
toLow”Ca£
());

162 
	gtim”NameCache
 = 
m­Bud”
.
bud
();

164 
	gtimeoutCÚÃù
 = 
·¿m‘”s
.
g‘CÚÃùiÚTimeout
().
toMlis
();

165 
	gtimeoutRe¥Ú£
 = 
·¿m‘”s
.
g‘Reque¡Timeout
().
toMlis
();

166 
	gtimeoutR‘ry
 = 
·¿m‘”s
.
g‘CÚÃùiÚR‘ryR©e
().
toMlis
();

168 
	gcÚÃùiÚFutu»
 = 
Ãw
 
Com¶‘abËFutu»
<>();

170 
	ghªdËrM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

171 
	gş›ÁLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

172 
	g»que¡ID
 = 
Ãw
 
AtomicLÚg
();

173 
	gout¡ªdšgReque¡s
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

174 
	gshutdown
 = 
Œue
;

176 ià(
	g·¿m‘”s
.
isTlsEÇbËd
()) {

177 
	gŒy
 {

178 
	gs¦CÚ‹xt
 = 
S¦CÚ‹xtCÚ¡ruùÜ
.
cÚ¡ruùS¦CÚ‹xt
(
çl£
,

179 
·¿m‘”s
.
g‘KeyStÜe
(),

180 
·¿m‘”s
.
g‘KsPasswÜdFe
(),

181 
·¿m‘”s
.
g‘Tru¡StÜe
(),

182 
·¿m‘”s
.
g‘TsPasswÜdFe
());

183 } 
ÿtch
 (
SSLExû±iÚ
 
e
) {

184 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
e
);

188 
addCl›Á
(
Ãw
 
Ba£HªdËr
());

192 
	gshutdown
 = 
çl£
;

193 
BoÙ¡¿p
 
	gb
 = 
Ãw
 Bootstrap();

194 
	gb
.
group
(
ev’tLoİGroup
);

195 
	gb
.
chªÃl
(
·¿m‘”s
.
g‘Sock‘Ty³
().
g‘ChªÃlCÏss
());

196 
	g·¿m‘”s
.
g‘N‘tyChªÃlO±iÚs
().
fÜEach
(
b
::
İtiÚ
);

197 
	gb
.
hªdËr
(
g‘ChªÃlIn™Ÿliz”
());

198 
	gb
.
İtiÚ
(
ChªÃlO±iÚ
.
CONNECT_TIMEOUT_MILLIS
, (è
timeoutCÚÃù
);

202 
cÚÃùAsync
(
b
);

211 
public
 
ICl›ÁRou‹r
 
addCl›Á
(
ICl›Á
 
ş›Á
) {

213 
	gş›Á
.
£tRou‹r
(
this
);

216 
	gş›Á
.
g‘HªdËdTy³s
().
¡»am
()

217 .
fÜEach
(
x
 -> {

218 
hªdËrM­
.
put
(
x
, 
ş›Á
);

219 
log
.
Œaû
("Regi¡”ed {}ØhªdË mes§ge oàty³ {}", 
ş›Á
, 
x
);

223 
	gş›ÁLi¡
.
add
(
ş›Á
);

224  
	gthis
;

235 @
Suµ»ssW¬nšgs
("unchecked")

236 
	gpublic
 <
T
 
ex‹nds
 
	gICl›Á
> T 
g‘Cl›Á
(
CÏss
<T> 
ş›ÁTy³
) {

237  (
	gT
è
	gş›ÁLi¡
.
¡»am
()

238 .
f‹r
(
ş›ÁTy³
::
isIn¡ªû
)

239 .
fšdFœ¡
().
g‘
();

248 @
	gOv”ride


249 @
D•»ÿ‹d


250 
public
 
synchrÚized
 
¡¬t
() {

258 
´iv©e
 
ChªÃlIn™Ÿliz”
 
g‘ChªÃlIn™Ÿliz”
() {

259  
Ãw
 
ChªÃlIn™Ÿliz”
() {

260 @
Ov”ride


261 
´Ùeùed
 
š™ChªÃl
(@
NÚnuÎ
 
ChªÃl
 
ch
è
throws
 
	gExû±iÚ
 {

262 
	gch
.
p–še
().
addLa¡
(
Ãw
 
IdËS‹HªdËr
(
·¿m‘”s
.
g‘IdËCÚÃùiÚTimeout
(),

263 
·¿m‘”s
.
g‘K“pAliveP”iod
(), 0));

264 ià(
	g·¿m‘”s
.
isTlsEÇbËd
()) {

265 
	gch
.
p–še
().
addLa¡
("s¦", 
s¦CÚ‹xt
.
ÃwHªdËr
(
ch
.
®loc
()));

267 
	gch
.
p–še
().
addLa¡
(
Ãw
 
L’gthF›ldP»³nd”
(4));

268 
	gch
.
p–še
().
addLa¡
(
Ãw
 
L’gthF›ldBa£dF¿meDecod”
(
IÁeg”
.
MAX_VALUE
,

271 ià(
	g·¿m‘”s
.
isSa¦PÏšTextEÇbËd
()) {

272 
PÏšTextSa¦N‘tyCl›Á
 
	g§¦N‘tyCl›Á
 =

273 
Sa¦Uts
.
’abËSa¦PÏšText
(
·¿m‘”s
.
g‘U£ºameFe
(),

274 
·¿m‘”s
.
g‘PasswÜdFe
());

275 
	gch
.
p–še
().
addLa¡
("§¦/¶aš-‹xt", 
§¦N‘tyCl›Á
);

277 
	gch
.
p–še
().
addLa¡
(
Ãw
 
N‘tyCÜfuMes§geDecod”
());

278 
	gch
.
p–še
().
addLa¡
(
Ãw
 
N‘tyCÜfuMes§geEncod”
());

279 
	gch
.
p–še
().
addLa¡
(
Ãw
 
Cl›ÁHªdshakeHªdËr
(
·¿m‘”s
.
g‘Cl›ÁId
(),

280 
node
.
g‘NodeId
(), 
·¿m‘”s
.
g‘HªdshakeTimeout
()));

283 ià(
	g·¿m‘”s
.
g‘N‘tyCl›ÁInboundMsgF‹rs
(è!ğ
nuÎ
) {

284 
fš®
 
InboundMsgF‹rHªdËr
 
šboundMsgF‹rHªdËr
 =

285 
Ãw
 
InboundMsgF‹rHªdËr
(
·¿m‘”s
.
g‘N‘tyCl›ÁInboundMsgF‹rs
());

286 
	gch
.
p–še
().
addLa¡
(
šboundMsgF‹rHªdËr
);

288 
	gch
.
p–še
().
addLa¡
(
N‘tyCl›ÁRou‹r
.
this
);

298 
´iv©e
 
addRecÚÃùiÚOnClo£Futu»
(@
NÚnuÎ
 
ChªÃl
 
chªÃl
,

299 @
NÚnuÎ
 
BoÙ¡¿p
 
boÙ¡¿p
) {

300 
	gchªÃl
.
şo£Futu»
().
addLi¡’”
((
r
) -> {

301 
log
.
debug
("addRecÚÃùiÚOnClo£Futu»[{}]: discÚÃùed", 
node
);

303 
cÚÃùiÚFutu»
 = 
Ãw
 
Com¶‘abËFutu»
<>();

305 
out¡ªdšgReque¡s
.
fÜEach
((
»qId
, 
»qCom¶‘abËFutu»
) -> {

306 
»qCom¶‘abËFutu»
.
com¶‘eExû±iÚ®ly
(

307 
Ãw
 
N‘wÜkExû±iÚ
("DiscÚÃùed", 
node
));

309 
out¡ªdšgReque¡s
.
»move
(
»qId
);

312 ià(!
shutdown
) {

313 
SË•
.
¦“pUnš‹¼u±ibly
(
·¿m‘”s
.
g‘CÚÃùiÚR‘ryR©e
());

314 
log
.
debug
("addRecÚÃùiÚOnClo£Futu»[{}]:„ecÚÃùšg...", 
node
);

316 
cÚÃùAsync
(
boÙ¡¿p
);

326 
´iv©e
 
cÚÃùAsync
(@
NÚnuÎ
 
BoÙ¡¿p
 
boÙ¡¿p
) {

328 ià(
	gshutdown
) {

331 
	glog
.
šfo
("CÚÃù Asynø{}:{}", 
node
.
g‘Ho¡
(),‚ode.
g‘PÜt
());

333 
ChªÃlFutu»
 
	gf
 = 
boÙ¡¿p
.
cÚÃù
(
node
.
g‘Ho¡
(),‚ode.
g‘PÜt
());

334 
	gf
.
addLi¡’”
((
ChªÃlFutu»
 
cf
è-> 
chªÃlCÚÃùiÚFutu»HªdËr
(cf, 
boÙ¡¿p
));

342 
´iv©e
 
chªÃlCÚÃùiÚFutu»HªdËr
(@
NÚnuÎ
 
ChªÃlFutu»
 
futu»
,

343 @
NÚnuÎ
 
BoÙ¡¿p
 
boÙ¡¿p
) {

344 ià(
	gfutu»
.
isSucûss
()) {

346 
addRecÚÃùiÚOnClo£Futu»
(
futu»
.
chªÃl
(), 
boÙ¡¿p
);

347 
	glog
.
šfo
("cÚÃùAsync[{}]: ChªÃÈcÚÃùed.", 
node
);

351 ià(!
	gshutdown
) {

352 
	gSË•
.
¦“pUnš‹¼u±ibly
(
·¿m‘”s
.
g‘CÚÃùiÚR‘ryR©e
());

353 
	glog
.
šfo
("cÚÃùAsync[{}]: ChªÃÈcÚÃùiÚ faed,„ecÚÃùšg...", 
node
);

357 
cÚÃùAsync
(
boÙ¡¿p
);

365 @
Ov”ride


366 
public
 
¡İ
() {

367 
	glog
.
debug
("¡İ: Shu‰šg dowÀrou‹¸fÜ {}", 
node
);

368 
	gshutdown
 = 
Œue
;

369 
	gcÚÃùiÚFutu»
.
com¶‘eExû±iÚ®ly
(
Ãw
 
N‘wÜkExû±iÚ
("Rou‹¸¡İ³d", 
node
));

370 ià(
	gchªÃl
 !ğ
nuÎ
 && 
chªÃl
.
isO³n
()) {

371 
chªÃl
.
şo£
();

379 @
	gOv”ride


380 @
D•»ÿ‹d


381 
public
 
¡İ
(
boŞ—n
 
shutdown
) {

382 
¡İ
();

394 
	gpublic
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
£ndMes§geAndG‘Com¶‘abË
(
ChªÃlHªdËrCÚ‹xt
 
ùx
,

395 @
NÚNuÎ
 
CÜfuMsg
 
mes§ge
) {

399 
	gŒy
 {

400 
	gcÚÃùiÚFutu»


401 .
g‘
(
·¿m‘”s
.
g‘CÚÃùiÚTimeout
().
toMlis
(), 
TimeUn™
.
MILLISECONDS
);

402 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

403 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
e
);

404 } 
ÿtch
 (
TimeoutExû±iÚ
 
‹
) {

405 
	gCom¶‘abËFutu»
<
	gT
> 
	gf
 = 
Ãw
 
Com¶‘abËFutu»
<>();

406 
	gf
.
com¶‘eExû±iÚ®ly
(
‹
);

407  
	gf
;

408 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
“
) {

409 
	gCom¶‘abËFutu»
<
	gT
> 
	gf
 = 
Ãw
 
Com¶‘abËFutu»
<>();

410 
	gf
.
com¶‘eExû±iÚ®ly
(
“
.
g‘Cau£
());

411  
	gf
;

415 
fš®
 
Tim”
 
	groundTrMsgTim”
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
()

416 .
tim”
(
tim”NameCache
.
g‘
(
mes§ge
.
g‘MsgTy³
()));

418 
fš®
 
	gTim”
.
CÚ‹xt
 
	groundTrMsgCÚ‹xt
 = 
M‘ricsUts


419 .
g‘CÚd™iÚ®CÚ‹xt
(
roundTrMsgTim”
);

422 
fš®
 
	gthisReque¡
 = 
»que¡ID
.
g‘AndInüem’t
();

425 
	gmes§ge
.
£tCl›ÁID
(
·¿m‘”s
.
g‘Cl›ÁId
());

426 
	gmes§ge
.
£tReque¡ID
(
thisReque¡
);

429 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gcf
 = 
Ãw
 
Com¶‘abËFutu»
<>();

430 
	gout¡ªdšgReque¡s
.
put
(
thisReque¡
, 
cf
);

433 ià(
	gùx
 =ğ
nuÎ
) {

434 
chªÃl
.
wr™eAndFlush
(
mes§ge
, chªÃl.
voidPromi£
());

436 
	gùx
.
wr™eAndFlush
(
mes§ge
, 
ùx
.
voidPromi£
());

438 
	glog
.
Œaû
("S’ˆmes§ge: {}", 
mes§ge
);

441 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gcfB’chm¬ked
 = 
cf
.
th’Aµly
(
x
 -> {

442 
M‘ricsUts
.
¡İCÚd™iÚ®CÚ‹xt
(
roundTrMsgCÚ‹xt
);

443  
x
;

448 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gcfTimeout
 =

449 
CFUts
.
w™hš
(
cfB’chm¬ked
, 
Du¿tiÚ
.
ofMlis
(
timeoutRe¥Ú£
));

450 
	gcfTimeout
.
exû±iÚ®ly
(
e
 -> {

455 ià(
e
.
g‘Cau£
(è
š¡ªûof
 
TimeoutExû±iÚ
) {

456 
out¡ªdšgReque¡s
.
»move
(
thisReque¡
);

457 
log
.
debug
("sendMessageAndGetCompletable: Remove„equest {}o {} dueoimeout! Message:{}",

458 
thisReque¡
, 
node
, 
mes§ge
);

460  
nuÎ
;

462  
	gcfTimeout
;

471 
public
 
£ndMes§ge
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
mes§ge
) {

473 
fš®
 
	gthisReque¡
 = 
»que¡ID
.
g‘AndInüem’t
();

475 
	gmes§ge
.
£tCl›ÁID
(
·¿m‘”s
.
g‘Cl›ÁId
());

476 
	gmes§ge
.
£tReque¡ID
(
thisReque¡
);

478 
	gchªÃl
.
wr™eAndFlush
(
mes§ge
, 
chªÃl
.
voidPromi£
());

479 
	glog
.
Œaû
("S’ˆÚe-way mes§ge: {}", 
mes§ge
);

490 
public
 
£ndRe¥Ú£ToS”v”
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
šMsg
, CÜfuMsg 
outMsg
) {

491 
	goutMsg
.
cİyBa£F›lds
(
šMsg
);

492 
	gùx
.
wr™eAndFlush
(
outMsg
, 
ùx
.
voidPromi£
());

493 
	glog
.
Œaû
("S’ˆ»¥Ú£: {}", 
outMsg
);

503 
	gpublic
 <
	gT
> 
com¶‘eReque¡
(
»que¡Id
, 
T
 
com¶‘iÚ
) {

504 
	gCom¶‘abËFutu»
<
	gT
> 
	gcf
;

505 ià((
	gcf
 = (
Com¶‘abËFutu»
<
T
>è
out¡ªdšgReque¡s
.
»move
(
»que¡Id
)è!ğ
nuÎ
) {

506 
cf
.
com¶‘e
(
com¶‘iÚ
);

508 
	glog
.
w¬n
("A‰em±edØcom¶‘»que¡ {}, buˆ»que¡‚Ù out¡ªdšg!", 
»que¡Id
);

518 
public
 
com¶‘eExû±iÚ®ly
(
»que¡ID
, @
NÚnuÎ
 
ThrowabË
 
ÿu£
) {

519 
Com¶‘abËFutu»
 
	gcf
;

520 ià((
	gcf
 = 
out¡ªdšgReque¡s
.
»move
(
»que¡ID
)è!ğ
nuÎ
) {

521 
cf
.
com¶‘eExû±iÚ®ly
(
ÿu£
);

522 
	glog
.
debug
("com¶‘eExû±iÚ®ly: Remov»que¡ {}Ø{} dutØ{}.", 
»que¡ID
, 
node
,

523 
ÿu£
.
g‘CÏss
().
g‘Sim¶eName
(), cause);

525 
	glog
.
w¬n
("Attemptedoƒxceptionally complete„equest {}, but„equest‚ot outstanding!",

526 
»que¡ID
);

536 
´iv©e
 
boŞ—n
 
v®id©eCl›ÁId
(
CÜfuMsg
 
msg
) {

538 ià(!
	gmsg
.
g‘Cl›ÁID
().
equ®s
(
·¿m‘”s
.
g‘Cl›ÁId
())) {

539 
	glog
.
w¬n
("Incoming message intended for client {}, our id is {}, dropping!",

540 
msg
.
g‘Cl›ÁID
(), 
·¿m‘”s
.
g‘Cl›ÁId
());

541  
	gçl£
;

543  
	gŒue
;

546 @
Ov”ride


547 
´Ùeùed
 
chªÃlR—d0
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
m
è
throws
 
	gExû±iÚ
 {

548 
	gŒy
 {

550 
ICl›Á
 
	ghªdËr
 = 
hªdËrM­
.
g‘
(
m
.
g‘MsgTy³
());

551 ià(
	ghªdËr
 =ğ
nuÎ
) {

553 
log
.
w¬n
("Reûived uÄegi¡”ed mes§g{}, drİpšg", 
m
);

555 ià(
v®id©eCl›ÁId
(
m
)) {

557 ià(
	glog
.
isT¿ûEÇbËd
()) {

558 
	glog
.
Œaû
("Message„outedo {}: {}",

559 
hªdËr
.
g‘CÏss
().
g‘Sim¶eName
(), 
m
);

561 
	ghªdËr
.
hªdËMes§ge
(
m
, 
ùx
);

564 } 
ÿtch
 (
Exû±iÚ
 
e
) {

565 
	glog
.
”rÜ
("Exû±iÚ duršg„—d!", 
e
);

569 @
Ov”ride


570 
public
 
exû±iÚCaught
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ThrowabË
 
ÿu£
) {

571 
	glog
.
”rÜ
("Exû±iÚ duršg chªÃÈhªdlšg.", 
ÿu£
);

572 
	gùx
.
şo£
();

580 
´iv©e
 
k“pAlive
() {

581 ià(
	gchªÃl
 =ğ
nuÎ
 || !
chªÃl
.
isO³n
()) {

582 
log
.
šfo
("keepAlive: channel‚otƒstablished or‚ot open, skipping sending keep‡live.");

586 
£ndMes§geAndG‘Com¶‘abË
(
nuÎ
, 
CÜfuMsgTy³
.
KEEP_ALIVE
.
msg
());

587 
	glog
.
Œaû
("k“pAlive: s’ˆk“°®ivtØ{}", 
this
.
chªÃl
.
»mÙeAdd»ss
());

590 @
Ov”ride


591 
public
 
u£rEv’tTrigg”ed
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
Objeù
 
evt
è
throws
 
	gExû±iÚ
 {

592 ià(
	gevt
.
equ®s
(
Cl›ÁHªdshakeEv’t
.
CONNECTED
)) {

595 
	gchªÃl
 = 
ùx
.
chªÃl
();

596 
	gcÚÃùiÚFutu»
.
com¶‘e
(
nuÎ
);

597 } ià(
	gevt
.
equ®s
(
Cl›ÁHªdshakeEv’t
.
FAILED
è&& 
	gcÚÃùiÚFutu»
.
isDÚe
()) {

601 
	gcÚÃùiÚFutu»
 = 
Ãw
 
Com¶‘abËFutu»
<>();

602 } ià(
evt
 
š¡ªûof
 
	gIdËS‹Ev’t
) {

603 
IdËS‹Ev’t
 
	ge
 = (IdËS‹Ev’tè
evt
;

604 ià(
	ge
.
¡©e
(è=ğ
IdËS‹
.
READER_IDLE
) {

605 
ùx
.
şo£
();

606 } ià(
	ge
.
¡©e
(è=ğ
IdËS‹
.
WRITER_IDLE
) {

607 
k“pAlive
();

610 
	glog
.
w¬n
("u£rEv’tTrigg”ed: unhªdËdƒv’ˆ{}", 
evt
);

622 @
D•»ÿ‹d


623 
public
 
N‘tyCl›ÁRou‹r
(
SŒšg
 
’dpošt
) {

624 
this
(
’dpošt
.
¥l™
(":")[0], 
IÁeg”
.
·r£IÁ
(endpoint.split(":")[1]));

634 @
D•»ÿ‹d


635 
public
 
N‘tyCl›ÁRou‹r
(
SŒšg
 
ho¡
, 
IÁeg”
 
pÜt
) {

636 
this
(
NodeLoÿtÜ
.
bud”
().
ho¡
(ho¡).
pÜt
ÕÜt).
bud
(),

637 
RuÁimeP¬am‘”s
.
bud”
().
bud
());

647 @
D•»ÿ‹d


648 
public
 
N‘tyCl›ÁRou‹r
(
SŒšg
 
ho¡
, 
IÁeg”
 
pÜt
, 
BoŞ—n
 
s
,

649 
SŒšg
 
keyStÜe
, SŒšg 
ksPasswÜdFe
, SŒšg 
Œu¡StÜe
,

650 
SŒšg
 
tsPasswÜdFe
, 
BoŞ—n
 
§¦PÏšText
, SŒšg 
u£ºameFe
,

651 
SŒšg
 
·sswÜdFe
) {

652 
this
(
NodeLoÿtÜ
.
bud”
().
ho¡
(ho¡).
pÜt
ÕÜt).
bud
(),

653 
RuÁimeP¬am‘”s
.
bud”
()

654 .
sEÇbËd
(
s
)

655 .
keyStÜe
(keyStore)

656 .
ksPasswÜdFe
(ksPasswordFile)

657 .
Œu¡StÜe
(trustStore)

658 .
tsPasswÜdFe
(tsPasswordFile)

659 .
§¦PÏšTextEÇbËd
(
§¦PÏšText
)

660 .
u£ºameFe
(usernameFile)

661 .
·sswÜdFe
(passwordFile)

662 .
bud
());

665 
public
 
N‘tyCl›ÁRou‹r
(@
NÚnuÎ
 
NodeLoÿtÜ
 
node
,

666 @
NÚnuÎ
 
RuÁimeP¬am‘”s
 
·¿m‘”s
) {

667 
this
(
node
, 
·¿m‘”s
.
g‘Sock‘Ty³
()

668 .
g‘G’”©Ü
().
g’”©e
(
RuÁime
.
g‘RuÁime
().
avaabËProûssÜs
() * 2,

669 
Ãw
 
Th»adFaùÜyBud”
()

670 .
£tD«mÚ
(
Œue
)

671 .
£tNameFÜm©
(
·¿m‘”s
.
g‘N‘tyEv’tLoİTh»adFÜm©
())

672 .
bud
()), 
·¿m‘”s
);

675 @
	gD•»ÿ‹d


676 @
Ov”ride


677 
public
 
IÁeg”
 
g‘PÜt
() {

678  
	gnode
.
g‘PÜt
();

681 @
D•»ÿ‹d


682 
public
 
SŒšg
 
g‘Ho¡
() {

683  
	gnode
.
g‘Ho¡
();

	@runtime/src/main/java/org/corfudb/runtime/clients/SequencerClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrRecov”yMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—mAdd»ssRªge
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssReque¡
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Reque¡
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

26 
public
 cÏs 
	cSequ’ûrCl›Á
 
ex‹nds
 
	mAb¡¿ùCl›Á
 {

28 
public
 
	$Sequ’ûrCl›Á
(
ICl›ÁRou‹r
 
rou‹r
, 
•och
) {

29 
	`su³r
(
rou‹r
, 
•och
);

35 
public
 
Com¶‘abËFutu»
<
Sequ’ûrM‘rics
> 
	$»que¡M‘rics
() {

36  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
SEQUENCER_METRICS_REQUEST
.
	`msg
());

37 
	}
}

46 
public
 
	gCom¶‘abËFutu»
<
	gTok’Re¥Ú£
> 
ÃxtTok’
(
Li¡
<
UUID
> 
¡»amIDs
, 
numTok’s
) {

47  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
TOKEN_REQ
.
·ylßdMsg
(

48 
Ãw
 
Tok’Reque¡
(
numTok’s
, 
¡»amIDs
)));

57 
public
 
	gCom¶‘abËFutu»
<
	gSŒ—msAdd»ssRe¥Ú£
> 
g‘SŒ—msAdd»ssS·û
(
Li¡
<
SŒ—mAdd»ssRªge
> 
¡»amsAdd»s£sRªge
) {

58  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
STREAMS_ADDRESS_REQUEST
.
·ylßdMsg
(

59 
Ãw
 
SŒ—msAdd»ssReque¡
(
¡»amsAdd»s£sRªge
)));

70 
public
 
	gCom¶‘abËFutu»
<
	gTok’Re¥Ú£
> 
ÃxtTok’
(
Li¡
<
UUID
> 
¡»amIDs
, 
numTok’s
,

71 
TxResŞutiÚInfo
 
cÚæiùInfo
) {

72  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
TOKEN_REQ
.
·ylßdMsg
(

73 
Ãw
 
Tok’Reque¡
(
numTok’s
, 
¡»amIDs
, 
cÚæiùInfo
)));

76 
public
 
	gCom¶‘abËFutu»
<
	gVoid
> 
	$ŒimCache
(
LÚg
 
add»ss
) {

77  
	`£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
SEQUENCER_TRIM_REQ
.
	`·ylßdMsg
(
add»ss
));

78 
	}
}

91 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
boÙ¡¿p
(
LÚg
 
š™ŸlTok’
, 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amAdd»ssS·ûM­
,

92 
LÚg
 
»adyS‹Epoch
,

93 
boŞ—n
 
boÙ¡¿pW™houtTasUpd©e
) {

94  
£ndMes§geW™hFutu»
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
.
·ylßdMsg
(

95 
Ãw
 
Sequ’ûrRecov”yMsg
(
š™ŸlTok’
, 
¡»amAdd»ssS·ûM­
, 
»adyS‹Epoch
,

96 
boÙ¡¿pW™houtTasUpd©e
)));

108 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
boÙ¡¿p
(
LÚg
 
š™ŸlTok’
,

109 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amAdd»ssS·ûM­
,

110 
LÚg
 
»adyS‹Epoch
) {

111  
boÙ¡¿p
(
š™ŸlTok’
, 
¡»amAdd»ssS·ûM­
, 
»adyS‹Epoch
, 
çl£
);

	@runtime/src/main/java/org/corfudb/runtime/clients/SequencerHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gšvoke
.
	gM‘hodHªdËs
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

23 
public
 
şass
 
Sequ’ûrHªdËr
 
im¶em’ts
 
	gICl›Á
, 
	gIHªdËr
<
	gSequ’ûrCl›Á
> {

26 @
	gS‘‹r


27 @
G‘‹r


28 
ICl›ÁRou‹r
 
	grou‹r
;

30 @
Ov”ride


31 
public
 
Sequ’ûrCl›Á
 
g‘Cl›Á
(
•och
) {

32  
Ãw
 
Sequ’ûrCl›Á
(
rou‹r
, 
•och
);

38 @
G‘‹r


39 
public
 
Cl›ÁMsgHªdËr
 
	gmsgHªdËr
 = 
Ãw
 Cl›ÁMsgHªdËr(
this
)

40 .
g’”©eHªdËrs
(
M‘hodHªdËs
.
lookup
(), 
this
);

42 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
SEQUENCER_METRICS_RESPONSE
)

43 
´iv©e
 
Objeù
 
hªdËM‘ricsRe¥Ú£
(
CÜfuPaylßdMsg
<
Sequ’ûrM‘rics
> 
msg
,

44 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

45  
	gmsg
.
g‘Paylßd
();

48 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
TOKEN_RES
)

49 
´iv©e
 
Objeù
 
hªdËTok’Re¥Ú£
(
CÜfuPaylßdMsg
<
Tok’Re¥Ú£
> 
msg
,

50 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

51  
	gmsg
.
g‘Paylßd
();

54 @
Cl›ÁHªdËr
(
ty³
 = 
CÜfuMsgTy³
.
STREAMS_ADDRESS_RESPONSE
)

55 
´iv©e
 
Objeù
 
hªdËSŒ—mAdd»s£sRe¥Ú£
(
CÜfuPaylßdMsg
<
SŒ—msAdd»ssRe¥Ú£
> 
msg
,

56 
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
ICl›ÁRou‹r
 
r
) {

57  
	gmsg
.
g‘Paylßd
();

	@runtime/src/main/java/org/corfudb/runtime/collections/ContextAwareMap.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

12 
public
 
š‹rçû
 
	gCÚ‹xtAw¬eM­
<
	gK
, 
	gV
> 
ex‹nds
 
	gSŒ—mšgM­
<K, V>, 
	gAutoClo£abË
 {

23  
	gCÚ‹xtAw¬eM­
<
	gK
, 
	gV
> 
g‘O±imi¡icM­
() {

24  
	gthis
;

30  
şo£
() {

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuDynamicKey.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDyÇmicMes§ge
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

15 
public
 cÏs 
	cCÜfuDyÇmicKey
 {

20 @
G‘‹r


21 
´iv©e
 
fš®
 
SŒšg
 
	mkeyTy³U¾
;

26 
´iv©e
 
fš®
 
CÜfuDyÇmicMes§ge
 
	mkey
;

28 
public
 
	$CÜfuDyÇmicKey
(
SŒšg
 
keyTy³U¾
,

29 
DyÇmicMes§ge
 
key
) {

30 
this
.
keyTy³U¾
 = keyTypeUrl;

31 
this
.
key
 = 
Ãw
 
	`CÜfuDyÇmicMes§ge
(key);

34 
public
 
DyÇmicMes§ge
 
	$g‘Key
() {

35  
key
.
	`g‘Paylßd
();

36 
	}
}

38 @
Ov”ride


39 
public
 
	$hashCode
() {

40  
Objeùs
.
	`hash
(
keyTy³U¾
, 
key
);

41 
	}
}

43 @
Ov”ride


44 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

45 ià(!(
obj
 
š¡ªûof
 
CÜfuDyÇmicKey
)) {

46  
çl£
;

48 
CÜfuDyÇmicKey
 
cÜfuDyÇmicKey
 = (CÜfuDyÇmicKeyè
obj
;

49  
keyTy³U¾
.
	`equ®s
(
cÜfuDyÇmicKey
.keyTypeUrl)

50 && 
key
.
	`equ®s
(
cÜfuDyÇmicKey
.key);

52 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuDynamicMessage.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gF›ldDesütÜ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDyÇmicMes§ge
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

8 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

19 
public
 cÏs 
	cCÜfuDyÇmicMes§ge
 {

24 @
G‘‹r


25 
´iv©e
 
fš®
 
DyÇmicMes§ge
 
	m·ylßd
;

27 
CÜfuDyÇmicMes§ge
(@
NuÎabË
 
DyÇmicMes§ge
 
·ylßd
) {

28 
	mthis
.
	m·ylßd
 = 
·ylßd
;

36 @
Ov”ride


37 
public
 
	$hashCode
() {

39 ià(
·ylßd
 =ğ
nuÎ
) {

43 
Li¡
<
Objeù
> 
objeùsLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

44 
·ylßd
.
	`g‘AÎF›lds
().
	`fÜEach
((
key
, 
v®ue
) -> {

47 
objeùsLi¡
.
	`add
(
key
.
	`toPrÙo
());

48 
objeùsLi¡
.
	`add
(
v®ue
);

50 
Objeù
[] 
objeùs
 = 
objeùsLi¡
.
	`toA¼ay
();

51  
Objeùs
.
	`hash
(
objeùs
);

52 
	}
}

60 @
Ov”ride


61 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

63 ià(!(
obj
 
š¡ªûof
 
CÜfuDyÇmicMes§ge
)) {

64  
çl£
;

67 
CÜfuDyÇmicMes§ge
 
Ùh”
 = (CÜfuDyÇmicMes§geè
obj
;

69 ià(
·ylßd
 =ğ
nuÎ
 && 
Ùh”
.·ylßd =ğnuÎè 
Œue
;

70 ià(
·ylßd
 =ğ
nuÎ
 || 
Ùh”
.·ylßd =ğnuÎè 
çl£
;

72 ià(
·ylßd
.
	`g‘AÎF›lds
().
	`size
(è!ğ
Ùh”
.payload.getAllFields().size()) {

73  
çl£
;

79 
I‹¿tÜ
<
M­
.
EÁry
<
F›ldDesütÜ
, 
Objeù
>> 
thisMes§ge


80 ğ
Ãw
 
A¼ayLi¡
<>(
·ylßd
.
	`g‘AÎF›lds
().
	`’ŒyS‘
()).
	`™”©Ü
();

81 
I‹¿tÜ
<
M­
.
EÁry
<
F›ldDesütÜ
, 
Objeù
>> 
Ùh”Mes§ge


82 ğ
Ãw
 
A¼ayLi¡
<>(
Ùh”
.
·ylßd
.
	`g‘AÎF›lds
().
	`’ŒyS‘
()).
	`™”©Ü
();

84 
thisMes§ge
.
	`hasNext
()) {

85 ià(!
Ùh”Mes§ge
.
	`hasNext
()) {

86  
çl£
;

88 
M­
.
EÁry
<
F›ldDesütÜ
, 
Objeù
> 
’Œy1
 = 
thisMes§ge
.
	`Ãxt
();

89 
M­
.
EÁry
<
F›ldDesütÜ
, 
Objeù
> 
’Œy2
 = 
Ùh”Mes§ge
.
	`Ãxt
();

91 ià(!
’Œy1
.
	`g‘Key
().
	`toPrÙo
().
	`equ®s
(
’Œy2
.getKey().toProto())

92 || !
’Œy1
.
	`g‘V®ue
().
	`equ®s
(
’Œy2
.getValue())) {

93  
çl£
;

97  
Œue
;

98 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuDynamicRecord.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDyÇmicMes§ge
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

7 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

8 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

17 
public
 cÏs 
	cCÜfuDyÇmicRecÜd
 {

22 @
G‘‹r


23 
´iv©e
 
fš®
 
SŒšg
 
	m·ylßdTy³U¾
;

28 
public
 
fš®
 
CÜfuDyÇmicMes§ge
 
	m·ylßd
;

33 @
G‘‹r


34 
´iv©e
 
fš®
 
SŒšg
 
	mm‘ad©aTy³U¾
;

39 
public
 
fš®
 
CÜfuDyÇmicMes§ge
 
	mm‘ad©a
;

41 
public
 
CÜfuDyÇmicRecÜd
(@
NÚnuÎ
 
SŒšg
 
·ylßdTy³U¾
,

42 @
NÚnuÎ
 
DyÇmicMes§ge
 
·ylßd
,

43 @
NuÎabË
 
SŒšg
 
m‘ad©aTy³U¾
,

44 @
NuÎabË
 
DyÇmicMes§ge
 
m‘ad©a
) {

45 
	mthis
.
	m·ylßdTy³U¾
 = 
·ylßdTy³U¾
;

46 
	mthis
.
	m·ylßd
 = 
Ãw
 
CÜfuDyÇmicMes§ge
(
·ylßd
);

47 
	mthis
.
	mm‘ad©aTy³U¾
 = 
m‘ad©aTy³U¾
;

48 
	mthis
.
	mm‘ad©a
 = 
Ãw
 
CÜfuDyÇmicMes§ge
(
m‘ad©a
);

51 
public
 
DyÇmicMes§ge
 
	$g‘Paylßd
() {

52  
·ylßd
.
	`g‘Paylßd
();

53 
	}
}

55 
public
 
DyÇmicMes§ge
 
	$g‘M‘ad©a
() {

56  
m‘ad©a
.
	`g‘Paylßd
();

57 
	}
}

60 @
Ov”ride


61 
public
 
	$hashCode
() {

62  
Objeùs
.
	`hash
(
·ylßdTy³U¾
, 
·ylßd
, 
m‘ad©aTy³U¾
, 
m‘ad©a
);

63 
	}
}

65 @
Ov”ride


66 
public
 
boŞ—n
 
	$equ®s
(
Objeù
 
obj
) {

67 ià(!(
obj
 
š¡ªûof
 
CÜfuDyÇmicRecÜd
)) {

68  
çl£
;

70 
CÜfuDyÇmicRecÜd
 
cÜfuDyÇmicRecÜd
 = (CÜfuDyÇmicRecÜdè
obj
;

73 
boŞ—n
 
·ylßdM©ch
 = 
·ylßdTy³U¾
.
	`equ®s
(
cÜfuDyÇmicRecÜd
.payloadTypeUrl)

74 && 
·ylßd
.
	`equ®s
(
cÜfuDyÇmicRecÜd
.payload);

77 
boŞ—n
 
m‘ad©aM©ch
 = 
m‘ad©a
.
	`equ®s
(
cÜfuDyÇmicRecÜd
.metadata);

80 
boŞ—n
 
m‘ad©aTy³U¾M©ch
;

81 ià(
m‘ad©aTy³U¾
 =ğ
nuÎ
) {

82 
m‘ad©aTy³U¾M©ch
 = 
cÜfuDyÇmicRecÜd
.
m‘ad©aTy³U¾
 =ğ
nuÎ
;

84 
m‘ad©aTy³U¾M©ch
 = 
m‘ad©aTy³U¾
.
	`equ®s
(
cÜfuDyÇmicRecÜd
.metadataTypeUrl);

87  
·ylßdM©ch
 && 
m‘ad©aTy³U¾M©ch
 && 
m‘ad©aM©ch
;

88 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuQueue.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gCÜfuGuidG’”©Ü
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gLškedHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

18 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

36 @
Slf4j


37 
public
 
şass
 
	gCÜfuQueue
<
	gE
> {

41 
´iv©e
 
fš®
 
	gCÜfuTabË
<
	gLÚg
, 
	gE
> 
	gcÜfuTabË
;

42 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	gruÁime
;

43 
´iv©e
 
fš®
 
CÜfuGuidG’”©Ü
 
	gguidG’”©Ü
;

45 
public
 
CÜfuQueue
(
CÜfuRuÁime
 
ruÁime
, 
SŒšg
 
¡»amName
, 
IS”Ÿliz”
 
£rŸliz”
,

46 
Index
.
Regi¡ry
<
LÚg
, 
E
> 
šdiûs
) {

47 
fš®
 
	gSuµl›r
<
	gSŒ—mšgM­
<
	gLÚg
, 
	gE
>> 
	gm­Suµl›r
 =

48 (è-> 
Ãw
 
SŒ—mšgM­DecÜ©Ü
<>Òew 
LškedHashM­
<
LÚg
, 
	gE
>());

49 
	gthis
.
	gruÁime
 = 
ruÁime
;

50 
	gcÜfuTabË
 = 
ruÁime
.
g‘ObjeùsV›w
().
bud
()

51 .
£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
LÚg
, 
E
>>() {})

52 .
£tSŒ—mName
(
¡»amName
)

53 .
£tArgum’ts
(
šdiûs
, 
m­Suµl›r
)

54 .
£tS”Ÿliz”
(
£rŸliz”
)

55 .
İ’
();

56 
	gguidG’”©Ü
 = 
CÜfuGuidG’”©Ü
.
g‘In¡ªû
(
ruÁime
);

59 
public
 
CÜfuQueue
(
CÜfuRuÁime
 
ruÁime
, 
SŒšg
 
¡»amName
) {

60 
this
(
ruÁime
, 
¡»amName
, 
S”Ÿliz”s
.
g‘DeçuÉS”Ÿliz”
(), 
Index
.
Regi¡ry
.
em±y
());

67 
public
 
size
() {

68  
	gcÜfuTabË
.
size
();

77 
public
 
şass
 
CÜfuRecÜdId
 
im¶em’ts
 
	gCom·¿bË
<
	gCÜfuRecÜdId
> {

78 
´iv©e
 
fš®
 
UUID
 
	gid
;

79 
public
 
CÜfuRecÜdId
(
Üd”šg
, 
uniqueId
) {

80 
	gthis
.
	gid
 = 
Ãw
 
UUID
(
Üd”šg
, 
uniqueId
);

86 
public
 
g‘EÁryId
() {

87  
	gid
.
g‘L—¡SignifiÿÁB™s
();

93 
public
 
g‘Ord”šg
() {

94  
	gid
.
g‘Mo¡SignifiÿÁB™s
();

103 @
Ov”ride


104 
public
 
com·»To
(
CÜfuRecÜdId
 
o
) {

105 ià(
	gthis
.
	gid
.
g‘Mo¡SignifiÿÁB™s
(è=ğ0 && 
o
.
id
.getMostSignificantBits() != 0) {

106 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
(

109 ià(
	gthis
.
	gid
.
g‘Mo¡SignifiÿÁB™s
(è!=0 && 
o
.
id
.getMostSignificantBits() == 0) {

110 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
(

113 ià(
	gthis
.
	gid
.
g‘L—¡SignifiÿÁB™s
(è=ğ
o
.
id
.getLeastSignificantBits()) {

116  
	gid
.
com·»To
(
o
.
id
);

124 
public
 
boŞ—n
 
equ®s
(
CÜfuRecÜdId
 
o
) {

125  
	gid
.
g‘L—¡SignifiÿÁB™s
(è=ğ
o
.
id
.getLeastSignificantBits();

128 
public
 
SŒšg
 
toSŒšg
() {

129  
	gid
.
toSŒšg
();

151 
public
 
CÜfuRecÜdId
 
’queue
(
E
 
e
) {

152 
fš®
 
LÚg
 
	gid
 = 
guidG’”©Ü
.
ÃxtLÚg
();

153 
	gcÜfuTabË
.
put
(
id
, 
e
);

154  
Ãw
 
CÜfuRecÜdId
(0, 
id
);

165 
public
 
şass
 
	gCÜfuQueueRecÜd
<
	gE
> 
im¶em’ts
 
	gCom·¿bË
<CÜfuQueueRecÜd<? 
ex‹nds
 E>> {

173 @
G‘‹r


174 
´iv©e
 
fš®
 
CÜfuRecÜdId
 
	g»cÜdId
;

176 @
G‘‹r


177 
´iv©e
 
fš®
 
E
 
	g’Œy
;

179 
public
 
SŒšg
 
toSŒšg
() {

180  
	gSŒšg
.
fÜm©
("%s=>%s", 
»cÜdId
, 
’Œy
);

183 
CÜfuQueueRecÜd
(
Üd”šg
, 
’ŒyId
, 
E
 
’Œy
) {

184 
	gthis
.
	g»cÜdId
 = 
Ãw
 
CÜfuRecÜdId
(
Üd”šg
, 
’ŒyId
);

185 
	gthis
.
	g’Œy
 = 
’Œy
;

188 @
Ov”ride


189 
public
 
com·»To
(
CÜfuQueueRecÜd
<? 
ex‹nds
 
E
> 
o
) {

190  
	gthis
.
	g»cÜdId
.
com·»To
(
o
.
g‘RecÜdId
());

199 
fš®
 
´iv©e
 
	gMAX_BITS_FOR_INDEX
 = 24;

200 
fš®
 
´iv©e
 
	gMAX_INDEX_ENTRIES
 = (1<<
MAX_BITS_FOR_INDEX
) - 1;

233 
public
 
	gLi¡
<
	gCÜfuQueueRecÜd
<
	gE
>> 
’ŒyLi¡
(
maxEÁr›s
) {

234 ià(
	gmaxEÁr›s
 <= 0) {

235 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("entryList given‚egative maxEntries");

237 ià(
	gmaxEÁr›s
 > 
	gMAX_INDEX_ENTRIES
) {

238 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
(

239 "’ŒyLi¡ cª'ˆ»tuº mÜthª "+
MAX_INDEX_ENTRIES
+"ƒntries"

244 
	g¢­shÙV”siÚ
;

245 
boŞ—n
 
	g¡¬‹dNewT¿n§ùiÚ
 = 
çl£
;

246 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
()) {

247 
	g¢­shÙV”siÚ
 = 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
()

248 .
g‘SÇpshÙTime¡amp
().
g‘Sequ’û
();

250 
	gruÁime
.
g‘ObjeùsV›w
().
TXBud
().
ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
)

251 .
bud
()

252 .
begš
();

253 
	g¢­shÙV”siÚ
 = 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
()

254 .
g‘SÇpshÙTime¡amp
().
g‘Sequ’û
();

255 
	g¡¬‹dNewT¿n§ùiÚ
 = 
Œue
;

257 
	gLi¡
<
	gCÜfuQueueRecÜd
<
	gE
>> 
	gcİy
 = 
Ãw
 
A¼ayLi¡
<>(

258 
M©h
.
mš
(
cÜfuTabË
.
size
(), 
maxEÁr›s
)

260 
	gšdex
 = 0;

261 
	gM­
.
	gEÁry
<
	gLÚg
, 
	gE
> 
	g’Œy
 : 
cÜfuTabË
.
’ŒyS‘
()) {

262 ià(++
šdex
 >ğ
maxEÁr›s
) {

266 
	gÜd”šg
 = (
¢­shÙV”siÚ
 << 
MAX_BITS_FOR_INDEX
è| 
šdex
;

267 
	g’ŒyId
 = 
’Œy
.
g‘Key
();

268 
	gCÜfuQueueRecÜd
<
	gE
> 
	g»cÜd
 = 
Ãw
 
CÜfuQueueRecÜd
<>(

269 
Üd”šg
, 
	g’ŒyId
, 
	g’Œy
.
g‘V®ue
()

271 
	gcİy
.
add
(
»cÜd
);

274 ià(
	g¡¬‹dNewT¿n§ùiÚ
) {

275 
	gruÁime
.
g‘ObjeùsV›w
().
TXEnd
();

277  
	gcİy
;

283 
public
 
	gLi¡
<
	gCÜfuQueueRecÜd
<
	gE
>> 
’ŒyLi¡
() {

284  
	gthis
.
’ŒyLi¡
(
MAX_INDEX_ENTRIES
);

287 
public
 
boŞ—n
 
isEm±y
() {

288  
	gcÜfuTabË
.
isEm±y
();

291 
public
 
boŞ—n
 
cÚšsKey
(
CÜfuRecÜdId
 
key
) {

292  
	gcÜfuTabË
.
cÚšsKey
(
key
.
id
.
g‘L—¡SignifiÿÁB™s
());

300 
public
 
E
 
g‘
(
CÜfuRecÜdId
 
key
) {

301  
	gcÜfuTabË
.
g‘
(
key
.
id
.
g‘L—¡SignifiÿÁB™s
());

309 
public
 
E
 
»moveEÁry
(
CÜfuRecÜdId
 
’ŒyId
) {

310  
	gcÜfuTabË
.
»move
(
’ŒyId
.
id
.
g‘L—¡SignifiÿÁB™s
());

316 
public
 
ş—r
() {

317 
	gcÜfuTabË
.
ş—r
();

320 
public
 
hashCode
() {

321  
	gObjeùs
.
hash
(
this
);

324 
public
 
boŞ—n
 
equ®s
(
Objeù
 
o
){

325  
	go
.
hashCode
(è=ğ
Objeùs
.
hash
(
this
);

328 
public
 
SŒšg
 
toSŒšg
(){

329 
SŒšgBud”
 
	g¡ršgBud”
 = 
Ãw
 SŒšgBud”(
cÜfuTabË
.
size
());

330 
	g¡ršgBud”
.
­³nd
("{");

331 
	gM­
.
	gEÁry
<
	gLÚg
, 
	gE
> 
	g’Œy
 : 
cÜfuTabË
.
’ŒyS‘
()) {

332 
¡ršgBud”
.
­³nd
(
’Œy
.
toSŒšg
()).append(", ");

334 
	g¡ršgBud”
.
­³nd
("}");

335  
	g¡ršgBud”
.
toSŒšg
();

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuRecord.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

5 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

17 @
Equ®sAndHashCode


18 
public
 
şass
 
	gCÜfuRecÜd
<
V
 
ex‹nds
 
	gMes§ge
, 
M
ƒxtends Message> {

22 @
G‘‹r


23 
´iv©e
 
fš®
 
V
 
	g·ylßd
;

29 @
G‘‹r


30 
´iv©e
 
fš®
 
M
 
	gm‘ad©a
;

32 
public
 
CÜfuRecÜd
(
V
 
·ylßd
, 
M
 
m‘ad©a
) {

33 
	gthis
.
	g·ylßd
 = 
·ylßd
;

34 
	gthis
.
	gm‘ad©a
 = 
m‘ad©a
;

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuStore.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

5 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

10 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
;

30 
public
 cÏs 
	cCÜfuStÜe
 {

32 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

37 
´iv©e
 
fš®
 
TxnSŒ—mšgMªag”
 
	mtxnSŒ—mšgMªag”
;

44 @
NÚnuÎ


45 
public
 
CÜfuStÜe
(@
NÚnuÎ
 
fš®
 
CÜfuRuÁime
 
ruÁime
) {

46 
	mruÁime
.
£tT¿n§ùiÚLoggšg
(
Œue
);

47 
	mthis
.
	mruÁime
 = 
ruÁime
;

48 
	mthis
.
	mtxnSŒ—mšgMªag”
 = 
Ãw
 
TxnSŒ—mšgMªag”
(
ruÁime
);

56 @
NÚnuÎ


57 
public
 
Time¡amp
 
	$g‘Time¡amp
() {

58 
Tok’
 
tok’
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Tok’
();

59  
Time¡amp
.
	`ÃwBud”
()

60 .
	`£tEpoch
(
tok’
.
	`g‘Epoch
())

61 .
	`£tSequ’û
(
tok’
.
	`g‘Sequ’û
())

62 .
	`bud
();

63 
	}
}

83 @
NÚnuÎ


84 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

85 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
İ’TabË
(@
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
,

86 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

87 @
NÚnuÎ
 
fš®
 
CÏss
<
K
> 
kCÏss
,

88 @
NÚnuÎ
 
fš®
 
CÏss
<
V
> 
vCÏss
,

89 @
NuÎabË
 
fš®
 
CÏss
<
M
> 
mCÏss
,

90 @
NÚnuÎ
 
fš®
 
TabËO±iÚs
 
bËO±iÚs
)

91 
throws
 
	gNoSuchM‘hodExû±iÚ
, 
	gInvoÿtiÚT¬g‘Exû±iÚ
, 
	gIÎeg®AcûssExû±iÚ
 {

93  
	gruÁime
.
g‘TabËRegi¡ry
().
İ’TabË
(
Çme¥aû
, 
bËName
, 
kCÏss
, 
vCÏss
, 
mCÏss
, 
bËO±iÚs
);

104 @
NÚnuÎ


105 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

106 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
İ’TabË
(@
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
,

107 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
) {

108  
	gruÁime
.
g‘TabËRegi¡ry
().
g‘TabË
(
Çme¥aû
, 
bËName
);

117 
´iv©e
 
	$d–‘eTabË
(
SŒšg
 
Çme¥aû
, SŒšg 
bËName
) {

118 
ruÁime
.
	`g‘TabËRegi¡ry
().
	`d–‘eTabË
(
Çme¥aû
, 
bËName
);

119 
	}
}

128 @
NÚnuÎ


129 
public
 
	gCŞËùiÚ
<
	gTabËName
> 
li¡TabËs
(@
NuÎabË
 
fš®
 
SŒšg
 
Çme¥aû
) {

130  
	gruÁime
.
g‘TabËRegi¡ry
().
li¡TabËs
(
Çme¥aû
);

141 @
NÚnuÎ


142 
public
 
TxBud”
 
tx
(@
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
) {

143  
Ãw
 
TxBud”
(

144 
this
.
ruÁime
.
g‘ObjeùsV›w
(),

145 
this
.
ruÁime
.
g‘TabËRegi¡ry
(),

146 
Çme¥aû
);

155 @
NÚnuÎ


156 
public
 
Qu”y
 
qu”y
(@
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
) {

157  
Ãw
 
Qu”y
(

158 
this
.
ruÁime
.
g‘TabËRegi¡ry
(),

159 
this
.
ruÁime
.
g‘ObjeùsV›w
(),

160 
Çme¥aû
);

172 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

173 
subsüibe
(@
NÚnuÎ
 
SŒ—mLi¡’”
 
¡»amLi¡’”
, @NÚnuÎ 
SŒšg
 
Çme¥aû
,

174 @
NÚnuÎ
 
Li¡
<
TabËSchema
> 
bËsOfIÁ”e¡
,

175 @
NuÎabË
 
Time¡amp
 
time¡amp
) {

176 
	gtxnSŒ—mšgMªag”
.
subsüibe
(
¡»amLi¡’”
, 
Çme¥aû
, 
bËsOfIÁ”e¡
,

177 (
time¡amp
 =ğ
nuÎ
è? 
g‘Time¡amp
().
g‘Sequ’û
() :imestamp.getSequence());

185 
public
 
unsubsüibe
(@
NÚnuÎ
 
SŒ—mLi¡’”
 
¡»amLi¡’”
) {

186 
	gtxnSŒ—mšgMªag”
.
unsubsüibe
(
¡»amLi¡’”
);

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuStoreEntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

4 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

12 @
Equ®sAndHashCode


13 
public
 
şass
 
	gCÜfuStÜeEÁry
<
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message> {

18 @
G‘‹r


19 
´iv©e
 
fš®
 
K
 
	gkey
;

24 @
G‘‹r


25 
´iv©e
 
fš®
 
V
 
	g·ylßd
;

30 @
G‘‹r


31 
´iv©e
 
fš®
 
M
 
	gm‘ad©a
;

33 
public
 
CÜfuStÜeEÁry
(
K
 
key
, 
V
 
·ylßd
, 
M
 
m‘ad©a
) {

34 
	gthis
.
	gkey
 = 
key
;

35 
	gthis
.
	g·ylßd
 = 
·ylßd
;

36 
	gthis
.
	gm‘ad©a
 = 
m‘ad©a
;

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuStreamEntries.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

16 
public
 cÏs 
	cCÜfuSŒ—mEÁr›s
 {

17 @
G‘‹r


18 
´iv©e
 
fš®
 
	mM­
<
	mTabËSchema
, 
	mLi¡
<
	mCÜfuSŒ—mEÁry
>> 
	m’Œ›s
;

20 
public
 
CÜfuSŒ—mEÁr›s
(
M­
<
TabËSchema
, 
Li¡
<
CÜfuSŒ—mEÁry
>> 
’Œ›s
) {

21 
	mthis
.
	m’Œ›s
 = 
’Œ›s
;

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuStreamEntry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

8 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

23 @
Slf4j


24 
public
 
şass
 
	gCÜfuSŒ—mEÁry
<
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message> {

28 @
G‘‹r


29 
´iv©e
 
fš®
 
K
 
	gkey
;

34 @
G‘‹r


35 
´iv©e
 
fš®
 
V
 
	g·ylßd
;

40 @
G‘‹r


41 
´iv©e
 
fš®
 
M
 
	gm‘ad©a
;

46 
public
 
	eO³¿tiÚTy³
 {

47 
	gUPDATE
,

48 
	gDELETE
,

49 
	gCLEAR
;

52 @
G‘‹r


53 
´iv©e
 
fš®
 
O³¿tiÚTy³
 
	gİ”©iÚ
;

57 @
G‘‹r


58 
´iv©e
 
fš®
 
	g•och
;

62 @
G‘‹r


63 
´iv©e
 
fš®
 
	gadd»ss
;

65 
public
 
CÜfuSŒ—mEÁry
(
K
 
key
, 
V
 
·ylßd
, 
M
 
m‘ad©a
, 
•och
, 
add»ss
, 
O³¿tiÚTy³
 
İ”©iÚ
) {

66 
	gthis
.
	gkey
 = 
key
;

67 
	gthis
.
	g·ylßd
 = 
·ylßd
;

68 
	gthis
.
	gm‘ad©a
 = 
m‘ad©a
;

69 
	gthis
.
	g•och
 = 
•och
;

70 
	gthis
.
	gadd»ss
 = 
add»ss
;

71 
	gthis
.
	gİ”©iÚ
 = 
İ”©iÚ
;

77 
public
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

78 
	gCÜfuSŒ—mEÁry
<
	gK
, 
	gV
, 
	gM
> 
äomSMREÁry
(
SMREÁry
 
’Œy
, @
NÚnuÎ
 
fš®
 
•och
,

79 @
NÚnuÎ
 
fš®
 
CÏss
<
K
> 
keyCÏss
,

80 @
NÚnuÎ
 
fš®
 
CÏss
<
V
> 
·ylßdCÏss
,

81 @
NuÎabË
 
fš®
 
CÏss
<
M
> 
m‘ad©aCÏss
) {

83 
	gadd»ss
 = 
’Œy
.
g‘Glob®Add»ss
();

85 
O³¿tiÚTy³
 
	gİ”©iÚTy³
;

86 
	glog
.
Œaû
("äomSRMEÁry: TabË {} sŒ—m” gÙ SMR {}", 
keyCÏss
.
g‘Name
(), 
’Œy
.
g‘SMRM‘hod
());

87 
	g’Œy
.
g‘SMRM‘hod
()) {

90 
İ”©iÚTy³
 = 
O³¿tiÚTy³
.
UPDATE
;

93 
İ”©iÚTy³
 = 
O³¿tiÚTy³
.
CLEAR
;

96 
İ”©iÚTy³
 = 
O³¿tiÚTy³
.
DELETE
;

99 
throw
 
Ãw
 
RuÁimeExû±iÚ
("SMRM‘hod "+
’Œy
.
g‘SMRM‘hod
()

103 
	gObjeù
[] 
	g¬gs
 = 
’Œy
.
g‘SMRArgum’ts
();

105 
	glog
.
Œaû
("Converting SMREntry‡t‡ddress {}o CorfuStreamEntry: Operation: {} Length of‡rguments: {}. " +

107 
add»ss
, 
İ”©iÚTy³
, 
¬gs
.
Ëngth
, 
keyCÏss
.
g‘CªÚiÿlName
(), 
·ylßdCÏss
.getCanonicalName(),

108 (
m‘ad©aCÏss
 !ğ
nuÎ
è? m‘ad©aCÏss.
g‘CªÚiÿlName
() : "null");

110 
K
 
	gkey
 = 
nuÎ
;

111 
V
 
	g·ylßd
 = 
nuÎ
;

112 
M
 
	gm‘ad©a
 = 
nuÎ
;

113 ià(
	g¬gs
.
	gËngth
 > 0) {

114 
	gkey
 = (
K
è
¬gs
[0];

115 ià(
	g¬gs
.
	gËngth
 > 1) {

116 
CÜfuRecÜd
 
	g»cÜd
 = (CÜfuRecÜdè
¬gs
[1];

117 
	g·ylßd
 = (
V
è
»cÜd
.
g‘Paylßd
();

118 
	gm‘ad©a
 = (
M
è
»cÜd
.
g‘M‘ad©a
();

122  
Ãw
 
	gCÜfuSŒ—mEÁry
<
	gK
, 
	gV
, 
	gM
>(
	gkey
, 
	g·ylßd
, 
	gm‘ad©a
, 
	g•och
, 
	gadd»ss
, 
	gİ”©iÚTy³
);

	@runtime/src/main/java/org/corfudb/runtime/collections/CorfuTable.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÚæiùP¬am‘”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gDÚtIn¡rum’t
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gT¿n§ùiÚ®M‘hod
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuV”siÚPŞicy
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gImmubËLi¡S‘W¿µ”
;

20 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

21 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

24 
impÜt
 
	gjava
.
	gut
.
	gCÚcu¼’tModifiÿtiÚExû±iÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

27 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

28 
impÜt
 
	gjava
.
	gut
.
	gM­
;

29 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

30 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFÜkJošPoŞ
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFÜkJošWÜk”Th»ad
;

33 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiCÚsum”
;

34 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

36 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

37 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

38 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

39 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

58 @
	gSlf4j


59 @
CÜfuObjeù


60 
public
 
şass
 
	gCÜfuTabË
<
	gK
, 
	gV
> 
im¶em’ts


61 
	gICÜfuTabË
<
	gK
, 
	gV
>, 
	gICÜfuSMR
<
	gCÜfuTabË
<K, V>> {

70 
´iv©e
 
fš®
 
FÜkJošPoŞ
 
	gpoŞ
 = 
Ãw
 FÜkJošPoŞ(
RuÁime
.
g‘RuÁime
().
avaabËProûssÜs
() - 1,

71 
poŞ
 -> {

72 
fš®
 
FÜkJošWÜk”Th»ad
 
wÜk”
 = 
FÜkJošPoŞ
.
deçuÉFÜkJošWÜk”Th»adFaùÜy
.
ÃwTh»ad
(
poŞ
);

73 
wÜk”
.
£tName
("CÜfuTabË-FÜkjoš-poŞ-" + wÜk”.
g‘PoŞIndex
());

74  
wÜk”
;

75 }, 
nuÎ
, 
Œue
);

78 
´iv©e
 
fš®
 
	gCÚ‹xtAw¬eM­
<
	gK
, 
	gV
> 
	gmašM­
;

79 
´iv©e
 
fš®
 
	gS‘
<
	gIndex
.
	gS³c
<
	gK
, 
	gV
, ? 
ex‹nds
 
	gCom·¿bË
>> 
	gšdexS³c
;

80 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, M­<
	gCom·¿bË
, M­<
	gK
, 
	gV
>>> 
	g£cÚd¬yIndexes
;

81 
´iv©e
 
fš®
 
	gCÜfuTabË
<
	gK
, 
	gV
> 
	gİtimi¡icTabË
;

82 
´iv©e
 
fš®
 
V”siÚPŞicy
 
	gv”siÚPŞicy
;

84 
public
 
CÜfuTabË
(
CÚ‹xtAw¬eM­
<
K
, 
V
> 
mašM­
,

85 
S‘
<
Index
.
S³c
<
K
, 
V
, ? 
ex‹nds
 
Com·¿bË
>> 
šdexS³c
,

86 
M­
<
SŒšg
, M­<
Com·¿bË
, M­<
K
, 
V
>>> 
£cÚd¬yIndexe
,

87 
CÜfuTabË
<
K
, 
V
> 
İtimi¡icTabË
) {

88 
	gthis
.
	gmašM­
 = 
mašM­
;

89 
	gthis
.
	gšdexS³c
 = 
šdexS³c
;

90 
	gthis
.
	g£cÚd¬yIndexes
 = 
£cÚd¬yIndexe
;

91 
	gthis
.
	gİtimi¡icTabË
 = 
İtimi¡icTabË
;

92 
	gthis
.
	gv”siÚPŞicy
 = 
ICÜfuV”siÚPŞicy
.
DEFAULT
;

100 
public
 
CÜfuTabË
(
Index
.
Regi¡ry
<
K
, 
V
> 
šdiûs
,

101 
Suµl›r
<
CÚ‹xtAw¬eM­
<
K
, 
V
>> 
¡»amšgM­Suµl›r
,

102 
V”siÚPŞicy
 
v”siÚPŞicy
) {

103 
	gthis
.
	gšdexS³c
 = 
Ãw
 
HashS‘
<>();

104 
	gthis
.
	g£cÚd¬yIndexes
 = 
Ãw
 
HashM­
<>();

105 
	gthis
.
	gmašM­
 = 
¡»amšgM­Suµl›r
.
g‘
();

106 
	gthis
.
	gv”siÚPŞicy
 = 
v”siÚPŞicy
;

108 
	gthis
.
	gİtimi¡icTabË
 = 
Ãw
 
CÜfuTabË
<>(
this
.
mašM­
.
g‘O±imi¡icM­
(),his.
	gšdexS³c
,

109 
	gthis
.
	g£cÚd¬yIndexes
, 
	gnuÎ
);

111 
	gšdiûs
.
fÜEach
(
šdex
 -> {

112 
£cÚd¬yIndexes
.
put
(
šdex
.
g‘Name
().
g‘
(), 
Ãw
 
HashM­
<>());

113 
šdexS³c
.
add
(
šdex
);

116 ià(!
	g£cÚd¬yIndexes
.
isEm±y
()) {

117 
	glog
.
šfo
(

119 
£cÚd¬yIndexes
.
keyS‘
()

128 
public
 
CÜfuTabË
(
Index
.
Regi¡ry
<
K
, 
V
> 
šdiûs
,

129 
Suµl›r
<
CÚ‹xtAw¬eM­
<
K
, 
V
>> 
¡»amšgM­Suµl›r
) {

130 
this
(
šdiûs
, 
¡»amšgM­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
DEFAULT
);

137 
public
 
CÜfuTabË
(
Suµl›r
<
CÚ‹xtAw¬eM­
<
K
, 
V
>> 
¡»amšgM­Suµl›r
,

138 
V”siÚPŞicy
 
v”siÚPŞicy
) {

139 
this
(
Index
.
Regi¡ry
.
em±y
(), 
¡»amšgM­Suµl›r
, 
v”siÚPŞicy
);

145 
public
 
CÜfuTabË
(
Index
.
Regi¡ry
<
K
, 
V
> 
šdexRegi¡ry
) {

146 
this
(
šdexRegi¡ry
, (è-> 
Ãw
 
SŒ—mšgM­DecÜ©Ü
<>Òew 
HashM­
<>()),

147 
ICÜfuV”siÚPŞicy
.
DEFAULT
);

153 
public
 
CÜfuTabË
() {

154 
this
(
Index
.
Regi¡ry
.
em±y
());

163 <
	gK
, 
	gV
> 
	gTy³Tok’
<
	gCÜfuTabË
<K, V>> 
g‘M­Ty³
() {

164  
Ãw
 
	gTy³Tok’
<
	gCÜfuTabË
<
	gK
, 
	gV
>>() {};

173 <
	gK
, 
	gV
> 
	gTy³Tok’
<
	gCÜfuTabË
<K, V>> 
g‘TabËTy³
() {

174  
Ãw
 
	gTy³Tok’
<
	gCÜfuTabË
<
	gK
, 
	gV
>>() {};

178 @
	gOv”ride


179 @
AcûssÜ


180 
public
 
size
() {

181  
	gmašM­
.
size
();

185 @
	gOv”ride


186 @
AcûssÜ


187 
public
 
boŞ—n
 
isEm±y
() {

188  
	gmašM­
.
isEm±y
();

195 @
AcûssÜ


196 
public
 
boŞ—n
 
hasSecÚd¬yIndiûs
() {

197  !
	g£cÚd¬yIndexes
.
isEm±y
();

201 @
	gOv”ride


202 @
AcûssÜ


203 
public
 
boŞ—n
 
cÚšsKey
(@
CÚæiùP¬am‘”
 
Objeù
 
key
) {

204  
	gmašM­
.
cÚšsKey
(
key
);

208 @
	gOv”ride


209 @
AcûssÜ


210 
public
 
boŞ—n
 
cÚšsV®ue
(
Objeù
 
v®ue
) {

211  
	gmašM­
.
cÚšsV®ue
(
v®ue
);

215 @
	gOv”ride


216 @
AcûssÜ


217 
public
 
V
 
g‘
(@
CÚæiùP¬am‘”
 
Objeù
 
key
) {

218  
	gmašM­
.
g‘
(
key
);

228 @
Suµ»ssW¬nšgs
("unchecked")

229 @
AcûssÜ


230 
	gpublic
 @
	gNÚnuÎ


231 <
I
 
ex‹nds
 
	gCom·¿bË
<
	gI
>>

232 
	gCŞËùiÚ
<
	gEÁry
<
	gK
, 
	gV
>> 
g‘ByIndex
(@
NÚnuÎ
 
Index
.
Name
 
šdexName
, 
I
 
šdexKey
) {

233 
SŒšg
 
	g£cÚd¬yIndex
 = 
šdexName
.
g‘
();

234 
	gM­
<
	gCom·¿bË
, M­<
	gK
, 
	gV
>> 
	g£cÚd¬yM­
;

235 ià(
	g£cÚd¬yIndexes
.
cÚšsKey
(
£cÚd¬yIndex
) &&

236 ((
	g£cÚd¬yM­
 = 
£cÚd¬yIndexes
.
g‘
(
£cÚd¬yIndex
)è!ğ
nuÎ
)) {

238 
M­
<
K
, 
V
> 
»s
 = 
£cÚd¬yM­
.
g‘
(
šdexKey
);

240  
	g»s
 =ğ
nuÎ
 ?

241 
CŞËùiÚs
.
em±yS‘
() :

242 
Ãw
 
HashS‘
<>(
»s
.
’ŒyS‘
());

246 
	glog
.
”rÜ
("CÜfuTabË: secÚd¬y index " + 
£cÚd¬yIndex
 + " does‚otƒxist forhisable, cannot completehe get by index.");

247 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("SecÚd¬y Index " + 
£cÚd¬yIndex
 + " is‚ot defined.");

258 @
AcûssÜ


259 
	gpublic
 @
	gNÚnuÎ


260 <
I
 
ex‹nds
 
	gCom·¿bË
<
	gI
>>

261 
	gCŞËùiÚ
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
g‘ByIndexAndF‹r
(@
NÚnuÎ
 
Index
.
Name
 
šdexName
,

262 @
NÚnuÎ
 
P»diÿ‹
<? 
su³r
 
EÁry
<
K
, 
V
>>

263 
’ŒyP»diÿ‹
,

264 
I
 
šdexKey
) {

265 
	gSŒ—m
<
	gEÁry
<
	gK
, 
	gV
>> 
	g’ŒySŒ—m
;

266 
SŒšg
 
	g£cÚd¬yIndex
 = 
šdexName
.
g‘
();

267 
	gM­
<
	gCom·¿bË
, M­<
	gK
, 
	gV
>> 
	g£cÚd¬yM­
;

269 ià(
	g£cÚd¬yIndexes
.
cÚšsKey
(
£cÚd¬yIndex
) &&

270 ((
	g£cÚd¬yM­
 = 
£cÚd¬yIndexes
.
g‘
(
£cÚd¬yIndex
)è!ğ
nuÎ
)) {

271 ià(
£cÚd¬yM­
.
g‘
(
šdexKey
è=ğ
nuÎ
) {

272 
’ŒySŒ—m
 = 
SŒ—m
.
em±y
();

274 
	g’ŒySŒ—m
 = 
£cÚd¬yM­
.
g‘
(
šdexKey
).
’ŒyS‘
().
¡»am
();

277  
	g’ŒySŒ—m
.
f‹r
(
’ŒyP»diÿ‹
).
cŞËù
(
CŞËùÜs
.
toCŞËùiÚ
(
A¼ayLi¡
::
Ãw
));

281 
	glog
.
”rÜ
("CÜfuTabË: secÚd¬y index " + 
£cÚd¬yIndex
 + " does‚otƒxist forhisable, cannot completehe get by index‡nd filter.");

282 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("SecÚd¬y Index " + 
£cÚd¬yIndex
 + " is‚ot defined.");

286 @
	gOv”ride


287 @
MutÜAcûssÜ
(
Çme
 = "put", 
undoFunùiÚ
 = "undoPut", 
undoRecÜdFunùiÚ
 = "undoPutRecord")

288 
public
 
V
 
put
(@
CÚæiùP¬am‘”
 
K
 
key
, V 
v®ue
) {

289 
V
 
	g´evious
 = 
mašM­
.
put
(
key
, 
v®ue
);

291 ià(!
	g£cÚd¬yIndexes
.
isEm±y
()) {

292 
unm­SecÚd¬yIndexes
(
key
, 
´evious
);

293 
m­SecÚd¬yIndexes
(
key
, 
v®ue
);

295  
	g´evious
;

298 @
DÚtIn¡rum’t


299 
´Ùeùed
 
V
 
undoPutRecÜd
(
CÜfuTabË
<
K
, V> 
bË
, K 
key
, V 
v®ue
) {

300  
	gbË
.
	gmašM­
.
g‘
(
key
);

303 @
DÚtIn¡rum’t


304 
´Ùeùed
 
undoPut
(
CÜfuTabË
<
K
, 
V
> 
bË
, V 
undoRecÜd
, K 
key
, V 
v®ue
) {

306 
undoRemove
(
bË
, 
undoRecÜd
, 
key
);

309 @
DÚtIn¡rum’t


310 
	gObjeù
[] 
putAÎCÚæiùFunùiÚ
(
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m
) {

311  
	gm
.
keyS‘
().
¡»am
()

312 .
m­
(
Objeù
::
hashCode
)

313 .
toA¼ay
(
Objeù
[]::
Ãw
);

316 
	eUndoNuÎabË
 {

317 
	gNULL
;

328 @
	gDÚtIn¡rum’t


329 @
Suµ»ssW¬nšgs
("unchecked")

330 
	gM­
<
	gK
, 
	gV
> 
undoPutAÎRecÜd
(
CÜfuTabË
<
K
, 
V
> 
´eviousS‹
,

331 
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m
) {

332 
	gImmubËM­
.
	gBud”
<
	gK
, 
	gV
> 
	gbud”
 = 
ImmubËM­
.
bud”
();

333 
	gm
.
keyS‘
().
fÜEach
(
k
 -> 
bud”
.
put
(k,

334 (
´eviousS‹
.
g‘
(
k
è=ğ
nuÎ


335 ? (
V
è
CÜfuTabË
.
UndoNuÎabË
.
NULL


336 : 
´eviousS‹
.
g‘
(
k
))));

337  
	gbud”
.
bud
();

346 @
DÚtIn¡rum’t


347 
undoPutAÎ
(
CÜfuTabË
<
K
, 
V
> 
bË
, 
M­
<K, V> 
undoRecÜd
,

348 
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m
) {

349 
	gundoRecÜd
.
’ŒyS‘
().
fÜEach
(
e
 -> {

350 ià(
e
.
g‘V®ue
(è=ğ
CÜfuTabË
.
UndoNuÎabË
.
NULL
) {

351 
undoRemove
(
bË
, 
nuÎ
, 
e
.
g‘Key
());

353 
undoRemove
(
bË
, 
e
.
g‘V®ue
(),ƒ.
g‘Key
());

360 @
	gOv”ride


361 @
MutÜ
(
Çme
 = "put", 
noUpÿÎ
 = 
Œue
)

362 
public
 
š£¹
(@
CÚæiùP¬am‘”
 
K
 
key
, 
V
 
v®ue
) {

369 @
	gOv”ride


370 @
AcûssÜ


371 
public
 
	gLi¡
<
	gV
> 
sÿnAndF‹r
(
P»diÿ‹
<? 
su³r
 
V
> 
v®ueP»diÿ‹
) {

372 
Œy
 (
SŒ—m
<
M­
.
EÁry
<
K
, 
V
>> 
’Œ›s
 = 
mašM­
.
un§ãEÁrySŒ—m
()) {

373  
poŞ
.
subm™
((è-> 
’Œ›s


374 .
m­
(
EÁry
::
g‘V®ue
).
f‹r
(
v®ueP»diÿ‹
)

375 .
cŞËù
(
CŞËùÜs
.
toCŞËùiÚ
(
A¼ayLi¡
::
Ãw
))).
još
();

380 @
	gOv”ride


381 @
AcûssÜ


382 
public
 
	gCŞËùiÚ
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
sÿnAndF‹rByEÁry
(

383 
P»diÿ‹
<? 
su³r
 
M­
.
EÁry
<
K
, 
V
>> 
’ŒyP»diÿ‹
) {

384 
Œy
 (
SŒ—m
<
M­
.
EÁry
<
K
, 
V
>> 
’Œ›s
 = 
mašM­
.
un§ãEÁrySŒ—m
()) {

385  
poŞ
.
subm™
((è-> 
’Œ›s


386 .
f‹r
(
’ŒyP»diÿ‹
)

387 .
cŞËù
(
CŞËùÜs
.
toCŞËùiÚ
(
A¼ayLi¡
::
Ãw
))).
još
();

392 @
	gOv”ride


393 @
MutÜAcûssÜ
(
Çme
 = "»move", 
undoFunùiÚ
 = "undoRemove",

394 
undoRecÜdFunùiÚ
 = "undoRemoveRecord")

395 @
Suµ»ssW¬nšgs
("unchecked")

396 
public
 
V
 
»move
(@
CÚæiùP¬am‘”
 
Objeù
 
key
) {

397 
V
 
´evious
 = 
mašM­
.
»move
(
key
);

398 
unm­SecÚd¬yIndexes
((
K
è
key
, 
´evious
);

399  
	g´evious
;

402 @
DÚtIn¡rum’t


403 
´Ùeùed
 
V
 
undoRemoveRecÜd
(
CÜfuTabË
<
K
, V> 
bË
, K 
key
) {

404  
	gbË
.
	gmašM­
.
g‘
(
key
);

407 @
DÚtIn¡rum’t


408 
´Ùeùed
 
undoRemove
(
CÜfuTabË
<
K
, 
V
> 
bË
, V 
undoRecÜd
, K 
key
) {

409 ià(
	gundoRecÜd
 =ğ
nuÎ
) {

410 
V
 
´evious
 = 
bË
.
mašM­
.
»move
(
key
);

411 
	gbË
.
unm­SecÚd¬yIndexes
(
key
, 
´evious
);

413 
V
 
	g´evious
 = 
bË
.
mašM­
.
put
(
key
, 
undoRecÜd
);

414 ià(!
	gbË
.
	g£cÚd¬yIndexes
.
isEm±y
()) {

415 
	gbË
.
unm­SecÚd¬yIndexes
(
key
, 
´evious
);

416 
	gbË
.
m­SecÚd¬yIndexes
(
key
, 
undoRecÜd
);

422 @
	gOv”ride


423 @
MutÜ
(
Çme
 = "»move", 
noUpÿÎ
 = 
Œue
)

424 
public
 
d–‘e
(@
CÚæiùP¬am‘”
 
K
 
key
) {

431 @
Ov”ride


432 @
MutÜ
(
Çme
 = "putAll",

433 
undoFunùiÚ
 = "undoPutAll",

434 
undoRecÜdFunùiÚ
 = "undoPutAllRecord",

435 
cÚæiùP¬am‘”FunùiÚ
 = "putAllConflictFunction")

436 
public
 
putAÎ
(@
NÚnuÎ
 
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m
) {

438 ià(
	g£cÚd¬yIndexes
.
isEm±y
()) {

439 
	gmašM­
.
putAÎ
(
m
);

443 
	gm
.
’ŒyS‘
().
¡»am
()

444 .
fÜEach
(
e
 -> {

445 
V
 
´evious
 = 
mašM­
.
put
(
e
.
g‘Key
(),ƒ.
g‘V®ue
());

446 
unm­SecÚd¬yIndexes
(
e
.
g‘Key
(), 
´evious
);

447 
m­SecÚd¬yIndexes
(
e
.
g‘Key
(),ƒ.
g‘V®ue
());

453 @
	gOv”ride


454 @
MutÜ
(
Çme
 = "ş—r", 
»£t
 = 
Œue
)

455 
public
 
ş—r
() {

456 
mašM­
.
ş—r
();

457 
	g£cÚd¬yIndexes
.
v®ues
().
fÜEach
(
M­
::
ş—r
);

461 @
	gOv”ride


462 @
AcûssÜ


463 
	gpublic
 @
NÚnuÎ
 
	gS‘
<
	gK
> 
keyS‘
() {

464  
	gmašM­
.
keyS‘
()

465 .
¡»am
()

466 .
cŞËù
(
ImmubËS‘
.
toImmubËS‘
());

470 @
	gOv”ride


471 @
AcûssÜ


472 
	gpublic
 @
NÚnuÎ
 
	gCŞËùiÚ
<
	gV
> 
v®ues
() {

473  
	gmašM­
.
v®ues
()

474 .
¡»am
()

475 .
cŞËù
(
ImmubËS‘
.
toImmubËS‘
());

482 @
	gOv”ride


483 @
AcûssÜ


484 
	gpublic
 @
NÚnuÎ
 
	gS‘
<
	gEÁry
<
	gK
, 
	gV
>> 
’ŒyS‘
() {

485  
	gImmubËLi¡S‘W¿µ”
.
äomM­
(
mašM­
);

495 @
AcûssÜ


496 
	gpublic
 @
NÚnuÎ
 
	gSŒ—m
<
	gEÁry
<
	gK
, 
	gV
>> 
’ŒySŒ—m
() {

497  
	gmašM­
.
’ŒySŒ—m
();

502 @
	gOv”ride


503 @
AcûssÜ


504 
public
 
V
 
g‘OrDeçuÉ
(
Objeù
 
key
, V 
deçuÉV®ue
) {

505  
	gmašM­
.
g‘OrDeçuÉ
(
key
, 
deçuÉV®ue
);

509 @
	gOv”ride


510 @
AcûssÜ


511 
public
 
fÜEach
(
BiCÚsum”
<? 
su³r
 
K
, ? su³¸
V
> 
aùiÚ
) {

512 
	gmašM­
.
fÜEach
(
aùiÚ
);

516 @
	gOv”ride


517 @
T¿n§ùiÚ®M‘hod


518 
public
 
»¶aûAÎ
(
BiFunùiÚ
<? 
su³r
 
K
, ? su³¸
V
, ? 
ex‹nds
 V> 
funùiÚ
) {

519 
	gObjeùs
.
»quœeNÚNuÎ
(
funùiÚ
);

520 
	gM­
.
	gEÁry
<
	gK
, 
	gV
> 
	g’Œy
 : 
’ŒyS‘
()) {

521 
K
 
k
;

522 
V
 
	gv
;

523 
	gŒy
 {

524 
	gk
 = 
’Œy
.
g‘Key
();

525 
	gv
 = 
’Œy
.
g‘V®ue
();

526 } 
ÿtch
 (
IÎeg®S‹Exû±iÚ
 
i£
) {

528 
throw
 
Ãw
 
CÚcu¼’tModifiÿtiÚExû±iÚ
(
i£
);

532 
	gv
 = 
funùiÚ
.
­¶y
(
k
, 
v
);

534 
	gŒy
 {

535 
š£¹
(
k
, 
v
);

536 } 
ÿtch
 (
IÎeg®S‹Exû±iÚ
 
i£
) {

538 
throw
 
Ãw
 
CÚcu¼’tModifiÿtiÚExû±iÚ
(
i£
);

544 @
	gOv”ride


545 @
T¿n§ùiÚ®M‘hod


546 
public
 
V
 
putIfAb£Á
(
K
 
key
, V 
v®ue
) {

547 
V
 
	gv
 = 
g‘
(
key
);

548 ià(
	gv
 =ğ
nuÎ
) {

549 
v
 = 
put
(
key
, 
v®ue
);

552  
	gv
;

556 @
	gOv”ride


557 @
T¿n§ùiÚ®M‘hod


558 
public
 
boŞ—n
 
»move
(
Objeù
 
key
, Objeù 
v®ue
) {

559 
Objeù
 
	gcurV®ue
 = 
g‘
(
key
);

560 ià(!
	gObjeùs
.
equ®s
(
curV®ue
, 
v®ue
)

561 || (
	gcurV®ue
 =ğ
nuÎ
 && !
cÚšsKey
(
key
))) {

562  
çl£
;

564 
»move
(
key
);

565  
	gŒue
;

569 @
	gOv”ride


570 @
T¿n§ùiÚ®M‘hod


571 
public
 
V
 
»¶aû
(
K
 
key
, V 
v®ue
) {

572 
V
 
	gcurV®ue
;

573 ià(((
	gcurV®ue
 = 
g‘
(
key
)è!ğ
nuÎ
è|| 
cÚšsKey
(key)) {

574 
curV®ue
 = 
put
(
key
, 
v®ue
);

576  
	gcurV®ue
;

580 @
	gOv”ride


581 @
T¿n§ùiÚ®M‘hod


582 
public
 
V
 
compu‹IfAb£Á
(
K
 
key
, 
FunùiÚ
<? 
su³r
 K, ? 
ex‹nds
 V> 
m­pšgFunùiÚ
) {

584 
	gObjeùs
.
»quœeNÚNuÎ
(
m­pšgFunùiÚ
);

585 
V
 
	gv
;

586 ià((
	gv
 = 
g‘
(
key
)è=ğ
nuÎ
) {

587 
V
 
ÃwV®ue
;

588 ià((
	gÃwV®ue
 = 
m­pšgFunùiÚ
.
­¶y
(
key
)è!ğ
nuÎ
) {

589 
put
(
key
, 
ÃwV®ue
);

590  
	gÃwV®ue
;

594  
	gv
;

598 @
	gOv”ride


599 @
T¿n§ùiÚ®M‘hod


600 
public
 
V
 
compu‹IfP»£Á
(
K
 
key
, 
BiFunùiÚ
<? 
su³r
 K, ? su³¸V, ? 
ex‹nds
 V>

601 
»m­pšgFunùiÚ
) {

602 
	gObjeùs
.
»quœeNÚNuÎ
(
»m­pšgFunùiÚ
);

603 
V
 
	gŞdV®ue
;

604 ià((
	gŞdV®ue
 = 
g‘
(
key
)è!ğ
nuÎ
) {

605 
V
 
ÃwV®ue
 = 
»m­pšgFunùiÚ
.
­¶y
(
key
, 
ŞdV®ue
);

606 ià(
	gÃwV®ue
 !ğ
nuÎ
) {

607 
put
(
key
, 
ÃwV®ue
);

608  
	gÃwV®ue
;

610 
»move
(
key
);

611  
	gnuÎ
;

614  
	gnuÎ
;

619 @
	gOv”ride


620 @
T¿n§ùiÚ®M‘hod


621 
public
 
V
 
m”ge
(
K
 
key
, V 
v®ue
, 
BiFunùiÚ
<? 
su³r
 V, ? su³¸V, ? 
ex‹nds
 V>

622 
»m­pšgFunùiÚ
) {

623 
	gObjeùs
.
»quœeNÚNuÎ
(
»m­pšgFunùiÚ
);

624 
	gObjeùs
.
»quœeNÚNuÎ
(
v®ue
);

625 
V
 
	gŞdV®ue
 = 
g‘
(
key
);

626 
V
 
	gÃwV®ue
 = (
ŞdV®ue
 =ğ
nuÎ
è? 
v®ue
 :

627 
»m­pšgFunùiÚ
.
­¶y
(
ŞdV®ue
, 
v®ue
);

628 ià(
	gÃwV®ue
 =ğ
nuÎ
) {

629 
»move
(
key
);

631 
put
(
key
, 
ÃwV®ue
);

633  
	gÃwV®ue
;

642 @
	gDÚtIn¡rum’t


643 @
Suµ»ssW¬nšgs
("unchecked")

644 
´Ùeùed
 
unm­SecÚd¬yIndexes
(
K
 
key
, 
V
 
v®ue
) {

645 ià(
	gv®ue
 =ğ
nuÎ
) {

649 
	gŒy
 {

651 
	gIndex
.
	gS³c
<
	gK
, 
	gV
, ? 
ex‹nds
 
	gCom·¿bË
> 
	gšdex
 : 
šdexS³c
) {

652 
SŒšg
 
šdexName
 = 
šdex
.
g‘Name
().
g‘
();

653 
	gM­
<
	gCom·¿bË
, M­<
	gK
, 
	gV
>> 
	g£cÚd¬yIndex
 = 
£cÚd¬yIndexes
.
g‘
(
šdexName
);

654 
Com·¿bË
 
	gšdexKey
 : 
šdex
.
g‘MuÉiV®ueIndexFunùiÚ
().
­¶y
(
key
, 
v®ue
)) {

655 
	gM­
<
	gK
, 
	gV
> 
	g¦Ù
 = 
£cÚd¬yIndex
.
g‘
(
šdexKey
);

656 ià(
	g¦Ù
 !ğ
nuÎ
) {

657 
¦Ù
.
»move
(
key
, 
v®ue
);

661 } 
ÿtch
 (
Exû±iÚ
 
e
) {

662 
	glog
.
”rÜ
("Received‡nƒxception while computinghe index. " +

663 "Thi i mo¡†ik–y‡Àissuw™hhş›Á' šdexšg funùiÚ. {}", 
e
);

666 
ş—rIndex
();

669 
throw
 
	ge
;

679 @
	gDÚtIn¡rum’t


680 @
Suµ»ssW¬nšgs
("unchecked")

681 
´Ùeùed
 
m­SecÚd¬yIndexes
(
K
 
key
, 
V
 
v®ue
) {

682 ià(
	gv®ue
 =ğ
nuÎ
) {

683 
log
.
w¬n
("Attemptingo build‡n index with‡‚ull value, skipping.");

687 
	gŒy
 {

689 
	gIndex
.
	gS³c
<
	gK
, 
	gV
, ? 
ex‹nds
 
	gCom·¿bË
> 
	gšdex
 : 
šdexS³c
) {

690 
SŒšg
 
šdexName
 = 
šdex
.
g‘Name
().
g‘
();

691 
	gM­
<
	gCom·¿bË
, M­<
	gK
, 
	gV
>> 
	g£cÚd¬yIndex
 = 
£cÚd¬yIndexes
.
g‘
(
šdexName
);

692 
Com·¿bË
 
	gšdexKey
 : 
šdex
.
g‘MuÉiV®ueIndexFunùiÚ
().
­¶y
(
key
, 
v®ue
)) {

693 
	gM­
<
	gK
, 
	gV
> 
	g¦Ù
 = 
£cÚd¬yIndex
.
compu‹IfAb£Á
(
šdexKey
, 
k
 -> 
Ãw
 
HashM­
<>());

694 
	g¦Ù
.
put
(
key
, 
v®ue
);

697 } 
ÿtch
 (
Exû±iÚ
 
e
) {

698 
	glog
.
”rÜ
("Received‡nƒxception while computinghe index. " +

699 "Thi i mo¡†ik–y‡Àissuw™hhş›Á' šdexšg funùiÚ.", 
e
);

702 
ş—rIndex
();

705 
throw
 
	ge
;

712 @
DÚtIn¡rum’t


713 
´Ùeùed
 
ş—rIndex
() {

714 
	gšdexS³c
.
ş—r
();

715 
	g£cÚd¬yIndexes
.
ş—r
();

721 @
	gPassThrough


722 @
Ov”ride


723 
public
 
	gCÜfuTabË
<
	gK
, 
	gV
> 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

724 ià(
	gcÚ‹xt
 =ğ
OPTIMISTIC
) {

725  
İtimi¡icTabË
;

727  
	gthis
;

734 @
	gDÚtIn¡rum’t


735 @
Ov”ride


736 
public
 
V”siÚPŞicy
 
g‘V”siÚPŞicy
() {

737  
	gv”siÚPŞicy
;

743 @
	gPassThrough


744 @
Ov”ride


745 
public
 
şo£
() {

746 
	gthis
.
	gmašM­
.
şo£
();

752 @
	gDÚtIn¡rum’t


753 @
Ov”ride


754 
public
 
şo£W¿µ”
() {

755 
	gthis
.
	gmašM­
.
şo£
();

	@runtime/src/main/java/org/corfudb/runtime/collections/ICorfuTable.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

8 
public
 
š‹rçû
 
	gICÜfuTabË
<
	gK
, 
	gV
>

9 
ex‹nds
 
	gSŒ—mšgM­
<
	gK
, 
	gV
> {

19 
š£¹
(
K
 
key
, 
V
 
v®ue
);

28 
d–‘e
(
K
 
key
);

38 
	gLi¡
<
	gV
> 
sÿnAndF‹r
(
P»diÿ‹
<? 
su³r
 
V
> 
v®ueP»diÿ‹
);

48 
	gCŞËùiÚ
<
	gEÁry
<
	gK
, 
	gV
>> 
sÿnAndF‹rByEÁry
(

49 
P»diÿ‹
<? 
su³r
 
M­
.
EÁry
<
K
, 
V
>> 
’ŒyP»diÿ‹
);

	@runtime/src/main/java/org/corfudb/runtime/collections/Index.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

4 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

5 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
;

6 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

10 
public
 cÏs 
	cIndex
 {

16 @
FunùiÚ®IÁ”çû


17 
public
 
š‹rçû
 
Name
 
ex‹nds
 
	mSuµl›r
<
	mSŒšg
> {

28 @
FunùiÚ®IÁ”çû


29 
public
 
š‹rçû
 
	gFunùiÚ
<
	gK
, 
	gV
, 
I
 
ex‹nds
 
	gCom·¿bË
<?>>ƒx‹nd 
	gBiFunùiÚ
<K, V, 
	gI
> {

32 @
FunùiÚ®IÁ”çû


33 
public
 
š‹rçû
 
	gMuÉiV®ueFunùiÚ
<
	gK
, 
	gV
, 
I
 
ex‹nds
 
	gCom·¿bË
<?>>

34 
ex‹nds
 
	gBiFunùiÚ
<
	gK
, 
	gV
, 
	gI‹¿bË
<
	gI
>> {

47 
public
 
şass
 
	gS³c
<
	gK
, 
	gV
, 
I
 
ex‹nds
 
	gCom·¿bË
<?>> {

48 
´iv©e
 
fš®
 
Name
 
	gÇme
;

49 
´iv©e
 
fš®
 
	gMuÉiV®ueFunùiÚ
<
	gK
, 
	gV
, 
	gI
> 
	gšdexFunùiÚ
;

51 
public
 
S³c
(
Name
 
Çme
, 
FunùiÚ
<
K
, 
V
, 
I
> 
šdexFunùiÚ
) {

52 
	gthis
.
	gÇme
 = 
Çme
;

53 
	gthis
.
	gšdexFunùiÚ
 =

54 (
k
, 
	gv
è-> 
	gCŞËùiÚs
.
sšgËtÚLi¡
(
šdexFunùiÚ
.
­¶y
(k, 
v
));

57 
public
 
S³c
(
Name
 
Çme
, 
MuÉiV®ueFunùiÚ
<
K
, 
V
, 
I
> 
šdexFunùiÚ
) {

58 
	gthis
.
	gÇme
 = 
Çme
;

59 
	gthis
.
	gšdexFunùiÚ
 = 
šdexFunùiÚ
;

62 
public
 
Name
 
g‘Name
() {

63  
	gÇme
;

66 
public
 
	gMuÉiV®ueFunùiÚ
<
	gK
, 
	gV
, 
	gI
> 
g‘MuÉiV®ueIndexFunùiÚ
() {

67  
	gšdexFunùiÚ
;

71 @
Ov”ride


72 
public
 
boŞ—n
 
equ®s
(
Objeù
 
o
) {

73 ià(
	gthis
 =ğ
o
è 
Œue
;

74 ià(!(
o
 
š¡ªûof
 
	gIndex
)è 
	gçl£
;

75 
	gS³c
<?, ?, ?> 
	gšdex
 = (
S³c
<?, ?, ?>è
	go
;

76  
	gObjeùs
.
equ®s
(
Çme
.
g‘
(), 
šdex
.name.get());

79 @
Ov”ride


80 
public
 
hashCode
() {

81  
	gObjeùs
.
hash
(
Çme
.
g‘
());

91 
public
 
š‹rçû
 
	gRegi¡ry
<
	gK
, 
	gV
>

92 
ex‹nds
 
	gI‹¿bË
<
	gS³c
<
	gK
, 
	gV
, ?ƒx‹nd 
	gCom·¿bË
<?>>> {

94 
	gRegi¡ry
<?, ?> 
	gEMPTY
 = 
Ãw
 
Regi¡ry
<
Objeù
, 
	gObjeù
>() {

95 @
Ov”ride


96 
	gpublic
 <
I
 
ex‹nds
 
	gCom·¿bË
<?>> 
	gO±iÚ®
<
	gS³c
<
	gObjeù
, Objeù, 
	gI
>> 
g‘
(
Name
 
Çme
) {

97  
	gO±iÚ®
.
em±y
();

100 @
Ov”ride


101 
public
 
	gI‹¿tÜ
<
	gS³c
<
	gObjeù
, Objeù, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
™”©Ü
() {

102  
	gCŞËùiÚs
.
em±yI‹¿tÜ
();

112 <
I
 
ex‹nds
 
	gCom·¿bË
<?>> 
	gO±iÚ®
<
	gS³c
<
	gK
, 
	gV
, 
	gI
>> 
g‘
(
Name
 
Çme
);

121 <
	gK
, 
	gV
> 
	gRegi¡ry
<K, V> 
em±y
() {

122 @
Suµ»ssW¬nšgs
("unchecked")

123 
	gRegi¡ry
<
	gK
, 
	gV
> 
	g»suÉ
 = (
Regi¡ry
<
K
, V>è
	gEMPTY
;

124  
	g»suÉ
;

	@runtime/src/main/java/org/corfudb/runtime/collections/MetadataOptions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gD©a
;

7 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

18 @
	gD©a


19 @
Bud”


20 şas 
	cM‘ad©aO±iÚs
 {

22 @
DeçuÉ


23 
´iv©e
 
fš®
 
boŞ—n
 
	mm‘ad©aEÇbËd
 = 
çl£
;

25 @
DeçuÉ


26 
´iv©e
 
fš®
 
Mes§ge
 
	mdeçuÉM‘ad©aIn¡ªû
 = 
nuÎ
;

	@runtime/src/main/java/org/corfudb/runtime/collections/PersistedStreamingMap.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

10 
impÜt
 
	gÜg
.
	grocksdb
.
	gCom·ùiÚO±iÚsUniv”§l
;

11 
impÜt
 
	gÜg
.
	grocksdb
.
	gCom´essiÚTy³
;

12 
impÜt
 
	gÜg
.
	grocksdb
.
	gO±iÚs
;

13 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDB
;

14 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDBExû±iÚ
;

16 
impÜt
 
	gjava
.
	gio
.
	gFe
;

17 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

18 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

22 
impÜt
 
	gjava
.
	gut
.
	gS¶™”©Ü
;

23 
impÜt
 
	gjava
.
	gut
.
	gS¶™”©Üs
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

25 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

26 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—mSuµÜt
;

36 @
Slf4j


37 
public
 
şass
 
	gP”si¡edSŒ—mšgM­
<
	gK
, 
	gV
> 
im¶em’ts
 
	gCÚ‹xtAw¬eM­
<K, V> {

40 
	gRocksDB
.
lßdLib¿ry
();

59 
public
 
O±iÚs
 
g‘P”si¡edSŒ—mšgM­O±iÚs
() {

60 
fš®
 
	gmaxSizeAm¶ifiÿtiÚP”ûÁ
 = 50;

61 
fš®
 
O±iÚs
 
	gİtiÚs
 = 
Ãw
 Options();

63 
	gİtiÚs
.
£tC»©eIfMissšg
(
Œue
);

64 
	gİtiÚs
.
£tCom´essiÚTy³
(
Com´essiÚTy³
.
LZ4_COMPRESSION
);

68 
fš®
 
Com·ùiÚO±iÚsUniv”§l
 
	gcom·ùiÚO±iÚs
 = 
Ãw
 CompactionOptionsUniversal();

69 
	gcom·ùiÚO±iÚs
.
£tMaxSizeAm¶ifiÿtiÚP”ûÁ
(
maxSizeAm¶ifiÿtiÚP”ûÁ
);

70 
	gİtiÚs
.
£tCom·ùiÚO±iÚsUniv”§l
(
com·ùiÚO±iÚs
);

71  
	gİtiÚs
;

74 
´iv©e
 
fš®
 
	gCÚ‹xtAw¬eM­
<
	gK
, 
	gV
> 
	gİtimi¡icM­
 = 
Ãw
 
SŒ—mšgM­DecÜ©Ü
<>();

75 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	gd©aS‘Size
 = 
Ãw
 AtomicInteger();

76 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	gcÜfuRuÁime
;

77 
´iv©e
 
fš®
 
IS”Ÿliz”
 
	g£rŸliz”
;

78 
´iv©e
 
fš®
 
RocksDB
 
	grocksDb
;

80 
public
 
P”si¡edSŒ—mšgM­
(@
NÚNuÎ
 
P©h
 
d©aP©h
,

81 @
NÚNuÎ
 
O±iÚs
 
İtiÚs
,

82 @
NÚNuÎ
 
IS”Ÿliz”
 
£rŸliz”
,

83 @
NÚNuÎ
 
CÜfuRuÁime
 
cÜfuRuÁime
) {

84 
	gŒy
 {

85 
	gRocksDB
.
de¡royDB
(
d©aP©h
.
toFe
().
g‘AbsŞu‹P©h
(), 
İtiÚs
);

86 
	gthis
.
	grocksDb
 = 
RocksDB
.
İ’
(
İtiÚs
, 
d©aP©h
.
toFe
().
g‘AbsŞu‹P©h
());

87 } 
ÿtch
 (
RocksDBExû±iÚ
 
e
) {

88 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
e
);

90 
	gthis
.
	g£rŸliz”
 = 
£rŸliz”
;

91 
	gthis
.
	gcÜfuRuÁime
 = 
cÜfuRuÁime
;

97 @
Ov”ride


98 
public
 
size
() {

99  
	gd©aS‘Size
.
g‘
();

105 @
Ov”ride


106 
public
 
boŞ—n
 
isEm±y
() {

107  
	gd©aS‘Size
.
g‘
() == 0;

113 @
Ov”ride


114 
public
 
boŞ—n
 
cÚšsKey
(@
NÚNuÎ
 
Objeù
 
key
) {

115 
fš®
 
By‹Buf
 
	gkeyPaylßd
 = 
UÅoŞed
.
bufãr
();

116 
	g£rŸliz”
.
£rŸlize
(
key
, 
keyPaylßd
);

117 
	gŒy
 {

118 
	gby‹
[] 
	gv®ue
 = 
rocksDb
.
g‘
(

119 
keyPaylßd
.
¬¿y
(), keyPaylßd.
¬¿yOff£t
(), keyPaylßd.
»adabËBy‹s
());

120  
	gv®ue
 !ğ
nuÎ
;

121 } 
ÿtch
 (
RocksDBExû±iÚ
 
ex
) {

122 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
ex
);

123 } 
	gfš®ly
 {

124 
	gkeyPaylßd
.
»Ëa£
();

133 @
Ov”ride


134 
public
 
boŞ—n
 
cÚšsV®ue
(@
NÚNuÎ
 
Objeù
 
v®ue
) {

135 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

141 @
Ov”ride


142 
public
 
V
 
g‘
(@
NÚNuÎ
 
Objeù
 
key
) {

143 
fš®
 
By‹Buf
 
	gkeyPaylßd
 = 
UÅoŞed
.
bufãr
();

144 
	g£rŸliz”
.
£rŸlize
(
key
, 
keyPaylßd
);

146 
	gŒy
 {

147 
	gby‹
[] 
	gv®ue
 = 
rocksDb
.
g‘
(

148 
keyPaylßd
.
¬¿y
(), keyPaylßd.
¬¿yOff£t
(), keyPaylßd.
»adabËBy‹s
());

149 ià(
	gv®ue
 =ğ
nuÎ
) {

150  
nuÎ
;

152  (
	gV
è
	g£rŸliz”
.
de£rŸlize
(
UÅoŞed
.
w¿µedBufãr
(
v®ue
), 
cÜfuRuÁime
);

153 } 
ÿtch
 (
RocksDBExû±iÚ
 
ex
) {

154 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
ex
);

155 } 
	gfš®ly
 {

156 
	gkeyPaylßd
.
»Ëa£
();

163 @
Ov”ride


164 
public
 
V
 
put
(@
NÚNuÎ
 
K
 
key
, @NÚNuÎ V 
v®ue
) {

165 
fš®
 
By‹Buf
 
	gkeyPaylßd
 = 
UÅoŞed
.
bufãr
();

166 
fš®
 
By‹Buf
 
	gv®uePaylßd
 = 
UÅoŞed
.
bufãr
();

167 
	g£rŸliz”
.
£rŸlize
(
key
, 
keyPaylßd
);

168 
	g£rŸliz”
.
£rŸlize
(
v®ue
, 
v®uePaylßd
);

172 
fš®
 
boŞ—n
 
	gkeyExi¡s
 = 
rocksDb
.
keyMayExi¡
(
keyPaylßd
.
¬¿y
(),

173 
keyPaylßd
.
¬¿yOff£t
(), keyPaylßd.
»adabËBy‹s
(), 
Ãw
 
SŒšgBud”
());

174 ià(!
	gkeyExi¡s
) {

175 
	gd©aS‘Size
.
šüem’tAndG‘
();

178 
	gŒy
 {

179 
	grocksDb
.
put
(

180 
keyPaylßd
.
¬¿y
(), keyPaylßd.
¬¿yOff£t
(), keyPaylßd.
»adabËBy‹s
(),

181 
v®uePaylßd
.
¬¿y
(), v®uePaylßd.
¬¿yOff£t
(), v®uePaylßd.
»adabËBy‹s
());

182 } 
ÿtch
 (
RocksDBExû±iÚ
 
ex
) {

183 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
ex
);

184 } 
	gfš®ly
 {

185 
	gkeyPaylßd
.
»Ëa£
();

186 
	gv®uePaylßd
.
»Ëa£
();

189  
	gv®ue
;

195 @
Ov”ride


196 
public
 
V
 
»move
(@
NÚNuÎ
 
Objeù
 
key
) {

197 
fš®
 
By‹Buf
 
	gkeyPaylßd
 = 
UÅoŞed
.
bufãr
();

198 
	g£rŸliz”
.
£rŸlize
(
key
, 
keyPaylßd
);

199 
	gŒy
 {

200 
V
 
	gv®ue
 = 
g‘
(
key
);

201 ià(
	gv®ue
 !ğ
nuÎ
) {

202 
rocksDb
.
d–‘e
(

203 
keyPaylßd
.
¬¿y
(), keyPaylßd.
¬¿yOff£t
(), keyPaylßd.
»adabËBy‹s
());

204 
	gd©aS‘Size
.
deüem’tAndG‘
();

205  
	gv®ue
;

207  
	gnuÎ
;

209 } 
ÿtch
 (
RocksDBExû±iÚ
 
ex
) {

210 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
ex
);

211 } 
	gfš®ly
 {

212 
	gkeyPaylßd
.
»Ëa£
();

219 @
Ov”ride


220 
public
 
putAÎ
(@
NÚNuÎ
 
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m­
) {

221 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

227 @
Ov”ride


228 
public
 
ş—r
() {

229 
’ŒySŒ—m
().
m­
(
EÁry
::
g‘Key
).
fÜEach
(
this
::
»move
);

230 
	gd©aS‘Size
.
£t
(0);

236 @
Ov”ride


237 
public
 
	gS‘
<
	gK
> 
keyS‘
() {

238 
Œy
 (
fš®
 
RocksDbEÁryI‹¿tÜ
<
K
, 
V
> 
’ŒyI‹¿tÜ
 =

239 
Ãw
 
RocksDbEÁryI‹¿tÜ
<>(
rocksDb
, 
£rŸliz”
, 
çl£
)) {

240 
	gS‘
<
	gK
> 
	gkeyS‘
 = 
Ãw
 
HashS‘
<>();

241 
	g’ŒyI‹¿tÜ
.
hasNext
()) {

242 
	gkeyS‘
.
add
(
’ŒyI‹¿tÜ
.
Ãxt
().
g‘Key
());

244  
	gkeyS‘
;

253 @
Ov”ride


254 
public
 
	gCŞËùiÚ
<
	gV
> 
v®ues
() {

255 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

263 @
Ov”ride


264 
public
 
	gS‘
<
	gEÁry
<
	gK
, 
	gV
>> 
’ŒyS‘
() {

265 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

271 @
Ov”ride


272 
public
 
	gCÚ‹xtAw¬eM­
<
	gK
, 
	gV
> 
g‘O±imi¡icM­
() {

273  
	gİtimi¡icM­
;

279 @
Ov”ride


280 
public
 
	gSŒ—m
<
	gEÁry
<
	gK
, 
	gV
>> 
’ŒySŒ—m
() {

281 
fš®
 
	gRocksDbEÁryI‹¿tÜ
<
	gK
, 
	gV
> 
	g’ŒyI‹¿tÜ
 = 
Ãw
 
RocksDbEÁryI‹¿tÜ
<>(
rocksDb
, 
	g£rŸliz”
);

282 
	gSŒ—m
<
	gEÁry
<
	gK
, 
	gV
>> 
	g»sSŒ—m
 = 
SŒ—mSuµÜt
.
¡»am
(
S¶™”©Üs
.
¥l™”©ÜUnknownSize
(
’ŒyI‹¿tÜ
,

283 
S¶™”©Ü
.
ORDERED
), 
çl£
);

284 
	g»sSŒ—m
.
ÚClo£
(
’ŒyI‹¿tÜ
::
şo£
);

285  
	g»sSŒ—m
;

291 @
Ov”ride


292 
public
 
şo£
() {

293 
	gthis
.
	grocksDb
.
şo£
();

	@runtime/src/main/java/org/corfudb/runtime/collections/ProtobufIndexer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gF›ldDesütÜ
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gCÏssUts
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
;

10 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

12 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

22 
public
 
şass
 
PrÙobufIndex”
 
im¶em’ts
 
	gIndex
.
	gRegi¡ry
<
	gMes§ge
, 
	gCÜfuRecÜd
<Message,

23 
	gMes§ge
>> {

25 
´iv©e
 
fš®
 
	gHashM­
<
	gSŒšg
,

26 
	gIndex
.
	gS³c
<
	gMes§ge
, 
	gCÜfuRecÜd
<Mes§ge, Mes§ge>, ? 
ex‹nds
 
	gCom·¿bË
<?>>>

27 
	gšdiûs
 = 
Ãw
 
HashM­
<>();

29 
PrÙobufIndex”
(
Mes§ge
 
·ylßdSchema
) {

30 
	g·ylßdSchema
.
g‘DesütÜFÜTy³
().
g‘F›lds
().
fÜEach
(
this
::
»gi¡”Indiûs
);

33 
	g´iv©e
 <
T
 
ex‹nds
 
	gCom·¿bË
<
	gT
>> 
	gIndex
.
	gS³c
<
	gMes§ge
, 
	gCÜfuRecÜd
<Message, Message>, ?ƒxtends Comparable<?>>

34 
g‘Index
(
SŒšg
 
šdexName
, 
F›ldDesütÜ
 
f›ldDesütÜ
) {

36  
Ãw
 
	gIndex
.
	gS³c
<>(

37 (è-> 
	gšdexName
,

38 (
	gIndex
.
	gFunùiÚ
<
	gMes§ge
, 
	gCÜfuRecÜd
<Mes§ge, Mes§ge>, 
	gT
>)

39 (
	gkey
, 
	gv®
è-> 
	gCÏssUts
.
ÿ¡
(
v®
.
g‘Paylßd
().
g‘F›ld
(
f›ldDesütÜ
)));

42 
»gi¡”Indiûs
(
fš®
 
DesütÜs
.
F›ldDesütÜ
 
f›ldDesütÜ
) {

44 ià(
	gf›ldDesütÜ
.
g‘O±iÚs
().
g‘Ex‹nsiÚ
(
CÜfuO±iÚs
.
schema
).
g‘SecÚd¬yKey
()) {

45 
fš®
 
SŒšg
 
	gšdexName
 = 
f›ldDesütÜ
.
g‘Name
();

46 ià(
	gf›ldDesütÜ
.
g‘Ty³
(è=ğ
F›ldDesütÜ
.
Ty³
.
GROUP
) {

47 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("group is‡ deprecated, unsupportedype");

49 
	gšdiûs
.
put
(
šdexName
, 
g‘Index
(šdexName, 
f›ldDesütÜ
));

53 @
Ov”ride


54 
public
 
	gO±iÚ®
<

55 
	gIndex
.
	gS³c
<
	gMes§ge
, 
	gCÜfuRecÜd
<Mes§ge, Mes§ge>, ? 
ex‹nds
 
	gCom·¿bË
<?>>

56 > 
g‘
(
Index
.
Name
 
Çme
) {

57  
	gO±iÚ®
.
ofNuÎabË
(
Çme
).
m­
(
šdexName
 -> 
šdiûs
.
g‘
(indexName));

60 @
Ov”ride


61 
public
 
	gI‹¿tÜ
<
	gIndex
.
	gS³c
<
	gMes§ge
, 
	gCÜfuRecÜd
<Mes§ge, Mes§ge>, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
™”©Ü
() {

62  
	gšdiûs
.
v®ues
().
™”©Ü
();

	@runtime/src/main/java/org/corfudb/runtime/collections/Query.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gQu”yO±iÚs
.
	gDEFAULT_OPTIONS
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

7 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

12 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

15 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiP»diÿ‹
;

17 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

21 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

22 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ
.
	gT¿n§ùiÚBud”
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
;

37 
public
 cÏs 
	cQu”y
 {

39 
´iv©e
 
fš®
 
TabËRegi¡ry
 
	mbËRegi¡ry
;

41 
´iv©e
 
fš®
 
ObjeùsV›w
 
	mobjeùsV›w
;

43 
´iv©e
 
fš®
 
SŒšg
 
	mÇme¥aû
;

52 
public
 
	$Qu”y
(
fš®
 
TabËRegi¡ry
 
bËRegi¡ry
, fš® 
ObjeùsV›w
 
objeùsV›w
, fš® 
SŒšg
 
Çme¥aû
) {

53 
this
.
bËRegi¡ry
 =ableRegistry;

54 
this
.
objeùsV›w
 = objectsView;

55 
this
.
Çme¥aû
 =‚amespace;

58 
´iv©e
 
Tok’
 
	$g‘Tok’
(
Time¡amp
 
time¡amp
) {

59  
Ãw
 
	`Tok’
(
time¡amp
.
	`g‘Epoch
(),ime¡amp.
	`g‘Sequ’û
());

60 
	}
}

62 
´iv©e
 
	$txBegš
(
Time¡amp
 
time¡amp
) {

63 
T¿n§ùiÚBud”
 
Œª§ùiÚBud”
 = 
objeùsV›w
.
	`TXBud
()

64 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
);

66 ià(
time¡amp
 !ğ
nuÎ
) {

67 
Œª§ùiÚBud”
.
	`¢­shÙ
(
	`g‘Tok’
(
time¡amp
));

70 
Œª§ùiÚBud”
.
	`bud
().
	`begš
();

71 
	}
}

73 
´iv©e
 
	$txEnd
() {

74 
objeùsV›w
.
	`TXEnd
();

75 
	}
}

77 
	g´iv©e
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

78 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
g‘TabË
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
) {

79  
	gbËRegi¡ry
.
g‘TabË
(
this
.
Çme¥aû
, 
bËName
);

92 @
NuÎabË


93 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

94 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
g‘RecÜd
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

95 @
NÚnuÎ
 
fš®
 
K
 
key
) {

96  
g‘RecÜd
(
bËName
, 
nuÎ
, 
key
);

110 @
NuÎabË


111 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

112 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
g‘RecÜd
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

113 @
NuÎabË
 
fš®
 
Time¡amp
 
time¡amp
,

114 @
NÚnuÎ
 
fš®
 
K
 
key
) {

115 ià(
	gbËName
 =ğ
nuÎ
) {

116 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Query::getRecord‚eeds‡ validableName");

118 
	gŒy
 {

119 
txBegš
(
time¡amp
);

120 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	gbË
 = 
g‘TabË
(
bËName
);

121  
	gbË
.
g‘
(
key
);

122 } 
	gfš®ly
 {

123 
txEnd
();

133 
public
 
couÁ
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
) {

134  
couÁ
(
bËName
, 
nuÎ
);

144 
public
 
couÁ
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

145 @
NuÎabË
 
fš®
 
Time¡amp
 
time¡amp
) {

146 
	gŒy
 {

147 
txBegš
(
time¡amp
);

148  
g‘TabË
(
bËName
).
couÁ
();

149 } 
	gfš®ly
 {

150 
txEnd
();

162 @
NÚnuÎ


163 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
> 
	gS‘
<
	gK
> 
keyS‘
(@
NÚnuÎ
 
SŒšg
 
bËName
,

164 @
NuÎabË
 
Time¡amp
 
time¡amp
) {

165 
	gŒy
 {

166 
txBegš
(
time¡amp
);

167  (
	gS‘
<
	gK
>è
g‘TabË
(
bËName
).
keyS‘
();

168 } 
	gfš®ly
 {

169 
txEnd
();

173 @
NÚnuÎ


174 
	g´iv©e
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

175 
	gLi¡
<
	gCÜfuStÜeEÁry
<
	gK
, 
	gV
, 
	gM
>> 
sÿnAndF‹rByEÁry
(

176 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

177 @
NuÎabË
 
Time¡amp
 
time¡amp
,

178 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>> 
´ediÿ‹
) {

179 
	gŒy
 {

180 
txBegš
(
time¡amp
);

181  ((
	gTabË
<
	gK
, 
	gV
, 
	gM
>è
g‘TabË
(
bËName
)).
sÿnAndF‹rByEÁry
(
´ediÿ‹
);

182 } 
	gfš®ly
 {

183 
txEnd
();

198 @
NÚnuÎ


199 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
I
ƒx‹nd 
	gCom·¿bË
<
	gI
>>

200 
	gQu”yResuÉ
<
	gEÁry
<
	gK
, 
	gV
>> 
g‘ByIndex
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

201 @
NÚnuÎ
 
fš®
 
SŒšg
 
šdexName
,

202 @
NÚnuÎ
 
fš®
 
I
 
šdexKey
) {

203  
Ãw
 
	gQu”yResuÉ
<>(((
	gTabË
<
	gK
, 
	gV
, 
	gM
>è
g‘TabË
(
bËName
)).
g‘ByIndex
(
šdexName
, 
šdexKey
));

206 
	g´iv©e
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
	gR
>

207 
	gCŞËùiÚ
<
	gR
> 
š™ŸlizeResuÉCŞËùiÚ
(
Qu”yO±iÚs
<
K
, 
V
, 
M
, 
R
> 
qu”yO±iÚs
) {

208 ià(!
	gqu”yO±iÚs
.
isDi¡šù
()) {

209  
Ãw
 
	gA¼ayLi¡
<>();

211 ià(
	gqu”yO±iÚs
.
g‘Com·¿tÜ
(è!ğ
nuÎ
) {

212  
Ãw
 
T»eS‘
<>(
qu”yO±iÚs
.
g‘Com·¿tÜ
());

214  
Ãw
 
	gHashS‘
<>();

217 
	g´iv©e
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
	gR
>

218 
	gCŞËùiÚ
<
	gR
> 
ŒªsfÜm
(
CŞËùiÚ
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>> 
qu”yResuÉ
,

219 
CŞËùiÚ
<
R
> 
»suÉCŞËùiÚ
,

220 
FunùiÚ
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>, 
R
> 
´ojeùiÚ
) {

221  
	gqu”yResuÉ
.
¡»am
()

222 .
m­
(
v
 -> 
O±iÚ®
.
ofNuÎabË
(
´ojeùiÚ
)

223 .
m­
(
funùiÚ
 -> funùiÚ.
­¶y
(
v
))

224 .
ÜEl£
((
R
è
v
))

225 .
cŞËù
(
CŞËùÜs
.
toCŞËùiÚ
((è-> 
»suÉCŞËùiÚ
));

238 @
NÚnuÎ


239 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
	gR
>

240 
	gQu”yResuÉ
<
	gR
> 
execu‹Qu”y
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

241 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>> 
qu”y
) {

242  
execu‹Qu”y
(
bËName
, 
qu”y
, 
DEFAULT_OPTIONS
);

259 @
NÚnuÎ


260 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
	gR
>

261 
	gQu”yResuÉ
<
	gR
> 
execu‹Qu”y
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

262 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>> 
qu”y
,

263 @
NÚnuÎ
 
fš®
 
Qu”yO±iÚs
<
K
, 
V
, 
M
, 
R
> 
qu”yO±iÚs
) {

265 
	gLi¡
<
	gCÜfuStÜeEÁry
<
	gK
, 
	gV
, 
	gM
>> 
	gf‹rResuÉ


266 ğ
sÿnAndF‹rByEÁry
(
bËName
, 
qu”yO±iÚs
.
g‘Time¡amp
(), 
qu”y
);

267 
	gCŞËùiÚ
<
	gR
> 
	g»suÉ
 = 
š™ŸlizeResuÉCŞËùiÚ
(
qu”yO±iÚs
);

268  
Ãw
 
	gQu”yResuÉ
<>(
ŒªsfÜm
(
f‹rResuÉ
, 
»suÉ
, 
qu”yO±iÚs
.
g‘ProjeùiÚ
()));

287 @
NÚnuÎ


288 
	gpublic
 <
K1
 
ex‹nds
 
	gMes§ge
, 
K2
ƒxtends Message,

289 
V1
 
ex‹nds
 
	gMes§ge
, 
V2
ƒxtends Message,

290 
M1
 
ex‹nds
 
	gMes§ge
, 
M2
ƒx‹nd Mes§ge, 
	gT
, 
	gU
>

291 
	gQu”yResuÉ
<
	gU
> 
execu‹JošQu”y
(

292 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName1
,

293 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName2
,

294 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K1
, 
V1
, 
M1
>> 
qu”y1
,

295 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K2
, 
V2
, 
M2
>> 
qu”y2
,

296 @
NÚnuÎ
 
fš®
 
BiP»diÿ‹
<
V1
, 
V2
> 
jošP»diÿ‹
,

297 @
NÚnuÎ
 
fš®
 
BiFunùiÚ
<
V1
, 
V2
, 
T
> 
jošFunùiÚ
,

298 
fš®
 
FunùiÚ
<
T
, 
U
> 
jošProjeùiÚ
) {

299  
execu‹JošQu”y
(

300 
bËName1
,

301 
bËName2
,

302 
qu”y1
,

303 
qu”y2
,

304 
DEFAULT_OPTIONS
,

305 
DEFAULT_OPTIONS
,

306 
jošP»diÿ‹
,

307 
jošFunùiÚ
,

308 
jošProjeùiÚ
);

331 @
NÚnuÎ


332 
	gpublic
 <
K1
 
ex‹nds
 
	gMes§ge
, 
K2
ƒxtends Message,

333 
V1
 
ex‹nds
 
	gMes§ge
, 
V2
ƒxtends Message,

334 
M1
 
ex‹nds
 
	gMes§ge
, 
M2
ƒxtends Message,

335 
	gR
, 
	gS
, 
	gT
, 
	gU
>

336 
	gQu”yResuÉ
<
	gU
> 
execu‹JošQu”y
(

337 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName1
,

338 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName2
,

339 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K1
, 
V1
, 
M1
>> 
qu”y1
,

340 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K2
, 
V2
, 
M2
>> 
qu”y2
,

341 @
NÚnuÎ
 
fš®
 
Qu”yO±iÚs
<
K1
, 
V1
, 
M1
, 
R
> 
qu”yO±iÚs1
,

342 @
NÚnuÎ
 
fš®
 
Qu”yO±iÚs
<
K2
, 
V2
, 
M2
, 
S
> 
qu”yO±iÚs2
,

343 @
NÚnuÎ
 
fš®
 
BiP»diÿ‹
<
R
, 
S
> 
jošP»diÿ‹
,

344 @
NÚnuÎ
 
fš®
 
BiFunùiÚ
<
R
, 
S
, 
T
> 
jošFunùiÚ
,

345 
fš®
 
FunùiÚ
<
T
, 
U
> 
jošProjeùiÚ
) {

347 
	gLi¡
<
	gCÜfuStÜeEÁry
<
	gK1
, 
	gV1
, 
	gM1
>> 
	gf‹rResuÉ1


348 ğ
sÿnAndF‹rByEÁry
(
bËName1
, 
qu”yO±iÚs1
.
g‘Time¡amp
(), 
qu”y1
);

349 
	gCŞËùiÚ
<
	gR
> 
	gqu”yResuÉ1
 = 
ŒªsfÜm
(

350 
f‹rResuÉ1
,

351 
š™ŸlizeResuÉCŞËùiÚ
(
qu”yO±iÚs1
),

352 
qu”yO±iÚs1
.
g‘ProjeùiÚ
());

354 
	gLi¡
<
	gCÜfuStÜeEÁry
<
	gK2
, 
	gV2
, 
	gM2
>> 
	gf‹rResuÉ2


355 ğ
sÿnAndF‹rByEÁry
(
bËName2
, 
qu”yO±iÚs2
.
g‘Time¡amp
(), 
qu”y2
);

356 
	gCŞËùiÚ
<
	gS
> 
	gqu”yResuÉ2
 = 
ŒªsfÜm
(

357 
f‹rResuÉ2
,

358 
š™ŸlizeResuÉCŞËùiÚ
(
qu”yO±iÚs2
),

359 
qu”yO±iÚs2
.
g‘ProjeùiÚ
());

361 
	gCŞËùiÚ
<
	gT
> 
	gjošResuÉ
 = 
Ãw
 
A¼ayLi¡
<>();

363 
R
 
	gv®ue1
 : 
qu”yResuÉ1
) {

364 
S
 
v®ue2
 : 
qu”yResuÉ2
) {

365 ià(!
jošP»diÿ‹
.
‹¡
(
v®ue1
, 
v®ue2
)) {

369 
T
 
	g»suÉV®ue
 = 
jošFunùiÚ
.
­¶y
(
v®ue1
, 
v®ue2
);

370 
	gjošResuÉ
.
add
(
»suÉV®ue
);

374  
Ãw
 
	gQu”yResuÉ
<>(
	gjošResuÉ
.
¡»am
()

375 .
m­
(
v
 -> 
O±iÚ®
.
ofNuÎabË
(
jošProjeùiÚ
)

376 .
m­
(
funùiÚ
 -> funùiÚ.
­¶y
(
v
))

377 .
ÜEl£
((
U
è
v
))

378 .
cŞËù
(
CŞËùÜs
.
toLi¡
()));

386 @
FunùiÚ®IÁ”çû


387 
public
 
š‹rçû
 
	gM”geFunùiÚ
<
	gR
> {

395 
R
 
m”ge
(
Li¡
<
Objeù
> 
¬gum’ts
);

409 
	g´iv©e
 <
	gR
> 
	gLi¡
<R> 
m”ge
(@
NÚnuÎ
 
Li¡
<
CŞËùiÚ
<?>> 
li¡
,

410 @
NÚnuÎ
 
Li¡
<
Objeù
> 
m”gePaylßd
,

411 @
NÚnuÎ
 
M”geFunùiÚ
<
R
> 
func
,

412 
d•th
) {

413 
	gCŞËùiÚ
<?> 
	gcŞËùiÚ
 = 
li¡
.
g‘
(
d•th
);

414 ià(
	gli¡
.
size
(è- 1 =ğ
d•th
) {

415 
Li¡
<
R
> 
»suÉ
 = 
Ãw
 
A¼ayLi¡
<>();

416 
Objeù
 
	go
 : 
cŞËùiÚ
) {

417 
Li¡
<
Objeù
> 
fš®M”geLi¡
 = 
Ãw
 
A¼ayLi¡
<>(
m”gePaylßd
);

418 
	gfš®M”geLi¡
.
add
(
o
);

419 
R
 
	gm”geResuÉ
 = 
func
.
m”ge
(
fš®M”geLi¡
);

420 ià(
	gm”geResuÉ
 !ğ
nuÎ
) {

421 
»suÉ
.
add
(
m”geResuÉ
);

424  
	g»suÉ
;

427 
	gLi¡
<
	gR
> 
	g»suÉ
 = 
Ãw
 
A¼ayLi¡
<>();

428 
Objeù
 
	go
 : 
cŞËùiÚ
) {

429 
Li¡
<
Objeù
> 
m”geLi¡
 = 
Ãw
 
A¼ayLi¡
<>(
m”gePaylßd
);

430 
	gm”geLi¡
.
add
(
o
);

431 
	g»suÉ
.
addAÎ
(
m”ge
(
li¡
, 
m”geLi¡
, 
func
, 
d•th
 + 1));

433  
	g»suÉ
;

444 @
NÚnuÎ


445 
	gpublic
 <
	gR
> 
	gQu”yResuÉ
<R> 
execu‹MuÉiJošQu”y
(@
NÚnuÎ
 
fš®
 
CŞËùiÚ
<
SŒšg
> 
bËNames
,

446 @
NÚnuÎ
 
fš®
 
M”geFunùiÚ
<
R
> 
jošFunùiÚ
) {

448 
	gLi¡
<
	gCŞËùiÚ
<?>> 
	gv®ues
 = 
Ãw
 
A¼ayLi¡
<>();

449 
SŒšg
 
	gbËName
 : 
bËNames
) {

450 
CŞËùiÚ
<
Mes§ge
> 
mes§ges
 = 
sÿnAndF‹rByEÁry
(
bËName
, 
nuÎ
, 
cÜfuStÜeEÁry
 -> 
Œue
)

451 .
¡»am
()

452 .
m­
(
CÜfuStÜeEÁry
::
g‘Paylßd
)

453 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

454 
	gv®ues
.
add
(
mes§ges
);

457 
	gm”geJošD•th
 = 0;

458 
	gCŞËùiÚ
<
	gR
> 
	gm”gedResuÉs
 = 
m”ge
(
v®ues
, 
Ãw
 
A¼ayLi¡
<>(), 
jošFunùiÚ
, 
m”geJošD•th
);

459  
Ãw
 
	gQu”yResuÉ
<>(
	gm”gedResuÉs
);

	@runtime/src/main/java/org/corfudb/runtime/collections/QueryOptions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

5 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

6 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

16 @
G‘‹r


17 
public
 
şass
 
	gQu”yO±iÚs
<
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
	gR
> {

19 
public
 
fš®
 
Qu”yO±iÚs
 
	gDEFAULT_OPTIONS
 = 
Qu”yO±iÚsBud”
.
ÃwBud”
().
bud
();

21 
´iv©e
 
fš®
 
Time¡amp
 
	gtime¡amp
;

22 
´iv©e
 
fš®
 
boŞ—n
 
	gdi¡šù
;

23 
´iv©e
 
fš®
 
	gCom·¿tÜ
<
	gR
> 
	gcom·¿tÜ
;

24 
´iv©e
 
fš®
 
	gFunùiÚ
<
	gCÜfuStÜeEÁry
<
	gK
, 
	gV
, 
	gM
>, 
	gR
> 
	g´ojeùiÚ
;

26 
´iv©e
 
Qu”yO±iÚs
(
Time¡amp
 
time¡amp
,

27 
boŞ—n
 
di¡šù
,

28 
Com·¿tÜ
<
R
> 
com·¿tÜ
,

29 
FunùiÚ
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>, 
R
> 
´ojeùiÚ
) {

30 
	gthis
.
	gtime¡amp
 = 
time¡amp
;

31 
	gthis
.
	gdi¡šù
 = 
di¡šù
;

32 
	gthis
.
	gcom·¿tÜ
 = 
com·¿tÜ
;

33 
	gthis
.
	g´ojeùiÚ
 = 
´ojeùiÚ
;

36 
public
 
şass
 
	gQu”yO±iÚsBud”
<
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒx‹nd Mes§ge, 
	gR
> {

38 
´iv©e
 
Time¡amp
 
	gtime¡amp
;

39 
´iv©e
 
boŞ—n
 
	gdi¡šù
;

40 
´iv©e
 
	gCom·¿tÜ
<
	gR
> 
	gcom·¿tÜ
;

41 
´iv©e
 
	gFunùiÚ
<
	gCÜfuStÜeEÁry
<
	gK
, 
	gV
, 
	gM
>, 
	gR
> 
	g´ojeùiÚ
;

43 
public
 <
KEY
 
ex‹nds
 
	gMes§ge
, 
VALUE
ƒx‹nd Mes§ge, 
META
ƒx‹nd Mes§ge, 
	gS
>

44 
	gQu”yO±iÚsBud”
<
	gKEY
, 
	gVALUE
, 
	gMETA
, 
	gS
> 
ÃwBud”
() {

45  
Ãw
 
	gQu”yO±iÚsBud”
<>();

48 
public
 
	gQu”yO±iÚsBud”
<
	gK
, 
	gV
, 
	gM
, 
	gR
> 
£tTime¡amp
(
Time¡amp
 
time¡amp
) {

49 
	gthis
.
	gtime¡amp
 = 
time¡amp
;

50  
	gthis
;

53 
public
 
	gQu”yO±iÚsBud”
<
	gK
, 
	gV
, 
	gM
, 
	gR
> 
£tDi¡šù
(
boŞ—n
 
di¡šù
) {

54 
	gthis
.
	gdi¡šù
 = 
di¡šù
;

55  
	gthis
;

58 
public
 
	gQu”yO±iÚsBud”
<
	gK
, 
	gV
, 
	gM
, 
	gR
> 
£tCom·¿tÜ
(
Com·¿tÜ
<
R
> 
com·¿tÜ
) {

59 
	gthis
.
	gcom·¿tÜ
 = 
com·¿tÜ
;

60  
	gthis
;

63 
public
 
	gQu”yO±iÚsBud”
<
	gK
, 
	gV
, 
	gM
, 
	gR
> 
£tProjeùiÚ
(
FunùiÚ
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>, 
R
> 
´ojeùiÚ
) {

64 
	gthis
.
	g´ojeùiÚ
 = 
´ojeùiÚ
;

65  
	gthis
;

68 
public
 
	gQu”yO±iÚs
<
	gK
, 
	gV
, 
	gM
, 
	gR
> 
bud
() {

69  
Ãw
 
	gQu”yO±iÚs
<>(

70 
	gtime¡amp
,

71 
	gdi¡šù
,

72 
	gcom·¿tÜ
,

73 
	g´ojeùiÚ
);

	@runtime/src/main/java/org/corfudb/runtime/collections/QueryResult.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

5 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

11 @
Equ®sAndHashCode


12 
public
 
şass
 
	gQu”yResuÉ
<
	gE
> {

14 @
G‘‹r


15 
´iv©e
 
fš®
 
	gCŞËùiÚ
<
	gE
> 
	g»suÉ
;

17 
public
 
Qu”yResuÉ
(
CŞËùiÚ
<
E
> 
»suÉ
) {

18 
	gthis
.
	g»suÉ
 = 
»suÉ
;

	@runtime/src/main/java/org/corfudb/runtime/collections/RocksDbEntryIterator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

5 
impÜt
 
	gÜg
.
	grocksdb
.
	gR—dO±iÚs
;

6 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDB
;

8 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gcÚcu¼’t
.
	gNÙTh»adSaã
;

9 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

20 @
NÙTh»adSaã


21 
public
 
şass
 
	gRocksDbEÁryI‹¿tÜ
<
	gK
, 
	gV
> 
im¶em’ts
 
	gI‹¿tÜ
<
	gM­
.
	gEÁry
<K, V>>, 
	gAutoClo£abË
 {

26 
fš®
 
´iv©e
 
W¿µedRocksI‹¿tÜ
 
	gw¿µedRocksI‹¿tÜ
;

31 
fš®
 
´iv©e
 
IS”Ÿliz”
 
	g£rŸliz”
;

36 
´iv©e
 
	gM­
.
	gEÁry
<
	gK
, 
	gV
> 
	gÃxt
;

41 
´iv©e
 
fš®
 
boŞ—n
 
	glßdV®ues
;

43 
fš®
 
´iv©e
 
R—dO±iÚs
 
	g»adO±iÚs
;

45 
public
 
RocksDbEÁryI‹¿tÜ
(
RocksDB
 
rocksDB
, 
IS”Ÿliz”
 
£rŸliz”
, 
boŞ—n
 
lßdV®ues
) {

47 
	g»adO±iÚs
 = 
Ãw
 
R—dO±iÚs
();

48 
	g»adO±iÚs
.
£tSÇpshÙ
(
nuÎ
);

49 
	gthis
.
	gw¿µedRocksI‹¿tÜ
 = 
Ãw
 
W¿µedRocksI‹¿tÜ
(
rocksDB
.
ÃwI‹¿tÜ
(
»adO±iÚs
));

50 
	gthis
.
	g£rŸliz”
 = 
£rŸliz”
;

51 
	gw¿µedRocksI‹¿tÜ
.
£ekToFœ¡
();

52 
	gthis
.
	glßdV®ues
 = 
lßdV®ues
;

55 
public
 
RocksDbEÁryI‹¿tÜ
(
RocksDB
 
rocksDB
, 
IS”Ÿliz”
 
£rŸliz”
) {

56 
this
(
rocksDB
, 
£rŸliz”
, 
Œue
);

62 @
Ov”ride


63 
public
 
boŞ—n
 
hasNext
() {

64 ià(
	gÃxt
 =ğ
nuÎ
 && 
w¿µedRocksI‹¿tÜ
.
isO³n
(è&& w¿µedRocksI‹¿tÜ.
isV®id
()) {

66 
K
 
key
 = (Kè
£rŸliz”
.
de£rŸlize
(
UÅoŞed
.
w¿µedBufãr
(
w¿µedRocksI‹¿tÜ
.key()), 
nuÎ
);

67 
V
 
	gv®ue
 = 
lßdV®ues
 ? (Vè
£rŸliz”


68 .
de£rŸlize
(
UÅoŞed
.
w¿µedBufãr
(
w¿µedRocksI‹¿tÜ
.
v®ue
()), 
nuÎ
) :‚ull;

69 
	gÃxt
 = 
Ãw
 
Ab¡¿ùM­
.
Sim¶eEÁry
(
key
, 
v®ue
);

70 
	gw¿µedRocksI‹¿tÜ
.
Ãxt
();

73 ià(
	gÃxt
 =ğ
nuÎ
 && 
w¿µedRocksI‹¿tÜ
.
isO³n
()) {

75 
w¿µedRocksI‹¿tÜ
.
şo£
();

76 
	g»adO±iÚs
.
şo£
();

79  
	gÃxt
 !ğ
nuÎ
;

85 @
Ov”ride


86 
public
 
	gM­
.
	gEÁry
<
	gK
, 
	gV
> 
Ãxt
() {

87 ià(
hasNext
()) {

88 
	gM­
.
	gEÁry
<
	gK
, 
	gV
> 
	g»s
 = 
Ãxt
;

89 
	gÃxt
 = 
nuÎ
;

90  
	g»s
;

92 
throw
 
Ãw
 
NoSuchEËm’tExû±iÚ
();

99 @
Ov”ride


100 
public
 
şo£
() {

102 ià(
	gw¿µedRocksI‹¿tÜ
.
isO³n
()) {

103 
	gw¿µedRocksI‹¿tÜ
.
şo£
();

104 
	g»adO±iÚs
.
şo£
();

	@runtime/src/main/java/org/corfudb/runtime/collections/StreamListener.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

8 
public
 
š‹rçû
 
	gSŒ—mLi¡’”
{

15 
ÚNext
(
CÜfuSŒ—mEÁr›s
 
»suÉs
);

23 
ÚE¼Ü
(
ThrowabË
 
throwabË
);

	@runtime/src/main/java/org/corfudb/runtime/collections/StreamingMap.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

4 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

15 
public
 
š‹rçû
 
	gSŒ—mšgM­
<
	gK
, 
	gV
> 
ex‹nds
 
	gM­
<K, V> {

22 
	gSŒ—m
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
’ŒySŒ—m
();

24  
	gSŒ—m
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
un§ãEÁrySŒ—m
() {

25  
’ŒySŒ—m
();

	@runtime/src/main/java/org/corfudb/runtime/collections/StreamingMapDecorator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gImmubËLi¡S‘W¿µ”
;

5 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

19 
public
 
şass
 
	gSŒ—mšgM­DecÜ©Ü
<
	gK
, 
	gV
> 
im¶em’ts
 
	gCÚ‹xtAw¬eM­
<K, V> {

21 
fš®
 
	gM­
<
	gK
, 
	gV
> 
	gm­Im¶
;

23 
public
 
SŒ—mšgM­DecÜ©Ü
() {

24 
this
(
Ãw
 
HashM­
<>());

27 
public
 
SŒ—mšgM­DecÜ©Ü
(
M­
<
K
, 
V
> 
m­Im¶
) {

28 
	gthis
.
	gm­Im¶
 = 
m­Im¶
;

34 @
Ov”ride


35 
public
 
	gSŒ—m
<
	gEÁry
<
	gK
, 
	gV
>> 
’ŒySŒ—m
() {

36  
	gImmubËLi¡S‘W¿µ”
.
äomM­
(
m­Im¶
).
¡»am
().
·¿Î–
();

42 @
Ov”ride


43 
public
 
	gSŒ—m
<
	gEÁry
<
	gK
, 
	gV
>> 
un§ãEÁrySŒ—m
() {

44  
	gm­Im¶
.
’ŒyS‘
().
¡»am
().
·¿Î–
();

50 @
Ov”ride


51 
public
 
size
() {

52  
	gm­Im¶
.
size
();

58 @
Ov”ride


59 
public
 
boŞ—n
 
isEm±y
() {

60  
	gm­Im¶
.
isEm±y
();

66 @
Ov”ride


67 
public
 
boŞ—n
 
cÚšsKey
(
Objeù
 
key
) {

68  
	gm­Im¶
.
cÚšsKey
(
key
);

74 @
Ov”ride


75 
public
 
boŞ—n
 
cÚšsV®ue
(
Objeù
 
v®ue
) {

76  
	gm­Im¶
.
cÚšsV®ue
(
v®ue
);

82 @
Ov”ride


83 
public
 
V
 
g‘
(
Objeù
 
key
) {

84  
	gm­Im¶
.
g‘
(
key
);

90 @
Ov”ride


91 
public
 
V
 
put
(
K
 
key
, V 
v®ue
) {

92  
	gm­Im¶
.
put
(
key
, 
v®ue
);

98 @
Ov”ride


99 
public
 
V
 
»move
(
Objeù
 
key
) {

100  
	gm­Im¶
.
»move
(
key
);

106 @
Ov”ride


107 
public
 
putAÎ
(
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m­
) {

108 
	gm­Im¶
.
putAÎ
(
m­
);

114 @
Ov”ride


115 
public
 
ş—r
() {

116 
	gm­Im¶
.
ş—r
();

122 @
Ov”ride


123 
public
 
	gS‘
<
	gK
> 
keyS‘
() {

124  
	gm­Im¶
.
keyS‘
();

130 @
Ov”ride


131 
public
 
	gCŞËùiÚ
<
	gV
> 
v®ues
() {

132  
	gm­Im¶
.
v®ues
();

138 @
Ov”ride


139 
public
 
	gS‘
<
	gEÁry
<
	gK
, 
	gV
>> 
’ŒyS‘
() {

140  
	gm­Im¶
.
’ŒyS‘
();

	@runtime/src/main/java/org/corfudb/runtime/collections/StreamingSubscriptionContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gLškedBlockšgQueue
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

16 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

18 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

29 @
Slf4j


30 
public
 cÏs 
	cSŒ—mšgSubsütiÚCÚ‹xt
 {

35 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

40 @
G‘‹r


41 
´iv©e
 
fš®
 
SŒ—mLi¡’”
 
	mli¡’”
;

46 @
G‘‹r


47 
´iv©e
 
fš®
 
SŒšg
 
	mÇme¥aû
;

54 @
G‘‹r


55 
´iv©e
 
fš®
 
	mM­
<
	mUUID
,

56 
	mTabËSchema
<? 
ex‹nds
 
	mMes§ge
, ?ƒx‹nd Mes§ge, ?ƒx‹nd Mes§ge>> 
	mbËsOfIÁ”e¡
;

61 
´iv©e
 
fš®
 
	m¡¬tAdd»ss
;

66 @
G‘‹r


67 
´iv©e
 
	mÏ¡R—dAdd»ss
;

72 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mtxPŞËrInProg»ss
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

77 @
	mG‘‹r


78 @
S‘‹r


79 
´iv©e
 vŞ©
ThrowabË
 
	mpŞËrExû±iÚ
 = 
nuÎ
;

87 @
G‘‹r


88 
´iv©e
 vŞ©
boŞ—n
 
	m»adyToBeR—³d
 = 
çl£
;

93 
´iv©e
 
fš®
 
	mQUEUE_CAPACITY
 = 512;

101 
´iv©e
 
fš®
 
	mth»shŞdFÜLÚgRuÂšgC®lsInNªo
 = 60L * 1
_000_000_000
;

105 
´iv©e
 
fš®
 
	mLškedBlockšgQueue
<
	mCÜfuSŒ—mEÁr›s
> 
	m¡»amQueue
 =

106 
Ãw
 
LškedBlockšgQueue
<>(
QUEUE_CAPACITY
);

112 
´iv©e
 
fš®
 
AtomicBoŞ—n
 
	mnÙifiÿtiÚInProg»ss
 = 
Ãw
 AtomicBoŞ—n(
çl£
);

122 
public
 
SŒ—mšgSubsütiÚCÚ‹xt
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
, @NÚnuÎ 
SŒ—mLi¡’”
 
li¡’”
,

123 @
NÚnuÎ
 
SŒšg
 
Çme¥aû
, @NÚnuÎ 
Li¡
<
TabËSchema
> 
bËSchemas
,

124 
¡¬tAdd»ss
) {

125 
	mthis
.
	mruÁime
 = 
ruÁime
;

126 
	mthis
.
	mli¡’”
 = 
li¡’”
;

127 
	mthis
.
	mÇme¥aû
 = 
Çme¥aû
;

128 
	mthis
.
	mbËsOfIÁ”e¡
 = 
bËSchemas
.
¡»am
().
cŞËù
(
CŞËùÜs
.
toM­
(

129 
e
 -> 
ruÁime
.
g‘SŒ—mID
ÔuÁime.
g‘TabËRegi¡ry
()

130 .
g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
e
.
g‘TabËName
())),

131 
e
 ->ƒ));

132 
	mthis
.
	m¡¬tAdd»ss
 = 
¡¬tAdd»ss
;

133 
	mthis
.
	mÏ¡R—dAdd»ss
 = 
¡¬tAdd»ss
;

139 
public
 
boŞ—n
 
	$acquœe
() {

142 ià(
pŞËrExû±iÚ
 !ğ
nuÎ
) {

143  
çl£
;

146  
txPŞËrInProg»ss
.
	`com·»AndS‘
(
çl£
, 
Œue
);

147 
	}
}

152 
public
 
	$»Ëa£
() {

153 
txPŞËrInProg»ss
.
	`£t
(
çl£
);

154 
	}
}

162 
public
 
boŞ—n
 
	$’queueSŒ—mEÁry
(
Ï¡Add»ss
, 
ILogD©a
 
logD©a
) {

166 
S‘
<
UUID
> 
logD©aSŒ—ms
 = 
Ãw
 
	`HashS‘
(
logD©a
.
	`g‘SŒ—ms
());

167 
logD©aSŒ—ms
.
	`»šAÎ
(
bËsOfIÁ”e¡
.
	`keyS‘
());

169 ià(
logD©aSŒ—ms
.
	`isEm±y
()) {

170 
log
.
	`Œaû
("Entry‡t‡ddress {} does‚ot contain‡ny streams of interesto†istener {}",

171 
logD©a
.
	`g‘Glob®Add»ss
(), 
li¡’”
.
	`toSŒšg
());

172 
Ï¡R—dAdd»ss
 = 
logD©a
.
	`g‘Glob®Add»ss
();

173  
Œue
;

176 
	`synchrÚized
 (
this
) {

179 ià(
Ï¡R—dAdd»ss
 !ğ
Ï¡Add»ss
) {

180 
log
.
	`”rÜ
("Incorrect‡ddress givenoƒnqueueStreamEntry. Given {} Expected {}",

181 
Ï¡Add»ss
, 
Ï¡R—dAdd»ss
);

182  
çl£
;

185 
MuÉiObjeùSMREÁry
 
muÉiObjSMREÁry
 = (MuÉiObjeùSMREÁryè
logD©a
.
	`g‘Paylßd
(
ruÁime
);

186 
•och
 = 
logD©a
.
	`g‘Epoch
();

188 
CÜfuSŒ—mEÁr›s
 
upd©e
 = 
Ãw
 
	`CÜfuSŒ—mEÁr›s
(
muÉiObjSMREÁry
.
	`g‘EÁryM­
()

189 .
	`’ŒyS‘
()

190 .
	`¡»am
()

191 .
	`f‹r
(
e
 -> 
bËsOfIÁ”e¡
.
	`cÚšsKey
Ó.
	`g‘Key
()))

192 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(

193 
e
 -> 
bËsOfIÁ”e¡
.
	`g‘
Ó.
	`g‘Key
()),

194 
e
 ->ƒ.
	`g‘V®ue
().
	`g‘Upd©es
()

195 .
	`¡»am
()

196 .
	`m­
(
smrEÁry
 -> 
CÜfuSŒ—mEÁry
.
	`äomSMREÁry
(smrEntry,

197 
•och
,

198 
bËsOfIÁ”e¡
.
	`g‘
(
e
.
	`g‘Key
()).
	`g‘KeyCÏss
(),

199 
bËsOfIÁ”e¡
.
	`g‘
(
e
.
	`g‘Key
()).
	`g‘PaylßdCÏss
(),

200 
bËsOfIÁ”e¡
.
	`g‘
(
e
.
	`g‘Key
()).
	`g‘M‘ad©aCÏss
()))

201 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()))));

205 ià(
¡»amQueue
.
	`ofãr
(
upd©e
)) {

206 
Ï¡R—dAdd»ss
 = 
muÉiObjSMREÁry
.
	`g‘Glob®Add»ss
();

207  
Œue
;

210  
çl£
;

211 
	}
}

218 
public
 
	$nÙifyCl›Á
(
numUpd©esToD–iv”
) {

219 ià(
nÙifiÿtiÚInProg»ss
.
	`com·»AndS‘
(
çl£
, 
Œue
)) {

220 
upd©esD–iv”ed
 = 0;

221 
Œy
 {

222 
log
.
	`Œaû
("S¹šg‚ÙifiÿtiÚ fÜ {}", 
li¡’”
.
	`toSŒšg
());

226 ià(
pŞËrExû±iÚ
 !ğ
nuÎ
) {

230 ià(!
»adyToBeR—³d
) {

231 
log
.
	`w¬n
("Encountered {} when streaming updates on‚amespace {}, " +

232 "{} fÜ {}", 
pŞËrExû±iÚ
, 
Çme¥aû
, 
li¡’”
.
	`toSŒšg
());

233 
li¡’”
.
	`ÚE¼Ü
(
pŞËrExû±iÚ
);

234 
log
.
	`Œaû
("ThrowabË {} d–iv”edØ{}", 
pŞËrExû±iÚ
,

235 
li¡’”
.
	`toSŒšg
());

236 
»adyToBeR—³d
 = 
Œue
;

240 
¡»amQueue
.
	`ş—r
();

244 
CÜfuSŒ—mEÁr›s
 
ÃxtUpd©e
 = 
¡»amQueue
.
	`pŞl
();

245 ià(
ÃxtUpd©e
 =ğ
nuÎ
) {

248 
befÜe
 = 
Sy¡em
.
	`ÇnoTime
();

250 
li¡’”
.
	`ÚNext
(
ÃxtUpd©e
);

252 
aá”
 = 
Sy¡em
.
	`ÇnoTime
();

253 ià(
aá”
 - 
befÜe
 > 
th»shŞdFÜLÚgRuÂšgC®lsInNªo
) {

254 
log
.
	`”rÜ
("{} onNext(ètookoØlÚg {} secÚds", 
li¡’”
.
	`toSŒšg
(),

255 (
aá”
 - 
befÜe
)/1
_000_000_000
);

257 
upd©esD–iv”ed
++;

258 } 
numUpd©esToD–iv”
 > 
upd©esD–iv”ed
);

259 } 
	`ÿtch
 (
ThrowabË
 
t
) {

262 
log
.
	`”rÜ
("Aborting client‚otification for {} dueo‡nƒxception {}",

263 
li¡’”
.
	`toSŒšg
(), 
t
);

264 } 
fš®ly
 {

265 
log
.
	`Œaû
("End oànÙifiÿtiÚ fÜ {}, d–iv”ed {} upd©es", 
li¡’”
.
	`toSŒšg
(),

266 
upd©esD–iv”ed
);

267 
nÙifiÿtiÚInProg»ss
.
	`£t
(
çl£
);

270 
log
.
	`Œaû
("Another‚otificationhread is‡lready servicinghis " +

271 "SŒ—mšgSubsütiÚCÚ‹xˆ{}", 
li¡’”
.
	`toSŒšg
());

273 
	}
}

275 
public
 
boŞ—n
 
	$equ®s
(
SŒ—mšgSubsütiÚCÚ‹xt
 
sc
) {

276  
li¡’”
.
	`equ®s
(
sc
.
	`g‘Li¡’”
());

277 
	}
}

279 
public
 
	$hashCode
() {

280  
li¡’”
.
	`hashCode
();

281 
	}
}

283 
public
 
SŒšg
 
	$toSŒšg
() {

284  
li¡’”
.
	`toSŒšg
(è+ "(" + 
Çme¥aû
 + ")";

285 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/Table.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

6 
impÜt
 
	gjava
.
	gut
.*;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

9 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

10 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

12 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

13 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

15 
impÜt
 
	glombok
.
	gNÚNuÎ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuV”siÚPŞicy
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

23 
impÜt
 
	glombok
.
	gG‘‹r
;

31 
public
 
şass
 
	gTabË
<
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message> {

33 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	gcÜfuRuÁime
;

35 
´iv©e
 
fš®
 
	gCÜfuTabË
<
	gK
, 
	gCÜfuRecÜd
<
	gV
, 
	gM
>> 
	gcÜfuTabË
;

40 @
G‘‹r


41 
´iv©e
 
fš®
 
SŒšg
 
	gÇme¥aû
;

46 @
G‘‹r


47 
´iv©e
 
fš®
 
SŒšg
 
	gfuÎyQu®if›dTabËName
;

49 @
G‘‹r


50 
´iv©e
 
fš®
 
M‘ad©aO±iÚs
 
	gm‘ad©aO±iÚs
;

61 @
NÚnuÎ


62 
public
 
TabË
(@
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
,

63 @
NÚnuÎ
 
fš®
 
SŒšg
 
fuÎyQu®if›dTabËName
,

64 @
NÚnuÎ
 
fš®
 
V
 
v®ueSchema
,

65 @
NuÎabË
 
fš®
 
M
 
m‘ad©aSchema
,

66 @
NÚnuÎ
 
fš®
 
CÜfuRuÁime
 
cÜfuRuÁime
,

67 @
NÚnuÎ
 
fš®
 
IS”Ÿliz”
 
£rŸliz”
,

68 @
NÚnuÎ
 
fš®
 
Suµl›r
<
SŒ—mšgM­
<
K
, 
V
>> 
¡»amšgM­Suµl›r
,

69 @
NÚNuÎ
 
fš®
 
ICÜfuV”siÚPŞicy
.
V”siÚPŞicy
 
v”siÚPŞicy
) {

71 
	gthis
.
	gcÜfuRuÁime
 = 
cÜfuRuÁime
;

72 
	gthis
.
	gÇme¥aû
 = 
Çme¥aû
;

73 
	gthis
.
	gfuÎyQu®if›dTabËName
 = 
fuÎyQu®if›dTabËName
;

74 
	gthis
.
	gm‘ad©aO±iÚs
 = 
O±iÚ®
.
ofNuÎabË
(
m‘ad©aSchema
)

75 .
m­
(
schema
 -> 
M‘ad©aO±iÚs
.
bud”
()

76 .
m‘ad©aEÇbËd
(
Œue
)

77 .
deçuÉM‘ad©aIn¡ªû
(
schema
)

78 .
bud
())

79 .
ÜEl£
(
M‘ad©aO±iÚs
.
bud”
().
bud
());

81 
	gthis
.
	gcÜfuTabË
 = 
cÜfuRuÁime
.
g‘ObjeùsV›w
().
bud
()

82 .
£tTy³Tok’
(
CÜfuTabË
.<
K
, 
CÜfuRecÜd
<
V
, 
M
>>
g‘TabËTy³
())

83 .
£tSŒ—mName
(
this
.
fuÎyQu®if›dTabËName
)

84 .
£tS”Ÿliz”
(
£rŸliz”
)

85 .
£tArgum’ts
(
Ãw
 
PrÙobufIndex”
(
v®ueSchema
), 
¡»amšgM­Suµl›r
, 
v”siÚPŞicy
)

86 .
İ’
();

92 
´iv©e
 
boŞ—n
 
TxBegš
() {

93 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
()) {

94  
	gçl£
;

96 
	gcÜfuRuÁime
.
g‘ObjeùsV›w
()

97 .
TXBud
()

98 .
ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
)

99 .
bud
()

100 .
begš
();

101  
	gŒue
;

107 
´iv©e
 
TxEnd
() {

108 
	gcÜfuRuÁime
.
g‘ObjeùsV›w
().
TXEnd
();

119 @
NuÎabË


120 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
ü—‹
(@
NÚnuÎ
 
fš®
 
K
 
key
,

121 @
NuÎabË
 
fš®
 
V
 
v®ue
,

122 @
NuÎabË
 
fš®
 
M
 
m‘ad©a
) {

123 
boŞ—n
 
	gbegªNewTxn
 = 
çl£
;

124 
	gŒy
 {

125 
	gbegªNewTxn
 = 
TxBegš
();

126 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
	g´evious
 = 
cÜfuTabË
.
g‘
(
key
);

127 ià(
	g´evious
 !ğ
nuÎ
) {

128 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Cannot create‡„ecord onƒxisting key.");

130 
M
 
	gÃwM‘ad©a
 = 
nuÎ
;

131 ià(
	gm‘ad©aO±iÚs
.
isM‘ad©aEÇbËd
()) {

132 ià(
	gm‘ad©a
 =ğ
nuÎ
) {

133 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Table::create‚eeds‚on-null metadata");

135 
M
 
	gm‘ad©aDeçuÉIn¡ªû
 = (Mè
g‘M‘ad©aO±iÚs
().
g‘DeçuÉM‘ad©aIn¡ªû
();

136 
	gÃwM‘ad©a
 = 
m”geOldAndNewM‘ad©a
(
m‘ad©aDeçuÉIn¡ªû
, 
m‘ad©a
, 
Œue
);

138  
	gcÜfuTabË
.
put
(
key
, 
Ãw
 
CÜfuRecÜd
<>(
v®ue
, 
ÃwM‘ad©a
));

139 } 
	gfš®ly
 {

140 ià(
	gbegªNewTxn
) {

141 
TxEnd
();

152 @
NuÎabË


153 
public
 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
g‘
(@
NÚnuÎ
 
fš®
 
K
 
key
) {

154  
	gcÜfuTabË
.
g‘
(
key
);

165 @
NuÎabË


166 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
upd©e
(@
NÚnuÎ
 
fš®
 
K
 
key
,

167 @
NÚnuÎ
 
fš®
 
V
 
v®ue
,

168 @
NuÎabË
 
fš®
 
M
 
m‘ad©a
) {

169 
boŞ—n
 
	gbegªNewTxn
 = 
çl£
;

170 
	gŒy
 {

171 
	gbegªNewTxn
 = 
TxBegš
();

172 
M
 
	gÃwM‘ad©a
 = 
nuÎ
;

173 ià(
	gm‘ad©aO±iÚs
.
isM‘ad©aEÇbËd
()) {

174 ià(
	gm‘ad©a
 =ğ
nuÎ
) {

175 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Table::update‚eeds‚on-null metadata");

177 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
	g´evious
 = 
cÜfuTabË
.
g‘
(
key
);

178 
M
 
	g´eviousM‘ad©a
;

179 
boŞ—n
 
	gisC»©e
 = 
çl£
;

180 ià(
	g´evious
 =ğ
nuÎ
) {

181 
´eviousM‘ad©a
 = (
M
è
m‘ad©aO±iÚs
.
g‘DeçuÉM‘ad©aIn¡ªû
();

182 
	gisC»©e
 = 
Œue
;

184 
	g´eviousM‘ad©a
 = 
´evious
.
g‘M‘ad©a
();

186 
v®id©eV”siÚ
(
´eviousM‘ad©a
, 
m‘ad©a
);

187 
	gÃwM‘ad©a
 = 
m”geOldAndNewM‘ad©a
(
´eviousM‘ad©a
, 
m‘ad©a
, 
isC»©e
);

189  
	gcÜfuTabË
.
put
(
key
, 
Ãw
 
CÜfuRecÜd
<>(
v®ue
, 
ÃwM‘ad©a
));

190 } 
	gfš®ly
 {

191 ià(
	gbegªNewTxn
) {

192 
TxEnd
();

203 @
NuÎabË


204 
	gCÜfuRecÜd
<
	gV
, 
	gM
> 
d–‘e
(@
NÚnuÎ
 
fš®
 
K
 
key
) {

205 
boŞ—n
 
	gbegªNewTxn
 = 
çl£
;

206 
	gŒy
 {

207 
	gbegªNewTxn
 = 
TxBegš
();

208  
	gcÜfuTabË
.
»move
(
key
);

209 } 
	gfš®ly
 {

210 ià(
	gbegªNewTxn
) {

211 
TxEnd
();

219 
public
 
ş—r
() {

220 
boŞ—n
 
	gbegªNewTxn
 = 
çl£
;

221 
	gŒy
 {

222 
	gbegªNewTxn
 = 
TxBegš
();

223 
	gcÜfuTabË
.
ş—r
();

224 } 
	gfš®ly
 {

225 ià(
	gbegªNewTxn
) {

226 
TxEnd
();

236 
couÁ
() {

237  
	gcÜfuTabË
.
size
();

245 
	gS‘
<
	gK
> 
keyS‘
() {

246  
	gcÜfuTabË
.
keyS‘
();

255 @
NÚnuÎ


256 
	gCŞËùiÚ
<
	gCÜfuRecÜd
<
	gV
, 
	gM
>> 
sÿnAndF‹r
(@
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuRecÜd
<
V
, 
M
>> 
p
) {

257  
	gcÜfuTabË
.
sÿnAndF‹r
(
p
);

266 @
NÚnuÎ


267 
	gLi¡
<
	gCÜfuStÜeEÁry
<
	gK
, 
	gV
, 
	gM
>> 
sÿnAndF‹rByEÁry
(

268 @
NÚnuÎ
 
fš®
 
P»diÿ‹
<
CÜfuStÜeEÁry
<
K
, 
V
, 
M
>> 
’ŒyP»diÿ‹
) {

269  
	gcÜfuTabË
.
sÿnAndF‹rByEÁry
(
»cÜdEÁry
 ->

270 
’ŒyP»diÿ‹
.
‹¡
(
Ãw
 
CÜfuStÜeEÁry
<>(

271 
»cÜdEÁry
.
g‘Key
(),

272 
»cÜdEÁry
.
g‘V®ue
().
g‘Paylßd
(),

273 
»cÜdEÁry
.
g‘V®ue
().
g‘M‘ad©a
())))

274 .
·¿Î–SŒ—m
()

275 .
m­
(
’Œy
 -> 
Ãw
 
CÜfuStÜeEÁry
<>(

276 
’Œy
.
g‘Key
(),

277 
’Œy
.
g‘V®ue
().
g‘Paylßd
(),

278 
’Œy
.
g‘V®ue
().
g‘M‘ad©a
()))

279 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

290 @
NÚnuÎ


291 
	g´Ùeùed
 <
I
 
ex‹nds
 
	gCom·¿bË
<
	gI
>>

292 
	gCŞËùiÚ
<
	gEÁry
<
	gK
, 
	gV
>> 
g‘ByIndex
(@
NÚnuÎ
 
fš®
 
SŒšg
 
šdexName
,

293 @
NÚnuÎ
 
fš®
 
I
 
šdexKey
) {

294  
	gcÜfuTabË
.
g‘ByIndex
((è-> 
šdexName
, 
šdexKey
).
¡»am
()

295 .
m­
(
’Œy
 -> 
Ãw
 
Ab¡¿ùM­
.
Sim¶eEÁry
<>ÓÁry.
g‘Key
(),ƒÁry.
g‘V®ue
().
g‘Paylßd
()))

296 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

299 
´iv©e
 
	gS‘
<
	gDesütÜs
.
	gF›ldDesütÜ
.
	gTy³
> 
	gv”siÚTy³s
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
asLi¡
(

300 
DesütÜs
.
F›ldDesütÜ
.
Ty³
.
INT32
,

301 
DesütÜs
.
F›ldDesütÜ
.
Ty³
.
INT64
,

302 
DesütÜs
.
F›ldDesütÜ
.
Ty³
.
UINT32
,

303 
DesütÜs
.
F›ldDesütÜ
.
Ty³
.
UINT64
,

304 
DesütÜs
.
F›ldDesütÜ
.
Ty³
.
SFIXED32
,

305 
DesütÜs
.
F›ldDesütÜ
.
Ty³
.
SFIXED64


308 
´iv©e
 
M
 
m”geOldAndNewM‘ad©a
(@
NÚnuÎ
 M 
´eviousM‘ad©a
,

309 @
NuÎabË
 
M
 
u£rM‘ad©a
, 
boŞ—n
 
isC»©e
) {

310 
	gM
.
Bud”
 
	gbud”
 = 
´eviousM‘ad©a
.
toBud”
();

311 
	gDesütÜs
.
F›ldDesütÜ
 
	gf›ldDesütÜ
 : 
´eviousM‘ad©a
.
g‘DesütÜFÜTy³
().
g‘F›lds
()) {

312 ià(
f›ldDesütÜ
.
g‘O±iÚs
().
g‘Ex‹nsiÚ
(
CÜfuO±iÚs
.
schema
).
g‘V”siÚ
()) {

314 
bud”
.
£tF›ld
(

315 
f›ldDesütÜ
,

316 
O±iÚ®
.
ofNuÎabË
(
´eviousM‘ad©a
.
g‘F›ld
(
f›ldDesütÜ
))

317 .
m­
(
´eviousV”siÚ
 -> (
isC»©e
 ? 0L : ((
LÚg
)…reviousVersion) + 1))

318 .
ÜEl£
(0L));

319 } ià(
	gu£rM‘ad©a
 !ğ
nuÎ
) {

320 ià(!
u£rM‘ad©a
.
hasF›ld
(
f›ldDesütÜ
)) {

321 
bud”
.
£tF›ld
(
f›ldDesütÜ
, 
´eviousM‘ad©a
.
g‘F›ld
(fieldDescriptor));

323 
	gbud”
.
£tF›ld
(
f›ldDesütÜ
, 
u£rM‘ad©a
.
g‘F›ld
(fieldDescriptor));

327  (
	gM
è
	gbud”
.
bud
();

330 
´iv©e
 
v®id©eV”siÚ
(@
NuÎabË
 
M
 
´eviousM‘ad©a
,

331 @
NuÎabË
 
M
 
u£rM‘ad©a
) {

333 
	gDesütÜs
.
F›ldDesütÜ
 
	gf›ldDesütÜ
 : 
u£rM‘ad©a
.
g‘DesütÜFÜTy³
().
g‘F›lds
()) {

334 ià(!
f›ldDesütÜ
.
g‘O±iÚs
().
g‘Ex‹nsiÚ
(
CÜfuO±iÚs
.
schema
).
g‘V”siÚ
()) {

337 ià(!
	gv”siÚTy³s
.
cÚšs
(
f›ldDesütÜ
.
g‘Ty³
())) {

338 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Version field‚eedso be‡n Integer or Longype."

339 + " Cu¼’ˆty³=" + 
f›ldDesütÜ
.
g‘Ty³
());

341 
	gv®id©šgV”siÚ
 = (è
u£rM‘ad©a
.
g‘F›ld
(
f›ldDesütÜ
);

342 ià(
	gv®id©šgV”siÚ
 <= 0) {

345 
	g´eviousV”siÚ
 = 
O±iÚ®
.
ofNuÎabË
(
´eviousM‘ad©a
)

346 .
m­
(
m
 -> (
LÚg
èm.
g‘F›ld
(
f›ldDesütÜ
))

347 .
ÜEl£
(-1L);

348 ià(
	gv®id©šgV”siÚ
 !ğ
´eviousV”siÚ
) {

349 
throw
 
Ãw
 
RuÁimeExû±iÚ
("SË objeù Exû±iÚ: " + 
´eviousV”siÚ
 + " != "

350 + 
v®id©šgV”siÚ
);

	@runtime/src/main/java/org/corfudb/runtime/collections/TableOptions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

6 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

11 @
Bud”


12 
public
 
şass
 
	gTabËO±iÚs
<
	gK
, 
	gV
> {

14 
´iv©e
 
fš®
 
	gIndex
.
	gRegi¡ry
<
	gK
, 
	gV
> 
	gšdexRegi¡ry
;

19 
´iv©e
 
fš®
 
P©h
 
	g³rsi¡’tD©aP©h
;

21 
public
 
	gO±iÚ®
<
	gP©h
> 
g‘P”si¡’tD©aP©h
() {

22  
	gO±iÚ®
.
ofNuÎabË
(
³rsi¡’tD©aP©h
);

	@runtime/src/main/java/org/corfudb/runtime/collections/TableSchema.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

4 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

8 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

22 @
Equ®sAndHashCode


23 
public
 
şass
 
	gTabËSchema
<
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message> {

24 @
G‘‹r


25 
´iv©e
 
fš®
 
SŒšg
 
	gbËName
;

27 @
G‘‹r


28 
´iv©e
 
fš®
 
	gCÏss
<
	gK
> 
	gkeyCÏss
;

30 @
G‘‹r


31 
´iv©e
 
fš®
 
	gCÏss
<
	gV
> 
	g·ylßdCÏss
;

33 @
G‘‹r


34 
´iv©e
 
fš®
 
	gCÏss
<
	gM
> 
	gm‘ad©aCÏss
;

36 
public
 
TabËSchema
(@
NÚnuÎ
 
SŒšg
 
bËName
, @NÚnuÎ 
CÏss
<
K
> 
keyCÏss
,

37 @
NÚnuÎ
 
CÏss
<
V
> 
·ylßdCÏss
, @
NuÎabË
 CÏss<
M
> 
m‘ad©aCÏss
) {

38 
	gthis
.
	gbËName
 = 
bËName
;

39 
	gthis
.
	gkeyCÏss
 = 
keyCÏss
;

40 
	gthis
.
	g·ylßdCÏss
 = 
·ylßdCÏss
;

41 
	gthis
.
	gm‘ad©aCÏss
 = 
m‘ad©aCÏss
;

	@runtime/src/main/java/org/corfudb/runtime/collections/TransactionPoller.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

11 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

23 @
Slf4j


24 
public
 cÏs 
	cT¿n§ùiÚPŞËr
 
im¶em’ts
 
	mRuÂabË
 {

29 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

36 
´iv©e
 
fš®
 
	mLi¡
<
	mSŒ—mšgSubsütiÚCÚ‹xt
> 
	m¡»amCÚ‹xts
;

41 @
G‘‹r


42 
´iv©e
 
fš®
 
ISŒ—mV›w
 
	mtxnSŒ—m
;

49 
public
 
T¿n§ùiÚPŞËr
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
,

50 @
NÚnuÎ
 
Li¡
<
SŒ—mšgSubsütiÚCÚ‹xt
> 
¡»ams
) {

51 
	mthis
.
	mruÁime
 = 
ruÁime
;

52 
	mthis
.
	m¡»amCÚ‹xts
 = 
¡»ams
.
¡»am
()

53 .
sÜ‹d
(
Com·¿tÜ
.
com·ršgLÚg
(
sc
 -> sc.
g‘La¡R—dAdd»ss
()))

54 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

56 
SŒ—mO±iÚs
 
	mİtiÚs
 = SŒ—mO±iÚs.
bud”
()

57 .
ÿcheEÁr›s
(
çl£
)

58 .
bud
();

60 
	mtxnSŒ—m
 = 
ruÁime
.
g‘SŒ—msV›w
()

61 .
g‘Un§ã
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
, 
İtiÚs
);

67 @
Ov”ride


68 
public
 
	$run
() {

69 
Œy
 {

70 
	`pŞlTxSŒ—m
();

71 } 
	`ÿtch
 (
ThrowabË
 
t
) {

74 
log
.
	`”rÜ
("EncouÁ”ed‡Àexû±iÚ whpŞlšghtxÀ¡»am: {}", 
t
);

76 
¡»amCÚ‹xts
.
	`fÜEach
(
sc
 -> sc.
	`£tPŞËrExû±iÚ
(
t
));

77 } 
fš®ly
 {

78 
¡»amCÚ‹xts
.
	`fÜEach
(
sc
 -> sc.
	`»Ëa£
());

80 
	}
}

82 
´iv©e
 
	$pŞlTxSŒ—m
() {

84 
Ï¡R—dAdd»ss
 = 
¡»amCÚ‹xts
.
	`g‘
(0).
	`g‘La¡R—dAdd»ss
();

86 
log
.
	`Œaû
("S“kšgxSŒ—mØ{}", 
Ï¡R—dAdd»ss
 + 1);

87 
txnSŒ—m
.
	`£ek
(
Ï¡R—dAdd»ss
 + 1);

88 
log
.
	`Œaû
("txStream current global…osition‡fter seeking {}, hasNext {}",

89 
txnSŒ—m
.
	`g‘Cu¼’tGlob®Pos™iÚ
(),xnSŒ—m.
	`hasNext
());

91 
Li¡
<
ILogD©a
> 
upd©es
 = 
txnSŒ—m
.
	`»maššg
();

93 
log
.
	`Œaû
("{} upd©e »maššg iÀthtxSŒ—m", 
upd©es
.
	`size
());

95 
ILogD©a
 
upd©e
 : 
upd©es
) {

96 
Li¡
<
SŒ—mšgSubsütiÚCÚ‹xt
> 
¡»amCÚ‹xtsNÙUpd©ed
 = 
Ãw
 
LškedLi¡
<>();

97 
SŒ—mšgSubsütiÚCÚ‹xt
 
sc
 : 
¡»amCÚ‹xts
) {

98 ià(!
sc
.
	`’queueSŒ—mEÁry
(
Ï¡R—dAdd»ss
, 
upd©e
)) {

101 
¡»amCÚ‹xtsNÙUpd©ed
.
	`add
(
sc
);

104 
Ï¡R—dAdd»ss
 = 
upd©e
.
	`g‘Glob®Add»ss
();

107 
¡»amCÚ‹xtsNÙUpd©ed
.
	`fÜEach
(
sc
 -> sc.
	`»Ëa£
());

108 
¡»amCÚ‹xts
.
	`»moveAÎ
(
¡»amCÚ‹xtsNÙUpd©ed
);

110 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/TxBuilder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
;

13 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

14 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

27 
public
 cÏs 
	cTxBud”
 {

29 
´iv©e
 
fš®
 
ObjeùsV›w
 
	mobjeùsV›w
;

30 
´iv©e
 
fš®
 
TabËRegi¡ry
 
	mbËRegi¡ry
;

31 
´iv©e
 
fš®
 
SŒšg
 
	mÇme¥aû
;

32 
´iv©e
 
Time¡amp
 
	mtime¡amp
;

33 
´iv©e
 
fš®
 
	mLi¡
<
	mRuÂabË
> 
	mİ”©iÚs
;

42 @
NÚnuÎ


43 
TxBud”
(@
NÚnuÎ
 
fš®
 
ObjeùsV›w
 
objeùsV›w
,

44 @
NÚnuÎ
 
fš®
 
TabËRegi¡ry
 
bËRegi¡ry
,

45 @
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
) {

46 
	mthis
.
	mobjeùsV›w
 = 
objeùsV›w
;

47 
	mthis
.
	mbËRegi¡ry
 = 
bËRegi¡ry
;

48 
	mthis
.
	mÇme¥aû
 = 
Çme¥aû
;

49 
	mthis
.
	mİ”©iÚs
 = 
Ãw
 
A¼ayLi¡
<>();

52 
	g´iv©e
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

53 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
g‘TabË
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
) {

54  
	gthis
.
	gbËRegi¡ry
.
g‘TabË
(
this
.
Çme¥aû
, 
bËName
);

67 @
NÚnuÎ


68 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

69 
TxBud”
 
ü—‹
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

70 @
NÚnuÎ
 
fš®
 
K
 
key
,

71 @
NÚnuÎ
 
fš®
 
V
 
v®ue
,

72 @
NuÎabË
 
fš®
 
M
 
m‘ad©a
) {

73 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	gbË
 = 
g‘TabË
(
bËName
);

74 
	gİ”©iÚs
.
add
(() -> {

75 
bË
.
ü—‹
(
key
, 
v®ue
, 
m‘ad©a
);

77  
	gthis
;

90 @
NÚnuÎ


91 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

92 
TxBud”
 
upd©e
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

93 @
NÚnuÎ
 
fš®
 
K
 
key
,

94 @
NÚnuÎ
 
fš®
 
V
 
v®ue
,

95 @
NuÎabË
 
fš®
 
M
 
m‘ad©a
) {

96 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	gbË
 = 
g‘TabË
(
bËName
);

97 
	gİ”©iÚs
.
add
(() -> {

98 
bË
.
upd©e
(
key
, 
v®ue
, 
m‘ad©a
);

100  
	gthis
;

109 
public
 
TxBud”
 
	$logUpd©e
(
SŒšg
 
bËName
, 
SMREÁry
 
upd©eEÁry
) {

111 
Œy
 {

112 ià(
bËRegi¡ry
.
	`g‘TabË
(
Çme¥aû
, 
bËName
è!ğ
nuÎ
) {

113 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("The…rovidedable is‡lready opened. "

115 + 
bËName
 + " iÀÇme¥aû " + 
Çme¥aû
);

117 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

119 ià(!(
e
 
š¡ªûof
 
IÎeg®Argum’tExû±iÚ
)) {

120 
throw
 
e
;

124 
UUID
 
¡»amId
 = UUID.
	`ÇmeUUIDFromBy‹s
((
TabËRegi¡ry
.
	`g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËName
).
	`g‘By‹s
()));

125 
İ”©iÚs
.
	`add
(() -> {

126 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`logUpd©e
(
¡»amId
, 
upd©eEÁry
);

128  
this
;

129 
	}
}

141 @
NÚnuÎ


142 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

143 
TxBud”
 
touch
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

144 @
NÚnuÎ
 
fš®
 
K
 
key
) {

145 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	gbË
 = 
g‘TabË
(
bËName
);

146 
	gİ”©iÚs
.
add
(() -> {

148 
CÜfuRecÜd
<
V
, 
M
> 
»cÜd
 = 
bË
.
g‘
(
key
);

150  
	gthis
;

162 @
NÚnuÎ


163 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

164 
TxBud”
 
d–‘e
(@
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

165 @
NÚnuÎ
 
fš®
 
K
 
key
) {

166 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	gbË
 = 
g‘TabË
(
bËName
);

167 
	gİ”©iÚs
.
add
((è-> 
bË
.
d–‘e
(
key
));

168  
	gthis
;

171 
´iv©e
 
	$txBegš
() {

172 
T¿n§ùiÚ
.
T¿n§ùiÚBud”
 
Œª§ùiÚBud”
 = 
this
.
objeùsV›w


173 .
	`TXBud
()

174 .
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
);

175 ià(
time¡amp
 !ğ
nuÎ
) {

176 
Œª§ùiÚBud”
.
	`¢­shÙ
(
Ãw
 
	`Tok’
(
time¡amp
.
	`g‘Epoch
(),ime¡amp.
	`g‘Sequ’û
()));

178 
Œª§ùiÚBud”
.
	`bud
().
	`begš
();

179 
	}
}

181 
´iv©e
 
	$txEnd
() {

182 
this
.
objeùsV›w
.
	`TXEnd
();

183 
	}
}

192 
public
 
	$comm™
() {

193 
	`comm™
(
nuÎ
);

194 
	}
}

205 
public
 
	$comm™
(
fš®
 
Time¡amp
 
time¡amp
) {

206 
this
.
time¡amp
 =imestamp;

207 
Œy
 {

208 
	`txBegš
();

209 
İ”©iÚs
.
	`fÜEach
(
RuÂabË
::
run
);

210 } 
fš®ly
 {

211 
	`txEnd
();

212 
İ”©iÚs
.
	`ş—r
();

214 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/TxnStreamingManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

15 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

16 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

18 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

26 @
Slf4j


27 
public
 cÏs 
	cTxnSŒ—mšgMªag”
 {

32 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

42 
´iv©e
 
fš®
 
	mM­
<
	mIÁeg”
, 
	mSŒ—mšgSubsütiÚCÚ‹xt
> 
	msubsütiÚs
 = 
Ãw
 
HashM­
<>();

47 
´iv©e
 
ExecutÜS”viû
 
	mpŞËrExecutÜ
 = 
ExecutÜs
.
ÃwFixedTh»adPoŞ
(1, (
r
) -> {

48 
Th»ad
 
t
 = 
ExecutÜs
.
deçuÉTh»adFaùÜy
().
ÃwTh»ad
(
r
);

49 
t
.
£tD«mÚ
(
Œue
);

50 
t
.
£tName
("TxnStreamingManagerPoller");

51  
t
;

57 
´iv©e
 
ExecutÜS”viû
 
	gnÙif›rExecutÜ
 = 
ExecutÜs
.
ÃwFixedTh»adPoŞ
(3, (
r
) -> {

58 
Th»ad
 
t
 = 
ExecutÜs
.
deçuÉTh»adFaùÜy
().
ÃwTh»ad
(
r
);

59 
t
.
£tD«mÚ
(
Œue
);

60 
t
.
£tName
("TxnStreamingManagerNotifier");

61  
t
;

67 
´iv©e
 
ScheduËdExecutÜS”viû
 
	gexecutÜ
 = 
ExecutÜs
.
ÃwSšgËTh»adScheduËdExecutÜ
((
r
) -> {

68 
Th»ad
 
t
 = 
ExecutÜs
.
deçuÉTh»adFaùÜy
().
ÃwTh»ad
(
r
);

69 
t
.
£tD«mÚ
(
Œue
);

70 
t
.
£tName
("TxnStreamingManagerScheduler");

71  
t
;

77 
´iv©e
 
fš®
 
	gINTERVAL
 = 50;

82 
´iv©e
 
fš®
 
	gMAX_NOTIFICATIONS
 = 25;

84 
public
 
TxnSŒ—mšgMªag”
(@
NÚnuÎ
 
CÜfuRuÁime
 
ruÁime
) {

85 
	gthis
.
	gruÁime
 = 
ruÁime
;

86 
	gexecutÜ
.
scheduËW™hFixedD–ay
(
this
::
scheduËTxnPŞlšg
, 0, 
INTERVAL
,

87 
TimeUn™
.
MILLISECONDS
);

88 
	gexecutÜ
.
scheduËW™hFixedD–ay
(
this
::
scheduËCl›ÁNÙifiÿtiÚ
, 
INTERVAL
, INTERVAL,

89 
TimeUn™
.
MILLISECONDS
);

100 
public
 
	gsynchrÚized
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

101 
subsüibe
(@
NÚnuÎ
 
SŒ—mLi¡’”
 
¡»amLi¡’”
, @NÚnuÎ 
SŒšg
 
Çme¥aû
,

102 @
NÚnuÎ
 
Li¡
<
TabËSchema
> 
bËsOfIÁ”e¡
, 
¡¬tAdd»ss
) {

104 ià(
	gsubsütiÚs
.
cÚšsKey
(
¡»amLi¡’”
.
hashCode
())) {

105 
	glog
.
”rÜ
("A stream†istener {} with hash code {}‡lready subscribed.",

106 
¡»amLi¡’”
.
toSŒšg
(), sŒ—mLi¡’”.
hashCode
());

110 
SŒ—mšgSubsütiÚCÚ‹xt
 
	gsc
 = 
Ãw
 SŒ—mšgSubsütiÚCÚ‹xt(
ruÁime
, 
¡»amLi¡’”
,

111 
Çme¥aû
, 
bËsOfIÁ”e¡
, 
¡¬tAdd»ss
);

113 
	gsubsütiÚs
.
put
(
¡»amLi¡’”
.
hashCode
(), 
sc
);

115 
	glog
.
šfo
("Subsüibed SŒ—mLi¡’” {}", 
sc
.
toSŒšg
());

123 
public
 
synchrÚized
 
unsubsüibe
(@
NÚnuÎ
 
SŒ—mLi¡’”
 
¡»amLi¡’”
) {

124 
SŒ—mšgSubsütiÚCÚ‹xt
 
	gsc
 = 
subsütiÚs
.
»move
(
¡»amLi¡’”
.
hashCode
());

125 ià(
	gsc
 !ğ
nuÎ
) {

126 
log
.
šfo
("Unsubsüibed SŒ—mLi¡’” {}", 
sc
.
toSŒšg
());

133 
´iv©e
 
synchrÚized
 
	$scheduËTxnPŞlšg
() {

135 
Li¡
<
IÁeg”
> 
keysToBeR—³d
 = 
subsütiÚs
.
	`’ŒyS‘
()

136 .
	`¡»am
()

137 .
	`f‹r
(
e
 ->ƒ.
	`g‘V®ue
().
	`isR—dyToBeR—³d
())

138 .
	`m­
(
e
 ->ƒ.
	`g‘Key
())

139 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

140 
keysToBeR—³d
.
	`fÜEach
(
k
 -> 
subsütiÚs
.
	`»move
(k));

143 
Li¡
<
SŒ—mšgSubsütiÚCÚ‹xt
> 
lockedSŒ—mšgSubsütiÚCÚ‹xts
 = 
subsütiÚs
.
	`v®ues
()

144 .
	`¡»am
()

145 .
	`f‹r
(
sc
 -> sc.
	`acquœe
())

146 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

148 ià(!
lockedSŒ—mšgSubsütiÚCÚ‹xts
.
	`isEm±y
()) {

149 
log
.
	`Œaû
("Locked {} StreamingSubscriptionContexts for…rocessing",

150 
lockedSŒ—mšgSubsütiÚCÚ‹xts
.
	`size
());

152 
pŞËrExecutÜ
.
	`subm™
(
Ãw
 
	`T¿n§ùiÚPŞËr
(
ruÁime
, 
lockedSŒ—mšgSubsütiÚCÚ‹xts
));

156 
	}
}

161 
´iv©e
 
	$scheduËCl›ÁNÙifiÿtiÚ
() {

162 
subsütiÚs
.
	`v®ues
().
	`¡»am
()

163 .
	`fÜEach
(
sc
 -> 
nÙif›rExecutÜ
.
	`subm™
((è-> sc.
	`nÙifyCl›Á
(
MAX_NOTIFICATIONS
)));

164 
	}
}

169 
public
 
	$shutdown
() {

170 
CÚsum”
<
ExecutÜS”viû
> 
shutdownExecutÜ
 = (
executÜ
) -> {

171 
executÜ
.
	`shutdown
();

172 
Œy
 {

173 ià(!
executÜ
.
	`awa™T”mš©iÚ
(5, 
TimeUn™
.
SECONDS
)) {

174 
executÜ
.
	`shutdownNow
();

176 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

177 
executÜ
.
	`shutdownNow
();

181 
Com¶‘abËFutu»
.
	`runAsync
((è-> 
shutdownExecutÜ
.
	`acû±
(
executÜ
));

182 
Com¶‘abËFutu»
.
	`runAsync
((è-> 
shutdownExecutÜ
.
	`acû±
(
pŞËrExecutÜ
));

183 
Com¶‘abËFutu»
.
	`runAsync
((è-> 
shutdownExecutÜ
.
	`acû±
(
nÙif›rExecutÜ
));

184 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/collections/WrappedRocksIterator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

4 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDBExû±iÚ
;

5 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksI‹¿tÜ
;

6 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksI‹¿tÜIÁ”çû
;

15 
public
 cÏs 
	cW¿µedRocksI‹¿tÜ
 
im¶em’ts
 
	mRocksI‹¿tÜIÁ”çû
 {

17 
´iv©e
 
fš®
 
RocksI‹¿tÜ
 
	m™”©Ü
;

18 
public
 
	$W¿µedRocksI‹¿tÜ
(
RocksI‹¿tÜ
 
™”©Ü
) {

19 
this
.
™”©Ü
 = iterator;

26 
´iv©e
 
	$checkHªdË
() {

27 ià(!
™”©Ü
.
	`isOwnšgHªdË
()) {

28 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("RocksIterator has been closed");

30 
	}
}

35 @
Ov”ride


36 
public
 
boŞ—n
 
	$isV®id
() {

37 
	`checkHªdË
();

38 
boŞ—n
 
»s
 = 
™”©Ü
.
	`isV®id
();

39 
	`¡©us
();

40  
»s
;

41 
	}
}

46 @
Ov”ride


47 
public
 
	$£ekToFœ¡
() {

48 
	`checkHªdË
();

49 
™”©Ü
.
	`£ekToFœ¡
();

50 
	`¡©us
();

51 
	}
}

56 @
Ov”ride


57 
public
 
	$£ekToLa¡
() {

58 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("seekToLast");

59 
	}
}

64 @
Ov”ride


65 
public
 
	$£ek
(
by‹
[] 
rg‘
) {

66 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("seek");

67 
	}
}

73 @
Ov”ride


74 
public
 
	$£ekFÜP»v
(
by‹
[] 
rg‘
){

75 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("seekForPrev");

76 
	}
}

82 @
Ov”ride


83 
public
 
	$Ãxt
() {

84 
	`checkHªdË
();

85 
™”©Ü
.
	`Ãxt
();

86 
	`¡©us
();

87 
	}
}

92 @
Ov”ride


93 
public
 
	$´ev
() {

94 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("prev");

95 
	}
}

100 
public
 
	gby‹
[] 
	$key
() {

101 
	`checkHªdË
();

102 
by‹
[] 
»s
 = 
™”©Ü
.
	`key
();

103 
	`¡©us
();

104  
»s
;

105 
	}
}

110 
public
 
	gby‹
[] 
	$v®ue
() {

111 
	`checkHªdË
();

112 
by‹
[] 
»s
 = 
™”©Ü
.
	`v®ue
();

113 
	`¡©us
();

114  
»s
;

115 
	}
}

121 @
Ov”ride


122 
public
 
	$¡©us
() {

123 
Œy
 {

124 
™”©Ü
.
	`¡©us
();

125 } 
	`ÿtch
 (
RocksDBExû±iÚ
 
e
) {

126 
throw
 
Ãw
 
	`UÄecov”abËCÜfuE¼Ü
("I‹¿tÜ i š‡Àšv®id s‹", 
e
);

128 
	}
}

130 
public
 
boŞ—n
 
	$isO³n
() {

131  
™”©Ü
.
	`isOwnšgHªdË
();

132 
	}
}

137 
public
 
	$şo£
() {

138 
™”©Ü
.
	`şo£
();

139 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/AbortCause.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

8 @
RequœedArgsCÚ¡ruùÜ


9 
public
 
	eAbÜtCau£
 {

12 
	mCONFLICT
,

13 
	mOVERWRITE
,

14 
	mNEW_SEQUENCER
,

15 
	mSIZE_EXCEEDED
,

16 
	mUSER
,

17 
	mNETWORK
,

18 
	mTRIM
,

19 
	mSEQUENCER_OVERFLOW
,

20 
	mSEQUENCER_TRIM
,

21 
	mQUOTA_EXCEEDED
,

22 
	mUNSUPPORTED
,

23 
	mUNDEFINED
;

	@runtime/src/main/java/org/corfudb/runtime/exceptions/AlreadyBootstrappedException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cAÌ—dyBoÙ¡¿µedExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

8 
public
 
	$AÌ—dyBoÙ¡¿µedExû±iÚ
() {

9 
	`su³r
("Server is‡lready bootstrapped");

12 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/AppendException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cAµ’dExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

	@runtime/src/main/java/org/corfudb/runtime/exceptions/DataCorruptionException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cD©aCÜru±iÚExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

8 
public
 
	$D©aCÜru±iÚExû±iÚ
() {

11 
public
 
	$D©aCÜru±iÚExû±iÚ
(
SŒšg
 
mes§ge
) {

12 
	`su³r
(
mes§ge
);

13 
	}
}

15 
public
 
	$D©aCÜru±iÚExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

16 
	`su³r
(
mes§ge
, 
ÿu£
);

17 
	}
}

19 
public
 
	$D©aCÜru±iÚExû±iÚ
(
ThrowabË
 
ÿu£
) {

20 
	`su³r
(
ÿu£
);

21 
	}
}

23 
public
 
	$D©aCÜru±iÚExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
, 
boŞ—n
 
’abËSuµ»ssiÚ
, boŞ—À
wr™abËSckT¿û
) {

24 
	`su³r
(
mes§ge
, 
ÿu£
, 
’abËSuµ»ssiÚ
, 
wr™abËSckT¿û
);

25 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/DataOutrankedException.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

14 
public
 cÏs 
	cD©aOuŒªkedExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

	@runtime/src/main/java/org/corfudb/runtime/exceptions/FastObjectLoaderException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

8 
public
 cÏs 
	cFa¡ObjeùLßd”Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

9 
public
 
	$Fa¡ObjeùLßd”Exû±iÚ
(
SŒšg
 
msg
) {

10 
	`su³r
(
msg
);

12 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/HoleFillRequiredException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

7 
public
 cÏs 
	cHŞeFlRequœedExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

9 
public
 
	$HŞeFlRequœedExû±iÚ
(
SŒšg
 
mes§ge
) {

10 
	`su³r
(
mes§ge
);

13 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/LayoutModificationException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

9 
public
 cÏs 
	cLayoutModifiÿtiÚExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

11 
public
 
	$LayoutModifiÿtiÚExû±iÚ
(
SŒšg
 
mes§ge
) {

12 
	`su³r
(
mes§ge
);

14 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/LogUnitException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cLogUn™Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

8 
public
 
	$LogUn™Exû±iÚ
() {

11 
public
 
	$LogUn™Exû±iÚ
(
SŒšg
 
mes§ge
) {

12 
	`su³r
(
mes§ge
);

13 
	}
}

15 
public
 
	$LogUn™Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

16 
	`su³r
(
mes§ge
, 
ÿu£
);

17 
	}
}

19 
public
 
	$LogUn™Exû±iÚ
(
ThrowabË
 
ÿu£
) {

20 
	`su³r
(
ÿu£
);

21 
	}
}

23 
public
 
	$LogUn™Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
, 
boŞ—n
 
’abËSuµ»ssiÚ
, boŞ—À
wr™abËSckT¿û
) {

24 
	`su³r
(
mes§ge
, 
ÿu£
, 
’abËSuµ»ssiÚ
, 
wr™abËSckT¿û
);

25 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/NetworkException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

9 
public
 cÏs 
	cN‘wÜkExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

11 @
G‘‹r


12 
NodeLoÿtÜ
 
	mnode
;

15 
public
 
	$N‘wÜkExû±iÚ
(
SŒšg
 
mes§ge
, 
NodeLoÿtÜ
 
node
) {

16 
	`su³r
(
mes§ge
 + " [’dpošt=" + 
node
.
	`toSŒšg
() + "]");

17 
this
.
node
 =‚ode;

20 
public
 
	$N‘wÜkExû±iÚ
(
SŒšg
 
mes§ge
, 
NodeLoÿtÜ
 
node
, 
ThrowabË
 
ÿu£
) {

21 
	`su³r
(
mes§ge
 + " [’dpošt=" + 
node
.
	`toSŒšg
(è+ "]", 
ÿu£
);

22 
this
.
node
 =‚ode;

23 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/NoBootstrapException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cNoBoÙ¡¿pExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

7 
public
 
	$NoBoÙ¡¿pExû±iÚ
() {

8 
	`su³r
("Layout server‚ot bootstrapped!");

10 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/NoRollbackException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

10 
public
 cÏs 
	cNoRŞlbackExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

12 
public
 
	$NoRŞlbackExû±iÚ
(
rŞlbackV”siÚ
) {

13 
	`su³r
(
SŒšg
.
	`fÜm©
(

15 
rŞlbackV”siÚ
)

19 
public
 
	$NoRŞlbackExû±iÚ
(
add»ss
, 
rŞlbackV”siÚ
) {

20 
	`su³r
(
SŒšg
.
	`fÜm©
(

22 
add»ss
,

23 
rŞlbackV”siÚ
)

25 
	}
}

27 
public
 
NoRŞlbackExû±iÚ
(
O±iÚ®
<
SMREÁry
> 
’Œy
, 
add»ss
, 
rŞlbackV”siÚ
) {

28 
su³r
(
SŒšg
.
fÜm©
("Can't„oll back dueo %s@%d but‚eed %d so can't undo",

29 
’Œy
.
m­
(
SMREÁry
::
g‘SMRM‘hod
).
ÜEl£
("Unknown Entry"),

30 
add»ss
,

31 
rŞlbackV”siÚ
)

	@runtime/src/main/java/org/corfudb/runtime/exceptions/OutOfSpaceException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cOutOfS·ûExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

	@runtime/src/main/java/org/corfudb/runtime/exceptions/OutrankedException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
public
 cÏs 
	cOuŒªkedExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

10 @
G‘‹r


11 
	mÃwRªk
;

13 @
G‘‹r


14 
Layout
 
	mÏyout
;

20 
public
 
	$OuŒªkedExû±iÚ
(
ÃwRªk
) {

21 
	`su³r
("High”„ªk " + 
ÃwRªk
 + "ƒncountered,†ayout =‚ull");

22 
this
.
ÃwRªk
 =‚ewRank;

23 
this
.
Ïyout
 = 
nuÎ
;

31 
public
 
	$OuŒªkedExû±iÚ
(
ÃwRªk
, 
Layout
 
Ïyout
) {

32 
	`su³r
("High”„ªk " + 
ÃwRªk
 + "ƒncouÁ”ed,†ayouˆğ" + ((
Ïyout
 =ğ
nuÎ
)

33 ? "nuÎ" : 
Ïyout
.
	`toSŒšg
()));

34 
this
.
ÃwRªk
 =‚ewRank;

35 
this
.
Ïyout
 =†ayout;

36 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/OverwriteCause.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

5 @
G‘‹r


6 
public
 
	eOv”wr™eCau£
 {

8 
HOLE
(0),

12 
SAME_DATA
(1),

14 
DIFF_DATA
(2),

16 
TRIM
(3),

18 
NONE
(4);

20 
´iv©e
 
	mid
;

21 
Ov”wr™eCau£
(
i
) {

22 
	mthis
.
	mid
 = 
i
;

25 
public
 
Ov”wr™eCau£
 
äomId
(
id
) {

26 
Ov”wr™eCau£
 
	mty³
 : 
v®ues
()) {

27 ià(
ty³
.
g‘Id
(è=ğ
id
) {

28  
ty³
;

31  
	mnuÎ
;

	@runtime/src/main/java/org/corfudb/runtime/exceptions/OverwriteException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

8 @
G‘‹r


9 
public
 cÏs 
	cOv”wr™eExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

10 
´iv©e
 
Ov”wr™eCau£
 
	mov”Wr™eCau£
;

12 
public
 
	$Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
 
ÿu£
) {

13 
this
.
ov”Wr™eCau£
 = 
ÿu£
;

15 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/QuorumUnreachableException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
public
 cÏs 
	cQuÜumUÄ—chabËExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

10 @
G‘‹r


11 
public
 
	m»achabË
;

13 @
G‘‹r


14 
public
 
	m»quœed
;

21 
public
 
	$QuÜumUÄ—chabËExû±iÚ
(
»achabË
, 
»quœed
) {

22 
	`su³r
("Couldn'ˆ»ach quÜum,„—chabË=" + 
»achabË
 + ",„equœed=" + 
»quœed
);

23 
this
.
»achabË
 =„eachable;

24 
this
.
»quœed
 =„equired;

26 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/QuotaExceededException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

4 
impÜt
 
	glombok
.
	gNoArgsCÚ¡ruùÜ
;

11 @
NoArgsCÚ¡ruùÜ


12 
public
 cÏs 
	cQuÙaExûededExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

13 
public
 
	$QuÙaExûededExû±iÚ
(
SŒšg
 
msg
) {

14 
	`su³r
("Disk usage hasƒxceededhe quota set, system is‚ow in„ead-only mode. "

15 + 
msg
);

17 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/RecoveryException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cRecov”yExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

7 
public
 
	$Recov”yExû±iÚ
(
SŒšg
 
mes§ge
) {

8 
	`su³r
(
mes§ge
);

10 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/RetryExhaustedException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

8 
public
 cÏs 
	cR‘ryExhau¡edExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

10 
public
 
	$R‘ryExhau¡edExû±iÚ
(
SŒšg
 
s
) {

11 
	`su³r
(
s
);

14 
public
 
	$R‘ryExhau¡edExû±iÚ
() {

15 
	}
}

17 
public
 
	$R‘ryExhau¡edExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

18 
	`su³r
(
mes§ge
, 
ÿu£
);

19 
	}
}

21 
public
 
	$R‘ryExhau¡edExû±iÚ
(
ThrowabË
 
ÿu£
) {

22 
	`su³r
(
ÿu£
);

23 
	}
}

25 
public
 
	$R‘ryExhau¡edExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
, 
boŞ—n
 
’abËSuµ»ssiÚ
, boŞ—À
wr™abËSckT¿û
) {

26 
	`su³r
(
mes§ge
, 
ÿu£
, 
’abËSuµ»ssiÚ
, 
wr™abËSckT¿û
);

27 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/SerializerException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cS”Ÿliz”Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

13 
public
 
	$S”Ÿliz”Exû±iÚ
(
By‹
 
ty³
) {

14 
	`su³r
("S”Ÿliz”y³ cod" + 
ty³
.
	`štV®ue
() + "‚ot found.");

22 
public
 
	$S”Ÿliz”Exû±iÚ
(
SŒšg
 
mes§ge
) {

23 
	`su³r
(
mes§ge
);

24 
	}
}

32 
public
 
	$S”Ÿliz”Exû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
ÿu£
) {

33 
	`su³r
(
mes§ge
, 
ÿu£
);

34 
	}
}

41 
public
 
	$S”Ÿliz”Exû±iÚ
(
ThrowabË
 
ÿu£
) {

42 
	`su³r
(
ÿu£
);

43 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/ServerNotReadyException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

6 
public
 cÏs 
	cS”v”NÙR—dyExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

8 
public
 
	$S”v”NÙR—dyExû±iÚ
() {

10 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/StaleTokenException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

14 
public
 cÏs 
	cSËTok’Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

15 @
G‘‹r


16 
´iv©e
 
fš®
 
	mcÜ»ùEpoch
;

18 
public
 
	$SËTok’Exû±iÚ
(
cÜ»ùEpoch
) {

19 
	`su³r
("SËok’ƒpoch. [ex³ùed=" + 
cÜ»ùEpoch
 + "]");

20 
this
.
cÜ»ùEpoch
 = correctEpoch;

22 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/TransactionAbortedException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

15 
public
 cÏs 
	cT¿n§ùiÚAbÜ‹dExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

17 @
G‘‹r


18 
AbÜtCau£
 
	mabÜtCau£
;

20 @
G‘‹r


21 
TxResŞutiÚInfo
 
	mtxResŞutiÚInfo
;

26 @
G‘‹r


27 
	mby‹
[] 
	mcÚæiùKey
;

32 @
G‘‹r


33 
UUID
 
	mcÚæiùSŒ—m
;

38 @
G‘‹r


39 
LÚg
 
	mofãndšgAdd»ss
;

41 @
G‘‹r


42 
ThrowabË
 
	mÿu£
;

44 @
G‘‹r


45 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	mcÚ‹xt
;

53 
public
 
	$T¿n§ùiÚAbÜ‹dExû±iÚ
(
TxResŞutiÚInfo
 
txResŞutiÚInfo
,

54 
by‹
[] 
cÚæiùKey
, 
UUID
 
cÚæiùSŒ—m
, 
LÚg
 
ofãndšgAdd»ss
, 
AbÜtCau£
 
abÜtCau£
,

55 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
cÚ‹xt
) {

56 
	`this
(
txResŞutiÚInfo
, 
cÚæiùKey
, 
cÚæiùSŒ—m
, 
ofãndšgAdd»ss
, 
abÜtCau£
, 
nuÎ
, 
cÚ‹xt
);

59 
public
 
	$T¿n§ùiÚAbÜ‹dExû±iÚ
(
TxResŞutiÚInfo
 
txResŞutiÚInfo
,

60 
AbÜtCau£
 
abÜtCau£
, 
ThrowabË
 
ÿu£
, 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
cÚ‹xt
) {

61 
	`this
(
txResŞutiÚInfo
, 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
, Tok’Re¥Ú£.
NO_CONFLICT_STREAM
,

62 
Add»ss
.
NON_ADDRESS
, 
abÜtCau£
, 
ÿu£
, 
cÚ‹xt
);

63 
	}
}

65 
public
 
	$T¿n§ùiÚAbÜ‹dExû±iÚ
(
TxResŞutiÚInfo
 
txResŞutiÚInfo
,

66 
by‹
[] 
cÚæiùKey
, 
UUID
 
cÚæiùSŒ—m
, 
LÚg
 
ofãndšgAdd»ss
,

67 
AbÜtCau£
 
abÜtCau£
, 
ThrowabË
 
ÿu£
, 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
cÚ‹xt
) {

68 
	`su³r
("TX ABORT "

69 + " | SÇpshÙ Timğ" + 
txResŞutiÚInfo
.
	`g‘SÇpshÙTime¡amp
()

70 + " | Faed T¿n§ùiÚ ID = " + 
txResŞutiÚInfo
.
	`g‘TXid
()

71 + " | Ofãndšg Add»s ğ" + 
ofãndšgAdd»ss


72 + " | CÚæiù Key = " + 
Uts
.
	`by‹sToHex
(
cÚæiùKey
)

73 + " | CÚæiù SŒ—m = " + 
cÚæiùSŒ—m


74 + " | Cau£ = " + 
abÜtCau£


75 + " | Timğ" + (
cÚ‹xt
 =ğ
nuÎ
 ? "Unknown" :

76 
Sy¡em
.
	`cu¼’tTimeMlis
() -

77 
cÚ‹xt
.
	`g‘S¹Time
()) + " ms"

78 + (
ÿu£
 =ğ
nuÎ
 ? "" : " | Mes§gğ" + cau£.
	`g‘Mes§ge
()));

79 
this
.
txResŞutiÚInfo
 =xResolutionInfo;

80 
this
.
cÚæiùKey
 = conflictKey;

81 
this
.
cÚæiùSŒ—m
 = conflictStream;

82 
this
.
ofãndšgAdd»ss
 = offendingAddress;

83 
this
.
abÜtCau£
 =‡bortCause;

84 
this
.
ÿu£
 = cause;

85 
this
.
cÚ‹xt
 = context;

86 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/TrimmedException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 @
Slf4j


14 
public
 cÏs 
	cTrimmedExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

20 @
	mG‘‹r


21 @
S‘‹r


22 
´iv©e
 
boŞ—n
 
	m»ŒŸbË
 = 
Œue
;

27 @
	mG‘‹r


28 @
S‘‹r


29 
´iv©e
 
	mLi¡
<
	mLÚg
> 
	mŒimmedAdd»s£s
;

31 
public
 
	$TrimmedExû±iÚ
() {

34 
public
 
	`TrimmedExû±iÚ
(
Li¡
<
LÚg
> 
Œimmed
) {

35 
	`su³r
(
SŒšg
.
	`fÜm©
("Trimmed‡dd»s£ %s", 
Œimmed
));

36 
log
.
	`”rÜ
("Trimmed‡dd»s£ {}", 
Œimmed
);

37 
ŒimmedAdd»s£s
 = 
Œimmed
;

38 
	}
}

40 
public
 
	$TrimmedExû±iÚ
(
SŒšg
 
mes§ge
) {

41 
	`su³r
(
mes§ge
);

42 
»ŒŸbË
 = 
Œue
;

43 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/TrimmedUpcallException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

10 
public
 cÏs 
	cTrimmedUpÿÎExû±iÚ
 
ex‹nds
 
	mTrimmedExû±iÚ
 {

12 
public
 
	$TrimmedUpÿÎExû±iÚ
(
add»ss
) {

13 
	`su³r
("A‰em±edØg‘ upÿÎ„esuÉ @" + 
add»ss


16 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/UnreachableClusterException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

8 
public
 cÏs 
	cUÄ—chabËClu¡”Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

10 
public
 
	$UÄ—chabËClu¡”Exû±iÚ
(
SŒšg
 
mes§ge
) {

11 
	`su³r
(
mes§ge
);

13 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/ValueAdoptedException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

11 @
AÎArgsCÚ¡ruùÜ


12 
public
 cÏs 
	cV®ueAdİ‹dExû±iÚ
 
ex‹nds
 
	mLogUn™Exû±iÚ
 {

13 @
G‘‹r


14 
´iv©e
 
R—dRe¥Ú£
 
	m»adRe¥Ú£
;

	@runtime/src/main/java/org/corfudb/runtime/exceptions/WorkflowException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

7 
public
 cÏs 
	cWÜkæowExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

8 
public
 
	$WÜkæowExû±iÚ
(
SŒšg
 
msg
) {

9 
	`su³r
(
msg
);

11 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/WorkflowResultUnknownException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

7 
public
 cÏs 
	cWÜkæowResuÉUnknownExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

	@runtime/src/main/java/org/corfudb/runtime/exceptions/WriteSizeException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

7 
public
 cÏs 
	cWr™eSizeExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

8 
public
 
	$Wr™eSizeExû±iÚ
(
size
, 
max
) {

9 
	`su³r
("TryšgØwr™" + 
size
 + " by‹ buˆmax wr™lim™ i " + 
max
 + " bytes");

11 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/WrongClusterException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

4 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUuidUts
;

8 
public
 cÏs 
	cWrÚgClu¡”Exû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

11 @
G‘‹r


12 
fš®
 
UUID
 
	mex³ùedClu¡”
;

15 @
G‘‹r


16 
fš®
 
UUID
 
	maùu®Clu¡”
;

23 
public
 
WrÚgClu¡”Exû±iÚ
(@
NuÎabË
 
UUID
 
ex³ùedClu¡”
,

24 @
NuÎabË
 
UUID
 
aùu®Clu¡”
) {

25 
su³r
("Expected: "

26 + ((
ex³ùedClu¡”
 =ğ
nuÎ
è? "nuÎ" : 
UuidUts
.
asBa£64
(expectedCluster))

28 + ((
aùu®Clu¡”
 =ğ
nuÎ
è? "nuÎ" : 
UuidUts
.
asBa£64
(actualCluster)));

29 
	mthis
.
	mex³ùedClu¡”
 = 
ex³ùedClu¡”
;

30 
	mthis
.
	maùu®Clu¡”
 = 
aùu®Clu¡”
;

	@runtime/src/main/java/org/corfudb/runtime/exceptions/WrongEpochException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
public
 cÏs 
	cWrÚgEpochExû±iÚ
 
ex‹nds
 
	mRuÁimeExû±iÚ
 {

9 @
G‘‹r


10 
fš®
 
	mcÜ»ùEpoch
;

12 
public
 
	$WrÚgEpochExû±iÚ
(
cÜ»ùEpoch
) {

13 
	`su³r
("WrÚgƒpoch. [ex³ùed=" + 
cÜ»ùEpoch
 + "]");

14 
this
.
cÜ»ùEpoch
 = correctEpoch;

16 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/unrecoverable/SystemUnavailableError.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
;

6 
public
 cÏs 
	cSy¡emUÇvaabËE¼Ü
 
ex‹nds
 
	mUÄecov”abËCÜfuE¼Ü
 {

7 
public
 
	$Sy¡emUÇvaabËE¼Ü
(
SŒšg
 
»asÚ
) {

8 
	`su³r
(
»asÚ
);

11 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/exceptions/unrecoverable/UnrecoverableCorfuError.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
;

3 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

8 
public
 cÏs 
	cUÄecov”abËCÜfuE¼Ü
 
ex‹nds
 
	mE¼Ü
 {

14 
public
 
UÄecov”abËCÜfuE¼Ü
(@
NÚnuÎ
 
ThrowabË
 
ÿu£
) {

15 
su³r
(
ÿu£
);

22 
public
 
UÄecov”abËCÜfuE¼Ü
(@
NÚnuÎ
 
SŒšg
 
mes§ge
) {

23 
su³r
(
mes§ge
);

31 
public
 
UÄecov”abËCÜfuE¼Ü
Ğ@
NÚnuÎ
 
SŒšg
 
mes§ge
,

32 @
NÚnuÎ
 
ThrowabË
 
ÿu£
) {

33 
su³r
(
mes§ge
, 
ÿu£
);

	@runtime/src/main/java/org/corfudb/runtime/exceptions/unrecoverable/UnrecoverableCorfuInterruptedError.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
;

3 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

12 
public
 cÏs 
	cUÄecov”abËCÜfuIÁ”ru±edE¼Ü
 
ex‹nds
 
	mUÄecov”abËCÜfuE¼Ü
 {

19 
public
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(@
NÚnuÎ
 
IÁ”ru±edExû±iÚ
 
ÿu£
) {

20 
su³r
(
ÿu£
);

22 
	mTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

31 
public
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
Ğ@
NÚnuÎ
 
SŒšg
 
mes§ge
,

32 @
NÚnuÎ
 
IÁ”ru±edExû±iÚ
 
ÿu£
) {

33 
su³r
(
mes§ge
, 
ÿu£
);

35 
	gTh»ad
.
cu¼’tTh»ad
().
š‹¼u±
();

	@runtime/src/main/java/org/corfudb/runtime/object/CorfuCompileProxy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gLÚg
.
	gmš
;

5 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gCouÁ”
;

6 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

7 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedUpÿÎExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gReæeùiÚUts
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

29 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

30 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

32 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

33 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

34 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

35 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

36 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

60 @
Slf4j


61 
public
 
şass
 
	gCÜfuCompeProxy
<
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
im¶em’ts
 
	gICÜfuSMRProxyIÁ”Çl
<T> {

69 @
G‘‹r


70 
	gV”siÚLockedObjeù
<
	gT
> 
	gund”lyšgObjeù
;

76 
fš®
 
CÜfuRuÁime
 
	g¹
;

81 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

82 
fš®
 
UUID
 
	g¡»amID
;

88 
fš®
 
	gCÏss
<
	gT
> 
	gty³
;

94 @
G‘‹r


95 
IS”Ÿliz”
 
	g£rŸliz”
;

100 
´iv©e
 
fš®
 
	gObjeù
[] 
	g¬gs
;

105 
´iv©e
 
fš®
 
Tim”
 
	gtim”Acûss
;

106 
´iv©e
 
fš®
 
Tim”
 
	gtim”LogWr™e
;

107 
´iv©e
 
fš®
 
Tim”
 
	gtim”Txn
;

108 
´iv©e
 
fš®
 
Tim”
 
	gtim”UpÿÎ
;

109 
´iv©e
 
fš®
 
CouÁ”
 
	gcouÁ”TxnR‘ry1
;

110 
´iv©e
 
fš®
 
CouÁ”
 
	gcouÁ”TxnR‘ryN
;

115 
´iv©e
 
fš®
 
Logg”
 
	gcÜ»ùÃssLogg”
 = 
Logg”FaùÜy
.
g‘Logg”
("correctness");

126 @
	gD•»ÿ‹d


127 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

128 
public
 
CÜfuCompeProxy
(
CÜfuRuÁime
 
¹
, 
UUID
 
¡»amID
, 
CÏss
<
T
> 
ty³
, 
Objeù
[] 
¬gs
,

129 
IS”Ÿliz”
 
£rŸliz”
, 
ICÜfuSMR
<
T
> 
w¿µ”Objeù


131 
	gthis
.
	g¹
 = 
¹
;

132 
	gthis
.
	g¡»amID
 = 
¡»amID
;

133 
	gthis
.
	gty³
 = 
ty³
;

134 
	gthis
.
	g¬gs
 = 
¬gs
;

135 
	gthis
.
	g£rŸliz”
 = 
£rŸliz”
;

139 
	gund”lyšgObjeù
 = 
Ãw
 
V”siÚLockedObjeù
<
T
>(
this
::
g‘NewIn¡ªû
,

140 
Ãw
 
SŒ—mV›wSMRAd­‹r
(
¹
,„t.
g‘SŒ—msV›w
().
g‘Un§ã
(
¡»amID
)),

141 
	gw¿µ”Objeù
);

143 
fš®
 
M‘ricRegi¡ry
 
	gm‘rics
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

144 
	gtim”Acûss
 = 
m‘rics
.
tim”
(
CÜfuCompÚ’t
.
OBJECT
 + "access");

145 
	gtim”LogWr™e
 = 
m‘rics
.
tim”
(
CÜfuCompÚ’t
.
OBJECT
 + "log-write");

146 
	gtim”Txn
 = 
m‘rics
.
tim”
(
CÜfuCompÚ’t
.
OBJECT
 + "txn");

147 
	gtim”UpÿÎ
 = 
m‘rics
.
tim”
(
CÜfuCompÚ’t
.
OBJECT
 + "upcall");

148 
	gcouÁ”TxnR‘ry1
 = 
m‘rics
.
couÁ”
(
CÜfuCompÚ’t
.
OBJECT
 + "txn-first-retry");

149 
	gcouÁ”TxnR‘ryN
 = 
m‘rics
.
couÁ”
(
CÜfuCompÚ’t
.
OBJECT
 + "txn-extra-retries");

155 @
Ov”ride


156 
	gpublic
 <
	gR
> 
R
 
·ssThrough
(
FunùiÚ
<
T
, R> 
m‘hod
) {

157  
	gund”lyšgObjeù
.
·ssThrough
(
m‘hod
);

163 @
Ov”ride


164 
	gpublic
 <
	gR
> 
R
 
acûss
(
ICÜfuSMRAcûss
<R, 
T
> 
acûssM‘hod
,

165 
Objeù
[] 
cÚæiùObjeù
) {

166 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
tim”Acûss
)) {

167  
acûssIÂ”
(
acûssM‘hod
, 
cÚæiùObjeù
);

171 
	g´iv©e
 <
	gR
> 
R
 
acûssIÂ”
(
ICÜfuSMRAcûss
<R, 
T
> 
acûssM‘hod
,

172 
Objeù
[] 
cÚæiùObjeù
) {

173 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
()) {

174 
	gŒy
 {

175  
	gT¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
()

176 .
acûss
(
this
, 
acûssM‘hod
, 
cÚæiùObjeù
);

177 } 
ÿtch
 (
Exû±iÚ
 
e
) {

178 
	glog
.
”rÜ
("Acûss[{}]", 
this
, 
e
);

179 
	gthis
.
abÜtT¿n§ùiÚ
(
e
);

184 
	gx
 = 0; x < 
	g¹
.
g‘P¬am‘”s
().
g‘TrimR‘ry
(); x++) {

186 
fš®
 
	gtime¡amp
 = 
¹
.
g‘Sequ’ûrV›w
()

187 .
qu”y
(
g‘SŒ—mID
());

188 
	glog
.
debug
("Acûss[{}] cÚæiùObj={} v”siÚ={}", 
this
, 
cÚæiùObjeù
, 
time¡amp
);

190 
	gŒy
 {

191  
	gund”lyšgObjeù
.
acûss
(
o
 -> o.
g‘V”siÚUn§ã
(è>ğ
time¡amp


192 && !
o
.
isO±imi¡iÿÎyModif›dUn§ã
(),

193 
o
 -> o.
syncObjeùUn§ã
(
time¡amp
),

194 
o
 -> 
acûssM‘hod
.
acûss
(o));

195 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

196 
	glog
.
šfo
("accessInner: Encounteredrimmed‡ddress space " +

198 
time¡amp
, 
g‘SŒ—mID
(), 
x
);

200 
	gund”lyšgObjeù
.
upd©e
(
o
 -> {

201 
o
.
»£tUn§ã
();

202  
nuÎ
;

207 
throw
 
Ãw
 
TrimmedExû±iÚ
();

213 @
Ov”ride


214 
public
 
logUpd©e
(
SŒšg
 
smrUpd©eFunùiÚ
, 
fš®
 
boŞ—n
 
k“pUpÿÎResuÉ
,

215 
Objeù
[] 
cÚæiùObjeù
, Objeù... 
¬gs
) {

216 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
tim”LogWr™e
)) {

217  
logUpd©eIÂ”
(
smrUpd©eFunùiÚ
, 
k“pUpÿÎResuÉ
, 
cÚæiùObjeù
, 
¬gs
);

221 
´iv©e
 
logUpd©eIÂ”
(
SŒšg
 
smrUpd©eFunùiÚ
, 
fš®
 
boŞ—n
 
k“pUpÿÎResuÉ
,

222 
Objeù
[] 
cÚæiùObjeù
, Objeù... 
¬gs
) {

225 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
()) {

226 
	gŒy
 {

228 
SMREÁry
 
	g’Œy
 = 
Ãw
 SMREÁry(
smrUpd©eFunùiÚ
, 
¬gs
, 
£rŸliz”
);

229  
	gT¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
()

230 .
logUpd©e
(
this
, 
’Œy
, 
cÚæiùObjeù
);

231 } 
ÿtch
 (
Exû±iÚ
 
e
) {

232 
	glog
.
w¬n
("Upd©e[{}]", 
this
, 
e
);

233 
	gthis
.
abÜtT¿n§ùiÚ
(
e
);

239 
SMREÁry
 
	gsmrEÁry
 = 
Ãw
 SMREÁry(
smrUpd©eFunùiÚ
, 
¬gs
, 
£rŸliz”
);

240 
	gadd»ss
 = 
und”lyšgObjeù
.
logUpd©e
(
smrEÁry
, 
k“pUpÿÎResuÉ
);

241 
	glog
.
Œaû
("Update[{}] {}@{} ({}) conflictObj={}",

242 
this
, 
smrUpd©eFunùiÚ
, 
add»ss
, 
¬gs
, 
cÚæiùObjeù
);

243 
	gcÜ»ùÃssLogg”
.
Œaû
("V”siÚ, {}", 
add»ss
);

244  
	gadd»ss
;

250 @
Ov”ride


251 
	gpublic
 <
	gR
> 
R
 
g‘UpÿÎResuÉ
(
time¡amp
, 
Objeù
[] 
cÚæiùObjeù
) {

252 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
tim”UpÿÎ
);) {

253  
g‘UpÿÎResuÉIÂ”
(
time¡amp
, 
cÚæiùObjeù
);

257 
	g´iv©e
 <
	gR
> 
R
 
g‘UpÿÎResuÉIÂ”
(
time¡amp
, 
Objeù
[] 
cÚæiùObjeù
) {

260 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
()) {

261 
	gŒy
 {

262  (
	gR
è
	gT¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
()

263 .
g‘UpÿÎResuÉ
(
this
, 
time¡amp
, 
cÚæiùObjeù
);

264 } 
ÿtch
 (
Exû±iÚ
 
e
) {

265 
	glog
.
w¬n
("UpÿÎResuÉ[{}] Exû±iÚ: {}", 
this
, 
e
);

266 
	gthis
.
abÜtT¿n§ùiÚ
(
e
);

272 ià(
	gund”lyšgObjeù
.
g‘UpÿÎResuÉs
().
cÚšsKey
(
time¡amp
)) {

273 
	glog
.
Œaû
("UpÿÎ[{}] {} Dœeù", 
this
, 
time¡amp
);

274 
R
 
	g»t
 = (Rè
und”lyšgObjeù
.
g‘UpÿÎResuÉs
().
g‘
(
time¡amp
);

275 
	gund”lyšgObjeù
.
g‘UpÿÎResuÉs
().
»move
(
time¡amp
);

276  
	g»t
 =ğ
V”siÚLockedObjeù
.
NuÎV®ue
.
NULL_VALUE
 ? 
nuÎ
 : 
»t
;

279 
	gx
 = 0; x < 
	g¹
.
g‘P¬am‘”s
().
g‘TrimR‘ry
(); x++) {

280 
	gŒy
 {

281  
	gund”lyšgObjeù
.
upd©e
(
o
 -> {

282 
o
.
syncObjeùUn§ã
(
time¡amp
);

283 ià(
o
.
g‘UpÿÎResuÉs
().
cÚšsKey
(
time¡amp
)) {

284 
log
.
Œaû
("UpÿÎ[{}] {} Sync'd", 
this
, 
time¡amp
);

285 
R
 
»t
 = (Rè
o
.
g‘UpÿÎResuÉs
().
g‘
(
time¡amp
);

286 
o
.
g‘UpÿÎResuÉs
().
»move
(
time¡amp
);

287  
»t
 =ğ
V”siÚLockedObjeù
.
NuÎV®ue
.
NULL_VALUE
 ? 
nuÎ
 :„et;

294 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Attemptedo gethe„esult "

295 + "oàª upÿÎ@" + 
time¡amp
 + " but we‡re @"

296 + 
und”lyšgObjeù
.
g‘V”siÚUn§ã
()

299 } 
ÿtch
 (
TrimmedExû±iÚ
 
ex
) {

300 
	glog
.
šfo
("getUpcallResultInner: Encounteredrimmed‡ddress space " +

302 
time¡amp
, 
g‘SŒ—mID
(), 
x
);

304 
	gund”lyšgObjeù
.
upd©e
(
o
 -> {

305 
o
.
»£tUn§ã
();

306  
nuÎ
;

311 
throw
 
Ãw
 
TrimmedUpÿÎExû±iÚ
(
time¡amp
);

319 @
Ov”ride


320 
public
 
UUID
 
g‘SŒ—mID
() {

321  
	g¡»amID
;

330 @
Ov”ride


331 
	gpublic
 <
	gR
> 
R
 
TXExecu‹
(
Suµl›r
<R> 
txFunùiÚ
) {

332 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
tim”Txn
)) {

333  
TXExecu‹IÂ”
(
txFunùiÚ
);

337 @
Suµ»ssW¬nšgs
({"checkstyle:membername", "checkstyle:abbreviation"})

338 
	g´iv©e
 <
	gR
> 
R
 
TXExecu‹IÂ”
(
Suµl›r
<R> 
txFunùiÚ
) {

340 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
()) {

341 
	gŒy
 {

342  
	gtxFunùiÚ
.
g‘
();

343 } 
ÿtch
 (
Exû±iÚ
 
e
) {

344 
	glog
.
w¬n
("TXExecu‹[{}] AbÜˆw™h Exû±iÚ: {}", 
this
, 
e
);

345 
	gthis
.
abÜtT¿n§ùiÚ
(
e
);

348 
	g¦“pTime
 = 1L;

349 
fš®
 
	gmaxSË•Time
 = 1000L;

350 
	g»Œ›s
 = 1;

351 
	gŒue
) {

352 
	gŒy
 {

353 
	g¹
.
g‘ObjeùsV›w
().
TXBegš
();

354 
R
 
	g»t
 = 
txFunùiÚ
.
g‘
();

355 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

356  
	g»t
;

357 } 
ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

362 
	glog
.
w¬n
("TXExecu‹[{}] AbÜˆw™hƒxû±iÚ {}", 
this
, 
e
);

363 ià(
	ge
.
g‘AbÜtCau£
(è=ğ
AbÜtCau£
.
NETWORK
) {

364 ià(
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
(è!ğ
nuÎ
) {

365 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
().
abÜtT¿n§ùiÚ
(
e
);

366 
	gT¿n§ùiÚ®CÚ‹xt
.
»moveCÚ‹xt
();

367 
throw
 
	ge
;

371 ià(
	g»Œ›s
 == 1) {

372 
M‘ricsUts


373 .
šcCÚd™iÚ®CouÁ”
(
couÁ”TxnR‘ry1
, 1);

375 
	gM‘ricsUts
.
šcCÚd™iÚ®CouÁ”
(
couÁ”TxnR‘ryN
, 1);

376 
	glog
.
debug
("Transactional function‡borted dueo {},„etrying‡fter {} msec",

377 
e
, 
¦“pTime
);

378 
	gSË•
.
¦“pUnš‹¼u±ibly
(
Du¿tiÚ
.
ofMlis
(
¦“pTime
));

379 
	g¦“pTime
 = 
mš
(
¦“pTime
 * 2L, 
maxSË•Time
);

380 
	g»Œ›s
++;

381 } 
ÿtch
 (
Exû±iÚ
 
e
) {

382 
	glog
.
w¬n
("TXExecu‹[{}] AbÜˆw™h Exû±iÚ: {}", 
this
, 
e
);

383 
	gthis
.
abÜtT¿n§ùiÚ
(
e
);

393 @
Ov”ride


394 
public
 
	gCÏss
<
	gT
> 
g‘ObjeùTy³
() {

395  
	gty³
;

403 @
Ov”ride


404 
public
 
g‘V”siÚ
() {

405  
acûss
(
o
 -> 
und”lyšgObjeù
.
g‘V”siÚUn§ã
(),

406 
nuÎ
);

414 @
Suµ»ssW¬nšgs
("unchecked")

415 
´iv©e
 
T
 
g‘NewIn¡ªû
() {

416 
	gŒy
 {

417 
T
 
	g»t
 = (Tè
ReæeùiÚUts


418 .
fšdM©chšgCÚ¡ruùÜ
(
ty³
.
g‘Deş¬edCÚ¡ruùÜs
(), 
¬gs
);

419 ià(
»t
 
š¡ªûof
 
	gICÜfuSMRProxyW¿µ”
) {

420 ((
	gICÜfuSMRProxyW¿µ”
<
	gT
>è
	g»t
).
£tProxy$CORFUSMR
(
this
);

422  
	g»t
;

423 } 
ÿtch
 (
In¡ªtŸtiÚExû±iÚ
 | 
IÎeg®AcûssExû±iÚ
 | 
InvoÿtiÚT¬g‘Exû±iÚ
 
e
) {

424 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
e
);

428 @
Ov”ride


429 
public
 
SŒšg
 
toSŒšg
() {

430  
	gty³
.
g‘Sim¶eName
(è+ "[" + 
	gUts
.
toR—dabËId
(
¡»amID
) + "]";

433 
´iv©e
 
abÜtT¿n§ùiÚ
(
Exû±iÚ
 
e
) {

434 
fš®
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	gcÚ‹xt
 = 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
();

435 
	gT¿n§ùiÚ®CÚ‹xt
.
»moveCÚ‹xt
();

438 ià(
e
 
š¡ªûof
 
	gT¿n§ùiÚAbÜ‹dExû±iÚ
) {

439 
throw
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
è
	ge
;

442 
Tok’
 
	g¢­shÙTime¡amp
 = Tok’.
UNINITIALIZED
;

443 
AbÜtCau£
 
	gabÜtCau£
 = AbÜtCau£.
UNDEFINED
;

445 ià(
e
 
š¡ªûof
 
	gN‘wÜkExû±iÚ
) {

450 
	gabÜtCau£
 = 
AbÜtCau£
.
NETWORK
;

451 } ià(
e
 
š¡ªûof
 
	gUnsuµÜ‹dO³¿tiÚExû±iÚ
) {

452 
	g¢­shÙTime¡amp
 = 
cÚ‹xt
.
g‘SÇpshÙTime¡amp
();

453 
	gabÜtCau£
 = 
AbÜtCau£
.
UNSUPPORTED
;

455 
	glog
.
”rÜ
("abÜtT¿n§ùiÚ[{}] AbÜˆT¿n§ùiÚ w™h Exû±iÚ {}", 
this
, 
e
);

456 
	g¢­shÙTime¡amp
 = 
cÚ‹xt
.
g‘SÇpshÙTime¡amp
();

459 
fš®
 
TxResŞutiÚInfo
 
	gtxInfo
 = 
Ãw
 TxResolutionInfo(

460 
cÚ‹xt
.
g‘T¿n§ùiÚID
(), 
¢­shÙTime¡amp
);

461 
fš®
 
T¿n§ùiÚAbÜ‹dExû±iÚ
 
	ge
 = 
Ãw
 T¿n§ùiÚAbÜ‹dExû±iÚ(
txInfo
,

462 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
, 
g‘SŒ—mID
(), 
Add»ss
.
NON_ADDRESS
,

463 
abÜtCau£
, 
e
, 
cÚ‹xt
);

464 
	gcÚ‹xt
.
abÜtT¿n§ùiÚ
(
e
);

466 
throw
 
	ge
;

	@runtime/src/main/java/org/corfudb/runtime/object/CorfuCompileWrapperBuilder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSMRObjeù
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gReæeùiÚUts
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

15 
public
 cÏs 
	cCÜfuCompeW¿µ”Bud”
 {

32 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

33 
public
 <
T
 
ex‹nds
 
	mICÜfuSMR
<
	mT
>> T 
g‘W¿µ”
(
CÏss
<T> 
ty³
, 
CÜfuRuÁime
 
¹
,

34 
UUID
 
¡»amID
, 
Objeù
[] 
¬gs
,

35 
IS”Ÿliz”
 
£rŸliz”
)

36 
throws
 
	mExû±iÚ
 {

38 
	mCÏss
<
	mICÜfuSMR
<
	mT
>> 
	mw¿µ”CÏss
 = (
CÏss
<
ICÜfuSMR
<
T
>>)

39 
CÏss
.
fÜName
(
ty³
.
g‘Name
(è+ 
ICÜfuSMR
.
CORFUSMR_SUFFIX
);

42 
	mICÜfuSMR
<
	mT
> 
	mw¿µ”Objeù
 = (
ICÜfuSMR
<
T
>è
ReæeùiÚUts
.

43 
fšdM©chšgCÚ¡ruùÜ
(
w¿µ”CÏss
.
g‘Deş¬edCÚ¡ruùÜs
(), 
¬gs
);

47 
	mw¿µ”Objeù
.
£tCÜfuSMRProxy
(
Ãw
 
CÜfuCompeProxy
<
T
>(
¹
, 
¡»amID
,

48 
ty³
, 
¬gs
, 
£rŸliz”
, 
w¿µ”Objeù
));

50 ià(
w¿µ”Objeù
 
š¡ªûof
 
	mICÜfuSMRProxyW¿µ”
) {

51 ((
	mICÜfuSMRProxyW¿µ”
è
	mw¿µ”Objeù
)

52 .
£tProxy$CORFUSMR
(
w¿µ”Objeù
.
g‘CÜfuSMRProxy
());

55  (
	mT
è
	mw¿µ”Objeù
;

58 
public
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> T 
g‘W¿µ”
(
SMRObjeù
<T> 
smrObjeù
è
throws
 
	gExû±iÚ
 {

59  
g‘W¿µ”
(
smrObjeù
.
g‘Ty³
(),

60 
smrObjeù
.
g‘RuÁime
(),

61 
smrObjeù
.
g‘SŒ—mID
(),

62 
smrObjeù
.
g‘Argum’ts
(),

63 
smrObjeù
.
g‘S”Ÿliz”
());

	@runtime/src/main/java/org/corfudb/runtime/object/ICorfuSMRProxyInternal.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

14 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

15 
public
 
š‹rçû
 
	gICÜfuSMRProxyIÁ”Çl
<
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>>ƒx‹nd 
	gICÜfuSMRProxy
<T> {

21 
	gV”siÚLockedObjeù
<
	gT
> 
g‘Und”lyšgObjeù
();

28 
IS”Ÿliz”
 
g‘S”Ÿliz”
();

	@runtime/src/main/java/org/corfudb/runtime/object/ISMRStream.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

23 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

24 
public
 
š‹rçû
 
	gISMRSŒ—m
 {

27 
	gLi¡
<
	gSMREÁry
> 
»maššgUpTo
(
maxGlob®
);

29 
	gLi¡
<
	gSMREÁry
> 
cu¼’t
();

31 
	gLi¡
<
	gSMREÁry
> 
´evious
();

33 
pos
();

35 
»£t
();

37 
£ek
(
glob®Add»ss
);

39 
gc
(
ŒimM¬k
);

41 
	gSŒ—m
<
	gSMREÁry
> 
¡»am
();

43 
	gSŒ—m
<
	gSMREÁry
> 
¡»amUpTo
(
maxGlob®
);

64 
­³nd
(
SMREÁry
 
’Œy
,

65 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
acquis™iÚC®lback
,

66 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
d—cquis™iÚC®lback
);

73 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

74 
UUID
 
g‘ID
();

	@runtime/src/main/java/org/corfudb/runtime/object/StreamViewSMRAdapter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gISMRCÚsumabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

13 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

32 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

33 
public
 cÏs 
	cSŒ—mV›wSMRAd­‹r
 
im¶em’ts
 
	mISMRSŒ—m
 {

38 
fš®
 
ISŒ—mV›w
 
	m¡»amV›w
;

43 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

45 
public
 
	$SŒ—mV›wSMRAd­‹r
(
CÜfuRuÁime
 
ruÁime
,

46 
ISŒ—mV›w
 
¡»amV›w
) {

47 
this
.
ruÁime
 =„untime;

48 
this
.
¡»amV›w
 = streamView;

51 
´iv©e
 
Li¡
<
SMREÁry
> 
	$d©aAndCheckpoštM­³r
(
ILogD©a
 
logD©a
) {

52 ià(
logD©a
.
	`hasCheckpoštM‘ad©a
()) {

54 
CheckpoštEÁry
 
ı
 = (CheckpoštEÁryè
logD©a
.
	`g‘Paylßd
(
ruÁime
);

55 ià(
ı
.
	`g‘SmrEÁr›s
(è!ğ
nuÎ


56 && 
ı
.
	`g‘SmrEÁr›s
().
	`g‘Upd©es
().
	`size
() > 0) {

57 
ı
.
	`g‘SmrEÁr›s
().
	`g‘Upd©es
().
	`fÜEach
(
e
 -> {

58 
e
.
	`£tRuÁime
(
ruÁime
);

59 
e
.
	`£tGlob®Add»ss
(
logD©a
.
	`g‘Glob®Add»ss
());

61  
ı
.
	`g‘SmrEÁr›s
().
	`g‘Upd©es
();

63  (
Li¡
<
SMREÁry
>è
CŞËùiÚs
.
EMPTY_LIST
;

66  ((
ISMRCÚsumabË
è
logD©a
.
	`g‘Paylßd
(
ruÁime
)).
	`g‘SMRUpd©es
(
¡»amV›w
.
	`g‘Id
());

68 
	}
}

70 @
Ov”ride


71 
public
 
	$gc
(
ŒimM¬k
) {

72 
¡»amV›w
.
	`gc
(
ŒimM¬k
);

73 
	}
}

81 
public
 
	gLi¡
<
	gSMREÁry
> 
	$»maššgUpTo
(
maxGlob®
) {

82  
¡»amV›w
.
	`»maššgUpTo
(
maxGlob®
).
	`¡»am
()

83 .
	`f‹r
(
m
 -> m.
	`g‘Ty³
(è=ğ
D©aTy³
.
DATA
)

84 .
	`f‹r
(
m
 -> m.
	`g‘Paylßd
(
ruÁime
è
š¡ªûof
 
ISMRCÚsumabË


85 || 
m
.
	`hasCheckpoštM‘ad©a
())

86 .
	`m­
(
this
::
d©aAndCheckpoštM­³r
)

87 .
	`æ©M­
(
Li¡
::
¡»am
)

88 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

89 
	}
}

97 
public
 
	gLi¡
<
	gSMREÁry
> 
	$cu¼’t
() {

98 
ILogD©a
 
d©a
 = 
¡»amV›w
.
	`cu¼’t
();

99 ià(
d©a
 =ğ
nuÎ


100 || 
d©a
.
	`g‘Ty³
(è!ğ
D©aTy³
.
DATA


101 || !(
d©a
.
	`g‘Paylßd
(
ruÁime
è
š¡ªûof
 
ISMRCÚsumabË
)) {

102  
CŞËùiÚs
.
	`em±yLi¡
();

105  ((
ISMRCÚsumabË
è
d©a
.
	`g‘Paylßd
(
ruÁime
)).
	`g‘SMRUpd©es
(
¡»amV›w
.
	`g‘Id
());

106 
	}
}

114 
public
 
	gLi¡
<
	gSMREÁry
> 
	$´evious
() {

115 
ILogD©a
 
d©a
 = 
¡»amV›w
.
	`´evious
();

116 
Add»ss
.
	`isAdd»ss
(
¡»amV›w
.
	`g‘Cu¼’tGlob®Pos™iÚ
())

117 && 
d©a
 !ğ
nuÎ
) {

118 ià(
d©a
.
	`g‘Ty³
(è=ğ
D©aTy³
.
DATA


119 && 
d©a
.
	`g‘Paylßd
(
ruÁime
è
š¡ªûof
 
ISMRCÚsumabË
) {

120  ((
ISMRCÚsumabË
è
d©a
.
	`g‘Paylßd
(
ruÁime
))

121 .
	`g‘SMRUpd©es
(
¡»amV›w
.
	`g‘Id
());

123 
d©a
 = 
¡»amV›w
.
	`´evious
();

126  
CŞËùiÚs
.
	`em±yLi¡
();

127 
	}
}

129 
public
 
	$pos
() {

130  
¡»amV›w
.
	`g‘Cu¼’tGlob®Pos™iÚ
();

131 
	}
}

133 
public
 
	$»£t
() {

134 
¡»amV›w
.
	`»£t
();

135 
	}
}

137 
public
 
	$£ek
(
glob®Add»ss
) {

138 
¡»amV›w
.
	`£ek
(
glob®Add»ss
);

139 
	}
}

141 @
Ov”ride


142 
public
 
	gSŒ—m
<
	gSMREÁry
> 
	$¡»am
() {

143  
	`¡»amUpTo
(
Add»ss
.
MAX
);

144 
	}
}

146 @
Ov”ride


147 
public
 
	gSŒ—m
<
	gSMREÁry
> 
	$¡»amUpTo
(
maxGlob®
) {

148  
¡»amV›w
.
	`¡»amUpTo
(
maxGlob®
)

149 .
	`f‹r
(
m
 -> m.
	`g‘Ty³
(è=ğ
D©aTy³
.
DATA
)

150 .
	`f‹r
(
m
 -> m.
	`g‘Paylßd
(
ruÁime
è
š¡ªûof
 
ISMRCÚsumabË


151 || 
m
.
	`hasCheckpoštM‘ad©a
())

152 .
	`m­
(
this
::
d©aAndCheckpoštM­³r
)

153 .
	`æ©M­
(
Li¡
::
¡»am
);

154 
	}
}

175 
public
 
­³nd
(
SMREÁry
 
’Œy
,

176 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
acquis™iÚC®lback
,

177 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
d—cquis™iÚC®lback
) {

178  
	g¡»amV›w
.
­³nd
(
’Œy
, 
acquis™iÚC®lback
, 
d—cquis™iÚC®lback
);

184 @
Ov”ride


185 
public
 
UUID
 
	$g‘ID
() {

186  
¡»amV›w
.
	`g‘Id
();

187 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/VersionLockedObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoRŞlbackExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gWr™eS‘SMRSŒ—m
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

17 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”
;

18 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gLi¡I‹¿tÜ
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

24 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

25 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gSm³dLock
;

28 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

29 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

30 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

50 @
Slf4j


51 
public
 
şass
 
	gV”siÚLockedObjeù
<
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> {

55 @
G‘‹r


56 
´iv©e
 
T
 
	gobjeù
;

62 @
G‘‹r


63 
´iv©e
 
fš®
 
	gS‘
<
	gLÚg
> 
	g³ndšgUpÿÎs
;

67 
	eNuÎV®ue
 {

68 
	gNULL_VALUE


74 @
G‘‹r


75 
´iv©e
 
fš®
 
	gM­
<
	gLÚg
, 
	gObjeù
> 
	gupÿÎResuÉs
;

82 
´iv©e
 
fš®
 
Sm³dLock
 
	glock
;

87 
´iv©e
 
fš®
 
ISMRSŒ—m
 
	gsmrSŒ—m
;

92 
´iv©e
 
Wr™eS‘SMRSŒ—m
 
	gİtimi¡icSŒ—m
;

97 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gT
>> 
	gupÿÎT¬g‘M­
;

102 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gT
>> 
	gundoRecÜdFunùiÚM­
;

107 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gT
>> 
	gundoFunùiÚM­
;

112 
´iv©e
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘
;

117 
´iv©e
 
fš®
 
	gSuµl›r
<
	gT
> 
	gÃwObjeùFn
;

122 
´iv©e
 
fš®
 
Logg”
 
	gcÜ»ùÃssLogg”
 = 
Logg”FaùÜy
.
g‘Logg”
("correctness");

131 
public
 
V”siÚLockedObjeù
(
Suµl›r
<
T
> 
ÃwObjeùFn
,

132 
SŒ—mV›wSMRAd­‹r
 
smrSŒ—m
,

133 
ICÜfuSMR
<
T
> 
w¿µ”Objeù
) {

134 
	gthis
.
	gsmrSŒ—m
 = 
smrSŒ—m
;

136 
	gthis
.
	gupÿÎT¬g‘M­
 = 
w¿µ”Objeù
.
g‘CÜfuSMRUpÿÎM­
();

137 
	gthis
.
	gundoRecÜdFunùiÚM­
 = 
w¿µ”Objeù
.
g‘CÜfuUndoRecÜdM­
();

138 
	gthis
.
	gundoFunùiÚM­
 = 
w¿µ”Objeù
.
g‘CÜfuUndoM­
();

139 
	gthis
.
	g»£tS‘
 = 
w¿µ”Objeù
.
g‘CÜfuRe£tS‘
();

141 
	gw¿µ”Objeù
.
şo£W¿µ”
();

142 
	gthis
.
	gÃwObjeùFn
 = 
ÃwObjeùFn
;

143 
	gthis
.
	gobjeù
 = 
ÃwObjeùFn
.
g‘
();

144 
	gthis
.
	g³ndšgUpÿÎs
 = 
CÚcu¼’tHashM­
.
ÃwKeyS‘
();

145 
	gthis
.
	gupÿÎResuÉs
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

147 
	glock
 = 
Ãw
 
Sm³dLock
();

154 
public
 
gc
(
ŒimM¬k
) {

155 
	gts
 = 0;

157 
Œy
 (
Tim”
.
CÚ‹xt
 
vloGcDu¿tiÚ
 = 
VloM‘ricsH–³r
.
g‘VloGcCÚ‹xt
()) {

158 
ts
 = 
lock
.
wr™eLock
();

159 
	g³ndšgUpÿÎs
.
»moveIf
(
e
 ->ƒ < 
ŒimM¬k
);

160 
	gupÿÎResuÉs
.
’ŒyS‘
().
»moveIf
(
e
 ->ƒ.
g‘Key
(è< 
ŒimM¬k
);

161 
	gsmrSŒ—m
.
gc
(
ŒimM¬k
);

162 } 
	gfš®ly
 {

163 
	glock
.
uÆock
(
ts
);

170 
	gpublic
 <
	gR
> 
R
 
·ssThrough
(
FunùiÚ
<
T
, R> 
m‘hod
) {

171  
	gm‘hod
.
­¶y
(
objeù
);

201 
	gpublic
 <
	gR
> 
R
 
acûss
(
FunùiÚ
<
V”siÚLockedObjeù
<
T
>, 
BoŞ—n
> 
dœeùAcûssCheckFunùiÚ
,

202 
CÚsum”
<
V”siÚLockedObjeù
<
T
>> 
upd©eFunùiÚ
,

203 
FunùiÚ
<
T
, 
R
> 
acûssFunùiÚ
) {

206 
	gts
 = 
lock
.
ŒyO±imi¡icR—d
();

207 ià(
	gts
 != 0) {

208 
Œy
 (
Tim”
.
CÚ‹xt
 
İtimi¡R—dDu¿tiÚ
 = 
VloM‘ricsH–³r
.
g‘O±imi¡icR—dCÚ‹xt
()) {

209 ià(
dœeùAcûssCheckFunùiÚ
.
­¶y
(
this
)) {

210 
log
.
Œaû
("Access [{}] Direct (optimistic-read)‡ccess‡t {}",

211 
this
, 
g‘V”siÚUn§ã
());

212 
R
 
	g»t
 = 
acûssFunùiÚ
.
­¶y
(
objeù
.
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
DEFAULT
));

214 
	gv”siÚFÜCÜ»ùÃss
 = 
g‘V”siÚUn§ã
();

215 ià(
	glock
.
v®id©e
(
ts
)) {

216 
	gcÜ»ùÃssLogg”
.
Œaû
("V”siÚ, {}", 
v”siÚFÜCÜ»ùÃss
);

217  
	g»t
;

220 } 
ÿtch
 (
Exû±iÚ
 
e
) {

224 ià(
	glock
.
v®id©e
(
ts
)) {

225 
throw
 
	ge
;

229 
	glog
.
w¬n
("Access [{}] Direct (optimistic-read)ƒxception, upgrading†ock. Exception ",

230 
this
, 
e
);

236 
Œy
 (
Tim”
.
CÚ‹xt
 
upd©eObjeùR—dDu¿tiÚ
 = 
VloM‘ricsH–³r
.
g‘Upd©edObjeùR—dCÚ‹xt
()) {

238 
ts
 = 
lock
.
ŒyCÚv”tToWr™eLock
(ts);

240 ià(
	gts
 == 0) {

241 
ts
 = 
lock
.
wr™eLock
();

244 ià(
	gdœeùAcûssCheckFunùiÚ
.
­¶y
(
this
)) {

245 
	glog
.
Œaû
("Acûs [{}] Dœeù (wr™–ockèacûs © {}", 
this
, 
g‘V”siÚUn§ã
());

246 
R
 
	g»t
 = 
acûssFunùiÚ
.
­¶y
(
objeù
.
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
DEFAULT
));

247 
	gcÜ»ùÃssLogg”
.
Œaû
("V”siÚ, {}", 
g‘V”siÚUn§ã
());

248  
	g»t
;

251 
	gupd©eFunùiÚ
.
acû±
(
this
);

252 
	gcÜ»ùÃssLogg”
.
Œaû
("V”siÚ, {}", 
g‘V”siÚUn§ã
());

253 
	glog
.
Œaû
("Acûs [{}] Upd©ed (wr™–ockèacûs © {}", 
this
, 
g‘V”siÚUn§ã
());

254  
	gacûssFunùiÚ
.
­¶y
(
objeù
.
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
DEFAULT
));

256 } 
	gfš®ly
 {

257 
	glock
.
uÆock
(
ts
);

268 
	gpublic
 <
	gR
> 
R
 
upd©e
(
FunùiÚ
<
V”siÚLockedObjeù
<
T
>, R> 
upd©eFunùiÚ
) {

269 
	gts
 = 0;

271 
Œy
 (
Tim”
.
CÚ‹xt
 
upd©eDu¿tiÚ
 = 
VloM‘ricsH–³r
.
g‘VloUpd©eCÚ‹xt
()) {

272 
ts
 = 
lock
.
wr™eLock
();

273 
	glog
.
Œaû
("Upd©e[{}] (wr™–ock)", 
this
);

274  
	gupd©eFunùiÚ
.
­¶y
(
this
);

275 } 
	gfš®ly
 {

276 
	glock
.
uÆock
(
ts
);

291 
public
 
rŞlbackObjeùUn§ã
(
time¡amp
) {

292 ià(
	gobjeù
.
g‘V”siÚPŞicy
(è=ğ
ICÜfuV”siÚPŞicy
.
MONOTONIC
) {

296 ià(
g‘V”siÚUn§ã
(è<ğ
time¡amp
) {

300 
	gŒy
 {

301 
	glog
.
Œaû
("RŞlback[{}]Ø{}", 
this
, 
time¡amp
);

302 
rŞlbackSŒ—mUn§ã
(
smrSŒ—m
, 
time¡amp
);

303 
	glog
.
Œaû
("RŞlback[{}] com¶‘ed", 
this
);

304 } 
ÿtch
 (
NoRŞlbackExû±iÚ
 
Äe
) {

305 
	glog
.
w¬n
("SyncObjeùUn§ã[{}]Ø{} faed {}", 
this
, 
time¡amp
, 
Äe
);

306 
»£tUn§ã
();

317 
public
 
£ek
(
glob®Add»ss
) {

318 
	gsmrSŒ—m
.
£ek
(
glob®Add»ss
);

324 
public
 
syncObjeùUn§ã
(
time¡amp
) {

325 
Œy
 (
Tim”
.
CÚ‹xt
 
upd©eDu¿tiÚ
 = 
VloM‘ricsH–³r
.
g‘VloSyncCÚ‹xt
()) {

326 
syncObjeùUn§ãIÂ”
(
time¡amp
);

336 
´iv©e
 
syncObjeùUn§ãIÂ”
(
time¡amp
) {

339 ià(
İtimi¡iÿÎyOwÃdByTh»adUn§ã
()) {

341 ià(
	gİtimi¡icSŒ—m
.
pos
(è=ğ
Add»ss
.
NEVER_READ
) {

342 
fš®
 
Wr™eS‘SMRSŒ—m
 
cu¼’tO±imi¡icSŒ—m
 = 
İtimi¡icSŒ—m
;

344 
rŞlbackObjeùUn§ã
(
time¡amp
);

347 
syncSŒ—mUn§ã
(
smrSŒ—m
, 
time¡amp
);

352 
	gİtimi¡icSŒ—m
 = 
cu¼’tO±imi¡icSŒ—m
;

354 
syncSŒ—mUn§ã
(
İtimi¡icSŒ—m
, 
Add»ss
.
OPTIMISTIC
);

358 ià(
	gthis
.
	gİtimi¡icSŒ—m
 !ğ
nuÎ
) {

359 
rŞlbackUncomm™‹dChªgesUn§ã
();

360 
	gthis
.
	gİtimi¡icSŒ—m
 = 
nuÎ
;

363 
rŞlbackObjeùUn§ã
(
time¡amp
);

364 
syncSŒ—mUn§ã
(
smrSŒ—m
, 
time¡amp
);

374 
public
 
£tUncomm™‹dChªges
() {

375 
Wr™eS‘SMRSŒ—m
 
	g¡»am
 = 
g‘O±imi¡icSŒ—mUn§ã
();

376 ià(
	g¡»am
 =ğ
nuÎ


377 || !
¡»am
.
isSŒ—mCu¼’tCÚ‹xtTh»adCu¼’tCÚ‹xt
()) {

382 
Wr™eS‘SMRSŒ—m
 
ÃwSmrSŒ—m
 =

383 
Ãw
 
Wr™eS‘SMRSŒ—m
(
T¿n§ùiÚ®CÚ‹xt
.
g‘T¿n§ùiÚSckAsLi¡
(), 
g‘ID
());

385 
£tUncomm™‹dChªges
(
ÃwSmrSŒ—m
);

398 
public
 
logUpd©e
(
SMREÁry
 
’Œy
, 
boŞ—n
 
§veUpÿÎ
) {

399  
	gsmrSŒ—m
.
­³nd
(
’Œy
,

400 
t
 -> {

401 ià(
§veUpÿÎ
) {

402 
³ndšgUpÿÎs
.
add
(
t
.
g‘Tok’
().
g‘Sequ’û
());

404  
Œue
;

406 
t
 -> {

407 ià(
§veUpÿÎ
) {

408 
³ndšgUpÿÎs
.
»move
(
t
.
g‘Tok’
().
g‘Sequ’û
());

410  
Œue
;

417 
public
 
Wr™eS‘SMRSŒ—m
 
g‘O±imi¡icSŒ—mUn§ã
() {

418  
	gİtimi¡icSŒ—m
;

426 
public
 
boŞ—n
 
İtimi¡iÿÎyOwÃdByTh»adUn§ã
() {

427  
	gİtimi¡icSŒ—m
 !ğ
nuÎ
 && 
İtimi¡icSŒ—m
.
isSŒ—mFÜThisTh»ad
();

436 
public
 
£tUncomm™‹dChªges
(
Wr™eS‘SMRSŒ—m
 
İtimi¡icSŒ—m
) {

437 ià(
	gthis
.
	gİtimi¡icSŒ—m
 !ğ
nuÎ
) {

438 
rŞlbackUncomm™‹dChªgesUn§ã
();

440 
	gthis
.
	gİtimi¡icSŒ—m
 = 
İtimi¡icSŒ—m
;

449 
public
 
g‘V”siÚUn§ã
() {

450  
	gsmrSŒ—m
.
pos
();

456 
public
 
boŞ—n
 
isO±imi¡iÿÎyModif›dUn§ã
() {

457  
	gİtimi¡icSŒ—m
 !ğ
nuÎ
 && 
İtimi¡icSŒ—m
.
pos
(è!ğ
Add»ss
.
NEVER_READ
;

463 
public
 
»£tUn§ã
() {

464 
	glog
.
debug
("Re£t[{}]", 
this
);

465 
	gobjeù
.
şo£
();

466 
	gobjeù
 = 
ÃwObjeùFn
.
g‘
();

467 
	gsmrSŒ—m
.
»£t
();

468 
	gİtimi¡icSŒ—m
 = 
nuÎ
;

476 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

477 
public
 
UUID
 
g‘ID
() {

478  
	gsmrSŒ—m
.
g‘ID
();

489 @
Ov”ride


490 
public
 
SŒšg
 
toSŒšg
() {

491 
Wr™eS‘SMRSŒ—m
 
	gİtimi¡icSŒ—m
 = 
this
.
İtimi¡icSŒ—m
;

493  
	gobjeù
.
g‘CÏss
().
g‘Sim¶eName
()

494 + "[" + 
	gUts
.
toR—dabËId
(
smrSŒ—m
.
g‘ID
()) + "]@"

495 + (
g‘V”siÚUn§ã
(è=ğ
Add»ss
.
NEVER_READ
 ? "NR" : getVersionUnsafe())

496 + (
İtimi¡icSŒ—m
 =ğ
nuÎ
 ? "" : "+" + o±imi¡icSŒ—m.
pos
());

507 
´iv©e
 
	gICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
g‘CÚ‹xt
(
ISMRSŒ—m
 
¡»am
) {

508 ià(
	g¡»am
 =ğ
İtimi¡icSŒ—m
) {

509  
ICÜfuExecutiÚCÚ‹xt
.
OPTIMISTIC
;

512  
	gICÜfuExecutiÚCÚ‹xt
.
	gDEFAULT
;

520 
´iv©e
 
­¶yUndoRecÜdUn§ã
(
SMREÁry
 
’Œy
, 
ISMRSŒ—m
 
¡»am
) {

521 
	glog
.
Œaû
("Undo[{}] oà{}@{} ({})", 
this
, 
’Œy
.
g‘SMRM‘hod
(),

522 
Add»ss
.
isAdd»ss
(
’Œy
.
g‘Glob®Add»ss
()) ?ƒntry.getGlobalAddress() : "OPT",

523 
’Œy
.
g‘UndoRecÜd
());

524 
	gIUndoFunùiÚ
<
	gT
> 
	gundoFunùiÚ
 = 
undoFunùiÚM­
.
g‘
(
’Œy
.
g‘SMRM‘hod
());

525 
	gICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
	gcÚ‹xt
 = 
g‘CÚ‹xt
(
¡»am
);

528 ià(
	gundoFunùiÚ
 !ğ
nuÎ
) {

529 
undoFunùiÚ
.
doUndo
(

530 
objeù
.
g‘CÚ‹xt
(
cÚ‹xt
),

531 
’Œy
.
g‘UndoRecÜd
(),ƒÁry.
g‘SMRArgum’ts
());

533 } ià(
	g»£tS‘
.
cÚšs
(
’Œy
.
g‘SMRM‘hod
())) {

536 
	gobjeù
 = (
T
è
’Œy
.
g‘UndoRecÜd
();

539 
	g’Œy
.
ş—rUndoRecÜd
();

546 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Unknown undo„ecord in undo†og");

556 
´iv©e
 
	gICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
g‘CÚ‹xt
(
time¡amp
) {

557 ià(
	gtime¡amp
 =ğ
Add»ss
.
OPTIMISTIC
) {

558  
ICÜfuExecutiÚCÚ‹xt
.
OPTIMISTIC
;

561  
	gICÜfuExecutiÚCÚ‹xt
.
	gDEFAULT
;

569 
´iv©e
 
Objeù
 
­¶yUpd©eUn§ã
(
SMREÁry
 
’Œy
, 
time¡amp
) {

570 
	glog
.
Œaû
("Aµly[{}] oà{}@{} ({})", 
this
, 
’Œy
.
g‘SMRM‘hod
(),

571 
Add»ss
.
isAdd»ss
(
’Œy
.
g‘Glob®Add»ss
()) ?ƒntry.getGlobalAddress() : "OPT",

572 
’Œy
.
g‘SMRArgum’ts
());

574 
	gICÜfuSMRUpÿÎT¬g‘
<
	gT
> 
	grg‘
 = 
upÿÎT¬g‘M­
.
g‘
(
’Œy
.
g‘SMRM‘hod
());

575 ià(
	grg‘
 =ğ
nuÎ
) {

576 
throw
 
Ãw
 
RuÁimeExû±iÚ
("UnknowÀupÿÎ " + 
’Œy
.
g‘SMRM‘hod
());

579 
	gICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
	gcÚ‹xt
 = 
g‘CÚ‹xt
(
time¡amp
);

586 ià(!
	g’Œy
.
isUndßbË
(è|| !
	gAdd»ss
.
isAdd»ss
(
’Œy
.
g‘Glob®Add»ss
())) {

588 
	gIUndoRecÜdFunùiÚ
<
	gT
> 
	gundoRecÜdT¬g‘
 =

589 
undoRecÜdFunùiÚM­
.
g‘
(
’Œy
.
g‘SMRM‘hod
());

591 ià(
	gundoRecÜdT¬g‘
 !ğ
nuÎ
) {

593 
’Œy
.
£tUndoRecÜd
(
undoRecÜdT¬g‘


594 .
g‘UndoRecÜd
(
objeù
.
g‘CÚ‹xt
(
cÚ‹xt
), 
’Œy
.
g‘SMRArgum’ts
()));

595 
	glog
.
Œaû
("Aµly[{}] Undo->{}", 
this
, 
’Œy
.
g‘UndoRecÜd
());

596 } ià(
	g»£tS‘
.
cÚšs
(
’Œy
.
g‘SMRM‘hod
())) {

600 
	g’Œy
.
£tUndoRecÜd
(
objeù
);

601 
	gobjeù
.
şo£
();

602 
	gobjeù
 = 
ÃwObjeùFn
.
g‘
();

603 
	glog
.
Œaû
("Aµly[{}] Undo->RESET", 
this
);

608  
	grg‘
.
upÿÎ
(
objeù
.
g‘CÚ‹xt
(
cÚ‹xt
), 
’Œy
.
g‘SMRArgum’ts
());

621 
´Ùeùed
 
rŞlbackSŒ—mUn§ã
(
ISMRSŒ—m
 
¡»am
, 
rŞlbackV”siÚ
) {

624 ià(
	g¡»am
.
pos
(è<ğ
rŞlbackV”siÚ
) {

628 
	gLi¡
<
	gSMREÁry
> 
	g’Œ›s
 = 
¡»am
.
cu¼’t
();

630 !
	g’Œ›s
.
isEm±y
()) {

631 ià(
	g’Œ›s
.
¡»am
().
®lM©ch
(
SMREÁry
::
isUndßbË
)) {

633 
Li¡I‹¿tÜ
<
SMREÁry
> 
™
 = 
’Œ›s
.
li¡I‹¿tÜ
ÓÁr›s.
size
());

634 
	g™
.
hasP»vious
()) {

635 
­¶yUndoRecÜdUn§ã
(
™
.
´evious
(), 
¡»am
);

638 
	gO±iÚ®
<
	gSMREÁry
> 
	g’Œy
 = 
’Œ›s
.
¡»am
().
fšdFœ¡
();

639 ià(
	glog
.
isT¿ûEÇbËd
()) {

640 
	glog
.
Œaû
("rollbackStreamUnsafe: one or more streamƒntries in‡ddress @{}‡re‚ot undoable. " +

641 "UndßbËƒÁr›s: {}/{}", 
¡»am
.
pos
(),

642 (è
’Œ›s
.
¡»am
().
f‹r
(
SMREÁry
::
isUndßbË
).
couÁ
(),

643 
’Œ›s
.
size
());

645 
throw
 
Ãw
 
NoRŞlbackExû±iÚ
(
’Œy
, 
¡»am
.
pos
(), 
rŞlbackV”siÚ
);

648 
	g’Œ›s
 = 
¡»am
.
´evious
();

650 ià(
	g¡»am
.
pos
(è<ğ
rŞlbackV”siÚ
) {

655 
throw
 
Ãw
 
NoRŞlbackExû±iÚ
(
¡»am
.
pos
(), 
rŞlbackV”siÚ
);

673 
´Ùeùed
 
syncSŒ—mUn§ã
(
ISMRSŒ—m
 
¡»am
, 
time¡amp
) {

674 
	glog
.
Œaû
("Sync[{}] {}", 
this
, (
time¡amp
 =ğ
Add»ss
.
OPTIMISTIC
)

675 ? "O±imi¡ic" : "tØ" + 
time¡amp
);

676 
	gsyncTo
 = (
time¡amp
 =ğ
Add»ss
.
OPTIMISTIC
è? Add»ss.
MAX
 :imestamp;

677 
	g¡»am
.
¡»amUpTo
(
syncTo
)

678 .
fÜEachOrd”ed
(
’Œy
 -> {

679 
Œy
 {

680 
Objeù
 
»s
 = 
­¶yUpd©eUn§ã
(
’Œy
, 
time¡amp
);

681 ià(
time¡amp
 =ğ
Add»ss
.
OPTIMISTIC
) {

682 
’Œy
.
£tUpÿÎResuÉ
(
»s
);

683 } ià(
³ndšgUpÿÎs
.
cÚšs
(
’Œy
.
g‘Glob®Add»ss
())) {

684 
log
.
debug
("Sync[{}] Upcall Result {}",

685 
this
, 
’Œy
.
g‘Glob®Add»ss
());

686 
upÿÎResuÉs
.
put
(
’Œy
.
g‘Glob®Add»ss
(), 
»s
 =ğ
nuÎ


687 ? 
NuÎV®ue
.
NULL_VALUE
 : 
»s
);

688 
³ndšgUpÿÎs
.
»move
(
’Œy
.
g‘Glob®Add»ss
());

690 
’Œy
.
£tUpÿÎResuÉ
(
»s
);

691 } 
ÿtch
 (
Exû±iÚ
 
e
) {

692 
log
.
”rÜ
("Sync[{}] E¼Ü: Couldn'ˆexecu‹ upÿÎ dutØ{}", 
this
, 
e
);

693 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
e
);

702 
´Ùeùed
 
rŞlbackUncomm™‹dChªgesUn§ã
() {

703 
	gŒy
 {

704 
	glog
.
Œaû
("O±imi¡icRŞlback[{}] s¹ed", 
this
);

705 
rŞlbackSŒ—mUn§ã
(
this
.
İtimi¡icSŒ—m
,

706 
Add»ss
.
NEVER_READ
);

707 
	glog
.
Œaû
("O±imi¡icRŞlback[{}] com¶‘e", 
this
);

708 } 
ÿtch
 (
NoRŞlbackExû±iÚ
 
Äe
) {

709 
	glog
.
w¬n
("O±imi¡icRŞlback[{}] faed", 
this
);

710 
»£tUn§ã
();

719 
public
 
­¶yUpd©eToSŒ—mUn§ã
(
SMREÁry
 
’Œy
, 
glob®Add»ss
) {

720 
­¶yUpd©eUn§ã
(
’Œy
, 
glob®Add»ss
);

721 
£ek
(
glob®Add»ss
 + 1);

728 
´iv©e
 şas 
	cVloM‘ricsH–³r
 {

729 
´iv©e
 
fš®
 
M‘ricRegi¡ry
 
	gm‘rics
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

730 
´iv©e
 
fš®
 
SŒšg
 
	gVLO_OPTIMISTIC_READ
 = 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() +

732 
´iv©e
 
fš®
 
SŒšg
 
	gVLO_UPDATED_OBJECT_READ
 = 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() +

734 
´iv©e
 
fš®
 
SŒšg
 
	gVLO_UPDATE
 = 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() + "vlo.update";

735 
´iv©e
 
fš®
 
SŒšg
 
	gVLO_SYNC
 = 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() + "vlo.sync";

736 
´iv©e
 
fš®
 
SŒšg
 
	gVLO_GC
 = 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() + "vlo.gc";

738 
´iv©e
 
	gTim”
.
CÚ‹xt
 
g‘VloSyncCÚ‹xt
() {

739  
	gM‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
m‘rics
.
tim”
(
VLO_SYNC
));

742 
´iv©e
 
	gTim”
.
CÚ‹xt
 
g‘O±imi¡icR—dCÚ‹xt
() {

743  
	gM‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
m‘rics
.
tim”
(
VLO_OPTIMISTIC_READ
));

746 
´iv©e
 
	gTim”
.
CÚ‹xt
 
g‘Upd©edObjeùR—dCÚ‹xt
() {

747  
	gM‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
m‘rics
.
tim”
(
VLO_UPDATED_OBJECT_READ
));

750 
´iv©e
 
	gTim”
.
CÚ‹xt
 
g‘VloUpd©eCÚ‹xt
() {

751  
	gM‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
m‘rics
.
tim”
(
VLO_UPDATE
));

754 
´iv©e
 
	gTim”
.
CÚ‹xt
 
g‘VloGcCÚ‹xt
() {

755  
	gM‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
m‘rics
.
tim”
(
VLO_GC
));

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/AbstractTransactionalContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuCompeProxy
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRAcûss
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gV”siÚLockedObjeù
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

26 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

27 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

60 @
Slf4j


61 
public
 
ab¡¿ù
 
şass
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
im¶em’ts


62 
	gCom·¿bË
<
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
> {

67 
public
 
fš®
 
	gUNCOMMITTED_ADDRESS
 = -1L;

73 
public
 
fš®
 
	gFOLDED_ADDRESS
 = -2L;

78 
public
 
fš®
 
	gABORTED_ADDRESS
 = -3L;

84 
public
 
fš®
 
	gNOWRITE_ADDRESS
 = -4L;

90 @
Suµ»ssW¬nšgs
("checkstyle:abbreviationaswordinname")

91 @
G‘‹r


92 
public
 
UUID
 
	gŒª§ùiÚID
;

97 @
G‘‹r


98 
public
 
fš®
 
T¿n§ùiÚ
 
	gŒª§ùiÚ
;

103 @
G‘‹r


104 
public
 
fš®
 
	g¡¬tTime
;

109 @
G‘‹r
(
Ïzy
 = 
Œue
)

110 
´iv©e
 
fš®
 
Tok’
 
¢­shÙTime¡amp
 = 
obšSÇpshÙTime¡amp
();

115 @
G‘‹r


116 
public
 
	gcomm™Add»ss
 = 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
.
UNCOMMITTED_ADDRESS
;

121 @
G‘‹r


122 
´iv©e
 
fš®
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	g·»ÁCÚ‹xt
;

124 @
G‘‹r


125 
´iv©e
 
fš®
 
Wr™eS‘Info
 
	gwr™eS‘Info
 = 
Ãw
 WriteSetInfo();

127 @
G‘‹r


128 
´iv©e
 
fš®
 
CÚæiùS‘Info
 
	g»adS‘Info
 = 
Ãw
 ConflictSetInfo();

134 @
G‘‹r


135 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	gcom¶‘iÚFutu»
 =

136 
Ãw
 
Com¶‘abËFutu»
<>();

141 @
G‘‹r


142 
´iv©e
 
fš®
 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gknownSŒ—mPos™iÚ
 = 
Ãw
 
HashM­
<>();

147 @
G‘‹r


148 
´iv©e
 
fš®
 
M‘ricRegi¡ry
 
	gm‘rics
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

149 
´iv©e
 
fš®
 
SŒšg
 
	gTXN_OP_DURATION_TIMER_NAME
 = 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() +

151 
´iv©e
 
fš®
 
Tim”
 
	gtxDu¿tiÚTim”
 = 
m‘rics
.
tim”
(
TXN_OP_DURATION_TIMER_NAME
);

152 @
G‘‹r


153 
´iv©e
 
fš®
 
	gTim”
.
CÚ‹xt
 
	gtxOpDu¿tiÚCÚ‹xt
;

155 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
(
T¿n§ùiÚ
 
Œª§ùiÚ
) {

156 
	gŒª§ùiÚID
 = 
UUID
.
¿ndomUUID
();

157 
	gthis
.
	gŒª§ùiÚ
 = 
Œª§ùiÚ
;

159 
	g¡¬tTime
 = 
Sy¡em
.
cu¼’tTimeMlis
();

161 
	gtxOpDu¿tiÚCÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
txDu¿tiÚTim”
);

163 
	g·»ÁCÚ‹xt
 = 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
();

165 
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
.
	glog
.
debug
("TXBegš[{}]", 
this
);

179 
public
 
	gab¡¿ù
 <
	gR
, 
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
R
 
acûss
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

180 
ICÜfuSMRAcûss
<
R
, 
T
> 
acûssFunùiÚ
,

181 
Objeù
[] 
cÚæiùObjeù
);

192 
public
 
	gab¡¿ù
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
Objeù
 
g‘UpÿÎResuÉ
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

193 
time¡amp
,

194 
Objeù
[] 
cÚæiùObjeù
);

196 
public
 
syncW™hR‘ryUn§ã
(
V”siÚLockedObjeù
 
vlo
,

197 
Tok’
 
¢­shÙTime¡amp
,

198 
ICÜfuSMRProxyIÁ”Çl
 
´oxy
,

199 @
NuÎabË
 
RuÂabË
 
İtimi¡icSŒ—mS‘‹r
) {

200 
	gx
 = 0; x < 
	gthis
.
	gŒª§ùiÚ
.
g‘RuÁime
().
g‘P¬am‘”s
().
g‘TrimR‘ry
(); x++) {

201 
	gŒy
 {

202 ià(
	gİtimi¡icSŒ—mS‘‹r
 !ğ
nuÎ
) {

208 
İtimi¡icSŒ—mS‘‹r
.
run
();

210 
	gvlo
.
syncObjeùUn§ã
(
¢­shÙTime¡amp
.
g‘Sequ’û
());

212 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

214 
	gvlo
.
»£tUn§ã
();

215 ià(!
	g‹
.
isR‘rŸbË
()

216 || 
	gx
 =ğ
this
.
Œª§ùiÚ
.
g‘RuÁime
().
g‘P¬am‘”s
().
g‘TrimR‘ry
() - 1) {

218 
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
 =

219 
Ãw
 
T¿n§ùiÚAbÜ‹dExû±iÚ
(

220 
Ãw
 
TxResŞutiÚInfo
(
g‘T¿n§ùiÚID
(), 
¢­shÙTime¡amp
),

221 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
, 
´oxy
.
g‘SŒ—mID
(),

222 
Add»ss
.
NON_ADDRESS
, 
AbÜtCau£
.
TRIM
, 
‹
, 
this
);

223 
abÜtT¿n§ùiÚ
(
e
);

224 
throw
 
	ge
;

239 
public
 
	gab¡¿ù
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
logUpd©e
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

240 
SMREÁry
 
upd©eEÁry
,

241 
Objeù
[] 
cÚæiùObjeù
);

243 
public
 
ab¡¿ù
 
logUpd©e
(
UUID
 
¡»amId
, 
SMREÁry
 
upd©eEÁry
);

251 
public
 
ab¡¿ù
 
addT¿n§ùiÚ
(
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
tc
);

258 
public
 
comm™T¿n§ùiÚ
(è
throws
 
	gT¿n§ùiÚAbÜ‹dExû±iÚ
 {

259 
	gcom¶‘iÚFutu»
.
com¶‘e
(
Œue
);

260  
	gNOWRITE_ADDRESS
;

266 
public
 
abÜtT¿n§ùiÚ
(
T¿n§ùiÚAbÜ‹dExû±iÚ
 
«
) {

267 
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
.
	glog
.
debug
("TXAbÜt[{}]", 
this
);

268 
	gcomm™Add»ss
 = 
ABORTED_ADDRESS
;

269 
	gcom¶‘iÚFutu»


270 .
com¶‘eExû±iÚ®ly
(
«
);

280 
´iv©e
 
Tok’
 
obšSÇpshÙTime¡amp
() {

281 
fš®
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	g·»ÁCtx
 = 
g‘P¬’tCÚ‹xt
();

282 
fš®
 
Tok’
 
	gtxnBud”Ts
 = 
g‘T¿n§ùiÚ
().
g‘SÇpshÙ
();

283 ià(
	g·»ÁCtx
 !ğ
nuÎ
) {

286 
Tok’
 
·»ÁTime¡amp
 = 
·»ÁCtx
.
g‘SÇpshÙTime¡amp
();

287 
	glog
.
Œaû
("obtainSnapshotTimestamp: inheriting…arent snapshot" +

288 " SÇpshÙTime¡amp[{}] {}", 
this
, 
·»ÁTime¡amp
);

289  
	g·»ÁTime¡amp
;

290 } ià(!
	gtxnBud”Ts
.
equ®s
(
Tok’
.
UNINITIALIZED
)) {

291 
	glog
.
Œaû
("obtainSnapshotTimestamp: using user defined snapshot" +

292 " SÇpshÙTime¡amp[{}] {}", 
this
, 
txnBud”Ts
);

293  
	gtxnBud”Ts
;

297 
Tok’
 
	gtime¡amp
 = 
g‘T¿n§ùiÚ
()

298 .
g‘RuÁime
()

299 .
g‘Sequ’ûrV›w
()

300 .
qu”y
()

301 .
g‘Tok’
();

302 
	glog
.
Œaû
("obšSÇpshÙTime¡amp: sequ’û¸SÇpshÙTime¡amp[{}] {}", 
this
, 
time¡amp
);

303  
	gtime¡amp
;

314 
public
 
addToR—dS‘
(
ICÜfuSMRProxyIÁ”Çl
 
´oxy
, 
Objeù
[] 
cÚæiùObjeùs
) {

315 
g‘R—dS‘Info
().
add
(
´oxy
, 
cÚæiùObjeùs
);

323 
m”geR—dS‘IÁo
(
CÚæiùS‘Info
 
Ùh”
) {

324 
g‘R—dS‘Info
().
m”geIÁo
(
Ùh”
);

336 
addToWr™eS‘
(
ICÜfuSMRProxyIÁ”Çl
 
´oxy
, 
SMREÁry
 
upd©eEÁry
, 
Objeù
[]

337 
cÚæiùObjeùs
) {

338  
g‘Wr™eS‘Info
().
add
(
´oxy
, 
upd©eEÁry
, 
cÚæiùObjeùs
);

341 
addToWr™eS‘
(
UUID
 
¡»amId
, 
SMREÁry
 
upd©eEÁry
) {

342 
g‘Wr™eS‘Info
().
add
(
¡»amId
, 
upd©eEÁry
);

345 
m”geWr™eS‘IÁo
(
Wr™eS‘Info
 
Ùh”
) {

346 
g‘Wr™eS‘Info
().
m”geIÁo
(
Ùh”
);

354 
MuÉiObjeùSMREÁry
 
cŞËùWr™eS‘EÁr›s
() {

355  
g‘Wr™eS‘Info
().
g‘Wr™eS‘
();

364 
	gLi¡
<
	gSMREÁry
> 
g‘Wr™eS‘EÁryLi¡
(
UUID
 
id
) {

365  
g‘Wr™eS‘Info
().
g‘Wr™eS‘
().
g‘SMRUpd©es
(
id
);

368 
g‘Wr™eS‘EÁrySize
(
UUID
 
id
) {

369  
g‘Wr™eS‘Info
()

370 .
g‘Wr™eS‘
()

371 .
g‘SMRUpd©es
(
id
)

372 .
size
();

378 @
Ov”ride


379 
public
 
com·»To
(
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
o
) {

380  
	gthis
.
g‘SÇpshÙTime¡amp
()

381 .
com·»To
(
o
.
g‘SÇpshÙTime¡amp
());

384 @
Ov”ride


385 
public
 
SŒšg
 
toSŒšg
() {

386  "TX[" + 
	gUts
.
toR—dabËId
(
Œª§ùiÚID
) + "]";

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/ConflictSetInfo.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

4 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

13 
impÜt
 
	glombok
.
	gG‘‹r
;

19 @
G‘‹r


20 
public
 cÏs 
	cCÚæiùS‘Info
 {

24 
´Ùeùed
 
	mM­
<
	mICÜfuSMRProxyIÁ”Çl
, 
	mS‘
<
	mObjeù
>> 
	mcÚæiùs
 = 
Ãw
 
HashM­
<>();

27 
public
 
	mby‹
[] 
	$g’”©eHashFromObjeù
(
ICÜfuSMRProxyIÁ”Çl
 
p
, 
Objeù
 
o
) {

28  
p
.
	`g‘S”Ÿliz”
().
	`hash
(
o
);

34 
public
 
M­
<
UUID
, 
S‘
<
by‹
[]>> 
	$g‘HashedCÚæiùS‘
() {

35  
cÚæiùs
.
	`’ŒyS‘
().
	`¡»am
()

36 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(

38 
e
 ->ƒ.
	`g‘Key
().
	`g‘SŒ—mID
(),

40 
e
 ->ƒ.
	`g‘V®ue
().
	`¡»am
()

41 .
	`m­
(
o
 -> 
CÚæiùS‘Info
.
	`g’”©eHashFromObjeù
(
e
.
	`g‘Key
(), o))

42 .
	`cŞËù
(
CŞËùÜs
.
	`toS‘
()),

45 (
v1
,
v2
) -> {

47 
v1
.
	`addAÎ
(
v2
);

48  
v1
;

50 
	}
}

55 
public
 
	$m”geIÁo
(
CÚæiùS‘Info
 
Ùh”
) {

56 
cÚæiùs
.
	`putAÎ
(
Ùh”
.conflicts);

57 
	}
}

60 
public
 
	$add
(
ICÜfuSMRProxyIÁ”Çl
 
´oxy
, 
Objeù
[] 
cÚæiùObjeùs
) {

61 ià(
cÚæiùObjeùs
 =ğ
nuÎ
) {

67 
cÚæiùs
.
	`compu‹
(
´oxy
, (
p
, 
c
) -> {

69 ià(
c
 =ğ
nuÎ
) {

70 
c
 = 
Ãw
 
HashS‘
<>();

73 
c
.
	`addAÎ
(
A¼ays
.
	`asLi¡
(
cÚæiùObjeùs
));

74  
c
;

76 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
.
	gTRANSACTION_STREAM_ID
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAµ’dExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRAcûss
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

44 @
Slf4j


45 
public
 cÏs 
	cO±imi¡icT¿n§ùiÚ®CÚ‹xt
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚ®CÚ‹xt
 {

48 @
G‘‹r


49 
´iv©e
 
fš®
 
	mS‘
<
	mICÜfuSMRProxyIÁ”Çl
> 
	mmodif›dProx›s
 =

50 
Ãw
 
HashS‘
<>();

53 
	$O±imi¡icT¿n§ùiÚ®CÚ‹xt
(
T¿n§ùiÚ
 
Œª§ùiÚ
) {

54 
	`su³r
(
Œª§ùiÚ
);

75 @
Ov”ride


76 
public
 <
R
, 
T
 
ex‹nds
 
ICÜfuSMR
<T>> R 
	`acûss
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

77 
ICÜfuSMRAcûss
<
R
, 
T
> 
acûssFunùiÚ
,

78 
Objeù
[] 
cÚæiùObjeù
) {

79 
log
.
	`debug
("Acûss[{},{}] cÚæiùObj={}", 
this
, 
´oxy
, 
cÚæiùObjeù
);

81 
	`addToR—dS‘
(
´oxy
, 
cÚæiùObjeù
);

87 
ts
 = 
	`g‘SÇpshÙTime¡amp
().
	`g‘Sequ’û
();

88  
´oxy


89 .
	`g‘Und”lyšgObjeù
()

90 .
	`acûss
(
o
 -> {

91 
Wr™eS‘SMRSŒ—m
 
¡»am
 = 
o
.
	`g‘O±imi¡icSŒ—mUn§ã
();

95 
¡»amR—dPos™iÚ
 = 
	`g‘KnownSŒ—mPos™iÚ
()

96 .
	`g‘OrDeçuÉ
(
´oxy
.
	`g‘SŒ—mID
(), 
ts
);

99 (
¡»am
 =ğ
nuÎ
 || sŒ—m.
	`isSŒ—mCu¼’tCÚ‹xtTh»adCu¼’tCÚ‹xt
())

100 && (
¡»am
 !ğ
nuÎ
 && 
	`g‘Wr™eS‘EÁrySize
(
´oxy
.
	`g‘SŒ—mID
()è=ğ¡»am.
	`pos
() + 1

101 || (
	`g‘Wr™eS‘EÁrySize
(
´oxy
.
	`g‘SŒ—mID
()) == 0

102 && 
o
.
	`g‘V”siÚUn§ã
(è=ğ
¡»amR—dPos™iÚ
)

106 
o
 -> {

110 
	`syncW™hR‘ryUn§ã
(
o
, 
	`g‘SÇpshÙTime¡amp
(), 
´oxy
,

111 
o
::
£tUncomm™‹dChªges
);

115 
	`g‘KnownSŒ—mPos™iÚ
().
	`put
(
´oxy
.
	`g‘SŒ—mID
(), 
o
.
	`g‘V”siÚUn§ã
());

117 
acûssFunùiÚ
::
acûss


119 
	}
}

136 @
Ov”ride


137 
	gpublic
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
Objeù
 
g‘UpÿÎResuÉ
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

138 
time¡amp
, 
Objeù
[] 
cÚæiùObjeù
) {

140 
addToR—dS‘
(
´oxy
, 
cÚæiùObjeù
);

143 
SMREÁry
 
	gw¿µ”
 = 
g‘Wr™eS‘EÁryLi¡
(
´oxy
.
g‘SŒ—mID
()).
g‘
(()
time¡amp
);

144 ià(
	gw¿µ”
 !ğ
nuÎ
 && 
w¿µ”
.
isHaveUpÿÎResuÉ
()) {

145  
w¿µ”
.
g‘UpÿÎResuÉ
();

149 
Tok’
 
	gts
 = 
g‘SÇpshÙTime¡amp
();

150  
	g´oxy
.
g‘Und”lyšgObjeù
().
upd©e
(
o
 -> {

151 
log
.
Œaû
("UpÿÎ[{}] {} Sync'd", 
this
, 
time¡amp
);

152 
syncW™hR‘ryUn§ã
(
o
, 
ts
, 
´oxy
, o::
£tUncomm™‹dChªges
);

153 
SMREÁry
 
w¿µ”2
 = 
g‘Wr™eS‘EÁryLi¡
(
´oxy
.
g‘SŒ—mID
()).
g‘
(()
time¡amp
);

154 ià(
w¿µ”2
 !ğ
nuÎ
 && w¿µ”2.
isHaveUpÿÎResuÉ
()) {

155  
w¿µ”2
.
g‘UpÿÎResuÉ
();

158 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Triedo get upcall during‡ransaction but"

159 + " wdÚ'ˆhav™ƒv’‡á”‡Àİtimi¡iøsynø×sked fÜ " + 
time¡amp


160 + " whav0-" + (
g‘Wr™eS‘EÁryLi¡
(
´oxy
.
g‘SŒ—mID
()).
size
() - 1) + ")");

175 @
Ov”ride


176 
	gpublic
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>>
logUpd©e
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

177 
SMREÁry
 
upd©eEÁry
,

178 
Objeù
[] 
cÚæiùObjeùs
) {

179 
	glog
.
Œaû
("LogUpdate[{},{}] {} ({}) conflictObj={}",

180 
this
, 
´oxy
, 
upd©eEÁry
.
g‘SMRM‘hod
(),

181 
upd©eEÁry
.
g‘SMRArgum’ts
(), 
cÚæiùObjeùs
);

183  
addToWr™eS‘
(
´oxy
, 
upd©eEÁry
, 
cÚæiùObjeùs
);

186 @
Ov”ride


187 
public
 
	$logUpd©e
(
UUID
 
¡»amId
, 
SMREÁry
 
upd©eEÁry
) {

188 
	`addToWr™eS‘
(
¡»amId
, 
upd©eEÁry
);

189 
	}
}

197 @
Suµ»ssW¬nšgs
("unchecked")

198 
public
 
	$addT¿n§ùiÚ
(
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
tc
) {

199 
log
.
	`Œaû
("M”ge[{}]‡ddšg {}", 
this
, 
tc
);

201 
	`m”geR—dS‘IÁo
(
tc
.
	`g‘R—dS‘Info
());

204 
	`m”geWr™eS‘IÁo
(
tc
.
	`g‘Wr™eS‘Info
());

209 
	}
}

217 @
	gOv”ride


218 @
Suµ»ssW¬nšgs
("unchecked")

219 
public
 
	$comm™T¿n§ùiÚ
(è
throws
 
T¿n§ùiÚAbÜ‹dExû±iÚ
 {

220 
log
.
	`debug
("TX[{}]„eque¡ o±imi¡iøcomm™", 
this
);

222  
	`g‘CÚæiùS‘AndComm™
(
	`g‘R—dS‘Info
());

223 
	}
}

231 
public
 
	$g‘CÚæiùS‘AndComm™
(
CÚæiùS‘Info
 
cÚæiùS‘
) {

233 ià(
T¿n§ùiÚ®CÚ‹xt
.
	`isInNe¡edT¿n§ùiÚ
()) {

234 
	`g‘P¬’tCÚ‹xt
().
	`addT¿n§ùiÚ
(
this
);

235 
comm™Add»ss
 = 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
.
FOLDED_ADDRESS
;

236 
log
.
	`Œaû
("Comm™[{}] FŞded iÁØ{}", 
this
, 
	`g‘P¬’tCÚ‹xt
());

237  
comm™Add»ss
;

242 ià(
	`g‘Wr™eS‘Info
().
	`g‘Wr™eS‘
().
	`g‘EÁryM­
().
	`isEm±y
()) {

243 
log
.
	`Œaû
("Comm™[{}] R—d-Úly comm™ (nØwr™e)", 
this
);

244  
NOWRITE_ADDRESS
;

248 
S‘
<
UUID
> 
afãùedSŒ—msIds
 = 
Ãw
 
HashS‘
<>(
	`g‘Wr™eS‘Info
().
	`g‘Wr™eS‘
().
	`g‘EÁryM­
().
	`keyS‘
());

250 ià(
this
.
Œª§ùiÚ
.
	`isLoggšgEÇbËd
()) {

251 
afãùedSŒ—msIds
.
	`add
(
TRANSACTION_STREAM_ID
);

254 
UUID
[] 
afãùedSŒ—ms
 = 
afãùedSŒ—msIds
.
	`toA¼ay
(
Ãw
 UUID[afãùedSŒ—msIds.
	`size
()]);

259 
add»ss
 = -1L;

260 
fš®
 
TxResŞutiÚInfo
 
txInfo
 =

266 
Ãw
 
	`TxResŞutiÚInfo
(
	`g‘T¿n§ùiÚID
(),

267 
	`g‘SÇpshÙTime¡amp
(),

268 
cÚæiùS‘
.
	`g‘HashedCÚæiùS‘
(),

269 
	`g‘Wr™eS‘Info
().
	`g‘HashedCÚæiùS‘
());

271 
Œy
 {

272 
add»ss
 = 
this
.
Œª§ùiÚ
.
ruÁime
.
	`g‘SŒ—msV›w
()

273 .
	`­³nd
(

275 
	`cŞËùWr™eS‘EÁr›s
(),

276 
txInfo
,

278 
afãùedSŒ—ms


280 } 
	`ÿtch
 (
Aµ’dExû±iÚ
 
Û
) {

283 
throw
 
Ãw
 
	`T¿n§ùiÚAbÜ‹dExû±iÚ
(
txInfo
, 
AbÜtCau£
.
OVERWRITE
, 
Û
, 
this
);

286 
log
.
	`Œaû
("Comm™[{}] Acquœadd»s {}", 
this
, 
add»ss
);

288 
su³r
.
	`comm™T¿n§ùiÚ
();

289 
comm™Add»ss
 = 
add»ss
;

291 
log
.
	`Œaû
("Comm™[{}] Wr™‹ÀtØ{}", 
this
, 
add»ss
);

292  
add»ss
;

293 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/SnapshotTransactionalContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRAcûss
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

24 
public
 cÏs 
	cSÇpshÙT¿n§ùiÚ®CÚ‹xt
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚ®CÚ‹xt
 {

29 @
G‘‹r


30 
´iv©e
 
	mS‘
<
	mICÜfuSMRProxyIÁ”Çl
> 
	mmodif›dProx›s
 = 
ImmubËS‘
.
of
();

32 
public
 
	$SÇpshÙT¿n§ùiÚ®CÚ‹xt
(
T¿n§ùiÚ
 
Œª§ùiÚ
) {

33 
	`su³r
(
Œª§ùiÚ
);

39 @
Ov”ride


40 
public
 <
R
, 
T
 
ex‹nds
 
ICÜfuSMR
<T>> R 
	`acûss
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

41 
ICÜfuSMRAcûss
<
R
, 
T
> 
acûssFunùiÚ
,

42 
Objeù
[] 
cÚæiùObjeù
) {

47  
´oxy
.
	`g‘Und”lyšgObjeù
().
	`acûss
(
o
 -> o.
	`g‘V”siÚUn§ã
()

48 =ğ
	`g‘SÇpshÙTime¡amp
().
	`g‘Sequ’û
()

49 && !
o
.
	`isO±imi¡iÿÎyModif›dUn§ã
(),

50 
o
 -> {

51 
	`syncW™hR‘ryUn§ã
(
o
, 
	`g‘SÇpshÙTime¡amp
(), 
´oxy
, 
nuÎ
);

53 
o
 -> 
acûssFunùiÚ
.
	`acûss
(o));

54 
	}
}

63 @
Ov”ride


64 
	gpublic
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
Objeù
 
g‘UpÿÎResuÉ
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

65 
time¡amp
,

66 
Objeù
[] 
cÚæiùObjeù
) {

67 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't get upcall during‡„ead-onlyransaction!");

77 @
Ov”ride


78 
	gpublic
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> 
logUpd©e
(
ICÜfuSMRProxyIÁ”Çl
<T> 
´oxy
,

79 
SMREÁry
 
upd©eEÁry
,

80 
Objeù
[] 
cÚæiùObjeù
) {

81 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
(

85 @
Ov”ride


86 
public
 
	$logUpd©e
(
UUID
 
¡»amId
, 
SMREÁry
 
upd©eEÁry
) {

87 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't modify object during‡„ead-onlyransaction!");

88 
	}
}

90 @
Ov”ride


91 
public
 
	$addT¿n§ùiÚ
(
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
tc
) {

92 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Can't merge into‡„eadonlyxn (yet)");

93 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/Transaction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

19 @
	gG‘‹r


20 @
	gAÎArgsCÚ¡ruùÜ


21 @
Bud”


22 
public
 cÏs 
	cT¿n§ùiÚ
 {

27 @
NÚNuÎ


28 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

33 @
DeçuÉ


34 
fš®
 
T¿n§ùiÚTy³
 
	mty³
 = T¿n§ùiÚTy³.
OPTIMISTIC
;;

40 @
DeçuÉ


41 
fš®
 
Tok’
 
	m¢­shÙ
 = Tok’.
UNINITIALIZED
;;

47 
public
 
	$begš
() {

48 
	`v”ify
();

49 
T¿n§ùiÚ®CÚ‹xt
.
	`ÃwCÚ‹xt
(
ty³
.
g‘
.
	`­¶y
(
this
));

52 
public
 
boŞ—n
 
	$isLoggšgEÇbËd
() {

53  
ruÁime
.
	`g‘ObjeùsV›w
().
	`isT¿n§ùiÚLoggšg
();

54 
	}
}

59 
´iv©e
 
	$v”ify
() {

60 
fš®
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
·»ÁCtx
 = 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
();

61 ià(
·»ÁCtx
 !ğ
nuÎ
) {

63 ià(
·»ÁCtx
.
	`g‘T¿n§ùiÚ
().
	`g‘RuÁime
(è!ğ
this
.
ruÁime
) {

64 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
(

69 ià(
ty³
 !ğ
·»ÁCtx
.
	`g‘T¿n§ùiÚ
().
	`g‘Ty³
()) {

70 
SŒšg
 
msg
 = SŒšg.
	`fÜm©
("Attemptingo‚estransactions with‡ " +

72 
·»ÁCtx
.
	`g‘T¿n§ùiÚ
().
	`g‘Ty³
(), 
this
.getType());

73 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(
msg
);

77 
Tok’
 
·»ÁTime¡amp
 = 
·»ÁCtx
.
	`g‘SÇpshÙTime¡amp
();

78 ià(!
this
.
¢­shÙ
.
	`equ®s
(
Tok’
.
UNINITIALIZED
)

79 && !
this
.
¢­shÙ
.
	`equ®s
(
·»ÁTime¡amp
)) {

80 
SŒšg
 
msg
 = SŒšg.
	`fÜm©
("Attemptingo‚estransactions with" +

82 
·»ÁCtx
.
	`g‘SÇpshÙTime¡amp
(), 
this
.
¢­shÙ
);

83 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(
msg
);

96 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/TransactionType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

5 
impÜt
 
	glombok
.
	gRequœedArgsCÚ¡ruùÜ
;

10 @
RequœedArgsCÚ¡ruùÜ


11 
public
 
	eT¿n§ùiÚTy³
 {

12 
OPTIMISTIC
(
O±imi¡icT¿n§ùiÚ®CÚ‹xt
::
Ãw
),

13 
SNAPSHOT
(
SÇpshÙT¿n§ùiÚ®CÚ‹xt
::
Ãw
),

14 
WRITE_AFTER_WRITE
(
Wr™eAá”Wr™eT¿n§ùiÚ®CÚ‹xt
::
Ãw
);

16 
fš®
 
	mFunùiÚ
<
	mT¿n§ùiÚ
, ? 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚ®CÚ‹xt
> 
	mg‘
;

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/TransactionalContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

4 
impÜt
 
	gjava
.
	gut
.
	gDeque
;

5 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 @
Slf4j


19 
public
 cÏs 
	cT¿n§ùiÚ®CÚ‹xt
 {

24 
´iv©e
 
fš®
 
	mTh»adLoÿl
<
	mDeque
<
	mAb¡¿ùT¿n§ùiÚ®CÚ‹xt
>>

25 
	mth»adT¿n§ùiÚSck
 = 
Th»adLoÿl
.
w™hIn™Ÿl
(
LškedLi¡
::
Ãw
);

31 
public
 
boŞ—n
 
	$isInNe¡edT¿n§ùiÚ
() {

32  
th»adT¿n§ùiÚSck
.
	`g‘
().
	`size
() > 1;

40 
public
 
Deque
<
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
> 
	$g‘T¿n§ùiÚSck
() {

41  
th»adT¿n§ùiÚSck
.
	`g‘
();

42 
	}
}

49 
public
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	$g‘Cu¼’tCÚ‹xt
() {

50  
	`g‘T¿n§ùiÚSck
().
	`³ekFœ¡
();

51 
	}
}

58 
public
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	$g‘RoÙCÚ‹xt
() {

59  
	`g‘T¿n§ùiÚSck
().
	`³ekLa¡
();

60 
	}
}

67 
public
 
boŞ—n
 
	$isInT¿n§ùiÚ
() {

68  
	`g‘T¿n§ùiÚSck
().
	`³ekFœ¡
(è!ğ
nuÎ
;

69 
	}
}

76 
public
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	$ÃwCÚ‹xt
(
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
cÚ‹xt
) {

77 
log
.
	`debug
("TX begš[{}]", 
cÚ‹xt
);

78 
	`g‘T¿n§ùiÚSck
().
	`addFœ¡
(
cÚ‹xt
);

79  
cÚ‹xt
;

80 
	}
}

86 
public
 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
	$»moveCÚ‹xt
() {

87 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
r
 = 
	`g‘T¿n§ùiÚSck
().
	`pŞlFœ¡
();

88 ià(
	`g‘T¿n§ùiÚSck
().
	`isEm±y
()) {

89 
	`synchrÚized
 (
	`g‘T¿n§ùiÚSck
()) {

90 
	`g‘T¿n§ùiÚSck
().
	`nÙifyAÎ
();

93  
r
;

94 
	}
}

100 
public
 
	gLi¡
<
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
> 
	$g‘T¿n§ùiÚSckAsLi¡
() {

101 
Li¡
<
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
> 
li¡Rev”£
 =

102 
	`g‘T¿n§ùiÚSck
().
	`¡»am
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

103 
CŞËùiÚs
.
	`»v”£
(
li¡Rev”£
);

104  
li¡Rev”£
;

105 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/WriteAfterWriteTransactionalContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

22 @
Slf4j


23 
public
 cÏs 
	cWr™eAá”Wr™eT¿n§ùiÚ®CÚ‹xt


24 
ex‹nds
 
	mO±imi¡icT¿n§ùiÚ®CÚ‹xt
 {

26 
	$Wr™eAá”Wr™eT¿n§ùiÚ®CÚ‹xt
(
T¿n§ùiÚ
 
Œª§ùiÚ
) {

27 
	`su³r
(
Œª§ùiÚ
);

28 
	`g‘SÇpshÙTime¡amp
();

31 @
Ov”ride


32 
public
 
	$comm™T¿n§ùiÚ
(è
throws
 
T¿n§ùiÚAbÜ‹dExû±iÚ
 {

33 
log
.
	`debug
("TX[{}]„eque¡ wr™e-wr™comm™", 
this
);

35  
	`g‘CÚæiùS‘AndComm™
(
	`g‘Wr™eS‘Info
());

36 
	}
}

38 @
Ov”ride


44 
public
 
	$addToR—dS‘
(
ICÜfuSMRProxyIÁ”Çl
 
´oxy
, 
Objeù
[] 
cÚæiùObjeùs
) {

47 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/WriteSetInfo.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

4 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

5 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
.
	gg‘RoÙCÚ‹xt
;

19 @
G‘‹r


20 
public
 cÏs 
	cWr™eS‘Info
 
ex‹nds
 
	mCÚæiùS‘Info
 {

23 
	mS‘
<
	mUUID
> 
	mafãùedSŒ—ms
 = 
Ãw
 
HashS‘
<>();

26 
MuÉiObjeùSMREÁry
 
	mwr™eS‘
 = 
Ãw
 MultiObjectSMREntry();

28 
public
 
	$add
(
ICÜfuSMRProxyIÁ”Çl
 
´oxy
, 
SMREÁry
 
upd©eEÁry
, 
Objeù
[] 
cÚæiùObjeùs
) {

29 
	`synchrÚized
 (
	`g‘RoÙCÚ‹xt
().
	`g‘T¿n§ùiÚID
()) {

32 
wr™eS‘
.
	`addTo
(
´oxy
.
	`g‘SŒ—mID
(), 
upd©eEÁry
);

34 
su³r
.
	`add
(
´oxy
, 
cÚæiùObjeùs
);

36  
wr™eS‘
.
	`g‘SMRUpd©es
(
´oxy
.
	`g‘SŒ—mID
()).
	`size
() - 1;

40 
public
 
	$add
(
UUID
 
¡»amId
, 
SMREÁry
 
upd©eEÁry
) {

41 
	`synchrÚized
 (
	`g‘RoÙCÚ‹xt
().
	`g‘T¿n§ùiÚID
()) {

43 
wr™eS‘
.
	`addTo
(
¡»amId
, 
upd©eEÁry
);

45 
	}
}

47 @
Ov”ride


48 
public
 
	$m”geIÁo
(
CÚæiùS‘Info
 
Ùh”
) {

49 ià(!(
Ùh”
 
š¡ªûof
 
Wr™eS‘Info
)) {

50 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Merging write set with„ead set unsupported");

53 
su³r
.
	`m”geIÁo
(
Ùh”
);

54 
afãùedSŒ—ms
.
	`addAÎ
(((
Wr™eS‘Info
è
Ùh”
).affectedStreams);

55 
wr™eS‘
.
	`m”geIÁo
(((
Wr™eS‘Info
è
Ùh”
).writeSet);

56 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/object/transactions/WriteSetSMRStream.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

4 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gISMRSŒ—m
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

60 @
	gSlf4j


61 @
Suµ»ssW¬nšgs
("checkstyle:abbreviationaswordinname")

62 
public
 cÏs 
	cWr™eS‘SMRSŒ—m
 
im¶em’ts
 
	mISMRSŒ—m
 {

64 
´iv©e
 
	mLi¡
<
	mAb¡¿ùT¿n§ùiÚ®CÚ‹xt
> 
	mcÚ‹xts
;

66 
	mcu¼’tCÚ‹xt
 = 0;

71 
´iv©e
 
	mcu¼’tCÚ‹xtPos
;

76 
´iv©e
 
	mwr™ePos
;

79 
´iv©e
 
fš®
 
UUID
 
	mid
;

86 
public
 
Wr™eS‘SMRSŒ—m
(
Li¡
<
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
> 
cÚ‹xts
,

87 
UUID
 
id
) {

88 
	mthis
.
	mcÚ‹xts
 = 
cÚ‹xts
;

89 
	mthis
.
	mid
 = 
id
;

90 
»£t
();

101 
public
 
boŞ—n
 
	$isSŒ—mCu¼’tCÚ‹xtTh»adCu¼’tCÚ‹xt
() {

102  
cÚ‹xts
.
	`g‘
(
cu¼’tCÚ‹xt
)

103 .
	`equ®s
(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
());

104 
	}
}

114 
public
 
boŞ—n
 
	$isSŒ—mFÜThisTh»ad
() {

115  
cÚ‹xts
.
	`g‘
(0)

116 .
	`equ®s
(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘RoÙCÚ‹xt
());

117 
	}
}

119 
	$m”geT¿n§ùiÚ
() {

120 
cÚ‹xts
.
	`»move
(cÚ‹xts.
	`size
() - 1);

121 ià(
cu¼’tCÚ‹xt
 =ğ
cÚ‹xts
.
	`size
()) {

124 
»adPos
 = 
Add»ss
.
	`maxNÚAdd»ss
();

125 
i
 = 0; i < 
cÚ‹xts
.
	`size
(); i++) {

126 
»adPos
 +ğ
cÚ‹xts
.
	`g‘
(
i
).
	`g‘Wr™eS‘EÁryLi¡
(
id
).
	`size
();

127 ià(
»adPos
 >ğ
wr™ePos
) {

128 
cu¼’tCÚ‹xtPos
 = 
cÚ‹xts
.
	`g‘
(
i
).
	`g‘Wr™eS‘EÁryLi¡
(
id
).
	`size
()

129 - (
wr™ePos
 - 
»adPos
) - 1;

132 
cu¼’tCÚ‹xt
--;

134 
	}
}

136 @
Ov”ride


137 
public
 
	$gc
(
ŒimM¬k
) {

139 
	}
}

141 @
Ov”ride


142 
public
 
	gLi¡
<
	gSMREÁry
> 
	$»maššgUpTo
(
maxGlob®
) {

144 ià(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘T¿n§ùiÚSck
().
	`size
()

145 > 
cÚ‹xts
.
	`size
()) {

146 
cÚ‹xts
 = 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘T¿n§ùiÚSckAsLi¡
();

147 } ià(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘T¿n§ùiÚSck
().
	`size
()

148 < 
cÚ‹xts
.
	`size
()) {

149 
	`m”geT¿n§ùiÚ
();

151 
Li¡
<
SMREÁry
> 
’ŒyLi¡
 = 
Ãw
 
LškedLi¡
<>();

154 
i
 = 
cu¼’tCÚ‹xt
; i < 
cÚ‹xts
.
	`size
(); i++) {

155 
fš®
 
Li¡
<
SMREÁry
> 
wr™eS‘
 = 
cÚ‹xts
.
	`g‘
(
i
)

156 .
	`g‘Wr™eS‘EÁryLi¡
(
id
);

157 
»adCÚ‹xtS¹
 = 
i
 =ğ
cu¼’tCÚ‹xt
 ? 
cu¼’tCÚ‹xtPos
 + 1 : 0;

158 
j
 = 
»adCÚ‹xtS¹
; j < 
wr™eS‘
.
	`size
(); j++) {

159 
’ŒyLi¡
.
	`add
(
wr™eS‘
.
	`g‘
((è
j
));

160 
wr™ePos
++;

162 ià(
wr™eS‘
.
	`size
() > 0) {

163 
cu¼’tCÚ‹xt
 = 
i
;

164 
cu¼’tCÚ‹xtPos
 = 
wr™eS‘
.
	`size
() - 1;

167  
’ŒyLi¡
;

168 
	}
}

170 @
Ov”ride


171 
public
 
	gLi¡
<
	gSMREÁry
> 
	$cu¼’t
() {

172 ià(
Add»ss
.
	`nÚAdd»ss
(
wr™ePos
)) {

173  
CŞËùiÚs
.
	`em±yLi¡
();

176 ià(
Add»ss
.
	`nÚAdd»ss
(
cu¼’tCÚ‹xtPos
)) {

177 
cu¼’tCÚ‹xtPos
 = -1;

180  
CŞËùiÚs
.
	`sšgËtÚLi¡
(
cÚ‹xts


181 .
	`g‘
(
cu¼’tCÚ‹xt
)

182 .
	`g‘Wr™eS‘EÁryLi¡
(
id
)

183 .
	`g‘
(()(
cu¼’tCÚ‹xtPos
)));

184 
	}
}

186 @
Ov”ride


187 
public
 
	gLi¡
<
	gSMREÁry
> 
	$´evious
() {

188 
wr™ePos
--;

190 ià(
wr™ePos
 <ğ
Add»ss
.
	`maxNÚAdd»ss
()) {

191 
wr™ePos
 = 
Add»ss
.
	`maxNÚAdd»ss
();

192  
CŞËùiÚs
.
	`em±yLi¡
();

195 
cu¼’tCÚ‹xtPos
--;

197 ià(
cu¼’tCÚ‹xtPos
 <ğ
Add»ss
.
	`maxNÚAdd»ss
()) {

199 ià(
cu¼’tCÚ‹xt
 == 0) {

200 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(

201 "A‰em±edØpİ fœ¡ cÚ‹xˆÕos=" + 
	`pos
() + ")");

203 
cu¼’tCÚ‹xt
--;

205 } 
cÚ‹xts


206 .
	`g‘
(
cu¼’tCÚ‹xt
)

207 .
	`g‘Wr™eS‘EÁrySize
(
id
) == 0);

208 
cu¼’tCÚ‹xtPos
 = 
cÚ‹xts


209 .
	`g‘
(
cu¼’tCÚ‹xt
)

210 .
	`g‘Wr™eS‘EÁrySize
(
id
) - 1 ;

213  
	`cu¼’t
();

214 
	}
}

216 @
Ov”ride


217 
public
 
	$pos
() {

218  
wr™ePos
;

219 
	}
}

221 @
Ov”ride


222 
public
 
	$»£t
() {

223 
wr™ePos
 = 
Add»ss
.
	`maxNÚAdd»ss
();

224 
cu¼’tCÚ‹xt
 = 0;

225 
cu¼’tCÚ‹xtPos
 = 
Add»ss
.
	`maxNÚAdd»ss
();

226 
	}
}

228 @
Ov”ride


229 
public
 
	$£ek
(
glob®Add»ss
) {

230 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

231 
	}
}

233 @
Ov”ride


234 
public
 
	gSŒ—m
<
	gSMREÁry
> 
	$¡»am
() {

235  
	`¡»amUpTo
(
Add»ss
.
MAX
);

236 
	}
}

238 @
Ov”ride


239 
public
 
	gSŒ—m
<
	gSMREÁry
> 
	$¡»amUpTo
(
maxGlob®
) {

240  
	`»maššgUpTo
(
maxGlob®
)

241 .
	`¡»am
();

242 
	}
}

244 @
Ov”ride


245 
public
 
­³nd
(
SMREÁry
 
’Œy
,

246 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
acquis™iÚC®lback
,

247 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
d—cquis™iÚC®lback
) {

248 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

251 @
Ov”ride


252 
public
 
UUID
 
	$g‘ID
() {

253  
id
;

254 
	}
}

256 @
Ov”ride


257 
public
 
SŒšg
 
	$toSŒšg
() {

258  "WSSMRSŒ—m[" + 
Uts
.
	`toR—dabËId
(
	`g‘ID
()) + "]";

259 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/AbstractView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

8 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”v”NÙR—dyExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

30 @
Slf4j


31 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùV›w
 {

33 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

35 
public
 
Ab¡¿ùV›w
(@
NÚnuÎ
 
fš®
 
CÜfuRuÁime
 
ruÁime
) {

36 
	mthis
.
	mruÁime
 = 
ruÁime
;

44 
public
 
Layout
 
	$g‘Cu¼’tLayout
() {

45 
Œue
) {

46 
Œy
 {

47  
ruÁime
.
Ïyout
.
	`g‘
();

48 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

49 
log
.
	`w¬n
("Errorƒxecuting„emote call, invalidating view‡nd„etrying in {}s",

50 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘CÚÃùiÚR‘ryR©e
(), 
ex
);

51 
ruÁime
.
	`šv®id©eLayout
();

52 
SË•
.
	`¦“pUnš‹¼u±ibly
(
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘CÚÃùiÚR‘ryR©e
());

55 
	}
}

57 
	gpublic
 <
	gT
, 
A
 
ex‹nds
 
	gRuÁimeExû±iÚ
, 
B
ƒx‹nd RuÁimeExû±iÚ, 
C
ƒxtends RuntimeException,

58 
D
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
T
 
ÏyoutH–³r
(
LayoutFunùiÚ
<
Layout
, T, 
A
, 
B
, 
C
, D>

59 
funùiÚ
)

60 
throws
 
	gA
, 
	gB
, 
	gC
, 
	gD
 {

61  
ÏyoutH–³r
(
funùiÚ
, 
çl£
);

68 
´iv©e
 
fš®
 
	gAtomicReã»nû
<
	gRuÁimeLayout
> 
	gruÁimeLayout
 = 
Ãw
 
AtomicReã»nû
<>();

76 
´iv©e
 
Layout
 
	$g‘LayoutUnš‹¼u±ibly
() {

77 
Œy
 {

78  
ruÁime
.
Ïyout
.
	`g‘
();

79 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

80 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
("IÁ”ru±ed iÀÏyoutH–³r", 
›
);

81 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
ex
) {

83 
ruÁime
.
	`šv®id©eLayout
();

87 ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
E¼Ü
) {

88 
log
.
	`”rÜ
("g‘LayoutUnš‹¼u±ibly: EncouÁ”edƒ¼Ü. AbÜtšg†ayoutH–³r", 
ex
);

89 
	`throw
 (
E¼Ü
è
ex
.
	`g‘Cau£
();

92 ià(
ex
.
	`g‘Cau£
(è
š¡ªûof
 
RuÁimeExû±iÚ
) {

93 
log
.
	`”rÜ
("getLayoutUninterruptibly: Encountered uncheckedƒxception. "

94 + "AbÜtšg†ayoutH–³r", 
ex
);

95 
	`throw
 (
RuÁimeExû±iÚ
è
ex
.
	`g‘Cau£
();

98 
log
.
	`”rÜ
("getLayoutUninterruptibly: Encounteredƒxception while fetching†ayout");

99 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
ex
);

101 
	}
}

120 
	gpublic
 <
	gT
, 
A
 
ex‹nds
 
	gRuÁimeExû±iÚ
, 
B
ƒx‹nd RuÁimeExû±iÚ, 
C
ƒxtends RuntimeException,

121 
D
 
ex‹nds
 
	gRuÁimeExû±iÚ
> 
T
 
ÏyoutH–³r
(
LayoutFunùiÚ
<
Layout
, T, 
A
, 
B
, 
C
, D> 
funùiÚ
,

122 
boŞ—n
 
»throwAÎExû±iÚs
)

123 
throws
 
	gA
, 
	gB
, 
	gC
, 
	gD
 {

124 
	gruÁime
.
g‘P¬am‘”s
().
g‘BefÜeRpcHªdËr
().
run
();

125 
fš®
 
Du¿tiÚ
 
	g»ŒyR©e
 = 
ruÁime
.
g‘P¬am‘”s
().
g‘CÚÃùiÚR‘ryR©e
();

126 
	gsy¡emDownTrigg”CouÁ”
 = 0;

127 
	gŒue
) {

129 
fš®
 
Layout
 
	gÏyout
 = 
g‘LayoutUnš‹¼u±ibly
();

131 
	gŒy
 {

132  
	gfunùiÚ
.
­¶y
(
ruÁimeLayout
.
upd©eAndG‘
(
rLayout
 -> {

133 ià(
rLayout
 =ğ
nuÎ
 ||„Layout.
g‘Layout
().
g‘Epoch
(è!ğ
Ïyout
.getEpoch()) {

134  
Ãw
 
RuÁimeLayout
(
Ïyout
, 
ruÁime
);

136  
rLayout
;

138 } 
ÿtch
 (
RuÁimeExû±iÚ
 
»
) {

139 ià(
	g»
.
g‘Cau£
(è
š¡ªûof
 
	gTimeoutExû±iÚ
) {

140 
	glog
.
w¬n
("Timeoutƒxecuting„emote call, invalidating view‡nd„etrying "

141 + "š {}s", 
»ŒyR©e
);

142 } ià(
»
 
š¡ªûof
 
	gS”v”NÙR—dyExû±iÚ
) {

143 
	glog
.
w¬n
("Server still‚ot„eady. Waiting for servero start "

145 } ià(
»
 
š¡ªûof
 
	gWrÚgEpochExû±iÚ
) {

146 
WrÚgEpochExû±iÚ
 
	gwe
 = (WrÚgEpochExû±iÚè
»
;

147 
	glog
.
w¬n
("Got‡ wrongƒpochƒxception, updatingƒpocho {}‡nd "

148 + "šv®id©v›w", 
we
.
g‘CÜ»ùEpoch
());

149 } ià(
»
 
š¡ªûof
 
	gN‘wÜkExû±iÚ
) {

150 
	glog
.
w¬n
("ÏyoutH–³r: Sy¡em s“m uÇvaabË", 
»
);

152 
throw
 
	g»
;

154 ià(
	g»throwAÎExû±iÚs
) {

155 
throw
 
	g»
;

159 
	glog
.
šfo
("layoutHelper: Retried {}imes, SystemDownHandlerTriggerLimit = {}",

160 
sy¡emDownTrigg”CouÁ”
,

161 
ruÁime
.
g‘P¬am‘”s
().
g‘Sy¡emDownHªdËrTrigg”Lim™
());

164 ià(++
	gsy¡emDownTrigg”CouÁ”


165 >ğ
ruÁime
.
g‘P¬am‘”s
().
g‘Sy¡emDownHªdËrTrigg”Lim™
()) {

166 
log
.
šfo
("layoutHelper: Invokinghe systemDownHandler.");

167 
	gruÁime
.
g‘P¬am‘”s
().
g‘Sy¡emDownHªdËr
().
run
();

170 
	gruÁime
.
šv®id©eLayout
();

171 
	gSË•
.
¦“pUnš‹¼u±ibly
(
»ŒyR©e
);

175 @
FunùiÚ®IÁ”çû


176 
public
 
š‹rçû
 
	gLayoutFunùiÚ
<
	gV
, 
	gR
, 
A
 
ex‹nds
 
	gThrowabË
,

177 
B
 
ex‹nds
 
	gThrowabË
, 
C
ƒx‹nd ThrowabË, 
D
ƒxtends Throwable> {

178 
R
 
­¶y
(
RuÁimeLayout
 
l
è
throws
 
	gA
, 
	gB
, 
	gC
, 
	gD
;

	@runtime/src/main/java/org/corfudb/runtime/view/Address.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
public
 cÏs 
	cAdd»ss
 {

19 
public
 
boŞ—n
 
	$nÚAdd»ss
(
addr
) {

20  !
	`isAdd»ss
(
addr
);

29 
public
 
boŞ—n
 
	$isAdd»ss
(
addr
) {

30  
addr
 >= 0;

31 
	}
}

38 @
G‘‹r


39 
´iv©e
 
	gmšAdd»ss
 = 0L;

42 
public
 
	$maxNÚAdd»ss
() {

44 
	}
}

49 
public
 
fš®
 
	gNON_ADDRESS
 = -1L;

52 
public
 
fš®
 
	gMAX
 = 
LÚg
.
MAX_VALUE
;

57 
public
 
fš®
 
	gABORTED
 = -2L;

62 
public
 
fš®
 
	gNOT_FOUND
 = -3L;

67 
public
 
fš®
 
	gOPTIMISTIC
 = -4L;

72 
public
 
fš®
 
	gNO_BACKPOINTER
 = -5L;

77 
public
 
fš®
 
	gNON_EXIST
 = -6L;

82 
public
 
fš®
 
	gNEVER_READ
 = -1L;

87 
public
 
fš®
 
	gCOW_BACKPOINTER
 = -7L;

	@runtime/src/main/java/org/corfudb/runtime/view/AddressSpaceView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gGauge
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gÿche
.
	gCache
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gÿche
.
	gCacheBud”
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gÿche
.
	gRemov®NÙifiÿtiÚ
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gI‹¿bËs
;

10 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

11 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gUncheckedExecutiÚExû±iÚ
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gtimeout
.
	gTimeoutExû±iÚ
;

13 
impÜt
 
	glombok
.
	gNÚNuÎ
;

14 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gITok’
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÙaExûededExû±iÚ
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gSËTok’Exû±iÚ
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWr™eSizeExû±iÚ
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

39 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

40 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

41 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

42 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

43 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

44 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

45 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

46 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

47 
impÜt
 
	gjava
.
	gut
.
	gM­
;

48 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

49 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

50 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

51 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘iÚExû±iÚ
;

52 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

53 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

54 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

62 @
Slf4j


63 
public
 cÏs 
	cAdd»ssS·ûV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

65 
´iv©e
 
fš®
 
	mCACHE_KEY_SIZE
 = 
M‘ricsUts
.
sizeOf
.
d“pSizeOf
(0L);

66 
´iv©e
 
fš®
 
	mDEFAULT_MAX_CACHE_ENTRIES
 = 5000;

67 
´iv©e
 
fš®
 
boŞ—n
 
	mNO_THROW
 = 
çl£
;

72 
´iv©e
 
fš®
 
	mCache
<
	mLÚg
, 
	mILogD©a
> 
	m»adCache
;

73 
´iv©e
 
fš®
 
R—dO±iÚs
 
	mdeçuÉR—dO±iÚs
 = R—dO±iÚs.
bud”
()

74 .
ignÜeTrim
(
çl£
)

75 .
wa™FÜHŞe
(
Œue
)

76 .
ş›ÁCach—bË
(
Œue
)

77 .
£rv”Cach—bË
(
Œue
)

78 .
bud
();

83 
public
 
Add»ssS·ûV›w
(@
NÚnuÎ
 
fš®
 
CÜfuRuÁime
 
ruÁime
) {

84 
su³r
(
ruÁime
);

86 
	mCacheBud”
<
	mObjeù
, Objeù> 
	mÿcheBud”
 = 
CacheBud”
.
ÃwBud”
();

88 
fš®
 
boŞ—n
 
	mÿcheDi§bËd
 = 
ruÁime
.
g‘P¬am‘”s
().
isCacheDi§bËd
();

89 
fš®
 
	mmaxCacheEÁr›s
 = 
ruÁime
.
g‘P¬am‘”s
().
g‘MaxCacheEÁr›s
();

90 
fš®
 
	mmaxCacheWeight
 = 
ruÁime
.
g‘P¬am‘”s
().
g‘MaxCacheWeight
();

91 
fš®
 
	mcÚcu¼’cyLev–
 = 
ruÁime
.
g‘P¬am‘”s
().
g‘CacheCÚcu¼’cyLev–
();

93 ià(
	mmaxCacheWeight
 != 0) {

94 
ÿcheBud”
.
maximumWeight
(
maxCacheWeight
);

95 
	mÿcheBud”
.
weigh”
((
k
, 
v
è-> (è(
CACHE_KEY_SIZE
 + 
M‘ricsUts
.
sizeOf
.
d“pSizeOf
(v)));

98 ià(
	mÿcheDi§bËd
) {

99 
	mÿcheBud”
.
maximumSize
(0);

100 } ià(
	mmaxCacheEÁr›s
 != 0) {

101 
ÿcheBud”
.
maximumSize
(
maxCacheEÁr›s
);

102 } ià(
	mmaxCacheWeight
 == 0) {

104 
ÿcheBud”
.
maximumSize
(
DEFAULT_MAX_CACHE_ENTRIES
);

107 ià(
	mcÚcu¼’cyLev–
 != 0) {

108 
ÿcheBud”
.
cÚcu¼’cyLev–
(concurrencyLevel);

111 
	m»adCache
 = 
ÿcheBud”
.
expœeAá”Acûss
(
ruÁime
.
g‘P¬am‘”s
().
g‘CacheExpœyTime
(), 
TimeUn™
.
SECONDS
)

112 .
expœeAá”Wr™e
(
ruÁime
.
g‘P¬am‘”s
().
g‘CacheExpœyTime
(), 
TimeUn™
.
SECONDS
)

113 .
»mov®Li¡’”
(
this
::
hªdËEviùiÚ
)

114 .
»cÜdSts
()

115 .
bud
();

117 
M‘ricRegi¡ry
 
	mm‘rics
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

118 
fš®
 
SŒšg
 
	mpfx
 = SŒšg.
fÜm©
("%s0x%x.ÿche.", 
CÜfuCompÚ’t
.
ADDRESS_SPACE_VIEW
.
toSŒšg
(),

119 
this
.
hashCode
());

120 
	mm‘rics
.(
	mpfx
 + "ÿche-size", (
	mGauge
<
	mLÚg
>è
	m»adCache
::
size
);

121 
	mm‘rics
.(
	mpfx
 + "eviùiÚs", (
	mGauge
<
	mLÚg
>è(è-> 
	m»adCache
.
¡©s
().
eviùiÚCouÁ
());

122 
	mm‘rics
.(
	mpfx
 + "h™-¿‹", (
	mGauge
<
	mDoubË
>è(è-> 
	m»adCache
.
¡©s
().
h™R©e
());

123 
	mm‘rics
.(
	mpfx
 + "h™s", (
	mGauge
<
	mLÚg
>è(è-> 
	m»adCache
.
¡©s
().
h™CouÁ
());

124 
	mm‘rics
.(
	mpfx
 + "mis£s", (
	mGauge
<
	mLÚg
>è(è-> 
	m»adCache
.
¡©s
().
missCouÁ
());

127 
´iv©e
 
hªdËEviùiÚ
(
Remov®NÙifiÿtiÚ
<
LÚg
, 
ILogD©a
> 
nÙifiÿtiÚ
) {

128 ià(
	glog
.
isT¿ûEÇbËd
()) {

129 
	glog
.
Œaû
("hªdËEviùiÚ:ƒviùšg {} cau£ {}", 
nÙifiÿtiÚ
.
g‘Key
(),‚ÙifiÿtiÚ.
g‘Cau£
());

136 
public
 
	$gc
(
ŒimM¬k
) {

137 
»adCache
.
	`asM­
().
	`’ŒyS‘
().
	`»moveIf
(
e
 ->ƒ.
	`g‘Key
(è< 
ŒimM¬k
);

138 
	}
}

143 
public
 
	$»£tCaches
() {

144 
»adCache
.
	`šv®id©eAÎ
();

145 
	}
}

160 
´iv©e
 
v®id©eS‹OfWr™‹nEÁry
(
add»ss
, @
NÚnuÎ
 
ILogD©a
 
ld
) {

161 
ILogD©a
 
	glogD©a
;

162 
	gŒy
 {

163 
	glogD©a
 = 
»ad
(
add»ss
);

164 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

166 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
("We cannot determine state of‡n update because of‡rim.");

169 ià(!
	glogD©a
.
equ®s
(
ld
)) {

170 
throw
 
Ãw
 
Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
DIFF_DATA
);

189 
public
 
wr™e
(@
NÚnuÎ
 
ITok’
 
tok’
, @NÚnuÎ 
Objeù
 
d©a
, @NÚnuÎ 
CacheO±iÚ
 
ÿcheO±iÚ
) {

190 
ILogD©a
 
	gld
;

191 ià(
d©a
 
š¡ªûof
 
	gILogD©a
) {

192 
	gld
 = (
ILogD©a
è
d©a
;

194 
	gld
 = 
Ãw
 
LogD©a
(
D©aTy³
.
DATA
, 
d©a
, 
ruÁime
.
g‘P¬am‘”s
().
g‘CodecTy³
());

197 
ÏyoutH–³r
(
e
 -> {

198 
Layout
 
l
 = 
e
.
g‘Layout
();

202 ià(
tok’
.
g‘Epoch
(è!ğ
l
.getEpoch()) {

203 
throw
 
Ãw
 
SËTok’Exû±iÚ
(
l
.
g‘Epoch
());

207 
ld
.
u£Tok’
(
tok’
);

208 
ld
.
£tId
(
ruÁime
.
g‘P¬am‘”s
().
g‘Cl›ÁId
());

211 
Œy
 {

212 
l
.
g‘R•liÿtiÚMode
(
tok’
.
g‘Sequ’û
())

213 .
g‘R•liÿtiÚPrÙocŞ
(
ruÁime
)

214 .
wr™e
(
e
, 
ld
);

215 } 
ÿtch
 (
Ov”wr™eExû±iÚ
 
ex
) {

216 ià(
ex
.
g‘Ov”Wr™eCau£
(è=ğ
Ov”wr™eCau£
.
SAME_DATA
) {

220 
v®id©eS‹OfWr™‹nEÁry
(
tok’
.
g‘Sequ’û
(), 
ld
);

226 
throw
 
ex
;

228 } 
ÿtch
 (
Wr™eSizeExû±iÚ
 | 
QuÙaExûededExû±iÚ
 
›
) {

229 
log
.
w¬n
("wr™e: wr™çed", 
›
);

230 
throw
 
›
;

231 } 
ÿtch
 (
RuÁimeExû±iÚ
 
»
) {

232 
log
.
”rÜ
("wr™e: GÙƒxû±iÚ duršg„•liÿtiÚ…rÙocŞ wr™w™hok’: {}", 
tok’
, 
»
);

233 
v®id©eS‹OfWr™‹nEÁry
(
tok’
.
g‘Sequ’û
(), 
ld
);

235  
nuÎ
;

236 }, 
Œue
);

239 ià(
	gÿcheO±iÚ
 =ğ
CacheO±iÚ
.
WRITE_THROUGH
) {

240 
»adCache
.
put
(
tok’
.
g‘Sequ’û
(), 
ld
);

250 
public
 
	$wr™e
(
ITok’
 
tok’
, 
Objeù
 
d©a
è
throws
 
Ov”wr™eExû±iÚ
 {

251 
	`wr™e
(
tok’
, 
d©a
, 
CacheO±iÚ
.
WRITE_THROUGH
);

252 
	}
}

264 
	gpublic
 @
NuÎabË


265 
ILogD©a
 
	$³ek
(
fš®
 
add»ss
) {

266  
	`ÏyoutH–³r
(
e
 ->ƒ.
	`g‘Layout
().
	`g‘R•liÿtiÚMode
(
add»ss
)

267 .
	`g‘R•liÿtiÚPrÙocŞ
(
ruÁime
)

268 .
	`³ek
(
e
, 
add»ss
));

269 
	}
}

274 
	gpublic
 @
NÚNuÎ
 
ILogD©a
 
	$»ad
(
add»ss
) {

275  
	`»ad
(
add»ss
, 
deçuÉR—dO±iÚs
);

276 
	}
}

285 
	gpublic
 @
NÚnuÎ


286 
ILogD©a
 
»ad
(
add»ss
, @
NÚNuÎ
 
R—dO±iÚs
 
İtiÚs
) {

304 
ILogD©a
 
	gd©a
 = 
»adCache
.
g‘IfP»£Á
(
add»ss
);

305 ià(
	gd©a
 =ğ
nuÎ
) {

311 
fš®
 
ILogD©a
 
lßdedV®
 = 
ãtch
(
add»ss
);

312  
ÿcheLßdAndG‘
(
»adCache
, 
add»ss
, 
lßdedV®
, 
İtiÚs
);

314  
	gd©a
;

329 
	gpublic
 @
NÚnuÎ


330 
ILogD©a
 
»ad
(@
NÚNuÎ
 
LÚg
 
ÃxtR—d
, @NÚNuÎ 
NavigabËS‘
<LÚg> 
add»s£s
,

331 @
NÚNuÎ
 
R—dO±iÚs
 
İtiÚs
) {

332 ià(
	gİtiÚs
.
isCl›ÁCach—bË
()) {

333 
ILogD©a
 
	gd©a
 = 
»adCache
.
g‘IfP»£Á
(
ÃxtR—d
);

334 ià(
	gd©a
 =ğ
nuÎ
) {

335 
Li¡
<
LÚg
> 
b©ch
 = 
g‘B©ch
(
ÃxtR—d
, 
add»s£s
);

336 
	glog
.
Œaû
("»ad:„eque¡‡dd»s {},„—d b©ch {}", 
ÃxtR—d
, 
b©ch
);

337 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	gm­Add»s£s
 = 
»ad
(
b©ch
, 
İtiÚs
);

338 
	gd©a
 = 
m­Add»s£s
.
g‘
(
ÃxtR—d
);

341  
	gd©a
;

344  
ãtch
(
ÃxtR—d
);

354 
´iv©e
 
	gLi¡
<
	gLÚg
> 
g‘B©ch
(
cu¼’tR—d
, @
NÚNuÎ
 
NavigabËS‘
<
LÚg
> 
queue
) {

355 
	gLi¡
<
	gLÚg
> 
	gb©chR—d
 = 
Ãw
 
A¼ayLi¡
<>();

356 
	gb©chR—d
.
add
(
cu¼’tR—d
);

358 
	gI‹¿tÜ
<
	gLÚg
> 
	g™
 = 
queue
.
™”©Ü
();

359 
	g™
.
hasNext
(è&& 
	gb©chR—d
.
size
(è< 
	gruÁime
.
g‘P¬am‘”s
().
g‘SŒ—mB©chSize
()) {

360 
	gb©chR—d
.
add
(
™
.
Ãxt
());

363  
	gb©chR—d
;

378 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
»ad
(
I‹¿bË
<
LÚg
> 
add»s£s
) {

379  
»ad
(
add»s£s
, 
deçuÉR—dO±iÚs
);

386 
´iv©e
 
ILogD©a
 
ÿcheLßdAndG‘
(@
NÚNuÎ
 
Cache
<
LÚg
, ILogD©a> 
ÿche
, 
add»ss
,

387 @
NÚNuÎ
 
ILogD©a
 
lßdedV®ue
,

388 @
NÚNuÎ
 
R—dO±iÚs
 
İtiÚs
) {

390 ià(!
	gİtiÚs
.
isCl›ÁCach—bË
()) {

391  
	glßdedV®ue
;

394 
	gŒy
 {

395  
	gÿche
.
g‘
(
add»ss
, (è-> 
lßdedV®ue
);

396 } 
ÿtch
 (
ExecutiÚExû±iÚ
 | 
UncheckedExecutiÚExû±iÚ
 
e
) {

400 
ThrowabË
 
	gÿu£
 = 
e
.
g‘Cau£
();

401 ià(
ÿu£
 
š¡ªûof
 
	gRuÁimeExû±iÚ
) {

402 
throw
 (
RuÁimeExû±iÚ
è
	gÿu£
;

404 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
ÿu£
);

415 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
»ad
(
I‹¿bË
<
LÚg
> 
add»s£s
, @
NÚNuÎ
 
R—dO±iÚs
 
İtiÚs
) {

416 
fš®
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	gÿchedD©a
 = 
»adCache
.
g‘AÎP»£Á
(
add»s£s
);

417 
fš®
 
	gS‘
<
	gLÚg
> 
	gadd»s£sToF‘ch
 = 
S‘s
.
difã»nû
(

418 
S‘s
.
ÃwHashS‘
(
add»s£s
), 
ÿchedD©a
.
keyS‘
());

420 
fš®
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	gunÿchedD©a
 = 
ãtchAÎ
(
add»s£sToF‘ch
, 
İtiÚs
);

421 
fš®
 
	gLi¡
<
	gLÚg
> 
	gŒimmedAdd»s£s
 = 
f‹rTrimmedAdd»s£s
(
unÿchedD©a
);

422 
	gŒimmedAdd»s£s
.
fÜEach
(
unÿchedD©a
::
»move
);

424 
fš®
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	g»suÉ
 = 
unÿchedD©a
.
’ŒyS‘
().
¡»am
()

425 .
cŞËù
(
CŞËùÜs
.
toM­
(
EÁry
::
g‘Key
, 
’Œy
 ->

426 
ÿcheLßdAndG‘
(
»adCache
, 
’Œy
.
g‘Key
(),ƒÁry.
g‘V®ue
(), 
İtiÚs
)));

427 
	g»suÉ
.
putAÎ
(
ÿchedD©a
);

429 ià(!
	gŒimmedAdd»s£s
.
isEm±y
()) {

430 ià(!
	gİtiÚs
.
isIgnÜeTrim
()) {

431 
throw
 
Ãw
 
TrimmedExû±iÚ
(
ŒimmedAdd»s£s
);

434 
	glog
.
w¬n
("»ad: ignÜšgrimmed‡dd»s£ {}", 
ŒimmedAdd»s£s
);

438  
	g»suÉ
;

449 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
sim¶ePrÙocŞR—d
(
Li¡
<
LÚg
> 
add»ssB©ch
, 
R—dO±iÚs
 
»adO±iÚs
) {

451 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	gd©a
 = 
ÏyoutH–³r
(
ruÁimeLayout
 ->

452 
ruÁimeLayout
.
g‘Layout
()

453 .
g‘R•liÿtiÚMode
(
add»ssB©ch
.
™”©Ü
().
Ãxt
())

454 .
g‘R•liÿtiÚPrÙocŞ
(
ruÁime
)

455 .
»adAÎ
(
ruÁimeLayout
, 
add»ssB©ch
,

456 
»adO±iÚs
.
isWa™FÜHŞe
(),

457 
»adO±iÚs
.
isS”v”Cach—bË
()),

458 
Œue
);

459 
fš®
 
	gLi¡
<
	gLÚg
> 
	gŒimmedAdd»s£s
 = 
f‹rTrimmedAdd»s£s
(
d©a
);

460 
	gŒimmedAdd»s£s
.
fÜEach
(
d©a
::
»move
);

461 ià(!
	gŒimmedAdd»s£s
.
isEm±y
()) {

462 ià(!
	g»adO±iÚs
.
isIgnÜeTrim
()) {

463 
throw
 
Ãw
 
TrimmedExû±iÚ
(
ŒimmedAdd»s£s
);

466 
	glog
.
w¬n
("sim¶ePrÙocŞR—d: ignÜšgrimmed‡dd»s£ {}", 
ŒimmedAdd»s£s
);

468  
	gd©a
;

474 
public
 
Tok’
 
	$g‘TrimM¬k
() {

475  
	`ÏyoutH–³r
(

476 
e
 -> {

477 
ŒimM¬k
 = 
e
.
	`g‘Layout
().
£gm’ts
.
	`¡»am
()

478 .
	`æ©M­
(
£g
 -> seg.
	`g‘SŒes
().
	`¡»am
())

479 .
	`æ©M­
(
¡re
 -> sŒe.
	`g‘LogS”v”s
().
	`¡»am
())

480 .
	`m­
(
e
::
g‘LogUn™Cl›Á
)

481 .
	`m­
(
LogUn™Cl›Á
::
g‘TrimM¬k
)

482 .
	`m­
(
futu»
 -> {

486 
Œy
 {

487  
futu»
.
	`još
();

488 } 
	`ÿtch
 (
Com¶‘iÚExû±iÚ
 
ex
) {

489 
ThrowabË
 
ÿu£
 = 
ex
.
	`g‘Cau£
();

490 ià(
ÿu£
 
š¡ªûof
 
RuÁimeExû±iÚ
) {

491 
	`throw
 (
RuÁimeExû±iÚ
è
ÿu£
;

493 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
ÿu£
);

497 .
	`max
(
Com·¿tÜ
.
	`Çtu¿lOrd”
()).
	`g‘
();

498  
Ãw
 
	`Tok’
(
e
.
	`g‘Layout
().
	`g‘Epoch
(), 
ŒimM¬k
);

500 
	}
}

505 
public
 
LÚg
 
	$g‘LogTa
() {

506  
	`ÏyoutH–³r
(

507 
e
 -> 
Uts
.
	`g‘LogTa
Ó.
	`g‘Layout
(), 
ruÁime
));

508 
	}
}

513 
public
 
TasRe¥Ú£
 
	$g‘AÎTas
() {

514  
	`ÏyoutH–³r
(

515 
e
 -> 
Uts
.
	`g‘AÎTas
Ó.
	`g‘Layout
(), 
ruÁime
));

516 
	}
}

525 
public
 
SŒ—msAdd»ssRe¥Ú£
 
	$g‘LogAdd»ssS·û
() {

526  
	`ÏyoutH–³r
(

527 
e
 -> 
Uts
.
	`g‘LogAdd»ssS·û
Ó.
	`g‘Layout
(), 
ruÁime
));

528 
	}
}

540 
public
 
	$´efixTrim
(
fš®
 
Tok’
 
add»ss
) {

541 
log
.
	`šfo
("P»fixTrim[{}]", 
add»ss
);

542 
fš®
 
numR‘r›s
 = 3;

544 
x
 = 0; x < 
numR‘r›s
; x++) {

545 
Œy
 {

554 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`ŒimCache
(
add»ss
.
	`g‘Sequ’û
());

556 
	`ÏyoutH–³r
(
e
 -> {

557 
e
.
	`g‘Layout
().
	`g‘P»fixSegm’ts
(
add»ss
.
	`g‘Sequ’û
()).
	`¡»am
()

558 .
	`æ©M­
(
£g
 -> seg.
	`g‘SŒes
().
	`¡»am
())

559 .
	`æ©M­
(
¡re
 -> sŒe.
	`g‘LogS”v”s
().
	`¡»am
())

560 .
	`m­
(
e
::
g‘LogUn™Cl›Á
)

561 .
	`m­
(
ş›Á
 -> cl›Á.
	`´efixTrim
(
add»ss
))

562 .
	`fÜEach
(
cf
 -> {

563 
CFUts
.
	`g‘Unš‹¼u±ibly
(
cf
,

564 
N‘wÜkExû±iÚ
.
şass
, 
TimeoutExû±iÚ
.class,

565 
WrÚgEpochExû±iÚ
.
şass
);

567  
nuÎ
;

568 }, 
Œue
);

570 } 
	`ÿtch
 (
N‘wÜkExû±iÚ
 | 
TimeoutExû±iÚ
 
e
) {

571 
log
.
	`w¬n
("´efixTrim:ƒncouÁ”ed‡‚‘wÜkƒ¼Ü oÀŒy {}", 
x
, 
e
);

572 
Du¿tiÚ
 
»ŒyR©e
 = 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘CÚÃùiÚR‘ryR©e
();

573 
SË•
.
	`¦“pUnš‹¼u±ibly
(
»ŒyR©e
);

574 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
w“
) {

575 
£rv”Epoch
 = 
w“
.
	`g‘CÜ»ùEpoch
();

576 
ruÁimeEpoch
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

577 
log
.
	`w¬n
("prefixTrim[{}]: wrongEpochException,„untime is inƒpoch {}, while server is inƒpoch {}. "

579 
add»ss
, 
ruÁimeEpoch
, 
£rv”Epoch
, 
x
 + 1, 
numR‘r›s
);

580 
ruÁime
.
	`šv®id©eLayout
();

583 
	}
}

590 
public
 
	$gc
() {

591 
log
.
	`debug
("GarbageCollect");

592 
	`ÏyoutH–³r
(
e
 -> {

593 
e
.
	`g‘Layout
().
£gm’ts
.
	`¡»am
()

594 .
	`æ©M­
(
£g
 -> seg.
	`g‘SŒes
().
	`¡»am
())

595 .
	`æ©M­
(
¡re
 -> sŒe.
	`g‘LogS”v”s
().
	`¡»am
())

596 .
	`m­
(
e
::
g‘LogUn™Cl›Á
)

597 .
	`m­
(
LogUn™Cl›Á
::
com·ù
)

598 .
	`fÜEach
(
CFUts
::
g‘Unš‹¼u±ibly
);

599  
nuÎ
;

601 
	}
}

606 
public
 
	$šv®id©eS”v”Caches
() {

607 
log
.
	`debug
("InvalidateServerCaches");

608 
	`ÏyoutH–³r
(
e
 -> {

609 
e
.
	`g‘Layout
().
£gm’ts
.
	`¡»am
()

610 .
	`æ©M­
(
£g
 -> seg.
	`g‘SŒes
().
	`¡»am
())

611 .
	`æ©M­
(
¡re
 -> sŒe.
	`g‘LogS”v”s
().
	`¡»am
())

612 .
	`m­
(
e
::
g‘LogUn™Cl›Á
)

613 .
	`m­
(
LogUn™Cl›Á
::
æushCache
)

614 .
	`fÜEach
(
CFUts
::
g‘Unš‹¼u±ibly
);

615  
nuÎ
;

617 
	}
}

622 
public
 
	$šv®id©eCl›ÁCache
() {

623 
»adCache
.
	`šv®id©eAÎ
();

624 
	}
}

634 @
NÚnuÎ


635 
´iv©e
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
ãtchAÎ
(
I‹¿bË
<
LÚg
> 
add»s£s
, 
R—dO±iÚs
 
İtiÚs
) {

636 
fš®
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	g¿wD©a
 = 
Ãw
 
HashM­
<>();

637 ià(
	gI‹¿bËs
.
isEm±y
(
add»s£s
)) {

638  
	g¿wD©a
;

641 
fš®
 
	gI‹¿bË
<
	gLi¡
<
	gLÚg
>> 
	gb©ches
 = 
I‹¿bËs
.
·¹™iÚ
(
add»s£s
,

642 
ruÁime
.
g‘P¬am‘”s
().
g‘BulkR—dSize
());

644 
	gLi¡
<
	gLÚg
> 
	gb©ch
 : 
b©ches
) {

646 
M­
<
LÚg
, 
	gILogD©a
> 
	gb©chResuÉ
 = 
ÏyoutH–³r
(
Ïyout
 ->†ayout.
g‘Layout
()

647 .
g‘R•liÿtiÚMode
(
b©ch
.
™”©Ü
().
Ãxt
())

648 .
g‘R•liÿtiÚPrÙocŞ
(
ruÁime
)

649 .
»adAÎ
(
Ïyout
, 
b©ch
, 
İtiÚs
.
isWa™FÜHŞe
(), o±iÚs.
isS”v”Cach—bË
()));

651 ià(
	gb©chResuÉ
.
size
(è!ğ
b©ch
.size()) {

652 
log
.
”rÜ
("fetchAll: Requested‚umber of‡ddresses‚otƒqualohe„ead„esult" +

653 "äom s”v”,„eque¡ed: {},„‘uºed: {}", 
b©ch
, 
b©chResuÉ
.
keyS‘
());

654 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Requested‚umber of‡ddresses‚otƒqualohe„ead„esult");

656 
	g¿wD©a
.
putAÎ
(
b©chResuÉ
);

659  
	g¿wD©a
;

668 
´iv©e
 
	gLi¡
<
	gLÚg
> 
f‹rTrimmedAdd»s£s
(
M­
<
LÚg
, 
ILogD©a
> 
®lD©a
) {

669  
	g®lD©a
.
’ŒyS‘
().
¡»am
()

670 .
f‹r
(
’Œy
 -> !
isLogD©aV®id
ÓÁry.
g‘Key
(),ƒÁry.
g‘V®ue
(), 
NO_THROW
))

671 .
m­
(
EÁry
::
g‘Key
).
cŞËù
(
CŞËùÜs
.
toLi¡
());

683 
´iv©e
 
boŞ—n
 
	$isLogD©aV®id
(
add»ss
, 
ILogD©a
 
logD©a
, 
boŞ—n
 
throwExû±iÚ
) {

684 ià(
logD©a
 =ğ
nuÎ
 ||†ogD©a.
	`g‘Ty³
(è=ğ
D©aTy³
.
EMPTY
) {

685 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Unexpected„eturn ofƒmpty data‡t‡ddress "

686 + 
add»ss
 + " on„ead");

689 ià(
logD©a
.
	`isTrimmed
()) {

690 ià(
throwExû±iÚ
) {

691 
throw
 
Ãw
 
	`TrimmedExû±iÚ
(
SŒšg
.
	`fÜm©
("Trimmed‡dd»s %s", 
add»ss
));

693  
çl£
;

696  
Œue
;

697 
	}
}

705 
	g´iv©e
 @
NÚnuÎ


706 
ILogD©a
 
	$ãtch
(
fš®
 
add»ss
) {

707 
ILogD©a
 
»suÉ
 = 
	`ÏyoutH–³r
(
e
 ->ƒ.
	`g‘Layout
().
	`g‘R•liÿtiÚMode
(
add»ss
)

708 .
	`g‘R•liÿtiÚPrÙocŞ
(
ruÁime
)

709 .
	`»ad
(
e
, 
add»ss
)

712 
	`checkLogD©aThrowExû±iÚ
(
add»ss
, 
»suÉ
);

714  
»suÉ
;

715 
	}
}

717 
´iv©e
 
	$checkLogD©aThrowExû±iÚ
(
add»ss
, 
ILogD©a
 
»suÉ
) {

718 
	`isLogD©aV®id
(
add»ss
, 
»suÉ
, 
Œue
);

719 
	}
}

721 @
VisibËFÜTe¡šg


722 
	gCache
<
	gLÚg
, 
	gILogD©a
> 
	$g‘R—dCache
() {

723  
»adCache
;

724 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/CacheOption.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

9 
public
 
	eCacheO±iÚ
 {

13 
	mWRITE_AROUND
,

18 
	mWRITE_THROUGH


	@runtime/src/main/java/org/corfudb/runtime/view/ClusterStatusReport.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

14 @
D©a


15 
public
 cÏs 
	cClu¡”StusR•Üt
 {

20 
public
 
	eNodeStus
 {

25 
	mUP
,

30 
	mDB_SYNCING
,

35 
	mDOWN
,

43 
	mNA
;

49 
public
 
	eClu¡”Stus
 {

54 
STABLE
(0),

60 
DB_SYNCING
(1),

65 
DEGRADED
(2),

70 
UNAVAILABLE
(3);

72 @
G‘‹r


73 
fš®
 
	gh—ÉhV®ue
;

75 
Clu¡”Stus
(
h—ÉhV®ue
) {

76 
	gthis
.
	gh—ÉhV®ue
 = 
h—ÉhV®ue
;

83 
public
 
	eCÚÃùiv™yStus
 {

87 
RESPONSIVE
(
Œue
),

92 
UNRESPONSIVE
(
çl£
);

94 @
G‘‹r


95 
fš®
 
boŞ—n
 
	gpšg
;

97 
CÚÃùiv™yStus
(
boŞ—n
 
pšg
) {

98 
	gthis
.
	gpšg
 = 
pšg
;

106 
public
 
	eClu¡”StusR–Ÿb™y
 {

110 
	gSTRONG_QUORUM
,

115 
	gWEAK_NO_QUORUM
,

121 
	gUNAVAILABLE


127 
´iv©e
 
fš®
 
Layout
 
	gÏyout
;

132 
´iv©e
 
fš®
 
Clu¡”Stus
 
	gşu¡”Stus
;

137 
´iv©e
 
fš®
 
Clu¡”StusR–Ÿb™y
 
	gşu¡”StusR–Ÿb™y
;

142 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, 
	gNodeStus
> 
	gşu¡”NodeStusM­
;

147 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, 
	gCÚÃùiv™yStus
> 
	gş›ÁS”v”CÚÃùiv™yStusM­
;

	@runtime/src/main/java/org/corfudb/runtime/view/ConservativeFailureHandlerPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 @
Slf4j


14 
public
 cÏs 
	cCÚ£rv©iveFau»HªdËrPŞicy
 
im¶em’ts
 
	mIRecÚfigu¿tiÚHªdËrPŞicy
 {

27 @
Ov”ride


28 
public
 
Layout
 
g’”©eLayout
(Layouˆ
Üigš®Layout
,

29 
CÜfuRuÁime
 
cÜfuRuÁime
,

30 
S‘
<
SŒšg
> 
çedNodes
,

31 
S‘
<
SŒšg
> 
h—ËdNodes
) {

32 
LayoutBud”
 
	mÏyoutBud”
 = 
Ãw
 LayoutBud”(
Üigš®Layout
);

33 
Layout
 
	mÃwLayout
 = 
ÏyoutBud”


34 .
assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
çedNodes
)

35 .
»moveLogun™S”v”s
(
çedNodes
)

36 .
»moveUÄe¥ÚsiveS”v”s
(
h—ËdNodes
)

37 .
addUÄe¥ÚsiveS”v”s
(
çedNodes
)

38 .
bud
();

39 
	mÃwLayout
.
£tEpoch
(
ÃwLayout
.
g‘Epoch
() + 1);

40 
	mlog
.
šfo
("g’”©eLayout:‚ew Layouˆ{}", 
ÃwLayout
);

41  
	mÃwLayout
;

	@runtime/src/main/java/org/corfudb/runtime/view/CorfuGuidGenerator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

13 
impÜt
 
	gjava
.
	gtime
.
	gIn¡ªt
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

25 şas 
	cCÜfuGuid
 {

26 
public
 
fš®
 
	mMAX_CORRECTION
 = 0xF;

27 
´iv©e
 
fš®
 
	mtime¡amp
;

28 
´iv©e
 
fš®
 
	mdriáCÜ»ùiÚ
;

29 
´iv©e
 
fš®
 
	m»sŞutiÚCÜ»ùiÚ
;

30 @
G‘‹r


31 
´iv©e
 
fš®
 
	muniqueIn¡ªûId
;

33 
	$CÜfuGuid
(
UTCtime¡amp
, 
driáCÜ»ùiÚ
,

34 
»sŞutiÚCÜ»ùiÚ
, 
uniqueIn¡ªûId
) {

35 
this
.
time¡amp
 = 
UTCtime¡amp
;

36 
this
.
driáCÜ»ùiÚ
 = driftCorrection;

37 
this
.
»sŞutiÚCÜ»ùiÚ
 =„esolutionCorrection;

38 
this
.
uniqueIn¡ªûId
 = uniqueInstanceId;

41 
´iv©e
 
fš®
 
TIMESTAMP_MSB_MASK
 = 0x000000FFffFF0000L;

42 
´iv©e
 
fš®
 
TIMESTAMP_LSB_MASK
 = 0x000000000000FFffL;

43 
´iv©e
 
fš®
 
INSTANCE_ID_MASK
 = 0x000000000000FFffL;

44 
´iv©e
 
fš®
 
CORRECTION_MASK
 = 
MAX_CORRECTION
;

46 
´iv©e
 
fš®
 
TIMESTAMP_MSB_SHIFT
 = 24;

47 
´iv©e
 
fš®
 
DRIFT_ADJUST_SHIFT
 = 36;

48 
´iv©e
 
fš®
 
TIMESTAMP_LSB_SHIFT
 = 20;

49 
´iv©e
 
fš®
 
INSTANCE_ID_SHIFT
 = 4;

66 
public
 
	$g‘LÚg
() {

67 
fš®
 
time¡ampMSB
 = 
time¡amp
 & 
TIMESTAMP_MSB_MASK
;

68 
fš®
 
driáAdju¡
 = 
driáCÜ»ùiÚ
 & 
CORRECTION_MASK
;

69 
fš®
 
time¡ampLSB
 = 
time¡amp
 & 
TIMESTAMP_LSB_MASK
;

70 
fš®
 
š¡ªûId
 = 
uniqueIn¡ªûId
 & 
INSTANCE_ID_MASK
;

71 
fš®
 
»sŞutiÚAdju¡
 = 
»sŞutiÚCÜ»ùiÚ
 & 
CORRECTION_MASK
;

73  ((
time¡ampMSB
 << 
TIMESTAMP_MSB_SHIFT
) |

74 (
driáAdju¡
 << 
DRIFT_ADJUST_SHIFT
) |

75 (
time¡ampLSB
 << 
TIMESTAMP_LSB_SHIFT
) |

76 (
š¡ªûId
 << 
INSTANCE_ID_SHIFT
) |

77 
»sŞutiÚAdju¡
);

78 
	}
}

80 
	$CÜfuGuid
(
’codedTs
) {

81 
cu¼’tTime¡amp
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

82 
fš®
 
time¡ampMSB
 = (
’codedTs
 >> 
TIMESTAMP_MSB_SHIFT
è& 
TIMESTAMP_MSB_MASK
;

83 
fš®
 
time¡ampLSB
 = (
’codedTs
 >> 
TIMESTAMP_LSB_SHIFT
è& 
TIMESTAMP_LSB_MASK
;

84 
time¡amp
 = (
cu¼’tTime¡amp
 & (~(
TIMESTAMP_MSB_MASK
 | 
TIMESTAMP_LSB_MASK
)))

85 | 
time¡ampMSB
 | 
time¡ampLSB
;

86 
driáCÜ»ùiÚ
 = ()((
’codedTs
 >> 
DRIFT_ADJUST_SHIFT
è& 
CORRECTION_MASK
);

87 
uniqueIn¡ªûId
 = ()((
’codedTs
 >> 
INSTANCE_ID_SHIFT
è& 
INSTANCE_ID_MASK
);

88 
»sŞutiÚCÜ»ùiÚ
 = ()(
’codedTs
 & 
CORRECTION_MASK
);

89 
	}
}

91 
public
 
SŒšg
 
	$toSŒšg
() {

92  
SŒšg
.
	`fÜm©
("%s: drift: %d„esolution: %d instanceId %d",

93 
In¡ªt
.
	`ofEpochMli
(
time¡amp
).
	`toSŒšg
(),

94 
driáCÜ»ùiÚ
, 
»sŞutiÚCÜ»ùiÚ
, 
uniqueIn¡ªûId
);

95 
	}
}

98 @
Slf4j


99 
public
 cÏs 
	cCÜfuGuidG’”©Ü
 
im¶em’ts
 
	mOrd”edGuidG’”©Ü
 {

100 
´iv©e
 
fš®
 
SŒšg
 
	mGUID_STREAM_NAME
 = "CORFU_GUID_COUNTER_STREAM";

101 
´iv©e
 
fš®
 
IÁeg”
 
	mGUID_STREAM_KEY
 = 0xdeadbeef;

103 
´iv©e
 
fš®
 
	mCÜfuTabË
<
	mIÁeg”
, 
	mLÚg
> 
	mdi¡ribu‹dCouÁ”
;

105 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

112 
´iv©e
 
	mdriáCÜ»ùiÚ
 = 
CÜfuGuid
.
MAX_CORRECTION
;

113 
´iv©e
 
	m»sŞutiÚCÜ»ùiÚ
 = 
CÜfuGuid
.
MAX_CORRECTION
;

114 
´iv©e
 
	m´eviousTime¡amp
 = 
LÚg
.
MAX_VALUE
;

115 
´iv©e
 
	mš¡ªûId
 = 0L;

117 
´iv©e
 
CÜfuGuidG’”©Ü
 
	msšgËtÚCÜfuGuidG’”©Ü
;

119 
´iv©e
 
	$CÜfuGuidG’”©Ü
(
CÜfuRuÁime
 
¹
) {

120 
ruÁime
 = 
¹
;

121 
di¡ribu‹dCouÁ”
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

122 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
LÚg
>>() {})

123 .
	`£tSŒ—mName
(
GUID_STREAM_NAME
)

124 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
	`g‘DeçuÉS”Ÿliz”
())

125 .
	`İ’
();

128 
public
 
synchrÚized
 
CÜfuGuidG’”©Ü
 
	$g‘In¡ªû
(
CÜfuRuÁime
 
¹
) {

129 ià(
sšgËtÚCÜfuGuidG’”©Ü
 =ğ
nuÎ
) {

130 
sšgËtÚCÜfuGuidG’”©Ü
 = 
Ãw
 
	`CÜfuGuidG’”©Ü
(
¹
);

132  
sšgËtÚCÜfuGuidG’”©Ü
;

133 
	}
}

135 @
Ov”ride


136 
public
 
UUID
 
	$ÃxtUUID
() {

137 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Not supported yet");

138 
	}
}

143 
´iv©e
 
	$upd©eIn¡ªûId
() {

144 
ÃxtIn¡ªûId
;

145 
Œue
) {

146 
Œy
 {

147 
T¿n§ùiÚTy³
 
txnTy³
;

148 ià(
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

149 
txnTy³
 = 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
()

150 .
	`g‘T¿n§ùiÚ
().
	`g‘Ty³
();

152 
txnTy³
 = 
T¿n§ùiÚTy³
.
OPTIMISTIC
;

155 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
()

156 .
	`ty³
(
txnTy³
)

157 .
	`bud
()

158 .
	`begš
();

160 
ÃxtIn¡ªûId
 = 
di¡ribu‹dCouÁ”
.
	`g‘OrDeçuÉ
(
GUID_STREAM_KEY
, 1L) + 1;

161 
di¡ribu‹dCouÁ”
.
	`put
(
GUID_STREAM_KEY
, 
ÃxtIn¡ªûId
);

163 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

165 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

166 
log
.
	`”rÜ
("upd©eIn¡ªûId: T¿n§ùiÚ‡bÜ‹d whupd©šg GUID couÁ”", 
e
);

170 
š¡ªûId
 = 
ÃxtIn¡ªûId
;

171  
ÃxtIn¡ªûId
;

172 
	}
}

177 @
Ov”ride


178 
public
 
	$ÃxtLÚg
() {

179  
	`g‘CÜ»ùedTime¡amp
().
	`g‘LÚg
();

180 
	}
}

192 
´iv©e
 
synchrÚized
 
CÜfuGuid
 
	$g‘CÜ»ùedTime¡amp
() {

193 
cu¼’tTime¡amp
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

194 ià(
cu¼’tTime¡amp
 =ğ
´eviousTime¡amp
) {

195 
»sŞutiÚCÜ»ùiÚ
++;

199 ià(
»sŞutiÚCÜ»ùiÚ
 > 
CÜfuGuid
.
MAX_CORRECTION
) {

200 
cu¼’tTime¡amp
 =ğ
´eviousTime¡amp
) {

201 
cu¼’tTime¡amp
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

203 
»sŞutiÚCÜ»ùiÚ
 = 0;

206 
»sŞutiÚCÜ»ùiÚ
 = 0;

209 ià(
cu¼’tTime¡amp
 < 
´eviousTime¡amp
) {

210 
driáCÜ»ùiÚ
++;

211 ià(
driáCÜ»ùiÚ
 > 
CÜfuGuid
.
MAX_CORRECTION
) {

212 
log
.
	`šfo
("updateInstanceId: Time went backwardoo manyimes "+

214 
cu¼’tTime¡amp
, 
´eviousTime¡amp
, 
driáCÜ»ùiÚ
, 
š¡ªûId
);

215 
driáCÜ»ùiÚ
 = 0;

216 
	`upd©eIn¡ªûId
();

219 
´eviousTime¡amp
 = 
cu¼’tTime¡amp
;

220  
Ãw
 
	`CÜfuGuid
(
cu¼’tTime¡amp
, 
driáCÜ»ùiÚ
, 
»sŞutiÚCÜ»ùiÚ
, 
š¡ªûId
);

221 
	}
}

223 
public
 
SŒšg
 
	$toSŒšg
(
’codedTs
) {

224  
Ãw
 
	`CÜfuGuid
(
’codedTs
).
	`toSŒšg
();

225 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/IReconfigurationHandlerPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLayoutModifiÿtiÚExû±iÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
public
 
š‹rçû
 
	gIRecÚfigu¿tiÚHªdËrPŞicy
 {

26 
Layout
 
g’”©eLayout
(Layouˆ
cu¼’tLayout
,

27 
CÜfuRuÁime
 
cÜfuRuÁime
,

28 
S‘
<
SŒšg
> 
çedNodes
,

29 
S‘
<
SŒšg
> 
h—ËdNodes
)

30 
throws
 
	gLayoutModifiÿtiÚExû±iÚ
;

	@runtime/src/main/java/org/corfudb/runtime/view/Layout.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gObjeùs
.
	g»quœeNÚNuÎ
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚBud”
;

8 
impÜt
 
	glombok
.
	gD©a
;

9 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

10 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
impÜt
 
	glombok
.
	gNÚNuÎ
;

12 
impÜt
 
	glombok
.
	gS‘‹r
;

13 
impÜt
 
	glombok
.
	gToSŒšg
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
.
	gChašR•liÿtiÚPrÙocŞ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
.
	gIR•liÿtiÚPrÙocŞ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
.
	gNev”HŞeFlPŞicy
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
.
	gQuÜumR•liÿtiÚPrÙocŞ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
.
	gR—dWa™HŞeFlPŞicy
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gAdd»ssM­SŒ—mV›w
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gBackpoš‹rSŒ—mV›w
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gTh»adSaãSŒ—mV›w
;

27 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

28 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

29 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

31 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

35 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

36 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

37 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

43 @
D©a


44 
public
 cÏs 
	cLayout
 {

49 
public
 
fš®
 
	mCom·¿tÜ
<
	mLayout
> 
	mLAYOUT_COMPARATOR
 = 
Com·¿tÜ
.
com·ršg
(
Layout
::
g‘Epoch
).
»v”£d
();

54 @
G‘‹r


55 
fš®
 
GsÚ
 
	m·r£r
 = 
Ãw
 
GsÚBud”
()

56 .
»gi¡”Ty³Ad­‹r
(
Layout
.
şass
, 
Ãw
 
LayoutDe£rŸliz”
())

57 .
ü—‹
();

61 @
G‘‹r


62 
	mLi¡
<
	mSŒšg
> 
	mÏyoutS”v”s
;

66 @
G‘‹r


67 
	mLi¡
<
	mSŒšg
> 
	m£qu’ûrs
;

71 @
G‘‹r


72 
	mLi¡
<
	mLayoutSegm’t
> 
	m£gm’ts
;

76 @
G‘‹r


77 
	mLi¡
<
	mSŒšg
> 
	muÄe¥ÚsiveS”v”s
;

81 @
	mG‘‹r


82 @
S‘‹r


83 
	m•och
;

89 
public
 
fš®
 
	mINVALID_EPOCH
 = -1L;

95 @
G‘‹r


96 
UUID
 
	mşu¡”Id
;

102 
public
 
Layout
(@
NÚNuÎ
 
Li¡
<
SŒšg
> 
ÏyoutS”v”s
, @NÚNuÎ Li¡<SŒšg> 
£qu’ûrs
,

103 @
NÚNuÎ
 
Li¡
<
LayoutSegm’t
> 
£gm’ts
, @NÚNuÎ Li¡<
SŒšg
> 
uÄe¥ÚsiveS”v”s
,

104 
•och
, @
NuÎabË
 
UUID
 
şu¡”Id
) {

106 
	mthis
.
	mÏyoutS”v”s
 = 
ÏyoutS”v”s
;

107 
	mthis
.
	m£qu’ûrs
 = 
£qu’ûrs
;

108 
	mthis
.
	m£gm’ts
 = 
£gm’ts
;

109 
	mthis
.
	muÄe¥ÚsiveS”v”s
 = 
uÄe¥ÚsiveS”v”s
;

110 
	mthis
.
	m•och
 = 
•och
;

111 
	mthis
.
	mşu¡”Id
 = 
şu¡”Id
;

114 ià(
	mthis
.
	mÏyoutS”v”s
.
size
() == 0) {

115 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Empty†ist of LayoutServers");

117 ià(
	mthis
.
	m£qu’ûrs
.
size
() == 0) {

118 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Empty†ist of Sequencers");

120 ià(
	mthis
.
	m£gm’ts
.
size
() == 0) {

121 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Empty†ist of segments");

123 
	mLayout
.
LayoutSegm’t
 
	m£gm’t
 : 
£gm’ts
) {

124 
»quœeNÚNuÎ
(
£gm’t
.
¡res
);

125 ià(
	m£gm’t
.
	m¡res
.
size
() == 0) {

126 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("One segment has‡nƒmpty†ist of stripes");

131 
public
 
Layout
(
Li¡
<
SŒšg
> 
ÏyoutS”v”s
, Li¡<SŒšg> 
£qu’ûrs
, Li¡<
LayoutSegm’t
> 
£gm’ts
,

132 
•och
, 
UUID
 
şu¡”Id
) {

133 
this
(
ÏyoutS”v”s
, 
£qu’ûrs
, 
£gm’ts
, 
Ãw
 
A¼ayLi¡
<
SŒšg
>(), 
•och
, 
şu¡”Id
);

139 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviation"})

140 
public
 
Layout
 
	$äomJSONSŒšg
(
SŒšg
 
jsÚ
) {

142  
	`»quœeNÚNuÎ
(
·r£r
.
	`äomJsÚ
(
jsÚ
, 
Layout
.
şass
));

143 
	}
}

150 
public
 
	gS‘
<
	gLayoutSegm’t
> 
g‘Segm’tsFÜEndpošt
(@
NÚnuÎ
 
SŒšg
 
’dpošt
) {

151 
	gS‘
<
	gLayoutSegm’t
> 
	g»s
 = 
Ãw
 
HashS‘
<>();

153 
LayoutSegm’t
 
	g£gm’t
 : 
g‘Segm’ts
()) {

154 
LayoutSŒe
 
¡re
 : 
£gm’t
.
g‘SŒes
()) {

155 ià(
¡re
.
g‘LogS”v”s
().
cÚšs
(
’dpošt
)) {

156 
»s
.
add
(
£gm’t
);

161  
	g»s
;

169 
public
 
	gS‘
<
	gSŒšg
> 
	$g‘AÎAùiveS”v”s
() {

170 
S‘
<
SŒšg
> 
aùiveS”v”s
 = 
Ãw
 
HashS‘
<>();

171 
aùiveS”v”s
.
	`addAÎ
(
ÏyoutS”v”s
);

172 
aùiveS”v”s
.
	`addAÎ
(
£qu’ûrs
);

173 
£gm’ts
.
	`fÜEach
(
x
 ->

174 
x
.
	`g‘SŒes
().
	`fÜEach
(
y
 ->

175 
aùiveS”v”s
.
	`addAÎ
(
y
.
	`g‘LogS”v”s
())));

176 
aùiveS”v”s
.
	`»moveAÎ
(
uÄe¥ÚsiveS”v”s
);

177  
aùiveS”v”s
;

178 
	}
}

185 
public
 
	gS‘
<
	gSŒšg
> 
	$g‘AÎS”v”s
() {

186 
S‘
<
SŒšg
> 
®lS”v”s
 = 
Ãw
 
HashS‘
<>();

187 
®lS”v”s
.
	`addAÎ
(
	`g‘AÎAùiveS”v”s
());

188 
®lS”v”s
.
	`addAÎ
(
uÄe¥ÚsiveS”v”s
);

189  
®lS”v”s
;

190 
	}
}

197 
public
 
SŒšg
 
	$g‘Prim¬ySequ’ûr
() {

198  
£qu’ûrs
.
	`g‘
(0);

199 
	}
}

212 
	gpublic
 @
NÚnuÎ
 
	gLi¡
<
	gLayoutSegm’t
> 
	$g‘P»fixSegm’ts
(
glob®Add»ss
) {

213  
£gm’ts
.
	`¡»am
()

214 .
	`f‹r
(
p
 ->….
	`g‘End
(è<ğ
glob®Add»ss
)

215 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

216 
	}
}

223 
public
 
LayoutSŒe
 
	$g‘SŒe
(
glob®Add»ss
) {

224 
LayoutSegm’t
 
ls
 = 
	`g‘Segm’t
(
glob®Add»ss
);

225  
ls
.
	`g‘SŒes
().
	`g‘
((è(
glob®Add»ss
 %†s.
	`g‘Numb”OfSŒes
()));

226 
	}
}

233 
public
 
LayoutSegm’t
 
	$g‘Segm’t
(
glob®Add»ss
) {

234 
LayoutSegm’t
 
ls
 : 
£gm’ts
) {

235 ià(
ls
.
¡¬t
 <ğ
glob®Add»ss
 && (ls.
’d
 > globalAddress ||†s.end == -1)) {

236  
ls
;

239 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Unm­³d‡dd»s " + 
LÚg
.
	`toSŒšg
(
glob®Add»ss
) + "!");

240 
	}
}

246 
public
 
LayoutSegm’t
 
	$g‘Fœ¡Segm’t
() {

247  
this
.
	`g‘Segm’ts
().
	`g‘
(0);

248 
	}
}

254 
public
 
LayoutSegm’t
 
	$g‘L©e¡Segm’t
() {

255  
this
.
	`g‘Segm’ts
().
	`g‘
Ñhis.g‘Segm’ts().
	`size
() - 1);

256 
	}
}

263 
public
 
SŒšg
 
	$g‘La¡AddedNodeInLa¡Segm’t
() {

267 
Li¡
<
SŒšg
> 
fœ¡SŒeLogS”v”s
 = 
	`g‘L©e¡Segm’t
().
	`g‘Fœ¡SŒe
().
	`g‘LogS”v”s
();

268  
fœ¡SŒeLogS”v”s
.
	`g‘
(fœ¡SŒeLogS”v”s.
	`size
() - 1);

269 
	}
}

277 
public
 
	$g‘Segm’tL’gth
(
add»ss
) {

278  
	`g‘SŒe
(
add»ss
).
	`g‘LogS”v”s
().
	`size
();

279 
	}
}

287 
public
 
R•liÿtiÚMode
 
	$g‘R•liÿtiÚMode
(
add»ss
) {

288 
LayoutSegm’t
 
ls
 : 
£gm’ts
) {

289 ià(
ls
.
¡¬t
 <ğ
add»ss
 && (ls.
’d
 >‡ddress ||†s.end == -1)) {

290  
ls
.
	`g‘R•liÿtiÚMode
();

293  
nuÎ
;

294 
	}
}

299 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviation"})

300 
public
 
SŒšg
 
	$asJSONSŒšg
() {

301  
·r£r
.
	`toJsÚ
(
this
);

302 
	}
}

310 
public
 
Layout
(@
NÚnuÎ
 Layouˆ
Ïyout
) {

311 
Layout
 
	gÏyoutCİy
 = 
·r£r
.
äomJsÚ
(
Ïyout
.
asJSONSŒšg
(), Layout.
şass
);

312 
	gthis
.
	gÏyoutS”v”s
 = 
ÏyoutCİy
.
g‘LayoutS”v”s
();

313 
	gthis
.
	g£qu’ûrs
 = 
ÏyoutCİy
.
g‘Sequ’ûrs
();

314 
	gthis
.
	g£gm’ts
 = 
ÏyoutCİy
.
g‘Segm’ts
();

315 
	gthis
.
	guÄe¥ÚsiveS”v”s
 = 
ÏyoutCİy
.
g‘UÄe¥ÚsiveS”v”s
();

316 
	gthis
.
	g•och
 = 
ÏyoutCİy
.
g‘Epoch
();

317 
	gthis
.
	gşu¡”Id
 = 
ÏyoutCİy
.
şu¡”Id
;

320 
public
 
	$ÃxtEpoch
() {

321 
•och
 += 1;

322 
	}
}

324 
public
 
	gImmubËLi¡
<
	gSŒšg
> 
	$g‘AùiveLayoutS”v”s
() {

325  
ÏyoutS”v”s
.
	`¡»am
()

327 .
	`f‹r
(
s
 -> !
uÄe¥ÚsiveS”v”s
.
	`cÚšs
(s))

328 .
	`cŞËù
(
ImmubËLi¡
.
	`toImmubËLi¡
());

329 
	}
}

331 
public
 
	eR•liÿtiÚMode
 {

332 
	gCHAIN_REPLICATION
 {

333 @
Ov”ride


334 
public
 
v®id©eSegm’tS—l
(
LayoutSegm’t
 
ÏyoutSegm’t
,

335 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>>

336 
com¶‘abËFutu»M­
)

337 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
 {

338 
	gS—lS”v”sH–³r
.
wa™FÜChašSegm’tS—l
(
ÏyoutSegm’t
, 
com¶‘abËFutu»M­
);

341 @
Ov”ride


342 
public
 
g‘MšR•liÿtiÚFaùÜ
(
Layout
 
Ïyout
, 
LayoutSŒe
 
¡re
) {

346 @
Ov”ride


347 
public
 
ISŒ—mV›w
 
g‘SŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

348  
Ãw
 
Th»adSaãSŒ—mV›w
(
r
, 
¡»amId
, 
İtiÚs
);

351 @
Ov”ride


352 
public
 
ISŒ—mV›w
 
g‘Un§ãSŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

353 ià(
	gr
.
g‘P¬am‘”s
().
isFŞlowBackpoš‹rsEÇbËd
()) {

354  
Ãw
 
Backpoš‹rSŒ—mV›w
(
r
, 
¡»amId
, 
İtiÚs
);

356  
Ãw
 
Add»ssM­SŒ—mV›w
(
r
, 
¡»amId
, 
İtiÚs
);

360 @
Ov”ride


361 
public
 
IR•liÿtiÚPrÙocŞ
 
g‘R•liÿtiÚPrÙocŞ
(
CÜfuRuÁime
 
r
) {

362 ià(
	gr
.
g‘P¬am‘”s
().
isHŞeFlšgDi§bËd
()) {

363  
Ãw
 
ChašR•liÿtiÚPrÙocŞ
Òew 
Nev”HŞeFlPŞicy
(100));

365  
Ãw
 
ChašR•liÿtiÚPrÙocŞ
(

366 
Ãw
 
R—dWa™HŞeFlPŞicy
(
r
.
g‘P¬am‘”s
().
g‘HŞeFlTimeout
(),

367 
r
.
g‘P¬am‘”s
().
g‘HŞeFlR‘ryTh»shŞd
()));

371 @
Ov”ride


372 
public
 
Clu¡”Stus
 
g‘Clu¡”H—ÉhFÜSegm’t
(
LayoutSegm’t
 
ÏyoutSegm’t
,

373 
S‘
<
SŒšg
> 
»¥ÚsiveNodes
) {

374  !
	g»¥ÚsiveNodes
.
cÚšsAÎ
(
ÏyoutSegm’t
.
g‘AÎLogS”v”s
())

375 ? 
	gClu¡”Stus
.
	gUNAVAILABLE
 : 
Clu¡”Stus
.
STABLE
;

378 
	gQUORUM_REPLICATION
 {

379 @
Ov”ride


380 
public
 
v®id©eSegm’tS—l
(
LayoutSegm’t
 
ÏyoutSegm’t
,

381 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>>

382 
com¶‘abËFutu»M­
)

383 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
 {

385 
	gS—lS”v”sH–³r
.
wa™FÜQuÜumSegm’tS—l
(
ÏyoutSegm’t
, 
com¶‘abËFutu»M­
);

388 @
Ov”ride


389 
public
 
g‘MšR•liÿtiÚFaùÜ
(
Layout
 
Ïyout
, 
LayoutSŒe
 
¡re
) {

390  (
	g¡re
.
g‘LogS”v”s
().
size
() / 2) + 1;

393 @
Ov”ride


394 
public
 
ISŒ—mV›w
 
g‘SŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

395  
Ãw
 
Th»adSaãSŒ—mV›w
(
r
, 
¡»amId
, 
İtiÚs
);

398 @
Ov”ride


399 
public
 
ISŒ—mV›w
 
g‘Un§ãSŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

400 ià(
	gr
.
g‘P¬am‘”s
().
isFŞlowBackpoš‹rsEÇbËd
()) {

401  
Ãw
 
Backpoš‹rSŒ—mV›w
(
r
, 
¡»amId
, 
İtiÚs
);

403  
Ãw
 
Add»ssM­SŒ—mV›w
(
r
, 
¡»amId
, 
İtiÚs
);

407 @
Ov”ride


408 
public
 
IR•liÿtiÚPrÙocŞ
 
g‘R•liÿtiÚPrÙocŞ
(
CÜfuRuÁime
 
r
) {

409 ià(
	gr
.
g‘P¬am‘”s
().
isHŞeFlšgDi§bËd
()) {

410  
Ãw
 
QuÜumR•liÿtiÚPrÙocŞ
Òew 
Nev”HŞeFlPŞicy
(100));

412  
Ãw
 
QuÜumR•liÿtiÚPrÙocŞ
(

413 
Ãw
 
R—dWa™HŞeFlPŞicy
(
r
.
g‘P¬am‘”s
().
g‘HŞeFlTimeout
(),

414 
r
.
g‘P¬am‘”s
().
g‘HŞeFlR‘ryTh»shŞd
()));

418 @
Ov”ride


419 
public
 
Clu¡”Stus
 
g‘Clu¡”H—ÉhFÜSegm’t
(
LayoutSegm’t
 
ÏyoutSegm’t
,

420 
S‘
<
SŒšg
> 
»¥ÚsiveNodes
) {

421 
Clu¡”Stus
 
	gşu¡”Stus
 = Clu¡”Stus.
STABLE
;

424 
LayoutSŒe
 
	gÏyoutSŒe
 : 
ÏyoutSegm’t
.
g‘SŒes
()) {

425 
Li¡
<
SŒšg
> 
»¥ÚsiveLogS”v”s


426 ğ
Ãw
 
A¼ayLi¡
<>(
ÏyoutSŒe
.
g‘LogS”v”s
());

428 
	g»¥ÚsiveLogS”v”s
.
»šAÎ
(
»¥ÚsiveNodes
);

430 ià(!
	g»¥ÚsiveLogS”v”s
.
cÚšsAÎ
(
ÏyoutSŒe
.
g‘LogS”v”s
())) {

431 ià(
	gşu¡”Stus
.
equ®s
(
Clu¡”Stus
.
STABLE
)) {

432 
	gşu¡”Stus
 = 
Clu¡”Stus
.
DEGRADED
;

434 
	gquÜumSize
 = (
ÏyoutSŒe
.
g‘LogS”v”s
().
size
() / 2) + 1;

435 ià(
	g»¥ÚsiveLogS”v”s
.
size
(è< 
	gquÜumSize
) {

436 
	gşu¡”Stus
 = 
Clu¡”Stus
.
UNAVAILABLE
;

441  
	gşu¡”Stus
;

444 }, 
	gNO_REPLICATION
 {

445 @
Ov”ride


446 
public
 
v®id©eSegm’tS—l
(
LayoutSegm’t
 
ÏyoutSegm’t
,

447 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>>

448 
com¶‘abËFutu»M­
)

449 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
 {

450 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("unsupported seal");

453 @
Ov”ride


454 
public
 
g‘MšR•liÿtiÚFaùÜ
(
Layout
 
Ïyout
, 
LayoutSŒe
 
¡re
) {

458 @
Ov”ride


459 
public
 
ISŒ—mV›w
 
g‘SŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

460 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Stream view used without‡"

464 @
Ov”ride


465 
public
 
ISŒ—mV›w
 
g‘Un§ãSŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

466 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Stream view used without‡"

470 @
Ov”ride


471 
public
 
Clu¡”Stus
 
g‘Clu¡”H—ÉhFÜSegm’t
(
LayoutSegm’t
 
ÏyoutSegm’t
,

472 
S‘
<
SŒšg
> 
»¥ÚsiveNodes
) {

473 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Unsupported cluster health check.");

480 
public
 
ab¡¿ù
 
v®id©eSegm’tS—l
(
LayoutSegm’t
 
ÏyoutSegm’t
,

481 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>>

482 
com¶‘abËFutu»M­
)

483 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
;

493 
public
 
ab¡¿ù
 
g‘MšR•liÿtiÚFaùÜ
(
Layout
 
Ïyout
, 
LayoutSŒe
 
¡re
);

495 
public
 
ab¡¿ù
 
ISŒ—mV›w
 
g‘SŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
);

497 
public
 
ab¡¿ù
 
ISŒ—mV›w
 
g‘Un§ãSŒ—mV›w
(
CÜfuRuÁime
 
r
, 
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
);

499 
public
 
IR•liÿtiÚPrÙocŞ
 
g‘R•liÿtiÚPrÙocŞ
(
CÜfuRuÁime
 
r
) {

500 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
();

510 
public
 
ab¡¿ù
 
Clu¡”Stus
 
g‘Clu¡”H—ÉhFÜSegm’t
(
LayoutSegm’t
 
ÏyoutSegm’t
, 
S‘
<
SŒšg
> 
»¥ÚsiveNodes
);

514 @
	gD©a


515 @
	gG‘‹r


516 @
	gS‘‹r


517 @
Equ®sAndHashCode


518 
public
 şas 
	cLayoutSegm’t
 {

522 
R•liÿtiÚMode
 
	g»¶iÿtiÚMode
;

527 
	g¡¬t
;

532 
	g’d
;

537 
	gLi¡
<
	gLayoutSŒe
> 
	g¡res
;

550 
public
 
LayoutSegm’t
(@
NÚNuÎ
 
R•liÿtiÚMode
 
»¶iÿtiÚMode
, 
¡¬t
, 
’d
,

551 @
NÚNuÎ
 
Li¡
<
LayoutSŒe
> 
¡res
) {

552 
	gthis
.
	g»¶iÿtiÚMode
 = 
»¶iÿtiÚMode
;

553 
	gthis
.
	g¡¬t
 = 
¡¬t
;

554 
	gthis
.
	g’d
 = 
’d
;

555 
	gthis
.
	g¡res
 = 
¡res
;

559 
public
 
g‘Numb”OfSŒes
() {

560  
	g¡res
.
size
();

568 
public
 
LayoutSŒe
 
g‘Fœ¡SŒe
() {

569  
	g¡res
.
g‘
(0);

577 
public
 
	gS‘
<
	gSŒšg
> 
g‘AÎLogS”v”s
() {

578  
	gthis
.
g‘SŒes
().
¡»am
()

579 .
æ©M­
(
ÏyoutSŒe
 ->†ayoutSŒe.
g‘LogS”v”s
().
¡»am
())

580 .
cŞËù
(
CŞËùÜs
.
toS‘
());

584 @
	gG‘‹r


585 @
	gEqu®sAndHashCode


586 @
ToSŒšg


587 
public
 şas 
	cLayoutSŒe
 {

588 
fš®
 
	gLi¡
<
	gSŒšg
> 
	glogS”v”s
;

590 
public
 
LayoutSŒe
(@
NÚNuÎ
 
Li¡
<
SŒšg
> 
logS”v”s
) {

591 
	gthis
.
	glogS”v”s
 = 
logS”v”s
;

	@runtime/src/main/java/org/corfudb/runtime/view/LayoutBuilder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

5 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLayoutModifiÿtiÚExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSŒe
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

22 @
Slf4j


23 
public
 cÏs 
	cLayoutBud”
 {

28 
´iv©e
 
Layout
 
	mÏyout
;

32 
´iv©e
 
	m•och
;

39 
public
 
LayoutBud”
(@
NÚNuÎ
 
Layout
 
Ïyout
) {

40 
	mthis
.
	mÏyout
 = 
Ãw
 
Layout
(
Ïyout
);

41 
	mthis
.
	m•och
 = 
Ïyout
.
g‘Epoch
();

49 
public
 
LayoutBud”
 
	$£tEpoch
(
•och
) {

50 
this
.
•och
 =ƒpoch;

51  
this
;

52 
	}
}

59 
public
 
LayoutBud”
 
£tSegm’ts
(@
NÚNuÎ
 
Li¡
<
LayoutSegm’t
> 
£gm’ts
){

60 
	gÏyout
.
£tSegm’ts
(
£gm’ts
);

61  
	gthis
;

72 
public
 
LayoutBud”
 
addUÄe¥ÚsiveS”v”s
(@
NÚNuÎ
 
S‘
<
SŒšg
> 
’dpošts
) {

73 
	gLi¡
<
	gSŒšg
> 
	guÄe¥ÚsiveS”v”s
 = 
Ïyout
.
g‘UÄe¥ÚsiveS”v”s
();

74 
	guÄe¥ÚsiveS”v”s
.
addAÎ
(
’dpošts
);

75  
	gthis
;

86 
public
 
LayoutBud”
 
»moveUÄe¥ÚsiveS”v”s
(@
NÚNuÎ
 
S‘
<
SŒšg
> 
’dpošts
) {

87 
	gÏyout
.
g‘UÄe¥ÚsiveS”v”s
().
»moveAÎ
(
’dpošts
);

88  
	gthis
;

98 
public
 
LayoutBud”
 
»moveUÄe¥ÚsiveS”v”
(@
NÚNuÎ
 
SŒšg
 
’dpošt
) {

99 
	gÏyout
.
g‘UÄe¥ÚsiveS”v”s
().
»move
(
’dpošt
);

100  
	gthis
;

114 
public
 
LayoutBud”
 
»moveLayoutS”v”
(@
NÚNuÎ
 
SŒšg
 
’dpošt
) {

117 ià(
	gÏyout
.
g‘LayoutS”v”s
().
size
() == 1 &&

118 
Ïyout
.
g‘LayoutS”v”s
().
g‘
(0).
equ®s
(
’dpošt
)) {

119 
log
.
w¬n
("Skipped„emoving†ayout server‡s {} ishe†ast„emaining†ayout servers.",

120 
’dpošt
);

121 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
(

124 
	gÏyout
.
g‘LayoutS”v”s
().
»move
(
’dpošt
);

127  
	gthis
;

147 
public
 
LayoutBud”
 
»moveLayoutS”v”s
(@
NÚNuÎ
 
S‘
<
SŒšg
> 
’dpošts
) {

150 if(
	g’dpošts
.
cÚšsAÎ
(
Ïyout
.
g‘LayoutS”v”s
())) {

151 
	glog
.
w¬n
("Skipped„emoving†ayout servers‡s„emove„equest of {} would„emove‡ll " +

153 
’dpošts
.
toSŒšg
(),

154 
Ïyout
.
g‘LayoutS”v”s
());

155 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
("Attemptingo„emove‡ll†ayout servers.");

157 
	gÏyout
.
g‘LayoutS”v”s
().
»moveAÎ
(
’dpošts
);

160  
	gthis
;

171 
public
 
LayoutBud”
 
addLayoutS”v”
(@
NÚNuÎ
 
SŒšg
 
’dpošt
) {

172 
	gÏyout
.
g‘LayoutS”v”s
().
add
(
’dpošt
);

173  
	gthis
;

184 
public
 
LayoutBud”
 
addSequ’ûrS”v”
(@
NÚNuÎ
 
SŒšg
 
’dpošt
) {

185 
	gÏyout
.
g‘Sequ’ûrs
().
add
(
’dpošt
);

186  
	gthis
;

206 
public
 
LayoutBud”
 
addLogun™S”v”
(
¡reIndex
, 
glob®LogTa
,

207 @
NÚNuÎ
 
SŒšg
 
ÃwLogun™Endpošt
) {

208 
	gLi¡
<
	gLayoutSegm’t
> 
	gÏyoutSegm’tLi¡
 = 
Ïyout
.
g‘Segm’ts
();

209 
LayoutSegm’t
 
	gÏ¡Segm’t
 = 
ÏyoutSegm’tLi¡
.
»move
ÖayoutSegm’tLi¡.
size
() - 1);

212 ià(
	gÏ¡Segm’t
.
g‘S¹
(è=ğ
glob®LogTa
 + 1) {

213 
ImmubËLi¡
<
SŒšg
> 
logS”v”s
 = 
Ãw
 ImmubËLi¡.
Bud”
<String>()

214 .
addAÎ
(
Ï¡Segm’t
.
g‘SŒes
().
g‘
(
¡reIndex
).
g‘LogS”v”s
())

215 .
add
(
ÃwLogun™Endpošt
)

216 .
bud
();

217 
LayoutSŒe
 
	gÃwSŒe
 = 
Ãw
 LayoutSŒe(
logS”v”s
);

218 
	gLi¡
<
	gLayoutSŒe
> 
	gÃwSŒeLi¡
 = 
Ãw
 
A¼ayLi¡
<>(
Ï¡Segm’t
.
g‘SŒes
());

219 
	gÃwSŒeLi¡
.
»move
(
¡reIndex
);

220 
	gÃwSŒeLi¡
.
add
(
¡reIndex
, 
ÃwSŒe
);

221 
LayoutSegm’t
 
	gİ’Segm’t
 = 
Ãw
 LayoutSegm’t(
Ï¡Segm’t
.
g‘R•liÿtiÚMode
(),

222 
Ï¡Segm’t
.
g‘S¹
(),

223 
Ï¡Segm’t
.
g‘End
(),

224 
ÃwSŒeLi¡
);

225 
	gÏyoutSegm’tLi¡
.
add
(
ÏyoutSegm’tLi¡
.
size
(), 
İ’Segm’t
);

226  
	gthis
;

230 
LayoutSegm’t
 
	gşo£dSegm’t
 = 
Ãw
 LayoutSegm’t(
Ï¡Segm’t
.
g‘R•liÿtiÚMode
(),

231 
Ï¡Segm’t
.
g‘S¹
(),

232 
glob®LogTa
 + 1,

233 
Ï¡Segm’t
.
g‘SŒes
());

235 
	gLi¡
<
	gSŒšg
> 
	glogun™S”v”Li¡
 = 
Ãw
 
A¼ayLi¡
<>(

236 
Ï¡Segm’t
.
g‘SŒes
()

237 .
g‘
(
¡reIndex
)

238 .
g‘LogS”v”s
());

239 
	glogun™S”v”Li¡
.
add
(
ÃwLogun™Endpošt
);

242 
LayoutSŒe
 
	gÃwSŒe
 = 
Ãw
 LayoutSŒe(
logun™S”v”Li¡
);

243 
	gLi¡
<
	gLayoutSŒe
> 
	gÃwSŒeLi¡
 = 
Ãw
 
A¼ayLi¡
<>(
Ï¡Segm’t
.
g‘SŒes
());

244 
	gÃwSŒeLi¡
.
»move
(
¡reIndex
);

245 
	gÃwSŒeLi¡
.
add
(
¡reIndex
, 
ÃwSŒe
);

247 
LayoutSegm’t
 
	gİ’Segm’t
 = 
Ãw
 LayoutSegm’t(
Ï¡Segm’t
.
g‘R•liÿtiÚMode
(),

248 
glob®LogTa
 + 1,

249 
Ï¡Segm’t
.
g‘End
(),

250 
ÃwSŒeLi¡
);

251 
	gÏyoutSegm’tLi¡
.
add
(
ÏyoutSegm’tLi¡
.
size
(), 
şo£dSegm’t
);

252 
	gÏyoutSegm’tLi¡
.
add
(
ÏyoutSegm’tLi¡
.
size
(), 
İ’Segm’t
);

253  
	gthis
;

265 
public
 
LayoutBud”
 
addLogun™S”v”ToSegm’t
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

266 
£gm’tIndex
,

267 
¡reIndex
) {

268 
LayoutSŒe
 
	g¡re
 = 
Ïyout
.
g‘Segm’ts
().
g‘
(
£gm’tIndex
).
g‘SŒes
().g‘(
¡reIndex
);

269 ià(!
	g¡re
.
g‘LogS”v”s
().
cÚšs
(
’dpošt
)) {

270 
	g¡re
.
g‘LogS”v”s
().
add
(
’dpošt
);

272  
	gthis
;

284 
public
 
LayoutBud”
 
	$m”geP»viousSegm’t
(
£gm’tIndex
) {

285 ià(
£gm’tIndex
 < 1) {

286 
log
.
	`w¬n
("mergePreviousSegment: No segmentso merge.");

287  
this
;

290 
Li¡
<
LayoutSegm’t
> 
ÏyoutSegm’tLi¡
 = 
Ïyout
.
	`g‘Segm’ts
();

291 ià(
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
).
¡¬t


292 !ğ
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
 - 1).
’d
) {

293 
throw
 
Ãw
 
	`LayoutModifiÿtiÚExû±iÚ
("Cannot merge disjoint segments.");

296 
Li¡
<
LayoutSŒe
> 
ŞdSegm’tSŒeLi¡
 = 
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
 - 1).
	`g‘SŒes
();

297 
Li¡
<
LayoutSŒe
> 
ÃwSegm’tSŒeLi¡
 = 
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
).
	`g‘SŒes
();

299 
®lowedUpd©es
 = 1;

300 ià(
ŞdSegm’tSŒeLi¡
.
	`size
(è!ğ
ÃwSegm’tSŒeLi¡
.size()) {

301 
throw
 
Ãw
 
	`LayoutModifiÿtiÚExû±iÚ
("Stripe‡ddition/deletion‚ot‡llowed.");

303 
i
 = 0; i < 
ŞdSegm’tSŒeLi¡
.
	`size
(); i++) {

304 
S‘
<
SŒšg
> 
ŞdSegm’tSŒe
 =

305 
Ãw
 
HashS‘
<>(
ŞdSegm’tSŒeLi¡
.
	`g‘
(
i
).
	`g‘LogS”v”s
());

306 
S‘
<
SŒšg
> 
ÃwSegm’tSŒe
 =

307 
Ãw
 
HashS‘
<>(
ÃwSegm’tSŒeLi¡
.
	`g‘
(
i
).
	`g‘LogS”v”s
());

308 
S‘
<
SŒšg
> 
difã»nûs
 = 
S‘s
.
	`difã»nû
(

309 
S‘s
.(
ŞdSegm’tSŒe
, 
ÃwSegm’tSŒe
),

310 
S‘s
.
	`š‹r£ùiÚ
(
ŞdSegm’tSŒe
, 
ÃwSegm’tSŒe
));

311 
®lowedUpd©es
 =‡ÎowedUpd©e - 
difã»nûs
.
	`size
();

312 ià(
®lowedUpd©es
 < 0) {

313 
throw
 
Ãw
 
	`LayoutModifiÿtiÚExû±iÚ
(

314 "Aˆmo¡ " + 
®lowedUpd©es
 + "†og unit server update‡llowed.");

318 
LayoutSegm’t
 
m”gedSegm’t
 = 
Ãw
 
	`LayoutSegm’t
(
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
)

319 .
	`g‘R•liÿtiÚMode
(),

320 
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
 - 1).
	`g‘S¹
(),

321 
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
).
	`g‘End
(),

322 
ÏyoutSegm’tLi¡
.
	`g‘
(
£gm’tIndex
).
	`g‘SŒes
());

323 
ÏyoutSegm’tLi¡
.
	`»move
(
£gm’tIndex
);

324 
ÏyoutSegm’tLi¡
.
	`»move
(
£gm’tIndex
 - 1);

325 
ÏyoutSegm’tLi¡
.
	`add
(
£gm’tIndex
 - 1, 
m”gedSegm’t
);

326  
this
;

327 
	}
}

341 
public
 
LayoutBud”
 
assignRe¥ÚsiveSequ’ûrAsPrim¬y
(@
NÚNuÎ
 
S‘
<
SŒšg
> 
’dpošts
) {

343 
	gLi¡
<
	gSŒšg
> 
	gmodif›dSequ’ûrS”v”s
 = 
Ãw
 
A¼ayLi¡
<>(
Ïyout
.
g‘Sequ’ûrs
());

344 
	gi
 = 0; i < 
	gmodif›dSequ’ûrS”v”s
.
size
(); i++) {

345 
SŒšg
 
	g£qu’ûrS”v”
 = 
modif›dSequ’ûrS”v”s
.
g‘
(
i
);

349 ià(!
	g’dpošts
.
cÚšs
(
£qu’ûrS”v”
) &&

350 !
	gÏyout
.
g‘UÄe¥ÚsiveS”v”s
().
cÚšs
(
£qu’ûrS”v”
)) {

351 
	gmodif›dSequ’ûrS”v”s
.
»move
(
£qu’ûrS”v”
);

352 
	gmodif›dSequ’ûrS”v”s
.
add
(0, 
£qu’ûrS”v”
);

353 
	gÏyout
.
£tSequ’ûrs
(
modif›dSequ’ûrS”v”s
);

354  
	gthis
;

358 
	glog
.
w¬n
("Failovero‡„esponsive sequencer server failed. Each ofhe†ayout " +

360 
modif›dSequ’ûrS”v”s
.
toSŒšg
());

361 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
("All sequencers failed.");

375 
public
 
LayoutBud”
 
»moveSequ’ûrS”v”
(@
NÚNuÎ
 
SŒšg
 
’dpošt
) {

378 ià(
	gÏyout
.
g‘Sequ’ûrs
().
size
() == 1 &&

379 
Ïyout
.
g‘Sequ’ûrs
().
g‘
(0).
equ®s
(
’dpošt
)) {

380 
log
.
w¬n
("Skipped„emoving sequencer‡s {} ishe†ast„emaining sequencer.",

381 
’dpošt
);

382 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
(

385 
	gÏyout
.
g‘Sequ’ûrs
().
»move
(
’dpošt
);

388  
	gthis
;

408 
public
 
LayoutBud”
 
»moveSequ’ûrS”v”s
(@
NÚNuÎ
 
S‘
<
SŒšg
> 
’dpošts
) {

411 ià(
	g’dpošts
.
cÚšsAÎ
(
Ïyout
.
g‘Sequ’ûrs
())) {

412 
	glog
.
w¬n
("Skipped„emoving sequencers‡s„emove„equest of {} would„emove‡ll " +

414 
’dpošts
.
toSŒšg
(),

415 
Ïyout
.
g‘Sequ’ûrs
());

416 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
("Attemptingo„emove‡ll sequencers.");

418 
	gÏyout
.
g‘Sequ’ûrs
().
»moveAÎ
(
’dpošts
);

421  
	gthis
;

433 
public
 
»moveFromSŒe
(@
NÚNuÎ
 
SŒšg
 
’dpošt
,

434 @
NÚNuÎ
 
LayoutSŒe
 
ÏyoutSŒe
,

435 
mšR•liÿtiÚFaùÜ
) {

436 ià(
	gÏyoutSŒe
.
g‘LogS”v”s
().
»move
(
’dpošt
)) {

437 ià(
	gÏyoutSŒe
.
g‘LogS”v”s
().
isEm±y
()) {

438 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
(

443 ià(
	gÏyoutSŒe
.
g‘LogS”v”s
().
size
(è< 
	gmšR•liÿtiÚFaùÜ
) {

444 
throw
 
Ãw
 
LayoutModifiÿtiÚExû±iÚ
(

457 
public
 
LayoutBud”
 
»moveLogun™S”v”
(@
NÚNuÎ
 
SŒšg
 
’dpošt
) {

459 
Layout
 
	g‹mpLayout
 = 
Ãw
 Layout(
Ïyout
);

461 
	gLi¡
<
	gLayoutSegm’t
> 
	gÏyoutSegm’ts
 = 
‹mpLayout
.
g‘Segm’ts
();

462 
LayoutSegm’t
 
	gÏyoutSegm’t
 : 
ÏyoutSegm’ts
) {

463 
LayoutSŒe
 
ÏyoutSŒe
 : 
ÏyoutSegm’t
.
g‘SŒes
()) {

464 
mšR•liÿtiÚFaùÜ
 = 
ÏyoutSegm’t
.
g‘R•liÿtiÚMode
()

465 .
g‘MšR•liÿtiÚFaùÜ
(
‹mpLayout
, 
ÏyoutSŒe
);

466 
»moveFromSŒe
(
’dpošt
, 
ÏyoutSŒe
, 
mšR•liÿtiÚFaùÜ
);

469 
	gÏyout
 = 
‹mpLayout
;

470  
	gthis
;

481 
public
 
LayoutBud”
 
»moveLogun™S”v”s
(@
NÚNuÎ
 
S‘
<
SŒšg
> 
’dpošts
) {

483 
Layout
 
	g‹mpLayout
 = 
Ãw
 Layout(
Ïyout
);

485 
	gLi¡
<
	gLayoutSegm’t
> 
	gÏyoutSegm’ts
 = 
‹mpLayout
.
g‘Segm’ts
();

486 
LayoutSegm’t
 
	gÏyoutSegm’t
 : 
ÏyoutSegm’ts
) {

487 
LayoutSŒe
 
ÏyoutSŒe
 : 
ÏyoutSegm’t
.
g‘SŒes
()) {

488 
SŒšg
 
’dpošt
 : 
’dpošts
) {

489 
mšR•liÿtiÚFaùÜ
 = 
ÏyoutSegm’t
.
g‘R•liÿtiÚMode
()

490 .
g‘MšR•liÿtiÚFaùÜ
(
‹mpLayout
, 
ÏyoutSŒe
);

491 
»moveFromSŒe
(
’dpošt
, 
ÏyoutSŒe
, 
mšR•liÿtiÚFaùÜ
);

495 
	gÏyout
 = 
‹mpLayout
;

496  
	gthis
;

504 
public
 
Layout
 
	$bud
() {

505  
Ãw
 
	`Layout
(

506 
Ïyout
.
	`g‘LayoutS”v”s
(),

507 
Ïyout
.
	`g‘Sequ’ûrs
(),

508 
Ïyout
.
	`g‘Segm’ts
(),

509 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
(),

510 
this
.
•och
,

511 
Ïyout
.
	`g‘Clu¡”Id
());

512 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/LayoutDeserializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gJsÚDe£rŸliz©iÚCÚ‹xt
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gJsÚDe£rŸliz”
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gJsÚEËm’t
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gJsÚP¬£Exû±iÚ
;

9 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gTy³
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

18 
public
 cÏs 
	cLayoutDe£rŸliz”
 
im¶em’ts
 
	mJsÚDe£rŸliz”
 {

19 @
Ov”ride


20 
public
 
Layout
 
	$de£rŸlize
(
JsÚEËm’t
 
¬g0
, 
Ty³
 
¬g1
, 
JsÚDe£rŸliz©iÚCÚ‹xt
 
¬g2
)

21 
throws
 
JsÚP¬£Exû±iÚ
 {

22 
GsÚ
 
g
 = 
Ãw
 
	`GsÚ
();

23 
Layout
 
un§ãLayout
 = 
g
.
	`äomJsÚ
(
¬g0
, Layout.
şass
);

28 ià(
un§ãLayout
.
uÄe¥ÚsiveS”v”s
 =ğ
nuÎ
) {

29 
un§ãLayout
.
uÄe¥ÚsiveS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

34 
Layout
 
§ãLayout
 = 
Ãw
 
	`Layout
(
un§ãLayout
.
ÏyoutS”v”s
, un§ãLayout.
£qu’ûrs
,

35 
un§ãLayout
.
£gm’ts
, un§ãLayout.
uÄe¥ÚsiveS”v”s
, un§ãLayout.
•och
,

36 
un§ãLayout
.
şu¡”Id
);

38  
§ãLayout
;

41 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/LayoutManagementView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gS‘s
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLayoutModifiÿtiÚExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

14 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

18 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicReã»nû
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

23 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
.
	gg‘LogTa
;

32 @
Slf4j


33 
public
 cÏs 
	cLayoutMªagem’tV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

35 
public
 
LayoutMªagem’tV›w
(@
NÚNuÎ
 
CÜfuRuÁime
 
ruÁime
) {

36 
su³r
(
ruÁime
);

39 
´iv©e
 vŞ©
	g´•¬eRªk
 = 1L;

41 
´iv©e
 
fš®
 
R“Á¿ÁLock
 
	g»cov”Sequ’ûrLock
 = 
Ãw
 ReentrantLock();

47 
´iv©e
 
fš®
 
	gAtomicReã»nû
<
	gCom¶‘abËFutu»
<
	gBoŞ—n
>> 
	g£qu’ûrRecov”yFutu»


48 ğ
Ãw
 
AtomicReã»nû
<>(
Com¶‘abËFutu»
.
com¶‘edFutu»
(
Œue
));

50 
´iv©e
 vŞ©
	gÏ¡KnownSequ’ûrEpoch
 = 
Layout
.
INVALID_EPOCH
;

59 
public
 
boŞ—n
 
	$©‹m±Clu¡”Recov”y
(
Layout
 
»cov”yLayout
) {

61 
Œy
 {

62 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
»cov”yLayout
);

63 
	`£®Epoch
(
Ïyout
);

64 
	`©‹m±CÚ£nsus
(
Ïyout
);

65 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

66 
log
.
	`”rÜ
("E¼Ü:„ecov”y: {}", 
e
);

67  
çl£
;

69  
Œue
;

70 
	}
}

81 
public
 
hªdËFau»
(
IRecÚfigu¿tiÚHªdËrPŞicy
 
çu»HªdËrPŞicy
,

82 
Layout
 
cu¼’tLayout
,

83 
S‘
<
SŒšg
> 
çedS”v”s
)

84 
throws
 
	gOuŒªkedExû±iÚ
, 
	gLayoutModifiÿtiÚExû±iÚ
 {

87 
Layout
 
	gÃwLayout
 = 
çu»HªdËrPŞicy


88 .
g’”©eLayout
(
cu¼’tLayout
,

89 
ruÁime
,

90 
çedS”v”s
,

91 
CŞËùiÚs
.
em±yS‘
());

92 
runLayoutRecÚfigu¿tiÚ
(
cu¼’tLayout
, 
ÃwLayout
, 
çl£
);

104 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$boÙ¡¿pNewNode
(
SŒšg
 
’dpošt
) {

107 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

108  
ruÁime
.
	`g‘LayoutV›w
().
	`boÙ¡¿pLayoutS”v”
(
’dpošt
, 
Ïyout
)

109 .
	`th’Aµly
(
»suÉ
 -> {

110 
log
.
	`šfo
("boÙ¡¿pNewNode: New‚od{} boÙ¡¿µed.", 
’dpošt
);

111  
Œue
;

113 
	}
}

127 
public
 
addNode
(@
NÚnuÎ
 
Layout
 
cu¼’tLayout
,

128 @
NÚnuÎ
 
SŒšg
 
’dpošt
,

129 
boŞ—n
 
isLayoutS”v”
,

130 
boŞ—n
 
isSequ’ûrS”v”
,

131 
boŞ—n
 
isLogUn™S”v”
,

132 
boŞ—n
 
isUÄe¥ÚsiveS”v”
,

133 
logUn™SŒeIndex
)

134 
throws
 
	gOuŒªkedExû±iÚ
 {

135 
Layout
 
	gÃwLayout
;

136 ià(!
	gcu¼’tLayout
.
g‘AÎS”v”s
().
cÚšs
(
’dpošt
)) {

138 
£®Epoch
(
cu¼’tLayout
);

140 
LayoutBud”
 
	gÏyoutBud”
 = 
Ãw
 LayoutBud”(
cu¼’tLayout
);

141 ià(
	gisLayoutS”v”
) {

142 
	gÏyoutBud”
.
addLayoutS”v”
(
’dpošt
);

144 ià(
	gisSequ’ûrS”v”
) {

145 
	gÏyoutBud”
.
addSequ’ûrS”v”
(
’dpošt
);

147 ià(
	gisLogUn™S”v”
) {

148 
	gÏyoutBud”
.
addLogun™S”v”
(
logUn™SŒeIndex
,

149 
g‘LogTa
(
cu¼’tLayout
, 
ruÁime
),

150 
’dpošt
);

152 ià(
	gisUÄe¥ÚsiveS”v”
) {

153 
	gÏyoutBud”
.
addUÄe¥ÚsiveS”v”s
(
CŞËùiÚs
.
sšgËtÚ
(
’dpošt
));

155 
	gÃwLayout
 = 
ÏyoutBud”
.
bud
();

157 
©‹m±CÚ£nsus
(
ÃwLayout
);

159 ià(!
	gruÁime
.
g‘LayoutV›w
().
g‘Layout
().
equ®s
(
ÃwLayout
)){

160 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("This‚ode's†ayout was‚ot committed." +

164 
	glog
.
šfo
("Nod{}‡Ì—dyƒxi¡ šhÏyout, skpšg.", 
’dpošt
);

165 
	gÃwLayout
 = 
cu¼’tLayout
;

170 
»cÚfigu»Sequ’ûrS”v”s
(
cu¼’tLayout
, 
ÃwLayout
, 
çl£
);

180 
public
 
	$h—lNode
(
Layout
 
cu¼’tLayout
, 
SŒšg
 
’dpošt
è
throws
 
OuŒªkedExû±iÚ
 {

182 
Layout
 
ÃwLayout
;

187 ià(
cu¼’tLayout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
’dpošt
)) {

188 
	`£®Epoch
(
cu¼’tLayout
);

191 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
cu¼’tLayout
)

192 .
	`g‘Ba£Cl›Á
(
’dpošt
).
	`£®RemÙeS”v”
(
cu¼’tLayout
.
	`g‘Epoch
()));

195 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
cu¼’tLayout
)

196 .
	`g‘LogUn™Cl›Á
(
’dpošt
).
	`»£tLogUn™
(
cu¼’tLayout
.
	`g‘Epoch
()));

198 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
cu¼’tLayout
);

199 
ÏyoutBud”
.
	`addLogun™S”v”
(0,

200 
	`g‘LogTa
(
cu¼’tLayout
, 
ruÁime
),

201 
’dpošt
);

202 
ÏyoutBud”
.
	`»moveUÄe¥ÚsiveS”v”s
(
CŞËùiÚs
.
	`sšgËtÚ
(
’dpošt
));

203 
ÃwLayout
 = 
ÏyoutBud”
.
	`bud
();

205 
	`©‹m±CÚ£nsus
(
ÃwLayout
);

207 
log
.
	`šfo
("Nod{}‡Ì—dyƒxi¡ šhÏyout, skpšg.", 
’dpošt
);

208 
ÃwLayout
 = 
cu¼’tLayout
;

213 
	`»cÚfigu»Sequ’ûrS”v”s
(
cu¼’tLayout
, 
ÃwLayout
, 
çl£
);

214 
	}
}

223 
public
 
	$m”geSegm’ts
(
Layout
 
cu¼’tLayout
) {

224 
Layout
 
‹mpLayout
 = 
cu¼’tLayout
;

225 
Layout
 
ÃwLayout
;

226 
P»diÿ‹
<
Layout
> 
shouldM”geSegm’ts
 = 
Ïyout
 -> {

227 ià(
Ïyout
.
	`g‘Segm’ts
().
	`size
() > 1) {

228  
S‘s
.
	`difã»nû
(

229 
Ïyout
.
	`g‘Segm’ts
().
	`g‘
(1).
	`g‘AÎLogS”v”s
(),

230 
Ïyout
.
	`g‘Segm’ts
().
	`g‘
(0).
	`g‘AÎLogS”v”s
()).
	`isEm±y
();

232  
çl£
;

235 ià(
shouldM”geSegm’ts
.
	`‹¡
(
‹mpLayout
)) {

237 
log
.
	`šfo
("m”geSegm’ts:†ayouˆi {}", 
‹mpLayout
);

239 
	`£®Epoch
(
‹mpLayout
);

241 
shouldM”geSegm’ts
.
	`‹¡
(
‹mpLayout
)) {

242 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
‹mpLayout
);

243 
‹mpLayout
 = 
ÏyoutBud”


244 .
	`m”geP»viousSegm’t
(1)

245 .
	`bud
();

248 
ÃwLayout
 = 
‹mpLayout
;

250 
	`©‹m±CÚ£nsus
(
ÃwLayout
);

252 
log
.
	`šfo
("m”geSegm’ts: skpšg,‚Ø£gm’t tØm”g{}", 
‹mpLayout
);

253 
ÃwLayout
 = 
‹mpLayout
;

255 
	`»cÚfigu»Sequ’ûrS”v”s
(
‹mpLayout
, 
ÃwLayout
, 
çl£
);

256 
	}
}

264 
public
 
»moveNode
(@
NÚnuÎ
 
Layout
 
cu¼’tLayout
,

265 @
NÚnuÎ
 
SŒšg
 
’dpošt
è
throws
 
	gOuŒªkedExû±iÚ
 {

267 
Layout
 
	gÃwLayout
;

268 ià(
	gcu¼’tLayout
.
g‘AÎS”v”s
().
cÚšs
(
’dpošt
)) {

269 
LayoutBud”
 
	gbud”
 = 
Ãw
 LayoutBud”(
cu¼’tLayout
);

270 
	gÃwLayout
 = 
bud”
.
»moveLayoutS”v”
(
’dpošt
)

271 .
»moveSequ’ûrS”v”
(
’dpošt
)

272 .
assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
CŞËùiÚs
.
em±yS‘
())

273 .
»moveLogun™S”v”
(
’dpošt
)

274 .
»moveUÄe¥ÚsiveS”v”
(
’dpošt
)

275 .
£tEpoch
(
cu¼’tLayout
.
g‘Epoch
() + 1)

276 .
bud
();

280 
£®Epoch
(
cu¼’tLayout
);

282 
©‹m±CÚ£nsus
(
ÃwLayout
);

284 
	gÃwLayout
 = 
cu¼’tLayout
;

285 
	glog
.
šfo
("removeNode: Ignoring„emove‚ode on {} because it doesn'tƒxist in {}",

286 
’dpošt
, 
cu¼’tLayout
);

289 
»cÚfigu»Sequ’ûrS”v”s
(
cu¼’tLayout
, 
ÃwLayout
, 
çl£
);

299 
public
 
fÜûLayout
(@
NÚnuÎ
 
Layout
 
cu¼’tLayout
, @Nonnull Layout forceLayout) {

300 
	gŒy
 {

301 
£®Epoch
(
cu¼’tLayout
);

302 } 
ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
e
) {

303 
	glog
.
w¬n
("fÜûLayout:ƒ¼Ü wh£®šg ", 
e
);

306 
	gruÁime
.
g‘LayoutV›w
().
comm™‹d
(
fÜûLayout
.
g‘Epoch
(), fÜûLayout, 
Œue
);

324 
public
 
	$runLayoutRecÚfigu¿tiÚ
(
Layout
 
cu¼’tLayout
, Layouˆ
ÃwLayout
,

325 
fš®
 
boŞ—n
 
fÜûSequ’ûrRecov”y
)

326 
throws
 
OuŒªkedExû±iÚ
 {

329 
	`£®Epoch
(
cu¼’tLayout
);

331 
	`©‹m±CÚ£nsus
(
ÃwLayout
);

338 
	`»cÚfigu»Sequ’ûrS”v”s
(
cu¼’tLayout
, 
ÃwLayout
, 
fÜûSequ’ûrRecov”y
);

339 
	}
}

346 
´iv©e
 
	$£®Epoch
(
Layout
 
Ïyout
è
throws
 
QuÜumUÄ—chabËExû±iÚ
 {

347 
Ïyout
.
	`ÃxtEpoch
();

348 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

349 
	}
}

357 
´iv©e
 
	$©‹m±CÚ£nsus
(
Layout
 
Ïyout
)

358 
throws
 
OuŒªkedExû±iÚ
 {

360 
Œy
 {

361 
ruÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout
, 
´•¬eRªk
);

362 
´•¬eRªk
 = 1L;

363 } 
	`ÿtch
 (
OuŒªkedExû±iÚ
 
Û
) {

365 
log
.
	`”rÜ
("CÚæiù iÀupd©šg†ayouˆby‡‰em±CÚ£nsus: {}", 
Û
);

367 
´•¬eRªk
 = 
Û
.
	`g‘NewRªk
() + 1;

368 
throw
 
Û
;

372 
x
 = 0; x < 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘Inv®id©eR‘ry
(); x++) {

373 
ruÁime
.
	`šv®id©eLayout
();

374 ià(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`equ®s
(
Ïyout
)) {

375 
log
.
	`šfo
("New LayouˆComm™‹d = {}", 
Ïyout
);

378 
log
.
	`w¬n
("Runtime„ecovered with‡ different†ayout = {}",

379 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

381 
log
.
	`w¬n
("©‹m±CÚ£nsus: Checkšg ià{} ha b“Àacû±ed,„‘ry {}", 
Ïyout
, 
x
);

383 
	}
}

395 
public
 
	$»cÚfigu»Sequ’ûrS”v”s
(
Layout
 
Üigš®Layout
, Layouˆ
ÃwLayout
,

396 
boŞ—n
 
fÜûRecÚfigu»
) {

398 
boŞ—n
 
acquœedLocked
 = 
»cov”Sequ’ûrLock
.
	`ŒyLock
();

399 ià(
acquœedLocked
) {

400 
Œy
 {

403 ià(
ÃwLayout
.
	`g‘Epoch
(è<ğ
Ï¡KnownSequ’ûrEpoch
) {

404 
log
.
	`w¬n
("reconfigureSequencerServers: Sequencer bootstrap failed. "

409 
maxTok’Reque¡ed
 = -1L;

410 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amsAdd»ssS·û
 = 
CŞËùiÚs
.
	`em±yM­
();

411 
boŞ—n
 
boÙ¡¿pW™houtTasUpd©e
 = 
Œue
;

414 ià(
fÜûRecÚfigu»


415 || !
Üigš®Layout
.
	`g‘Prim¬ySequ’ûr
()

416 .
	`equ®s
(
ÃwLayout
.
	`g‘Prim¬ySequ’ûr
())) {

418 
SŒ—msAdd»ssRe¥Ú£
 
¡»amsAdd»s£sRe¥Ú£
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
()

419 .
	`g‘LogAdd»ssS·û
();

421 
maxTok’Reque¡ed
 = 
¡»amsAdd»s£sRe¥Ú£
.
	`g‘LogTa
();

422 
¡»amsAdd»ssS·û
 = 
¡»amsAdd»s£sRe¥Ú£
.
	`g‘Add»ssM­
();

425 
maxTok’Reque¡ed
++;

426 
boÙ¡¿pW™houtTasUpd©e
 = 
çl£
;

430 
boŞ—n
 
£qu’ûrBoÙ¡¿pResuÉ
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(

431 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout
)

432 .
	`g‘Prim¬ySequ’ûrCl›Á
()

433 .
	`boÙ¡¿p
(
maxTok’Reque¡ed
, 
¡»amsAdd»ssS·û
, 
ÃwLayout
.
	`g‘Epoch
(),

434 
boÙ¡¿pW™houtTasUpd©e
));

435 
Ï¡KnownSequ’ûrEpoch
 = 
ÃwLayout
.
	`g‘Epoch
();

436 ià(
£qu’ûrBoÙ¡¿pResuÉ
) {

437 
log
.
	`šfo
("reconfigureSequencerServers: Sequencer bootstrap successful.");

439 
log
.
	`w¬n
("reconfigureSequencerServers: Sequencer bootstrap failed. "

442 } 
fš®ly
 {

443 
»cov”Sequ’ûrLock
.
	`uÆock
();

446 
log
.
	`šfo
("reconfigureSequencerServers: Sequencer„econfiguration‡lready in…rogress.");

448 
	}
}

457 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
asyncSequ’ûrBoÙ¡¿p
(

458 @
NÚNuÎ
 
Layout
 
Ïyout
, @NÚNuÎ 
ExecutÜS”viû
 
£rviû
) {

460  
	g£qu’ûrRecov”yFutu»
.
upd©eAndG‘
(
£qu’ûrRecov”y
 -> {

461 ià(!
£qu’ûrRecov”y
.
isDÚe
()) {

462 
log
.
šfo
("triggerSequencerBootstrap:‡ bootstrapask is‡lready in…rogress.");

463  
£qu’ûrRecov”y
;

466  
Com¶‘abËFutu»
.
suµlyAsync
(() -> {

467 
log
.
šfo
("triggerSequencerBootstrap:‡ bootstrapask isriggered.");

468 
Œy
 {

469 
»cÚfigu»Sequ’ûrS”v”s
(
Ïyout
,†ayout, 
Œue
);

470 } 
ÿtch
 (
Exû±iÚ
 
e
) {

471 
log
.
”rÜ
("Œigg”Sequ’ûrBoÙ¡¿p: Faed w™h Exû±iÚ: ", 
e
);

473  
Œue
;

474 }, 
£rviû
);

	@runtime/src/main/java/org/corfudb/runtime/view/LayoutView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
.
	g¡»am
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

11 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

13 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Re¥Ú£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoBoÙ¡¿pExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgClu¡”Exû±iÚ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

29 @
Slf4j


30 
public
 cÏs 
	cLayoutV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

32 
public
 
LayoutV›w
(@
NÚnuÎ
 
fš®
 
CÜfuRuÁime
 
ruÁime
) {

33 
su³r
(
ruÁime
);

39 
public
 
Layout
 
	$g‘Layout
() {

40  
	`ÏyoutH–³r
(
RuÁimeLayout
::
g‘Layout
);

41 
	}
}

43 
public
 
RuÁimeLayout
 
	$g‘RuÁimeLayout
() {

44  
	`ÏyoutH–³r
(
l
 ->†);

45 
	}
}

47 
public
 
RuÁimeLayout
 
g‘RuÁimeLayout
(@
NÚnuÎ
 
Layout
 
Ïyout
) {

48  
Ãw
 
RuÁimeLayout
(
Ïyout
, 
ruÁime
);

57 
public
 
	$g‘QuÜumNumb”
() {

58  (
	`g‘Layout
().
	`g‘LayoutS”v”s
().
	`size
() / 2) + 1;

59 
	}
}

76 @
Suµ»ssW¬nšgs
("unchecked")

77 
public
 
	$upd©eLayout
(
Layout
 
Ïyout
, 
¿nk
)

78 
throws
 
QuÜumUÄ—chabËExû±iÚ
, 
OuŒªkedExû±iÚ
, 
WrÚgEpochExû±iÚ
 {

80 
•och
 = 
Ïyout
.
	`g‘Epoch
();

81 
Layout
 
cu¼’tLayout
 = 
	`g‘Layout
();

82 ià(
cu¼’tLayout
.
	`g‘Epoch
(è!ğ
•och
 - 1) {

83 
log
.
	`”rÜ
("Runtime†ayout hasƒpoch {} butƒxpected {}o moveoƒpoch {}",

84 
cu¼’tLayout
.
	`g‘Epoch
(), 
•och
 - 1,ƒpoch);

85 
throw
 
Ãw
 
	`WrÚgEpochExû±iÚ
(
•och
 - 1);

87 ià(
cu¼’tLayout
.
	`g‘Clu¡”Id
(è!ğ
nuÎ


88 && !
cu¼’tLayout
.
	`g‘Clu¡”Id
().
	`equ®s
(
Ïyout
.getClusterId())) {

89 
log
.
	`”rÜ
("updateLayout: Requested†ayout has cluster Id {} butƒxpected {}",

90 
Ïyout
.
	`g‘Clu¡”Id
(), 
cu¼’tLayout
.getClusterId());

91 
throw
 
Ãw
 
	`WrÚgClu¡”Exû±iÚ
(
cu¼’tLayout
.
	`g‘Clu¡”Id
(), 
Ïyout
.getClusterId());

94 
Layout
 
®»adyPrİo£dLayout
 = 
	`´•¬e
(
•och
, 
¿nk
);

95 
Layout
 
ÏyoutToPrİo£
 = 
®»adyPrİo£dLayout
 !ğ
nuÎ
 ?‡Ì—dyPrİo£dLayouˆ: 
Ïyout
;

97 
	`´İo£
(
•och
, 
¿nk
, 
ÏyoutToPrİo£
);

99 
	`comm™‹d
(
•och
, 
ÏyoutToPrİo£
);

100 
	}
}

112 @
Suµ»ssW¬nšgs
("unchecked")

113 
public
 
Layout
 
	$´•¬e
(
•och
, 
¿nk
)

114 
throws
 
QuÜumUÄ—chabËExû±iÚ
, 
OuŒªkedExû±iÚ
, 
WrÚgEpochExû±iÚ
 {

116 
Com¶‘abËFutu»
<
LayoutP»·»Re¥Ú£
>[] 
´•¬eLi¡
 = 
	`g‘Layout
().
	`g‘LayoutS”v”s
()

117 .
	`¡»am
()

118 .
	`m­
(
x
 -> {

119 
Com¶‘abËFutu»
<
LayoutP»·»Re¥Ú£
> 
cf
 = 
Ãw
 CompletableFuture<>();

120 
Œy
 {

122 
cf
 = 
	`g‘RuÁimeLayout
().
	`g‘LayoutCl›Á
(
x
).
	`´•¬e
(
•och
, 
¿nk
);

123 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

124 
cf
.
	`com¶‘eExû±iÚ®ly
(
e
);

126  
cf
;

128 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

129 
LayoutP»·»Re¥Ú£
[] 
acû±Li¡
;

130 
timeouts
 = 0L;

131 
wrÚgEpochRejeùed
 = 0L;

132 
Œue
) {

134 ià(
´•¬eLi¡
.
Ëngth
 < 
	`g‘QuÜumNumb”
()) {

135 
log
.
	`debug
("´•¬e: QuÜum uÄ—chabË,„emaššg={},„equœed={}", 
´•¬eLi¡
,

136 
	`g‘QuÜumNumb”
());

137 
throw
 
Ãw
 
	`QuÜumUÄ—chabËExû±iÚ
(
´•¬eLi¡
.
Ëngth
, 
	`g‘QuÜumNumb”
());

141 
Œy
 {

142 
CFUts
.
	`g‘Unš‹¼u±ibly
(
Com¶‘abËFutu»
.
	`ªyOf
(
´•¬eLi¡
),

143 
OuŒªkedExû±iÚ
.
şass
, 
TimeoutExû±iÚ
.şass, 
N‘wÜkExû±iÚ
.class,

144 
WrÚgEpochExû±iÚ
.
şass
);

145 } 
	`ÿtch
 (
TimeoutExû±iÚ
 | 
N‘wÜkExû±iÚ
 
e
) {

146 
timeouts
++;

147 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
we
) {

148 
wrÚgEpochRejeùed
++;

152 
´•¬eLi¡
 = 
	`¡»am
(prepareList)

153 .
	`f‹r
(
x
 -> !x.
	`isCom¶‘edExû±iÚ®ly
())

154 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

156 
acû±Li¡
 = 
	`¡»am
(
´•¬eLi¡
)

157 .
	`m­
(
x
 -> {

158 
Œy
 {

159  
x
.
	`g‘Now
(
nuÎ
);

160 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

161  
nuÎ
;

164 .
	`f‹r
(
x
 -> x !ğ
nuÎ
)

165 .
	`toA¼ay
(
LayoutP»·»Re¥Ú£
[]::
Ãw
);

167 
log
.
	`debug
("prepare: Successful„esponses={},‚eeded={},imeouts={}, "

169 
acû±Li¡
.
Ëngth
, 
	`g‘QuÜumNumb”
(), 
timeouts
, 
wrÚgEpochRejeùed
);

171 ià(
acû±Li¡
.
Ëngth
 >ğ
	`g‘QuÜumNumb”
()) {

176 
Li¡
<
LayoutP»·»Re¥Ú£
> 
li¡
 = 
A¼ays
.
	`¡»am
(
acû±Li¡
)

177 .
	`f‹r
(
x
 -> x.
	`g‘Layout
(è!ğ
nuÎ
)

178 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

179 ià(
li¡
.
	`isEm±y
()) {

180  
nuÎ
;

183 
highe¡R‘uºedRªk
 = 
LÚg
.
MIN_VALUE
;

184 
Layout
 
ÏyoutW™hHighe¡Rªk
 = 
nuÎ
;

186 
LayoutP»·»Re¥Ú£
 
ÏyoutP»·»Re¥Ú£
 : 
li¡
) {

187 ià(
ÏyoutP»·»Re¥Ú£
.
	`g‘Rªk
(è> 
highe¡R‘uºedRªk
) {

188 
highe¡R‘uºedRªk
 = 
ÏyoutP»·»Re¥Ú£
.
	`g‘Rªk
();

189 
ÏyoutW™hHighe¡Rªk
 = 
ÏyoutP»·»Re¥Ú£
.
	`g‘Layout
();

192  
ÏyoutW™hHighe¡Rªk
;

194 
	}
}

203 @
Suµ»ssW¬nšgs
("unchecked")

204 
public
 
Layout
 
	$´İo£
(
•och
, 
¿nk
, 
Layout
 
Ïyout
)

205 
throws
 
QuÜumUÄ—chabËExû±iÚ
, 
OuŒªkedExû±iÚ
 {

206 
Com¶‘abËFutu»
<
BoŞ—n
>[] 
´İo£Li¡
 = 
	`g‘Layout
().
	`g‘LayoutS”v”s
().
	`¡»am
()

207 .
	`m­
(
x
 -> 
	`g‘RuÁimeLayout
().
	`g‘LayoutCl›Á
(x).
	`´İo£
(
•och
, 
¿nk
, 
Ïyout
))

208 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

210 
timeouts
 = 0L;

211 
wrÚgEpochRejeùed
 = 0L;

212 
Œue
) {

214 ià(
´İo£Li¡
.
Ëngth
 < 
	`g‘QuÜumNumb”
()) {

215 
log
.
	`debug
("´İo£: QuÜum uÄ—chabË,„emaššg={},„equœed={}", 
´İo£Li¡
,

216 
	`g‘QuÜumNumb”
());

217 
throw
 
Ãw
 
	`QuÜumUÄ—chabËExû±iÚ
(
´İo£Li¡
.
Ëngth
, 
	`g‘QuÜumNumb”
());

221 
Œy
 {

222 
CFUts
.
	`g‘Unš‹¼u±ibly
(
Com¶‘abËFutu»
.
	`ªyOf
(
´İo£Li¡
),

223 
OuŒªkedExû±iÚ
.
şass
, 
TimeoutExû±iÚ
.şass, 
N‘wÜkExû±iÚ
.class,

224 
WrÚgEpochExû±iÚ
.
şass
);

225 } 
	`ÿtch
 (
TimeoutExû±iÚ
 | 
N‘wÜkExû±iÚ
 
e
) {

226 
timeouts
++;

227 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
we
) {

228 
wrÚgEpochRejeùed
++;

232 
´İo£Li¡
 = 
	`¡»am
(proposeList)

233 .
	`f‹r
(
x
 -> !x.
	`isCom¶‘edExû±iÚ®ly
())

234 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

237 
couÁ
 = 
	`¡»am
(
´İo£Li¡
)

238 .
	`m­
(
x
 -> {

239 
Œy
 {

240  
x
.
	`g‘Now
(
çl£
);

241 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

242  
çl£
;

245 .
	`f‹r
(
x
 -> x)

246 .
	`couÁ
();

248 
log
.
	`debug
("propose: Successful„esponses={},‚eeded={},imeouts={}, "

250 
couÁ
, 
	`g‘QuÜumNumb”
(), 
timeouts
, 
wrÚgEpochRejeùed
);

252 ià(
couÁ
 >ğ
	`g‘QuÜumNumb”
()) {

257  
Ïyout
;

258 
	}
}

269 
public
 
	$comm™‹d
(
•och
, 
Layout
 
Ïyout
) {

270 
	`comm™‹d
(
•och
, 
Ïyout
, 
çl£
);

271 
	}
}

277 @
Suµ»ssW¬nšgs
("unchecked")

278 
public
 
	$comm™‹d
(
•och
, 
Layout
 
Ïyout
, 
boŞ—n
 
fÜû
)

279 
throws
 
WrÚgEpochExû±iÚ
 {

280 
Com¶‘abËFutu»
<
BoŞ—n
>[] 
comm™Li¡
 = 
Ïyout
.
	`g‘LayoutS”v”s
().
	`¡»am
()

281 .
	`m­
(
x
 -> {

282 
Com¶‘abËFutu»
<
BoŞ—n
> 
cf
 = 
Ãw
 CompletableFuture<>();

283 
Œy
 {

285 ià(
fÜû
) {

286 
cf
 = 
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘LayoutCl›Á
(
x
).
	`fÜû
(layout);

288 
cf
 = 
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘LayoutCl›Á
(
x
).
	`comm™‹d
(
•och
,†ayout);

290 } 
	`ÿtch
 (
N‘wÜkExû±iÚ
 
e
) {

291 
cf
.
	`com¶‘eExû±iÚ®ly
(
e
);

293  
cf
;

295 .
	`toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

298 
»¥Ú£s
 = 0;

299 
Com¶‘abËFutu»
 
cf
 : 
comm™Li¡
) {

300 
Œy
 {

301 
CFUts
.
	`g‘Unš‹¼u±ibly
(
cf
, 
WrÚgEpochExû±iÚ
.
şass
,

302 
TimeoutExû±iÚ
.
şass
, 
N‘wÜkExû±iÚ
.şass, 
NoBoÙ¡¿pExû±iÚ
.class);

303 
»¥Ú£s
++;

304 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
e
) {

305 ià(!
fÜû
) {

306 
throw
 
e
;

308 
log
.
	`w¬n
("comm™‹d:ƒncouÁ”edƒxû±iÚ", 
e
);

309 } 
	`ÿtch
 (
NoBoÙ¡¿pExû±iÚ
 | 
TimeoutExû±iÚ
 | 
N‘wÜkExû±iÚ
 
e
) {

310 
log
.
	`w¬n
("comm™‹d:ƒncouÁ”edƒxû±iÚ", 
e
);

313 
log
.
	`debug
("comm™‹d: SucûssfuÈ»que¡s={},„e¥Ú£s={}", 
comm™Li¡
.
Ëngth
, 
»¥Ú£s
);

314 
	}
}

324 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
boÙ¡¿pLayoutS”v”
(@
NÚnuÎ
 
SŒšg
 
’dpošt
, @NÚnuÎ 
Layout
 
Ïyout
) {

325  
g‘RuÁimeLayout
(
Ïyout
).
g‘LayoutCl›Á
(
’dpošt
).
boÙ¡¿pLayout
(layout)

326 .
exû±iÚ®ly
(
throwabË
 -> {

327 
Œy
 {

328 
CFUts
.
unw¿p
(
throwabË
, 
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

329 } 
ÿtch
 (
AÌ—dyBoÙ¡¿µedExû±iÚ
 
e
) {

330 
log
.
šfo
("boÙ¡¿pLayoutS”v”: LayouˆS”v” {}‡Ì—dy boÙ¡¿µed.", 
’dpošt
);

332  
Œue
;

334 .
th’Aµly
(
»suÉ
 -> {

335 
log
.
šfo
("boÙ¡¿pLayoutS”v”: LayouˆS”v” {} boÙ¡¿°sucûssful", 
’dpošt
);

336  
Œue
;

	@runtime/src/main/java/org/corfudb/runtime/view/ManagementView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutCl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWÜkæowExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWÜkæowResuÉUnknownExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”StusR–Ÿb™y
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gCÚÃùiv™yStus
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
.
	gAddNode
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
.
	gFÜûRemoveNode
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
.
	gH—lNode
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
.
	gRemoveNode
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
.
	gRe¡ÜeRedundªcyM”geSegm’ts
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

25 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

26 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

27 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

28 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

30 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

31 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

35 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

36 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

37 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

38 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

45 @
Slf4j


46 
public
 cÏs 
	cMªagem’tV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

51 
´iv©e
 
fš®
 
	mCLUSTER_STATUS_QUERY_ATTEMPTS
 = 3;

53 
public
 
Mªagem’tV›w
(@
NÚNuÎ
 
CÜfuRuÁime
 
ruÁime
) {

54 
su³r
(
ruÁime
);

68 
public
 
»moveNode
(@
NÚnuÎ
 
SŒšg
 
’dpoštToRemove
, 
»Œy
,

69 @
NÚnuÎ
 
Du¿tiÚ
 
timeout
, @NÚnuÎ Du¿tiÚ 
pŞlP”iod
) {

71 
Ãw
 
RemoveNode
(
’dpoštToRemove
, 
ruÁime
, 
»Œy
, 
timeout
, 
pŞlP”iod
).
švoke
();

85 
public
 
fÜûRemoveNode
(@
NÚnuÎ
 
SŒšg
 
’dpoštToRemove
, 
»Œy
,

86 @
NÚnuÎ
 
Du¿tiÚ
 
timeout
, @NÚnuÎ Du¿tiÚ 
pŞlP”iod
) {

87 
Ãw
 
FÜûRemoveNode
(
’dpoštToRemove
, 
ruÁime
, 
»Œy
, 
timeout
, 
pŞlP”iod
).
švoke
();

100 
public
 
addNode
(@
NÚnuÎ
 
SŒšg
 
’dpoštToAdd
, 
»Œy
,

101 @
NÚnuÎ
 
Du¿tiÚ
 
timeout
, @NÚnuÎ Du¿tiÚ 
pŞlP”iod
) {

102 
Ãw
 
AddNode
(
’dpoštToAdd
, 
ruÁime
, 
»Œy
, 
timeout
, 
pŞlP”iod
)

103 .
švoke
();

116 
public
 
h—lNode
(@
NÚnuÎ
 
SŒšg
 
’dpoštToH—l
, 
»Œy
, @NÚnuÎ 
Du¿tiÚ
 
timeout
,

117 @
NÚnuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

118 
Ãw
 
H—lNode
(
’dpoštToH—l
, 
ruÁime
, 
»Œy
, 
timeout
, 
pŞlP”iod
).
švoke
();

131 
public
 
m”geSegm’ts
(@
NÚnuÎ
 
SŒšg
 
’dpoštToRe¡ÜeRedundªcy
, 
»Œy
, @NÚnuÎ 
Du¿tiÚ
 
timeout
,

132 @
NÚnuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

133 
Ãw
 
Re¡ÜeRedundªcyM”geSegm’ts
(
’dpoštToRe¡ÜeRedundªcy
, 
ruÁime
, 
»Œy
, 
timeout
, 
pŞlP”iod
).
švoke
();

145 
´iv©e
 
Clu¡”Stus
 
g‘LayoutS”v”sClu¡”H—Éh
(
Layout
 
Ïyout
,

146 
S‘
<
SŒšg
> 
³”Re¥ÚsiveNodes
) {

147 
Clu¡”Stus
 
	gşu¡”Stus
 = Clu¡”Stus.
STABLE
;

149 
	gLi¡
<
	gSŒšg
> 
	g»¥ÚsiveLayoutS”v”s
 = 
Ãw
 
A¼ayLi¡
<>(
Ïyout
.
g‘LayoutS”v”s
());

151 
	g»¥ÚsiveLayoutS”v”s
.
»šAÎ
(
³”Re¥ÚsiveNodes
);

152 ià(
	g»¥ÚsiveLayoutS”v”s
.
size
(è!ğ
Ïyout
.
g‘LayoutS”v”s
().size()) {

153 
şu¡”Stus
 = 
Clu¡”Stus
.
DEGRADED
;

154 
	gquÜumSize
 = (
Ïyout
.
g‘LayoutS”v”s
().
size
() / 2) + 1;

155 ià(
	g»¥ÚsiveLayoutS”v”s
.
size
(è< 
	gquÜumSize
) {

156 
	gşu¡”Stus
 = 
Clu¡”Stus
.
UNAVAILABLE
;

159  
	gşu¡”Stus
;

169 
´iv©e
 
Clu¡”Stus
 
g‘Sequ’ûrS”v”sClu¡”H—Éh
(
Layout
 
Ïyout
,

170 
S‘
<
SŒšg
> 
³”Re¥ÚsiveNodes
) {

172  !
	g³”Re¥ÚsiveNodes
.
cÚšs
(
Ïyout
.
g‘Prim¬ySequ’ûr
())

173 ? 
	gClu¡”Stus
.
	gUNAVAILABLE
 : 
Clu¡”Stus
.
STABLE
;

183 
´iv©e
 
Clu¡”Stus
 
g‘LogUn™S”v”sClu¡”H—Éh
(
Layout
 
Ïyout
,

184 
S‘
<
SŒšg
> 
³”Re¥ÚsiveNodes
) {

187 
Clu¡”Stus
 
	glogUn™RedundªcyStus
 = 
³”Re¥ÚsiveNodes
.
¡»am
()

188 .
ªyM©ch
(
s
 -> 
g‘LogUn™NodeStusInLayout
(
Ïyout
, sè=ğ
NodeStus
.
DB_SYNCING
)

189 ? 
Clu¡”Stus
.
DB_SYNCING
 : Clu¡”Stus.
STABLE
;

192 
Clu¡”Stus
 
	glogun™Clu¡”Stus
 = 
Ïyout
.
g‘Segm’ts
().
¡»am
()

193 .
m­
(
£gm’t
 -> segm’t.
g‘R•liÿtiÚMode
()

194 .
g‘Clu¡”H—ÉhFÜSegm’t
(
£gm’t
, 
³”Re¥ÚsiveNodes
))

195 .
max
(
Com·¿tÜ
.
com·ršgIÁ
(
Clu¡”Stus
::
g‘H—ÉhV®ue
))

196 .
ÜEl£
(
Clu¡”Stus
.
UNAVAILABLE
);

198  
	gSŒ—m
.
of
(
logun™Clu¡”Stus
, 
logUn™RedundªcyStus
)

199 .
max
(
Com·¿tÜ
.
com·ršgIÁ
(
Clu¡”Stus
::
g‘H—ÉhV®ue
))

200 .
ÜEl£
(
Clu¡”Stus
.
UNAVAILABLE
);

217 
´iv©e
 
Clu¡”Stus
 
g‘Clu¡”H—Éh
(
Layout
 
Ïyout
, 
S‘
<
SŒšg
> 
³”Re¥ÚsiveNodes
) {

219  
	gSŒ—m
.
of
(
g‘LayoutS”v”sClu¡”H—Éh
(
Ïyout
, 
³”Re¥ÚsiveNodes
),

220 
g‘Sequ’ûrS”v”sClu¡”H—Éh
(
Ïyout
, 
³”Re¥ÚsiveNodes
),

221 
g‘LogUn™S”v”sClu¡”H—Éh
(
Ïyout
, 
³”Re¥ÚsiveNodes
))

224 .
max
(
Com·¿tÜ
.
com·ršgIÁ
(
Clu¡”Stus
::
g‘H—ÉhV®ue
))

225 .
ÜEl£
(
Clu¡”Stus
.
UNAVAILABLE
);

240 
´iv©e
 
NodeStus
 
	$g‘LogUn™NodeStusInLayout
(
Layout
 
Ïyout
, 
SŒšg
 
£rv”
) {

241 ià(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
£rv”
)) {

242  
NodeStus
.
DOWN
;

244 
fš®
 
£gm’tsCouÁ
 = 
Ïyout
.
	`g‘Segm’ts
().
	`size
();

245 
nodeInSegm’ts
 = 0;

246 
LayoutSegm’t
 
ÏyoutSegm’t
 : 
Ïyout
.
	`g‘Segm’ts
()) {

247 ià(
ÏyoutSegm’t
.
	`g‘AÎLogS”v”s
().
	`cÚšs
(
£rv”
)) {

248 
nodeInSegm’ts
++;

251  
nodeInSegm’ts
 =ğ
£gm’tsCouÁ
 ||‚odeInSegments == 0

252 ? 
NodeStus
.
UP
 : NodeStus.
DB_SYNCING
;

253 
	}
}

293 
public
 
Clu¡”StusR•Üt
 
	$g‘Clu¡”Stus
() {

294 
Layout
 
Ïyout
;

295 
Clu¡”StusR–Ÿb™y
 
¡©usR–Ÿb™y
 = Clu¡”StusR–Ÿb™y.
STRONG_QUORUM
;

299 
Li¡
<
SŒšg
> 
ÏyoutS”v”s
 = 
ruÁime
.
	`g‘LayoutS”v”s
().
	`¡»am
()

300 .
	`m­
(
’dpošt
 -> 
NodeLoÿtÜ
.
	`·r£SŒšg
Óndpošt).
	`toEndpoštU¾
())

301 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

303 
Œy
 {

314 
M­
<
SŒšg
, 
Layout
> 
ÏyoutM­
 = 
	`g‘Layouts
(
ÏyoutS”v”s
, 
Œue
);

316 
quÜum
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘QuÜumNumb”
();

318 ià(
ÏyoutM­
.
	`isEm±y
()) {

320 
log
.
	`debug
("g‘Clu¡”Stus:‡Î†ayouˆ£rv” {} faedØ»¥Úd w™h†ayouts.", 
ÏyoutS”v”s
);

324 
M­
<
SŒšg
, 
CÚÃùiv™yStus
> 
cÚÃùiv™yStusM­
 = 
	`g‘CÚÃùiv™yStusM­
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

325  
	`g‘UÇvaabËClu¡”StusR•Üt
(
ÏyoutS”v”s
, 
Clu¡”StusR–Ÿb™y
.
UNAVAILABLE
,

326 
cÚÃùiv™yStusM­
.
	`’ŒyS‘
().
	`¡»am
()

327 .
	`f‹r
(
x
 -> x.
	`g‘V®ue
().
	`equ®s
(
CÚÃùiv™yStus
.
RESPONSIVE
))

328 .
	`m­
(
x
 -> x.
	`g‘Key
()).
	`cŞËù
(
CŞËùÜs
.
	`toS‘
()), 
nuÎ
);

330 
£rv”sLayoutRe¥Ú£s
 = 
ÏyoutM­
.
	`size
();

332 ià(
£rv”sLayoutRe¥Ú£s
 < 
quÜum
) {

335 
log
.
	`šfo
("getClusterStatus: Quorum unreachable,„eachable={},„equired={}. Cluster status in unavailable.",

336 
£rv”sLayoutRe¥Ú£s
, 
quÜum
);

337 
Ïyout
 = 
	`g‘Highe¡EpochLayout
(
ÏyoutM­
);

341  
	`g‘UÇvaabËClu¡”StusR•Üt
(
	`g‘LayoutS”v”s
(
ÏyoutM­
.
	`v®ues
()),

342 
Clu¡”StusR–Ÿb™y
.
WEAK_NO_QUORUM
, 
ÏyoutM­
.
	`keyS‘
(), 
Ïyout
);

344 
Ïyout
 = 
	`g‘LayoutFromQuÜum
(
ÏyoutM­
, 
quÜum
);

346 ià(
Ïyout
 =ğ
nuÎ
) {

350 
log
.
	`šfo
("getClusterStatus: majority of‚odes sharinghe same†ayout‚ot found. Cluster status is unavailable.");

351 
Ïyout
 = 
	`g‘Highe¡EpochLayout
(
ÏyoutM­
);

352  
	`g‘UÇvaabËClu¡”StusR•Üt
(
	`g‘LayoutS”v”s
(
ÏyoutM­
.
	`v®ues
()),

353 
Clu¡”StusR–Ÿb™y
.
WEAK_NO_QUORUM
, 
ÏyoutM­
.
	`keyS‘
(), 
Ïyout
);

356 
log
.
	`debug
("g‘Clu¡”Stus: quÜum†ayouˆ{}", 
Ïyout
);

361 
Clu¡”Stus
 
şu¡”Stus
 = 
	`g‘Clu¡”H—Éh
(
Ïyout
,†ayout.
	`g‘AÎAùiveS”v”s
());

364 
M­
<
SŒšg
, 
NodeStus
> 
nodeStusM­
 = 
	`g‘NodeStusM­
(
Ïyout
);

369 
M­
 <
SŒšg
, 
Clu¡”StusR•Üt
.
CÚÃùiv™yStus
> 
cÚÃùiv™yStusM­
 = 
	`g‘CÚÃùiv™yStusM­
(
Ïyout
);

371 
log
.
	`debug
("g‘Clu¡”Stus: sucûssful. Ov”®Èşu¡” stus: {}", 
şu¡”Stus
);

373  
Ãw
 
	`Clu¡”StusR•Üt
(
Ïyout
, 
şu¡”Stus
, 
¡©usR–Ÿb™y
, 
nodeStusM­
, 
cÚÃùiv™yStusM­
);

374 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

375 
log
.
	`”rÜ
("getClusterStatus[{}]: cluster status unavailable. Exception: {}",

376 
this
.
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘Cl›ÁId
(), 
e
);

377  
	`g‘UÇvaabËClu¡”StusR•Üt
(
ÏyoutS”v”s
);

379 
	}
}

381 
´iv©e
 
Clu¡”StusR•Üt
 
g‘UÇvaabËClu¡”StusR•Üt
(
Li¡
<
SŒšg
> 
ÏyoutS”v”s
, 
Clu¡”StusR–Ÿb™y
 
»lŸb™y
, @
NÚnuÎ
 
S‘
<SŒšg> 
»¥ÚsiveS”v”s
, 
Layout
 
Ïyout
) {

382  
Ãw
 
Clu¡”StusR•Üt
(
Ïyout
,

383 
Clu¡”Stus
.
UNAVAILABLE
,

384 
»lŸb™y
,

385 
ÏyoutS”v”s
.
¡»am
().
cŞËù
(
CŞËùÜs
.
toM­
(

386 
’dpošt
 ->ƒndpoint,

387 
node
 -> 
NodeStus
.
NA
)),

388 
ÏyoutS”v”s
.
¡»am
().
cŞËù
(
CŞËùÜs
.
toM­
(

389 
’dpošt
 ->ƒndpoint,

390 
’dpošt
 -> 
»¥ÚsiveS”v”s
.
cÚšs
Óndpoštè? 
CÚÃùiv™yStus
.
RESPONSIVE
 : CÚÃùiv™yStus.
UNRESPONSIVE
)));

393 
´iv©e
 
Clu¡”StusR•Üt
 
g‘UÇvaabËClu¡”StusR•Üt
(
Li¡
<
SŒšg
> 
ÏyoutS”v”s
) {

394  
g‘UÇvaabËClu¡”StusR•Üt
(
ÏyoutS”v”s
, 
Clu¡”StusR–Ÿb™y
.
UNAVAILABLE
, 
CŞËùiÚs
.
em±yS‘
(), 
nuÎ
);

407 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gLayout
> 
g‘Layouts
(
Li¡
<
SŒšg
> 
ÏyoutS”v”s
, 
BoŞ—n
 
discov”LayoutS”v”s
) {

408 
	gM­
<
	gSŒšg
, 
	gCom¶‘abËFutu»
<
	gLayout
>> 
	gÏyoutFutu»sM­
 = 
g‘LayoutFutu»s
(
ÏyoutS”v”s
);

409 
	gM­
<
	gSŒšg
, 
	gLayout
> 
	gÏyoutM­
 = 
Ãw
 
HashM­
<>();

412 
	gEÁry
<
	gSŒšg
, 
	gCom¶‘abËFutu»
<
	gLayout
>> 
	g’Œy
 : 
ÏyoutFutu»sM­
.
’ŒyS‘
()) {

413 
Œy
 {

414 
Layout
 
nodeLayout
 = 
’Œy
.
g‘V®ue
().
g‘
();

415 
	glog
.
debug
("S”v”:{}„e¥Úded w™h†ayout: {}", 
’Œy
.
g‘Key
(), 
nodeLayout
);

416 
	gÏyoutM­
.
put
(
’Œy
.
g‘Key
(), 
nodeLayout
);

417 } 
ÿtch
 (
Exû±iÚ
 
e
) {

418 
	glog
.
”rÜ
("getClusterStatus: Error while fetching†ayout from {}. Exception: ",

419 
’Œy
.
g‘Key
(), 
e
);

425 ià(
	gdiscov”LayoutS”v”s
) {

426 
	gLi¡
<
	gSŒšg
> 
	gdiscov”edLayoutS”v”s
 = 
ÏyoutM­
.
v®ues
().
¡»am
()

427 .
m­
(
Ïyout
 ->†ayout.
g‘LayoutS”v”s
())

428 .
æ©M­
(
£rv”s
 -> s”v”s.
¡»am
())

429 .
di¡šù
()

430 .
f‹r
(
£rv”s
 -> !
ÏyoutS”v”s
.
cÚšs
(servers))

431 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

433 ià(!
	gdiscov”edLayoutS”v”s
.
isEm±y
()) {

434 
	glog
.
debug
("G‘†ayouˆäom discov”ed†ayouˆ£rv”s: {} ", 
discov”edLayoutS”v”s
);

435 
	gM­
 <
	gSŒšg
, 
	gLayout
> 
	g»cursiveLayouts
 = 
g‘Layouts
(
Ãw
 
A¼ayLi¡
<>(
discov”edLayoutS”v”s
), 
çl£
);

436 
	gÏyoutM­
.
putAÎ
(
»cursiveLayouts
);

440  
	gÏyoutM­
;

443 
´iv©e
 
Layout
 
g‘LayoutFromQuÜum
(@
NÚnuÎ
 
M­
<
SŒšg
, Layout> 
ÏyoutM­
, 
quÜum
) {

444 
Layout
 
	gÏyout
 = 
nuÎ
;

446 
	gM­
<
	gLayout
, 
	gIÁeg”
> 
	guniqueLayoutM­
 = 
Ãw
 
HashM­
<>();

450 
Layout
 
	gnodeLayout
 : 
ÏyoutM­
.
v®ues
()) {

451 ià(
uniqueLayoutM­
.
keyS‘
().
cÚšs
(
nodeLayout
)) {

452 
uniqueLayoutM­
.
m”ge
(
nodeLayout
, 1, 
IÁeg”
::
sum
);

454 
	guniqueLayoutM­
.
put
(
nodeLayout
, 1);

459 
	gM­
<
	gLayout
, 
	gIÁeg”
> 
	guniqueLayoutsQuÜumM­
 = 
uniqueLayoutM­
.
’ŒyS‘
().
¡»am
()

460 .
f‹r
(
uniqueLayout
 -> uniqueLayout.
g‘V®ue
(è>ğ
quÜum
)

461 .
cŞËù
(
CŞËùÜs
.
toM­
(
uniqueLayout
 -> uniqueLayout.
g‘Key
(),

462 
uniqueLayout
 -> uniqueLayout.
g‘V®ue
()));

465 ià(!
	guniqueLayoutsQuÜumM­
.
isEm±y
()) {

466 
	gM­
.
	gEÁry
<
	gLayout
, 
	gIÁeg”
> 
	gmaxEÁry
 = 
nuÎ
;

467 
	gM­
.
	gEÁry
<
	gLayout
, 
	gIÁeg”
> 
	g’Œy
 : 
uniqueLayoutsQuÜumM­
.
’ŒyS‘
()) {

468 ià(
maxEÁry
 =ğ
nuÎ
 || 
’Œy
.
g‘V®ue
().
com·»To
(maxEntry.getValue()) > 0) {

469 
maxEÁry
 = 
’Œy
;

472 
	gÏyout
 = 
maxEÁry
.
g‘Key
();

475  
	gÏyout
;

478 
´iv©e
 
Layout
 
g‘Highe¡EpochLayout
(
M­
<
SŒšg
, Layout> 
ÏyoutM­
) {

479 
Layout
 
	gÏyout
 = 
nuÎ
;

480 
	gEÁry
<
	gSŒšg
, 
	gLayout
> 
	g’Œy
 : 
ÏyoutM­
.
’ŒyS‘
()) {

481 
Layout
 
nodeLayout
 = 
’Œy
.
g‘V®ue
();

482 ià(
	gÏyout
 =ğ
nuÎ
 || 
nodeLayout
.
g‘Epoch
(è> 
Ïyout
.getEpoch()) {

483 
Ïyout
 = 
nodeLayout
;

487  
	gÏyout
;

491 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gCom¶‘abËFutu»
<
	gLayout
>> 
g‘LayoutFutu»s
(
Li¡
<
SŒšg
> 
ÏyoutS”v”s
) {

493 
	gM­
<
	gSŒšg
, 
	gCom¶‘abËFutu»
<
	gLayout
>> 
	gÏyoutFutu»sM­
 = 
Ãw
 
HashM­
<>();

496 
SŒšg
 
	g£rv”
 : 
ÏyoutS”v”s
) {

497 
ICl›ÁRou‹r
 
rou‹r
 = 
ruÁime
.
g‘Rou‹r
(
£rv”
);

498 
	gÏyoutFutu»sM­
.
put
(
£rv”
, 
Ãw
 
LayoutCl›Á
(
rou‹r
, 
Layout
.
INVALID_EPOCH
).
g‘Layout
());

501  
	gÏyoutFutu»sM­
;

504 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gClu¡”StusR•Üt
.
	gCÚÃùiv™yStus
> 
	$g‘CÚÃùiv™yStusM­
(
Layout
 
Ïyout
) {

505 
M­
<
SŒšg
, 
Clu¡”StusR•Üt
.
CÚÃùiv™yStus
> 
cÚÃùiv™yStusM­
 = 
Ãw
 
HashM­
<>();

508 
SŒšg
 
£rv”Endpošt
 : 
Ïyout
.
	`g‘AÎS”v”s
()) {

509 
cÚÃùiv™yStusM­
.
	`put
(
£rv”Endpošt
, 
Clu¡”StusR•Üt
.
CÚÃùiv™yStus
.
UNRESPONSIVE
);

512 
RuÁimeLayout
 
ruÁimeLayout
 = 
Ãw
 
	`RuÁimeLayout
(
Ïyout
, 
ruÁime
);

513 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>> 
pšgFutu»M­
 = 
Ãw
 
HashM­
<>();

516 
i
 = 0; i < 
CLUSTER_STATUS_QUERY_ATTEMPTS
; i++) {

518 if(
cÚÃùiv™yStusM­
.
	`cÚšsV®ue
(
CÚÃùiv™yStus
.
UNRESPONSIVE
)) {

520 
Li¡
<
SŒšg
> 
’dpošts
 = 
cÚÃùiv™yStusM­
.
	`’ŒyS‘
()

521 .
	`¡»am
()

522 .
	`f‹r
(
’Œy
 ->ƒÁry.
	`g‘V®ue
().
	`equ®s
(
Clu¡”StusR•Üt
.
CÚÃùiv™yStus
.
UNRESPONSIVE
))

523 .
	`m­
(
EÁry
::
g‘Key
)

524 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

526 
SŒšg
 
£rv”Endpošt
 : 
’dpošts
) {

528 
Com¶‘abËFutu»
<
BoŞ—n
> 
cf
 = 
ruÁimeLayout
.
	`g‘Ba£Cl›Á
(
£rv”Endpošt
).
	`pšg
();

529 
pšgFutu»M­
.
	`put
(
£rv”Endpošt
, 
cf
);

533 
pšgFutu»M­
.
	`fÜEach
((
’dpošt
, 
pšgFutu»
) -> {

534 
Œy
 {

535 
Clu¡”StusR•Üt
.
CÚÃùiv™yStus
 
cÚÃùiv™yStus
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(
pšgFutu»
,

536 
WrÚgEpochExû±iÚ
.
şass
è? 
CÚÃùiv™yStus
.
RESPONSIVE
 : CÚÃùiv™yStus.
UNRESPONSIVE
;

537 
cÚÃùiv™yStusM­
.
	`put
(
’dpošt
, 
cÚÃùiv™yStus
);

538 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
w“
) {

539 
cÚÃùiv™yStusM­
.
	`put
(
’dpošt
, 
CÚÃùiv™yStus
.
RESPONSIVE
);

540 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

541 
cÚÃùiv™yStusM­
.
	`put
(
’dpošt
, 
CÚÃùiv™yStus
.
UNRESPONSIVE
);

547  
cÚÃùiv™yStusM­
;

548 
	}
}

550 
´iv©e
 
	gM­
<
	gSŒšg
, 
	gNodeStus
> 
	$g‘NodeStusM­
(
Layout
 
Ïyout
) {

551 
M­
<
SŒšg
, 
NodeStus
> 
nodeStusM­
 = 
Ãw
 
HashM­
<>();

552 
SŒšg
 
’dpošt
: 
Ïyout
.
	`g‘AÎS”v”s
()) {

553 ià(
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
’dpošt
)) {

554 
nodeStusM­
.
	`put
(
’dpošt
, 
NodeStus
.
DOWN
);

555 } ià(
Ïyout
.
	`g‘Segm’ts
().
	`size
(è!ğÏyout.
	`g‘Segm’tsFÜEndpošt
(
’dpošt
).size()) {

558 
nodeStusM­
.
	`put
(
’dpošt
, 
NodeStus
.
DB_SYNCING
);

560 
nodeStusM­
.
	`put
(
’dpošt
, 
NodeStus
.
UP
);

564  
nodeStusM­
;

565 
	}
}

567 
´iv©e
 
	gLi¡
<
	gSŒšg
> 
g‘LayoutS”v”s
(
CŞËùiÚ
<
Layout
> 
Ïyouts
) {

568 
	gLi¡
<
	gSŒšg
> 
	g®lLayoutS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

569 
Layout
 
	gÏyout
 : 
Ïyouts
) {

570 
®lLayoutS”v”s
.
addAÎ
(
Ïyout
.
g‘LayoutS”v”s
());

573  
	g®lLayoutS”v”s
.
¡»am
().
di¡šù
().
cŞËù
(
CŞËùÜs
.
toLi¡
());

584 
public
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
boÙ¡¿pMªagem’tS”v”
(@
NÚnuÎ
 
SŒšg
 
’dpošt
, @NÚnuÎ 
Layout
 
Ïyout
) {

585  
	gruÁime
.
g‘LayoutV›w
().
g‘RuÁimeLayout
(
Ïyout
)

586 .
g‘Mªagem’tCl›Á
(
’dpošt
)

587 .
boÙ¡¿pMªagem’t
(
Ïyout
)

588 .
exû±iÚ®ly
(
throwabË
 -> {

589 
Œy
 {

590 
CFUts
.
unw¿p
(
throwabË
, 
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

591 } 
ÿtch
 (
AÌ—dyBoÙ¡¿µedExû±iÚ
 
e
) {

592 
log
.
šfo
("boÙ¡¿pMªagem’tS”v”: Mªagem’ˆS”v” {}‡Ì—dy boÙ¡¿µed.", 
’dpošt
);

594  
Œue
;

596 .
th’Aµly
(
»suÉ
 -> {

597 
log
.
šfo
("boÙ¡¿pMªagem’tS”v”: Mªagem’ˆS”v” {} boÙ¡¿°sucûssful.", 
’dpošt
);

598  
Œue
;

	@runtime/src/main/java/org/corfudb/runtime/view/ObjectOpenOption.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

6 
public
 
	eObjeùO³nO±iÚ
 {

7 
	mNO_CACHE
,

8 
	mCACHE


	@runtime/src/main/java/org/corfudb/runtime/view/ObjectsView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÙaExûededExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWr™eSizeExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuCompeProxy
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚ®CÚ‹xt
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ
.
	gT¿n§ùiÚBud”
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

28 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

37 @
Slf4j


38 
public
 cÏs 
	cObjeùsV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

40 
´iv©e
 
fš®
 
SŒšg
 
	mTXN_COMMIT_TIMER_NAME
 =

41 
CÜfuCompÚ’t
.
OBJECT
.
toSŒšg
() + "txn-commit-duration";

46 
public
 
fš®
 
UUID
 
	mTRANSACTION_STREAM_ID
 = 
CÜfuRuÁime
.
g‘SŒ—mID
("Transaction_Stream");

48 @
	mG‘‹r


49 @
S‘‹r


50 
boŞ—n
 
	mŒª§ùiÚLoggšg
 = 
çl£
;

53 @
G‘‹r


54 
	mM­
<
	mObjeùID
, 
	mObjeù
> 
	mobjeùCache
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

56 
public
 
ObjeùsV›w
(@
NÚnuÎ
 
fš®
 
CÜfuRuÁime
 
ruÁime
) {

57 
su³r
(
ruÁime
);

65 
public
 
	gSMRObjeù
.
	gBud”
<?> 
	$bud
() {

66  
Ãw
 
SMRObjeù
.
Bud”
<>()

67 .
	`ruÁime
(
ruÁime
);

68 
	}
}

76 @
Suµ»ssW¬nšgs
({"checkstyle:methodname", "checkstyle:abbreviation"})

77 
public
 
	$TXBegš
() {

78 
T¿n§ùiÚTy³
 
ty³
 = T¿n§ùiÚTy³.
OPTIMISTIC
;

81 ià(
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()) {

82 
ty³
 = 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`g‘T¿n§ùiÚ
().
	`g‘Ty³
();

83 
log
.
	`Œaû
("Inh”™šg…¬’t' Œª§ùiÚy³ {}", 
ty³
);

86 
	`TXBud
()

87 .
	`ty³
(
ty³
)

88 .
	`bud
()

89 .
	`begš
();

90 
	}
}

98 @
Suµ»ssW¬nšgs
({"checkstyle:methodname", "checkstyle:abbreviation"})

99 
public
 
T¿n§ùiÚBud”
 
	$TXBud
() {

100 
T¿n§ùiÚBud”
 
bud”
 = 
T¿n§ùiÚ
.
	`bud”
();

101 
bud”
.
	`ruÁime
(
ruÁime
);

102  
bud”
;

103 
	}
}

110 @
Suµ»ssW¬nšgs
({"checkstyle:methodname", "checkstyle:abbreviation"})

111 
public
 
	$TXAbÜt
() {

112 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
cÚ‹xt
 = 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
();

113 ià(
cÚ‹xt
 =ğ
nuÎ
) {

114 
log
.
	`w¬n
("Attemptedo‡bort‡ransaction, but‚oransaction‡ctive!");

116 
TxResŞutiÚInfo
 
txInfo
 = 
Ãw
 
	`TxResŞutiÚInfo
(

117 
cÚ‹xt
.
	`g‘T¿n§ùiÚID
(), cÚ‹xt.
	`g‘SÇpshÙTime¡amp
());

118 
cÚ‹xt
.
	`abÜtT¿n§ùiÚ
(
Ãw
 
	`T¿n§ùiÚAbÜ‹dExû±iÚ
(

119 
txInfo
, 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
, Tok’Re¥Ú£.
NO_CONFLICT_STREAM
,

120 
Add»ss
.
NON_ADDRESS
, 
AbÜtCau£
.
USER
, 
cÚ‹xt
));

121 
T¿n§ùiÚ®CÚ‹xt
.
	`»moveCÚ‹xt
();

123 
	}
}

131 @
Suµ»ssW¬nšgs
({"checkstyle:methodname", "checkstyle:abbreviation"})

132 
public
 
boŞ—n
 
	$TXAùive
() {

133  
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
();

134 
	}
}

142 @
Suµ»ssW¬nšgs
({"checkstyle:methodname", "checkstyle:abbreviation"})

143 
public
 
	$TXEnd
(è
throws
 
T¿n§ùiÚAbÜ‹dExû±iÚ
 {

144 
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
 
cÚ‹xt
 = 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
();

145 ià(
cÚ‹xt
 =ğ
nuÎ
) {

146 
log
.
	`w¬n
("Attemptedoƒnd‡ransaction, but‚oransaction‡ctive!");

147  
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
.
UNCOMMITTED_ADDRESS
;

151 
tÙ®Time
 = 
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
cÚ‹xt
.
	`g‘S¹Time
();

152 
log
.
	`Œaû
("TXEnd[{}]ime={} ms", 
cÚ‹xt
, 
tÙ®Time
);

155 ià(
cÚ‹xt
.
	`g‘TxOpDu¿tiÚCÚ‹xt
(è!ğ
nuÎ
) {

156 
cÚ‹xt
.
	`g‘TxOpDu¿tiÚCÚ‹xt
().
	`¡İ
();

160 
Tim”
 
txComm™Du¿tiÚTim”
 = 
cÚ‹xt
.
	`g‘M‘rics
().
	`tim”
(
TXN_COMMIT_TIMER_NAME
);

161 
	`Œy
 (
Tim”
.
CÚ‹xt
 
txComm™Du¿tiÚ
 =

162 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
txComm™Du¿tiÚTim”
)){

163  
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`comm™T¿n§ùiÚ
();

164 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

165 
log
.
	`w¬n
("TXEnd[{}] AbÜ‹d Exû±iÚ {}", 
cÚ‹xt
, 
e
);

166 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`abÜtT¿n§ùiÚ
(
e
);

167 
throw
 
e
;

168 } 
	`ÿtch
 (
N‘wÜkExû±iÚ
 | 
Wr™eSizeExû±iÚ
 | 
QuÙaExûededExû±iÚ
 
e
) {

170 
Tok’
 
¢­shÙTime¡amp
;

171 
Œy
 {

172 
¢­shÙTime¡amp
 = 
cÚ‹xt
.
	`g‘SÇpshÙTime¡amp
();

173 } 
	`ÿtch
 (
N‘wÜkExû±iÚ
 
Ã
) {

174 
¢­shÙTime¡amp
 = 
Tok’
.
UNINITIALIZED
;

176 
TxResŞutiÚInfo
 
txInfo
 = 
Ãw
 
	`TxResŞutiÚInfo
(
cÚ‹xt
.
	`g‘T¿n§ùiÚID
(),

177 
¢­shÙTime¡amp
);

179 
AbÜtCau£
 
ÿu£
 = AbÜtCau£.
UNDEFINED
;

180 ià(
e
 
š¡ªûof
 
N‘wÜkExû±iÚ
) {

181 
log
.
	`w¬n
("TXEnd[{}] N‘wÜk Exû±iÚ {}", 
cÚ‹xt
, 
e
);

182 
ÿu£
 = 
AbÜtCau£
.
NETWORK
;

183 } ià(
e
 
š¡ªûof
 
Wr™eSizeExû±iÚ
) {

184 
log
.
	`”rÜ
("TXEnd[{}]¿n§ùiÚ sizlim™ƒxûeded {}", 
cÚ‹xt
, 
e
);

185 
ÿu£
 = 
AbÜtCau£
.
SIZE_EXCEEDED
;

186 } ià(
e
 
š¡ªûof
 
QuÙaExûededExû±iÚ
){

187 
log
.
	`”rÜ
("TXEnd[{}] s”v” quÙ¨exûeded {}", 
cÚ‹xt
, 
e
);

188 
ÿu£
 = 
AbÜtCau£
.
QUOTA_EXCEEDED
;

191 
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
 = 
Ãw
 
	`T¿n§ùiÚAbÜ‹dExû±iÚ
(

192 
txInfo
, 
ÿu£
, 
e
, 
cÚ‹xt
);

193 
cÚ‹xt
.
	`abÜtT¿n§ùiÚ
(
e
);

194 
throw
 
e
;

196 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

197 
log
.
	`”rÜ
("TXEnd[{}]: UÃx³ùedƒxû±iÚ", 
cÚ‹xt
, 
e
);

198 
TxResŞutiÚInfo
 
txInfo
 = 
Ãw
 
	`TxResŞutiÚInfo
(
cÚ‹xt
.
	`g‘T¿n§ùiÚID
(),

199 
Tok’
.
UNINITIALIZED
);

200 
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
 = 
Ãw
 
	`T¿n§ùiÚAbÜ‹dExû±iÚ
(

201 
txInfo
, 
AbÜtCau£
.
UNDEFINED
, 
e
, 
cÚ‹xt
);

202 
cÚ‹xt
.
	`abÜtT¿n§ùiÚ
(
e
);

203 
throw
 
Ãw
 
	`UÄecov”abËCÜfuE¼Ü
("UÃx³ùedƒxû±iÚ duršg comm™", 
e
);

204 } 
fš®ly
 {

205 
T¿n§ùiÚ®CÚ‹xt
.
	`»moveCÚ‹xt
();

207 
	}
}

213 
public
 
	$gc
(
ŒimM¬k
) {

214 
Objeù
 
obj
 : 
	`g‘ObjeùCache
().
	`v®ues
()) {

215 ((
CÜfuCompeProxy
è((
ICÜfuSMR
è
obj
).

216 
	`g‘CÜfuSMRProxy
()).
	`g‘Und”lyšgObjeù
().
	`gc
(
ŒimM¬k
);

218 
	}
}

220 @
	gD©a


221 @
Suµ»ssW¬nšgs
({"checkstyle:abbreviation"})

222 
public
 
şass
 
	gObjeùID
<
	gT
> {

223 
fš®
 
UUID
 
	g¡»amID
;

224 
fš®
 
	gCÏss
<
	gT
> 
	gty³
;

226 
public
 
SŒšg
 
toSŒšg
() {

227  "[" + 
	g¡»amID
 + ", " + 
	gty³
.
g‘Sim¶eName
() + "]";

	@runtime/src/main/java/org/corfudb/runtime/view/OrderedGuidGenerator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

11 
public
 
š‹rçû
 
	gOrd”edGuidG’”©Ü
 {

15 
ÃxtLÚg
();

20 
UUID
 
ÃxtUUID
();

	@runtime/src/main/java/org/corfudb/runtime/view/QuorumFuturesFactory.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gHashMuÉi£t
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

10 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gMuÉi£t
;

11 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gT»eMuÉim­
;

13 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

22 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

30 @
Slf4j


31 
public
 cÏs 
	cQuÜumFutu»sFaùÜy
 {

49 <
	mR
> 
	mCompos™eFutu»
<R> 
g‘QuÜumFutu»
(
Com·¿tÜ
<
R
> 
com·¿tÜ
,

50 
Com¶‘abËFutu»
<
R
>... 
futu»s
) {

51  
Ãw
 
	mCompos™eFutu»
<
	mR
>(
	mcom·¿tÜ
, (
	mfutu»s
.
	mËngth
 / 2) + 1, futures);

75 
public
 <
	gR
> 
	gCompos™eFutu»
<R> 
g‘QuÜumFutu»
(
Com·¿tÜ
<
R
> 
com·¿tÜ
,

76 
Com¶‘abËFutu»
<
R
>[] 
futu»s
,

77 
CÏss
... 
çFa¡ThrowabËs
) {

78  
Ãw
 
Compos™eFutu»
(
com·¿tÜ
, (
futu»s
.
Ëngth
 / 2) + 1, futures,

79 
çFa¡ThrowabËs
);

99 <
	gR
> 
	gCompos™eFutu»
<R> 
g‘Fœ¡WšsFutu»
(
Com·¿tÜ
<
R
> 
com·¿tÜ
,

100 
Com¶‘abËFutu»
<
R
>... 
futu»s
) {

101  
Ãw
 
	gCompos™eFutu»
<
	gR
>(
	gcom·¿tÜ
, 1, 
	gfutu»s
);

106 
public
 
şass
 
	gCompos™eFutu»
<
	gR
> 
im¶em’ts
 
	gFutu»
<R> {

107 
´iv©e
 
fš®
 
	gCom·¿tÜ
<
	gR
> 
	gcom·¿tÜ
;

108 
´iv©e
 
fš®
 
	gquÜum
;

109 
´iv©e
 
fš®
 
	gCom¶‘abËFutu»
<
	gR
>[] 
	gfutu»s
;

110 
´iv©e
 
fš®
 
	gS‘
<
	gCÏss
> 
	gçFa¡ThrowabËs
;

111 
´iv©e
 
fš®
 
	gS‘
<
	gThrowabË
> 
	gthrowabËs
 = 
CÚcu¼’tHashM­
.
ÃwKeyS‘
();

112 
´iv©e
 vŞ©
boŞ—n
 
	gdÚe
 = 
çl£
;

113 
´iv©e
 vŞ©
boŞ—n
 
	gÿnûËd
 = 
çl£
;

114 
´iv©e
 vŞ©
boŞ—n
 
	gcÚæiù
 = 
çl£
;

116 
´iv©e
 
Compos™eFutu»
(
Com·¿tÜ
<
R
> 
com·¿tÜ
, 
quÜum
,

117 
Com¶‘abËFutu»
<
R
>[] 
futu»s
, 
CÏss
... 
çFa¡ThrowabËs
) {

118 
	gthis
.
	gçFa¡ThrowabËs
 = 
ImmubËS‘
.
cİyOf
(
çFa¡ThrowabËs
);

119 
	gthis
.
	gcom·¿tÜ
 = 
com·¿tÜ
;

120 
	gthis
.
	gquÜum
 = 
quÜum
;

121 
	gthis
.
	gfutu»s
 = 
futu»s
;

124 @
Ov”ride


125 
public
 
R
 
g‘
(
timeout
, 
TimeUn™
 
un™
è
throws
 
	gIÁ”ru±edExû±iÚ
, 
	gExecutiÚExû±iÚ
,

126 
	gTimeoutExû±iÚ
 {

128 
	gCom·¿tÜ
<
	gIÁeg”
> 
	gic
 = 
IÁeg”
::
com·»To
;

129 
	gT»eMuÉim­
<
	gIÁeg”
, 
	gR
> 
	gv®uesSÜ‹dByCouÁ
 = 
T»eMuÉim­
.
ü—‹
(
ic
.
»v”£d
(),

130 
com·¿tÜ
);

131 
	gT»eMuÉim­
<
	gR
, 
	gIÁeg”
> 
	gšdexesByV®ue
 = 
T»eMuÉim­
.
ü—‹
(
com·¿tÜ
, 
ic
);

133 
	guÁ
 = 0;

134 
boŞ—n
 
	gšfš™e
 = (
timeout
 =ğ
LÚg
.
MAX_VALUE
);

135 ià(!
	gšfš™e
) {

136 
	guÁ
 = 
Sy¡em
.
ÇnoTime
(è+ 
un™
.
toNªos
(
timeout
);

138 
	gšfš™e
 || 
	gSy¡em
.
ÇnoTime
(è< 
	guÁ
) {

139 
	gnumIncom¶‘eFutu»s
 = 0;

140 
Com¶‘abËFutu»
 
	gagg»g©edFutu»
 = 
nuÎ
;

141 
	gi
 = 0; i < 
	gfutu»s
.
	gËngth
; i++) {

142 
	gCom¶‘abËFutu»
<
	gR
> 
	gc
 = 
futu»s
[
i
];

143 ià(!
	gc
.
isDÚe
()) {

144 
	gnumIncom¶‘eFutu»s
++;

145 ià(
	gagg»g©edFutu»
 =ğ
nuÎ
) {

146 
agg»g©edFutu»
 = 
c
;

148 
	gagg»g©edFutu»
 = 
Com¶‘abËFutu»
.
ªyOf
(
agg»g©edFutu»
, 
c
);

151 ià(!
	gc
.
isCªûÎed
()) {

152 ià(
	gc
.
isCom¶‘edExû±iÚ®ly
()) {

153 
	gŒy
 {

154 
	gfutu»s
[
i
].
g‘
();

155 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

156 
ThrowabË
 
	gt
 = 
e
.
g‘Cau£
();

157 
	gthrowabËs
.
add
(
t
);

158 ià(
	gçFa¡ThrowabËs
.
cÚšs
(
t
.
g‘CÏss
())) {

159 
	gdÚe
 = 
ÿnûËd
 = 
Œue
;

160 
throw
 
	ge
;

164 
R
 
	gv®ue
 = 
c
.
g‘
();

165 
	gS‘
<
	gIÁeg”
> 
	gšdexes
 = 
šdexesByV®ue
.
g‘
(
v®ue
);

166 ià(!
	gšdexes
.
cÚšs
(
i
)) {

167 
	gv®uesSÜ‹dByCouÁ
.
»move
(
šdexes
.
size
(), 
v®ue
);

168 
	gšdexes
.
add
(
i
);

169 
	gv®uesSÜ‹dByCouÁ
.
put
(
šdexes
.
size
(), 
v®ue
);

171 ià(
	gšdexesByV®ue
.
keyS‘
().
size
() > 1) {

172 
	gcÚæiù
 = 
Œue
;

179 
	gg»©e¡NumCom¶‘eFutu»s
 = 
v®uesSÜ‹dByCouÁ
.
size
() == 0 ? 0 :

180 
v®uesSÜ‹dByCouÁ
.
keyS‘
().
™”©Ü
().
Ãxt
();

181 ià(
	gg»©e¡NumCom¶‘eFutu»s
 >ğ
quÜum
) {

182 
dÚe
 = 
Œue
;

183  
	gv®uesSÜ‹dByCouÁ
.
’Œ›s
().
™”©Ü
().
Ãxt
().
g‘V®ue
();

185 
boŞ—n
 
	gnoMÜeHİe
 = 
numIncom¶‘eFutu»s
 + 
g»©e¡NumCom¶‘eFutu»s
 < 
quÜum
;

186 ià(
	gnoMÜeHİe
) {

187 
	gdÚe
 = 
ÿnûËd
 = 
Œue
;

189 
	gMuÉi£t
<
	gThrowabË
> 
	gexû±iÚCouÁ”
 = 
HashMuÉi£t
.
ü—‹
();

190 
ThrowabË
 
	gt
: 
g‘ThrowabËs
()) {

191 
log
.
debug
("QuÜumG‘: Exû±iÚ {}", 
t
.
g‘CÏss
().
g‘Sim¶eName
());

192 
	gexû±iÚCouÁ”
.
add
(
t
);

195 
ThrowabË
 
	gt
 : 
exû±iÚCouÁ”
.
–em’tS‘
()) {

196 ià(
exû±iÚCouÁ”
.
couÁ
(
t
è>ğ
quÜum
) {

197 
throw
 
Ãw
 
ExecutiÚExû±iÚ
(
t
);

200 
throw
 
Ãw
 
ExecutiÚExû±iÚ
(

201 
Ãw
 
QuÜumUÄ—chabËExû±iÚ
(
g»©e¡NumCom¶‘eFutu»s
, 
quÜum
));

203 
	gŒy
 {

204 ià(
	gšfš™e
) {

205 
	gagg»g©edFutu»
.
g‘
();

207 
	gagg»g©edFutu»
.
g‘
(
timeout
, 
un™
);

209 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
t
) {

214 
throw
 
Ãw
 
TimeoutExû±iÚ
();

218 @
Ov”ride


219 
public
 
R
 
g‘
(è
throws
 
	gIÁ”ru±edExû±iÚ
, 
	gExecutiÚExû±iÚ
 {

220 
	gŒy
 {

221  
g‘
(
LÚg
.
MAX_VALUE
, 
nuÎ
);

222 } 
ÿtch
 (
TimeoutExû±iÚ
 
e
) {

223 
	glog
.
”rÜ
(
e
.
g‘Mes§ge
(),ƒ);

224  
	gnuÎ
;

228 @
Ov”ride


229 
public
 
boŞ—n
 
ÿnûl
(boŞ—À
mayIÁ”ru±IfRuÂšg
) {

230 
Com¶‘abËFutu»
 
	gf
 : 
futu»s
) {

231 
f
.
ÿnûl
(
mayIÁ”ru±IfRuÂšg
);

233 
	gdÚe
 = 
ÿnûËd
 = 
Œue
;

234  
	gÿnûËd
;

242 @
Ov”ride


243 
public
 
boŞ—n
 
isCªûÎed
() {

244  
	gÿnûËd
;

247 @
Ov”ride


248 
public
 
boŞ—n
 
isDÚe
() {

249  
	gdÚe
;

255 
public
 
boŞ—n
 
isCÚæiù
() {

256  
	gcÚæiù
;

265 
public
 
	gS‘
<
	gThrowabË
> 
g‘ThrowabËs
() {

266  
	gImmubËS‘
.
cİyOf
(
throwabËs
);

275 
public
 
boŞ—n
 
cÚšsThrowabËFrom
(
CÏss
<? 
ex‹nds
 
ThrowabË
> 
check
) {

276 
ThrowabË
 
	gt
: 
throwabËs
) {

277 ià(
t
.
g‘CÏss
().
isAssigÇbËFrom
(
check
)) {

278  
Œue
;

281  
	gçl£
;

	@runtime/src/main/java/org/corfudb/runtime/view/ReadOptions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

15 @
Bud”
(
toBud”
=
Œue
)

16 @
D©a


17 
public
 cÏs 
	cR—dO±iÚs
 {

21 @
G‘‹r


22 @
Bud”
.
DeçuÉ


23 
fš®
 
boŞ—n
 
ignÜeTrim
 = 
çl£
;

28 @
	mG‘‹r


29 @
	mBud”
.
DeçuÉ


30 
´iv©e
 
fš®
 
boŞ—n
 
	mwa™FÜHŞe
 = 
Œue
;

35 @
	mG‘‹r


36 @
	mBud”
.
DeçuÉ


37 
´iv©e
 
fš®
 
boŞ—n
 
	mş›ÁCach—bË
 = 
Œue
;

42 @
	mG‘‹r


43 @
	mBud”
.
DeçuÉ


44 
´iv©e
 
fš®
 
boŞ—n
 
	m£rv”Cach—bË
 = 
Œue
;

	@runtime/src/main/java/org/corfudb/runtime/view/RuntimeLayout.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£Cl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutCl›Á
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gSequ’ûrCl›Á
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gLayoutSegm’t
;

19 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

20 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gCÚ¡ruùÜ
;

21 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

31 @
	gSlf4j


32 @
D©a


33 
public
 cÏs 
	cRuÁimeLayout
 {

35 @
G‘‹r


36 
´iv©e
 
fš®
 
Layout
 
	mÏyout
;

41 @
G‘‹r


42 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

47 
public
 
RuÁimeLayout
(@
NÚnuÎ
 
Layout
 
Ïyout
, @NÚnuÎ 
CÜfuRuÁime
 
cÜfuRuÁime
) {

48 
	mthis
.
	mÏyout
 = 
Ïyout
;

49 
	mthis
.
	mruÁime
 = 
cÜfuRuÁime
;

62 
public
 
	$£®MšS”v”S‘
()

63 
throws
 
WrÚgEpochExû±iÚ
, 
QuÜumUÄ—chabËExû±iÚ
 {

64 
log
.
	`debug
("Reque¡ed movoà£rv” tØÃwƒpoch {} s”v” ¬{}", 
Ïyout
.
	`g‘Epoch
(),

65 
Ïyout
.
	`g‘AÎS”v”s
());

68 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>> 
»suÉM­
 = 
S—lS”v”sH–³r
.
	`asyncS—lS”v”s
(
this
);

71 
S—lS”v”sH–³r
.
	`wa™FÜLayoutS—l
(
Ïyout
.
	`g‘LayoutS”v”s
(), 
»suÉM­
);

74 
LayoutSegm’t
 
ÏyoutSegm’t
 : 
Ïyout
.
	`g‘Segm’ts
()) {

75 
ÏyoutSegm’t
.
	`g‘R•liÿtiÚMode
().
	`v®id©eSegm’tS—l
ÖayoutSegm’t, 
»suÉM­
);

78 
log
.
	`debug
("Layout has been sealed successfully.");

79 
	}
}

88 
´iv©e
 
fš®
 
	gM­
<
	gCÏss
<? 
ex‹nds
 
	gICl›Á
>,

89 
	gM­
<
	gSŒšg
, 
	gICl›Á
>> 
	g£nd”Cl›ÁM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

101 
´iv©e
 
ICl›Á
 
g‘Cl›Á
(
fš®
 
CÏss
<? 
ex‹nds
 ICl›Á> 
ş›ÁCÏss
,

102 
fš®
 
SŒšg
 
’dpošt
) {

103  
	g£nd”Cl›ÁM­
.
compu‹
(
ş›ÁCÏss
, (
£nd”CÏss
, 
¡ršgEÁryM­
) -> {

104 
M­
<
SŒšg
, 
ICl›Á
> 
’dpoštCl›ÁM­
 = 
¡ršgEÁryM­
;

105 ià(
’dpoštCl›ÁM­
 =ğ
nuÎ
) {

106 
’dpoštCl›ÁM­
 = 
Ãw
 
HashM­
<>();

109 
’dpoštCl›ÁM­
.
compu‹IfAb£Á
(
’dpošt
, 
s
 -> {

110 
Œy
 {

111 
CÚ¡ruùÜ
<? 
ex‹nds
 
ICl›Á
> 
ùÜ
 =

112 
ş›ÁCÏss
.
g‘Deş¬edCÚ¡ruùÜ
(
ICl›ÁRou‹r
.
şass
, .class);

113 
ICl›Á
 
š¡
 = 
ùÜ
.
ÃwIn¡ªû
(
g‘RuÁime
().
g‘Rou‹r
(
’dpošt
), 
Ïyout
.
g‘Epoch
());

114 
š¡
.
£tPriÜ™yLev–
(
g‘RuÁime
().
g‘P¬am‘”s
().
g‘PriÜ™yLev–
());

115  
š¡
;

116 } 
ÿtch
 (
NoSuchM‘hodExû±iÚ
 | 
IÎeg®AcûssExû±iÚ
 | 
In¡ªtŸtiÚExû±iÚ


117 | 
InvoÿtiÚT¬g‘Exû±iÚ
 
e
) {

118 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
e
);

121  
’dpoštCl›ÁM­
;

122 }).
g‘
(
’dpošt
);

125 
public
 
Ba£Cl›Á
 
	$g‘Ba£Cl›Á
(
SŒšg
 
’dpošt
) {

126  (
Ba£Cl›Á
è
	`g‘Cl›Á
(Ba£Cl›Á.
şass
, 
’dpošt
);

127 
	}
}

129 
public
 
LayoutCl›Á
 
	$g‘LayoutCl›Á
(
SŒšg
 
’dpošt
) {

130  (
LayoutCl›Á
è
	`g‘Cl›Á
(LayoutCl›Á.
şass
, 
’dpošt
);

131 
	}
}

133 
public
 
Sequ’ûrCl›Á
 
	$g‘Prim¬ySequ’ûrCl›Á
() {

134  
	`g‘Sequ’ûrCl›Á
(
Ïyout
.
	`g‘Sequ’ûrs
().
	`g‘
(0));

135 
	}
}

137 
public
 
Sequ’ûrCl›Á
 
	$g‘Sequ’ûrCl›Á
(
SŒšg
 
’dpošt
) {

138  (
Sequ’ûrCl›Á
è
	`g‘Cl›Á
(Sequ’ûrCl›Á.
şass
, 
’dpošt
);

139 
	}
}

141 
public
 
LogUn™Cl›Á
 
	$g‘LogUn™Cl›Á
(
add»ss
, 
šdex
) {

142  
	`g‘LogUn™Cl›Á
(
Ïyout
.
	`g‘SŒe
(
add»ss
).
	`g‘LogS”v”s
().
	`g‘
(
šdex
));

143 
	}
}

145 
public
 
LogUn™Cl›Á
 
	$g‘LogUn™Cl›Á
(
SŒšg
 
’dpošt
) {

146  ((
LogUn™Cl›Á
è
	`g‘Cl›Á
(LogUn™Cl›Á.
şass
, 
’dpošt
));

147 
	}
}

149 
public
 
Mªagem’tCl›Á
 
	$g‘Mªagem’tCl›Á
(
SŒšg
 
’dpošt
) {

150  (
Mªagem’tCl›Á
è
	`g‘Cl›Á
(Mªagem’tCl›Á.
şass
, 
’dpošt
);

151 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/SMRObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gBud”
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
.
	gNÚNuÎ
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuCompeProxy
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuCompeW¿µ”Bud”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

27 @
	gSlf4j


28 @
	gG‘‹r


29 @
Bud”
(
bud”CÏssName
 = "Builder")

30 @
AÎArgsCÚ¡ruùÜ


31 
public
 
şass
 
SMRObjeù
<
T
 
ex‹nds
 
ICÜfuSMR
<T>> {

33 @
NÚNuÎ


34 
´iv©e
 
fš®
 
CÜfuRuÁime
 
ruÁime
;

36 @
NÚNuÎ


37 
´iv©e
 
fš®
 
	gCÏss
<
	gT
> 
	gty³
;

39 @
	gNÚNuÎ


40 @
Suµ»ssW¬nšgs
("checkstyle:abbreviation")

41 
´iv©e
 
fš®
 
UUID
 
	g¡»amID
;

43 
´iv©e
 
fš®
 
SŒšg
 
	g¡»amName
;

45 @
NÚNuÎ


46 
´iv©e
 
fš®
 
IS”Ÿliz”
 
	g£rŸliz”
;

48 @
NÚNuÎ


49 
´iv©e
 
fš®
 
ObjeùO³nO±iÚ
 
	gİtiÚ
;

51 @
NÚNuÎ


52 
´iv©e
 
fš®
 
	gObjeù
[] 
	g¬gum’ts
;

55 
public
 
şass
 
	gBud”
<
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> {

57 
´iv©e
 
IS”Ÿliz”
 
	g£rŸliz”
 = 
S”Ÿliz”s
.
g‘DeçuÉS”Ÿliz”
();

58 
´iv©e
 
ObjeùO³nO±iÚ
 
	gİtiÚ
 = ObjeùO³nO±iÚ.
CACHE
;

59 
´iv©e
 
	gObjeù
[] 
	g¬gum’ts
 = 
Ãw
 
Objeù
[0];

60 @
G‘‹r


61 
´iv©e
 
	gCÏss
<
	gT
> 
	gty³
;

62 @
G‘‹r


63 
´iv©e
 
CÜfuRuÁime
 
	gruÁime
;

64 @
G‘‹r


65 
public
 
UUID
 
	g¡»amID
;

67 
´iv©e
 
v”ify
() {

68 ià(
	g¡»amName
 !ğ
nuÎ
 && !
UUID
.
ÇmeUUIDFromBy‹s
(
¡»amName
.
g‘By‹s
()).
equ®s
(
¡»amID
)) {

69 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Stream id must be derived from stream‚ame");

73 @
Suµ»ssW¬nšgs
("unchecked")

74 
	gpublic
 <
R
 
ex‹nds
 
	gICÜfuSMR
<
	gR
>> 
	gSMRObjeù
.
	gBud”
<R> 
£tTy³
(
CÏss
<R> 
ty³
) {

75 
	gthis
.
	gty³
 = (
CÏss
<
T
>è
ty³
;

76  (
	gSMRObjeù
.
	gBud”
<
	gR
>è
	gthis
;

79 @
Suµ»ssW¬nšgs
("unchecked")

80 
	gpublic
 <
R
 
ex‹nds
 
	gICÜfuSMR
<
	gR
>> 
	gSMRObjeù
.
	gBud”
<R> 
£tTy³Tok’
(
Ty³Tok’
<R> 
ty³Tok’
) {

81 
	gthis
.
	gty³
 = (
CÏss
<
T
>è
ty³Tok’
.
g‘RawTy³
();

82  (
	gSMRObjeù
.
	gBud”
<
	gR
>è
	gthis
;

85 
public
 
	gSMRObjeù
.
	gBud”
<
	gT
> 
£tArgum’ts
(
Objeù
 ... 
¬gum’ts
) {

86 
	gthis
.
	g¬gum’ts
 = 
¬gum’ts
;

87  
	gthis
;

90 
public
 
	gSMRObjeù
.
	gBud”
<
	gT
> 
£tSŒ—mName
(
SŒšg
 
¡»amName
) {

91 
	gthis
.
	g¡»amName
 = 
¡»amName
;

92  
	gthis
;

95 
public
 
	gSMRObjeù
.
	gBud”
<
	gT
> 
£tSŒ—mID
(
UUID
 
¡»amID
) {

96 
	gthis
.
	g¡»amID
 = 
¡»amID
;

97  
	gthis
;

100 
public
 
	gSMRObjeù
.
	gBud”
<
	gT
> 
£tS”Ÿliz”
(
IS”Ÿliz”
 
£rŸliz”
) {

101 
	gthis
.
	g£rŸliz”
 = 
£rŸliz”
;

102  
	gthis
;

105 
public
 
	gSMRObjeù
.
	gBud”
<
	gT
> 
addO³nO±iÚ
(
ObjeùO³nO±iÚ
 
İ’O±iÚ
) {

106 
	gthis
.
	gİtiÚ
 = 
İ’O±iÚ
;

107  
	gthis
;

111 
public
 
	gSMRObjeù
<
	gT
> 
bud
() {

112 ià(
	g¡»amID
 =ğ
nuÎ
 && 
¡»amName
 !=‚ull) {

113 
¡»amID
 = 
UUID
.
ÇmeUUIDFromBy‹s
(
¡»amName
.
g‘By‹s
());

115 
v”ify
();

116  
Ãw
 
	gSMRObjeù
<>(
	gruÁime
, 
	gty³
, 
	g¡»amID
, 
	g¡»amName
, 
	g£rŸliz”
, 
	gİtiÚ
, 
	g¬gum’ts
);

119 
public
 
T
 
İ’
() {

120 
fš®
 
	gSMRObjeù
<
	gT
> 
	gsmrObjeù
 = 
bud
();

122 
	gŒy
 {

123 
	glog
.
šfo
("ObjeùBud”: o³ÀCÜfu sŒ—m {} id {}", 
smrObjeù
.
g‘SŒ—mName
(),

124 
smrObjeù
.
g‘SŒ—mID
());

126 ià(
	gsmrObjeù
.
g‘O±iÚ
(è=ğ
ObjeùO³nO±iÚ
.
NO_CACHE
) {

127  
CÜfuCompeW¿µ”Bud”
.
g‘W¿µ”
(
smrObjeù
);

129 
	gObjeùsV›w
.
	gObjeùID
<
	gT
> 
	goid
 = 
Ãw
 
ObjeùsV›w
.
ObjeùID
(
¡»amID
, 
ty³
);

130  (
	gT
è
	gsmrObjeù
.
g‘RuÁime
().
g‘ObjeùsV›w
().
	gobjeùCache
.
compu‹IfAb£Á
(
oid
, 
x
 -> {

131 
Œy
 {

132 
T
 
»suÉ
 = 
CÜfuCompeW¿µ”Bud”
.
g‘W¿µ”
(
smrObjeù
);

136 
IS”Ÿliz”
 
objeùS”Ÿliz”
 = ((
CÜfuCompeProxy
è((
ICÜfuSMR
è
»suÉ
).

137 
g‘CÜfuSMRProxy
())

138 .
g‘S”Ÿliz”
();

140 ià(
smrObjeù
.
g‘S”Ÿliz”
(è!ğ
objeùS”Ÿliz”
) {

141 
log
.
w¬n
("open: Attempto open‡nƒxisting object with‡ different serializer {}. " +

143 
smrObjeù
.
g‘S”Ÿliz”
().
g‘CÏss
().
g‘Sim¶eName
(),

144 
oid
,

145 
objeùS”Ÿliz”
.
g‘CÏss
().
g‘Sim¶eName
());

147  
»suÉ
;

148 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

149 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
ex
);

155 } 
ÿtch
 (
Exû±iÚ
 
ex
) {

156 
	glog
.
”rÜ
("Runtime instrumentation‚o†onger supported‡nd‚o compiled class found"

157 + " fÜ {}", 
ty³
, 
ex
);

158 
throw
 
Ãw
 
UÄecov”abËCÜfuE¼Ü
(
ex
);

	@runtime/src/main/java/org/corfudb/runtime/view/SealServersHelper.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

4 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

5 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

12 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

23 @
Slf4j


24 
public
 cÏs 
	cS—lS”v”sH–³r
 {

34 
public
 
	mM­
<
	mSŒšg
, 
	mCom¶‘abËFutu»
<
	mBoŞ—n
>> 
	$asyncS—lS”v”s
(

35 
RuÁimeLayout
 
ruÁimeLayout
) {

36 
Layout
 
Ïyout
 = 
ruÁimeLayout
.
	`g‘Layout
();

37 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>> 
»suÉM­
 = 
Ãw
 
HashM­
<>();

39 
Ïyout
.
	`g‘AÎS”v”s
().
	`fÜEach
(
£rv”
 -> {

40 
Com¶‘abËFutu»
<
BoŞ—n
> 
cf
 =

41 
ruÁimeLayout
.
	`g‘Ba£Cl›Á
(
£rv”
).
	`£®RemÙeS”v”
(
Ïyout
.
	`g‘Epoch
());

42 
»suÉM­
.
	`put
(
£rv”
, 
cf
);

45  
»suÉM­
;

56 
public
 
	`wa™FÜLayoutS—l
(
Li¡
<
SŒšg
> 
ÏyoutS”v”s
, 
M­
<String,

57 
Com¶‘abËFutu»
<
BoŞ—n
>> 
com¶‘abËFutu»M­
)

58 
throws
 
QuÜumUÄ—chabËExû±iÚ
 {

59 
Com¶‘abËFutu»
<
BoŞ—n
>[] 
com¶‘abËFutu»s
 =

60 
	`f‹rFutu»M­AndG‘A¼ay
(
com¶‘abËFutu»M­
, 
ÏyoutS”v”s
::
cÚšs
);

61 
	`wa™FÜQuÜum
(
com¶‘abËFutu»s
);

62 
	}
}

72 
public
 
wa™FÜChašSegm’tS—l
(
Layout
.
LayoutSegm’t
 
ÏyoutSegm’t
, 
M­
<
SŒšg
,

73 
Com¶‘abËFutu»
<
BoŞ—n
>> 
com¶‘abËFutu»M­
)

74 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
 {

75 
	gLayout
.
LayoutSŒe
 
	gÏyoutSŒe
 : 
ÏyoutSegm’t
.
g‘SŒes
()) {

76 
Com¶‘abËFutu»
<
BoŞ—n
>[] 
com¶‘abËFutu»s
 =

77 
f‹rFutu»M­AndG‘A¼ay
(
com¶‘abËFutu»M­
, 
ÏyoutSŒe
.
g‘LogS”v”s
()::
cÚšs
);

78 
	gQuÜumFutu»sFaùÜy
.
	gCompos™eFutu»
<
	gBoŞ—n
> 
	gquÜumFutu»
 =

79 
QuÜumFutu»sFaùÜy
.
g‘Fœ¡WšsFutu»
(
BoŞ—n
::
com·»To
, 
com¶‘abËFutu»s
);

81 
boŞ—n
 
	gsucûss
 = 
çl£
;

82 
	gŒy
 {

83 
	gsucûss
 = 
CFUts
.
g‘Unš‹¼u±ibly
(
quÜumFutu»
,

84 
TimeoutExû±iÚ
.
şass
, 
QuÜumUÄ—chabËExû±iÚ
.class);

85 } 
ÿtch
 (
TimeoutExû±iÚ
 
e
) {

86 
	glog
.
”rÜ
("wa™FÜChašSegm’tS—l:imeout", 
e
);

89 ià(
	gsucûss
) {

90 
	glog
.
debug
("waitForChainSegmentSeal: Successfully waited‡t†east one " +

95 
	g»achabËS”v”s
 = (è
A¼ays
.
¡»am
(
com¶‘abËFutu»s
)

96 .
f‹r
(
boŞ—nCom¶‘abËFutu»
 ->

97 !
boŞ—nCom¶‘abËFutu»
.
isCom¶‘edExû±iÚ®ly
())

98 .
couÁ
();

99 
throw
 
Ãw
 
QuÜumUÄ—chabËExû±iÚ
(
»achabËS”v”s
, 
com¶‘abËFutu»s
.
Ëngth
);

111 
public
 
wa™FÜQuÜumSegm’tS—l
(
Layout
.
LayoutSegm’t
 
ÏyoutSegm’t
, 
M­
<
SŒšg
,

112 
Com¶‘abËFutu»
<
BoŞ—n
>> 
com¶‘abËFutu»M­
)

113 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
 {

114 
	gLayout
.
LayoutSŒe
 
	gÏyoutSŒe
 : 
ÏyoutSegm’t
.
g‘SŒes
()) {

115 
Com¶‘abËFutu»
<
BoŞ—n
>[] 
com¶‘abËFutu»s
 =

116 
f‹rFutu»M­AndG‘A¼ay
(
com¶‘abËFutu»M­
, 
ÏyoutSŒe
.
g‘LogS”v”s
()::
cÚšs
);

117 
wa™FÜQuÜum
(
com¶‘abËFutu»s
);

127 
public
 
wa™FÜQuÜum
(
Com¶‘abËFutu»
<
BoŞ—n
>[] 
com¶‘abËFutu»s
)

128 
throws
 
	gQuÜumUÄ—chabËExû±iÚ
 {

129 
BoŞ—n
 
	gsucûss
 = 
çl£
;

130 
	gQuÜumFutu»sFaùÜy
.
	gCompos™eFutu»
<
	gBoŞ—n
> 
	gquÜumFutu»
 =

131 
QuÜumFutu»sFaùÜy
.
g‘QuÜumFutu»
(
BoŞ—n
::
com·»To
, 
com¶‘abËFutu»s
);

132 
	gŒy
 {

133 
	gsucûss
 = 
quÜumFutu»
.
g‘
();

134 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

135 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
("S—lšg iÁ”ru±ed", 
›
);

136 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

137 ià(
	ge
.
g‘Cau£
(è
š¡ªûof
 
	gQuÜumUÄ—chabËExû±iÚ
) {

138 
throw
 (
QuÜumUÄ—chabËExû±iÚ
è
	ge
.
g‘Cau£
();

142 ià(
	gsucûss
) {

143 
	glog
.
debug
("Successfully waited for quorum");

147 
	g»achabËS”v”s
 = (è
A¼ays
.
¡»am
(
com¶‘abËFutu»s
)

148 .
f‹r
(
boŞ—nCom¶‘abËFutu»
 ->

149 !
boŞ—nCom¶‘abËFutu»
.
isCom¶‘edExû±iÚ®ly
())

150 .
couÁ
();

151 
throw
 
Ãw
 
QuÜumUÄ—chabËExû±iÚ
(
»achabËS”v”s
, 
com¶‘abËFutu»s
.
Ëngth
);

154 @
Suµ»ssW¬nšgs
("unchecked")

155 
´iv©e
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
>[] 
f‹rFutu»M­AndG‘A¼ay
(

156 
M­
<
SŒšg
, 
Com¶‘abËFutu»
<
BoŞ—n
>> 
com¶‘abËFutu»M­
,

157 
P»diÿ‹
<
SŒšg
> 
f‹rP»diÿ‹
) {

158  
	gcom¶‘abËFutu»M­
.
’ŒyS‘
().
¡»am
()

159 .
f‹r
(
·œ
 -> 
f‹rP»diÿ‹
.
‹¡
Õaœ.
g‘Key
()))

160 .
m­
(
M­
.
EÁry
::
g‘V®ue
)

161 .
toA¼ay
(
Com¶‘abËFutu»
[]::
Ãw
);

	@runtime/src/main/java/org/corfudb/runtime/view/SequencerView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gLi¡s
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—mAdd»ssRªge
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

16 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

17 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

21 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

27 
public
 cÏs 
	cSequ’ûrV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

30 
´iv©e
 
Tim”
 
	m£qu’ûrNextOÃSŒ—m
;

31 
´iv©e
 
Tim”
 
	m£qu’ûrQu”y
;

32 
´iv©e
 
Tim”
 
	m£qu’ûrNextMuÉËSŒ—m
;

33 
´iv©e
 
Tim”
 
	m£qu’ûrD•»ÿ‹dNextOÃSŒ—m
;

34 
´iv©e
 
Tim”
 
	m£qu’ûrD•»ÿ‹dNextMuÉËSŒ—m
;

35 
´iv©e
 
Tim”
 
	m£qu’ûrTrimCache
;

36 
´iv©e
 
fš®
 
M‘ricRegi¡ry
 
	mm‘ricRegi¡ry
 = 
CÜfuRuÁime
.
g‘DeçuÉM‘rics
();

38 
public
 
	$Sequ’ûrV›w
(
CÜfuRuÁime
 
ruÁime
) {

39 
	`su³r
(
ruÁime
);

42 
	`£tupTim”s
();

48 
´iv©e
 
	$£tupTim”s
() {

49 
£qu’ûrQu”y
 = 
m‘ricRegi¡ry
.
	`tim”
(
CÜfuCompÚ’t
.
CLIENT_SEQUENCER
 +

51 
£qu’ûrTrimCache
 = 
m‘ricRegi¡ry
.
	`tim”
(
CÜfuCompÚ’t
.
CLIENT_SEQUENCER
 +

53 
£qu’ûrNextOÃSŒ—m
 = 
m‘ricRegi¡ry
.
	`tim”
(
CÜfuCompÚ’t
.
CLIENT_SEQUENCER
 +

55 
£qu’ûrNextMuÉËSŒ—m
 = 
m‘ricRegi¡ry
.
	`tim”
(
CÜfuCompÚ’t
.
CLIENT_SEQUENCER
 +

57 
£qu’ûrD•»ÿ‹dNextOÃSŒ—m
 = 
m‘ricRegi¡ry
.
	`tim”
(
CÜfuCompÚ’t
.
CLIENT_SEQUENCER
 +

59 
£qu’ûrD•»ÿ‹dNextMuÉËSŒ—m
 = 
m‘ricRegi¡ry
.
	`tim”
(
CÜfuCompÚ’t
.
CLIENT_SEQUENCER
 +

61 
	}
}

70 
public
 
Tok’Re¥Ú£
 
	$qu”y
(
UUID
... 
¡»amIds
) {

71 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrQu”y
)){

72 ià(
¡»amIds
.
Ëngth
 == 0) {

73  
	`ÏyoutH–³r
(
e
 -> 
CFUts
.
	`g‘Unš‹¼u±ibly
Ó.
	`g‘Prim¬ySequ’ûrCl›Á
()

74 .
	`ÃxtTok’
(
CŞËùiÚs
.
	`em±yLi¡
(), 0)));

76  
	`ÏyoutH–³r
(
e
 -> 
CFUts
.
	`g‘Unš‹¼u±ibly
Ó.
	`g‘Prim¬ySequ’ûrCl›Á
()

77 .
	`ÃxtTok’
(
A¼ays
.
	`asLi¡
(
¡»amIds
), 0)));

80 
	}
}

88 
public
 
	$qu”y
(
UUID
 
¡»amId
) {

89 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrQu”y
)) {

90  
	`ÏyoutH–³r
(
e
 -> 
CFUts
.
	`g‘Unš‹¼u±ibly
Ó.
	`g‘Prim¬ySequ’ûrCl›Á
()

91 .
	`ÃxtTok’
(
A¼ays
.
	`asLi¡
(
¡»amId
), 0))).
	`g‘SŒ—mTa
(streamId);

93 
	}
}

101 
public
 
Tok’Re¥Ú£
 
	$Ãxt
(
UUID
 ... 
¡»amIds
) {

102 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrNextOÃSŒ—m
)) {

103  
	`ÏyoutH–³r
(
e
 -> 
CFUts
.
	`g‘Unš‹¼u±ibly
Ó.
	`g‘Prim¬ySequ’ûrCl›Á
()

104 .
	`ÃxtTok’
(
A¼ays
.
	`asLi¡
(
¡»amIds
), 1)));

106 
	}
}

114 
public
 
SŒ—mAdd»ssS·û
 
	$g‘SŒ—mAdd»ssS·û
(
SŒ—mAdd»ssRªge
 
¡»amsAdd»s£sRªge
) {

115  
	`g‘SŒ—msAdd»ssS·û
(
A¼ays
.
	`asLi¡
(
¡»amsAdd»s£sRªge
)).
	`g‘
(¡»amsAdd»s£sRªge.
	`g‘SŒ—mID
());

116 
	}
}

124 
public
 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
g‘SŒ—msAdd»ssS·û
(
Li¡
<
SŒ—mAdd»ssRªge
> 
¡»amsAdd»s£sRªge
) {

125 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrNextOÃSŒ—m
)) {

126 
SŒ—msAdd»ssRe¥Ú£
 
¡»amsAdd»ssRe¥Ú£
 = 
ÏyoutH–³r
(
e
 ->

127 
CFUts
.
g‘Unš‹¼u±ibly
(
e
.
g‘Prim¬ySequ’ûrCl›Á
()

128 .
g‘SŒ—msAdd»ssS·û
(
¡»amsAdd»s£sRªge
)));

129  
	g¡»amsAdd»ssRe¥Ú£
.
g‘Add»ssM­
();

141 
public
 
Tok’Re¥Ú£
 
	$Ãxt
(
TxResŞutiÚInfo
 
cÚæiùInfo
, 
UUID
 ... 
¡»amIds
) {

142 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrNextMuÉËSŒ—m
)) {

143  
	`ÏyoutH–³r
(
e
 -> 
CFUts
.
	`g‘Unš‹¼u±ibly
Ó.
	`g‘Prim¬ySequ’ûrCl›Á
()

144 .
	`ÃxtTok’
(
A¼ays
.
	`asLi¡
(
¡»amIds
), 1, 
cÚæiùInfo
)));

146 
	}
}

159 @
D•»ÿ‹d


160 
public
 
Tok’Re¥Ú£
 
ÃxtTok’
(
S‘
<
UUID
> 
¡»amIDs
, 
numTok’s
) {

161 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrD•»ÿ‹dNextOÃSŒ—m
)){

162  
ÏyoutH–³r
(
e
 -> 
CFUts
.
g‘Unš‹¼u±ibly
Ó.
g‘Prim¬ySequ’ûrCl›Á
()

163 .
ÃxtTok’
(
Li¡s
.
ÃwA¼ayLi¡
(
¡»amIDs
), 
numTok’s
)));

167 @
D•»ÿ‹d


168 
public
 
Tok’Re¥Ú£
 
ÃxtTok’
(
S‘
<
UUID
> 
¡»amIDs
, 
numTok’s
,

169 
TxResŞutiÚInfo
 
cÚæiùInfo
) {

170 
Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrD•»ÿ‹dNextMuÉËSŒ—m
)){

171  
ÏyoutH–³r
(
e
 -> 
CFUts
.
g‘Unš‹¼u±ibly
Ó.
g‘Prim¬ySequ’ûrCl›Á
()

172 .
ÃxtTok’
(
Li¡s
.
ÃwA¼ayLi¡
(
¡»amIDs
), 
numTok’s
, 
cÚæiùInfo
)));

176 
public
 
	$ŒimCache
(
add»ss
) {

177 
	`Œy
 (
Tim”
.
CÚ‹xt
 
cÚ‹xt
 = 
M‘ricsUts
.
	`g‘CÚd™iÚ®CÚ‹xt
(
£qu’ûrTrimCache
)){

178 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘Prim¬ySequ’ûrCl›Á
().
	`ŒimCache
(
add»ss
);

180 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/SnowflakeGuidGenerator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

4 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

12 
public
 cÏs 
	cSnowæakeGuidG’”©Ü
 
im¶em’ts
 
	mOrd”edGuidG’”©Ü
 {

13 
´iv©e
 
fš®
 
	mNODE_MAX_VAL
 = 1023;

14 
´iv©e
 
fš®
 
	mNODE_SHIFT_LONG
 = 10;

15 
´iv©e
 
fš®
 
	mNODE_SHIFT_UUID
 = 53;

16 
´iv©e
 
fš®
 
	mSEQ_MAX_VAL
 = 4095;

17 
´iv©e
 
fš®
 
	mSEQ_SHIFT
 = 12;

19 
´iv©e
 
fš®
 
	mnode
;

20 
´iv©e
 
fš®
 
AtomicIÁeg”
 
	m£qu’û
;

29 
public
 
	$SnowæakeGuidG’”©Ü
(
node
) {

30 
this
.
node
 = ()Òod& 
NODE_MAX_VAL
);

31 
£qu’û
 = 
Ãw
 
	`AtomicIÁeg”
(0);

42 @
Ov”ride


43 
public
 
	$ÃxtLÚg
() {

44 
cu¼’tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

45 
couÁ”
 = 
this
.
£qu’û
.
	`šüem’tAndG‘
(è& 
SEQ_MAX_VAL
;

46  
cu¼’tTime
 << 
NODE_SHIFT_LONG
 << 
SEQ_SHIFT


47 | 
node
 << 
SEQ_SHIFT


48 | 
couÁ”
;

49 
	}
}

59 @
Ov”ride


60 
public
 
UUID
 
	$ÃxtUUID
() {

61 
cu¼’tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

62 
couÁ”
 = 
this
.
£qu’û
.
	`šüem’tAndG‘
();

63 
couÁ”
 |ğ
node
 << 
NODE_SHIFT_UUID
;

64  
Ãw
 
	`UUID
(
cu¼’tTime
, 
couÁ”
);

65 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/StreamOptions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

11 @
Bud”


12 
public
 cÏs 
	cSŒ—mO±iÚs
 {

13 
public
 
SŒ—mO±iÚs
 
	mDEFAULT
 = SŒ—mO±iÚs.
bud”
()

14 .
ignÜeTrimmed
(
çl£
)

15 .
ÿcheEÁr›s
(
Œue
)

16 .
bud
();

21 @
	mG‘‹r


22 @
	mBud”
.
DeçuÉ


23 
´iv©e
 
fš®
 
boŞ—n
 
	mignÜeTrimmed
 = 
çl£
;

28 @
	mG‘‹r


29 @
	mBud”
.
DeçuÉ


30 
´iv©e
 
fš®
 
boŞ—n
 
	mÿcheEÁr›s
 = 
Œue
;

	@runtime/src/main/java/org/corfudb/runtime/view/StreamsView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTxResŞutiÚInfo
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAµ’dExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gSËTok’Exû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

20 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

21 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCİyOnWr™eA¼ayLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

31 @
Slf4j


32 
public
 cÏs 
	cSŒ—msV›w
 
ex‹nds
 
	mAb¡¿ùV›w
 {

38 
public
 
fš®
 
SŒšg
 
	mCHECKPOINT_SUFFIX
 = "_cp";

46 
´iv©e
 
	mLi¡
<
	mISŒ—mV›w
> 
	mİ’edSŒ—ms
 = 
Ãw
 
CİyOnWr™eA¼ayLi¡
<>();

48 
public
 
	$SŒ—msV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
) {

49 
	`su³r
(
ruÁime
);

58 
public
 
ISŒ—mV›w
 
	$g‘
(
UUID
 
¡»am
) {

59  
this
.
	`g‘
(
¡»am
, 
SŒ—mO±iÚs
.
DEFAULT
);

60 
	}
}

71 
public
 
ISŒ—mV›w
 
	$g‘Un§ã
(
UUID
 
¡»am
) {

72  
this
.
	`g‘Un§ã
(
¡»am
, 
SŒ—mO±iÚs
.
DEFAULT
);

73 
	}
}

82 
public
 
ISŒ—mV›w
 
	$g‘
(
UUID
 
¡»amId
, 
SŒ—mO±iÚs
 
İtiÚs
) {

83 
ISŒ—mV›w
 
¡»am
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘L©e¡Segm’t
()

84 .
	`g‘R•liÿtiÚMode
()

85 .
	`g‘SŒ—mV›w
(
ruÁime
, 
¡»amId
, 
İtiÚs
);

86 
İ’edSŒ—ms
.
	`add
(
¡»am
);

87  
¡»am
;

88 
	}
}

95 
public
 
ISŒ—mV›w
 
	$g‘Un§ã
(
UUID
 
¡»am
, 
SŒ—mO±iÚs
 
İtiÚs
) {

96  
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘L©e¡Segm’t
()

97 .
	`g‘R•liÿtiÚMode
().
	`g‘Un§ãSŒ—mV›w
(
ruÁime
, 
¡»am
, 
İtiÚs
);

98 
	}
}

103 
public
 
	$ş—r
() {

104 
İ’edSŒ—ms
.
	`ş—r
();

105 
	}
}

113 
public
 
	$gc
(
ŒimM¬k
) {

114 
ISŒ—mV›w
 
¡»amV›w
 : 
İ’edSŒ—ms
) {

115 
¡»amV›w
.
	`gc
(
ŒimM¬k
);

117 
	}
}

131 
public
 
­³nd
(@
NÚnuÎ
 
Objeù
 
objeù
, @
NuÎabË
 
TxResŞutiÚInfo
 
cÚæiùInfo
,

132 @
NÚnuÎ
 
CacheO±iÚ
 
ÿcheO±iÚ
, @NÚnuÎ 
UUID
... 
¡»amIDs
) {

134 
fš®
 
LogD©a
 
	gld
 = 
Ãw
 LogD©a(
D©aTy³
.
DATA
, 
objeù
, 
ruÁime
.
g‘P¬am‘”s
().
g‘CodecTy³
());

136 
	gld
.
checkMaxWr™eSize
(
ruÁime
.
g‘P¬am‘”s
().
g‘MaxWr™eSize
());

138 
Tok’Re¥Ú£
 
	gtok’Re¥Ú£
 = 
nuÎ
;

139 
	gx
 = 0; x < 
	gruÁime
.
g‘P¬am‘”s
().
g‘Wr™eR‘ry
(); x++) {

141 
	gtok’Re¥Ú£
 = 
cÚæiùInfo
 =ğ
nuÎ


142 ? 
ruÁime
.
g‘Sequ’ûrV›w
().
Ãxt
(
¡»amIDs
)

143 : 
ruÁime
.
g‘Sequ’ûrV›w
().
Ãxt
(
cÚæiùInfo
, 
¡»amIDs
);

146 
AbÜtCau£
 
	gabÜtCau£
 = 
nuÎ
;

147 
	gtok’Re¥Ú£
.
g‘Re¥Ty³
()) {

148 
	gTX_ABORT_CONFLICT
:

149 
abÜtCau£
 = 
AbÜtCau£
.
CONFLICT
;

151 
	gTX_ABORT_NEWSEQ
:

152 
abÜtCau£
 = 
AbÜtCau£
.
NEW_SEQUENCER
;

154 
	gTX_ABORT_SEQ_OVERFLOW
:

155 
abÜtCau£
 = 
AbÜtCau£
.
SEQUENCER_OVERFLOW
;

157 
	gTX_ABORT_SEQ_TRIM
:

158 
abÜtCau£
 = 
AbÜtCau£
.
SEQUENCER_TRIM
;

162 ià(
	gabÜtCau£
 !ğ
nuÎ
) {

163 
throw
 
Ãw
 
T¿n§ùiÚAbÜ‹dExû±iÚ
(

164 
cÚæiùInfo
,

165 
tok’Re¥Ú£
.
g‘CÚæiùKey
(),ok’Re¥Ú£.
g‘CÚæiùSŒ—m
(),

166 
tok’Re¥Ú£
.
g‘Tok’
().
g‘Sequ’û
(), 
abÜtCau£
,

167 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
());

170 
	gŒy
 {

172 
	gruÁime
.
g‘Add»ssS·ûV›w
().
wr™e
(
tok’Re¥Ú£
, 
ld
, 
ÿcheO±iÚ
);

174  
	gtok’Re¥Ú£
.
g‘Sequ’û
();

175 } 
ÿtch
 (
Ov”wr™eExû±iÚ
 
Û
) {

177 
	glog
.
w¬n
("append[{}]: Overwritten‡fter {}„etries, streams {}",

178 
tok’Re¥Ú£
.
g‘Sequ’û
(), 
x
,

179 
A¼ays
.
¡»am
(
¡»amIDs
).
m­
(
Uts
::
toR—dabËId
).
cŞËù
(
CŞËùÜs
.
toS‘
()));

181 ià(
	gcÚæiùInfo
 !ğ
nuÎ
) {

184 
cÚæiùInfo
.
£tSÇpshÙTime¡amp
(
tok’Re¥Ú£
.
g‘Tok’
());

187 } 
ÿtch
 (
SËTok’Exû±iÚ
 
£
) {

189 
	glog
.
w¬n
("­³nd[{}]: SËTok’, sŒ—m {}", 
tok’Re¥Ú£
.
g‘Sequ’û
(),

190 
A¼ays
.
¡»am
(
¡»amIDs
).
m­
(
Uts
::
toR—dabËId
).
cŞËù
(
CŞËùÜs
.
toS‘
()));

192 
throw
 
Ãw
 
T¿n§ùiÚAbÜ‹dExû±iÚ
(

193 
cÚæiùInfo
,

194 
tok’Re¥Ú£
.
g‘CÚæiùKey
(),ok’Re¥Ú£.
g‘CÚæiùSŒ—m
(),

195 
tok’Re¥Ú£
.
g‘Tok’
().
g‘Sequ’û
(),

196 
AbÜtCau£
.
NEW_SEQUENCER
,

197 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
());

201 
	glog
.
”rÜ
("append[{}]: failed‡fter {}„etries, streams {}, write size {} bytes",

202 
tok’Re¥Ú£
 =ğ
nuÎ
 ? -1 :ok’Re¥Ú£.
g‘Sequ’û
(),

203 
ruÁime
.
g‘P¬am‘”s
().
g‘Wr™eR‘ry
(),

204 
A¼ays
.
¡»am
(
¡»amIDs
).
m­
(
Uts
::
toR—dabËId
).
cŞËù
(
CŞËùÜs
.
toS‘
()),

205 
ILogD©a
.
g‘S”ŸlizedSize
(
objeù
, 
ruÁime
.
g‘P¬am‘”s
().
g‘CodecTy³
()));

206 
throw
 
Ãw
 
Aµ’dExû±iÚ
();

214 
public
 
­³nd
(@
NÚnuÎ
 
Objeù
 
objeù
, @
NuÎabË
 
TxResŞutiÚInfo
 
cÚæiùInfo
,

215 @
NÚnuÎ
 
UUID
... 
¡»amIDs
) {

216  
­³nd
(
objeù
, 
cÚæiùInfo
, 
CacheO±iÚ
.
WRITE_THROUGH
, 
¡»amIDs
);

219 @
VisibËFÜTe¡šg


220 
	gLi¡
<
	gISŒ—mV›w
> 
	$g‘O³ÃdSŒ—ms
() {

221  
İ’edSŒ—ms
;

222 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/TableRegistry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gDesütÜ
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

8 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gDeque
;

11 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

19 
impÜt
 
	glombok
.
	gG‘‹r
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gP”si¡edSŒ—mšgM­
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­DecÜ©Ü
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabË
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuV”siÚPŞicy
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gPrÙobufS”Ÿliz”
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

35 
impÜt
 
	gÜg
.
	grocksdb
.
	gCom·ùiÚO±iÚsUniv”§l
;

36 
impÜt
 
	gÜg
.
	grocksdb
.
	gCom´essiÚTy³
;

37 
impÜt
 
	gÜg
.
	grocksdb
.
	gO±iÚs
;

39 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

40 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

52 
public
 cÏs 
	cTabËRegi¡ry
 {

59 
public
 
fš®
 
SŒšg
 
	mCORFU_SYSTEM_NAMESPACE
 = "CorfuSystem";

60 
public
 
fš®
 
SŒšg
 
	mREGISTRY_TABLE_NAME
 = "RegistryTable";

65 
´iv©e
 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

71 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mCÏss
<? 
ex‹nds
 
	mMes§ge
>> 
	mşassM­
;

76 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mTabË
<
	mMes§ge
, Mes§ge, Mes§ge>> 
	mbËM­
;

81 
´iv©e
 
fš®
 
IS”Ÿliz”
 
	m´ÙobufS”Ÿliz”
;

86 @
G‘‹r


87 
´iv©e
 
fš®
 
	mCÜfuTabË
<
	mTabËName
, 
	mCÜfuRecÜd
<
	mTabËDesütÜs
, 
	mMes§ge
>> 
	m»gi¡ryTabË
;

89 
public
 
	$TabËRegi¡ry
(
CÜfuRuÁime
 
ruÁime
) {

90 
this
.
ruÁime
 =„untime;

91 
this
.
şassM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

92 
this
.
bËM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

93 
this
.
´ÙobufS”Ÿliz”
 = 
Ãw
 
	`PrÙobufS”Ÿliz”
(
şassM­
);

94 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
this
.
´ÙobufS”Ÿliz”
);

95 
this
.
»gi¡ryTabË
 =his.
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

96 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
TabËName
, 
CÜfuRecÜd
<
TabËDesütÜs
, 
Mes§ge
>>>() {

98 .
	`£tSŒ—mName
(
	`g‘FuÎyQu®if›dTabËName
(
CORFU_SYSTEM_NAMESPACE
, 
REGISTRY_TABLE_NAME
))

99 .
	`£tS”Ÿliz”
(
this
.
´ÙobufS”Ÿliz”
)

100 .
	`İ’
();

103 
	`addTy³ToCÏssM­
(
TabËName
.
	`g‘DeçuÉIn¡ªû
());

104 
	`addTy³ToCÏssM­
(
TabËDesütÜs
.
	`g‘DeçuÉIn¡ªû
());

107 
Œy
 {

108 
	`»gi¡”TabË
(
CORFU_SYSTEM_NAMESPACE
,

109 
REGISTRY_TABLE_NAME
,

110 
TabËName
.
şass
,

111 
TabËDesütÜs
.
şass
,

112 
nuÎ
);

113 } 
	`ÿtch
 (
NoSuchM‘hodExû±iÚ
 | 
InvoÿtiÚT¬g‘Exû±iÚ
 | 
IÎeg®AcûssExû±iÚ
 
e
) {

114 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

133 
´iv©e
 <
K
 
ex‹nds
 
Mes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

134 
	`»gi¡”TabË
(@
NÚnuÎ
 
SŒšg
 
Çme¥aû
,

135 @
NÚnuÎ
 
SŒšg
 
bËName
,

136 @
NÚnuÎ
 
CÏss
<
K
> 
keyCÏss
,

137 @
NÚnuÎ
 
CÏss
<
V
> 
·ylßdCÏss
,

138 @
NuÎabË
 
CÏss
<
M
> 
m‘ad©aCÏss
)

139 
throws
 
NoSuchM‘hodExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
, 
IÎeg®AcûssExû±iÚ
 {

141 
TabËName
 
bËNameKey
 = TabËName.
	`ÃwBud”
()

142 .
	`£tName¥aû
(
Çme¥aû
)

143 .
	`£tTabËName
(
bËName
)

144 .
	`bud
();

146 
K
 
deçuÉKeyMes§ge
 = (Kè
keyCÏss
.
	`g‘M‘hod
("g‘DeçuÉIn¡ªû").
	`švoke
(
nuÎ
);

147 
V
 
deçuÉV®ueMes§ge
 = (Vè
·ylßdCÏss
.
	`g‘M‘hod
("g‘DeçuÉIn¡ªû").
	`švoke
(
nuÎ
);

149 
TabËDesütÜs
.
Bud”
 
bËDesütÜsBud”
 = TabËDesütÜs.
	`ÃwBud”
();

151 
FeDesütÜ
 
keyFeDesütÜ
 = 
deçuÉKeyMes§ge
.
	`g‘DesütÜFÜTy³
().
	`g‘Fe
();

152 
	`š£¹AÎD•’dšgFeDesütÜPrÙos
(
bËDesütÜsBud”
, 
keyFeDesütÜ
);

153 
FeDesütÜ
 
v®ueFeDesütÜ
 = 
deçuÉV®ueMes§ge
.
	`g‘DesütÜFÜTy³
().
	`g‘Fe
();

154 
	`š£¹AÎD•’dšgFeDesütÜPrÙos
(
bËDesütÜsBud”
, 
v®ueFeDesütÜ
);

156 ià(
m‘ad©aCÏss
 !ğ
nuÎ
) {

157 
M
 
deçuÉM‘ad©aMes§ge
 = (Mè
m‘ad©aCÏss
.
	`g‘M‘hod
("g‘DeçuÉIn¡ªû").
	`švoke
(
nuÎ
);

158 
FeDesütÜ
 
m‘aFeDesütÜ
 = 
deçuÉM‘ad©aMes§ge
.
	`g‘DesütÜFÜTy³
().
	`g‘Fe
();

159 
	`š£¹AÎD•’dšgFeDesütÜPrÙos
(
bËDesütÜsBud”
, 
m‘aFeDesütÜ
);

161 
TabËDesütÜs
 
bËDesütÜs
 = 
bËDesütÜsBud”
.
	`bud
();

163 
Œy
 {

164 
this
.
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
	`bud
().
	`begš
();

165 
this
.
»gi¡ryTabË
.
	`putIfAb£Á
(
bËNameKey
,

166 
Ãw
 
CÜfuRecÜd
<>(
bËDesütÜs
, 
nuÎ
));

167 } 
fš®ly
 {

168 
this
.
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

170 
	}
}

179 
´iv©e
 
	$š£¹AÎD•’dšgFeDesütÜPrÙos
(
TabËDesütÜs
.
Bud”
 
bËDesütÜsBud”
,

180 
FeDesütÜ
 
roÙFeDesütÜ
) {

181 
Deque
<
FeDesütÜ
> 
feDesütÜSck
 = 
Ãw
 
LškedLi¡
<>();

182 
feDesütÜSck
.
	`push
(
roÙFeDesütÜ
);

184 !
feDesütÜSck
.
	`isEm±y
()) {

185 
FeDesütÜ
 
feDesütÜ
 = 
feDesütÜSck
.
	`pİ
();

186 
FeDesütÜPrÙo
 
feDesütÜPrÙo
 = 
feDesütÜ
.
	`toPrÙo
();

189 ià(
bËDesütÜsBud”
.
	`g‘FeDesütÜsM­
().
	`cÚšsKey
(
feDesütÜPrÙo
.
	`g‘Name
())) {

194 
bËDesütÜsBud”
.
	`putFeDesütÜs
(
feDesütÜPrÙo
.
	`g‘Name
(), fileDescriptorProto);

197 
FeDesütÜ
 
d•’dšgFeDesütÜ
 : 
feDesütÜ
.
	`g‘D•’d’c›s
()) {

198 
FeDesütÜPrÙo
 
d•’dšgFeDesütÜPrÙo
 = 
d•’dšgFeDesütÜ
.
	`toPrÙo
();

199 ià(!
bËDesütÜsBud”
.
	`g‘FeDesütÜsM­
()

200 .
	`cÚšsKey
(
d•’dšgFeDesütÜPrÙo
.
	`g‘Name
())) {

202 
feDesütÜSck
.
	`push
(
d•’dšgFeDesütÜ
);

206 
	}
}

215 
public
 
SŒšg
 
	$g‘Ty³U¾
(
DesütÜ
 
desütÜ
) {

216  "ty³.googË­is.com/" + 
desütÜ
.
	`g‘FuÎName
();

217 
	}
}

226 
public
 
SŒšg
 
	$g‘FuÎyQu®if›dTabËName
(
SŒšg
 
Çme¥aû
, SŒšg 
bËName
) {

227  
Çme¥aû
 + "$" + 
bËName
;

228 
	}
}

236 
	g´iv©e
 <
T
 
ex‹nds
 
	gMes§ge
> 
	$addTy³ToCÏssM­
(
T
 
msg
) {

237 
SŒšg
 
ty³U¾
 = 
	`g‘Ty³U¾
(
msg
.
	`g‘DesütÜFÜTy³
());

239 ià(!
şassM­
.
	`cÚšsKey
(
ty³U¾
)) {

240 
şassM­
.
	`put
(
ty³U¾
, 
msg
.
	`g‘CÏss
());

242 
	}
}

261 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

262 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
İ’TabË
(@
NÚnuÎ
 
fš®
 
SŒšg
 
Çme¥aû
,

263 @
NÚnuÎ
 
fš®
 
SŒšg
 
bËName
,

264 @
NÚnuÎ
 
fš®
 
CÏss
<
K
> 
kCÏss
,

265 @
NÚnuÎ
 
fš®
 
CÏss
<
V
> 
vCÏss
,

266 @
NuÎabË
 
fš®
 
CÏss
<
M
> 
mCÏss
,

267 @
NÚnuÎ
 
fš®
 
TabËO±iÚs
<
K
, 
V
> 
bËO±iÚs
)

268 
throws
 
	gNoSuchM‘hodExû±iÚ
, 
	gInvoÿtiÚT¬g‘Exû±iÚ
, 
	gIÎeg®AcûssExû±iÚ
 {

271 
K
 
	gdeçuÉKeyMes§ge
 = (Kè
kCÏss
.
g‘M‘hod
("g‘DeçuÉIn¡ªû").
švoke
(
nuÎ
);

272 
addTy³ToCÏssM­
(
deçuÉKeyMes§ge
);

274 
V
 
	gdeçuÉV®ueMes§ge
 = (Vè
vCÏss
.
g‘M‘hod
("g‘DeçuÉIn¡ªû").
švoke
(
nuÎ
);

275 
addTy³ToCÏssM­
(
deçuÉV®ueMes§ge
);

277 
M
 
	gdeçuÉM‘ad©aMes§ge
 = 
nuÎ
;

278 ià(
	gmCÏss
 !ğ
nuÎ
) {

279 
deçuÉM‘ad©aMes§ge
 = (
M
è
mCÏss
.
g‘M‘hod
("g‘DeçuÉIn¡ªû").
švoke
(
nuÎ
);

280 
addTy³ToCÏssM­
(
deçuÉM‘ad©aMes§ge
);

283 
SŒšg
 
	gfuÎyQu®if›dTabËName
 = 
g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËName
);

284 
	gICÜfuV”siÚPŞicy
.
V”siÚPŞicy
 
	gv”siÚPŞicy
 = 
ICÜfuV”siÚPŞicy
.
DEFAULT
;

285 
	gSuµl›r
<
	gSŒ—mšgM­
<
	gK
, 
	gV
>> 
	gm­Suµl›r
 = (è-> 
Ãw
 
SŒ—mšgM­DecÜ©Ü
();

286 ià(
	gbËO±iÚs
.
g‘P”si¡’tD©aP©h
().
isP»£Á
()) {

287 
	gv”siÚPŞicy
 = 
ICÜfuV”siÚPŞicy
.
MONOTONIC
;

288 
	gm­Suµl›r
 = (è-> 
Ãw
 
P”si¡edSŒ—mšgM­
<>(

289 
bËO±iÚs
.
g‘P”si¡’tD©aP©h
().
g‘
(),

290 
	gP”si¡edSŒ—mšgM­
.
g‘P”si¡edSŒ—mšgM­O±iÚs
(),

291 
	g´ÙobufS”Ÿliz”
, 
	gthis
.
	gruÁime
);

295 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	gbË
 = 
Ãw
 
TabË
<>(

296 
Çme¥aû
,

297 
	gfuÎyQu®if›dTabËName
,

298 
	gdeçuÉV®ueMes§ge
,

299 
	gdeçuÉM‘ad©aMes§ge
,

300 
	gthis
.
	gruÁime
,

301 
	gthis
.
	g´ÙobufS”Ÿliz”
,

302 
	gm­Suµl›r
, 
	gv”siÚPŞicy
);

303 
	gbËM­
.
put
(
fuÎyQu®if›dTabËName
, (
TabË
<
Mes§ge
, Mes§ge, Mes§ge>è
bË
);

305 
»gi¡”TabË
(
Çme¥aû
, 
bËName
, 
kCÏss
, 
vCÏss
, 
mCÏss
);

306  
	gbË
;

320 
	gpublic
 <
K
 
ex‹nds
 
	gMes§ge
, 
V
ƒx‹nd Mes§ge, 
M
ƒxtends Message>

321 
	gTabË
<
	gK
, 
	gV
, 
	gM
> 
	$g‘TabË
(
SŒšg
 
Çme¥aû
, SŒšg 
bËName
) {

322 
SŒšg
 
fuÎyQu®if›dTabËName
 = 
	`g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËName
);

323 ià(!
bËM­
.
	`cÚšsKey
(
fuÎyQu®if›dTabËName
)) {

326 ià(
»gi¡ryTabË
.
	`cÚšsKey
(

327 
TabËName
.
	`ÃwBud”
()

328 .
	`£tName¥aû
(
Çme¥aû
)

329 .
	`£tTabËName
(
bËName
)

330 .
	`bud
())

334 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Please…rovide Key, Value & Metadata schemaso„e-open"

335 + "hi exi¡šgabË " + 
bËName
 + " iÀÇme¥aû " + 
Çme¥aû
);

338 
throw
 
Ãw
 
	`NoSuchEËm’tExû±iÚ
(

339 
SŒšg
.
	`fÜm©
("No suchable found:‚amespace: %s,ableName: %s",

340 
Çme¥aû
, 
bËName
));

343  (
TabË
<
K
, 
V
, 
M
>è
bËM­
.
	`g‘
(
fuÎyQu®if›dTabËName
);

344 
	}
}

352 
public
 
	$d–‘eTabË
(
SŒšg
 
Çme¥aû
, SŒšg 
bËName
) {

353 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("deleteTable unsupported for‚ow");

354 
	}
}

362 
public
 
	gCŞËùiÚ
<
	gTabËName
> 
li¡TabËs
(@
NuÎabË
 
fš®
 
SŒšg
 
Çme¥aû
) {

363  
	g»gi¡ryTabË
.
keyS‘
()

364 .
¡»am
()

365 .
f‹r
(
bËName
 -> 
Çme¥aû
 =ğ
nuÎ
 ||abËName.
g‘Name¥aû
().
equ®s
(namespace))

366 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

376 @
NuÎabË


377 
public
 
TabËDesütÜs
 
g‘TabËDesütÜ
(@
NÚnuÎ
 
TabËName
 
bËName
) {

378  
	gO±iÚ®
.
ofNuÎabË
(
this
.
»gi¡ryTabË
.
g‘
(
bËName
))

379 .
m­
(
CÜfuRecÜd
::
g‘Paylßd
)

380 .
ÜEl£
(
nuÎ
);

	@runtime/src/main/java/org/corfudb/runtime/view/replication/AbstractReplicationProtocol.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gHŞeFlRequœedExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

13 @
Slf4j


14 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùR•liÿtiÚPrÙocŞ
 
im¶em’ts
 
	mIR•liÿtiÚPrÙocŞ
 {

19 
´Ùeùed
 
fš®
 
IHŞeFlPŞicy
 
	mhŞeFlPŞicy
;

27 
public
 
	$Ab¡¿ùR•liÿtiÚPrÙocŞ
(
IHŞeFlPŞicy
 
hŞeFlPŞicy
) {

28 
this
.
hŞeFlPŞicy
 = holeFillPolicy;

39 @
NÚnuÎ


40 @
Ov”ride


41 
public
 
ILogD©a
 
	$»ad
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
) {

42 
Œy
 {

43  
hŞeFlPŞicy


44 .
	`³ekUÁHŞeFlRequœed
(
glob®Add»ss
,

45 
a
 -> 
	`³ek
(
ruÁimeLayout
,‡));

46 } 
	`ÿtch
 (
HŞeFlRequœedExû±iÚ
 
e
) {

47 
log
.
	`debug
("HŞeFl[{}] dutØ{}", 
glob®Add»ss
, 
e
.
	`g‘Mes§ge
());

48 
	`hŞeFl
(
ruÁimeLayout
, 
glob®Add»ss
);

49  
	`³ek
(
ruÁimeLayout
, 
glob®Add»ss
);

51 
	}
}

63 
´Ùeùed
 
ab¡¿ù
 
hŞeFl
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
);

	@runtime/src/main/java/org/corfudb/runtime/view/replication/AlwaysHoleFillPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

4 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gHŞeFlRequœedExû±iÚ
;

13 
public
 cÏs 
	cAlwaysHŞeFlPŞicy
 
im¶em’ts
 
	mIHŞeFlPŞicy
 {

18 @
	mNÚnuÎ


19 @
Ov”ride


20 
public
 
ILogD©a
 
³ekUÁHŞeFlRequœed
(
add»ss
,

21 
FunùiÚ
<
LÚg
, 
ILogD©a
> 
³ekFunùiÚ
è
throws
 
	mHŞeFlRequœedExû±iÚ
 {

22 
ILogD©a
 
	md©a
 = 
³ekFunùiÚ
.
­¶y
(
add»ss
);

23 ià(
	md©a
 =ğ
nuÎ
) {

24 
throw
 
Ãw
 
HŞeFlRequœedExû±iÚ
("No data‡t‡ddress");

26  
	md©a
;

	@runtime/src/main/java/org/corfudb/runtime/view/replication/ChainReplicationProtocol.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gRecov”yExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

14 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

15 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

16 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

21 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

26 @
Slf4j


27 
public
 cÏs 
	cChašR•liÿtiÚPrÙocŞ
 
ex‹nds
 
	mAb¡¿ùR•liÿtiÚPrÙocŞ
 {

29 
public
 
	$ChašR•liÿtiÚPrÙocŞ
(
IHŞeFlPŞicy
 
hŞeFlPŞicy
) {

30 
	`su³r
(
hŞeFlPŞicy
);

36 @
Ov”ride


37 
public
 
	$wr™e
(
RuÁimeLayout
 
ruÁimeLayout
, 
ILogD©a
 
d©a
è
throws
 
Ov”wr™eExû±iÚ
 {

38 
fš®
 
glob®Add»ss
 = 
d©a
.
	`g‘Glob®Add»ss
();

39 
numUn™s
 = 
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Segm’tL’gth
(
glob®Add»ss
);

43 
	`Œy
 (
ILogD©a
.
S”Ÿliz©iÚHªdË
 
sh
 =

44 
d©a
.
	`g‘S”ŸlizedFÜm
()) {

45 
log
.
	`Œaû
("Wr™e[{}]: chaš h—d {}/{}", 
glob®Add»ss
, 1, 
numUn™s
);

47 
Œy
 {

48 
CFUts
.
	`g‘Unš‹¼u±ibly
(

49 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
glob®Add»ss
, 0)

50 .
	`wr™e
(
sh
.
	`g‘S”Ÿlized
()),

51 
Ov”wr™eExû±iÚ
.
şass
);

52 
	`´İag©e
(
ruÁimeLayout
, 
glob®Add»ss
, 
sh
.
	`g‘S”Ÿlized
());

53 } 
	`ÿtch
 (
Ov”wr™eExû±iÚ
 
Û
) {

57 
	`»cov”
(
ruÁimeLayout
, 
glob®Add»ss
);

58 
throw
 
Û
;

61 
	}
}

66 @
Ov”ride


67 
public
 
ILogD©a
 
	$³ek
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
) {

68 
numUn™s
 = 
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Segm’tL’gth
(
glob®Add»ss
);

69 
log
.
	`Œaû
("R—d[{}]: chaš {}/{}", 
glob®Add»ss
, 
numUn™s
,‚umUnits);

72 
ILogD©a
 
³ekResuÉ
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ruÁimeLayout


73 .
	`g‘LogUn™Cl›Á
(
glob®Add»ss
, 
numUn™s
 - 1)

74 .
	`»ad
(
glob®Add»ss
)).
	`g‘Add»s£s
().
	`g‘
(globalAddress);

76  
³ekResuÉ
.
	`isEm±y
(è? 
nuÎ
 :…eekResult;

77 
	}
}

96 @
	gOv”ride


97 @
NÚnuÎ


98 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
»adAÎ
(
RuÁimeLayout
 
ruÁimeLayout
,

99 
Li¡
<
LÚg
> 
add»s£s
,

100 
boŞ—n
 
wa™FÜWr™e
,

101 
boŞ—n
 
ÿcheOnS”v”
) {

104 
	gM­
<
	gSŒšg
, 
	gLi¡
<
	gLÚg
>> 
	g£rv”Add»ssM­
 = 
Ãw
 
HashM­
<>();

106 
LÚg
 
	gadd»ss
 : 
add»s£s
) {

107 
Li¡
<
SŒšg
> 
logS”v”s
 = 
ruÁimeLayout
.
g‘Layout
().
g‘SŒe
(
add»ss
).
g‘LogS”v”s
();

108 
SŒšg
 
	glogS”v”
 = 
logS”v”s
.
g‘
ÖogS”v”s.
size
() - 1);

109 
	gLi¡
<
	gLÚg
> 
	gadd»ssLi¡
 = 
£rv”Add»ssM­
.
compu‹IfAb£Á
(
logS”v”
, 
s
 -> 
Ãw
 
A¼ayLi¡
<>());

110 
	gadd»ssLi¡
.
add
(
add»ss
);

114 
	gLi¡
<
	gCom¶‘abËFutu»
<
	gR—dRe¥Ú£
>> 
	gfutu»s
 = 
£rv”Add»ssM­
.
’ŒyS‘
().
¡»am
()

115 .
m­
(
’Œy
 -> 
ruÁimeLayout
.
g‘LogUn™Cl›Á
ÓÁry.
g‘Key
())

116 .
»adAÎ
(
’Œy
.
g‘V®ue
(), 
ÿcheOnS”v”
))

117 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

120 
	gM­
<
	gLÚg
, 
	gLogD©a
> 
	g»adResuÉ
 = 
futu»s
.
¡»am
()

121 .
m­
(
futu»
 -> 
CFUts
.
g‘Unš‹¼u±ibly
(futu»).
g‘Add»s£s
())

122 .
»duû
(
Ãw
 
HashM­
<>(), (
m­1
, 
m­2
) -> {

123 
m­1
.
putAÎ
(
m­2
);

124  
m­1
;

127  
wa™OrHŞeFl
(
ruÁimeLayout
, 
»adResuÉ
, 
wa™FÜWr™e
);

130 
´iv©e
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
wa™OrHŞeFl
(
RuÁimeLayout
 
ruÁimeLayout
,

131 
M­
<
LÚg
, 
LogD©a
> 
»adResuÉ
,

132 
boŞ—n
 
wa™FÜWr™e
) {

133 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	g»tuºResuÉ
 = 
Ãw
 
HashM­
<>(
»adResuÉ
);

136 ià(!
	gwa™FÜWr™e
) {

137 
	g»adResuÉ
.
fÜEach
((
add»ss
, 
v®ue
) -> {

138 ià(
v®ue
.
isEm±y
()) {

139 
hŞeFl
(
ruÁimeLayout
, 
add»ss
);

140 
»tuºResuÉ
.
put
(
add»ss
, 
³ek
(
ruÁimeLayout
,‡ddress));

143  
	g»tuºResuÉ
;

149 
boŞ—n
 
	gwa™
 = 
Œue
;

150 
	gM­
.
	gEÁry
<
	gLÚg
, 
	gLogD©a
> 
	g’Œy
 : 
»adResuÉ
.
’ŒyS‘
()) {

151 
add»ss
 = 
’Œy
.
g‘Key
();

152 
ILogD©a
 
	gv®ue
 = 
’Œy
.
g‘V®ue
();

153 ià(
	gv®ue
.
isEm±y
()) {

154 ià(
	gwa™
) {

155 
	gv®ue
 = 
»ad
(
ruÁimeLayout
, 
add»ss
);

158 
	gwa™
 = 
çl£
;

161 
	gv®ue
 = 
³ek
(
ruÁimeLayout
, 
add»ss
);

163 ià(
	gv®ue
 =ğ
nuÎ
) {

164 
hŞeFl
(
ruÁimeLayout
, 
add»ss
);

165 
	gv®ue
 = 
³ek
(
ruÁimeLayout
, 
add»ss
);

168 
	g»tuºResuÉ
.
put
(
add»ss
, 
v®ue
);

172  
	g»tuºResuÉ
;

185 
´iv©e
 
´İag©e
(
RuÁimeLayout
 
ruÁimeLayout
,

186 
glob®Add»ss
,

187 @
NuÎabË
 
ILogD©a
 
d©a
) {

188 
	gnumUn™s
 = 
ruÁimeLayout
.
g‘Layout
().
g‘Segm’tL’gth
(
glob®Add»ss
);

190 
	gi
 = 1; i < 
	gnumUn™s
; i++) {

191 
	glog
.
Œaû
("Prİag©e[{}]: chaš {}/{}", 
Tok’
.
of
(
ruÁimeLayout
.
g‘Layout
().
g‘Epoch
(),

192 
glob®Add»ss
),

193 
i
 + 1, 
numUn™s
);

196 
	gŒy
 {

197 ià(
	gd©a
 !ğ
nuÎ
) {

198 
CFUts
.
g‘Unš‹¼u±ibly
(

199 
ruÁimeLayout
.
g‘LogUn™Cl›Á
(
glob®Add»ss
, 
i
)

200 .
wr™e
(
d©a
),

201 
Ov”wr™eExû±iÚ
.
şass
);

203 
Tok’
 
	gtok’
 = 
Ãw
 Tok’(
ruÁimeLayout
.
g‘Layout
().
g‘Epoch
(), 
glob®Add»ss
);

204 
LogD©a
 
	ghŞe
 = LogD©a.
g‘HŞe
(
tok’
);

205 
	gCFUts
.
g‘Unš‹¼u±ibly
(
ruÁimeLayout


206 .
g‘LogUn™Cl›Á
(
glob®Add»ss
, 
i
)

207 .
wr™e
(
hŞe
), 
Ov”wr™eExû±iÚ
.
şass
);

209 } 
ÿtch
 (
Ov”wr™eExû±iÚ
 
Û
) {

210 
	glog
.
šfo
("Prİag©e[{}]: Com¶‘ed by oth” wr™”", 
glob®Add»ss
);

231 
´iv©e
 
	$»cov”
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
) {

232 
fš®
 
Layout
 
Ïyout
 = 
ruÁimeLayout
.
	`g‘Layout
();

237 
numUn™s
 = 
Ïyout
.
	`g‘Segm’tL’gth
(
glob®Add»ss
);

238 
log
.
	`w¬n
("Recov”[{}]:„—d chaš h—d {}/{}", 
Tok’
.
	`of
(
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Epoch
()

239 , 
glob®Add»ss
),

240 1, 
numUn™s
);

241 
ILogD©a
 
ld
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ruÁimeLayout


242 .
	`g‘LogUn™Cl›Á
(
glob®Add»ss
, 0)

243 .
	`»ad
(
glob®Add»ss
)).
	`g‘Add»s£s
().
	`g‘OrDeçuÉ
(glob®Add»ss, 
nuÎ
);

252 ià(
ld
 =ğ
nuÎ
 ||†d.
	`isEm±y
()) {

253 
throw
 
Ãw
 
	`Recov”yExû±iÚ
("Failedo„ead data during„ecovery‡t chain head.");

256 
i
 = 1; i < 
numUn™s
; i++) {

257 
log
.
	`debug
("Recov”[{}]: wr™chaš {}/{}", 
Ïyout
, 
i
 + 1, 
numUn™s
);

259 
Œy
 {

260 
CFUts
.
	`g‘Unš‹¼u±ibly
(

261 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
glob®Add»ss
, 
i
).
	`wr™e
(
ld
),

262 
Ov”wr™eExû±iÚ
.
şass
);

264 
log
.
	`debug
("Recov”[{}]:„ecov”ed wr™© chaš {}/{}", 
Ïyout
, 
i
 + 1, 
numUn™s
);

265 } 
	`ÿtch
 (
Ov”wr™eExû±iÚ
 
Û
) {

268 
log
.
	`debug
("Recov”[{}]: ov”wr™‹À© chaš {}/{}", 
Ïyout
, 
i
 + 1, 
numUn™s
);

271 
	}
}

276 @
Ov”ride


277 
´Ùeùed
 
	$hŞeFl
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
) {

278 
numUn™s
 = 
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Segm’tL’gth
(
glob®Add»ss
);

279 
log
.
	`w¬n
("flHŞe[{}]: chaš h—d {}/{}", 
Tok’
.
	`of
(
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Epoch
(), 
glob®Add»ss
),

280 1, 
numUn™s
);

283 
Œy
 {

284 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Epoch
(), 
glob®Add»ss
);

285 
LogD©a
 
hŞe
 = LogD©a.
	`g‘HŞe
(
tok’
);

286 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ruÁimeLayout


287 .
	`g‘LogUn™Cl›Á
(
glob®Add»ss
, 0)

288 .
	`wr™e
(
hŞe
), 
Ov”wr™eExû±iÚ
.
şass
);

289 
	`´İag©e
(
ruÁimeLayout
, 
glob®Add»ss
, 
nuÎ
);

290 } 
	`ÿtch
 (
Ov”wr™eExû±iÚ
 
Û
) {

293 
	`»cov”
(
ruÁimeLayout
, 
glob®Add»ss
);

295 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/replication/IHoleFillPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

4 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gHŞeFlRequœedExû±iÚ
;

12 
public
 
š‹rçû
 
	gIHŞeFlPŞicy
 {

26 @
NÚnuÎ


27 
ILogD©a
 
³ekUÁHŞeFlRequœed
(
add»ss
,

28 
FunùiÚ
<
LÚg
, 
ILogD©a
> 
³ekFunùiÚ
)

29 
throws
 
	gHŞeFlRequœedExû±iÚ
;

	@runtime/src/main/java/org/corfudb/runtime/view/replication/IReplicationProtocol.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

7 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 
public
 
š‹rçû
 
	gIR•liÿtiÚPrÙocŞ
 {

39 
wr™e
(
RuÁimeLayout
 
ruÁimeLayout
, 
ILogD©a
 
d©a
è
throws
 
	gOv”wr™eExû±iÚ
;

53 @
NÚnuÎ


54 
ILogD©a
 
»ad
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
);

72 @
NÚnuÎ


73 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
»adAÎ
(
RuÁimeLayout
 
ruÁimeLayout
,

74 
Li¡
<
LÚg
> 
add»s£s
,

75 
boŞ—n
 
wa™FÜWr™e
,

76 
boŞ—n
 
ÿcheOnS”v”
);

91 
ILogD©a
 
³ek
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
);

	@runtime/src/main/java/org/corfudb/runtime/view/replication/NeverHoleFillPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

5 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gHŞeFlRequœedExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

19 @
Slf4j


20 
public
 cÏs 
	cNev”HŞeFlPŞicy
 
im¶em’ts
 
	mIHŞeFlPŞicy
 {

23 
fš®
 
	mwa™Ms
;

29 
public
 
	$Nev”HŞeFlPŞicy
(
wa™Ms
) {

30 
this
.
wa™Ms
 = waitMs;

36 @
NÚnuÎ


37 @
Ov”ride


38 
public
 
ILogD©a
 
	`³ekUÁHŞeFlRequœed
(
add»ss
,

39 
FunùiÚ
<
LÚg
, 
ILogD©a
> 
³ekFunùiÚ
è
throws
 
HŞeFlRequœedExû±iÚ
 {

40 
ILogD©a
 
d©a
 = 
nuÎ
;

41 
ŒyNum
 = 0;

43 ià(
ŒyNum
 != 0) {

44 
log
.
	`Œaû
("P“k[{}] R‘ryšg„—d {}", 
add»ss
, 
ŒyNum
);

45 
SË•
.
	`¦“pUnš‹¼u±ibly
(
Du¿tiÚ
.
	`ofMlis
(
wa™Ms
));

47 
d©a
 = 
³ekFunùiÚ
.
	`­¶y
(
add»ss
);

48 
ŒyNum
++;

49 } 
d©a
 =ğ
nuÎ
);

50  
d©a
;

51 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/replication/QuorumReplicationProtocol.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

9 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

10 
impÜt
 
	glombok
.
	gD©a
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aOuŒªkedExû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gHŞeFlRequœedExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLogUn™Exû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gV®ueAdİ‹dExû±iÚ
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gQuÜumFutu»sFaùÜy
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gHŞd”
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gExpÚ’tŸlBackoffR‘ry
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gIR‘ry
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gR‘ryN“dedExû±iÚ
;

34 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

35 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

36 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
.
	gSim¶eImmubËEÁry
;

37 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

38 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

39 
impÜt
 
	gjava
.
	gut
.
	gM­
;

40 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

42 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

43 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

44 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

45 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

50 @
Slf4j


51 
public
 cÏs 
	cQuÜumR•liÿtiÚPrÙocŞ
 
ex‹nds
 
	mAb¡¿ùR•liÿtiÚPrÙocŞ
 {

53 
´iv©e
 
fš®
 
	mQUORUM_RECOVERY_READ_EXPONENTIAL_RETRY_BASE
 = 3;

54 
´iv©e
 
fš®
 
	mQUORUM_RECOVERY_READ_EXPONENTIAL_RETRY_BACKOFF_DURATION_SECONDS
 = 10;

55 
´iv©e
 
fš®
 
	mQUORUM_RECOVERY_READ_EXTRA_WAIT_MILLIS
 = 20;

56 
´iv©e
 
fš®
 
	mQUORUM_RECOVERY_READ_WAIT_RANDOM_PART
 = .5f;

58 
´iv©e
 
fš®
 
	mCÚsum”
<
	mExpÚ’tŸlBackoffR‘ry
> 
	mWRITE_RETRY_SETTINGS
 = 
x
 -> {

59 
x
.
£tBa£
(
QUORUM_RECOVERY_READ_EXPONENTIAL_RETRY_BASE
);

60 
	mx
.
£tExŒaWa™
(
QUORUM_RECOVERY_READ_EXTRA_WAIT_MILLIS
);

61 
	mx
.
£tBackoffDu¿tiÚ
(
Du¿tiÚ
.
ofSecÚds
(

62 
QUORUM_RECOVERY_READ_EXPONENTIAL_RETRY_BACKOFF_DURATION_SECONDS
));

63 
	mx
.
£tRªdomPÜtiÚ
(
QUORUM_RECOVERY_READ_WAIT_RANDOM_PART
);

66 
public
 
	$QuÜumR•liÿtiÚPrÙocŞ
(
IHŞeFlPŞicy
 
hŞeFlPŞicy
) {

67 
	`su³r
(
hŞeFlPŞicy
);

68 
	}
}

74 @
Ov”ride


75 
public
 
ILogD©a
 
	$³ek
(
RuÁimeLayout
 
ruÁimeLayout
, 
add»ss
) {

76 
numUn™s
 = 
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Segm’tL’gth
(
add»ss
);

77 
log
.
	`Œaû
("P“k[{}]: quÜum {}/{}", 
add»ss
, 
numUn™s
,‚umUnits);

78 
Œy
 {

79 
R—dRe¥Ú£
 
»adRe¥Ú£
 = 
nuÎ
;

80 
Œy
 {

81 
Com¶‘abËFutu»
<
R—dRe¥Ú£
>[] 
futu»s
 = 
Ãw
 Com¶‘abËFutu»[
numUn™s
];

82 
i
 = 0; i < 
numUn™s
; i++) {

83 
futu»s
[
i
] = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
add»ss
, i).
	`»ad
(address);

85 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
R—dRe¥Ú£
> 
futu»
 =

86 
QuÜumFutu»sFaùÜy
.
	`g‘QuÜumFutu»
(
Ãw
 
	`R—dRe¥Ú£Com·¿tÜ
(
add»ss
),

87 
futu»s
);

88 
»adRe¥Ú£
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(
futu»
, 
QuÜumUÄ—chabËExû±iÚ
.
şass
);

89 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
e
) {

90 
log
.
	`debug
("³ek: QuÜum uÄ—chabË: {}", 
e
);

91  
nuÎ
;

93 ià(
»adRe¥Ú£
 !ğ
nuÎ
) {

94 
LogD©a
 
»suÉ
 = 
»adRe¥Ú£
.
	`g‘Add»s£s
().
	`g‘
(
add»ss
);

95 ià(
»suÉ
 !ğ
nuÎ
 && !
	`isEm±yTy³
ÔesuÉ.
	`g‘Ty³
())) {

96  
»suÉ
;

99  
nuÎ
;

100 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

101 
throw
 
e
;

103 
	}
}

108 @
	gOv”ride


109 @
NÚnuÎ


110 
public
 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
»adAÎ
(
RuÁimeLayout
 
ruÁimeLayout
,

111 
Li¡
<
LÚg
> 
add»s£s
,

112 
boŞ—n
 
wa™FÜWr™e
,

113 
boŞ—n
 
ÿcheOnS”v”
) {

115  
	gadd»s£s
.
¡»am
()

116 .
m­
(
addr
 -> 
Ãw
 
Sim¶eImmubËEÁry
<>×ddr, 
»ad
(
ruÁimeLayout
,‡ddr)))

117 .
cŞËù
(
CŞËùÜs
.
toM­
(
Sim¶eImmubËEÁry
::
g‘Key
, Sim¶eImmubËEÁry::
g‘V®ue
));

123 @
Ov”ride


124 
´Ùeùed
 
	$hŞeFl
(
RuÁimeLayout
 
ruÁimeLayout
, 
glob®Add»ss
) {

125 
numUn™s
 = 
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Segm’tL’gth
(
glob®Add»ss
);

126 
log
.
	`Œaû
("flHŞe[{}]: quÜum h—d {}/{}", 
glob®Add»ss
, 1, 
numUn™s
);

127 
	`Œy
 (
ILogD©a
.
S”Ÿliz©iÚHªdË
 
hŞeD©a
 = 
	`ü—‹Em±yD©a
(
glob®Add»ss
,

128 
D©aTy³
.
HOLE
, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(0))) {

129 
	`»cov”yWr™e
(
ruÁimeLayout
, 
hŞeD©a
.
	`g‘S”Ÿlized
());

131 
	}
}

136 @
Ov”ride


137 
public
 
	$wr™e
(
RuÁimeLayout
 
ruÁimeLayout
, 
ILogD©a
 
d©a
è
throws
 
Ov”wr™eExû±iÚ
 {

138 
fš®
 
glob®Add»ss
 = 
d©a
.
	`g‘Glob®Add»ss
();

139 
log
.
	`debug
("Wr™© {} " + 
glob®Add»ss
);

140 
IM‘ad©a
.
D©aRªk
 
¿nk
 = 
Ãw
 IM‘ad©a.
	`D©aRªk
(0);

141 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
BoŞ—n
> 
futu»
 = 
nuÎ
;

142 
d©a
.
	`£tRªk
(
¿nk
);

143 
Œy
 {

144 
	`Œy
 (
ILogD©a
.
S”Ÿliz©iÚHªdË
 
sh
 =

145 
d©a
.
	`g‘S”ŸlizedFÜm
()) {

146 
futu»
 = 
	`g‘Wr™eFutu»
(
ruÁimeLayout
, 
sh
.
	`g‘S”Ÿlized
());

147 
CFUts
.
	`g‘Unš‹¼u±ibly
(
futu»
, 
QuÜumUÄ—chabËExû±iÚ
.
şass
,

148 
Ov”wr™eExû±iÚ
.
şass
, 
D©aOuŒªkedExû±iÚ
.class);

150 } 
	`ÿtch
 (
Ov”wr™eExû±iÚ
 
e
) {

151 
log
.
	`”rÜ
("Client implementationƒrror,„ace in…hase 1. "

153 
throw
 
e
;

154 } 
	`ÿtch
 (
LogUn™Exû±iÚ
 | 
QuÜumUÄ—chabËExû±iÚ
 
e
) {

155 ià(
futu»
.
	`cÚšsThrowabËFrom
(
D©aOuŒªkedExû±iÚ
.
şass
)

156 || 
futu»
.
	`cÚšsThrowabËFrom
(
V®ueAdİ‹dExû±iÚ
.
şass
)) {

158 
boŞ—n
 
adİ‹d
 = 
	`»cov”yWr™e
(
ruÁimeLayout
, 
d©a
);

159 ià(!
adİ‹d
) {

163 
throw
 
Ãw
 
	`Ov”wr™eExû±iÚ
(
Ov”wr™eCau£
.
DIFF_DATA
);

165 
	}
}

168 
´iv©e
 
	gILogD©a
.
S”Ÿliz©iÚHªdË
 
	$ü—‹Em±yD©a
(

169 
pos™iÚ
, 
D©aTy³
 
ty³
, 
IM‘ad©a
.
D©aRªk
 
¿nk
) {

170 
ILogD©a
 
d©a
 = 
Ãw
 
	`LogD©a
(
ty³
);

171 
d©a
.
	`£tRªk
(
¿nk
);

172 
d©a
.
	`£tGlob®Add»ss
(
pos™iÚ
);

173  
d©a
.
	`g‘S”ŸlizedFÜm
();

174 
	}
}

176 
´iv©e
 
boŞ—n
 
	$isEm±yTy³
(
D©aTy³
 
ty³
) {

177  
ty³
 =ğ
D©aTy³
.
RANK_ONLY
 ||y³ =ğD©aTy³.
EMPTY
;

178 
	}
}

181 
´iv©e
 
boŞ—n
 
	$»cov”yWr™e
(
RuÁimeLayout
 
ruÁimeLayout
, 
ILogD©a
 
logD©a
) {

182 
add»ss
 = 
logD©a
.
	`g‘Glob®Add»ss
();

183 
log
.
	`debug
("Recov”y wr™© {} " + 
add»ss
);

184 
HŞd”
<
ILogD©a
> 
dh
 = 
Ãw
 HŞd”<>(
logD©a
);

185 
AtomicBoŞ—n
 
Ùh”V®ueAdİ‹d
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

186 
AtomicIÁeg”
 
»ŒyCouÁ
 = 
Ãw
 
	`AtomicIÁeg”
(0);

187 ià(
logD©a
.
	`g‘Rªk
(è=ğ
nuÎ
) {

188 
logD©a
.
	`£tRªk
(
Ãw
 
IM‘ad©a
.
	`D©aRªk
(0));

190 
Œy
 {

191 
IR‘ry
.
	`bud
(
ExpÚ’tŸlBackoffR‘ry
.
şass
, () -> {

192 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
BoŞ—n
> 
futu»
 = 
nuÎ
;

193 
Œy
 {

194 
log
.
	`debug
("Recovery write†oop for {}",†og);

196 
dh
.
	`g‘Ref
().
	`»Ëa£Bufãr
();

197 
dh
.
	`g‘Ref
().
	`£tRªk
(dh.g‘Ref().
	`g‘Rªk
().
	`budHigh”Rªk
());

199 ià(
»ŒyCouÁ
.
	`g‘AndInüem’t
() > 0) {

200 
Œy
 {

201  
hŞeFlPŞicy


202 .
	`³ekUÁHŞeFlRequœed
(
add»ss
,

203 
a
 -> 
	`³ek
(
ruÁimeLayout
,‡));

204 } 
	`ÿtch
 (
HŞeFlRequœedExû±iÚ
 
e
) {

205 
log
.
	`debug
(
e
.
	`g‘Mes§ge
(),ƒ);

210 
	`Œy
 (
ILogD©a
.
S”Ÿliz©iÚHªdË
 
ph1
 = 
	`ü—‹Em±yD©a
(

211 
dh
.
	`g‘Ref
().
	`g‘Glob®Add»ss
(),

212 
D©aTy³
.
RANK_ONLY
,

213 
dh
.
	`g‘Ref
().
	`g‘Rªk
())) {

214 
futu»
 = 
	`g‘Wr™eFutu»
(
ruÁimeLayout
, 
ph1
.
	`g‘S”Ÿlized
());

215 
CFUts
.
	`g‘Unš‹¼u±ibly
(
futu»
, 
QuÜumUÄ—chabËExû±iÚ
.
şass
,

216 
Ov”wr™eExû±iÚ
.
şass
, 
D©aOuŒªkedExû±iÚ
.class);

217 } 
	`ÿtch
 (
LogUn™Exû±iÚ
 | 
QuÜumUÄ—chabËExû±iÚ
 
e
) {

218 
R—dRe¥Ú£
 
¼
 = 
	`g‘Adİ‹dV®ueW™hHighe¡RªkIfP»£Á
(

219 
add»ss
, 
futu»
.
	`g‘ThrowabËs
());

220 ià(
¼
 !ğ
nuÎ
) {

221 
LogD©a
 
logD©aExi¡šg
 = 
¼
.
	`g‘Add»s£s
().
	`g‘
(
add»ss
);

222 
logD©aExi¡šg
.
	`»Ëa£Bufãr
();

223 
logD©aExi¡šg
.
	`£tRªk
(
dh
.
	`g‘Ref
().
	`g‘Rªk
());

224 
dh
.
	`£tRef
(
logD©aExi¡šg
.
	`g‘S”ŸlizedFÜm
().
	`g‘S”Ÿlized
());

225 
Ùh”V®ueAdİ‹d
.
	`£t
(
Œue
);

228 
throw
 
e
;

232 
futu»
 = 
	`g‘Wr™eFutu»
(
ruÁimeLayout
, 
dh
.
	`g‘Ref
());

233 
CFUts
.
	`g‘Unš‹¼u±ibly
(
futu»
, 
QuÜumUÄ—chabËExû±iÚ
.
şass
,

234 
Ov”wr™eExû±iÚ
.
şass
, 
D©aOuŒªkedExû±iÚ
.class);

235 
log
.
	`Œaû
("Wr™dÚe[{}]: {}", 
add»ss
);

236  
dh
.
	`g‘Ref
();

237 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 | 
D©aOuŒªkedExû±iÚ
 
e
) {

238 
throw
 
Ãw
 
	`R‘ryN“dedExû±iÚ
();

239 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

240 
throw
 
e
;

242 }).
	`£tO±iÚs
(
WRITE_RETRY_SETTINGS
).
	`run
();

243  
Ùh”V®ueAdİ‹d
.
	`g‘
();

244 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

245 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
("Recov”y iÁ”ru±ed", 
e
);

246 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
e
) {

247 
throw
 
e
;

250 
	}
}

252 
´iv©e
 
	gQuÜumFutu»sFaùÜy
.
	gCompos™eFutu»
<
	gBoŞ—n
> 
	$g‘Wr™eFutu»
(

253 
RuÁimeLayout
 
ruÁimeLayout
, 
ILogD©a
 
d©a
) {

254 
numUn™s
 = 
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Segm’tL’gth
(
d©a
.
	`g‘Glob®Add»ss
());

255 
glob®Add»ss
 = 
d©a
.
	`g‘Glob®Add»ss
();

256 
Com¶‘abËFutu»
<
BoŞ—n
>[] 
futu»s
 = 
Ãw
 Com¶‘abËFutu»[
numUn™s
];

257 
i
 = 0; i < 
numUn™s
; i++) {

258 
log
.
	`Œaû
("Wr™e[{}]: quÜum {}/{}", 
glob®Add»ss
, 
i
 + 1, 
numUn™s
);

259 
futu»s
[
i
] = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
glob®Add»ss
, i).
	`wr™e
(
d©a
);

261 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
BoŞ—n
> 
futu»
 =

262 
QuÜumFutu»sFaùÜy
.
	`g‘QuÜumFutu»
(
BoŞ—n
::
com·»To
, 
futu»s
,

263 
Ov”wr™eExû±iÚ
.
şass
, 
D©aOuŒªkedExû±iÚ
.class);

264  
futu»
;

265 
	}
}

267 
´iv©e
 
R—dRe¥Ú£
 
g‘Adİ‹dV®ueW™hHighe¡RªkIfP»£Á
(

268 
LÚg
 
pos™iÚ
, 
S‘
<
ThrowabË
> 
throwabËs
) {

269 
R—dRe¥Ú£
 
	g»suÉ
 = 
nuÎ
;

270 
	gIM‘ad©a
.
D©aRªk
 
	gmaxRªk
 = 
nuÎ
;

271 
ThrowabË
 
	gt
 : 
throwabËs
) {

272 ià(
t
 
š¡ªûof
 
V®ueAdİ‹dExû±iÚ
) {

273 
V®ueAdİ‹dExû±iÚ
 
ve
 = (V®ueAdİ‹dExû±iÚè
t
;

274 
R—dRe¥Ú£
 
	gr
 = 
ve
.
g‘R—dRe¥Ú£
();

275 
LogD©a
 
	gld
 = 
r
.
g‘Add»s£s
().
g‘
(
pos™iÚ
);

276 ià(
	gmaxRªk
 =ğ
nuÎ
 || 
maxRªk
.
com·»To
(
ld
.
g‘Rªk
()) < 0) {

277 
maxRªk
 = 
ld
.
g‘Rªk
();

278 
	g»suÉ
 = 
r
;

282  
	g»suÉ
;

286 @
	gD©a


287 @
AÎArgsCÚ¡ruùÜ


288 
´iv©e
 
şass
 
R—dRe¥Ú£Com·¿tÜ
 
im¶em’ts
 
	gCom·¿tÜ
<
	gR—dRe¥Ú£
> {

289 
´iv©e
 
	glogPos™iÚ
;

291 @
Ov”ride


292 
public
 
com·»
(
R—dRe¥Ú£
 
o1
, R—dRe¥Ú£ 
o2
) {

293 
LogD©a
 
	gld1
 = 
o1
.
g‘Add»s£s
().
g‘
(
logPos™iÚ
);

294 
LogD©a
 
	gld2
 = 
o2
.
g‘Add»s£s
().
g‘
(
logPos™iÚ
);

295 if(
	gld1
.
isTrimmed
(è|| 
	gld2
.isTrimmed()) {

296 
throw
 
Ãw
 
TrimmedExû±iÚ
();

298 
	gIM‘ad©a
.
D©aRªk
 
	g¿nk1
 = 
ld1
.
g‘Rªk
();

299 
	gIM‘ad©a
.
D©aRªk
 
	g¿nk2
 = 
ld2
.
g‘Rªk
();

300 ià(
	g¿nk1
 =ğ
nuÎ
) {

301  
¿nk2
 =ğ
nuÎ
 ? 0 : 1;

303 ià(
	g¿nk2
 =ğ
nuÎ
) {

306  
	g¿nk1
.
com·»To
(
¿nk2
);

	@runtime/src/main/java/org/corfudb/runtime/view/replication/ReadWaitHoleFillPolicy.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

5 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

7 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gHŞeFlRequœedExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gR‘ryExhau¡edExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gExpÚ’tŸlBackoffR‘ry
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gIR‘ry
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gR‘ryN“dedExû±iÚ
;

16 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

26 @
Slf4j


27 
public
 cÏs 
	cR—dWa™HŞeFlPŞicy
 
im¶em’ts
 
	mIHŞeFlPŞicy
 {

33 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mhŞeFlTh»shŞd
;

38 
´iv©e
 
fš®
 
Du¿tiÚ
 
	m»ŒyWa™Th»shŞd
;

47 
public
 
	$R—dWa™HŞeFlPŞicy
(
Du¿tiÚ
 
hŞeFlTh»shŞd
, Du¿tiÚ 
»ŒyWa™Th»shŞd
) {

48 
this
.
hŞeFlTh»shŞd
 = holeFillThreshold;

49 
this
.
»ŒyWa™Th»shŞd
 =„etryWaitThreshold;

55 @
NÚnuÎ


56 @
Ov”ride


57 
public
 
ILogD©a
 
	`³ekUÁHŞeFlRequœed
(
add»ss
, 
FunùiÚ
<
LÚg
, ILogD©a> 
³ekFunùiÚ
)

58 
throws
 
HŞeFlRequœedExû±iÚ
 {

59 
fš®
 
AtomicLÚg
 
¡¬tTime
 = 
Ãw
 
	`AtomicLÚg
();

61 
Œy
 {

62  
IR‘ry
.
	`bud
(
ExpÚ’tŸlBackoffR‘ry
.
şass
, 
R‘ryExhau¡edExû±iÚ
.class, () -> {

65 
ILogD©a
 
d©a
 = 
³ekFunùiÚ
.
	`­¶y
(
add»ss
);

67 ià(
d©a
 !ğ
nuÎ
) {

68  
d©a
;

69 } ià(
¡¬tTime
.
	`g‘
() == 0) {

70 
¡¬tTime
.
	`£t
(
Sy¡em
.
	`cu¼’tTimeMlis
());

71 } ià(
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
.
	`g‘
(è>ğ
hŞeFlTh»shŞd


72 .
	`toMlis
()) {

73 
throw
 
Ãw
 
	`R‘ryExhau¡edExû±iÚ
("Retries Exhausted.");

77 
log
.
	`debug
("peekUntilHoleFillRequired: Attempted„ead‡t‡ddress {}, "

78 + "buˆd©¨ab£Á. R‘ryšg.", 
add»ss
);

79 
throw
 
Ãw
 
	`R‘ryN“dedExû±iÚ
();

80 }).
	`£tO±iÚs
(
x
 -> x.
	`£tMaxR‘ryTh»shŞd
(
»ŒyWa™Th»shŞd
)).
	`run
();

81 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

82 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

83 } 
	`ÿtch
 (
R‘ryExhau¡edExû±iÚ
 
»e
) {

85 
log
.
	`debug
("³ekUÁHŞeFlRequœed: Add»ss:{}ƒm±y. HŞe-flšg.", 
add»ss
);

88 
throw
 
Ãw
 
	`HŞeFlRequœedExû±iÚ
("NØd©¨aá” " + 
hŞeFlTh»shŞd
.
	`toMlis
() + "ms.");

89 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/stream/AbstractContextStreamView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

10 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

31 @
Slf4j


32 
public
 
ab¡¿ù
 
şass
 
	gAb¡¿ùCÚ‹xtSŒ—mV›w
<
T
 
ex‹nds
 
	gAb¡¿ùSŒ—mCÚ‹xt
>

33 
im¶em’ts
 
	gISŒ—mV›w
, 
	gAutoClo£abË
 {

38 @
G‘‹r


39 
fš®
 
UUID
 
	gid
;

44 
fš®
 
CÜfuRuÁime
 
	gruÁime
;

51 
fš®
 
	gNavigabËS‘
<
	gT
> 
	g¡»amCÚ‹xts
;

55 
fš®
 
	gBiFunùiÚ
<
	gUUID
, 
	gLÚg
, 
	gT
> 
	gcÚ‹xtFaùÜy
;

58 
fš®
 
T
 
	gba£CÚ‹xt
;

68 
public
 
Ab¡¿ùCÚ‹xtSŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

69 
fš®
 
UUID
 
id
,

70 
fš®
 
BiFunùiÚ
<
UUID
, 
LÚg
, 
T
>

71 
cÚ‹xtFaùÜy
) {

72 
	gthis
.
	gid
 = 
id
;

73 
	gthis
.
	gruÁime
 = 
ruÁime
;

74 
	gthis
.
	g¡»amCÚ‹xts
 = 
Ãw
 
T»eS‘
<>();

75 
	gthis
.
	gcÚ‹xtFaùÜy
 = 
cÚ‹xtFaùÜy
;

76 
	gthis
.
	gba£CÚ‹xt
 = 
cÚ‹xtFaùÜy
.
­¶y
(
id
, 
Add»ss
.
MAX
);

77 
	gthis
.
	g¡»amCÚ‹xts
.
add
(
ba£CÚ‹xt
);

83 
public
 
synchrÚized
 
»£t
() {

84 
	gthis
.
	g¡»amCÚ‹xts
.
ş—r
();

85 
	gba£CÚ‹xt
.
»£t
();

86 
	gthis
.
	g¡»amCÚ‹xts
.
add
(
ba£CÚ‹xt
);

92 @
Ov”ride


93 
public
 
synchrÚized
 
£ek
(
glob®Add»ss
) {

96 
	gthis
.
	g¡»amCÚ‹xts
.
size
() > 1) {

97 ià(
	gthis
.
	g¡»amCÚ‹xts
.
fœ¡
().
	gmaxGlob®Add»ss
 < 
	gglob®Add»ss
) {

98 
	gthis
.
	g¡»amCÚ‹xts
.
pŞlFœ¡
();

103 
	gthis
.
	g¡»amCÚ‹xts
.
fœ¡
().
£ek
(
glob®Add»ss
);

109 @
Ov”ride


110 
public
 
şo£
() {}

115 @
Ov”ride


116 
public
 
fš®
 
synchrÚized
 
ILogD©a
 
ÃxtUpTo
(fš® 
maxGlob®
) {

118 ià(
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
(è> 
	gmaxGlob®
) {

119  
	gnuÎ
;

123 ià(
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
()

124 >ğ
g‘Cu¼’tCÚ‹xt
().
maxGlob®Add»ss
) {

125 
fš®
 
T
 
Ï¡
 = 
¡»amCÚ‹xts
.
pŞlFœ¡
();

126 
	glog
.
Œaû
("Completed context {}@{},„emoving.",

127 
Ï¡
.
id
,†a¡.
maxGlob®Add»ss
);

131 
fš®
 
ILogD©a
 
	g’Œy
 =

132 
g‘NextEÁry
(
g‘Cu¼’tCÚ‹xt
(), 
maxGlob®
);

134 ià(
	g’Œy
 !ğ
nuÎ
) {

136 
upd©ePoš‹r
(
’Œy
);

140  
	g’Œy
;

145 @
Ov”ride


146 
public
 
fš®
 
synchrÚized
 
	gLi¡
<
	gILogD©a
> 
»maššgUpTo
(
maxGlob®
) {

149 ià(
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
()

150 >ğ
g‘Cu¼’tCÚ‹xt
().
maxGlob®Add»ss
) {

151 
fš®
 
T
 
Ï¡
 = 
¡»amCÚ‹xts
.
pŞlFœ¡
();

152 
	glog
.
Œaû
("Completed context {}@{},„emoving.",

153 
Ï¡
.
id
,†a¡.
maxGlob®Add»ss
);

156 
fš®
 
	gLi¡
<
	gILogD©a
> 
	g’Œ›s
 = 
g‘NextEÁr›s
(
g‘Cu¼’tCÚ‹xt
(), 
maxGlob®
,

157 
this
::
dÛsEÁryUpd©eCÚ‹xt
);

160 ià(
	g’Œ›s
.
size
() == 0) {

162 ià(
maxGlob®
 !ğ
Add»ss
.
MAX
) {

164 
g‘Cu¼’tCÚ‹xt
().
£tGlob®Poš‹rCheckGCTrimM¬k
(
maxGlob®
);

166  
	g’Œ›s
;

170 ià(
dÛsEÁryUpd©eCÚ‹xt
(
’Œ›s
.
g‘
ÓÁr›s.
size
() - 1))) {

173 
	g’Œ›s
.
»move
(
’Œ›s
.
size
() - 1);

176 
	g’Œ›s
.
addAÎ
(
»maššgUpTo
(
maxGlob®
));

180 
	g’Œ›s
.
addAÎ
(
»maššgUpTo
(
maxGlob®
));

184 ià(
	gmaxGlob®
 !ğ
Add»ss
.
MAX
) {

186 
g‘Cu¼’tCÚ‹xt
().
£tGlob®Poš‹rCheckGCTrimM¬k
(
maxGlob®
);

189 
upd©ePoš‹r
(
’Œ›s
.
g‘
ÓÁr›s.
size
() - 1));

190 
g‘Cu¼’tCÚ‹xt
().
v®id©eGlob®Poš‹rPos™iÚ
(
g‘Cu¼’tGlob®Pos™iÚ
());

194  
	g’Œ›s
;

200 @
Ov”ride


201 
public
 
boŞ—n
 
hasNext
() {

202  
g‘HasNext
(
g‘Cu¼’tCÚ‹xt
());

211 
´Ùeùed
 
ab¡¿ù
 
boŞ—n
 
g‘HasNext
(
T
 
cÚ‹xt
);

219 
´Ùeùed
 
ab¡¿ù
 
ILogD©a
 
g‘NextEÁry
(
T
 
cÚ‹xt
, 
maxGlob®
);

237 
´Ùeùed
 
	gLi¡
<
	gILogD©a
> 
g‘NextEÁr›s
(
T
 
cÚ‹xt
, 
maxGlob®
,

238 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
cÚ‹xtCheckFn
) {

239 
fš®
 
	gLi¡
<
	gILogD©a
> 
	gd©aLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

240 
ILogD©a
 
	gthisD©a
;

242 (
	gthisD©a
 = 
g‘NextEÁry
(
cÚ‹xt
, 
maxGlob®
)è!ğ
nuÎ
) {

244 
d©aLi¡
.
add
(
thisD©a
);

248 
upd©ePoš‹r
(
thisD©a
);

251 ià(
	gcÚ‹xtCheckFn
.
­¶y
(
thisD©a
)) {

256  
	gd©aLi¡
;

264 
´Ùeùed
 
boŞ—n
 
dÛsEÁryUpd©eCÚ‹xt
(
fš®
 
ILogD©a
 
d©a
) {

265  
	gd©a
.
hasBackpoš‹r
(
g‘Cu¼’tCÚ‹xt
().
id
)

266 && 
	gd©a
.
g‘Backpoš‹r
(
g‘Cu¼’tCÚ‹xt
().
id
)

267 .
equ®s
(
Add»ss
.
COW_BACKPOINTER
);

274 
´iv©e
 
upd©ePoš‹r
(
fš®
 
ILogD©a
 
d©a
) {

276 ià(
	gd©a
.
g‘Ty³
(è=ğ
D©aTy³
.
DATA
 && !
d©a
.
hasCheckpoštM‘ad©a
()) {

281 
g‘Cu¼’tCÚ‹xt
().
£tGlob®Poš‹r
(
d©a
.
g‘Glob®Add»ss
());

291 
´Ùeùed
 
T
 
g‘Cu¼’tCÚ‹xt
() {

292  
	g¡»amCÚ‹xts
.
fœ¡
();

295 @
Ov”ride


296 
public
 
SŒšg
 
toSŒšg
() {

297  
	gUts
.
toR—dabËId
(
ba£CÚ‹xt
.
id
è+ "@" + 
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
();

	@runtime/src/main/java/org/corfudb/runtime/view/stream/AbstractQueuedStreamView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

7 
impÜt
 
	glombok
.
	gToSŒšg
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAµ’dExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gSËTok’Exû±iÚ
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gR—dO±iÚs
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

25 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

26 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

27 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

28 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

31 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

32 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

33 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

34 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

35 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

54 @
Slf4j


55 
public
 
ab¡¿ù
 
şass
 
Ab¡¿ùQueuedSŒ—mV›w
 
ex‹nds


56 
	gAb¡¿ùCÚ‹xtSŒ—mV›w
<
	gAb¡¿ùQueuedSŒ—mV›w


57 .
	gQueuedSŒ—mCÚ‹xt
> {

58 @
G‘‹r


59 
´iv©e
 
fš®
 
R—dO±iÚs
 
	g»adO±iÚs
;

66 
public
 
Ab¡¿ùQueuedSŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

67 
fš®
 
UUID
 
¡»amId
,

68 
SŒ—mO±iÚs
 
¡»amO±iÚs
) {

69 
su³r
(
ruÁime
, 
¡»amId
, 
QueuedSŒ—mCÚ‹xt
::
Ãw
);

70 
	gthis
.
	g»adO±iÚs
 = 
R—dO±iÚs
.
bud”
()

71 .
ş›ÁCach—bË
(
¡»amO±iÚs
.
isCacheEÁr›s
())

72 .
ignÜeTrim
(
¡»amO±iÚs
.
isIgnÜeTrimmed
())

73 .
bud
();

81 
´Ùeùed
 
addToResŞvedQueue
(
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
,

82 
glob®Add»ss
) {

83 
	gcÚ‹xt
.
	g»sŞvedQueue
.
add
(
glob®Add»ss
);

85 ià(
	gcÚ‹xt
.
	gmaxResŞutiÚ
 < 
	gglob®Add»ss
) {

86 
	gcÚ‹xt
.
	gmaxResŞutiÚ
 = 
glob®Add»ss
;

93 @
Ov”ride


94 
´Ùeùed
 
ILogD©a
 
g‘NextEÁry
(
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
,

95 
maxGlob®
) {

98 ià(
	gcÚ‹xt
.
	g»adQueue
.
isEm±y
(è&& cÚ‹xt.
	g»adCpQueue
.isEmpty()

99 && !
flR—dQueue
(
maxGlob®
, 
cÚ‹xt
)) {

100  
	gnuÎ
;

105 ià(
	gmaxGlob®
 < 
	gcÚ‹xt
.
	gcheckpošt
.
	g¡¬tAdd»ss
) {

106 
throw
 
Ãw
 
TrimmedExû±iÚ
();

110 
	gNavigabËS‘
<
	gLÚg
> 
	gg‘From
;

111 ià(
	gcÚ‹xt
.
	g»adCpQueue
.
size
() > 0) {

112 
	gg‘From
 = 
cÚ‹xt
.
»adCpQueue
;

115 
	gcÚ‹xt
.
£tGlob®Poš‹r
(
cÚ‹xt
.
checkpošt
.
¡¬tAdd»ss
);

117 
	gg‘From
 = 
cÚ‹xt
.
»adQueue
;

122 ià(
	gcÚ‹xt
.
	g»adCpQueue
.
isEm±y
(è&& cÚ‹xt.
	g»adQueue
.
fœ¡
(è> 
	gmaxGlob®
) {

123  
	gnuÎ
;

126  
»moveFromQueue
(
g‘From
);

136 
´Ùeùed
 
ab¡¿ù
 
ILogD©a
 
»moveFromQueue
(
NavigabËS‘
<
LÚg
> 
queue
);

138 @
Ov”ride


139 
public
 
gc
(
ŒimM¬k
) {

145 ià(
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
(è>ğg‘Cu¼’tCÚ‹xt().
g‘GcTrimM¬k
()) {

146 
log
.
debug
("gc[{}]: s¹ GC oÀ¡»am {} fÜrim m¬k {}", 
this
,his.
g‘Id
(),

147 
g‘Cu¼’tCÚ‹xt
().
g‘GcTrimM¬k
());

150 
g‘Cu¼’tCÚ‹xt
().
	g»adCpQueue
.
h—dS‘
(g‘Cu¼’tCÚ‹xt().
g‘GcTrimM¬k
()).
ş—r
();

151 
g‘Cu¼’tCÚ‹xt
().
	g»adQueue
.
h—dS‘
(g‘Cu¼’tCÚ‹xt().
g‘GcTrimM¬k
()).
ş—r
();

152 
g‘Cu¼’tCÚ‹xt
().
	g»sŞvedQueue
.
h—dS‘
(g‘Cu¼’tCÚ‹xt().
g‘GcTrimM¬k
()).
ş—r
();

154 ià(!
g‘Cu¼’tCÚ‹xt
().
	g»sŞvedQueue
.
isEm±y
()) {

155 
g‘Cu¼’tCÚ‹xt
().
	gmšResŞutiÚ
 = getCurrentContext()

156 .
»sŞvedQueue
.
fœ¡
();

159 
	glog
.
debug
("gc[{}]: GC‚ot…erformed on stream {} forhis cycle. Global…ointer {} is belowrim mark {}",

160 
this
,his.
g‘Id
(), 
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
(), g‘Cu¼’tCÚ‹xt().
g‘GcTrimM¬k
());

164 
g‘Cu¼’tCÚ‹xt
().
£tGcTrimM¬k
(
ŒimM¬k
);

173 @
Ov”ride


174 
public
 
­³nd
(
Objeù
 
objeù
,

175 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
acquis™iÚC®lback
,

176 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
d—cquis™iÚC®lback
) {

177 
fš®
 
LogD©a
 
	gld
 = 
Ãw
 LogD©a(
D©aTy³
.
DATA
, 
objeù
, 
ruÁime
.
g‘P¬am‘”s
().
g‘CodecTy³
());

180 
	gld
.
checkMaxWr™eSize
(
ruÁime
.
g‘P¬am‘”s
().
g‘MaxWr™eSize
());

183 
Tok’Re¥Ú£
 
	gtok’Re¥Ú£
 = 
ruÁime
.
g‘Sequ’ûrV›w
()

184 .
Ãxt
(
id
);

188 
	gx
 = 0; x < 
	gruÁime
.
g‘P¬am‘”s
().
g‘Wr™eR‘ry
(); x++) {

191 ià(
	gacquis™iÚC®lback
 !ğ
nuÎ
) {

192 ià(!
acquis™iÚC®lback
.
­¶y
(
tok’Re¥Ú£
)) {

196 
log
.
debug
("Acquis™iÚ„ejeùedok’={}", 
tok’Re¥Ú£
);

204 
	gŒy
 {

205 
	gruÁime
.
g‘Add»ssS·ûV›w
().
wr™e
(
tok’Re¥Ú£
, 
ld
);

208  
	gtok’Re¥Ú£
.
g‘Tok’
().
g‘Sequ’û
();

209 } 
ÿtch
 (
Ov”wr™eExû±iÚ
 
Û
) {

210 
	glog
.
Œaû
("Ov”wr™occu¼ed‡ˆ{}", 
tok’Re¥Ú£
);

213 ià(
	gd—cquis™iÚC®lback
 !ğ
nuÎ
) {

214 ià(!
d—cquis™iÚC®lback
.
­¶y
(
tok’Re¥Ú£
)) {

215 
log
.
debug
("Deacquisition„equested‡bort");

221 
	gtok’Re¥Ú£
 = 
ruÁime
.
g‘Sequ’ûrV›w
().
Ãxt
(
id
);

222 } 
ÿtch
 (
SËTok’Exû±iÚ
 
‹
) {

223 
	glog
.
Œaû
("Tok’ g»w sË occu¼ed‡ˆ{}", 
tok’Re¥Ú£
);

224 ià(
	gd—cquis™iÚC®lback
 !ğ
nuÎ
 && !
d—cquis™iÚC®lback
.
­¶y
(
tok’Re¥Ú£
)) {

225 
log
.
debug
("Deacquisition„equested‡bort");

230 
	gtok’Re¥Ú£
 = 
ruÁime
.
g‘Sequ’ûrV›w
().
Ãxt
(
id
);

234 
	glog
.
”rÜ
("append[{}]: failed‡fter {}„etries, write size {} bytes",

235 
tok’Re¥Ú£
.
g‘Sequ’û
(),

236 
ruÁime
.
g‘P¬am‘”s
().
g‘Wr™eR‘ry
(),

237 
ILogD©a
.
g‘S”ŸlizedSize
(
objeù
, 
ruÁime
.
g‘P¬am‘”s
().
g‘CodecTy³
()));

238 
throw
 
Ãw
 
Aµ’dExû±iÚ
();

255 @
D•»ÿ‹d


256 
´Ùeùed
 
ILogD©a
 
»ad
(
fš®
 
add»ss
, 
»adS¹Time
) {

257 
	gŒy
 {

258 ià(
	gSy¡em
.
cu¼’tTimeMlis
(è- 
	g»adS¹Time
 <

259 
	gruÁime
.
g‘P¬am‘”s
().
g‘HŞeFlTimeout
().
toMlis
()) {

260  
	gruÁime
.
g‘Add»ssS·ûV›w
().
»ad
(
add»ss
, 
»adO±iÚs
);

263 
R—dO±iÚs
 
	gİtiÚs
 = 
»adO±iÚs
.
toBud”
()

264 .
wa™FÜHŞe
(
çl£
)

265 .
bud
();

266  
	gruÁime
.
g‘Add»ssS·ûV›w
().
»ad
(
add»ss
, 
İtiÚs
);

267 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

268 
´oûssTrimmedExû±iÚ
(
‹
);

269 
throw
 
	g‹
;

273 @
NÚnuÎ


274 
´Ùeùed
 
	gLi¡
<
	gILogD©a
> 
»adAÎ
(@
NÚnuÎ
 
Li¡
<
LÚg
> 
add»s£s
) {

275 
	gŒy
 {

276 
	gM­
<
	gLÚg
, 
	gILogD©a
> 
	gd©aM­
 =

277 
ruÁime
.
g‘Add»ssS·ûV›w
().
»ad
(
add»s£s
, 
»adO±iÚs
);

281  
	gadd»s£s
.
¡»am
().
m­
(
d©aM­
::
g‘
)

282 .
f‹r
(
d©a
 -> d©¨!ğ
nuÎ
)

283 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

284 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

285 
´oûssTrimmedExû±iÚ
(
‹
);

286 
throw
 
	g‹
;

290 
´iv©e
 
´oûssTrimmedExû±iÚ
(
TrimmedExû±iÚ
 
‹
) {

291 ià(
	gT¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
(è!ğ
nuÎ


292 && 
T¿n§ùiÚ®CÚ‹xt
.
g‘Cu¼’tCÚ‹xt
().
g‘SÇpshÙTime¡amp
().
g‘Sequ’û
()

293 < 
g‘Cu¼’tCÚ‹xt
().
checkpošt
.
¢­shÙ
) {

294 
‹
.
£tR‘rŸbË
(
çl£
);

304 @
Ov”ride


305 
´Ùeùed
 
	gLi¡
<
	gILogD©a
> 
g‘NextEÁr›s
(
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
, 
maxGlob®
,

306 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
cÚ‹xtCheckFn
) {

307 
	gNavigabËS‘
<
	gLÚg
> 
	g»adS‘
 = 
Ãw
 
T»eS‘
<>();

312 
boŞ—n
 
	g»adQueueIsEm±y
 = !
flR—dQueue
(
maxGlob®
, 
cÚ‹xt
);

316 ià(
	gmaxGlob®
 < 
	gcÚ‹xt
.
	gcheckpošt
.
	g¡¬tAdd»ss
) {

317 
throw
 
Ãw
 
TrimmedExû±iÚ
();

322 ià(
	g»adQueueIsEm±y
) {

323  
	gCŞËùiÚs
.
em±yLi¡
();

328 
	g»adS‘
.
addAÎ
(
cÚ‹xt
.
»adCpQueue
);

330 ià(!
	gcÚ‹xt
.
	g»adQueue
.
isEm±y
(è&& cÚ‹xt.»adQueue.
fœ¡
(è> 
	gmaxGlob®
) {

336 
	g»adS‘
.
addAÎ
(
cÚ‹xt
.
»adQueue
.
h—dS‘
(
maxGlob®
, 
Œue
));

339 
	gLi¡
<
	gLÚg
> 
	gtoR—d
 = 
»adS‘
.
¡»am
()

340 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

343 
	gLi¡
<
	gILogD©a
> 
	g»adFrom
 = 
»adAÎ
(
toR—d
).
¡»am
()

344 .
f‹r
(
x
 -> x.
g‘Ty³
(è=ğ
D©aTy³
.
DATA
)

345 .
f‹r
(
x
 -> x.
cÚšsSŒ—m
(
cÚ‹xt
.
id
))

346 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

351 
	gO±iÚ®
<
	gILogD©a
> 
	gcÚ‹xtEÁry
 = 
»adFrom
.
¡»am
()

352 .
f‹r
(
cÚ‹xtCheckFn
::
­¶y
).
fšdFœ¡
();

353 ià(
	gcÚ‹xtEÁry
.
isP»£Á
()) {

354 
	glog
.
Œaû
("g‘NextEÁr›s[{}] cÚ‹xˆsw™ch @ {}", 
this
,

355 
cÚ‹xtEÁry
.
g‘
().
g‘Glob®Add»ss
());

356 
	gidx
 = 
»adFrom
.
šdexOf
(
cÚ‹xtEÁry
.
g‘
());

357 
	g»adFrom
 = 
»adFrom
.
subLi¡
(0, 
idx
 + 1);

359 
	g»adS‘
.
h—dS‘
(
cÚ‹xtEÁry
.
g‘
().
g‘Glob®Add»ss
(), 
Œue
).
ş—r
();

362 
	gcÚ‹xt
.
	g»adQueue
.
h—dS‘
(
maxGlob®
, 
Œue
).
ş—r
();

366 
	g»adFrom
.
¡»am
()

367 .
fÜEach
(
x
 -> 
addToResŞvedQueue
(
cÚ‹xt
, x.
g‘Glob®Add»ss
()));

370 ià(
	g»adFrom
.
size
() > 0) {

371 
	gcÚ‹xt
.
£tGlob®Poš‹rCheckGCTrimM¬k
(
»adFrom
.
g‘
Ô—dFrom.
size
() - 1)

372 .
g‘Glob®Add»ss
());

375  
	g»adFrom
;

394 
´Ùeùed
 
boŞ—n
 
flR—dQueue
(
fš®
 
maxGlob®
,

395 
fš®
 
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
) {

396 
	glog
.
Œaû
("Fl_R—d_Queue[{}] Max: {}, Cu¼’t: {}, ResŞved: {} - {}", 
this
,

397 
maxGlob®
, 
cÚ‹xt
.
g‘Glob®Poš‹r
(), cÚ‹xt.
maxResŞutiÚ
, cÚ‹xt.
mšResŞutiÚ
);

398 
	glog
.
Œaû
("Fill_Read_Queue[{}]:‡ddresses inhis stream Resolved queue {}" +

399 " - R—dQueu{} - CP Queu{}", 
this
,

400 
cÚ‹xt
.
»sŞvedQueue
, cÚ‹xt.
»adQueue
, cÚ‹xt.
»adCpQueue
);

405 ià(
	gcÚ‹xt
.
g‘Checkpošt
(è=ğ
SŒ—mCheckpošt
.
UNINITIALIZED
) {

406 
cÚ‹xt
.
checkpošt
 = 
SŒ—mCheckpošt
.
INITIALIZED
;

408 
fš®
 
UUID
 
	gcheckpoštId
 = 
CÜfuRuÁime


409 .
g‘CheckpoštSŒ—mIdFromId
(
cÚ‹xt
.
id
);

411 
	gŒy
 {

412 ià(
discov”Add»ssS·û
(
checkpoštId
, 
cÚ‹xt
.
»adCpQueue
,

413 
ruÁime
.
g‘Sequ’ûrV›w
().
qu”y
(
checkpoštId
),

414 
Add»ss
.
NEVER_READ
,

415 
d©a
 -> 
sÿnCheckpoštSŒ—m
(
cÚ‹xt
, d©a, 
maxGlob®
),

416 
Œue
, 
maxGlob®
)) {

417 
	glog
.
Œaû
("Fill_Read_Queue[{}] Get Stream Address Map using checkpoint with {}ƒntries",

418 
this
, 
cÚ‹xt
.
»adCpQueue
.
size
());

420  
	gŒue
;

422 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

423 
	glog
.
w¬n
("Fl_R—d_Queue[{}] TrimƒncouÁ”ed.", 
this
, 
‹
);

424 
throw
 
	g‹
;

429 
fš®
 
	gmaxAdd»ss
 =

430 
LÚg
.
mš
(
maxGlob®
, 
cÚ‹xt
.
maxGlob®Add»ss
);

434 ià(
	gcÚ‹xt
.
g‘Glob®Poš‹r
(è>ğ
maxAdd»ss
) {

435  
çl£
;

440 ià(
	gcÚ‹xt
.
	gmaxResŞutiÚ
 >ğ
maxAdd»ss


441 && 
cÚ‹xt
.
mšResŞutiÚ
 < cÚ‹xt.
g‘Glob®Poš‹r
()) {

442  
flFromResŞved
(
maxGlob®
, 
cÚ‹xt
);

445 
LÚg
 
	gÏ‹¡Tok’V®ue
 = 
nuÎ
;

448 ià(
	gmaxGlob®
 !ğ
Add»ss
.
MAX
) {

449 
Ï‹¡Tok’V®ue
 = 
cÚ‹xt
.
»sŞvedQueue
.
ûšg
(
maxGlob®
);

454 ià(
	gÏ‹¡Tok’V®ue
 =ğ
nuÎ
 || 
maxGlob®
 =ğ
Add»ss
.
MAX
) {

462 
Ï‹¡Tok’V®ue
 = 
ruÁime
.
g‘Sequ’ûrV›w
().
qu”y
(
cÚ‹xt
.
id
);

463 
	glog
.
Œaû
("Fl_R—d_Queue[{}] F‘cheda {} from sequ’ûr", 
this
, 
Ï‹¡Tok’V®ue
);

468 ià(
	gAdd»ss
.
nÚAdd»ss
(
Ï‹¡Tok’V®ue
)) {

472 ià(
	gÏ‹¡Tok’V®ue
 !ğ
Add»ss
.
NON_EXIST
) {

473 
log
.
w¬n
("TOKEN[{}] uÃx³ùed„‘uº v®ue", 
Ï‹¡Tok’V®ue
);

475  
	gçl£
;

480 ià(
	gcÚ‹xt
.
	gmaxResŞutiÚ
 >ğ
Ï‹¡Tok’V®ue


481 && 
cÚ‹xt
.
mšResŞutiÚ
 < cÚ‹xt.
g‘Glob®Poš‹r
()) {

482  
flFromResŞved
(
Ï‹¡Tok’V®ue
, 
cÚ‹xt
);

485 
	g¡İAdd»ss
 = 
LÚg
.
max
(
cÚ‹xt
.
glob®Poš‹r
, cÚ‹xt.
checkpošt
.
¢­shÙ
);

490 ià(
	gcÚ‹xt
.
	gglob®Poš‹r
 < cÚ‹xt.
	gmaxResŞutiÚ
) {

491 ià(
flFromResŞved
(
cÚ‹xt
.
maxResŞutiÚ
, context)) {

492 
	g¡İAdd»ss
 = 
cÚ‹xt
.
maxResŞutiÚ
;

493 
	glog
.
Œaû
("fillReadQueue[{}]: current…ointer: {},„esolved upo: {},„eadQueue: {}, " +

494 "Ãw stİ‡dd»ss: {}", 
this
, 
cÚ‹xt
.
glob®Poš‹r
,

495 
cÚ‹xt
.
maxResŞutiÚ
, cÚ‹xt.
»adQueue
, 
¡İAdd»ss
);

501 
discov”Add»ssS·û
(
cÚ‹xt
.
id
, cÚ‹xt.
»adQueue
,

502 
Ï‹¡Tok’V®ue
,

503 
¡İAdd»ss
,

504 
d
 -> 
Œue
, 
çl£
, 
maxGlob®
);

506  !
	gcÚ‹xt
.
	g»adCpQueue
.
isEm±y
(è|| !cÚ‹xt.
	g»adQueue
.isEmpty();

527 
´Ùeùed
 
ab¡¿ù
 
boŞ—n
 
discov”Add»ssS·û
(
fš®
 
UUID
 
¡»amId
,

528 
fš®
 
NavigabËS‘
<
LÚg
> 
queue
,

529 
fš®
 
¡¬tAdd»ss
,

530 
fš®
 
¡İAdd»ss
,

531 
fš®
 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
f‹r
,

532 
fš®
 
boŞ—n
 
checkpošt
,

533 
fš®
 
maxGlob®
);

535 
´Ùeùed
 
boŞ—n
 
flFromResŞved
(
fš®
 
maxGlob®
,

536 
fš®
 
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
) {

538 ià(
	gmaxGlob®
 < 
	gcÚ‹xt
.
g‘Glob®Poš‹r
()) {

539  
	gçl£
;

543 
	gNavigabËS‘
<
	gLÚg
> 
	g»sŞvedS‘
 =

544 
cÚ‹xt
.
»sŞvedQueue
.
subS‘
(cÚ‹xt.
g‘Glob®Poš‹r
(),

545 
çl£
, 
maxGlob®
, 
Œue
);

548 
	gcÚ‹xt
.
	g»adQueue
.
addAÎ
(
»sŞvedS‘
);

550  !
	gcÚ‹xt
.
	g»adQueue
.
isEm±y
();

557 
´Ùeùed
 
ILogD©a
 
»ad
(
fš®
 
add»ss
) {

558 
	gŒy
 {

559  
	gruÁime
.
g‘Add»ssS·ûV›w
().
»ad
(
add»ss
, 
»adO±iÚs
);

560 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

561 
´oûssTrimmedExû±iÚ
(
‹
);

562 
throw
 
	g‹
;

577 
	g´Ùeùed
 @
NÚnuÎ
 
ILogD©a
 
»ad
(
ÃxtR—d
, @NÚnuÎ 
fš®
 
NavigabËS‘
<
LÚg
> 
add»s£s
) {

578 
	gŒy
 {

579  
	gruÁime
.
g‘Add»ssS·ûV›w
().
»ad
(
ÃxtR—d
, 
add»s£s
, 
»adO±iÚs
);

580 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

581 
´oûssTrimmedExû±iÚ
(
‹
);

582 
throw
 
	g‹
;

593 @
Ov”ride


594 
public
 
boŞ—n
 
g‘HasNext
(
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
) {

595  !
	gcÚ‹xt
.
	g»adQueue
.
isEm±y
()

596 || 
	gruÁime
.
g‘Sequ’ûrV›w
().
qu”y
(
cÚ‹xt
.
id
)

597 > 
	gcÚ‹xt
.
g‘Glob®Poš‹r
();

603 @
Ov”ride


604 
public
 
şo£
() {}

607 
´iv©e
 
SŒ—mCheckpošt
 
	gÏ‹¡V®idCheckpošt
 = 
Ãw
 StreamCheckpoint();

632 
´Ùeùed
 
boŞ—n
 
sÿnCheckpoštSŒ—m
(
fš®
 
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
, 
ILogD©a
 
d©a
,

633 
maxGlob®
) {

634 ià(
	gd©a
.
hasCheckpoštM‘ad©a
()) {

635 
CheckpoštEÁry
 
	gıEÁry
 = (CheckpoštEÁryè
d©a
.
g‘Paylßd
(
ruÁime
);

639 ià(
	gcÚ‹xt
.
	gcheckpošt
.
	gid
 =ğ
nuÎ
 &&

640 
ıEÁry
.
g‘CpTy³
(è=ğ
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
END


641 && 
LÚg
.
decode
(
ıEÁry
.
g‘Diù
()

642 .
g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
)è<ğ
maxGlob®
) {

643 
log
.
Œaû
("Checkpoint[{}] END found‡t‡ddress {}ype {} id {}‡uthor {}",

644 
this
, 
d©a
.
g‘Glob®Add»ss
(), 
ıEÁry
.
g‘CpTy³
(),

645 
Uts
.
toR—dabËId
(
ıEÁry
.
g‘CheckpoštId
()), cpEÁry.
g‘CheckpoštAuthÜId
());

651 
UUID
 
	gcheckpoštId
 = 
ıEÁry
.
g‘CheckpoštId
();

652 
	gcheckpoštVLOV”siÚ
 = 
LÚg
.
decode
(
ıEÁry
.
g‘Diù
()

653 .
g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
));

654 
boŞ—n
 
	gisCheckpoštFÜHighe¡VLOV”siÚ
 = 
Ï‹¡V®idCheckpošt
.
v®id©eHigh”
(
checkpoštId
,

655 
checkpoštVLOV”siÚ
);

660 ià(
	gisCheckpoštFÜHighe¡VLOV”siÚ
) {

662 
	gÏ‹¡V®idCheckpošt
 = 
Ãw
 
SŒ—mCheckpošt
(
checkpoštId
);

663 
	gÏ‹¡V®idCheckpošt
.
£tS¹Add»ss
(
d©a
.
g‘Checkpoš‹dSŒ—mS¹LogAdd»ss
());

664 
	gÏ‹¡V®idCheckpošt
.
£tNumEÁr›s
(1);

665 
	gÏ‹¡V®idCheckpošt
.
£tTÙ®By‹s
((è
d©a
.
g‘SizeE¡im©e
());

666 
	gÏ‹¡V®idCheckpošt
.
addAdd»ss
(
d©a
.
g‘Glob®Add»ss
());

668 ià(
	gıEÁry
.
g‘Diù
().
g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey


669 .
SNAPSHOT_ADDRESS
è!ğ
nuÎ
) {

670 
Ï‹¡V®idCheckpošt
.
£tSÇpshÙ
(
LÚg
.
decode
(
ıEÁry
.
g‘Diù
()

671 .
g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
SNAPSHOT_ADDRESS
)));

674 } ià(
	gÏ‹¡V®idCheckpošt
.
g‘Id
(è!ğ
nuÎ
 &&

675 
Ï‹¡V®idCheckpošt
.
g‘Id
().
equ®s
(
ıEÁry
.
g‘CheckpoštId
())) {

680 
Ï‹¡V®idCheckpošt
.
addBy‹s
((è
d©a
.
g‘SizeE¡im©e
());

681 
	gÏ‹¡V®idCheckpošt
.
addNumEÁr›s
(1);

682 
	gÏ‹¡V®idCheckpošt
.
addAdd»ss
(
d©a
.
g‘Glob®Add»ss
());

684 ià(
	gıEÁry
.
g‘CpTy³
().
equ®s
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
START
)) {

686 
	glog
.
Œaû
("Checkpoint[{}] START found‡t‡ddress {}ype {} id {}‡uthor {}",

687 
this
, 
d©a
.
g‘Glob®Add»ss
(), 
ıEÁry
.
g‘CpTy³
(),

688 
Uts
.
toR—dabËId
(
ıEÁry
.
g‘CheckpoštId
()),

689 
ıEÁry
.
g‘CheckpoštAuthÜId
());

690  
	gŒue
;

694  
	gçl£
;

705 
public
 
	gLi¡
<
	gLÚg
> 
»sŞveCheckpošt
(
fš®
 
QueuedSŒ—mCÚ‹xt
 
cÚ‹xt
) {

707 
	gLi¡
<
	gLÚg
> 
	gcheckpoštAdd»s£s
 = 
Ãw
 
A¼ayLi¡
<>();

709 ià(
	gÏ‹¡V®idCheckpošt
 !ğ
nuÎ
 && 
Ï‹¡V®idCheckpošt
.
g‘Id
() !=‚ull) {

711 
log
.
Œaû
("»sŞveCheckpošt[{}]: s–eùšg checkpošˆ{} w™h s¹‡dd»s {}", 
this
,

712 
Ï‹¡V®idCheckpošt
.
g‘Id
(),†©e¡V®idCheckpošt.
g‘S¹Add»ss
());

713 
	gcÚ‹xt
.
	gcheckpošt
 = 
Ï‹¡V®idCheckpošt
;

714 
	gcheckpoštAdd»s£s
.
addAÎ
(
Ï‹¡V®idCheckpošt
.
g‘CheckpoštAdd»s£s
());

718 
	gÏ‹¡V®idCheckpošt
 = 
Ãw
 
SŒ—mCheckpošt
();

719  
	gcheckpoštAdd»s£s
;

725 @
Ov”ride


726 
public
 
synchrÚized
 
ILogD©a
 
´evious
() {

727 
fš®
 
QueuedSŒ—mCÚ‹xt
 
	gcÚ‹xt
 = 
g‘Cu¼’tCÚ‹xt
();

728 
fš®
 
	gŞdPoš‹r
 = 
cÚ‹xt
.
g‘Glob®Poš‹r
();

730 
	glog
.
Œaû
("´evious[{}]: max={} mš={}", 
this
,

731 
cÚ‹xt
.
maxResŞutiÚ
,

732 
cÚ‹xt
.
mšResŞutiÚ
);

735 ià(
	gcÚ‹xt
.
g‘Glob®Poš‹r
(è=ğ
Add»ss
.
NEVER_READ
) {

736  
nuÎ
;

741 ià(
	gcÚ‹xt
.
g‘Glob®Poš‹r
(è- 1 < cÚ‹xt.
	gcheckpošt
.
	g¡¬tAdd»ss
) {

742 
throw
 
Ãw
 
TrimmedExû±iÚ
();

747 
LÚg
 
	g´evAdd»ss
 = 
cÚ‹xt


748 .
»sŞvedQueue
.
low”
(
cÚ‹xt
.
g‘Glob®Poš‹r
());

751 ià(
	g´evAdd»ss
 =ğ
nuÎ
 && 
Add»ss
.
isAdd»ss
(
cÚ‹xt
.
mšResŞutiÚ
)

752 || 
´evAdd»ss
 !ğ
nuÎ
 &&…»vAdd»s <ğ
cÚ‹xt
.
mšResŞutiÚ
) {

753 
cÚ‹xt
.
£tGlob®Poš‹rCheckGCTrimM¬k
(
´evAdd»ss
 =ğ
nuÎ
 ? 
Add»ss
.
NEVER_READ
 :

754 
´evAdd»ss
 - 1L);

756 
»maššgUpTo
(
cÚ‹xt
.
mšResŞutiÚ
);

757 
	gcÚ‹xt
.
	gmšResŞutiÚ
 = 
Add»ss
.
NON_ADDRESS
;

758 
	gcÚ‹xt
.
£tGlob®Poš‹rCheckGCTrimM¬k
(
ŞdPoš‹r
);

759 
	g´evAdd»ss
 = 
cÚ‹xt


760 .
»sŞvedQueue
.
low”
(
cÚ‹xt
.
g‘Glob®Poš‹r
());

761 
	glog
.
Œaû
("´evious[{}]: upd©ed„esŞved queu{}", 
this
, 
cÚ‹xt
.
»sŞvedQueue
);

765 
	gcÚ‹xt
.
	g»adQueue
.
ş—r
();

767 ià(
	g´evAdd»ss
 !ğ
nuÎ
) {

768 
log
.
Œaû
("´evious[{}]: upd©ed„—d queu{}", 
this
, 
cÚ‹xt
.
»adQueue
);

769 
	gcÚ‹xt
.
£tGlob®Poš‹rCheckGCTrimM¬k
(
´evAdd»ss
);

770  
»ad
(
´evAdd»ss
);

773 ià(
	gcÚ‹xt
.
	gcheckpošt
.
	gid
 =ğ
nuÎ
) {

777 
log
.
Œaû
("previous[{}]:„eachedhe beginning ofhe stream„esetting" +

778 "h¡»am…oš‹¸tØ{}", 
this
, 
Add»ss
.
NON_ADDRESS
);

779 
	gcÚ‹xt
.
£tGlob®Poš‹rCheckGCTrimM¬k
(
Add»ss
.
NON_ADDRESS
);

780  
	gnuÎ
;

783 ià(
	gcÚ‹xt
.
	g»sŞvedQueue
.
fœ¡
(è=ğ
cÚ‹xt
.
g‘Glob®Poš‹r
()) {

784 
log
.
Œaû
("previous[{}]:„eachedhe beginning ofhe stream„esetting" +

785 "h¡»am…oš‹¸tØcheckpošˆv”siÚ {}", 
this
, 
cÚ‹xt
.
checkpošt
.
¡¬tAdd»ss
);

788 
	gcÚ‹xt
.
£tGlob®Poš‹r
(
cÚ‹xt
.
checkpošt
.
¡¬tAdd»ss
);

789  
	gnuÎ
;

792 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("The stream…ointer seemso be corrupted!");

799 @
Ov”ride


800 
public
 
synchrÚized
 
ILogD©a
 
cu¼’t
() {

801 
fš®
 
QueuedSŒ—mCÚ‹xt
 
	gcÚ‹xt
 = 
g‘Cu¼’tCÚ‹xt
();

803 ià(
	gAdd»ss
.
nÚAdd»ss
(
cÚ‹xt
.
g‘Glob®Poš‹r
())) {

804  
	gnuÎ
;

806  
»ad
(
cÚ‹xt
.
g‘Glob®Poš‹r
());

812 @
Ov”ride


813 
public
 
g‘Cu¼’tGlob®Pos™iÚ
() {

814  
g‘Cu¼’tCÚ‹xt
().
g‘Glob®Poš‹r
();

817 @
VisibËFÜTe¡šg


818 
	gAb¡¿ùQueuedSŒ—mV›w
.
QueuedSŒ—mCÚ‹xt
 
g‘CÚ‹xt
() {

819  
	gthis
.
	gba£CÚ‹xt
;

827 @
ToSŒšg


828 şas 
	cQueuedSŒ—mCÚ‹xt
 
ex‹nds
 
	gAb¡¿ùSŒ—mCÚ‹xt
 {

831 
fš®
 
	gNavigabËS‘
<
	gLÚg
> 
	g»sŞvedQueue


832 ğ
Ãw
 
T»eS‘
<>();

837 
	gmšResŞutiÚ
 = 
Add»ss
.
NON_ADDRESS
;

842 
	gmaxResŞutiÚ
 = 
Add»ss
.
NON_ADDRESS
;

847 
fš®
 
	gNavigabËS‘
<
	gLÚg
> 
	g»adQueue


848 ğ
Ãw
 
T»eS‘
<>();

852 
fš®
 
	gNavigabËS‘
<
	gLÚg
> 
	g»adCpQueue
 = 
Ãw
 
T»eS‘
<>();

857 @
	gG‘‹r


858 @
S‘‹r


859 
´iv©e
 
SŒ—mCheckpošt
 
	gcheckpošt
 = SŒ—mCheckpošt.
UNINITIALIZED
;

866 
public
 
QueuedSŒ—mCÚ‹xt
(
UUID
 
id
, 
maxGlob®Add»ss
) {

867 
su³r
(
id
, 
maxGlob®Add»ss
);

873 @
Ov”ride


874 
»£t
() {

875 
	gsu³r
.
»£t
();

876 
	g»adCpQueue
.
ş—r
();

877 
	g»adQueue
.
ş—r
();

878 
	g»sŞvedQueue
.
ş—r
();

879 
	gmšResŞutiÚ
 = 
Add»ss
.
NON_ADDRESS
;

880 
	gmaxResŞutiÚ
 = 
Add»ss
.
NON_ADDRESS
;

881 
£tCheckpošt
(
SŒ—mCheckpošt
.
UNINITIALIZED
);

887 @
Ov”ride


888 
synchrÚized
 
£ek
(
glob®Add»ss
) {

889 ià(
	gAdd»ss
.
nÚAdd»ss
(
glob®Add»ss
)) {

890 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("globalAddress must"

893 
	glog
.
Œaû
("S“k[{}]({}), mš={} max={}", 
this
, 
glob®Add»ss
,

894 
mšResŞutiÚ
, 
maxResŞutiÚ
);

896 ià(
	gglob®Add»ss
 >ğ
maxResŞutiÚ
) {

897 
log
.
Œaû
("£ˆmš„e tØ{}" , 
glob®Add»ss
);

898 
	gmšResŞutiÚ
 = 
glob®Add»ss
;

902 
	g»adQueue
.
h—dS‘
(
glob®Add»ss
).
ş—r
();

906 
	g»adQueue
.
addAÎ
(
»sŞvedQueue
.
S‘
(
glob®Add»ss
, 
Œue
));

907 
	gsu³r
.
£ek
(
glob®Add»ss
);

915 @
D©a


916 şas 
	cSŒ—mCheckpošt
 {

917 
public
 
fš®
 
SŒ—mCheckpošt
 
	gUNINITIALIZED
 = 
Ãw
 StreamCheckpoint();

918 
public
 
fš®
 
SŒ—mCheckpošt
 
	gINITIALIZED
 = 
Ãw
 StreamCheckpoint();

920 
UUID
 
	gid
 = 
nuÎ
;

923 
	g¡¬tAdd»ss
 = 
Add»ss
.
NEVER_READ
;

925 
	gnumEÁr›s
 = 0L;

927 
	gtÙ®By‹s
 = 0L;

933 
	g¢­shÙ
 = 
Add»ss
.
NEVER_READ
;

935 
	gLi¡
<
	gLÚg
> 
	gcheckpoštAdd»s£s
 = 
Ãw
 
A¼ayLi¡
<>();

940 
public
 
SŒ—mCheckpošt
(
UUID
 
id
) {

941 
	gthis
.
	gid
 = 
id
;

944 
public
 
SŒ—mCheckpošt
() {

947 
public
 
addAdd»ss
(
add»ss
) {

948 
	gcheckpoštAdd»s£s
.
add
(
add»ss
);

960 
public
 
boŞ—n
 
v®id©eHigh”
(
UUID
 
id
, 
¡¬tAdd»ss
) {

961 ià(
	gAdd»ss
.
isAdd»ss
(
¡¬tAdd»ss
è&& 
	g¡¬tAdd»ss
 > 
	gthis
.startAddress) {

962 
	glog
.
Œaû
("v®id©eHigh”[{}]: v®id checkpošˆ{} w™h s¹‡dd»s {}", 
this
, 
id
, 
¡¬tAdd»ss
);

963  
	gŒue
;

966  
	gçl£
;

969 
public
 
»£t
() {

970 
	gid
 = 
nuÎ
;

971 
	g¡¬tAdd»ss
 = 
Add»ss
.
NEVER_READ
;

972 
	g¢­shÙ
 = 
Add»ss
.
NEVER_READ
;

973 
	gnumEÁr›s
 = 0;

974 
	gtÙ®By‹s
 = 0;

975 
	gcheckpoštAdd»s£s
 = 
Ãw
 
A¼ayLi¡
<>();

978 
public
 
addBy‹s
(
by‹s
) {

979 
	gtÙ®By‹s
 +ğ
by‹s
;

982 
public
 
addNumEÁr›s
(
’Œ›s
) {

983 
	gnumEÁr›s
 +ğ
’Œ›s
;

	@runtime/src/main/java/org/corfudb/runtime/view/stream/AbstractStreamContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

18 
public
 
ab¡¿ù
 
şass
 
Ab¡¿ùSŒ—mCÚ‹xt
 
im¶em’ts


19 
	gCom·¿bË
<
	gAb¡¿ùSŒ—mCÚ‹xt
> {

24 
fš®
 
UUID
 
	gid
;

30 
fš®
 
	gmaxGlob®Add»ss
;

43 @
	gG‘‹r


44 @
S‘‹r


45 
´Ùeùed
 
	ggcTrimM¬k
 = 0;

51 @
G‘‹r


52 
´Ùeùed
 
	gglob®Poš‹r
;

62 
´Ùeùed
 
£tGlob®Poš‹rCheckGCTrimM¬k
(
glob®Poš‹r
) {

63 
v®id©eGlob®Poš‹rPos™iÚ
(
glob®Poš‹r
);

64 
	gthis
.
£tGlob®Poš‹r
(
glob®Poš‹r
);

67 
´Ùeùed
 
£tGlob®Poš‹r
(
glob®Poš‹r
) {

68 
	gthis
.
	gglob®Poš‹r
 = 
glob®Poš‹r
;

80 
´Ùeùed
 
v®id©eGlob®Poš‹rPos™iÚ
(
glob®Poš‹r
) {

81 ià(
	gglob®Poš‹r
 < 
	ggcTrimM¬k
 && glob®Poš‹¸> 
	gAdd»ss
.
	gNON_ADDRESS
) {

82 
throw
 
Ãw
 
TrimmedExû±iÚ
(
SŒšg
.
fÜm©
("Global…ointer…osition[%s] is in GCrim„ange. GC Trim mark: [%s]. This‡ddress isrimmed fromhe†og.",

83 
glob®Poš‹r
, 
gcTrimM¬k
));

93 
public
 
Ab¡¿ùSŒ—mCÚ‹xt
(
fš®
 
UUID
 
id
,

94 
fš®
 
maxGlob®Add»ss
) {

95 
	gthis
.
	gid
 = 
id
;

96 
	gthis
.
	gmaxGlob®Add»ss
 = 
maxGlob®Add»ss
;

97 
	gthis
.
£tGlob®Poš‹rCheckGCTrimM¬k
(
Add»ss
.
NON_ADDRESS
);

101 
»£t
() {

102 
	gglob®Poš‹r
 = 
Add»ss
.
NON_ADDRESS
;

109 
£ek
(
glob®Add»ss
) {

115 
	gglob®Poš‹r
 = 
glob®Add»ss
 - 1;

121 @
Ov”ride


122 
public
 
com·»To
(
Ab¡¿ùSŒ—mCÚ‹xt
 
o
) {

123  
	gLÚg
.
com·»
(
this
.
maxGlob®Add»ss
, 
o
.maxGlobalAddress);

	@runtime/src/main/java/org/corfudb/runtime/view/stream/AddressMapStreamView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gSÜ‹dS‘
;

7 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

11 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

13 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gI‹¿bËs
;

14 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—mAdd»ssRªge
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

24 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

42 @
Slf4j


43 
public
 cÏs 
	cAdd»ssM­SŒ—mV›w
 
ex‹nds
 
	mAb¡¿ùQueuedSŒ—mV›w
 {

45 
´iv©e
 
fš®
 
	mDIFF_CONSECUTIVE_ADDRESSES
 = 1;

47 
´iv©e
 
	madd»ssCouÁ
 = 0L;

54 
public
 
Add»ssM­SŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

55 
fš®
 
UUID
 
¡»amId
,

56 @
NÚnuÎ
 
fš®
 
SŒ—mO±iÚs
 
İtiÚs
) {

57 
su³r
(
ruÁime
, 
¡»amId
, 
İtiÚs
);

60 
public
 
	$Add»ssM­SŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

61 
fš®
 
UUID
 
¡»amId
) {

62 
	`this
(
ruÁime
, 
¡»amId
, 
SŒ—mO±iÚs
.
DEFAULT
);

63 
	}
}

65 @
Ov”ride


66 
´Ùeùed
 
ILogD©a
 
»moveFromQueue
(
NavigabËS‘
<
LÚg
> 
queue
) {

67 
boŞ—n
 
	g»adNext
;

68 
ILogD©a
 
	gld
 = 
nuÎ
;

69 
LÚg
 
	gcu¼’tR—d
;

72 
	gcu¼’tR—d
 = 
queue
.
pŞlFœ¡
();

74 ià(
	gcu¼’tR—d
 =ğ
nuÎ
) {

76  
nuÎ
;

79 
	gŒy
 {

85 
	gld
 = 
»ad
(
cu¼’tR—d
, 
queue
);

87 ià(
	gqueue
 =ğ
g‘Cu¼’tCÚ‹xt
().
»adQueue
 && 
ld
 !ğ
nuÎ
) {

91 ià(
ld
.
cÚšsSŒ—m
(
this
.
id
è&&†d.
g‘Ty³
(è=ğ
D©aTy³
.
DATA
) {

92 
addToResŞvedQueue
(
g‘Cu¼’tCÚ‹xt
(), 
cu¼’tR—d
);

93 
	g»adNext
 = 
çl£
;

95 
	glog
.
Œaû
("getNextEntry[{}]:he data for‡ddress {} does‚ot belongohis stream. Skip.",

96 
this
, 
cu¼’tR—d
);

98 
	g»adNext
 = 
Œue
;

101 
	g»adNext
 = 
çl£
;

103 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

108 ià(!
g‘R—dO±iÚs
().
isIgnÜeTrim
()) {

109 
throw
 
	g‹
;

112 
	glog
.
debug
("»moveFromQueue[{}]: ignÜšgrimmed‡dd»s£ {}", 
this
, 
‹
.
g‘TrimmedAdd»s£s
());

114 
	g‹
.
g‘TrimmedAdd»s£s
().
fÜEach
(
add»ss
 -> 
queue
.
»move
(address));

118 
	g»adNext
 = 
Œue
;

120 } 
	g»adNext
);

122  
	gld
;

139 @
Ov”ride


140 
´Ùeùed
 
boŞ—n
 
discov”Add»ssS·û
(
fš®
 
UUID
 
¡»amId
,

141 
fš®
 
NavigabËS‘
<
LÚg
> 
queue
,

142 
fš®
 
¡¬tAdd»ss
,

143 
fš®
 
¡İAdd»ss
,

144 
fš®
 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
f‹r
,

145 
fš®
 
boŞ—n
 
checkpošt
,

146 
fš®
 
maxGlob®
) {

151 ià(
	gAdd»ss
.
isAdd»ss
(
¡¬tAdd»ss
è&& (
	g¡¬tAdd»ss
 > 
	g¡İAdd»ss
)) {

153 
SŒ—mAdd»ssS·û
 
	g¡»amAdd»ssS·û
 = 
g‘SŒ—mAdd»ssM­
(
¡¬tAdd»ss
, 
¡İAdd»ss
, 
¡»amId
);

155 ià(
	gcheckpošt
) {

156 
´oûssCheckpošt
(
¡»amAdd»ssS·û
, 
f‹r
, 
queue
);

161 
	gqueue
.
addAÎ
(
¡»amAdd»ssS·û
.
cİyAdd»s£sToS‘
(
maxGlob®
));

163 
	gŒimM¬k
 = 
¡»amAdd»ssS·û
.
g‘TrimM¬k
();

168 ià(!
isCheckpoštC­abË
()

169 && 
	gAdd»ss
.
isAdd»ss
(
ŒimM¬k
)

170 && 
	gŒimM¬k
 > 
	g¡İAdd»ss
) {

171 
SŒšg
 
	gmes§ge
 = SŒšg.
fÜm©
("getStreamAddressMap[{%s}] stream has been " +

174 "thcheckpošˆÿ·b™y.", 
this
, 
ŒimM¬k
, 
¡İAdd»ss
);

175 
	glog
.
šfo
(
mes§ge
);

176 
throw
 
Ãw
 
TrimmedExû±iÚ
(
mes§ge
);

181 ià(
isCheckpoštC­abË
()

182 && 
	gAdd»ss
.
isAdd»ss
(
ŒimM¬k
)

183 && !
isTrimCov”edByCheckpoštOrLoÿlV›w
(
ŒimM¬k
)) {

184 ià(
g‘R—dO±iÚs
().
isIgnÜeTrim
()) {

185 
	glog
.
debug
("getStreamAddressMap[{}]: Ignoringrimmedƒxception for‡ddress[{}].",

186 
this
, 
¡»amAdd»ssS·û
.
g‘TrimM¬k
());

188 
SŒšg
 
	gmes§ge
 = SŒšg.
fÜm©
("getStreamAddressMap[{%s}] [%d, %d] " +

193 
this
, 
¡İAdd»ss
, 
¡¬tAdd»ss
, 
ŒimM¬k
,

194 
g‘Cu¼’tCÚ‹xt
().
g‘Checkpošt
().
¡¬tAdd»ss
, 
maxGlob®
);

195 
throw
 
Ãw
 
TrimmedExû±iÚ
(
mes§ge
);

201 
	gadd»ssCouÁ
 +ğ
queue
.
size
();

202  !
	gqueue
.
isEm±y
();

205 
´iv©e
 
´oûssCheckpošt
(
SŒ—mAdd»ssS·û
 
¡»amAdd»ssS·û
, 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
f‹r
,

206 
NavigabËS‘
<
LÚg
> 
queue
) {

207 
	gSÜ‹dS‘
<
	gLÚg
> 
	gcheckpoštAdd»s£s
 = 
Ãw
 
T»eS‘
<>(
CŞËùiÚs
.
»v”£Ord”
());

208 
	g¡»amAdd»ssS·û
.
g‘Add»ssM­
().
fÜEach
(
checkpoštAdd»s£s
::
add
);

218 
	gI‹¿bË
<
	gLi¡
<
	gLÚg
>> 
	gb©ches
 = 
I‹¿bËs
.
·¹™iÚ
(
checkpoštAdd»s£s
,

219 
ruÁime
.
g‘P¬am‘”s
().
g‘CheckpoštR—dB©chSize
());

221 
	gLi¡
<
	gLÚg
> 
	gb©ch
 : 
b©ches
) {

222 
Œy
 {

223 
Li¡
<
ILogD©a
> 
’Œ›s
 = 
»adAÎ
(
b©ch
);

224 
ILogD©a
 
	gd©a
 : 
’Œ›s
) {

225 
f‹r
.
­¶y
(
d©a
);

227 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

228 
	glog
.
w¬n
("´oûssCheckpošt:rimmed‡dd»s£ {}", 
‹
.
g‘TrimmedAdd»s£s
());

232 
´oûssCheckpoštB©chByEÁry
(
b©ch
, 
f‹r
);

241 
	gLi¡
<
	gLÚg
> 
	gcheckpoštEÁr›s
 = 
»sŞveCheckpošt
(
g‘Cu¼’tCÚ‹xt
());

242 
	gqueue
.
addAÎ
(
checkpoštEÁr›s
);

254 
´iv©e
 
´oûssCheckpoštB©chByEÁry
(
Li¡
<
LÚg
> 
b©ch
,

255 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
f‹r
) {

256 
	glog
.
debug
("´oûssCheckpoštB©chByEÁry[{}]: sšgË s‹°aüos {}", 
this
, 
b©ch
);

257 
	gŒy
 {

258 
boŞ—n
 
	gcheckpoštResŞved
;

259 
	gadd»ss
 : 
b©ch
) {

260 
ILogD©a
 
d©a
 = 
»ad
(
add»ss
);

261 
	gcheckpoštResŞved
 = 
f‹r
.
­¶y
(
d©a
);

262 ià(
	gcheckpoštResŞved
) {

267 } 
ÿtch
 (
TrimmedExû±iÚ
 
¡e
) {

275 
´iv©e
 
SŒ—mAdd»ssS·û
 
	$g‘SŒ—mAdd»ssM­
(
¡¬tAdd»ss
, 
¡İAdd»ss
, 
UUID
 
¡»amId
) {

277 ià(
¡¬tAdd»ss
 - 
¡İAdd»ss
 > 
DIFF_CONSECUTIVE_ADDRESSES
) {

278 
log
.
	`Œaû
("g‘SŒ—mAdd»ssM­[{}] g‘‡dd»s£ äom {}Ø{}", 
this
, 
¡¬tAdd»ss
, 
¡İAdd»ss
);

283 if(
	`isAdd»ssToBackpoš‹rResŞved
(
¡¬tAdd»ss
, 
¡»amId
)) {

284  
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
, 
Rßršg64NavigabËM­
.
	`b™m­Of
(
¡¬tAdd»ss
));

287 
log
.
	`Œaû
("getStreamAddressMap[{}]:„equest stream‡ddress space between {}‡nd {}.",

288 
¡»amId
, 
¡¬tAdd»ss
, 
¡İAdd»ss
);

289  
ruÁime
.
	`g‘Sequ’ûrV›w
()

290 .
	`g‘SŒ—mAdd»ssS·û
(
Ãw
 
	`SŒ—mAdd»ssRªge
(
¡»amId
, 
¡¬tAdd»ss
, 
¡İAdd»ss
));

295  
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
, 
Rßršg64NavigabËM­
.
	`b™m­Of
(
¡¬tAdd»ss
));

296 
	}
}

298 
´iv©e
 
boŞ—n
 
	$isAdd»ssToBackpoš‹rResŞved
(
¡¬tAdd»ss
, 
UUID
 
¡»amId
) {

299 
ILogD©a
 
d
;

300 
Œy
 {

301 
d
 = 
	`»ad
(
¡¬tAdd»ss
);

302 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
e
) {

303 ià(
	`g‘R—dO±iÚs
().
	`isIgnÜeTrim
()) {

304 
log
.
	`debug
("isAddressToBackpointerResolved[{}]: Ignoringrimmedƒxception for‡ddress[{}]," +

305 " sŒ—m[{}]", 
this
, 
¡¬tAdd»ss
, 
¡»amId
);

306  
çl£
;

310 
log
.
	`šfo
("getStreamAddressMap[{}]; Attemptingo„esolve backpointer for {} but‡ddress isrimmed. " +

312 
this
, 
¡¬tAdd»ss
);

313 
throw
 
e
;

317 ià(
d
.
	`hasBackpoš‹r
(
¡»amId
)) {

318 
´eviousAdd»ss
 = 
d
.
	`g‘Backpoš‹r
(
¡»amId
);

319 
log
.
	`Œaû
("getStreamAddressMap[{}]: backpointer for {}…ointso {}",

320 
¡»amId
, 
¡¬tAdd»ss
, 
´eviousAdd»ss
);

322 ià((
Add»ss
.
	`isAdd»ss
(
´eviousAdd»ss
) &&

323 
	`g‘Cu¼’tCÚ‹xt
().
»sŞvedQueue
.
	`cÚšs
(
´eviousAdd»ss
))

324 || 
´eviousAdd»ss
 =ğ
Add»ss
.
NON_EXIST
) {

325 
log
.
	`Œaû
("getStreamAddressMap[{}]: backpointer {} is†ocally…resent, do‚ot„equest " +

326 "¡»am‡dd»s m­.", 
¡»amId
, 
´eviousAdd»ss
);

327  
Œue
;

331  
çl£
;

332 
	}
}

343 
´iv©e
 
boŞ—n
 
	$isTrimCov”edByCheckpoštOrLoÿlV›w
(
ŒimM¬k
) {

344  
	`isTrimResŞvedLoÿÎy
(
ŒimM¬k
) ||

345 
	`isTrimCov”edByCheckpošt
(
ŒimM¬k
);

346 
	}
}

348 
´iv©e
 
boŞ—n
 
	$isTrimResŞvedLoÿÎy
(
ŒimM¬k
) {

349  
	`g‘Cu¼’tCÚ‹xt
().
	`g‘Checkpošt
().
id
 =ğ
nuÎ


350 && 
	`g‘Cu¼’tCÚ‹xt
().
»sŞvedQueue
.
	`cÚšs
(
ŒimM¬k
);

351 
	}
}

353 
´iv©e
 
boŞ—n
 
	$isTrimCov”edByCheckpošt
(
ŒimM¬k
) {

354  
	`g‘Cu¼’tCÚ‹xt
().
	`g‘Checkpošt
().
id
 !ğ
nuÎ
 &&

355 
	`g‘Cu¼’tCÚ‹xt
().
	`g‘Checkpošt
().
¡¬tAdd»ss
 >ğ
ŒimM¬k
;

356 
	}
}

363 
´iv©e
 
boŞ—n
 
	$isCheckpoštC­abË
() {

364  !
	`g‘Id
().
	`equ®s
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
);

365 
	}
}

367 @
Ov”ride


368 
public
 
	$g‘TÙ®Upd©es
() {

369  
add»ssCouÁ
;

370 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/stream/BackpointerStreamView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

10 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

11 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

12 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

23 @
Slf4j


24 
public
 cÏs 
	cBackpoš‹rSŒ—mV›w
 
ex‹nds
 
	mAb¡¿ùQueuedSŒ—mV›w
 {

31 
public
 
Backpoš‹rSŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

32 
fš®
 
UUID
 
¡»amId
,

33 @
NÚnuÎ
 
fš®
 
SŒ—mO±iÚs
 
İtiÚs
) {

34 
su³r
(
ruÁime
, 
¡»amId
, 
İtiÚs
);

37 
public
 
	$Backpoš‹rSŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

38 
fš®
 
UUID
 
¡»amId
) {

39 
	`this
(
ruÁime
, 
¡»amId
, 
SŒ—mO±iÚs
.
DEFAULT
);

40 
	}
}

42 @
Ov”ride


43 
´Ùeùed
 
ILogD©a
 
»moveFromQueue
(
NavigabËS‘
<
LÚg
> 
queue
) {

44 
boŞ—n
 
	g»adNext
;

45 
LÚg
 
	gthisR—d
;

46 
ILogD©a
 
	gld
;

49 ià(
	gqueue
.
isEm±y
()) {

51 
	g»adNext
 = 
çl£
;

55 
	gthisR—d
 = 
queue
.
pŞlFœ¡
();

56 
	gŒy
 {

57 
	gld
 = 
»ad
(
thisR—d
);

58 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

59 ià(!
g‘R—dO±iÚs
().
isIgnÜeTrim
()) {

60 
throw
 
	g‹
;

63 
	g»adNext
 = 
Œue
;

67 ià(
	gqueue
 =ğ
g‘Cu¼’tCÚ‹xt
().
»adQueue
 && 
ld
 !ğ
nuÎ
) {

68 
addToResŞvedQueue
(
g‘Cu¼’tCÚ‹xt
(), 
thisR—d
);

70  
	gld
;

71 } 
	g»adNext
);

73  
	gnuÎ
;

76 
´iv©e
 
	gbackpoš‹rCouÁ
 = 0L;

78 @
Ov”ride


79 
public
 
	$g‘TÙ®Upd©es
() {

80  
backpoš‹rCouÁ
;

81 
	}
}

83 
´Ùeùed
 
boŞ—n
 
discov”Add»ssS·û
(
fš®
 
UUID
 
¡»amId
,

84 
fš®
 
NavigabËS‘
<
LÚg
> 
queue
,

85 
fš®
 
¡¬tAdd»ss
,

86 
fš®
 
¡İAdd»ss
,

87 
fš®
 
FunùiÚ
<
ILogD©a
, 
BoŞ—n
> 
f‹r
,

88 
fš®
 
boŞ—n
 
checkpošt
,

89 
fš®
 
maxGlob®
) {

97 
	glog
.
Œaû
("followBackpointers: streamId[{}], queue[{}], startAddress[{}], stopAddress[{}]," +

98 "f‹r[{}]", 
¡»amId
, 
queue
, 
¡¬tAdd»ss
, 
¡İAdd»ss
, 
f‹r
);

99 
	g»adS¹Time
 = 
Sy¡em
.
cu¼’tTimeMlis
();

102 
	gcu¼’tAdd»ss
 = 
¡¬tAdd»ss
;

104 
boŞ—n
 
	g¡¬tšgSšgËS‹p
 = 
Œue
;

107 
	gcu¼’tAdd»ss
 > 
	g¡İAdd»ss
 && 
	gAdd»ss
.
isAdd»ss
(
cu¼’tAdd»ss
)) {

108 
	gbackpoš‹rCouÁ
++;

111 
ILogD©a
 
	gd
;

112 
	gŒy
 {

113 
	glog
.
Œaû
("fŞlowBackpoš‹rs:„—dAdd»ss[{}]", 
cu¼’tAdd»ss
);

114 
	gd
 = 
»ad
(
cu¼’tAdd»ss
, 
»adS¹Time
);

115 } 
ÿtch
 (
TrimmedExû±iÚ
 
e
) {

116 ià(
g‘R—dO±iÚs
().
isIgnÜeTrim
()) {

117 
	glog
.
w¬n
("followBackpointers: Ignoringrimmedƒxception for‡ddress[{}]," +

118 " sŒ—m[{}]", 
cu¼’tAdd»ss
, 
id
);

119  !
	gqueue
.
isEm±y
();

121 
throw
 
	ge
;

126 ià(
	gd
.
cÚšsSŒ—m
(
¡»amId
)) {

127 
	glog
.
Œaû
("fŞlowBackpoš‹rs:‡dd»ss[{}] cÚš ¡»amId[{}],‡µly f‹r", 
cu¼’tAdd»ss
,

128 
¡»amId
);

131 
	gf‹r
.
­¶y
(
d
);

133 ià(!
	gcheckpošt
) {

134 
	glog
.
Œaû
("fŞlowBackpoš‹rs: Addšg backpoš‹¸tØadd»ss[{}]Øqueue", 
cu¼’tAdd»ss
);

135 
	gqueue
.
add
(
cu¼’tAdd»ss
);

139 
boŞ—n
 
	gsšgËS‹p
 = 
Œue
;

143 
	glog
.
Œaû
("followBackpointers: calculatehe‚ext‡ddress");

145 ià(
	gd
.
hasBackpoš‹r
(
¡»amId
)) {

146 
	gtmp
 = 
d
.
g‘Backpoš‹r
(
¡»amId
);

147 
	glog
.
Œaû
("fŞlowBackpoš‹rs: backpoš‹¸pošt tØ{}", 
tmp
);

150 ià(
	gAdd»ss
.
isAdd»ss
(
tmp
è|| 
	gtmp
 =ğ
Add»ss
.
NON_EXIST
) {

151 
cu¼’tAdd»ss
 = 
tmp
;

152 
	gsšgËS‹p
 = 
çl£
;

153 ià(!
	g¡¬tšgSšgËS‹p
) {

155 
	glog
.
šfo
("followBackpointers[{}]: Found backpointer forhis stream‡t‡ddress {}."

156 + "Stİ sšgË s‹°downg¿de.", 
this
, 
cu¼’tAdd»ss
);

157 
	g¡¬tšgSšgËS‹p
 = 
Œue
;

162 ià(
	gsšgËS‹p
) {

163 ià(
	g¡¬tšgSšgËS‹p
) {

164 
	g¡¬tšgSšgËS‹p
 = 
çl£
;

165 
	glog
.
šfo
("followBackpointers[{}]: Found hole‡t‡ddress {}. Starting single step downgrade.",

166 
this
, 
cu¼’tAdd»ss
);

170 
	glog
.
Œaû
("fŞlowBackpoš‹rs[{}]: downg¿dšgØsšgË s‹p, found hŞ© {}", 
this
, 
cu¼’tAdd»ss
);

171 
	gcu¼’tAdd»ss
 = 
cu¼’tAdd»ss
 - 1;

175 ià(
	gcheckpošt
) {

176 
	gqueue
.
addAÎ
(
»sŞveCheckpošt
(
g‘Cu¼’tCÚ‹xt
()));

179  !
	gqueue
.
isEm±y
();

	@runtime/src/main/java/org/corfudb/runtime/view/stream/IStreamView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gS¶™”©Ü
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—mSuµÜt
;

11 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

12 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

25 
public
 
š‹rçû
 
ISŒ—mV›w
 
ex‹nds


26 
	gI‹¿tÜ
<
	gILogD©a
> {

31 
UUID
 
g‘Id
();

36 
»£t
();

42 
gc
(
ŒimM¬k
);

48 
£ek
(
glob®Add»ss
);

67 
­³nd
(
Objeù
 
objeù
,

68 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
acquis™iÚC®lback
,

69 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
d—cquis™iÚC®lback
);

76  
­³nd
(
Objeù
 
objeù
) {

77  
­³nd
(
objeù
, 
nuÎ
,‚ull);

86 @
NuÎabË


87  
ILogD©a
 
Ãxt
() {

88  
ÃxtUpTo
(
LÚg
.
MAX_VALUE
);

96 @
NuÎabË


97 
ILogD©a
 
´evious
();

105 @
NuÎabË


106 
ILogD©a
 
cu¼’t
();

116 @
NuÎabË


117 
ILogD©a
 
ÃxtUpTo
(
maxGlob®
);

130 @
NÚnuÎ


131  
	gLi¡
<
	gILogD©a
> 
»maššg
() {

132  
»maššgUpTo
(
Add»ss
.
MAX
);

144 
	gLi¡
<
	gILogD©a
> 
»maššgUpTo
(
maxGlob®
);

152 
boŞ—n
 
hasNext
();

159 
g‘Cu¼’tGlob®Pos™iÚ
();

164  
	gS¶™”©Ü
<
	gILogD©a
> 
¥l™”©Ü
() {

165  
Ãw
 
SŒ—mS¶™”©Ü
(
this
);

173  
	gS¶™”©Ü
<
	gILogD©a
> 
¥l™”©ÜUpTo
(
maxGlob®
) {

174  
Ãw
 
SŒ—mS¶™”©Ü
(
this
, 
maxGlob®
);

180  
	gSŒ—m
<
	gILogD©a
> 
¡»am
() {

181  
	gSŒ—mSuµÜt
.
¡»am
(
¥l™”©Ü
(), 
çl£
);

189  
	gSŒ—m
<
	gILogD©a
> 
¡»amUpTo
(
maxGlob®
) {

190  
	gSŒ—mSuµÜt
.
¡»am
(
¥l™”©ÜUpTo
(
maxGlob®
), 
çl£
);

198 
g‘TÙ®Upd©es
();

	@runtime/src/main/java/org/corfudb/runtime/view/stream/OpaqueStream.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gICÜfuPaylßd
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

13 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

14 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

15 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

18 
public
 cÏs 
	cO·queSŒ—m
 {

22 
fš®
 
ISŒ—mV›w
 
	m¡»amV›w
;

27 
fš®
 
CÜfuRuÁime
 
	mruÁime
;

29 
public
 
	$O·queSŒ—m
(
CÜfuRuÁime
 
ruÁime
, 
ISŒ—mV›w
 
¡»amV›w
) {

30 
this
.
ruÁime
 =„untime;

31 
this
.
¡»amV›w
 = streamView;

34 
´iv©e
 
O·queEÁry
 
	$´oûssLogD©a
(
ILogD©a
 
logD©a
) {

35 ià(
logD©a
 =ğ
nuÎ
) {

36  
nuÎ
;

39 ià(
logD©a
.
	`isHŞe
()) {

40 
CŞËùiÚs
.
	`em±yLi¡
();

42 } ià(
logD©a
.
	`isTrimmed
()) {

43 
throw
 
Ãw
 
	`TrimmedExû±iÚ
();

44 } ià(
logD©a
.
	`isEm±y
()) {

45 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Em±y slÙ‚Ùƒx³ùed!" + 
logD©a
.
	`g‘Glob®Add»ss
());

48 ià(!
logD©a
.
	`isD©a
()) {

49 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Must have‡…ayload");

52  
O·queEÁry
.
	`uÅack
(
logD©a
);

53 
	}
}

55 
public
 
	$pos
() {

56  
¡»amV›w
.
	`g‘Cu¼’tGlob®Pos™iÚ
();

57 
	}
}

59 
public
 
	$£ek
(
glob®Add»ss
) {

60 
¡»amV›w
.
	`£ek
(
glob®Add»ss
);

61 
	}
}

63 
public
 
	gSŒ—m
<
	gO·queEÁry
> 
	$¡»amUpTo
(
¢­shÙ
) {

64  
¡»amV›w
.
	`¡»amUpTo
(
¢­shÙ
)

65 .
	`f‹r
(
m
 -> m.
	`g‘Ty³
(è=ğ
D©aTy³
.
DATA
)

66 .
	`m­
(
this
::
´oûssLogD©a
)

67 .
	`f‹r
(
e
 -> !e.
	`g‘EÁr›s
().
	`isEm±y
());

69 
	}
}

71 
public
 
UUID
 
	$g‘Id
() {

72  
¡»amV›w
.
	`g‘Id
();

73 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/stream/StreamAddressSpace.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—mAdd»ssRªge
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

7 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gLÚgI‹¿tÜ
;

8 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gNavigabËS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

26 @
Slf4j


27 
public
 cÏs 
	cSŒ—mAdd»ssS·û
 {

29 
´iv©e
 
fš®
 
	mNO_ADDRESSES
 = 0;

34 
´iv©e
 
	mŒimM¬k
;

37 
´iv©e
 
fš®
 
Rßršg64NavigabËM­
 
	madd»ssM­
;

39 
public
 
	$SŒ—mAdd»ssS·û
(
ŒimM¬k
, 
Rßršg64NavigabËM­
 
add»ssM­
) {

40 
this
.
ŒimM¬k
 =rimMark;

41 
this
.
add»ssM­
 =‡ddressMap;

44 
public
 
Rßršg64NavigabËM­
 
	$g‘Add»ssM­
() {

45  
add»ssM­
;

46 
	}
}

53 
public
 
	gNavigabËS‘
<
	gLÚg
> 
	$cİyAdd»s£sToS‘
(
fš®
 
LÚg
 
maxGlob®
) {

54 
NavigabËS‘
<
LÚg
> 
queue
 = 
Ãw
 
T»eS‘
<>();

55 
this
.
add»ssM­
.
	`fÜEach
(
add»ss
 -> {

56 ià(
add»ss
 <ğ
maxGlob®
){

57 
queue
.
	`add
(
add»ss
);

61  
queue
;

62 
	}
}

69 
public
 
LÚg
 
	$g‘Ta
() {

71 ià(
add»ssM­
.
	`g‘LÚgC¬dš®™y
(è=ğ
NO_ADDRESSES
) {

72  
ŒimM¬k
;

76  
add»ssM­
.
	`g‘Rev”£LÚgI‹¿tÜ
().
	`Ãxt
();

77 
	}
}

84 
public
 
	$addAdd»ss
(
add»ss
) {

85 
add»ssM­
.
	`addLÚg
(
add»ss
);

86 
	}
}

92 
public
 
»moveAdd»s£s
(
Li¡
<
LÚg
> 
add»s£s
) {

93 
	gadd»s£s
.
¡»am
().
fÜEach
(
add»ssM­
::
»moveLÚg
);

96 
	gadd»ssM­
.
Œim
();

97 
	gŒimM¬k
 = 
CŞËùiÚs
.
max
(
add»s£s
);

99 
	glog
.
Œaû
("»moveAdd»s£s:‚ewrim m¬k s‘Ø{}", 
ŒimM¬k
);

107 
public
 
	$Œim
(
LÚg
 
ŒimM¬k
) {

108 ià(!
Add»ss
.
	`isAdd»ss
(
ŒimM¬k
)) {

116 
numAdd»s£sToTrim
 = 
add»ssM­
.
	`¿nkLÚg
(
ŒimM¬k
);

118 ià(
numAdd»s£sToTrim
 <ğ
NO_ADDRESSES
) {

122 
Li¡
<
LÚg
> 
add»s£sToTrim
 = 
Ãw
 
A¼ayLi¡
<>();

123 
LÚgI‹¿tÜ
 
™
 = 
add»ssM­
.
	`g‘LÚgI‹¿tÜ
();

124 
i
 = 0; i < 
numAdd»s£sToTrim
; i++) {

125 
add»s£sToTrim
.
	`add
(
™
.
	`Ãxt
());

128 
log
.
	`Œaû
("Œim: Remov{}‡dd»s£ fÜrim m¬k {}", 
add»s£sToTrim
.
	`size
(), 
ŒimM¬k
);

131 ià(!
add»s£sToTrim
.
	`isEm±y
()) {

132 
	`»moveAdd»s£s
(
add»s£sToTrim
);

134 
	}
}

141 
public
 
Rßršg64NavigabËM­
 
	$g‘Add»s£sInRªge
(
SŒ—mAdd»ssRªge
 
¿nge
) {

142 
Rßršg64NavigabËM­
 
add»s£sInRªge
 = 
Ãw
 
	`Rßršg64NavigabËM­
();

143 ià(
¿nge
.
	`g‘S¹
(è>„ªge.
	`g‘End
()) {

144 
add»ssM­
.
	`fÜEach
(
add»ss
 -> {

146 ià(
add»ss
 > 
¿nge
.
	`g‘End
(è&&‡dd»s <ğ¿nge.
	`g‘S¹
()) {

147 
add»s£sInRªge
.
	`add
(
add»ss
);

152 
log
.
	`Œaû
("getAddressesInRange[{}]:‡ddress map in„ange [{}-{}] has‡otal of {}‡ddresses.",

153 
Uts
.
	`toR—dabËId
(
¿nge
.
	`g‘SŒ—mID
()),„ªge.
	`g‘End
(),

154 
¿nge
.
	`g‘S¹
(), 
add»s£sInRªge
.
	`g‘LÚgC¬dš®™y
());

156  
add»s£sInRªge
;

157 
	}
}

159 
public
 
	$£tTrimM¬k
(
ŒimM¬k
) {

160 
this
.
ŒimM¬k
 =rimMark;

161 
	}
}

163 
public
 
	$g‘TrimM¬k
() {

164  
ŒimM¬k
;

165 
	}
}

167 
public
 
	$g‘Lowe¡Add»ss
() {

168 ià(
add»ssM­
.
	`isEm±y
()) {

169  
Add»ss
.
NON_EXIST
;

172  
add»ssM­
.
	`™”©Ü
().
	`Ãxt
();

173 
	}
}

175 
public
 
	$g‘Highe¡Add»ss
() {

176 ià(
add»ssM­
.
	`isEm±y
()) {

177  
Add»ss
.
NON_EXIST
;

180  
add»ssM­
.
	`g‘Rev”£LÚgI‹¿tÜ
().
	`Ãxt
();

181 
	}
}

183 @
Ov”ride


184 
public
 
SŒšg
 
	$toSŒšg
() {

185  
SŒšg
.
	`fÜm©
("[%s, %s]@%s", 
	`g‘Lowe¡Add»ss
(), 
	`g‘Highe¡Add»ss
(), 
ŒimM¬k
);

186 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/stream/StreamSpliterator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

4 
impÜt
 
	gjava
.
	gut
.
	gS¶™”©Ü
;

5 
impÜt
 
	gjava
.
	gut
.
	gS¶™”©Üs
;

6 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

26 @
Slf4j


27 
public
 
şass
 
SŒ—mS¶™”©Ü
 
ex‹nds
 
	gS¶™”©Üs
.
	gAb¡¿ùS¶™”©Ü
<
	gILogD©a
> {

30 
fš®
 
ISŒ—mV›w
 
	g¡»amV›w
;

33 
fš®
 
	gmaxGlob®
;

38 
public
 
SŒ—mS¶™”©Ü
(
ISŒ—mV›w
 
v›w
) {

39 
this
(
v›w
, 
Add»ss
.
MAX
);

46 
public
 
SŒ—mS¶™”©Ü
(
ISŒ—mV›w
 
v›w
, 
maxGlob®
) {

47 
su³r
(
maxGlob®
 - 
v›w
.
g‘Cu¼’tGlob®Pos™iÚ
(),

48 
S¶™”©Ü
.
ORDERED
 | S¶™”©Ü.
SORTED
);

49 
	g¡»amV›w
 = 
v›w
;

50 
	gthis
.
	gmaxGlob®
 = 
maxGlob®
;

56 @
Ov”ride


57 
public
 
boŞ—n
 
ŒyAdvªû
(
CÚsum”
<? 
su³r
 
ILogD©a
> 
aùiÚ
) {

59 
ILogD©a
 
	gÃxt
 = 
¡»amV›w
.
ÃxtUpTo
(
maxGlob®
);

61 ià(
	gÃxt
 =ğ
nuÎ
) {

62  
çl£
;

65 
	gaùiÚ
.
acû±
(
Ãxt
);

66  
	gŒue
;

72 @
Ov”ride


73 
public
 
	gCom·¿tÜ
<? 
su³r
 
	gILogD©a
> 
g‘Com·¿tÜ
() {

74  
	gILogD©a
::
com·»To
;

	@runtime/src/main/java/org/corfudb/runtime/view/stream/ThreadSafeStreamView.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

9 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

12 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

20 
public
 cÏs 
	cTh»adSaãSŒ—mV›w
 
im¶em’ts
 
	mISŒ—mV›w
 {

22 
´iv©e
 
fš®
 
ISŒ—mV›w
 
	m¡»am
;

24 
public
 
Th»adSaãSŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

25 
fš®
 
UUID
 
¡»amId
,

26 @
NÚnuÎ
 
fš®
 
SŒ—mO±iÚs
 
İtiÚs
) {

27 ià(
	mruÁime
.
g‘P¬am‘”s
().
isFŞlowBackpoš‹rsEÇbËd
()) {

28 
	m¡»am
 = 
Ãw
 
Backpoš‹rSŒ—mV›w
(
ruÁime
, 
¡»amId
, 
İtiÚs
);

30 
	m¡»am
 = 
Ãw
 
Add»ssM­SŒ—mV›w
(
ruÁime
, 
¡»amId
, 
İtiÚs
);

34 
public
 
	$Th»adSaãSŒ—mV›w
(
fš®
 
CÜfuRuÁime
 
ruÁime
,

35 
fš®
 
UUID
 
¡»amId
) {

36 ià(
ruÁime
.
	`g‘P¬am‘”s
().
	`isFŞlowBackpoš‹rsEÇbËd
()) {

37 
¡»am
 = 
Ãw
 
	`Backpoš‹rSŒ—mV›w
(
ruÁime
, 
¡»amId
, 
SŒ—mO±iÚs
.
DEFAULT
);

39 
¡»am
 = 
Ãw
 
	`Add»ssM­SŒ—mV›w
(
ruÁime
, 
¡»amId
, 
SŒ—mO±iÚs
.
DEFAULT
);

41 
	}
}

43 @
Ov”ride


44 
public
 
UUID
 
	$g‘Id
() {

45  
¡»am
.
	`g‘Id
();

46 
	}
}

48 @
Ov”ride


49 
public
 
synchrÚized
 
	$»£t
() {

50 
¡»am
.
	`»£t
();

51 
	}
}

53 @
Ov”ride


54 
public
 
synchrÚized
 
	$gc
(
ŒimM¬k
) {

55 
¡»am
.
	`gc
(
ŒimM¬k
);

56 
	}
}

58 @
Ov”ride


59 
public
 
synchrÚized
 
	$£ek
(
glob®Add»ss
) {

60 
¡»am
.
	`£ek
(
glob®Add»ss
);

61 
	}
}

63 @
Ov”ride


64 
public
 
synchrÚized
 
­³nd
(
Objeù
 
objeù
,

65 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
acquis™iÚC®lback
,

66 
FunùiÚ
<
Tok’Re¥Ú£
, 
BoŞ—n
> 
d—cquis™iÚC®lback
) {

67  
	g¡»am
.
­³nd
(
objeù
, 
acquis™iÚC®lback
, 
d—cquis™iÚC®lback
);

70 @
Ov”ride


71 
public
 
synchrÚized
 
ILogD©a
 
	$Ãxt
() {

72  
¡»am
.
	`Ãxt
();

73 
	}
}

75 @
Ov”ride


76 
public
 
synchrÚized
 
ILogD©a
 
	$´evious
() {

77  
¡»am
.
	`´evious
();

78 
	}
}

80 @
Ov”ride


81 
public
 
synchrÚized
 
ILogD©a
 
	$cu¼’t
() {

82  
¡»am
.
	`cu¼’t
();

83 
	}
}

85 @
Ov”ride


86 
public
 
synchrÚized
 
ILogD©a
 
	$ÃxtUpTo
(
maxGlob®
) {

87  
¡»am
.
	`ÃxtUpTo
(
maxGlob®
);

88 
	}
}

90 @
Ov”ride


91 
public
 
synchrÚized
 
	gLi¡
<
	gILogD©a
> 
	$»maššgUpTo
(
maxGlob®
) {

92  
¡»am
.
	`»maššgUpTo
(
maxGlob®
);

93 
	}
}

95 @
Ov”ride


96 
public
 
synchrÚized
 
boŞ—n
 
	$hasNext
() {

97  
¡»am
.
	`hasNext
();

98 
	}
}

100 @
Ov”ride


101 
public
 
synchrÚized
 
	$g‘Cu¼’tGlob®Pos™iÚ
() {

102  
¡»am
.
	`g‘Cu¼’tGlob®Pos™iÚ
();

103 
	}
}

105 @
Ov”ride


106 
public
 
	$g‘TÙ®Upd©es
() {

107  
¡»am
.
	`g‘TÙ®Upd©es
();

108 
	}
}

110 @
VisibËFÜTe¡šg


111 
ISŒ—mV›w
 
	$g‘Und”lyšgSŒ—m
() {

112  
¡»am
;

113 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/workflows/AddNode.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£Cl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

12 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

23 @
Slf4j


24 
public
 cÏs 
	cAddNode
 
ex‹nds
 
	mWÜkæowReque¡
 {

29 
´iv©e
 
fš®
 
	mpšgR‘r›s
 = 3;

33 
´iv©e
 
fš®
 
Du¿tiÚ
 
	mpšgIÁ”v®
 = Du¿tiÚ.
ofMlis
(50);

35 
public
 
AddNode
(@
NÚNuÎ
 
SŒšg
 
’dpoštToAdd
, @NÚNuÎ 
CÜfuRuÁime
 
ruÁime
,

36 
»Œy
, @
NÚNuÎ
 
Du¿tiÚ
 
timeout
,

37 @
NÚNuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

38 
	mthis
.
	mnodeFÜWÜkæow
 = 
’dpoštToAdd
;

39 
	mthis
.
	mruÁime
 = 
ruÁime
;

40 
	mthis
.
	m»Œy
 = 
»Œy
;

41 
	mthis
.
	mtimeout
 = 
timeout
;

42 
	mthis
.
	mpŞlP”iod
 = 
pŞlP”iod
;

45 @
Ov”ride


46 
´Ùeùed
 
UUID
 
£ndReque¡
(@
NÚNuÎ
 
Mªagem’tCl›Á
 
mªagem’tCl›Á
è
throws
 
	gTimeoutExû±iÚ
 {

48 
Layout
 
	gÏyout
 = 
Ãw
 Layout(
ruÁime
.
g‘LayoutV›w
().
g‘Layout
());

49 
	gruÁime
.
g‘Mªagem’tV›w
().
boÙ¡¿pMªagem’tS”v”
(
nodeFÜWÜkæow
, 
Ïyout
).
još
();

51 
C»©eWÜkæowRe¥Ú£
 
	g»¥
 = 
mªagem’tCl›Á
.
addNodeReque¡
(
nodeFÜWÜkæow
);

52 
	glog
.
šfo
("sendRequest:„equestedo‡dd {} on orchestrator {}:{}",

53 
nodeFÜWÜkæow
, 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘Ho¡
(),

54 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘PÜt
());

55  
	g»¥
.
g‘WÜkæowId
();

58 @
Ov”ride


59 
´Ùeùed
 
boŞ—n
 
v”ifyReque¡
(@
NÚNuÎ
 
Layout
 
Ïyout
) {

61 
	glog
.
šfo
("v”ifyReque¡: {}Ø{}", 
this
, 
Ïyout
);

62  
	gÏyout
.
g‘AÎS”v”s
().
cÚšs
(
nodeFÜWÜkæow
)

63 && 
	gÏyout
.
g‘Segm’tsFÜEndpošt
(
nodeFÜWÜkæow
).
size
()

64 =ğ
Ïyout
.
g‘Segm’ts
().
size
();

67 @
Ov”ride


68 
public
 
SŒšg
 
	$toSŒšg
() {

69  
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
(è+ " " + 
nodeFÜWÜkæow
;

70 
	}
}

72 @
Ov”ride


73 
´Ùeùed
 
	gO±iÚ®
<
	gMªagem’tCl›Á
> 
	$g‘Orche¡¿tÜ
() {

74 
ruÁime
.
	`šv®id©eLayout
();

75 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

76 
Ba£Cl›Á
 
ba£Cl›Á
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘Ba£Cl›Á
(
nodeFÜWÜkæow
);

79 
i
 = 0; i < 
pšgR‘r›s
; i++) {

80 ià(
ba£Cl›Á
.
	`pšgSync
()) {

81 
log
.
	`šfo
("g‘Orche¡¿tÜ: orche¡¿tÜ s–eùed {}", 
nodeFÜWÜkæow
);

82  
O±iÚ®
.
	`of
(
ruÁime
.
	`g‘LayoutV›w
()

83 .
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘Mªagem’tCl›Á
(
nodeFÜWÜkæow
));

85 
SË•
.
	`¦“pUnš‹¼u±ibly
(
pšgIÁ”v®
);

86 
log
.
	`šfo
("R‘ryšgØpšg‡ cu¼’ˆba£ s”v” {}imes.", 
i
);

88 
log
.
	`w¬n
("g‘Orche¡¿tÜ:‡ s”v” {} i nÙ„e¥ÚdšgØpšgs", 
nodeFÜWÜkæow
);

89  
O±iÚ®
.
	`em±y
();

91 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/workflows/ForceRemoveNode.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

9 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

20 @
Slf4j


21 
public
 cÏs 
	cFÜûRemoveNode
 
ex‹nds
 
	mRemoveNode
 {

23 
public
 
FÜûRemoveNode
(@
NÚNuÎ
 
SŒšg
 
’dpoštToRemove
, @NÚNuÎ 
CÜfuRuÁime
 
ruÁime
,

24 
»Œy
, @
NÚNuÎ
 
Du¿tiÚ
 
timeout
,

25 @
NÚNuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

26 
su³r
(
’dpoštToRemove
, 
ruÁime
, 
»Œy
, 
timeout
, 
pŞlP”iod
);

29 @
Ov”ride


30 
´Ùeùed
 
UUID
 
£ndReque¡
(@
NÚNuÎ
 
Mªagem’tCl›Á
 
mªagem’tCl›Á
è
throws
 
	gTimeoutExû±iÚ
 {

32 
C»©eWÜkæowRe¥Ú£
 
	g»¥
 = 
mªagem’tCl›Á
.
fÜûRemoveNode
(
nodeFÜWÜkæow
);

33 
	glog
.
šfo
("sendRequest:„equestedo force„emove {} on orchestrator {}:{}",

34 
nodeFÜWÜkæow
, 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘Ho¡
(),

35 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘PÜt
());

36  
	g»¥
.
g‘WÜkæowId
();

39 @
Ov”ride


40 
public
 
SŒšg
 
	$toSŒšg
() {

41  
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
(è+ " " + 
nodeFÜWÜkæow
;

42 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/workflows/HealNode.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£Cl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

12 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

17 @
Slf4j


18 
public
 cÏs 
	cH—lNode
 
ex‹nds
 
	mWÜkæowReque¡
 {

20 
public
 
H—lNode
(@
NÚNuÎ
 
SŒšg
 
’dpoštToH—l
, @NÚNuÎ 
CÜfuRuÁime
 
ruÁime
,

21 
»Œy
, @
NÚNuÎ
 
Du¿tiÚ
 
timeout
,

22 @
NÚNuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

23 
	mthis
.
	mnodeFÜWÜkæow
 = 
’dpoštToH—l
;

24 
	mthis
.
	mruÁime
 = 
ruÁime
;

25 
	mthis
.
	m»Œy
 = 
»Œy
;

26 
	mthis
.
	mtimeout
 = 
timeout
;

27 
	mthis
.
	mpŞlP”iod
 = 
pŞlP”iod
;

30 @
Ov”ride


31 
´Ùeùed
 
UUID
 
£ndReque¡
(@
NÚNuÎ
 
Mªagem’tCl›Á
 
mªagem’tCl›Á
è
throws
 
	gTimeoutExû±iÚ
 {

32 
C»©eWÜkæowRe¥Ú£
 
	g»¥
 = 
mªagem’tCl›Á
.
h—lNodeReque¡
(
nodeFÜWÜkæow
,

33 
Œue
,rue,rue, 0);

34 
	glog
.
šfo
("sendRequest:„equestedo heal {} on orchestrator {}:{}",

35 
nodeFÜWÜkæow
, 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘Ho¡
(),

36 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘PÜt
());

37  
	g»¥
.
g‘WÜkæowId
();

40 @
Ov”ride


41 
´Ùeùed
 
boŞ—n
 
v”ifyReque¡
(@
NÚNuÎ
 
Layout
 
Ïyout
) {

42 
	glog
.
šfo
("v”ifyReque¡: {} iÀ{}", 
this
, 
Ïyout
);

43  
	gÏyout
.
g‘AÎS”v”s
().
cÚšs
(
nodeFÜWÜkæow
)

44 && 
	gÏyout
.
g‘Segm’tsFÜEndpošt
(
nodeFÜWÜkæow
).
size
()

45 =ğ
Ïyout
.
g‘Segm’ts
().
size
();

48 @
Ov”ride


49 
public
 
SŒšg
 
	$toSŒšg
() {

50  
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
(è+ " " + 
nodeFÜWÜkæow
;

51 
	}
}

53 @
Ov”ride


54 
´Ùeùed
 
	gO±iÚ®
<
	gMªagem’tCl›Á
> 
	$g‘Orche¡¿tÜ
() {

55 
ruÁime
.
	`šv®id©eLayout
();

56 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

57 
Ba£Cl›Á
 
ba£Cl›Á
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘Ba£Cl›Á
(
nodeFÜWÜkæow
);

58 ià(
ba£Cl›Á
.
	`pšgSync
()) {

59 
log
.
	`šfo
("g‘Orche¡¿tÜ: orche¡¿tÜ s–eùed {}", 
nodeFÜWÜkæow
);

60  
O±iÚ®
.
	`of
(
ruÁime
.
	`g‘LayoutV›w
()

61 .
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘Mªagem’tCl›Á
(
nodeFÜWÜkæow
));

63 
log
.
	`w¬n
("g‘Orche¡¿tÜ:‡ s”v” {} i nÙ„e¥ÚdšgØpšgs", 
nodeFÜWÜkæow
);

64  
O±iÚ®
.
	`em±y
();

66 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/workflows/RemoveNode.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

11 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

20 @
Slf4j


21 
public
 cÏs 
	cRemoveNode
 
ex‹nds
 
	mWÜkæowReque¡
 {

23 
public
 
RemoveNode
(@
NÚNuÎ
 
SŒšg
 
’dpoštToRemove
, @NÚNuÎ 
CÜfuRuÁime
 
ruÁime
,

24 
»Œy
, @
NÚNuÎ
 
Du¿tiÚ
 
timeout
,

25 @
NÚNuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

26 
	mthis
.
	mnodeFÜWÜkæow
 = 
’dpoštToRemove
;

27 
	mthis
.
	mruÁime
 = 
ruÁime
;

28 
	mthis
.
	m»Œy
 = 
»Œy
;

29 
	mthis
.
	mtimeout
 = 
timeout
;

30 
	mthis
.
	mpŞlP”iod
 = 
pŞlP”iod
;

33 @
Ov”ride


34 
´Ùeùed
 
UUID
 
£ndReque¡
(@
NÚNuÎ
 
Mªagem’tCl›Á
 
mªagem’tCl›Á
è
throws
 
	gTimeoutExû±iÚ
 {

37 
C»©eWÜkæowRe¥Ú£
 
	g»¥
 = 
mªagem’tCl›Á
.
»moveNode
(
nodeFÜWÜkæow
);

38 
	glog
.
šfo
("sendRequest:„equestedo„emove {} on orchestrator {}:{}",

39 
nodeFÜWÜkæow
, 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘Ho¡
(),

40 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘PÜt
());

41  
	g»¥
.
g‘WÜkæowId
();

44 @
Ov”ride


45 
´Ùeùed
 
boŞ—n
 
v”ifyReque¡
(@
NÚNuÎ
 
Layout
 
Ïyout
) {

46 
	glog
.
šfo
("v”ifyReque¡: {} from {}", 
this
, 
Ïyout
);

48  !
	gÏyout
.
g‘AÎS”v”s
().
cÚšs
(
nodeFÜWÜkæow
);

51 @
Ov”ride


52 
public
 
SŒšg
 
	$toSŒšg
() {

53  
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
(è+ " " + 
nodeFÜWÜkæow
;

54 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/workflows/RestoreRedundancyMergeSegments.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gC»©eWÜkæowRe¥Ú£
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£Cl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

12 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

20 @
Slf4j


21 
public
 cÏs 
	cRe¡ÜeRedundªcyM”geSegm’ts
 
ex‹nds
 
	mWÜkæowReque¡
 {

32 
public
 
Re¡ÜeRedundªcyM”geSegm’ts
(@
NÚNuÎ
 
SŒšg
 
’dpoštToRe¡ÜeRedundªcy
,

33 @
NÚNuÎ
 
CÜfuRuÁime
 
ruÁime
,

34 
»Œy
,

35 @
NÚNuÎ
 
Du¿tiÚ
 
timeout
,

36 @
NÚNuÎ
 
Du¿tiÚ
 
pŞlP”iod
) {

37 
	mthis
.
	mnodeFÜWÜkæow
 = 
’dpoštToRe¡ÜeRedundªcy
;

38 
	mthis
.
	mruÁime
 = 
ruÁime
;

39 
	mthis
.
	m»Œy
 = 
»Œy
;

40 
	mthis
.
	mtimeout
 = 
timeout
;

41 
	mthis
.
	mpŞlP”iod
 = 
pŞlP”iod
;

51 @
Ov”ride


52 
´Ùeùed
 
UUID
 
£ndReque¡
(@
NÚNuÎ
 
Mªagem’tCl›Á
 
mªagem’tCl›Á
è
throws
 
	gTimeoutExû±iÚ
 {

53 
C»©eWÜkæowRe¥Ú£
 
	g»¥
 = 
mªagem’tCl›Á
.
m”geSegm’ts
(
nodeFÜWÜkæow
);

54 
	glog
.
šfo
("sendRequest:„equesto„estore„edundancy‡nd merge segments forƒndpoint {} on orchestrator {}:{}",

55 
nodeFÜWÜkæow
, 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘Ho¡
(),

56 
mªagem’tCl›Á
.
g‘Rou‹r
().
g‘PÜt
());

57  
	g»¥
.
g‘WÜkæowId
();

66 @
Ov”ride


67 
´Ùeùed
 
boŞ—n
 
v”ifyReque¡
(@
NÚNuÎ
 
Layout
 
Ïyout
) {

68 
	glog
.
šfo
("v”ifyReque¡: {} iÀ{}", 
this
, 
Ïyout
);

69  
	gÏyout
.
g‘AÎS”v”s
().
cÚšs
(
nodeFÜWÜkæow
)

70 && 
	gÏyout
.
g‘Segm’tsFÜEndpošt
(
nodeFÜWÜkæow
).
size
()

71 =ğ
Ïyout
.
g‘Segm’ts
().
size
();

74 @
Ov”ride


75 
public
 
SŒšg
 
	$toSŒšg
() {

76  
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
(è+ " " + 
nodeFÜWÜkæow
;

77 
	}
}

79 @
Ov”ride


80 
´Ùeùed
 
	gO±iÚ®
<
	gMªagem’tCl›Á
> 
	$g‘Orche¡¿tÜ
(){

81 
ruÁime
.
	`šv®id©eLayout
();

82 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

83 
Ba£Cl›Á
 
ba£Cl›Á
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘Ba£Cl›Á
(
nodeFÜWÜkæow
);

84 if(
ba£Cl›Á
.
	`pšgSync
()){

85 
log
.
	`šfo
("g‘Orche¡¿tÜ: orche¡¿tÜ s–eùed {}", 
nodeFÜWÜkæow
);

86  
O±iÚ®
.
	`of
(
ruÁime
.
	`g‘LayoutV›w
()

87 .
	`g‘RuÁimeLayout
(
Ïyout
).
	`g‘Mªagem’tCl›Á
(
nodeFÜWÜkæow
));

90 
log
.
	`w¬n
("g‘Orche¡¿tÜ:‡ s”v” {} i nÙ„e¥ÚdšgØpšgs", 
nodeFÜWÜkæow
);

91  
O±iÚ®
.
	`em±y
();

93 
	}
}

	@runtime/src/main/java/org/corfudb/runtime/view/workflows/WorkflowRequest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gwÜkæows
;

3 
impÜt
 
	glombok
.
	gNÚNuÎ
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£Cl›Á
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWÜkæowExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWÜkæowResuÉUnknownExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

14 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

26 @
Slf4j


27 
public
 
ab¡¿ù
 cÏs 
	cWÜkæowReque¡
 {

29 
´Ùeùed
 
	m»Œy
;

31 
´Ùeùed
 
Du¿tiÚ
 
	mtimeout
;

33 
´Ùeùed
 
Du¿tiÚ
 
	mpŞlP”iod
;

35 
´Ùeùed
 
CÜfuRuÁime
 
	mruÁime
;

37 @
NÚNuÎ


38 
´Ùeùed
 
SŒšg
 
	mnodeFÜWÜkæow
;

46 
´Ùeùed
 
ab¡¿ù
 
UUID
 
	$£ndReque¡
(
Mªagem’tCl›Á
 
ş›Á
è
throws
 
TimeoutExû±iÚ
;

59 
´Ùeùed
 
O±iÚ®
<
Mªagem’tCl›Á
> 
	$g‘Orche¡¿tÜ
() {

61 
ruÁime
.
	`šv®id©eLayout
();

62 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

64 
Li¡
<
SŒšg
> 
avaabËLayoutS”v”s
 = 
Ïyout
.
	`g‘LayoutS”v”s
().
	`¡»am
()

65 .
	`f‹r
(
s
 -> !s.
	`equ®s
(
nodeFÜWÜkæow
))

66 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

68 ià(
avaabËLayoutS”v”s
.
	`isEm±y
()) {

69 
throw
 
Ãw
 
	`WÜkæowExû±iÚ
("g‘Orche¡¿tÜ:‚ØavaabË orche¡¿tÜ " + 
Ïyout
);

73 
O±iÚ®
<
Mªagem’tCl›Á
> 
mªagem’tCl›Á
 = O±iÚ®.
	`em±y
();

75 
SŒšg
 
’dpošt
 : 
avaabËLayoutS”v”s
) {

76 
Ba£Cl›Á
 
ş›Á
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
)

77 .
	`g‘Ba£Cl›Á
(
’dpošt
);

78 ià(
ş›Á
.
	`pšgSync
()) {

79 
log
.
	`šfo
("g‘Orche¡¿tÜ: orche¡¿tÜ s–eùed {},†ayouˆ{}", 
’dpošt
, 
Ïyout
);

80 
mªagem’tCl›Á
 = 
O±iÚ®
.
	`of
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
)

81 .
	`g‘Mªagem’tCl›Á
(
’dpošt
));

87  
mªagem’tCl›Á
;

97 
´Ùeùed
 
ab¡¿ù
 
boŞ—n
 
	`v”ifyReque¡
(
Layout
 
Ïyout
);

108 
´iv©e
 
	`wa™FÜWÜkæow
(@
NÚNuÎ
 
UUID
 
wÜkæow
, @NÚNuÎ 
Mªagem’tCl›Á
 
ş›Á
,

109 @
NÚNuÎ
 
Du¿tiÚ
 
timeout
, @NÚNuÎ Du¿tiÚ 
pŞlP”iod
)

110 
throws
 
TimeoutExû±iÚ
 {

111 
Œ›s
 = 
timeout
.
	`toNªos
(è/ 
pŞlP”iod
.toNanos();

112 
x
 = 0; x < 
Œ›s
; x++) {

113 ià(!
ş›Á
.
	`qu”yReque¡
(
wÜkæow
).
	`isAùive
()) {

116 
SË•
.
	`¦“pUnš‹¼u±ibly
(
pŞlP”iod
);

117 
log
.
	`debug
("wa™FÜWÜkæow: wa™šg fÜ {} oÀ©‹m± {}", 
wÜkæow
, 
x
);

119 
throw
 
Ãw
 
	`TimeoutExû±iÚ
();

120 
	}
}

132 
public
 
	$švoke
() {

133 
x
 = 0; x < 
»Œy
; x++) {

134 
Œy
 {

135 
O±iÚ®
<
Mªagem’tCl›Á
> 
Üche¡¿tÜ
 = 
	`g‘Orche¡¿tÜ
();

136 if(
Üche¡¿tÜ
.
	`isP»£Á
()){

137 
UUID
 
wÜkæowId
 = 
	`£ndReque¡
(
Üche¡¿tÜ
.
	`g‘
());

138 
	`wa™FÜWÜkæow
(
wÜkæowId
, 
Üche¡¿tÜ
.
	`g‘
(), 
timeout
, 
pŞlP”iod
);

141 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Orchestrator can‚ot be selected");

144 } 
	`ÿtch
 (
N‘wÜkExû±iÚ
 | 
TimeoutExû±iÚ
 | 
IÎeg®S‹Exû±iÚ
 
e
) {

145 
log
.
	`w¬n
("WÜkæowReque¡: E¼Ü whruÂšg {} oÀ©‹m± {}, cau£ {}", 
this
, 
x
, 
e
);

148 
y
 = 0; y < 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘Inv®id©eR‘ry
(); y++) {

149 
ruÁime
.
	`šv®id©eLayout
();

150 
Layout
 
ÏyoutToV”ify
 = 
Ãw
 
	`Layout
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

151 ià(
	`v”ifyReque¡
(
ÏyoutToV”ify
)) {

152 
log
.
	`šfo
("WÜkæowReque¡: SucûssfuÎy com¶‘ed {}", 
this
);

156 
log
.
	`w¬n
("WÜkæowReque¡: R‘ryšg {} oÀ©‹m± {}", 
this
, 
x
);

159 
throw
 
Ãw
 
	`WÜkæowResuÉUnknownExû±iÚ
();

160 
	}
}

	@runtime/src/main/java/org/corfudb/security/sasl/SaslUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
.
	gPÏšTextSa¦N‘tyCl›Á
;

5 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦Exû±iÚ
;

6 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

7 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

13 
public
 cÏs 
	cSa¦Uts
 {

15 
´iv©e
 
	$Sa¦Uts
() {

25 
public
 
PÏšTextSa¦N‘tyCl›Á
 
	$’abËSa¦PÏšText
(

26 
SŒšg
 
u£ºameFe
, SŒšg 
·sswÜdFe
) {

27 ià(
u£ºameFe
 =ğ
nuÎ
) {

28 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Invalid username file");

30 ià(
·sswÜdFe
 =ğ
nuÎ
) {

31 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Invalid…assword file");

34 
SŒšg
 
u£ºame
 = 
nuÎ
;

35 
Œy
 {

36 
u£ºame
 =

37 (
Ãw
 
	`SŒšg
(
Fes
.
	`»adAÎBy‹s
(
P©hs
.
	`g‘
(
u£ºameFe
)))).
	`Œim
();

38 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

39 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Error„eadinghe username file: "

40 + 
e
.
	`g‘CÏss
().
	`g‘Sim¶eName
(),ƒ);

44 
SŒšg
 
·sswÜd
 = 
nuÎ
;

45 
Œy
 {

46 
·sswÜd
 =

47 (
Ãw
 
	`SŒšg
(
Fes
.
	`»adAÎBy‹s
(
P©hs
.
	`g‘
(
·sswÜdFe
)))).
	`Œim
();

48 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

49 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Error„eadinghe…assword file: "

50 + 
e
.
	`g‘CÏss
().
	`g‘Sim¶eName
(),ƒ);

53 
PÏšTextSa¦N‘tyCl›Á
 
§¦N‘tyCl›Á
 = 
nuÎ
;

55 
Œy
 {

56 
§¦N‘tyCl›Á
 = 
Ãw
 
	`PÏšTextSa¦N‘tyCl›Á
(
u£ºame
, 
·sswÜd
);

57 } 
	`ÿtch
 (
Sa¦Exû±iÚ
 
£
) {

58 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Could‚ot create‡ SASL Plain Text Netty client"

59 + 
£
.
	`g‘CÏss
().
	`g‘Sim¶eName
(), se);

62  
§¦N‘tyCl›Á
;

63 
	}
}

	@runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextCallbackHandler.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
;

3 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gC®lback
;

4 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gC®lbackHªdËr
;

5 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gNameC®lback
;

6 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gPasswÜdC®lback
;

7 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gUnsuµÜ‹dC®lbackExû±iÚ
;

16 
public
 cÏs 
	cPÏšTextC®lbackHªdËr
 
im¶em’ts
 
	mC®lbackHªdËr
 {

18 
´iv©e
 
fš®
 
SŒšg
 
	mu£ºame
;

19 
´iv©e
 
fš®
 
SŒšg
 
	m·sswÜd
;

21 
public
 
	$PÏšTextC®lbackHªdËr
(
SŒšg
 
u£ºame
, SŒšg 
·sswÜd
) {

22 
this
.
u£ºame
 = username;

23 
this
.
·sswÜd
 =…assword;

32 
public
 
	$hªdË
(
C®lback
[] 
ÿÎbacks
)

33 
throws
 
UnsuµÜ‹dC®lbackExû±iÚ
 {

34 
i
 = 0; i < 
ÿÎbacks
.
Ëngth
; i++) {

35 ià(
ÿÎbacks
[
i
] 
š¡ªûof
 
NameC®lback
) {

36 
NameC®lback
 
nc
 = (NameC®lback)
ÿÎbacks
[
i
];

37 
nc
.
	`£tName
(
u£ºame
);

38 } ià(
ÿÎbacks
[
i
] 
š¡ªûof
 
PasswÜdC®lback
) {

39 
PasswÜdC®lback
 
pc
 = (PasswÜdC®lback)
ÿÎbacks
[
i
];

40 
pc
.
	`£tPasswÜd
(
·sswÜd
.
	`toCh¬A¼ay
());

42 
throw
 
Ãw
 
	`UnsuµÜ‹dC®lbackExû±iÚ
(
ÿÎbacks
[
i
],

46 
	}
}

	@runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextLoginModule.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
;

3 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gSubjeù
;

7 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gC®lback
;

8 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gC®lbackHªdËr
;

9 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gNameC®lback
;

10 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gPasswÜdC®lback
;

11 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gUnsuµÜ‹dC®lbackExû±iÚ
;

12 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	glogš
.
	gLogšExû±iÚ
;

13 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	g¥i
.
	gLogšModuË
;

22 
public
 cÏs 
	cPÏšTextLogšModuË
 
im¶em’ts
 
	mLogšModuË
 {

24 
´iv©e
 
fš®
 
SŒšg
 
	mPLAIN_TEXT_USER_PREFIX
 = "corfudb_user_";

25 
´iv©e
 
C®lbackHªdËr
 
	mÿÎbackHªdËr
;

26 
´iv©e
 
	mM­
<
	mSŒšg
, ?> 
	mİtiÚs
;

28 @
Ov”ride


29 
public
 
š™Ÿlize
(
Subjeù
 
subjeù
, 
C®lbackHªdËr
 
ÿÎbackHªdËr
,

30 
M­
<
SŒšg
, ?> 
sh¬edS‹
, M­<SŒšg, ?> 
İtiÚs
) {

31 
	mthis
.
	mÿÎbackHªdËr
 = 
ÿÎbackHªdËr
;

32 
	mthis
.
	mİtiÚs
 = 
İtiÚs
;

35 @
Ov”ride


36 
public
 
boŞ—n
 
	$logš
(è
throws
 
LogšExû±iÚ
 {

37 ià(
ÿÎbackHªdËr
 =ğ
nuÎ
) {

38 
throw
 
Ãw
 
	`LogšExû±iÚ
("CallbackHandler‚ot„egistered");

41 
C®lback
[] 
ÿÎbacks
 = 
Ãw
 Callback[2];

42 
ÿÎbacks
[0] = 
Ãw
 
	`NameC®lback
("Username");

43 
ÿÎbacks
[1] = 
Ãw
 
	`PasswÜdC®lback
("PasswÜd", 
çl£
);

45 
Œy
 {

46 
ÿÎbackHªdËr
.
	`hªdË
(
ÿÎbacks
);

47 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

48 
throw
 
Ãw
 
	`LogšExû±iÚ
("IOExû±iÚ: " + 
›
.
	`toSŒšg
());

49 } 
	`ÿtch
 (
UnsuµÜ‹dC®lbackExû±iÚ
 
uû
) {

50 
throw
 
Ãw
 
	`LogšExû±iÚ
("UnsupportedCallbackException: "

51 + 
uû
.
	`g‘C®lback
().
	`toSŒšg
());

54 
SŒšg
 
u£ºame
 = ((
NameC®lback
)
ÿÎbacks
[0]).
	`g‘Name
();

55 ià(
İtiÚs
.
	`cÚšsKey
(
PLAIN_TEXT_USER_PREFIX
 + 
u£ºame
)) {

56 
SŒšg
 
ex³ùedPasswÜd
 = (SŒšgè
İtiÚs
.
	`g‘
(
PLAIN_TEXT_USER_PREFIX
 + 
u£ºame
);

57 
SŒšg
 
·sswÜd
 = 
Ãw
 
	`SŒšg
(((
PasswÜdC®lback
)
ÿÎbacks
[1]).
	`g‘PasswÜd
());

58 ià(!
ex³ùedPasswÜd
.
	`equ®s
(
·sswÜd
)) {

59 
throw
 
Ãw
 
	`LogšExû±iÚ
("IncÜ»ù…asswÜd fÜ: " + 
u£ºame
);

62 
throw
 
Ãw
 
	`LogšExû±iÚ
("U£r: " + 
u£ºame
 + "‚ot found");

65  
Œue
;

66 
	}
}

68 @
Ov”ride


69 
public
 
boŞ—n
 
	$comm™
(è
throws
 
LogšExû±iÚ
 {

70  
Œue
;

71 
	}
}

73 @
Ov”ride


74 
public
 
boŞ—n
 
	$abÜt
(è
throws
 
LogšExû±iÚ
 {

75  
Œue
;

76 
	}
}

78 @
Ov”ride


79 
public
 
boŞ—n
 
	$logout
(è
throws
 
LogšExû±iÚ
 {

80  
Œue
;

81 
	}
}

	@runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslNettyClient.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlDu¶exHªdËr
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

7 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦
;

8 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦Cl›Á
;

9 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦Exû±iÚ
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

20 @
Slf4j


21 
public
 cÏs 
	cPÏšTextSa¦N‘tyCl›Á
 
ex‹nds
 
	mChªÃlDu¶exHªdËr
 {

23 
´iv©e
 
Sa¦Cl›Á
 
	m§¦Cl›Á
;

25 
´iv©e
 
fš®
 
	mSŒšg
[] 
	mmechªisms
 = {"PLAIN"};

28 
public
 
	$PÏšTextSa¦N‘tyCl›Á
(
SŒšg
 
u£ºame
, SŒšg 
·sswÜd
)

29 
throws
 
Sa¦Exû±iÚ
 {

30 
PÏšTextC®lbackHªdËr
 
cbh
 = 
Ãw
 
	`PÏšTextC®lbackHªdËr
(
u£ºame
,

31 
·sswÜd
);

32 
§¦Cl›Á
 = 
Sa¦
.
	`ü—‹Sa¦Cl›Á
(
mechªisms
, 
u£ºame
,

33 "¶aš", 
nuÎ
,‚uÎ, 
cbh
);

34 
	}
}

36 @
Ov”ride


37 
public
 
	$chªÃlAùive
(
ChªÃlHªdËrCÚ‹xt
 
ùx
è
throws
 
Exû±iÚ
 {

38 
by‹
[] 
»¥Ú£
 = 
Ãw
 byte[0];

39 !
§¦Cl›Á
.
	`isCom¶‘e
()) {

40 
Œy
 {

41 
»¥Ú£
 = 
§¦Cl›Á
.
	`ev®u©eCh®Ënge
(
nuÎ
);

42 } 
	`ÿtch
 (
Sa¦Exû±iÚ
 
£
) {

43 
log
.
	`”rÜ
("Sa¦Exû±iÚ {}", 
£
.
	`toSŒšg
());

48 ià(
§¦Cl›Á
.
	`isCom¶‘e
()) {

49 
By‹Buf
 
buf
 = 
ùx
.
	`®loc
().
	`h—pBufãr
(
»¥Ú£
.
Ëngth
);

50 
By‹Buf
 
’coded
 = 
buf
.
	`wr™eBy‹s
(
»¥Ú£
);

51 
ùx
.
	`wr™eAndFlush
(
’coded
);

52 
ùx
.
	`p–še
().
	`»move
(
this
);

53 
su³r
.
	`chªÃlAùive
(
ùx
);

55 
	}
}

	@runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslNettyServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gSim¶eChªÃlInboundHªdËr
;

7 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦
;

8 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦Exû±iÚ
;

9 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦S”v”
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

21 @
Slf4j


22 
public
 
şass
 
PÏšTextSa¦N‘tyS”v”
 
ex‹nds
 
	gSim¶eChªÃlInboundHªdËr
<
	gBy‹Buf
> {

24 
´iv©e
 
Sa¦S”v”
 
	g§¦S”v”
;

26 
´iv©e
 
fš®
 
SŒšg
 
	gmechªisms
 = "PLAIN";

29 
	gPÏšTextSa¦S”v”Provid”
.
š™Ÿlize
();

32 
public
 
PÏšTextSa¦N‘tyS”v”
(è
throws
 
	gSa¦Exû±iÚ
 {

33 
	g§¦S”v”
 = 
Sa¦
.
ü—‹Sa¦S”v”
(
mechªisms
, "¶aš", 
nuÎ
,‚ull,‚ull);

36 @
Ov”ride


37 
´Ùeùed
 
chªÃlR—d0
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
By‹Buf
 
buf
)

38 
throws
 
	gExû±iÚ
 {

40 
	gby‹
[] 
	gmsg
 = 
Ãw
 
by‹
[
buf
.
»adabËBy‹s
()];

41 
	gbuf
.
g‘By‹s
(0, 
msg
);

43 !
	g§¦S”v”
.
isCom¶‘e
()) {

44 
	gŒy
 {

45 
	gby‹
[] 
	gch®Ënge
 = 
§¦S”v”
.
ev®u©eRe¥Ú£
(
msg
);

46 } 
ÿtch
 (
Sa¦Exû±iÚ
 
£
) {

47 
	glog
.
”rÜ
("Sa¦Exû±iÚ {}", 
£
.
toSŒšg
());

52 ià(
	g§¦S”v”
.
isCom¶‘e
()) {

53 
	glog
.
debug
("channelRead0: Sasl handshake successful, uninstalling handler");

54 
	gùx
.
p–še
().
»move
(
this
);

	@runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslServer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
;

3 
impÜt
 
	gjava
.
	gio
.
	gUnsuµÜ‹dEncodšgExû±iÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	gÿÎback
.
	gC®lbackHªdËr
;

8 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	glogš
.
	gLogšCÚ‹xt
;

9 
impÜt
 
	gjavax
.
	g£cur™y
.
	gauth
.
	glogš
.
	gLogšExû±iÚ
;

10 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦
;

11 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦Exû±iÚ
;

12 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦S”v”
;

13 
impÜt
 
	gjavax
.
	g£cur™y
.
	g§¦
.
	gSa¦S”v”FaùÜy
;

14 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

24 @
Slf4j


25 
public
 cÏs 
	cPÏšTextSa¦S”v”
 
im¶em’ts
 
	mSa¦S”v”
 {

27 
public
 
fš®
 
SŒšg
 
	mMECHANISM
 = "PLAIN";

29 
´iv©e
 
boŞ—n
 
	mauth’tiÿ‹d
;

31 
´iv©e
 
SŒšg
 
	mauthÜiz©iÚId
;

33 
public
 
	$PÏšTextSa¦S”v”
() {

34 
auth’tiÿ‹d
 = 
çl£
;

37 @
Ov”ride


38 
public
 
SŒšg
 
	$g‘MechªismName
() {

39  
MECHANISM
;

40 
	}
}

42 
´iv©e
 
	$v”ify
(
SŒšg
 
authzid
, SŒšg 
authcid
, SŒšg 
·sswd
)

43 
throws
 
Sa¦Exû±iÚ
 {

45 ià(
authcid
.
	`isEm±y
()) {

46 
throw
 
Ãw
 
	`Sa¦Exû±iÚ
("Authentication failed dueoƒmpty username");

48 ià(
·sswd
.
	`isEm±y
()) {

49 
throw
 
Ãw
 
	`Sa¦Exû±iÚ
("Authentication failed dueoƒmpty…assword");

52 ià(
authzid
.
	`isEm±y
()) {

53 
authÜiz©iÚId
 = 
authcid
;

55 
authÜiz©iÚId
 = 
authzid
;

58 
Œy
 {

59 
LogšCÚ‹xt
 
lc
 = 
Ãw
 
	`LogšCÚ‹xt
("CorfuDB",

60 
Ãw
 
	`PÏšTextC®lbackHªdËr
(
authcid
, 
·sswd
));

61 
lc
.
	`logš
();

62 } 
	`ÿtch
 (
LogšExû±iÚ
 
Ë
) {

63 
throw
 
Ãw
 
	`Sa¦Exû±iÚ
("Logš‡‰em± by '" + 
authcid
 + "' failed");

65 
log
.
	`debug
("Logš by {} i sucûssful", 
authcid
);

67 
auth’tiÿ‹d
 = 
Œue
;

68 
	}
}

70 @
Ov”ride


71 
public
 
	gby‹
[] 
	$ev®u©eRe¥Ú£
(
by‹
[] 
»¥Ú£
)

72 
throws
 
Sa¦Exû±iÚ
 {

73 
SŒšg
[] 
tok’s
;

74 
Œy
 {

75 
tok’s
 = 
Ãw
 
	`SŒšg
(
»¥Ú£
, "UTF-8").
	`¥l™
("\u0000");

76 } 
	`ÿtch
 (
UnsuµÜ‹dEncodšgExû±iÚ
 
ue
) {

77 
throw
 
Ãw
 
	`Sa¦Exû±iÚ
("Unsupported charset");

80 ià(
tok’s
.
Ëngth
 != 3) {

81 
throw
 
Ãw
 
	`Sa¦Exû±iÚ
("Malformed…lainext„esponse„eceived");

84 
	`v”ify
(
tok’s
[0],okens[1],okens[2]);

86  
nuÎ
;

87 
	}
}

89 @
Ov”ride


90 
public
 
boŞ—n
 
	$isCom¶‘e
() {

91  
auth’tiÿ‹d
;

92 
	}
}

94 @
Ov”ride


95 
public
 
SŒšg
 
	$g‘AuthÜiz©iÚID
() {

96 ià(!
auth’tiÿ‹d
) {

97 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Authentication is incomplete");

99  
authÜiz©iÚId
;

100 
	}
}

102 @
Ov”ride


103 
public
 
	gby‹
[] 
	$unw¿p
(
by‹
[] 
šcomšg
, 
off£t
, 
Ën
è
throws
 
Sa¦Exû±iÚ
 {

104 ià(!
auth’tiÿ‹d
) {

105 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Authentication is incomplete");

107  
A¼ays
.
	`cİyOfRªge
(
šcomšg
, 
off£t
, off£ˆ+ 
Ën
);

108 
	}
}

110 @
Ov”ride


111 
public
 
	gby‹
[] 
	$w¿p
(
by‹
[] 
outgošg
, 
off£t
, 
Ën
è
throws
 
Sa¦Exû±iÚ
 {

112 ià(!
auth’tiÿ‹d
) {

113 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Authentication is incomplete");

115  
A¼ays
.
	`cİyOfRªge
(
outgošg
, 
off£t
, off£ˆ+ 
Ën
);

116 
	}
}

118 @
Ov”ride


119 
public
 
Objeù
 
	$g‘NegÙŸ‹dPrİ”ty
(
SŒšg
 
´İName
) {

120 ià(!
auth’tiÿ‹d
) {

121 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Authentication is incomplete");

123  
nuÎ
;

124 
	}
}

126 @
Ov”ride


127 
public
 
	$di¥o£
(è
throws
 
Sa¦Exû±iÚ
 {

128 
	}
}

130 
public
 şas 
	cPÏšTextSa¦S”v”FaùÜy
 
im¶em’ts
 
	gSa¦S”v”FaùÜy
 {

132 @
Ov”ride


133 
public
 
Sa¦S”v”
 
ü—‹Sa¦S”v”
(
SŒšg
 
mechªism
, SŒšg 
´ÙocŞ
,

134 
SŒšg
 
£rv”Name
, 
M­
<SŒšg, ?> 
´İs
,

135 
C®lbackHªdËr
 
cbh
)

136 
throws
 
	gSa¦Exû±iÚ
 {

138 ià(!
	gmechªism
.
equ®s
(
MECHANISM
)) {

139 
throw
 
Ãw
 
Sa¦Exû±iÚ
("UnsuµÜ‹d mechªism: " + 
mechªism
);

141  
Ãw
 
PÏšTextSa¦S”v”
();

144 @
Ov”ride


145 
public
 
	gSŒšg
[] 
g‘MechªismNames
(
M­
<
SŒšg
, ?> 
´İs
) {

146 
SŒšg
 
	gnoPÏšText
 = (SŒšgè
´İs
.
g‘
(
Sa¦
.
POLICY_NOPLAINTEXT
);

147 ià(
	gnoPÏšText
.
equ®s
("true")) {

148  
Ãw
 
	gSŒšg
[]{};

150  
Ãw
 
	gSŒšg
[]{
	gMECHANISM
};

	@runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslServerProvider.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
;

3 
impÜt
 
	gjava
.
	g£cur™y
.
	gProvid”
;

4 
impÜt
 
	gjava
.
	g£cur™y
.
	gSecur™y
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	g§¦
.
	g¶aš‹xt
.
	gPÏšTextSa¦S”v”
.
	gPÏšTextSa¦S”v”FaùÜy
;

15 
public
 cÏs 
	cPÏšTextSa¦S”v”Provid”
 
ex‹nds
 
	mProvid”
 {

17 
´Ùeùed
 
	$PÏšTextSa¦S”v”Provid”
() {

18 
	`su³r
("PlainTextSaslServerProvider", 1.0,

20 
su³r
.
	`put
("Sa¦S”v”FaùÜy." + 
PÏšTextSa¦S”v”
.
MECHANISM
,

21 
PÏšTextSa¦S”v”FaùÜy
.
şass
.
	`g‘Name
());

24 
public
 
	$š™Ÿlize
() {

25 
Secur™y
.
	`addProvid”
(
Ãw
 
	`PÏšTextSa¦S”v”Provid”
());

26 
	}
}

	@runtime/src/main/java/org/corfudb/security/tls/ReloadableTrustManager.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
;

3 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜe
;

4 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜeExû±iÚ
;

5 
impÜt
 
	gjava
.
	g£cur™y
.
	gNoSuchAlgÜ™hmExû±iÚ
;

6 
impÜt
 
	gjava
.
	g£cur™y
.
	gû¹
.
	gC”tifiÿ‹Exû±iÚ
;

7 
impÜt
 
	gjava
.
	g£cur™y
.
	gû¹
.
	gX509C”tifiÿ‹
;

8 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

9 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gTru¡Mªag”
;

10 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gTru¡Mªag”FaùÜy
;

11 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gX509Tru¡Mªag”
;

12 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

20 @
Slf4j


21 
public
 cÏs 
	cR–ßdabËTru¡Mªag”
 
im¶em’ts
 
	mX509Tru¡Mªag”
 {

22 
´iv©e
 
fš®
 
SŒšg
 
	mŒu¡StÜeP©h
;

23 
´iv©e
 
fš®
 
SŒšg
 
	mŒu¡PasswÜdP©h
;

24 
´iv©e
 
X509Tru¡Mªag”
 
	mŒu¡Mªag”
;

36 
public
 
	$R–ßdabËTru¡Mªag”
(
SŒšg
 
Œu¡StÜeP©h
, SŒšg 
Œu¡PasswÜdP©h
è
throws
 
SSLExû±iÚ
 {

37 
this
.
Œu¡StÜeP©h
 =rustStorePath;

38 
this
.
Œu¡PasswÜdP©h
 =rustPasswordPath;

39 
	`»lßdTru¡StÜe
();

42 @
Ov”ride


43 
public
 
	$checkCl›ÁTru¡ed
(
X509C”tifiÿ‹
[] 
chaš
, 
SŒšg
 
authTy³
è
throws
 
C”tifiÿ‹Exû±iÚ
 {

44 
	`»lßdTru¡StÜeW¿µ”
();

45 
Œu¡Mªag”
.
	`checkCl›ÁTru¡ed
(
chaš
, 
authTy³
);

46 
	}
}

48 @
Ov”ride


49 
public
 
	$checkS”v”Tru¡ed
(
X509C”tifiÿ‹
[] 
chaš
, 
SŒšg
 
authTy³
è
throws
 
C”tifiÿ‹Exû±iÚ
 {

50 
	`»lßdTru¡StÜeW¿µ”
();

51 
Œu¡Mªag”
.
	`checkS”v”Tru¡ed
(
chaš
, 
authTy³
);

52 
	}
}

54 @
Ov”ride


55 
public
 
	gX509C”tifiÿ‹
[] 
	$g‘Acû±edIssu”s
() {

56  
Ãw
 
X509C”tifiÿ‹
[0];

57 
	}
}

65 
´iv©e
 
	$»lßdTru¡StÜeW¿µ”
(è
throws
 
C”tifiÿ‹Exû±iÚ
 {

66 
Œy
 {

67 
	`»lßdTru¡StÜe
();

68 } 
	`ÿtch
 (
SSLExû±iÚ
 
e
) {

69 
SŒšg
 
mes§ge
 = "UÇbËØ»lßdru¡ stÜ" + 
Œu¡StÜeP©h
 + ".";

70 
log
.
	`”rÜ
(
mes§ge
, 
e
);

71 
throw
 
Ãw
 
	`C”tifiÿ‹Exû±iÚ
(
mes§ge
, 
e
);

73 
	}
}

81 
´iv©e
 
	$»lßdTru¡StÜe
(è
throws
 
SSLExû±iÚ
 {

82 
SŒšg
 
Œu¡PasswÜd
 = 
TlsUts
.
	`g‘KeyStÜePasswÜd
(
Œu¡PasswÜdP©h
);

83 
KeyStÜe
 
Œu¡StÜe
 = 
TlsUts
.
	`İ’KeyStÜe
(
Œu¡StÜeP©h
, 
Œu¡PasswÜd
);

85 
Tru¡Mªag”FaùÜy
 
tmf
;

86 
Œy
 {

87 
tmf
 = 
Tru¡Mªag”FaùÜy
.
	`g‘In¡ªû
(Tru¡Mªag”FaùÜy.
	`g‘DeçuÉAlgÜ™hm
());

88 
tmf
.
	`š™
(
Œu¡StÜe
);

89 } 
	`ÿtch
 (
NoSuchAlgÜ™hmExû±iÚ
 
e
) {

90 
SŒšg
 
”rÜMes§ge
 = "No support for TrustManagerFactory default‡lgorithm "

91 + 
Tru¡Mªag”FaùÜy
.
	`g‘DeçuÉAlgÜ™hm
() + ".";

92 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

93 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

94 } 
	`ÿtch
 (
KeyStÜeExû±iÚ
 
e
) {

95 
SŒšg
 
”rÜMes§ge
 = "UÇbËØlßdru¡ stÜ" + 
Œu¡StÜeP©h
 + ".";

96 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

97 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

100 
Tru¡Mªag”
 
tm
: 
tmf
.
	`g‘Tru¡Mªag”s
()) {

101 ià(
tm
 
š¡ªûof
 
X509Tru¡Mªag”
) {

102 
Œu¡Mªag”
 = (
X509Tru¡Mªag”
)
tm
;

107 
throw
 
Ãw
 
	`SSLExû±iÚ
("No X509TrustManager in TrustManagerFactory.");

108 
	}
}

	@runtime/src/main/java/org/corfudb/security/tls/ReloadableTrustManagerFactory.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gut
.
	gSim¶eTru¡Mªag”FaùÜy
;

4 
impÜt
 
	gjava
.
	g£cur™y
.
	gInv®idAlgÜ™hmP¬am‘”Exû±iÚ
;

5 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜe
;

6 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜeExû±iÚ
;

7 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gMªag”FaùÜyP¬am‘”s
;

8 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

9 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gTru¡Mªag”
;

16 
public
 cÏs 
	cR–ßdabËTru¡Mªag”FaùÜy
 
ex‹nds
 
	mSim¶eTru¡Mªag”FaùÜy
 {

18 
´iv©e
 
R–ßdabËTru¡Mªag”
 
	mŒu¡Mªag”
;

30 
public
 
	$R–ßdabËTru¡Mªag”FaùÜy
(
SŒšg
 
Œu¡StÜeP©h
, SŒšg 
Œu¡PasswÜdP©h
è
throws
 
SSLExû±iÚ
 {

31 
Œu¡Mªag”
 = 
Ãw
 
	`R–ßdabËTru¡Mªag”
(
Œu¡StÜeP©h
, 
Œu¡PasswÜdP©h
);

34 @
Ov”ride


35 
´Ùeùed
 
	$’gšeIn™
(
KeyStÜe
 
keyStÜe
è
throws
 
KeyStÜeExû±iÚ
 {

37 
	}
}

39 @
Ov”ride


40 
´Ùeùed
 
	$’gšeIn™
(
Mªag”FaùÜyP¬am‘”s
 
mªag”FaùÜyP¬am‘”s
è
throws
 
Inv®idAlgÜ™hmP¬am‘”Exû±iÚ
 {

42 
	}
}

44 @
Ov”ride


45 
´Ùeùed
 
	gTru¡Mªag”
[] 
	$’gšeG‘Tru¡Mªag”s
() {

46  
Ãw
 
Tru¡Mªag”
[] { 
Œu¡Mªag”
 };

47 
	}
}

	@runtime/src/main/java/org/corfudb/security/tls/SslContextConstructor.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gO³nS¦
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦CÚ‹xt
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦CÚ‹xtBud”
;

6 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜe
;

7 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜeExû±iÚ
;

8 
impÜt
 
	gjava
.
	g£cur™y
.
	gNoSuchAlgÜ™hmExû±iÚ
;

9 
impÜt
 
	gjava
.
	g£cur™y
.
	gUÄecov”abËKeyExû±iÚ
;

10 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gKeyMªag”FaùÜy
;

11 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	ghªdËr
.
	gs¦
.
	gS¦Provid”
;

14 
impÜt
 
	glombok
.
	gNÚNuÎ
;

15 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

17 @
Slf4j


18 
public
 cÏs 
	cS¦CÚ‹xtCÚ¡ruùÜ
 {

31 
public
 
S¦CÚ‹xt
 
cÚ¡ruùS¦CÚ‹xt
(
boŞ—n
 
isS”v”
,

32 @
NÚNuÎ
 
SŒšg
 
keyStÜeP©h
,

33 
SŒšg
 
ksPasswÜdFe
,

34 @
NÚNuÎ
 
SŒšg
 
Œu¡StÜeP©h
,

35 
SŒšg
 
tsPasswÜdFe
è
throws
 
	mSSLExû±iÚ
 {

36 
	mlog
.
šfo
("Construct ssl context based onhe following information:");

37 
	mlog
.
šfo
("Key stÜf·th: {}.", 
keyStÜeP©h
);

38 
	mlog
.
šfo
("Key stÜ·sswÜd f·th: {}.", 
ksPasswÜdFe
);

39 
	mlog
.
šfo
("Tru¡ stÜf·th: {}.", 
Œu¡StÜeP©h
);

40 
	mlog
.
šfo
("Tru¡ stÜ·sswÜd f·th: {}.", 
tsPasswÜdFe
);

42 
KeyMªag”FaùÜy
 
	mkmf
 = 
ü—‹KeyMªag”FaùÜy
(
keyStÜeP©h
, 
ksPasswÜdFe
);

43 
R–ßdabËTru¡Mªag”FaùÜy
 
	mtmf
 = 
Ãw
 R–ßdabËTru¡Mªag”FaùÜy(
Œu¡StÜeP©h
, 
tsPasswÜdFe
);

45 
S¦Provid”
 
	m´ovid”
 = S¦Provid”.
JDK
;

47 ià(
	mO³nS¦
.
isAvaabË
()) {

48 
	m´ovid”
 = 
S¦Provid”
.
OPENSSL
;

50 
	mlog
.
w¬n
("constructSslContext: couldn't†oad‚ative openssl†ibrary, using JdkSslEngine instead!");

54 ià(
	misS”v”
) {

55  
	mS¦CÚ‹xtBud”
.
fÜS”v”
(
kmf
).
s¦Provid”
(
´ovid”
).
Œu¡Mªag”
(
tmf
).
bud
();

57  
	mS¦CÚ‹xtBud”
.
fÜCl›Á
().
s¦Provid”
(
´ovid”
).
keyMªag”
(
kmf
).
Œu¡Mªag”
(
tmf
).
bud
();

61 
´iv©e
 
KeyMªag”FaùÜy
 
	$ü—‹KeyMªag”FaùÜy
(
SŒšg
 
keyStÜeP©h
,

62 
SŒšg
 
ksPasswÜdFe
è
throws
 
SSLExû±iÚ
 {

63 
SŒšg
 
keyStÜePasswÜd
 = 
TlsUts
.
	`g‘KeyStÜePasswÜd
(
ksPasswÜdFe
);

64 
KeyStÜe
 
keyStÜe
 = 
TlsUts
.
	`İ’KeyStÜe
(
keyStÜeP©h
, 
keyStÜePasswÜd
);

66 
KeyMªag”FaùÜy
 
kmf
;

67 
Œy
 {

68 
kmf
 = 
KeyMªag”FaùÜy
.
	`g‘In¡ªû
(KeyMªag”FaùÜy.
	`g‘DeçuÉAlgÜ™hm
());

69 
kmf
.
	`š™
(
keyStÜe
, 
keyStÜePasswÜd
.
	`toCh¬A¼ay
());

70  
kmf
;

71 } 
	`ÿtch
 (
UÄecov”abËKeyExû±iÚ
 
e
) {

72 
SŒšg
 
”rÜMes§ge
 = "UÄecov”abË key iÀkey stÜ" + 
keyStÜeP©h
 + ".";

73 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

74 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

75 } 
	`ÿtch
 (
NoSuchAlgÜ™hmExû±iÚ
 
e
) {

76 
SŒšg
 
”rÜMes§ge
 = "Can‚ot create key manager factory with default‡lgorithm "

77 + 
KeyMªag”FaùÜy
.
	`g‘DeçuÉAlgÜ™hm
() + ".";

78 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

79 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

80 } 
	`ÿtch
 (
KeyStÜeExû±iÚ
 
e
) {

81 
SŒšg
 
”rÜMes§ge
 = "Cª‚Ù in™Ÿlizkey mªag” faùÜy from " + 
keyStÜeP©h
 + ".";

82 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

83 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

85 
	}
}

	@runtime/src/main/java/org/corfudb/security/tls/TlsUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gIOUts
;

6 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

7 
impÜt
 
	gjava
.
	gio
.
	gFe
;

8 
impÜt
 
	gjava
.
	gio
.
	gFeIÅutSŒ—m
;

9 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

10 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

11 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

12 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜe
;

13 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜeExû±iÚ
;

14 
impÜt
 
	gjava
.
	g£cur™y
.
	gNoSuchAlgÜ™hmExû±iÚ
;

15 
impÜt
 
	gjava
.
	g£cur™y
.
	gû¹
.
	gC”tifiÿ‹Exû±iÚ
;

21 @
Slf4j


22 
public
 cÏs 
	cTlsUts
 {

24 
´iv©e
 
	$TlsUts
() {

37 
public
 
KeyStÜe
 
	$İ’KeyStÜe
(
SŒšg
 
keyStÜeP©h
,

38 
SŒšg
 
·sswÜd
è
throws
 
SSLExû±iÚ
 {

39 
Fe
 
keyStÜeFe
 = 
Ãw
 
	`Fe
(
keyStÜeP©h
);

40 ià(!
keyStÜeFe
.
	`exi¡s
()) {

41 
SŒšg
 
”rÜMes§ge
 = "Key stÜf{" + 
keyStÜeP©h
 + "} doesn'tƒxist.";

42 
log
.
	`”rÜ
(
”rÜMes§ge
);

43 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
);

46 
FeIÅutSŒ—m
 
šputSŒ—m
 = 
nuÎ
;

47 
Œy
 {

48 
šputSŒ—m
 = 
Ãw
 
	`FeIÅutSŒ—m
(
keyStÜeP©h
);

49 
KeyStÜe
 
keyStÜe
 = KeyStÜe.
	`g‘In¡ªû
(KeyStÜe.
	`g‘DeçuÉTy³
());

50 
keyStÜe
.
	`lßd
(
šputSŒ—m
, 
·sswÜd
.
	`toCh¬A¼ay
());

51  
keyStÜe
;

52 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

53 
SŒšg
 
”rÜMes§ge
 = "UÇbËØ»ad key stÜf" + 
keyStÜeP©h
 + ".";

54 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

55 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

56 } 
	`ÿtch
 (
C”tifiÿ‹Exû±iÚ
 
e
) {

57 
SŒšg
 
”rÜMes§ge
 = "UÇbËØ»ad c”tifiÿ‹ š key stÜf" + 
keyStÜeP©h
 + ".";

58 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

59 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

60 } 
	`ÿtch
 (
NoSuchAlgÜ™hmExû±iÚ
 
e
) {

61 
SŒšg
 
”rÜMes§ge
 = "NØsuµÜˆfÜ‡lgÜ™hm [" + 
KeyStÜe
.
	`g‘DeçuÉTy³
() +

62 "] iÀkey stÜ" + 
keyStÜeP©h
 + ".";

63 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

64 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

65 } 
	`ÿtch
 (
KeyStÜeExû±iÚ
 
e
) {

66 
SŒšg
 
”rÜMes§ge
 = "Error creating‡ key store object of‡lgorithm ["

67 + 
KeyStÜe
.
	`g‘DeçuÉTy³
() + "].";

68 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

69 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

70 } 
fš®ly
 {

71 
IOUts
.
	`şo£Qu›y
(
šputSŒ—m
);

73 
	}
}

85 
public
 
SŒšg
 
	$g‘KeyStÜePasswÜd
(
SŒšg
 
·sswÜdFeP©h
è
throws
 
SSLExû±iÚ
 {

86 ià(
·sswÜdFeP©h
 =ğ
nuÎ
 ||…asswÜdFeP©h.
	`isEm±y
()) {

89 
Œy
 {

90  (
Ãw
 
	`SŒšg
(
Fes
.
	`»adAÎBy‹s
(
P©hs
.
	`g‘
(
·sswÜdFeP©h
)))).
	`Œim
();

91 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

92 
SŒšg
 
”rÜMes§ge
 = "UÇbËØ»ad…asswÜd f" + 
·sswÜdFeP©h
 + ".";

93 
log
.
	`”rÜ
(
”rÜMes§ge
, 
e
);

94 
throw
 
Ãw
 
	`SSLExû±iÚ
(
”rÜMes§ge
, 
e
);

96 
	}
}

	@runtime/src/main/java/org/corfudb/util/CFUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

6 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

7 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘iÚExû±iÚ
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

24 
public
 
fš®
 cÏs 
	cCFUts
 {

25 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	mSCHEDULER
 =

26 
ExecutÜs
.
ÃwScheduËdTh»adPoŞ
(

28 
Ãw
 
Th»adFaùÜyBud”
()

29 .
£tD«mÚ
(
Œue
)

30 .
£tNameFÜm©
("failAfter-%d")

31 .
bud
());

36 
fš®
 
TimeoutExû±iÚ
 
	mTIMEOUT_EXCEPTION
 = 
Ãw
 TimeoutException();

38 
´iv©e
 
	$CFUts
() {

42 @
	`Suµ»ssW¬nšgs
("unchecked")

43 
public
 <
T
,

44 
A
 
ex‹nds
 
ThrowabË
,

45 
B
 
ex‹nds
 
ThrowabË
,

46 
C
 
ex‹nds
 
ThrowabË
,

47 
D
 
ex‹nds
 
ThrowabË
> 
T
 
	`g‘Unš‹¼u±ibly
(
Futu»
<T> 
futu»
,

48 
CÏss
<
A
> 
throwabËA
,

49 
CÏss
<
B
> 
throwabËB
,

50 
CÏss
<
C
> 
throwabËC
,

51 
CÏss
<
D
> 
throwabËD
)

52 
throws
 
A
, 
B
, 
C
, 
D
 {

53 
Œy
 {

54  
futu»
.
	`g‘
();

55 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

56 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
("IÁ”ru±ed whcom¶‘šg futu»", 
e
);

57 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
“
) {

58 ià(
throwabËA
.
	`isIn¡ªû
(
“
.
	`g‘Cau£
())) {

59 
	`throw
 (
A
è
“
.
	`g‘Cau£
();

61 ià(
throwabËB
.
	`isIn¡ªû
(
“
.
	`g‘Cau£
())) {

62 
	`throw
 (
B
è
“
.
	`g‘Cau£
();

64 ià(
throwabËC
.
	`isIn¡ªû
(
“
.
	`g‘Cau£
())) {

65 
	`throw
 (
C
è
“
.
	`g‘Cau£
();

67 ià(
throwabËD
.
	`isIn¡ªû
(
“
.
	`g‘Cau£
())) {

68 
	`throw
 (
D
è
“
.
	`g‘Cau£
();

70 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
“
.
	`g‘Cau£
());

72 
	}
}

74 
public
 <
	gT
,

75 
A
 
ex‹nds
 
	gThrowabË
,

76 
B
 
ex‹nds
 
	gThrowabË
,

77 
C
 
ex‹nds
 
	gThrowabË
> 
T
 
g‘Unš‹¼u±ibly
(
Futu»
<T> 
futu»
,

78 
CÏss
<
A
> 
throwabËA
,

79 
CÏss
<
B
> 
throwabËB
,

80 
CÏss
<
C
> 
throwabËC
)

81 
throws
 
	gA
, 
	gB
, 
	gC
 {

82  
g‘Unš‹¼u±ibly
(
futu»
, 
throwabËA
, 
throwabËB
, 
throwabËC
,

83 
RuÁimeExû±iÚ
.
şass
);

86 
public
 <
	gT
,

87 
A
 
ex‹nds
 
	gThrowabË
,

88 
B
 
ex‹nds
 
	gThrowabË
> 
T
 
g‘Unš‹¼u±ibly
(
Futu»
<T> 
futu»
,

89 
CÏss
<
A
> 
throwabËA
,

90 
CÏss
<
B
> 
throwabËB
)

91 
throws
 
	gA
, 
	gB
 {

92  
g‘Unš‹¼u±ibly
(
futu»
, 
throwabËA
, 
throwabËB
, 
RuÁimeExû±iÚ
.
şass
,

93 
RuÁimeExû±iÚ
.
şass
);

96 
public
 <
	gT
, 
A
 
ex‹nds
 
	gThrowabË
> 
T
 
g‘Unš‹¼u±ibly
(
Futu»
<T> 
futu»
,

97 
CÏss
<
A
> 
throwabËA
)

98 
throws
 
	gA
 {

99  
g‘Unš‹¼u±ibly
(
futu»
, 
throwabËA
, 
RuÁimeExû±iÚ
.
şass
,

100 
RuÁimeExû±iÚ
.
şass
, RuntimeException.class);

103 
public
 <
	gT
> 
T
 
g‘Unš‹¼u±ibly
(
Futu»
<T> 
futu»
) {

104  
g‘Unš‹¼u±ibly
(
futu»
, 
RuÁimeExû±iÚ
.
şass
, RuntimeException.class,

105 
RuÁimeExû±iÚ
.
şass
, RuntimeException.class);

116 
public
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
	$çAá”
(
Du¿tiÚ
 
du¿tiÚ
) {

117 
fš®
 
Com¶‘abËFutu»
<
T
> 
´omi£
 = 
Ãw
 CompletableFuture<>();

118 
SCHEDULER
.
	`scheduË
((è-> 
´omi£
.
	`com¶‘eExû±iÚ®ly
(
TIMEOUT_EXCEPTION
),

119 
du¿tiÚ
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

120  
´omi£
;

121 
	}
}

134 
public
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
w™hš
(
Com¶‘abËFutu»
<
T
> 
futu»
, 
Du¿tiÚ
 
du¿tiÚ
) {

135 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gtimeout
 = 
çAá”
(
du¿tiÚ
);

136  
	gfutu»
.
­¶yToE™h”
(
timeout
, 
FunùiÚ
.
id’t™y
());

139 
public
 <
	gT
> 
	gCom¶‘abËFutu»
<
	gVoid
> 
®lOf
(
CŞËùiÚ
<
Com¶‘abËFutu»
<
T
>> 
futu»s
) {

140 
	gCom¶‘abËFutu»
<
	gT
>[] 
	gfutu»sA¼
 = 
futu»s
.
toA¼ay
(
Ãw
 
Com¶‘abËFutu»
[futu»s.
size
()]);

141  
	gCom¶‘abËFutu»
.
®lOf
(
futu»sA¼
);

151 
public
 <
	gT
> 
	gCom¶‘abËFutu»
<
	gLi¡
<T>> 
£qu’û
(
Li¡
<
Com¶‘abËFutu»
<
T
>> 
futu»s
) {

152  
®lOf
(
futu»s
).
th’Compo£
(
em±y
 -> {

153 
Com¶‘abËFutu»
<
Li¡
<
T
>> 
agg»g©ed
 = CompletableFuture

154 .
com¶‘edFutu»
(
Ãw
 
A¼ayLi¡
<>());

156 
Com¶‘abËFutu»
<
T
> 
futu»
 : 
futu»s
) {

157 
agg»g©ed
 =‡gg»g©ed.
th’Combše
(
futu»
, (
Li¡
<
T
> 
li¡
, T 
v®ue
) -> {

158 
li¡
.
add
(
v®ue
);

159  
li¡
;

163  
agg»g©ed
;

178 
public
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
runFutu»Aá”
(
Suµl›r
<
Com¶‘abËFutu»
<
T
>> 
futu»
,

179 
ScheduËdExecutÜS”viû
 
scheduËdExecutÜS”viû
,

180 
d–ay
,

181 
TimeUn™
 
un™s
) {

182 
	gCom¶‘abËFutu»
<
	gT
> 
	g»suÉFutu»
 = 
Ãw
 
Com¶‘abËFutu»
<>();

183 
	gscheduËdExecutÜS”viû
.
scheduË
((è-> 
futu»
.
g‘
()

184 .
th’Acû±
(
»suÉFutu»
::
com¶‘e
)

185 .
exû±iÚ®ly
(
»suÉ
 -> {

186 
»suÉFutu»
.
com¶‘eExû±iÚ®ly
(
»suÉ
);

187  
nuÎ
;

188 }), 
d–ay
, 
un™s
);

189  
	g»suÉFutu»
;

200 
public
 <
A
 
ex‹nds
 
	gThrowabË
> 
unw¿p
(
ThrowabË
 
throwabË
, 
CÏss
<A> 
throwabËA
è
throws
 
	gA
 {

202 
ThrowabË
 
	gunw¿pThrowabË
 = 
throwabË
;

203 ià(
throwabË
 
š¡ªûof
 
	gExecutiÚExû±iÚ
 ||hrowabË in¡ªûoà
	gCom¶‘iÚExû±iÚ
) {

204 
	gunw¿pThrowabË
 = 
throwabË
.
g‘Cau£
();

207 ià(
	gthrowabËA
.
isIn¡ªû
(
unw¿pThrowabË
)) {

208 
throw
 (
A
è
	gunw¿pThrowabË
;

210 ià(
unw¿pThrowabË
 
š¡ªûof
 
	gRuÁimeExû±iÚ
) {

211 
throw
 (
RuÁimeExû±iÚ
è
	gunw¿pThrowabË
;

213 ià(
unw¿pThrowabË
 
š¡ªûof
 
	gE¼Ü
) {

214 
throw
 (
E¼Ü
è
	gunw¿pThrowabË
;

216 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
unw¿pThrowabË
);

	@runtime/src/main/java/org/corfudb/util/CorfuComponent.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

9 
public
 
	eCÜfuCompÚ’t
 {

11 
ADDRESS_SPACE_VIEW
("corfu.runtime.as-view."),

12 
CLIENT_ROUTER
("corfu.runtime.client-router."),

13 
LOG_UNIT_CLIENT
("corfu.runtime.log-unit-client."),

14 
OBJECT
("corfu.runtime.object."),

15 
GARBAGE_COLLECTION
("corfu.runtime.gc."),

16 
CLIENT_SEQUENCER
("corfu.runtime.sequencer."),

19 
INFRA_MSG_HANDLER
("corfu.infrastructure.message-handler."),

20 
INFRA_SEQUENCER
("corfu.infrastructure.sequencer."),

21 
INFRA_STREAM_OPS
("corfu.infrastructure.stream-ops.");

23 
CÜfuCompÚ’t
(
SŒšg
 
v®ue
) {

24 
	mthis
.
	mv®ue
 = 
v®ue
;

27 
´iv©e
 
fš®
 
SŒšg
 
	mv®ue
;

29 @
Ov”ride


30 
public
 
SŒšg
 
toSŒšg
() {

31  
	mv®ue
;

	@runtime/src/main/java/org/corfudb/util/GitRepositoryState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 @
Slf4j


11 
public
 cÏs 
	cG™R•os™ÜyS‹
 {

13 
´iv©e
 
G™R•os™ÜyS‹
 
	m_g™R•os™ÜyS‹
 = 
nuÎ
;

15 
public
 
fš®
 
SŒšg
 
	mgs
;

16 
public
 
fš®
 
SŒšg
 
	mb¿nch
;

17 
public
 
fš®
 
SŒšg
 
	mdœty
;

18 
public
 
fš®
 
SŒšg
 
	m»mÙeOrigšU¾
;

19 
public
 
fš®
 
SŒšg
 
	mcomm™Id
;

20 
public
 
fš®
 
SŒšg
 
	mcomm™IdAbb»v
;

21 
public
 
fš®
 
SŒšg
 
	mdesüibe
;

22 
public
 
fš®
 
SŒšg
 
	mdesüibeShÜt
;

23 
public
 
fš®
 
SŒšg
 
	mcomm™U£rName
;

24 
public
 
fš®
 
SŒšg
 
	mcomm™U£rEma
;

25 
public
 
fš®
 
SŒšg
 
	mcomm™Mes§geFuÎ
;

26 
public
 
fš®
 
SŒšg
 
	mcomm™Mes§geShÜt
;

27 
public
 
fš®
 
SŒšg
 
	mcomm™Time
;

28 
public
 
fš®
 
SŒšg
 
	mşo£¡TagName
;

29 
public
 
fš®
 
SŒšg
 
	mşo£¡TagComm™CouÁ
;

30 
public
 
fš®
 
SŒšg
 
	mbudU£rName
;

31 
public
 
fš®
 
SŒšg
 
	mbudU£rEma
;

32 
public
 
fš®
 
SŒšg
 
	mbudTime
;

33 
public
 
fš®
 
SŒšg
 
	mbudHo¡
;

34 
public
 
fš®
 
SŒšg
 
	mbudV”siÚ
;

36 
´iv©e
 
	$G™R•os™ÜyS‹
(
Prİ”t›s
 
´İ”t›s
) {

37 
this
.
gs
 = 
´İ”t›s
.
	`g‘
("g™.gs").
	`toSŒšg
();

38 
this
.
b¿nch
 = 
´İ”t›s
.
	`g‘
("g™.b¿nch").
	`toSŒšg
();

39 
this
.
dœty
 = 
´İ”t›s
.
	`g‘
("g™.dœty").
	`toSŒšg
();

40 
this
.
»mÙeOrigšU¾
 = 
´İ”t›s
.
	`g‘
("g™.»mÙe.Üigš.u¾").
	`toSŒšg
();

42 
this
.
comm™Id
 = 
´İ”t›s
.
	`g‘
("g™.comm™.id").
	`toSŒšg
();

43 
this
.
comm™IdAbb»v
 = 
´İ”t›s
.
	`g‘
("g™.comm™.id.abb»v").
	`toSŒšg
();

44 
this
.
desüibe
 = 
´İ”t›s
.
	`g‘
("g™.comm™.id.desüibe").
	`toSŒšg
();

45 
this
.
desüibeShÜt
 = 
´İ”t›s
.
	`g‘
("g™.comm™.id.desüibe-shÜt").
	`toSŒšg
();

46 
this
.
comm™U£rName
 = 
´İ”t›s
.
	`g‘
("g™.comm™.u£r.Çme").
	`toSŒšg
();

47 
this
.
comm™U£rEma
 = 
´İ”t›s
.
	`g‘
("g™.comm™.u£r.ema").
	`toSŒšg
();

48 
this
.
comm™Mes§geFuÎ
 = 
´İ”t›s
.
	`g‘
("g™.comm™.mes§ge.fuÎ").
	`toSŒšg
();

49 
this
.
comm™Mes§geShÜt
 = 
´İ”t›s
.
	`g‘
("g™.comm™.mes§ge.shÜt").
	`toSŒšg
();

50 
this
.
comm™Time
 = 
´İ”t›s
.
	`g‘
("g™.comm™.time").
	`toSŒšg
();

51 
this
.
şo£¡TagName
 = 
´İ”t›s
.
	`g‘
("g™.şo£¡.g.Çme").
	`toSŒšg
();

52 
this
.
şo£¡TagComm™CouÁ
 = 
´İ”t›s
.
	`g‘
("g™.şo£¡.g.comm™.couÁ").
	`toSŒšg
();

54 
this
.
budU£rName
 = 
´İ”t›s
.
	`g‘
("g™.bud.u£r.Çme").
	`toSŒšg
();

55 
this
.
budU£rEma
 = 
´İ”t›s
.
	`g‘
("g™.bud.u£r.ema").
	`toSŒšg
();

56 
this
.
budTime
 = 
´İ”t›s
.
	`g‘
("g™.bud.time").
	`toSŒšg
();

57 
this
.
budHo¡
 = 
´İ”t›s
.
	`g‘
("g™.bud.ho¡").
	`toSŒšg
();

58 
this
.
budV”siÚ
 = 
´İ”t›s
.
	`g‘
("g™.bud.v”siÚ").
	`toSŒšg
();

65 
public
 
G™R•os™ÜyS‹
 
	$g‘R•os™ÜyS‹
() {

66 ià(
_g™R•os™ÜyS‹
 =ğ
nuÎ
) {

67 
Prİ”t›s
 
´İ”t›s
 = 
Ãw
 
	`Prİ”t›s
();

68 
Œy
 {

69 
´İ”t›s
.
	`lßd
(
G™R•os™ÜyS‹
.
şass
.
	`g‘CÏssLßd”
()

70 .
	`g‘ResourûAsSŒ—m
("git.properties"));

71 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

72 
log
.
	`”rÜ
("FaedØg‘„•os™Üy s‹", 
›
);

74 
_g™R•os™ÜyS‹
 = 
Ãw
 
	`G™R•os™ÜyS‹
(
´İ”t›s
);

76  
_g™R•os™ÜyS‹
;

77 
	}
}

	@runtime/src/main/java/org/corfudb/util/Holder.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

9 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

10 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
impÜt
 
	glombok
.
	gS‘‹r
;

18 @
AÎArgsCÚ¡ruùÜ


19 
public
 
şass
 
	gHŞd”
<
	gT
> {

20 @
	gG‘‹r


21 @
S‘‹r


22 
´iv©e
 
T
 
	g»f
;

	@runtime/src/main/java/org/corfudb/util/ImmutableListSetWrapper.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËLi¡
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

7 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
.
	gSim¶eImmubËEÁry
;

8 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùS‘
;

9 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
impÜt
 
	gjava
.
	gut
.
	gS¶™”©Ü
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

17 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

25 
public
 
şass
 
	gImmubËLi¡S‘W¿µ”
<
	gE
> 
ex‹nds
 
	gAb¡¿ùS‘
<E> 
im¶em’ts
 
	gS‘
<E> {

26 
´iv©e
 
fš®
 
	gLi¡
<
	gE
> 
	gš‹º®Li¡
;

28 
public
 <
	gK
, 
	gV
> 
	gImmubËLi¡S‘W¿µ”
<
	gEÁry
<K, V>> 
äomM­
(@
NÚNuÎ
 
M­
<
K
, 
V
> 
Üigš®
) {

29  
Ãw
 
	gImmubËLi¡S‘W¿µ”
<>(
	gÜigš®


30 .
’ŒyS‘
()

31 .
¡»am
()

32 .
m­
(
’Œy
 -> 
Ãw
 
Sim¶eImmubËEÁry
<>ÓÁry.
g‘Key
(),ƒÁry.
g‘V®ue
()))

33 .
cŞËù
(
ImmubËLi¡
.
toImmubËLi¡
()));

36 
public
 
ImmubËLi¡S‘W¿µ”
(@
NÚnuÎ
 
Li¡
<
E
> 
š‹º®Li¡
) {

37 
	gthis
.
	gš‹º®Li¡
 = 
š‹º®Li¡
;

40 @
Ov”ride


41 
public
 
size
() {

42  
	gš‹º®Li¡
.
size
();

45 @
Ov”ride


46 
public
 
boŞ—n
 
isEm±y
() {

47  
	gš‹º®Li¡
.
isEm±y
();

50 @
Ov”ride


51 
public
 
boŞ—n
 
cÚšs
(
Objeù
 
o
) {

52  
	gš‹º®Li¡
.
cÚšs
(
o
);

55 @
Ov”ride


56 
public
 
	gI‹¿tÜ
<
	gE
> 
™”©Ü
() {

57  
	gš‹º®Li¡
.
™”©Ü
();

60 @
Ov”ride


61 
public
 
fÜEach
(
CÚsum”
<? 
su³r
 
E
> 
aùiÚ
) {

62 
	gš‹º®Li¡
.
fÜEach
(
aùiÚ
);

65 @
Ov”ride


66 
public
 
	gObjeù
[] 
toA¼ay
() {

67  
	gš‹º®Li¡
.
toA¼ay
();

70 @
Ov”ride


71 
	gpublic
 <
	gT
> T[] 
toA¼ay
(
T
[] 
a
) {

72  
	gš‹º®Li¡
.
toA¼ay
(
a
);

75 @
Ov”ride


76 
public
 
boŞ—n
 
add
(
E
 
e
) {

77 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't‡dd");

80 @
Ov”ride


81 
public
 
boŞ—n
 
»move
(
Objeù
 
o
) {

82 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't„emove");

85 @
Ov”ride


86 
public
 
boŞ—n
 
cÚšsAÎ
(
CŞËùiÚ
<?> 
c
) {

87  
	gš‹º®Li¡
.
cÚšsAÎ
(
c
);

90 @
Ov”ride


91 
public
 
boŞ—n
 
addAÎ
(
CŞËùiÚ
<? 
ex‹nds
 
E
> 
c
) {

92 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't‡dd");

95 @
Ov”ride


96 
public
 
boŞ—n
 
»šAÎ
(
CŞËùiÚ
<?> 
c
) {

97 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't„emove");

100 @
Ov”ride


101 
public
 
boŞ—n
 
»moveAÎ
(
CŞËùiÚ
<?> 
c
) {

102 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't„emove");

105 @
Ov”ride


106 
public
 
boŞ—n
 
»moveIf
(
P»diÿ‹
<? 
su³r
 
E
> 
f‹r
) {

107 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't„emove");

110 @
Ov”ride


111 
public
 
ş—r
() {

112 
throw
 
Ãw
 
UnsuµÜ‹dO³¿tiÚExû±iÚ
("Immutable set can't clear");

115 @
Ov”ride


116 
public
 
	gS¶™”©Ü
<
	gE
> 
¥l™”©Ü
() {

117  
	gš‹º®Li¡
.
¥l™”©Ü
();

120 @
Ov”ride


121 
public
 
	gSŒ—m
<
	gE
> 
¡»am
() {

122  
	gš‹º®Li¡
.
¡»am
();

125 @
Ov”ride


126 
public
 
	gSŒ—m
<
	gE
> 
·¿Î–SŒ—m
() {

127  
	gš‹º®Li¡
.
¡»am
();

	@runtime/src/main/java/org/corfudb/util/JsonUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚBud”
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gJsÚEËm’t
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gJsÚP¬£r
;

11 
public
 cÏs 
	cJsÚUts
 {

13 
´iv©e
 
	$JsÚUts
() {

17 
public
 
fš®
 
GsÚ
 
·r£r
 = 
Ãw
 
	`GsÚBud”
().
	`£tP»‰yPrštšg
().
	`ü—‹
();

18 
´iv©e
 
fš®
 
GsÚ
 
REGULAR_PARSER
 = 
Ãw
 
	`GsÚBud”
().
	`ü—‹
();

26 
public
 
SŒšg
 
	$´‘tyPršt
(
SŒšg
 
jsÚSŒšg
) {

27 
JsÚP¬£r
 
p
 = 
Ãw
 
	`JsÚP¬£r
();

28 
JsÚEËm’t
 
e
 = 
p
.
	`·r£
(
jsÚSŒšg
);

29  
·r£r
.
	`toJsÚ
(
e
);

30 
	}
}

32 
public
 <
	gT
> 
SŒšg
 
	$toJsÚ
(
T
 
obj
){

33  
REGULAR_PARSER
.
	`toJsÚ
(
obj
);

34 
	}
}

36 
public
 <
	gT
> 
T
 
äomJsÚ
(
SŒšg
 
jsÚ
, 
CÏss
<T> 
ty³
) {

37  
	gREGULAR_PARSER
.
äomJsÚ
(
jsÚ
, 
ty³
);

	@runtime/src/main/java/org/corfudb/util/LambdaUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiCÚsum”
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiP»diÿ‹
;

10 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBš¬yO³¿tÜ
;

11 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBoŞ—nSuµl›r
;

12 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

13 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËBš¬yO³¿tÜ
;

14 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËCÚsum”
;

15 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËFunùiÚ
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËP»diÿ‹
;

17 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËSuµl›r
;

18 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËToIÁFunùiÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËToLÚgFunùiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gDoubËUÇryO³¿tÜ
;

21 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁBš¬yO³¿tÜ
;

23 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁCÚsum”
;

24 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁFunùiÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁP»diÿ‹
;

26 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁSuµl›r
;

27 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁToDoubËFunùiÚ
;

28 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁToLÚgFunùiÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁUÇryO³¿tÜ
;

30 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgBš¬yO³¿tÜ
;

31 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgCÚsum”
;

32 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgFunùiÚ
;

33 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgP»diÿ‹
;

34 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgSuµl›r
;

35 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgToDoubËFunùiÚ
;

36 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgToIÁFunùiÚ
;

37 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gLÚgUÇryO³¿tÜ
;

38 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gObjDoubËCÚsum”
;

39 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gObjIÁCÚsum”
;

40 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gObjLÚgCÚsum”
;

41 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

42 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

43 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gToDoubËBiFunùiÚ
;

44 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gToDoubËFunùiÚ
;

45 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gToIÁBiFunùiÚ
;

46 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gToIÁFunùiÚ
;

47 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gToLÚgBiFunùiÚ
;

48 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gToLÚgFunùiÚ
;

49 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gUÇryO³¿tÜ
;

54 @
Slf4j


55 
public
 cÏs 
	cLambdaUts
 {

57 
´iv©e
 
	$LambdaUts
() {

61 
´iv©e
 
fš®
 
M­
<
CÏss
<
Objeù
>,

62 
LambdaResŞv”
<
Objeù
>> 
di¥©chM­
 = 
	`g’”©eDi¥©chM­
();

64 @
	`Suµ»ssW¬nšgs
("unchecked")

65 
´iv©e
 
M­
<
CÏss
<
Objeù
>, 
LambdaResŞv”
<Objeù>> 
	$g’”©eDi¥©chM­
() {

66 
ImmubËM­
.
Bud”
<
CÏss
<
Objeù
>, 
LambdaResŞv”
<Objeù>> 
bud”
 =

67 
ImmubËM­
.<
CÏss
<
Objeù
>, 
LambdaResŞv”
<Objeù>>
	`bud”
();

69 
	`ty³dPut
(
bud”
, 
BiCÚsum”
.
şass
, (
f
, 
a
) -> {

70 
f
.
	`acû±
(
a
[0],‡[1]);

71  
nuÎ
;

73 
	`ty³dPut
(
bud”
, 
BiFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(a[0],‡[1]));

74 
	`ty³dPut
(
bud”
, 
Bš¬yO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(a[0],‡[1]));

75 
	`ty³dPut
(
bud”
, 
BiP»diÿ‹
.
şass
, (
f
, 
a
è-> f.
	`‹¡
(a[0],‡[1]));

76 
	`ty³dPut
(
bud”
, 
BoŞ—nSuµl›r
.
şass
, (
f
, 
a
è-> f.
	`g‘AsBoŞ—n
());

77 
	`ty³dPut
(
bud”
, 
CÚsum”
.
şass
, (
f
, 
a
) -> {

78 
f
.
	`acû±
(
a
[0]);

79  
nuÎ
;

81 
	`ty³dPut
(
bud”
, 
DoubËBš¬yO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsDoubË
(()‡[0],

82 (è
a
[1]));

83 
	`ty³dPut
(
bud”
, 
DoubËCÚsum”
.
şass
, (
f
, 
a
) -> {

84 
f
.
	`acû±
((è
a
[0]);

85  
nuÎ
;

87 
	`ty³dPut
(
bud”
, 
DoubËFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(()‡[0]));

88 
	`ty³dPut
(
bud”
, 
DoubËP»diÿ‹
.
şass
, (
f
, 
a
è-> f.
	`‹¡
(()‡[0]));

89 
	`ty³dPut
(
bud”
, 
DoubËSuµl›r
.
şass
, (
f
, 
a
è-> f.
	`g‘AsDoubË
());

90 
	`ty³dPut
(
bud”
, 
DoubËToIÁFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsIÁ
(()‡[0]));

91 
	`ty³dPut
(
bud”
, 
DoubËToLÚgFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsLÚg
(()‡[0]));

92 
	`ty³dPut
(
bud”
, 
DoubËUÇryO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsDoubË
(()‡[0]));

93 
	`ty³dPut
(
bud”
, 
FunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(a[0]));

94 
	`ty³dPut
(
bud”
, 
IÁBš¬yO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsIÁ
(()‡[0], ()‡[1]));

95 
	`ty³dPut
(
bud”
, 
IÁCÚsum”
.
şass
, (
f
, 
a
) -> {

96 
f
.
	`acû±
((è
a
[0]);

97  
nuÎ
;

99 
	`ty³dPut
(
bud”
, 
IÁFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(()‡[0]));

100 
	`ty³dPut
(
bud”
, 
IÁP»diÿ‹
.
şass
, (
f
, 
a
è-> f.
	`‹¡
(()‡[0]));

101 
	`ty³dPut
(
bud”
, 
IÁSuµl›r
.
şass
, (
f
, 
a
è-> f.
	`g‘AsIÁ
());

102 
	`ty³dPut
(
bud”
, 
IÁToDoubËFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsDoubË
(()‡[0]));

103 
	`ty³dPut
(
bud”
, 
IÁToLÚgFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsLÚg
(()‡[0]));

104 
	`ty³dPut
(
bud”
, 
IÁUÇryO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsIÁ
(()‡[0]));

105 
	`ty³dPut
(
bud”
, 
LÚgBš¬yO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsLÚg
(()‡[0],

106 (è
a
[1]));

107 
	`ty³dPut
(
bud”
, 
LÚgCÚsum”
.
şass
, (
f
, 
a
) -> {

108 
f
.
	`acû±
((è
a
[0]);

109  
nuÎ
;

111 
	`ty³dPut
(
bud”
, 
LÚgFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(()‡[0]));

112 
	`ty³dPut
(
bud”
, 
LÚgP»diÿ‹
.
şass
, (
f
, 
a
è-> f.
	`‹¡
(()‡[0]));

113 
	`ty³dPut
(
bud”
, 
LÚgSuµl›r
.
şass
, (
f
, 
a
è-> f.
	`g‘AsLÚg
());

114 
	`ty³dPut
(
bud”
, 
LÚgToDoubËFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsDoubË
(()‡[0]));

115 
	`ty³dPut
(
bud”
, 
LÚgToIÁFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsIÁ
(()‡[0]));

116 
	`ty³dPut
(
bud”
, 
LÚgUÇryO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsLÚg
(()‡[0]));

117 
	`ty³dPut
(
bud”
, 
ObjDoubËCÚsum”
.
şass
, (
f
, 
a
) -> {

118 
f
.
	`acû±
(
a
[0], ()‡[1]);

119  
nuÎ
;

121 
	`ty³dPut
(
bud”
, 
ObjIÁCÚsum”
.
şass
, (
f
, 
a
) -> {

122 
f
.
	`acû±
(
a
[0], ()‡[1]);

123  
nuÎ
;

125 
	`ty³dPut
(
bud”
, 
ObjLÚgCÚsum”
.
şass
, (
f
, 
a
) -> {

126 
f
.
	`acû±
(
a
[0], ()‡[1]);

127  
nuÎ
;

129 
	`ty³dPut
(
bud”
, 
P»diÿ‹
.
şass
, (
f
, 
a
è-> f.
	`‹¡
(a[0]));

130 
	`ty³dPut
(
bud”
, 
Suµl›r
.
şass
, (
f
, 
a
è-> f.
	`g‘
());

131 
	`ty³dPut
(
bud”
, 
ToDoubËBiFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsDoubË
(a[0],‡[1]));

132 
	`ty³dPut
(
bud”
, 
ToDoubËFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsDoubË
(a[0]));

133 
	`ty³dPut
(
bud”
, 
ToIÁBiFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsIÁ
(a[0],‡[1]));

134 
	`ty³dPut
(
bud”
, 
ToIÁFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsIÁ
(a[0]));

135 
	`ty³dPut
(
bud”
, 
ToLÚgBiFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsLÚg
(a[0],‡[1]));

136 
	`ty³dPut
(
bud”
, 
ToLÚgFunùiÚ
.
şass
, (
f
, 
a
è-> f.
	`­¶yAsLÚg
(a[0]));

137 
	`ty³dPut
(
bud”
, 
UÇryO³¿tÜ
.
şass
, (
f
, 
a
è-> f.
	`­¶y
(a[0]));

139  
bud”
.
	`bud
();

140 
	}
}

142 @
Suµ»ssW¬nšgs
("unchecked")

143 
´iv©e
 <
	gT
, 
	gU
> 
	gImmubËM­
.
	gBud”
<
	gCÏss
<T>, 
	gLambdaResŞv”
<T>> 
ty³dPut
(

144 
ImmubËM­
.
Bud”
<
CÏss
<
T
>, 
LambdaResŞv”
<T>> 
bud”
,

145 
CÏss
<
U
> 
şs
,

146 
LambdaResŞv”
<
U
> 
â
) {

147  
	gbud”
.
put
((
CÏss
<
T
>è
şs
, (
LambdaResŞv”
<T>è
â
);

153 
public
 
Objeù
 
	$execu‹UnknownLambda
(
Objeù
 
unknownLambda
, Objeù... 
¬gum’ts
) {

154  
di¥©chM­
.
	`’ŒyS‘
().
	`¡»am
()

155 .
	`f‹r
(
e
 ->ƒ.
	`g‘Key
().
	`isIn¡ªû
(
unknownLambda
))

156 .
	`fšdFœ¡
().
	`g‘
().
	`g‘V®ue
().
	`»sŞve
(
unknownLambda
, 
¬gum’ts
);

157 
	}
}

159 @
FunùiÚ®IÁ”çû


160 
š‹rçû
 
	gLambdaResŞv”
<
	gT
> {

161 
Objeù
 
»sŞve
(
T
 
»sŞv”
, Objeù[] 
¬gs
);

170 
public
 
	$runSªsThrow
(
RuÂabË
 
ruÂabË
) {

171 
Œy
 {

172 
ruÂabË
.
	`run
();

173 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

174 
log
.
	`”rÜ
("runSªsThrow: Suµ»ssšgƒxû±iÚ whexecutšg„uÂabË: ", 
e
);

176 
	}
}

	@runtime/src/main/java/org/corfudb/util/MetricsUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gCouÁ”
;

4 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gCsvR•Ü‹r
;

5 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gGauge
;

6 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjmx
.
	gJmxR•Ü‹r
;

7 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricF‹r
;

8 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

9 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricS‘
;

10 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gR©ioGauge
;

11 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gSlf4jR•Ü‹r
;

12 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

13 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjvm
.
	gBufãrPoŞM‘ricS‘
;

14 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjvm
.
	gCÏssLßdšgGaugeS‘
;

15 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjvm
.
	gFeDesütÜR©ioGauge
;

16 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjvm
.
	gG¬bageCŞËùÜM‘ricS‘
;

17 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjvm
.
	gMemÜyU§geGaugeS‘
;

18 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gjvm
.
	gTh»adS‹sGaugeS‘
;

19 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCache
;

21 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gPoŞedBy‹BufAÎoÿtÜ
;

23 
impÜt
 
	gjava
.
	gio
.
	gFe
;

24 
impÜt
 
	gjava
.
	gÏng
.
	gmªagem’t
.
	gMªagem’tFaùÜy
;

25 
impÜt
 
	gjava
.
	gÏng
.
	g»f
.
	gW—kReã»nû
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	gM‘ricsS”v”
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	g£rv”s
.
	gProm‘heusM‘ricsS”v”
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	g£rv”s
.
	gProm‘heusM‘ricsS”v”
.
	gCÚfig
;

31 
impÜt
 
	gÜg
.
	gehÿche
..
	gSizeOf
;

32 
impÜt
 
	gÜg
.
	g¦f4j
.
	gLogg”FaùÜy
;

34 
impÜt
 
	glombok
.
	gG‘‹r
;

35 
impÜt
 
	glombok
.
	gNÚNuÎ
;

36 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

38 @
Slf4j


39 
public
 cÏs 
	cM‘ricsUts
 {

41 
´iv©e
 
	$M‘ricsUts
() {

45 
´iv©e
 
fš®
 
Gauge
<
LÚg
> 
m‘ricsJVMU±ime
 =

46 (è-> 
Mªagem’tFaùÜy
.
	`g‘RuÁimeMXB—n
().
	`g‘U±ime
();

47 
´iv©e
 
fš®
 
R©ioGauge
 
m‘ricsJVMFdGauge
 = 
Ãw
 
	`FeDesütÜR©ioGauge
();

48 
´iv©e
 
fš®
 
M‘ricS‘
 
m‘ricsBuffPoŞed
 =

49 
Ãw
 
	`BufãrPoŞM‘ricS‘
(
Mªagem’tFaùÜy
.
	`g‘PÏtfÜmMB—nS”v”
());

50 
´iv©e
 
fš®
 
M‘ricS‘
 
m‘ricsCÏssLßdšgGauge
 = 
Ãw
 
	`CÏssLßdšgGaugeS‘
();

51 
´iv©e
 
fš®
 
M‘ricS‘
 
m‘ricsJVMGC
 = 
Ãw
 
	`G¬bageCŞËùÜM‘ricS‘
();

52 
´iv©e
 
fš®
 
M‘ricS‘
 
m‘ricsJVMMem
 = 
Ãw
 
	`MemÜyU§geGaugeS‘
();

53 
´iv©e
 
fš®
 
M‘ricS‘
 
m‘ricsJVMTh»ad
 = 
Ãw
 
	`Th»adS‹sGaugeS‘
();

56 
´iv©e
 
fš®
 
SŒšg
 
CORFU_METRICS
 = "corfu.metrics";

59 
´iv©e
 
fš®
 
SŒšg
 
PROPERTY_CSV_FOLDER
 = "corfu.metrics.csv.folder";

60 
´iv©e
 
fš®
 
SŒšg
 
PROPERTY_CSV_INTERVAL
 = "corfu.metrics.csv.interval";

61 
´iv©e
 
fš®
 
SŒšg
 
PROPERTY_JMX_REPORTING
 = "corfu.metrics.jmxreporting";

62 
´iv©e
 
fš®
 
SŒšg
 
PROPERTY_JVM_METRICS_COLLECTION
 = "corfu.metrics.jvm";

63 
´iv©e
 
fš®
 
SŒšg
 
PROPERTY_LOG_INTERVAL
 = "corfu.metrics.log.interval";

64 
´iv©e
 
fš®
 
SŒšg
 
PROPERTY_LOCAL_METRICS_COLLECTION
 =

67 
´iv©e
 
fš®
 
SŒšg
 
ADDRESS_SPACE_METRIC_PREFIX
 = "corfu.runtime.as-view";

68 
´iv©e
 
fš®
 
M‘ricF‹r
 
ADDRESS_SPACE_FILTER
 =

69 (
Çme
, 
m‘ric
è-> !Çme.
	`cÚšs
(
ADDRESS_SPACE_METRIC_PREFIX
);

71 
´iv©e
 
m‘ricsCsvIÁ”v®
;

72 
´iv©e
 
m‘ricsLogIÁ”v®
;

73 
´iv©e
 
SŒšg
 
m‘ricsCsvFŞd”
;

74 @
G‘‹r


75 
´iv©e
 
boŞ—n
 
m‘ricsCŞËùiÚEÇbËd
 = 
çl£
;

76 
´iv©e
 
boŞ—n
 
m‘ricsLoÿlCŞËùiÚEÇbËd
 = 
çl£
;

77 
´iv©e
 
boŞ—n
 
m‘ricsCsvR•ÜtšgEÇbËd
 = 
çl£
;

78 
´iv©e
 
boŞ—n
 
m‘ricsJmxR•ÜtšgEÇbËd
 = 
çl£
;

79 
´iv©e
 
boŞ—n
 
m‘ricsJvmCŞËùiÚEÇbËd
 = 
çl£
;

80 
´iv©e
 
boŞ—n
 
m‘ricsSlf4jR•ÜtšgEÇbËd
 = 
çl£
;

81 
´iv©e
 
fš®
 
SŒšg
 
mpTrigg”
 = "filter-trigger";

83 
public
 
fš®
 
SizeOf
 
sizeOf
 = SizeOf.
	`ÃwIn¡ªû
();

84 
public
 
fš®
 
NO_METRICS_PORT
 = -1;

124 
´iv©e
 
	$lßdVmPrİ”t›s
() {

125 
m‘ricsLoÿlCŞËùiÚEÇbËd
 = 
BoŞ—n
.
	`v®ueOf
(
Sy¡em
.
	`g‘Prİ”ty
(

126 
PROPERTY_LOCAL_METRICS_COLLECTION
));

128 
m‘ricsJmxR•ÜtšgEÇbËd
 = 
BoŞ—n
.
	`v®ueOf
(
Sy¡em
.
	`g‘Prİ”ty
(
PROPERTY_JMX_REPORTING
));

129 
m‘ricsJvmCŞËùiÚEÇbËd
 = 
BoŞ—n
.
	`v®ueOf
(
Sy¡em
.
	`g‘Prİ”ty
(
PROPERTY_JVM_METRICS_COLLECTION
));

131 
m‘ricsLogIÁ”v®
 = 
LÚg
.
	`v®ueOf
(
Sy¡em
.
	`g‘Prİ”ty
(
PROPERTY_LOG_INTERVAL
, "0"));

132 
m‘ricsSlf4jR•ÜtšgEÇbËd
 = 
m‘ricsLogIÁ”v®
 > 0;

134 
m‘ricsCsvIÁ”v®
 = 
LÚg
.
	`v®ueOf
(
Sy¡em
.
	`g‘Prİ”ty
(
PROPERTY_CSV_INTERVAL
, "0"));

135 
m‘ricsCsvFŞd”
 = 
SŒšg
.
	`v®ueOf
(
Sy¡em
.
	`g‘Prİ”ty
(
PROPERTY_CSV_FOLDER
));

136 
m‘ricsCsvR•ÜtšgEÇbËd
 = 
m‘ricsCsvIÁ”v®
 > 0;

137 
	}
}

146 
public
 
boŞ—n
 
isM‘ricsR•ÜtšgS‘Up
(@
NÚNuÎ
 
M‘ricRegi¡ry
 
m‘rics
) {

147  
	gm‘rics
.
g‘Names
().
cÚšs
(
mpTrigg”
);

158 
public
 
m‘ricsR•ÜtšgS‘up
(@
NÚNuÎ
 
M‘ricRegi¡ry
 
m‘rics
) {

159 ià(
isM‘ricsR•ÜtšgS‘Up
(
m‘rics
)) {

163 
	gm‘rics
.
couÁ”
(
mpTrigg”
);

165 
lßdVmPrİ”t›s
();

167 ià(
	gm‘ricsLoÿlCŞËùiÚEÇbËd
) {

168 
£tupCsvR•Ütšg
(
m‘rics
);

169 
£tupJvmM‘rics
(
m‘rics
);

170 
£tupJmxR•Ütšg
(
m‘rics
);

171 
£tupSlf4jR•Ütšg
(
m‘rics
);

173 
	gm‘ricsCŞËùiÚEÇbËd
 = 
Œue
;

174 
	glog
.
šfo
("Corfu CSV metrics collection‡nd‡ll„eportingypes‡reƒnabled");

183 
public
 
m‘ricsR•ÜtšgS‘up
(@
NÚNuÎ
 
M‘ricRegi¡ry
 
m‘ricRegi¡ry
,

184 
´om‘heusM‘ricsPÜt
) {

185 
CÚfig
 
	gcÚfig
 = 
Ãw
 CÚfig(
´om‘heusM‘ricsPÜt
, CÚfig.
ENABLED
);

186 
M‘ricsS”v”
 
	g£rv”
 = 
Ãw
 
Prom‘heusM‘ricsS”v”
(
cÚfig
, 
m‘ricRegi¡ry
);

187 
	g£rv”
.
¡¬t
();

189 
	gm‘ricsCŞËùiÚEÇbËd
 = 
Œue
;

190 
	glog
.
šfo
("Metricsƒxporting via Prometheus has beenƒnabled‡t…ort {}.",

191 
´om‘heusM‘ricsPÜt
);

195 
´iv©e
 
	$£tupJmxR•Ütšg
(
M‘ricRegi¡ry
 
m‘ricRegi¡ry
) {

196 ià(!
m‘ricsJmxR•ÜtšgEÇbËd
) ;

199 
JmxR•Ü‹r
 
jmxR•Ü‹r
 = JmxR•Ü‹r.
	`fÜRegi¡ry
(
m‘ricRegi¡ry
)

200 .
	`cÚv”tDu¿tiÚsTo
(
TimeUn™
.
MICROSECONDS
)

201 .
	`cÚv”tR©esTo
(
TimeUn™
.
SECONDS
)

202 .
	`šDomaš
(
CORFU_METRICS
)

203 .
	`f‹r
(
ADDRESS_SPACE_FILTER
)

204 .
	`bud
();

205 
jmxR•Ü‹r
.
	`¡¬t
();

206 
	}
}

209 
´iv©e
 
	$£tupSlf4jR•Ütšg
(
M‘ricRegi¡ry
 
m‘rics
) {

210 ià(!
m‘ricsSlf4jR•ÜtšgEÇbËd
) ;

212 
M‘ricF‹r
 
mpTrigg”F‹r
 = (
Çme
, 
m‘ric
è-> !Çme.
	`equ®s
(
mpTrigg”
);

214 
Slf4jR•Ü‹r
 
¦f4jR•Ü‹r
 = Slf4jR•Ü‹r.
	`fÜRegi¡ry
(
m‘rics
)

215 .
	`cÚv”tDu¿tiÚsTo
(
TimeUn™
.
MICROSECONDS
)

216 .
	`cÚv”tR©esTo
(
TimeUn™
.
SECONDS
)

217 .
	`ouutTo
(
Logg”FaùÜy
.
	`g‘Logg”
("org.corfudb.metricsdata"))

218 .
	`f‹r
(
mpTrigg”F‹r
)

219 .
	`bud
();

220 
¦f4jR•Ü‹r
.
	`¡¬t
(
m‘ricsLogIÁ”v®
, 
TimeUn™
.
SECONDS
);

221 
	}
}

224 
´iv©e
 
	$£tupCsvR•Ütšg
(
M‘ricRegi¡ry
 
m‘rics
) {

225 ià(!
m‘ricsCsvR•ÜtšgEÇbËd
) ;

227 
fš®
 
Fe
 
dœeùÜy
 = 
Ãw
 
	`Fe
(
m‘ricsCsvFŞd”
);

229 ià(!
dœeùÜy
.
	`isDœeùÜy
() ||

230 !
dœeùÜy
.
	`exi¡s
() ||

231 !
dœeùÜy
.
	`ÿnWr™e
()) {

232 
log
.
	`w¬n
("Provided CSV directory : {} doesn'tƒxist, isn't‡ directory, or " +

233 "nÙ‡cûssibË fÜ wr™es. Di§blšg CSV R•Ütšg.", 
dœeùÜy
);

234 
m‘ricsCsvR•ÜtšgEÇbËd
 = 
çl£
;

238 
CsvR•Ü‹r
 
csvR•Ü‹r
 = CsvR•Ü‹r.
	`fÜRegi¡ry
(
m‘rics
)

239 .
	`cÚv”tDu¿tiÚsTo
(
TimeUn™
.
MICROSECONDS
)

240 .
	`cÚv”tR©esTo
(
TimeUn™
.
SECONDS
)

241 .
	`f‹r
(
ADDRESS_SPACE_FILTER
)

242 .
	`bud
(
dœeùÜy
);

243 
csvR•Ü‹r
.
	`¡¬t
(
m‘ricsCsvIÁ”v®
, 
TimeUn™
.
SECONDS
);

244 
	}
}

249 
´iv©e
 
£tupJvmM‘rics
(@
NÚNuÎ
 
M‘ricRegi¡ry
 
m‘rics
) {

250 ià(!
	gm‘ricsJvmCŞËùiÚEÇbËd
) ;

252 
	gŒy
 {

253 
	gm‘rics
.("jvm.bufãrs", 
	gm‘ricsBuffPoŞed
);

254 
	gm‘rics
.("jvm.şass-lßdšg", 
	gm‘ricsCÏssLßdšgGauge
);

255 
	gm‘rics
.("jvm.fe-desütÜs-u£d", 
	gm‘ricsJVMFdGauge
);

256 
	gm‘rics
.("jvm.gc", 
	gm‘ricsJVMGC
);

257 
	gm‘rics
.("jvm.memÜy", 
	gm‘ricsJVMMem
);

258 
	gm‘rics
.("jvm.th»ad", 
	gm‘ricsJVMTh»ad
);

259 
	gm‘rics
.("jvm.u±ime", 
	gm‘ricsJVMU±ime
);

260 
	gm‘rics
.("cÜfu.Ã‰y.mem.poŞed-by‹-buf.dœeù", 
g‘N‘tyPoŞedDœeùMemGauge
());

261 
	gm‘rics
.("cÜfu.Ã‰y.mem.poŞed-by‹-buf.h—p", 
g‘N‘tyPoŞedH—pMemGauge
());

262 } 
ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

267 
public
 
	gTim”
.
CÚ‹xt
 
g‘CÚd™iÚ®CÚ‹xt
(@
NÚNuÎ
 
Tim”
 
t
) {

268  
	gm‘ricsCŞËùiÚEÇbËd
 ? 
	gt
.
time
(è: 
nuÎ
;

271 
public
 
	$¡İCÚd™iÚ®CÚ‹xt
(
Tim”
.
CÚ‹xt
 
cÚ‹xt
) {

272 ià(
cÚ‹xt
 !ğ
nuÎ
) {

273 
cÚ‹xt
.
	`¡İ
();

275 
	}
}

277 
public
 
šcCÚd™iÚ®CouÁ”
(@
NÚNuÎ
 
CouÁ”
 
couÁ”
, 
amouÁ
) {

278 ià(
	gm‘ricsCŞËùiÚEÇbËd
) {

279 
	gcouÁ”
.
šc
(
amouÁ
);

286 
´iv©e
 
	gGauge
<
	gLÚg
> 
	$g‘N‘tyPoŞedDœeùMemGauge
() {

287  (è-> 
PoŞedBy‹BufAÎoÿtÜ
.
DEFAULT
.
	`m‘ric
().
	`u£dDœeùMemÜy
();

288 
	}
}

293 
´iv©e
 
	gGauge
<
	gLÚg
> 
	$g‘N‘tyPoŞedH—pMemGauge
() {

294  (è-> 
PoŞedBy‹BufAÎoÿtÜ
.
DEFAULT
.
	`m‘ric
().
	`u£dH—pMemÜy
();

295 
	}
}

310 
public
 
	gGauge
<
	gLÚg
> 
addMemÜyM—su»rFÜ
(@
NÚNuÎ
 
M‘ricRegi¡ry
 
m‘rics
,

311 
Objeù
 
objeù
) {

312 
SŒšg
 
	gsim¶eCÏssName
 = 
objeù
 =ğ
nuÎ
 ?

314 
objeù
.
g‘CÏss
().
g‘Sim¶eName
();

316  
	gm‘rics
.(
	gSŒšg
.
fÜm©
("deep-sizeof.%s@%04x",

317 
sim¶eCÏssName
,

318 
Sy¡em
.
id’t™yHashCode
(
objeù
)),

319 
g‘SizeGauge
(
objeù
));

333 
´iv©e
 
	gGauge
<
	gLÚg
> 
	$g‘SizeGauge
(
Objeù
 
objeù
) {

334 
W—kReã»nû
<
Objeù
> 
toBeM—su»dObjeù
 = 
Ãw
 W—kReã»nû<>(
objeù
);

337 
fš®
 
Objeù
 
objeùOfIÁ”e¡
 = 
toBeM—su»dObjeù
.
	`g‘
();

338  (
objeùOfIÁ”e¡
 !ğ
nuÎ
) ?

339 
sizeOf
.
	`d“pSizeOf
(
objeùOfIÁ”e¡
) :

342 
	}
}

358 
public
 
addCacheM—su»rFÜ
(@
NÚNuÎ
 
M‘ricRegi¡ry
 
m‘rics
, 
Cache
 
ÿche
) {

359 
	gŒy
 {

360 
	gm‘rics
.("ÿche.objeù-couÁs." + 
	gÿche
.
toSŒšg
(),

361 (
	gGauge
<
	gLÚg
>è
	gÿche
::
e¡im©edSize
);

362 
	gm‘rics
.("ÿche.eviùiÚs." + 
	gÿche
.
toSŒšg
(),

363 (
	gGauge
<
	gLÚg
>è
	gÿche
.
¡©s
()::
eviùiÚCouÁ
);

364 
	gm‘rics
.("ÿche.h™-¿‹." + 
	gÿche
.
toSŒšg
(),

365 (
	gGauge
<
	gDoubË
>è
	gÿche
.
¡©s
()::
h™R©e
);

366 
	gm‘rics
.("ÿche.h™s." + 
	gÿche
.
toSŒšg
(),

367 (
	gGauge
<
	gLÚg
>è
	gÿche
.
¡©s
()::
h™CouÁ
);

368 
	gm‘rics
.("ÿche.mis£s." + 
	gÿche
.
toSŒšg
(),

369 (
	gGauge
<
	gLÚg
>è
	gÿche
.
¡©s
()::
missCouÁ
);

370 } 
ÿtch
 (
IÎeg®Argum’tExû±iÚ
 
e
) {

	@runtime/src/main/java/org/corfudb/util/NetworkUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

6 
impÜt
 
	gjava
.
	gÃt
.
	gIÃt4Add»ss
;

7 
impÜt
 
	gjava
.
	gÃt
.
	gIÁ”çûAdd»ss
;

8 
impÜt
 
	gjava
.
	gÃt
.
	gN‘wÜkIÁ”çû
;

9 
impÜt
 
	gjava
.
	gÃt
.
	gSock‘Exû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

12 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

22 @
Slf4j


23 
public
 cÏs 
	cN‘wÜkUts
 {

25 
´iv©e
 
	$N‘wÜkUts
() {

36 
public
 
SŒšg
 
	$g‘Add»ssFromIÁ”çûName
(
SŒšg
 
š‹rçûName
) {

37 
Œy
 {

38 
N‘wÜkIÁ”çû
 
ÃtwÜkIÁ”çû
 : 
	`g‘AÎIÁ”çûs
()) {

39 ià(
ÃtwÜkIÁ”çû
.
	`isUp
()

40 && 
š‹rçûName
.
	`equ®s
(
ÃtwÜkIÁ”çû
.
	`g‘Name
())) {

41 
SŒšg
 
add»ss
;

42 ià(
ÃtwÜkIÁ”çû
.
	`isVœtu®
()) {

44 
add»ss
 = 
	`g‘IPV4Add»ss
(
ÃtwÜkIÁ”çû
.
	`g‘IÁ”çûAdd»s£s
());

48 
S‘
<
IÁ”çûAdd»ss
> 
·»ÁAdd»s£s
 = 
Ãw
 
HashS‘
<>(
ÃtwÜkIÁ”çû
.
	`g‘IÁ”çûAdd»s£s
());

49 
S‘
<
IÁ”çûAdd»ss
> 
subIÁ”çûsAdd»s£s
 = 
	`g‘SubIÁ”çûsAdd»s£s
(
ÃtwÜkIÁ”çû
);

50 
·»ÁAdd»s£s
.
	`»moveAÎ
(
subIÁ”çûsAdd»s£s
);

51 
add»ss
 = 
	`g‘IPV4Add»ss
(
Ãw
 
A¼ayLi¡
<>(
·»ÁAdd»s£s
));

54 ià(
add»ss
 !ğ
nuÎ
) {

55  
add»ss
;

61 } 
	`ÿtch
 (
Sock‘Exû±iÚ
 
e
) {

62 
log
.
	`”rÜ
("E¼Ü f‘chšg‡dd»s äom iÁ”çû‚am", 
e
);

63 
throw
 
Ãw
 
	`UÄecov”abËCÜfuE¼Ü
(
e
);

66 
throw
 
Ãw
 
	`UÄecov”abËCÜfuE¼Ü
("No valid interfaces with‚ame "

67 + 
š‹rçûName
 + " found.");

68 
	}
}

73 
´iv©e
 
	gS‘
<
	gIÁ”çûAdd»ss
> 
	$g‘SubIÁ”çûsAdd»s£s
(
N‘wÜkIÁ”çû
 
ÃtwÜkIÁ”çû
) {

74 
S‘
<
IÁ”çûAdd»ss
> 
š‹rçûAdd»s£s
 = 
Ãw
 
HashS‘
<>();

75 
N‘wÜkIÁ”çû
 
subIÁ”çû
 : 
CŞËùiÚs
.
	`li¡
(
ÃtwÜkIÁ”çû
.
	`g‘SubIÁ”çûs
())) {

76 
š‹rçûAdd»s£s
.
	`addAÎ
(
subIÁ”çû
.
	`g‘IÁ”çûAdd»s£s
());

78  
š‹rçûAdd»s£s
;

79 
	}
}

84 
´iv©e
 
SŒšg
 
g‘IPV4Add»ss
(
Li¡
<
IÁ”çûAdd»ss
> 
add»s£s
) {

85 
IÁ”çûAdd»ss
 
	gš‹rçûAdd»ss
 : 
add»s£s
) {

86 ià(
š‹rçûAdd»ss
.
g‘Add»ss
(è
š¡ªûof
 
IÃt4Add»ss
) {

87  
š‹rçûAdd»ss
.
g‘Add»ss
().
g‘Ho¡Add»ss
();

90  
	gnuÎ
;

98 
´iv©e
 
	gLi¡
<
	gN‘wÜkIÁ”çû
> 
	$g‘AÎIÁ”çûs
(è
throws
 
Sock‘Exû±iÚ
 {

99 
Li¡
<
N‘wÜkIÁ”çû
> 
®lIÁ”çûs
 = 
CŞËùiÚs
.
	`li¡
(N‘wÜkIÁ”çû.
	`g‘N‘wÜkIÁ”çûs
())

100 .
	`¡»am
()

101 .
	`æ©M­
(
m
 -> {

102 
Li¡
<
N‘wÜkIÁ”çû
> 
l
 = 
CŞËùiÚs
.
	`li¡
(
m
.
	`g‘SubIÁ”çûs
());

103 
l
.
	`add
(
m
);

104  
l
.
	`¡»am
();

106 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

107  
®lIÁ”çûs
;

108 
	}
}

	@runtime/src/main/java/org/corfudb/util/NodeLocator.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	glombok
.
	gBud”
;

5 
impÜt
 
	glombok
.
	gBud”
.
	gDeçuÉ
;

6 
impÜt
 
	glombok
.
	gEqu®sAndHashCode
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gSšguÏr
;

11 
impÜt
 
	gjava
.
	gio
.
	gS”ŸlizabË
;

12 
impÜt
 
	gjava
.
	gÃt
.
	gURI
;

13 
impÜt
 
	gjava
.
	gÃt
.
	gURISyÁaxExû±iÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

25 @
	gBud”


26 @
Equ®sAndHashCode


27 
public
 cÏs 
	cNodeLoÿtÜ
 
im¶em’ts
 
	mS”ŸlizabË
 {

29 
´iv©e
 
fš®
 
	m£rŸlV”siÚUID
 = 1L;

34 
public
 
	ePrÙocŞ
 {

38 
	mTCP


44 @
	gG‘‹r


45 @
	gNÚNuÎ


46 @
DeçuÉ


47 
´iv©e
 
fš®
 
PrÙocŞ
 
	g´ÙocŞ
 = PrÙocŞ.
TCP
;

52 @
	gG‘‹r


53 @
NÚNuÎ


54 
´iv©e
 
fš®
 
SŒšg
 
	gho¡
;

59 @
G‘‹r


60 
´iv©e
 
fš®
 
	gpÜt
;

65 @
G‘‹r


66 
´iv©e
 
fš®
 
UUID
 
	gnodeId
;

71 @
SšguÏr


72 
´iv©e
 
fš®
 
	gImmubËM­
<
	gSŒšg
, SŒšg> 
	gİtiÚs
;

80 
public
 
NodeLoÿtÜ
 
	$·r£SŒšg
(
SŒšg
 
toP¬£
) {

81 
Œy
 {

83 ià(!
toP¬£
.
	`cÚšs
("://")) {

84 
toP¬£
 = "tcp://" +oParse;

87 
URI
 
u¾
 = 
Ãw
 
	`URI
(
toP¬£
);

90 
PrÙocŞ
 
´Ùo
 = PrÙocŞ.
	`v®ueOf
(
u¾
.
	`g‘Scheme
().
	`toUµ”Ca£
());

93 
SŒšg
 
ho¡
 = 
u¾
.
	`g‘Ho¡
();

94 
pÜt
 = 
u¾
.
	`g‘PÜt
();

97 
UUID
 
nodeId
;

98 ià(
u¾
.
	`g‘P©h
().
	`equ®s
("") || url.getPath().equals("/")) {

100 
nodeId
 = 
nuÎ
;

102 
nodeId
 = 
UuidUts
.
	`äomBa£64
(
u¾
.
	`g‘P©h
().
	`»¶aûFœ¡
("/", ""));

106 
M­
<
SŒšg
, SŒšg> 
İtiÚs
;

107 ià(
u¾
.
	`g‘Qu”y
(è=ğ
nuÎ
 || u¾.g‘Qu”y().
	`equ®s
("")) {

108 
İtiÚs
 = 
CŞËùiÚs
.
	`em±yM­
();

110 
SŒšg
[] 
qu”y
 = 
u¾
.
	`g‘Qu”y
().
	`¥l™
("&");

111 
İtiÚs
 = 
A¼ays
.
	`¡»am
(
qu”y
)

112 .
	`m­
(
keyV®ue
 -> keyV®ue.
	`¥l™
("="))

113 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(
kv
 -> kv[0], kv -> kv[1]));

116  
NodeLoÿtÜ
.
	`bud”
()

117 .
	`´ÙocŞ
(
´Ùo
)

118 .
	`ho¡
(
ho¡
)

119 .
	`pÜt
(
pÜt
)

120 .
	`nodeId
(
nodeId
)

121 .
	`İtiÚs
(
İtiÚs
)

122 .
	`bud
();

124 } 
	`ÿtch
 (
URISyÁaxExû±iÚ
 
m
) {

125 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(
m
);

127 
	}
}

129 
public
 
SŒšg
 
	$toEndpoštU¾
(){

130  
ho¡
 + ":" + 
pÜt
;

131 
	}
}

133 @
Ov”ride


134 
public
 
SŒšg
 
	$toSŒšg
() {

135  
	`toEndpoštU¾
();

136 
	}
}

	@runtime/src/main/java/org/corfudb/util/ReflectionUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	glombok
.
	gNÚNuÎ
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gÏng3
.
	gCÏssUts
;

8 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gCÚ¡ruùÜ
;

9 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

10 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gM‘hod
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

13 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

14 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gM­
;

18 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

19 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gM©ch”
;

20 
impÜt
 
	gjava
.
	gut
.
	g»gex
.
	gP©‹º
;

21 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

26 @
Slf4j


27 
public
 cÏs 
	cReæeùiÚUts
 {

29 
´iv©e
 
	$ReæeùiÚUts
() {

33 
fš®
 
M­
<
SŒšg
, 
CÏss
> 
´im™iveTy³M­
 = 
ImmubËM­
.<SŒšg, CÏss>
	`bud”
()

34 .
	`put
("št", 
IÁeg”
.
TYPE
)

35 .
	`put
("lÚg", 
LÚg
.
TYPE
)

36 .
	`put
("doubË", 
DoubË
.
TYPE
)

37 .
	`put
("æßt", 
Flßt
.
TYPE
)

38 .
	`put
("boŞ", 
BoŞ—n
.
TYPE
)

39 .
	`put
("ch¬", 
Ch¬aù”
.
TYPE
)

40 .
	`put
("by‹", 
By‹
.
TYPE
)

41 .
	`put
("void", 
Void
.
TYPE
)

42 .
	`put
("shÜt", 
ShÜt
.
TYPE
)

43 .
	`put
("št[]", [].
şass
)

44 .
	`put
("lÚg[]", [].
şass
)

45 .
	`put
("doubË[]", [].
şass
)

46 .
	`put
("æßt[]", [].
şass
)

47 .
	`put
("boŞ[]", 
boŞ—n
[].
şass
)

48 .
	`put
("ch¬[]", [].
şass
)

49 .
	`put
("by‹[]", 
by‹
[].
şass
)

50 .
	`put
("shÜt[]", [].
şass
)

51 .
	`bud
();

52 
´iv©e
 
fš®
 
P©‹º
 
şassExŒaùÜ
 = P©‹º.
	`compe
("(\\S*)\\.(.*)\\(.*$");

54 
public
 
CÏss
<?> 
	$g‘Prim™iveTy³
(
SŒšg
 
s
) {

55  
´im™iveTy³M­
.
	`g‘
(
s
);

56 
	}
}

63 
public
 
	gCÏss
[] 
	$g‘Argum’tTy³sFromSŒšg
(
SŒšg
 
s
) {

64 
SŒšg
 
¬gLi¡
 = 
s
.
	`cÚšs
("("è? s.
	`sub¡ršg
(s.
	`šdexOf
('('è+ 1, s.
	`Ëngth
() - 1) : s;

65  
A¼ays
.
	`¡»am
(
¬gLi¡
.
	`¥l™
(","))

66 .
	`f‹r
(
x
 -> !x.
	`equ®s
(""))

67 .
	`m­
(
x
 -> {

68 
Œy
 {

69  
CÏss
.
	`fÜName
(
x
);

70 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
úã
) {

71 
CÏss
 
»tV®
 = 
	`g‘Prim™iveTy³
(
x
);

72 ià(
»tV®
 =ğ
nuÎ
) {

73 
log
.
	`w¬n
("CÏs {}‚Ù found", 
x
);

75  
»tV®
;

78 .
	`toA¼ay
(
CÏss
[]::
Ãw
);

79 
	}
}

98 
public
 <
	gT
> 
Objeù
 
fšdM©chšgCÚ¡ruùÜ
(

99 @
NÚNuÎ
 
CÚ¡ruùÜ
[] 
cÚ¡ruùÜs
, @NÚNuÎ 
Objeù
[] 
¬gs
)

100 
throws
 
	gIÎeg®AcûssExû±iÚ
, 
	gInvoÿtiÚT¬g‘Exû±iÚ
, 
	gIn¡ªtŸtiÚExû±iÚ
 {

102 
fš®
 
	gLi¡
<
	gCÏss
> 
	g¬gTy³s
 = 
A¼ays


103 .
¡»am
(
¬gs
).
m­
(
Objeù
::
g‘CÏss
)

104 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

106 
fš®
 
	gLi¡
<
	gCÚ¡ruùÜ
> 
	gcÚ¡ruùÜCªdid©es
 = 
A¼ays
.
¡»am
(
cÚ¡ruùÜs
)

107 .
f‹r
(
cÚ¡ruùÜ
 -> cÚ¡ruùÜ.
g‘P¬am‘”Ty³s
().
Ëngth
 =ğ
¬gs
.length)

108 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

110 
	gM­
<
	gIÁeg”
, 
	gCÚ¡ruùÜ
> 
	gm©chšgCÚ¡ruùÜs
 = 
Ãw
 
HashM­
<>();

111 
CÚ¡ruùÜ
 
	gÿndid©e
: 
cÚ¡ruùÜCªdid©es
) {

112 
fš®
 
Li¡
<
CÏss
> 
·¿m‘”Ty³s
 = 
A¼ays
.
asLi¡
(
ÿndid©e
.
g‘P¬am‘”Ty³s
());

113 
fš®
 
	gLi¡
<
	gIÁeg”
> 
	g»sŞutiÚLi¡
 = 
Ãw
 
LškedLi¡
<>();

115 
	gidx
 = 0; idx < 
	g·¿m‘”Ty³s
.
size
(); idx++) {

116 
fš®
 
	gCÏss
<?> 
	g·¿m‘”Ty³
 = 
·¿m‘”Ty³s
.
g‘
(
idx
);

117 
fš®
 
	gCÏss
<?> 
	g¬gum’tTy³
 = 
¬gTy³s
.
g‘
(
idx
);

121 
	g»sŞutiÚLi¡
.
add
(
maxD•th
(
·¿m‘”Ty³
, 
¬gum’tTy³
, 0));

126 ià(
	g»sŞutiÚLi¡
.
¡»am
().
ªyM©ch
(
d•th
 -> depth == 0)) {

132 
	gm©chšgCÚ¡ruùÜs
.
put
(

133 
»sŞutiÚLi¡
.
¡»am
().
»duû
(0, 
IÁeg”
::
sum
),

134 
ÿndid©e
);

138  
	gm©chšgCÚ¡ruùÜs
.
’ŒyS‘
().
¡»am
()

139 .
mš
(
M­
.
EÁry
.
com·ršgByKey
()).
ÜEl£Throw
(

140 (è-> 
Ãw
 
IÎeg®S‹Exû±iÚ
("No matching constructors found."))

141 .
g‘V®ue
().
ÃwIn¡ªû
(
¬gs
);

153 
´iv©e
 
	$maxD•th
(
CÏss
 
·¿m‘”Ty³
, CÏs 
¬gum’tTy³
, 
cu¼’tD•th
) {

154 ià(!
CÏssUts
.
	`isAssigÇbË
(
¬gum’tTy³
, 
·¿m‘”Ty³
, 
Œue
)) {

155  
cu¼’tD•th
;

157 
fš®
 
ÃwD•th
 = 
cu¼’tD•th
 + 1;

158 
fš®
 
Li¡
<
IÁeg”
> 
»suÉs
 = 
Ãw
 
A¼ayLi¡
<>();

159 
fš®
 
CÏss
[] 
š‹rçûs
 = 
¬gum’tTy³
.
	`g‘IÁ”çûs
();

160 
fš®
 
CÏss
 
su³rCÏss
 = 
¬gum’tTy³
.
	`g‘Su³rşass
();

162 
A¼ays
.
	`¡»am
(
š‹rçûs
)

163 .
	`fÜEach
(
şazz
 -> 
»suÉs
.
	`add
(
	`maxD•th
(
·¿m‘”Ty³
, cÏzz, 
ÃwD•th
)));

164 
O±iÚ®
.
	`ofNuÎabË
(
su³rCÏss
)

165 .
	`m­
(
şazz
 -> 
»suÉs
.
	`add
(
	`maxD•th
(
·¿m‘”Ty³
, cÏzz, 
ÃwD•th
)));

166  
»suÉs
.
	`¡»am
()

167 .
	`max
(
Com·¿tÜ
.
	`com·ršg
(
IÁeg”
::
v®ueOf
))

168 .
	`ÜEl£
(
ÃwD•th
);

170 
	}
}

177 
public
 
CÏss
 
	$g‘CÏssFromM‘hodToSŒšg
(
SŒšg
 
m‘hodSŒšg
) {

178 
M©ch”
 
m
 = 
şassExŒaùÜ
.
	`m©ch”
(
m‘hodSŒšg
);

179 
m
.
	`fšd
();

180 
SŒšg
 
şassName
 = 
m
.
	`group
(1);

181 
Œy
 {

182  
CÏss
.
	`fÜName
(
şassName
);

183 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
úã
) {

184 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
úã
);

186 
	}
}

	@runtime/src/main/java/org/corfudb/util/Sleep.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

16 @
D•»ÿ‹d


17 
public
 
	eSË•
 {

18 
	mNANOSECONDS
 {

19 @
Ov”ride


20 
toMlis
(
du¿tiÚ
) {

21  
	mTimeUn™
.
	mNANOSECONDS
.
toMlis
(
du¿tiÚ
);

24 
	mMICROSECONDS
 {

25 @
Ov”ride


26 
toMlis
(
du¿tiÚ
) {

27  
	mTimeUn™
.
	mMICROSECONDS
.
toMlis
(
du¿tiÚ
);

30 
	mMILLISECONDS
 {

31 @
Ov”ride


32 
toMlis
(
du¿tiÚ
) {

33  
	mTimeUn™
.
	mMILLISECONDS
.
toMlis
(
du¿tiÚ
);

36 
	mSECONDS
 {

37 @
Ov”ride


38 
toMlis
(
du¿tiÚ
) {

39  
	mTimeUn™
.
	mSECONDS
.
toMlis
(
du¿tiÚ
);

42 
	mMINUTES
 {

43 @
Ov”ride


44 
toMlis
(
du¿tiÚ
) {

45  
	mTimeUn™
.
	mMINUTES
.
toMlis
(
du¿tiÚ
);

48 
	mHOURS
 {

49 @
Ov”ride


50 
toMlis
(
du¿tiÚ
) {

51  
	mTimeUn™
.
	mHOURS
.
toMlis
(
du¿tiÚ
);

54 
	mDAYS
 {

55 @
Ov”ride


56 
toMlis
(
du¿tiÚ
) {

57  
	mTimeUn™
.
	mDAYS
.
toMlis
(
du¿tiÚ
);

66 
ab¡¿ù
 
toMlis
(
du¿tiÚ
);

77 
public
 
¦“pUnš‹¼u±ibly
(
Du¿tiÚ
 
du¿tiÚ
) {

78 
fš®
 
	mmli£cÚds
 = 
du¿tiÚ
.
toMlis
();

79 ià(
	mmli£cÚds
 == 0) {

80 
¦“pUnš‹¼u±ibly
(
du¿tiÚ
.
toNªos
(), 
TimeUn™
.
NANOSECONDS
);

82 
¦“pUnš‹¼u±ibly
(
du¿tiÚ
.
toMlis
(), 
TimeUn™
.
MILLISECONDS
);

95 @
Suµ»ssW¬nšgs
("checkstyle:ThreadSleep")

96 
´iv©e
 
¦“pUnš‹¼u±ibly
(
du¿tiÚ
, 
TimeUn™
 
timeUn™
) {

97 
	mŒy
 {

98 
	mtimeUn™
.
¦“p
(
du¿tiÚ
);

99 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

100 
throw
 
Ãw
 
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
("Unš‹¼u±ibË sË• iÁ”ru±ed", 
›
);

	@runtime/src/main/java/org/corfudb/util/Utils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

4 
impÜt
 
	gjdk
.
	gš‹º®
.
	gÜg
.
	gobjeùweb
.
	gasm
.
	gut
.
	gPrš‹r
;

5 
impÜt
 
	gjdk
.
	gš‹º®
.
	gÜg
.
	gobjeùweb
.
	gasm
.
	gut
.
	gTextif›r
;

6 
impÜt
 
	gjdk
.
	gš‹º®
.
	gÜg
.
	gobjeùweb
.
	gasm
.
	gut
.
	gT¿ûM‘hodVis™Ü
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

15 
impÜt
 
	gjava
.
	g‹xt
.
	gDecim®FÜm©
;

16 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

18 
impÜt
 
	gjava
.
	gut
.
	gM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

20 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

24 @
Slf4j


25 
public
 cÏs 
	cUts
 {

27 
´iv©e
 
fš®
 
	mDEFAULT_LOGUNIT
 = 0;

29 
´iv©e
 
	$Uts
() {

33 
´iv©e
 
fš®
 
Prš‹r
 
´š‹r
 = 
Ãw
 
	`Textif›r
();

34 
´iv©e
 
fš®
 
T¿ûM‘hodVis™Ü
 
mp
 = 
Ãw
 
	`T¿ûM‘hodVis™Ü
(
´š‹r
);

36 
´iv©e
 
fš®
 [] 
hexA¼ay
 = "0123456789ABCDEF".
	`toCh¬A¼ay
();

45 
public
 
SŒšg
 
	$by‹sToHex
(
by‹
[] 
by‹s
) {

46 ià(
by‹s
 =ğ
nuÎ
) {

49 [] 
hexCh¬s
 = 
Ãw
 [
by‹s
.
Ëngth
 * 2];

50  
j
 = 0; j < 
by‹s
.
Ëngth
; j++ ) {

51 
v
 = 
by‹s
[
j
] & 0xFF;

52 
hexCh¬s
[
j
 * 2] = 
hexA¼ay
[
v
 >>> 4];

53 
hexCh¬s
[
j
 * 2 + 1] = 
hexA¼ay
[
v
 & 0x0F];

55  
Ãw
 
	`SŒšg
(
hexCh¬s
);

56 
	}
}

58 
public
 
	gby‹
[] 
	$štToBigEndŸnBy‹A¼ay
(
š
) {

59  
Ãw
 
by‹
[] {

60 (
by‹
è((
š
 >> 24) & 0xFF),

61 (
by‹
è((
š
 >> 16) & 0xFF),

62 (
by‹
è((
š
 >> 8) & 0xFF),

63 (
by‹
è(
š
 & 0xFF)};

64 
	}
}

67 
public
 
	gby‹
[] 
	$lÚgToBigEndŸnBy‹A¼ay
(
š
) {

68  
Ãw
 
by‹
[] {

69 (
by‹
è((
š
 >> 56) & 0xFF),

70 (
by‹
è((
š
 >> 48) & 0xFF),

71 (
by‹
è((
š
 >> 40) & 0xFF),

72 (
by‹
è((
š
 >> 32) & 0xFF),

73 (
by‹
è((
š
 >> 24) & 0xFF),

74 (
by‹
è((
š
 >> 16) & 0xFF),

75 (
by‹
è((
š
 >> 8) & 0xFF),

76 (
by‹
è(
š
 & 0xFF)};

77 
	}
}

86 
public
 
SŒšg
 
	$cÚv”tToBy‹SŒšgR•»£Á©iÚ
(
fš®
 
v®ue
) {

87 
fš®
 [] 
divid”s
 = 
Ãw
 []{1
_000_000_000_000L
, 1
_000_000_000
, 1
_000_000
, 1
_000
, 1};

88 
fš®
 
SŒšg
[] 
un™s
 = 
Ãw
 String[]{"TB", "GB", "MB", "KB", "B"};

89 ià(
v®ue
 < 1) {

90 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("Inv®id fsize: " + 
v®ue
);

92 
SŒšg
 
»suÉ
 = 
nuÎ
;

93 
i
 = 0; i < 
divid”s
.
Ëngth
; i++) {

94 
fš®
 
divid”
 = 
divid”s
[
i
];

95 ià(
v®ue
 >ğ
divid”
) {

96 
fš®
 
üesuÉ
 =

97 
divid”
 > 1 ? (è
v®ue
 / () divider : () value;

98 
»suÉ
 = 
Ãw
 
	`Decim®FÜm©
("#,##0.#").
	`fÜm©
(
üesuÉ
è+ " " + 
un™s
[
i
];

102  
»suÉ
;

103 
	}
}

109 
public
 
SŒšg
 
	$toR—dabËId
(
UUID
 
id
) {

110  
LÚg
.
	`toHexSŒšg
((
id
.
	`g‘L—¡SignifiÿÁB™s
()) & 0xFFFF);

111 
	}
}

121 
public
 
	$g‘LogTa
(
Layout
 
Ïyout
, 
CÜfuRuÁime
 
ruÁime
) {

122 
glob®LogTa
 = 
Add»ss
.
NON_EXIST
;

124 
Layout
.
LayoutSegm’t
 
£gm’t
 = 
Ïyout
.
	`g‘L©e¡Segm’t
();

127 ià(
£gm’t
.
	`g‘R•liÿtiÚMode
(è=ğ
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
) {

128 
Layout
.
LayoutSŒe
 
¡re
 : 
£gm’t
.
	`g‘SŒes
()) {

130 
TasRe¥Ú£
 
»¥Ú£
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(

131 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
)

132 .
	`g‘LogUn™Cl›Á
(
¡re
.
	`g‘LogS”v”s
().
	`g‘
(
DEFAULT_LOGUNIT
))

133 .
	`g‘LogTa
());

134 
glob®LogTa
 = 
LÚg
.
	`max
(glob®LogTa, 
»¥Ú£
.
	`g‘LogTa
());

136 } ià(
£gm’t
.
	`g‘R•liÿtiÚMode
(è=ğ
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
) {

137 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

140  
glob®LogTa
;

141 
	}
}

152 
public
 
TasRe¥Ú£
 
	$g‘AÎTas
(
Layout
 
Ïyout
, 
CÜfuRuÁime
 
ruÁime
) {

153 
S‘
<
TasRe¥Ú£
> 
luRe¥Ú£s
 = 
Ãw
 
HashS‘
<>();

155 
Layout
.
LayoutSegm’t
 
£gm’t
 = 
Ïyout
.
	`g‘L©e¡Segm’t
();

158 ià(
£gm’t
.
	`g‘R•liÿtiÚMode
(è=ğ
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
) {

159 
Layout
.
LayoutSŒe
 
¡re
 : 
£gm’t
.
	`g‘SŒes
()) {

161 
TasRe¥Ú£
 
»s
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(

162 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
)

163 .
	`g‘LogUn™Cl›Á
(
¡re
.
	`g‘LogS”v”s
().
	`g‘
(
DEFAULT_LOGUNIT
))

164 .
	`g‘AÎTas
());

165 
luRe¥Ú£s
.
	`add
(
»s
);

167 } ià(
£gm’t
.
	`g‘R•liÿtiÚMode
(è=ğ
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
) {

168 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

171  
	`agg»g©eLogUn™Tas
(
luRe¥Ú£s
);

172 
	}
}

181 
TasRe¥Ú£
 
agg»g©eLogUn™Tas
(
S‘
<TasRe¥Ú£> 
»¥Ú£s
) {

182 
	gglob®Ta
 = 
Add»ss
.
NON_ADDRESS
;

183 
	gM­
<
	gUUID
, 
	gLÚg
> 
	gglob®SŒ—mTas
 = 
Ãw
 
HashM­
<>();

185 
TasRe¥Ú£
 
	g»s
 : 
»¥Ú£s
) {

186 
glob®Ta
 = 
M©h
.
max
(glob®Ta, 
»s
.
g‘LogTa
());

188 
	gM­
.
	gEÁry
<
	gUUID
, 
	gLÚg
> 
	g¡»am
 : 
»s
.
g‘SŒ—mTas
().
’ŒyS‘
()) {

189 
¡»amTa
 = 
glob®SŒ—mTas
.
g‘OrDeçuÉ
(
¡»am
.
g‘Key
(), 
Add»ss
.
NON_ADDRESS
);

190 
	gglob®SŒ—mTas
.
put
(
¡»am
.
g‘Key
(), 
M©h
.
max
(
¡»amTa
, sŒ—m.
g‘V®ue
()));

194  
Ãw
 
TasRe¥Ú£
(
glob®Ta
, 
glob®SŒ—mTas
);

197 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
agg»g©eSŒ—mAdd»ssM­
(
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
¡»amAdd»ssS·ûM­
,

198 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
agg»g©ed
) {

199 
	gM­
.
	gEÁry
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
	g¡»am
 : 
¡»amAdd»ssS·ûM­
.
’ŒyS‘
()) {

200 ià(
agg»g©ed
.
cÚšsKey
(
¡»am
.
g‘Key
())) {

201 
cu¼’tTrimM¬k
 = 
agg»g©ed
.
g‘
(
¡»am
.
g‘Key
()).
g‘TrimM¬k
();

202 
	gagg»g©ed
.
g‘
(
¡»am
.
g‘Key
()).
g‘Add»ssM­
().
Ü
(¡»am.
g‘V®ue
().getAddressMap());

203 
	gagg»g©ed
.
g‘
(
¡»am
.
g‘Key
()).
£tTrimM¬k
(
M©h
.
max
(
cu¼’tTrimM¬k
, sŒ—m.
g‘V®ue
().
g‘TrimM¬k
()));

205 
	gagg»g©ed
.
put
(
¡»am
.
g‘Key
(), sŒ—m.
g‘V®ue
());

209  
	gagg»g©ed
;

220 
public
 
SŒ—msAdd»ssRe¥Ú£
 
	$g‘LogAdd»ssS·û
(
Layout
 
Ïyout
, 
CÜfuRuÁime
 
ruÁime
) {

221 
S‘
<
SŒ—msAdd»ssRe¥Ú£
> 
luRe¥Ú£s
 = 
Ãw
 
HashS‘
<>();

223 
Layout
.
LayoutSegm’t
 
£gm’t
 = 
Ïyout
.
	`g‘L©e¡Segm’t
();

226 ià(
£gm’t
.
	`g‘R•liÿtiÚMode
(è=ğ
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
) {

227 
Layout
.
LayoutSŒe
 
¡re
 : 
£gm’t
.
	`g‘SŒes
()) {

229 
SŒ—msAdd»ssRe¥Ú£
 
»s
 = 
CFUts
.
	`g‘Unš‹¼u±ibly
(

230 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
)

231 .
	`g‘LogUn™Cl›Á
(
¡re
.
	`g‘LogS”v”s
().
	`g‘
(
DEFAULT_LOGUNIT
))

232 .
	`g‘LogAdd»ssS·û
());

233 
luRe¥Ú£s
.
	`add
(
»s
);

235 } ià(
£gm’t
.
	`g‘R•liÿtiÚMode
(è=ğ
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
) {

236 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
();

239  
	`agg»g©eLogAdd»ssS·û
(
luRe¥Ú£s
);

240 
	}
}

242 
SŒ—msAdd»ssRe¥Ú£
 
agg»g©eLogAdd»ssS·û
(
S‘
<SŒ—msAdd»ssRe¥Ú£> 
»¥Ú£s
) {

243 
	gM­
<
	gUUID
, 
	gSŒ—mAdd»ssS·û
> 
	g¡»amAdd»ssS·û
 = 
Ãw
 
HashM­
<>();

244 
	glogTa
 = 
Add»ss
.
NON_ADDRESS
;

246 
SŒ—msAdd»ssRe¥Ú£
 
	g»s
 : 
»¥Ú£s
) {

247 
logTa
 = 
M©h
.
max
ÖogTa, 
»s
.
g‘LogTa
());

248 
	g¡»amAdd»ssS·û
 = 
agg»g©eSŒ—mAdd»ssM­
(
»s
.
g‘Add»ssM­
(), 
¡»amAdd»ssS·û
);

250  
Ãw
 
SŒ—msAdd»ssRe¥Ú£
(
logTa
, 
¡»amAdd»ssS·û
);

	@runtime/src/main/java/org/corfudb/util/UuidUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gio
.
	gBa£Encodšg
;

5 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

6 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
public
 cÏs 
	cUuidUts
 {

12 
´iv©e
 
	$UuidUts
() {

21 
public
 
SŒšg
 
	`asBa£64
(@
NÚnuÎ
 
UUID
 
uuid
) {

22 
By‹Bufãr
 
bb
 = By‹Bufãr.
	`w¿p
(
Ãw
 
by‹
[16]);

23 
bb
.
	`putLÚg
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
());

24 
bb
.
	`putLÚg
(
uuid
.
	`g‘L—¡SignifiÿÁB™s
());

25  
Ba£Encodšg
.
	`ba£64U¾
().
	`om™Paddšg
().
	`’code
(
bb
.
	`¬¿y
());

26 
	}
}

35 
public
 
UUID
 
äomBa£64
(@
NÚnuÎ
 
SŒšg
 
uuidSŒšg
) {

36 
By‹Bufãr
 
	gbb
 = By‹Bufãr.
w¿p
(
Ba£Encodšg
.
ba£64U¾
().
decode
(
uuidSŒšg
));

37 ià(
	gbb
.
»maššg
() < 16) {

38 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Inputoo short: must be 16 bytes");

39 } ià(
	gbb
.
»maššg
() > 16) {

40 
throw
 
Ãw
 
IÎeg®Argum’tExû±iÚ
("Inputoo†ong: must be 16 bytes");

42  
Ãw
 
UUID
(
bb
.
g‘LÚg
(), bb.getLong());

	@runtime/src/main/java/org/corfudb/util/Version.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

4 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

11 
public
 cÏs 
	cV”siÚ
 {

13 @
	$G‘‹r
(
Ïzy
 = 
Œue
)

14 
´iv©e
 
fš®
 
SŒšg
 
v”siÚSŒšg
 = 
	`g‘V”siÚ
();

16 
´iv©e
 
SŒšg
 
	$g‘V”siÚ
() {

17 
Œy
 {

18 
Prİ”t›s
 
p
 = 
Ãw
 
	`Prİ”t›s
();

19 
IÅutSŒ—m
 
is
 = 
V”siÚ
.
şass


20 .
	`g‘ResourûAsSŒ—m
("/META-INF/maven/org.corfudb/corfu/pom.properties");

21 ià(
is
 !ğ
nuÎ
) {

22 
p
.
	`lßd
(
is
);

23  
p
.
	`g‘Prİ”ty
("version", "");

25 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

26 
Package
 
thisPackage
 = 
V”siÚ
.
şass
.
	`g‘Package
();

27 ià(
thisPackage
 !ğ
nuÎ
) {

28 
SŒšg
 
o
 = 
thisPackage
.
	`g‘Im¶em’tiÚV”siÚ
();

29 ià(
o
 =ğ
nuÎ
) {

30 
o
 = 
thisPackage
.
	`g‘S³cifiÿtiÚV”siÚ
();

32  
o
;

38 
	}
}

	@runtime/src/main/java/org/corfudb/util/concurrent/SingletonResource.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
;

3 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

4 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

17 
public
 
şass
 
	gSšgËtÚResourû
<
	gT
> {

22 
´iv©e
 
fš®
 
	gSuµl›r
<
	gT
> 
	gg’”©Ü
;

27 
´iv©e
 vŞ©
T
 
	g»sourû
;

36 
public
 <
	gR
> 
	gSšgËtÚResourû
<R> 
w™hIn™Ÿl
(@
NÚnuÎ
 
Suµl›r
<
R
> 
g’”©Ü
) {

37  
Ãw
 
	gSšgËtÚResourû
<>(
	gg’”©Ü
);

45 
´iv©e
 
SšgËtÚResourû
(
Suµl›r
<
T
> 
g’”©Ü
) {

46 
	gthis
.
	gg’”©Ü
 = 
g’”©Ü
;

55 
public
 
T
 
g‘
() {

56 
T
 
	g‹mp
 = 
»sourû
;

57 ià(
	g‹mp
 =ğ
nuÎ
) {

58 
synchrÚized
 (
this
) {

59 
‹mp
 = 
»sourû
;

60 ià(
	g‹mp
 =ğ
nuÎ
) {

61 
‹mp
 = 
g’”©Ü
.
g‘
();

62 
	g»sourû
 = 
‹mp
;

66  
	g‹mp
;

85 
public
 
synchrÚized
 
ş—nup
(@
NÚnuÎ
 
CÚsum”
<
T
> 
ş—Ãr
) {

86 ià(
	g»sourû
 !ğ
nuÎ
) {

87 
ş—Ãr
.
acû±
(
»sourû
);

88 
	g»sourû
 = 
nuÎ
;

	@runtime/src/main/java/org/corfudb/util/retry/AbstractRetry.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

9 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

10 
impÜt
 
	glombok
.
	gG‘‹r
;

18 @
AÎArgsCÚ¡ruùÜ


19 
ab¡¿ù
 
şass
 
	gAb¡¿ùR‘ry
<
E
 
ex‹nds
 
	gExû±iÚ
, 
F
ƒxtends Exception,

20 
G
 
ex‹nds
 
	gExû±iÚ
, 
H
ƒx‹nd Exû±iÚ, 
	gO
, 
A
ƒx‹nd 
	gIR‘ry
>

21 
im¶em’ts
 
	gIR‘ry
<
	gE
, 
	gF
, 
	gG
, 
	gH
, 
	gO
, 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
.
	gExpÚ’tŸlBackoffR‘ry
> {

23 @
G‘‹r


24 
fš®
 
	gIR‘ryabË
<
	gE
, 
	gF
, 
	gG
, 
	gH
, 
	gO
> 
	grunFunùiÚ
;

	@runtime/src/main/java/org/corfudb/util/retry/ExponentialBackoffRetry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

3 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
.
	gS‘‹r
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

17 @
Slf4j


18 
public
 
şass
 
	gExpÚ’tŸlBackoffR‘ry
<
E
 
ex‹nds
 
	gExû±iÚ
, 
F
ƒxtends Exception,

19 
G
 
ex‹nds
 
	gExû±iÚ
, 
H
ƒx‹nd Exû±iÚ, 
	gO
, 
A
ƒx‹nd 
	gIR‘ry
>

20 
ex‹nds
 
	gAb¡¿ùR‘ry
<
	gE
, 
	gF
, 
	gG
, 
	gH
, 
	gO
, 
	gExpÚ’tŸlBackoffR‘ry
> {

22 
´iv©e
 
fš®
 
	gDEFAULT_BASE
 = 2;

23 
´iv©e
 
fš®
 
	gDEFAULT_RANDOM_PORTION
 = 0f;

24 
´iv©e
 
fš®
 
Du¿tiÚ
 
	gDEFAULT_BACKOFF_DURATION
 = Du¿tiÚ.
ofMšu‹s
(1);

25 
´iv©e
 
	g»ŒyCouÁ”
 = 0;

26 
´iv©e
 
	gÃxtBackoffTime
 = 0;

28 @
	gG‘‹r


29 @
S‘‹r


30 
´iv©e
 
Du¿tiÚ
 
	gbackoffDu¿tiÚ
 = 
DEFAULT_BACKOFF_DURATION
;

35 @
	gG‘‹r
 @
S‘‹r


36 
´iv©e
 
	gba£
 = 
DEFAULT_BASE
;

42 @
	gG‘‹r
 @
S‘‹r


43 
´iv©e
 
	g¿ndomPÜtiÚ
 = 
DEFAULT_RANDOM_PORTION
;

48 @
	gG‘‹r


49 @
S‘‹r


50 
´iv©e
 
	gexŒaWa™
 = 0;

55 @
	gG‘‹r


56 @
S‘‹r


57 
´iv©e
 
Du¿tiÚ
 
	gmaxR‘ryTh»shŞd
 = Du¿tiÚ.
ZERO
;

59 
public
 
ExpÚ’tŸlBackoffR‘ry
(
IR‘ryabË
 
runFunùiÚ
) {

60 
su³r
(
runFunùiÚ
);

63 @
Ov”ride


64 
public
 
ÃxtWa™
() {

65 ià(
	gÃxtBackoffTime
 == 0) {

66 
ÃxtBackoffTime
 = 
Sy¡em
.
cu¼’tTimeMlis
(è+ 
backoffDu¿tiÚ
.
toMlis
();

68 
	g»ŒyCouÁ”
++;

69 
	g¦“pTime
 = (è
M©h
.
pow
(
ba£
, 
»ŒyCouÁ”
);

70 
	g¦“pTime
 +ğ
exŒaWa™
;

71 
	g¿ndomP¬t
 = 
Ãw
 
Rªdom
().
ÃxtFlßt
(è* 
¿ndomPÜtiÚ
;

72 
	g¦“pTime
 -ğ
¦“pTime
 * 
¿ndomP¬t
;

73 ià(
	gmaxR‘ryTh»shŞd
.
toMlis
() > 0) {

74 
	g¦“pTime
 = 
M©h
.
mš
(
¦“pTime
, 
maxR‘ryTh»shŞd
.
toMlis
());

77 ià(
	gSy¡em
.
cu¼’tTimeMlis
(è+ 
	g¦“pTime
 > 
	gÃxtBackoffTime
) {

78 
	gÃxtBackoffTime
 = 0;

79 
	g»ŒyCouÁ”
 = 1;

80 
	g¦“pTime
 = 
ba£
 + 
exŒaWa™
;

81 
	g¦“pTime
 -ğ
¦“pTime
 * 
¿ndomP¬t
;

83 
	gSË•
.
¦“pUnš‹¼u±ibly
(
Du¿tiÚ
.
ofMlis
(
¦“pTime
));

	@runtime/src/main/java/org/corfudb/util/retry/IRetry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

3 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

5 
impÜt
 
	glombok
.
	gSÃakyThrows
;

18 
public
 
š‹rçû
 
	gIR‘ry
<
E
 
ex‹nds
 
	gExû±iÚ
, 
F
ƒx‹nd Exû±iÚ, 
G
ƒxtends Exception,

19 
H
 
ex‹nds
 
	gExû±iÚ
, 
	gO
, 
A
ƒx‹nd 
	gIR‘ry
> {

22 <
	gR
, 
Z
 
ex‹nds
 
	gIR‘ry
> IR‘ry<
	gRuÁimeExû±iÚ
, RuntimeException, RuntimeException,

23 
	gRuÁimeExû±iÚ
, 
	gR
, 
	gZ
> 
bud
(
CÏss
<
Z
> 
»ŒyTy³
, 
IR‘ryabË
<
RuÁimeExû±iÚ
,

24 
RuÁimeExû±iÚ
, RuÁimeExû±iÚ, RuÁimeExû±iÚ, 
R
> 
runFunùiÚ
) {

25  
bud
(
»ŒyTy³
, 
RuÁimeExû±iÚ
.
şass
, RuntimeException.class,

26 
RuÁimeExû±iÚ
.
şass
, RuÁimeExû±iÚ.şass, 
runFunùiÚ
);

29 <
T
 
ex‹nds
 
	gExû±iÚ
, 
	gR
, 
Z
ƒx‹nd 
	gIR‘ry
> IR‘ry<
	gT
, 
	gRuÁimeExû±iÚ
, RuntimeException,

30 
	gRuÁimeExû±iÚ
, 
	gR
, 
	gZ
> 
bud
(
CÏss
<
Z
> 
»ŒyTy³
, CÏss<? 
ex‹nds
 
T
> 
fœ¡Exû±iÚTy³
,

31 
IR‘ryabË
<
T
, 
RuÁimeExû±iÚ
, RuntimeException,

32 
RuÁimeExû±iÚ
, 
R
> 
runFunùiÚ
) {

33  
bud
(
»ŒyTy³
, 
fœ¡Exû±iÚTy³
, 
RuÁimeExû±iÚ
.
şass
, RuntimeException.class,

34 
RuÁimeExû±iÚ
.
şass
, 
runFunùiÚ
);

37 <
T
 
ex‹nds
 
	gExû±iÚ
, 
U
ƒx‹nd Exû±iÚ, 
	gR
, 
Z
ƒx‹nd 
	gIR‘ry
> IR‘ry<
	gT
, 
	gU
,

38 
	gRuÁimeExû±iÚ
, RuÁimeExû±iÚ, 
	gR
, 
	gZ
> 
bud
(
CÏss
<
Z
> 
»ŒyTy³
,

39 
CÏss
<? 
ex‹nds
 
T
> 
fœ¡Exû±iÚTy³
,

40 
CÏss
<? 
ex‹nds
 
U
> 
£cÚdExû±iÚTy³
, 
IR‘ryabË
<
T
, U, 
RuÁimeExû±iÚ
,

41 
RuÁimeExû±iÚ
, 
R
> 
runFunùiÚ
) {

42  
bud
(
»ŒyTy³
, 
fœ¡Exû±iÚTy³
, 
£cÚdExû±iÚTy³
, 
RuÁimeExû±iÚ
.
şass
,

43 
RuÁimeExû±iÚ
.
şass
, 
runFunùiÚ
);

46 <
T
 
ex‹nds
 
	gExû±iÚ
, 
U
ƒx‹nd Exû±iÚ, 
V
ƒx‹nd Exû±iÚ, 
	gR
,

47 
Z
 
ex‹nds
 
	gIR‘ry
> IR‘ry<
	gT
, 
	gU
, 
	gV
, 
	gRuÁimeExû±iÚ
, 
	gR
,

48 
	gZ
> 
bud
(
CÏss
<
Z
> 
»ŒyTy³
,CÏss<? 
ex‹nds
 
T
> 
fœ¡Exû±iÚTy³
,

49 
CÏss
<? 
ex‹nds
 
U
> 
£cÚdExû±iÚTy³
,

50 
CÏss
<? 
ex‹nds
 
V
> 
thœdExû±iÚTy³
, 
IR‘ryabË
<
T
, 
U
, V,

51 
RuÁimeExû±iÚ
, 
R
> 
runFunùiÚ
) {

52  
bud
(
»ŒyTy³
, 
fœ¡Exû±iÚTy³
, 
£cÚdExû±iÚTy³
, 
thœdExû±iÚTy³
,

53 
RuÁimeExû±iÚ
.
şass
, 
runFunùiÚ
);

56 @
SÃakyThrows


57 <
T
 
ex‹nds
 
	gExû±iÚ
, 
U
ƒx‹nd Exû±iÚ, 
V
ƒx‹nd Exû±iÚ, 
W
ƒx‹nd Exû±iÚ, 
	gR
,

58 
Z
 
ex‹nds
 
	gIR‘ry
>

59 
	gIR‘ry
<
	gT
, 
	gU
, 
	gV
, 
	gW
, 
	gR
, 
	gZ
> 
bud
(
CÏss
<
Z
> 
»ŒyTy³
,

60 
CÏss
<? 
ex‹nds
 
T
> 
fœ¡Exû±iÚTy³
,

61 
CÏss
<? 
ex‹nds
 
U
> 
£cÚdExû±iÚTy³
,

62 
CÏss
<? 
ex‹nds
 
V
> 
thœdExû±iÚTy³
,

63 
CÏss
<? 
ex‹nds
 
W
> 
fou¹hExû±iÚTy³
, 
IR‘ryabË
<
T
,

64 
U
, 
V
,

65 
W
, 
R
> 
runFunùiÚ
) {

66  (
	gIR‘ry
<
	gT
, 
	gU
, 
	gV
, 
	gW
, 
	gR
, 
	gZ
>è
	g»ŒyTy³
.
g‘CÚ¡ruùÜ
(
IR‘ryabË
.
şass
)

67 .
ÃwIn¡ªû
(
runFunùiÚ
);

74  
O
 
run
()

75 
throws
 
	gE
, 
	gF
, 
	gG
, 
	gH
, 
	gIÁ”ru±edExû±iÚ
 {

76 
	gŒue
) {

77 
	gŒy
 {

78  
g‘RunFunùiÚ
().
»ŒyFunùiÚ
();

79 } 
ÿtch
 (
R‘ryN“dedExû±iÚ
 
ex
) {

81 
ÃxtWa™
();

89 
	gIR‘ryabË
<
	gE
, 
	gF
, 
	gG
, 
	gH
, 
	gO
> 
g‘RunFunùiÚ
();

100 @
Suµ»ssW¬nšgs
("unchecked")

101  
	gIR‘ry
<
	gE
, 
	gF
, 
	gG
, 
	gH
, 
	gO
, 
	gA
> 
£tO±iÚs
(
CÚsum”
<
A
> 
£‰šgsFunùiÚ
) {

102 
	g£‰šgsFunùiÚ
.
acû±
((
A
è
this
);

103  
	gthis
;

109 
ÃxtWa™
(è
throws
 
	gIÁ”ru±edExû±iÚ
;

	@runtime/src/main/java/org/corfudb/util/retry/IRetryable.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

6 @
FunùiÚ®IÁ”çû


7 
public
 
š‹rçû
 
	gIR‘ryabË
<
E
 
ex‹nds
 
	gExû±iÚ
, 
F
ƒxtends Exception,

8 
G
 
ex‹nds
 
	gExû±iÚ
, 
H
ƒx‹nd Exû±iÚ, 
	gT
> {

12 
T
 
»ŒyFunùiÚ
(è
throws
 
	gR‘ryN“dedExû±iÚ
, 
	gIÁ”ru±edExû±iÚ
, 
	gE
, 
	gF
, 
	gG
, 
	gH
;

	@runtime/src/main/java/org/corfudb/util/retry/IntervalRetry.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

14 @
Slf4j


15 
public
 
şass
 
	gIÁ”v®R‘ry
<
E
 
ex‹nds
 
	gExû±iÚ
, 
F
ƒxtends Exception,

16 
G
 
ex‹nds
 
	gExû±iÚ
, 
H
ƒx‹nd Exû±iÚ, 
	gO
>ƒx‹nd 
	gAb¡¿ùR‘ry
<
	gE
, 
	gF
,

17 
	gG
, 
	gH
, 
	gO
, 
	gIÁ”v®R‘ry
> {

23 @
	gG‘‹r


24 @
S‘‹r


25 
	g»ŒyIÁ”v®
 = 1000;

27 
public
 
IÁ”v®R‘ry
(
IR‘ryabË
<
E
, 
F
, 
G
, 
H
, 
O
> 
runFunùiÚ
) {

28 
su³r
(
runFunùiÚ
);

35 @
Ov”ride


36 
public
 
ÃxtWa™
(è
throws
 
	gIÁ”ru±edExû±iÚ
 {

37 
	gTimeUn™
.
	gMILLISECONDS
.
¦“p
(
»ŒyIÁ”v®
);

	@runtime/src/main/java/org/corfudb/util/retry/RetryNeededException.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

14 
public
 cÏs 
	cR‘ryN“dedExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

	@runtime/src/main/java/org/corfudb/util/serializer/CorfuSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
public
 cÏs 
	cCÜfuS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

12 
´iv©e
 
fš®
 
by‹
 
	mty³
;

15 
public
 
fš®
 
by‹
 
	mcÜfuPaylßdMagic
 = 0x42;

17 
public
 
	$CÜfuS”Ÿliz”
(
by‹
 
ty³
) {

18 
this
.
ty³
 =ype;

21 @
Ov”ride


22 
public
 
by‹
 
	$g‘Ty³
() {

23  
ty³
;

24 
	}
}

32 @
Ov”ride


33 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

34 ià(
b
.
	`»adBy‹
(è!ğ
cÜfuPaylßdMagic
) {

35 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
b
.
	`»adabËBy‹s
()];

36 
b
.
	`»adBy‹s
(
by‹s
);

37  
by‹s
;

39  
LogEÁry
.
	`de£rŸlize
(
b
, 
¹
);

40 
	}
}

48 @
Ov”ride


49 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

50 ià(
o
 
š¡ªûof
 
ICÜfuS”ŸlizabË
) {

51 
b
.
	`wr™eBy‹
(
cÜfuPaylßdMagic
);

52 
ICÜfuS”ŸlizabË
 
c
 = (ICÜfuS”ŸlizabËè
o
;

53 
c
.
	`£rŸlize
(
b
);

54 } ià(
o
 
š¡ªûof
 
by‹
[]) {

56 
b
.
	`wr™eBy‹
(0);

57 
by‹
[] 
by‹s
 = (by‹[]è
o
;

58 
b
.
	`wr™eBy‹s
(
by‹s
);

60 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Attemptingo serialize unsupportedype "

61 + 
o
.
	`g‘CÏss
().
	`g‘Name
() + ".");

63 
	}
}

	@runtime/src/main/java/org/corfudb/util/serializer/DynamicProtobufSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gDesütÜ
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gDesütÜV®id©iÚExû±iÚ
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
;

10 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDyÇmicMes§ge
;

11 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufIÅutSŒ—m
;

14 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufOuutSŒ—m
;

15 
impÜt
 
	glombok
.
	gG‘‹r
;

16 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicKey
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicRecÜd
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gPrÙobufS”Ÿliz”
.
	gMes§geTy³
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

32 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

33 
impÜt
 
	gjava
.
	gut
.
	gM­
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tM­
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
.
	gCORFU_SYSTEM_NAMESPACE
;

38 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
.
	gREGISTRY_TABLE_NAME
;

39 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
.
	gg‘FuÎyQu®if›dTabËName
;

40 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
.
	gg‘Ty³U¾
;

58 @
Slf4j


59 
public
 cÏs 
	cDyÇmicPrÙobufS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

64 @
G‘‹r


65 
´iv©e
 
fš®
 
by‹
 
	mty³
;

71 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mFeDesütÜPrÙo
> 
	mfdPrÙoM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

77 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, SŒšg> 
	mmes§gesFdPrÙoNameM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

82 
´iv©e
 
fš®
 
	mCÚcu¼’tM­
<
	mSŒšg
, 
	mFeDesütÜ
> 
	mfeDesütÜM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

84 
public
 
	$DyÇmicPrÙobufS”Ÿliz”
(
CÜfuRuÁime
 
cÜfuRuÁime
) {

85 
this
.
ty³
 = 
PrÙobufS”Ÿliz”
.
PROTOBUF_SERIALIZER_CODE
;

88 
IS”Ÿliz”
 
´ÙobufS”Ÿliz”
 = 
	`ü—‹PrÙobufS”Ÿliz”
();

89 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
´ÙobufS”Ÿliz”
);

92 
CÜfuTabË
<
TabËName
, 
CÜfuRecÜd
<
TabËDesütÜs
, 
Mes§ge
>> 
cÜfuTabË
 = 
cÜfuRuÁime
.
	`g‘ObjeùsV›w
()

93 .
	`bud
()

94 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
TabËName
, 
CÜfuRecÜd
<
TabËDesütÜs
, 
Mes§ge
>>>() {

96 .
	`£tSŒ—mName
(
	`g‘FuÎyQu®if›dTabËName
(
CORFU_SYSTEM_NAMESPACE
, 
REGISTRY_TABLE_NAME
))

97 .
	`£tS”Ÿliz”
(
´ÙobufS”Ÿliz”
)

98 .
	`İ’
();

101 
cÜfuTabË
.
	`fÜEach
((
bËName
, 
v®ue
) -> {

103 
TabËDesütÜs
 
bËDesütÜs
 = 
v®ue
.
	`g‘Paylßd
();

104 
bËDesütÜs
.
	`g‘FeDesütÜsM­
().
	`fÜEach
((
fdName
, 
feDesütÜPrÙo
) -> {

105 
SŒšg
 
´ÙoFeName
 = 
feDesütÜPrÙo
.
	`g‘Name
();

108 ià(
´ÙoFeName
.
	`equ®s
("corfu_options.proto")) {

109 
fdPrÙoM­
.
	`putIfAb£Á
(
´ÙoFeName
, 
feDesütÜPrÙo
);

111 
´ÙoFeName
 = "corfudb/runtime/corfu_options.proto";

113 
fdPrÙoM­
.
	`putIfAb£Á
(
´ÙoFeName
, 
feDesütÜPrÙo
);

114 
	`id’tifyMes§geTy³sšFeDesütÜPrÙo
(
feDesütÜPrÙo
);

117 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
this
);

125 
´iv©e
 
IS”Ÿliz”
 
	$ü—‹PrÙobufS”Ÿliz”
() {

126 
M­
<
SŒšg
, 
CÏss
<? 
ex‹nds
 
Mes§ge
>> 
şassM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

129 
şassM­
.
	`put
(
	`g‘Ty³U¾
(
TabËName
.
	`g‘DesütÜ
()), TabËName.
şass
);

130 
şassM­
.
	`put
(
	`g‘Ty³U¾
(
TabËDesütÜs
.
	`g‘DesütÜ
()), TabËDesütÜs.
şass
);

131  
Ãw
 
	`PrÙobufS”Ÿliz”
(
şassM­
);

132 
	}
}

140 
´iv©e
 
	$id’tifyMes§geTy³sšFeDesütÜPrÙo
(
FeDesütÜPrÙo
 
feDesütÜPrÙo
) {

141 
DesütÜPrÙos
.
DesütÜPrÙo
 
desütÜPrÙo
 : 
feDesütÜPrÙo
.
	`g‘Mes§geTy³Li¡
()) {

142 
SŒšg
 
mes§geName
 = 
feDesütÜPrÙo
.
	`g‘Package
(è+ "." + 
desütÜPrÙo
.
	`g‘Name
();

143 
mes§gesFdPrÙoNameM­
.
	`putIfAb£Á
(
mes§geName
, 
feDesütÜPrÙo
.
	`g‘Name
());

145 
	}
}

156 
´iv©e
 
FeDesütÜ
 
	$g‘DesütÜ
(
SŒšg
 
Çme
è
throws
 
DesütÜV®id©iÚExû±iÚ
 {

158 ià(
feDesütÜM­
.
	`cÚšsKey
(
Çme
)) {

159  
feDesütÜM­
.
	`g‘
(
Çme
);

162 ià(!
fdPrÙoM­
.
	`cÚšsKey
(
Çme
)) {

163 
log
.
	`”rÜ
("DynamicProtobufSerializer failedo deserialize unknown file {}",

164 
Çme
);

165 
log
.
	`”rÜ
(
this
.
	`toSŒšg
());

166 
throw
 
Ãw
 
	`S”Ÿliz”Exû±iÚ
(

167 "DyÇmicPrÙobufS”Ÿliz” f" + 
Çme
 + " was‚ever seen in„egistry");

169 
Li¡
<
FeDesütÜ
> 
feDesütÜLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

170 
SŒšg
 
s
 : 
fdPrÙoM­
.
	`g‘
(
Çme
).
	`g‘D•’d’cyLi¡
()) {

171 
FeDesütÜ
 
desütÜ
 = 
	`g‘DesütÜ
(
s
);

172 
feDesütÜLi¡
.
	`add
(
desütÜ
);

174 
FeDesütÜ
[] 
feDesütÜs
 = 
feDesütÜLi¡
.
	`toA¼ay
(
Ãw
 FeDesütÜ[feDesütÜLi¡.
	`size
()]);

175 
FeDesütÜ
 
feDesütÜ
 = FeDesütÜ.
	`budFrom
(
fdPrÙoM­
.
	`g‘
(
Çme
), 
feDesütÜs
);

176 
feDesütÜM­
.
	`putIfAb£Á
(
Çme
, 
feDesütÜ
);

177  
feDesütÜ
;

178 
	}
}

188 
´iv©e
 
SŒšg
 
	$g‘Mes§geName
(
Any
 
mes§ge
) {

189 
SŒšg
 
ty³U¾
 = 
mes§ge
.
	`g‘Ty³U¾
();

190  
ty³U¾
.
	`sub¡ršg
Ñy³U¾.
	`Ï¡IndexOf
('.') + 1);

191 
	}
}

201 
´iv©e
 
SŒšg
 
	$g‘FuÎMes§geName
(
Any
 
mes§ge
) {

202 
SŒšg
 
ty³U¾
 = 
mes§ge
.
	`g‘Ty³U¾
();

203  
ty³U¾
.
	`sub¡ršg
Ñy³U¾.
	`Ï¡IndexOf
('/') + 1);

204 
	}
}

212 @
Ov”ride


213 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

215 
	`Œy
 (
By‹BufIÅutSŒ—m
 
bbis
 = 
Ãw
 
	`By‹BufIÅutSŒ—m
(
b
)) {

216 
Mes§geTy³
 
ty³
 = Mes§geTy³.
	`v®ueOf
(
bbis
.
	`»adIÁ
());

217 
size
 = 
bbis
.
	`»adIÁ
();

218 
by‹
[] 
d©a
 = 
Ãw
 by‹[
size
];

219 
bbis
.
	`»adFuÎy
(
d©a
);

220 
RecÜd
 
»cÜd
 = RecÜd.
	`·r£From
(
d©a
);

221 
Any
 
·ylßd
 = 
»cÜd
.
	`g‘Paylßd
();

223 
FeDesütÜ
 
v®ueFeDesütÜ


224 ğ
	`g‘DesütÜ
(
mes§gesFdPrÙoNameM­
.
	`g‘
(
	`g‘FuÎMes§geName
(
·ylßd
)));

225 
DesütÜ
 
v®ueDesütÜ
 = 
v®ueFeDesütÜ
.
	`fšdMes§geTy³ByName
(
	`g‘Mes§geName
(
·ylßd
));

226 
DyÇmicMes§ge
 
v®ue
 = DyÇmicMes§ge.
	`·r£From
(
v®ueDesütÜ
, 
·ylßd
.
	`g‘V®ue
());

228 ià(
ty³
.
	`equ®s
(
Mes§geTy³
.
KEY
)) {

229  
Ãw
 
	`CÜfuDyÇmicKey
(
·ylßd
.
	`g‘Ty³U¾
(), 
v®ue
);

232 
SŒšg
 
m‘ad©aTy³U¾
 = 
nuÎ
;

233 
DyÇmicMes§ge
 
m‘ad©a
 = 
nuÎ
;

234 ià(
»cÜd
.
	`hasM‘ad©a
()) {

235 
Any
 
ªyM‘ad©a
 = 
»cÜd
.
	`g‘M‘ad©a
();

236 
m‘ad©aTy³U¾
 = 
ªyM‘ad©a
.
	`g‘Ty³U¾
();

238 
FeDesütÜ
 
m‘aFeDesütÜ


239 ğ
	`g‘DesütÜ
(
mes§gesFdPrÙoNameM­
.
	`g‘
(
	`g‘FuÎMes§geName
(
ªyM‘ad©a
)));

240 
DesütÜ
 
m‘aDesütÜ
 = 
m‘aFeDesütÜ
.
	`fšdMes§geTy³ByName
(
	`g‘Mes§geName
(
ªyM‘ad©a
));

241 
m‘ad©a
 = 
DyÇmicMes§ge
.
	`·r£From
(
m‘aDesütÜ
, 
ªyM‘ad©a
.
	`g‘V®ue
());

243  
Ãw
 
	`CÜfuDyÇmicRecÜd
(
·ylßd
.
	`g‘Ty³U¾
(), 
v®ue
, 
m‘ad©aTy³U¾
, 
m‘ad©a
);

245 } 
	`ÿtch
 (
IOExû±iÚ
 | 
DesütÜV®id©iÚExû±iÚ
 
›
) {

246 
log
.
	`”rÜ
("Exû±iÚ duršg de£rŸliz©iÚ!", 
›
);

247 
throw
 
Ãw
 
	`S”Ÿliz”Exû±iÚ
(
›
);

249 
	}
}

257 @
Ov”ride


258 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

260 
RecÜd
 
»cÜd
;

261 
Mes§geTy³
 
mes§geTy³
;

263 ià(
o
 
š¡ªûof
 
CÜfuDyÇmicRecÜd
) {

264 
CÜfuDyÇmicRecÜd
 
cÜfuRecÜd
 = (CÜfuDyÇmicRecÜdè
o
;

265 
Any
 
mes§ge
 = Any.
	`ÃwBud”
()

266 .
	`£tTy³U¾
(
cÜfuRecÜd
.
	`g‘PaylßdTy³U¾
())

267 .
	`£tV®ue
(
cÜfuRecÜd
.
	`g‘Paylßd
().
	`toBy‹SŒšg
())

268 .
	`bud
();

269 
RecÜd
.
Bud”
 
»cÜdBud”
 = RecÜd.
	`ÃwBud”
()

270 .
	`£tPaylßd
(
mes§ge
);

271 ià(
cÜfuRecÜd
.
	`g‘M‘ad©a
(è!ğ
nuÎ
) {

272 
Any
 
m‘ad©a
 = Any.
	`ÃwBud”
()

273 .
	`£tTy³U¾
(
cÜfuRecÜd
.
	`g‘M‘ad©aTy³U¾
())

274 .
	`£tV®ue
(
cÜfuRecÜd
.
	`g‘M‘ad©a
().
	`toBy‹SŒšg
())

275 .
	`bud
();

276 
»cÜdBud”
.
	`£tM‘ad©a
(
m‘ad©a
);

278 
»cÜd
 = 
»cÜdBud”
.
	`bud
();

279 
mes§geTy³
 = 
Mes§geTy³
.
VALUE
;

281 
CÜfuDyÇmicKey
 
cÜfuKey
 = (CÜfuDyÇmicKeyè
o
;

282 
Any
 
mes§ge
 = Any.
	`ÃwBud”
()

283 .
	`£tTy³U¾
(
cÜfuKey
.
	`g‘KeyTy³U¾
())

284 .
	`£tV®ue
(
cÜfuKey
.
	`g‘Key
().
	`toBy‹SŒšg
())

285 .
	`bud
();

286 
»cÜd
 = 
RecÜd
.
	`ÃwBud”
()

287 .
	`£tPaylßd
(
mes§ge
)

288 .
	`bud
();

289 
mes§geTy³
 = 
Mes§geTy³
.
KEY
;

291 
by‹
[] 
d©a
 = 
»cÜd
.
	`toBy‹A¼ay
();

293 
	`Œy
 (
By‹BufOuutSŒ—m
 
bbos
 = 
Ãw
 
	`By‹BufOuutSŒ—m
(
b
)) {

294 
bbos
.
	`wr™eIÁ
(
mes§geTy³
.
v®
);

295 
bbos
.
	`wr™eIÁ
(
d©a
.
Ëngth
);

296 
bbos
.
	`wr™e
(
d©a
);

297 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

298 
log
.
	`”rÜ
("Exû±iÚ duršg s”Ÿliz©iÚ!", 
›
);

299 
throw
 
Ãw
 
	`S”Ÿliz”Exû±iÚ
(
›
);

301 
	}
}

303 
public
 
SŒšg
 
	$toSŒšg
() {

304 
SŒšgBud”
 
¡ršgBud”
 = 
Ãw
 
	`SŒšgBud”
();

305 
¡ršgBud”
.
	`­³nd
("\n---------messageFdProtoNameMap Messages:---------\n");

306 
M­
.
EÁry
<
SŒšg
, SŒšg> 
mÇme
: 
mes§gesFdPrÙoNameM­
.
	`’ŒyS‘
()) {

307 
¡ršgBud”
.
	`­³nd
("Mes§ge: "+ 
mÇme
.
	`g‘Key
()+ " iÀf"+ mÇme.
	`g‘V®ue
()+"\n");

310 
¡ršgBud”
.
	`­³nd
("\n-------fdProtoMap FileDescriptors:--------------\n");

311 
M­
.
EÁry
<
SŒšg
, 
FeDesütÜPrÙo
> 
fdPrÙo
: 
fdPrÙoM­
.
	`’ŒyS‘
()) {

312 
¡ršgBud”
.
	`­³nd
("Fe: " + 
fdPrÙo
.
	`g‘Key
());

313 
¡ršgBud”
.
	`­³nd
(" ===> (FileDescriptorProto follows...)\n");

314 
¡ršgBud”
.
	`­³nd
(
fdPrÙo
.
	`g‘V®ue
());

317 
¡ršgBud”
.
	`­³nd
("\n---------fileDescriptorCache FileDescriptors----------\n");

318 
M­
.
EÁry
<
SŒšg
, 
FeDesütÜ
> 
fds
: 
feDesütÜM­
.
	`’ŒyS‘
()) {

319 
¡ršgBud”
.
	`­³nd
("Fe: "+ 
fds
.
	`g‘Key
(è+ " ==> " + fds.
	`g‘V®ue
() + "\n");

321  
¡ršgBud”
.
	`toSŒšg
();

322 
	}
}

	@runtime/src/main/java/org/corfudb/util/serializer/ICorfuHashable.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

6 
public
 
š‹rçû
 
	gICÜfuHashabË
 {

9 
	gby‹
[] 
g’”©eCÜfuHash
();

	@runtime/src/main/java/org/corfudb/util/serializer/ICorfuSerializable.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

8 
public
 
š‹rçû
 
	gICÜfuS”ŸlizabË
 {

9 
£rŸlize
(
By‹Buf
 
b
);

	@runtime/src/main/java/org/corfudb/util/serializer/ISerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gcom
.
	gesÙ”icsoáw¬e
.
	gkryo
.
	gKryo
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

13 
impÜt
 
	gde
.
	gjavakafãe
.
	gkryo£rŸliz”s
.
	gguava
.
	gImmubËLi¡S”Ÿliz”
;

14 
impÜt
 
	gde
.
	gjavakafãe
.
	gkryo£rŸliz”s
.
	gguava
.
	gImmubËM­S”Ÿliz”
;

15 
impÜt
 
	gde
.
	gjavakafãe
.
	gkryo£rŸliz”s
.
	gguava
.
	gImmubËMuÉim­S”Ÿliz”
;

16 
impÜt
 
	gde
.
	gjavakafãe
.
	gkryo£rŸliz”s
.
	gguava
.
	gImmubËS‘S”Ÿliz”
;

17 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

18 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

20 
impÜt
 
	gÃt
.
	gİ’há
.
	ghashšg
.
	gLÚgHashFunùiÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gUts
;

24 
impÜt
 
	gÜg
.
	gobj’esis
.
	g¡¿‹gy
.
	gStdIn¡ªtŸtÜSŒ©egy
;

30 
public
 
š‹rçû
 
	gIS”Ÿliz”
 {

33 
	gTh»adLoÿl
<
	gKryo
> 
	gkryos
 = 
Ãw
 
Th»adLoÿl
<
Kryo
>() {

34 
´Ùeùed
 
Kryo
 
š™ŸlV®ue
() {

35 
Kryo
 
kryo
 = 
Ãw
 Kryo();

37 
	gkryo
.
£tIn¡ªtŸtÜSŒ©egy
(
Ãw
 
Kryo
.
DeçuÉIn¡ªtŸtÜSŒ©egy
(

38 
Ãw
 
StdIn¡ªtŸtÜSŒ©egy
()));

39 
	gImmubËLi¡S”Ÿliz”
.
»gi¡”S”Ÿliz”s
(
kryo
);

40 
	gImmubËS‘S”Ÿliz”
.
»gi¡”S”Ÿliz”s
(
kryo
);

41 
	gImmubËM­S”Ÿliz”
.
»gi¡”S”Ÿliz”s
(
kryo
);

42 
	gImmubËMuÉim­S”Ÿliz”
.
»gi¡”S”Ÿliz”s
(
kryo
);

44  
	gkryo
;

50 
by‹
 
g‘Ty³
();

58 
Objeù
 
de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
);

66 
£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
);

68 
	gM­
<
	gCÏss
<?>, 
	gFunùiÚ
<?, 
	gby‹
[]>> 
	gcu¡omHashšgM­
 =

69 
Ãw
 
CÚcu¼’tHashM­
<>();

75  <
	gT
> 
»gi¡”Cu¡omHash”
(
CÏss
<
T
> 
şs
, 
FunùiÚ
<T, 
by‹
[]> 
hashFunùiÚ
) {

76 
	gcu¡omHashšgM­
.
put
(
şs
, 
hashFunùiÚ
);

84  <
	gT
> 
	gFunùiÚ
<T, 
	gby‹
[]> 
g‘Cu¡omHash”
(
CÏss
<
T
> 
şs
) {

85  (
	gFunùiÚ
<
	gT
, 
	gby‹
[]>è
	gcu¡omHashšgM­
.
g‘
(
şs
);

91 
	gM­
<
	gCÏss
<?>, 
	gFunùiÚ
<?, 
	gby‹
[]>> 
	ghashCÚv”siÚM­
 =

92 
ImmubËM­
.<
CÏss
<?>, 
	gFunùiÚ
<?, 
	gby‹
[]>>
bud”
()

93 .
put
(
SŒšg
.
şass
, (SŒšg 
o
) ->

94 
Uts
.
lÚgToBigEndŸnBy‹A¼ay
(
LÚgHashFunùiÚ
.
xx
().
hashCh¬s
(
o
)))

95 .
put
(
UUID
.
şass
, (UUID 
o
) -> {

96 
By‹Bufãr
 
bb
 = By‹Bufãr.
w¿p
(
Ãw
 
by‹
[16]);

97 
bb
.
putLÚg
(
o
.
g‘Mo¡SignifiÿÁB™s
());

98 
bb
.
putLÚg
(
o
.
g‘L—¡SignifiÿÁB™s
());

99  
bb
.
¬¿y
();

101 .
put
(
LÚg
.
şass
, (LÚg 
o
è-> 
Uts
.
lÚgToBigEndŸnBy‹A¼ay
(o))

102 .
put
(
IÁeg”
.
şass
, (IÁeg” 
o
è-> 
Uts
.
štToBigEndŸnBy‹A¼ay
(o))

103 .
put
(
By‹
.
şass
, (By‹ 
o
è-> 
Ãw
 
by‹
[]{o})

104 .
put
(.
şass
, (
LÚg
 
o
è-> 
Uts
.
lÚgToBigEndŸnBy‹A¼ay
(o))

105 .
put
(.
şass
, (
IÁeg”
 
o
è-> 
Uts
.
štToBigEndŸnBy‹A¼ay
(o))

106 .
put
(
by‹
.
şass
, (
By‹
 
o
è-> 
Ãw
 byte[]{o})

107 .
bud
();

122  
	gby‹
[] 
hash
(
Objeù
 
o
) {

123 
fš®
 
	gCÏss
<?> 
	gşs
 = 
o
.
g‘CÏss
();

124 
	gFunùiÚ
<
	gObjeù
, 
	gby‹
[]> 
	gcÚv”siÚFunc
 =

125 (
FunùiÚ
<
Objeù
, 
	gby‹
[]>è
	ghashCÚv”siÚM­
.
g‘
(
şs
);

126 ià(
	gcÚv”siÚFunc
 !ğ
nuÎ
) {

128  
cÚv”siÚFunc
.
­¶y
(
o
);

129 } ià((
	gcÚv”siÚFunc
 =

130 (
FunùiÚ
<
Objeù
, 
	gby‹
[]>)
g‘Cu¡omHash”
(
şs
)è!ğ
nuÎ
) {

132  
cÚv”siÚFunc
.
­¶y
(
o
);

133 } ià(
o
 
š¡ªûof
 
	gICÜfuHashabË
) {

135  ((
	gICÜfuHashabË
è
	go
).
g’”©eCÜfuHash
();

139 
	ghash
;

140 
By‹Buf
 
	gb
 = 
UÅoŞed
.
bufãr
();

141 
£rŸlize
(
o
, 
b
);

142 
	ghash
 = 
LÚgHashFunùiÚ
.
xx
().
hashBy‹s
(
b
.
nioBufãr
());

143 
	gb
.
»Ëa£
();

144  
	gUts
.
lÚgToBigEndŸnBy‹A¼ay
(
hash
);

154  
Objeù
 
şÚe
(Objeù 
o
, 
CÜfuRuÁime
 
¹
) {

155  
	gkryos
.
g‘
().
cİy
(
o
);

	@runtime/src/main/java/org/corfudb/util/serializer/JavaSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufIÅutSŒ—m
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufOuutSŒ—m
;

7 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

8 
impÜt
 
	gjava
.
	gio
.
	gObjeùIÅutSŒ—m
;

9 
impÜt
 
	gjava
.
	gio
.
	gObjeùOuutSŒ—m
;

11 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 @
Slf4j


19 
public
 cÏs 
	cJavaS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

20 
´iv©e
 
fš®
 
by‹
 
	mty³
;

22 
public
 
	$JavaS”Ÿliz”
(
by‹
 
ty³
) {

23 
this
.
ty³
 =ype;

26 @
Ov”ride


27 
public
 
by‹
 
	$g‘Ty³
() {

28  
ty³
;

29 
	}
}

37 @
Ov”ride


38 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

39 
	`Œy
 (
By‹BufIÅutSŒ—m
 
bbis
 = 
Ãw
 
	`By‹BufIÅutSŒ—m
(
b
)) {

40 
	`Œy
 (
ObjeùIÅutSŒ—m
 
ois
 = 
Ãw
 
	`ObjeùIÅutSŒ—m
(
bbis
)) {

41  
ois
.
	`»adObjeù
();

43 } 
	`ÿtch
 (
IOExû±iÚ
 | 
CÏssNÙFoundExû±iÚ
 
›
) {

44 
log
.
	`”rÜ
("Exû±iÚ duršg de£rŸliz©iÚ!", 
›
);

45 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
›
);

47 
	}
}

55 @
Ov”ride


56 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

57 
	`Œy
 (
By‹BufOuutSŒ—m
 
bbos
 = 
Ãw
 
	`By‹BufOuutSŒ—m
(
b
)) {

58 
	`Œy
 (
ObjeùOuutSŒ—m
 
oos
 = 
Ãw
 
	`ObjeùOuutSŒ—m
(
bbos
)) {

59 
oos
.
	`wr™eObjeù
(
o
);

61 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

62 
log
.
	`”rÜ
("Exû±iÚ duršg s”Ÿliz©iÚ!", 
›
);

64 
	}
}

	@runtime/src/main/java/org/corfudb/util/serializer/JsonSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚBud”
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufIÅutSŒ—m
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufOuutSŒ—m
;

10 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

11 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

12 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

22 @
Slf4j


23 
public
 cÏs 
	cJsÚS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

24 
´iv©e
 
fš®
 
by‹
 
	mty³
;

26 
´iv©e
 
fš®
 
GsÚ
 
	mgsÚ
 = 
Ãw
 
GsÚBud”
()

27 .
ü—‹
();

29 
public
 
	$JsÚS”Ÿliz”
(
by‹
 
ty³
) {

30 
this
.
ty³
 =ype;

33 @
Ov”ride


34 
public
 
by‹
 
	$g‘Ty³
() {

35  
ty³
;

36 
	}
}

44 @
Ov”ride


45 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

46 
şassNameL’gth
 = 
b
.
	`»adShÜt
();

47 
by‹
[] 
şassNameBy‹s
 = 
Ãw
 by‹[
şassNameL’gth
];

48 
b
.
	`»adBy‹s
(
şassNameBy‹s
, 0, 
şassNameL’gth
);

49 
SŒšg
 
şassName
 = 
Ãw
 
	`SŒšg
(
şassNameBy‹s
);

50 ià(
şassName
.
	`equ®s
("null")) {

51  
nuÎ
;

52 } ià(
şassName
.
	`equ®s
("CorfuObject")) {

53 
smrCÏssNameL’gth
 = 
b
.
	`»adShÜt
();

54 
by‹
[] 
smrCÏssNameBy‹s
 = 
Ãw
 by‹[
smrCÏssNameL’gth
];

55 
b
.
	`»adBy‹s
(
smrCÏssNameBy‹s
, 0, 
smrCÏssNameL’gth
);

56 
SŒšg
 
smrCÏssName
 = 
Ãw
 
	`SŒšg
(
smrCÏssNameBy‹s
);

57 
Œy
 {

58  
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

59 .
	`£tSŒ—mID
(
Ãw
 
	`UUID
(
b
.
	`»adLÚg
(), b.readLong()))

60 .
	`£tTy³
((
CÏss
<? 
ex‹nds
 
ICÜfuSMR
>èCÏss.
	`fÜName
(
smrCÏssName
))

61 .
	`İ’
();

62 } 
	`ÿtch
 (
CÏssNÙFoundExû±iÚ
 
úã
) {

63 
log
.
	`”rÜ
("Exû±iÚ duršg de£rŸliz©iÚ!", 
úã
);

64 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
úã
);

67 
	`Œy
 (
By‹BufIÅutSŒ—m
 
bbis
 = 
Ãw
 
	`By‹BufIÅutSŒ—m
(
b
)) {

68 
	`Œy
 (
IÅutSŒ—mR—d”
 
r
 = 
Ãw
 
	`IÅutSŒ—mR—d”
(
bbis
)) {

69  
gsÚ
.
	`äomJsÚ
(
r
, 
CÏss
.
	`fÜName
(
şassName
));

71 } 
	`ÿtch
 (
IOExû±iÚ
 | 
CÏssNÙFoundExû±iÚ
 
›
) {

72 
log
.
	`”rÜ
("Exû±iÚ duršg de£rŸliz©iÚ!", 
›
);

73 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
›
);

76 
	}
}

84 @
Ov”ride


85 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

86 
SŒšg
 
şassName
 = 
o
 =ğ
nuÎ
 ? "nuÎ" : o.
	`g‘CÏss
().
	`g‘Name
();

87 ià(
şassName
.
	`’dsW™h
(
ICÜfuSMR
.
CORFUSMR_SUFFIX
)) {

88 
şassName
 = "CorfuObject";

89 
by‹
[] 
şassNameBy‹s
 = 
şassName
.
	`g‘By‹s
();

90 
b
.
	`wr™eShÜt
(
şassNameBy‹s
.
Ëngth
);

91 
b
.
	`wr™eBy‹s
(
şassNameBy‹s
);

92 
SŒšg
 
smrCÏss
 = 
şassName
.
	`¥l™
("\\$")[0];

93 
by‹
[] 
smrCÏssNameBy‹s
 = 
smrCÏss
.
	`g‘By‹s
();

94 
b
.
	`wr™eShÜt
(
smrCÏssNameBy‹s
.
Ëngth
);

95 
b
.
	`wr™eBy‹s
(
smrCÏssNameBy‹s
);

96 
UUID
 
id
 = ((
ICÜfuSMR
è
o
).
	`g‘CÜfuSŒ—mID
();

97 
log
.
	`Œaû
("Serializing‡ CorfuObject ofype {}‡s‡ stream…ointero {}",

98 
smrCÏss
, 
id
);

99 
b
.
	`wr™eLÚg
(
id
.
	`g‘Mo¡SignifiÿÁB™s
());

100 
b
.
	`wr™eLÚg
(
id
.
	`g‘L—¡SignifiÿÁB™s
());

102 
by‹
[] 
şassNameBy‹s
 = 
şassName
.
	`g‘By‹s
();

103 
b
.
	`wr™eShÜt
(
şassNameBy‹s
.
Ëngth
);

104 
b
.
	`wr™eBy‹s
(
şassNameBy‹s
);

105 ià(
o
 =ğ
nuÎ
) {

108 
	`Œy
 (
By‹BufOuutSŒ—m
 
bbos
 = 
Ãw
 
	`By‹BufOuutSŒ—m
(
b
)) {

109 
	`Œy
 (
OuutSŒ—mWr™”
 
osw
 = 
Ãw
 
	`OuutSŒ—mWr™”
(
bbos
)) {

110 
gsÚ
.
	`toJsÚ
(
o
, o.
	`g‘CÏss
(), 
osw
);

112 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

113 
log
.
	`”rÜ
("Exû±iÚ duršg s”Ÿliz©iÚ!", 
›
);

116 
	}
}

	@runtime/src/main/java/org/corfudb/util/serializer/PrimitiveSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

6 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gA¼ay
;

7 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

8 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

11 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

12 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

15 
impÜt
 
	glombok
.
	gG‘‹r
;

16 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

25 @
Slf4j


26 
public
 cÏs 
	cPrim™iveS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

27 
´iv©e
 
fš®
 
by‹
 
	mty³
;

29 
public
 
fš®
 
	mM­
<
	mBy‹
, 
	mDe£rŸliz”FunùiÚ
> 
	mDe£rŸliz”M­
 =

30 
A¼ays
.
¡»am
(
Prim™ives
.
v®ues
())

31 .
cŞËù
(
CŞËùÜs
.
toM­
(
Prim™ives
::
g‘Ty³Num
, Prim™ives::
g‘De£rŸliz”
));

32 
public
 
fš®
 
	mM­
<
	mCÏss
, 
	mPrim™ives
> 
	mS”Ÿliz”M­
 = 
g‘S”Ÿliz”M­
();

34 
public
 
	$Prim™iveS”Ÿliz”
(
by‹
 
ty³
) {

35 
this
.
ty³
 =ype;

38 @
Ov”ride


39 
public
 
by‹
 
	$g‘Ty³
() {

40  
ty³
;

41 
	}
}

43 
´iv©e
 
	gM­
<
	gCÏss
, 
	gPrim™ives
> 
	$g‘S”Ÿliz”M­
() {

44 
ImmubËM­
.
Bud”
<
CÏss
, 
Prim™ives
> 
b
 = ImmubËM­.
	`bud”
();

45 
A¼ays
.
	`¡»am
(
Prim™ives
.
	`v®ues
()).
	`fÜEach
(
e
 -> {

46 
b
.
	`put
(
e
.
	`g‘CÏssTy³
(),ƒ);

47 ià(
e
.
	`g‘Prim™iveCÏss
(è!ğ
nuÎ
) {

48 
b
.
	`put
(
e
.
	`g‘Prim™iveCÏss
(),ƒ);

51  
b
.
	`bud
();

52 
	}
}

54 @
Suµ»ssW¬nšgs
("unchecked")

55 <
	gT
, 
	gR
> 
wr™eA¼ay
(
T
[] 
o
, 
By‹Buf
 
b
, 
BiFunùiÚ
<By‹Buf, 
R
, By‹Buf> 
­¶yFunc
) {

56 
	gËngth
 = 
A¼ay
.
g‘L’gth
(
o
);

57 
	gb
.
wr™eIÁ
(
Ëngth
);

58 
	gA¼ays
.
¡»am
(
o
)

59 .
fÜEach
(
i
 -> 
­¶yFunc
.
­¶y
(
b
, (
R
) i));

62 @
Suµ»ssW¬nšgs
("unchecked")

63 <
	gT
, 
	gR
> T[] 
»adA¼ay
(
By‹Buf
 
b
, 
FunùiÚ
<By‹Buf, 
T
> 
­¶yFunc
,

64 
FunùiÚ
<
IÁeg”
, 
T
[]> 
¬¿yG’
) {

65 
	gËngth
 = 
b
.
»adIÁ
();

66 
	gT
[] 
	gr
 = 
¬¿yG’
.
­¶y
(
Ëngth
);

67 
	gi
 = 0; i < 
	gËngth
; i++) {

68 
	gr
[
i
] = 
­¶yFunc
.
­¶y
(
b
);

70  
	gr
;

73 
	$wr™eBy‹s
(
Objeù
 
o
, 
By‹Buf
 
b
) {

74 
Ëngth
 = 
A¼ay
.
	`g‘L’gth
(
o
);

75 
b
.
	`wr™eIÁ
(
Ëngth
);

76 
b
.
	`wr™eBy‹s
((
by‹
[]è
o
);

77 
	}
}

79 
	gby‹
[] 
	$»adBy‹s
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

80 
Ëngth
 = 
b
.
	`»adIÁ
();

81 
by‹
[] 
by‹s
 = 
Ãw
 by‹[
Ëngth
];

82 
b
.
	`»adBy‹s
(
by‹s
, 0, 
Ëngth
);

83  
by‹s
;

84 
	}
}

92 @
	gOv”ride


93 @
Suµ»ssW¬nšgs
("unchecked")

94 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

95 
by‹
 
ty³
 = 
b
.
	`»adBy‹
();

96 
De£rŸliz”FunùiÚ
 
d
 = 
De£rŸliz”M­
.
	`g‘
(
ty³
);

97  
d
.
	`de£rŸlize
(
b
, 
¹
);

98 
	}
}

106 @
	gOv”ride


107 @
Suµ»ssW¬nšgs
("unchecked")

108 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

109 ià(
o
.
	`g‘CÏss
().
	`g‘Name
().
	`cÚšs
("$ByteBuddy$")) {

110 ((
S”Ÿliz”FunùiÚ
<
Objeù
>è
Prim™ives
.
CORFU_SMR
.
	`g‘S”Ÿliz”
()).
	`£rŸlize
(
o
, 
b
);

112 
Prim™ives
 
p
 = 
S”Ÿliz”M­
.
	`g‘
(
o
.
	`g‘CÏss
());

113 ià(
p
 =ğ
nuÎ
) {

114 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("UnsuµÜ‹d cÏs fÜ s”Ÿliz©iÚ: " + 
o
.
	`g‘CÏss
());

116 
b
.
	`wr™eBy‹
(
p
.
	`g‘Ty³Num
());

117 ((
S”Ÿliz”FunùiÚ
<
Objeù
>)
p
.
	`g‘S”Ÿliz”
()).
	`£rŸlize
(
o
, 
b
);

119 
	}
}

121 
	ePrim™ives
 {

122 
BYTE
(0, 
By‹
.
şass
, 
by‹
.şass, (
o
, 
b
è-> b.
wr™eBy‹
(o), (b, 
r
è-> b.
»adBy‹
()),

123 
SHORT
(1, 
ShÜt
.
şass
, .şass, (
o
, 
b
è-> b.
wr™eShÜt
(o), (b, 
r
è-> b.
»adShÜt
()),

124 
INTEGER
(2, 
IÁeg”
.
şass
, .şass, (
o
, 
b
è-> b.
wr™eIÁ
(o), (b, 
r
è-> b.
»adIÁ
()),

125 
LONG
(3, 
LÚg
.
şass
, .şass, (
o
, 
b
è-> b.
wr™eLÚg
(o), (b, 
r
è-> b.
»adLÚg
()),

126 
BOOLEAN
(4, 
BoŞ—n
.
şass
, 
boŞ—n
.şass, (
o
, 
b
è-> b.
wr™eBoŞ—n
(o),

127 (
b
, 
r
è-> b.
»adBoŞ—n
()),

128 
DOUBLE
(5, 
DoubË
.
şass
, .şass, (
o
, 
b
è-> b.
wr™eDoubË
(o), (b, 
r
è-> b.
»adDoubË
()),

129 
FLOAT
(6, 
Flßt
.
şass
, .şass, (
o
, 
b
è-> b.
wr™eFlßt
(o), (b, 
r
è-> b.
»adFlßt
()),

130 
BYTE_ARRAY
(7, 
By‹
[].
şass
, 
by‹
[].şass, 
Prim™iveS”Ÿliz”
::
wr™eBy‹s
,

131 (
De£rŸliz”FunùiÚ
)
Prim™iveS”Ÿliz”
::
»adBy‹s
),

132 
SHORT_ARRAY
(8, 
ShÜt
[].
şass
, [].şass, (
o
, 
b
è-> 
wr™eA¼ay
(o, b,

133 
By‹Buf
::
wr™eShÜt
),

134 (
b
, 
r
è-> 
»adA¼ay
(b, 
By‹Buf
::
»adShÜt
, 
ShÜt
[]::
Ãw
)),

135 
INTEGER_ARRAY
(9, 
IÁeg”
[].
şass
, [].şass, (
o
, 
b
è-> 
wr™eA¼ay
(o, b,

136 
By‹Buf
::
wr™eIÁ
),

137 (
b
, 
r
è-> 
»adA¼ay
(b, 
By‹Buf
::
»adIÁ
, 
IÁeg”
[]::
Ãw
)),

138 
LONG_ARRAY
(10, 
LÚg
[].
şass
, [].şass, (
o
, 
b
è-> 
wr™eA¼ay
(o, b, 
By‹Buf
::
wr™eLÚg
),

139 (
b
, 
r
è-> 
»adA¼ay
(b, 
By‹Buf
::
»adLÚg
, 
LÚg
[]::
Ãw
)),

140 
BOOLEAN_ARRAY
(11, 
BoŞ—n
[].
şass
, 
boŞ—n
[].şass, (
o
, 
b
è-> 
wr™eA¼ay
(o, b,

141 
By‹Buf
::
wr™eBoŞ—n
),

142 (
b
, 
r
è-> 
»adA¼ay
(b, 
By‹Buf
::
»adBoŞ—n
, 
BoŞ—n
[]::
Ãw
)),

143 
DOUBLE_ARRAY
(12, 
DoubË
[].
şass
, [].şass, (
o
, 
b
è-> 
wr™eA¼ay
(o, b,

144 
By‹Buf
::
wr™eDoubË
),

145 (
b
, 
r
è-> 
»adA¼ay
(b, 
By‹Buf
::
»adDoubË
, 
DoubË
[]::
Ãw
)),

146 
FLOAT_ARRAY
(13, 
Flßt
[].
şass
, [].şass, (
o
, 
b
è-> 
wr™eA¼ay
(o, b,

147 
By‹Buf
::
wr™eFlßt
),

148 (
b
, 
r
è-> 
»adA¼ay
(b, 
By‹Buf
::
»adFlßt
, 
Flßt
[]::
Ãw
)),

149 
STRING
(14, 
SŒšg
.
şass
, 
nuÎ
, (
o
, 
b
) -> {

150 
b
.
wr™eIÁ
(
o
.
Ëngth
());

151 
b
.
wr™eBy‹s
(
o
.
g‘By‹s
());

153 (
b
, 
r
) -> {

154 
Ëngth
 = 
b
.
»adIÁ
();

155 
by‹
[] 
bs
 = 
Ãw
 by‹[
Ëngth
];

156 
b
.
»adBy‹s
(
bs
, 0, 
Ëngth
);

157  
Ãw
 
SŒšg
(
bs
);

159 
CORFU_SMR
(15, 
Objeù
.
şass
, 
nuÎ
, (
o
, 
b
) -> {

160 
SŒšg
 
şassName
 = 
o
.
g‘CÏss
().
toSŒšg
();

161 
şassName
 = "SMRObject";

162 
by‹
[] 
şassNameBy‹s
 = 
şassName
.
g‘By‹s
();

163 
b
.
wr™eShÜt
(
şassNameBy‹s
.
Ëngth
);

164 
b
.
wr™eBy‹s
(
şassNameBy‹s
);

165 
SŒšg
 
smrCÏss
 = 
şassName
.
¥l™
("\\$")[0];

166 
by‹
[] 
smrCÏssNameBy‹s
 = 
smrCÏss
.
g‘By‹s
();

167 
b
.
wr™eShÜt
(
smrCÏssNameBy‹s
.
Ëngth
);

168 
b
.
wr™eBy‹s
(
smrCÏssNameBy‹s
);

169 
Œy
 {

170 
F›ld
 
f
 = 
o
.
g‘CÏss
().
g‘Deş¬edF›ld
("_corfuStreamID");

171 
f
.
£tAcûssibË
(
Œue
);

172 
UUID
 
id
 = (UUIDè
f
.
g‘
(
o
);

173 
log
.
Œaû
("Serializing‡ SMRObject ofype {}‡s‡ stream…ointero {}",

174 
smrCÏss
, 
id
);

175 
b
.
wr™eLÚg
(
id
.
g‘Mo¡SignifiÿÁB™s
());

176 
b
.
wr™eLÚg
(
id
.
g‘L—¡SignifiÿÁB™s
());

177 } 
ÿtch
 (
NoSuchF›ldExû±iÚ
 | 
IÎeg®AcûssExû±iÚ
 
nsã
) {

178 
log
.
”rÜ
("Error serializing fields");

179 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
nsã
);

182 (
b
, 
r
) -> {

183 
smrCÏssNameL’gth
 = 
b
.
»adShÜt
();

184 
by‹
[] 
smrCÏssNameBy‹s
 = 
Ãw
 by‹[
smrCÏssNameL’gth
];

185 
b
.
»adBy‹s
(
smrCÏssNameBy‹s
, 0, 
smrCÏssNameL’gth
);

186 
SŒšg
 
smrCÏssName
 = 
Ãw
 SŒšg(
smrCÏssNameBy‹s
);

187 
Œy
 {

188  
r
.
g‘ObjeùsV›w
().
bud
()

189 .
£tSŒ—mID
(
Ãw
 
UUID
(
b
.
»adLÚg
(), b.readLong()))

190 .
£tTy³
((
CÏss
<? 
ex‹nds
 
ICÜfuSMR
>èCÏss.
fÜName
(
smrCÏssName
))

191 .
İ’
();

192 } 
ÿtch
 (
CÏssNÙFoundExû±iÚ
 
úã
) {

193 
log
.
”rÜ
("Exû±iÚ duršg de£rŸliz©iÚ!", 
úã
);

194 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
úã
);

198 @
G‘‹r


199 
public
 
fš®
 
by‹
 
	gty³Num
;

200 @
G‘‹r


201 
public
 
fš®
 
	gCÏss
<?> 
	gşassTy³
;

202 @
G‘‹r


203 
public
 
fš®
 
	gCÏss
<?> 
	g´im™iveCÏss
;

204 @
G‘‹r


205 
public
 
fš®
 
	gS”Ÿliz”FunùiÚ
<?> 
	g£rŸliz”
;

206 @
G‘‹r


207 
public
 
fš®
 
De£rŸliz”FunùiÚ
 
	gde£rŸliz”
;

208 <
	gT
> 
Prim™ives
(
ty³Num
, 
CÏss
<
T
> 
şassTy³
, CÏss<?> 
´im™iveCÏss
,

209 
S”Ÿliz”FunùiÚ
<
T
> 
£rŸliz”
, 
De£rŸliz”FunùiÚ
<T> 
de£rŸliz”
) {

210 
	gthis
.
	gty³Num
 = (
by‹
è
ty³Num
;

211 
	gthis
.
	gşassTy³
 = 
şassTy³
;

212 
	gthis
.
	g´im™iveCÏss
 = 
´im™iveCÏss
;

213 
	gthis
.
	g£rŸliz”
 = 
£rŸliz”
;

214 
	gthis
.
	gde£rŸliz”
 = 
de£rŸliz”
;

219 @
FunùiÚ®IÁ”çû


220 
š‹rçû
 
	gDe£rŸliz”FunùiÚ
<
	gT
> {

221 
T
 
de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
r
);

224 @
FunùiÚ®IÁ”çû


225 
š‹rçû
 
	gS”Ÿliz”FunùiÚ
<
	gT
> {

226 
£rŸlize
(
T
 
o
, 
By‹Buf
 
b
);

	@runtime/src/main/java/org/corfudb/util/serializer/ProtobufSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufIÅutSŒ—m
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufOuutSŒ—m
;

10 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

11 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gM­
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

17 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

31 @
Slf4j


32 
public
 cÏs 
	cPrÙobufS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

34 
´iv©e
 
fš®
 
by‹
 
	mty³
;

36 
public
 
fš®
 
by‹
 
	mPROTOBUF_SERIALIZER_CODE
 = (byte) 25;

38 
´iv©e
 
fš®
 
	mM­
<
	mSŒšg
, 
	mCÏss
<? 
ex‹nds
 
	mMes§ge
>> 
	mşassM­
;

40 
public
 
PrÙobufS”Ÿliz”
(
M­
<
SŒšg
, 
CÏss
<? 
ex‹nds
 
Mes§ge
>> 
şassM­
) {

41 
	mthis
.
	mty³
 = 
PROTOBUF_SERIALIZER_CODE
;

42 
	mthis
.
	mşassM­
 = 
şassM­
;

45 
	eMes§geTy³
 {

46 
KEY
(1),

47 
VALUE
(2);

49 
fš®
 
	gM­
<
	gIÁeg”
, 
	gMes§geTy³
> 
	gv®ToTy³M­
 = 
Ãw
 
HashM­
<>();

52 
Mes§geTy³
 
	gty³
 : Mes§geTy³.
v®ues
()) {

53 
v®ToTy³M­
.
put
(
ty³
.
v®
,ype);

57 
fš®
 
	gv®
;

59 
Mes§geTy³
(
v®
) {

60 
	gthis
.
	gv®
 = 
v®
;

63 
public
 
Mes§geTy³
 
v®ueOf
(
v®
) {

64  
	gv®ToTy³M­
.
g‘
(
v®
);

68 @
Ov”ride


69 
public
 
by‹
 
	$g‘Ty³
() {

70  
ty³
;

71 
	}
}

79 @
Ov”ride


80 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

82 
	`Œy
 (
By‹BufIÅutSŒ—m
 
bbis
 = 
Ãw
 
	`By‹BufIÅutSŒ—m
(
b
)) {

83 
Mes§geTy³
 
ty³
 = Mes§geTy³.
	`v®ueOf
(
bbis
.
	`»adIÁ
());

84 
size
 = 
bbis
.
	`»adIÁ
();

85 
by‹
[] 
d©a
 = 
Ãw
 by‹[
size
];

86 
bbis
.
	`»adFuÎy
(
d©a
);

87 
RecÜd
 
»cÜd
 = RecÜd.
	`·r£From
(
d©a
);

88 
Any
 
·ylßd
 = 
»cÜd
.
	`g‘Paylßd
();

89 
Mes§ge
 
v®ue
 = 
·ylßd
.
	`uÅack
(
şassM­
.
	`g‘
Õaylßd.
	`g‘Ty³U¾
()));

91 ià(
ty³
.
	`equ®s
(
Mes§geTy³
.
KEY
)) {

92  
v®ue
;

94 
Mes§ge
 
m‘ad©a
 = 
nuÎ
;

95 ià(
»cÜd
.
	`hasM‘ad©a
()) {

96 
Any
 
ªyM‘ad©a
 = 
»cÜd
.
	`g‘M‘ad©a
();

97 
m‘ad©a
 = 
ªyM‘ad©a
.
	`uÅack
(
şassM­
.
	`g‘
×nyM‘ad©a.
	`g‘Ty³U¾
()));

99  
Ãw
 
	`CÜfuRecÜd
(
v®ue
, 
m‘ad©a
);

101 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

102 
log
.
	`”rÜ
("Exû±iÚ duršg de£rŸliz©iÚ!", 
›
);

103 
throw
 
Ãw
 
	`S”Ÿliz”Exû±iÚ
(
›
);

105 
	}
}

113 @
Ov”ride


114 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

116 
RecÜd
 
»cÜd
;

117 
Mes§geTy³
 
ty³
;

119 ià(
o
 
š¡ªûof
 
CÜfuRecÜd
) {

120 
CÜfuRecÜd
 
cÜfuRecÜd
 = (CÜfuRecÜdè
o
;

121 
Any
 
mes§ge
 = Any.
	`·ck
(
cÜfuRecÜd
.
	`g‘Paylßd
());

122 
RecÜd
.
Bud”
 
»cÜdBud”
 = RecÜd.
	`ÃwBud”
()

123 .
	`£tPaylßd
(
mes§ge
);

124 ià(
cÜfuRecÜd
.
	`g‘M‘ad©a
(è!ğ
nuÎ
) {

125 
Any
 
m‘ad©a
 = Any.
	`·ck
(
cÜfuRecÜd
.
	`g‘M‘ad©a
());

126 
»cÜdBud”
.
	`£tM‘ad©a
(
m‘ad©a
);

128 
»cÜd
 = 
»cÜdBud”
.
	`bud
();

129 
ty³
 = 
Mes§geTy³
.
VALUE
;

131 
Any
 
mes§ge
 = Any.
	`·ck
(((
Mes§ge
è
o
));

132 
»cÜd
 = 
RecÜd
.
	`ÃwBud”
()

133 .
	`£tPaylßd
(
mes§ge
)

134 .
	`bud
();

135 
ty³
 = 
Mes§geTy³
.
KEY
;

137 
by‹
[] 
d©a
 = 
»cÜd
.
	`toBy‹A¼ay
();

139 
	`Œy
 (
By‹BufOuutSŒ—m
 
bbos
 = 
Ãw
 
	`By‹BufOuutSŒ—m
(
b
)) {

140 
bbos
.
	`wr™eIÁ
(
ty³
.
v®
);

141 
bbos
.
	`wr™eIÁ
(
d©a
.
Ëngth
);

142 
bbos
.
	`wr™e
(
d©a
);

143 } 
	`ÿtch
 (
IOExû±iÚ
 
›
) {

144 
log
.
	`”rÜ
("Exû±iÚ duršg s”Ÿliz©iÚ!", 
›
);

145 
throw
 
Ãw
 
	`S”Ÿliz”Exû±iÚ
(
›
);

147 
	}
}

	@runtime/src/main/java/org/corfudb/util/serializer/Serializers.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

4 
impÜt
 
	gjava
.
	gut
.
	gM­
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

15 @
Slf4j


16 
public
 cÏs 
	cS”Ÿliz”s
 {

18 
public
 
fš®
 
	mSYSTEM_SERIALIZERS_COUNT
 = 10;

19 
public
 
fš®
 
IS”Ÿliz”
 
	mCORFU
 = 
Ãw
 
CÜfuS”Ÿliz”
((
by‹
) 0);

20 
public
 
fš®
 
IS”Ÿliz”
 
	mJAVA
 = 
Ãw
 
JavaS”Ÿliz”
((
by‹
) 1);

21 
public
 
fš®
 
IS”Ÿliz”
 
	mJSON
 = 
Ãw
 
JsÚS”Ÿliz”
((
by‹
) 2);

22 
public
 
fš®
 
IS”Ÿliz”
 
	mPRIMITIVE
 = 
Ãw
 
Prim™iveS”Ÿliz”
((
by‹
) 3);

27 
public
 
fš®
 
IS”Ÿliz”
 
	$g‘DeçuÉS”Ÿliz”
() {

28  
S”Ÿliz”s
.
JSON
;

31 
´iv©e
 
fš®
 
M­
<
By‹
, 
IS”Ÿliz”
> 
£rŸliz”sM­
;

34 
£rŸliz”sM­
 = 
Ãw
 
	`HashM­
();

35 
£rŸliz”sM­
.
	`put
(
CORFU
.
	`g‘Ty³
(), CORFU);

36 
£rŸliz”sM­
.
	`put
(
JAVA
.
	`g‘Ty³
(), JAVA);

37 
£rŸliz”sM­
.
	`put
(
JSON
.
	`g‘Ty³
(), JSON);

38 
£rŸliz”sM­
.
	`put
(
PRIMITIVE
.
	`g‘Ty³
(), PRIMITIVE);

39 
	}
}

41 
´iv©e
 
fš®
 
	gM­
<
	gBy‹
, 
	gIS”Ÿliz”
> 
	gcu¡omS”Ÿliz”s
 = 
Ãw
 
HashM­
<>();

48 
public
 
IS”Ÿliz”
 
	$g‘S”Ÿliz”
(
By‹
 
ty³
) {

49 ià(
ty³
 <ğ
SYSTEM_SERIALIZERS_COUNT
) {

50 ià(
£rŸliz”sM­
.
	`cÚšsKey
(
ty³
)) {

51  
£rŸliz”sM­
.
	`g‘
(
ty³
);

53 } ià(
cu¡omS”Ÿliz”s
.
	`cÚšsKey
(
ty³
)) {

54  
cu¡omS”Ÿliz”s
.
	`g‘
(
ty³
);

57 
log
.
	`”rÜ
("Serializer withype code {}‚ot found. Please check custom serializers " +

58 "fÜhi ş›Á.", 
ty³
.
	`štV®ue
());

59 
throw
 
Ãw
 
	`S”Ÿliz”Exû±iÚ
(
ty³
);

60 
	}
}

66 
public
 
synchrÚized
 
	$»gi¡”S”Ÿliz”
(
IS”Ÿliz”
 
£rŸliz”
) {

67 ià(
£rŸliz”
.
	`g‘Ty³
(è> 
SYSTEM_SERIALIZERS_COUNT
) {

68 
cu¡omS”Ÿliz”s
.
	`put
(
£rŸliz”
.
	`g‘Ty³
(), serializer);

70 
SŒšg
 
msg
 = SŒšg.
	`fÜm©
("Serializer id must be greaterhan {}",

71 
SYSTEM_SERIALIZERS_COUNT
);

72 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
msg
);

74 
	}
}

76 @
VisibËFÜTe¡šg


77 
public
 
synchrÚized
 
	$»moveS”Ÿliz”
(
IS”Ÿliz”
 
£rŸliz”
) {

78 
cu¡omS”Ÿliz”s
.
	`»move
(
£rŸliz”
.
	`g‘Ty³
());

79 
	}
}

	@runtime/src/test/java/org/corfudb/protocols/wireprotocol/ICorfuPayloadTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
.
	gCheckpoštEÁryTy³
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
.
	gD©aRªk
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

11 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gJava6As£¹iÚs
.
	gas£¹Th©
;

19 
public
 cÏs 
	cICÜfuPaylßdTe¡
 {

21 @
Te¡


22 
public
 
	$checkCÚ¡ruùÜM­
() {

23 
Li¡
<
CÏss
<?>> 
ty³s
 = 
A¼ays
.
	`asLi¡
(

24 
By‹
.
şass
, 
IÁeg”
.şass, 
LÚg
.şass, 
BoŞ—n
.şass, 
DoubË
.şass, 
Flßt
.şass, 
SŒšg
.class,

25 
Layout
.
şass
, 
D©aRªk
.şass, 
CheckpoštEÁryTy³
.şass, 
UUID
.şass, 
by‹
[].şass, 
By‹Buf
.class

28 
	`as£¹Th©
(
ICÜfuPaylßd
.
cÚ¡ruùÜM­
.
	`keyS‘
()).
	`cÚšsAÎ
(
ty³s
);

31 @
Te¡


32 
public
 
	$‹¡BudPaylßdFromBufãr
(){

33 
fš®
 
v®ue
 = 12345;

34 
By‹Buf
 
·ylßd
 = 
UÅoŞed
.
	`bufãr
().
	`wr™eIÁ
(
v®ue
);

35 
IÁeg”
 
»suÉ
 = 
ICÜfuPaylßd
.
	`äomBufãr
(
·ylßd
, IÁeg”.
şass
);

37 
	`as£¹Th©
(
»suÉ
).
	`isEqu®To
(
v®ue
);

38 
	}
}

40 @
Te¡


41 
public
 
	$‹¡S”Ÿlize
(){

42 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`bufãr
();

44 
S‘
<
SŒšg
> 
·ylßd
 = 
Ãw
 
HashS‘
<>();

45 
·ylßd
.
	`add
("value1");

46 
·ylßd
.
	`add
("value2");

48 
ICÜfuPaylßd
.
	`£rŸlize
(
buf
, 
·ylßd
);

50 
	`as£¹Th©
(
ICÜfuPaylßd
.
	`£tFromBufãr
(
buf
, 
SŒšg
.
şass
)).
	`isEqu®To
(
·ylßd
);

51 
	}
}

	@runtime/src/test/java/org/corfudb/protocols/wireprotocol/NodeStateTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
public
 cÏs 
	cNodeS‹Te¡
 {

15 @
Te¡


16 
public
 
	$‹¡S”ŸlizeDe£rŸlize
() {

17 
fš®
 
•och
 = 1;

19 
NodeCÚÃùiv™y
 
co
 = NodeCÚÃùiv™y.
	`bud”
()

20 .
	`ty³
(
NodeCÚÃùiv™yTy³
.
CONNECTED
)

21 .
	`’dpošt
("localhost:9000")

22 .
	`cÚÃùiv™y
(
ImmubËM­
.
	`of
())

23 .
	`•och
(
•och
)

24 .
	`bud
();

26 
NodeS‹
 
nodeS‹
 = NodeS‹.
	`bud”
()

27 .
	`£qu’ûrM‘rics
(
Sequ’ûrM‘rics
.
UNKNOWN
)

28 .
	`cÚÃùiv™y
(
co
)

29 .
	`bud
();

31 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`bufãr
();

32 
CÜfuPaylßdMsg
<
NodeS‹
> 
msg
 = 
CÜfuMsgTy³
.
NODE_STATE_RESPONSE
.
	`·ylßdMsg
(
nodeS‹
);

33 
msg
.
	`£rŸlize
(
buf
);

35 
CÜfuMsg
 
de£rŸlizedMsg
 = CÜfuMsg.
	`de£rŸlize
(
buf
);

36 
	`as£¹Equ®s
(
CÜfuMsgTy³
.
NODE_STATE_RESPONSE
, 
de£rŸlizedMsg
.
msgTy³
);

37 
	`as£¹NÙNuÎ
(
de£rŸlizedMsg
.
	`g‘Buf
());

41 
	}
}

	@runtime/src/test/java/org/corfudb/protocols/wireprotocol/failuredetector/NodeConnectivityTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gFAILED
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gCÚÃùiÚStus
.
	gOK
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
public
 cÏs 
	cNodeCÚÃùiv™yTe¡
 {

14 @
Te¡


15 
public
 
	$‹¡CÚÃùedAndFaedNodes
() {

16 
NodeCÚÃùiv™y
 
nodeS‹
 = NodeCÚÃùiv™y.
	`cÚÃùiv™y
(

18 
ImmubËM­
.
	`of
("a", 
OK
, "b", OK, "c", 
FAILED
)

21 
	`as£¹Th©
(
nodeS‹
.
	`g‘CÚÃùedNodes
()).
	`isEqu®To
(
ImmubËS‘
.
	`of
("a", "b"));

22 
	`as£¹Th©
(
nodeS‹
.
	`g‘FaedNodes
()).
	`isEqu®To
(
ImmubËS‘
.
	`of
("c"));

24 
	}
}

	@runtime/src/test/java/org/corfudb/runtime/view/LayoutTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

4 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

5 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gwh’
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gT»eS‘
;

11 
public
 cÏs 
	cLayoutTe¡
 {

13 @
Te¡


14 
public
 
	$‹¡LayoutCom·¿tÜ
(){

15 
Layout
 
l1
 = 
	`mock
(Layout.
şass
);

16 
Layout
 
l2
 = 
	`mock
(Layout.
şass
);

18 
	`wh’
(
l1
.
	`g‘Epoch
()).
	`th’R‘uº
(1L);

19 
	`wh’
(
l2
.
	`g‘Epoch
()).
	`th’R‘uº
(2L);

21 
T»eS‘
<
Layout
> 
desûndšgOrd”
 = 
Ãw
 T»eS‘<>(Layout.
LAYOUT_COMPARATOR
);

22 
desûndšgOrd”
.
	`add
(
l1
);

23 
desûndšgOrd”
.
	`add
(
l2
);

25 
	`as£¹Equ®s
(
l2
.
	`g‘Epoch
(), 
desûndšgOrd”
.
	`fœ¡
().getEpoch());

28 
	}
}

	@runtime/target/generated-sources/annotations/org/corfudb/runtime/collections/CorfuTable$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gCom·¿bË
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

8 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

9 
impÜt
 
	gjava
.
	gÏng
.
	gSuµ»ssW¬nšgs
;

10 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiCÚsum”
;

15 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiFunùiÚ
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

17 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

18 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

20 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÚæiùP¬am‘”
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gT¿n§ùiÚ®M‘hod
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxy
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRUpÿÎT¬g‘
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuV”siÚPŞicy
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoFunùiÚ
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoRecÜdFunùiÚ
;

36 @
In¡rum’‹dCÜfuObjeù


37 
public
 
şass
 
	gCÜfuTabË$CORFUSMR
<
	gK
, 
	gV
> 
ex‹nds
 
	gCÜfuTabË
<K, V> 
im¶em’ts
 
	gICÜfuSMR
<CorfuTable<K, V>> {

38 
public
 
	gICÜfuSMRProxy
<
	gCÜfuTabË
<
	gK
, 
	gV
>> 
	g´oxy_CORFUSMR
;

40 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuTabË
<
	gK
, 
	gV
>>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<CorfuTable<K, V>>>()

41 .
put
("ş—r", (
obj
, 
¬gs
è-> { obj.
ş—r
(); 
nuÎ
;})

42 .
put
("put", (
obj
, 
¬gs
è-> {  obj.put((
K
è¬gs[0], (
V
)‡rgs[1]);})

43 .
put
("»move", (
obj
, 
¬gs
è-> {  obj.
»move
((
java
.
Ïng
.
Objeù
)‡rgs[0]);})

44 .
put
("putAÎ", (
obj
, 
¬gs
è-> { obj.
putAÎ
((
java
.
ut
.
M­
<? 
ex‹nds
 
K
,?ƒx‹nd 
V
>è¬gs[0]); 
nuÎ
;}).
bud
();

46 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuTabË
<
	gK
, 
	gV
>>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecordFunction<CorfuTable<K, V>>>()

47 .
put
("put", (
obj
, 
¬gs
è-> {  
this
.
undoPutRecÜd
(obj,(
K
è¬gs[0], (
V
)‡rgs[1]);})

48 .
put
("»move", (
obj
, 
¬gs
è-> {  
this
.
undoRemoveRecÜd
(obj,(
K
)‡rgs[0]);})

49 .
put
("putAÎ", (
obj
, 
¬gs
è-> {  
this
.
undoPutAÎRecÜd
(obj,(
java
.
ut
.
M­
<? 
ex‹nds
 
K
,?ƒx‹nd 
V
>è¬gs[0]);}).
bud
();

51 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuTabË
<
	gK
, 
	gV
>>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunction<CorfuTable<K, V>>>()

52 .
put
("put", (
obj
, 
undoRecÜd
, 
¬gs
è-> {
this
.
undoPut
(obj, (
V
èundoRecÜd, (
K
)‡rgs[0], (V)‡rgs[1]);})

53 .
put
("»move", (
obj
, 
undoRecÜd
, 
¬gs
è-> {
this
.
undoRemove
(obj, (
V
èundoRecÜd, (
K
)‡rgs[0]);})

54 .
put
("putAÎ", (
obj
, 
undoRecÜd
, 
¬gs
è-> {
this
.
undoPutAÎ
(obj, (
java
.
ut
.
M­
<
K
, 
V
>èundoRecÜd, (java.ut.M­<? 
ex‹nds
 K,?ƒx‹nd V>è¬gs[0]);}).
bud
();

56 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>()

57 .
add
("ş—r").
bud
();

59 
public
 
CÜfuTabË$CORFUSMR
(
CÚ‹xtAw¬eM­
<
K
, 
V
> 
mašM­
, 
S‘
<
Index
.
S³c
<K, V, ? 
ex‹nds
 
Com·¿bË
>> 
šdexS³c
, 
M­
<
SŒšg
, M­<Com·¿bË, M­<K, V>>> 
£cÚd¬yIndexe
, 
CÜfuTabË
<K, V> 
İtimi¡icTabË
) {

60 
su³r
(
mašM­
, 
šdexS³c
, 
£cÚd¬yIndexe
, 
İtimi¡icTabË
);

63 
public
 
CÜfuTabË$CORFUSMR
(
Index
.
Regi¡ry
<
K
, 
V
> 
šdiûs
, 
Suµl›r
<
CÚ‹xtAw¬eM­
<K, V>> 
¡»amšgM­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
V”siÚPŞicy
 
v”siÚPŞicy
) {

64 
su³r
(
šdiûs
, 
¡»amšgM­Suµl›r
, 
v”siÚPŞicy
);

67 
public
 
CÜfuTabË$CORFUSMR
(
Index
.
Regi¡ry
<
K
, 
V
> 
šdiûs
, 
Suµl›r
<
CÚ‹xtAw¬eM­
<K, V>> 
¡»amšgM­Suµl›r
) {

68 
su³r
(
šdiûs
, 
¡»amšgM­Suµl›r
);

71 
public
 
CÜfuTabË$CORFUSMR
(
Suµl›r
<
CÚ‹xtAw¬eM­
<
K
, 
V
>> 
¡»amšgM­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
V”siÚPŞicy
 
v”siÚPŞicy
) {

72 
su³r
(
¡»amšgM­Suµl›r
, 
v”siÚPŞicy
);

75 
public
 
CÜfuTabË$CORFUSMR
(
Index
.
Regi¡ry
<
K
, 
V
> 
šdexRegi¡ry
) {

76 
su³r
(
šdexRegi¡ry
);

79 
public
 
CÜfuTabË$CORFUSMR
() {

80 
su³r
();

83 
public
 
	gICÜfuSMRProxy
<
	gCÜfuTabË
<
	gK
, 
	gV
>> 
g‘CÜfuSMRProxy
() {

84  
	g´oxy_CORFUSMR
;

87 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
CÜfuTabË
<
K
, 
V
>> 
´oxy
) {

88 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

91 @
	gOv”ride


92 @
AcûssÜ


93 
public
 
size
() {

94  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
size
();},
nuÎ
);

97 @
	gOv”ride


98 @
	gAcûssÜ


99 @
NÚnuÎ


100 
	gpublic
 <
I
 
ex‹nds
 
	gCom·¿bË
<
	gI
>> 
	gCŞËùiÚ
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
g‘ByIndexAndF‹r
(@
NÚnuÎ
 
Index
.
Name
 
šdexName
, @NÚnuÎ 
P»diÿ‹
<? 
su³r
 
M­
.
EÁry
<
K
, 
V
>> 
’ŒyP»diÿ‹
, I 
šdexKey
) {

101  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘ByIndexAndF‹r
(
šdexName
, 
’ŒyP»diÿ‹
, 
šdexKey
);},
nuÎ
);

104 @
	gOv”ride


105 @
AcûssÜ


106 
public
 
boŞ—n
 
cÚšsV®ue
(
Objeù
 
v®ue
) {

107  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
cÚšsV®ue
(
v®ue
);},
nuÎ
);

110 @
	gOv”ride


111 @
	gAcûssÜ


112 @
NÚnuÎ


113 
public
 
	gS‘
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
’ŒyS‘
() {

114  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
’ŒyS‘
();},
nuÎ
);

117 @
	gOv”ride


118 @
AcûssÜ


119 
public
 
boŞ—n
 
isEm±y
() {

120  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
isEm±y
();},
nuÎ
);

123 @
	gOv”ride


124 @
MutÜ
(

125 
Çme
 = "clear",

126 
»£t
 = 
Œue


128 
public
 
ş—r
() {

129 
´oxy_CORFUSMR
.
logUpd©e
("ş—r",
çl£
,
nuÎ
);

132 @
	gOv”ride


133 @
AcûssÜ


134 
public
 
V
 
g‘OrDeçuÉ
(
Objeù
 
key
, V 
deçuÉV®ue
) {

135  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘OrDeçuÉ
(
key
, 
deçuÉV®ue
);},
nuÎ
);

138 @
	gOv”ride


139 @
	gAcûssÜ


140 @
NÚnuÎ


141 
public
 
	gSŒ—m
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
’ŒySŒ—m
() {

142  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
’ŒySŒ—m
();},
nuÎ
);

145 @
Ov”ride


146 
public
 
SŒšg
 
toSŒšg
() {

147  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

150 @
Ov”ride


151 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

152  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

155 @
	gOv”ride


156 @
MutÜ
(

157 
Çme
 = "remove",

158 
noUpÿÎ
 = 
Œue


160 
public
 
d–‘e
(@
CÚæiùP¬am‘”
 
K
 
key
) {

161 
Objeù
[] 
cÚæiùF›ld_CORFUSMR
 = 
Ãw
 Objeù[]{
key
};

162 
	g´oxy_CORFUSMR
.
logUpd©e
("»move",
çl£
,
cÚæiùF›ld_CORFUSMR
,
key
);

165 @
	gOv”ride


166 @
AcûssÜ


167 
public
 
V
 
g‘
(@
CÚæiùP¬am‘”
 
Objeù
 
key
) {

168 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
key
};

169  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘
(
key
);},
cÚæiùF›ld_CORFUSMR
);

172 @
	gOv”ride


173 @
T¿n§ùiÚ®M‘hod


174 
public
 
V
 
compu‹IfP»£Á
(
K
 
key
, 
BiFunùiÚ
<? 
su³r
 K, ? su³¸V, ? 
ex‹nds
 V> 
»m­pšgFunùiÚ
) {

175  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
compu‹IfP»£Á
(
key
, 
»m­pšgFunùiÚ
);

178 @
	gOv”ride


179 @
AcûssÜ


180 
public
 
	gCŞËùiÚ
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
sÿnAndF‹rByEÁry
(
P»diÿ‹
<? 
su³r
 
M­
.
EÁry
<
K
, 
V
>> 
’ŒyP»diÿ‹
) {

181  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
sÿnAndF‹rByEÁry
(
’ŒyP»diÿ‹
);},
nuÎ
);

184 @
	gOv”ride


185 @
MutÜAcûssÜ
(

186 
Çme
 = "put",

187 
undoFunùiÚ
 = "undoPut",

188 
undoRecÜdFunùiÚ
 = "undoPutRecord"

190 
public
 
V
 
put
(@
CÚæiùP¬am‘”
 
K
 
key
, V 
v®ue
) {

191 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
key
};

192 
	gadd»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("put",
Œue
,
cÚæiùF›ld_CORFUSMR
,
key
, 
v®ue
);

193  (
	gV
è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
cÚæiùF›ld_CORFUSMR
);

196 @
	gOv”ride


197 @
T¿n§ùiÚ®M‘hod


198 
public
 
»¶aûAÎ
(
BiFunùiÚ
<? 
su³r
 
K
, ? su³¸
V
, ? 
ex‹nds
 V> 
funùiÚ
) {

199 
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> {
su³r
.
»¶aûAÎ
(
funùiÚ
);

200  
nuÎ
; });}

202 @
	gOv”ride


203 @
AcûssÜ


204 
public
 
fÜEach
(
BiCÚsum”
<? 
su³r
 
K
, ? su³¸
V
> 
aùiÚ
) {

205 
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> {o_CORFUSMR.
fÜEach
(
aùiÚ
); 
nuÎ
;},null);

208 @
	gOv”ride


209 @
AcûssÜ


210 
public
 
boŞ—n
 
cÚšsKey
(@
CÚæiùP¬am‘”
 
Objeù
 
key
) {

211 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
key
};

212  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
cÚšsKey
(
key
);},
cÚæiùF›ld_CORFUSMR
);

215 @
	gOv”ride


216 @
Suµ»ssW¬nšgs
("unchecked")

217 @
	gAcûssÜ


218 @
NÚnuÎ


219 
	gpublic
 <
I
 
ex‹nds
 
	gCom·¿bË
<
	gI
>> 
	gCŞËùiÚ
<
	gM­
.
	gEÁry
<
	gK
, 
	gV
>> 
g‘ByIndex
(@
NÚnuÎ
 
Index
.
Name
 
šdexName
, I 
šdexKey
) {

220  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘ByIndex
(
šdexName
, 
šdexKey
);},
nuÎ
);

223 @
	gOv”ride


224 @
T¿n§ùiÚ®M‘hod


225 
public
 
V
 
putIfAb£Á
(
K
 
key
, V 
v®ue
) {

226  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
putIfAb£Á
(
key
, 
v®ue
);

229 @
	gOv”ride


230 @
T¿n§ùiÚ®M‘hod


231 
public
 
V
 
m”ge
(
K
 
key
, V 
v®ue
, 
BiFunùiÚ
<? 
su³r
 V, ? su³¸V, ? 
ex‹nds
 V> 
»m­pšgFunùiÚ
) {

232  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
m”ge
(
key
, 
v®ue
, 
»m­pšgFunùiÚ
);

235 @
	gOv”ride


236 @
MutÜ
(

237 
Çme
 = "put",

238 
noUpÿÎ
 = 
Œue


240 
public
 
š£¹
(@
CÚæiùP¬am‘”
 
K
 
key
, 
V
 
v®ue
) {

241 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
key
};

242 
	g´oxy_CORFUSMR
.
logUpd©e
("put",
çl£
,
cÚæiùF›ld_CORFUSMR
,
key
, 
v®ue
);

245 @
	gOv”ride


246 @
T¿n§ùiÚ®M‘hod


247 
public
 
boŞ—n
 
»move
(
Objeù
 
key
, Objeù 
v®ue
) {

248  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
»move
(
key
, 
v®ue
);

251 @
Ov”ride


252 
public
 
hashCode
() {

253  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

256 @
	gOv”ride


257 @
	gAcûssÜ


258 @
NÚnuÎ


259 
public
 
	gS‘
<
	gK
> 
keyS‘
() {

260  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
keyS‘
();},
nuÎ
);

263 @
	gOv”ride


264 @
T¿n§ùiÚ®M‘hod


265 
public
 
V
 
compu‹IfAb£Á
(
K
 
key
, 
FunùiÚ
<? 
su³r
 K, ? 
ex‹nds
 V> 
m­pšgFunùiÚ
) {

266  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
compu‹IfAb£Á
(
key
, 
m­pšgFunùiÚ
);

269 @
	gOv”ride


270 @
AcûssÜ


271 
public
 
boŞ—n
 
hasSecÚd¬yIndiûs
() {

272  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hasSecÚd¬yIndiûs
();},
nuÎ
);

275 @
	gOv”ride


276 @
T¿n§ùiÚ®M‘hod


277 
public
 
V
 
»¶aû
(
K
 
key
, V 
v®ue
) {

278  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
»¶aû
(
key
, 
v®ue
);

281 @
	gOv”ride


282 @
MutÜAcûssÜ
(

283 
Çme
 = "remove",

284 
undoFunùiÚ
 = "undoRemove",

285 
undoRecÜdFunùiÚ
 = "undoRemoveRecord"

287 @
Suµ»ssW¬nšgs
("unchecked")

288 
public
 
V
 
»move
(@
CÚæiùP¬am‘”
 
Objeù
 
key
) {

289 
Objeù
[] 
cÚæiùF›ld_CORFUSMR
 = 
Ãw
 Objeù[]{
key
};

290 
	gadd»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("»move",
Œue
,
cÚæiùF›ld_CORFUSMR
,
key
);

291  (
	gV
è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
cÚæiùF›ld_CORFUSMR
);

294 @
	gOv”ride


295 @
AcûssÜ


296 
public
 
	gLi¡
<
	gV
> 
sÿnAndF‹r
(
P»diÿ‹
<? 
su³r
 
V
> 
v®ueP»diÿ‹
) {

297  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
sÿnAndF‹r
(
v®ueP»diÿ‹
);},
nuÎ
);

300 @
	gOv”ride


301 @
PassThrough


302 
public
 
şo£
() {

303 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

306 @
	gOv”ride


307 @
	gAcûssÜ


308 @
NÚnuÎ


309 
public
 
	gCŞËùiÚ
<
	gV
> 
v®ues
() {

310  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
v®ues
();},
nuÎ
);

313 @
	gOv”ride


314 @
PassThrough


315 
public
 
	gCÜfuTabË
<
	gK
, 
	gV
> 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

316  
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);});

319 @
	gOv”ride


320 @
MutÜ
(

321 
Çme
 = "putAll",

322 
undoFunùiÚ
 = "undoPutAll",

323 
undoRecÜdFunùiÚ
 = "undoPutAllRecord",

324 
cÚæiùP¬am‘”FunùiÚ
 = "putAllConflictFunction"

326 
public
 
putAÎ
(@
NÚnuÎ
 
M­
<? 
ex‹nds
 
K
, ?ƒx‹nd 
V
> 
m
) {

327 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
putAÎCÚæiùFunùiÚ
(
m
);

328 
	g´oxy_CORFUSMR
.
logUpd©e
("putAÎ",
çl£
,
cÚæiùF›ld_CORFUSMR
,
m
);

331 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuTabË
<
	gK
, 
	gV
>>> 
g‘CÜfuSMRUpÿÎM­
() {

332  
	gupÿÎM­_CORFUSMR
;

335 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuTabË
<
	gK
, 
	gV
>>> 
g‘CÜfuUndoRecÜdM­
() {

336  
	gundoRecÜdM­_CORFUSMR
;

339 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuTabË
<
	gK
, 
	gV
>>> 
g‘CÜfuUndoM­
() {

340  
	gundoM­_CORFUSMR
;

343 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

344  
	g»£tS‘_CORFUSMR
;

	@runtime/target/generated-sources/org/corfudb/runtime/CorfuOptions.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

6 
public
 
fš®
 cÏs 
	cCÜfuO±iÚs
 {

7 
´iv©e
 
	$CÜfuO±iÚs
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
»gi¡ry
.
	`add
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
schema
);

11 
	}
}

13 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

14 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

15 
	`»gi¡”AÎEx‹nsiÚs
(

16 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

17 
	}
}

18 
public
 
š‹rçû
 
SchemaO±iÚsOrBud”
 
ex‹nds


20 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

29 
boŞ—n
 
hasSecÚd¬yKey
();

37 
boŞ—n
 
g‘SecÚd¬yKey
();

46 
boŞ—n
 
hasV”siÚ
();

54 
boŞ—n
 
g‘V”siÚ
();

63 
public
 
fš®
 
şass
 
SchemaO±iÚs
 
ex‹nds


64 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


66 
	gSchemaO±iÚsOrBud”
 {

68 
´iv©e
 
SchemaO±iÚs
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

69 
su³r
(
bud”
);

71 
´iv©e
 
SchemaO±iÚs
() {

72 
	g£cÚd¬yKey_
 = 
çl£
;

73 
	gv”siÚ_
 = 
çl£
;

76 @
	gjava
.
	gÏng
.
Ov”ride


77 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


78 
g‘UnknownF›lds
() {

79  
	gthis
.
	gunknownF›lds
;

81 
´iv©e
 
SchemaO±iÚs
(

82 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

83 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

84 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

85 
this
();

86 
	gmubË_b™F›ld0_
 = 0;

87 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

88 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

89 
	gŒy
 {

90 
boŞ—n
 
	gdÚe
 = 
çl£
;

91 !
	gdÚe
) {

92 
	gg
 = 
šput
.
»adTag
();

93 
	gg
) {

95 
dÚe
 = 
Œue
;

98 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

99 
ex‹nsiÚRegi¡ry
, 
g
)) {

100 
	gdÚe
 = 
Œue
;

105 
b™F›ld0_
 |= 0x00000001;

106 
	g£cÚd¬yKey_
 = 
šput
.
»adBoŞ
();

110 
b™F›ld0_
 |= 0x00000002;

111 
	gv”siÚ_
 = 
šput
.
»adBoŞ
();

116 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

117 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

118 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

119 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

120 
e
).
£tUnfšishedMes§ge
(
this
);

121 } 
	gfš®ly
 {

122 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

123 
makeEx‹nsiÚsImmubË
();

126 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


127 
g‘DesütÜ
() {

128  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

131 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


132 
š‹º®G‘F›ldAcûssÜTabË
() {

133  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË


134 .
’su»F›ldAcûssÜsIn™Ÿlized
(

135 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
şass
, org.cÜfudb.ruÁime.CÜfuO±iÚs.SchemaO±iÚs.
Bud”
.class);

138 
´iv©e
 
	gb™F›ld0_
;

139 
public
 
fš®
 
	gSECONDARY_KEY_FIELD_NUMBER
 = 1;

140 
´iv©e
 
boŞ—n
 
	g£cÚd¬yKey_
;

148 
public
 
boŞ—n
 
hasSecÚd¬yKey
() {

149  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

158 
public
 
boŞ—n
 
g‘SecÚd¬yKey
() {

159  
	g£cÚd¬yKey_
;

162 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 2;

163 
´iv©e
 
boŞ—n
 
	gv”siÚ_
;

171 
public
 
boŞ—n
 
hasV”siÚ
() {

172  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

181 
public
 
boŞ—n
 
g‘V”siÚ
() {

182  
	gv”siÚ_
;

185 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

186 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

187 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

188 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

189 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

191 
	gmemoizedIsIn™Ÿlized
 = 1;

192  
	gŒue
;

195 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

196 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

197 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

198 
ouut
.
wr™eBoŞ
(1, 
£cÚd¬yKey_
);

200 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

201 
ouut
.
wr™eBoŞ
(2, 
v”siÚ_
);

203 
	gunknownF›lds
.
wr™eTo
(
ouut
);

206 
public
 
g‘S”ŸlizedSize
() {

207 
	gsize
 = 
memoizedSize
;

208 ià(
	gsize
 !ğ-1è 
size
;

210 
	gsize
 = 0;

211 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

212 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


213 .
compu‹BoŞSize
(1, 
£cÚd¬yKey_
);

215 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

216 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


217 .
compu‹BoŞSize
(2, 
v”siÚ_
);

219 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

220 
	gmemoizedSize
 = 
size
;

221  
	gsize
;

224 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

225 @
	gjava
.
	gÏng
.
Ov”ride


226 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

227 ià(
	gobj
 =ğ
this
) {

228  
Œue
;

230 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
)) {

231  
	gsu³r
.
equ®s
(
obj
);

233 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.SchemaO±iÚsè
obj
;

235 
boŞ—n
 
	g»suÉ
 = 
Œue
;

236 
	g»suÉ
 = 
»suÉ
 && (
hasSecÚd¬yKey
(è=ğ
Ùh”
.hasSecondaryKey());

237 ià(
hasSecÚd¬yKey
()) {

238 
	g»suÉ
 = 
»suÉ
 && (
g‘SecÚd¬yKey
()

239 =ğ
Ùh”
.
g‘SecÚd¬yKey
());

241 
	g»suÉ
 = 
»suÉ
 && (
hasV”siÚ
(è=ğ
Ùh”
.hasVersion());

242 ià(
hasV”siÚ
()) {

243 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

244 =ğ
Ùh”
.
g‘V”siÚ
());

246 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

247  
	g»suÉ
;

250 @
	gjava
.
	gÏng
.
Ov”ride


251 
public
 
hashCode
() {

252 ià(
	gmemoizedHashCode
 != 0) {

253  
memoizedHashCode
;

255 
	ghash
 = 41;

256 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

257 ià(
hasSecÚd¬yKey
()) {

258 
	ghash
 = (37 * 
hash
è+ 
SECONDARY_KEY_FIELD_NUMBER
;

259 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

260 
g‘SecÚd¬yKey
());

262 ià(
hasV”siÚ
()) {

263 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

264 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

265 
g‘V”siÚ
());

267 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

268 
	gmemoizedHashCode
 = 
hash
;

269  
	ghash
;

272 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

273 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

274 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

275  
	gPARSER
.
·r£From
(
d©a
);

277 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

278 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

279 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

280 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

281  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

283 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(
by‹
[] 
d©a
)

284 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

285  
	gPARSER
.
·r£From
(
d©a
);

287 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

288 
by‹
[] 
d©a
,

289 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

290 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

291  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

293 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

294 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

295  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


296 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

298 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

299 
java
.
io
.
IÅutSŒ—m
 
šput
,

300 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

301 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

302  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


303 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

305 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

306 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

307  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


308 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

310 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£D–im™edFrom
(

311 
java
.
io
.
IÅutSŒ—m
 
šput
,

312 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

313 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

314  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


315 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

317 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

318 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

319 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

320  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


321 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

323 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

324 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

325 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

326 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

327  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


328 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

331 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

332 
public
 
Bud”
 
ÃwBud”
() {

333  
	gDEFAULT_INSTANCE
.
toBud”
();

335 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
 
´ÙÙy³
) {

336  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

338 
public
 
Bud”
 
toBud”
() {

339  
	gthis
 =ğ
DEFAULT_INSTANCE


340 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

343 @
	gjava
.
	gÏng
.
Ov”ride


344 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

345 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

346 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

347  
	gbud”
;

356 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


357 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


359 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚsOrBud”
 {

360 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


361 
g‘DesütÜ
() {

362  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

365 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


366 
š‹º®G‘F›ldAcûssÜTabË
() {

367  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË


368 .
’su»F›ldAcûssÜsIn™Ÿlized
(

369 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
şass
, org.cÜfudb.ruÁime.CÜfuO±iÚs.SchemaO±iÚs.
Bud”
.class);

373 
´iv©e
 
Bud”
() {

374 
maybeFÜûBud”In™Ÿliz©iÚ
();

377 
´iv©e
 
Bud”
(

378 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

379 
su³r
(
·»Á
);

380 
maybeFÜûBud”In™Ÿliz©iÚ
();

382 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

383 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


384 .
	g®waysU£F›ldBud”s
) {

387 
public
 
Bud”
 
ş—r
() {

388 
	gsu³r
.
ş—r
();

389 
	g£cÚd¬yKey_
 = 
çl£
;

390 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

391 
	gv”siÚ_
 = 
çl£
;

392 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

393  
	gthis
;

396 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


397 
g‘DesütÜFÜTy³
() {

398  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

401 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

402  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
.
g‘DeçuÉIn¡ªû
();

405 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
bud
() {

406 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	g»suÉ
 = 
budP¬tŸl
();

407 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

408 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

410  
	g»suÉ
;

413 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
budP¬tŸl
() {

414 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.SchemaO±iÚs(
this
);

415 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

416 
	gto_b™F›ld0_
 = 0;

417 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

418 
to_b™F›ld0_
 |= 0x00000001;

420 
	g»suÉ
.
	g£cÚd¬yKey_
 = 
£cÚd¬yKey_
;

421 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

422 
to_b™F›ld0_
 |= 0x00000002;

424 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

425 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

426 
ÚBut
();

427  
	g»suÉ
;

430 
public
 
Bud”
 
şÚe
() {

431  (
	gBud”
è
	gsu³r
.
şÚe
();

433 
public
 
Bud”
 
£tF›ld
(

434 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

435 
Objeù
 
v®ue
) {

436  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

438 
public
 
Bud”
 
ş—rF›ld
(

439 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

440  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

442 
public
 
Bud”
 
ş—rOÃof
(

443 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

444  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

446 
public
 
Bud”
 
£tR•—‹dF›ld
(

447 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

448 
šdex
, 
Objeù
 
v®ue
) {

449  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

451 
public
 
Bud”
 
addR•—‹dF›ld
(

452 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

453 
Objeù
 
v®ue
) {

454  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

456 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

457 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
) {

458  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
)
Ùh”
);

460 
	gsu³r
.
m”geFrom
(
Ùh”
);

461  
	gthis
;

465 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
 
Ùh”
) {

466 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
g‘DeçuÉIn¡ªû
()è 
this
;

467 ià(
	gÙh”
.
hasSecÚd¬yKey
()) {

468 
£tSecÚd¬yKey
(
Ùh”
.
g‘SecÚd¬yKey
());

470 ià(
	gÙh”
.
hasV”siÚ
()) {

471 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

473 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

474 
ÚChªged
();

475  
	gthis
;

478 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

479  
	gŒue
;

482 
public
 
Bud”
 
m”geFrom
(

483 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

484 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

485 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

486 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	g·r£dMes§ge
 = 
nuÎ
;

487 
	gŒy
 {

488 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

489 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

490 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
è
e
.
g‘UnfšishedMes§ge
();

491 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

492 } 
	gfš®ly
 {

493 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

494 
m”geFrom
(
·r£dMes§ge
);

497  
	gthis
;

499 
´iv©e
 
	gb™F›ld0_
;

501 
´iv©e
 
boŞ—n
 
	g£cÚd¬yKey_
 ;

509 
public
 
boŞ—n
 
hasSecÚd¬yKey
() {

510  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

519 
public
 
boŞ—n
 
g‘SecÚd¬yKey
() {

520  
	g£cÚd¬yKey_
;

529 
public
 
Bud”
 
£tSecÚd¬yKey
(
boŞ—n
 
v®ue
) {

530 
	gb™F›ld0_
 |= 0x00000001;

531 
	g£cÚd¬yKey_
 = 
v®ue
;

532 
ÚChªged
();

533  
	gthis
;

542 
public
 
Bud”
 
ş—rSecÚd¬yKey
() {

543 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

544 
	g£cÚd¬yKey_
 = 
çl£
;

545 
ÚChªged
();

546  
	gthis
;

549 
´iv©e
 
boŞ—n
 
	gv”siÚ_
 ;

557 
public
 
boŞ—n
 
hasV”siÚ
() {

558  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

567 
public
 
boŞ—n
 
g‘V”siÚ
() {

568  
	gv”siÚ_
;

577 
public
 
Bud”
 
£tV”siÚ
(
boŞ—n
 
v®ue
) {

578 
	gb™F›ld0_
 |= 0x00000002;

579 
	gv”siÚ_
 = 
v®ue
;

580 
ÚChªged
();

581  
	gthis
;

590 
public
 
Bud”
 
ş—rV”siÚ
() {

591 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

592 
	gv”siÚ_
 = 
çl£
;

593 
ÚChªged
();

594  
	gthis
;

596 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

597 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

598  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

601 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

602 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

603  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

611 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	gDEFAULT_INSTANCE
;

613 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
();

616 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
g‘DeçuÉIn¡ªû
() {

617  
	gDEFAULT_INSTANCE
;

620 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gSchemaO±iÚs
>

621 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
SchemaO±iÚs
>() {

622 
public
 
SchemaO±iÚs
 
·r£P¬tŸlFrom
(

623 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

624 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

625 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

626  
Ãw
 
SchemaO±iÚs
(
šput
, 
ex‹nsiÚRegi¡ry
);

630 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gSchemaO±iÚs
> 
·r£r
() {

631  
	gPARSER
;

634 @
	gjava
.
	gÏng
.
Ov”ride


635 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gSchemaO±iÚs
> 
g‘P¬£rFÜTy³
() {

636  
	gPARSER
;

639 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

640  
	gDEFAULT_INSTANCE
;

645 
public
 
fš®
 
	gSCHEMA_FIELD_NUMBER
 = 1036;

653 
public
 
fš®


654 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§ge
.
	gG’”©edEx‹nsiÚ
<

655 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gF›ldO±iÚs
,

656 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
> 
	gschema
 = 
com
.
googË
.
´Ùobuf
.
G’”©edMes§ge


657 .
ÃwFeScİedG’”©edEx‹nsiÚ
(

658 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
şass
,

659 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
g‘DeçuÉIn¡ªû
());

660 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


661 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

662 
´iv©e
 
fš®


663 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


664 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË
;

666 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


667 
	$g‘DesütÜ
() {

668  
desütÜ
;

669 
	}
}

670 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


671 
	gdesütÜ
;

673 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

681 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

682 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

683 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

684 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

685 
desütÜ
 = 
roÙ
;

686  
	gnuÎ
;

689 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


690 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

691 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

692 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
g‘DesütÜ
(),

693 }, 
assigÃr
);

694 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
 =

695 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

696 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË
 = 
Ãw


697 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

698 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
,

699 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "SecondaryKey", "Version", });

700 
	gschema
.
š‹º®In™
(
desütÜ
.
g‘Ex‹nsiÚs
().
g‘
(0));

701 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
g‘DesütÜ
();

	@runtime/target/generated-sources/org/corfudb/runtime/CorfuStoreMetadata.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

6 
public
 
fš®
 cÏs 
	cCÜfuStÜeM‘ad©a
 {

7 
´iv©e
 
	$CÜfuStÜeM‘ad©a
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
Time¡ampOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
g‘Epoch
();

29 
g‘Sequ’û
();

38 
public
 
fš®
 
şass
 
Time¡amp
 
ex‹nds


39 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


41 
	gTime¡ampOrBud”
 {

43 
´iv©e
 
Time¡amp
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

44 
su³r
(
bud”
);

46 
´iv©e
 
Time¡amp
() {

47 
	g•och_
 = 0L;

48 
	g£qu’û_
 = 0L;

51 @
	gjava
.
	gÏng
.
Ov”ride


52 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


53 
g‘UnknownF›lds
() {

54  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

56 
´iv©e
 
Time¡amp
(

57 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

58 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

59 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

60 
this
();

61 
	gmubË_b™F›ld0_
 = 0;

62 
	gŒy
 {

63 
boŞ—n
 
	gdÚe
 = 
çl£
;

64 !
	gdÚe
) {

65 
	gg
 = 
šput
.
»adTag
();

66 
	gg
) {

68 
dÚe
 = 
Œue
;

71 ià(!
šput
.
skF›ld
(
g
)) {

72 
dÚe
 = 
Œue
;

78 
•och_
 = 
šput
.
»adIÁ64
();

83 
£qu’û_
 = 
šput
.
»adIÁ64
();

88 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

89 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

90 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

91 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

92 
e
).
£tUnfšishedMes§ge
(
this
);

93 } 
	gfš®ly
 {

94 
makeEx‹nsiÚsImmubË
();

97 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


98 
g‘DesütÜ
() {

99  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

102 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


103 
š‹º®G‘F›ldAcûssÜTabË
() {

104  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË


105 .
’su»F›ldAcûssÜsIn™Ÿlized
(

106 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.Time¡amp.
Bud”
.class);

109 
public
 
fš®
 
	gEPOCH_FIELD_NUMBER
 = 1;

110 
´iv©e
 
	g•och_
;

114 
public
 
g‘Epoch
() {

115  
	g•och_
;

118 
public
 
fš®
 
	gSEQUENCE_FIELD_NUMBER
 = 2;

119 
´iv©e
 
	g£qu’û_
;

123 
public
 
g‘Sequ’û
() {

124  
	g£qu’û_
;

127 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

128 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

129 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

130 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

131 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

133 
	gmemoizedIsIn™Ÿlized
 = 1;

134  
	gŒue
;

137 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

138 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

139 ià(
	g•och_
 != 0L) {

140 
ouut
.
wr™eIÁ64
(1, 
•och_
);

142 ià(
	g£qu’û_
 != 0L) {

143 
ouut
.
wr™eIÁ64
(2, 
£qu’û_
);

147 
public
 
g‘S”ŸlizedSize
() {

148 
	gsize
 = 
memoizedSize
;

149 ià(
	gsize
 !ğ-1è 
size
;

151 
	gsize
 = 0;

152 ià(
	g•och_
 != 0L) {

153 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


154 .
compu‹IÁ64Size
(1, 
•och_
);

156 ià(
	g£qu’û_
 != 0L) {

157 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


158 .
compu‹IÁ64Size
(2, 
£qu’û_
);

160 
	gmemoizedSize
 = 
size
;

161  
	gsize
;

164 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

165 @
	gjava
.
	gÏng
.
Ov”ride


166 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

167 ià(
	gobj
 =ğ
this
) {

168  
Œue
;

170 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
)) {

171  
	gsu³r
.
equ®s
(
obj
);

173 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.Time¡ampè
obj
;

175 
boŞ—n
 
	g»suÉ
 = 
Œue
;

176 
	g»suÉ
 = 
»suÉ
 && (
g‘Epoch
()

177 =ğ
Ùh”
.
g‘Epoch
());

178 
	g»suÉ
 = 
»suÉ
 && (
g‘Sequ’û
()

179 =ğ
Ùh”
.
g‘Sequ’û
());

180  
	g»suÉ
;

183 @
	gjava
.
	gÏng
.
Ov”ride


184 
public
 
hashCode
() {

185 ià(
	gmemoizedHashCode
 != 0) {

186  
memoizedHashCode
;

188 
	ghash
 = 41;

189 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

190 
	ghash
 = (37 * 
hash
è+ 
EPOCH_FIELD_NUMBER
;

191 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

192 
g‘Epoch
());

193 
	ghash
 = (37 * 
hash
è+ 
SEQUENCE_FIELD_NUMBER
;

194 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

195 
g‘Sequ’û
());

196 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

197 
	gmemoizedHashCode
 = 
hash
;

198  
	ghash
;

201 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

202 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

203 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

204  
	gPARSER
.
·r£From
(
d©a
);

206 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

207 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

208 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

209 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

210  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

212 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(
by‹
[] 
d©a
)

213 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

214  
	gPARSER
.
·r£From
(
d©a
);

216 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

217 
by‹
[] 
d©a
,

218 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

219 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

220  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

222 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

223 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

224  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


225 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

227 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

228 
java
.
io
.
IÅutSŒ—m
 
šput
,

229 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

230 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

231  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


232 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

234 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

235 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

236  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


237 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

239 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£D–im™edFrom
(

240 
java
.
io
.
IÅutSŒ—m
 
šput
,

241 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

242 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

243  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


244 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

246 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

247 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

248 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

249  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


250 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

252 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

253 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

254 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

255 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

256  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


257 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

260 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

261 
public
 
Bud”
 
ÃwBud”
() {

262  
	gDEFAULT_INSTANCE
.
toBud”
();

264 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
 
´ÙÙy³
) {

265  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

267 
public
 
Bud”
 
toBud”
() {

268  
	gthis
 =ğ
DEFAULT_INSTANCE


269 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

272 @
	gjava
.
	gÏng
.
Ov”ride


273 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

274 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

275 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

276  
	gbud”
;

285 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


286 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


288 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡ampOrBud”
 {

289 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


290 
g‘DesütÜ
() {

291  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

294 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


295 
š‹º®G‘F›ldAcûssÜTabË
() {

296  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË


297 .
’su»F›ldAcûssÜsIn™Ÿlized
(

298 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.Time¡amp.
Bud”
.class);

302 
´iv©e
 
Bud”
() {

303 
maybeFÜûBud”In™Ÿliz©iÚ
();

306 
´iv©e
 
Bud”
(

307 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

308 
su³r
(
·»Á
);

309 
maybeFÜûBud”In™Ÿliz©iÚ
();

311 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

312 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


313 .
	g®waysU£F›ldBud”s
) {

316 
public
 
Bud”
 
ş—r
() {

317 
	gsu³r
.
ş—r
();

318 
	g•och_
 = 0L;

320 
	g£qu’û_
 = 0L;

322  
	gthis
;

325 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


326 
g‘DesütÜFÜTy³
() {

327  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

330 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
g‘DeçuÉIn¡ªûFÜTy³
() {

331  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
.
g‘DeçuÉIn¡ªû
();

334 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
bud
() {

335 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	g»suÉ
 = 
budP¬tŸl
();

336 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

337 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

339  
	g»suÉ
;

342 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
budP¬tŸl
() {

343 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.Time¡amp(
this
);

344 
	g»suÉ
.
	g•och_
 = 
•och_
;

345 
	g»suÉ
.
	g£qu’û_
 = 
£qu’û_
;

346 
ÚBut
();

347  
	g»suÉ
;

350 
public
 
Bud”
 
şÚe
() {

351  (
	gBud”
è
	gsu³r
.
şÚe
();

353 
public
 
Bud”
 
£tF›ld
(

354 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

355 
Objeù
 
v®ue
) {

356  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

358 
public
 
Bud”
 
ş—rF›ld
(

359 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

360  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

362 
public
 
Bud”
 
ş—rOÃof
(

363 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

364  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

366 
public
 
Bud”
 
£tR•—‹dF›ld
(

367 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

368 
šdex
, 
Objeù
 
v®ue
) {

369  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

371 
public
 
Bud”
 
addR•—‹dF›ld
(

372 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

373 
Objeù
 
v®ue
) {

374  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

376 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

377 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
) {

378  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
)
Ùh”
);

380 
	gsu³r
.
m”geFrom
(
Ùh”
);

381  
	gthis
;

385 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
 
Ùh”
) {

386 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
.
g‘DeçuÉIn¡ªû
()è 
this
;

387 ià(
	gÙh”
.
g‘Epoch
() != 0L) {

388 
£tEpoch
(
Ùh”
.
g‘Epoch
());

390 ià(
	gÙh”
.
g‘Sequ’û
() != 0L) {

391 
£tSequ’û
(
Ùh”
.
g‘Sequ’û
());

393 
ÚChªged
();

394  
	gthis
;

397 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

398  
	gŒue
;

401 
public
 
Bud”
 
m”geFrom
(

402 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

403 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

404 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

405 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	g·r£dMes§ge
 = 
nuÎ
;

406 
	gŒy
 {

407 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

408 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

409 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
è
e
.
g‘UnfšishedMes§ge
();

410 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

411 } 
	gfš®ly
 {

412 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

413 
m”geFrom
(
·r£dMes§ge
);

416  
	gthis
;

419 
´iv©e
 
	g•och_
 ;

423 
public
 
g‘Epoch
() {

424  
	g•och_
;

429 
public
 
Bud”
 
£tEpoch
(
v®ue
) {

431 
	g•och_
 = 
v®ue
;

432 
ÚChªged
();

433  
	gthis
;

438 
public
 
Bud”
 
ş—rEpoch
() {

440 
	g•och_
 = 0L;

441 
ÚChªged
();

442  
	gthis
;

445 
´iv©e
 
	g£qu’û_
 ;

449 
public
 
g‘Sequ’û
() {

450  
	g£qu’û_
;

455 
public
 
Bud”
 
£tSequ’û
(
v®ue
) {

457 
	g£qu’û_
 = 
v®ue
;

458 
ÚChªged
();

459  
	gthis
;

464 
public
 
Bud”
 
ş—rSequ’û
() {

466 
	g£qu’û_
 = 0L;

467 
ÚChªged
();

468  
	gthis
;

470 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

471 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

472  
	gthis
;

475 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

476 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

477  
	gthis
;

485 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	gDEFAULT_INSTANCE
;

487 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
();

490 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
g‘DeçuÉIn¡ªû
() {

491  
	gDEFAULT_INSTANCE
;

494 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTime¡amp
>

495 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Time¡amp
>() {

496 
public
 
Time¡amp
 
·r£P¬tŸlFrom
(

497 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

498 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

499 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

500  
Ãw
 
Time¡amp
(
šput
, 
ex‹nsiÚRegi¡ry
);

504 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTime¡amp
> 
·r£r
() {

505  
	gPARSER
;

508 @
	gjava
.
	gÏng
.
Ov”ride


509 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTime¡amp
> 
g‘P¬£rFÜTy³
() {

510  
	gPARSER
;

513 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
g‘DeçuÉIn¡ªûFÜTy³
() {

514  
	gDEFAULT_INSTANCE
;

519 
public
 
š‹rçû
 
TabËNameOrBud”
 
ex‹nds


521 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

526 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name¥aû
();

530 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


531 
g‘Name¥aûBy‹s
();

536 
	gjava
.
	gÏng
.
SŒšg
 
g‘TabËName
();

540 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


541 
g‘TabËNameBy‹s
();

550 
public
 
fš®
 
şass
 
TabËName
 
ex‹nds


551 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


553 
	gTabËNameOrBud”
 {

555 
´iv©e
 
TabËName
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

556 
su³r
(
bud”
);

558 
´iv©e
 
TabËName
() {

559 
	gÇme¥aû_
 = "";

560 
	gbËName_
 = "";

563 @
	gjava
.
	gÏng
.
Ov”ride


564 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


565 
g‘UnknownF›lds
() {

566  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

568 
´iv©e
 
TabËName
(

569 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

570 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

571 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

572 
this
();

573 
	gmubË_b™F›ld0_
 = 0;

574 
	gŒy
 {

575 
boŞ—n
 
	gdÚe
 = 
çl£
;

576 !
	gdÚe
) {

577 
	gg
 = 
šput
.
»adTag
();

578 
	gg
) {

580 
dÚe
 = 
Œue
;

583 ià(!
šput
.
skF›ld
(
g
)) {

584 
dÚe
 = 
Œue
;

589 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

591 
	gÇme¥aû_
 = 
s
;

595 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

597 
	gbËName_
 = 
s
;

602 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

603 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

604 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

605 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

606 
e
).
£tUnfšishedMes§ge
(
this
);

607 } 
	gfš®ly
 {

608 
makeEx‹nsiÚsImmubË
();

611 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


612 
g‘DesütÜ
() {

613  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

616 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


617 
š‹º®G‘F›ldAcûssÜTabË
() {

618  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË


619 .
’su»F›ldAcûssÜsIn™Ÿlized
(

620 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
Bud”
.class);

623 
public
 
fš®
 
	gNAMESPACE_FIELD_NUMBER
 = 1;

624 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gÇme¥aû_
;

628 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name¥aû
() {

629 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

630 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

631  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

633 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

634 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

635 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

636 
	gÇme¥aû_
 = 
s
;

637  
	gs
;

643 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


644 
g‘Name¥aûBy‹s
() {

645 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

646 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

647 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

648 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

649 (
java
.
Ïng
.
SŒšg
è
»f
);

650 
	gÇme¥aû_
 = 
b
;

651  
	gb
;

653  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

657 
public
 
fš®
 
	gTABLE_NAME_FIELD_NUMBER
 = 2;

658 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gbËName_
;

662 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘TabËName
() {

663 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

664 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

665  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

667 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

668 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

669 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

670 
	gbËName_
 = 
s
;

671  
	gs
;

677 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


678 
g‘TabËNameBy‹s
() {

679 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

680 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

681 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

682 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

683 (
java
.
Ïng
.
SŒšg
è
»f
);

684 
	gbËName_
 = 
b
;

685  
	gb
;

687  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

691 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

692 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

693 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

694 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

695 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

697 
	gmemoizedIsIn™Ÿlized
 = 1;

698  
	gŒue
;

701 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

702 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

703 ià(!
g‘Name¥aûBy‹s
().
isEm±y
()) {

704 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
Çme¥aû_
);

706 ià(!
g‘TabËNameBy‹s
().
isEm±y
()) {

707 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
bËName_
);

711 
public
 
g‘S”ŸlizedSize
() {

712 
	gsize
 = 
memoizedSize
;

713 ià(
	gsize
 !ğ-1è 
size
;

715 
	gsize
 = 0;

716 ià(!
g‘Name¥aûBy‹s
().
isEm±y
()) {

717 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
Çme¥aû_
);

719 ià(!
g‘TabËNameBy‹s
().
isEm±y
()) {

720 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
bËName_
);

722 
	gmemoizedSize
 = 
size
;

723  
	gsize
;

726 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

727 @
	gjava
.
	gÏng
.
Ov”ride


728 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

729 ià(
	gobj
 =ğ
this
) {

730  
Œue
;

732 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
)) {

733  
	gsu³r
.
equ®s
(
obj
);

735 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËNameè
obj
;

737 
boŞ—n
 
	g»suÉ
 = 
Œue
;

738 
	g»suÉ
 = 
»suÉ
 && 
g‘Name¥aû
()

739 .
equ®s
(
Ùh”
.
g‘Name¥aû
());

740 
	g»suÉ
 = 
»suÉ
 && 
g‘TabËName
()

741 .
equ®s
(
Ùh”
.
g‘TabËName
());

742  
	g»suÉ
;

745 @
	gjava
.
	gÏng
.
Ov”ride


746 
public
 
hashCode
() {

747 ià(
	gmemoizedHashCode
 != 0) {

748  
memoizedHashCode
;

750 
	ghash
 = 41;

751 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

752 
	ghash
 = (37 * 
hash
è+ 
NAMESPACE_FIELD_NUMBER
;

753 
	ghash
 = (53 * 
hash
è+ 
g‘Name¥aû
().
hashCode
();

754 
	ghash
 = (37 * 
hash
è+ 
TABLE_NAME_FIELD_NUMBER
;

755 
	ghash
 = (53 * 
hash
è+ 
g‘TabËName
().
hashCode
();

756 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

757 
	gmemoizedHashCode
 = 
hash
;

758  
	ghash
;

761 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

762 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

763 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

764  
	gPARSER
.
·r£From
(
d©a
);

766 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

767 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

768 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

769 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

770  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

772 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(
by‹
[] 
d©a
)

773 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

774  
	gPARSER
.
·r£From
(
d©a
);

776 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

777 
by‹
[] 
d©a
,

778 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

779 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

780  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

782 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

783 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

784  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


785 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

787 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

788 
java
.
io
.
IÅutSŒ—m
 
šput
,

789 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

790 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

791  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


792 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

794 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

795 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

796  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


797 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

799 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£D–im™edFrom
(

800 
java
.
io
.
IÅutSŒ—m
 
šput
,

801 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

802 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

803  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


804 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

806 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

807 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

808 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

809  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


810 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

812 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

813 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

814 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

815 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

816  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


817 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

820 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

821 
public
 
Bud”
 
ÃwBud”
() {

822  
	gDEFAULT_INSTANCE
.
toBud”
();

824 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
´ÙÙy³
) {

825  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

827 
public
 
Bud”
 
toBud”
() {

828  
	gthis
 =ğ
DEFAULT_INSTANCE


829 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

832 @
	gjava
.
	gÏng
.
Ov”ride


833 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

834 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

835 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

836  
	gbud”
;

845 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


846 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


848 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËNameOrBud”
 {

849 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


850 
g‘DesütÜ
() {

851  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

854 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


855 
š‹º®G‘F›ldAcûssÜTabË
() {

856  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË


857 .
’su»F›ldAcûssÜsIn™Ÿlized
(

858 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
Bud”
.class);

862 
´iv©e
 
Bud”
() {

863 
maybeFÜûBud”In™Ÿliz©iÚ
();

866 
´iv©e
 
Bud”
(

867 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

868 
su³r
(
·»Á
);

869 
maybeFÜûBud”In™Ÿliz©iÚ
();

871 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

872 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


873 .
	g®waysU£F›ldBud”s
) {

876 
public
 
Bud”
 
ş—r
() {

877 
	gsu³r
.
ş—r
();

878 
	gÇme¥aû_
 = "";

880 
	gbËName_
 = "";

882  
	gthis
;

885 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


886 
g‘DesütÜFÜTy³
() {

887  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

890 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘DeçuÉIn¡ªûFÜTy³
() {

891  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
.
g‘DeçuÉIn¡ªû
();

894 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
bud
() {

895 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	g»suÉ
 = 
budP¬tŸl
();

896 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

897 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

899  
	g»suÉ
;

902 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
budP¬tŸl
() {

903 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËName(
this
);

904 
	g»suÉ
.
	gÇme¥aû_
 = 
Çme¥aû_
;

905 
	g»suÉ
.
	gbËName_
 = 
bËName_
;

906 
ÚBut
();

907  
	g»suÉ
;

910 
public
 
Bud”
 
şÚe
() {

911  (
	gBud”
è
	gsu³r
.
şÚe
();

913 
public
 
Bud”
 
£tF›ld
(

914 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

915 
Objeù
 
v®ue
) {

916  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

918 
public
 
Bud”
 
ş—rF›ld
(

919 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

920  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

922 
public
 
Bud”
 
ş—rOÃof
(

923 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

924  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

926 
public
 
Bud”
 
£tR•—‹dF›ld
(

927 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

928 
šdex
, 
Objeù
 
v®ue
) {

929  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

931 
public
 
Bud”
 
addR•—‹dF›ld
(

932 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

933 
Objeù
 
v®ue
) {

934  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

936 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

937 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
) {

938  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
)
Ùh”
);

940 
	gsu³r
.
m”geFrom
(
Ùh”
);

941  
	gthis
;

945 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
Ùh”
) {

946 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
()è 
this
;

947 ià(!
	gÙh”
.
g‘Name¥aû
().
isEm±y
()) {

948 
	gÇme¥aû_
 = 
Ùh”
.
Çme¥aû_
;

949 
ÚChªged
();

951 ià(!
	gÙh”
.
g‘TabËName
().
isEm±y
()) {

952 
	gbËName_
 = 
Ùh”
.
bËName_
;

953 
ÚChªged
();

955 
ÚChªged
();

956  
	gthis
;

959 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

960  
	gŒue
;

963 
public
 
Bud”
 
m”geFrom
(

964 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

965 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

966 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

967 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	g·r£dMes§ge
 = 
nuÎ
;

968 
	gŒy
 {

969 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

970 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

971 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
è
e
.
g‘UnfšishedMes§ge
();

972 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

973 } 
	gfš®ly
 {

974 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

975 
m”geFrom
(
·r£dMes§ge
);

978  
	gthis
;

981 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gÇme¥aû_
 = "";

985 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name¥aû
() {

986 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

987 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

988 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

989 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

990 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

991 
	gÇme¥aû_
 = 
s
;

992  
	gs
;

994  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1000 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1001 
g‘Name¥aûBy‹s
() {

1002 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

1003 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1004 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1005 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1006 (
java
.
Ïng
.
SŒšg
è
»f
);

1007 
	gÇme¥aû_
 = 
b
;

1008  
	gb
;

1010  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1016 
public
 
Bud”
 
£tName¥aû
(

1017 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1018 ià(
	gv®ue
 =ğ
nuÎ
) {

1019 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1022 
	gÇme¥aû_
 = 
v®ue
;

1023 
ÚChªged
();

1024  
	gthis
;

1029 
public
 
Bud”
 
ş—rName¥aû
() {

1031 
	gÇme¥aû_
 = 
g‘DeçuÉIn¡ªû
().
g‘Name¥aû
();

1032 
ÚChªged
();

1033  
	gthis
;

1038 
public
 
Bud”
 
£tName¥aûBy‹s
(

1039 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1040 ià(
	gv®ue
 =ğ
nuÎ
) {

1041 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1043 
checkBy‹SŒšgIsUtf8
(
v®ue
);

1045 
	gÇme¥aû_
 = 
v®ue
;

1046 
ÚChªged
();

1047  
	gthis
;

1050 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gbËName_
 = "";

1054 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘TabËName
() {

1055 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

1056 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

1057 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1058 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1059 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1060 
	gbËName_
 = 
s
;

1061  
	gs
;

1063  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1069 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1070 
g‘TabËNameBy‹s
() {

1071 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

1072 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1073 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1074 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1075 (
java
.
Ïng
.
SŒšg
è
»f
);

1076 
	gbËName_
 = 
b
;

1077  
	gb
;

1079  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1085 
public
 
Bud”
 
£tTabËName
(

1086 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1087 ià(
	gv®ue
 =ğ
nuÎ
) {

1088 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1091 
	gbËName_
 = 
v®ue
;

1092 
ÚChªged
();

1093  
	gthis
;

1098 
public
 
Bud”
 
ş—rTabËName
() {

1100 
	gbËName_
 = 
g‘DeçuÉIn¡ªû
().
g‘TabËName
();

1101 
ÚChªged
();

1102  
	gthis
;

1107 
public
 
Bud”
 
£tTabËNameBy‹s
(

1108 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1109 ià(
	gv®ue
 =ğ
nuÎ
) {

1110 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1112 
checkBy‹SŒšgIsUtf8
(
v®ue
);

1114 
	gbËName_
 = 
v®ue
;

1115 
ÚChªged
();

1116  
	gthis
;

1118 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1119 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1120  
	gthis
;

1123 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1124 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1125  
	gthis
;

1133 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gDEFAULT_INSTANCE
;

1135 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
();

1138 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘DeçuÉIn¡ªû
() {

1139  
	gDEFAULT_INSTANCE
;

1142 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËName
>

1143 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TabËName
>() {

1144 
public
 
TabËName
 
·r£P¬tŸlFrom
(

1145 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1146 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1147 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1148  
Ãw
 
TabËName
(
šput
, 
ex‹nsiÚRegi¡ry
);

1152 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËName
> 
·r£r
() {

1153  
	gPARSER
;

1156 @
	gjava
.
	gÏng
.
Ov”ride


1157 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËName
> 
g‘P¬£rFÜTy³
() {

1158  
	gPARSER
;

1161 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1162  
	gDEFAULT_INSTANCE
;

1167 
public
 
š‹rçû
 
TabËDesütÜsOrBud”
 
ex‹nds


1169 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1179 
g‘FeDesütÜsCouÁ
();

1188 
boŞ—n
 
cÚšsFeDesütÜs
(

1189 
java
.
Ïng
.
SŒšg
 
key
);

1193 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1194 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1195 
g‘FeDesütÜs
();

1204 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1205 
g‘FeDesütÜsM­
();

1215 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrDeçuÉ
(

1216 
java
.
Ïng
.
SŒšg
 
key
,

1217 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
deçuÉV®ue
);

1227 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrThrow
(

1228 
java
.
Ïng
.
SŒšg
 
key
);

1237 
public
 
fš®
 
şass
 
TabËDesütÜs
 
ex‹nds


1238 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1240 
	gTabËDesütÜsOrBud”
 {

1242 
´iv©e
 
TabËDesütÜs
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1243 
su³r
(
bud”
);

1245 
´iv©e
 
TabËDesütÜs
() {

1248 @
	gjava
.
	gÏng
.
Ov”ride


1249 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1250 
g‘UnknownF›lds
() {

1251  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

1253 
´iv©e
 
TabËDesütÜs
(

1254 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1255 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1256 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1257 
this
();

1258 
	gmubË_b™F›ld0_
 = 0;

1259 
	gŒy
 {

1260 
boŞ—n
 
	gdÚe
 = 
çl£
;

1261 !
	gdÚe
) {

1262 
	gg
 = 
šput
.
»adTag
();

1263 
	gg
) {

1265 
dÚe
 = 
Œue
;

1268 ià(!
šput
.
skF›ld
(
g
)) {

1269 
dÚe
 = 
Œue
;

1274 ià(!((
mubË_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

1275 
feDesütÜs_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

1276 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1277 
	gmubË_b™F›ld0_
 |= 0x00000001;

1279 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1280 
	gfeDesütÜs__
 = 
šput
.
»adMes§ge
(

1281 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
g‘P¬£rFÜTy³
(), 
ex‹nsiÚRegi¡ry
);

1282 
	gfeDesütÜs_
.
g‘MubËM­
().
put
(

1283 
feDesütÜs__
.
g‘Key
(), feDesütÜs__.
g‘V®ue
());

1288 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1289 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

1290 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

1291 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

1292 
e
).
£tUnfšishedMes§ge
(
this
);

1293 } 
	gfš®ly
 {

1294 
makeEx‹nsiÚsImmubË
();

1297 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1298 
g‘DesütÜ
() {

1299  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

1302 @
Suµ»ssW¬nšgs
({"rawtypes"})

1303 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘M­F›ld
(

1304 
numb”
) {

1305 
	gnumb”
) {

1307  
š‹º®G‘FeDesütÜs
();

1309 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1310 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1313 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1314 
š‹º®G‘F›ldAcûssÜTabË
() {

1315  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË


1316 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1317 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËDesütÜs.
Bud”
.class);

1320 
public
 
fš®
 
	gFILEDESCRIPTORS_FIELD_NUMBER
 = 1;

1321 
´iv©e
 
fš®
 cÏs 
	cFeDesütÜsDeçuÉEÁryHŞd”
 {

1322 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<

1323 
	gjava
.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gdeçuÉEÁry
 =

1324 
com
.
googË
.
´Ùobuf
.
M­EÁry


1325 .<
java
.
Ïng
.
SŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>
ÃwDeçuÉIn¡ªû
(

1326 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
,

1327 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
STRING
,

1329 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
MESSAGE
,

1330 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
.
g‘DeçuÉIn¡ªû
());

1332 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

1333 
	gjava
.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gfeDesütÜs_
;

1334 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1335 
š‹º®G‘FeDesütÜs
() {

1336 ià(
	gfeDesütÜs_
 =ğ
nuÎ
) {

1337  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

1338 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1340  
	gfeDesütÜs_
;

1343 
public
 
g‘FeDesütÜsCouÁ
() {

1344  
š‹º®G‘FeDesütÜs
().
g‘M­
().
size
();

1355 
public
 
boŞ—n
 
cÚšsFeDesütÜs
(

1356 
java
.
Ïng
.
SŒšg
 
key
) {

1357 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1358  
š‹º®G‘FeDesütÜs
().
g‘M­
().
cÚšsKey
(
key
);

1363 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1364 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜs
() {

1365  
g‘FeDesütÜsM­
();

1376 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜsM­
() {

1377  
š‹º®G‘FeDesütÜs
().
g‘M­
();

1388 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrDeçuÉ
(

1389 
java
.
Ïng
.
SŒšg
 
key
,

1390 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
deçuÉV®ue
) {

1391 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1392 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1393 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1394  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

1405 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrThrow
(

1406 
java
.
Ïng
.
SŒšg
 
key
) {

1407 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1408 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1409 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1410 ià(!
	gm­
.
cÚšsKey
(
key
)) {

1411 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

1413  
	gm­
.
g‘
(
key
);

1416 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

1417 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1418 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

1419 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

1420 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

1422 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
	g™em
 : 
g‘FeDesütÜsM­
().
v®ues
()) {

1423 ià(!
™em
.
isIn™Ÿlized
()) {

1424 
memoizedIsIn™Ÿlized
 = 0;

1425  
	gçl£
;

1428 
	gmemoizedIsIn™Ÿlized
 = 1;

1429  
	gŒue
;

1432 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

1433 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1434 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1435 .
£rŸlizeSŒšgM­To
(

1436 
ouut
,

1437 
š‹º®G‘FeDesütÜs
(),

1438 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
,

1442 
public
 
g‘S”ŸlizedSize
() {

1443 
	gsize
 = 
memoizedSize
;

1444 ià(
	gsize
 !ğ-1è 
size
;

1446 
	gsize
 = 0;

1447 
	gjava
.
	gut
.
	gM­
.
	gEÁry
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	g’Œy


1448 : 
š‹º®G‘FeDesütÜs
().
g‘M­
().
’ŒyS‘
()) {

1449 
com
.
googË
.
´Ùobuf
.
M­EÁry
<
java
.
Ïng
.
SŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1450 
	gfeDesütÜs__
 = 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
ÃwBud”FÜTy³
()

1451 .
£tKey
(
’Œy
.
g‘Key
())

1452 .
£tV®ue
(
’Œy
.
g‘V®ue
())

1453 .
bud
();

1454 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1455 .
compu‹Mes§geSize
(1, 
feDesütÜs__
);

1457 
	gmemoizedSize
 = 
size
;

1458  
	gsize
;

1461 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

1462 @
	gjava
.
	gÏng
.
Ov”ride


1463 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

1464 ià(
	gobj
 =ğ
this
) {

1465  
Œue
;

1467 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
)) {

1468  
	gsu³r
.
equ®s
(
obj
);

1470 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËDesütÜsè
obj
;

1472 
boŞ—n
 
	g»suÉ
 = 
Œue
;

1473 
	g»suÉ
 = 
»suÉ
 && 
š‹º®G‘FeDesütÜs
().
equ®s
(

1474 
Ùh”
.
š‹º®G‘FeDesütÜs
());

1475  
	g»suÉ
;

1478 @
	gjava
.
	gÏng
.
Ov”ride


1479 
public
 
hashCode
() {

1480 ià(
	gmemoizedHashCode
 != 0) {

1481  
memoizedHashCode
;

1483 
	ghash
 = 41;

1484 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

1485 ià(!
š‹º®G‘FeDesütÜs
().
g‘M­
().
isEm±y
()) {

1486 
	ghash
 = (37 * 
hash
è+ 
FILEDESCRIPTORS_FIELD_NUMBER
;

1487 
	ghash
 = (53 * 
hash
è+ 
š‹º®G‘FeDesütÜs
().
hashCode
();

1489 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

1490 
	gmemoizedHashCode
 = 
hash
;

1491  
	ghash
;

1494 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1495 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

1496 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1497  
	gPARSER
.
·r£From
(
d©a
);

1499 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1500 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

1501 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1502 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1503  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1505 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(
by‹
[] 
d©a
)

1506 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1507  
	gPARSER
.
·r£From
(
d©a
);

1509 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1510 
by‹
[] 
d©a
,

1511 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1512 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1513  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1515 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1516 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1517  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1518 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1520 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1521 
java
.
io
.
IÅutSŒ—m
 
šput
,

1522 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1523 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1524  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1525 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1527 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1528 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1529  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1530 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

1532 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£D–im™edFrom
(

1533 
java
.
io
.
IÅutSŒ—m
 
šput
,

1534 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1535 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1536  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1537 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1539 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1540 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

1541 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1542  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1543 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1545 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1546 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1547 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1548 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1549  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1550 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1553 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

1554 
public
 
Bud”
 
ÃwBud”
() {

1555  
	gDEFAULT_INSTANCE
.
toBud”
();

1557 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
´ÙÙy³
) {

1558  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

1560 
public
 
Bud”
 
toBud”
() {

1561  
	gthis
 =ğ
DEFAULT_INSTANCE


1562 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1565 @
	gjava
.
	gÏng
.
Ov”ride


1566 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1567 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1568 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1569  
	gbud”
;

1578 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1579 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1581 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜsOrBud”
 {

1582 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1583 
g‘DesütÜ
() {

1584  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

1587 @
Suµ»ssW¬nšgs
({"rawtypes"})

1588 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘M­F›ld
(

1589 
numb”
) {

1590 
	gnumb”
) {

1592  
š‹º®G‘FeDesütÜs
();

1594 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1595 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1598 @
Suµ»ssW¬nšgs
({"rawtypes"})

1599 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘MubËM­F›ld
(

1600 
numb”
) {

1601 
	gnumb”
) {

1603  
š‹º®G‘MubËFeDesütÜs
();

1605 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1606 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1609 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1610 
š‹º®G‘F›ldAcûssÜTabË
() {

1611  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË


1612 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1613 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËDesütÜs.
Bud”
.class);

1617 
´iv©e
 
Bud”
() {

1618 
maybeFÜûBud”In™Ÿliz©iÚ
();

1621 
´iv©e
 
Bud”
(

1622 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1623 
su³r
(
·»Á
);

1624 
maybeFÜûBud”In™Ÿliz©iÚ
();

1626 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1627 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1628 .
	g®waysU£F›ldBud”s
) {

1631 
public
 
Bud”
 
ş—r
() {

1632 
	gsu³r
.
ş—r
();

1633 
š‹º®G‘MubËFeDesütÜs
().
ş—r
();

1634  
	gthis
;

1637 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1638 
g‘DesütÜFÜTy³
() {

1639  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

1642 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1643  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
.
g‘DeçuÉIn¡ªû
();

1646 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
bud
() {

1647 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	g»suÉ
 = 
budP¬tŸl
();

1648 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1649 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1651  
	g»suÉ
;

1654 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
budP¬tŸl
() {

1655 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËDesütÜs(
this
);

1656 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

1657 
	g»suÉ
.
	gfeDesütÜs_
 = 
š‹º®G‘FeDesütÜs
();

1658 
	g»suÉ
.
	gfeDesütÜs_
.
makeImmubË
();

1659 
ÚBut
();

1660  
	g»suÉ
;

1663 
public
 
Bud”
 
şÚe
() {

1664  (
	gBud”
è
	gsu³r
.
şÚe
();

1666 
public
 
Bud”
 
£tF›ld
(

1667 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1668 
Objeù
 
v®ue
) {

1669  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1671 
public
 
Bud”
 
ş—rF›ld
(

1672 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1673  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1675 
public
 
Bud”
 
ş—rOÃof
(

1676 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1677  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1679 
public
 
Bud”
 
£tR•—‹dF›ld
(

1680 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1681 
šdex
, 
Objeù
 
v®ue
) {

1682  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1684 
public
 
Bud”
 
addR•—‹dF›ld
(

1685 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1686 
Objeù
 
v®ue
) {

1687  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1689 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1690 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
) {

1691  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
)
Ùh”
);

1693 
	gsu³r
.
m”geFrom
(
Ùh”
);

1694  
	gthis
;

1698 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
Ùh”
) {

1699 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
.
g‘DeçuÉIn¡ªû
()è 
this
;

1700 
š‹º®G‘MubËFeDesütÜs
().
m”geFrom
(

1701 
Ùh”
.
š‹º®G‘FeDesütÜs
());

1702 
ÚChªged
();

1703  
	gthis
;

1706 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1707 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
	g™em
 : 
g‘FeDesütÜsM­
().
v®ues
()) {

1708 ià(!
™em
.
isIn™Ÿlized
()) {

1709  
çl£
;

1712  
	gŒue
;

1715 
public
 
Bud”
 
m”geFrom
(

1716 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1717 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1718 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1719 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	g·r£dMes§ge
 = 
nuÎ
;

1720 
	gŒy
 {

1721 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1722 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1723 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
è
e
.
g‘UnfšishedMes§ge
();

1724 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1725 } 
	gfš®ly
 {

1726 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1727 
m”geFrom
(
·r£dMes§ge
);

1730  
	gthis
;

1732 
´iv©e
 
	gb™F›ld0_
;

1734 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

1735 
	gjava
.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gfeDesütÜs_
;

1736 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1737 
š‹º®G‘FeDesütÜs
() {

1738 ià(
	gfeDesütÜs_
 =ğ
nuÎ
) {

1739  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

1740 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1742  
	gfeDesütÜs_
;

1744 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1745 
š‹º®G‘MubËFeDesütÜs
() {

1746 
ÚChªged
();;

1747 ià(
	gfeDesütÜs_
 =ğ
nuÎ
) {

1748 
feDesütÜs_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

1749 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1751 ià(!
	gfeDesütÜs_
.
isMubË
()) {

1752 
	gfeDesütÜs_
 = 
feDesütÜs_
.
cİy
();

1754  
	gfeDesütÜs_
;

1757 
public
 
g‘FeDesütÜsCouÁ
() {

1758  
š‹º®G‘FeDesütÜs
().
g‘M­
().
size
();

1769 
public
 
boŞ—n
 
cÚšsFeDesütÜs
(

1770 
java
.
Ïng
.
SŒšg
 
key
) {

1771 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1772  
š‹º®G‘FeDesütÜs
().
g‘M­
().
cÚšsKey
(
key
);

1777 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1778 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜs
() {

1779  
g‘FeDesütÜsM­
();

1790 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜsM­
() {

1791  
š‹º®G‘FeDesütÜs
().
g‘M­
();

1802 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrDeçuÉ
(

1803 
java
.
Ïng
.
SŒšg
 
key
,

1804 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
deçuÉV®ue
) {

1805 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1806 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1807 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1808  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

1819 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrThrow
(

1820 
java
.
Ïng
.
SŒšg
 
key
) {

1821 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1822 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1823 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1824 ià(!
	gm­
.
cÚšsKey
(
key
)) {

1825 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

1827  
	gm­
.
g‘
(
key
);

1830 
public
 
Bud”
 
ş—rFeDesütÜs
() {

1831 
g‘MubËFeDesütÜs
().
ş—r
();

1832  
	gthis
;

1843 
public
 
Bud”
 
»moveFeDesütÜs
(

1844 
java
.
Ïng
.
SŒšg
 
key
) {

1845 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1846 
g‘MubËFeDesütÜs
().
»move
(
key
);

1847  
	gthis
;

1852 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1853 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1854 
g‘MubËFeDesütÜs
() {

1855  
š‹º®G‘MubËFeDesütÜs
().
g‘MubËM­
();

1865 
public
 
Bud”
 
putFeDesütÜs
(

1866 
java
.
Ïng
.
SŒšg
 
key
,

1867 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
v®ue
) {

1868 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1869 ià(
	gv®ue
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1870 
g‘MubËFeDesütÜs
().
put
(
key
, 
v®ue
);

1871  
	gthis
;

1882 
public
 
Bud”
 
putAÎFeDesütÜs
(

1883 
java
.
ut
.
M­
<java.
Ïng
.
SŒšg
, 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
> 
v®ues
) {

1884 
g‘MubËFeDesütÜs
().
putAÎ
(
v®ues
);

1885  
	gthis
;

1887 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1888 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1889  
	gthis
;

1892 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1893 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1894  
	gthis
;

1902 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	gDEFAULT_INSTANCE
;

1904 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
();

1907 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
g‘DeçuÉIn¡ªû
() {

1908  
	gDEFAULT_INSTANCE
;

1911 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËDesütÜs
>

1912 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TabËDesütÜs
>() {

1913 
public
 
TabËDesütÜs
 
·r£P¬tŸlFrom
(

1914 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1915 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1916 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1917  
Ãw
 
TabËDesütÜs
(
šput
, 
ex‹nsiÚRegi¡ry
);

1921 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËDesütÜs
> 
·r£r
() {

1922  
	gPARSER
;

1925 @
	gjava
.
	gÏng
.
Ov”ride


1926 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËDesütÜs
> 
g‘P¬£rFÜTy³
() {

1927  
	gPARSER
;

1930 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1931  
	gDEFAULT_INSTANCE
;

1936 
public
 
š‹rçû
 
TabËM‘ad©aOrBud”
 
ex‹nds


1938 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1943 
boŞ—n
 
hasTabËName
();

1947 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘TabËName
();

1951 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËNameOrBud”
 
g‘TabËNameOrBud”
();

1960 
boŞ—n
 
g‘DiskBa£d
();

1969 
boŞ—n
 
g‘Cache
();

1978 
public
 
fš®
 
şass
 
TabËM‘ad©a
 
ex‹nds


1979 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1981 
	gTabËM‘ad©aOrBud”
 {

1983 
´iv©e
 
TabËM‘ad©a
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1984 
su³r
(
bud”
);

1986 
´iv©e
 
TabËM‘ad©a
() {

1987 
	gdiskBa£d_
 = 
çl£
;

1988 
	gÿche_
 = 
çl£
;

1991 @
	gjava
.
	gÏng
.
Ov”ride


1992 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1993 
g‘UnknownF›lds
() {

1994  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

1996 
´iv©e
 
TabËM‘ad©a
(

1997 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1998 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1999 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2000 
this
();

2001 
	gmubË_b™F›ld0_
 = 0;

2002 
	gŒy
 {

2003 
boŞ—n
 
	gdÚe
 = 
çl£
;

2004 !
	gdÚe
) {

2005 
	gg
 = 
šput
.
»adTag
();

2006 
	gg
) {

2008 
dÚe
 = 
Œue
;

2011 ià(!
šput
.
skF›ld
(
g
)) {

2012 
dÚe
 = 
Œue
;

2017 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
Bud”
 
subBud”
 = 
nuÎ
;

2018 ià(
	gbËName_
 !ğ
nuÎ
) {

2019 
subBud”
 = 
bËName_
.
toBud”
();

2021 
	gbËName_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

2022 ià(
	gsubBud”
 !ğ
nuÎ
) {

2023 
subBud”
.
m”geFrom
(
bËName_
);

2024 
	gbËName_
 = 
subBud”
.
budP¬tŸl
();

2031 
diskBa£d_
 = 
šput
.
»adBoŞ
();

2036 
ÿche_
 = 
šput
.
»adBoŞ
();

2041 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2042 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

2043 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

2044 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

2045 
e
).
£tUnfšishedMes§ge
(
this
);

2046 } 
	gfš®ly
 {

2047 
makeEx‹nsiÚsImmubË
();

2050 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2051 
g‘DesütÜ
() {

2052  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

2055 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2056 
š‹º®G‘F›ldAcûssÜTabË
() {

2057  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË


2058 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2059 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËM‘ad©a.
Bud”
.class);

2062 
public
 
fš®
 
	gTABLE_NAME_FIELD_NUMBER
 = 1;

2063 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gbËName_
;

2067 
public
 
boŞ—n
 
hasTabËName
() {

2068  
	gbËName_
 !ğ
nuÎ
;

2073 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘TabËName
() {

2074  
	gbËName_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
(è: 
bËName_
;

2079 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËNameOrBud”
 
g‘TabËNameOrBud”
() {

2080  
g‘TabËName
();

2083 
public
 
fš®
 
	gDISK_BASED_FIELD_NUMBER
 = 2;

2084 
´iv©e
 
boŞ—n
 
	gdiskBa£d_
;

2092 
public
 
boŞ—n
 
g‘DiskBa£d
() {

2093  
	gdiskBa£d_
;

2096 
public
 
fš®
 
	gCACHE_FIELD_NUMBER
 = 3;

2097 
´iv©e
 
boŞ—n
 
	gÿche_
;

2105 
public
 
boŞ—n
 
g‘Cache
() {

2106  
	gÿche_
;

2109 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

2110 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2111 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

2112 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

2113 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

2115 
	gmemoizedIsIn™Ÿlized
 = 1;

2116  
	gŒue
;

2119 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

2120 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2121 ià(
	gbËName_
 !ğ
nuÎ
) {

2122 
ouut
.
wr™eMes§ge
(1, 
g‘TabËName
());

2124 ià(
	gdiskBa£d_
 !ğ
çl£
) {

2125 
ouut
.
wr™eBoŞ
(2, 
diskBa£d_
);

2127 ià(
	gÿche_
 !ğ
çl£
) {

2128 
ouut
.
wr™eBoŞ
(3, 
ÿche_
);

2132 
public
 
g‘S”ŸlizedSize
() {

2133 
	gsize
 = 
memoizedSize
;

2134 ià(
	gsize
 !ğ-1è 
size
;

2136 
	gsize
 = 0;

2137 ià(
	gbËName_
 !ğ
nuÎ
) {

2138 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2139 .
compu‹Mes§geSize
(1, 
g‘TabËName
());

2141 ià(
	gdiskBa£d_
 !ğ
çl£
) {

2142 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2143 .
compu‹BoŞSize
(2, 
diskBa£d_
);

2145 ià(
	gÿche_
 !ğ
çl£
) {

2146 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2147 .
compu‹BoŞSize
(3, 
ÿche_
);

2149 
	gmemoizedSize
 = 
size
;

2150  
	gsize
;

2153 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

2154 @
	gjava
.
	gÏng
.
Ov”ride


2155 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

2156 ià(
	gobj
 =ğ
this
) {

2157  
Œue
;

2159 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©a
)) {

2160  
	gsu³r
.
equ®s
(
obj
);

2162 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËM‘ad©aè
obj
;

2164 
boŞ—n
 
	g»suÉ
 = 
Œue
;

2165 
	g»suÉ
 = 
»suÉ
 && (
hasTabËName
(è=ğ
Ùh”
.hasTableName());

2166 ià(
hasTabËName
()) {

2167 
	g»suÉ
 = 
»suÉ
 && 
g‘TabËName
()

2168 .
equ®s
(
Ùh”
.
g‘TabËName
());

2170 
	g»suÉ
 = 
»suÉ
 && (
g‘DiskBa£d
()

2171 =ğ
Ùh”
.
g‘DiskBa£d
());

2172 
	g»suÉ
 = 
»suÉ
 && (
g‘Cache
()

2173 =ğ
Ùh”
.
g‘Cache
());

2174  
	g»suÉ
;

2177 @
	gjava
.
	gÏng
.
Ov”ride


2178 
public
 
hashCode
() {

2179 ià(
	gmemoizedHashCode
 != 0) {

2180  
memoizedHashCode
;

2182 
	ghash
 = 41;

2183 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

2184 ià(
hasTabËName
()) {

2185 
	ghash
 = (37 * 
hash
è+ 
TABLE_NAME_FIELD_NUMBER
;

2186 
	ghash
 = (53 * 
hash
è+ 
g‘TabËName
().
hashCode
();

2188 
	ghash
 = (37 * 
hash
è+ 
DISK_BASED_FIELD_NUMBER
;

2189 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

2190 
g‘DiskBa£d
());

2191 
	ghash
 = (37 * 
hash
è+ 
CACHE_FIELD_NUMBER
;

2192 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

2193 
g‘Cache
());

2194 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

2195 
	gmemoizedHashCode
 = 
hash
;

2196  
	ghash
;

2199 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2200 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

2201 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2202  
	gPARSER
.
·r£From
(
d©a
);

2204 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2205 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

2206 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2207 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2208  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2210 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(
by‹
[] 
d©a
)

2211 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2212  
	gPARSER
.
·r£From
(
d©a
);

2214 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2215 
by‹
[] 
d©a
,

2216 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2217 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2218  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2220 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2221 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2222  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2223 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2225 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2226 
java
.
io
.
IÅutSŒ—m
 
šput
,

2227 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2228 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2229  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2230 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2232 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2233 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2234  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2235 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

2237 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£D–im™edFrom
(

2238 
java
.
io
.
IÅutSŒ—m
 
šput
,

2239 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2240 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2241  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2242 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2244 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2245 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2246 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2247  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2248 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2250 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2251 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2252 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2253 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2254  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2255 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2258 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2259 
public
 
Bud”
 
ÃwBud”
() {

2260  
	gDEFAULT_INSTANCE
.
toBud”
();

2262 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
´ÙÙy³
) {

2263  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2265 
public
 
Bud”
 
toBud”
() {

2266  
	gthis
 =ğ
DEFAULT_INSTANCE


2267 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2270 @
	gjava
.
	gÏng
.
Ov”ride


2271 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2272 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2273 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2274  
	gbud”
;

2283 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


2284 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


2286 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©aOrBud”
 {

2287 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2288 
g‘DesütÜ
() {

2289  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

2292 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2293 
š‹º®G‘F›ldAcûssÜTabË
() {

2294  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË


2295 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2296 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËM‘ad©a.
Bud”
.class);

2300 
´iv©e
 
Bud”
() {

2301 
maybeFÜûBud”In™Ÿliz©iÚ
();

2304 
´iv©e
 
Bud”
(

2305 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2306 
su³r
(
·»Á
);

2307 
maybeFÜûBud”In™Ÿliz©iÚ
();

2309 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

2310 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2311 .
	g®waysU£F›ldBud”s
) {

2314 
public
 
Bud”
 
ş—r
() {

2315 
	gsu³r
.
ş—r
();

2316 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2317 
bËName_
 = 
nuÎ
;

2319 
	gbËName_
 = 
nuÎ
;

2320 
	gbËNameBud”_
 = 
nuÎ
;

2322 
	gdiskBa£d_
 = 
çl£
;

2324 
	gÿche_
 = 
çl£
;

2326  
	gthis
;

2329 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2330 
g‘DesütÜFÜTy³
() {

2331  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

2334 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2335  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©a
.
g‘DeçuÉIn¡ªû
();

2338 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
bud
() {

2339 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	g»suÉ
 = 
budP¬tŸl
();

2340 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

2341 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

2343  
	g»suÉ
;

2346 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
budP¬tŸl
() {

2347 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËM‘ad©a(
this
);

2348 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2349 
»suÉ
.
bËName_
 =ableName_;

2351 
	g»suÉ
.
	gbËName_
 = 
bËNameBud”_
.
bud
();

2353 
	g»suÉ
.
	gdiskBa£d_
 = 
diskBa£d_
;

2354 
	g»suÉ
.
	gÿche_
 = 
ÿche_
;

2355 
ÚBut
();

2356  
	g»suÉ
;

2359 
public
 
Bud”
 
şÚe
() {

2360  (
	gBud”
è
	gsu³r
.
şÚe
();

2362 
public
 
Bud”
 
£tF›ld
(

2363 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2364 
Objeù
 
v®ue
) {

2365  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

2367 
public
 
Bud”
 
ş—rF›ld
(

2368 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

2369  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

2371 
public
 
Bud”
 
ş—rOÃof
(

2372 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

2373  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

2375 
public
 
Bud”
 
£tR•—‹dF›ld
(

2376 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2377 
šdex
, 
Objeù
 
v®ue
) {

2378  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

2380 
public
 
Bud”
 
addR•—‹dF›ld
(

2381 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2382 
Objeù
 
v®ue
) {

2383  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

2385 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

2386 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©a
) {

2387  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
)
Ùh”
);

2389 
	gsu³r
.
m”geFrom
(
Ùh”
);

2390  
	gthis
;

2394 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
Ùh”
) {

2395 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
.
g‘DeçuÉIn¡ªû
()è 
this
;

2396 ià(
	gÙh”
.
hasTabËName
()) {

2397 
m”geTabËName
(
Ùh”
.
g‘TabËName
());

2399 ià(
	gÙh”
.
g‘DiskBa£d
(è!ğ
çl£
) {

2400 
£tDiskBa£d
(
Ùh”
.
g‘DiskBa£d
());

2402 ià(
	gÙh”
.
g‘Cache
(è!ğ
çl£
) {

2403 
£tCache
(
Ùh”
.
g‘Cache
());

2405 
ÚChªged
();

2406  
	gthis
;

2409 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2410  
	gŒue
;

2413 
public
 
Bud”
 
m”geFrom
(

2414 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2415 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2416 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2417 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	g·r£dMes§ge
 = 
nuÎ
;

2418 
	gŒy
 {

2419 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

2420 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2421 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
è
e
.
g‘UnfšishedMes§ge
();

2422 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

2423 } 
	gfš®ly
 {

2424 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

2425 
m”geFrom
(
·r£dMes§ge
);

2428  
	gthis
;

2431 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gbËName_
 = 
nuÎ
;

2432 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

2433 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
	gBud”
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.
	gTabËNameOrBud”
> 
	gbËNameBud”_
;

2437 
public
 
boŞ—n
 
hasTabËName
() {

2438  
	gbËNameBud”_
 !ğ
nuÎ
 || 
bËName_
 !=‚ull;

2443 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘TabËName
() {

2444 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2445  
bËName_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
() :ableName_;

2447  
	gbËNameBud”_
.
g‘Mes§ge
();

2453 
public
 
Bud”
 
£tTabËName
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
v®ue
) {

2454 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2455 ià(
v®ue
 =ğ
nuÎ
) {

2456 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2458 
	gbËName_
 = 
v®ue
;

2459 
ÚChªged
();

2461 
	gbËNameBud”_
.
£tMes§ge
(
v®ue
);

2464  
	gthis
;

2469 
public
 
Bud”
 
£tTabËName
(

2470 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
Bud”
 
bud”FÜV®ue
) {

2471 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2472 
bËName_
 = 
bud”FÜV®ue
.
bud
();

2473 
ÚChªged
();

2475 
	gbËNameBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

2478  
	gthis
;

2483 
public
 
Bud”
 
m”geTabËName
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
v®ue
) {

2484 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2485 ià(
bËName_
 !ğ
nuÎ
) {

2486 
bËName_
 =

2487 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
ÃwBud”
(
bËName_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

2489 
	gbËName_
 = 
v®ue
;

2491 
ÚChªged
();

2493 
	gbËNameBud”_
.
m”geFrom
(
v®ue
);

2496  
	gthis
;

2501 
public
 
Bud”
 
ş—rTabËName
() {

2502 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2503 
bËName_
 = 
nuÎ
;

2504 
ÚChªged
();

2506 
	gbËName_
 = 
nuÎ
;

2507 
	gbËNameBud”_
 = 
nuÎ
;

2510  
	gthis
;

2515 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
.
Bud”
 
g‘TabËNameBud”
() {

2517 
ÚChªged
();

2518  
g‘TabËNameF›ldBud”
().
g‘Bud”
();

2523 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËNameOrBud”
 
g‘TabËNameOrBud”
() {

2524 ià(
	gbËNameBud”_
 !ğ
nuÎ
) {

2525  
bËNameBud”_
.
g‘Mes§geOrBud”
();

2527  
	gbËName_
 =ğ
nuÎ
 ?

2528 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
(è: 
bËName_
;

2534 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

2535 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
	gBud”
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.
	gTabËNameOrBud”
>

2536 
g‘TabËNameF›ldBud”
() {

2537 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2538 
bËNameBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

2539 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
, 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
.
	gBud”
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.
	gTabËNameOrBud”
>(

2540 
g‘TabËName
(),

2541 
g‘P¬’tFÜChd»n
(),

2542 
isCËª
());

2543 
	gbËName_
 = 
nuÎ
;

2545  
	gbËNameBud”_
;

2548 
´iv©e
 
boŞ—n
 
	gdiskBa£d_
 ;

2556 
public
 
boŞ—n
 
g‘DiskBa£d
() {

2557  
	gdiskBa£d_
;

2566 
public
 
Bud”
 
£tDiskBa£d
(
boŞ—n
 
v®ue
) {

2568 
	gdiskBa£d_
 = 
v®ue
;

2569 
ÚChªged
();

2570  
	gthis
;

2579 
public
 
Bud”
 
ş—rDiskBa£d
() {

2581 
	gdiskBa£d_
 = 
çl£
;

2582 
ÚChªged
();

2583  
	gthis
;

2586 
´iv©e
 
boŞ—n
 
	gÿche_
 ;

2594 
public
 
boŞ—n
 
g‘Cache
() {

2595  
	gÿche_
;

2604 
public
 
Bud”
 
£tCache
(
boŞ—n
 
v®ue
) {

2606 
	gÿche_
 = 
v®ue
;

2607 
ÚChªged
();

2608  
	gthis
;

2617 
public
 
Bud”
 
ş—rCache
() {

2619 
	gÿche_
 = 
çl£
;

2620 
ÚChªged
();

2621  
	gthis
;

2623 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

2624 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2625  
	gthis
;

2628 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

2629 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2630  
	gthis
;

2638 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	gDEFAULT_INSTANCE
;

2640 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
();

2643 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
g‘DeçuÉIn¡ªû
() {

2644  
	gDEFAULT_INSTANCE
;

2647 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËM‘ad©a
>

2648 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TabËM‘ad©a
>() {

2649 
public
 
TabËM‘ad©a
 
·r£P¬tŸlFrom
(

2650 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2651 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2652 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

2653  
Ãw
 
TabËM‘ad©a
(
šput
, 
ex‹nsiÚRegi¡ry
);

2657 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËM‘ad©a
> 
·r£r
() {

2658  
	gPARSER
;

2661 @
	gjava
.
	gÏng
.
Ov”ride


2662 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËM‘ad©a
> 
g‘P¬£rFÜTy³
() {

2663  
	gPARSER
;

2666 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2667  
	gDEFAULT_INSTANCE
;

2672 
public
 
š‹rçû
 
RecÜdOrBud”
 
ex‹nds


2674 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

2679 
boŞ—n
 
hasPaylßd
();

2683 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘Paylßd
();

2687 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘PaylßdOrBud”
();

2692 
boŞ—n
 
hasM‘ad©a
();

2696 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘M‘ad©a
();

2700 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘M‘ad©aOrBud”
();

2709 
public
 
fš®
 
şass
 
RecÜd
 
ex‹nds


2710 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


2712 
	gRecÜdOrBud”
 {

2714 
´iv©e
 
RecÜd
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

2715 
su³r
(
bud”
);

2717 
´iv©e
 
RecÜd
() {

2720 @
	gjava
.
	gÏng
.
Ov”ride


2721 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


2722 
g‘UnknownF›lds
() {

2723  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

2725 
´iv©e
 
RecÜd
(

2726 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2727 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2728 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2729 
this
();

2730 
	gmubË_b™F›ld0_
 = 0;

2731 
	gŒy
 {

2732 
boŞ—n
 
	gdÚe
 = 
çl£
;

2733 !
	gdÚe
) {

2734 
	gg
 = 
šput
.
»adTag
();

2735 
	gg
) {

2737 
dÚe
 = 
Œue
;

2740 ià(!
šput
.
skF›ld
(
g
)) {

2741 
dÚe
 = 
Œue
;

2746 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
subBud”
 = 
nuÎ
;

2747 ià(
	g·ylßd_
 !ğ
nuÎ
) {

2748 
subBud”
 = 
·ylßd_
.
toBud”
();

2750 
	g·ylßd_
 = 
šput
.
»adMes§ge
(
com
.
googË
.
´Ùobuf
.
Any
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

2751 ià(
	gsubBud”
 !ğ
nuÎ
) {

2752 
subBud”
.
m”geFrom
(
·ylßd_
);

2753 
	g·ylßd_
 = 
subBud”
.
budP¬tŸl
();

2759 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
subBud”
 = 
nuÎ
;

2760 ià(
	gm‘ad©a_
 !ğ
nuÎ
) {

2761 
subBud”
 = 
m‘ad©a_
.
toBud”
();

2763 
	gm‘ad©a_
 = 
šput
.
»adMes§ge
(
com
.
googË
.
´Ùobuf
.
Any
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

2764 ià(
	gsubBud”
 !ğ
nuÎ
) {

2765 
subBud”
.
m”geFrom
(
m‘ad©a_
);

2766 
	gm‘ad©a_
 = 
subBud”
.
budP¬tŸl
();

2773 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2774 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

2775 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

2776 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

2777 
e
).
£tUnfšishedMes§ge
(
this
);

2778 } 
	gfš®ly
 {

2779 
makeEx‹nsiÚsImmubË
();

2782 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2783 
g‘DesütÜ
() {

2784  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

2787 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2788 
š‹º®G‘F›ldAcûssÜTabË
() {

2789  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË


2790 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2791 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.RecÜd.
Bud”
.class);

2794 
public
 
fš®
 
	gPAYLOAD_FIELD_NUMBER
 = 1;

2795 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	g·ylßd_
;

2799 
public
 
boŞ—n
 
hasPaylßd
() {

2800  
	g·ylßd_
 !ğ
nuÎ
;

2805 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘Paylßd
() {

2806  
	g·ylßd_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
·ylßd_
;

2811 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘PaylßdOrBud”
() {

2812  
g‘Paylßd
();

2815 
public
 
fš®
 
	gMETADATA_FIELD_NUMBER
 = 2;

2816 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	gm‘ad©a_
;

2820 
public
 
boŞ—n
 
hasM‘ad©a
() {

2821  
	gm‘ad©a_
 !ğ
nuÎ
;

2826 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘M‘ad©a
() {

2827  
	gm‘ad©a_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
m‘ad©a_
;

2832 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘M‘ad©aOrBud”
() {

2833  
g‘M‘ad©a
();

2836 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

2837 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2838 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

2839 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

2840 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

2842 
	gmemoizedIsIn™Ÿlized
 = 1;

2843  
	gŒue
;

2846 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

2847 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2848 ià(
	g·ylßd_
 !ğ
nuÎ
) {

2849 
ouut
.
wr™eMes§ge
(1, 
g‘Paylßd
());

2851 ià(
	gm‘ad©a_
 !ğ
nuÎ
) {

2852 
ouut
.
wr™eMes§ge
(2, 
g‘M‘ad©a
());

2856 
public
 
g‘S”ŸlizedSize
() {

2857 
	gsize
 = 
memoizedSize
;

2858 ià(
	gsize
 !ğ-1è 
size
;

2860 
	gsize
 = 0;

2861 ià(
	g·ylßd_
 !ğ
nuÎ
) {

2862 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2863 .
compu‹Mes§geSize
(1, 
g‘Paylßd
());

2865 ià(
	gm‘ad©a_
 !ğ
nuÎ
) {

2866 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2867 .
compu‹Mes§geSize
(2, 
g‘M‘ad©a
());

2869 
	gmemoizedSize
 = 
size
;

2870  
	gsize
;

2873 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

2874 @
	gjava
.
	gÏng
.
Ov”ride


2875 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

2876 ià(
	gobj
 =ğ
this
) {

2877  
Œue
;

2879 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
)) {

2880  
	gsu³r
.
equ®s
(
obj
);

2882 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.RecÜdè
obj
;

2884 
boŞ—n
 
	g»suÉ
 = 
Œue
;

2885 
	g»suÉ
 = 
»suÉ
 && (
hasPaylßd
(è=ğ
Ùh”
.hasPayload());

2886 ià(
hasPaylßd
()) {

2887 
	g»suÉ
 = 
»suÉ
 && 
g‘Paylßd
()

2888 .
equ®s
(
Ùh”
.
g‘Paylßd
());

2890 
	g»suÉ
 = 
»suÉ
 && (
hasM‘ad©a
(è=ğ
Ùh”
.hasMetadata());

2891 ià(
hasM‘ad©a
()) {

2892 
	g»suÉ
 = 
»suÉ
 && 
g‘M‘ad©a
()

2893 .
equ®s
(
Ùh”
.
g‘M‘ad©a
());

2895  
	g»suÉ
;

2898 @
	gjava
.
	gÏng
.
Ov”ride


2899 
public
 
hashCode
() {

2900 ià(
	gmemoizedHashCode
 != 0) {

2901  
memoizedHashCode
;

2903 
	ghash
 = 41;

2904 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

2905 ià(
hasPaylßd
()) {

2906 
	ghash
 = (37 * 
hash
è+ 
PAYLOAD_FIELD_NUMBER
;

2907 
	ghash
 = (53 * 
hash
è+ 
g‘Paylßd
().
hashCode
();

2909 ià(
hasM‘ad©a
()) {

2910 
	ghash
 = (37 * 
hash
è+ 
METADATA_FIELD_NUMBER
;

2911 
	ghash
 = (53 * 
hash
è+ 
g‘M‘ad©a
().
hashCode
();

2913 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

2914 
	gmemoizedHashCode
 = 
hash
;

2915  
	ghash
;

2918 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2919 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

2920 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2921  
	gPARSER
.
·r£From
(
d©a
);

2923 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2924 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

2925 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2926 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2927  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2929 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(
by‹
[] 
d©a
)

2930 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2931  
	gPARSER
.
·r£From
(
d©a
);

2933 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2934 
by‹
[] 
d©a
,

2935 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2936 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2937  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2939 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2940 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2941  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2942 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2944 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2945 
java
.
io
.
IÅutSŒ—m
 
šput
,

2946 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2947 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2948  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2949 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2951 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2952 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2953  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2954 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

2956 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£D–im™edFrom
(

2957 
java
.
io
.
IÅutSŒ—m
 
šput
,

2958 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2959 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2960  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2961 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2963 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2964 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2965 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2966  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2967 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2969 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2970 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2971 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2972 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2973  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2974 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2977 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2978 
public
 
Bud”
 
ÃwBud”
() {

2979  
	gDEFAULT_INSTANCE
.
toBud”
();

2981 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
 
´ÙÙy³
) {

2982  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2984 
public
 
Bud”
 
toBud”
() {

2985  
	gthis
 =ğ
DEFAULT_INSTANCE


2986 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2989 @
	gjava
.
	gÏng
.
Ov”ride


2990 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2991 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2992 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2993  
	gbud”
;

3002 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


3003 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


3005 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜdOrBud”
 {

3006 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3007 
g‘DesütÜ
() {

3008  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

3011 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3012 
š‹º®G‘F›ldAcûssÜTabË
() {

3013  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË


3014 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3015 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.RecÜd.
Bud”
.class);

3019 
´iv©e
 
Bud”
() {

3020 
maybeFÜûBud”In™Ÿliz©iÚ
();

3023 
´iv©e
 
Bud”
(

3024 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3025 
su³r
(
·»Á
);

3026 
maybeFÜûBud”In™Ÿliz©iÚ
();

3028 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

3029 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3030 .
	g®waysU£F›ldBud”s
) {

3033 
public
 
Bud”
 
ş—r
() {

3034 
	gsu³r
.
ş—r
();

3035 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3036 
·ylßd_
 = 
nuÎ
;

3038 
	g·ylßd_
 = 
nuÎ
;

3039 
	g·ylßdBud”_
 = 
nuÎ
;

3041 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3042 
m‘ad©a_
 = 
nuÎ
;

3044 
	gm‘ad©a_
 = 
nuÎ
;

3045 
	gm‘ad©aBud”_
 = 
nuÎ
;

3047  
	gthis
;

3050 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3051 
g‘DesütÜFÜTy³
() {

3052  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

3055 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3056  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
.
g‘DeçuÉIn¡ªû
();

3059 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
bud
() {

3060 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	g»suÉ
 = 
budP¬tŸl
();

3061 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

3062 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

3064  
	g»suÉ
;

3067 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
budP¬tŸl
() {

3068 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.RecÜd(
this
);

3069 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3070 
»suÉ
.
·ylßd_
 =…ayload_;

3072 
	g»suÉ
.
	g·ylßd_
 = 
·ylßdBud”_
.
bud
();

3074 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3075 
»suÉ
.
m‘ad©a_
 = metadata_;

3077 
	g»suÉ
.
	gm‘ad©a_
 = 
m‘ad©aBud”_
.
bud
();

3079 
ÚBut
();

3080  
	g»suÉ
;

3083 
public
 
Bud”
 
şÚe
() {

3084  (
	gBud”
è
	gsu³r
.
şÚe
();

3086 
public
 
Bud”
 
£tF›ld
(

3087 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3088 
Objeù
 
v®ue
) {

3089  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

3091 
public
 
Bud”
 
ş—rF›ld
(

3092 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

3093  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

3095 
public
 
Bud”
 
ş—rOÃof
(

3096 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

3097  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

3099 
public
 
Bud”
 
£tR•—‹dF›ld
(

3100 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3101 
šdex
, 
Objeù
 
v®ue
) {

3102  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

3104 
public
 
Bud”
 
addR•—‹dF›ld
(

3105 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3106 
Objeù
 
v®ue
) {

3107  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

3109 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

3110 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
) {

3111  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
)
Ùh”
);

3113 
	gsu³r
.
m”geFrom
(
Ùh”
);

3114  
	gthis
;

3118 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
 
Ùh”
) {

3119 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
.
g‘DeçuÉIn¡ªû
()è 
this
;

3120 ià(
	gÙh”
.
hasPaylßd
()) {

3121 
m”gePaylßd
(
Ùh”
.
g‘Paylßd
());

3123 ià(
	gÙh”
.
hasM‘ad©a
()) {

3124 
m”geM‘ad©a
(
Ùh”
.
g‘M‘ad©a
());

3126 
ÚChªged
();

3127  
	gthis
;

3130 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3131  
	gŒue
;

3134 
public
 
Bud”
 
m”geFrom
(

3135 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3136 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3137 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3138 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	g·r£dMes§ge
 = 
nuÎ
;

3139 
	gŒy
 {

3140 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

3141 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3142 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
è
e
.
g‘UnfšishedMes§ge
();

3143 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

3144 } 
	gfš®ly
 {

3145 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

3146 
m”geFrom
(
·r£dMes§ge
);

3149  
	gthis
;

3152 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	g·ylßd_
 = 
nuÎ
;

3153 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3154 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
> 
	g·ylßdBud”_
;

3158 
public
 
boŞ—n
 
hasPaylßd
() {

3159  
	g·ylßdBud”_
 !ğ
nuÎ
 || 
·ylßd_
 !=‚ull;

3164 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘Paylßd
() {

3165 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3166  
·ylßd_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
() :…ayload_;

3168  
	g·ylßdBud”_
.
g‘Mes§ge
();

3174 
public
 
Bud”
 
£tPaylßd
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3175 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3176 ià(
v®ue
 =ğ
nuÎ
) {

3177 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3179 
	g·ylßd_
 = 
v®ue
;

3180 
ÚChªged
();

3182 
	g·ylßdBud”_
.
£tMes§ge
(
v®ue
);

3185  
	gthis
;

3190 
public
 
Bud”
 
£tPaylßd
(

3191 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
bud”FÜV®ue
) {

3192 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3193 
·ylßd_
 = 
bud”FÜV®ue
.
bud
();

3194 
ÚChªged
();

3196 
	g·ylßdBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

3199  
	gthis
;

3204 
public
 
Bud”
 
m”gePaylßd
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3205 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3206 ià(
·ylßd_
 !ğ
nuÎ
) {

3207 
·ylßd_
 =

3208 
com
.
googË
.
´Ùobuf
.
Any
.
ÃwBud”
(
·ylßd_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

3210 
	g·ylßd_
 = 
v®ue
;

3212 
ÚChªged
();

3214 
	g·ylßdBud”_
.
m”geFrom
(
v®ue
);

3217  
	gthis
;

3222 
public
 
Bud”
 
ş—rPaylßd
() {

3223 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3224 
·ylßd_
 = 
nuÎ
;

3225 
ÚChªged
();

3227 
	g·ylßd_
 = 
nuÎ
;

3228 
	g·ylßdBud”_
 = 
nuÎ
;

3231  
	gthis
;

3236 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
Bud”
 
g‘PaylßdBud”
() {

3238 
ÚChªged
();

3239  
g‘PaylßdF›ldBud”
().
g‘Bud”
();

3244 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘PaylßdOrBud”
() {

3245 ià(
	g·ylßdBud”_
 !ğ
nuÎ
) {

3246  
·ylßdBud”_
.
g‘Mes§geOrBud”
();

3248  
	g·ylßd_
 =ğ
nuÎ
 ?

3249 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
·ylßd_
;

3255 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3256 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>

3257 
g‘PaylßdF›ldBud”
() {

3258 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3259 
·ylßdBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

3260 
com
.
googË
.
´Ùobuf
.
Any
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>(

3261 
g‘Paylßd
(),

3262 
g‘P¬’tFÜChd»n
(),

3263 
isCËª
());

3264 
	g·ylßd_
 = 
nuÎ
;

3266  
	g·ylßdBud”_
;

3269 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	gm‘ad©a_
 = 
nuÎ
;

3270 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3271 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
> 
	gm‘ad©aBud”_
;

3275 
public
 
boŞ—n
 
hasM‘ad©a
() {

3276  
	gm‘ad©aBud”_
 !ğ
nuÎ
 || 
m‘ad©a_
 !=‚ull;

3281 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘M‘ad©a
() {

3282 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3283  
m‘ad©a_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
() : metadata_;

3285  
	gm‘ad©aBud”_
.
g‘Mes§ge
();

3291 
public
 
Bud”
 
£tM‘ad©a
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3292 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3293 ià(
v®ue
 =ğ
nuÎ
) {

3294 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3296 
	gm‘ad©a_
 = 
v®ue
;

3297 
ÚChªged
();

3299 
	gm‘ad©aBud”_
.
£tMes§ge
(
v®ue
);

3302  
	gthis
;

3307 
public
 
Bud”
 
£tM‘ad©a
(

3308 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
bud”FÜV®ue
) {

3309 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3310 
m‘ad©a_
 = 
bud”FÜV®ue
.
bud
();

3311 
ÚChªged
();

3313 
	gm‘ad©aBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

3316  
	gthis
;

3321 
public
 
Bud”
 
m”geM‘ad©a
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3322 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3323 ià(
m‘ad©a_
 !ğ
nuÎ
) {

3324 
m‘ad©a_
 =

3325 
com
.
googË
.
´Ùobuf
.
Any
.
ÃwBud”
(
m‘ad©a_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

3327 
	gm‘ad©a_
 = 
v®ue
;

3329 
ÚChªged
();

3331 
	gm‘ad©aBud”_
.
m”geFrom
(
v®ue
);

3334  
	gthis
;

3339 
public
 
Bud”
 
ş—rM‘ad©a
() {

3340 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3341 
m‘ad©a_
 = 
nuÎ
;

3342 
ÚChªged
();

3344 
	gm‘ad©a_
 = 
nuÎ
;

3345 
	gm‘ad©aBud”_
 = 
nuÎ
;

3348  
	gthis
;

3353 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
Bud”
 
g‘M‘ad©aBud”
() {

3355 
ÚChªged
();

3356  
g‘M‘ad©aF›ldBud”
().
g‘Bud”
();

3361 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘M‘ad©aOrBud”
() {

3362 ià(
	gm‘ad©aBud”_
 !ğ
nuÎ
) {

3363  
m‘ad©aBud”_
.
g‘Mes§geOrBud”
();

3365  
	gm‘ad©a_
 =ğ
nuÎ
 ?

3366 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
m‘ad©a_
;

3372 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3373 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>

3374 
g‘M‘ad©aF›ldBud”
() {

3375 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3376 
m‘ad©aBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

3377 
com
.
googË
.
´Ùobuf
.
Any
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>(

3378 
g‘M‘ad©a
(),

3379 
g‘P¬’tFÜChd»n
(),

3380 
isCËª
());

3381 
	gm‘ad©a_
 = 
nuÎ
;

3383  
	gm‘ad©aBud”_
;

3385 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

3386 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3387  
	gthis
;

3390 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

3391 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3392  
	gthis
;

3400 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	gDEFAULT_INSTANCE
;

3402 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
();

3405 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
g‘DeçuÉIn¡ªû
() {

3406  
	gDEFAULT_INSTANCE
;

3409 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gRecÜd
>

3410 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
RecÜd
>() {

3411 
public
 
RecÜd
 
·r£P¬tŸlFrom
(

3412 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3413 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3414 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

3415  
Ãw
 
RecÜd
(
šput
, 
ex‹nsiÚRegi¡ry
);

3419 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gRecÜd
> 
·r£r
() {

3420  
	gPARSER
;

3423 @
	gjava
.
	gÏng
.
Ov”ride


3424 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gRecÜd
> 
g‘P¬£rFÜTy³
() {

3425  
	gPARSER
;

3428 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3429  
	gDEFAULT_INSTANCE
;

3434 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3435 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

3436 
´iv©e
 
fš®


3437 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3438 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË
;

3439 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3440 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

3441 
´iv©e
 
fš®


3442 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3443 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË
;

3444 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3445 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

3446 
´iv©e
 
fš®


3447 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3448 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË
;

3449 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3450 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
;

3451 
´iv©e
 
fš®


3452 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3453 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_f›ldAcûssÜTabË
;

3454 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3455 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

3456 
´iv©e
 
fš®


3457 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3458 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË
;

3459 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3460 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

3461 
´iv©e
 
fš®


3462 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3463 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË
;

3465 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


3466 
	$g‘DesütÜ
() {

3467  
desütÜ
;

3468 
	}
}

3469 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


3470 
	gdesütÜ
;

3472 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

3490 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

3491 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

3492 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

3493 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

3494 
desütÜ
 = 
roÙ
;

3495  
	gnuÎ
;

3498 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


3499 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

3500 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

3501 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
g‘DesütÜ
(),

3502 
com
.
googË
.
´Ùobuf
.
AnyPrÙo
.
g‘DesütÜ
(),

3503 }, 
assigÃr
);

3504 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
 =

3505 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

3506 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË
 = 
Ãw


3507 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3508 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
,

3509 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Epoch", "Sequence", });

3510 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
 =

3511 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

3512 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË
 = 
Ãw


3513 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3514 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
,

3515 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Namespace", "TableName", });

3516 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
 =

3517 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(2);

3518 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË
 = 
Ãw


3519 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3520 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
,

3521 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "FileDescriptors", });

3522 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
 =

3523 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
.
g‘Ne¡edTy³s
().
g‘
(0);

3524 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_f›ldAcûssÜTabË
 = 
Ãw


3525 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3526 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
,

3527 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Key", "Value", });

3528 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
 =

3529 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(3);

3530 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË
 = 
Ãw


3531 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3532 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
,

3533 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "TableName", "DiskBased", "Cache", });

3534 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
 =

3535 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(4);

3536 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË
 = 
Ãw


3537 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3538 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
,

3539 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Payload", "Metadata", });

3540 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
g‘DesütÜ
();

3541 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAnyPrÙo
.
g‘DesütÜ
();

	@samples/src/main/java/org/corfudb/samples/BaseCorfuAppUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

9 
impÜt
 
	gÜg
.
	gdocİt
.
	gDocİt
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

18 
public
 
ab¡¿ù
 cÏs 
	cBa£CÜfuAµUts
 {

20 @
	mS‘‹r
 @
G‘‹r


21 
CÜfuRuÁime
 
	mcÜfuRuÁime
;

37 
´iv©e
 
CÜfuRuÁime
 
	$g‘RuÁimeAndCÚÃù
(
SŒšg
 
cÚfigu¿tiÚSŒšg
) {

38  
Ãw
 
	`CÜfuRuÁime
(
cÚfigu¿tiÚSŒšg
).
	`cÚÃù
();

41 
´iv©e
 
fš®
 
SŒšg
 
USAGE
 = "Usage: HelloCorfu [-c <conf>]\n"

48 
ab¡¿ù
 
	`aùiÚ
();

55 
	$¡¬t
(
SŒšg
[] 
¬gs
) {

57 
M­
<
SŒšg
, 
Objeù
> 
İts
 =

58 
Ãw
 
	`Docİt
(
USAGE
)

59 .
	`w™hV”siÚ
(
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
desüibe
)

60 .
	`·r£
(
¬gs
);

61 
SŒšg
 
cÜfuCÚfigu¿tiÚSŒšg
 = (SŒšgè
İts
.
	`g‘
("-c");

66 
	`£tCÜfuRuÁime
Ğ
	`g‘RuÁimeAndCÚÃù
(
cÜfuCÚfigu¿tiÚSŒšg
) );

74 
	`aùiÚ
();

75 
	}
}

90 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
<
	gT
>> T 
š¡ªtŸ‹CÜfuObjeù
(

91 
Ty³Tok’
<
T
> 
tTy³
, 
SŒšg
 
Çme
) {

92  
g‘CÜfuRuÁime
().
g‘ObjeùsV›w
()

93 .
bud
()

94 .
£tSŒ—mName
(
Çme
)

95 .
£tTy³Tok’
(
tTy³
)

96 .
İ’
();

104 
´Ùeùed
 
	$TXBegš
() {

105 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

106 .
	`bud
()

107 .
	`begš
();

108 
	}
}

113 
´Ùeùed
 
	$TXEnd
() {

114 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

115 
	}
}

	@samples/src/main/java/org/corfudb/samples/BatchedWriteTransaction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

45 
public
 cÏs 
	cB©chedWr™eT¿n§ùiÚ
 
ex‹nds
 
	mBa£CÜfuAµUts
 {

50 
Ba£CÜfuAµUts
 
	$£lfFaùÜy
(è{  
Ãw
 
	`B©chedWr™eT¿n§ùiÚ
(); }

51 
public
 
	$maš
(
SŒšg
[] 
¬gs
è{ 
	`£lfFaùÜy
().
	`¡¬t
×rgs); 
	}
}

53 
´iv©e
 
fš®
 
	gnumB©ches
 = 100;

54 
´iv©e
 
fš®
 
	gb©chSize
 = 1
_000
;

55 
´iv©e
 
fš®
 
	gnumTasks
 = 
numB©ches
 * 
b©chSize
;

60 @
Ov”ride


61 
	$aùiÚ
() {

62 
	`wÜklßd1
();

63 
	`wÜklßd2
();

64 
	}
}

66 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

67 
	$wÜklßd1
() {

71 
M­
<
SŒšg
, 
IÁeg”
> 
m­
 = 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
()

72 .
	`bud
()

73 .
	`£tSŒ—mName
("A")

74 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {})

75 .
	`İ’
();

78 
¡¬‰
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

79 
i
 = 0; i < 
numTasks
; i++) {

80 
m­
.
	`put
("k1" + 
i
, i);

82 
’dt
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

83 
Sy¡em
.
out
.
	`´šn
("timtØpİuÏ‹ m­ sequ’tŸÎy (m£cs): " + (
’dt
 - 
¡¬‰
) );

86 
¡¬‰
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

87 
i
 = 0; i < 
numB©ches
; i++) {

88 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

89 
j
 = 0; j < 
b©chSize
; j++)

90 
m­
.
	`put
("k2" + (
i
 * 
b©chSize
 + 
j
), i);

91 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

93 
’dt
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

94 
Sy¡em
.
out
.
	`´šn
("timtØpİuÏ‹ m­ iÀb©che (m£cs): " + (
’dt
 - 
¡¬‰
));

95 
	}
}

97 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

98 
	$wÜklßd2
() {

102 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
m­¬¿y
 = 
Ãw
 
A¼ayLi¡
<M­<SŒšg, IÁeg”>>(
numB©ches
);

103 
m
 = 0; m < 
numB©ches
; m++) {

104 
m­¬¿y
.
	`add
(
m
,

105 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
()

106 .
	`bud
()

107 .
	`£tSŒ—mName
("C" + 
m
)

108 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {})

109 .
	`İ’
()

113 
¡¬‰
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

114 
i
 = 0; i < 
b©chSize
; i++) {

115 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

116 
j
 = 0; j < 
numB©ches
; j++)

117 
m­¬¿y
.
	`g‘
(
j
).
	`put
("k2"+(
i
*
numB©ches
 + j), i);

118 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

120 
’dt
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

121 
Sy¡em
.
out
.
	`´šn
("timtØpİuÏ‹ m­-¬¿y iÀb©che (m£cs): " + (
’dt
-
¡¬‰
));

123 
	}
}

	@samples/src/main/java/org/corfudb/samples/CorfuCompoundObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

16 @
CÜfuObjeù


17 
public
 
şass
 
CÜfuCompoundObjeù
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuCompoundObjeù
> {

19 
public
 cÏs 
	cIÂ”
 {

20 @
	gS‘‹r


21 @
G‘‹r


22 
SŒšg
 
	gfœ¡Name
, 
	gÏ¡Name
;

24 
public
 
IÂ”
(
SŒšg
 
f
, SŒšg 
l
è{ 
	gfœ¡Name
 = f; 
	gÏ¡Name
 =†; }

27 
IÂ”
 
	gu£r
;

28 
	gID
;

30 @
MutÜ
(
Çme
 = "set")

31 
public
 
	$£t
(
IÂ”
 
š
, 
id
) {

32 
this
.
u£r
 = 
š
;

33 
this
.
ID
 = 
id
;

34 
	}
}

36 @
AcûssÜ


37 
public
 
IÂ”
 
	$g‘U£r
(è{  
u£r
;
	}
}

39 @
AcûssÜ


40 
public
 
	$g‘ID
(è{  
ID
;
	}
}

45 @
Ov”ride


46 
public
 
CÜfuCompoundObjeù
 
	$g‘CÚ‹xt
(
CÚ‹xt
 
cÚ‹xt
) {

47  
this
;

48 
	}
}

	@samples/src/main/java/org/corfudb/samples/CorfuSharedCounter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

31 @
CÜfuObjeù


32 
public
 
şass
 
CÜfuSh¬edCouÁ”
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuSh¬edCouÁ”
> {

33 
IÁeg”
 
	gv®ue
 = 0;

41 @
MutÜAcûssÜ
(
Çme
 = "Increment")

42 
public
 
Inüem’t
() {

43 
tmp
 = 
v®ue
;

44 
	gv®ue
++;

45  
	gtmp
;

53 @
AcûssÜ


54 
public
 
G‘
(è{  
	gv®ue
; }

60 @
MutÜ
(
Çme
 = "Set")

61 
public
 
S‘
(
Ãwv®ue
è{ 
v®ue
 =‚ewvalue; }

66 @
Ov”ride


67 
public
 
CÜfuSh¬edCouÁ”
 
g‘CÚ‹xt
(
CÚ‹xt
 
cÚ‹xt
) {

68  
	gthis
;

	@samples/src/main/java/org/corfudb/samples/CorfuStoreSample.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

8 
impÜt
 
	gÜg
.
	gdocİt
.
	gDocİt
;

9 
impÜt
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
;

10 
impÜt
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gC¬
;

12 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
public
 cÏs 
	cCÜfuStÜeSam¶e
 {

24 
´iv©e
 
fš®
 
SŒšg
 
	mUSAGE
 = "Usage: CorfuStoreSample [-c <conf>]\n"

35 
´iv©e
 
CÜfuRuÁime
 
	$g‘RuÁimeAndCÚÃù
(
SŒšg
 
cÚfigu¿tiÚSŒšg
) {

37  
CÜfuRuÁime
.
	`äomP¬am‘”s
(CÜfuRuÁime.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

38 .
	`ÿcheDi§bËd
(
Œue
)

39 .
	`sEÇbËd
(
çl£
)

40 .
	`bud
())

41 .
	`·r£CÚfigu¿tiÚSŒšg
(
cÚfigu¿tiÚSŒšg
)

42 .
	`cÚÃù
();

45 @
	`Suµ»ssW¬nšgs
("checkstyle:printLine")

46 
public
 
	$maš
(
SŒšg
[] 
¬gs
è
throws
 
Exû±iÚ
 {

48 
M­
<
SŒšg
, 
Objeù
> 
İts
 =

49 
Ãw
 
	`Docİt
(
USAGE
)

50 .
	`w™hV”siÚ
(
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
desüibe
)

51 .
	`·r£
(
¬gs
);

52 
SŒšg
 
cÜfuCÚfigu¿tiÚSŒšg
 = (SŒšgè
İts
.
	`g‘
("-c");

58 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘RuÁimeAndCÚÃù
(
cÜfuCÚfigu¿tiÚSŒšg
);

60 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

62 
SŒšg
 
Çme¥aû
 = "credentials";

63 
SŒšg
 
bËName
 = "profile";

65 
cÜfuStÜe
.
	`İ’TabË
(
Çme¥aû
,

66 
bËName
,

67 
Name
.
şass
,

68 
C¬
.
şass
,

69 
nuÎ
,

70 
TabËO±iÚs
.
	`bud”
().
	`bud
());

72 
cÜfuStÜe
.
	`tx
(
Çme¥aû
)

73 .
	`ü—‹
(
bËName
,

74 
Name
.
	`ÃwBud”
().
	`£tFœ¡Name
("a").
	`£tLa¡Name
("x").
	`bud
(),

75 
C¬
.
	`ÃwBud”
().
	`£tCŞÜ
("»d").
	`bud
(),

76 
nuÎ
)

77 .
	`ü—‹
(
bËName
,

78 
Name
.
	`ÃwBud”
().
	`£tFœ¡Name
("b").
	`£tLa¡Name
("y").
	`bud
(),

79 
C¬
.
	`ÃwBud”
().
	`£tCŞÜ
("blue").
	`bud
(),

80 
nuÎ
)

82 .
	`comm™
();

84 
CÜfuRecÜd
 
»cÜd
 = 
cÜfuStÜe
.
	`qu”y
(
Çme¥aû
)

85 .
	`g‘RecÜd
(
bËName
,

86 
Name
.
	`ÃwBud”
().
	`£tFœ¡Name
("a").
	`£tLa¡Name
("x").
	`bud
());

87 
Sy¡em
.
out
.
	`´šn
("C¬ = " + 
»cÜd
.
	`g‘Paylßd
());

89 
cÜfuStÜe
.
	`tx
(
Çme¥aû
)

90 .
	`upd©e
(
bËName
,

91 
Name
.
	`ÃwBud”
().
	`£tFœ¡Name
("a").
	`£tLa¡Name
("x").
	`bud
(),

92 
C¬
.
	`ÃwBud”
().
	`£tCŞÜ
("sv”").
	`bud
(),

93 
nuÎ
)

94 .
	`comm™
();

95 
»cÜd
 = 
cÜfuStÜe
.
	`qu”y
(
Çme¥aû
)

96 .
	`g‘RecÜd
(
bËName
,

97 
Name
.
	`ÃwBud”
().
	`£tFœ¡Name
("a").
	`£tLa¡Name
("x").
	`bud
());

98 
Sy¡em
.
out
.
	`´šn
("C¬ = " + 
»cÜd
.
	`g‘Paylßd
());

99 
	}
}

	@samples/src/main/java/org/corfudb/samples/HelloCorfu.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gG™R•os™ÜyS‹
;

9 
impÜt
 
	gÜg
.
	gdocİt
.
	gDocİt
;

16 
public
 cÏs 
	cH–loCÜfu
 {

17 
´iv©e
 
fš®
 
SŒšg
 
	mUSAGE
 = "Usage: HelloCorfu [-c <conf>]\n"

28 
´iv©e
 
CÜfuRuÁime
 
	$g‘RuÁimeAndCÚÃù
(
SŒšg
 
cÚfigu¿tiÚSŒšg
) {

30 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
cÚfigu¿tiÚSŒšg
).
	`cÚÃù
();

31  
cÜfuRuÁime
;

34 @
	`Suµ»ssW¬nšgs
("checkstyle:printLine")

35 
public
 
	$maš
(
SŒšg
[] 
¬gs
) {

37 
M­
<
SŒšg
, 
Objeù
> 
İts
 =

38 
Ãw
 
	`Docİt
(
USAGE
)

39 .
	`w™hV”siÚ
(
G™R•os™ÜyS‹
.
	`g‘R•os™ÜyS‹
().
desüibe
)

40 .
	`·r£
(
¬gs
);

41 
SŒšg
 
cÜfuCÚfigu¿tiÚSŒšg
 = (SŒšgè
İts
.
	`g‘
("-c");

47 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘RuÁimeAndCÚÃù
(
cÜfuCÚfigu¿tiÚSŒšg
);

63 
M­
<
SŒšg
, 
IÁeg”
> 
m­
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

64 .
	`bud
()

65 .
	`£tSŒ—mName
("A")

66 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {})

67 .
	`İ’
();

78 
IÁeg”
 
´evious
 = 
m­
.
	`g‘
("a");

79 ià(
´evious
 =ğ
nuÎ
) {

80 
Sy¡em
.
out
.
	`´šn
("This ishe firstime we were„un!");

81 
m­
.
	`put
("a", 1);

84 
m­
.
	`put
("a", ++
´evious
);

85 
Sy¡em
.
out
.
	`´šn
("Thi i th" + 
´evious
 + "ime we were„un!");

87 
	}
}

	@samples/src/main/java/org/corfudb/samples/SimpleAtomicTransaction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

80 
public
 cÏs 
	cSim¶eAtomicT¿n§ùiÚ
 
ex‹nds
 
	mBa£CÜfuAµUts
 {

85 
Ba£CÜfuAµUts
 
	$£lfFaùÜy
(è{  
Ãw
 
	`Sim¶eAtomicT¿n§ùiÚ
(); }

86 
public
 
	$maš
(
SŒšg
[] 
¬gs
è{ 
	`£lfFaùÜy
().
	`¡¬t
×rgs); 
	}
}

91 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

92 @
Ov”ride


93 
	$aùiÚ
() {

99 
M­
<
SŒšg
, 
IÁeg”
> 
m­
 = 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
()

100 .
	`bud
()

101 .
	`£tSŒ—mName
("A")

102 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {})

103 .
	`İ’
();

110 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

111 
IÁeg”
 
´evious
 = 
m­
.
	`g‘
("a");

112 ià(
´evious
 =ğ
nuÎ
) {

113 
Sy¡em
.
out
.
	`´šn
("This ishe firstime we were„un!");

114 
m­
.
	`put
("a", 1);

117 
m­
.
	`put
("a", ++
´evious
);

118 
Sy¡em
.
out
.
	`´šn
("Thi i th" + 
´evious
 + "ime we were„un!");

120 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

130 
	}
}

	@samples/src/main/java/org/corfudb/samples/SimpleUseCustomBaseCorfuObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

9 
public
 cÏs 
	cSim¶eU£Cu¡omBa£CÜfuObjeù
 
ex‹nds
 
	mBa£CÜfuAµUts
 {

14 
Ba£CÜfuAµUts
 
	$£lfFaùÜy
(è{  
Ãw
 
	`Sim¶eU£Cu¡omBa£CÜfuObjeù
(); }

15 
public
 
	$maš
(
SŒšg
[] 
¬gs
è{ 
	`£lfFaùÜy
().
	`¡¬t
×rgs); 
	}
}

17 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

18 
public
 
	$aùiÚ
() {

19 
CÜfuSh¬edCouÁ”
 
úŒ
 = 
	`š¡ªtŸ‹CÜfuObjeù
(

20 
Ãw
 
Ty³Tok’
<
CÜfuSh¬edCouÁ”
>() {}, "CNTR"

23 
fš®
 
MAGIC_VALUE
 = 55;

24 
Sy¡em
.
out
.
	`´šn
("CouÁ” v®ubefÜšüem’t: " + 
úŒ
.
	`G‘
());

25 
úŒ
.
	`S‘
(
MAGIC_VALUE
);

26 
Sy¡em
.
out
.
	`´šn
("CouÁ” v®ubefÜšüem’t: " + 
úŒ
.
	`Inüem’t
());

27 
Sy¡em
.
out
.
	`´šn
("CouÁ” v®ubefÜšüem’t: " + 
úŒ
.
	`Inüem’t
());

29 
CÜfuCompoundObjeù
 
cm²d
 = 
	`š¡ªtŸ‹CÜfuObjeù
(

30 
Ãw
 
Ty³Tok’
<
CÜfuCompoundObjeù
>() {}, "CMPND"

33 
cm²d
.
	`£t
(cm²d.
Ãw
 
	`IÂ”
("foo", "b¬"), 
MAGIC_VALUE
);

34 
Sy¡em
.
out
.
	`´šn
("compound: "

35 + "u£r=" + 
cm²d
.
	`g‘U£r
().
	`g‘Fœ¡Name
(è+ "," + cm²d.g‘U£r().
	`g‘La¡Name
()

36 + " ID=" + 
cm²d
.
	`g‘ID
());

37 
	}
}

	@samples/src/main/java/org/corfudb/samples/WriteOnlySimpleTransaction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

22 
public
 cÏs 
	cWr™eOÆySim¶eT¿n§ùiÚ
 
ex‹nds
 
	mBa£CÜfuAµUts
 {

27 
Ba£CÜfuAµUts
 
	$£lfFaùÜy
(è{  
Ãw
 
	`Wr™eOÆySim¶eT¿n§ùiÚ
(); }

28 
public
 
	$maš
(
SŒšg
[] 
¬gs
è{ 
	`£lfFaùÜy
().
	`¡¬t
×rgs); 
	}
}

34 @
	gOv”ride


35 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

36 
	$aùiÚ
() {

40 
M­
<
SŒšg
, 
IÁeg”
> 
m­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(

41 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {}, "A");

45 
Ãw
 
	`Th»ad
(() -> {

46 
	`TXBegš
();

47 
m­
.
	`put
("a", 1);

48 
m­
.
	`put
("b", 1);

49 
	`TXEnd
();

51 ).
	`¡¬t
();

55 
Ãw
 
	`Th»ad
(() -> {

56 
IÁeg”
 
v®A
 = 0, 
v®B
 = 0;

58 
	`TXBegš
();

59 
v®A
 = 
m­
.
	`g‘
("a");

60 
Sy¡em
.
out
.
	`´šn
("a: " + 
v®A
);

61 
v®B
 = 
m­
.
	`g‘
("b");

62 
Sy¡em
.
out
.
	`´šn
("b: " + 
v®B
);

63 
	`TXEnd
();

65 ).
	`¡¬t
();

66 
	}
}

	@samples/src/main/java/org/corfudb/samples/WriteWriteTXs.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gICÜfuTabË
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

34 
public
 cÏs 
	cWr™eWr™eTXs
 
ex‹nds
 
	mBa£CÜfuAµUts
 {

39 
Ba£CÜfuAµUts
 
	$£lfFaùÜy
(è{  
Ãw
 
	`Wr™eWr™eTXs
(); }

40 
public
 
	$maš
(
SŒšg
[] 
¬gs
è{ 
	`£lfFaùÜy
().
	`¡¬t
×rgs); 
	}
}

45 
´iv©e
 
fš®
 
	gNUM_BATCHES
 = 10;

46 
´iv©e
 
fš®
 
	gBATCH_SZ
 = 1
_000
;

47 
´iv©e
 
fš®
 
	gnumTasks
 = 
NUM_BATCHES
 * 
BATCH_SZ
;

48 
´iv©e
 
fš®
 
	gTOTAL_PERCENT
 = 100;

53 @
Ov”ride


54 
´Ùeùed
 
	$TXBegš
() {

55 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

56 .
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
)

57 .
	`bud
()

58 .
	`begš
();

59 
	}
}

64 @
	gOv”ride


65 @
Suµ»ssW¬nšgs
("checkstyle:printLine")

66 
	$aùiÚ
() {

68 
fš®
 
NUM_THREADS
 = 2;

69 
fš®
 
THREAD_TIMEOUT
 = 300
_000
;

70 
fš®
 
READ_PERCENT
 = 80;

72 
A¼ayLi¡
<
Th»ad
> 
tLi¡
 = 
Ãw
 ArrayList<>();

75 
	`g’”©eM­s
();

80 
t
 = 0; < 
NUM_THREADS
;++) {

81 
fš®
 
th»adNum
 = 
t
;

85 
tLi¡
.
	`g‘
(
t
).
	`¡¬t
();

88 
tLi¡
.
	`fÜEach
(
th
 -> {

89 
Œy
 {

90 
th
.
	`još
(
THREAD_TIMEOUT
);

91 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

92 
Sy¡em
.
out
.
	`´šn
("Threadimeout!");

93 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

98 
tLi¡
.
	`ş—r
();

101 
t
 = 0; < 
NUM_THREADS
;++) {

102 
fš®
 
th»adNum
 = 
t
;

103 
tLi¡
.
	`add
(
Ãw
 
	`Th»ad
((è-> 
	`mixedR—dWr™eLßd1
(
th»adNum
, 
READ_PERCENT
)));

104 
tLi¡
.
	`g‘
(
t
).
	`¡¬t
();

107 
tLi¡
.
	`fÜEach
(
th
 -> {

108 
Œy
 {

109 
th
.
	`još
(
THREAD_TIMEOUT
);

110 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

111 
Sy¡em
.
out
.
	`´šn
("Threadimeout!");

112 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
(
›
);

116 
	}
}

121 
	gICÜfuTabË
<
	gSŒšg
, 
	gIÁeg”
> 
	gm­1
, 
	gm­2
, 
	gm­3
;

126 
fš®
 
	gSEED
 = 434343;

127 
fš®
 
Rªdom
 
	g¿nd
 = 
Ãw
 Rªdom(
SEED
);

132 @
Suµ»ssW¬nšgs
({"checkstyle:printLine", "checkstyle:print"})

133 
	$g’”©eM­s
() {

137 
m­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {}, "A");

138 
m­2
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {}, "B");

139 
m­3
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {}, "C");

142 
Sy¡em
.
out
.
	`´št
("generating maps..");

143 
i
 = 0; i < 
NUM_BATCHES
; i++) {

144 
Sy¡em
.
out
.
	`´št
(".");

145 
	`TXBegš
();

146 
j
 = 0; j < 
BATCH_SZ
; j++) {

147 
m­1
.
	`put
("m1" + (
i
 * 
BATCH_SZ
 + 
j
), i);

148 
m­2
.
	`put
("m2" + (
i
 * 
BATCH_SZ
 + 
j
), i);

149 
m­3
.
	`put
("m3" + (
i
 * 
BATCH_SZ
 + 
j
), i);

151 
	`TXEnd
();

153 
Sy¡em
.
out
.
	`´šn
("END");

154 
	}
}

163 @
Suµ»ssW¬nšgs
({"checkstyle:printLine", "checkstyle:print"})

164 
	$mixedR—dWr™eLßd1
(
th»adNum
, 
»adP”ûÁ
) {

165 
Sy¡em
.
out
.
	`´št
("running mixedRWload1..");

166 
¡¬‰
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

167 
AtomicIÁeg”
 
abÜts
 = 
Ãw
 
	`AtomicIÁeg”
(0);

169 
i
 = 0; i < 
NUM_BATCHES
; i++) {

170 
Sy¡em
.
out
.
	`´št
(".");

171 
	`TXBegš
();

172 
accumuÏtÜ
 = 0;

173 
j
 = 0; j < 
BATCH_SZ
; j++) {

176 ià(
¿nd
.
	`ÃxtIÁ
(
TOTAL_PERCENT
è< 
»adP”ûÁ
) {

177 
r1
 = 
¿nd
.
	`ÃxtIÁ
(
numTasks
);

178 
r2
 = 
¿nd
.
	`ÃxtIÁ
(
numTasks
);

179 
r3
 = 
¿nd
.
	`ÃxtIÁ
(
numTasks
);

180 
Œy
 {

181 
accumuÏtÜ
 +ğ
m­1
.
	`g‘
("m1" + 
r1
);

182 
accumuÏtÜ
 +ğ
m­2
.
	`g‘
("m2" + 
r2
);

183 
accumuÏtÜ
 +ğ
m­3
.
	`g‘
("m3" + 
r3
);

184 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

185 
Sy¡em
.
out
.
	`´šn
(
th»adNum
 +

186 ":ƒxû±iÚ oÀ™”©iÚ " + 
i
 + "," + 
j


187 + ",„=" + 
r1
 + "," + 
r2
 + "," + 
r3
);

194 ià(
¿nd
.
	`ÃxtIÁ
(2) == 1)

195 
m­2
.
	`put
("m2" + 
¿nd
.
	`ÃxtIÁ
(
numTasks
), 
accumuÏtÜ
);

197 
m­3
.
	`put
("m3" + 
¿nd
.
	`ÃxtIÁ
(
numTasks
), 
accumuÏtÜ
);

201 
Œy
 {

202 
	`TXEnd
();

203 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

204 
abÜts
.
	`g‘AndInüem’t
();

207 
Sy¡em
.
out
.
	`´šn
("END");

209 
’dt
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

210 
Sy¡em
.
out
.
	`´šn
(
th»adNum


211 + ": mixedR—dWr™eLßdƒÏp£dim(m£cs): " + (
’dt
 - 
¡¬‰
));

212 
Sy¡em
.
out
.
	`´šn
(
th»adNum


213 + ": #abÜts/#TXs: " + 
abÜts
.
	`g‘
(è+ "/" + 
numTasks
);

214 
	}
}

	@samples/target/generated-sources/annotations/org/corfudb/samples/CorfuCompoundObject$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxy
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRUpÿÎT¬g‘
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoFunùiÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoRecÜdFunùiÚ
;

21 @
In¡rum’‹dCÜfuObjeù


22 
public
 
şass
 
CÜfuCompoundObjeù$CORFUSMR
 
ex‹nds
 
CÜfuCompoundObjeù
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuCompoundObjeù
> {

23 
public
 
	gICÜfuSMRProxy
<
	gCÜfuCompoundObjeù
> 
	g´oxy_CORFUSMR
;

25 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuCompoundObjeù
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<CorfuCompoundObject>>()

26 .
put
("£t", (
obj
, 
¬gs
è-> { obj.
£t
((
Üg
.
cÜfudb
.
§m¶es
.
CÜfuCompoundObjeù
.
IÂ”
è¬gs[0], (è¬gs[1]); 
nuÎ
;}).
bud
();

28 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuCompoundObjeù
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<CÜfuCompoundObjeù>>().
bud
();

30 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuCompoundObjeù
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<CÜfuCompoundObjeù>>().
bud
();

32 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

34 
public
 
CÜfuCompoundObjeù$CORFUSMR
() {

35 
su³r
();

38 
public
 
	gICÜfuSMRProxy
<
	gCÜfuCompoundObjeù
> 
g‘CÜfuSMRProxy
() {

39  
	g´oxy_CORFUSMR
;

42 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
CÜfuCompoundObjeù
> 
´oxy
) {

43 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

46 @
Ov”ride


47 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

48  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

51 @
Ov”ride


52 
public
 
SŒšg
 
toSŒšg
() {

53  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

56 @
Ov”ride


57 
public
 
CÜfuCompoundObjeù
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

58  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

61 @
	gOv”ride


62 @
MutÜ
(

63 
Çme
 = "set"

65 
public
 
£t
(
CÜfuCompoundObjeù
.
IÂ”
 
š
, 
id
) {

66 
	g´oxy_CORFUSMR
.
logUpd©e
("£t",
çl£
,
nuÎ
,
š
, 
id
);

69 @
	gOv”ride


70 @
PassThrough


71 
public
 
şo£
() {

72 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

75 @
Ov”ride


76 
public
 
hashCode
() {

77  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

80 @
	gOv”ride


81 @
AcûssÜ


82 
public
 
	gCÜfuCompoundObjeù
.
IÂ”
 
g‘U£r
() {

83  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘U£r
();},
nuÎ
);

86 @
	gOv”ride


87 @
AcûssÜ


88 
public
 
g‘ID
() {

89  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘ID
();},
nuÎ
);

92 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuCompoundObjeù
>> 
g‘CÜfuSMRUpÿÎM­
() {

93  
	gupÿÎM­_CORFUSMR
;

96 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuCompoundObjeù
>> 
g‘CÜfuUndoRecÜdM­
() {

97  
	gundoRecÜdM­_CORFUSMR
;

100 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuCompoundObjeù
>> 
g‘CÜfuUndoM­
() {

101  
	gundoM­_CORFUSMR
;

104 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

105  
	g»£tS‘_CORFUSMR
;

	@samples/target/generated-sources/annotations/org/corfudb/samples/CorfuSharedCounter$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g§m¶es
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxy
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRUpÿÎT¬g‘
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoFunùiÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoRecÜdFunùiÚ
;

22 @
In¡rum’‹dCÜfuObjeù


23 
public
 
şass
 
CÜfuSh¬edCouÁ”$CORFUSMR
 
ex‹nds
 
CÜfuSh¬edCouÁ”
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuSh¬edCouÁ”
> {

24 
public
 
	gICÜfuSMRProxy
<
	gCÜfuSh¬edCouÁ”
> 
	g´oxy_CORFUSMR
;

26 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuSh¬edCouÁ”
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<CorfuSharedCounter>>()

27 .
put
("S‘", (
obj
, 
¬gs
è-> { obj.
S‘
((è¬gs[0]); 
nuÎ
;})

28 .
put
("Inüem’t", (
obj
, 
¬gs
è-> {  obj.
Inüem’t
();}).
bud
();

30 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<CÜfuSh¬edCouÁ”>>().
bud
();

32 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<CÜfuSh¬edCouÁ”>>().
bud
();

34 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

36 
public
 
CÜfuSh¬edCouÁ”$CORFUSMR
() {

37 
su³r
();

40 
public
 
	gICÜfuSMRProxy
<
	gCÜfuSh¬edCouÁ”
> 
g‘CÜfuSMRProxy
() {

41  
	g´oxy_CORFUSMR
;

44 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
CÜfuSh¬edCouÁ”
> 
´oxy
) {

45 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

48 @
	gOv”ride


49 @
MutÜ
(

50 
Çme
 = "Set"

52 
public
 
S‘
(
Ãwv®ue
) {

53 
´oxy_CORFUSMR
.
logUpd©e
("S‘",
çl£
,
nuÎ
,
Ãwv®ue
);

56 @
Ov”ride


57 
public
 
CÜfuSh¬edCouÁ”
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

58  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

61 @
Ov”ride


62 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

63  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

66 @
	gOv”ride


67 @
MutÜAcûssÜ
(

68 
Çme
 = "Increment"

70 
public
 
Inüem’t
() {

71 
add»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("Inüem’t",
Œue
,
nuÎ
);

72  (è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
nuÎ
);

75 @
	gOv”ride


76 @
AcûssÜ


77 
public
 
G‘
() {

78  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
G‘
();},
nuÎ
);

81 @
Ov”ride


82 
public
 
hashCode
() {

83  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

86 @
Ov”ride


87 
public
 
SŒšg
 
toSŒšg
() {

88  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

91 @
	gOv”ride


92 @
PassThrough


93 
public
 
şo£
() {

94 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

97 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuSh¬edCouÁ”
>> 
g‘CÜfuSMRUpÿÎM­
() {

98  
	gupÿÎM­_CORFUSMR
;

101 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
g‘CÜfuUndoRecÜdM­
() {

102  
	gundoRecÜdM­_CORFUSMR
;

105 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
g‘CÜfuUndoM­
() {

106  
	gundoM­_CORFUSMR
;

109 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

110  
	g»£tS‘_CORFUSMR
;

	@samples/target/generated-sources/samples/protobuf/PersonProfile.java

4 
·ckage
 
	g§m¶es
.
	g´Ùobuf
;

6 
public
 
fš®
 cÏs 
	cP”sÚProfe
 {

7 
´iv©e
 
	$P”sÚProfe
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
NameOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
	gjava
.
	gÏng
.
SŒšg
 
g‘Fœ¡Name
();

28 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


29 
g‘Fœ¡NameBy‹s
();

34 
	gjava
.
	gÏng
.
SŒšg
 
g‘La¡Name
();

38 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


39 
g‘La¡NameBy‹s
();

44 
public
 
fš®
 
şass
 
Name
 
ex‹nds


45 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


47 
	gNameOrBud”
 {

49 
´iv©e
 
Name
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

50 
su³r
(
bud”
);

52 
´iv©e
 
Name
() {

53 
	gfœ¡Name_
 = "";

54 
	gÏ¡Name_
 = "";

57 @
	gjava
.
	gÏng
.
Ov”ride


58 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


59 
g‘UnknownF›lds
() {

60  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

62 
´iv©e
 
Name
(

63 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

64 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

65 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

66 
this
();

67 
	gmubË_b™F›ld0_
 = 0;

68 
	gŒy
 {

69 
boŞ—n
 
	gdÚe
 = 
çl£
;

70 !
	gdÚe
) {

71 
	gg
 = 
šput
.
»adTag
();

72 
	gg
) {

74 
dÚe
 = 
Œue
;

77 ià(!
šput
.
skF›ld
(
g
)) {

78 
dÚe
 = 
Œue
;

83 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

85 
	gfœ¡Name_
 = 
s
;

89 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

91 
	gÏ¡Name_
 = 
s
;

96 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

97 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

98 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

99 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

100 
e
).
£tUnfšishedMes§ge
(
this
);

101 } 
	gfš®ly
 {

102 
makeEx‹nsiÚsImmubË
();

105 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


106 
g‘DesütÜ
() {

107  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_desütÜ
;

110 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


111 
š‹º®G‘F›ldAcûssÜTabË
() {

112  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_f›ldAcûssÜTabË


113 .
’su»F›ldAcûssÜsIn™Ÿlized
(

114 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
şass
, sam¶es.´Ùobuf.P”sÚProfe.Name.
Bud”
.class);

117 
public
 
fš®
 
	gFIRST_NAME_FIELD_NUMBER
 = 1;

118 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gfœ¡Name_
;

122 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Fœ¡Name
() {

123 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
fœ¡Name_
;

124 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

125  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

127 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

128 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

129 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

130 
	gfœ¡Name_
 = 
s
;

131  
	gs
;

137 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


138 
g‘Fœ¡NameBy‹s
() {

139 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
fœ¡Name_
;

140 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

141 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

142 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

143 (
java
.
Ïng
.
SŒšg
è
»f
);

144 
	gfœ¡Name_
 = 
b
;

145  
	gb
;

147  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

151 
public
 
fš®
 
	gLAST_NAME_FIELD_NUMBER
 = 2;

152 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gÏ¡Name_
;

156 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘La¡Name
() {

157 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Ï¡Name_
;

158 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

159  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

161 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

162 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

163 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

164 
	gÏ¡Name_
 = 
s
;

165  
	gs
;

171 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


172 
g‘La¡NameBy‹s
() {

173 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Ï¡Name_
;

174 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

175 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

176 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

177 (
java
.
Ïng
.
SŒšg
è
»f
);

178 
	gÏ¡Name_
 = 
b
;

179  
	gb
;

181  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

185 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

186 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

187 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

188 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

189 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

191 
	gmemoizedIsIn™Ÿlized
 = 1;

192  
	gŒue
;

195 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

196 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

197 ià(!
g‘Fœ¡NameBy‹s
().
isEm±y
()) {

198 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
fœ¡Name_
);

200 ià(!
g‘La¡NameBy‹s
().
isEm±y
()) {

201 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
Ï¡Name_
);

205 
public
 
g‘S”ŸlizedSize
() {

206 
	gsize
 = 
memoizedSize
;

207 ià(
	gsize
 !ğ-1è 
size
;

209 
	gsize
 = 0;

210 ià(!
g‘Fœ¡NameBy‹s
().
isEm±y
()) {

211 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
fœ¡Name_
);

213 ià(!
g‘La¡NameBy‹s
().
isEm±y
()) {

214 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
Ï¡Name_
);

216 
	gmemoizedSize
 = 
size
;

217  
	gsize
;

220 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

221 @
	gjava
.
	gÏng
.
Ov”ride


222 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

223 ià(
	gobj
 =ğ
this
) {

224  
Œue
;

226 ià(!(
obj
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
)) {

227  
	gsu³r
.
equ®s
(
obj
);

229 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	gÙh”
 = (
§m¶es
.
´Ùobuf
.
P”sÚProfe
.Nameè
obj
;

231 
boŞ—n
 
	g»suÉ
 = 
Œue
;

232 
	g»suÉ
 = 
»suÉ
 && 
g‘Fœ¡Name
()

233 .
equ®s
(
Ùh”
.
g‘Fœ¡Name
());

234 
	g»suÉ
 = 
»suÉ
 && 
g‘La¡Name
()

235 .
equ®s
(
Ùh”
.
g‘La¡Name
());

236  
	g»suÉ
;

239 @
	gjava
.
	gÏng
.
Ov”ride


240 
public
 
hashCode
() {

241 ià(
	gmemoizedHashCode
 != 0) {

242  
memoizedHashCode
;

244 
	ghash
 = 41;

245 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

246 
	ghash
 = (37 * 
hash
è+ 
FIRST_NAME_FIELD_NUMBER
;

247 
	ghash
 = (53 * 
hash
è+ 
g‘Fœ¡Name
().
hashCode
();

248 
	ghash
 = (37 * 
hash
è+ 
LAST_NAME_FIELD_NUMBER
;

249 
	ghash
 = (53 * 
hash
è+ 
g‘La¡Name
().
hashCode
();

250 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

251 
	gmemoizedHashCode
 = 
hash
;

252  
	ghash
;

255 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(

256 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

257 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

258  
	gPARSER
.
·r£From
(
d©a
);

260 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(

261 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

262 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

263 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

264  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

266 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(
by‹
[] 
d©a
)

267 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

268  
	gPARSER
.
·r£From
(
d©a
);

270 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(

271 
by‹
[] 
d©a
,

272 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

273 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

274  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

276 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

277 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

278  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


279 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

281 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(

282 
java
.
io
.
IÅutSŒ—m
 
šput
,

283 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

284 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

285  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


286 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

288 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

289 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

290  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


291 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

293 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£D–im™edFrom
(

294 
java
.
io
.
IÅutSŒ—m
 
šput
,

295 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

296 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

297  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


298 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

300 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(

301 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

302 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

303  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


304 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

306 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
·r£From
(

307 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

308 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

309 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

310  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


311 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

314 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

315 
public
 
Bud”
 
ÃwBud”
() {

316  
	gDEFAULT_INSTANCE
.
toBud”
();

318 
public
 
Bud”
 
ÃwBud”
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
 
´ÙÙy³
) {

319  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

321 
public
 
Bud”
 
toBud”
() {

322  
	gthis
 =ğ
DEFAULT_INSTANCE


323 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

326 @
	gjava
.
	gÏng
.
Ov”ride


327 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

328 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

329 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

330  
	gbud”
;

335 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


336 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


338 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gNameOrBud”
 {

339 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


340 
g‘DesütÜ
() {

341  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_desütÜ
;

344 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


345 
š‹º®G‘F›ldAcûssÜTabË
() {

346  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_f›ldAcûssÜTabË


347 .
’su»F›ldAcûssÜsIn™Ÿlized
(

348 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
şass
, sam¶es.´Ùobuf.P”sÚProfe.Name.
Bud”
.class);

352 
´iv©e
 
Bud”
() {

353 
maybeFÜûBud”In™Ÿliz©iÚ
();

356 
´iv©e
 
Bud”
(

357 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

358 
su³r
(
·»Á
);

359 
maybeFÜûBud”In™Ÿliz©iÚ
();

361 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

362 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


363 .
	g®waysU£F›ldBud”s
) {

366 
public
 
Bud”
 
ş—r
() {

367 
	gsu³r
.
ş—r
();

368 
	gfœ¡Name_
 = "";

370 
	gÏ¡Name_
 = "";

372  
	gthis
;

375 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


376 
g‘DesütÜFÜTy³
() {

377  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_desütÜ
;

380 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
g‘DeçuÉIn¡ªûFÜTy³
() {

381  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
.
g‘DeçuÉIn¡ªû
();

384 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
bud
() {

385 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	g»suÉ
 = 
budP¬tŸl
();

386 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

387 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

389  
	g»suÉ
;

392 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
budP¬tŸl
() {

393 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	g»suÉ
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.Name(
this
);

394 
	g»suÉ
.
	gfœ¡Name_
 = 
fœ¡Name_
;

395 
	g»suÉ
.
	gÏ¡Name_
 = 
Ï¡Name_
;

396 
ÚBut
();

397  
	g»suÉ
;

400 
public
 
Bud”
 
şÚe
() {

401  (
	gBud”
è
	gsu³r
.
şÚe
();

403 
public
 
Bud”
 
£tF›ld
(

404 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

405 
Objeù
 
v®ue
) {

406  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

408 
public
 
Bud”
 
ş—rF›ld
(

409 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

410  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

412 
public
 
Bud”
 
ş—rOÃof
(

413 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

414  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

416 
public
 
Bud”
 
£tR•—‹dF›ld
(

417 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

418 
šdex
, 
Objeù
 
v®ue
) {

419  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

421 
public
 
Bud”
 
addR•—‹dF›ld
(

422 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

423 
Objeù
 
v®ue
) {

424  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

426 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

427 ià(
Ùh”
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
) {

428  
m”geFrom
((
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
)
Ùh”
);

430 
	gsu³r
.
m”geFrom
(
Ùh”
);

431  
	gthis
;

435 
public
 
Bud”
 
m”geFrom
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
 
Ùh”
) {

436 ià(
	gÙh”
 =ğ
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
g‘DeçuÉIn¡ªû
()è 
this
;

437 ià(!
	gÙh”
.
g‘Fœ¡Name
().
isEm±y
()) {

438 
	gfœ¡Name_
 = 
Ùh”
.
fœ¡Name_
;

439 
ÚChªged
();

441 ià(!
	gÙh”
.
g‘La¡Name
().
isEm±y
()) {

442 
	gÏ¡Name_
 = 
Ùh”
.
Ï¡Name_
;

443 
ÚChªged
();

445 
ÚChªged
();

446  
	gthis
;

449 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

450  
	gŒue
;

453 
public
 
Bud”
 
m”geFrom
(

454 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

455 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

456 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

457 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	g·r£dMes§ge
 = 
nuÎ
;

458 
	gŒy
 {

459 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

460 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

461 
	g·r£dMes§ge
 = (
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
è
e
.
g‘UnfšishedMes§ge
();

462 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

463 } 
	gfš®ly
 {

464 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

465 
m”geFrom
(
·r£dMes§ge
);

468  
	gthis
;

471 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gfœ¡Name_
 = "";

475 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Fœ¡Name
() {

476 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
fœ¡Name_
;

477 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

478 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

479 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

480 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

481 
	gfœ¡Name_
 = 
s
;

482  
	gs
;

484  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

490 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


491 
g‘Fœ¡NameBy‹s
() {

492 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
fœ¡Name_
;

493 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

494 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

495 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

496 (
java
.
Ïng
.
SŒšg
è
»f
);

497 
	gfœ¡Name_
 = 
b
;

498  
	gb
;

500  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

506 
public
 
Bud”
 
£tFœ¡Name
(

507 
java
.
Ïng
.
SŒšg
 
v®ue
) {

508 ià(
	gv®ue
 =ğ
nuÎ
) {

509 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

512 
	gfœ¡Name_
 = 
v®ue
;

513 
ÚChªged
();

514  
	gthis
;

519 
public
 
Bud”
 
ş—rFœ¡Name
() {

521 
	gfœ¡Name_
 = 
g‘DeçuÉIn¡ªû
().
g‘Fœ¡Name
();

522 
ÚChªged
();

523  
	gthis
;

528 
public
 
Bud”
 
£tFœ¡NameBy‹s
(

529 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

530 ià(
	gv®ue
 =ğ
nuÎ
) {

531 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

533 
checkBy‹SŒšgIsUtf8
(
v®ue
);

535 
	gfœ¡Name_
 = 
v®ue
;

536 
ÚChªged
();

537  
	gthis
;

540 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gÏ¡Name_
 = "";

544 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘La¡Name
() {

545 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Ï¡Name_
;

546 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

547 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

548 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

549 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

550 
	gÏ¡Name_
 = 
s
;

551  
	gs
;

553  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

559 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


560 
g‘La¡NameBy‹s
() {

561 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Ï¡Name_
;

562 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

563 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

564 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

565 (
java
.
Ïng
.
SŒšg
è
»f
);

566 
	gÏ¡Name_
 = 
b
;

567  
	gb
;

569  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

575 
public
 
Bud”
 
£tLa¡Name
(

576 
java
.
Ïng
.
SŒšg
 
v®ue
) {

577 ià(
	gv®ue
 =ğ
nuÎ
) {

578 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

581 
	gÏ¡Name_
 = 
v®ue
;

582 
ÚChªged
();

583  
	gthis
;

588 
public
 
Bud”
 
ş—rLa¡Name
() {

590 
	gÏ¡Name_
 = 
g‘DeçuÉIn¡ªû
().
g‘La¡Name
();

591 
ÚChªged
();

592  
	gthis
;

597 
public
 
Bud”
 
£tLa¡NameBy‹s
(

598 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

599 ià(
	gv®ue
 =ğ
nuÎ
) {

600 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

602 
checkBy‹SŒšgIsUtf8
(
v®ue
);

604 
	gÏ¡Name_
 = 
v®ue
;

605 
ÚChªged
();

606  
	gthis
;

608 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

609 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

610  
	gthis
;

613 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

614 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

615  
	gthis
;

623 
´iv©e
 
fš®
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	gDEFAULT_INSTANCE
;

625 
	gDEFAULT_INSTANCE
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
();

628 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
g‘DeçuÉIn¡ªû
() {

629  
	gDEFAULT_INSTANCE
;

632 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gName
>

633 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Name
>() {

634 
public
 
Name
 
·r£P¬tŸlFrom
(

635 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

636 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

637 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

638  
Ãw
 
Name
(
šput
, 
ex‹nsiÚRegi¡ry
);

642 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gName
> 
·r£r
() {

643  
	gPARSER
;

646 @
	gjava
.
	gÏng
.
Ov”ride


647 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gName
> 
g‘P¬£rFÜTy³
() {

648  
	gPARSER
;

651 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
g‘DeçuÉIn¡ªûFÜTy³
() {

652  
	gDEFAULT_INSTANCE
;

657 
public
 
š‹rçû
 
P”sÚOrBud”
 
ex‹nds


659 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

664 
boŞ—n
 
hasName
();

668 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
g‘Name
();

672 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
NameOrBud”
 
g‘NameOrBud”
();

677 
g‘Age
();

682 
boŞ—n
 
hasExp
();

686 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
g‘Exp
();

690 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nûOrBud”
 
g‘ExpOrBud”
();

695 
public
 
fš®
 
şass
 
P”sÚ
 
ex‹nds


696 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


698 
	gP”sÚOrBud”
 {

700 
´iv©e
 
P”sÚ
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

701 
su³r
(
bud”
);

703 
´iv©e
 
P”sÚ
() {

704 
	gage_
 = 0;

707 @
	gjava
.
	gÏng
.
Ov”ride


708 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


709 
g‘UnknownF›lds
() {

710  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

712 
´iv©e
 
P”sÚ
(

713 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

714 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

715 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

716 
this
();

717 
	gmubË_b™F›ld0_
 = 0;

718 
	gŒy
 {

719 
boŞ—n
 
	gdÚe
 = 
çl£
;

720 !
	gdÚe
) {

721 
	gg
 = 
šput
.
»adTag
();

722 
	gg
) {

724 
dÚe
 = 
Œue
;

727 ià(!
šput
.
skF›ld
(
g
)) {

728 
dÚe
 = 
Œue
;

733 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
Bud”
 
subBud”
 = 
nuÎ
;

734 ià(
	gÇme_
 !ğ
nuÎ
) {

735 
subBud”
 = 
Çme_
.
toBud”
();

737 
	gÇme_
 = 
šput
.
»adMes§ge
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

738 ià(
	gsubBud”
 !ğ
nuÎ
) {

739 
subBud”
.
m”geFrom
(
Çme_
);

740 
	gÇme_
 = 
subBud”
.
budP¬tŸl
();

747 
age_
 = 
šput
.
»adIÁ32
();

751 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
Bud”
 
subBud”
 = 
nuÎ
;

752 ià(
	gexp_
 !ğ
nuÎ
) {

753 
subBud”
 = 
exp_
.
toBud”
();

755 
	gexp_
 = 
šput
.
»adMes§ge
(
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

756 ià(
	gsubBud”
 !ğ
nuÎ
) {

757 
subBud”
.
m”geFrom
(
exp_
);

758 
	gexp_
 = 
subBud”
.
budP¬tŸl
();

765 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

766 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

767 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

768 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

769 
e
).
£tUnfšishedMes§ge
(
this
);

770 } 
	gfš®ly
 {

771 
makeEx‹nsiÚsImmubË
();

774 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


775 
g‘DesütÜ
() {

776  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_desütÜ
;

779 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


780 
š‹º®G‘F›ldAcûssÜTabË
() {

781  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_f›ldAcûssÜTabË


782 .
’su»F›ldAcûssÜsIn™Ÿlized
(

783 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
.
şass
, sam¶es.´Ùobuf.P”sÚProfe.P”sÚ.
Bud”
.class);

786 
public
 
fš®
 
	gNAME_FIELD_NUMBER
 = 1;

787 
´iv©e
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	gÇme_
;

791 
public
 
boŞ—n
 
hasName
() {

792  
	gÇme_
 !ğ
nuÎ
;

797 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
g‘Name
() {

798  
	gÇme_
 =ğ
nuÎ
 ? 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
g‘DeçuÉIn¡ªû
(è: 
Çme_
;

803 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
NameOrBud”
 
g‘NameOrBud”
() {

804  
g‘Name
();

807 
public
 
fš®
 
	gAGE_FIELD_NUMBER
 = 2;

808 
´iv©e
 
	gage_
;

812 
public
 
g‘Age
() {

813  
	gage_
;

816 
public
 
fš®
 
	gEXP_FIELD_NUMBER
 = 3;

817 
´iv©e
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	gexp_
;

821 
public
 
boŞ—n
 
hasExp
() {

822  
	gexp_
 !ğ
nuÎ
;

827 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
g‘Exp
() {

828  
	gexp_
 =ğ
nuÎ
 ? 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
g‘DeçuÉIn¡ªû
(è: 
exp_
;

833 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nûOrBud”
 
g‘ExpOrBud”
() {

834  
g‘Exp
();

837 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

838 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

839 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

840 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

841 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

843 
	gmemoizedIsIn™Ÿlized
 = 1;

844  
	gŒue
;

847 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

848 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

849 ià(
	gÇme_
 !ğ
nuÎ
) {

850 
ouut
.
wr™eMes§ge
(1, 
g‘Name
());

852 ià(
	gage_
 != 0) {

853 
ouut
.
wr™eIÁ32
(2, 
age_
);

855 ià(
	gexp_
 !ğ
nuÎ
) {

856 
ouut
.
wr™eMes§ge
(3, 
g‘Exp
());

860 
public
 
g‘S”ŸlizedSize
() {

861 
	gsize
 = 
memoizedSize
;

862 ià(
	gsize
 !ğ-1è 
size
;

864 
	gsize
 = 0;

865 ià(
	gÇme_
 !ğ
nuÎ
) {

866 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


867 .
compu‹Mes§geSize
(1, 
g‘Name
());

869 ià(
	gage_
 != 0) {

870 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


871 .
compu‹IÁ32Size
(2, 
age_
);

873 ià(
	gexp_
 !ğ
nuÎ
) {

874 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


875 .
compu‹Mes§geSize
(3, 
g‘Exp
());

877 
	gmemoizedSize
 = 
size
;

878  
	gsize
;

881 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

882 @
	gjava
.
	gÏng
.
Ov”ride


883 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

884 ià(
	gobj
 =ğ
this
) {

885  
Œue
;

887 ià(!(
obj
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gP”sÚ
)) {

888  
	gsu³r
.
equ®s
(
obj
);

890 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
	gÙh”
 = (
§m¶es
.
´Ùobuf
.
P”sÚProfe
.P”sÚè
obj
;

892 
boŞ—n
 
	g»suÉ
 = 
Œue
;

893 
	g»suÉ
 = 
»suÉ
 && (
hasName
(è=ğ
Ùh”
.hasName());

894 ià(
hasName
()) {

895 
	g»suÉ
 = 
»suÉ
 && 
g‘Name
()

896 .
equ®s
(
Ùh”
.
g‘Name
());

898 
	g»suÉ
 = 
»suÉ
 && (
g‘Age
()

899 =ğ
Ùh”
.
g‘Age
());

900 
	g»suÉ
 = 
»suÉ
 && (
hasExp
(è=ğ
Ùh”
.hasExp());

901 ià(
hasExp
()) {

902 
	g»suÉ
 = 
»suÉ
 && 
g‘Exp
()

903 .
equ®s
(
Ùh”
.
g‘Exp
());

905  
	g»suÉ
;

908 @
	gjava
.
	gÏng
.
Ov”ride


909 
public
 
hashCode
() {

910 ià(
	gmemoizedHashCode
 != 0) {

911  
memoizedHashCode
;

913 
	ghash
 = 41;

914 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

915 ià(
hasName
()) {

916 
	ghash
 = (37 * 
hash
è+ 
NAME_FIELD_NUMBER
;

917 
	ghash
 = (53 * 
hash
è+ 
g‘Name
().
hashCode
();

919 
	ghash
 = (37 * 
hash
è+ 
AGE_FIELD_NUMBER
;

920 
	ghash
 = (53 * 
hash
è+ 
g‘Age
();

921 ià(
hasExp
()) {

922 
	ghash
 = (37 * 
hash
è+ 
EXP_FIELD_NUMBER
;

923 
	ghash
 = (53 * 
hash
è+ 
g‘Exp
().
hashCode
();

925 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

926 
	gmemoizedHashCode
 = 
hash
;

927  
	ghash
;

930 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(

931 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

932 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

933  
	gPARSER
.
·r£From
(
d©a
);

935 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(

936 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

937 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

938 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

939  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

941 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(
by‹
[] 
d©a
)

942 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

943  
	gPARSER
.
·r£From
(
d©a
);

945 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(

946 
by‹
[] 
d©a
,

947 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

948 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

949  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

951 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

952 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

953  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


954 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

956 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(

957 
java
.
io
.
IÅutSŒ—m
 
šput
,

958 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

959 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

960  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


961 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

963 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

964 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

965  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


966 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

968 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£D–im™edFrom
(

969 
java
.
io
.
IÅutSŒ—m
 
šput
,

970 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

971 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

972  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


973 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

975 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(

976 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

977 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

978  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


979 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

981 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
·r£From
(

982 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

983 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

984 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

985  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


986 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

989 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

990 
public
 
Bud”
 
ÃwBud”
() {

991  
	gDEFAULT_INSTANCE
.
toBud”
();

993 
public
 
Bud”
 
ÃwBud”
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
 
´ÙÙy³
) {

994  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

996 
public
 
Bud”
 
toBud”
() {

997  
	gthis
 =ğ
DEFAULT_INSTANCE


998 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1001 @
	gjava
.
	gÏng
.
Ov”ride


1002 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1003 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1004 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1005  
	gbud”
;

1010 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1011 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1013 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gP”sÚOrBud”
 {

1014 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1015 
g‘DesütÜ
() {

1016  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_desütÜ
;

1019 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1020 
š‹º®G‘F›ldAcûssÜTabË
() {

1021  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_f›ldAcûssÜTabË


1022 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1023 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
.
şass
, sam¶es.´Ùobuf.P”sÚProfe.P”sÚ.
Bud”
.class);

1027 
´iv©e
 
Bud”
() {

1028 
maybeFÜûBud”In™Ÿliz©iÚ
();

1031 
´iv©e
 
Bud”
(

1032 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1033 
su³r
(
·»Á
);

1034 
maybeFÜûBud”In™Ÿliz©iÚ
();

1036 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1037 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1038 .
	g®waysU£F›ldBud”s
) {

1041 
public
 
Bud”
 
ş—r
() {

1042 
	gsu³r
.
ş—r
();

1043 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1044 
Çme_
 = 
nuÎ
;

1046 
	gÇme_
 = 
nuÎ
;

1047 
	gÇmeBud”_
 = 
nuÎ
;

1049 
	gage_
 = 0;

1051 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1052 
exp_
 = 
nuÎ
;

1054 
	gexp_
 = 
nuÎ
;

1055 
	gexpBud”_
 = 
nuÎ
;

1057  
	gthis
;

1060 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1061 
g‘DesütÜFÜTy³
() {

1062  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_desütÜ
;

1065 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1066  
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gP”sÚ
.
g‘DeçuÉIn¡ªû
();

1069 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
bud
() {

1070 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
	g»suÉ
 = 
budP¬tŸl
();

1071 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1072 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1074  
	g»suÉ
;

1077 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
budP¬tŸl
() {

1078 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
	g»suÉ
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.P”sÚ(
this
);

1079 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1080 
»suÉ
.
Çme_
 =‚ame_;

1082 
	g»suÉ
.
	gÇme_
 = 
ÇmeBud”_
.
bud
();

1084 
	g»suÉ
.
	gage_
 = 
age_
;

1085 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1086 
»suÉ
.
exp_
 =ƒxp_;

1088 
	g»suÉ
.
	gexp_
 = 
expBud”_
.
bud
();

1090 
ÚBut
();

1091  
	g»suÉ
;

1094 
public
 
Bud”
 
şÚe
() {

1095  (
	gBud”
è
	gsu³r
.
şÚe
();

1097 
public
 
Bud”
 
£tF›ld
(

1098 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1099 
Objeù
 
v®ue
) {

1100  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1102 
public
 
Bud”
 
ş—rF›ld
(

1103 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1104  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1106 
public
 
Bud”
 
ş—rOÃof
(

1107 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1108  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1110 
public
 
Bud”
 
£tR•—‹dF›ld
(

1111 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1112 
šdex
, 
Objeù
 
v®ue
) {

1113  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1115 
public
 
Bud”
 
addR•—‹dF›ld
(

1116 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1117 
Objeù
 
v®ue
) {

1118  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1120 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1121 ià(
Ùh”
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gP”sÚ
) {

1122  
m”geFrom
((
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
)
Ùh”
);

1124 
	gsu³r
.
m”geFrom
(
Ùh”
);

1125  
	gthis
;

1129 
public
 
Bud”
 
m”geFrom
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
 
Ùh”
) {

1130 ià(
	gÙh”
 =ğ
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
.
g‘DeçuÉIn¡ªû
()è 
this
;

1131 ià(
	gÙh”
.
hasName
()) {

1132 
m”geName
(
Ùh”
.
g‘Name
());

1134 ià(
	gÙh”
.
g‘Age
() != 0) {

1135 
£tAge
(
Ùh”
.
g‘Age
());

1137 ià(
	gÙh”
.
hasExp
()) {

1138 
m”geExp
(
Ùh”
.
g‘Exp
());

1140 
ÚChªged
();

1141  
	gthis
;

1144 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1145  
	gŒue
;

1148 
public
 
Bud”
 
m”geFrom
(

1149 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1150 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1151 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1152 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
	g·r£dMes§ge
 = 
nuÎ
;

1153 
	gŒy
 {

1154 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1155 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1156 
	g·r£dMes§ge
 = (
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
è
e
.
g‘UnfšishedMes§ge
();

1157 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1158 } 
	gfš®ly
 {

1159 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1160 
m”geFrom
(
·r£dMes§ge
);

1163  
	gthis
;

1166 
´iv©e
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
	gÇme_
 = 
nuÎ
;

1167 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1168 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
, sam¶es.´Ùobuf.P”sÚProfe.Name.
	gBud”
, sam¶es.´Ùobuf.P”sÚProfe.
	gNameOrBud”
> 
	gÇmeBud”_
;

1172 
public
 
boŞ—n
 
hasName
() {

1173  
	gÇmeBud”_
 !ğ
nuÎ
 || 
Çme_
 !=‚ull;

1178 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
Name
 
g‘Name
() {

1179 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1180  
Çme_
 =ğ
nuÎ
 ? 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
g‘DeçuÉIn¡ªû
() :‚ame_;

1182  
	gÇmeBud”_
.
g‘Mes§ge
();

1188 
public
 
Bud”
 
£tName
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
 
v®ue
) {

1189 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1190 ià(
v®ue
 =ğ
nuÎ
) {

1191 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1193 
	gÇme_
 = 
v®ue
;

1194 
ÚChªged
();

1196 
	gÇmeBud”_
.
£tMes§ge
(
v®ue
);

1199  
	gthis
;

1204 
public
 
Bud”
 
£tName
(

1205 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
Bud”
 
bud”FÜV®ue
) {

1206 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1207 
Çme_
 = 
bud”FÜV®ue
.
bud
();

1208 
ÚChªged
();

1210 
	gÇmeBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

1213  
	gthis
;

1218 
public
 
Bud”
 
m”geName
(
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
 
v®ue
) {

1219 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1220 ià(
Çme_
 !ğ
nuÎ
) {

1221 
Çme_
 =

1222 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
ÃwBud”
(
Çme_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

1224 
	gÇme_
 = 
v®ue
;

1226 
ÚChªged
();

1228 
	gÇmeBud”_
.
m”geFrom
(
v®ue
);

1231  
	gthis
;

1236 
public
 
Bud”
 
ş—rName
() {

1237 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1238 
Çme_
 = 
nuÎ
;

1239 
ÚChªged
();

1241 
	gÇme_
 = 
nuÎ
;

1242 
	gÇmeBud”_
 = 
nuÎ
;

1245  
	gthis
;

1250 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
.
Bud”
 
g‘NameBud”
() {

1252 
ÚChªged
();

1253  
g‘NameF›ldBud”
().
g‘Bud”
();

1258 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
NameOrBud”
 
g‘NameOrBud”
() {

1259 ià(
	gÇmeBud”_
 !ğ
nuÎ
) {

1260  
ÇmeBud”_
.
g‘Mes§geOrBud”
();

1262  
	gÇme_
 =ğ
nuÎ
 ?

1263 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
.
g‘DeçuÉIn¡ªû
(è: 
Çme_
;

1269 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1270 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
, sam¶es.´Ùobuf.P”sÚProfe.Name.
	gBud”
, sam¶es.´Ùobuf.P”sÚProfe.
	gNameOrBud”
>

1271 
g‘NameF›ldBud”
() {

1272 ià(
	gÇmeBud”_
 =ğ
nuÎ
) {

1273 
ÇmeBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

1274 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
Name
, 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
	gName
.
	gBud”
, sam¶es.´Ùobuf.P”sÚProfe.
	gNameOrBud”
>(

1275 
g‘Name
(),

1276 
g‘P¬’tFÜChd»n
(),

1277 
isCËª
());

1278 
	gÇme_
 = 
nuÎ
;

1280  
	gÇmeBud”_
;

1283 
´iv©e
 
	gage_
 ;

1287 
public
 
g‘Age
() {

1288  
	gage_
;

1293 
public
 
Bud”
 
£tAge
(
v®ue
) {

1295 
	gage_
 = 
v®ue
;

1296 
ÚChªged
();

1297  
	gthis
;

1302 
public
 
Bud”
 
ş—rAge
() {

1304 
	gage_
 = 0;

1305 
ÚChªged
();

1306  
	gthis
;

1309 
´iv©e
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	gexp_
 = 
nuÎ
;

1310 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1311 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
, sam¶es.´Ùobuf.WÜkEx³r›nû.Ex³r›nû.
	gBud”
, sam¶es.´Ùobuf.WÜkEx³r›nû.
	gEx³r›nûOrBud”
> 
	gexpBud”_
;

1315 
public
 
boŞ—n
 
hasExp
() {

1316  
	gexpBud”_
 !ğ
nuÎ
 || 
exp_
 !=‚ull;

1321 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
g‘Exp
() {

1322 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1323  
exp_
 =ğ
nuÎ
 ? 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
g‘DeçuÉIn¡ªû
() :ƒxp_;

1325  
	gexpBud”_
.
g‘Mes§ge
();

1331 
public
 
Bud”
 
£tExp
(
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
 
v®ue
) {

1332 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1333 ià(
v®ue
 =ğ
nuÎ
) {

1334 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1336 
	gexp_
 = 
v®ue
;

1337 
ÚChªged
();

1339 
	gexpBud”_
.
£tMes§ge
(
v®ue
);

1342  
	gthis
;

1347 
public
 
Bud”
 
£tExp
(

1348 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
Bud”
 
bud”FÜV®ue
) {

1349 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1350 
exp_
 = 
bud”FÜV®ue
.
bud
();

1351 
ÚChªged
();

1353 
	gexpBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

1356  
	gthis
;

1361 
public
 
Bud”
 
m”geExp
(
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
 
v®ue
) {

1362 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1363 ià(
exp_
 !ğ
nuÎ
) {

1364 
exp_
 =

1365 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
ÃwBud”
(
exp_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

1367 
	gexp_
 = 
v®ue
;

1369 
ÚChªged
();

1371 
	gexpBud”_
.
m”geFrom
(
v®ue
);

1374  
	gthis
;

1379 
public
 
Bud”
 
ş—rExp
() {

1380 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1381 
exp_
 = 
nuÎ
;

1382 
ÚChªged
();

1384 
	gexp_
 = 
nuÎ
;

1385 
	gexpBud”_
 = 
nuÎ
;

1388  
	gthis
;

1393 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
.
Bud”
 
g‘ExpBud”
() {

1395 
ÚChªged
();

1396  
g‘ExpF›ldBud”
().
g‘Bud”
();

1401 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nûOrBud”
 
g‘ExpOrBud”
() {

1402 ià(
	gexpBud”_
 !ğ
nuÎ
) {

1403  
expBud”_
.
g‘Mes§geOrBud”
();

1405  
	gexp_
 =ğ
nuÎ
 ?

1406 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
g‘DeçuÉIn¡ªû
(è: 
exp_
;

1412 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1413 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
, sam¶es.´Ùobuf.WÜkEx³r›nû.Ex³r›nû.
	gBud”
, sam¶es.´Ùobuf.WÜkEx³r›nû.
	gEx³r›nûOrBud”
>

1414 
g‘ExpF›ldBud”
() {

1415 ià(
	gexpBud”_
 =ğ
nuÎ
) {

1416 
expBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

1417 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
, 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
.
	gBud”
, sam¶es.´Ùobuf.WÜkEx³r›nû.
	gEx³r›nûOrBud”
>(

1418 
g‘Exp
(),

1419 
g‘P¬’tFÜChd»n
(),

1420 
isCËª
());

1421 
	gexp_
 = 
nuÎ
;

1423  
	gexpBud”_
;

1425 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1426 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1427  
	gthis
;

1430 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1431 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1432  
	gthis
;

1440 
´iv©e
 
fš®
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
	gDEFAULT_INSTANCE
;

1442 
	gDEFAULT_INSTANCE
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
P”sÚProfe
.
P”sÚ
();

1445 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
g‘DeçuÉIn¡ªû
() {

1446  
	gDEFAULT_INSTANCE
;

1449 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gP”sÚ
>

1450 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
P”sÚ
>() {

1451 
public
 
P”sÚ
 
·r£P¬tŸlFrom
(

1452 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1453 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1454 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1455  
Ãw
 
P”sÚ
(
šput
, 
ex‹nsiÚRegi¡ry
);

1459 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gP”sÚ
> 
·r£r
() {

1460  
	gPARSER
;

1463 @
	gjava
.
	gÏng
.
Ov”ride


1464 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gP”sÚ
> 
g‘P¬£rFÜTy³
() {

1465  
	gPARSER
;

1468 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gP”sÚProfe
.
P”sÚ
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1469  
	gDEFAULT_INSTANCE
;

1474 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1475 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_desütÜ
;

1476 
´iv©e
 
fš®


1477 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1478 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_f›ldAcûssÜTabË
;

1479 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1480 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_desütÜ
;

1481 
´iv©e
 
fš®


1482 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1483 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_f›ldAcûssÜTabË
;

1485 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


1486 
	$g‘DesütÜ
() {

1487  
desütÜ
;

1488 
	}
}

1489 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


1490 
	gdesütÜ
;

1492 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

1502 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

1503 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

1504 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

1505 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

1506 
desütÜ
 = 
roÙ
;

1507  
	gnuÎ
;

1510 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


1511 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

1512 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

1513 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
g‘DesütÜ
(),

1514 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
g‘DesütÜ
(),

1515 }, 
assigÃr
);

1516 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_desütÜ
 =

1517 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

1518 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Name_f›ldAcûssÜTabË
 = 
Ãw


1519 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

1520 
š‹º®_¡©ic_§m¶es_´Ùobuf_Name_desütÜ
,

1521 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "FirstName", "LastName", });

1522 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_desütÜ
 =

1523 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

1524 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_f›ldAcûssÜTabË
 = 
Ãw


1525 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

1526 
š‹º®_¡©ic_§m¶es_´Ùobuf_P”sÚ_desütÜ
,

1527 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Name", "Age", "Exp", });

1528 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
	g»gi¡ry
 =

1529 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
.
ÃwIn¡ªû
();

1530 
	g»gi¡ry
.
add
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
schema
);

1531 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


1532 .
š‹º®Upd©eFeDesütÜ
(
desütÜ
, 
»gi¡ry
);

1533 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
g‘DesütÜ
();

1534 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
g‘DesütÜ
();

	@samples/target/generated-sources/samples/protobuf/Vehicle.java

4 
·ckage
 
	g§m¶es
.
	g´Ùobuf
;

6 
public
 
fš®
 cÏs 
	cVehişe
 {

7 
´iv©e
 
	$Vehişe
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
C¬OrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
	gjava
.
	gÏng
.
SŒšg
 
g‘Com·ny
();

28 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


29 
g‘Com·nyBy‹s
();

34 
	gjava
.
	gÏng
.
SŒšg
 
g‘Mod–
();

38 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


39 
g‘Mod–By‹s
();

44 
	gjava
.
	gÏng
.
SŒšg
 
g‘CŞÜ
();

48 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


49 
g‘CŞÜBy‹s
();

54 
public
 
fš®
 
şass
 
C¬
 
ex‹nds


55 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


57 
	gC¬OrBud”
 {

59 
´iv©e
 
C¬
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

60 
su³r
(
bud”
);

62 
´iv©e
 
C¬
() {

63 
	gcom·ny_
 = "";

64 
	gmod–_
 = "";

65 
	gcŞÜ_
 = "";

68 @
	gjava
.
	gÏng
.
Ov”ride


69 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


70 
g‘UnknownF›lds
() {

71  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

73 
´iv©e
 
C¬
(

74 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

75 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

76 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

77 
this
();

78 
	gmubË_b™F›ld0_
 = 0;

79 
	gŒy
 {

80 
boŞ—n
 
	gdÚe
 = 
çl£
;

81 !
	gdÚe
) {

82 
	gg
 = 
šput
.
»adTag
();

83 
	gg
) {

85 
dÚe
 = 
Œue
;

88 ià(!
šput
.
skF›ld
(
g
)) {

89 
dÚe
 = 
Œue
;

94 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

96 
	gcom·ny_
 = 
s
;

100 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

102 
	gmod–_
 = 
s
;

106 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

108 
	gcŞÜ_
 = 
s
;

113 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

114 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

115 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

116 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

117 
e
).
£tUnfšishedMes§ge
(
this
);

118 } 
	gfš®ly
 {

119 
makeEx‹nsiÚsImmubË
();

122 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


123 
g‘DesütÜ
() {

124  
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_desütÜ
;

127 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


128 
š‹º®G‘F›ldAcûssÜTabË
() {

129  
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_f›ldAcûssÜTabË


130 .
’su»F›ldAcûssÜsIn™Ÿlized
(

131 
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
.
şass
, sam¶es.´Ùobuf.Vehişe.C¬.
Bud”
.class);

134 
public
 
fš®
 
	gCOMPANY_FIELD_NUMBER
 = 1;

135 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gcom·ny_
;

139 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Com·ny
() {

140 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

141 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

142  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

144 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

145 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

146 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

147 
	gcom·ny_
 = 
s
;

148  
	gs
;

154 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


155 
g‘Com·nyBy‹s
() {

156 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

157 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

158 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

159 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

160 (
java
.
Ïng
.
SŒšg
è
»f
);

161 
	gcom·ny_
 = 
b
;

162  
	gb
;

164  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

168 
public
 
fš®
 
	gMODEL_FIELD_NUMBER
 = 2;

169 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gmod–_
;

173 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Mod–
() {

174 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
mod–_
;

175 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

176  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

178 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

179 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

180 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

181 
	gmod–_
 = 
s
;

182  
	gs
;

188 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


189 
g‘Mod–By‹s
() {

190 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
mod–_
;

191 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

192 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

193 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

194 (
java
.
Ïng
.
SŒšg
è
»f
);

195 
	gmod–_
 = 
b
;

196  
	gb
;

198  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

202 
public
 
fš®
 
	gCOLOR_FIELD_NUMBER
 = 3;

203 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gcŞÜ_
;

207 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘CŞÜ
() {

208 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
cŞÜ_
;

209 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

210  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

212 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

213 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

214 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

215 
	gcŞÜ_
 = 
s
;

216  
	gs
;

222 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


223 
g‘CŞÜBy‹s
() {

224 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
cŞÜ_
;

225 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

226 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

227 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

228 (
java
.
Ïng
.
SŒšg
è
»f
);

229 
	gcŞÜ_
 = 
b
;

230  
	gb
;

232  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

236 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

237 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

238 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

239 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

240 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

242 
	gmemoizedIsIn™Ÿlized
 = 1;

243  
	gŒue
;

246 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

247 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

248 ià(!
g‘Com·nyBy‹s
().
isEm±y
()) {

249 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
com·ny_
);

251 ià(!
g‘Mod–By‹s
().
isEm±y
()) {

252 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
mod–_
);

254 ià(!
g‘CŞÜBy‹s
().
isEm±y
()) {

255 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 3, 
cŞÜ_
);

259 
public
 
g‘S”ŸlizedSize
() {

260 
	gsize
 = 
memoizedSize
;

261 ià(
	gsize
 !ğ-1è 
size
;

263 
	gsize
 = 0;

264 ià(!
g‘Com·nyBy‹s
().
isEm±y
()) {

265 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
com·ny_
);

267 ià(!
g‘Mod–By‹s
().
isEm±y
()) {

268 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
mod–_
);

270 ià(!
g‘CŞÜBy‹s
().
isEm±y
()) {

271 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(3, 
cŞÜ_
);

273 
	gmemoizedSize
 = 
size
;

274  
	gsize
;

277 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

278 @
	gjava
.
	gÏng
.
Ov”ride


279 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

280 ià(
	gobj
 =ğ
this
) {

281  
Œue
;

283 ià(!(
obj
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gC¬
)) {

284  
	gsu³r
.
equ®s
(
obj
);

286 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
	gÙh”
 = (
§m¶es
.
´Ùobuf
.
Vehişe
.C¬è
obj
;

288 
boŞ—n
 
	g»suÉ
 = 
Œue
;

289 
	g»suÉ
 = 
»suÉ
 && 
g‘Com·ny
()

290 .
equ®s
(
Ùh”
.
g‘Com·ny
());

291 
	g»suÉ
 = 
»suÉ
 && 
g‘Mod–
()

292 .
equ®s
(
Ùh”
.
g‘Mod–
());

293 
	g»suÉ
 = 
»suÉ
 && 
g‘CŞÜ
()

294 .
equ®s
(
Ùh”
.
g‘CŞÜ
());

295  
	g»suÉ
;

298 @
	gjava
.
	gÏng
.
Ov”ride


299 
public
 
hashCode
() {

300 ià(
	gmemoizedHashCode
 != 0) {

301  
memoizedHashCode
;

303 
	ghash
 = 41;

304 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

305 
	ghash
 = (37 * 
hash
è+ 
COMPANY_FIELD_NUMBER
;

306 
	ghash
 = (53 * 
hash
è+ 
g‘Com·ny
().
hashCode
();

307 
	ghash
 = (37 * 
hash
è+ 
MODEL_FIELD_NUMBER
;

308 
	ghash
 = (53 * 
hash
è+ 
g‘Mod–
().
hashCode
();

309 
	ghash
 = (37 * 
hash
è+ 
COLOR_FIELD_NUMBER
;

310 
	ghash
 = (53 * 
hash
è+ 
g‘CŞÜ
().
hashCode
();

311 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

312 
	gmemoizedHashCode
 = 
hash
;

313  
	ghash
;

316 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(

317 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

318 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

319  
	gPARSER
.
·r£From
(
d©a
);

321 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(

322 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

323 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

324 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

325  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

327 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(
by‹
[] 
d©a
)

328 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

329  
	gPARSER
.
·r£From
(
d©a
);

331 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(

332 
by‹
[] 
d©a
,

333 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

334 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

335  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

337 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

338 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

339  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


340 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

342 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(

343 
java
.
io
.
IÅutSŒ—m
 
šput
,

344 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

345 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

346  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


347 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

349 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

350 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

351  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


352 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

354 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£D–im™edFrom
(

355 
java
.
io
.
IÅutSŒ—m
 
šput
,

356 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

357 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

358  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


359 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

361 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(

362 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

363 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

364  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


365 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

367 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
·r£From
(

368 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

369 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

370 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

371  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


372 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

375 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

376 
public
 
Bud”
 
ÃwBud”
() {

377  
	gDEFAULT_INSTANCE
.
toBud”
();

379 
public
 
Bud”
 
ÃwBud”
(
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
 
´ÙÙy³
) {

380  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

382 
public
 
Bud”
 
toBud”
() {

383  
	gthis
 =ğ
DEFAULT_INSTANCE


384 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

387 @
	gjava
.
	gÏng
.
Ov”ride


388 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

389 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

390 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

391  
	gbud”
;

396 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


397 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


399 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gC¬OrBud”
 {

400 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


401 
g‘DesütÜ
() {

402  
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_desütÜ
;

405 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


406 
š‹º®G‘F›ldAcûssÜTabË
() {

407  
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_f›ldAcûssÜTabË


408 .
’su»F›ldAcûssÜsIn™Ÿlized
(

409 
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
.
şass
, sam¶es.´Ùobuf.Vehişe.C¬.
Bud”
.class);

413 
´iv©e
 
Bud”
() {

414 
maybeFÜûBud”In™Ÿliz©iÚ
();

417 
´iv©e
 
Bud”
(

418 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

419 
su³r
(
·»Á
);

420 
maybeFÜûBud”In™Ÿliz©iÚ
();

422 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

423 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


424 .
	g®waysU£F›ldBud”s
) {

427 
public
 
Bud”
 
ş—r
() {

428 
	gsu³r
.
ş—r
();

429 
	gcom·ny_
 = "";

431 
	gmod–_
 = "";

433 
	gcŞÜ_
 = "";

435  
	gthis
;

438 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


439 
g‘DesütÜFÜTy³
() {

440  
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_desütÜ
;

443 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
g‘DeçuÉIn¡ªûFÜTy³
() {

444  
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gC¬
.
g‘DeçuÉIn¡ªû
();

447 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
bud
() {

448 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
	g»suÉ
 = 
budP¬tŸl
();

449 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

450 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

452  
	g»suÉ
;

455 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
budP¬tŸl
() {

456 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
	g»suÉ
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
Vehişe
.C¬(
this
);

457 
	g»suÉ
.
	gcom·ny_
 = 
com·ny_
;

458 
	g»suÉ
.
	gmod–_
 = 
mod–_
;

459 
	g»suÉ
.
	gcŞÜ_
 = 
cŞÜ_
;

460 
ÚBut
();

461  
	g»suÉ
;

464 
public
 
Bud”
 
şÚe
() {

465  (
	gBud”
è
	gsu³r
.
şÚe
();

467 
public
 
Bud”
 
£tF›ld
(

468 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

469 
Objeù
 
v®ue
) {

470  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

472 
public
 
Bud”
 
ş—rF›ld
(

473 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

474  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

476 
public
 
Bud”
 
ş—rOÃof
(

477 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

478  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

480 
public
 
Bud”
 
£tR•—‹dF›ld
(

481 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

482 
šdex
, 
Objeù
 
v®ue
) {

483  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

485 
public
 
Bud”
 
addR•—‹dF›ld
(

486 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

487 
Objeù
 
v®ue
) {

488  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

490 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

491 ià(
Ùh”
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
	gC¬
) {

492  
m”geFrom
((
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
)
Ùh”
);

494 
	gsu³r
.
m”geFrom
(
Ùh”
);

495  
	gthis
;

499 
public
 
Bud”
 
m”geFrom
(
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
 
Ùh”
) {

500 ià(
	gÙh”
 =ğ
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
.
g‘DeçuÉIn¡ªû
()è 
this
;

501 ià(!
	gÙh”
.
g‘Com·ny
().
isEm±y
()) {

502 
	gcom·ny_
 = 
Ùh”
.
com·ny_
;

503 
ÚChªged
();

505 ià(!
	gÙh”
.
g‘Mod–
().
isEm±y
()) {

506 
	gmod–_
 = 
Ùh”
.
mod–_
;

507 
ÚChªged
();

509 ià(!
	gÙh”
.
g‘CŞÜ
().
isEm±y
()) {

510 
	gcŞÜ_
 = 
Ùh”
.
cŞÜ_
;

511 
ÚChªged
();

513 
ÚChªged
();

514  
	gthis
;

517 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

518  
	gŒue
;

521 
public
 
Bud”
 
m”geFrom
(

522 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

523 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

524 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

525 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
	g·r£dMes§ge
 = 
nuÎ
;

526 
	gŒy
 {

527 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

528 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

529 
	g·r£dMes§ge
 = (
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
è
e
.
g‘UnfšishedMes§ge
();

530 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

531 } 
	gfš®ly
 {

532 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

533 
m”geFrom
(
·r£dMes§ge
);

536  
	gthis
;

539 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gcom·ny_
 = "";

543 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Com·ny
() {

544 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

545 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

546 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

547 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

548 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

549 
	gcom·ny_
 = 
s
;

550  
	gs
;

552  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

558 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


559 
g‘Com·nyBy‹s
() {

560 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

561 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

562 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

563 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

564 (
java
.
Ïng
.
SŒšg
è
»f
);

565 
	gcom·ny_
 = 
b
;

566  
	gb
;

568  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

574 
public
 
Bud”
 
£tCom·ny
(

575 
java
.
Ïng
.
SŒšg
 
v®ue
) {

576 ià(
	gv®ue
 =ğ
nuÎ
) {

577 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

580 
	gcom·ny_
 = 
v®ue
;

581 
ÚChªged
();

582  
	gthis
;

587 
public
 
Bud”
 
ş—rCom·ny
() {

589 
	gcom·ny_
 = 
g‘DeçuÉIn¡ªû
().
g‘Com·ny
();

590 
ÚChªged
();

591  
	gthis
;

596 
public
 
Bud”
 
£tCom·nyBy‹s
(

597 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

598 ià(
	gv®ue
 =ğ
nuÎ
) {

599 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

601 
checkBy‹SŒšgIsUtf8
(
v®ue
);

603 
	gcom·ny_
 = 
v®ue
;

604 
ÚChªged
();

605  
	gthis
;

608 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gmod–_
 = "";

612 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Mod–
() {

613 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
mod–_
;

614 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

615 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

616 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

617 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

618 
	gmod–_
 = 
s
;

619  
	gs
;

621  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

627 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


628 
g‘Mod–By‹s
() {

629 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
mod–_
;

630 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

631 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

632 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

633 (
java
.
Ïng
.
SŒšg
è
»f
);

634 
	gmod–_
 = 
b
;

635  
	gb
;

637  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

643 
public
 
Bud”
 
£tMod–
(

644 
java
.
Ïng
.
SŒšg
 
v®ue
) {

645 ià(
	gv®ue
 =ğ
nuÎ
) {

646 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

649 
	gmod–_
 = 
v®ue
;

650 
ÚChªged
();

651  
	gthis
;

656 
public
 
Bud”
 
ş—rMod–
() {

658 
	gmod–_
 = 
g‘DeçuÉIn¡ªû
().
g‘Mod–
();

659 
ÚChªged
();

660  
	gthis
;

665 
public
 
Bud”
 
£tMod–By‹s
(

666 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

667 ià(
	gv®ue
 =ğ
nuÎ
) {

668 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

670 
checkBy‹SŒšgIsUtf8
(
v®ue
);

672 
	gmod–_
 = 
v®ue
;

673 
ÚChªged
();

674  
	gthis
;

677 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gcŞÜ_
 = "";

681 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘CŞÜ
() {

682 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
cŞÜ_
;

683 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

684 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

685 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

686 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

687 
	gcŞÜ_
 = 
s
;

688  
	gs
;

690  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

696 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


697 
g‘CŞÜBy‹s
() {

698 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
cŞÜ_
;

699 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

700 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

701 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

702 (
java
.
Ïng
.
SŒšg
è
»f
);

703 
	gcŞÜ_
 = 
b
;

704  
	gb
;

706  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

712 
public
 
Bud”
 
£tCŞÜ
(

713 
java
.
Ïng
.
SŒšg
 
v®ue
) {

714 ià(
	gv®ue
 =ğ
nuÎ
) {

715 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

718 
	gcŞÜ_
 = 
v®ue
;

719 
ÚChªged
();

720  
	gthis
;

725 
public
 
Bud”
 
ş—rCŞÜ
() {

727 
	gcŞÜ_
 = 
g‘DeçuÉIn¡ªû
().
g‘CŞÜ
();

728 
ÚChªged
();

729  
	gthis
;

734 
public
 
Bud”
 
£tCŞÜBy‹s
(

735 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

736 ià(
	gv®ue
 =ğ
nuÎ
) {

737 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

739 
checkBy‹SŒšgIsUtf8
(
v®ue
);

741 
	gcŞÜ_
 = 
v®ue
;

742 
ÚChªged
();

743  
	gthis
;

745 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

746 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

747  
	gthis
;

750 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

751 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

752  
	gthis
;

760 
´iv©e
 
fš®
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
	gDEFAULT_INSTANCE
;

762 
	gDEFAULT_INSTANCE
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
Vehişe
.
C¬
();

765 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
g‘DeçuÉIn¡ªû
() {

766  
	gDEFAULT_INSTANCE
;

769 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gC¬
>

770 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
C¬
>() {

771 
public
 
C¬
 
·r£P¬tŸlFrom
(

772 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

773 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

774 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

775  
Ãw
 
C¬
(
šput
, 
ex‹nsiÚRegi¡ry
);

779 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gC¬
> 
·r£r
() {

780  
	gPARSER
;

783 @
	gjava
.
	gÏng
.
Ov”ride


784 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gC¬
> 
g‘P¬£rFÜTy³
() {

785  
	gPARSER
;

788 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gVehişe
.
C¬
 
g‘DeçuÉIn¡ªûFÜTy³
() {

789  
	gDEFAULT_INSTANCE
;

794 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


795 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_desütÜ
;

796 
´iv©e
 
fš®


797 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


798 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_f›ldAcûssÜTabË
;

800 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


801 
	$g‘DesütÜ
() {

802  
desütÜ
;

803 
	}
}

804 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


805 
	gdesütÜ
;

807 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

812 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

813 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

814 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

815 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

816 
desütÜ
 = 
roÙ
;

817  
	gnuÎ
;

820 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


821 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

822 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

823 }, 
assigÃr
);

824 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_desütÜ
 =

825 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

826 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_C¬_f›ldAcûssÜTabË
 = 
Ãw


827 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

828 
š‹º®_¡©ic_§m¶es_´Ùobuf_C¬_desütÜ
,

829 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Company", "Model", "Color", });

	@samples/target/generated-sources/samples/protobuf/WorkExperience.java

4 
·ckage
 
	g§m¶es
.
	g´Ùobuf
;

6 
public
 
fš®
 cÏs 
	cWÜkEx³r›nû
 {

7 
´iv©e
 
	$WÜkEx³r›nû
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
Ex³r›nûOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
	gjava
.
	gÏng
.
SŒšg
 
g‘Com·ny
();

28 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


29 
g‘Com·nyBy‹s
();

34 
public
 
fš®
 
şass
 
Ex³r›nû
 
ex‹nds


35 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


37 
	gEx³r›nûOrBud”
 {

39 
´iv©e
 
Ex³r›nû
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

40 
su³r
(
bud”
);

42 
´iv©e
 
Ex³r›nû
() {

43 
	gcom·ny_
 = "";

46 @
	gjava
.
	gÏng
.
Ov”ride


47 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


48 
g‘UnknownF›lds
() {

49  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

51 
´iv©e
 
Ex³r›nû
(

52 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

53 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

54 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

55 
this
();

56 
	gmubË_b™F›ld0_
 = 0;

57 
	gŒy
 {

58 
boŞ—n
 
	gdÚe
 = 
çl£
;

59 !
	gdÚe
) {

60 
	gg
 = 
šput
.
»adTag
();

61 
	gg
) {

63 
dÚe
 = 
Œue
;

66 ià(!
šput
.
skF›ld
(
g
)) {

67 
dÚe
 = 
Œue
;

72 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

74 
	gcom·ny_
 = 
s
;

79 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

80 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

81 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

82 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

83 
e
).
£tUnfšishedMes§ge
(
this
);

84 } 
	gfš®ly
 {

85 
makeEx‹nsiÚsImmubË
();

88 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


89 
g‘DesütÜ
() {

90  
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_desütÜ
;

93 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


94 
š‹º®G‘F›ldAcûssÜTabË
() {

95  
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_f›ldAcûssÜTabË


96 .
’su»F›ldAcûssÜsIn™Ÿlized
(

97 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
şass
, sam¶es.´Ùobuf.WÜkEx³r›nû.Ex³r›nû.
Bud”
.class);

100 
public
 
fš®
 
	gCOMPANY_FIELD_NUMBER
 = 1;

101 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gcom·ny_
;

105 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Com·ny
() {

106 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

107 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

108  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

110 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

111 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

112 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

113 
	gcom·ny_
 = 
s
;

114  
	gs
;

120 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


121 
g‘Com·nyBy‹s
() {

122 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

123 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

124 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

125 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

126 (
java
.
Ïng
.
SŒšg
è
»f
);

127 
	gcom·ny_
 = 
b
;

128  
	gb
;

130  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

134 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

135 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

136 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

137 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

138 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

140 
	gmemoizedIsIn™Ÿlized
 = 1;

141  
	gŒue
;

144 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

145 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

146 ià(!
g‘Com·nyBy‹s
().
isEm±y
()) {

147 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
com·ny_
);

151 
public
 
g‘S”ŸlizedSize
() {

152 
	gsize
 = 
memoizedSize
;

153 ià(
	gsize
 !ğ-1è 
size
;

155 
	gsize
 = 0;

156 ià(!
g‘Com·nyBy‹s
().
isEm±y
()) {

157 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
com·ny_
);

159 
	gmemoizedSize
 = 
size
;

160  
	gsize
;

163 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

164 @
	gjava
.
	gÏng
.
Ov”ride


165 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

166 ià(
	gobj
 =ğ
this
) {

167  
Œue
;

169 ià(!(
obj
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
)) {

170  
	gsu³r
.
equ®s
(
obj
);

172 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	gÙh”
 = (
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.Ex³r›nûè
obj
;

174 
boŞ—n
 
	g»suÉ
 = 
Œue
;

175 
	g»suÉ
 = 
»suÉ
 && 
g‘Com·ny
()

176 .
equ®s
(
Ùh”
.
g‘Com·ny
());

177  
	g»suÉ
;

180 @
	gjava
.
	gÏng
.
Ov”ride


181 
public
 
hashCode
() {

182 ià(
	gmemoizedHashCode
 != 0) {

183  
memoizedHashCode
;

185 
	ghash
 = 41;

186 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

187 
	ghash
 = (37 * 
hash
è+ 
COMPANY_FIELD_NUMBER
;

188 
	ghash
 = (53 * 
hash
è+ 
g‘Com·ny
().
hashCode
();

189 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

190 
	gmemoizedHashCode
 = 
hash
;

191  
	ghash
;

194 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(

195 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

196 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

197  
	gPARSER
.
·r£From
(
d©a
);

199 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(

200 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

201 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

202 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

203  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

205 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(
by‹
[] 
d©a
)

206 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

207  
	gPARSER
.
·r£From
(
d©a
);

209 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(

210 
by‹
[] 
d©a
,

211 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

212 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

213  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

215 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

216 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

217  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


218 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

220 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(

221 
java
.
io
.
IÅutSŒ—m
 
šput
,

222 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

223 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

224  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


225 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

227 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

228 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

229  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


230 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

232 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£D–im™edFrom
(

233 
java
.
io
.
IÅutSŒ—m
 
šput
,

234 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

235 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

236  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


237 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

239 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(

240 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

241 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

242  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


243 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

245 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
·r£From
(

246 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

247 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

248 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

249  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


250 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

253 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

254 
public
 
Bud”
 
ÃwBud”
() {

255  
	gDEFAULT_INSTANCE
.
toBud”
();

257 
public
 
Bud”
 
ÃwBud”
(
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
 
´ÙÙy³
) {

258  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

260 
public
 
Bud”
 
toBud”
() {

261  
	gthis
 =ğ
DEFAULT_INSTANCE


262 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

265 @
	gjava
.
	gÏng
.
Ov”ride


266 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

267 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

268 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

269  
	gbud”
;

274 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


275 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


277 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nûOrBud”
 {

278 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


279 
g‘DesütÜ
() {

280  
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_desütÜ
;

283 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


284 
š‹º®G‘F›ldAcûssÜTabË
() {

285  
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_f›ldAcûssÜTabË


286 .
’su»F›ldAcûssÜsIn™Ÿlized
(

287 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
şass
, sam¶es.´Ùobuf.WÜkEx³r›nû.Ex³r›nû.
Bud”
.class);

291 
´iv©e
 
Bud”
() {

292 
maybeFÜûBud”In™Ÿliz©iÚ
();

295 
´iv©e
 
Bud”
(

296 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

297 
su³r
(
·»Á
);

298 
maybeFÜûBud”In™Ÿliz©iÚ
();

300 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

301 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


302 .
	g®waysU£F›ldBud”s
) {

305 
public
 
Bud”
 
ş—r
() {

306 
	gsu³r
.
ş—r
();

307 
	gcom·ny_
 = "";

309  
	gthis
;

312 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


313 
g‘DesütÜFÜTy³
() {

314  
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_desütÜ
;

317 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
g‘DeçuÉIn¡ªûFÜTy³
() {

318  
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
.
g‘DeçuÉIn¡ªû
();

321 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
bud
() {

322 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	g»suÉ
 = 
budP¬tŸl
();

323 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

324 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

326  
	g»suÉ
;

329 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
budP¬tŸl
() {

330 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	g»suÉ
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.Ex³r›nû(
this
);

331 
	g»suÉ
.
	gcom·ny_
 = 
com·ny_
;

332 
ÚBut
();

333  
	g»suÉ
;

336 
public
 
Bud”
 
şÚe
() {

337  (
	gBud”
è
	gsu³r
.
şÚe
();

339 
public
 
Bud”
 
£tF›ld
(

340 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

341 
Objeù
 
v®ue
) {

342  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

344 
public
 
Bud”
 
ş—rF›ld
(

345 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

346  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

348 
public
 
Bud”
 
ş—rOÃof
(

349 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

350  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

352 
public
 
Bud”
 
£tR•—‹dF›ld
(

353 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

354 
šdex
, 
Objeù
 
v®ue
) {

355  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

357 
public
 
Bud”
 
addR•—‹dF›ld
(

358 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

359 
Objeù
 
v®ue
) {

360  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

362 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

363 ià(
Ùh”
 
š¡ªûof
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
	gEx³r›nû
) {

364  
m”geFrom
((
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
)
Ùh”
);

366 
	gsu³r
.
m”geFrom
(
Ùh”
);

367  
	gthis
;

371 
public
 
Bud”
 
m”geFrom
(
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
 
Ùh”
) {

372 ià(
	gÙh”
 =ğ
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
.
g‘DeçuÉIn¡ªû
()è 
this
;

373 ià(!
	gÙh”
.
g‘Com·ny
().
isEm±y
()) {

374 
	gcom·ny_
 = 
Ùh”
.
com·ny_
;

375 
ÚChªged
();

377 
ÚChªged
();

378  
	gthis
;

381 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

382  
	gŒue
;

385 
public
 
Bud”
 
m”geFrom
(

386 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

387 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

388 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

389 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	g·r£dMes§ge
 = 
nuÎ
;

390 
	gŒy
 {

391 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

392 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

393 
	g·r£dMes§ge
 = (
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
è
e
.
g‘UnfšishedMes§ge
();

394 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

395 } 
	gfš®ly
 {

396 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

397 
m”geFrom
(
·r£dMes§ge
);

400  
	gthis
;

403 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gcom·ny_
 = "";

407 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Com·ny
() {

408 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

409 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

410 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

411 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

412 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

413 
	gcom·ny_
 = 
s
;

414  
	gs
;

416  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

422 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


423 
g‘Com·nyBy‹s
() {

424 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
com·ny_
;

425 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

426 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

427 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

428 (
java
.
Ïng
.
SŒšg
è
»f
);

429 
	gcom·ny_
 = 
b
;

430  
	gb
;

432  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

438 
public
 
Bud”
 
£tCom·ny
(

439 
java
.
Ïng
.
SŒšg
 
v®ue
) {

440 ià(
	gv®ue
 =ğ
nuÎ
) {

441 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

444 
	gcom·ny_
 = 
v®ue
;

445 
ÚChªged
();

446  
	gthis
;

451 
public
 
Bud”
 
ş—rCom·ny
() {

453 
	gcom·ny_
 = 
g‘DeçuÉIn¡ªû
().
g‘Com·ny
();

454 
ÚChªged
();

455  
	gthis
;

460 
public
 
Bud”
 
£tCom·nyBy‹s
(

461 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

462 ià(
	gv®ue
 =ğ
nuÎ
) {

463 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

465 
checkBy‹SŒšgIsUtf8
(
v®ue
);

467 
	gcom·ny_
 = 
v®ue
;

468 
ÚChªged
();

469  
	gthis
;

471 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

472 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

473  
	gthis
;

476 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

477 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

478  
	gthis
;

486 
´iv©e
 
fš®
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
	gDEFAULT_INSTANCE
;

488 
	gDEFAULT_INSTANCE
 = 
Ãw
 
§m¶es
.
´Ùobuf
.
WÜkEx³r›nû
.
Ex³r›nû
();

491 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
g‘DeçuÉIn¡ªû
() {

492  
	gDEFAULT_INSTANCE
;

495 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEx³r›nû
>

496 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Ex³r›nû
>() {

497 
public
 
Ex³r›nû
 
·r£P¬tŸlFrom
(

498 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

499 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

500 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

501  
Ãw
 
Ex³r›nû
(
šput
, 
ex‹nsiÚRegi¡ry
);

505 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEx³r›nû
> 
·r£r
() {

506  
	gPARSER
;

509 @
	gjava
.
	gÏng
.
Ov”ride


510 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEx³r›nû
> 
g‘P¬£rFÜTy³
() {

511  
	gPARSER
;

514 
public
 
	g§m¶es
.
	g´Ùobuf
.
	gWÜkEx³r›nû
.
Ex³r›nû
 
g‘DeçuÉIn¡ªûFÜTy³
() {

515  
	gDEFAULT_INSTANCE
;

520 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


521 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_desütÜ
;

522 
´iv©e
 
fš®


523 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


524 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_f›ldAcûssÜTabË
;

526 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


527 
	$g‘DesütÜ
() {

528  
desütÜ
;

529 
	}
}

530 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


531 
	gdesütÜ
;

533 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

538 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

539 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

540 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

541 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

542 
desütÜ
 = 
roÙ
;

543  
	gnuÎ
;

546 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


547 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

548 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

549 }, 
assigÃr
);

550 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_desütÜ
 =

551 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

552 
	gš‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_f›ldAcûssÜTabË
 = 
Ãw


553 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

554 
š‹º®_¡©ic_§m¶es_´Ùobuf_Ex³r›nû_desütÜ
,

555 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Company", });

	@test/src/test/java/org/corfudb/AbstractCorfuConcurrencyTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCªûÎ©iÚExû±iÚ
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

9 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

10 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

15 
public
 cÏs 
	cAb¡¿ùCÜfuCÚcu¼’cyTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

18 @
Te¡


19 
public
 
	$cÚcu¼’tTe¡sExecu‹
()

20 
throws
 
Exû±iÚ
 {

21 
fš®
 
AtomicLÚg
 
l
 = 
Ãw
 
	`AtomicLÚg
();

22 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_SOME
, 
t
 ->

23 
l
.
	`g‘AndInüem’t
());

24 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_SHORT
);

25 
	`as£¹Th©
(
l
.
	`g‘
())

26 .
	`isEqu®To
(
PARAMETERS
.
CONCURRENCY_SOME
);

29 @
Te¡


30 
public
 
	$cÚcu¼’tTe¡sThrowExû±iÚs
()

31 
throws
 
Exû±iÚ
 {

32 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_SOME
, 
t
 -> {

33 
throw
 
Ãw
 
	`IOExû±iÚ
("hi");

35 
	`as£¹Th©ThrownBy
((è-> 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
,

36 
PARAMETERS
.
TIMEOUT_SHORT
))

37 .
	`isIn¡ªûOf
(
IOExû±iÚ
.
şass
);

38 
	}
}

40 @
Te¡


41 
public
 
	$cÚcu¼’tTe¡sTimeout
()

42 
throws
 
Exû±iÚ
 {

43 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_SOME
,

44 
t
 -> 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
()));

45 
	`as£¹Th©ThrownBy
((è-> 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
,

46 
PARAMETERS
.
TIMEOUT_VERY_SHORT
))

47 .
	`isIn¡ªûOf
(
CªûÎ©iÚExû±iÚ
.
şass
);

48 
	}
}

	@test/src/test/java/org/corfudb/AbstractCorfuTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

5 
impÜt
 
	gÜg
.
	gfu£sourû
.
	gjªsi
.
	gAnsi
.
	gªsi
;

7 
impÜt
 
	gjava
.
	gio
.
	gFe
;

8 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

14 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

15 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gC®ÏbË
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘iÚExû±iÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜy
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

30 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gIÁCÚsum”
;

32 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAb¡¿ùObjeùAs£¹
;

33 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAb¡¿ùThrowabËAs£¹
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gDi§bËdOnT¿vis
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gcÚcu¼’t
.
	gTe¡Th»adGroups
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

38 
impÜt
 
	gÜg
.
	gfu£sourû
.
	gjªsi
.
	gAnsi
;

39 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

40 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gRuË
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTe¡RuË
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”
.
	gDesütiÚ
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”s
.
	gmod–
.
	gS‹m’t
;

50 
public
 cÏs 
	cAb¡¿ùCÜfuTe¡
 {

52 
public
 
	mS‘
<
	mC®ÏbË
<
	mObjeù
>> 
	mscheduËdTh»ads
;

53 
public
 
SŒšg
 
	m‹¡Stus
 = "";

55 
public
 
	mM­
<
	mIÁeg”
, 
	mTe¡Th»ad
> 
	mth»adsM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

59 
public
 
	mA¼ayLi¡
<
	mIÁCÚsum”
> 
	m‹¡SM
 = 
nuÎ
;

61 
public
 
fš®
 
CÜfuTe¡P¬am‘”s
 
	mPARAMETERS
 =

62 
Ãw
 
CÜfuTe¡P¬am‘”s
();

64 
public
 
fš®
 
CÜfuTe¡S”v”s
 
	mSERVERS
 =

65 
Ãw
 
CÜfuTe¡S”v”s
();

67 @
Aá”CÏss


68 
public
 
	$shutdownN‘tyGroups
() {

69 
Te¡Th»adGroups
.
	`shutdownTh»adGroups
();

75 @
RuË


76 
public
 
Te¡RuË
 
w©ch”
 = 
Ãw
 
	$Te¡RuË
() {

81 @
Ov”ride


82 
public
 
S‹m’t
 
	`­¶y
(
fš®
 S‹m’ˆ
¡©em’t
,

83 
fš®
 
DesütiÚ
 
desütiÚ
) {

84  
Ãw
 
	`S‹m’t
() {

85 @
Ov”ride


86 
public
 
	`ev®u©e
(è
throws
 
ThrowabË
 {

87 
Th»ad
 
‹¡Th»ad
 = 
nuÎ
;

88 
Œy
 {

89 
	`¡¬tšg
(
desütiÚ
);

92 ià(
PARAMETERS
.
TRAVIS_BUILD
 &&

93 
desütiÚ
.
g‘AÂÙ©iÚ


94 (
Di§bËdOnT¿vis
.
şass
è!ğ
nuÎ
 ||

95 
PARAMETERS
.
TRAVIS_BUILD
 &&

96 
desütiÚ
.
	`g‘Te¡CÏss
()

97 .
	`g‘AÂÙ©iÚ
(
Di§bËdOnT¿vis
.
şass
)

98 !ğ
nuÎ
) {

99 
	`ŒavisSk³d
();

103 
Com¶‘abËFutu»
<
ThrowabË
> 
‹¡Com¶‘iÚ
 = 
Ãw
 CompletableFuture<>();

104 
‹¡Th»ad
 = 
Ãw
 
	`Th»ad
(() -> {

105 
Œy
 {

106 
¡©em’t
.
	`ev®u©e
();

107 
‹¡Com¶‘iÚ
.
	`com¶‘e
(
nuÎ
);

108 } 
	`ÿtch
 (
ThrowabË
 
t
) {

109 
‹¡Com¶‘iÚ
.
	`com¶‘e
(
t
);

112 
‹¡Th»ad
.
	`£tName
("test-main");

113 
‹¡Th»ad
.
	`¡¬t
();

116 
Com¶‘abËFutu»
<
ThrowabË
> 
timeoutCom¶‘iÚ
 =

117 
CFUts
.
	`w™hš
(
‹¡Com¶‘iÚ
, 
PARAMETERS
.
TIMEOUT_LONG
);

118 
ThrowabË
 
t
;

119 
Œy
 {

120 
t
 = 
timeoutCom¶‘iÚ
.
	`još
();

121 } 
	`ÿtch
 (
Com¶‘iÚExû±iÚ
 
e
) {

122 ià(
e
.
	`g‘Cau£
(è
š¡ªûof
 
TimeoutExû±iÚ
) {

123 
	`timedOut
();

125 
	`çed
(
e
, 
desütiÚ
);

127 
throw
 
e
;

128 } 
fš®ly
 {

131 ià(
‹¡Th»ad
.
	`isAlive
()) {

132 
‹¡Th»ad
.
	`š‹¼u±
();

135 ià(
t
 =ğ
nuÎ
) {

136 
	`sucûeded
();

137 } ià(
t
 
š¡ªûof
 
Üg
.
jun™
.
š‹º®
.
Assum±iÚViŞ©edExû±iÚ
) {

138 
	`sk³d
(
t
);

139 
throw
 
t
;

141 
	`çed
(
t
, 
desütiÚ
);

142 
throw
 
t
;

145 } 
fš®ly
 {

146 
	`fšished
();

147 ià(
‹¡Th»ad
 !ğ
nuÎ
 &&e¡Th»ad.
	`isAlive
()) {

150 
SË•
.
	`¦“pUnš‹¼u±ibly
(
PARAMETERS
.
TIMEOUT_SHORT
);

151 ià(
‹¡Th»ad
.
	`isAlive
()) {

152 
Sy¡em
.
out
.
	`´šn
(
	`ªsi
().
	`fgRed
().
	`bŞd
()

153 .
	`a
("W¬nšg:e¡h»ad could‚Ù bkËd!").
	`»£t
());

154 
SckT¿ûEËm’t
[] 
‹¡T¿û
 = 
‹¡Th»ad
.
	`g‘SckT¿û
();

155 ià(
‹¡T¿û
.
Ëngth
 > 0) {

156 
Sy¡em
.
out
.
	`´šn
(
	`ªsi
().
	`a
("Thread method: ")

157 .
	`a
(
‹¡T¿û
[0].
	`g‘CÏssName
())

158 .
	`a
(":")

159 .
	`a
(
‹¡T¿û
[0].
	`g‘M‘hodName
()));

170 
´Ùeùed
 
	`sucûeded
() {

171 ià(!
‹¡Stus
.
	`equ®s
("")) {

172 
‹¡Stus
 = " [" +estStatus + "]";

174 
Sy¡em
.
out
.
	`´št
(
	`ªsi
().
	`a
("[").
	`fg
(
Ansi
.
CŞÜ
.
GREEN
).a("PASS")

175 .
	`»£t
().
	`a
("]" + 
‹¡Stus
).
	`Ãwlše
());

176 
Sy¡em
.
out
.
	`æush
();

182 
´Ùeùed
 
	`´štTh»ads
() {

183 
Sy¡em
.
out
.
	`´šn
(
	`ªsi
().
	`fgCyª
().
	`bŞd
().
	`a
("Active Threads At Test Failure")

184 .
	`»£t
());

185 
Sy¡em
.
out
.
	`´šn
(
	`ªsi
().
	`fÜm©
("%-40s %s",

187 
M­
<
Th»ad
, 
SckT¿ûEËm’t
[]> 
th»ads
 = Th»ad.
	`g‘AÎSckT¿ûs
();

188 
th»ads
.
	`’ŒyS‘
().
	`fÜEach
(
e
 -> {

190 ià(!
e
.
	`g‘Key
().
	`equ®s
(
Th»ad
.
	`cu¼’tTh»ad
())) {

191 ià(
e
.
	`g‘V®ue
().
Ëngth
 > 0) {

192 
Sy¡em
.
out
.
	`´šn
(
	`ªsi
().
	`fÜm©
("%-40s %s:%s",

193 
e
.
	`g‘Key
().
	`g‘Name
(),

194 
e
.
	`g‘V®ue
()[0].
	`g‘CÏssName
(),

195 
e
.
	`g‘V®ue
()[0].
	`g‘M‘hodName
()));

197 
Sy¡em
.
out
.
	`´šn
(
	`ªsi
().
	`fÜm©
("%-40s (norace‡vailable)",

198 
e
.
	`g‘Key
().
	`g‘Name
()));

209 
´Ùeùed
 
	`çed
(
ThrowabË
 
e
, 
DesütiÚ
 
desütiÚ
) {

210 
fš®
 
lšeNumb”
 = 
	`g‘LšeNumb”
(
e
, 
desütiÚ
);

211 
SŒšg
 
lšeOut
 = 
lšeNumb”
 == -1 ? "" : ":L" +†ineNumber;

212 
Sy¡em
.
out
.
	`´št
(
	`ªsi
().
	`a
("[")

213 .
	`fg
(
Ansi
.
CŞÜ
.
RED
)

214 .
	`a
("FAIL").
	`»£t
()

215 .
	`a
(" - ").a(
e
.
	`g‘CÏss
().
	`g‘Sim¶eName
())

216 .
	`a
(
lšeOut
)

217 .
	`a
("]").
	`Ãwlše
());

218 
	`´štTh»ads
();

219 
Sy¡em
.
out
.
	`æush
();

224 
´Ùeùed
 
	`timedOut
() {

225 
Sy¡em
.
out
.
	`´št
(
	`ªsi
().
	`a
("[")

226 .
	`fg
(
Ansi
.
CŞÜ
.
RED
)

227 .
	`a
("TIMED OUT").
	`»£t
()

228 .
	`a
("]").
	`Ãwlše
());

229 
	`´štTh»ads
();

230 
Sy¡em
.
out
.
	`æush
();

241 
´iv©e
 
boŞ—n
 
	`şassInh”™sFromNamedCÏss
(
SŒšg
 
şassName
,

242 
CÏss
<?> 
şs
) {

243 
CÏss
<?> 
ÃxtP¬’t
 = 
şs
;

244 
ÃxtP¬’t
 !ğ
Objeù
.
şass
) {

245 ià(
şassName
.
	`equ®s
(
ÃxtP¬’t
.
	`g‘Name
())) {

246  
Œue
;

248 
ÃxtP¬’t
 =‚extP¬’t.
	`g‘Su³rşass
();

250  
çl£
;

258 
´iv©e
 
	`g‘LšeNumb”
(
ThrowabË
 
e
, 
DesütiÚ
 
desütiÚ
) {

259 
Œy
 {

260 
SckT¿ûEËm’t
 
‹¡EËm’t
 = 
A¼ays
.
	`¡»am
(
e
.
	`g‘SckT¿û
())

261 .
	`f‹r
(
–em’t
 -> 
	`şassInh”™sFromNamedCÏss
(

262 
–em’t
.
	`g‘CÏssName
(), 
desütiÚ
.
	`g‘Te¡CÏss
()))

263 .
	`»duû
((
fœ¡
, 
£cÚd
) -> second)

264 .
	`g‘
();

265  
‹¡EËm’t
.
	`g‘LšeNumb”
();

266 } 
	`ÿtch
 (
NoSuchEËm’tExû±iÚ
 
n£
)

274 
´Ùeùed
 
	`fšished
() {

280 
´Ùeùed
 
	`ŒavisSk³d
() {

281 
Sy¡em
.
out
.
	`´št
(
	`ªsi
().
	`a
("[")

282 .
	`fg
(
Ansi
.
CŞÜ
.
YELLOW
)

283 .
	`a
("SKIPPED").
	`»£t
()

284 .
	`a
("]").
	`Ãwlše
());

285 
Sy¡em
.
out
.
	`æush
();

292 
´Ùeùed
 
	`sk³d
(
ThrowabË
 
e
) {

293 
Sy¡em
.
out
.
	`´št
(
	`ªsi
().
	`a
("[")

294 .
	`fg
(
Ansi
.
CŞÜ
.
YELLOW
)

295 .
	`a
("SKIPPED -").
	`»£t
()

296 .
	`a
(
e
.
	`g‘CÏss
().
	`toSŒšg
())

297 .
	`a
("]").
	`Ãwlše
());

298 
Sy¡em
.
out
.
	`æush
();

304 
´Ùeùed
 
	`¡¬tšg
(
DesütiÚ
 
desütiÚ
) {

305 
Sy¡em
.
out
.
	`´št
(
SŒšg
.
	`fÜm©
("%-60s", 
desütiÚ


306 .
	`g‘M‘hodName
()));

307 
Sy¡em
.
out
.
	`æush
();

311 
	}
};

319 
public
 
	$d–‘eFŞd”
(
Fe
 
fŞd”
, 
boŞ—n
 
d–‘eS–f
) {

320 
Fe
[] 
fes
 = 
fŞd”
.
	`li¡Fes
();

321 ià(
fes
 !ğ
nuÎ
) {

322 
Fe
 
f
 : 
fes
) {

323 ià(
f
.
	`isDœeùÜy
()) {

324 
	`d–‘eFŞd”
(
f
, 
Œue
);

326 
f
.
	`d–‘e
();

330 ià(
d–‘eS–f
) {

331 
fŞd”
.
	`d–‘e
();

333 
	}
}

335 @
BefÜe


336 
public
 
	$ş—rTe¡Stus
() {

337 
‹¡Stus
 = "";

338 
	}
}

340 @
BefÜe


341 
public
 
	$£tupScheduËdTh»ads
() {

342 
scheduËdTh»ads
 = 
CÚcu¼’tHashM­
.
	`ÃwKeyS‘
();

343 
	}
}

346 @
Aá”


347 
public
 
	$ş—nupScheduËdTh»ads
() {

348 
Œy
 {

349 
	`as£¹Th©
(
scheduËdTh»ads
)

350 .
	`as
("Testƒnded buthere‡re stillhreads scheduled!")

351 .
	`hasSize
(0);

352 } 
fš®ly
 {

353 
scheduËdTh»ads
.
	`ş—r
();

355 
	}
}

359 @
Aá”


360 
public
 
	$ş—nP”Te¡TempDœ
() {

361 
	`d–‘eFŞd”
(
Ãw
 
	`Fe
(
PARAMETERS
.
TEST_TEMP_DIR
),

362 
çl£
);

363 
	}
}

366 
public
 
	$ÿlcuÏ‹AbÜtR©e
(
abÜts
, 
Œª§ùiÚs
) {

367 
fš®
 
FRACTION_TO_PERCENT
 = 100.0F;

368 ià(!
‹¡Stus
.
	`equ®s
("")) {

369 
‹¡Stus
 += ";";

371 
‹¡Stus
 +ğ"AbÜts=" + 
SŒšg
.
	`fÜm©
("%.2f",

372 ((è
abÜts
 / 
Œª§ùiÚs
è* 
FRACTION_TO_PERCENT
) + "%";

373 
	}
}

375 
public
 
	$ÿlcuÏ‹Reque¡sP”SecÚd
(
SŒšg
 
Çme
, 
tÙ®Reque¡s
, 
¡¬tTime
) {

376 
fš®
 
MILLISECONDS_TO_SECONDS
 = 1000.0F;

377 
’dTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

378 
timeInSecÚds
 = ((è(
’dTime
 - 
¡¬tTime
))

379 / 
MILLISECONDS_TO_SECONDS
;

380 
½s
 = (è
tÙ®Reque¡s
 / 
timeInSecÚds
;

381 ià(!
‹¡Stus
.
	`equ®s
("")) {

382 
‹¡Stus
 += ";";

384 
‹¡Stus
 +ğ
Çme
 + "=" + 
SŒšg
.
	`fÜm©
("%.0f", 
½s
);

385 
	}
}

392 
public
 
	$scheduËCÚcu¼’y
(
C®ÏbËCÚsum”
 
funùiÚ
) {

393 
	`scheduËCÚcu¼’y
(1, 
funùiÚ
);

394 
	}
}

402 
public
 
	$scheduËCÚcu¼’y
(
»³t™iÚs
, 
C®ÏbËCÚsum”
 
funùiÚ
) {

403 
i
 = 0; i < 
»³t™iÚs
; i++) {

404 
fš®
 
skNumb”
 = 
i
;

406 
scheduËdTh»ads
.
	`add
(() -> {

409 
funùiÚ
.
	`acû±
(
skNumb”
);

410  
nuÎ
;

413 
	}
}

425 
public
 
	$execu‹ScheduËd
(
maxCÚcu¼’cy
, 
Du¿tiÚ
 
du¿tiÚ
)

426 
throws
 
Exû±iÚ
 {

427 
	`execu‹ScheduËd
(
maxCÚcu¼’cy
, 
du¿tiÚ
.
	`toMlis
(),

428 
TimeUn™
.
MILLISECONDS
);

429 
	}
}

439 
public
 
	$execu‹ScheduËd
(
maxCÚcu¼’cy
, 
timeout
, 
TimeUn™
 
timeUn™
)

440 
throws
 
Exû±iÚ
 {

441 
AtomicLÚg
 
th»adNum
 = 
Ãw
 
	`AtomicLÚg
();

442 
ExecutÜS”viû
 
£rviû
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
maxCÚcu¼’cy
, 
Ãw
 
	`Th»adFaùÜy
() {

443 @
Ov”ride


444 
public
 
Th»ad
 
	`ÃwTh»ad
(
RuÂabË
 
r
) {

445 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(
r
);

446 
t
.
	`£tName
("‹¡-" + 
th»adNum
.
	`g‘AndInüem’t
());

447  
t
;

450 
Li¡
<
Futu»
<
Objeù
>> 
fšishedS‘
 = 
£rviû
.
	`švokeAÎ
(
scheduËdTh»ads
, 
timeout
, 
timeUn™
);

451 
scheduËdTh»ads
.
	`ş—r
();

452 
£rviû
.
	`shutdown
();

454 
Œy
 {

455 
£rviû
.
	`awa™T”mš©iÚ
(
timeout
, 
timeUn™
);

456 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

457 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
›
);

460 
Œy
 {

461 
Futu»
 
f
 : 
fšishedS‘
) {

462 
	`as£¹Th©
(
f
.
	`isDÚe
()).

463 
	`as
("Ensurehat‡ll scheduledhreads‡re completed")

464 .
	`isTrue
();

465 
f
.
	`g‘
();

467 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
“
) {

468 ià(
“
.
	`g‘Cau£
(è
š¡ªûof
 
E¼Ü
) {

469 
	`throw
 (
E¼Ü
è
“
.
	`g‘Cau£
();

471 
	`throw
 (
Exû±iÚ
è
“
.
	`g‘Cau£
();

472 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

473 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
›
);

476 
	}
}

478 @
FunùiÚ®IÁ”çû


479 
public
 
š‹rçû
 
	gExû±iÚFunùiÚ
<
	gT
> {

480 
T
 
run
(è
throws
 
	gExû±iÚ
;

483 @
FunùiÚ®IÁ”çû


484 
public
 
š‹rçû
 
	gVoidExû±iÚFunùiÚ
 {

485 
run
(è
throws
 
	gExû±iÚ
;

488 şas 
	cTe¡Th»ad
 {

490 
Th»ad
 
	gt
;

491 
Sem­hÜe
 
	gs
 = 
Ãw
 Semaphore(0);

492 vŞ©
Exû±iÚFunùiÚ
 
	grunFunùiÚ
;

493 vŞ©
	gCom¶‘abËFutu»
<
	gObjeù
> 
	g»suÉ
;

494 vŞ©
boŞ—n
 
	gruÂšg
 = 
Œue
;

496 
public
 
Te¡Th»ad
(
th»adNum
) {

497 
	gt
 = 
Ãw
 
Th»ad
(() -> {

498 
ruÂšg
) {

499 
Œy
 {

500 
s
.
acquœe
();

501 
Œy
 {

502 
Objeù
 
»s
 = 
runFunùiÚ
.
run
();

503 
»suÉ
.
com¶‘e
(
»s
);

504 } 
ÿtch
 (
Exû±iÚ
 
e
) {

505 
»suÉ
.
com¶‘eExû±iÚ®ly
(
e
);

507 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

512 
	gt
.
£tName
("‹¡-" + 
th»adNum
);

513 
	gt
.
¡¬t
();

516 
public
 
Objeù
 
run
(
Exû±iÚFunùiÚ
 
funùiÚ
)

517 
throws
 
	gExû±iÚ


519 
	grunFunùiÚ
 = 
funùiÚ
;

520 
	g»suÉ
 = 
Ãw
 
Com¶‘abËFutu»
<>();

521 
	gs
.
»Ëa£
();

522 
	gŒy
 {

523  
	g»suÉ
.
g‘
();

524 } 
ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

525 
throw
 (
Exû±iÚ
è
	ge
.
g‘Cau£
();

526 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
){

527 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
›
);

531 
public
 
shutdown
() {

532 
	gruÂšg
 = 
çl£
;

533 
	gt
.
š‹¼u±
();

534 
	gŒy
 {

535 
	gt
.
još
();

536 } 
ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

543 @
BefÜe


544 
public
 
	$»£tTh»adšgTe¡
() {

545 
th»adsM­
.
	`ş—r
();

546 
Ï¡Exû±iÚ
 = 
nuÎ
;

547 
	}
}

549 @
Aá”


550 
public
 
	$shutdownTh»adšgTe¡
()

551 
throws
 
Exû±iÚ


553 
th»adsM­
.
	`’ŒyS‘
().
	`fÜEach
(
x
 -> {

554 
x
.
	`g‘V®ue
().
	`shutdown
();

557 ià(
Ï¡Exû±iÚ
 !ğ
nuÎ
) {

558 
throw
 
Ãw
 
	`Exû±iÚ
("Unÿughˆexû±iÚ‡ˆ’d oà‹¡", 
Ï¡Exû±iÚ
);

560 
	}
}

562 @
Suµ»ssW¬nšgs
("unchecked")

563 
	g´iv©e
 <
	gT
> 
T
 
runTh»ad
(
th»adNum
, 
Exû±iÚFunùiÚ
<T> 
e
)

564 
throws
 
	gExû±iÚ


568 ià(! 
	gth»adsM­
.
cÚšsKey
(
th»adNum
)) {

569 
	gth»adsM­
.
putIfAb£Á
(
th»adNum
, 
Ãw
 
Te¡Th»ad
(threadNum));

571  (
	gT
è
	gth»adsM­
.
g‘
(
th»adNum
).
run
(
e
);

576 
´iv©e
 vŞ©
Exû±iÚ
 
	gÏ¡Exû±iÚ
;

578 
public
 
şass
 
	gAs£¹abËObjeù
<
	gT
> {

580 
T
 
	gobj
;

581 
Exû±iÚ
 
	gex
;

583 
public
 
As£¹abËObjeù
(
Exû±iÚFunùiÚ
<
T
> 
objProvid”
) {

584 
	gŒy
 {

585 
	gthis
.
	gobj
 = 
objProvid”
.
run
();

586 } 
ÿtch
 (
Exû±iÚ
 
e
) {

587 
	gthis
.
	gex
 = 
e
;

588 
	gÏ¡Exû±iÚ
 = 
e
;

592 
public
 
	gAb¡¿ùObjeùAs£¹
<?, 
	gT
> 
as£¹ResuÉ
()

593 
throws
 
	gRuÁimeExû±iÚ
 {

594 ià(
	gex
 !ğ
nuÎ
) {

595 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
ex
);

597  
as£¹Th©
(
obj
);

600 
public
 
	gAb¡¿ùThrowabËAs£¹
<?, ? 
ex‹nds
 
	gThrowabË
> 
as£¹Throws
() {

601 ià(
	gex
 =ğ
nuÎ
) {

602 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Asserted‡nƒxception, but‚oƒxception washrown!");

604 
	gÏ¡Exû±iÚ
 = 
nuÎ
;

605  
as£¹Th©ThrownBy
((è-> {
throw
 
ex
;});

608 
public
 
as£¹DÛsNÙThrow
(
CÏss
<? 
ex‹nds
 
ThrowabË
> 
t
) {

609 ià(
	gex
 !ğ
nuÎ
) {

610 
as£¹Th©
(
ex
)

611 .
isNÙIn¡ªûOf
(
t
);

615 
public
 
T
 
»suÉ
()

616 
throws
 
	gRuÁimeExû±iÚ
 {

617 ià(
	gex
 !ğ
nuÎ
) {

618 
throw
 
Ãw
 
RuÁimeExû±iÚ
(
ex
);

620  
	gobj
;

630 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

631 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
t1
(
Exû±iÚFunùiÚ
<
T
> 
toRun
è{ 
t
(1,oRun);}

639 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

640 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
t2
(
Exû±iÚFunùiÚ
<
T
> 
toRun
è{ 
t
(2,oRun);}

648 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

649 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
t3
(
Exû±iÚFunùiÚ
<
T
> 
toRun
è{ 
t
(3,oRun);}

657 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

658 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
t4
(
Exû±iÚFunùiÚ
<
T
> 
toRun
è{ 
t
(4,oRun);}

666 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

667 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
	$t1
(
VoidExû±iÚFunùiÚ
 
toRun
è{ 
	`t
(1,oRun);
	}
}

675 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

676 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
	$t2
(
VoidExû±iÚFunùiÚ
 
toRun
è{ 
	`t
(2,oRun);
	}
}

678 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
t
(
th»adNum
, 
Exû±iÚFunùiÚ
<
T
> 
toRun
)

679 
throws
 
	gRuÁimeExû±iÚ
 {

680 ià(
	gÏ¡Exû±iÚ
 !ğ
nuÎ
) {

681 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Unÿughˆexû±iÚ from…»viou ¡©em’t", 
Ï¡Exû±iÚ
);

683  
Ãw
 
	gAs£¹abËObjeù
<
	gT
>((è-> 
runTh»ad
(
th»adNum
, 
toRun
));

686 
	gpublic
 <
	gT
> 
	gAs£¹abËObjeù
<T> 
	$t
(
th»adNum
, 
VoidExû±iÚFunùiÚ
 
toRun
)

687 
throws
 
RuÁimeExû±iÚ
 {

688 ià(
Ï¡Exû±iÚ
 !ğ
nuÎ
) {

689 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Unÿughˆexû±iÚ from…»viou ¡©em’t", 
Ï¡Exû±iÚ
);

691  
Ãw
 
As£¹abËObjeù
<
T
>((è-> 
	`runTh»ad
(
th»adNum
, (è-> {
toRun
.
	`run
();  
nuÎ
;}));

692 
	}
}

706 
public
 
	$scheduËIÁ”Ëaved
(
numTh»ads
, 
numTasks
) {

707 
fš®
 
NOTASK
 = -1;

709 
numS‹s
 = 
‹¡SM
.
	`size
();

710 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
(
PARAMETERS
.
SEED
);

711 
AtomicIÁeg”
 
nDÚe
 = 
Ãw
 
	`AtomicIÁeg”
(0);

713 [] 
ÚTask
 = 
Ãw
 [
numTh»ads
];

714 
A¼ays
.
	`fl
(
ÚTask
, 
NOTASK
);

716 [] 
ÚS‹
 = 
Ãw
 [
numTh»ads
];

717 
AtomicIÁeg”
 
highTask
 = 
Ãw
 
	`AtomicIÁeg”
(0);

719 
nDÚe
.
	`g‘
(è< 
numTasks
) {

720 
fš®
 
Ãx‰
 = 
r
.
	`ÃxtIÁ
(
numTh»ads
);

722 ià(
ÚTask
[
Ãx‰
] =ğ
NOTASK
) {

723 
t
 = 
highTask
.
	`g‘AndInüem’t
();

724 ià(
t
 < 
numTasks
) {

725 
ÚTask
[
Ãx‰
] = 
t
;

726 
ÚS‹
[
Ãx‰
] = 0;

730 ià(
ÚTask
[
Ãx‰
] !ğ
NOTASK
) {

731 
	`t
(
Ãx‰
, () -> {

732 
‹¡SM
.
	`g‘
(
ÚS‹
[
Ãx‰
]).
	`acû±
(
ÚTask
[nextt]);

733 ià(++
ÚS‹
[
Ãx‰
] >ğ
numS‹s
) {

734 
ÚTask
[
Ãx‰
] = 
NOTASK
;

735 
nDÚe
.
	`g‘AndInüem’t
();

740 
	}
}

749 
public
 
	$scheduËTh»aded
(
numTh»ads
, 
numTasks
)

750 
throws
 
Exû±iÚ


752 
	`scheduËCÚcu¼’y
(
numTasks
, (
numTask
) -> {

753 
IÁCÚsum”
 
¡•
 : 
‹¡SM
è¡•.
	`acû±
(
numTask
);

755 
	`execu‹ScheduËd
(
numTh»ads
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

756 
	}
}

762 @
BefÜe


763 
public
 
	$In™SM
() {

764 ià(
‹¡SM
 !ğ
nuÎ
)

765 
‹¡SM
.
	`ş—r
();

767 
‹¡SM
 = 
Ãw
 
A¼ayLi¡
<>();

768 
	}
}

770 
public
 
	$addTe¡S‹p
(
IÁCÚsum”
 
¡•FunùiÚ
) {

771 ià(
‹¡SM
 =ğ
nuÎ
) {

772 
	`In™SM
();

774 
‹¡SM
.
	`add
(
¡•FunùiÚ
);

775 
	}
}

780 @
FunùiÚ®IÁ”çû


781 
public
 
š‹rçû
 
	gC®ÏbËCÚsum”
 {

789 
acû±
(
IÁeg”
 
th»adNumb”
è
throws
 
	gExû±iÚ
;

	@test/src/test/java/org/corfudb/CorfuTestParameters.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

3 
impÜt
 
	gjava
.
	gtime
.
	g‹mpÜ®
.
	gChrÚoUn™
.
	gMILLIS
;

4 
impÜt
 
	gjava
.
	gtime
.
	g‹mpÜ®
.
	gChrÚoUn™
.
	gMINUTES
;

5 
impÜt
 
	gjava
.
	gtime
.
	g‹mpÜ®
.
	gChrÚoUn™
.
	gSECONDS
;

7 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

8 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gModif›r
;

9 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

11 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

18 
public
 cÏs 
	cCÜfuTe¡P¬am‘”s
 {

22 
public
 
fš®
 
Du¿tiÚ
 
	mTIMEOUT_VERY_SHORT
;

27 
public
 
fš®
 
Du¿tiÚ
 
	mTIMEOUT_SHORT
;

33 
public
 
fš®
 
Du¿tiÚ
 
	mTIMEOUT_NORMAL
;

38 
public
 
fš®
 
Du¿tiÚ
 
	mTIMEOUT_LONG
;

44 
public
 
fš®
 
	mNUM_ITERATIONS_VERY_LOW
;

50 
public
 
fš®
 
	mNUM_ITERATIONS_LOW
;

55 
public
 
fš®
 
	mNUM_ITERATIONS_MODERATE
;

61 
public
 
fš®
 
	mNUM_ITERATIONS_LARGE
;

64 
public
 
fš®
 
	mCONCURRENCY_ONE
;

67 
public
 
fš®
 
	mCONCURRENCY_TWO
;

71 
public
 
fš®
 
	mCONCURRENCY_SOME
;

75 
public
 
fš®
 
	mCONCURRENCY_LOTS
;

78 
public
 
fš®
 
SŒšg
 
	mTEST_TEMP_DIR
;

81 
public
 
fš®
 
boŞ—n
 
	mTRAVIS_BUILD
;

85 
public
 
fš®
 
	mSEED
;

88 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

89 
public
 
	$CÜfuTe¡P¬am‘”s
(){

91 
TRAVIS_BUILD
 = 
Sy¡em
.
	`g‘Prİ”ty
("test.travisBuild")

92 !ğ
nuÎ
 && 
Sy¡em
.
	`g‘Prİ”ty
("‹¡.ŒavisBud").
	`toLow”Ca£
()

93 .
	`equ®s
("true");

95 ià(
TRAVIS_BUILD
) {

96 
Sy¡em
.
out
.
	`´šn
("Building onravis, increasedimeouts, "

101 
TIMEOUT_VERY_SHORT
 = 
TRAVIS_BUILD
 ? 
Du¿tiÚ
.
	`of
(1, 
SECONDS
) :

102 
Du¿tiÚ
.
	`of
(100, 
MILLIS
);

103 
TIMEOUT_SHORT
 = 
TRAVIS_BUILD
 ? 
Du¿tiÚ
.
	`of
(5, 
SECONDS
) :

104 
Du¿tiÚ
.
	`of
(1, 
SECONDS
);

105 
TIMEOUT_NORMAL
 = 
TRAVIS_BUILD
 ? 
Du¿tiÚ
.
	`of
(20, 
SECONDS
) :

106 
Du¿tiÚ
.
	`of
(10, 
SECONDS
);

107 
TIMEOUT_LONG
 = 
TRAVIS_BUILD
 ? 
Du¿tiÚ
.
	`of
(2, 
MINUTES
):

108 
Du¿tiÚ
.
	`of
(2, 
MINUTES
);

111 
NUM_ITERATIONS_VERY_LOW
 = 
TRAVIS_BUILD
 ? 1 : 10;

112 
NUM_ITERATIONS_LOW
 = 
TRAVIS_BUILD
 ? 10 : 100;

113 
NUM_ITERATIONS_MODERATE
 = 
TRAVIS_BUILD
 ? 100: 1000;

114 
NUM_ITERATIONS_LARGE
 = 
TRAVIS_BUILD
 ? 1
_000
 : 10_000;

117 
CONCURRENCY_ONE
 = 1;

118 
CONCURRENCY_TWO
 = 2;

119 
CONCURRENCY_SOME
 = 
TRAVIS_BUILD
 ? 3 : 5;

120 
CONCURRENCY_LOTS
 = 
TRAVIS_BUILD
 ? 25 : 100;

123 
TEST_TEMP_DIR
 = 
com
.
googË
.
commÚ
.
io
.
Fes
.
	`ü—‹TempDœ
()

124 .
	`g‘AbsŞu‹P©h
();

127 
SEED
 = 
Sy¡em
.
	`g‘Prİ”ty
("‹¡.£ed"è=ğ
nuÎ
 ? 0L :

128 
LÚg
.
	`·r£LÚg
(
Sy¡em
.
	`g‘Prİ”ty
("test.seed"));

129 
	`´štP¬am‘”s
();

134 
´iv©e
 
	$´štP¬am‘”s
() {

135 
Sy¡em
.
out
.
	`´šn
("Test Configuration:");

136 
A¼ays
.
	`¡»am
(
this
.
	`g‘CÏss
().
	`g‘Deş¬edF›lds
())

137 .
	`sÜ‹d
(
Com·¿tÜ
.
	`com·ršg
(
F›ld
::
g‘Name
))

138 .
	`f‹r
(
f
 -> (f.
	`g‘Modif›rs
(è& 
Modif›r
.
PUBLIC
) > 0)

139 .
	`fÜEachOrd”ed
(
f
 -> { 
Œy
 {
Sy¡em
.
out
.
	`´šn
(f.
	`g‘Name
() + ":"

140 + 
f
.
	`g‘
(
this
).
	`toSŒšg
());}

141 
	`ÿtch
 (
Exû±iÚ
 
e
) {}});

142 
	}
}

	@test/src/test/java/org/corfudb/CorfuTestServers.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

6 
public
 cÏs 
	cCÜfuTe¡S”v”s
 {

9 
public
 
fš®
 
	mPORT_0
 = 0;

12 
public
 
fš®
 
	mPORT_1
 = 1;

15 
public
 
fš®
 
	mPORT_2
 = 2;

18 
public
 
fš®
 
	mPORT_3
 = 3;

21 
public
 
fš®
 
	mPORT_4
 = 4;

24 
public
 
fš®
 
	mPORT_5
 = 5;

27 
public
 
fš®
 
	mPORT_6
 = 6;

30 
public
 
fš®
 
	mPORT_7
 = 7;

33 
public
 
fš®
 
	mPORT_8
 = 8;

36 
public
 
fš®
 
	mPORT_9
 = 9;

39 
public
 
fš®
 
SŒšg
 
	mENDPOINT_0
 = "‹¡:" + 
PORT_0
;

42 
public
 
fš®
 
SŒšg
 
	mENDPOINT_1
 = "‹¡:" + 
PORT_1
;

45 
public
 
fš®
 
SŒšg
 
	mENDPOINT_2
 = "‹¡:" + 
PORT_2
;

48 
public
 
fš®
 
SŒšg
 
	mENDPOINT_3
 = "‹¡:" + 
PORT_3
;

51 
public
 
fš®
 
SŒšg
 
	mENDPOINT_4
 = "‹¡:" + 
PORT_4
;

	@test/src/test/java/org/corfudb/CustomSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

11 
public
 cÏs 
	cCu¡omS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

12 
IS”Ÿliz”
 
	m£rŸliz”
 = 
S”Ÿliz”s
.
g‘DeçuÉS”Ÿliz”
();

13 
´iv©e
 
fš®
 
by‹
 
	mty³
;

15 
public
 
	$Cu¡omS”Ÿliz”
(
by‹
 
ty³
) {

16 
this
.
ty³
 =ype;

19 
public
 
by‹
 
	$g‘Ty³
() {

20  
ty³
;

21 
	}
}

23 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

24  
£rŸliz”
.
	`de£rŸlize
(
b
, 
¹
);

25 
	}
}

27 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

28 
£rŸliz”
.
	`£rŸlize
(
o
, 
b
);

29 
	}
}

	@test/src/test/java/org/corfudb/LogReplicationTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

9 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

12 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
public
 cÏs 
	cLogR•liÿtiÚTe¡
 {

16 
SŒšg
 
	m’dpošt
;

18 
´iv©e
 
fš®
 
	mITERATIONS
 = 10;

20 
	mCÜfuTabË
<
	mSŒšg
, SŒšg> 
	mbË1
;

21 
	mCÜfuTabË
<
	mSŒšg
, SŒšg> 
	mbË2
;

22 
	mCÜfuTabË
<
	mSŒšg
, SŒšg> 
	mbË3
;

23 
CÜfuRuÁime
 
	mruÁime
;

25 
public
 
	$LogR•liÿtiÚTe¡
(
SŒšg
 
’dpošt
) {

26 
this
.
’dpošt
 =ƒndpoint;

37 
´iv©e
 
	$£tupEnv
(è
throws
 
IOExû±iÚ
 {

39 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CÜfuRuÁime.CÜfuRuÁimeP¬am‘”s.
	`bud”
()

45 .
	`ÏyoutS”v”s
(
A¼ays
.
	`asLi¡
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
’dpošt
)))

46 .
	`bud
();

48 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
)

49 .
	`£tT¿n§ùiÚLoggšg
(
Œue
);

50 
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
’dpošt
);

51 
ruÁime
.
	`»gi¡”Sy¡emDownHªdËr
((è-> {
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("Disconnected from database. Terminatinghread.");});

53 
Sy¡em
.
out
.
	`´šn
("CÚÃùšgØCÜfu " + 
’dpošt
);

54 
ruÁime
.
	`cÚÃù
();

56 
Sy¡em
.
out
.
	`´šn
("CÚÃùedØCÜfu " + 
’dpošt
);

59 
bË1
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

60 .
	`bud
()

61 .
	`£tSŒ—mName
("Table001")

62 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

64 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
PRIMITIVE
)

65 .
	`İ’
();

66 
bË2
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

67 .
	`bud
()

68 .
	`£tSŒ—mName
("Table002")

69 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

71 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
PRIMITIVE
)

72 .
	`İ’
();

73 
bË3
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

74 .
	`bud
()

75 .
	`£tSŒ—mName
("Table003")

76 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

78 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
PRIMITIVE
)

79 .
	`İ’
();

80 
	}
}

83 
´iv©e
 
	$g’”©eD©a
() {

94 
i
=0; i < 
ITERATIONS
; i++) {

95 
Œy
 {

96 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

97 
bË1
.
	`put
("T1_K" + 
i
, "T4_V" + i);

98 
bË2
.
	`put
("T2_K" + 
i
, "T5_V" + i);

99 
bË3
.
	`put
("T3_K" + 
i
, "T6_V" +i);

100 } 
fš®ly
 {

101 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

105 
	}
}

107 
´iv©e
 
	$v”ifyD©a
() {

108 ià(
bË1
.
	`isEm±y
(è&& 
bË2
.isEm±y(è&& 
bË3
.isEmpty()) {

109 
Sy¡em
.
out
.
	`´šn
("Allables‡re EMPTY");

111 
Sy¡em
.
out
.
	`´šn
("TabË1: " + 
bË1
.
	`keyS‘
());

112 
Sy¡em
.
out
.
	`´šn
("TabË2: " + 
bË2
.
	`keyS‘
());

113 
Sy¡em
.
out
.
	`´šn
("TabË3: " + 
bË3
.
	`keyS‘
());

115 
i
 = 0; i < 
ITERATIONS
; i++) {

117 ià(!
bË1
.
	`isEm±y
()è
	`as£¹Th©
ÑabË1.
	`g‘
("T1_K" + 
i
).
	`equ®s
("T1_V" + i));

118 ià(!
bË2
.
	`isEm±y
()è
	`as£¹Th©
ÑabË2.
	`g‘
("T2_K" + 
i
).
	`equ®s
("T2_V" + i));

119 ià(!
bË3
.
	`isEm±y
()è
	`as£¹Th©
ÑabË3.
	`g‘
("T3_K" + 
i
).
	`equ®s
("T3_V" + i));

123 
	}
}

125 
public
 
	$maš
(
SŒšg
[] 
¬gs
è
throws
 
Exû±iÚ
 {

126 
SŒšg
 
’dpošt
 = 
¬gs
[0];

127 
LogR•liÿtiÚTe¡
 
ÌTe¡
 = 
Ãw
 
	`LogR•liÿtiÚTe¡
(
’dpošt
);

128 
ÌTe¡
.
	`£tupEnv
();

129 if(
¬gs
[1].
	`equ®sIgnÜeCa£
("sender")) {

130 
Sy¡em
.
out
.
	`´šn
("Generating data forheables");

131 
ÌTe¡
.
	`g’”©eD©a
();

132 
Sy¡em
.
out
.
	`´šn
("Generated data forheables");

135 
Sy¡em
.
out
.
	`´šn
("Verifying data forheables");

136 
ÌTe¡
.
	`v”ifyD©a
();

137 
Sy¡em
.
out
.
	`´šn
("Verified data forheables");

139 
	}
}

	@test/src/test/java/org/corfudb/common/metrics/servers/PrometheusMetricsServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gm‘rics
.
	g£rv”s
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gTe¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gAs£¹iÚs
.*;

10 şas 
	cProm‘heusM‘ricsS”v”Te¡
 {

11 @
Te¡


12 
	$‹¡CÚfigP¬£Em±yO±s
() {

13 
M­
<
SŒšg
, 
Objeù
> 
m­
 = 
Ãw
 
HashM­
<>();

14 
Prom‘heusM‘ricsS”v”
.
CÚfig
 
cÚfig
 = Prom‘heusM‘ricsS”v”.CÚfig.
	`·r£
(
m­
);

15 
	`as£¹F®£
(
cÚfig
.
	`isEÇbËd
());

18 @
Te¡


19 
	$‹¡CÚfigP¬£EÇbËd
() {

20 
M­
<
SŒšg
, 
Objeù
> 
m­
 = 
Ãw
 
HashM­
<>();

21 
m­
.
	`put
(
Prom‘heusM‘ricsS”v”
.
CÚfig
.
METRICS_PARAM
, 
Œue
);

22 
Prom‘heusM‘ricsS”v”
.
CÚfig
 
cÚfig
 = Prom‘heusM‘ricsS”v”.CÚfig.
	`·r£
(
m­
);

23 
	`as£¹True
(
cÚfig
.
	`isEÇbËd
());

24 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/AbstractServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£HªdËr
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutHªdËr
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™HªdËr
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tHªdËr
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gSequ’ûrHªdËr
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡Cl›ÁRou‹r
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

28 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùS”v”Te¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

30 
public
 
fš®
 
UUID
 
	m‹¡Cl›ÁId
 = UUID.
ÇmeUUIDFromBy‹s
("TEST_CLIENT".
g‘By‹s
());

32 @
G‘‹r


33 
Te¡S”v”Rou‹r
 
	mrou‹r
;

35 @
G‘‹r


36 
Te¡Cl›ÁRou‹r
 
	mş›ÁRou‹r
;

38 
AtomicIÁeg”
 
	m»que¡CouÁ”
;

40 
public
 
	$Ab¡¿ùS”v”Te¡
() {

41 
rou‹r
 = 
Ãw
 
	`Te¡S”v”Rou‹r
();

42 
»que¡CouÁ”
 = 
Ãw
 
	`AtomicIÁeg”
();

44 
CÜfuRuÁime
.
ov”rideG‘Rou‹rFunùiÚ
 = 
this
::
g‘Rou‹rFunùiÚ
;

45 
ş›ÁRou‹r
 = 
	`g‘Cl›ÁRou‹r
();

48 
public
 
	$£tS”v”
(
Ab¡¿ùS”v”
 
£rv”
) {

49 
rou‹r
.
	`»£t
();

50 
rou‹r
.
	`addS”v”
(
£rv”
);

51 
	}
}

53 
public
 
ab¡¿ù
 
Ab¡¿ùS”v”
 
g‘DeçuÉS”v”
();

55 
	gpublic
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
	$£ndReque¡
(
UUID
 
ş›ÁId
, 
CÜfuMsg
 
msg
) {

56 
msg
.
	`£tCl›ÁID
(
ş›ÁId
)

57 .
	`£tReque¡ID
(
»que¡CouÁ”
.
	`g‘AndInüem’t
())

58 .
	`£tEpoch
(0L);

59 
ş›ÁRou‹r
.
	`£tCl›ÁID
(
ş›ÁId
);

60  
ş›ÁRou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
msg
);

61 
	}
}

63 
	gpublic
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
	$£ndReque¡
(
CÜfuMsg
 
msg
) {

64 
msg
.
	`£tCl›ÁID
(
‹¡Cl›ÁId
)

65 .
	`£tReque¡ID
(
»que¡CouÁ”
.
	`g‘AndInüem’t
())

66 .
	`£tEpoch
(0L);

67 
ş›ÁRou‹r
.
	`£tCl›ÁID
(
‹¡Cl›ÁId
);

68  
ş›ÁRou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
msg
);

69 
	}
}

71 
public
 
Te¡Cl›ÁRou‹r
 
	$g‘Cl›ÁRou‹r
() {

72 
Te¡Cl›ÁRou‹r
 
tú
 = 
Ãw
 
	`Te¡Cl›ÁRou‹r
(
rou‹r
);

73 
tú
.
	`£tCl›ÁID
(
‹¡Cl›ÁId
);

74 
tú
.
	`addCl›Á
(
Ãw
 
	`Ba£HªdËr
())

75 .
	`addCl›Á
(
Ãw
 
	`Sequ’ûrHªdËr
())

76 .
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
())

77 .
	`addCl›Á
(
Ãw
 
	`LogUn™HªdËr
())

78 .
	`addCl›Á
(
Ãw
 
	`Mªagem’tHªdËr
());

79  
tú
;

80 
	}
}

82 @
BefÜe


83 
public
 
	$»£tTe¡
() {

84 
rou‹r
.
	`»£t
();

85 
rou‹r
.
	`addS”v”
(
	`g‘DeçuÉS”v”
());

86 
»que¡CouÁ”
.
	`£t
(0);

87 
	}
}

90 
public
 
CÜfuMsg
 
	$g‘La¡Mes§ge
() {

91 ià(
rou‹r
.
	`g‘Re¥Ú£Mes§ges
().
	`size
(è=ğ0è 
nuÎ
;

92  
rou‹r
.
	`g‘Re¥Ú£Mes§ges
().
	`g‘
Ôou‹r.g‘Re¥Ú£Mes§ges().
	`size
() - 1);

93 
	}
}

95 @
Suµ»ssW¬nšgs
("unchecked")

96 
	gpublic
 <
	gT
> 
T
 
g‘La¡PaylßdMes§geAs
(
CÏss
<T> 
ty³
) {

97 
	gAs£¹iÚs
.
as£¹Th©
(
g‘La¡Mes§ge
())

98 .
isIn¡ªûOf
(
CÜfuPaylßdMsg
.
şass
);

99  ((
	gCÜfuPaylßdMsg
<
	gT
>)
g‘La¡Mes§ge
()).
g‘Paylßd
();

102 
public
 
	$£ndMes§ge
(
CÜfuMsg
 
mes§ge
) {

103 
	`£ndMes§ge
(
‹¡Cl›ÁId
, 
mes§ge
);

104 
	}
}

107 
public
 
	$£ndMes§ge
(
UUID
 
ş›ÁId
, 
CÜfuMsg
 
mes§ge
) {

108 
mes§ge
.
	`£tCl›ÁID
(
ş›ÁId
)

109 .
	`£tReque¡ID
(
»que¡CouÁ”
.
	`g‘AndInüem’t
())

110 .
	`£tEpoch
(0L);

111 
ş›ÁRou‹r
.
	`£ndMes§geAndG‘Com¶‘abË
(
mes§ge
);

112 
	}
}

117 
fš®
 
	gM­
<
	gCÜfuRuÁime
, M­<
	gSŒšg
, 
	gTe¡Cl›ÁRou‹r
>>

118 
	gruÁimeRou‹rM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

127 
´iv©e
 
ICl›ÁRou‹r
 
	$g‘Rou‹rFunùiÚ
(
CÜfuRuÁime
 
ruÁime
, 
SŒšg
 
’dpošt
) {

128 
ruÁimeRou‹rM­
.
	`putIfAb£Á
(
ruÁime
, 
Ãw
 
CÚcu¼’tHashM­
<>());

129 ià(!
’dpošt
.
	`¡¬tsW™h
("test:")) {

130 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("UnsuµÜ‹dƒndpošˆše¡: " + 
’dpošt
);

132  
ruÁimeRou‹rM­
.
	`g‘
(
ruÁime
).
	`compu‹IfAb£Á
(
’dpošt
,

133 
x
 -> {

134 
Te¡Cl›ÁRou‹r
 
tú
 =

135 
Ãw
 
	`Te¡Cl›ÁRou‹r
(
rou‹r
);

136 
tú
.
	`addCl›Á
(
Ãw
 
	`Ba£HªdËr
())

137 .
	`addCl›Á
(
Ãw
 
	`Sequ’ûrHªdËr
())

138 .
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
())

139 .
	`addCl›Á
(
Ãw
 
	`LogUn™HªdËr
())

140 .
	`addCl›Á
(
Ãw
 
	`Mªagem’tHªdËr
());

141  
tú
;

144 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/BaseServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

9 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
public
 cÏs 
	cBa£S”v”Te¡
 
ex‹nds
 
	mAb¡¿ùS”v”Te¡
 {

16 
Ba£S”v”
 
	mbs
;

18 @
Ov”ride


19 
public
 
Ab¡¿ùS”v”
 
	$g‘DeçuÉS”v”
() {

20 ià(
bs
 =ğ
nuÎ
) {

21 
bs
 = 
Ãw
 
	`Ba£S”v”
(
S”v”CÚ‹xtBud”
.
	`deçuÉTe¡CÚ‹xt
(0));

23  
bs
;

26 @
Te¡


27 
public
 
	$‹¡Pšg
() {

28 
Com¶‘abËFutu»
<
BoŞ—n
> 
»s
 = 
	`£ndReque¡
(
Ãw
 
	`CÜfuMsg
(
CÜfuMsgTy³
.
PING
));

29 
	`as£¹Th©
(
»s
.
	`još
()).
	`isTrue
();

30 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/DataStoreTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

5 
impÜt
 
	gjava
.
	gio
.
	gFe
;

6 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

7 
impÜt
 
	gjava
.
	gio
.
	gRªdomAcûssFe
;

8 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

9 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gD©aStÜe
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gd©a¡Üe
.
	gKvD©aStÜe
.
	gKvRecÜd
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

18 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

24 
public
 cÏs 
	cD©aStÜeTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

26 
´iv©e
 
fš®
 
	mKvRecÜd
<
	mSŒšg
> 
	mTEST_RECORD
 = 
KvRecÜd
.
of
("‹¡", "key", 
SŒšg
.
şass
);

28 
´iv©e
 
D©aStÜe
 
ü—‹P”si¡D©aStÜe
(
SŒšg
 
£rviûDœ
, SŒšg 
numR‘’tiÚ
,

29 
CÚsum”
<
SŒšg
> 
ş—nupTask
) {

30  
Ãw
 
D©aStÜe
Òew 
ImmubËM­
.
Bud”
<
SŒšg
, 
Objeù
>()

31 .
put
("--log-·th", 
£rviûDœ
)

32 .
put
("--m‘ad©a-»‹ÁiÚ", 
numR‘’tiÚ
)

33 .
bud
(), 
ş—nupTask
);

36 
´iv©e
 
D©aStÜe
 
	$ü—‹InMemÜyD©aStÜe
() {

37  
Ãw
 
	`D©aStÜe
Òew 
ImmubËM­
.
Bud”
<
SŒšg
, 
Objeù
>()

38 .
	`put
("--memÜy", 
Œue
)

39 .
	`bud
(), 
â
 -> { });

40 
	}
}

42 @
Te¡


43 
public
 
	$‹¡PutG‘
() {

44 
fš®
 
SŒšg
 
numR‘’tiÚ
 = "10";

45 
fš®
 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

46 
D©aStÜe
 
d©aStÜe
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

47 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

48 
d©aStÜe
.
	`put
(
TEST_RECORD
, 
v®ue
);

49 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
(
v®ue
);

51 
d©aStÜe
.
	`put
(
TEST_RECORD
, "NEW_VALUE");

52 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
("NEW_VALUE");

53 
	}
}

55 @
Te¡


56 
public
 
	$‹¡D©aCÜru±iÚ
(è
throws
 
IOExû±iÚ
 {

57 
fš®
 
SŒšg
 
numR‘’tiÚ
 = "10";

58 
fš®
 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

59 
D©aStÜe
 
d©aStÜe
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

60 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

61 
d©aStÜe
.
	`put
(
TEST_RECORD
, 
v®ue
);

63 
SŒšg
 
feName
 = 
PARAMETERS
.
TEST_TEMP_DIR
 + 
Fe
.
£·¿tÜ
 + "‹¡_key" + 
D©aStÜe
.
EXTENSION
;

64 
RªdomAcûssFe
 
dsFe
 = 
Ãw
 
	`RªdomAcûssFe
(
feName
, "rw");

66 
dsFe
.
	`£ek
(
v®ue
.
	`Ëngth
() / 2);

67 
dsFe
.
	`wr™eShÜt
(0);

68 
dsFe
.
	`şo£
();

71 
fš®
 
D©aStÜe
 
d©aStÜe2
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

72 
	`as£¹Th©ThrownBy
((è-> 
d©aStÜe2
.
	`g‘
(
TEST_RECORD
))

73 .
	`isIn¡ªûOf
(
D©aCÜru±iÚExû±iÚ
.
şass
);

74 
	}
}

76 @
Te¡


77 
public
 
	$‹¡PutG‘W™hRe¡¬t
() {

78 
fš®
 
SŒšg
 
numR‘’tiÚ
 = "10";

79 
fš®
 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

80 
D©aStÜe
 
d©aStÜe
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

81 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

82 
d©aStÜe
.
	`put
(
TEST_RECORD
, 
v®ue
);

85 
d©aStÜe
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

86 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
(
v®ue
);

88 
d©aStÜe
.
	`put
(
TEST_RECORD
, "NEW_VALUE");

89 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
("NEW_VALUE");

90 
	}
}

92 @
Te¡


93 
public
 
	$‹¡D©aStÜeEviùiÚ
() {

94 
fš®
 
SŒšg
 
numR‘’tiÚ
 = "10";

95 
fš®
 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

96 
D©aStÜe
 
d©aStÜe
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

98 
i
 = 0; i < 
d©aStÜe
.
	`g‘DsCacheSize
() * 2; i++) {

99 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

100 
d©aStÜe
.
	`put
(
TEST_RECORD
, 
v®ue
);

103 
d©aStÜe
 = 
	`ü—‹P”si¡D©aStÜe
(
£rviûDœ
, 
numR‘’tiÚ
, 
â
 -> { });

104 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
(
v®ue
);

105 
d©aStÜe
.
	`put
(
TEST_RECORD
, "NEW_VALUE");

106 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
("NEW_VALUE");

108 
	}
}

110 @
Te¡


111 
public
 
	$‹¡D©aStÜeCËªup
() {

112 
fš®
 
numR‘’tiÚ
 = 10;

113 
fš®
 
SŒšg
 
£rviûDœP©h
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

114 
Fe
 
£rviûDœ
 = 
Ãw
 
	`Fe
(
£rviûDœP©h
);

116 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

117 .
	`£tMemÜy
(
çl£
)

118 .
	`£tLogP©h
(
£rviûDœP©h
)

119 .
	`£tR‘’tiÚ
(
SŒšg
.
	`v®ueOf
(
numR‘’tiÚ
))

120 .
	`bud
();

121 
D©aStÜe
 
d©aStÜe
 = 
£rv”CÚ‹xt
.
	`g‘D©aStÜe
();

122 
S‘
<
SŒšg
> 
´efixesToCËª
 = 
£rv”CÚ‹xt
.
	`g‘DsFeP»fixesFÜCËªup
();

124 
i
 = 1; i < 
numR‘’tiÚ
 + 2; i++) {

125 
fš®
 
•och
 = 
i
;

126 
´efixesToCËª
.
	`fÜEach
(
´efix
 -> {

127 
SŒšg
 
key
 = 
•och
 + "KEY";

128 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

129 
d©aStÜe
.
	`put
(
KvRecÜd
.
	`of
(
´efix
, 
key
, 
SŒšg
.
şass
), 
v®ue
);

132 
´efixesToCËª
.
	`fÜEach
(
´efix
 -> {

135 
Fe
[] 
foundFes
 = 
£rviûDœ
.
	`li¡Fes
((
dœ
, 
Çme
è->‚ame.
	`¡¬tsW™h
(
´efix
));

136 ià(
•och
 > 
numR‘’tiÚ
) {

137 
	`as£¹Th©
(
foundFes
).
	`hasSize
(
numR‘’tiÚ
);

139 
j
 = 
•och
; j >ƒpoch - 
numR‘’tiÚ
; j--) {

140 
SŒšg
 
feName
 = 
´efix
 + "_" + 
•och
 + "KEY" + 
D©aStÜe
.
EXTENSION
;

141 
	`as£¹Th©
(
Ãw
 
	`Fe
(
£rviûDœ
, 
feName
).
	`exi¡s
()).
	`isTrue
();

144 
	`as£¹Th©
(
foundFes
).
	`hasSize
(
•och
);

148 
	}
}

150 @
Te¡


151 
public
 
	$‹¡InMemÜyPutG‘
() {

152 
D©aStÜe
 
d©aStÜe
 = 
	`ü—‹InMemÜyD©aStÜe
();

153 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

154 
d©aStÜe
.
	`put
(
TEST_RECORD
, 
v®ue
);

155 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
(
v®ue
);

157 
d©aStÜe
.
	`put
(
TEST_RECORD
, "NEW_VALUE");

158 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
("NEW_VALUE");

160 
	}
}

162 @
Te¡


163 
public
 
	$‹¡InMemÜyEviùiÚ
() {

164 
D©aStÜe
 
d©aStÜe
 = 
	`ü—‹InMemÜyD©aStÜe
();

166 
i
 = 0; i < 
d©aStÜe
.
	`g‘DsCacheSize
() * 2; i++) {

167 
SŒšg
 
v®ue
 = 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
();

168 
d©aStÜe
.
	`put
(
TEST_RECORD
, 
v®ue
);

169 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
(
v®ue
);

171 
d©aStÜe
.
	`put
(
TEST_RECORD
, "NEW_VALUE");

172 
	`as£¹Th©
(
d©aStÜe
.
	`g‘
(
TEST_RECORD
)).
	`isEqu®To
("NEW_VALUE");

174 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/LayoutBuilderTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLayoutModifiÿtiÚExû±iÚ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gR•liÿtiÚMode
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayoutBud”
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

23 
public
 cÏs 
	cLayoutBud”Te¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

25 
´iv©e
 
fš®
 
	mSERVER_ENTRY_3
 = 3;

26 
´iv©e
 
fš®
 
	mSERVER_ENTRY_4
 = 4;

34 @
Te¡


35 
public
 
	$checkRemov®OfNodes
(è
throws
 
LayoutModifiÿtiÚExû±iÚ
 {

36 
Layout
 
Üigš®Layout
 = 
Ãw
 
	`Te¡LayoutBud”
()

37 .
	`£tEpoch
(1L)

38 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

39 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

40 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

41 .
	`addLayoutS”v”
(
SERVERS
.
PORT_3
)

42 .
	`addLayoutS”v”
(
SERVERS
.
PORT_4
)

43 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

44 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

45 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

46 .
	`budSegm’t
()

47 .
	`£tR•liÿtiÚMode
(
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

48 .
	`budSŒe
()

49 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

50 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

51 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

52 .
	`addToSegm’t
()

53 .
	`budSŒe
()

54 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

55 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

56 .
	`addLogUn™
(
SERVERS
.
PORT_4
)

57 .
	`addToSegm’t
()

58 .
	`addToLayout
()

59 .
	`bud
();

61 
Li¡
<
SŒšg
> 
®lNodes
 = 
Ãw
 
A¼ayLi¡
<>();

62 
®lNodes
.
	`add
(
Te¡LayoutBud”
.
	`g‘Endpošt
(
SERVERS
.
PORT_0
));

63 
®lNodes
.
	`add
(
Te¡LayoutBud”
.
	`g‘Endpošt
(
SERVERS
.
PORT_1
));

64 
®lNodes
.
	`add
(
Te¡LayoutBud”
.
	`g‘Endpošt
(
SERVERS
.
PORT_2
));

65 
®lNodes
.
	`add
(
Te¡LayoutBud”
.
	`g‘Endpošt
(
SERVERS
.
PORT_3
));

66 
®lNodes
.
	`add
(
Te¡LayoutBud”
.
	`g‘Endpošt
(
SERVERS
.
PORT_4
));

68 
S‘
<
SŒšg
> 
çedNodes
 = 
Ãw
 
HashS‘
<>();

69 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
Üigš®Layout
);

72 
çedNodes
.
	`addAÎ
(
®lNodes
);

80 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLayoutS”v”s
(
çedNodes
).
	`bud
()

81 ).
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

84 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveSequ’ûrS”v”s
(
çedNodes
).
	`bud
())

85 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

88 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLogun™S”v”s
(
çedNodes
).
	`bud
())

89 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

92 
çedNodes
.
	`ş—r
();

93 
çedNodes
.
	`add
(
®lNodes
.
	`g‘
(0));

94 
çedNodes
.
	`add
(
®lNodes
.
	`g‘
(2));

95 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLogun™S”v”s
(
çedNodes
).
	`bud
())

96 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

105 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

106 .
	`£tEpoch
(1L)

107 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

108 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

109 .
	`addLayoutS”v”
(
SERVERS
.
PORT_3
)

110 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

111 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

112 .
	`budSegm’t
()

113 .
	`£tR•liÿtiÚMode
(
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

114 .
	`budSŒe
()

115 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

116 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

117 .
	`addToSegm’t
()

118 .
	`budSŒe
()

119 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

120 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

121 .
	`addToSegm’t
()

122 .
	`addToLayout
()

123 .
	`£tClu¡”Id
(
Üigš®Layout
.
	`g‘Clu¡”Id
())

124 .
	`bud
();

126 
çedNodes
.
	`ş—r
();

127 
çedNodes
.
	`add
(
®lNodes
.
	`g‘
(0));

128 
çedNodes
.
	`add
(
®lNodes
.
	`g‘
(
SERVER_ENTRY_4
));

130 
Layout
 
aùu®Layout
 = 
ÏyoutBud”


131 .
	`»moveLayoutS”v”s
(
çedNodes
)

132 .
	`»moveLogun™S”v”s
(
çedNodes
)

133 .
	`»moveSequ’ûrS”v”s
(
çedNodes
)

134 .
	`bud
();

135 
As£¹iÚs
.
	`as£¹Th©
(
aùu®Layout
).
	`isEqu®To
(
ex³ùedLayout
);

137 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

138 .
	`£tEpoch
(1L)

139 .
	`addLayoutS”v”
(
SERVERS
.
PORT_3
)

140 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

141 .
	`budSegm’t
()

142 .
	`£tR•liÿtiÚMode
(
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

143 .
	`budSŒe
()

144 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

145 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

146 .
	`addToSegm’t
()

147 .
	`budSŒe
()

148 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

149 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

150 .
	`addToSegm’t
()

151 .
	`addToLayout
()

152 .
	`bud
();

159 
ÏyoutBud”
.
	`»moveLayoutS”v”
(
®lNodes
.
	`g‘
(1));

160 
ÏyoutBud”
.
	`»moveLayoutS”v”
(
®lNodes
.
	`g‘
(2));

163 
ÏyoutBud”
.
	`»moveLayoutS”v”
(
®lNodes
.
	`g‘
(2));

166 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLayoutS”v”
(
®lNodes
.
	`g‘
(
SERVER_ENTRY_3
)))

167 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

170 
ÏyoutBud”
.
	`»moveSequ’ûrS”v”
(
®lNodes
.
	`g‘
(1));

173 
ÏyoutBud”
.
	`»moveSequ’ûrS”v”
(
®lNodes
.
	`g‘
(1));

176 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveSequ’ûrS”v”
(
®lNodes
.
	`g‘
(2)))

177 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

180 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLogun™S”v”
(
®lNodes
.
	`g‘
(1)))

181 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

184 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLogun™S”v”
(
®lNodes
.
	`g‘
(2)))

185 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

188 
	`as£¹Th©
(
ÏyoutBud”
.
	`bud
()).
	`isEqu®To
(
ex³ùedLayout
);

192 @
Te¡


193 
public
 
	$checkšgFÜNuÎArgum’tsInLayoutBud”
(è
throws
 
Exû±iÚ
 {

194 
Layout
 
Üigš®Layout
 = 
Ãw
 
	`Te¡LayoutBud”
()

195 .
	`£tEpoch
(1L)

196 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

197 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

198 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

199 .
	`addLayoutS”v”
(
SERVERS
.
PORT_3
)

200 .
	`addLayoutS”v”
(
SERVERS
.
PORT_4
)

201 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

202 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

203 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

204 .
	`budSegm’t
()

205 .
	`£tR•liÿtiÚMode
(
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

206 .
	`budSŒe
()

207 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

208 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

209 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

210 .
	`addToSegm’t
()

211 .
	`budSŒe
()

212 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

213 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

214 .
	`addLogUn™
(
SERVERS
.
PORT_4
)

215 .
	`addToSegm’t
()

216 .
	`addToLayout
()

217 .
	`bud
();

220 
	`as£¹Th©ThrownBy
((è-> 
Ãw
 
	`LayoutBud”
(
nuÎ
))

221 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

224 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
Üigš®Layout
);

227 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`addLayoutS”v”
(
nuÎ
))

228 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

230 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`addLogun™S”v”
(0,

232 
nuÎ
))

233 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

235 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`addLogun™S”v”ToSegm’t
(
nuÎ
,

238 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

240 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`addSequ’ûrS”v”
(
nuÎ
))

241 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

243 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`addUÄe¥ÚsiveS”v”s
(
nuÎ
))

244 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

246 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
nuÎ
))

247 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

249 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveFromSŒe
(
nuÎ
,

250 
nuÎ
,

252 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

254 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLayoutS”v”
(
nuÎ
))

255 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

257 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLayoutS”v”s
(
nuÎ
))

258 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

260 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLogun™S”v”
(
nuÎ
))

261 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

263 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveLogun™S”v”s
(
nuÎ
))

264 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

266 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveSequ’ûrS”v”
(
nuÎ
))

267 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

269 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveSequ’ûrS”v”s
(
nuÎ
))

270 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

272 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveUÄe¥ÚsiveS”v”
(
nuÎ
))

273 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

275 
	`as£¹Th©ThrownBy
((è-> 
ÏyoutBud”
.
	`»moveUÄe¥ÚsiveS”v”s
(
nuÎ
))

276 .
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
);

277 
	}
}

284 @
Te¡


285 
public
 
	$checkAdd™iÚOfNodes
(è
throws
 
Exû±iÚ
 {

287 
Layout
 
Üigš®Layout
 = 
Ãw
 
	`Te¡LayoutBud”
()

288 .
	`£tEpoch
(1L)

289 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

290 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

291 .
	`budSegm’t
()

292 .
	`budSŒe
()

293 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

294 .
	`addToSegm’t
()

295 .
	`budSŒe
()

296 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

297 .
	`addToSegm’t
()

298 .
	`addToLayout
()

299 .
	`bud
();

301 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
Üigš®Layout
);

303 
fš®
 
glob®LogTa
 = 50L;

304 
ÏyoutBud”
.
	`addLayoutS”v”
(
SERVERS
.
ENDPOINT_1
);

305 
ÏyoutBud”
.
	`addSequ’ûrS”v”
(
SERVERS
.
ENDPOINT_2
);

306 
ÏyoutBud”
.
	`addLogun™S”v”
(1, 
glob®LogTa
, 
SERVERS
.
ENDPOINT_3
);

309 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

310 .
	`£tEpoch
(1L)

311 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

312 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

313 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

314 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

315 .
	`budSegm’t
()

316 .
	`£tEnd
(
glob®LogTa
 + 1)

317 .
	`budSŒe
()

318 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

319 .
	`addToSegm’t
()

320 .
	`budSŒe
()

321 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

322 .
	`addToSegm’t
()

323 .
	`addToLayout
()

324 .
	`budSegm’t
()

325 .
	`£tS¹
(
glob®LogTa
 + 1)

326 .
	`budSŒe
()

327 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

328 .
	`addToSegm’t
()

329 .
	`budSŒe
()

330 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

331 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

332 .
	`addToSegm’t
()

333 .
	`addToLayout
()

334 .
	`bud
();

336 
	`as£¹Th©
(
ÏyoutBud”
.
	`bud
()).
	`isEqu®To
(
ex³ùedLayout
);

337 
	}
}

346 @
Te¡


347 
public
 
	$»assignRe¥ÚsiveSequ’ûr
(è
throws
 
Exû±iÚ
 {

349 
Layout
 
Üigš®Layout
 = 
Ãw
 
	`Te¡LayoutBud”
()

350 .
	`£tEpoch
(1L)

351 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

352 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

353 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

354 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

355 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

356 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

357 .
	`budSegm’t
()

358 .
	`budSŒe
()

359 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

360 .
	`addToSegm’t
()

361 .
	`addToLayout
()

362 .
	`addUÄe¥ÚsiveS”v”
(
SERVERS
.
PORT_1
)

363 .
	`bud
();

365 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
Üigš®Layout
)

366 .
	`assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_0
))

367 .
	`addUÄe¥ÚsiveS”v”s
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_0
));

372 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

373 .
	`£tEpoch
(1L)

374 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

375 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

376 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

377 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

378 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

379 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

380 .
	`budSegm’t
()

381 .
	`budSŒe
()

382 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

383 .
	`addToSegm’t
()

384 .
	`addToLayout
()

385 .
	`addUÄe¥ÚsiveS”v”
(
SERVERS
.
PORT_1
)

386 .
	`addUÄe¥ÚsiveS”v”
(
SERVERS
.
PORT_0
)

387 .
	`bud
();

389 
	`as£¹Th©
(
ÏyoutBud”
.
	`bud
()).
	`isEqu®To
(
ex³ùedLayout
);

390 
	}
}

399 @
	$Te¡
 (
ex³ùed
 = 
LayoutModifiÿtiÚExû±iÚ
.
şass
)

400 
public
 
	$unsucûssfulSequ’ûrFaov”ThrowsExû±iÚ
(è
throws
 
Exû±iÚ
 {

401 
Layout
 
Üigš®Layout
 = 
Ãw
 
	`Te¡LayoutBud”
()

402 .
	`£tEpoch
(1L)

403 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

404 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

405 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

406 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

407 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

408 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

409 .
	`budSegm’t
()

410 .
	`budSŒe
()

411 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

412 .
	`addToSegm’t
()

413 .
	`addToLayout
()

414 .
	`bud
();

416 
LayoutBud”
 
ÏyoutBud”
 = 
Ãw
 
	`LayoutBud”
(
Üigš®Layout
)

417 .
	`addUÄe¥ÚsiveS”v”s
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_0
))

418 .
	`addUÄe¥ÚsiveS”v”s
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_1
))

419 .
	`addUÄe¥ÚsiveS”v”s
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_2
))

420 .
	`assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_0
));

421 
ÏyoutBud”
.
	`bud
();

422 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/LayoutServerAssertions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAb¡¿ùAs£¹
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
public
 
şass
 
LayoutS”v”As£¹iÚs
 
ex‹nds
 
	gAb¡¿ùAs£¹
<
	gLayoutS”v”As£¹iÚs
, 
	gLayoutS”v”
> {

11 
public
 
LayoutS”v”As£¹iÚs
(
LayoutS”v”
 
aùu®
) {

12 
su³r
(
aùu®
, 
LayoutS”v”As£¹iÚs
.
şass
);

15 
public
 
LayoutS”v”As£¹iÚs
 
as£¹Th©
(
LayoutS”v”
 
aùu®
) {

16  
Ãw
 
LayoutS”v”As£¹iÚs
(
aùu®
);

19 
public
 
LayoutS”v”As£¹iÚs
 
isInEpoch
(
•och
) {

20 
isNÙNuÎ
();

21 
fš®
 
	g£rv”Epoch
 = 
aùu®
.
g‘S”v”CÚ‹xt
().
g‘S”v”Epoch
();

22 ià(
	g£rv”Epoch
 !ğ
•och
) {

23 
çW™hMes§ge
("Expected servero be inƒpoch <%d> but it was inƒpoch <%d>",

24 
•och
, 
£rv”Epoch
);

26  
	gthis
;

29 
public
 
LayoutS”v”As£¹iÚs
 
isPha£1Rªk
(
Rªk
 
pha£1Rªk
) {

30 
isNÙNuÎ
();

31 
fš®
 
	g£rv”Epoch
 = 
aùu®
.
g‘S”v”CÚ‹xt
().
g‘S”v”Epoch
();

32 ià(!
	gaùu®
.
g‘Pha£1Rªk
(
£rv”Epoch
).
equ®s
(
pha£1Rªk
)) {

33 
çW™hMes§ge
("Ex³ùed s”v”Øbš…ha£1Rªk <%s> buˆ™ wa š…ha£1Rªk <%s>", 
pha£1Rªk
,

34 
aùu®
.
g‘Pha£1Rªk
(
£rv”Epoch
));

36  
	gthis
;

39 
public
 
LayoutS”v”As£¹iÚs
 
isPha£2Rªk
(
Rªk
 
pha£2Rªk
) {

40 
isNÙNuÎ
();

41 
fš®
 
	g£rv”Epoch
 = 
aùu®
.
g‘S”v”CÚ‹xt
().
g‘S”v”Epoch
();

42 ià(!
	gaùu®
.
g‘Pha£2Rªk
(
£rv”Epoch
).
equ®s
(
pha£2Rªk
)) {

43 
çW™hMes§ge
("Ex³ùed s”v”Øbš…ha£2Rªk <%s> buˆ™ wa š…ha£2Rªk <%s>", 
pha£2Rªk
,

44 
aùu®
.
g‘Pha£2Rªk
(
£rv”Epoch
));

46  
	gthis
;

49 
public
 
LayoutS”v”As£¹iÚs
 
isPrİo£dLayout
(
Layout
 
Ïyout
) {

50 
isNÙNuÎ
();

51 
fš®
 
	g£rv”Epoch
 = 
aùu®
.
g‘S”v”CÚ‹xt
().
g‘S”v”Epoch
();

52 ià(!
	gaùu®
.
g‘Prİo£dLayout
(
£rv”Epoch
).
asJSONSŒšg
().
equ®s
(
Ïyout
.asJSONString())) {

53 
çW™hMes§ge
("Ex³ùed s”v”Øhav´İo£dLayouˆ <%s> buˆ™ i <%s>", 
Ïyout
,

54 
aùu®
.
g‘Prİo£dLayout
(
£rv”Epoch
));

57  
	gthis
;

	@test/src/test/java/org/corfudb/infrastructure/LayoutServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLayoutS”v”As£¹iÚs
.
	gas£¹Th©
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutBoÙ¡¿pReque¡
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutComm™‹dReque¡
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Reque¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutP»·»Re¥Ú£
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutPrİo£Reque¡
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoBoÙ¡¿pExû±iÚ
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

26 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
;

31 @
Slf4j


32 
public
 cÏs 
	cLayoutS”v”Te¡
 
ex‹nds
 
	mAb¡¿ùS”v”Te¡
 {

34 @
Ov”ride


35 
public
 
LayoutS”v”
 
	$g‘DeçuÉS”v”
() {

36 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

37  
	`g‘DeçuÉS”v”
(
£rviûDœ
);

40 
fš®
 
LOW_RANK
 = 10L;

41 
fš®
 
HIGH_RANK
 = 100L;

47 @
Te¡


48 
public
 
	$nÚBoÙ¡¿µedS”v”NoLayout
() {

51 
Com¶‘abËFutu»
<
Layout
> 
»¥
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
LAYOUT_REQUEST
.
	`·ylßdMsg
(0l));

52 
	`as£¹Th©ThrownBy
((è-> 
»¥
.
	`g‘
()).
	`hasCau£ExaùlyIn¡ªûOf
(
NoBoÙ¡¿pExû±iÚ
.
şass
);

53 
	}
}

59 @
Te¡


60 
public
 
	$boÙ¡¿pS”v”In¡®lsNewLayout
() {

61 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

62 
	`boÙ¡¿pS”v”
(
Ïyout
);

63 
Layout
 
»s
 = 
	`»que¡Layout
(
Ïyout
.
	`g‘Epoch
()).
	`još
();

64 
As£¹iÚs
.
	`as£¹Th©
(
»s
).
	`isEqu®To
(
Ïyout
);

65 
	}
}

70 @
Te¡


71 
public
 
	$ÿÂÙBoÙ¡¿pS”v”Twiû
() {

72 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

73 
	`boÙ¡¿pS”v”
(
Ïyout
);

74 
	`as£¹Th©ThrownBy
((è-> 
	`boÙ¡¿pS”v”
(
Ïyout
))

75 .
	`hasCau£ExaùlyIn¡ªûOf
(
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

76 
	}
}

84 @
Te¡


85 
public
 
	$´•¬eRejeùsLow”Rªks
() {

86 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

87 
•och
 = 
Ïyout
.
	`g‘Epoch
();

88 
	`boÙ¡¿pS”v”
(
Ïyout
);

89 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
•och
, 
HIGH_RANK
).
	`još
();

90 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

91 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

93 
	`as£¹Th©ThrownBy
((è-> 
	`£ndP»·»
(
•och
, 
LOW_RANK
).
	`još
())

94 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

95 
	}
}

102 @
Te¡


103 
public
 
	$´İo£RejeùsLow”Rªks
() {

104 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

105 
•och
 = 
Ïyout
.
	`g‘Epoch
();

106 
	`boÙ¡¿pS”v”
(
Ïyout
);

107 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
•och
, 
HIGH_RANK
).
	`još
();

108 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

109 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

110 
	`as£¹Th©ThrownBy
((è-> 
	`£ndPrİo£
(
•och
, 
LOW_RANK
, 
Ïyout
).
	`još
())

111 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

112 
	}
}

118 @
Te¡


119 
public
 
	$´İo£RejeùsAÌ—dyPrİo£d
() {

120 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

121 
•och
 = 
Ïyout
.
	`g‘Epoch
();

122 
	`boÙ¡¿pS”v”
(
Ïyout
);

124 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
•och
, 
LOW_RANK
).
	`još
();

125 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

126 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

128 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
•och
, 
LOW_RANK
, 
Ïyout
).
	`još
()).
	`isTrue
();

130 
	`as£¹Th©ThrownBy
((è-> 
	`£ndPrİo£
(
•och
, 
LOW_RANK
, 
Ïyout
).
	`još
())

131 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

132 
	}
}

138 @
Te¡


139 
public
 
	$comm™R‘uºsAck
() {

140 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

141 
	`boÙ¡¿pS”v”
(
Ïyout
);

143 
ÃwEpoch
 = 
Ïyout
.
	`g‘Epoch
() + 1;

144 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

145 
ÃwLayout
.
	`£tEpoch
(
ÃwEpoch
);

148 
	`£tEpoch
(
ÃwEpoch
).
	`još
();

150 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
).
	`još
();

151 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

152 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

153 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
ÃwEpoch
, 
HIGH_RANK
, 
ÃwLayout
).
	`još
()).
	`isTrue
();

154 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndComm™‹d
(
ÃwEpoch
, 
ÃwLayout
).
	`još
()).
	`isTrue
();

155 
	}
}

162 @
Te¡


163 
public
 
	$checkS”v”EpochDÛsNÙReg»ss
() {

164 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

165 
•och
 = 
Ïyout
.
	`g‘Epoch
();

167 
	`boÙ¡¿pS”v”
(
Ïyout
);

169 
As£¹iÚs
.
	`as£¹Th©
(
	`£tEpoch
(2).
	`još
()).
	`isTrue
();

171 
Layout
 
»¥
 = 
	`»que¡Layout
(
•och
).
	`još
();

172 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Epoch
()).
	`isEqu®To
(
Ïyout
.getEpoch());

174 
	`£tEpoch
(1);

175 
	`as£¹Th©ThrownBy
((è-> 
	`£tEpoch
(1).
	`još
())

176 .
	`hasCau£ExaùlyIn¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

177 
	}
}

184 @
Te¡


185 
public
 
	$checkLayoutP”si¡ed
(è
throws
 
Exû±iÚ
 {

187 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

189 
LayoutS”v”
 
s1
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

191 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

192 
	`boÙ¡¿pS”v”
(
Ïyout
);

194 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

196 
fš®
 
OLD_EPOCH
 = 0;

197 
fš®
 
NEW_EPOCH
 = 100;

199 
ÃwLayout
.
	`£tEpoch
(
NEW_EPOCH
);

200 
	`£tEpoch
(
NEW_EPOCH
).
	`još
();

204 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
NEW_EPOCH
, 1).
	`još
();

205 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

206 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

208 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
NEW_EPOCH
, 1, 
ÃwLayout
).
	`još
()).
	`isTrue
();

209 
	`as£¹Th©
(
s1
).
	`isInEpoch
(
NEW_EPOCH
);

210 
	`as£¹Th©
(
s1
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

211 
	`as£¹Th©
(
s1
).
	`isPha£2Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

212 
s1
.
	`shutdown
();

214 
LayoutS”v”
 
s2
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

215 
this
.
rou‹r
.
	`»£t
();

216 
this
.
rou‹r
.
	`addS”v”
(
s2
);

218 
	`as£¹Th©
(
s2
).
	`isInEpoch
(
NEW_EPOCH
);

219 
	`as£¹Th©
(
s2
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

220 
	`as£¹Th©
(
s2
).
	`isPha£2Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

223 
Layout
 
ŞdLayout
 = 
	`»que¡Layout
(
OLD_EPOCH
).
	`još
();

224 
As£¹iÚs
.
	`as£¹Th©
(
ŞdLayout
.
	`g‘Epoch
()).
	`isEqu®To
(0);

227 
Layout
 
ÃwLayoutRe¥
 = 
	`»que¡Layout
(
NEW_EPOCH
).
	`još
();

228 
As£¹iÚs
.
	`as£¹Th©
(
ÃwLayoutRe¥
.
	`g‘Epoch
()).
	`isEqu®To
(0);

229 
	}
}

237 @
Te¡


238 
public
 
	$checkPaxosPha£sP”si¡ed
(è
throws
 
Exû±iÚ
 {

239 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

240 
LayoutS”v”
 
s1
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

242 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

243 
	`boÙ¡¿pS”v”
(
Ïyout
);

245 
ÃwEpoch
 = 
Ïyout
.
	`g‘Epoch
() + 1;

246 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

247 
ÃwLayout
.
	`£tEpoch
(
ÃwEpoch
);

249 
	`£tEpoch
(
ÃwEpoch
).
	`još
();

252 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 1).
	`još
();

253 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

254 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

255 
	`as£¹Th©
(
s1
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

257 
s1
.
	`shutdown
();

259 
LayoutS”v”
 
s2
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

261 
	`as£¹Th©
(
s2
).
	`isInEpoch
(
ÃwEpoch
);

262 
	`as£¹Th©
(
s2
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

265 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
ÃwEpoch
, 1, 
ÃwLayout
).
	`još
()).
	`isTrue
();

267 
s2
.
	`shutdown
();

270 
LayoutS”v”
 
s3
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

272 
	`as£¹Th©
(
s3
).
	`isInEpoch
(
ÃwEpoch
);

273 
	`as£¹Th©
(
s3
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

274 
	`as£¹Th©
(
s3
).
	`isPha£2Rªk
(
Ãw
 
	`Rªk
(1L, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

275 
	`as£¹Th©
(
s3
).
	`isPrİo£dLayout
(
ÃwLayout
);

277 
	}
}

285 @
Te¡


286 
public
 
	$checkMes§gesV®id©edAgaš¡Pha£1P”si¡edD©a
(è
throws
 
Exû±iÚ
 {

287 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

288 
LayoutS”v”
 
s1
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

289 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

290 
	`boÙ¡¿pS”v”
(
Ïyout
);

292 
ÃwEpoch
 = 
Ïyout
.
	`g‘Epoch
() + 1;

293 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

294 
ÃwLayout
.
	`£tEpoch
(
ÃwEpoch
);

296 
	`£tEpoch
(
ÃwEpoch
).
	`još
();

298 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
).
	`još
();

299 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

300 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

302 
	`as£¹Th©
(
s1
).
	`isInEpoch
(
ÃwEpoch
);

303 
	`as£¹Th©
(
s1
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

305 
s1
.
	`shutdown
();

307 
LayoutS”v”
 
s2
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

308 
	`as£¹Th©
(
s2
).
	`isInEpoch
(
ÃwEpoch
);

309 
	`as£¹Th©
(
s2
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

312 
	`as£¹Th©ThrownBy
((è-> 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
 - 1).
	`još
())

313 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

317 
»¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
 + 1).
	`još
();

318 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

319 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

320 
	}
}

332 @
Te¡


333 
public
 
	$checkMes§gesV®id©edAgaš¡Pha£2P”si¡edD©a
(è
throws
 
Exû±iÚ
 {

334 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

335 
LayoutS”v”
 
s1
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

336 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

337 
	`boÙ¡¿pS”v”
(
Ïyout
);

339 
ÃwEpoch
 = 
Ïyout
.
	`g‘Epoch
() + 1;

340 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

341 
ÃwLayout
.
	`£tEpoch
(
ÃwEpoch
);

343 
	`£tEpoch
(
ÃwEpoch
).
	`još
();

344 
	`as£¹Th©
(
s1
).
	`isInEpoch
(
ÃwEpoch
);

347 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
).
	`još
();

348 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

349 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

351 
	`as£¹Th©
(
s1
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

353 
s1
.
	`shutdown
();

355 
LayoutS”v”
 
s2
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

356 
	`as£¹Th©
(
s2
).
	`isInEpoch
(
ÃwEpoch
);

357 
	`as£¹Th©
(
s2
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

360 
	`as£¹Th©ThrownBy
((è-> 
	`£ndPrİo£
(
ÃwEpoch
, 
HIGH_RANK
 - 1, 
ÃwLayout
).
	`još
())

361 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

364 
	`as£¹Th©ThrownBy
((è-> 
	`£ndPrİo£
(
ÃwEpoch
, 
HIGH_RANK
 + 1, 
ÃwLayout
).
	`još
())

365 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

369 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
ÃwEpoch
, 
HIGH_RANK
, 
ÃwLayout
).
	`još
()).
	`isEqu®To
(
Œue
);

370 
	`as£¹Th©
(
s2
).
	`isPrİo£dLayout
(
ÃwLayout
);

372 
s2
.
	`shutdown
();

374 
LayoutS”v”
 
s3
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

375 
	`as£¹Th©
(
s3
).
	`isInEpoch
(
ÃwEpoch
);

376 
	`as£¹Th©
(
s3
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

377 
	`as£¹Th©
(
s3
).
	`isPrİo£dLayout
(
ÃwLayout
);

378 
	}
}

390 @
Te¡


391 
public
 
	$checkPha£1AndPha£2Mes§gesFromMuÉËCl›Ás
(è
throws
 
Exû±iÚ
 {

392 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

394 
LayoutS”v”
 
s1
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

395 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

396 
	`boÙ¡¿pS”v”
(
Ïyout
);

398 
ÃwEpoch
 = 
Ïyout
.
	`g‘Epoch
() + 1;

399 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

400 
ÃwLayout
.
	`£tEpoch
(
ÃwEpoch
);

402 
	`£tEpoch
(
ÃwEpoch
).
	`još
();

405 
LayoutP»·»Re¥Ú£
 
»¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
).
	`još
();

406 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

407 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Layout
()).
	`isNuÎ
();

408 
	`as£¹Th©
(
s1
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
, 
Ab¡¿ùS”v”Te¡
.
‹¡Cl›ÁId
));

413 
	`as£¹Th©ThrownBy
((è-> 
	`£ndP»·»
(
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
()), 
ÃwEpoch
, 
HIGH_RANK
)

414 .
	`još
())

415 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

417 
	`as£¹Th©ThrownBy
((è-> 
	`£ndP»·»
(
UUID
.
	`ÇmeUUIDFromBy‹s
("TEST_CLIENT_OTHER".
	`g‘By‹s
()), 
ÃwEpoch
,

418 
HIGH_RANK
).
	`još
())

419 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

422 
»¥
 = 
	`£ndP»·»
(
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
()),

423 
ÃwEpoch
, 
HIGH_RANK
 + 1).
	`još
();

424 
	`as£¹Th©
(
s1
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
 + 1, 
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
())));

427 
s1
.
	`shutdown
();

428 
LayoutS”v”
 
s2
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

429 
	`as£¹Th©
(
s2
).
	`isInEpoch
(
ÃwEpoch
);

430 
	`as£¹Th©
(
s2
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
 + 1, 
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
())));

432 
	`as£¹Th©ThrownBy
((è-> 
	`£ndP»·»
(
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
()),

433 
ÃwEpoch
, 
HIGH_RANK
 + 1).
	`još
()).
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

438 
	`as£¹Th©ThrownBy
((è-> 
	`£ndPrİo£
(
ÃwEpoch
, 
HIGH_RANK
 + 1, 
ÃwLayout
).
	`još
())

439 .
	`hasCau£ExaùlyIn¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

442 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
()), 
ÃwEpoch
,

443 
HIGH_RANK
 + 1, 
ÃwLayout
).
	`još
()).
	`isTrue
();

445 
	`as£¹Th©
(
s2
).
	`isInEpoch
(
ÃwEpoch
);

446 
	`as£¹Th©
(
s2
).
	`isPha£1Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
 + 1, 
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
())));

447 
	`as£¹Th©
(
s2
).
	`isPha£2Rªk
(
Ãw
 
	`Rªk
(
HIGH_RANK
 + 1, 
UUID
.
	`ÇmeUUIDFromBy‹s
("OTHER_CLIENT".
	`g‘By‹s
())));

448 
	`as£¹Th©
(
s2
).
	`isPrİo£dLayout
(
ÃwLayout
);

450 
s2
.
	`shutdown
();

451 
	}
}

453 @
Te¡


454 
public
 
	$‹¡ReboÙ
(è
throws
 
Exû±iÚ
 {

455 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

456 
LayoutS”v”
 
s1
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

458 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

459 
fš®
 
NEW_EPOCH
 = 99L;

460 
Ïyout
.
	`£tEpoch
(
NEW_EPOCH
);

461 
	`boÙ¡¿pS”v”
(
Ïyout
);

466 
Layout
 
»¥
 = 
	`»que¡Layout
(
NEW_EPOCH
).
	`još
();

467 
As£¹iÚs
.
	`as£¹Th©
(
»¥
.
	`g‘Epoch
()).
	`isEqu®To
(
NEW_EPOCH
);

468 
s1
.
	`shutdown
();

470 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

471 
LayoutS”v”
 
s2
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

472 
	`comm™R‘uºsAck
(
s2
, 
i
, 
NEW_EPOCH
 + 1);

473 
s2
.
	`shutdown
();

475 
	}
}

481 @
Te¡


482 
public
 
	$‹¡ChªgeEpochInPha£2ByBa£S”v”
() {

483 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

484 
LayoutS”v”
 
ÏyoutS”v”
 = 
	`g‘DeçuÉS”v”
(
£rviûDœ
);

487 
LayoutS”v”
 
¥yLayoutS”v”
 = 
Mock™o
.
	`¥y
(
ÏyoutS”v”
);

490 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

491 
¥yLayoutS”v”
.
	`£tCu¼’tLayout
(
Ïyout
);

494 
Layout
 
ÃwLayout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

495 
ÃwLayout
.
	`£tEpoch
(
Ïyout
.
	`g‘Epoch
() + 1L);

498 
IS”v”Rou‹r
 
rou‹r
 = 
Mock™o
.
	`mock
(IS”v”Rou‹r.
şass
);

499 
ChªÃlHªdËrCÚ‹xt
 
cÚ‹xt
 = 
Mock™o
.
	`mock
(ChªÃlHªdËrCÚ‹xt.
şass
);

500 
Mock™o
.
	`doAnsw”
(
švoÿtiÚ
 -> 
nuÎ
)

501 .
	`wh’
(
rou‹r
).
	`£ndRe¥Ú£
(
Mock™o
.
	`ªy
(), Mockito.any(), Mockito.any());

503 
fš®
 
ÃwS—lEpoch
 = 
ÃwLayout
.
	`g‘Epoch
() + 1L;

507 
Mock™o
.
	`doAnsw”
(
švoÿtiÚ
 -> {

508 
¥yLayoutS”v”
.
	`g‘S”v”CÚ‹xt
().
	`£tS”v”Epoch
(
ÃwS—lEpoch
, 
rou‹r
);

509  
švoÿtiÚ
.
	`ÿÎR—lM‘hod
();

510 }).
	`wh’
(
¥yLayoutS”v”
).
	`£tPha£2D©a
(
Mock™o
.
	`ªy
(), Mock™o.
	`ªyLÚg
());

512 
fš®
 
msgRªk
 = 0L;

514 
¥yLayoutS”v”
.
	`g‘S”v”CÚ‹xt
().
	`£tS”v”Epoch
(
ÃwLayout
.
	`g‘Epoch
(), 
rou‹r
);

517 
LayoutP»·»Reque¡
 
´•¬eReque¡
 = 
Ãw
 
	`LayoutP»·»Reque¡
(

518 
ÃwLayout
.
	`g‘Epoch
(), 
msgRªk
);

519 
CÜfuPaylßdMsg
<
LayoutP»·»Reque¡
> 
´•¬eReque¡Msg
 =

520 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
LAYOUT_PREPARE
, 
´•¬eReque¡
);

521 
¥yLayoutS”v”
.
	`hªdËMes§geLayoutP»·»
(
´•¬eReque¡Msg
, 
cÚ‹xt
, 
rou‹r
);

526 
LayoutPrİo£Reque¡
 
´İo£Reque¡
 = 
Ãw
 
	`LayoutPrİo£Reque¡
(

527 
ÃwLayout
.
	`g‘Epoch
(), 
msgRªk
,‚ewLayout);

528 
CÜfuPaylßdMsg
<
LayoutPrİo£Reque¡
> 
ÏyoutPrİo£Reque¡Msg
 =

529 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
LAYOUT_PROPOSE
, 
´İo£Reque¡
);

530 
¥yLayoutS”v”
.
	`hªdËMes§geLayoutPrİo£
(
ÏyoutPrİo£Reque¡Msg
, 
cÚ‹xt
, 
rou‹r
);

533 
As£¹iÚs
.
	`as£¹Th©
(
ÃwS—lEpoch
)

534 .
	`isEqu®To
(
¥yLayoutS”v”
.
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Epoch
());

537 
As£¹iÚs
.
	`as£¹Th©
(
¥yLayoutS”v”
.
	`g‘Pha£2D©a
(
ÃwS—lEpoch
).
	`isP»£Á
())

538 .
	`isF®£
();

540 
As£¹iÚs
.
	`as£¹Th©
(
¥yLayoutS”v”
.
	`g‘Pha£2D©a
(
ÃwLayout
.
	`g‘Epoch
()).
	`isP»£Á
())

541 .
	`isTrue
();

542 
	}
}

544 
´iv©e
 
	$comm™R‘uºsAck
(
LayoutS”v”
 
s1
, 
IÁeg”
 
»boÙ
, 
ba£Epoch
) {

546 
ÃwEpoch
 = 
ba£Epoch
 + 
»boÙ
;

547 
	`£ndMes§ge
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
SEAL
, 
ÃwEpoch
));

549 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

550 
Ïyout
.
	`£tEpoch
(
ÃwEpoch
);

552 
LayoutP»·»Re¥Ú£
 
´•¬eRe¥
 = 
	`£ndP»·»
(
ÃwEpoch
, 
HIGH_RANK
).
	`još
();

553 
As£¹iÚs
.
	`as£¹Th©
(
´•¬eRe¥
.
	`g‘Rªk
()).
	`isEqu®To
(-1);

554 
As£¹iÚs
.
	`as£¹Th©
(
´•¬eRe¥
.
	`g‘Layout
()).
	`isNuÎ
();

556 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndPrİo£
(
ÃwEpoch
, 
HIGH_RANK
, 
Ïyout
).
	`još
()).
	`isTrue
();

558 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndComm™‹d
(
ÃwEpoch
, 
Ïyout
).
	`još
()).
	`isTrue
();

560 
As£¹iÚs
.
	`as£¹Th©
(
	`£ndComm™‹d
(
ÃwEpoch
, 
Ïyout
).
	`još
()).
	`isTrue
();

562 
Layout
 
ÃwLayout
 = 
	`»que¡Layout
(
ÃwEpoch
).
	`još
();

563 
As£¹iÚs
.
	`as£¹Th©
(
ÃwLayout
).
	`isEqu®To
(
Ïyout
);

564 
	}
}

566 
´iv©e
 
LayoutS”v”
 
	$g‘DeçuÉS”v”
(
SŒšg
 
£rviûDœ
) {

567 
S”v”CÚ‹xt
 
sc
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

568 .
	`£tSšgË
(
çl£
)

569 .
	`£tMemÜy
(
çl£
)

570 .
	`£tLogP©h
(
£rviûDœ
)

571 .
	`£tS”v”Rou‹r
(
	`g‘Rou‹r
())

572 .
	`bud
();

573 
LayoutS”v”
 
s1
 = 
Ãw
 
	`LayoutS”v”
(
sc
);

574 
	`£tS”v”
(
s1
);

575 
	`g‘Rou‹r
().
	`addS”v”
(
Ãw
 
	`Ba£S”v”
(
sc
));

576  
s1
;

577 
	}
}

579 
´iv©e
 
	$boÙ¡¿pS”v”
(
Layout
 
l
) {

580 
	`£ndReque¡
(
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP
.
	`·ylßdMsg
(
Ãw
 
	`LayoutBoÙ¡¿pReque¡
(
l
))).
	`još
();

581 
	}
}

583 
´iv©e
 
	gCom¶‘abËFutu»
<
	gLayout
> 
	$»que¡Layout
(
•och
) {

584  
	`£ndReque¡
(
CÜfuMsgTy³
.
LAYOUT_REQUEST
.
	`·ylßdMsg
(
•och
));

585 
	}
}

587 
´iv©e
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$£tEpoch
(
•och
) {

588  
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
SEAL
, 
•och
));

589 
	}
}

591 
´iv©e
 
	gCom¶‘abËFutu»
<
	gLayoutP»·»Re¥Ú£
> 
	$£ndP»·»
(
•och
, 
¿nk
) {

592  
	`£ndReque¡
(
CÜfuMsgTy³
.
LAYOUT_PREPARE
.
	`·ylßdMsg
(
Ãw
 
	`LayoutP»·»Reque¡
(
•och
, 
¿nk
)));

593 
	}
}

595 
´iv©e
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$£ndPrİo£
(
•och
, 
¿nk
, 
Layout
 
Ïyout
) {

596  
	`£ndReque¡
(
CÜfuMsgTy³
.
LAYOUT_PROPOSE
.
	`·ylßdMsg
(
Ãw
 
	`LayoutPrİo£Reque¡
(
•och
, 
¿nk
, 
Ïyout
)));

597 
	}
}

599 
´iv©e
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$£ndComm™‹d
(
•och
, 
Layout
 
Ïyout
) {

600  
	`£ndReque¡
(
CÜfuMsgTy³
.
LAYOUT_COMMITTED
.
	`·ylßdMsg
(
Ãw
 
	`LayoutComm™‹dReque¡
(
•och
, 
Ïyout
)));

601 
	}
}

603 
´iv©e
 
	gCom¶‘abËFutu»
<
	gLayoutP»·»Re¥Ú£
> 
	$£ndP»·»
(
UUID
 
ş›ÁId
, 
•och
, 
¿nk
) {

604  
	`£ndReque¡
(
ş›ÁId
, 
CÜfuMsgTy³
.
LAYOUT_PREPARE
.
	`·ylßdMsg
(
Ãw
 
	`LayoutP»·»Reque¡
(
•och
, 
¿nk
)));

605 
	}
}

607 
´iv©e
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$£ndPrİo£
(
UUID
 
ş›ÁId
, 
•och
, 
¿nk
, 
Layout
 
Ïyout
) {

608  
	`£ndReque¡
(
ş›ÁId
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE


609 .
	`·ylßdMsg
(
Ãw
 
	`LayoutPrİo£Reque¡
(
•och
,
¿nk
, 
Ïyout
)));

610 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/LogUnitCacheTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gMuÉËR—dReque¡
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gRªgeWr™eMsg
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

21 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”As£¹iÚs
.
	gas£¹Th©
;

27 
public
 cÏs 
	cLogUn™CacheTe¡
 
ex‹nds
 
	mAb¡¿ùS”v”Te¡
 {

29 
´iv©e
 
fš®
 
	mMIN_HEAP_RATIO
 = 0.1;

30 
´iv©e
 
fš®
 
	mMAX_HEAP_RATIO
 = 0.9;

32 @
Ov”ride


33 
public
 
Ab¡¿ùS”v”
 
	$g‘DeçuÉS”v”
() {

34 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

36  
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

37 .
	`£tLogP©h
(
£rviûDœ
)

38 .
	`£tMemÜy
(
çl£
)

39 .
	`bud
());

45 @
Te¡


46 
public
 
	$checkNÚCach—bËR—ds
(è
throws
 
Exû±iÚ
 {

47 
fš®
 
size
 = 10;

48 
fš®
 
¡¬t
 = 0L;

49 
fš®
 
’d
 = 
¡¬t
 + 
size
;

51 
LogUn™S”v”
 
logUn™S”v”
 = (LogUn™S”v”è
	`g‘DeçuÉS”v”
();

52 
	`£tS”v”
(
logUn™S”v”
);

54 
Li¡
<
LÚg
> 
add»s£s
 = 
LÚgSŒ—m
.
	`¿nge
(
¡¬t
, 
’d
).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

55 
Li¡
<
LogD©a
> 
·ylßds
 = 
Ãw
 
A¼ayLi¡
<>();

57 
i
 = 
¡¬t
; i < 
’d
; i++) {

58 
By‹Buf
 
·ylßd
 = 
UÅoŞed
.
	`bufãr
();

59 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("h–lo".
	`g‘By‹s
(), 
·ylßd
);

60 
LogD©a
 
logD©a
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
·ylßd
);

61 
logD©a
.
	`£tGlob®Add»ss
(
i
);

62 
·ylßds
.
	`add
(
logD©a
);

66 
	`£ndReque¡
(
CÜfuMsgTy³
.
RANGE_WRITE
.
	`·ylßdMsg
(
Ãw
 
	`RªgeWr™eMsg
(
·ylßds
))).
	`još
();

69 
Com¶‘abËFutu»
<
R—dRe¥Ú£
> 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MULTIPLE_READ_REQUEST


70 .
	`·ylßdMsg
(
Ãw
 
	`MuÉËR—dReque¡
(
add»s£s
, 
çl£
)));

73 
	`checkR—dRe¥Ú£
(
futu»
.
	`još
(), 
size
);

74 
	`as£¹Th©
(
logUn™S”v”
.
	`g‘D©aCache
().
	`g‘Size
()).
	`isEqu®To
(0);

77 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MULTIPLE_READ_REQUEST


78 .
	`·ylßdMsg
(
Ãw
 
	`MuÉËR—dReque¡
(
add»s£s
, 
Œue
)));

80 
	`checkR—dRe¥Ú£
(
futu»
.
	`još
(), 
size
);

81 
	`as£¹Th©
(
logUn™S”v”
.
	`g‘D©aCache
().
	`g‘Size
()).
	`isEqu®To
(
size
);

82 
	}
}

84 
´iv©e
 
	$checkR—dRe¥Ú£
(
R—dRe¥Ú£
 
»adRe¥Ú£
, 
size
) {

85 
	`as£¹Th©
(
»adRe¥Ú£
.
	`g‘Add»s£s
().
	`size
()).
	`isEqu®To
(
size
);

87 
»adRe¥Ú£
.
	`g‘Add»s£s
().
	`fÜEach
((
addr
, 
ld
è-> 
	`as£¹Th©
Öd.
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
));

88 
	}
}

93 @
Te¡


94 
public
 
	$CheckMaxCacheSizeIsCÜ»ùR©io
() {

95 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
(
Sy¡em
.
	`cu¼’tTimeMlis
());

96 
¿ndomCacheR©io
 = 
MIN_HEAP_RATIO
 + (
MAX_HEAP_RATIO
 - MIN_HEAP_RATIOè* 
r
.
	`ÃxtDoubË
();

97 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

98 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

99 .
	`£tLogP©h
(
£rviûDœ
)

100 .
	`£tMemÜy
(
çl£
)

101 .
	`£tCacheSizeH—pR©io
(
SŒšg
.
	`v®ueOf
(
¿ndomCacheR©io
))

102 .
	`bud
());

104 
	`as£¹Th©
(
s1
).
	`hasMaxCÜ»ùCacheSize
(
¿ndomCacheR©io
);

105 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/LogUnitServerAssertions.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAb¡¿ùAs£¹
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

13 
public
 
şass
 
LogUn™S”v”As£¹iÚs
 
ex‹nds
 
	gAb¡¿ùAs£¹
<
	gLogUn™S”v”As£¹iÚs
, 
	gLogUn™S”v”
> {

15 
public
 
LogUn™S”v”As£¹iÚs
(
LogUn™S”v”
 
aùu®
) {

16 
su³r
(
aùu®
, 
LogUn™S”v”As£¹iÚs
.
şass
);

19 
public
 
LogUn™S”v”As£¹iÚs
 
as£¹Th©
(
LogUn™S”v”
 
aùu®
) {

20  
Ãw
 
LogUn™S”v”As£¹iÚs
(
aùu®
);

24 
public
 
LogUn™S”v”As£¹iÚs
 
isEm±yAtAdd»ss
(
add»ss
) {

25 
isNÙNuÎ
();

27 ià(
	gaùu®
.
g‘D©aCache
().
g‘
(
add»ss
è!ğ
nuÎ
) {

28 
çW™hMes§ge
("Ex³ùed‡dd»s <%d>Øbem±y buˆcÚšed d©a!", 
add»ss
);

31  
	gthis
;

34 
public
 
LogUn™S”v”As£¹iÚs
 
cÚšsD©aAtAdd»ss
(
add»ss
) {

35 
isNÙNuÎ
();

37 ià(
	gaùu®
.
g‘D©aCache
().
g‘
(
add»ss
è=ğ
nuÎ
) {

38 
çW™hMes§ge
("Ex³ùed‡dd»s <%d>ØcÚš d©¨buˆwa em±y!", 
add»ss
);

39 } ià(
	gaùu®
.
g‘D©aCache
().
g‘
(
add»ss
).
isHŞe
()) {

40 
çW™hMes§ge
("Ex³ùed‡dd»s <%d>ØcÚš d©¨buˆwa fËd hŞe!", 
add»ss
);

43  
	gthis
;

46 
public
 
LogUn™S”v”As£¹iÚs
 
m©chesD©aAtAdd»ss
(
add»ss
, 
Objeù
 
d©a
) {

47 
isNÙNuÎ
();

49 ià(
	gaùu®
.
g‘D©aCache
().
g‘
(
add»ss
è=ğ
nuÎ
) {

50 
çW™hMes§ge
("Ex³ùed‡dd»s <%d>ØcÚš d©¨buˆwa em±y!", 
add»ss
);

52 
By‹Buf
 
	gb
 = 
UÅoŞed
.
bufãr
();

53 
	gS”Ÿliz”s
.
	gCORFU
.
£rŸlize
(
d©a
, 
b
);

54 
	gby‹
[] 
	gex³ùed
 = 
Ãw
 
by‹
[
b
.
»adabËBy‹s
()];

55 
	gb
.
g‘By‹s
(0, 
ex³ùed
);

57 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
as£¹Th©
(((
LogD©a
)
aùu®
.
g‘D©aCache
()

58 .
g‘
(
add»ss
)).
g‘D©a
())

59 .
isEqu®To
(
ex³ùed
);

63  
	gthis
;

66 
public
 
LogUn™S”v”As£¹iÚs
 
hasMaxCÜ»ùCacheSize
(
¿tio
) {

67 
	gmaxH—pSize
 = 
RuÁime
.
g‘RuÁime
().
maxMemÜy
();

68 if(
	gaùu®
.
g‘MaxCacheSize
(è!ğ(è(
maxH—pSize
 * 
¿tio
)) {

69 
çW™hMes§ge
("Expected cache size <%d> doesn't match‡llocated cache size <%d>",

70 (è(
maxH—pSize
 * 
¿tio
), 
aùu®
.
g‘MaxCacheSize
());

73  
	gthis
;

	@test/src/test/java/org/corfudb/infrastructure/LogUnitServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.*;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLogUn™Exû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

17 
impÜt
 
	gjava
.
	gio
.
	gFe
;

18 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

19 
impÜt
 
	gjava
.
	gio
.
	gRªdomAcûssFe
;

20 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

21 
impÜt
 
	gjava
.
	gnio
.
	gchªÃls
.
	gFeChªÃl
;

22 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

28 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”As£¹iÚs
.
	gas£¹Th©
;

30 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

31 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

36 
public
 cÏs 
	cLogUn™S”v”Te¡
 
ex‹nds
 
	mAb¡¿ùS”v”Te¡
 {

38 @
Ov”ride


39 
public
 
Ab¡¿ùS”v”
 
	$g‘DeçuÉS”v”
() {

40  
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
().
	`bud
());

43 @
Te¡


44 
public
 
	$checkOv”wr™esFa
(è
throws
 
Exû±iÚ
 {

45 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

47 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

48 .
	`£tLogP©h
(
£rviûDœ
)

49 .
	`£tMemÜy
(
çl£
)

50 .
	`bud
());

52 
this
.
rou‹r
.
	`»£t
();

53 
this
.
rou‹r
.
	`addS”v”
(
s1
);

55 
fš®
 
ADDRESS_0
 = 0L;

56 
fš®
 
ADDRESS_1
 = 100L;

58 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

59 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("0".
	`g‘By‹s
(), 
b
);

60 
Wr™eReque¡
 
m
 = Wr™eReque¡.
	`bud”
()

61 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

62 .
	`bud
();

63 
m
.
	`£tGlob®Add»ss
(
ADDRESS_0
);

64 
m
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`em±yM­
());

65 
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
)).
	`još
();

66 
	`as£¹Th©
(
s1
)

67 .
	`cÚšsD©aAtAdd»ss
(
ADDRESS_0
);

68 
	`as£¹Th©
(
s1
)

69 .
	`isEm±yAtAdd»ss
(
ADDRESS_1
);

73 
Wr™eReque¡
 
m2
 = Wr™eReque¡.
	`bud”
()

74 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

75 .
	`bud
();

76 
m2
.
	`£tGlob®Add»ss
(
ADDRESS_0
);

77 
m2
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`em±yM­
());

79 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m2
));

80 
	`as£¹Th©ThrownBy
(
futu»
::
još
).
	`hasCau£ExaùlyIn¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

81 
	}
}

88 @
Te¡


89 
public
 
	$ÿÁO³nR—dOÆyLogFes
(è
throws
 
Exû±iÚ
 {

90 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

92 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

93 .
	`£tLogP©h
(
£rviûDœ
)

94 .
	`£tMemÜy
(
çl£
)

95 .
	`bud
());

97 
this
.
rou‹r
.
	`»£t
();

98 
this
.
rou‹r
.
	`addS”v”
(
s1
);

100 
fš®
 
LOW_ADDRESS
 = 0L; fš® 
SŒšg
 
low_·ylßd
 = "0";

101 
fš®
 
MID_ADDRESS
 = 100L; fš® 
SŒšg
 
mid_·ylßd
 = "100";

102 
fš®
 
HIGH_ADDRESS
 = 10000000L; fš® 
SŒšg
 
high_·ylßd
 = "100000";

103 
fš®
 
SŒšg
 
¡»amName
 = "a";

105 
	`¿wWr™e
(
LOW_ADDRESS
, 
low_·ylßd
, 
¡»amName
);

106 
	`¿wWr™e
(
MID_ADDRESS
, 
mid_·ylßd
, 
¡»amName
);

107 
	`¿wWr™e
(
HIGH_ADDRESS
, 
high_·ylßd
, 
¡»amName
);

109 
s1
.
	`shutdown
();

111 
Œy
 {

112 
Fe
 
£rviûDœeùÜy
 = 
Ãw
 
	`Fe
(
£rviûDœ
);

113 
£rviûDœeùÜy
.
	`£tWr™abË
(
çl£
);

114 } 
	`ÿtch
(
Secur™yExû±iÚ
 
e
) {

115 
	`ç
("Should‚Ù h™ secur™yƒxû±iÚ"+
e
.
	`toSŒšg
());

118 
Œy
 {

119 
LogUn™S”v”
 
s2
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

120 .
	`£tLogP©h
(
£rviûDœ
)

121 .
	`£tMemÜy
(
çl£
)

122 .
	`bud
());

123 
	`ç
("Should have failedo startup in„ead-only mode");

124 } 
	`ÿtch
 (
LogUn™Exû±iÚ
 
e
) {

128 
Fe
 
£rviûDœeùÜy
 = 
Ãw
 
	`Fe
(
£rviûDœ
);

129 
£rviûDœeùÜy
.
	`£tWr™abË
(
Œue
);

130 
	}
}

132 @
Te¡


133 
public
 
	$checkTh©Wr™esA»P”si¡ed
()

134 
throws
 
Exû±iÚ
 {

135 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

137 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

138 .
	`£tLogP©h
(
£rviûDœ
)

139 .
	`£tMemÜy
(
çl£
)

140 .
	`bud
());

142 
this
.
rou‹r
.
	`»£t
();

143 
this
.
rou‹r
.
	`addS”v”
(
s1
);

145 
fš®
 
LOW_ADDRESS
 = 0L; fš® 
SŒšg
 
low_·ylßd
 = "0";

146 
fš®
 
MID_ADDRESS
 = 100L; fš® 
SŒšg
 
mid_·ylßd
 = "100";

147 
fš®
 
HIGH_ADDRESS
 = 10000000L; fš® 
SŒšg
 
high_·ylßd
 =

149 
fš®
 
SŒšg
 
¡»amName
 = "a";

152 
	`¿wWr™e
(
LOW_ADDRESS
, 
low_·ylßd
, 
¡»amName
);

155 
	`¿wWr™e
(
MID_ADDRESS
, 
mid_·ylßd
, 
¡»amName
);

158 
	`¿wWr™e
(
HIGH_ADDRESS
, 
high_·ylßd
, 
¡»amName
).
	`još
();

160 
s1
.
	`shutdown
();

162 
LogUn™S”v”
 
s2
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

163 .
	`£tLogP©h
(
£rviûDœ
)

164 .
	`£tMemÜy
(
çl£
)

165 .
	`bud
());

166 
this
.
rou‹r
.
	`»£t
();

167 
this
.
rou‹r
.
	`addS”v”
(
s2
);

169 
	`as£¹Th©
(
s2
)

170 .
	`cÚšsD©aAtAdd»ss
(
LOW_ADDRESS
)

171 .
	`cÚšsD©aAtAdd»ss
(
MID_ADDRESS
)

172 .
	`cÚšsD©aAtAdd»ss
(
HIGH_ADDRESS
);

173 
	`as£¹Th©
(
s2
)

174 .
	`m©chesD©aAtAdd»ss
(
LOW_ADDRESS
, 
low_·ylßd
.
	`g‘By‹s
())

175 .
	`m©chesD©aAtAdd»ss
(
MID_ADDRESS
, 
mid_·ylßd
.
	`g‘By‹s
())

176 .
	`m©chesD©aAtAdd»ss
(
HIGH_ADDRESS
, 
high_·ylßd
.
	`g‘By‹s
());

177 
	}
}

179 
´Ùeùed
 
	gCom¶‘abËFutu»
<
	gBoŞ—n
> 
	$¿wWr™e
(
addr
, 
SŒšg
 
s
, SŒšg 
¡»amName
) {

180 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

181 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
s
.
	`g‘By‹s
(), 
b
);

182 
Wr™eReque¡
 
m
 = Wr™eReque¡.
	`bud”
()

183 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

184 .
	`bud
();

185 
m
.
	`£tGlob®Add»ss
(
addr
);

186 
m
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`sšgËtÚM­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
),

187 
Add»ss
.
NO_BACKPOINTER
));

188  
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
));

189 
	}
}

191 @
Te¡


192 
public
 
	$checkTh©MÜeWr™esA»P”si¡ed
()

193 
throws
 
Exû±iÚ
 {

194 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

196 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

197 .
	`£tLogP©h
(
£rviûDœ
)

198 .
	`£tMemÜy
(
çl£
)

199 .
	`bud
());

201 
this
.
rou‹r
.
	`»£t
();

202 
this
.
rou‹r
.
	`addS”v”
(
s1
);

204 
fš®
 
START_ADDRESS
 = 0L; fš® 
SŒšg
 
low_·ylßd
 = "0";

205 
fš®
 
num_™”©iÚs_v”y_low
 = 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
;

206 
fš®
 
SŒšg
 
¡»amName
 = "a";

208 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»
 = 
nuÎ
;

209 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

210 
futu»
 = 
	`¿wWr™e
(
START_ADDRESS
+
i
, 
low_·ylßd
+i, 
¡»amName
);

212 
futu»
.
	`još
();

214 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

215 
	`as£¹Th©
(
s1
)

216 .
	`cÚšsD©aAtAdd»ss
(
START_ADDRESS
+
i
);

218 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

219 
	`as£¹Th©
(
s1
)

220 .
	`m©chesD©aAtAdd»ss
(
START_ADDRESS
+
i
, (
low_·ylßd
+i)

221 .
	`g‘By‹s
());

223 
s1
.
	`shutdown
();

225 
LogUn™S”v”
 
s2
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

226 .
	`£tLogP©h
(
£rviûDœ
)

227 .
	`£tMemÜy
(
çl£
)

228 .
	`bud
());

229 
this
.
rou‹r
.
	`»£t
();

230 
this
.
rou‹r
.
	`addS”v”
(
s2
);

232 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

233 
	`as£¹Th©
(
s2
)

234 .
	`cÚšsD©aAtAdd»ss
(
START_ADDRESS
+
i
);

236 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

237 
	`as£¹Th©
(
s2
)

238 .
	`m©chesD©aAtAdd»ss
(
START_ADDRESS
+
i
, (
low_·ylßd
+i)

239 .
	`g‘By‹s
());

241 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

242 
futu»
 = 
	`¿wWr™e
(
START_ADDRESS
+
num_™”©iÚs_v”y_low
+
i
, 
low_·ylßd
+i, 
¡»amName
);

244 
futu»
.
	`još
();

245 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

246 
	`as£¹Th©
(
s2
)

247 .
cÚšsD©aAtAdd»ss


248 (
START_ADDRESS
+
num_™”©iÚs_v”y_low
+
i
);

250 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

251 
	`as£¹Th©
(
s2
)

252 .
m©chesD©aAtAdd»ss


253 (
START_ADDRESS
+
num_™”©iÚs_v”y_low
+
i
,

254 (
low_·ylßd
+
i
)

255 .
	`g‘By‹s
());

257 
LogUn™S”v”
 
s3
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

258 .
	`£tLogP©h
(
£rviûDœ
)

259 .
	`£tMemÜy
(
çl£
)

260 .
	`bud
());

261 
this
.
rou‹r
.
	`»£t
();

262 
this
.
rou‹r
.
	`addS”v”
(
s3
);

264 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

265 
	`as£¹Th©
(
s3
)

266 .
	`cÚšsD©aAtAdd»ss
(
START_ADDRESS
+
i
);

268 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

269 
	`as£¹Th©
(
s3
)

270 .
	`m©chesD©aAtAdd»ss
(
START_ADDRESS
+
i
, (
low_·ylßd
+i)

271 .
	`g‘By‹s
());

273 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

274 
	`as£¹Th©
(
s3
)

275 .
cÚšsD©aAtAdd»ss


276 (
START_ADDRESS
+
num_™”©iÚs_v”y_low
+
i
);

278 
i
 = 0; i < 
num_™”©iÚs_v”y_low
; i++)

279 
	`as£¹Th©
(
s3
)

280 .
m©chesD©aAtAdd»ss


281 (
START_ADDRESS
+
num_™”©iÚs_v”y_low
+
i
,

282 (
low_·ylßd
+
i
)

283 .
	`g‘By‹s
());

285 
	}
}

293 @
Te¡


294 
public
 
	$checkLogUn™Re£tSŒ—mRebut
(è
throws
 
Exû±iÚ
 {

295 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

296 
fš®
 
maxAdd»ss
 = 20000L;

297 
fš®
 
mšAdd»ss
 = 10000L;

298 
fš®
 
ŒimM¬k
 = 15000L;

299 
UUID
 
¡»amID
 = UUID.
	`¿ndomUUID
();

301 
LogUn™S”v”
 
logUn™S”v”
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

302 .
	`£tLogP©h
(
£rviûDœ
)

303 .
	`£tMemÜy
(
çl£
)

304 .
	`bud
());

306 
this
.
rou‹r
.
	`»£t
();

307 
this
.
rou‹r
.
	`addS”v”
(
logUn™S”v”
);

310 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»
 = 
nuÎ
;

311 
i
 = 
maxAdd»ss
; i >ğ
mšAdd»ss
; i--) {

312 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

313 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("Paylßd".
	`g‘By‹s
(), 
b
);

314 
Wr™eReque¡
 
m
 = Wr™eReque¡.
	`bud”
()

315 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

316 .
	`bud
();

317 
m
.
	`£tGlob®Add»ss
(
i
);

318 
backpoš‹r
 = 
i
 - 1;

319 ià(
i
 =ğ
mšAdd»ss
) {

321 
backpoš‹r
 = 
Add»ss
.
NON_EXIST
;

323 
m
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amID
, 
backpoš‹r
));

324 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
));

327 
futu»
.
	`još
();

330 
SŒ—mAdd»ssS·û
 
add»ssS·û
 = 
logUn™S”v”
.
	`g‘SŒ—mAdd»ssS·û
(
¡»amID
);

331 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

332 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
mšAdd»ss
 + 1);

335 
LogUn™S”v”
 
ÃwS”v”
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

336 .
	`£tLogP©h
(
£rviûDœ
)

337 .
	`£tMemÜy
(
çl£
)

338 .
	`bud
());

341 
add»ssS·û
 = 
ÃwS”v”
.
	`g‘SŒ—mAdd»ssS·û
(
¡»amID
);

342 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

343 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
mšAdd»ss
 + 1);

346 
ÃwS”v”
.
	`´efixTrim
(
ŒimM¬k
);

347 
	`£ndReque¡
(
CÜfuMsgTy³
.
PREFIX_TRIM
.
	`·ylßdMsg
(
Ãw
 
	`TrimReque¡
Òew 
	`Tok’
(0l, 
ŒimM¬k
)))).
	`još
();

351 
add»ssS·û
 = 
ÃwS”v”
.
	`g‘SŒ—mAdd»ssS·û
(
¡»amID
);

352 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
ŒimM¬k
);

353 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
maxAdd»ss
 - 
ŒimM¬k
);

354 
	}
}

356 @
Te¡


357 
public
 
	$checkUnCachedWr™es
(è
throws
 
Exû±iÚ
 {

358 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

360 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

361 .
	`£tLogP©h
(
£rviûDœ
)

362 .
	`£tMemÜy
(
çl£
)

363 .
	`bud
());

365 
this
.
rou‹r
.
	`»£t
();

366 
this
.
rou‹r
.
	`addS”v”
(
s1
);

368 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

369 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("0".
	`g‘By‹s
(), 
b
);

370 
Wr™eReque¡
 
m
 = Wr™eReque¡.
	`bud”
()

371 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

372 .
	`bud
();

373 
fš®
 
LÚg
 
glob®Add»ss
 = 0L;

374 
m
.
	`£tGlob®Add»ss
(
glob®Add»ss
);

375 
M­
<
UUID
, 
LÚg
> 
uuidLÚgM­
 = 
Ãw
 
	`HashM­
();

376 
UUID
 
uuid
 = 
Ãw
 
	`UUID
(1,1);

377 
fš®
 
LÚg
 
add»ss
 = 5L;

378 
uuidLÚgM­
.
	`put
(
uuid
, 
add»ss
);

379 
m
.
	`£tBackpoš‹rM­
(
uuidLÚgM­
);

380 
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
)).
	`još
();

382 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

383 .
	`£tLogP©h
(
£rviûDœ
)

384 .
	`£tMemÜy
(
çl£
)

385 .
	`bud
());

387 
this
.
rou‹r
.
	`»£t
();

388 
this
.
rou‹r
.
	`addS”v”
(
s1
);

390 
ILogD©a
 
’Œy
 = 
s1
.
	`g‘D©aCache
().
	`g‘
(
glob®Add»ss
);

393 
	`as£¹Th©
(
’Œy
.
	`g‘Backpoš‹rM­
()).
	`isEqu®To
(
uuidLÚgM­
);

394 
	`as£¹Th©
(
’Œy
.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
glob®Add»ss
);

395 
	}
}

397 
´iv©e
 
SŒšg
 
	$ü—‹LogFe
(
SŒšg
 
·th
, 
v”siÚ
, 
boŞ—n
 
noV”ify
è
throws
 
IOExû±iÚ
 {

399 
Fe
 
logDœ
 = 
Ãw
 
	`Fe
(
·th
 + Fe.
£·¿tÜ
 + "log");

400 
logDœ
.
	`mkdœ
();

403 
SŒšg
 
logFeP©h
 = 
logDœ
.
	`g‘AbsŞu‹P©h
(è+ 
Fe
.
£·¿tÜ
 + 0 + ".log";

404 
Fe
 
logFe
 = 
Ãw
 
	`Fe
(
logFeP©h
);

405 
logFe
.
	`ü—‹NewFe
();

406 
RªdomAcûssFe
 
fe
 = 
Ãw
 
	`RªdomAcûssFe
(
logFe
, "rw");

407 
	`wr™eH—d”
(
fe
.
	`g‘ChªÃl
(), 
v”siÚ
, 
noV”ify
);

408 
fe
.
	`şo£
();

410  
logFe
.
	`g‘AbsŞu‹P©h
();

411 
	}
}

413 
public
 
	$wr™eH—d”
(
FeChªÃl
 
feChªÃl
, 
v”siÚ
, 
boŞ—n
 
v”ify
è
throws
 
IOExû±iÚ
 {

415 
Ty³s
.
LogH—d”
 
h—d”
 = Ty³s.LogH—d”.
	`ÃwBud”
()

416 .
	`£tV”siÚ
(
v”siÚ
)

417 .
	`£tV”ifyChecksum
(
v”ify
)

418 .
	`bud
();

420 
By‹Bufãr
 
buf
 = 
SŒ—mLogFes
.
	`g‘By‹BufãrW™hM‘aD©a
(
h—d”
);

422 
feChªÃl
.
	`wr™e
(
buf
);

423 } 
buf
.
	`hasRemaššg
());

424 
feChªÃl
.
	`fÜû
(
Œue
);

425 
	}
}

427 @
	$Te¡
 (
ex³ùed
 = 
RuÁimeExû±iÚ
.
şass
)

428 
public
 
	$‹¡Inv®idLogV”siÚ
(è
throws
 
Exû±iÚ
 {

430 
SŒšg
 
‹mpDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

431 
	`ü—‹LogFe
(
‹mpDœ
, 
SŒ—mLogFes
.
VERSION
 + 1, 
çl£
);

434 
S”v”CÚ‹xtBud”
 
bud”
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
();

435 
bud”
.
	`£tMemÜy
(
çl£
);

436 
bud”
.
	`£tLogP©h
(
‹mpDœ
);

437 
S”v”CÚ‹xt
 
cÚ‹xt
 = 
bud”
.
	`bud
();

438 
LogUn™S”v”
 
logun™
 = 
Ãw
 
	`LogUn™S”v”
(
cÚ‹xt
);

439 
	}
}

441 @
	$Te¡
 (
ex³ùed
 = 
RuÁimeExû±iÚ
.
şass
)

442 
public
 
	$‹¡V”ifyW™hNoV”ifyLog
(è
throws
 
Exû±iÚ
 {

443 
boŞ—n
 
noV”ify
 = 
Œue
;

446 
SŒšg
 
‹mpDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

447 
	`ü—‹LogFe
(
‹mpDœ
, 
SŒ—mLogFes
.
VERSION
 + 1, 
noV”ify
);

450 
S”v”CÚ‹xtBud”
 
bud”
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
();

451 
bud”
.
	`£tMemÜy
(
çl£
);

452 
bud”
.
	`£tLogP©h
(
‹mpDœ
);

453 
bud”
.
	`£tNoV”ify
(!
noV”ify
);

454 
S”v”CÚ‹xt
 
cÚ‹xt
 = 
bud”
.
	`bud
();

455 
LogUn™S”v”
 
logun™
 = 
Ãw
 
	`LogUn™S”v”
(
cÚ‹xt
);

456 
	}
}

459 @
Te¡


460 
public
 
	$checkOv”wr™eExû±iÚIsNÙThrownWh’TheRªkIsHigh”
(è
throws
 
Exû±iÚ
 {

461 
SŒšg
 
£rviûDœ
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

463 
LogUn™S”v”
 
s1
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

464 .
	`£tLogP©h
(
£rviûDœ
)

465 .
	`£tMemÜy
(
çl£
)

466 .
	`bud
());

468 
this
.
rou‹r
.
	`»£t
();

469 
this
.
rou‹r
.
	`addS”v”
(
s1
);

471 
fš®
 
ADDRESS_0
 = 0L;

472 
fš®
 
ADDRESS_1
 = 100L;

474 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

475 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("0".
	`g‘By‹s
(), 
b
);

476 
Wr™eReque¡
 
m
 = Wr™eReque¡.
	`bud”
()

477 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

478 .
	`bud
();

479 
m
.
	`£tGlob®Add»ss
(
ADDRESS_0
);

480 
m
.
	`£tRªk
(
Ãw
 
IM‘ad©a
.
	`D©aRªk
(0));

481 
m
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`em±yM­
());

482 
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
)).
	`još
();

483 
	`as£¹Th©
(
s1
)

484 .
	`cÚšsD©aAtAdd»ss
(
ADDRESS_0
);

485 
	`as£¹Th©
(
s1
)

486 .
	`isEm±yAtAdd»ss
(
ADDRESS_1
);

490 
b
.
	`ş—r
();

491 
b
 = 
UÅoŞed
.
	`bufãr
();

492 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("1".
	`g‘By‹s
(), 
b
);

493 
m
 = 
Wr™eReque¡
.
	`bud”
()

494 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

495 .
	`bud
();

496 
m
.
	`£tGlob®Add»ss
(
ADDRESS_0
);

497 
m
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`em±yM­
());

500 
Wr™eReque¡
 
m2
 = Wr™eReque¡.
	`bud”
()

501 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

502 .
	`bud
();

504 
m2
.
	`£tGlob®Add»ss
(
ADDRESS_0
);

505 
m2
.
	`£tRªk
(
Ãw
 
IM‘ad©a
.
	`D©aRªk
(1));

506 
m2
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`em±yM­
());

508 
	`as£¹Th©
(
	`£ndReque¡
(
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m2
)).
	`još
()).
	`isEqu®To
(
Œue
);

512 
	`as£¹Th©
(
s1
)

513 .
	`cÚšsD©aAtAdd»ss
(
ADDRESS_0
);

514 
	`as£¹Th©
(
s1
)

515 .
	`m©chesD©aAtAdd»ss
(
ADDRESS_0
, "1".
	`g‘By‹s
());

518 
LogUn™S”v”
 
s2
 = 
Ãw
 
	`LogUn™S”v”
Òew 
	`S”v”CÚ‹xtBud”
()

519 .
	`£tLogP©h
(
£rviûDœ
)

520 .
	`£tMemÜy
(
çl£
)

521 .
	`bud
());

522 
this
.
rou‹r
.
	`»£t
();

523 
this
.
rou‹r
.
	`addS”v”
(
s2
);

525 
	`as£¹Th©
(
s2
)

526 .
	`cÚšsD©aAtAdd»ss
(
ADDRESS_0
);

527 
	`as£¹Th©
(
s2
)

528 .
	`m©chesD©aAtAdd»ss
(
ADDRESS_0
, "1".
	`g‘By‹s
());

530 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/ManagementServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD‘eùÜMsg
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutBoÙ¡¿pReque¡
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoBoÙ¡¿pExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

25 
public
 cÏs 
	cMªagem’tS”v”Te¡
 
ex‹nds
 
	mAb¡¿ùS”v”Te¡
 {

27 
´iv©e
 
Mªagem’tS”v”
 
	mmªagem’tS”v”
;

29 @
Ov”ride


30 
public
 
Mªagem’tS”v”
 
	$g‘DeçuÉS”v”
() {

32 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

33 .
	`£tSšgË
(
çl£
)

34 .
	`£tPÜt
(
SERVERS
.
PORT_0
)

35 .
	`£tS”v”Rou‹r
(
	`g‘Rou‹r
())

36 .
	`bud
();

38 
rou‹r
.
	`addS”v”
(
Ãw
 
	`LayoutS”v”
(
£rv”CÚ‹xt
));

39 
rou‹r
.
	`addS”v”
(
Ãw
 
	`Ba£S”v”
(
£rv”CÚ‹xt
));

42 
rou‹r
.
	`addS”v”
(
Ãw
 
	`Sequ’ûrS”v”
(
£rv”CÚ‹xt
));

43 
mªagem’tS”v”
 = 
Ãw
 
	`Mªagem’tS”v”
(
£rv”CÚ‹xt
);

44  
mªagem’tS”v”
;

47 @
Aá”


48 
public
 
	$ş—nUp
() {

49 
mªagem’tS”v”
.
	`shutdown
();

50 
	}
}

55 @
Te¡


56 
public
 
	$checkFau»D‘eùÜStus
() {

57 
	`as£¹Th©
(
mªagem’tS”v”
.
	`g‘Mªagem’tAg’t
().
	`g‘RemÙeMÚ™ÜšgS”viû
()

58 .
	`g‘Fau»D‘eùÜWÜk”
().
	`isShutdown
()).
	`isF®£
();

59 
mªagem’tS”v”
.
	`shutdown
();

60 
	`as£¹Th©
(
mªagem’tS”v”
.
	`g‘Mªagem’tAg’t
().
	`g‘RemÙeMÚ™ÜšgS”viû
()

61 .
	`g‘Fau»D‘eùÜWÜk”
().
	`isShutdown
()).
	`isTrue
();

62 
	}
}

67 @
Te¡


68 
public
 
	$boÙ¡¿pMªagem’tS”v”
() {

69 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

70 
	`£ndMes§ge
(
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP
.
	`·ylßdMsg
(
Ãw
 
	`LayoutBoÙ¡¿pReque¡
(
Ïyout
)));

71 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
.
	`·ylßdMsg
(
Ïyout
));

72 
	`as£¹Th©
(
futu»
.
	`još
()).
	`isEqu®To
(
Œue
);

73 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
.
	`·ylßdMsg
(
Ïyout
));

74 
	`as£¹Th©ThrownBy
(
futu»
::
još
).
	`hasCau£ExaùlyIn¡ªûOf
(
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

75 
	}
}

80 @
Te¡


81 
public
 
	$Œigg”Fau»HªdËr
() {

82 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

83 
	`£ndMes§ge
(
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP
.
	`·ylßdMsg
(
Ãw
 
	`LayoutBoÙ¡¿pReque¡
(
Ïyout
)));

84 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
.
	`·ylßdMsg
(

85 
Ãw
 
	`D‘eùÜMsg
(0L, 
CŞËùiÚs
.
	`em±yS‘
(), Collections.emptySet())));

87 
	`as£¹Th©ThrownBy
(
futu»
::
još
).
	`hasCau£ExaùlyIn¡ªûOf
(
NoBoÙ¡¿pExû±iÚ
.
şass
);

89 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
.
	`·ylßdMsg
(
Ïyout
));

90 
	`as£¹Th©
(
futu»
.
	`još
()).
	`isEqu®To
(
Œue
);

91 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
.
	`·ylßdMsg
(

92 
Ãw
 
	`D‘eùÜMsg
(0L, 
CŞËùiÚs
.
	`em±yS‘
(), Collections.emptySet())));

93 
	`as£¹Th©
(
futu»
.
	`još
()).
	`isEqu®To
(
Œue
);

95 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/ReconfigurationEventHandlerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gRecÚfigu¿tiÚEv’tHªdËr
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gCÚ£rv©iveFau»HªdËrPŞicy
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gIRecÚfigu¿tiÚHªdËrPŞicy
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

21 
public
 cÏs 
	cRecÚfigu¿tiÚEv’tHªdËrTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

26 @
Te¡


27 
public
 
	$upd©eLayoutOnFau»
() {

29 
	`addS”v”
(
SERVERS
.
PORT_0
);

30 
	`addS”v”
(
SERVERS
.
PORT_1
);

31 
	`addS”v”
(
SERVERS
.
PORT_2
);

33 
Layout
 
Üigš®Layout
 = 
Ãw
 
	`Te¡LayoutBud”
()

34 .
	`£tEpoch
(1L)

35 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

36 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

37 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

38 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

39 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

40 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

41 .
	`budSegm’t
()

42 .
	`budSŒe
()

43 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

44 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

45 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

46 .
	`addToSegm’t
()

47 .
	`addToLayout
()

48 .
	`bud
();

49 
	`boÙ¡¿pAÎS”v”s
(
Üigš®Layout
);

51 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
Ãw
 
	`CÜfuRuÁime
();

52 
cÜfuRuÁime
.
	`addLayoutS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_0
));

53 
cÜfuRuÁime
.
	`addLayoutS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_1
));

54 
cÜfuRuÁime
.
	`addLayoutS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
));

55 
cÜfuRuÁime
.
	`cÚÃù
();

57 
S‘
<
SŒšg
> 
çedS”v”s
 = 
Ãw
 
HashS‘
<>();

58 
çedS”v”s
.
	`add
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
));

60 
RecÚfigu¿tiÚEv’tHªdËr
 
»cÚfigu¿tiÚEv’tHªdËr
 = 
Ãw
 
	`RecÚfigu¿tiÚEv’tHªdËr
();

61 
IRecÚfigu¿tiÚHªdËrPŞicy
 
çu»HªdËrPŞicy
 = 
Ãw
 
	`CÚ£rv©iveFau»HªdËrPŞicy
();

62 
»cÚfigu¿tiÚEv’tHªdËr
.
	`hªdËFau»
(
çu»HªdËrPŞicy
,

63 
Üigš®Layout
,

64 
cÜfuRuÁime
,

65 
çedS”v”s
);

67 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

68 .
	`£tEpoch
(2L)

69 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

70 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

71 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

72 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

73 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

74 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

75 .
	`addUÄe¥ÚsiveS”v”
(
SERVERS
.
PORT_2
)

76 .
	`budSegm’t
()

77 .
	`budSŒe
()

78 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

79 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

80 .
	`addToSegm’t
()

81 .
	`addToLayout
()

82 .
	`bud
();

84 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
())

85 .
	`isEqu®To
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘Cu¼’tLayout
())

86 .
	`isEqu®To
(
ex³ùedLayout
);

88 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/ResourceQuotaTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gTe¡
;

5 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

6 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚsFÜCÏssTy³s
.
	gas£¹Th©ThrownBy
;

9 şas 
	cResourûQuÙaTe¡
 {

11 @
Te¡


12 
public
 
	$»sourûQuÙaTe¡
() {

13 
fš®
 
quÙaLim™
 = 10;

14 
fš®
 
cÚsumeSize
 = 5;

15 
fš®
 
»Ëa£Size
 = 3;

16 
ResourûQuÙa
 
rq
 = 
Ãw
 
	`ResourûQuÙa
("quÙa1", 
quÙaLim™
);

18 
rq
.
	`cÚsume
(
cÚsumeSize
);

19 
	`as£¹Th©
(
rq
.
	`hasAvaabË
()).
	`isTrue
();

20 
rq
.
	`cÚsume
(
cÚsumeSize
);

21 
	`as£¹Th©
(
rq
.
	`hasAvaabË
()).
	`isF®£
();

22 
	`as£¹Th©
(
rq
.
	`g‘AvaabË
()).
	`isEqu®To
(0);

25 
rq
.
	`»Ëa£
(
»Ëa£Size
);

26 
	`as£¹Th©
(
rq
.
	`hasAvaabË
()).
	`isTrue
();

27 
	`as£¹Th©
(
rq
.
	`g‘AvaabË
()).
	`isEqu®To
(
»Ëa£Size
);

30 
rq
.
	`cÚsume
(
quÙaLim™
 * quotaLimit);

31 
	`as£¹Th©
(
rq
.
	`g‘AvaabË
()).
	`isEqu®To
(0);

32 
rq
.
	`»Ëa£
(
LÚg
.
MAX_VALUE
);

33 
	`as£¹Th©
(
rq
.
	`g‘AvaabË
()).
	`isEqu®To
(
quÙaLim™
);

36 @
Te¡


37 
public
 
	$‹¡CÚsumeOv”æow
() {

39 
fš®
 
quÙaLim™
 = 10;

40 
ResourûQuÙa
 
rq
 = 
Ãw
 
	`ResourûQuÙa
("quÙa1", 
quÙaLim™
);

41 
rq
.
	`cÚsume
(1);

42 
	`as£¹Th©ThrownBy
((è-> 
rq
.
	`cÚsume
(
LÚg
.
MAX_VALUE
))

43 .
	`isIn¡ªûOf
(
Ar™hm‘icExû±iÚ
.
şass
);

44 
	}
}

46 @
Te¡


47 
public
 
	$‹¡Inv®idLim™
() {

49 
	`as£¹Th©ThrownBy
((è-> 
Ãw
 
	`ResourûQuÙa
("quota1", -1))

50 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

51 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/SequencerServerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

6 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrRecov”yMsg
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Reque¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Ty³
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

23 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

28 
public
 cÏs 
	cSequ’ûrS”v”Te¡
 
ex‹nds
 
	mAb¡¿ùS”v”Te¡
 {

30 
public
 
	$Sequ’ûrS”v”Te¡
() {

31 
	`su³r
();

34 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
;

36 
Sequ’ûrS”v”
 
£rv”
;

38 @
Ov”ride


39 
public
 
Ab¡¿ùS”v”
 
	$g‘DeçuÉS”v”
() {

40 
£rv”CÚ‹xt
 = 
S”v”CÚ‹xtBud”
.
	`deçuÉTe¡CÚ‹xt
(
SERVERS
.
PORT_0
);

41 
£rv”
 = 
Ãw
 
	`Sequ’ûrS”v”
(
£rv”CÚ‹xt
);

42  
£rv”
;

43 
	}
}

45 @
BefÜe


46 
public
 
	$boÙ¡¿pSequ’ûr
() {

47 
£rv”
.
	`£tSequ’ûrEpoch
(0L);

48 
	}
}

53 @
Te¡


54 
public
 
	$£qu’ûrM‘ricsReque¡
() {

55 
Com¶‘abËFutu»
<
Sequ’ûrM‘rics
> 
cFutu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
SEQUENCER_METRICS_REQUEST
.
	`msg
());

56 
Sequ’ûrM‘rics
 
£qM‘rics
 = 
cFutu»
.
	`još
();

57 
	`as£¹Th©
(
£qM‘rics
.
	`g‘Sequ’ûrStus
())

58 .
	`isEqu®To
(
Sequ’ûrM‘rics
.
Sequ’ûrStus
.
READY
);

59 
	}
}

61 @
Te¡


62 
public
 
	$tok’sA»Inü—sšg
() {

63 
Ï¡Tok’V®ue
 = -1;

64 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

65 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

66 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`em±yLi¡
())));

67 
Tok’
 
thisTok’
 = 
futu»
.
	`još
().
	`g‘Tok’
();

68 
	`as£¹Th©
(
thisTok’
.
	`g‘Sequ’û
())

69 .
	`isG»©”Thª
(
Ï¡Tok’V®ue
);

70 
Ï¡Tok’V®ue
 = 
thisTok’
.
	`g‘Sequ’û
();

72 
	}
}

74 @
Te¡


75 
public
 
	$checkTok’Pos™iÚWÜks
() {

76 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

78 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»1
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

79 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`em±yLi¡
())));

80 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»2
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

81 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`em±yLi¡
())));

83 
Tok’
 
thisTok’
 = 
futu»1
.
	`još
().
	`g‘Tok’
();

84 
Tok’
 
checkTok’
 = 
futu»2
.
	`još
().
	`g‘Tok’
();

86 
	`as£¹Th©
(
thisTok’
)

87 .
	`isEqu®To
(
checkTok’
);

89 
	}
}

91 @
Te¡


92 
public
 
	$³rSŒ—mCheckTok’Pos™iÚWÜks
() {

93 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amA".
	`g‘By‹s
());

94 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amB".
	`g‘By‹s
());

96 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

97 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

98 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

100 
Tok’
 
thisTok’A
 = 
futu»
.
	`još
().
	`g‘Tok’
();

102 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

103 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

105 
checkTok’A
 = 
futu»
.
	`još
().
	`g‘SŒ—mTa
(
¡»amA
);

107 
	`as£¹Th©
(
thisTok’A
.
	`g‘Sequ’û
())

108 .
	`isEqu®To
(
checkTok’A
);

110 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

111 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
))));

113 
Tok’
 
thisTok’B
 = 
futu»
.
	`još
().
	`g‘Tok’
();

115 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

116 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
))));

117 
checkTok’B
 = 
futu»
.
	`još
().
	`g‘SŒ—mTa
(
¡»amB
);

119 
	`as£¹Th©
(
thisTok’B
.
	`g‘Sequ’û
())

120 .
	`isEqu®To
(
checkTok’B
);

122 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

123 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

124 
checkTok’A2
 = 
futu»
.
	`još
().
	`g‘SŒ—mTa
(
¡»amA
);

126 
	`as£¹Th©
(
checkTok’A2
)

127 .
	`isEqu®To
(
checkTok’A
);

129 
	`as£¹Th©
(
thisTok’B
.
	`g‘Sequ’û
())

130 .
	`isG»©”Thª
(
checkTok’A
);

132 
	}
}

134 @
Te¡


135 
public
 
	$checkBackpoš‹rsWÜk
() {

136 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amA".
	`g‘By‹s
());

137 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amB".
	`g‘By‹s
());

139 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

140 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

141 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

142 
Tok’
 
thisTok’A
 = 
futu»
.
	`još
().
	`g‘Tok’
();

144 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

145 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

146 
checkTok’AV®ue
 = 
futu»
.
	`još
().
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amA
);

148 
	`as£¹Th©
(
thisTok’A
.
	`g‘Sequ’û
())

149 .
	`isEqu®To
(
checkTok’AV®ue
);

151 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

152 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
))));

153 
Tok’
 
thisTok’B
 = 
futu»
.
	`još
().
	`g‘Tok’
();

155 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

156 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
))));

157 
checkTok’BV®ue
 = 
futu»
.
	`još
().
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amB
);

159 
	`as£¹Th©
(
thisTok’B
.
	`g‘Sequ’û
())

160 .
	`isEqu®To
(
checkTok’BV®ue
);

162 
fš®
 
MULTI_TOKEN
 = 5L;

164 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

165 
Ãw
 
	`Tok’Reque¡
(
MULTI_TOKEN
, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

166 
thisTok’A
 = 
futu»
.
	`još
().
	`g‘Tok’
();

168 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

169 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

170 
checkTok’AV®ue
 = 
futu»
.
	`još
().
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amA
);

172 
	`as£¹Th©
(
thisTok’A
.
	`g‘Sequ’û
(è+ 
MULTI_TOKEN
 - 1)

173 .
	`isEqu®To
(
checkTok’AV®ue
);

176 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

177 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

178 
thisTok’A
 = 
futu»
.
	`još
().
	`g‘Tok’
();

180 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

181 
Ãw
 
	`Tok’Reque¡
(
MULTI_TOKEN
, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

182 
checkTok’AV®ue
 = 
futu»
.
	`još
().
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amA
);

184 
	`as£¹Th©
(
thisTok’A
.
	`g‘Sequ’û
()).
	`isEqu®To
(
checkTok’AV®ue
);

187 
	}
}

189 @
Te¡


190 
public
 
	$Sequ’ûrWlRe£tTas
(è
throws
 
Exû±iÚ
 {

191 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amA".
	`g‘By‹s
());

192 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amB".
	`g‘By‹s
());

193 
UUID
 
¡»amC
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amC".
	`g‘By‹s
());

195 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

196 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

197 
A
 = 
futu»
.
	`još
().
	`g‘Tok’
().
	`g‘Sequ’û
();

199 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

200 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
))));

201 
B
 = 
futu»
.
	`još
().
	`g‘Tok’
().
	`g‘Sequ’û
();

203 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

204 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amC
))));

205 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

206 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amC
))));

208 
C
 = 
futu»
.
	`još
().
	`g‘Tok’
().
	`g‘Sequ’û
();

210 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

211 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`em±yLi¡
())));

212 
glob®Ta
 = 
futu»
.
	`još
().
	`g‘Tok’
().
	`g‘Sequ’û
();

215 
M­
<
UUID
, 
SŒ—mAdd»ssS·û
> 
M­
 = 
Ãw
 
HashM­
<>();

216 
ÃwTaA
 = 
A
 + 2;

217 
ÃwTaB
 = 
B
 + 1;

219 
ÃwTaC
 = 
C
 - 1;

221 
M­
.
	`put
(
¡»amA
, 
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
, 
Rßršg64NavigabËM­
.
	`b™m­Of
(
ÃwTaA
)));

222 
M­
.
	`put
(
¡»amB
, 
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
, 
Rßršg64NavigabËM­
.
	`b™m­Of
(
ÃwTaB
)));

223 
M­
.
	`put
(
¡»amC
, 
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
, 
Rßršg64NavigabËM­
.
	`b™m­Of
(
ÃwTaC
)));

226 
£rv”
.
	`£tSequ’ûrEpoch
(-1L);

227 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
,

228 
Ãw
 
	`Sequ’ûrRecov”yMsg
(
glob®Ta
 + 2, 
M­
, 0L, 
çl£
)));

229 
futu»
.
	`još
();

230 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

231 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

232 
	`as£¹Th©
(
futu»
.
	`još
().
	`g‘SŒ—mTa
(
¡»amA
)).
	`isEqu®To
(
ÃwTaA
);

234 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

235 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
))));

236 
	`as£¹Th©
(
futu»
.
	`još
().
	`g‘SŒ—mTa
(
¡»amB
)).
	`isEqu®To
(
ÃwTaB
);

239 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

240 
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amC
))));

241 
	`as£¹Th©
(
futu»
.
	`još
().
	`g‘SŒ—mTa
(
¡»amC
)).
	`isEqu®To
(
ÃwTaC
);

242 
	}
}

251 @
Te¡


252 
public
 
	$çov”SeqDÛsNÙReg»ssTok’V®ue
() {

254 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amA".
	`g‘By‹s
());

257 
fš®
 
num
 = 10;

259 
Com¶‘abËFutu»
<
Tok’Re¥Ú£
> 
futu»
 = 
nuÎ
;

260 
i
 = 0; i < 
num
; i++) {

261 
futu»
 = 
	`£ndReque¡
(
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
TOKEN_REQ
,

262 
Ãw
 
	`Tok’Reque¡
(1L, 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
))));

265 
futu»
.
	`još
();

266 
	`as£¹Th©
(
£rv”
.
	`g‘Glob®LogTa
()).
	`isEqu®To
(
num
);

269 
ÃwEpoch
 = 
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
() + 1;

270 
£rv”CÚ‹xt
.
	`£tS”v”Epoch
(
ÃwEpoch
, s”v”CÚ‹xt.
	`g‘S”v”Rou‹r
());

271 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»1
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
.
	`·ylßdMsg
(
Ãw
 
	`Sequ’ûrRecov”yMsg
(

272 
Add»ss
.
NON_EXIST
, 
CŞËùiÚs
.
	`em±yM­
(), 
ÃwEpoch
, 
Œue
)));

273 
	`as£¹Th©
(
futu»1
.
	`još
()).
	`isEqu®To
(
Œue
);

276 
ÃwEpoch
 = 
£rv”CÚ‹xt
.
	`g‘S”v”Epoch
() + 2;

277 
£rv”CÚ‹xt
.
	`£tS”v”Epoch
(
ÃwEpoch
, s”v”CÚ‹xt.
	`g‘S”v”Rou‹r
());

278 
futu»1
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
.
	`·ylßdMsg
(
Ãw
 
	`Sequ’ûrRecov”yMsg
(

279 
Add»ss
.
NON_EXIST
, 
CŞËùiÚs
.
	`em±yM­
(), 
ÃwEpoch
, 
Œue
)));

280 
	`as£¹Th©
(
futu»1
.
	`još
()).
	`isEqu®To
(
çl£
);

281 
futu»1
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
.
	`·ylßdMsg
(
Ãw
 
	`Sequ’ûrRecov”yMsg
(

282 
num
, 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Ãw
 
	`SŒ—mAdd»ssS·û
(
Add»ss
.
NON_ADDRESS
,

283 
Rßršg64NavigabËM­
.
	`b™m­Of
(
num
))), 
ÃwEpoch
, 
çl£
)));

284 
	`as£¹Th©
(
futu»1
.
	`još
()).
	`isEqu®To
(
Œue
);

286 
futu»
 = 
	`£ndReque¡
(
CÜfuMsgTy³
.
TOKEN_REQ
.
	`·ylßdMsg
(
Ãw
 
	`Tok’Reque¡
(0L, 
CŞËùiÚs
.
	`em±yLi¡
())));

287 
	`as£¹Th©
(
futu»
.
	`još
())

288 .
	`isEqu®To
(
Ãw
 
	`Tok’Re¥Ú£
(
Tok’Ty³
.
NORMAL
, 
Tok’Re¥Ú£
.
NO_CONFLICT_KEY
,

289 
Tok’Re¥Ú£
.
NO_CONFLICT_STREAM
, 
Ãw
 
	`Tok’
(
ÃwEpoch
, 
num
 - 1),

290 
CŞËùiÚs
.
	`em±yM­
(), Collections.emptyMap()));

291 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/ServerContextBuilder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gex³rim’l
.
	gAcûssÜs
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gcÚcu¼’t
.
	gTe¡Th»adGroups
;

11 @
AcûssÜs
(
chaš
 = 
Œue
)

12 @
D©a


14 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

15 
public
 cÏs 
	cS”v”CÚ‹xtBud”
 {

16 
boŞ—n
 
sšgË
 = 
Œue
;

17 
boŞ—n
 
	mmemÜy
 = 
Œue
;

18 
SŒšg
 
	mlogP©h
 = 
nuÎ
;

19 
boŞ—n
 
	mnoV”ify
 = 
çl£
;

20 
boŞ—n
 
	mnoSync
 = 
çl£
;

22 
boŞ—n
 
	msEÇbËd
 = 
çl£
;

23 
boŞ—n
 
	msMutu®AuthEÇbËd
 = 
çl£
;

24 
SŒšg
 
	msPrÙocŞs
 = "";

25 
SŒšg
 
	msCh”s
 = "";

26 
SŒšg
 
	mkey¡Üe
 = "";

27 
SŒšg
 
	mkey¡ÜePasswÜdFe
 = "";

28 
boŞ—n
 
	m§¦PÏšTextAuth
 = 
çl£
;

29 
SŒšg
 
	mŒu¡¡Üe
 = "";

30 
SŒšg
 
	mŒu¡¡ÜePasswÜdFe
 = "";

32 
SŒšg
 
	mim¶em’tiÚ
 = "local";

34 
SŒšg
 
	mÿcheSizeH—pR©io
 = "0.5";

35 
SŒšg
 
	madd»ss
 = "test";

36 
	mpÜt
 = 9000;

37 
SŒšg
 
	m£qCache
 = "1000";

38 
SŒšg
 
	mlogSizeLim™P”ûÁage
 = "100.0";

39 
SŒšg
 
	mb©chSize
 = "100";

40 
SŒšg
 
	mmªagem’tBoÙ¡¿pEndpošt
 = 
nuÎ
;

41 
IS”v”Rou‹r
 
	m£rv”Rou‹r
;

42 
SŒšg
 
	mnumTh»ads
 = "0";

43 
SŒšg
 
	mhªdshakeTimeout
 = "10";

44 
SŒšg
 
	m´efix
 = "";

45 
SŒšg
 
	m»‹ÁiÚ
 = "1000";

47 
SŒšg
 
	mşu¡”Id
 = "auto";

48 
boŞ—n
 
	misTe¡
 = 
Œue
;

50 
public
 
	$S”v”CÚ‹xtBud”
() {

54 
public
 
S”v”CÚ‹xt
 
	$bud
() {

55 
ImmubËM­
.
Bud”
<
SŒšg
,
Objeù
> 
bud”
 =

56 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, 
Objeù
>()

57 .
	`put
("--sšgË", 
sšgË
)

58 .
	`put
("--memÜy", 
memÜy
)

59 .
	`put
("--Th»ads", 
numTh»ads
)

60 .
	`put
("--HªdshakeTimeout", 
hªdshakeTimeout
)

61 .
	`put
("--£qu’ûr-ÿche-size", 
£qCache
)

62 .
	`put
("--log-size-quÙa-³rûÁage", 
logSizeLim™P”ûÁage
)

63 .
	`put
("--b©ch-size", 
b©chSize
)

64 .
	`put
("--m‘ad©a-»‹ÁiÚ", 
»‹ÁiÚ
);

65 ià(
logP©h
 !ğ
nuÎ
) {

66 
bud”
.
	`put
("--log-·th", 
logP©h
);

68 ià(
mªagem’tBoÙ¡¿pEndpošt
 !ğ
nuÎ
) {

69 
bud”
.
	`put
("--mªagem’t-£rv”", 
mªagem’tBoÙ¡¿pEndpošt
);

71 
bud”


72 .
	`put
("--no-v”ify", 
noV”ify
)

73 .
	`put
("--no-sync", 
noSync
)

74 .
	`put
("--add»ss", 
add»ss
)

75 .
	`put
("--ÿche-h—p-¿tio", 
ÿcheSizeH—pR©io
)

76 .
	`put
("--’abË-s", 
sEÇbËd
)

77 .
	`put
("--’abË-s-mutu®-auth", 
sMutu®AuthEÇbËd
)

78 .
	`put
("--s-´ÙocŞs", 
sPrÙocŞs
)

79 .
	`put
("--s-ch”s", 
sCh”s
)

80 .
	`put
("--key¡Üe", 
key¡Üe
)

81 .
	`put
("--key¡Üe-·sswÜd-fe", 
key¡ÜePasswÜdFe
)

82 .
	`put
("--Œu¡¡Üe", 
Œu¡¡Üe
)

83 .
	`put
("--Œu¡¡Üe-·sswÜd-fe", 
Œu¡¡ÜePasswÜdFe
)

84 .
	`put
("--’abË-§¦-¶aš-‹xt-auth", 
§¦PÏšTextAuth
)

85 .
	`put
("--şu¡”-id", 
şu¡”Id
)

86 .
	`put
("--im¶em’tiÚ", 
im¶em’tiÚ
)

87 .
	`put
("<pÜt>", 
IÁeg”
.
	`toSŒšg
(
pÜt
));

90 ià(
´efix
.
	`equ®s
("")) {

91 
´efix
 = "‹¡:" + 
pÜt
;

93 
bud”
.
	`put
("--P»fix", 
´efix
);

96 ià(
im¶em’tiÚ
.
	`equ®s
("local")) {

97 
bud”
.
	`put
("ş›Á", 
Te¡Th»adGroups
.
NETTY_CLIENT_GROUP
.
	`g‘
());

98 
bud”
.
	`put
("boss", 
Te¡Th»adGroups
.
NETTY_BOSS_GROUP
.
	`g‘
());

99 
bud”
.
	`put
("wÜk”", 
Te¡Th»adGroups
.
NETTY_CLIENT_GROUP
.
	`g‘
());

101 
S”v”CÚ‹xt
 
sc
 = 
Ãw
 
	`S”v”CÚ‹xt
(
bud”
.
	`bud
());

102 
sc
.
	`£tS”v”Rou‹r
(
£rv”Rou‹r
);

103  
sc
;

104 
	}
}

111 
public
 
S”v”CÚ‹xt
 
	$deçuÉTe¡CÚ‹xt
(
pÜt
) {

112 
S”v”CÚ‹xt
 
sc
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

113 .
	`£tPÜt
(
pÜt
).
	`bud
();

114 
sc
.
	`£tS”v”Rou‹r
(
Ãw
 
	`Te¡S”v”Rou‹r
());

115  
sc
;

116 
	}
}

123 
public
 
S”v”CÚ‹xt
 
	$deçuÉCÚ‹xt
(
pÜt
) {

124 
S”v”CÚ‹xt
 
sc
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

125 .
	`£tPÜt
(
pÜt
)

126 .
	`£tIm¶em’tiÚ
("auto")

127 .
	`bud
();

128  
sc
;

129 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/TestLayoutBuilder.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

6 
impÜt
 
	glombok
.
	gex³rim’l
.
	gAcûssÜs
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

16 @
	$AcûssÜs
(
chaš
 = 
Œue
)

17 
public
 cÏs 
	cTe¡LayoutBud”
 {

19 
Li¡
<
SŒšg
> 
£qu’ûrS”v”s
;

20 
Li¡
<
SŒšg
> 
ÏyoutS”v”s
;

21 
Li¡
<
SŒšg
> 
uÄe¥ÚsiveS”v”s
;

22 
Li¡
<
Te¡Segm’tBud”
> 
£gm’ts
;

24 @
G‘‹r


25 @
S‘‹r


26 
UUID
 
şu¡”Id
;

28 @
G‘‹r


29 @
S‘‹r


30 
•och
 = 0L;

32 
public
 
	$Te¡LayoutBud”
() {

33 
£qu’ûrS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

34 
ÏyoutS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

35 
uÄe¥ÚsiveS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

36 
£gm’ts
 = 
Ãw
 
A¼ayLi¡
<>();

39 
SŒšg
 
	$g‘Endpošt
(
pÜt
) {

40  "‹¡:" + 
pÜt
;

41 
	}
}

43 
public
 
Layout
 
	$sšgË
(
pÜt
) {

44  
Ãw
 
	`Te¡LayoutBud”
()

45 .
	`addLayoutS”v”
(
pÜt
)

46 .
	`addSequ’ûr
(
pÜt
)

47 .
	`budSegm’t
()

48 .
	`budSŒe
()

49 .
	`addLogUn™
(
pÜt
)

50 .
	`addToSegm’t
()

51 .
	`addToLayout
()

52 .
	`£tClu¡”Id
(
UUID
.
	`¿ndomUUID
())

53 .
	`bud
();

54 
	}
}

56 
public
 
Te¡LayoutBud”
 
	$addSequ’ûr
(
pÜt
) {

57 
£qu’ûrS”v”s
.
	`add
(
	`g‘Endpošt
(
pÜt
));

58  
this
;

59 
	}
}

61 
public
 
Te¡LayoutBud”
 
	$addLayoutS”v”
(
pÜt
) {

62 
ÏyoutS”v”s
.
	`add
(
	`g‘Endpošt
(
pÜt
));

63  
this
;

64 
	}
}

66 
public
 
Te¡LayoutBud”
 
	$addUÄe¥ÚsiveS”v”
(
pÜt
) {

67 
uÄe¥ÚsiveS”v”s
.
	`add
(
	`g‘Endpošt
(
pÜt
));

68  
this
;

69 
	}
}

71 
´iv©e
 
Te¡LayoutBud”
 
	$addSegm’t
(
Te¡Segm’tBud”
 
bud”
) {

72 
£gm’ts
.
	`add
(
bud”
);

73  
this
;

74 
	}
}

76 
public
 
Te¡Segm’tBud”
 
	$budSegm’t
() {

77  
Ãw
 
	`Te¡Segm’tBud”
(
this
);

78 
	}
}

80 
public
 
Layout
 
	$bud
() {

81 
Li¡
<
Layout
.
LayoutSegm’t
> 
£gm’tLi¡
 = 
£gm’ts
.
	`¡»am
()

82 .
	`m­
(
Te¡Segm’tBud”
::
bud
)

83 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

85  
Ãw
 
	`Layout
(
ÏyoutS”v”s
,

86 
£qu’ûrS”v”s
,

87 
£gm’tLi¡
,

88 
uÄe¥ÚsiveS”v”s
,

89 
•och
, 
şu¡”Id
);

90 
	}
}

92 @
	$AcûssÜs
(
chaš
 = 
Œue
)

93 
public
 şas 
	cTe¡Segm’tBud”
 {

95 
Te¡LayoutBud”
 
ÏyoutBud”
;

97 @
S‘‹r


98 
Layout
.
R•liÿtiÚMode
 
»¶iÿtiÚMode
 = Layout.R•liÿtiÚMode.
CHAIN_REPLICATION
;

100 @
S‘‹r


101 
¡¬t
 = 0L;

103 @
S‘‹r


104 
’d
 = -1L;

106 
Li¡
<
Te¡SŒeBud”
> 
¡res
;

109 
public
 
	`Te¡Segm’tBud”
(
Te¡LayoutBud”
 
ÏyoutBud”
) {

110 
this
.
ÏyoutBud”
 =†ayoutBuilder;

111 
¡res
 = 
Ãw
 
A¼ayLi¡
<>();

114 
public
 
Te¡SŒeBud”
 
	`budSŒe
() {

115  
Ãw
 
	`Te¡SŒeBud”
(
this
);

118 
´iv©e
 
Te¡Segm’tBud”
 
	`addSŒe
(
Te¡SŒeBud”
 
¡reBud”
) {

119 
¡res
.
	`add
(
¡reBud”
);

120  
this
;

123 
public
 
Te¡LayoutBud”
 
	`addToLayout
() {

124 
ÏyoutBud”
.
	`addSegm’t
(
this
);

125  
ÏyoutBud”
;

128 
´iv©e
 
Layout
.
LayoutSegm’t
 
	`bud
() {

129 
Li¡
<
Layout
.
LayoutSŒe
> 
®lSŒes
 = 
¡res
.
	`¡»am
()

130 .
	`m­
(
Te¡SŒeBud”
::
bud
)

131 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

132  
Ãw
 
Layout
.
	`LayoutSegm’t
(
»¶iÿtiÚMode
, 
¡¬t
, 
’d
, 
®lSŒes
);

134 
	}
}

136 
public
 şas 
	cTe¡SŒeBud”
 {

138 
Te¡Segm’tBud”
 
	g£gm’tBud”
;

139 
	gLi¡
<
	gSŒšg
> 
	glogUn™s
;

141 
public
 
Te¡SŒeBud”
(
Te¡Segm’tBud”
 
£gm’tBud”
) {

142 
	gthis
.
	g£gm’tBud”
 = 
£gm’tBud”
;

143 
	glogUn™s
 = 
Ãw
 
A¼ayLi¡
<>();

146 
public
 
Te¡SŒeBud”
 
addLogUn™
(
pÜt
) {

147 
	glogUn™s
.
add
(
g‘Endpošt
(
pÜt
));

148  
	gthis
;

151 
public
 
Te¡Segm’tBud”
 
addToSegm’t
() {

152 
	g£gm’tBud”
.
addSŒe
(
this
);

153  
	g£gm’tBud”
;

156 
´iv©e
 
	gLayout
.
LayoutSŒe
 
bud
() {

157  
Ãw
 
	gLayout
.
LayoutSŒe
(
logUn™s
);

	@test/src/test/java/org/corfudb/infrastructure/TestServerRouter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡ChªÃlCÚ‹xt
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

24 @
Slf4j


25 
public
 cÏs 
	cTe¡S”v”Rou‹r
 
im¶em’ts
 
	mIS”v”Rou‹r
 {

27 @
G‘‹r


28 
public
 
	mLi¡
<
	mCÜfuMsg
> 
	m»¥Ú£Mes§ges
;

30 @
G‘‹r


31 
public
 
	mM­
<
	mCÜfuMsgTy³
, 
	mAb¡¿ùS”v”
> 
	mhªdËrM­
;

33 @
G‘‹r


34 
public
 
	mLi¡
<
	mAb¡¿ùS”v”
> 
	m£rv”s
;

36 
public
 
	mLi¡
<
	mTe¡RuË
> 
	mruËs
;

38 
AtomicLÚg
 
	m»que¡CouÁ”
;

40 @
G‘‹r


41 
	m£rv”Epoch
;

43 @
G‘‹r


44 
	mpÜt
 = 0;

46 
public
 
	$Te¡S”v”Rou‹r
() {

47 
	`»£t
();

50 
public
 
	$Te¡S”v”Rou‹r
(
pÜt
) {

51 
	`»£t
();

52 
this
.
pÜt
 =…ort;

53 
	}
}

55 
public
 
	$»£t
() {

56 
this
.
»¥Ú£Mes§ges
 = 
Ãw
 
A¼ayLi¡
<>();

57 
this
.
»que¡CouÁ”
 = 
Ãw
 
	`AtomicLÚg
();

58 
this
.
£rv”s
 = 
Ãw
 
A¼ayLi¡
<>();

59 
this
.
hªdËrM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

60 
this
.
ruËs
 = 
Ãw
 
A¼ayLi¡
<>();

61 
	}
}

63 @
Ov”ride


64 
public
 
	$£ndRe¥Ú£
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
šMsg
, CÜfuMsg 
outMsg
) {

65 
outMsg
.
	`cİyBa£F›lds
(
šMsg
);

66 
outMsg
.
	`£tEpoch
(
	`g‘S”v”Epoch
());

67 ià(
ruËs
.
	`¡»am
()

68 .
	`m­
(
x
 -> x.
	`ev®u©e
(
outMsg
, 
this
))

69 .
	`®lM©ch
(
x
 -> x)) {

70 ià(
ùx
 !ğ
nuÎ
 && ctx 
š¡ªûof
 
Te¡ChªÃlCÚ‹xt
) {

71 
ùx
.
	`wr™eAndFlush
(
outMsg
);

73 
this
.
»¥Ú£Mes§ges
.
	`add
(
outMsg
);

76 
	}
}

83 @
Ov”ride


84 
public
 
	$addS”v”
(
Ab¡¿ùS”v”
 
£rv”
) {

85 
£rv”s
.
	`add
(
£rv”
);

86 
£rv”
.
	`g‘HªdËr
()

87 .
	`g‘HªdËdTy³s
().
	`fÜEach
(
x
 -> {

88 
hªdËrM­
.
	`put
(
x
, 
£rv”
);

89 
log
.
	`Œaû
("Regi¡”ed {}ØhªdË mes§ge oàty³ {}", 
£rv”
, 
x
);

91 
	}
}

102 
public
 
boŞ—n
 
	$v®id©eEpoch
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

103 ià(!
msg
.
	`g‘MsgTy³
().
ignÜeEpoch
 && msg.
	`g‘Epoch
(è!ğ
£rv”Epoch
) {

104 
	`£ndRe¥Ú£
(
ùx
, 
msg
, 
Ãw
 
CÜfuPaylßdMsg
<>(
CÜfuMsgTy³
.
WRONG_EPOCH
,

105 
	`g‘S”v”Epoch
()));

106 
log
.
	`Œaû
("Incoming message with wrongƒpoch, got {},ƒxpected {}, message was: {}",

107 
msg
.
	`g‘Epoch
(), 
£rv”Epoch
, msg);

108  
çl£
;

110  
Œue
;

111 
	}
}

113 
public
 
	$£ndS”v”Mes§ge
(
CÜfuMsg
 
msg
) {

114 
	`£ndS”v”Mes§ge
(
msg
, 
nuÎ
);

115 
	}
}

117 
public
 
	$£ndS”v”Mes§ge
(
CÜfuMsg
 
msg
, 
ChªÃlHªdËrCÚ‹xt
 
ùx
) {

118 
Ab¡¿ùS”v”
 
as
 = 
hªdËrM­
.
	`g‘
(
msg
.
	`g‘MsgTy³
());

119 ià(
	`v®id©eEpoch
(
msg
, 
ùx
)) {

120 ià(
as
 !ğ
nuÎ
) {

122 
as
.
	`hªdËMes§ge
(
msg
, 
ùx
, 
this
);

125 
log
.
	`Œaû
("UÄegi¡”ed mes§goàty³ {} s’ˆtØrou‹r", 
msg
.
	`g‘MsgTy³
());

128 
log
.
	`Œaû
("Mes§gw™h wrÚgƒpoch {},ƒx³ùed {}", 
msg
.
	`g‘Epoch
(), 
£rv”Epoch
);

130 
	}
}

132 
public
 
	$£tS”v”Epoch
(
£rv”Epoch
) {

133 
this
.
£rv”Epoch
 = serverEpoch;

134 
	`g‘S”v”s
().
	`fÜEach
(
s
 -> s.
	`£®S”v”W™hEpoch
(
£rv”Epoch
));

135 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/log/MultiReadWriteLockTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCªûÎ©iÚExû±iÚ
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCyşicB¬r›r
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

18 @
Slf4j


19 
public
 cÏs 
	cMuÉiR—dWr™eLockTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

21 @
Te¡


22 
public
 
	$‹¡Wr™eAndR—dLocksA»R“Á¿Á
(è
throws
 
Exû±iÚ
 {

23 
C®ÏbËCÚsum”
 
c
 = (
r
) -> {

24 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

25 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

26 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

27 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed3
 = 
locks
.
	`acquœeR—dLock
(1l)) {

28 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed4
 = 
locks
.
	`acquœeR—dLock
(1l)) {

34 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_ONE
, 
c
);

35 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_ONE
, PARAMETERS.
TIMEOUT_NORMAL
);

39 @
Te¡


40 
public
 
	$‹¡Ind•’d’tWr™eLocksDoNÙSynchrÚize
(è
throws
 
Exû±iÚ
 {

41 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

42 
CyşicB¬r›r
 
’Œy
 = 
Ãw
 
	`CyşicB¬r›r
(
PARAMETERS
.
CONCURRENCY_SOME
);

45 
C®ÏbËCÚsum”
 
c
 = (
r
) -> {

46 
	`Œy
(
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed
 = 
locks
.
	`acquœeWr™eLock
(()
r
)){

47 
’Œy
.
	`awa™
();

50 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_SOME
, 
c
);

51 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_NORMAL
);

53 
	}
}

57 @
Te¡


58 
public
 
	$‹¡Wr™eLockSynchrÚizes
(è
throws
 
Exû±iÚ
 {

59 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

60 
CyşicB¬r›r
 
’Œy
 = 
Ãw
 
	`CyşicB¬r›r
(
PARAMETERS
.
CONCURRENCY_SOME
);

62 
AtomicBoŞ—n
 
noProbËms
 = 
Ãw
 
	`AtomicBoŞ—n
(
Œue
);

63 
C®ÏbËCÚsum”
 
c
 = (
r
) -> {

64 
	`Œy
(
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

65 
’Œy
.
	`awa™
();

66 
noProbËms
.
	`£t
(
çl£
);

69 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_SOME
, 
c
);

70 
Œy
 {

71 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_VERY_SHORT
);

72 
	`ç
();

73 } 
	`ÿtch
 (
CªûÎ©iÚExû±iÚ
 
e
) {

74 
	`as£¹True
(
noProbËms
.
	`g‘
());

76 
	}
}

80 @
Te¡


81 
public
 
	$‹¡R—dLock
(è
throws
 
Exû±iÚ
 {

82 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

83 
CyşicB¬r›r
 
’Œy
 = 
Ãw
 
	`CyşicB¬r›r
(
PARAMETERS
.
CONCURRENCY_SOME
);

84 
C®ÏbËCÚsum”
 
c
 = (
r
) -> {

85 
	`Œy
(
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed
 = 
locks
.
	`acquœeR—dLock
(1l)){

86 
’Œy
.
	`awa™
();

89 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
CONCURRENCY_SOME
, 
c
);

90 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_NORMAL
);

91 
	}
}

95 @
Te¡


96 
public
 
	$‹¡Wr™eLockNÙP”m™‹dInR—dLock
() {

97 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

98 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeR—dLock
(1l)) {

99 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

101 
	`ç
();

102 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) {

105 
	}
}

107 @
Te¡


108 
public
 
	$‹¡IncÜ»ùLockOrd”
() {

109 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

110 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeR—dLock
(2l)) {

111 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

113 
	`ç
();

114 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) {

117 
	}
}

119 @
Te¡


120 
public
 
	$‹¡CÜ»ùLockOrd”
() {

121 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

122 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeR—dLock
(1l)) {

123 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeWr™eLock
(2l)) {

127 
	}
}

129 @
Te¡


130 
public
 
	$‹¡LockCÜ»ùlyD”egi¡”ed
() {

131 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

132 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeR—dLock
(2l)) {

134 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

137 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed0
 = 
locks
.
	`acquœeR—dLock
(0l)) {

138 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeR—dLock
(2l)) {

140 
	`Œy
 (
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeWr™eLock
(1l)) {

144 
	}
}

146 @
Te¡


147 
public
 
	$‹¡LockClo£IsIdempÙ’t
() {

148 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

149 
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeWr™eLock
(2l);

150 
ignÜed1
.
	`şo£
();

151 
ignÜed1
.
	`şo£
();

152 
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeR—dLock
(1l);

153 
ignÜed2
.
	`şo£
();

154 
ignÜed2
.
	`şo£
();

155 
	}
}

157 @
Te¡


158 
public
 
	$‹¡WrÚgUÆocksOrd”Caught
() {

159 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

160 
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeWr™eLock
(1l);

161 
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeR—dLock
(2l);

162 
Œy
 {

163 
ignÜed1
.
	`şo£
();

164 
	`ç
();

165 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) {

168 
	}
}

170 @
Te¡


171 
public
 
	$‹¡WrÚgUÆocksTy³Caught
() {

172 
MuÉiR—dWr™eLock
 
locks
 = 
Ãw
 
	`MuÉiR—dWr™eLock
();

173 
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed1
 = 
locks
.
	`acquœeWr™eLock
(1l);

174 
MuÉiR—dWr™eLock
.
AutoClo£abËLock
 
ignÜed2
 = 
locks
.
	`acquœeR—dLock
(1l);

175 
Œy
 {

176 
ignÜed1
.
	`şo£
();

177 
	`ç
();

178 } 
	`ÿtch
 (
IÎeg®S‹Exû±iÚ
 
e
) {

181 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/log/StreamLogCompactionTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gdoThrow
;

5 
impÜt
 
	gÜg
.
	gmock™o
.
	gMock™o
.
	gmock
;

7 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

17 @
Slf4j


18 
public
 cÏs 
	cSŒ—mLogCom·ùiÚTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

20 
´iv©e
 
M‘ricRegi¡ry
 
	mm‘ricRegi¡ry
;

22 @
BefÜeCÏss


23 
public
 
	$£tUpM‘rics
() {

24 
m‘ricRegi¡ry
 = 
S”v”CÚ‹xt
.
	`g‘M‘rics
();

25 ià(!
M‘ricsUts
.
	`isM‘ricsCŞËùiÚEÇbËd
()) {

26 
M‘ricsUts
.
	`m‘ricsR•ÜtšgS‘up
(
m‘ricRegi¡ry
);

37 @
Te¡


38 
public
 
	$‹¡Com·ùiÚ
(è
throws
 
IÁ”ru±edExû±iÚ
 {

39 
log
.
	`debug
("Start†og compactionest");

41 
fš®
 
timeout
 = 10;

42 
fš®
 
š™ŸlD–ay
 = 10;

43 
fš®
 
³riod
 = 10;

45 
SŒ—mLog
 
¡»amLog
 = 
	`mock
(SŒ—mLog.
şass
);

46 
	`doThrow
(
Ãw
 
	`RuÁimeExû±iÚ
("”r")).
	`wh’
(
¡»amLog
).
	`com·ù
();

48 
fš®
 
š™ŸlCom·ùiÚCouÁ”
 = 
	`g‘Com·ùiÚCouÁ”
();

49 
SŒ—mLogCom·ùiÚ
 
com·ùiÚ
 = 
Ãw
 
	`SŒ—mLogCom·ùiÚ
(
¡»amLog
,

50 
š™ŸlD–ay
,

51 
³riod
,

52 
TimeUn™
.
MILLISECONDS
,

53 
PARAMETERS
.
TIMEOUT_VERY_SHORT
);

57 
fš®
 
ex³ùedCom·ùiÚCouÁ”
 = 
š™ŸlCom·ùiÚCouÁ”
 +

58 (
M‘ricsUts
.
	`isM‘ricsCŞËùiÚEÇbËd
() ? 2 : 0);

60 
	`g‘Com·ùiÚCouÁ”
(è< 
ex³ùedCom·ùiÚCouÁ”
){

61 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
timeout
);

64 
com·ùiÚ
.
	`shutdown
();

66 
	`as£¹Th©
(
	`g‘Com·ùiÚCouÁ”
()).
	`isG»©”ThªOrEqu®To
(
ex³ùedCom·ùiÚCouÁ”
);

67 
	}
}

69 
´iv©e
 
	$g‘Com·ùiÚCouÁ”
() {

70  
m‘ricRegi¡ry


71 .
	`tim”
(
SŒ—mLogCom·ùiÚ
.
STREAM_COMPACT_METRIC
)

72 .
	`g‘CouÁ
();

73 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/log/StreamLogFilesTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
.
	gMETADATA_SIZE
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
.
	gRECORDS_PER_LOG_FILE
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

11 
impÜt
 
	gjava
.
	gio
.
	gFe
;

12 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

13 
impÜt
 
	gjava
.
	gio
.
	gRªdomAcûssFe
;

14 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

17 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

18 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

22 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
.
	gM‘ad©a
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
.
	gChecksum
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

42 
public
 cÏs 
	cSŒ—mLogFesTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

44 
´iv©e
 
SŒšg
 
	$g‘DœP©h
() {

45  
PARAMETERS
.
TEST_TEMP_DIR
;

48 
´iv©e
 
S”v”CÚ‹xt
 
	$g‘CÚ‹xt
() {

49 
SŒšg
 
·th
 = 
	`g‘DœP©h
();

50  
Ãw
 
	`S”v”CÚ‹xtBud”
()

51 .
	`£tLogP©h
(
·th
)

52 .
	`£tMemÜy
(
çl£
)

53 .
	`bud
();

54 
	}
}

56 @
Te¡


57 
public
 
	$‹¡Wr™eR—dW™hChecksum
() {

59 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

60 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

61 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

62 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

63 
add»ss0
 = 0;

64 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

65 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
).
	`g‘Paylßd
(
nuÎ
)).
	`isEqu®To
(
¡»amEÁry
);

70 
fš®
 
SŒ—mLog
 
ÃwLog
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
Œue
);

71 
	`as£¹Th©ThrownBy
(() -> {

72 
ÃwLog
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

74 .
	`isIn¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

75 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
).
	`g‘Paylßd
(
nuÎ
)).
	`isEqu®To
(
¡»amEÁry
);

76 
	}
}

78 @
Te¡


79 
public
 
	$‹¡B©chWr™e
(è
throws
 
Exû±iÚ
 {

80 
S”v”CÚ‹xt
 
sc
 = 
	`g‘CÚ‹xt
();

81 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

84 
fš®
 
numSegm’ts
 = 2;

85 
fš®
 
numI‹r
 = 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 * 
numSegm’ts
;

86 
Li¡
<
LogD©a
> 
wr™eEÁr›s
 = 
Ãw
 
A¼ayLi¡
<>();

87 
x
 = 0; x < 
numI‹r
; x++) {

88 
wr™eEÁr›s
.
	`add
(
	`g‘EÁry
(
x
));

91 
log
.
	`­³nd
(
wr™eEÁr›s
);

92 
log
.
	`sync
(
Œue
);

94 
SŒ—mLog
 
log2
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

95 
Li¡
<
LogD©a
> 
»adEÁr›s
 = 
	`»adRªge
(0, 
numI‹r
, 
log2
);

96 
	`as£¹Th©
(
wr™eEÁr›s
).
	`isEqu®To
(
»adEÁr›s
);

97 
	}
}

99 @
Te¡


100 
public
 
	$‹¡RªgeWr™eTrim
(è
throws
 
Exû±iÚ
 {

101 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

104 
fš®
 
numEÁr›s
 = 1000;

105 
fš®
 
ŒimmedR©io
 = .25;

106 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

108 
x
 = 0; x < 
numEÁr›s
; x++) {

109 ià(
x
 < 
ŒimmedR©io
 * 
numEÁr›s
) {

110 
’Œ›s
.
	`add
(
LogD©a
.
	`g‘Trimmed
(
x
));

112 
’Œ›s
.
	`add
(
	`g‘EÁry
(
x
));

116 
log
.
	`­³nd
(
’Œ›s
);

117 
ŒimM¬kAá”Wr™e
 = (è(
numEÁr›s
 * 
ŒimmedR©io
);

118 
	`as£¹Th©
(
log
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
ŒimM¬kAá”Wr™e
);

119 
	}
}

121 @
Te¡


122 
public
 
	$‹¡RªgeWr™eAá”P»fixTrim
(è
throws
 
Exû±iÚ
 {

125 
S”v”CÚ‹xt
 
sc
 = 
	`g‘CÚ‹xt
();

126 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

127 
fš®
 
ŒimM¬k
 = 1000;

128 
fš®
 
ŒimOv”Ïp
 = 100;

129 
fš®
 
numEÁr›s
 = 200;

130 
log
.
	`´efixTrim
(
ŒimM¬k
);

132 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

133 
x
 = 0; x < 
numEÁr›s
; x++) {

134 
add»ss
 = 
ŒimM¬k
 - 
ŒimOv”Ïp
 + 
x
;

135 
’Œ›s
.
	`add
(
	`g‘EÁry
(
add»ss
));

138 
log
.
	`­³nd
(
’Œ›s
);

140 
SŒ—mLog
 
log2
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

141 
Li¡
<
LogD©a
> 
»adEÁr›s
 = 
	`»adRªge
(0L, 
ŒimM¬k
 - 
ŒimOv”Ïp
 + 
numEÁr›s
, 
log2
);

143 
Li¡
<
LogD©a
> 
nÙTrimmed
 = 
Ãw
 
A¼ayLi¡
<>();

144 
LogD©a
 
’Œy
 : 
»adEÁr›s
) {

145 ià(!
’Œy
.
	`isTrimmed
()) {

146 
nÙTrimmed
.
	`add
(
’Œy
);

150 
	`as£¹Th©
((è
nÙTrimmed
.
	`size
()).
	`isEqu®To
(
numEÁr›s
 - 
ŒimOv”Ïp
 - 1);

151 
	}
}

153 @
Te¡


154 
public
 
	$badRªgeWr™e
(è
throws
 
Exû±iÚ
 {

155 
S”v”CÚ‹xt
 
sc
 = 
	`g‘CÚ‹xt
();

156 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

158 
Li¡
<
LogD©a
> 
ÏrgeRªge
 = 
Ãw
 
A¼ayLi¡
<>();

159 
Li¡
<
LogD©a
> 
nÚSequ’tŸlRªge
 = 
Ãw
 
A¼ayLi¡
<>();

160 
fš®
 
numSegm’ts
 = 3;

161 
fš®
 
skG­
 = 10;

162 
fš®
 
numEÁr›s
 = 
numSegm’ts
 * 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
;

164 
add»ss
 = 0;‡dd»s < 
numEÁr›s
;‡ddress++) {

165 
ÏrgeRªge
.
	`add
(
	`g‘EÁry
(
add»ss
));

166 ià(
add»ss
 % 
skG­
 == 0) {

167 
nÚSequ’tŸlRªge
.
	`add
(
	`g‘EÁry
(
add»ss
));

171 
SŒšg
 
logDœ
 = 
sc
.
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

172 
Fe
 
fe
 = 
Ãw
 
	`Fe
(
logDœ
);

173 
logSize
 = 
FeUts
.
	`sizeOfDœeùÜy
(
fe
);

176 
	`as£¹Th©ThrownBy
((è-> 
log
.
	`­³nd
(
ÏrgeRªge
))

177 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

178 
log
.
	`sync
(
Œue
);

181 
	`as£¹Th©ThrownBy
((è-> 
log
.
	`­³nd
(
nÚSequ’tŸlRªge
))

182 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

183 
log
.
	`sync
(
Œue
);

186 
logSize2
 = 
FeUts
.
	`sizeOfDœeùÜy
(
fe
);

187 
	`as£¹Th©
(
logSize2
).
	`isEqu®To
(
logSize
);

188 
	}
}

190 @
Te¡


191 
public
 
	$‹¡RªgeOv”wr™e
(è
throws
 
Exû±iÚ
 {

192 
S”v”CÚ‹xt
 
sc
 = 
	`g‘CÚ‹xt
();

193 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

194 
fš®
 
numI‹r
 = 500;

196 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

197 
x
 = 0; x < 
numI‹r
; x++) {

198 
’Œ›s
.
	`add
(
	`g‘EÁry
(
x
));

201 
SŒšg
 
logDœ
 = 
sc
.
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

202 
Fe
 
fe
 = 
Ãw
 
	`Fe
(
logDœ
);

204 
log
.
	`­³nd
(
’Œ›s
);

205 
log
.
	`sync
(
Œue
);

207 
As£¹iÚs
.
	`as£¹Th©Exû±iÚOfTy³
(
Ov”wr™eExû±iÚ
.
şass
)

208 .
	`isThrownBy
((è-> 
log
.
	`­³nd
(
’Œ›s
));

209 
	}
}

211 @
Te¡


212 
public
 
	$wr™šgTrimmedEÁr›s
(è
throws
 
Exû±iÚ
 {

213 
S”v”CÚ‹xt
 
sc
 = 
	`g‘CÚ‹xt
();

214 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
sc
, 
çl£
);

216 
fš®
 
ŒimM¬k
 = 400;

217 
fš®
 
numEÁr›s
 = 
ŒimM¬k
 + 200;

218 
log
.
	`´efixTrim
(
ŒimM¬k
);

220 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

221 
x
 = 0; x < 
numEÁr›s
; x++) {

222 
’Œ›s
.
	`add
(
LogD©a
.
	`g‘Trimmed
(
x
));

225 
SŒšg
 
logDœ
 = 
sc
.
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

226 
Fe
 
fe
 = 
Ãw
 
	`Fe
(
logDœ
);

227 
logSize
 = 
FeUts
.
	`sizeOfDœeùÜy
(
fe
);

228 
log
.
	`­³nd
(
’Œ›s
);

229 
log
.
	`sync
(
Œue
);

230 
logSize2
 = 
FeUts
.
	`sizeOfDœeùÜy
(
fe
);

231 
	`as£¹Th©
(
logSize2
).
	`isEqu®To
(
logSize
);

232 
	}
}

237 
	gLi¡
<
	gLogD©a
> 
	$»adRªge
(
a
, 
b
, 
SŒ—mLog
 
log
) {

238 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

239 
x
 = 
a
; x < 
b
; x++) {

240 
’Œ›s
.
	`add
(
log
.
	`»ad
(
x
));

242  
’Œ›s
;

243 
	}
}

245 
LogD©a
 
	$g‘EÁry
(
x
) {

246 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

247 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

248 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

249 
LogD©a
 
ld
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
);

250 
ld
.
	`£tGlob®Add»ss
((è
x
);

251  
ld
;

252 
	}
}

254 @
Te¡


255 
public
 
	$‹¡Ov”wr™eExû±iÚ
() {

256 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

257 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

258 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

259 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

260 
add»ss0
 = 0;

261 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

263 
	`as£¹Th©ThrownBy
((è-> 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
)))

264 .
	`isIn¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

265 
	}
}

267 @
Te¡


268 
public
 
	$‹¡R—dšgUnknownAdd»ss
() {

269 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

270 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

271 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

272 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

274 
add»ss0
 = 0;

275 
add»ss1
 = 1;

276 
add»ss2
 = 2;

278 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

279 
log
.
	`­³nd
(
add»ss2
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

280 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss1
)).
	`isNuÎ
();

281 
	}
}

283 @
Te¡


284 
public
 
	$‹¡SŒ—mLogBadChecksum
() {

289 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
Œue
);

290 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

291 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

292 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

293 
add»ss0
 = 0;

294 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

296 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
).
	`g‘Paylßd
(
nuÎ
)).
	`isEqu®To
(
¡»amEÁry
);

298 
log
.
	`şo£
();

301 
	`as£¹Th©ThrownBy
((è-> 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
))

302 .
	`isIn¡ªûOf
(
RuÁimeExû±iÚ
.
şass
);

303 
	}
}

305 @
Te¡


306 
public
 
	$‹¡SŒ—mLogD©aCÜru±iÚ
(è
throws
 
Exû±iÚ
 {

310 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

311 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

312 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

313 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

314 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

316 
add»ss0
 = 0;

317 
add»ss1
 = 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 + 1L;

318 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

319 
log
.
	`­³nd
(
add»ss1
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

321 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
).
	`g‘Paylßd
(
nuÎ
)).
	`isEqu®To
(
¡»amEÁry
);

322 
log
.
	`şo£
();

324 
fš®
 
OVERWRITE_BYTES
 = 4;

327 
SŒšg
 
logFeP©h1
 = 
logDœ
 + 
Fe
.
£·¿tÜ
 + 0 + ".log";

328 
SŒšg
 
logFeP©h2
 = 
logDœ
 + 
Fe
.
£·¿tÜ
 + 1 + ".log";

329 
RªdomAcûssFe
 
fe1
 = 
Ãw
 
	`RªdomAcûssFe
(
logFeP©h1
, "rw");

330 
RªdomAcûssFe
 
fe2
 = 
Ãw
 
	`RªdomAcûssFe
(
logFeP©h2
, "rw");

331 
By‹Bufãr
 
m‘aD©aBuf
 = By‹Bufãr.
	`®loÿ‹
(
METADATA_SIZE
);

332 
fe1
.
	`g‘ChªÃl
().
	`»ad
(
m‘aD©aBuf
);

333 
m‘aD©aBuf
.
	`æ
();

335 
M‘ad©a
 
m‘ad©a
 = M‘ad©a.
	`·r£From
(
m‘aD©aBuf
.
	`¬¿y
());

337 
fš®
 
off£t
 = 
METADATA_SIZE
 + 
m‘ad©a
.
	`g‘L’gth
(è+ 
OVERWRITE_BYTES
;

340 
fe2
.
	`£ek
(
off£t
);

341 
fe2
.
	`wr™eIÁ
(
OVERWRITE_BYTES
);

342 
fe2
.
	`şo£
();

344 
	`as£¹Th©ThrownBy
((è-> 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
))

345 .
	`isIn¡ªûOf
(
D©aCÜru±iÚExû±iÚ
.
şass
);

346 
	}
}

348 @
Te¡


349 
public
 
	$muÉiTh»adedR—dWr™e
(è
throws
 
Exû±iÚ
 {

350 
SŒšg
 
logDœ
 = 
	`g‘DœP©h
();

351 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

353 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

354 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

355 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

357 
fš®
 
num_th»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

358 
fš®
 
num_’Œ›s
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

360 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

361 
ba£
 = 
th»adNumb”
 * 
num_’Œ›s
;

362 
i
 = 
ba£
; i < ba£ + 
num_’Œ›s
; i++) {

363 
add»ss
 = (è
i
;

364 
log
.
	`­³nd
(
add»ss
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

368 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

371 
x
 = 0; x < 
num_’Œ›s
 * 
num_th»ads
; x++) {

372 
add»ss
 = (è
x
;

373 
LogD©a
 
d©a
 = 
log
.
	`»ad
(
add»ss
);

374 
by‹
[] 
by‹s
 = (by‹[]è
d©a
.
	`g‘Paylßd
(
nuÎ
);

375 
	`as£¹Th©
(
by‹s
).
	`isEqu®To
(
¡»amEÁry
);

377 
	}
}

379 @
	gTe¡


380 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

381 
public
 
	$‹¡Sync
(è
throws
 
Exû±iÚ
 {

382 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

383 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

384 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

385 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

386 
£g1
 = 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 * 0 + 1;

387 
£g2
 = 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 * 1 + 1;

388 
£g3
 = 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 * 2 + 1;

390 
log
.
	`­³nd
(
£g1
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

391 
log
.
	`­³nd
(
£g2
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

392 
log
.
	`­³nd
(
£g3
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

394 
	`as£¹Th©
(
log
.
	`g‘ChªÃlsToSync
().
	`size
()).
	`isEqu®To
(3);

396 
log
.
	`sync
(
Œue
);

398 
	`as£¹Th©
(
log
.
	`g‘ChªÃlsToSync
().
	`size
()).
	`isEqu®To
(0);

399 
	}
}

401 
´iv©e
 
	$wr™eToLog
(
SŒ—mLog
 
log
, 
add»ss
) {

402 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

403 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

404 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

405 
log
.
	`­³nd
(
add»ss
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

406 
	}
}

408 @
Te¡


409 
public
 
	$‹¡Wr™šgFeH—d”
(è
throws
 
Exû±iÚ
 {

410 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

411 
	`wr™eToLog
(
log
, 0L);

412 
log
.
	`sync
(
Œue
);

413 
SŒ—mLogFes
 
log2
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

414 
	`wr™eToLog
(
log2
, 1L);

415 
log2
.
	`sync
(
Œue
);

416 
SŒ—mLogFes
 
log3
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

417 
	`as£¹Th©
(
log3
.
	`»ad
(1L)).
	`isNÙNuÎ
();

418 
	}
}

420 @
Te¡


421 
public
 
	$‹¡G‘Glob®Ta
() {

422 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

424 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
Add»ss
.
NON_ADDRESS
);

427 
fš®
 
£gm’ts
 = 3;

428 
Ï¡Add»ss
 = 
£gm’ts
 * 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
;

429 
x
 = 0; x <ğ
Ï¡Add»ss
; x++){

430 
	`wr™eToLog
(
log
, 
x
);

431 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
x
);

435 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

436 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
Ï¡Add»ss
);

439 
fš®
 
D–
 = 5;

440 
x
 = 
Ï¡Add»ss
 + 1; x <ğÏ¡Add»s + 
D–
; x++){

441 
	`wr™eToLog
(
log
, 
x
);

442 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
x
);

446 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

447 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
Ï¡Add»ss
 + 
D–
);

448 
	}
}

450 @
Te¡


451 
public
 
	$‹¡P»fixTrim
() {

452 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

453 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

456 
fš®
 
numSegm’ts
 = 50;

457 
x
 = 0; x < 
numSegm’ts
 * 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
; x++) {

458 
	`wr™eToLog
(
log
, 
x
);

461 
Fe
 
logs
 = 
Ãw
 
	`Fe
(
logDœ
);

463 
	`as£¹Th©
((è
logs
.
	`li¡
().
Ëngth
).
	`isEqu®To
(
numSegm’ts
);

465 
fš®
 
’dSegm’t
 = 25;

466 
ŒimAdd»ss
 = 
’dSegm’t
 * 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 + 1;

469 
S‘
<
Segm’tHªdË
> 
ŒimmedHªdËs
 = 
Ãw
 
HashS‘
<>();

470 
Segm’tHªdË
 
sh
 : 
log
.
	`g‘O³nSegm’tHªdËs
()) {

471 ià(
sh
.
	`g‘Segm’t
(è< 
’dSegm’t
) {

472 
ŒimmedHªdËs
.
	`add
(
sh
);

476 
log
.
	`´efixTrim
(
ŒimAdd»ss
);

477 
log
.
	`com·ù
();

480 
	`as£¹Th©
(
log
.
	`g‘O³nSegm’tHªdËs
().
	`size
()).
	`isEqu®To
((è
’dSegm’t
);

483 
SŒšg
[] 
aá”TrimFes
 = 
logs
.
	`li¡
();

484 
	`as£¹Th©
(
aá”TrimFes
).
	`hasSize
((è(
numSegm’ts
 - 
’dSegm’t
));

486 
S‘
<
SŒšg
> 
feNames
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
	`asLi¡
(
aá”TrimFes
));

487 
x
 = 
’dSegm’t
 + 1; x < 
numSegm’ts
; x++) {

488 
SŒšg
 
logFe
 = 
LÚg
.
	`toSŒšg
(
x
) + ".log";

489 
	`as£¹Th©
(
feNames
).
	`cÚšs
(
logFe
);

494 
log
.
	`´efixTrim
(
ŒimAdd»ss
);

496 
ŒimmedExû±iÚs
 = 0;

499 
x
 = 0; x < 
numSegm’ts
 * 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
; x++) {

500 
ILogD©a
 
logD©a
 = 
log
.
	`»ad
(
x
);

501 if(
logD©a
.
	`isTrimmed
()) {

502 
ŒimmedExû±iÚs
++;

507 
Segm’tHªdË
 
sh
 : 
ŒimmedHªdËs
) {

508 
	`as£¹Th©
(
sh
.
	`g‘Wr™eChªÃl
().
	`isO³n
()).
	`isF®£
();

512 
	`as£¹Th©
(
ŒimmedExû±iÚs
).
	`isEqu®To
(
ŒimAdd»ss
 + 1);

513 
	}
}

515 @
Te¡


516 
public
 
	$‹¡P»fixTrimAndS¹Up
() {

517 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

518 
log
.
	`´efixTrim
(
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 / 2);

519 
log
.
	`com·ù
();

520 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

521 
fš®
 
midSegm’tAdd»ss
 = 
RECORDS_PER_LOG_FILE
 + 5;

522 
log
.
	`´efixTrim
(
midSegm’tAdd»ss
);

523 
log
.
	`com·ù
();

524 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

526 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
midSegm’tAdd»ss
);

527 
	`as£¹Th©
(
log
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
midSegm’tAdd»ss
 + 1);

528 
	}
}

530 @
Te¡


531 
public
 
	$‹¡P»fixTrimAá”Re¡¬t
() {

532 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

533 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

535 
fš®
 
numSegm’ts
 = 3;

536 
x
 = 0; x < 
RECORDS_PER_LOG_FILE
 * 
numSegm’ts
; x++) {

537 
	`wr™eToLog
(
log
, 
x
);

540 
fš®
 
ŒimM¬k
 = 
RECORDS_PER_LOG_FILE
 * 2 + 100;

541 
log
.
	`´efixTrim
(
ŒimM¬k
);

542 
log
.
	`şo£
();

544 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

545 
log
.
	`com·ù
();

547 
Fe
 
logs
 = 
Ãw
 
	`Fe
(
logDœ
);

548 
fš®
 
numFesLeá
 = 1;

549 
	`as£¹Th©
(
logs
.
	`li¡
()).
	`hasSize
(
numFesLeá
);

550 
	}
}

556 @
Te¡


557 
public
 
	$‹¡Re£tSŒ—mLog
() {

558 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

559 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

561 
fš®
 
numSegm’ts
 = 3;

562 
x
 = 0; x < 
RECORDS_PER_LOG_FILE
 * 
numSegm’ts
; x++) {

563 
	`wr™eToLog
(
log
, 
x
);

565 
fš®
 
fesToBeTrimmed
 = 1;

566 
log
.
	`´efixTrim
(
RECORDS_PER_LOG_FILE
 * 
fesToBeTrimmed
);

567 
log
.
	`com·ù
();

569 
Fe
 
logsDœ
 = 
Ãw
 
	`Fe
(
logDœ
);

571 
fš®
 
ex³ùedFesBefÜeRe£t
 = (è(
numSegm’ts
 - 
fesToBeTrimmed
);

572 
fš®
 
glob®TaBefÜeRe£t
 = (
RECORDS_PER_LOG_FILE
 * 
numSegm’ts
) - 1;

573 
fš®
 
ŒimM¬kBefÜeRe£t
 = 
RECORDS_PER_LOG_FILE
 * 
fesToBeTrimmed
 + 1;

574 
	`as£¹Th©
(
logsDœ
.
	`li¡
()).
	`hasSize
(
ex³ùedFesBefÜeRe£t
);

575 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
glob®TaBefÜeRe£t
);

576 
	`as£¹Th©
(
log
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
ŒimM¬kBefÜeRe£t
);

578 
log
.
	`»£t
();

580 
fš®
 
ex³ùedFesAá”Re£t
 = 0;

581 
fš®
 
glob®TaAá”Re£t
 = 
Add»ss
.
NON_ADDRESS
;

582 
fš®
 
ŒimM¬kAá”Re£t
 = 0L;

583 
	`as£¹Th©
(
logsDœ
.
	`li¡
()).
	`hasSize
(
ex³ùedFesAá”Re£t
);

584 
	`as£¹Th©
(
log
.
	`g‘LogTa
()).
	`isEqu®To
(
glob®TaAá”Re£t
);

585 
	`as£¹Th©
(
log
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
ŒimM¬kAá”Re£t
);

586 
	}
}

588 @
Te¡


589 
public
 
	$·¹ŸlH—d”M‘ad©aTe¡
(è
throws
 
Exû±iÚ
 {

590 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

591 
SŒšg
 
logFeP©h
 = 
logDœ
 + 
Fe
.
£·¿tÜ
 + 0 + ".log";

593 
Fe
 
dœ
 = 
Ãw
 
	`Fe
(
logDœ
);

594 
dœ
.
	`mkdœ
();

595 
RªdomAcûssFe
 
logFe
 = 
Ãw
 
	`RªdomAcûssFe
(
logFeP©h
, "rw");

597 
Ty³s
.
LogH—d”
 
h—d”
 = Ty³s.LogH—d”.
	`ÃwBud”
()

598 .
	`£tV”siÚ
(
SŒ—mLogFes
.
VERSION
)

599 .
	`£tV”ifyChecksum
(
çl£
)

600 .
	`bud
();

603 
By‹Bufãr
 
buf
 = 
SŒ—mLogFes
.
	`g‘By‹BufãrW™hM‘aD©a
(
h—d”
);

604 
buf
.
	`lim™
(
SŒ—mLogFes
.
METADATA_SIZE
 - 1);

605 
logFe
.
	`g‘ChªÃl
().
	`wr™e
(
buf
);

606 
logFe
.
	`şo£
();

609 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

610 
add»ss0
 = 0;

611 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
)).
	`isNuÎ
();

612 
log
.
	`şo£
();

613 
	}
}

615 @
Te¡


616 
public
 
	$·¹ŸlH—d”Te¡
(è
throws
 
Exû±iÚ
 {

617 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

618 
SŒšg
 
logFeP©h
 = 
logDœ
 + 
Fe
.
£·¿tÜ
 + 0 + ".log";

620 
Fe
 
dœ
 = 
Ãw
 
	`Fe
(
logDœ
);

621 
dœ
.
	`mkdœ
();

622 
RªdomAcûssFe
 
logFe
 = 
Ãw
 
	`RªdomAcûssFe
(
logFeP©h
, "rw");

624 
Ty³s
.
LogH—d”
 
h—d”
 = Ty³s.LogH—d”.
	`ÃwBud”
()

625 .
	`£tV”siÚ
(
SŒ—mLogFes
.
VERSION
)

626 .
	`£tV”ifyChecksum
(
çl£
)

627 .
	`bud
();

630 
By‹Bufãr
 
buf
 = 
SŒ—mLogFes
.
	`g‘By‹BufãrW™hM‘aD©a
(
h—d”
);

631 
buf
.
	`lim™
(buf.
	`ÿ·c™y
() - 1);

632 
logFe
.
	`g‘ChªÃl
().
	`wr™e
(
buf
);

633 
logFe
.
	`şo£
();

635 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

636 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

637 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

638 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

640 
add»ss0
 = 0;

641 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

642 
log
.
	`şo£
();

646 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

647 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
).
	`g‘Paylßd
(
nuÎ
)).
	`isEqu®To
(
¡»amEÁry
);

648 
	}
}

650 @
Te¡


651 
public
 
	$·¹ŸlEÁryTe¡
(è
throws
 
Exû±iÚ
 {

652 
SŒ—mLog
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

655 
add»ss0
 = 0;

656 
log
.
	`»ad
(
add»ss0
);

657 
log
.
	`şo£
();

660 
fš®
 
£rŸlizedEÁrySize
 = 100;

661 
by‹
[] 
’ŒyBy‹s
 = 
Ãw
 by‹[
£rŸlizedEÁrySize
];

662 
M‘ad©a
 
m‘ad©a
 = M‘ad©a.
	`ÃwBud”
()

663 .
	`£tPaylßdChecksum
(
Checksum
.
	`g‘Checksum
(
£rŸlizedEÁrySize
))

664 .
	`£tL’gthChecksum
(
Checksum
.
	`g‘Checksum
(
’ŒyBy‹s
.
Ëngth
))

665 .
	`£tL’gth
(
’ŒyBy‹s
.
Ëngth
)

666 .
	`bud
();

668 
By‹Bufãr
 
’ŒyBuf
 = By‹Bufãr.
	`®loÿ‹
(
’ŒyBy‹s
.
Ëngth
 + 
m‘ad©a
.
	`g‘S”ŸlizedSize
());

669 
’ŒyBuf
.
	`put
(
m‘ad©a
.
	`toBy‹A¼ay
());

670 
’ŒyBuf
.
	`put
(
’ŒyBy‹s
);

671 
’ŒyBuf
.
	`æ
();

673 
SŒšg
 
logDœ
 = 
	`g‘CÚ‹xt
().
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

674 
SŒšg
 
logFeP©h
 = 
logDœ
 + 
Fe
.
£·¿tÜ
 + 0 + ".log";

676 
RªdomAcûssFe
 
logFe
 = 
Ãw
 
	`RªdomAcûssFe
(
logFeP©h
, "rw");

679 
’ŒyBuf
.
	`lim™
ÓÁryBuf.
	`ÿ·c™y
() - 1);

680 
Sy¡em
.
out
.
	`´šn
("ÿ°" + 
’ŒyBuf
.
	`ÿ·c™y
());

681 
Sy¡em
.
out
.
	`´šn
("lim™ " + 
’ŒyBuf
.
	`lim™
());

683 
’d
 = 
logFe
.
	`g‘ChªÃl
().
	`size
();

684 
logFe
.
	`g‘ChªÃl
().
	`pos™iÚ
(
’d
);

685 
Sy¡em
.
out
.
	`´šn
("pos™iÚ " + 
logFe
.
	`g‘ChªÃl
().
	`pos™iÚ
());

686 
by‹sWr™‹n
 = 
logFe
.
	`g‘ChªÃl
().
	`wr™e
(
’ŒyBuf
);

687 
Sy¡em
.
out
.
	`´šn
("by‹sWr™‹À" + 
by‹sWr™‹n
);

688 
Sy¡em
.
out
.
	`´šn
("pos™iÚ " + 
logFe
.
	`g‘ChªÃl
().
	`pos™iÚ
());

689 
logFe
.
	`şo£
();

692 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

693 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
)).
	`isNuÎ
();

696 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

697 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

698 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

699 
log
.
	`­³nd
(
add»ss0
, 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
));

700 
log
.
	`şo£
();

702 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

703 
	`as£¹Th©
(
log
.
	`»ad
(
add»ss0
).
	`g‘Paylßd
(
nuÎ
)).
	`isEqu®To
(
¡»amEÁry
);

704 
	}
}

706 @
Te¡


707 
public
 
	$e¡im©eSizeTe¡
(è
throws
 
IOExû±iÚ
 {

710 
Fe
 
·»ÁDœ
 = 
com
.
googË
.
commÚ
.
io
.
Fes
.
	`ü—‹TempDœ
();

711 
Fe
 
chdDœ
 = 
Ãw
 
	`Fe
(
·»ÁDœ
.
	`g‘AbsŞu‹P©h
(è+ Fe.
£·¿tÜ
 + "logs");

713 
chdDœ
.
	`mkdœ
();

715 
RªdomAcûssFe
 
·»ÁDœFe
 = 
Ãw
 
	`RªdomAcûssFe
(
·»ÁDœ
.
	`g‘AbsŞu‹P©h
()

716 + 
Fe
.
£·¿tÜ
 + "file1", "rw");

718 
RªdomAcûssFe
 
chdDœFe
 = 
Ãw
 
	`RªdomAcûssFe
(
chdDœ
.
	`g‘AbsŞu‹P©h
()

719 + 
Fe
.
£·¿tÜ
 + "file2", "rw");

721 
fš®
 
·»ÁDœFePaylßdSize
 = 4300;

722 
fš®
 
chdDœFePaylßdSize
 = 3200;

724 
by‹
[] 
·»ÁDœFePaylßd
 = 
Ãw
 by‹[
·»ÁDœFePaylßdSize
];

725 
by‹
[] 
chdDœFePaylßd
 = 
Ãw
 by‹[
chdDœFePaylßdSize
];

727 
·»ÁDœFe
.
	`wr™e
(
·»ÁDœFePaylßd
);

728 
chdDœFe
.
	`wr™e
(
chdDœFePaylßd
);

730 
·»ÁDœFe
.
	`şo£
();

731 
chdDœFe
.
	`şo£
();

733 
·»ÁSize
 = 
SŒ—mLogFes
.
	`e¡im©eSize
(
·»ÁDœ
.
	`toP©h
());

734 
chdDœSize
 = 
SŒ—mLogFes
.
	`e¡im©eSize
(
chdDœ
.
	`toP©h
());

736 
	`as£¹Th©
(
·»ÁSize
).
	`isEqu®To
(
·»ÁDœFePaylßdSize
 + 
chdDœFePaylßdSize
);

737 
	`as£¹Th©
(
chdDœSize
).
	`isEqu®To
(
chdDœFePaylßdSize
);

738 
	}
}

	@test/src/test/java/org/corfudb/infrastructure/log/StreamLogWithRankedAddressSpaceTest.java

5 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

10 
impÜt
 
	gjava
.
	gio
.
	gFe
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aOuŒªkedExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gV®ueAdİ‹dExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

25 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

31 
public
 cÏs 
	cSŒ—mLogW™hRªkedAdd»ssS·ûTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

33 
´iv©e
 
fš®
 
	mRECORDS_TO_WRITE
 = 10;

34 @
	mTe¡


35 @
IgnÜe


36 
public
 
	$‹¡Com·ù
(è
throws
 
Exû±iÚ
 {

37 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

39 
add»ss
 = 0;

40 
x
 = 0; x < 
RECORDS_TO_WRITE
; x++) {

41 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "Paylßd", 
x
);

43 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

44 
size1
 = 
Ãw
 
	`Fe
(
log
.
	`g‘Segm’tHªdËFÜAdd»ss
(
add»ss
).
	`g‘FeName
()).
	`Ëngth
();

45 
log
.
	`com·ù
();

46 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

47 
size2
 = 
Ãw
 
	`Fe
(
log
.
	`g‘Segm’tHªdËFÜAdd»ss
(
add»ss
).
	`g‘FeName
()).
	`Ëngth
();

48 
	`as£¹Equ®s
(
v®ue1
.
	`g‘Rªk
(), 
v®ue2
.getRank());

49 
	`as£¹NÙEqu®s
(
size2
, 
size1
);

52 @
Te¡


53 
public
 
	$‹¡High”Rªk
() {

54 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

55 
add»ss
 = 0;

56 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-1", 1);

57 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

58 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

59 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-2", 2);

60 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

61 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-2"));

62 
log
.
	`şo£
();

63 
	}
}

65 @
Te¡


66 
public
 
	$‹¡Low”Rªk
() {

67 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

68 
add»ss
 = 0;

69 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-1", 2);

70 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

71 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

72 
Œy
 {

73 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-2", 1);

74 
	`ç
();

75 } 
	`ÿtch
 (
D©aOuŒªkedExû±iÚ
 
e
) {

78 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

79 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

80 
log
.
	`şo£
();

81 
	}
}

83 @
Te¡


84 
public
 
	$‹¡High”RªkAgaš¡Prİo§l
() {

85 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

86 
add»ss
 = 0;

87 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-1", 1);

88 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

89 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

90 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-2", 2);

91 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

92 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-2"));

93 
log
.
	`şo£
();

94 
	}
}

96 @
Te¡


97 
public
 
	$‹¡Low”RªkAgaš¡Prİo§l
() {

98 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

99 
add»ss
 = 0;

100 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-1", 2);

101 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

102 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

103 
Œy
 {

104 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-2", 1);

105 
	`ç
();

106 } 
	`ÿtch
 (
D©aOuŒªkedExû±iÚ
 
e
) {

109 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

110 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

111 
log
.
	`şo£
();

112 
	}
}

114 @
Te¡


115 
public
 
	$‹¡Prİo§lW™hHigh”RªkAgaš¡D©a
() {

116 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

117 
add»ss
 = 0;

118 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-1", 1);

119 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

120 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

121 
Œy
 {

122 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-2", 2);

123 
	`ç
();

124 } 
	`ÿtch
 (
V®ueAdİ‹dExû±iÚ
 
e
) {

125 
LogD©a
 
logD©a
 = 
e
.
	`g‘R—dRe¥Ú£
().
	`g‘Add»s£s
().
	`g‘
(0l);

126 
	`as£¹True
(
Ãw
 
	`SŒšg
(
logD©a
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

128 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

129 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

130 
log
.
	`şo£
();

131 
	}
}

134 @
Te¡


135 
public
 
	$‹¡Prİo§lW™hLow”RªkAgaš¡D©a
() {

136 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

137 
add»ss
 = 0;

138 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-1", 2);

139 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

140 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

141 
Œy
 {

142 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-2", 1);

143 
	`ç
();

144 } 
	`ÿtch
 (
D©aOuŒªkedExû±iÚ
 
e
) {

147 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

148 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

149 
log
.
	`şo£
();

150 
	}
}

153 @
Te¡


154 
public
 
	$‹¡Prİo§lsHigh”Rªk
() {

155 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

156 
add»ss
 = 0;

157 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-1", 1);

158 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

159 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

160 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-2", 2);

161 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

162 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-2"));

163 
log
.
	`şo£
();

164 
	}
}

166 @
Te¡


167 
public
 
	$‹¡Prİo§lsLow”Rªk
() {

168 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

169 
add»ss
 = 0;

170 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-1", 2);

171 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

172 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

173 
Œy
 {

174 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
RANK_ONLY
, "v-2", 1);

175 
	`ç
();

176 } 
	`ÿtch
 (
D©aOuŒªkedExû±iÚ
 
e
) {

179 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

180 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

181 
log
.
	`şo£
();

182 
	}
}

184 @
Te¡


185 
public
 
	$checkPrİo§lIsIdempÙ’t
() {

186 
SŒ—mLogFes
 
log
 = 
Ãw
 
	`SŒ—mLogFes
(
	`g‘CÚ‹xt
(), 
çl£
);

187 
add»ss
 = 0;

188 
IM‘ad©a
.
D©aRªk
 
§meRªk
 = 
Ãw
 IM‘ad©a.
	`D©aRªk
(1);

189 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-1", 
§meRªk
);

190 
LogD©a
 
v®ue1
 = 
log
.
	`»ad
(
add»ss
);

191 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue1
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

192 
	`wr™eToLog
(
log
, 
add»ss
, 
D©aTy³
.
DATA
, "v-1", 
§meRªk
);

193 
LogD©a
 
v®ue2
 = 
log
.
	`»ad
(
add»ss
);

194 
	`as£¹True
(
Ãw
 
	`SŒšg
(
v®ue2
.
	`g‘D©a
()).
	`cÚšs
("v-1"));

195 
	}
}

197 
´iv©e
 
	$wr™eToLog
(
SŒ—mLog
 
log
, 
add»ss
, 
D©aTy³
 
d©aTy³
, 
SŒšg
 
·ylßd
, 
¿nk
) {

198 
this
.
	`wr™eToLog
(
log
, 
add»ss
, 
d©aTy³
, 
·ylßd
, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(
¿nk
));

199 
	}
}

201 
´iv©e
 
	$wr™eToLog
(
SŒ—mLog
 
log
, 
add»ss
, 
D©aTy³
 
d©aTy³
, 
SŒšg
 
·ylßd
, 
IM‘ad©a
.
D©aRªk
 
¿nk
) {

202 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

203 
by‹
[] 
¡»amEÁry
 = 
·ylßd
.
	`g‘By‹s
();

204 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

205 
LogD©a
 
d©a
 = 
Ãw
 
	`LogD©a
(
d©aTy³
, 
b
);

206 
d©a
.
	`£tRªk
(
¿nk
);

207 
log
.
	`­³nd
(
add»ss
, 
d©a
);

208 
	}
}

210 
´iv©e
 
SŒšg
 
	$g‘DœP©h
() {

211  
PARAMETERS
.
TEST_TEMP_DIR
 + 
Fe
.
£·¿tÜ
;

212 
	}
}

214 
´iv©e
 
S”v”CÚ‹xt
 
	$g‘CÚ‹xt
() {

215 
SŒšg
 
·th
 = 
	`g‘DœP©h
();

216  
Ãw
 
	`S”v”CÚ‹xtBud”
()

217 .
	`£tLogP©h
(
·th
)

218 .
	`£tMemÜy
(
çl£
)

219 .
	`bud
();

220 
	}
}

	@test/src/test/java/org/corfudb/integration/AbstractIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	glombok
.
	gS‘‹r
;

8 
impÜt
 
	glombok
.
	gex³rim’l
.
	gAcûssÜs
;

9 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

10 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

18 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

20 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

21 
impÜt
 
	gjava
.
	gio
.
	gFe
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—m
;

24 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

25 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

26 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

27 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

28 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSnd¬dO³nO±iÚ
;

29 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

30 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

31 
impÜt
 
	gjava
.
	gut
.
	gPrİ”t›s
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

35 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

36 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

42 @
Slf4j


43 
public
 cÏs 
	cAb¡¿ùIT
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

44 
fš®
 
SŒšg
 
	mDEFAULT_HOST
 = "localhost";

45 
fš®
 
	mDEFAULT_PORT
 = 9000;

46 
fš®
 
SŒšg
 
	mDEFAULT_ENDPOINT
 = 
DEFAULT_HOST
 + ":" + 
DEFAULT_PORT
;

48 
fš®
 
SŒšg
 
	mCORFU_PROJECT_DIR
 = 
Ãw
 
Fe
("..").
g‘AbsŞu‹P©h
(è+ Fe.
£·¿tÜ
;

49 
fš®
 
SŒšg
 
	mCORFU_LOG_PATH
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

51 
´iv©e
 
fš®
 
SŒšg
 
	mKILL_COMMAND
 = "pkill -9 -P ";

52 
´iv©e
 
fš®
 
SŒšg
 
	mFORCE_KILL_ALL_CORFU_COMMAND
 = "jps | grep CorfuServer|awk '{print $1}'| xargs kill -9";

54 
´iv©e
 
fš®
 
	mSHUTDOWN_RETRIES
 = 10;

55 
´iv©e
 
fš®
 
	mSHUTDOWN_RETRY_WAIT
 = 500;

57 
public
 
CÜfuRuÁime
 
	mruÁime
;

59 
public
 
fš®
 
Prİ”t›s
 
	mPROPERTIES
 = 
Ãw
 Properties();

61 
public
 
fš®
 
SŒšg
 
	mTEST_SEQUENCE_LOG_PATH
 = 
CORFU_LOG_PATH
 + 
Fe
.
£·¿tÜ
 + "testSequenceLog";

64 
public
 
	$Ab¡¿ùIT
() {

65 
CÜfuRuÁime
.
ov”rideG‘Rou‹rFunùiÚ
 = 
nuÎ
;

66 
CÏssLßd”
 
şassLßd”
 = 
Th»ad
.
	`cu¼’tTh»ad
().
	`g‘CÚ‹xtCÏssLßd”
();

67 
IÅutSŒ—m
 
šput
 = 
şassLßd”
.
	`g‘ResourûAsSŒ—m
("CorfuDB.properties");

69 
Œy
 {

70 
PROPERTIES
.
	`lßd
(
šput
);

71 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

72 
e
.
	`´štSckT¿û
();

81 @
BefÜe


82 
public
 
	$£tUp
(è
throws
 
Exû±iÚ
 {

83 
ruÁime
 = 
nuÎ
;

84 
	`fÜûShutdownAÎCÜfuS”v”s
();

85 
FeUts
.
	`ş—nDœeùÜy
(
Ãw
 
	`Fe
(
CORFU_LOG_PATH
));

86 
	}
}

93 @
Aá”


94 
public
 
	$ş—nUp
(è
throws
 
Exû±iÚ
 {

95 
	`fÜûShutdownAÎCÜfuS”v”s
();

96 ià(
ruÁime
 !ğ
nuÎ
) {

97 
ruÁime
.
	`shutdown
();

99 
	}
}

101 
public
 
SŒšg
 
	$g‘CÜfuS”v”LogP©h
(
SŒšg
 
ho¡
, 
pÜt
) {

102  
CORFU_LOG_PATH
 + 
Fe
.
£·¿tÜ
 + 
ho¡
 + "_" + 
pÜt
 + "_log";

103 
	}
}

111 
public
 
	$fÜûShutdownAÎCÜfuS”v”s
(è
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

112 
ProûssBud”
 
bud”
 = 
Ãw
 
	`ProûssBud”
();

113 
bud”
.
	`commªd
("sh", "-c", 
FORCE_KILL_ALL_CORFU_COMMAND
);

114 
Proûss
 
p
 = 
bud”
.
	`¡¬t
();

115 
p
.
	`wa™FÜ
();

116 
	}
}

126 
public
 
boŞ—n
 
	$shutdownCÜfuS”v”
(
Proûss
 
cÜfuS”v”Proûss
è
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

127 
»Œ›s
 = 
SHUTDOWN_RETRIES
;

128 
Œue
) {

129 
·»ÁPid
 = 
	`g‘Pid
(
cÜfuS”v”Proûss
);

131 
Li¡
<
LÚg
> 
pidLi¡
 = 
	`g‘ChdPIDs
(
·»ÁPid
);

132 
pidLi¡
.
	`add
(
·»ÁPid
);

134 
ProûssBud”
 
bud”
 = 
Ãw
 
	`ProûssBud”
();

135 
LÚg
 
pid
 : 
pidLi¡
) {

136 
bud”
.
	`commªd
("sh", "-c", 
KILL_COMMAND
 + 
pid
.
	`lÚgV®ue
());

137 
Proûss
 
p
 = 
bud”
.
	`¡¬t
();

138 
p
.
	`wa™FÜ
();

141 ià(
»Œ›s
 == 0) {

142  
çl£
;

145 ià(
cÜfuS”v”Proûss
.
	`isAlive
()) {

146 
»Œ›s
--;

147 
Th»ad
.
	`¦“p
(
SHUTDOWN_RETRY_WAIT
);

149  
Œue
;

152 
	}
}

154 
public
 
	$»¡¬tS”v”
(

155 
CÜfuRuÁime
 
cÜfuRuÁime
, 
SŒšg
 
’dpošt
è
throws
 
IÁ”ru±edExû±iÚ
 {

157 
cÜfuRuÁime
.
	`šv®id©eLayout
();

158 
RuÁimeLayout
 
ruÁimeLayout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

159 
Œy
 {

160 
ruÁimeLayout
.
	`g‘Ba£Cl›Á
(
’dpošt
).
	`»¡¬t
().
	`g‘
();

161 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 | 
IÁ”ru±edExû±iÚ
 
e
) {

162 
log
.
	`”rÜ
("E¼Ü: {}", 
e
);

168 
Œue
) {

169 ià(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()

170 =ğ(
ruÁimeLayout
.
	`g‘Layout
().
	`g‘Epoch
() + 1)) {

173 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

174 
cÜfuRuÁime
.
	`šv®id©eLayout
();

176 
	}
}

185 
public
 
wa™FÜLayoutChªge
(

186 
P»diÿ‹
<
Layout
> 
v”if›r
, 
CÜfuRuÁime
 
cÜfuRuÁime
è
throws
 
	gIÁ”ru±edExû±iÚ
 {

188 
	gcÜfuRuÁime
.
šv®id©eLayout
();

189 
Layout
 
	g»äeshedLayout
 = 
cÜfuRuÁime
.
g‘LayoutV›w
().
g‘Layout
();

191 
	gi
 = 0; i < 
	gPARAMETERS
.
	gNUM_ITERATIONS_MODERATE
; i++) {

192 ià(
	gv”if›r
.
‹¡
(
»äeshedLayout
)) {

195 
	gcÜfuRuÁime
.
šv®id©eLayout
();

196 
	g»äeshedLayout
 = 
cÜfuRuÁime
.
g‘LayoutV›w
().
g‘Layout
();

197 
	gTimeUn™
.
	gMILLISECONDS
.
¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
toMlis
());

199 
as£¹Th©
(
v”if›r
.
‹¡
(
»äeshedLayout
)).
isTrue
();

207 
public
 
wa™FÜ
(
Suµl›r
<
BoŞ—n
> 
suµl›r
è
throws
 
	gIÁ”ru±edExû±iÚ
 {

208 !
	gsuµl›r
.
g‘
()) {

209 
	gTimeUn™
.
	gMILLISECONDS
.
¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
toMlis
());

221 
´iv©e
 
	gLi¡
<
	gLÚg
> 
	$g‘ChdPIDs
 (
pid
) {

222 
Li¡
<
LÚg
> 
chdPIDs
 = 
Ãw
 
A¼ayLi¡
<>();

223 
Œy
 {

225 
ProûssBud”
 
bud”
 = 
Ãw
 
	`ProûssBud”
();

226 
bud”
.
	`commªd
("sh", "-c", "pg»°-P " + 
pid
);

227 
Proûss
 
p
 = 
bud”
.
	`¡¬t
();

228 
p
.
	`wa™FÜ
();

231 
Bufã»dR—d”
 
br
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`IÅutSŒ—mR—d”
(
p
.
	`g‘IÅutSŒ—m
()));

232 
SŒšg
 
lše
 = 
nuÎ
;

233 
SŒšg
 
´evious
 = 
nuÎ
;

234 (
lše
 = 
br
.
	`»adLše
()è!ğ
nuÎ
) {

235 ià(!
lše
.
	`equ®s
(
´evious
)) {

236 
´evious
 = 
lše
;

237 
chdPID
 = 
LÚg
.
	`·r£LÚg
(
lše
);

238 
chdPIDs
.
	`add
(
chdPID
);

243 
LÚg
 
chdPID
 : 
chdPIDs
) {

244 
Li¡
<
LÚg
> 
pidRecursive
 = 
	`g‘ChdPIDs
(
chdPID
.
	`lÚgV®ue
());

245 
chdPIDs
.
	`addAÎ
(
pidRecursive
);

248 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

249 
throw
 
e
;

250 } 
fš®ly
 {

251  
chdPIDs
;

253 
	}
}

256 
public
 
	$g‘Pid
(
Proûss
 
p
) {

257 
pid
 = -1;

259 
Œy
 {

260 ià(
p
.
	`g‘CÏss
().
	`g‘Name
().
	`equ®s
("java.lang.UNIXProcess")) {

261 
F›ld
 
f
 = 
p
.
	`g‘CÏss
().
	`g‘Deş¬edF›ld
("pid");

262 
f
.
	`£tAcûssibË
(
Œue
);

263 
pid
 = 
f
.
	`g‘LÚg
(
p
);

264 
f
.
	`£tAcûssibË
(
çl£
);

266 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

267 
pid
 = -1;

269  
pid
;

270 
	}
}

272 
public
 
CÜfuRuÁime
 
	$ü—‹DeçuÉRuÁime
() {

273  
	`ü—‹RuÁime
(
DEFAULT_ENDPOINT
);

274 
	}
}

276 
public
 
Proûss
 
	$runS”v”
(
pÜt
, 
boŞ—n
 
sšgË
è
throws
 
IOExû±iÚ
 {

277  
Ãw
 
	`CÜfuS”v”RuÂ”
()

278 .
	`£tHo¡
(
DEFAULT_HOST
)

279 .
	`£tPÜt
(
pÜt
)

280 .
	`£tSšgË
(
sšgË
)

281 .
	`runS”v”
();

282 
	}
}

284 
public
 
Proûss
 
	$runDeçuÉS”v”
(è
throws
 
IOExû±iÚ
 {

285  
Ãw
 
	`CÜfuS”v”RuÂ”
()

286 .
	`£tHo¡
(
DEFAULT_HOST
)

287 .
	`£tPÜt
(
DEFAULT_PORT
)

288 .
	`£tSšgË
(
Œue
)

289 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
DEFAULT_HOST
, 
DEFAULT_PORT
))

290 .
	`runS”v”
();

291 
	}
}

293 
public
 
CÜfuRuÁime
 
	$ü—‹RuÁime
(
SŒšg
 
’dpošt
) {

294 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
’dpošt
)

295 .
	`£tCacheDi§bËd
(
Œue
)

296 .
	`cÚÃù
();

297  
¹
;

298 
	}
}

300 
public
 
CÜfuRuÁime
 
	$ü—‹RuÁimeW™hCache
() {

301  
	`ü—‹RuÁimeW™hCache
(
DEFAULT_ENDPOINT
);

302 
	}
}

304 
public
 
CÜfuRuÁime
 
	$ü—‹RuÁimeW™hCache
(
SŒšg
 
’dpošt
) {

305 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
’dpošt
)

306 .
	`£tCacheDi§bËd
(
çl£
)

307 .
	`cÚÃù
();

308  
¹
;

309 
	}
}

311 
public
 
	gSŒ—mšgM­
<
	gSŒšg
, 
	gIÁeg”
> 
	$ü—‹M­
(
CÜfuRuÁime
 
¹
, 
SŒšg
 
¡»amName
) {

312 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­
 = 
¹
.
	`g‘ObjeùsV›w
()

313 .
	`bud
()

314 .
	`£tSŒ—mName
(
¡»amName
)

315 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {})

316 .
	`İ’
();

317  
m­
;

318 
	}
}

320 
public
 şas 
	cSŒ—mGobbËr
 
im¶em’ts
 
	gRuÂabË
 {

321 
´iv©e
 
IÅutSŒ—m
 
	gšputSŒ—m
;

322 
´iv©e
 
SŒšg
 
	glogfe
;

324 
public
 
SŒ—mGobbËr
(
IÅutSŒ—m
 
šputSŒ—m
, 
SŒšg
 
logfe
è
throws
 
	gIOExû±iÚ
 {

325 
	gthis
.
	gšputSŒ—m
 = 
šputSŒ—m
;

326 
	gthis
.
	glogfe
 = 
logfe
;

327 ià(
	gFes
.
nÙExi¡s
(
P©hs
.
g‘
(
logfe
))) {

328 
	gFes
.
ü—‹Fe
(
P©hs
.
g‘
(
logfe
));

332 @
Ov”ride


333 
public
 
run
() {

334 
Ãw
 
Bufã»dR—d”
Òew 
IÅutSŒ—mR—d”
(
šputSŒ—m
)).
lšes
()

335 .
fÜEach
((
x
) -> {

336 
Œy
 {

337 
Fes
.
wr™e
(
P©hs
.
g‘
(
logfe
), 
x
.
g‘By‹s
(),

338 
Snd¬dO³nO±iÚ
.
APPEND
);

339 
Fes
.
wr™e
(
P©hs
.
g‘
(
logfe
), "\n".
g‘By‹s
(),

340 
Snd¬dO³nO±iÚ
.
APPEND
);

341 } 
ÿtch
 (
Exû±iÚ
 
e
) {

342 
log
.
”rÜ
("SŒ—mGobbËr: E¼Ü, {}", 
e
);

354 @
	gG‘‹r


355 @
	gS‘‹r


356 @
	$AcûssÜs
(
chaš
 = 
Œue
)

357 
public
 şas 
	cCÜfuS”v”RuÂ”
 {

359 
´iv©e
 
SŒšg
 
ho¡
 = 
DEFAULT_HOST
;

360 
´iv©e
 
pÜt
 = 
DEFAULT_PORT
;

362 
´iv©e
 
boŞ—n
 
sšgË
 = 
Œue
;

363 
´iv©e
 
boŞ—n
 
sEÇbËd
 = 
çl£
;

364 
´iv©e
 
SŒšg
 
keyStÜe
 = 
nuÎ
;

365 
´iv©e
 
SŒšg
 
keyStÜePasswÜd
 = 
nuÎ
;

366 
´iv©e
 
SŒšg
 
logLev–
 = "INFO";

367 
´iv©e
 
SŒšg
 
logP©h
 = 
nuÎ
;

368 
´iv©e
 
SŒšg
 
Œu¡StÜe
 = 
nuÎ
;

369 
´iv©e
 
SŒšg
 
logSizeLim™P”ûÁage
 = 
nuÎ
;

370 
´iv©e
 
SŒšg
 
Œu¡StÜePasswÜd
 = 
nuÎ
;

371 
´iv©e
 
SŒšg
 
com´essiÚCodec
 = 
nuÎ
;

379 
public
 
SŒšg
 
	`g‘O±iÚsSŒšg
() {

380 
SŒšgBud”
 
commªd
 = 
Ãw
 
	`SŒšgBud”
();

381 
commªd
.
	`­³nd
("-¨").­³nd(
ho¡
);

382 ià(
logP©h
 !ğ
nuÎ
) {

383 
commªd
.
	`­³nd
(" -È").­³nd(
logP©h
);

385 
commªd
.
	`­³nd
(" -m");

387 ià(
sšgË
) {

388 
commªd
.
	`­³nd
(" -s");

391 ià(
logSizeLim™P”ûÁage
 !ğ
nuÎ
) {

392 
commªd
.
	`­³nd
(" --log-size-quÙa-³rûÁag").­³nd(
logSizeLim™P”ûÁage
);

395 ià(
sEÇbËd
) {

396 
commªd
.
	`­³nd
(" -e");

397 ià(
keyStÜe
 !ğ
nuÎ
) {

398 
commªd
.
	`­³nd
(" -u ").­³nd(
keyStÜe
);

400 ià(
keyStÜePasswÜd
 !ğ
nuÎ
) {

401 
commªd
.
	`­³nd
(" -à").­³nd(
keyStÜePasswÜd
);

403 ià(
Œu¡StÜe
 !ğ
nuÎ
) {

404 
commªd
.
	`­³nd
(" -¸").­³nd(
Œu¡StÜe
);

406 ià(
Œu¡StÜePasswÜd
 !ğ
nuÎ
) {

407 
commªd
.
	`­³nd
(" -w ").­³nd(
Œu¡StÜePasswÜd
);

410 
commªd
.
	`­³nd
(" -d ").­³nd(
logLev–
).append(" ")

411 .
	`­³nd
(
pÜt
);

412  
commªd
.
	`toSŒšg
();

422 
public
 
Proûss
 
	`runS”v”
(è
throws
 
IOExû±iÚ
 {

423 
fš®
 
SŒšg
 
£rv”CÚsŞeLogP©h
 = 
CORFU_LOG_PATH
 + 
Fe
.
£·¿tÜ
 + 
ho¡
 + "_" + 
pÜt
 + "_consolelog";

425 
Fe
 
logP©h
 = 
Ãw
 
	`Fe
(
	`g‘CÜfuS”v”LogP©h
(
ho¡
, 
pÜt
));

426 ià(!
logP©h
.
	`exi¡s
()) {

427 
logP©h
.
	`mkdœ
();

429 
ProûssBud”
 
bud”
 = 
Ãw
 
	`ProûssBud”
();

430 
bud”
.
	`commªd
("sh", "-c", "bš/cÜfu_£rv” " + 
	`g‘O±iÚsSŒšg
());

431 
bud”
.
	`dœeùÜy
(
Ãw
 
	`Fe
(
CORFU_PROJECT_DIR
));

432 
Proûss
 
cÜfuS”v”Proûss
 = 
bud”
.
	`¡¬t
();

433 
SŒ—mGobbËr
 
¡»amGobbËr
 = 
Ãw
 
	`SŒ—mGobbËr
(
cÜfuS”v”Proûss
.
	`g‘IÅutSŒ—m
(), 
£rv”CÚsŞeLogP©h
);

434 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
().
	`subm™
(
¡»amGobbËr
);

435  
cÜfuS”v”Proûss
;

437 
	}
}

	@test/src/test/java/org/corfudb/integration/AckDataSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	glombok
.
	gD©a
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gSourûMªag”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

9 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

10 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gç
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

18 @
D©a


19 
public
 cÏs 
	cAckD©aS’d”
 
im¶em’ts
 
	mD©aS’d”
 {

21 
´iv©e
 
UUID
 
	m¢­shÙSyncReque¡Id
;

22 
´iv©e
 
	mba£SÇpshÙTime¡amp
;

23 
´iv©e
 
SourûMªag”
 
	msourûMªag”
;

24 
´iv©e
 
ExecutÜS”viû
 
	mchªÃl
;

26 
public
 
	$AckD©aS’d”
() {

27 
chªÃl
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
();

30 @
Ov”ride


31 
public
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
	$£nd
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

34 
fš®
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
cf
 = 
Ãw
 CompletableFuture<>();

35 
cf
.
	`com¶‘e
(
sourûMªag”
.
	`»ûive
(
mes§ge
));

36  
cf
;

37 
	}
}

39 @
Ov”ride


40 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
£nd
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
) {

41 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	gackCF
 = 
Ãw
 
Com¶‘abËFutu»
<>();

42 
	gmes§ges
.
fÜEach
(
msg
 -> 
£nd
(msg));

43  
	gackCF
;

46 @
Ov”ride


47 
public
 
	$ÚE¼Ü
(
LogR•liÿtiÚE¼Ü
 
”rÜ
) {

48 
	`ç
("On Error„eceived for†ogƒntry sync");

49 
	}
}

	@test/src/test/java/org/corfudb/integration/ClusterReconfigIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gCÚtiguousS‘
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gDisü‘eDomaš
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gRªge
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gBoÙ¡¿pUt
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gReboÙUt
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£HªdËr
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutCl›Á
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutHªdËr
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tCl›Á
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tHªdËr
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gN‘tyCl›ÁRou‹r
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—msV›w
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

37 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

39 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

40 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

41 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

42 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

43 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

44 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

45 
impÜt
 
	gjava
.
	gut
.
	gM­
;

46 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

47 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

48 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

49 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

50 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

51 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

52 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

53 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

55 
impÜt
 
	gjun™
.
	gäamewÜk
.
	gTe¡Ca£
.
	gç
;

56 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

57 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©Code
;

58 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

60 
public
 cÏs 
	cClu¡”RecÚfigIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

62 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

63 
´iv©e
 
fš®
 
	mba£PÜt
 = 9000;

64 
´iv©e
 
fš®
 
	m»Œ›s
 = 10;

66 @
BefÜe


67 
public
 
	$lßdPrİ”t›s
() {

68 
cÜfuSšgËNodeHo¡
 = (
SŒšg
è
PROPERTIES
.
	`g‘
("corfuSingleNodeHost");

71 @
Aá”


72 
public
 
	$‹¬Down
() {

73 ià(
ruÁime
 !ğ
nuÎ
) {

74 
ruÁime
.
	`shutdown
();

76 
	}
}

78 
´iv©e
 
SŒšg
 
	$g‘S”v”Endpošt
(
pÜt
) {

79  
cÜfuSšgËNodeHo¡
 + ":" + 
pÜt
;

80 
	}
}

82 
´iv©e
 
Rªdom
 
	$g‘RªdomNumb”G’”©Ü
() {

83 
fš®
 
Rªdom
 
¿ndomS“d
 = 
Ãw
 
	`Rªdom
();

84 
fš®
 
SEED
 = 
¿ndomS“d
.
	`ÃxtLÚg
();

86 
‹¡Stus
 +ğ"SEED=" + 
LÚg
.
	`toHexSŒšg
(
SEED
);

87  
Ãw
 
	`Rªdom
(
SEED
);

88 
	}
}

90 
´iv©e
 
Layout
 
	$g‘Layout
(
numNodes
) {

91 
Li¡
<
SŒšg
> 
£rv”s
 = 
Ãw
 
A¼ayLi¡
<>();

93 
x
 = 0; x < 
numNodes
; x++) {

94 
SŒšg
 
£rv”Add»ss
 = "loÿlho¡:" + (
ba£PÜt
 + 
x
);

95 
£rv”s
.
	`add
(
£rv”Add»ss
);

98  
Ãw
 
	`Layout
(

99 
Ãw
 
A¼ayLi¡
<>(
£rv”s
),

100 
Ãw
 
A¼ayLi¡
<>(
£rv”s
),

101 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
Layout
.
	`LayoutSegm’t
(

102 
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
,

105 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
Layout
.
	`LayoutSŒe
(
£rv”s
)))),

107 
UUID
.
	`¿ndomUUID
());

108 
	}
}

117 
´iv©e
 
wa™FÜEpochChªge
(
P»diÿ‹
<
LÚg
> 
•ochV”if›r
, 
CÜfuRuÁime
 
cÜfuRuÁime
)

118 
throws
 
	gIÁ”ru±edExû±iÚ
 {

120 
	gcÜfuRuÁime
.
šv®id©eLayout
();

121 
Layout
 
	g»äeshedLayout
 = 
cÜfuRuÁime
.
g‘LayoutV›w
().
g‘Layout
();

122 
	gi
 = 0; i < 
	gPARAMETERS
.
	gNUM_ITERATIONS_MODERATE
; i++) {

123 ià(
	g•ochV”if›r
.
‹¡
(
»äeshedLayout
.
g‘Epoch
())) {

126 
	gcÜfuRuÁime
.
šv®id©eLayout
();

127 
	g»äeshedLayout
 = 
cÜfuRuÁime
.
g‘LayoutV›w
().
g‘Layout
();

128 
	gTimeUn™
.
	gMILLISECONDS
.
¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
toMlis
());

130 
as£¹Th©
(
•ochV”if›r
.
‹¡
(
»äeshedLayout
.
g‘Epoch
())).
isTrue
();

139 
´iv©e
 
SŒšg
 
	$ü—‹SŒšgOfSize
(
msgSize
) {

140 
SŒšgBud”
 
sb
 = 
Ãw
 
	`SŒšgBud”
(
msgSize
);

141 
i
 = 0; i < 
msgSize
; i++) {

142 
sb
.
	`­³nd
('a');

144  
sb
.
	`toSŒšg
();

145 
	}
}

147 
´iv©e
 
Proûss
 
	$runP”si¡’tS”v”
(
SŒšg
 
add»ss
, 
pÜt
, 
boŞ—n
 
sšgËNode
è
throws
 
IOExû±iÚ
 {

148  
Ãw
 
	`CÜfuS”v”RuÂ”
()

149 .
	`£tHo¡
(
add»ss
)

150 .
	`£tPÜt
(
pÜt
)

151 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
add»ss
, 
pÜt
))

152 .
	`£tSšgË
(
sšgËNode
)

153 .
	`runS”v”
();

154 
	}
}

156 
´iv©e
 
Th»ad
 
	$¡¬tD«mÚWr™”
(
CÜfuRuÁime
 
cÜfuRuÁime
, 
Rªdom
 
r
, 
CÜfuTabË
 
bË
,

157 
SŒšg
 
d©a
, 
AtomicBoŞ—n
 
¡İFÏg
) {

158 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(() -> {

159 
¡İFÏg
.
	`g‘
()) {

160 
	`as£¹Th©Code
(() -> {

161 
Œy
 {

162 
cÜfuRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

163 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

164 
cÜfuRuÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

165 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

168 
e
.
	`´štSckT¿û
();

170 }).
	`dÛsNÙThrowAnyExû±iÚ
();

173 
t
.
	`£tD«mÚ
(
Œue
);

174 
t
.
	`¡¬t
();

175  
t
;

176 
	}
}

188 @
Te¡


189 
public
 
	$addNodesTe¡
(è
throws
 
Exû±iÚ
 {

190 
fš®
 
PORT_0
 = 9000;

191 
fš®
 
PORT_1
 = 9001;

192 
fš®
 
PORT_2
 = 9002;

193 
fš®
 
Du¿tiÚ
 
timeout
 = Du¿tiÚ.
	`ofMšu‹s
(5);

194 
fš®
 
Du¿tiÚ
 
pŞlP”iod
 = Du¿tiÚ.
	`ofSecÚds
(5);

195 
fš®
 
wÜkæowNumR‘ry
 = 3;

197 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
Œue
);

198 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

199 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

201 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

203 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

204 .
	`bud
()

205 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

206 .
	`£tSŒ—mName
("test")

207 .
	`İ’
();

209 
fš®
 
SŒšg
 
d©a
 = 
	`ü—‹SŒšgOfSize
(1
_000
);

211 
Rªdom
 
r
 = 
	`g‘RªdomNumb”G’”©Ü
();

212 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

213 
SŒšg
 
key
 = 
LÚg
.
	`toSŒšg
(
r
.
	`ÃxtLÚg
());

214 
bË
.
	`put
(
key
, 
d©a
);

217 
fš®
 
AtomicBoŞ—n
 
mÜeD©aToBeWr™‹n
 = 
Ãw
 
	`AtomicBoŞ—n
(
Œue
);

218 
Th»ad
 
t
 = 
	`¡¬tD«mÚWr™”
(
ruÁime
, 
r
, 
bË
, 
d©a
, 
mÜeD©aToBeWr™‹n
);

220 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
("loÿlho¡:9001", 
wÜkæowNumR‘ry
,

221 
timeout
, 
pŞlP”iod
);

222 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
("loÿlho¡:9002", 
wÜkæowNumR‘ry
,

223 
timeout
, 
pŞlP”iod
);

225 
fš®
 
nodesCouÁ
 = 3;

226 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AÎAùiveS”v”s
().
	`size
(è=ğ
nodesCouÁ


227 && 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`isEm±y
()

228 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
ruÁime
);

230 
mÜeD©aToBeWr™‹n
.
	`£t
(
çl£
);

231 
t
.
	`još
();

233 
	`v”ifyD©a
(
ruÁime
);

235 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

236 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

237 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

238 
	}
}

247 
´iv©e
 
	$v”ifyD©a
(
CÜfuRuÁime
 
cÜfuRuÁime
è
throws
 
Exû±iÚ
 {

249 
Ï¡Add»ss
 = 
cÜfuRuÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

251 
M­
<
LÚg
, 
LogD©a
> 
m­_0
 = 
	`g‘AÎNÚEm±yD©a
(
cÜfuRuÁime
, "loÿlho¡:9000", 
Ï¡Add»ss
);

252 
M­
<
LÚg
, 
LogD©a
> 
m­_1
 = 
	`g‘AÎNÚEm±yD©a
(
cÜfuRuÁime
, "loÿlho¡:9001", 
Ï¡Add»ss
);

253 
M­
<
LÚg
, 
LogD©a
> 
m­_2
 = 
	`g‘AÎNÚEm±yD©a
(
cÜfuRuÁime
, "loÿlho¡:9002", 
Ï¡Add»ss
);

255 
	`as£¹Th©
(
m­_1
.
	`’ŒyS‘
()).
	`cÚšsOÆyEËm’tsOf
(
m­_0
.entrySet());

256 
	`as£¹Th©
(
m­_2
.
	`’ŒyS‘
()).
	`cÚšsOÆyEËm’tsOf
(
m­_0
.entrySet());

257 
	}
}

268 
´iv©e
 
	gM­
<
	gLÚg
, 
	gLogD©a
> 
	$g‘AÎNÚEm±yD©a
(
CÜfuRuÁime
 
cÜfuRuÁime
,

269 
SŒšg
 
’dpošt
, 
’d
è
throws
 
Exû±iÚ
 {

270 
R—dRe¥Ú£
 
»adRe¥Ú£
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

271 .
	`g‘LogUn™Cl›Á
(
’dpošt
)

272 .
	`»adAÎ
(
	`g‘RªgeAdd»ssAsLi¡
(0L, 
’d
))

273 .
	`g‘
();

274  
»adRe¥Ú£
.
	`g‘Add»s£s
().
	`’ŒyS‘
()

275 .
	`¡»am
()

276 .
	`f‹r
(
lÚgLogD©aEÁry
 -> !lÚgLogD©aEÁry.
	`g‘V®ue
().
	`isEm±y
())

277 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(
EÁry
::
g‘Key
, EÁry::
g‘V®ue
));

278 
	}
}

287 
´iv©e
 
Layout
 
	$šüem’tClu¡”Epoch
(
CÜfuRuÁime
 
cÜfuRuÁime
è
throws
 
Exû±iÚ
 {

288 
ŞdEpoch
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

289 
Layout
 
l
 = 
Ãw
 
	`Layout
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

290 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

291 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

292 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
l
, 1L);

293 
cÜfuRuÁime
.
	`šv®id©eLayout
();

294 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(
ŞdEpoch
 + 1);

295  
l
;

296 
	}
}

298 
´iv©e
 
	gLi¡
<
	gLÚg
> 
	$g‘RªgeAdd»ssAsLi¡
(
¡¬tAdd»ss
, 
’dAdd»ss
) {

299 
Rªge
<
LÚg
> 
¿nge
 = Rªge.
	`şo£d
(
¡¬tAdd»ss
, 
’dAdd»ss
);

300  
CÚtiguousS‘
.
	`ü—‹
(
¿nge
, 
Disü‘eDomaš
.
	`lÚgs
()).
	`asLi¡
();

301 
	}
}

310 @
Te¡


311 
public
 
	$»£tTe¡
(è
throws
 
Exû±iÚ
 {

313 
fš®
 
PORT_0
 = 9000;

315 
Proûss
 
cÜfuS”v”
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
Œue
);

317 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

318 
	`šüem’tClu¡”Epoch
(
ruÁime
);

319 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘Ba£Cl›Á
("localhost:9000")

320 .
	`»£t
().
	`g‘
();

322 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

326 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

327 ià(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
() == 0L) {

330 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

331 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

333 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(0L);

334 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

335 
	}
}

345 @
Te¡


346 
public
 
	$»¡¬tTe¡
(è
throws
 
Exû±iÚ
 {

348 
fš®
 
PORT_0
 = 9000;

350 
Proûss
 
cÜfuS”v”
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
Œue
);

352 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

353 
Layout
 
l
 = 
	`šüem’tClu¡”Epoch
(
ruÁime
);

354 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`g‘Ba£Cl›Á
("localhost:9000")

355 .
	`»¡¬t
().
	`g‘
();

357 
	`wa™FÜEpochChªge
(
•och
 ->ƒpoch >ğ
l
.
	`g‘Epoch
(è+ 1, 
ruÁime
);

359 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

360 
	}
}

366 @
Te¡


367 
public
 
	$»boÙUtTe¡
(è
throws
 
Exû±iÚ
 {

368 
fš®
 
PORT_0
 = 9000;

369 
fš®
 
SŒšg
 
SERVER_0
 = "loÿlho¡:" + 
PORT_0
;

372 
Proûss
 
cÜfuS”v”
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
Œue
);

374 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

375 
Layout
 
Ïyout
 = 
	`šüem’tClu¡”Epoch
(
ruÁime
);

376 
ReboÙUt
.
	`»¡¬t
(
SERVER_0
, 
ruÁime
.
	`g‘P¬am‘”s
(), 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_LONG
);

378 
	`wa™FÜEpochChªge
(
•och
 ->ƒpoch >ğ
Ïyout
.
	`g‘Epoch
(è+ 1, 
ruÁime
);

380 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

381 
ReboÙUt
.
	`»£t
(
SERVER_0
, 
ruÁime
.
	`g‘P¬am‘”s
(), 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_LONG
);

382 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

384 
	`wa™FÜEpochChªge
(
•och
 ->ƒpoch =ğ0, 
ruÁime
);

385 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

386 
	}
}

399 
´iv©e
 
	$klNodeAndV”ifyD©aP©h
(
klNode
è
throws
 
Exû±iÚ
 {

402 
fš®
 
PORT_0
 = 9000;

403 
fš®
 
PORT_1
 = 9001;

404 
fš®
 
PORT_2
 = 9002;

405 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

406 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

407 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

408 
Li¡
<
Proûss
> 
cÜfuS”v”s
 = 
A¼ays
.
	`asLi¡
(
cÜfuS”v”_1
, 
cÜfuS”v”_2
, 
cÜfuS”v”_3
);

409 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

410 
TimeUn™
.
SECONDS
.
	`¦“p
(1);

411 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

414 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

415 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

416 .
	`bud
()

417 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

418 .
	`£tSŒ—mName
("test")

419 .
	`İ’
();

420 
fš®
 
SŒšg
 
d©a
 = 
	`ü—‹SŒšgOfSize
(1
_000
);

421 
Rªdom
 
r
 = 
	`g‘RªdomNumb”G’”©Ü
();

422 
fš®
 
AtomicBoŞ—n
 
mÜeD©aToBeWr™‹n
 = 
Ãw
 
	`AtomicBoŞ—n
(
Œue
);

423 
Th»ad
 
t
 = 
	`¡¬tD«mÚWr™”
(
ruÁime
, 
r
, 
bË
, 
d©a
, 
mÜeD©aToBeWr™‹n
);

426 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

427 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

428 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

429 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

433 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”s
.
	`g‘
(
klNode
))).
	`isTrue
();

437 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
Ïyout
.
	`g‘Epoch
(), 
ruÁime
);

440 
mÜeD©aToBeWr™‹n
.
	`£t
(
çl£
);

441 
t
.
	`još
();

445 
boŞ—n
 
wr™eAá”KlNode
 = 
çl£
;

446 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

447 
Œy
 {

448 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

449 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

450 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

451 
wr™eAá”KlNode
 = 
Œue
;

453 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

456 
e
.
	`´štSckT¿û
();

458 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

460 
	`as£¹Th©
(
wr™eAá”KlNode
).
	`isTrue
();

462 
i
 = 0; i < 
cÜfuS”v”s
.
	`size
(); i++) {

463 ià(
i
 =ğ
klNode
) {

466 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”s
.
	`g‘
(
i
))).
	`isTrue
();

468 
	}
}

476 @
Te¡


477 
public
 
	$klLogUn™AndPrim¬ySequ’ûr
(è
throws
 
Exû±iÚ
 {

478 
	`klNodeAndV”ifyD©aP©h
(0);

479 
	}
}

487 @
Te¡


488 
public
 
	$klLogUn™AndBackupSequ’ûr
(è
throws
 
Exû±iÚ
 {

489 
	`klNodeAndV”ifyD©aP©h
(1);

490 
	}
}

497 @
Te¡


498 
public
 
	$‹¡3NodeBoÙ¡¿pUt™y
(è
throws
 
Exû±iÚ
 {

501 
fš®
 
PORT_0
 = 9000;

502 
fš®
 
PORT_1
 = 9001;

503 
fš®
 
PORT_2
 = 9002;

504 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

505 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

506 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

507 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

509 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

511 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

512 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`equ®s
(
Ïyout
)).
	`isTrue
();

514 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

515 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

516 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

517 
	}
}

519 
´iv©e
 
	$»ŒyBoÙ¡¿pO³¿tiÚ
(
RuÂabË
 
boÙ¡¿pO³¿tiÚ
è
throws
 
IÁ”ru±edExû±iÚ
 {

520 
»Œy
 = 
»Œ›s
;

521 
»Œy
-- > 0) {

522 
Œy
 {

523 
boÙ¡¿pO³¿tiÚ
.
	`run
();

525 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

526 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

529 
	`ç
();

530 
	}
}

537 @
Te¡


538 
public
 
	$‹¡1NodeBoÙ¡¿pW™hBoÙ¡¿µedNode
(è
throws
 
Exû±iÚ
 {

541 
fš®
 
PORT_0
 = 9000;

542 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

543 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(1);

545 
ICl›ÁRou‹r
 
rou‹r
 = 
Ãw
 
	`N‘tyCl›ÁRou‹r
(
NodeLoÿtÜ


546 .
	`·r£SŒšg
(
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_0
),

547 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

548 
rou‹r
.
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
()).addCl›ÁÒew 
	`Ba£HªdËr
());

549 
	`»ŒyBoÙ¡¿pO³¿tiÚ
((è-> 
CFUts
.
	`g‘Unš‹¼u±ibly
(

550 
Ãw
 
	`LayoutCl›Á
(
rou‹r
, 
Ïyout
.
	`g‘Epoch
()).
	`boÙ¡¿pLayout
(layout)));

551 
	`»ŒyBoÙ¡¿pO³¿tiÚ
((è-> 
CFUts
.
	`g‘Unš‹¼u±ibly
(

552 
Ãw
 
	`Mªagem’tCl›Á
(
rou‹r
, 
Ïyout
.
	`g‘Epoch
()).
	`boÙ¡¿pMªagem’t
(layout)));

554 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

556 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

557 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`equ®s
(
Ïyout
)).
	`isTrue
();

559 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

560 
	}
}

567 @
Te¡


568 
public
 
	$‹¡1NodeBoÙ¡¿pW™hWrÚgBoÙ¡¿µedLayoutS”v”
(è
throws
 
Exû±iÚ
 {

571 
fš®
 
PORT_0
 = 9000;

572 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

573 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(1);

575 
ICl›ÁRou‹r
 
rou‹r
 = 
Ãw
 
	`N‘tyCl›ÁRou‹r
(
NodeLoÿtÜ


576 .
	`·r£SŒšg
(
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_0
),

577 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

578 
rou‹r
.
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
()).addCl›ÁÒew 
	`Ba£HªdËr
());

579 
Layout
 
wrÚgLayout
 = 
Ãw
 
	`Layout
(
Ïyout
);

580 
wrÚgLayout
.
	`g‘LayoutS”v”s
().
	`add
("localhost:9005");

581 
	`»ŒyBoÙ¡¿pO³¿tiÚ
((è-> 
CFUts
.
	`g‘Unš‹¼u±ibly
(

582 
Ãw
 
	`LayoutCl›Á
(
rou‹r
, 
Ïyout
.
	`g‘Epoch
()).
	`boÙ¡¿pLayout
(
wrÚgLayout
)));

584 
	`as£¹Th©ThrownBy
((è-> 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
))

585 .
	`hasCau£In¡ªûOf
(
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

587 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

588 
rou‹r
.
	`¡İ
();

589 
	}
}

596 @
Te¡


597 
public
 
	$‹¡1NodeBoÙ¡¿pW™hWrÚgBoÙ¡¿µedMªagem’tS”v”
(è
throws
 
Exû±iÚ
 {

600 
fš®
 
PORT_0
 = 9000;

601 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

602 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(1);

604 
ICl›ÁRou‹r
 
rou‹r
 = 
Ãw
 
	`N‘tyCl›ÁRou‹r
(
NodeLoÿtÜ


605 .
	`·r£SŒšg
(
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_0
),

606 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

607 
rou‹r
.
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
())

608 .
	`addCl›Á
(
Ãw
 
	`Mªagem’tHªdËr
())

609 .
	`addCl›Á
(
Ãw
 
	`Ba£HªdËr
());

610 
Layout
 
wrÚgLayout
 = 
Ãw
 
	`Layout
(
Ïyout
);

611 
fš®
 
Mªagem’tCl›Á
 
mªagem’tCl›Á
 = 
Ãw
 
	`Mªagem’tCl›Á
(
rou‹r
, 
Ïyout
.
	`g‘Epoch
());

612 
wrÚgLayout
.
	`g‘LayoutS”v”s
().
	`add
("localhost:9005");

613 
	`»ŒyBoÙ¡¿pO³¿tiÚ
((è-> 
CFUts
.
	`g‘Unš‹¼u±ibly
(

614 
mªagem’tCl›Á
.
	`boÙ¡¿pMªagem’t
(
wrÚgLayout
)));

616 
	`as£¹Th©ThrownBy
((è-> 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
))

617 .
	`hasCau£In¡ªûOf
(
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

619 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

620 
rou‹r
.
	`¡İ
();

621 
	}
}

637 @
Te¡


638 
public
 
	$klAndH—lNode
(è
throws
 
Exû±iÚ
 {

641 
fš®
 
PORT_0
 = 9000;

642 
fš®
 
PORT_1
 = 9001;

643 
fš®
 
PORT_2
 = 9002;

644 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

645 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

646 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

647 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

648 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

651 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

652 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

653 .
	`bud
()

654 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

655 .
	`£tSŒ—mName
("test")

656 .
	`İ’
();

657 
fš®
 
SŒšg
 
d©a
 = 
	`ü—‹SŒšgOfSize
(1
_000
);

658 
Rªdom
 
r
 = 
	`g‘RªdomNumb”G’”©Ü
();

661 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

662 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

663 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

664 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

669 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
)).
	`isTrue
();

673 
	`wa™FÜ
(() -> {

674 
ruÁime
.
	`šv®id©eLayout
();

675 
Layout
 
»äeshedLayout
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

676  
»äeshedLayout
.
	`g‘AÎAùiveS”v”s
().
	`size
() == 2

677 && 
»äeshedLayout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
("localhost:9000");

682 
boŞ—n
 
wr™eAá”KlNode
 = 
çl£
;

683 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

684 
Œy
 {

685 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

686 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

687 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

688 
wr™eAá”KlNode
 = 
Œue
;

690 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

694 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

696 
	`as£¹Th©
(
wr™eAá”KlNode
).
	`isTrue
();

700 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

703 
	`wa™FÜ
(() -> {

704 
ruÁime
.
	`šv®id©eLayout
();

705 
Layout
 
»äeshedLayout
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

706  
»äeshedLayout
.
	`g‘Segm’ts
().
	`size
() == 1

707 && 
»äeshedLayout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
() == 0

708 && 
»äeshedLayout
.
	`g‘AÎAùiveS”v”s
().
	`size
(è=ğ
Ïyout
.
	`g‘AÎS”v”s
().size();

710 
	`v”ifyD©a
(
ruÁime
);

712 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

713 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

714 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

715 
	}
}

722 @
Te¡


723 
public
 
	$‹¡Sy¡emDownHªdËr
(è
throws
 
Exû±iÚ
 {

725 
fš®
 
PORT_0
 = 9000;

726 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
Œue
);

727 
fš®
 
Sem­hÜe
 
£m­hÜe
 = 
Ãw
 
	`Sem­hÜe
(1);

728 
£m­hÜe
.
	`acquœe
();

731 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
 = CÜfuRuÁimeP¬am‘”s.
	`bud”
()

732 .
	`ÏyoutS”v”
(
NodeLoÿtÜ
.
	`·r£SŒšg
("localhost:9000"))

733 .
	`ÿcheDi§bËd
(
Œue
)

734 .
	`sy¡emDownHªdËrTrigg”Lim™
(1)

736 .
	`sy¡emDownHªdËr
(() ->

737 
	`as£¹Th©Code
(
£m­hÜe
::
»Ëa£
).
	`dÛsNÙThrowAnyExû±iÚ
())

738 .
	`bud
();

740 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
cÜfuRuÁimeP¬am‘”s
).
	`cÚÃù
();

742 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

743 .
	`bud
()

744 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

745 .
	`£tSŒ—mName
("test")

746 .
	`İ’
();

747 
fš®
 
SŒšg
 
d©a
 = 
	`ü—‹SŒšgOfSize
(1
_000
);

748 
Rªdom
 
r
 = 
	`g‘RªdomNumb”G’”©Ü
();

751 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

752 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

753 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

756 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
)).
	`isTrue
();

758 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(() -> {

759 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

760 
Œy
 {

761 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

762 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
r
.
	`ÃxtIÁ
()), 
d©a
);

763 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

765 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

771 
t
.
	`¡¬t
();

774 
£m­hÜe
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

775 
	}
}

786 @
Te¡


787 
public
 
	$´ev’tMuÉËRe£ts
(è
throws
 
Exû±iÚ
 {

789 
fš®
 
PORT_0
 = 9000;

790 
fš®
 
PORT_1
 = 9001;

791 
fš®
 
PORT_2
 = 9002;

792 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

793 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

794 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

795 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

797 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

799 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

800 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream");

801 
ISŒ—mV›w
 
¡»am
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

802 
couÁ”
 = 0;

805 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

806 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
Ïyout
.
	`g‘Epoch
(), 
ruÁime
);

807 
fš®
 
Layout
 
ÏyoutAá”Fau»
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

809 
fš®
 
­³ndNum
 = 5;

811 
i
 = 0; i < 
­³ndNum
; i++) {

812 
¡»am
.
	`­³nd
(
IÁeg”
.
	`toSŒšg
(
couÁ”
++).
	`g‘By‹s
());

816 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

817 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
ÏyoutAá”Fau»
.
	`g‘Epoch
(), 
ruÁime
);

820 
fš®
 
¡¬tAdd»ss
 = 0L;

821 
fš®
 
’dAdd»ss
 = 9L;

822 
i
 = 0; i < 
­³ndNum
; i++) {

823 
¡»am
.
	`­³nd
(
IÁeg”
.
	`toSŒšg
(
couÁ”
++).
	`g‘By‹s
());

827 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÏyoutAá”Fau»
)

828 .
	`g‘LogUn™Cl›Á
("localhost:9002")

829 .
	`»£tLogUn™
(
ÏyoutAá”Fau»
.
	`g‘Epoch
()).
	`g‘
();

832 
v”ifiÿtiÚCouÁ”
 = 0;

833 
LogD©a
 
logD©a
 : 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

834 .
	`g‘LogUn™Cl›Á
("localhost:9002")

835 .
	`»adAÎ
(
	`g‘RªgeAdd»ssAsLi¡
(
¡¬tAdd»ss
, 
’dAdd»ss
))

836 .
	`g‘
().
	`g‘Add»s£s
().
	`v®ues
()) {

837 
	`as£¹Th©
(
logD©a
.
	`g‘Paylßd
(
ruÁime
))

838 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
v”ifiÿtiÚCouÁ”
++).
	`g‘By‹s
());

841 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

842 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

843 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

844 
	}
}

854 @
Te¡


855 
public
 
	$h—lNodesWÜkæowTe¡
(è
throws
 
Exû±iÚ
 {

857 
fš®
 
PORT_0
 = 9000;

858 
fš®
 
PORT_1
 = 9001;

859 
fš®
 
PORT_2
 = 9002;

860 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

861 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

862 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

863 
fš®
 
nodesCouÁ
 = 3;

864 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

866 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

868 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

869 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream");

870 
ISŒ—mV›w
 
¡»am
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

872 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

873 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
Ïyout
.
	`g‘Epoch
(), 
ruÁime
);

874 
fš®
 
Layout
 
ÏyoutAá”Fau»1
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

876 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

877 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

878 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
ÏyoutAá”Fau»1
.
	`g‘Epoch
(), 
ruÁime
);

879 
fš®
 
Layout
 
ÏyoutAá”H—l1
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

880 
couÁ”
 = 0;

882 
fš®
 
­³ndNum
 = 3;

883 
fš®
 
¡¬tAdd»ss
 = 0;

885 
i
 = 0; i < 
­³ndNum
; i++) {

886 
¡»am
.
	`­³nd
(
IÁeg”
.
	`toSŒšg
(
couÁ”
++).
	`g‘By‹s
());

889 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

890 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
ÏyoutAá”H—l1
.
	`g‘Epoch
(), 
ruÁime
);

893 
i
 = 0; i < 
­³ndNum
; i++) {

894 
¡»am
.
	`­³nd
(
IÁeg”
.
	`toSŒšg
(
couÁ”
++).
	`g‘By‹s
());

896 
fš®
 
’dAdd»ss
 = 5;

898 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

899 
Layout
 
fš®Layout
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

900 ià(
fš®Layout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`isEm±y
()

901 && 
fš®Layout
.
	`g‘Segm’ts
().
	`size
() == 1

902 && 
fš®Layout
.
	`g‘Segm’ts
().
	`g‘
(0).
	`g‘AÎLogS”v”s
().
	`size
(è=ğ
nodesCouÁ
) {

905 
ruÁime
.
	`šv®id©eLayout
();

906 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

909 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘UÄe¥ÚsiveS”v”s
()).
	`isEm±y
();

912 
v”ifiÿtiÚCouÁ”
 = 0;

913 
LogD©a
 
logD©a
 : 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

914 .
	`g‘LogUn™Cl›Á
("localhost:9002")

915 .
	`»adAÎ
(
	`g‘RªgeAdd»ssAsLi¡
(
¡¬tAdd»ss
, 
’dAdd»ss
)).
	`g‘
()

916 .
	`g‘Add»s£s
().
	`v®ues
()) {

917 
	`as£¹Th©
(
logD©a
.
	`g‘Paylßd
(
ruÁime
))

918 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
v”ifiÿtiÚCouÁ”
++).
	`g‘By‹s
());

921 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

922 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

923 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

924 
	}
}

932 @
Te¡


933 
public
 
	$»cÚÃùDiscÚÃùedCl›Á
(è
throws
 
Exû±iÚ
 {

935 
fš®
 
PORT_0
 = 9000;

936 
fš®
 
PORT_1
 = 9001;

937 
fš®
 
PORT_2
 = 9002;

938 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

939 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

940 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

941 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

943 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

945 
fš®
 
sy¡emDownHªdËrLim™
 = 10;

946 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

947 .
	`ÏyoutS”v”
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
DEFAULT_ENDPOINT
))

948 .
	`sy¡emDownHªdËrTrigg”Lim™
(
sy¡emDownHªdËrLim™
)

950 .
	`sy¡emDownHªdËr
(() -> {

951 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("SystemDownHandler");

953 .
	`bud
()).
	`cÚÃù
();

955 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream");

956 
ISŒ—mV›w
 
¡»am
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

958 
fš®
 
­³ndNum
 = 3;

959 
couÁ”
 = 0;

961 
i
 = 0; i < 
­³ndNum
; i++) {

962 
¡»am
.
	`­³nd
(
IÁeg”
.
	`toSŒšg
(
couÁ”
++).
	`g‘By‹s
());

966 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

967 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

969 
fš®
 
Sem­hÜe
 
Ïtch
 = 
Ãw
 
	`Sem­hÜe
(1);

970 
Ïtch
.
	`acquœe
();

973 
ruÁime
.
	`šv®id©eLayout
();

978 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(() -> {

979 
fš®
 
couÁ”V®ue
 = 3;

980 
Œue
) {

981 
Œy
 {

982 
¡»am
.
	`­³nd
(
IÁeg”
.
	`toSŒšg
(
couÁ”V®ue
).
	`g‘By‹s
());

984 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
sue
) {

986 
Ïtch
.
	`»Ëa£
();

990 
t
.
	`¡¬t
();

992 
	`as£¹Th©
(
Ïtch
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
))

993 .
	`isTrue
();

995 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

996 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

998 
t
.
	`još
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
());

1001 
fš®
 
¡¬tAdd»ss
 = 0;

1002 
fš®
 
’dAdd»ss
 = 3;

1003 
i
 = 
¡¬tAdd»ss
; i <ğ
’dAdd»ss
; i++) {

1004 
	`as£¹Th©
(
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
i
).
	`g‘Paylßd
(runtime))

1005 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

1008 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_1
);

1009 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

1010 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

1011 
	}
}

1024 @
Te¡


1025 
public
 
	$fÜûRemoveAá”S—l
(è
throws
 
Exû±iÚ
 {

1028 
fš®
 
PORT_0
 = 9000;

1029 
fš®
 
PORT_1
 = 9001;

1030 
fš®
 
PORT_2
 = 9002;

1031 
Proûss
 
cÜfuS”v”_1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
çl£
);

1032 
Proûss
 
cÜfuS”v”_2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

1033 
Proûss
 
cÜfuS”v”_3
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

1034 
Li¡
<
Proûss
> 
cÜfuS”v”s
 = 
A¼ays
.
	`asLi¡
(
cÜfuS”v”_1
, 
cÜfuS”v”_2
, 
cÜfuS”v”_3
);

1035 
fš®
 
Layout
 
Ïyout
 = 
	`g‘Layout
(3);

1036 
TimeUn™
.
SECONDS
.
	`¦“p
(1);

1037 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_SHORT
);

1039 
fš®
 
sy¡emDownHªdËrLim™
 = 10;

1040 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

1041 .
	`ÏyoutS”v”
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
DEFAULT_ENDPOINT
))

1042 .
	`sy¡emDownHªdËr
(() -> {

1043 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
();

1045 .
	`sy¡emDownHªdËrTrigg”Lim™
(
sy¡emDownHªdËrLim™
)

1046 .
	`bud
())

1047 .
	`cÚÃù
();

1048 
ISŒ—mV›w
 
¡»am
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream"));

1050 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_2
);

1051 
	`shutdownCÜfuS”v”
(
cÜfuS”v”_3
);

1054 
Œue
) {

1055 
Œy
 {

1056 
¡»am
.
	`­³nd
("‹¡".
	`g‘By‹s
());

1057 
SË•
.
	`¦“pUnš‹¼u±ibly
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
);

1058 } 
	`ÿtch
 (
RuÁimeExû±iÚ
 
»
) {

1064 
	`as£¹Th©ThrownBy
(

1065 (è-> 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

1066 .
	`g‘Mªagem’tCl›Á
(
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_0
)

1067 .
	`£ndNodeS‹Reque¡
(), 
WrÚgEpochExû±iÚ
.
şass
))

1068 .
	`isIn¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

1070 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(

1071 
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_1
,

1072 
»Œ›s
,

1073 
PARAMETERS
.
TIMEOUT_SHORT
,

1074 
PARAMETERS
.
TIMEOUT_LONG
);

1075 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(

1076 
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_2
,

1077 
»Œ›s
,

1078 
PARAMETERS
.
TIMEOUT_SHORT
,

1079 
PARAMETERS
.
TIMEOUT_LONG
);

1080 
ruÁime
.
	`šv®id©eLayout
();

1083 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
())

1084 .
	`cÚšsExaùly
(
cÜfuSšgËNodeHo¡
 + ":" + 
PORT_0
);

1086 
Proûss
 
cÜfuS”v”
 : 
cÜfuS”v”s
) {

1087 
	`shutdownCÜfuS”v”
(
cÜfuS”v”
);

1089 
	}
}

1091 @
Te¡


1092 
public
 
	$‹¡Faov”W™hSŒ—mSubsumedByCheckpoštNoTrim
(è
throws
 
Exû±iÚ
 {

1095 
	`‹¡Faov”W™hSŒ—mSubsumedByCheckpošt
(
çl£
);

1096 
	}
}

1098 @
Te¡


1099 
public
 
	$‹¡Faov”W™hSŒ—mSubsumedByCheckpoštW™hTrim
(è
throws
 
Exû±iÚ
 {

1100 
	`‹¡Faov”W™hSŒ—mSubsumedByCheckpošt
(
Œue
);

1101 
	}
}

1107 
´iv©e
 
	$‹¡Faov”W™hSŒ—mSubsumedByCheckpošt
(
boŞ—n
 
Œim
è
throws
 
Exû±iÚ
 {

1108 
fš®
 
PORT_0
 = 9000;

1109 
fš®
 
PORT_1
 = 9001;

1110 
fš®
 
PORT_2
 = 9002;

1112 
fš®
 
SŒšg
 
¡»amName
 = "stream1";

1114 
fš®
 
numR‘ry
 = 3;

1115 
fš®
 
Du¿tiÚ
 
timeout
 = Du¿tiÚ.
	`ofMšu‹s
(5);

1116 
fš®
 
Du¿tiÚ
 
pŞlP”iod
 = Du¿tiÚ.
	`ofSecÚds
(5);

1118 
fš®
 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
);

1119 
fš®
 
SŒšg
 
checkpoštSŒ—mName
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
).
	`toSŒšg
()

1120 + 
SŒ—msV›w
.
CHECKPOINT_SUFFIX
;

1121 
fš®
 
UUID
 
checkpoštSŒ—mId
 = UUID.
	`ÇmeUUIDFromBy‹s
(
checkpoštSŒ—mName
.
	`g‘By‹s
());

1123 
fš®
 
numCheckpoštRecÜdsDeçuÉ
 = 3;

1125 
Proûss
 
£rv”0
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_0
, 
Œue
);

1126 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

1128 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

1129 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

1130 .
	`£tSŒ—mID
(
¡»amId
)

1131 .
	`İ’
();

1133 
fš®
 
numEÁr›s
 = 3;

1134 
i
 = 0; i < 
numEÁr›s
; i++) {

1135 
bË
.
	`put
("k" + 
i
, "v" + i);

1139 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

1140 
mcw
.
	`addM­
(
bË
);

1141 
Tok’
 
tok’
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "author");

1142 ià(
Œim
) {

1143 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

1147 
Proûss
 
£rv”1
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_1
, 
çl£
);

1148 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘S”v”Endpošt
(
PORT_1
), 
numR‘ry
, 
timeout
, 
pŞlP”iod
);

1150 
Proûss
 
£rv”2
 = 
	`runP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
PORT_2
, 
çl£
);

1151 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘S”v”Endpošt
(
PORT_2
), 
numR‘ry
, 
timeout
, 
pŞlP”iod
);

1153 
ruÁime
.
	`šv®id©eLayout
();

1154 
Layout
 
Ïyout
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

1157 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
£rv”0
)).
	`isTrue
();

1158 
	`wa™FÜEpochChªge
(
»äeshedEpoch
 ->„eäeshedEpoch > 
Ïyout
.
	`g‘Epoch
(), 
ruÁime
);

1161 
CÜfuRuÁime
 
ruÁime2
 = 
	`ü—‹RuÁime
(
	`g‘S”v”Endpošt
(
PORT_1
));

1164 
	`as£¹Th©
(
ruÁime2
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Prim¬ySequ’ûr
()).
	`isNÙEqu®To
(
	`g‘S”v”Endpošt
(
PORT_0
));

1165 
	`as£¹Th©
(
ruÁime2
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amId
)).
	`isEqu®To
(
numEÁr›s
);

1167 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË2
 = 
ruÁime2
.
	`g‘ObjeùsV›w
().
	`bud
()

1168 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

1169 .
	`£tSŒ—mID
(
¡»amId
)

1170 .
	`İ’
();

1173 
SŒ—mAdd»ssS·û
 
add»ssS·û
 = 
ruÁime2
.
	`g‘Add»ssS·ûV›w
()

1174 .
	`g‘LogAdd»ssS·û
()

1175 .
	`g‘Add»ssM­
().
	`g‘
(
¡»amId
);

1177 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
numEÁr›s
);

1178 ià(
Œim
) {

1180 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(0L);

1183 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
numEÁr›s
+1);

1187 
SŒ—mAdd»ssS·û
 
checkpoštAdd»ssS·û
 = 
ruÁime2
.
	`g‘Add»ssS·ûV›w
()

1188 .
	`g‘LogAdd»ssS·û
()

1189 .
	`g‘Add»ssM­
().
	`g‘
(
checkpoštSŒ—mId
);

1192 
	`as£¹Th©
(
checkpoštAdd»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
numCheckpoštRecÜdsDeçuÉ
);

1193 
CheckpoštEÁry
 
ıEÁry
 = (CheckpoštEÁryè
ruÁime2
.
	`g‘Add»ssS·ûV›w
()

1194 .
	`»ad
(
checkpoštAdd»ssS·û
.
	`g‘Highe¡Add»ss
())

1195 .
	`g‘Paylßd
(
ruÁime2
);

1196 
	`as£¹Th©
(
ıEÁry
.
	`g‘Diù
().
	`g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
)).

1197 
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(
numEÁr›s
));

1200 
	`as£¹Th©
(
bË2
.
	`size
()).
	`isEqu®To
(
numEÁr›s
);

1201 
i
 = 0; i < 
numEÁr›s
; i++) {

1202 
	`as£¹Th©
(
bË2
.
	`g‘
("k" + 
i
)).
	`isEqu®To
("v" + i);

1205 
	`shutdownCÜfuS”v”
(
£rv”1
);

1206 
	`shutdownCÜfuS”v”
(
£rv”2
);

1207 
	}
}

	@test/src/test/java/org/corfudb/integration/CmdletIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
impÜt
 
	gjava
.
	gio
.
	gBufã»dR—d”
;

13 
impÜt
 
	gjava
.
	gio
.
	gFe
;

14 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

15 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

16 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

18 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

27 @
IgnÜe


28 
public
 cÏs 
	cCmdËtIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

31 
´iv©e
 
fš®
 
	mPORT
 = 9901;

32 
´iv©e
 
fš®
 
SŒšg
 
	mENDPOINT
 = 
DEFAULT_HOST
 + ":" + 
PORT
;

34 
´iv©e
 
Layout
 
	$g‘SšgËLayout
() {

35  
Ãw
 
	`Layout
(

36 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
ENDPOINT
),

37 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
ENDPOINT
),

38 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
Layout
.
	`LayoutSegm’t
(Layout.
R•liÿtiÚMode
.
CHAIN_REPLICATION
,

41 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
Layout
.
	`LayoutSŒe
(CŞËùiÚs.sšgËtÚLi¡(
ENDPOINT
))))),

42 
CŞËùiÚs
.
EMPTY_LIST
,

44 
UUID
.
	`¿ndomUUID
());

47 
public
 
SŒšg
 
	$runCmdËtG‘Ouut
(
SŒšg
 
commªd
è
throws
 
Exû±iÚ
 {

48 
ProûssBud”
 
bud”
 = 
Ãw
 
	`ProûssBud”
("sh", "-c", 
commªd
);

49 
bud”
.
	`»dœeùE¼ÜSŒ—m
(
Œue
);

50 
Proûss
 
cmdËt
 = 
bud”
.
	`¡¬t
();

51 
fš®
 
SŒšgBud”
 
ouut
 = 
Ãw
 
	`SŒšgBud”
();

53 
	`Œy
 (
Bufã»dR—d”
 
bufã»dR—d”
 = 
Ãw
 
	`Bufã»dR—d”
Òew 
	`IÅutSŒ—mR—d”
(
cmdËt
.
	`g‘IÅutSŒ—m
()))) {

54 
SŒšg
 
lše
 = 
nuÎ
;

55 (
lše
 = 
bufã»dR—d”
.
	`»adLše
()è!ğ
nuÎ
) {

56 
ouut
.
	`­³nd
(
lše
);

58 
cmdËt
.
	`wa™FÜ
();

60  
ouut
.
	`toSŒšg
();

61 
	}
}

63 
´iv©e
 
Proûss
 
	gcÜfuS”v”Proûss
;

70 @
Te¡


71 
public
 
	$‹¡CÜfuLayoutCmdËt
(è
throws
 
Exû±iÚ
 {

73 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

74 
fš®
 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_Ïyouˆ" + 
ENDPOINT
;

75 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`cÚšs
(
	`g‘SšgËLayout
().
	`toSŒšg
()))

76 .
	`isTrue
();

77 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

78 
	}
}

85 @
Te¡


86 
public
 
	$‹¡CÜfuPšgCmdËt
(è
throws
 
Exû±iÚ
 {

88 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

89 
fš®
 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_pšg " + 
ENDPOINT
;

90 
fš®
 
SŒšg
 
ex³ùedSubSŒšg
 = "PING " + 
ENDPOINT
 + "ACK";

91 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`cÚšs
(
ex³ùedSubSŒšg
))

92 .
	`isTrue
();

93 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

94 
	}
}

102 @
Te¡


103 
public
 
	$‹¡CÜfuLayoutsCmdËt
(è
throws
 
Exû±iÚ
 {

105 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

106 
fš®
 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_Ïyout -ø" + 
ENDPOINT
 + " query";

108 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`»¶aû
(" ", "")

109 .
	`cÚšs
(
	`g‘SšgËLayout
().
	`asJSONSŒšg
()))

110 .
	`isTrue
();

111 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

112 
	}
}

119 @
Te¡


120 
public
 
	$‹¡CÜfuQu”yCmdËt
(è
throws
 
Exû±iÚ
 {

122 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

123 .
	`£tPÜt
(
PORT
)

124 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
DEFAULT_HOST
, 
PORT
))

125 .
	`runS”v”
();

127 
fš®
 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_qu”y " + 
ENDPOINT
;

128 
fš®
 
SŒšg
 
ex³ùedLogP©h
 = "--log-·th=" + 
CORFU_LOG_PATH
;

129 
fš®
 
SŒšg
 
ex³ùedS¹upArgs
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

130 .
	`£tPÜt
(
PORT
)

131 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
DEFAULT_HOST
, 
PORT
))

132 .
	`g‘O±iÚsSŒšg
();

133 
SŒšg
 
ouut
 = 
	`runCmdËtG‘Ouut
(
commªd
);

134 
	`as£¹Th©
(
ouut
.
	`cÚšs
(
ex³ùedLogP©h
)).
	`isTrue
();

135 
	`as£¹Th©
(
ouut
.
	`cÚšs
(
ex³ùedS¹upArgs
)).
	`isTrue
();

136 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

137 
	}
}

144 @
Te¡


145 
public
 
	$‹¡CÜfuSŒ—mCmdËt
(è
throws
 
Exû±iÚ
 {

147 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

148 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

149 
ruÁime
 = 
	`ü—‹RuÁime
(
ENDPOINT
);

150 
ISŒ—mV›w
 
¡»amV›wA
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
));

152 
SŒšg
 
·ylßd1
 = "Hello";

153 
¡»amV›wA
.
	`­³nd
(
·ylßd1
.
	`g‘By‹s
());

155 
SŒšg
 
commªdR—d
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_¡»am -˜" + 
¡»amA
 + " -ø" + 
ENDPOINT
 + "„ead";

156 
SŒšg
 
ouut
 = 
	`runCmdËtG‘Ouut
(
commªdR—d
);

157 
	`as£¹Th©
(
ouut
.
	`cÚšs
(
·ylßd1
)).
	`isTrue
();

159 
SŒšg
 
·ylßd2
 = "World";

160 
SŒšg
 
commªdAµ’d
 = "echØ'" + 
·ylßd2
 + "' | " + 
CORFU_PROJECT_DIR
 + "bš/cÜfu_¡»am -˜" + 
¡»amA
 + " -ø" + 
ENDPOINT
 + "‡ppend";

161 
	`runCmdËtG‘Ouut
(
commªdAµ’d
);

163 
	`as£¹Th©
(
¡»amV›wA
.
	`Ãxt
().
	`g‘Paylßd
(
ruÁime
)).
	`isEqu®To
(
·ylßd1
.
	`g‘By‹s
());

164 
	`as£¹Th©
(
¡»amV›wA
.
	`Ãxt
().
	`g‘Paylßd
(
ruÁime
)).
	`isEqu®To
((
·ylßd2
 + "\n").
	`g‘By‹s
());

165 
	`as£¹Th©
(
¡»amV›wA
.
	`Ãxt
()).
	`isNuÎ
();

166 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

167 
	}
}

174 @
Te¡


175 
public
 
	$‹¡CÜfuSequ’ûrCmdËt
(è
throws
 
Exû±iÚ
 {

177 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

178 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

179 
ruÁime
 = 
	`ü—‹RuÁime
(
ENDPOINT
);

181 
SŒšg
 
commªdNextTok’
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_£qu’û¸-˜" + 
¡»amA
 + " -ø" + 
ENDPOINT
 + "‚ext-token 3";

182 
	`runCmdËtG‘Ouut
(
commªdNextTok’
);

184 
Tok’
 
tok’
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Tok’
();

186 
SŒšg
 
commªdL©e¡
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_£qu’û¸-˜" + 
¡»amA
 + " -ø" + 
ENDPOINT
 + "†atest";

187 
SŒšg
 
ouut
 = 
	`runCmdËtG‘Ouut
(
commªdL©e¡
);

188 
	`as£¹Th©
(
ouut
.
	`cÚšs
(
tok’
.
	`toSŒšg
())).
	`isTrue
();

189 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

190 
	}
}

192 @
Te¡


193 
public
 
	$‹¡CÜfuAdd»ssS·ûCmdËt
(è
throws
 
Exû±iÚ
 {

195 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

196 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

197 
SŒšg
 
·ylßd
 = "Hello";

198 
SŒšg
 
commªdAµ’d
 = "echØ'" + 
·ylßd
 + "' | " + 
CORFU_PROJECT_DIR
 + "bš/cÜfu_a -˜" + 
¡»amA
 + " -ø" + 
ENDPOINT
 + " write 0";

199 
	`runCmdËtG‘Ouut
(
commªdAµ’d
);

200 
SŒšg
 
commªdR—d
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_a -˜" + 
¡»amA
 + " -ø" + 
ENDPOINT
 + "„ead 0";

201 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªdR—d
).
	`cÚšs
(
·ylßd
)).
	`isTrue
();

202 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

203 
	}
}

205 @
Te¡


206 
public
 
	$‹¡CÜfuHªdËFau»sCmdËt
(è
throws
 
Exû±iÚ
 {

208 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

209 
fš®
 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_hªdË_çu» -ø" + 
ENDPOINT
;

210 
fš®
 
SŒšg
 
ex³ùedSubSŒšg
 = "Fau» hªdË¸Ú " + 
ENDPOINT
 + " started.Initiation completed !";

211 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`cÚšs
(
ex³ùedSubSŒšg
))

212 .
	`isTrue
();

213 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

214 
	}
}

216 @
Te¡


217 
public
 
	$‹¡CÜfuLogun™CmdËt
(è
throws
 
Exû±iÚ
 {

219 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

220 
SŒšg
 
·ylßd
 = "Hello";

221 
SŒšg
 
commªdAµ’d
 = "echØ'" + 
·ylßd
 + "' | " + 
CORFU_PROJECT_DIR
 + "bš/cÜfu_logun™ " + 
ENDPOINT
 + " write 0";

222 
	`runCmdËtG‘Ouut
(
commªdAµ’d
);

224 
SŒšg
 
commªdR—d
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_logun™ " + 
ENDPOINT
 + "„ead 0";

225 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªdR—d
).
	`cÚšs
(
·ylßd
)).
	`isTrue
();

226 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

227 
	}
}

229 @
Te¡


230 
public
 
	$‹¡CÜfuRe£tCmdËt
(è
throws
 
Exû±iÚ
 {

232 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

233 
fš®
 
SŒšg
 
ex³ùedOuut
 = "Re£ˆ" + 
ENDPOINT
 + ":ACK";

234 
SŒšg
 
commªdR—d
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_»£ˆ" + 
ENDPOINT
;

235 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªdR—d
).
	`cÚšs
(
ex³ùedOuut
)).
	`isTrue
();

236 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

237 
	}
}

239 @
Te¡


240 
public
 
	$‹¡CÜfuBoÙ¡¿pClu¡”
(è
throws
 
Exû±iÚ
 {

241 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

242 .
	`£tPÜt
(
PORT
)

243 .
	`£tSšgË
(
çl£
)

244 .
	`runS”v”
();

245 
Fe
 
ÏyoutFe
 = 
Ãw
 
	`Fe
(
CORFU_LOG_PATH
 + Fe.
£·¿tÜ
 + "layoutFile");

246 
ÏyoutFe
.
	`ü—‹NewFe
();

247 
	`Œy
 (
FeOuutSŒ—m
 
fos
 = 
Ãw
 
	`FeOuutSŒ—m
(
ÏyoutFe
)) {

248 
fos
.
	`wr™e
(
	`g‘SšgËLayout
().
	`asJSONSŒšg
().
	`g‘By‹s
());

250 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_boÙ¡¿p_şu¡” -È" + 
ÏyoutFe
.
	`g‘AbsŞu‹P©h
();

251 
SŒšg
 
ex³ùedOuut
 = "New†ayout installed";

253 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`cÚšs
(
ex³ùedOuut
)).
	`isTrue
();

254 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

255 
	}
}

257 @
Te¡


258 
public
 
	$‹¡CÜfuBoÙ¡¿pClu¡”W™hSŒ—m
(è
throws
 
Exû±iÚ
 {

259 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

260 .
	`£tPÜt
(
PORT
)

261 .
	`£tSšgË
(
çl£
)

262 .
	`runS”v”
();

263 
Fe
 
ÏyoutFe
 = 
Ãw
 
	`Fe
(
CORFU_LOG_PATH
 + Fe.
£·¿tÜ
 + "layoutFile");

264 
ÏyoutFe
.
	`ü—‹NewFe
();

265 
	`Œy
 (
FeOuutSŒ—m
 
fos
 = 
Ãw
 
	`FeOuutSŒ—m
(
ÏyoutFe
)) {

266 
fos
.
	`wr™e
(
	`g‘SšgËLayout
().
	`asJSONSŒšg
().
	`g‘By‹s
());

268 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_boÙ¡¿p_şu¡” -È" + 
ÏyoutFe
.
	`g‘AbsŞu‹P©h
();

269 
SŒšg
 
ex³ùedOuut
 = "New†ayout installed";

271 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`cÚšs
(
ex³ùedOuut
)).
	`isTrue
();

273 
ruÁime
 = 
	`ü—‹RuÁime
(
ENDPOINT
);

274 
ISŒ—mV›w
 
¡»amV›wA
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

275 
	`as£¹Th©
(
¡»amV›wA
.
	`hasNext
())

276 .
	`isF®£
();

278 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

279 
	}
}

281 @
Te¡


282 
public
 
	$‹¡CÜfuMªagem’tBoÙ¡¿p
(è
throws
 
Exû±iÚ
 {

283 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

284 .
	`£tPÜt
(
PORT
)

285 .
	`£tSšgË
(
çl£
)

286 .
	`runS”v”
();

287 
Fe
 
ÏyoutFe
 = 
Ãw
 
	`Fe
(
CORFU_LOG_PATH
 + Fe.
£·¿tÜ
 + "layoutFile");

288 
ÏyoutFe
.
	`ü—‹NewFe
();

289 
	`Œy
 (
FeOuutSŒ—m
 
fos
 = 
Ãw
 
	`FeOuutSŒ—m
(
ÏyoutFe
)) {

290 
fos
.
	`wr™e
(
	`g‘SšgËLayout
().
	`asJSONSŒšg
().
	`g‘By‹s
());

292 
SŒšg
 
commªd
 = 
CORFU_PROJECT_DIR
 + "bš/cÜfu_mªagem’t_boÙ¡¿°-ø" + 
ENDPOINT
 + " -È" + 
ÏyoutFe
.
	`g‘AbsŞu‹P©h
();

293 
SŒšg
 
ex³ùedOuut
 = 
ENDPOINT
 + " bootstrapped successfully";

295 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªd
).
	`cÚšs
(
ex³ùedOuut
)).
	`isTrue
();

297 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

298 
	}
}

300 @
Te¡


301 
public
 
	$‹¡CÜfuSMRObjeù
(è
throws
 
Exû±iÚ
 {

302 
cÜfuS”v”Proûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
().
	`£tPÜt
(
PORT
).
	`runS”v”
();

303 
SŒšg
 
¡»amA
 = "streamA";

304 
SŒšg
 
·ylßd
 = "helloWorld";

305 
fš®
 
SŒšg
 
commªdPut
 = 
CORFU_PROJECT_DIR
 + "bin/corfu_smrobject" +

306 " -˜" + 
¡»amA
 +

307 " -ø" + 
ENDPOINT
 +

308 " " + 
CÜfuTabË
.
şass
.
	`g‘CªÚiÿlName
(è+ "…utIfAb£Á x " + 
·ylßd
;

309 
	`runCmdËtG‘Ouut
(
commªdPut
);

311 
fš®
 
SŒšg
 
commªdG‘
 = 
CORFU_PROJECT_DIR
 + "bin/corfu_smrobject" +

312 " -˜" + 
¡»amA
 +

313 " -ø" + 
ENDPOINT
 +

314 " " + 
CÜfuTabË
.
şass
.
	`g‘CªÚiÿlName
() + " getOrDefault x‚one";

316 
	`as£¹Th©
(
	`runCmdËtG‘Ouut
(
commªdG‘
).
	`cÚšs
(
·ylßd
)).
	`isTrue
();

318 
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
);

319 
	}
}

	@test/src/test/java/org/corfudb/integration/CorfuMsgFilterIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gMsgHªdlšgF‹r
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

17 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

19 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

27 
public
 cÏs 
	cCÜfuMsgF‹rIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

29 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

30 
´iv©e
 
	mcÜfuSšgËNodePÜt
;

31 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

34 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”
(
SŒšg
 
add»ss
, 
pÜt
è
throws
 
IOExû±iÚ
 {

35  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

36 .
	`£tHo¡
(
add»ss
)

37 .
	`£tPÜt
(
pÜt
)

38 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
add»ss
, 
pÜt
))

39 .
	`£tSšgË
(
Œue
)

40 .
	`runS”v”
();

43 @
BefÜe


44 
public
 
	$lßdPrİ”t›s
() {

45 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

46 
cÜfuSšgËNodePÜt
 = 
IÁeg”
.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodePort"));

47 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
("%s:%d",

48 
cÜfuSšgËNodeHo¡
, 
cÜfuSšgËNodePÜt
);

49 
	}
}

57 @
Te¡


58 
public
 
	$‹¡1NodeSimuÏtiÚDrİPÚg
(è
throws
 
Exû±iÚ
 {

60 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSšgËNodePÜt
);

63 
Li¡
<
MsgHªdlšgF‹r
> 
hªdlšgF‹rs
 = 
Ãw
 
A¼ayLi¡
<>();

64 
fš®
 
FunùiÚ
<
CÜfuMsg
, CÜfuMsg> 
drİPÚg
 = 
a
 -> (a.
	`g‘MsgTy³
(è=ğ
CÜfuMsgTy³
.
PONG
 ? 
nuÎ
 :‡);

66 
MsgHªdlšgF‹r
 
f‹r
 = 
Ãw
 
	`MsgHªdlšgF‹r
(
a
 -> 
Œue
, 
drİPÚg
);

67 
hªdlšgF‹rs
.
	`add
(
f‹r
);

70 
fš®
 
CÜfuRuÁimeP¬am‘”s
.
CÜfuRuÁimeP¬am‘”sBud”
 
·¿m‘”sBud”
 =

71 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
();

72 
·¿m‘”sBud”
.
	`Ã‰yCl›ÁInboundMsgF‹rs
(
hªdlšgF‹rs
);

73 
fš®
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
 = 
·¿m‘”sBud”
.
	`bud
();

76 
ruÁime
 = 
CÜfuRuÁime


77 .
	`äomP¬am‘”s
(
cÜfuRuÁimeP¬am‘”s
)

78 .
	`·r£CÚfigu¿tiÚSŒšg
(
sšgËNodeEndpošt
)

79 .
	`cÚÃù
();

82 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(0L);

83 
	`as£¹Th©ThrownBy
((è-> 
ruÁime
.
	`g‘LayoutV›w
()

84 .
	`g‘RuÁimeLayout
()

85 .
	`g‘Ba£Cl›Á
(
sšgËNodeEndpošt
)

86 .
	`pšg
()

87 .
	`g‘
())

88 .
	`hasRoÙCau£In¡ªûOf
(
TimeoutExû±iÚ
.
şass
);

89 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

90 
	}
}

102 @
Te¡


103 
public
 
	$‹¡1NodeMsgF‹rH–³rSimuÏtiÚRªdomDrİLayoutRe¥Ú£
(è
throws
 
Exû±iÚ
 {

105 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSšgËNodePÜt
);

109 
Li¡
<
MsgHªdlšgF‹r
> 
hªdlšgF‹rs
 = 
Ãw
 
A¼ayLi¡
<>();

110 
fš®
 
drİpšgProbab™y
 = 0.5;

112 
MsgHªdlšgF‹r
 
f‹r
 =

113 
MsgHªdlšgF‹r
.
	`msgDrİUnifÜmRªdomF‹rFÜ
(

114 
CŞËùiÚs
.
	`sšgËtÚ
(
CÜfuMsgTy³
.
LAYOUT_RESPONSE
),

115 
drİpšgProbab™y
);

116 
hªdlšgF‹rs
.
	`add
(
f‹r
);

119 
fš®
 
CÜfuRuÁimeP¬am‘”s
.
CÜfuRuÁimeP¬am‘”sBud”
 
·¿m‘”sBud”
 =

120 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
();

121 
·¿m‘”sBud”
.
	`Ã‰yCl›ÁInboundMsgF‹rs
(
hªdlšgF‹rs
);

122 
fš®
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
 = 
·¿m‘”sBud”
.
	`bud
();

125 
ruÁime
 = 
CÜfuRuÁime


126 .
	`äomP¬am‘”s
(
cÜfuRuÁimeP¬am‘”s
)

127 .
	`·r£CÚfigu¿tiÚSŒšg
(
sšgËNodeEndpošt
)

128 .
	`cÚÃù
();

131 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(0L);

132 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
()

133 .
	`g‘RuÁimeLayout
()

134 .
	`g‘Ba£Cl›Á
(
sšgËNodeEndpošt
)

135 .
	`g‘V”siÚInfo
().
	`g‘
())

136 .
	`isNÙNuÎ
();

137 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

138 
	}
}

145 @
Te¡


146 
public
 
	$‹¡1NodeSimuÏtiÚAÎowAÎ
(è
throws
 
Exû±iÚ
 {

148 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSšgËNodePÜt
);

151 
Li¡
<
MsgHªdlšgF‹r
> 
hªdlšgF‹rs
 = 
Ãw
 
A¼ayLi¡
<>();

152 
fš®
 
FunùiÚ
<
CÜfuMsg
, CÜfuMsg> 
®lowAÎ
 = 
a
 ->‡;

154 
MsgHªdlšgF‹r
 
f‹r
 = 
Ãw
 
	`MsgHªdlšgF‹r
(
a
 -> 
Œue
,

155 
®lowAÎ
);

156 
hªdlšgF‹rs
.
	`add
(
f‹r
);

159 
fš®
 
CÜfuRuÁimeP¬am‘”s
.
CÜfuRuÁimeP¬am‘”sBud”
 
·¿m‘”sBud”
 =

160 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
();

161 
·¿m‘”sBud”
.
	`Ã‰yCl›ÁInboundMsgF‹rs
(
hªdlšgF‹rs
);

162 
fš®
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
 = 
·¿m‘”sBud”
.
	`bud
();

165 
ruÁime
 = 
CÜfuRuÁime


166 .
	`äomP¬am‘”s
(
cÜfuRuÁimeP¬am‘”s
)

167 .
	`·r£CÚfigu¿tiÚSŒšg
(
sšgËNodeEndpošt
)

168 .
	`cÚÃù
();

171 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(0L);

172 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
()

173 .
	`g‘RuÁimeLayout
()

174 .
	`g‘Ba£Cl›Á
(
sšgËNodeEndpošt
)

175 .
	`g‘V”siÚInfo
().
	`g‘
())

176 .
	`isNÙNuÎ
();

177 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

178 
	}
}

186 @
Te¡


187 
public
 
	$‹¡1NodeSimuÏtiÚDi§bËdDrİAÎ
(è
throws
 
Exû±iÚ
 {

189 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSšgËNodePÜt
);

192 
Li¡
<
MsgHªdlšgF‹r
> 
hªdlšgF‹rs
 = 
Ãw
 
A¼ayLi¡
<>();

193 
fš®
 
FunùiÚ
<
CÜfuMsg
, CÜfuMsg> 
drİAÎ
 = 
a
 -> 
nuÎ
;

195 
MsgHªdlšgF‹r
 
f‹r
 = 
Ãw
 
	`MsgHªdlšgF‹r
(
a
 -> 
çl£
,

196 
drİAÎ
);

197 
hªdlšgF‹rs
.
	`add
(
f‹r
);

200 
fš®
 
CÜfuRuÁimeP¬am‘”s
.
CÜfuRuÁimeP¬am‘”sBud”
 
·¿m‘”sBud”
 =

201 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
();

202 
·¿m‘”sBud”
.
	`Ã‰yCl›ÁInboundMsgF‹rs
(
hªdlšgF‹rs
);

203 
fš®
 
CÜfuRuÁimeP¬am‘”s
 
cÜfuRuÁimeP¬am‘”s
 = 
·¿m‘”sBud”
.
	`bud
();

206 
ruÁime
 = 
CÜfuRuÁime


207 .
	`äomP¬am‘”s
(
cÜfuRuÁimeP¬am‘”s
)

208 .
	`·r£CÚfigu¿tiÚSŒšg
(
sšgËNodeEndpošt
)

209 .
	`cÚÃù
();

212 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(0L);

213 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
()

214 .
	`g‘RuÁimeLayout
()

215 .
	`g‘Ba£Cl›Á
(
sšgËNodeEndpošt
)

216 .
	`g‘V”siÚInfo
().
	`g‘
())

217 .
	`isNÙNuÎ
();

218 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

219 
	}
}

	@test/src/test/java/org/corfudb/integration/CorfuReplicationE2EIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
.
	gCÜfuR•liÿtiÚDiscov”yS”viû
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gšäa¡ruùu»
.
	gCÜfuR•liÿtiÚS”v”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

13 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	g¦“p
;

14 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

16 
public
 cÏs 
	cCÜfuR•liÿtiÚE2EIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

17 
fš®
 
	mMAX_RETRY
 = 20;

18 
fš®
 
	m¦“pTime
 = 2000;

19 @
Te¡


20 
public
 
	$‹¡LogR•liÿtiÚEndToEnd
(è
throws
 
Exû±iÚ
 {

21 
ExecutÜS”viû
 
executÜS”viû
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(2);

22 
Proûss
 
aùiveCÜfu
 = 
nuÎ
;

23 
Proûss
 
¡ªdbyCÜfu
 = 
nuÎ
;

25 
Œy
 {

26 
fš®
 
SŒšg
 
¡»amA
 = "Table001";

28 
fš®
 
aùiveS™eCÜfuPÜt
 = 9000;

29 
fš®
 
¡ªdbyS™eCÜfuPÜt
 = 9001;

31 
fš®
 
SŒšg
 
aùiveEndpošt
 = 
DEFAULT_HOST
 + ":" + 
aùiveS™eCÜfuPÜt
;

32 
fš®
 
SŒšg
 
¡ªdbyEndpošt
 = 
DEFAULT_HOST
 + ":" + 
¡ªdbyS™eCÜfuPÜt
;

34 
fš®
 
numWr™es
 = 1000;

37 
aùiveCÜfu
 = 
	`runS”v”
(
aùiveS™eCÜfuPÜt
, 
Œue
);

40 
¡ªdbyCÜfu
 = 
	`runS”v”
(
¡ªdbyS™eCÜfuPÜt
, 
Œue
);

42 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

43 .
	`bud”
()

44 .
	`bud
();

46 
CÜfuRuÁime
 
aùiveRuÁime
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
).
	`£tT¿n§ùiÚLoggšg
(
Œue
);

47 
aùiveRuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
aùiveEndpošt
);

48 
aùiveRuÁime
.
	`cÚÃù
();

50 
CÜfuRuÁime
 
aùiveRuÁime1
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
).
	`£tT¿n§ùiÚLoggšg
(
Œue
);

51 
aùiveRuÁime1
.
	`·r£CÚfigu¿tiÚSŒšg
(
aùiveEndpošt
);

52 
aùiveRuÁime1
.
	`cÚÃù
();

55 
CÜfuRuÁime
 
¡ªdbyRuÁime
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
).
	`£tT¿n§ùiÚLoggšg
(
Œue
);

56 
¡ªdbyRuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
¡ªdbyEndpošt
);

57 
¡ªdbyRuÁime
.
	`cÚÃù
();

60 
CÜfuTabË
<
SŒšg
, 
IÁeg”
> 
m­A
 = 
aùiveRuÁime
.
	`g‘ObjeùsV›w
()

61 .
	`bud
()

62 .
	`£tSŒ—mName
(
¡»amA
)

63 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {

65 .
	`İ’
();

67 
CÜfuTabË
<
SŒšg
, 
IÁeg”
> 
m­ASndby
 = 
¡ªdbyRuÁime
.
	`g‘ObjeùsV›w
()

68 .
	`bud
()

69 .
	`£tSŒ—mName
(
¡»amA
)

70 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {

72 .
	`İ’
();

74 
	`as£¹Th©
(
m­A
.
	`size
()).
	`isEqu®To
(0);

76 
i
 = 0; i < 
numWr™es
; i++) {

77 
aùiveRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

78 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

79 
aùiveRuÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

82 
	`as£¹Th©
(
m­A
.
	`size
()).
	`isEqu®To
(
numWr™es
);

85 
	`as£¹Th©
(
m­ASndby
.
	`size
()).
	`isEqu®To
(0);

88 
CÜfuR•liÿtiÚS”v”
 
£rv”A
 = 
Ãw
 
	`CÜfuR•liÿtiÚS”v”
Òew 
SŒšg
[]{"9010"});

89 
Th»ad
 
s™eATh»ad
 = 
Ãw
 
	`Th»ad
(
£rv”A
);

90 
Sy¡em
.
out
.
	`´šn
("Start Corfu Log Replication Server on 9010");

91 
s™eATh»ad
.
	`¡¬t
();

93 
CÜfuR•liÿtiÚS”v”
 
£rv”B
 = 
Ãw
 
	`CÜfuR•liÿtiÚS”v”
Òew 
SŒšg
[]{"9020"});

94 
Th»ad
 
s™eBTh»ad
 = 
Ãw
 
	`Th»ad
(
£rv”B
);

95 
Sy¡em
.
out
.
	`´šn
("Start Corfu Log Replication Server on 9020");

96 
s™eBTh»ad
.
	`¡¬t
();

100 
Sy¡em
.
out
.
	`´šn
("Wait ... Snapshot Data is being„eplicated ...");

101 
m­ASndby
.
	`size
(è< 
numWr™es
) {

102 
	`¦“p
(
¦“pTime
);

103 
Sy¡em
.
out
.
	`´št
("m­A¡ªdbysiz" + 
m­ASndby
.
	`size
(è+ " m­Asiz" + 
m­A
.size());

106 
Sy¡em
.
out
.
	`´št
("m­A¡ªdbysiz" + 
m­ASndby
.
	`size
(è+ " m­Asiz" + 
m­A
.size());

110 
	`as£¹Th©
(
m­ASndby
.
	`size
()).
	`isEqu®To
(
numWr™es
);

113 
i
=0; i < 
numWr™es
/2; i++) {

114 
aùiveRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

115 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
numWr™es
 + 
i
),‚umWrites + i);

116 
aùiveRuÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

120 
Sy¡em
.
out
.
	`´šn
("Wait ... Delta Data is being„eplicated ...");

121 
m­ASndby
.
	`size
(è< (
numWr™es
 +‚umWrites/2)) {

122 
	`¦“p
(
¦“pTime
);

123 
Sy¡em
.
out
.
	`´št
("m­A¡ªdbysiz" + 
m­ASndby
.
	`size
(è+ " m­Asiz" + 
m­A
.size());

125 
Sy¡em
.
out
.
	`´št
("m­A¡ªdbysiz" + 
m­ASndby
.
	`size
(è+ " m­Asiz" + 
m­A
.size());

128 
	`as£¹Th©
(
m­ASndby
.
	`size
()).
	`isEqu®To
(
numWr™es
 +‚umWrites/2);

130 
i
 = 0; i < (
numWr™es
 +‚umWrites/2) ; i++) {

131 
	`as£¹Th©
(
m­ASndby
.
	`cÚšsKey
(
SŒšg
.
	`v®ueOf
(
i
)));

133 
	`as£¹Th©
(
m­ASndby
.
	`keyS‘
().
	`cÚšsAÎ
(
m­A
.keySet()));

135 
SŒšg
 
´im¬y
 = 
£rv”A
.
	`g‘S™eMªag”Ad­‹r
().
	`g‘S™eCÚfig
().
	`g‘Prim¬yS™e
().
	`g‘S™eId
();

136 
SŒšg
 
cu¼’tPim¬y
 = 
£rv”A
.
	`g‘S™eMªag”Ad­‹r
().
	`g‘S™eCÚfig
().
	`g‘Prim¬yS™e
().
	`g‘S™eId
();

197 } 
fš®ly
 {

198 
executÜS”viû
.
	`shutdownNow
();

200 ià(
aùiveCÜfu
 !ğ
nuÎ
) {

201 
aùiveCÜfu
.
	`de¡roy
();

204 ià(
¡ªdbyCÜfu
 !ğ
nuÎ
) {

205 
¡ªdbyCÜfu
.
	`de¡roy
();

209 
	}
}

	@test/src/test/java/org/corfudb/integration/CorfuStoreBrowserIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
;

5 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

6 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gbrow£r
.
	gCÜfuStÜeBrow£r
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicRecÜd
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTxBud”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
;

23 
public
 cÏs 
	cCÜfuStÜeBrow£rIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

25 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

27 
´iv©e
 
	mcÜfuSŒšgNodePÜt
;

29 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

33 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”
(
SŒšg
 
ho¡
, 
pÜt
è
throws


34 
IOExû±iÚ
 {

35  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

36 .
	`£tHo¡
(
ho¡
)

37 .
	`£tPÜt
(
pÜt
)

38 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
ho¡
, 
pÜt
))

39 .
	`£tSšgË
(
Œue
)

40 .
	`runS”v”
();

46 @
BefÜe


47 
public
 
	$lßdPrİ”t›s
() {

48 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

49 
cÜfuSŒšgNodePÜt
 = 
IÁeg”
.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
(

51 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
(

53 
cÜfuSšgËNodeHo¡
,

54 
cÜfuSŒšgNodePÜt


56 
	}
}

66 @
Te¡


67 
public
 
	$brow£rTe¡
(è
throws


68 
IOExû±iÚ
,

69 
NoSuchM‘hodExû±iÚ
,

70 
IÎeg®AcûssExû±iÚ
,

71 
InvoÿtiÚT¬g‘Exû±iÚ
 {

72 
fš®
 
SŒšg
 
Çme¥aû
 = "namespace";

73 
fš®
 
SŒšg
 
bËName
 = "table";

74 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
,

75 
cÜfuSŒšgNodePÜt
);

78 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

80 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

82 
¡Üe
.
	`İ’TabË
(

83 
Çme¥aû
,

84 
bËName
,

85 
Sam¶eSchema
.
Uuid
.
şass
,

86 
Sam¶eSchema
.
Uuid
.
şass
,

87 
Sam¶eSchema
.
Uuid
.
şass
,

88 
TabËO±iÚs
.
	`bud”
().
	`bud
());

90 
fš®
 
keyUuid
 = 1L;

91 
fš®
 
v®ueUuid
 = 3L;

92 
fš®
 
m‘ad©aUuid
 = 5L;

94 
Sam¶eSchema
.
Uuid
 
uuidKey
 = Sam¶eSchema.Uuid.
	`ÃwBud”
()

95 .
	`£tMsb
(
keyUuid
)

96 .
	`£tLsb
(
keyUuid
)

97 .
	`bud
();

98 
Sam¶eSchema
.
Uuid
 
uuidV®
 = Sam¶eSchema.Uuid.
	`ÃwBud”
()

99 .
	`£tMsb
(
v®ueUuid
)

100 .
	`£tLsb
(
v®ueUuid
)

101 .
	`bud
();

102 
Sam¶eSchema
.
Uuid
 
m‘ad©a
 = Sam¶eSchema.Uuid.
	`ÃwBud”
()

103 .
	`£tMsb
(
m‘ad©aUuid
)

104 .
	`£tLsb
(
m‘ad©aUuid
)

105 .
	`bud
();

106 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
(
Çme¥aû
);

107 
tx
.
	`ü—‹
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

108 .
	`upd©e
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

109 .
	`comm™
();

110 
ruÁime
.
	`shutdown
();

112 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

113 
CÜfuStÜeBrow£r
 
brow£r
 = 
Ãw
 
	`CÜfuStÜeBrow£r
(
ruÁime
);

115 
As£¹
.
	`as£¹Equ®s
(
brow£r
.
	`li¡TabËs
(
Çme¥aû
), 1);

118 
CÜfuTabË
 
bË
 = 
brow£r
.
	`g‘TabË
(
Çme¥aû
, 
bËName
);

119 
As£¹
.
	`as£¹Equ®s
(
brow£r
.
	`´štTabË
(
Çme¥aû
, 
bËName
), 1);

120 
Objeù
 
obj
 : 
bË
.
	`v®ues
()) {

121 
CÜfuDyÇmicRecÜd
 
»cÜd
 = (CÜfuDyÇmicRecÜd)
obj
;

122 
As£¹
.
	`as£¹Equ®s
(

123 
UnknownF›ldS‘
.
	`ÃwBud”
().
	`bud
(),

124 
»cÜd
.
	`g‘Paylßd
().
	`g‘UnknownF›lds
());

128 
As£¹
.
	`as£¹Equ®s
(
brow£r
.
	`´štTabËInfo
(
Çme¥aû
, 
bËName
), 1);

130 
As£¹
.
	`as£¹Equ®s
(
brow£r
.
	`drİTabË
(
Çme¥aû
, 
bËName
), 1);

132 
As£¹
.
	`as£¹Equ®s
(
brow£r
.
	`´štTabËInfo
(
Çme¥aû
, 
bËName
), 0);

133 
	}
}

143 @
Te¡


144 
public
 
	$Ã¡edPrÙoTe¡
(è
throws


145 
IOExû±iÚ
,

146 
NoSuchM‘hodExû±iÚ
,

147 
IÎeg®AcûssExû±iÚ
,

148 
InvoÿtiÚT¬g‘Exû±iÚ
 {

149 
fš®
 
SŒšg
 
Çme¥aû
 = "namespace";

150 
fš®
 
SŒšg
 
bËName
 = "table";

151 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

154 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

156 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

158 
fš®
 
keyUuid
 = 10L;

159 
fš®
 
ruËIdV®
 = 50L;

160 
fš®
 
m‘aUuid
 = 100L;

162 
¡Üe
.
	`İ’TabË
(

163 
Çme¥aû
,

164 
bËName
,

165 
Sam¶eSchema
.
Uuid
.
şass
,

166 
Sam¶eSchema
.
Fœew®lRuË
.
şass
,

167 
Sam¶eSchema
.
Uuid
.
şass
,

168 
TabËO±iÚs
.
	`bud”
().
	`bud
());

170 
Sam¶eSchema
.
Uuid
 
uuidKey
 = Sam¶eSchema.Uuid.
	`ÃwBud”
().
	`£tLsb
(
keyUuid
)

171 .
	`£tMsb
(
keyUuid
).
	`bud
();

172 
Sam¶eSchema
.
Fœew®lRuË
 
fœew®lRuËV®
 = Sam¶eSchema.Fœew®lRuË.
	`ÃwBud”
()

173 .
	`£tRuËId
(
ruËIdV®
).
	`£tRuËName
("Test Rule")

174 .
	`£tIÅut
(

175 
Sam¶eAµlŸnû
.
AµlŸnû
.
	`ÃwBud”
().
	`£tEndpošt
("localhost"))

176 .
	`£tOuut
(

177 
Sam¶eAµlŸnû
.
AµlŸnû
.
	`ÃwBud”
().
	`£tEndpošt
("localhost"))

178 .
	`bud
();

179 
Sam¶eSchema
.
Uuid
 
uuidM‘a
 = Sam¶eSchema.Uuid.
	`ÃwBud”
().
	`£tLsb
(
m‘aUuid
)

180 .
	`£tMsb
(
m‘aUuid
).
	`bud
();

181 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
(
Çme¥aû
);

182 
tx
.
	`ü—‹
(
bËName
, 
uuidKey
, 
fœew®lRuËV®
, 
uuidM‘a
)

183 .
	`upd©e
(
bËName
, 
uuidKey
, 
fœew®lRuËV®
, 
uuidM‘a
)

184 .
	`comm™
();

185 
ruÁime
.
	`shutdown
();

187 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

188 
CÜfuStÜeBrow£r
 
brow£r
 = 
Ãw
 
	`CÜfuStÜeBrow£r
(
ruÁime
);

189 
CÜfuTabË
 
bË
 = 
brow£r
.
	`g‘TabË
(
Çme¥aû
, 
bËName
);

190 
brow£r
.
	`´štTabË
(
Çme¥aû
, 
bËName
);

191 
As£¹
.
	`as£¹Equ®s
(1, 
bË
.
	`size
());

193 
Objeù
 
obj
 : 
bË
.
	`v®ues
()) {

194 
CÜfuDyÇmicRecÜd
 
»cÜd
 = (CÜfuDyÇmicRecÜd)
obj
;

195 
As£¹
.
	`as£¹Equ®s
(

196 
UnknownF›ldS‘
.
	`ÃwBud”
().
	`bud
(),

197 
»cÜd
.
	`g‘Paylßd
().
	`g‘UnknownF›lds
());

199 
	}
}

209 @
Te¡


210 
public
 
	$brow£rRegi¡ryTabËTe¡
(è
throws


211 
IOExû±iÚ
,

212 
NoSuchM‘hodExû±iÚ
,

213 
IÎeg®AcûssExû±iÚ
,

214 
InvoÿtiÚT¬g‘Exû±iÚ
 {

215 
fš®
 
SŒšg
 
Çme¥aû
 = "namespace";

216 
fš®
 
SŒšg
 
bËName
 = "table";

217 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
,

218 
cÜfuSŒšgNodePÜt
);

221 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

223 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

225 
¡Üe
.
	`İ’TabË
(

226 
Çme¥aû
,

227 
bËName
,

228 
Sam¶eSchema
.
Uuid
.
şass
,

229 
Sam¶eSchema
.
Uuid
.
şass
,

230 
Sam¶eSchema
.
Uuid
.
şass
,

231 
TabËO±iÚs
.
	`bud”
().
	`bud
());

233 
fš®
 
keyUuid
 = 1L;

234 
fš®
 
v®ueUuid
 = 3L;

235 
fš®
 
m‘ad©aUuid
 = 5L;

237 
Sam¶eSchema
.
Uuid
 
uuidKey
 = Sam¶eSchema.Uuid.
	`ÃwBud”
()

238 .
	`£tMsb
(
keyUuid
)

239 .
	`£tLsb
(
keyUuid
)

240 .
	`bud
();

241 
Sam¶eSchema
.
Uuid
 
uuidV®
 = Sam¶eSchema.Uuid.
	`ÃwBud”
()

242 .
	`£tMsb
(
v®ueUuid
)

243 .
	`£tLsb
(
v®ueUuid
)

244 .
	`bud
();

245 
Sam¶eSchema
.
Uuid
 
m‘ad©a
 = Sam¶eSchema.Uuid.
	`ÃwBud”
()

246 .
	`£tMsb
(
m‘ad©aUuid
)

247 .
	`£tLsb
(
m‘ad©aUuid
)

248 .
	`bud
();

249 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
(
Çme¥aû
);

250 
tx
.
	`ü—‹
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

251 .
	`upd©e
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

252 .
	`comm™
();

253 
ruÁime
.
	`shutdown
();

255 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

256 
CÜfuStÜeBrow£r
 
brow£r
 = 
Ãw
 
	`CÜfuStÜeBrow£r
(
ruÁime
);

258 
As£¹
.
	`as£¹Equ®s
(2, 
brow£r
.
	`´štTabËInfo
(
TabËRegi¡ry
.
CORFU_SYSTEM_NAMESPACE
,

259 
TabËRegi¡ry
.
REGISTRY_TABLE_NAME
));

260 
	}
}

	@test/src/test/java/org/corfudb/integration/CorfuStoreIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDyÇmicMes§ge
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicKey
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuDyÇmicRecÜd
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuRecÜd
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTxBud”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùO³nO±iÚ
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gTabËRegi¡ry
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûs
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gDyÇmicPrÙobufS”Ÿliz”
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

23 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

24 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

26 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

27 
impÜt
 
	gjava
.
	gut
.
	gM­
;

28 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

30 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

31 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

36 
public
 cÏs 
	cCÜfuStÜeIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

38 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

39 
´iv©e
 
	mcÜfuSŒšgNodePÜt
;

40 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

44 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”
(
SŒšg
 
ho¡
, 
pÜt
è
throws
 
IOExû±iÚ
 {

45  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

46 .
	`£tHo¡
(
ho¡
)

47 .
	`£tPÜt
(
pÜt
)

48 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
ho¡
, 
pÜt
))

49 .
	`£tSšgË
(
Œue
)

50 .
	`runS”v”
();

56 @
BefÜe


57 
public
 
	$lßdPrİ”t›s
() {

58 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

59 
cÜfuSŒšgNodePÜt
 = 
IÁeg”
.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodePort"));

60 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
("%s:%d",

61 
cÜfuSšgËNodeHo¡
,

62 
cÜfuSŒšgNodePÜt
);

63 
	}
}

69 @
Te¡


70 
public
 
	$‹¡Tx
(è
throws
 
Exû±iÚ
 {

72 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

75 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

77 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

79 
TabË
<
Uuid
, Uuid, Uuid> 
bË
 = 
¡Üe
.
	`İ’TabË
(

80 "Çme¥aû", "bË", 
Uuid
.
şass
,

81 
Uuid
.
şass
, Uuid.class,

82 
TabËO±iÚs
.
	`bud”
().
	`bud
()

85 
fš®
 
keyUuid
 = 1L;

86 
fš®
 
v®ueUuid
 = 3L;

87 
fš®
 
m‘ad©aUuid
 = 5L;

88 
Uuid
 
uuidKey
 = Uuid.
	`ÃwBud”
()

89 .
	`£tMsb
(
keyUuid
)

90 .
	`£tLsb
(
keyUuid
)

91 .
	`bud
();

92 
Uuid
 
uuidV®
 = Uuid.
	`ÃwBud”
()

93 .
	`£tMsb
(
v®ueUuid
)

94 .
	`£tLsb
(
v®ueUuid
)

95 .
	`bud
();

96 
Uuid
 
m‘ad©a
 = Uuid.
	`ÃwBud”
()

97 .
	`£tMsb
(
m‘ad©aUuid
)

98 .
	`£tLsb
(
m‘ad©aUuid
)

99 .
	`bud
();

100 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
("namespace");

101 
tx
.
	`ü—‹
("bË", 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

102 .
	`upd©e
("bË", 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

103 .
	`comm™
();

104 
CÜfuRecÜd
 
»cÜd
 = 
bË
.
	`g‘
(
uuidKey
);

105 
	`as£¹Th©
(
»cÜd
.
	`g‘Paylßd
()).
	`isEqu®To
(
uuidV®
);

106 
	`as£¹Th©
(
»cÜd
.
	`g‘M‘ad©a
()).
	`isEqu®To
(
m‘ad©a
);

108 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

109 
	}
}

118 @
Te¡


119 
public
 
	$»adD©aW™hDyÇmicMes§ges
(è
throws
 
Exû±iÚ
 {

121 
fš®
 
SŒšg
 
Çme¥aû
 = "namespace";

122 
fš®
 
SŒšg
 
bËName
 = "table";

124 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

128 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

130 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

132 
¡Üe
.
	`İ’TabË
(

133 
Çme¥aû
,

134 
bËName
,

135 
Uuid
.
şass
,

136 
Uuid
.
şass
,

137 
MªagedResourûs
.
şass
,

138 
TabËO±iÚs
.
	`bud”
().
	`bud
());

140 
fš®
 
keyUuid
 = 1L;

141 
fš®
 
v®ueUuid
 = 3L;

142 
fš®
 
ÃwM‘ad©aUuid
 = 99L;

144 
Uuid
 
uuidKey
 = Uuid.
	`ÃwBud”
()

145 .
	`£tMsb
(
keyUuid
)

146 .
	`£tLsb
(
keyUuid
)

147 .
	`bud
();

148 
Uuid
 
uuidV®
 = Uuid.
	`ÃwBud”
()

149 .
	`£tMsb
(
v®ueUuid
)

150 .
	`£tLsb
(
v®ueUuid
)

151 .
	`bud
();

152 
MªagedResourûs
 
m‘ad©a
 = MªagedResourûs.
	`ÃwBud”
()

153 .
	`£tC»©eTime¡amp
(
keyUuid
)

154 .
	`bud
();

155 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
(
Çme¥aû
);

156 
tx
.
	`ü—‹
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

157 .
	`upd©e
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
)

158 .
	`comm™
();

160 
ruÁime
.
	`shutdown
();

164 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

166 
IS”Ÿliz”
 
dyÇmicPrÙobufS”Ÿliz”
 = 
Ãw
 
	`DyÇmicPrÙobufS”Ÿliz”
(
ruÁime
);

167 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
dyÇmicPrÙobufS”Ÿliz”
);

169 
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
cÜfuTabË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

170 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
>>() {

172 .
	`£tSŒ—mName
(
TabËRegi¡ry
.
	`g‘FuÎyQu®if›dTabËName
(
Çme¥aû
, 
bËName
))

173 .
	`£tS”Ÿliz”
(
dyÇmicPrÙobufS”Ÿliz”
)

174 .
	`İ’
();

176 
M­
.
EÁry
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
’Œy
 : 
cÜfuTabË
.
	`’ŒyS‘
()) {

177 
CÜfuDyÇmicKey
 
key
 = 
’Œy
.
	`g‘Key
();

178 
CÜfuDyÇmicRecÜd
 
v®ue
 = 
’Œy
.
	`g‘V®ue
();

179 
DyÇmicMes§ge
 
m‘aMsg
 = 
v®ue
.
	`g‘M‘ad©a
();

181 
DyÇmicMes§ge
.
Bud”
 
ÃwM‘aBud”
 = 
m‘aMsg
.
	`toBud”
();

182 
m‘aMsg
.
	`g‘AÎF›lds
().
	`fÜEach
((
f›ldDesütÜ
, 
o
) -> {

183 ià(
f›ldDesütÜ
.
	`g‘Name
().
	`equ®s
("create_timestamp")) {

184 
ÃwM‘aBud”
.
	`£tF›ld
(
f›ldDesütÜ
, 
ÃwM‘ad©aUuid
);

188 
cÜfuTabË
.
	`put
(
key
, 
Ãw
 
	`CÜfuDyÇmicRecÜd
(

189 
v®ue
.
	`g‘PaylßdTy³U¾
(),

190 
v®ue
.
	`g‘Paylßd
(),

191 
v®ue
.
	`g‘M‘ad©aTy³U¾
(),

192 
ÃwM‘aBud”
.
	`bud
()));

194 
	`as£¹Th©
(
cÜfuTabË
.
	`size
()).
	`isEqu®To
(1);

195 
MuÉiCheckpoštWr™”
<
CÜfuTabË
> 
mcw
 = 
Ãw
 MultiCheckpointWriter<>();

197 
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
> 
bËRegi¡ry
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

198 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
CÜfuDyÇmicKey
, 
CÜfuDyÇmicRecÜd
>>() {

200 .
	`£tSŒ—mName
(
TabËRegi¡ry
.
	`g‘FuÎyQu®if›dTabËName
(TabËRegi¡ry.
CORFU_SYSTEM_NAMESPACE
, TabËRegi¡ry.
REGISTRY_TABLE_NAME
))

201 .
	`£tS”Ÿliz”
(
dyÇmicPrÙobufS”Ÿliz”
)

202 .
	`addO³nO±iÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

203 .
	`İ’
();

205 
mcw
.
	`addM­
(
cÜfuTabË
);

206 
mcw
.
	`addM­
(
bËRegi¡ry
);

207 
Tok’
 
ŒimPošt
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "checkpointer");

209 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimPošt
);

210 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

211 
ruÁime
.
	`shutdown
();

215 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

216 
fš®
 
CÜfuStÜe
 
¡Üe3
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

219 
	`as£¹Th©ThrownBy
((è-> 
¡Üe3
.
	`İ’TabË
(
Çme¥aû
, 
bËName
)).

220 
	`isExaùlyIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

223 
	`as£¹Th©ThrownBy
((è-> 
¡Üe3
.
	`İ’TabË
(
Çme¥aû
, "NonExistingTableName")).

224 
	`isExaùlyIn¡ªûOf
(
NoSuchEËm’tExû±iÚ
.
şass
);

226 
¡Üe3
.
	`İ’TabË
(
Çme¥aû
, 
bËName
, 
Uuid
.
şass
, Uuid.şass, 
MªagedResourûs
.class,

227 
TabËO±iÚs
.
	`bud”
().
	`bud
());

228 
CÜfuRecÜd
<
Uuid
, 
MªagedResourûs
> 
»cÜd
 = 
¡Üe3
.
	`qu”y
(
Çme¥aû
).
	`g‘RecÜd
(
bËName
, 
uuidKey
);

229 
	`as£¹Th©
(
»cÜd
.
	`g‘M‘ad©a
().
	`g‘C»©eTime¡amp
()).
	`isEqu®To
(
ÃwM‘ad©aUuid
);

231 
¡Üe3
.
	`tx
(
Çme¥aû
).
	`upd©e
(
bËName
, 
uuidKey
, 
uuidV®
, 
m‘ad©a
).
	`comm™
();

233 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

234 
	}
}

	@test/src/test/java/org/corfudb/integration/CorfuStorePerfIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

4 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

5 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeStÜe
;

6 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

7 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

8 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

14 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gTe¡
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabË
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTxBud”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûs
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfo
;

33 
public
 cÏs 
	cCÜfuStÜeP”fIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

35 @
Te¡


36 
public
 
	$cÜfuStÜeP”fCom·risÚTe¡
(è
throws
 
Exû±iÚ
 {

37 
maxLogSize
 = 
FeUts
.
ONE_MB
 / 2;

38 
Proûss
 
£rv”1
 = 
	`runS”v”W™hQuÙa
(
DEFAULT_PORT
, 
maxLogSize
,

39 
Œue
);

41 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

42 
fš®
 
couÁ
 = 100;

43 
	`addObjeùsToTabË
(
¹
, 
couÁ
);

44 
	`addPrÙoToStÜe
(
¹
, 
couÁ
);

47 
´iv©e
 
fš®
 
¿ndomPÜt
 = 8000;

48 
´iv©e
 
fš®
 
ev’tTime
 = 20000;

49 
´iv©e
 
fš®
 
¿ndomF»q
 = 10;

51 
´iv©e
 
	$addObjeùsToTabË
(
CÜfuRuÁime
 
¹
, 
fš®
 
couÁ
) {

52 
Sy¡em
.
out
.
	`´šn
("S¹ Wr™šg Jav¨Obj" + Sy¡em.
	`cu¼’tTimeMlis
());

53 
¡¬t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

54 
M­
<
UUID
, 
Ev’t
> 
m­
 = 
¹
.
	`g‘ObjeùsV›w
()

55 .
	`bud
()

56 .
	`£tSŒ—mName
("s1")

57 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
UUID
, 
Ev’t
>>() {})

58 .
	`İ’
();

60 
Ev’t
 
ev’t
;

61 
i
=0; i<
couÁ
; i++) {

62 
ev’t
 = 
Ãw
 
	`Ev’t
(
i
, "Te¡Ev’t"+i, 
¿ndomPÜt
,

63 
ev’tTime
, 
¿ndomF»q


65 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

66 
m­
.
	`put
(
UUID
.
	`¿ndomUUID
(), 
ev’t
);

67 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

69 
’d
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

70 
Sy¡em
.
out
.
	`´šn
("TimTak’: "+ (
’d
 - 
¡¬t
));

71 
Sy¡em
.
out
.
	`´šn
("End Wr™šg Jav¨Obj" + Sy¡em.
	`cu¼’tTimeMlis
());

72 
	}
}

74 
´iv©e
 
	$addPrÙoToStÜe
(
CÜfuRuÁime
 
¹
, 
fš®
 
couÁ
) {

76 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
¹
);

79 
fš®
 
SŒšg
 
nsxMªag”
 = "nsx-manager-namespace5";

81 
fš®
 
SŒšg
 
bËName
 = "EventInfo";

83 
Sy¡em
.
out
.
	`´šn
("S¹ Wr™šg PrÙo" + Sy¡em.
	`cu¼’tTimeMlis
());

84 
¡¬t
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

87 
Œy
 {

88 
TabË
<
Uuid
, 
Ev’tInfo
, 
MªagedResourûs
> 
bË
 = 
cÜfuStÜe
.
	`İ’TabË
(

89 
nsxMªag”
,

90 
bËName
,

91 
Uuid
.
şass
,

92 
Ev’tInfo
.
şass
,

93 
MªagedResourûs
.
şass
,

95 
TabËO±iÚs
.
	`bud”
().
	`bud
());

96 } 
	`ÿtch
 (
NoSuchM‘hodExû±iÚ
 
e
) {

97 
e
.
	`´štSckT¿û
();

98 } 
	`ÿtch
 (
InvoÿtiÚT¬g‘Exû±iÚ
 
e
) {

99 
e
.
	`´štSckT¿û
();

100 } 
	`ÿtch
 (
IÎeg®AcûssExû±iÚ
 
e
) {

101 
e
.
	`´štSckT¿û
();

103 
Li¡
<
Uuid
> 
uuids
 = 
Ãw
 
A¼ayLi¡
<>();

104 
Li¡
<
Ev’tInfo
> 
ev’ts
 = 
Ãw
 
A¼ayLi¡
<>();

107 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

109 
MªagedResourûs
 
m‘ad©a
 = MªagedResourûs.
	`ÃwBud”
().
	`£tC»©eU£r
("Pª").
	`bud
();

112 
TxBud”
 
tx
 = 
cÜfuStÜe
.
	`tx
(
nsxMªag”
);

113 
tx
.
	`ü—‹
(
bËName
, 
Uuid
.
	`ÃwBud”
().
	`£tLsb
(0L).
	`£tMsb
(0L).
	`bud
(),

114 
Sam¶eSchema
.
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("sim¶eCRUD").
	`bud
(),

115 
m‘ad©a
);

116 
i
 = 0; i < 
couÁ
; i++) {

117 
UUID
 
uuid
 = UUID.
	`ÇmeUUIDFromBy‹s
(
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

118 
Uuid
 
uuidMsg
 = Uuid.
	`ÃwBud”
()

119 .
	`£tMsb
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
())

120 .
	`£tLsb
(
uuid
.
	`g‘L—¡SignifiÿÁB™s
())

121 .
	`bud
();

122 
uuids
.
	`add
(
uuidMsg
);

124 
ev’ts
.
	`add
(
Sam¶eSchema
.
Ev’tInfo
.
	`ÃwBud”
()

125 .
	`£tId
(
i
)

126 .
	`£tName
("ev’t_" + 
i
)

127 .
	`£tEv’tTime
(
i
)

128 .
	`bud
());

130 
tx
.
	`upd©e
(
bËName
, 
uuids
.
	`g‘
(
i
), 
ev’ts
.g‘(i), 
m‘ad©a
);

131 
tx
.
	`comm™
();

134 
’d
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

135 
Sy¡em
.
out
.
	`´šn
("TimTak’: " + (
’d
 - 
¡¬t
));

136 
Sy¡em
.
out
.
	`´šn
("End Wr™šg PrÙo" + Sy¡em.
	`cu¼’tTimeMlis
());

137 
	}
}

139 
´iv©e
 
Proûss
 
	$runS”v”W™hQuÙa
(
pÜt
, 
quÙa
, 
boŞ—n
 
sšgËNode
)

140 
throws
 
Exû±iÚ
 {

141 
SŒšg
 
logP©h
 = 
	`g‘CÜfuS”v”LogP©h
(
DEFAULT_HOST
, 
pÜt
);

142 
FeStÜe
 
cÜfuDœBack’d
 = 
Fes
.
	`g‘FeStÜe
(
P©hs
.
	`g‘
(
CORFU_LOG_PATH
));

143 
fsSize
 = 
cÜfuDœBack’d
.
	`g‘TÙ®S·û
();

144 
fš®
 
HUNDRED
 = 100.0;

145 
fš®
 
quÙaInP”c
 = 
quÙa
 * 
HUNDRED
 / 
fsSize
;

146  
Ãw
 
	`CÜfuS”v”RuÂ”
()

147 .
	`£tHo¡
(
DEFAULT_HOST
)

148 .
	`£tPÜt
(
pÜt
)

149 .
	`£tSšgË
(
sšgËNode
)

150 .
	`£tLogP©h
(
logP©h
)

151 .
	`£tLogSizeLim™P”ûÁage
(
DoubË
.
	`toSŒšg
(
quÙaInP”c
))

152 .
	`runS”v”
();

153 
	}
}

	@test/src/test/java/org/corfudb/integration/DefaultDataControl.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gD©aCÚŒŞ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gSourûMªag”
;

9 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gç
;

14 
public
 cÏs 
	cDeçuÉD©aCÚŒŞ
 
im¶em’ts
 
	mD©aCÚŒŞ
 {

16 @
S‘‹r


17 
´iv©e
 
SourûMªag”
 
	msourûMªag”
;

19 
´iv©e
 
	mcÚŒŞC®lsCouÁ
 = 0;

21 
´iv©e
 
DeçuÉD©aCÚŒŞCÚfig
 
	mcÚfig
;

23 @
G‘‹r


24 
´iv©e
 
Ob£rvabËV®ue
 
	mcÚŒŞC®ls
 = 
Ãw
 Ob£rvabËV®ue(
cÚŒŞC®lsCouÁ
);

26 
public
 
	$DeçuÉD©aCÚŒŞ
(
DeçuÉD©aCÚŒŞCÚfig
 
cÚfig
) {

27 
this
.
cÚfig
 = config;

30 @
Ov”ride


31 
public
 
	$»que¡SÇpshÙSync
() {

33 
cÚŒŞC®lsCouÁ
++;

34 
cÚŒŞC®ls
.
	`£tV®ue
(
cÚŒŞC®lsCouÁ
);

36 ià(
sourûMªag”
 !ğ
nuÎ
 && 
cÚfig
.
drİSÇpshÙSyncReque¡Mes§ge
 && cÚfig.
drİCouÁ
 >ğ
cÚŒŞC®lsCouÁ
) {

40 } ià(
sourûMªag”
 !ğ
nuÎ
) {

42 
Sy¡em
.
out
.
	`´šn
("----- S¹ SÇpshÙ SynøÚ Sourû: " + 
cÚŒŞC®lsCouÁ
);

43 
sourûMªag”
.
	`¡¬tSÇpshÙSync
();

45 
	`ç
("Source Manager has‚ot been set for DataControl implementation.");

47 
	}
}

49 
public
 şas 
	cDeçuÉD©aCÚŒŞCÚfig
 {

51 
´iv©e
 
boŞ—n
 
	gdrİSÇpshÙSyncReque¡Mes§ge
;

52 
´iv©e
 
	gdrİCouÁ
;

54 
public
 
DeçuÉD©aCÚŒŞCÚfig
(
boŞ—n
 
drİSÇpshÙSyncReque¡Mes§ge
, 
drİCouÁ
) {

55 
	gthis
.
	gdrİSÇpshÙSyncReque¡Mes§ge
 = 
drİSÇpshÙSyncReque¡Mes§ge
;

56 
	gthis
.
	gdrİCouÁ
 = 
drİCouÁ
;

	@test/src/test/java/org/corfudb/integration/Event.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

11 
public
 cÏs 
	cEv’t
 {

12 
´iv©e
 
	mid
;

13 
´iv©e
 
SŒšg
 
	mÇme
;

14 
´iv©e
 
	mpÜt
;

15 
´iv©e
 
	mev’t_time
;

16 
´iv©e
 
	mäequ’cy
;

18 
public
 
	$Ev’t
(
id
, 
SŒšg
 
Çme
, 
pÜt
, 
ev’t_time
, 
äeq
) {

19 
this
.
id
 = id;

20 
this
.
Çme
 =‚ame;

21 
this
.
pÜt
 =…ort;

22 
this
.
ev’t_time
 =ƒvent_time;

23 
this
.
äequ’cy
 = 
äeq
;

25 
	}
}

	@test/src/test/java/org/corfudb/integration/Harness.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
.
	gPARAMETERS
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gAb¡¿ùIT
.
	gPROPERTIES
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gAb¡¿ùIT
.
	gg‘CÜfuS”v”LogP©h
;

7 
impÜt
 
	glombok
.
	gBud”
;

8 
impÜt
 
	glombok
.
	gG‘‹r
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
.
	gAùiÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
.
	gNode
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gBoÙ¡¿pUt
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gRuÁimeP¬am‘”s
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

16 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

17 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

18 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

19 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

33 @
	gG‘‹r


34 @
Bud”


35 
public
 cÏs 
	cH¬Ãss
 {

37 
´iv©e
 
fš®
 
	mcÜfuPÜt
;

38 
´iv©e
 
fš®
 
SŒšg
 
	mcÜfuHo¡
;

39 
´iv©e
 
fš®
 
SŒšg
 
	mcÜfuEndpošt
;

41 
´iv©e
 
fš®
 
boŞ—n
 
	msEÇbËd
;

42 
´iv©e
 
fš®
 
SŒšg
 
	mruÁimeP©hToKeyStÜe
;

43 
´iv©e
 
fš®
 
SŒšg
 
	mruÁimeP©hToKeyStÜePasswÜd
;

44 
´iv©e
 
fš®
 
SŒšg
 
	mruÁimeP©hToTru¡StÜe
;

45 
´iv©e
 
fš®
 
SŒšg
 
	mruÁimeP©hToTru¡StÜePasswÜd
;

46 
´iv©e
 
fš®
 
SŒšg
 
	m£rv”P©hToKeyStÜe
;

47 
´iv©e
 
fš®
 
SŒšg
 
	m£rv”P©hToKeyStÜePasswÜd
;

48 
´iv©e
 
fš®
 
SŒšg
 
	m£rv”P©hToTru¡StÜe
;

49 
´iv©e
 
fš®
 
SŒšg
 
	m£rv”P©hToTru¡StÜePasswÜd
;

50 
´iv©e
 
fš®
 
	mcÚÃùiÚTimeout
;

61 
public
 
H¬Ãss
 
	$g‘DeçuÉH¬Ãss
() {

62 
fš®
 
SŒšg
 
cÜfuHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuHost");

63 
fš®
 
cÜfuPÜt
 = 
IÁeg”
.
	`·r£IÁ
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuPort"));

64 
fš®
 
BoŞ—n
 
sEÇbËd
 = BoŞ—n.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
("tlsEnabledHarness"));

66 
H¬ÃssBud”
 
h¬ÃssBud”
 = 
Ãw
 
	`H¬ÃssBud”
()

67 .
	`cÜfuHo¡
(
cÜfuHo¡
)

68 .
	`cÜfuPÜt
(
cÜfuPÜt
)

69 .
	`cÜfuEndpošt
(
SŒšg
.
	`fÜm©
("%s:%d", 
cÜfuHo¡
, 
cÜfuPÜt
))

70 .
	`sEÇbËd
(
sEÇbËd
)

71 .
	`cÚÃùiÚTimeout
(
IÁeg”
.
	`·r£IÁ
(
PROPERTIES
.
	`g‘Prİ”ty
("connectionTimeout")));

72 ià(
sEÇbËd
) {

73 
h¬ÃssBud”


74 .
	`£rv”P©hToKeyStÜe
(

75 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToKeyStore"))

76 .
	`£rv”P©hToKeyStÜePasswÜd
(

77 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToKeyStorePassword"))

78 .
	`£rv”P©hToTru¡StÜe
(

79 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToTrustStore"))

80 .
	`£rv”P©hToTru¡StÜePasswÜd
(

81 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToTrustStorePassword"))

82 .
	`ruÁimeP©hToKeyStÜe
(

83 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToKeyStore"))

84 .
	`ruÁimeP©hToKeyStÜePasswÜd
(

85 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToKeyStorePassword"))

86 .
	`ruÁimeP©hToTru¡StÜe
(

87 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToTrustStore"))

88 .
	`ruÁimeP©hToTru¡StÜePasswÜd
(

89 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToTrustStorePassword"));

91  
h¬ÃssBud”
.
	`bud
();

102 
´iv©e
 
SŒšg
 
	$g‘Prİ”tyAbsŞu‹P©h
(
SŒšg
 
·thPrİ”ty
) {

103 ià((
PROPERTIES
.
	`g‘Prİ”ty
(
·thPrİ”ty
)è=ğ
nuÎ
 ||

104 
Fes
.
	`nÙExi¡s
(
P©hs
.
	`g‘
(
PROPERTIES
.
	`g‘Prİ”ty
(
·thPrİ”ty
)).
	`toAbsŞu‹P©h
())) {

105 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(

106 
SŒšg
.
	`fÜm©
("CorfuDB.properties contains invalid or‚onƒxistent value for :%s",

107 
·thPrİ”ty
));

110  
P©hs
.
	`g‘
(
PROPERTIES
.
	`g‘Prİ”ty
(
·thPrİ”ty
)).
	`toAbsŞu‹P©h
().
	`toSŒšg
();

111 
	}
}

113 
´iv©e
 
SŒšg
 
	$g‘Add»ssFÜNode
(
pÜt
) {

114  
cÜfuHo¡
 + ":" + 
pÜt
;

115 
	}
}

123 
´iv©e
 
Layout
 
	$g‘LayoutFÜNodes
(
nodeCouÁ
) {

124 
Li¡
<
SŒšg
> 
ÏyoutS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

125 
Li¡
<
SŒšg
> 
£qu’ûr
 = 
Ãw
 
A¼ayLi¡
<>();

126 
Li¡
<
Layout
.
LayoutSegm’t
> 
£gm’ts
 = 
Ãw
 
A¼ayLi¡
<>();

127 
UUID
 
şu¡”Id
 = UUID.
	`¿ndomUUID
();

128 
Li¡
<
SŒšg
> 
¡rS”v”s
 = 
Ãw
 
A¼ayLi¡
<>();

130 
•och
 = 0;

132 
x
 = 0; x < 
nodeCouÁ
; x++) {

133 
pÜt
 = 
cÜfuPÜt
 + 
x
;

134 
ÏyoutS”v”s
.
	`add
(
	`g‘Add»ssFÜNode
(
pÜt
));

135 
£qu’ûr
.
	`add
(
	`g‘Add»ssFÜNode
(
pÜt
));

136 
¡rS”v”s
.
	`add
(
	`g‘Add»ssFÜNode
(
pÜt
));

139 
Layout
.
LayoutSegm’t
 
£gm’t
 = 
Ãw
 Layout.
	`LayoutSegm’t
(Layout.
R•liÿtiÚMode
.
CHAIN_REPLICATION
, 0L, -1L,

140 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
Layout
.
	`LayoutSŒe
(
¡rS”v”s
)));

141 
£gm’ts
.
	`add
(
£gm’t
);

142  
Ãw
 
	`Layout
(
ÏyoutS”v”s
, 
£qu’ûr
, 
£gm’ts
, 
•och
, 
şu¡”Id
);

143 
	}
}

145 
SŒšg
 
	$g‘Clu¡”CÚÃùiÚSŒšg
(
n
) {

146 
SŒšgBud”
 
cÚn
 = 
Ãw
 
	`SŒšgBud”
();

148 
i
 = 0; i < 
n
; i++) {

149 
pÜt
 = 
cÜfuPÜt
 + 
i
;

150 
cÚn
.
	`­³nd
(
cÜfuHo¡
)

151 .
	`­³nd
(":")

152 .
	`­³nd
(
pÜt
)

153 .
	`­³nd
(",");

157  
cÚn
.
	`Ëngth
(è> 0 ? cÚn.
	`toSŒšg
().
	`sub¡ršg
(0, conn.length() - 1) : "" ;

158 
	}
}

166 
public
 
	$run
(
AùiÚ
... 
aùiÚs
è
throws
 
Exû±iÚ
 {

167 
AùiÚ
 
aùiÚ
 : 
aùiÚs
) {

168 
aùiÚ
.
	`run
();

170 
	}
}

179 
public
 
	gLi¡
<
	gNode
> 
	$d•loyClu¡”
(
n
è
throws
 
IOExû±iÚ
 {

180 
Li¡
<
Node
> 
nodes
 = 
Ãw
 
A¼ayLi¡
<>(
n
);

181 
SŒšg
 
cÚn
 = 
	`g‘Clu¡”CÚÃùiÚSŒšg
(
n
);

182 
i
 = 0; i < 
n
; i++) {

183 
pÜt
 = 
cÜfuPÜt
 + 
i
;

184 
Proûss
 
´oc
 = 
	`runS”v”OnPÜt
(
pÜt
);

185 
nodes
.
	`add
(
Ãw
 
	`Node
(
	`g‘Add»ssFÜNode
(
pÜt
), 
cÚn
, 
	`g‘CÜfuS”v”LogP©h
(
cÜfuHo¡
,…ort)));

188 
fš®
 
Layout
 
Ïyout
 = 
	`g‘LayoutFÜNodes
(
n
);

189 
fš®
 
»Œ›s
 = 3;

190 
RuÁimeP¬am‘”s
 
ruÁimeP¬am‘”s
 = 
	`ü—‹RuÁimeP¬am‘”s
();

191 
BoÙ¡¿pUt
.
	`boÙ¡¿p
(
Ïyout
, (
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
)
ruÁimeP¬am‘”s
, 
»Œ›s
, 
PARAMETERS
.
TIMEOUT_LONG
);

192  
nodes
;

193 
	}
}

203 
´iv©e
 
RuÁimeP¬am‘”s
 
	$ü—‹RuÁimeP¬am‘”s
() {

204 ià(
sEÇbËd
) {

205  
RuÁimeP¬am‘”s


206 .
	`bud”
()

207 .
	`cÚÃùiÚTimeout
(
Du¿tiÚ
.
	`ofMlis
(
cÚÃùiÚTimeout
))

208 .
	`sEÇbËd
(
sEÇbËd
)

209 .
	`keyStÜe
(
£rv”P©hToKeyStÜe
)

210 .
	`ksPasswÜdFe
(
£rv”P©hToKeyStÜePasswÜd
)

211 .
	`Œu¡StÜe
(
£rv”P©hToTru¡StÜe
)

212 .
	`tsPasswÜdFe
(
£rv”P©hToTru¡StÜePasswÜd
)

213 .
	`bud
();

215  
RuÁimeP¬am‘”s


216 .
	`bud”
()

217 .
	`cÚÃùiÚTimeout
(
Du¿tiÚ
.
	`ofMlis
(
cÚÃùiÚTimeout
)).
	`bud
();

219 
	}
}

234 
´iv©e
 
Proûss
 
	$runS”v”OnPÜt
(
pÜt
è
throws
 
IOExû±iÚ
 {

235  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

236 .
	`£tHo¡
(
cÜfuHo¡
)

237 .
	`£tPÜt
(
pÜt
)

238 .
	`£tTlsEÇbËd
(
sEÇbËd
)

239 .
	`£tKeyStÜe
(
£rv”P©hToKeyStÜe
)

240 .
	`£tKeyStÜePasswÜd
(
£rv”P©hToKeyStÜePasswÜd
)

241 .
	`£tTru¡StÜe
(
£rv”P©hToTru¡StÜe
)

242 .
	`£tTru¡StÜePasswÜd
(
£rv”P©hToTru¡StÜePasswÜd
)

243 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
cÜfuHo¡
, 
pÜt
))

244 .
	`£tSšgË
(
çl£
)

245 .
	`runS”v”
();

246 
	}
}

255 
public
 
Node
 
	$d•loyUnboÙ¡¿µedNode
(
pÜt
è
throws
 
IOExû±iÚ
 {

257 
Proûss
 
´oc
 = 
	`runS”v”OnPÜt
(
pÜt
);

258  
Ãw
 
	`Node
(
	`g‘Add»ssFÜNode
(
pÜt
), 
	`g‘CÜfuS”v”LogP©h
(
cÜfuHo¡
,…ort));

259 
	}
}

269 
public
 
CÜfuRuÁime
 
	$ü—‹RuÁimeFÜNode
(
Node
 
node
) {

270 
fš®
 
CÜfuRuÁime
 
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
node
.
	`g‘Clu¡”Add»ss
());

272 ià(
sEÇbËd
) {

273 
ruÁime
.
	`’abËTls
(

274 
ruÁimeP©hToKeyStÜe
,

275 
ruÁimeP©hToKeyStÜePasswÜd
,

276 
ruÁimeP©hToTru¡StÜe
,

277 
ruÁimeP©hToTru¡StÜePasswÜd
);

279  
ruÁime
.
	`cÚÃù
();

280 
	}
}

	@test/src/test/java/org/corfudb/integration/LargeWriteIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWr™eSizeExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

21 
public
 cÏs 
	cL¬geWr™eIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

23 @
Te¡


24 
public
 
	$ÏrgeSŒ—mWr™e
(è
throws
 
Exû±iÚ
 {

26 
fš®
 
SŒšg
 
¡»amName
 = "s1";

29 
Proûss
 
£rv”_1
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

30 .
	`£tHo¡
(
DEFAULT_HOST
)

31 .
	`£tPÜt
(
DEFAULT_PORT
)

32 .
	`£tSšgË
(
Œue
)

33 .
	`runS”v”
();

35 
fš®
 
maxWr™eSize
 = 100;

38 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

39 .
	`bud”
()

40 .
	`maxWr™eSize
(
maxWr™eSize
)

41 .
	`bud
();

43 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

44 
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

45 
ruÁime
.
	`cÚÃù
();

47 
fš®
 
bufSize
 = 
maxWr™eSize
 * 2;

50 
	`as£¹Th©ThrownBy
((è-> 
ruÁime
.
	`g‘SŒ—msV›w
()

51 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
))

52 .
	`­³nd
(
Ãw
 
by‹
[
bufSize
]))

53 .
	`isIn¡ªûOf
(
Wr™eSizeExû±iÚ
.
şass
);

54 
	`shutdownCÜfuS”v”
(
£rv”_1
);

57 @
Te¡


58 
public
 
	$ÏrgeT¿n§ùiÚ
(è
throws
 
Exû±iÚ
 {

59 
fš®
 
SŒšg
 
bËName
 = "table1";

62 
Proûss
 
£rv”_1
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

63 .
	`£tHo¡
(
DEFAULT_HOST
)

64 .
	`£tPÜt
(
DEFAULT_PORT
)

65 .
	`£tSšgË
(
Œue
)

66 .
	`runS”v”
();

68 
fš®
 
maxWr™eSize
 = 100;

71 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

72 .
	`bud”
()

73 .
	`maxWr™eSize
(
maxWr™eSize
)

74 .
	`bud
();

76 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

77 
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

78 
ruÁime
.
	`cÚÃù
();

80 
SŒšg
 
ÏrgePaylßd
 = 
Ãw
 
	`SŒšg
Òew 
by‹
[
maxWr™eSize
 * 2]);

82 
M­
<
SŒšg
, SŒšg> 
m­
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

83 .
	`bud
()

84 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

85 .
	`£tSŒ—mName
(
bËName
)

86 .
	`İ’
();

89 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

90 
m­
.
	`put
("key1", 
ÏrgePaylßd
);

91 
boŞ—n
 
abÜ‹d
 = 
çl£
;

92 
Œy
 {

93 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

94 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

95 
abÜ‹d
 = 
Œue
;

96 
	`as£¹Th©
(
e
.
	`g‘Cau£
()).
	`isIn¡ªûOf
(
Wr™eSizeExû±iÚ
.
şass
);

97 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
SIZE_EXCEEDED
);

99 
	`as£¹Th©
(
abÜ‹d
).
	`isTrue
();

100 
	`shutdownCÜfuS”v”
(
£rv”_1
);

101 
	}
}

	@test/src/test/java/org/corfudb/integration/LockIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gTe¡LockLi¡’”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLock
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockCl›Á
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockLi¡’”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
.
	gLockS‹
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
.
	gLockS‹Ty³
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

17 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gOb£rvabË
;

24 
impÜt
 
	gjava
.
	gut
.
	gOb£rv”
;

25 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gC®ÏbË
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

30 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

31 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

33 
public
 cÏs 
	cLockIT
 
ex‹nds
 
Ab¡¿ùIT
 
im¶em’ts
 
	mOb£rv”
 {

35 
fš®
 
	mLOCK_TIME_CONSTANT
 = 6;

36 
fš®
 
	mLOCK_LEASE_DURATION
 = 15;

37 
fš®
 
	mRENEW_CYCLES
 = 5;

39 
fš®
 
SŒšg
 
	mLOCK_GROUP
 = "Default_Lock_Group";

40 
fš®
 
SŒšg
 
	mLOCK_NAME
 = "Test_Lock";

42 
´iv©e
 
	mM­
<
	mUUID
, 
	mOb£rvabËV®ue
> 
	mlockAcquœedOb£rvabËs
 = 
Ãw
 
HashM­
<>();

43 
´iv©e
 
	mM­
<
	mUUID
, 
	mOb£rvabËV®ue
> 
	mlockRevokedOb£rvabËs
 = 
Ãw
 
HashM­
<>();

44 
´iv©e
 
	mM­
<
	mUUID
, 
	mCÜfuRuÁime
> 
	mş›ÁIdToRuÁimeM­
 = 
Ãw
 
HashM­
<>();

47 
´iv©e
 
fš®
 
Sem­hÜe
 
	mblockUÁWa™CÚd™iÚ
 = 
Ãw
 Sem­hÜe(1, 
Œue
);

49 
´iv©e
 
Proûss
 
	mcÜfuS”v”
 = 
nuÎ
;

50 
´iv©e
 
fš®
 
	maùiveS™eCÜfuPÜt
 = 9000;

51 
´iv©e
 
fš®
 
SŒšg
 
	mcÜfuEndpošt
 = 
DEFAULT_HOST
 + ":" + 
aùiveS™eCÜfuPÜt
;

53 
´iv©e
 
Wa™CÚd™iÚTy³
 
	mwa™CÚd™iÚ
 = Wa™CÚd™iÚTy³.
NONE
;

59 @
Te¡


60 
public
 
	$‹¡SšgËLockCl›Á
(è
throws
 
Exû±iÚ
 {

62 
Œy
 {

64 
cÜfuS”v”
 = 
	`runS”v”
(
aùiveS™eCÜfuPÜt
, 
Œue
);

65 
	`š™Ÿlize
();

68 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

70 
UUID
 
ş›ÁId
 = UUID.
	`¿ndomUUID
();

71 
LockCl›Á
 
ş›Á
 = 
	`ü—‹LockCl›Á
(
ş›ÁId
);

72 
LockLi¡’”
 
li¡’”
 = 
	`ü—‹LockCl›ÁLi¡’”
(
ş›ÁId
);

74 
ş›Á
.
	`»gi¡”IÁ”e¡
(
LOCK_GROUP
, 
LOCK_NAME
, 
li¡’”
);

76 
LockD©aTy³s
.
LockId
 
lockId
 = LockD©aTy³s.LockId.
	`ÃwBud”
()

77 .
	`£tLockGroup
(
LOCK_GROUP
)

78 .
	`£tLockName
(
LOCK_NAME
)

79 .
	`bud
();

82 
Sy¡em
.
out
.
	`´šn
("***** Wait until†ock is‡cquired");

83 
wa™CÚd™iÚ
 = 
Wa™CÚd™iÚTy³
.
LOCK_ACQUIRED
;

84 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

86 
lockCouÁ
 = 1;

87 
	`as£¹Th©
(
lockAcquœedOb£rvabËs
.
	`g‘
(
ş›ÁId
).
	`g‘V®ue
()).
	`isEqu®To
(
lockCouÁ
);

88 
	`as£¹Th©
(
ş›Á
.
	`g‘Locks
().
	`g‘
(
lockId
).
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LockS‹Ty³
.
HAS_LEASE
);

89 
	`as£¹Th©
(
lockRevokedOb£rvabËs
.
	`g‘
(
ş›ÁId
).
	`g‘V®ue
()).
	`isEqu®To
(0);

91 
wa™CÚd™iÚ
 = 
Wa™CÚd™iÚTy³
.
NONE
;

94 
i
=0; i < 
RENEW_CYCLES
; i++) {

95 
Sy¡em
.
out
.
	`´šn
("***** Wait until†ock is„enewed");

101 
SË•
.
	`¦“pUnš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(
LOCK_TIME_CONSTANT
 + 1));

102 
	`as£¹Th©
(
lockAcquœedOb£rvabËs
.
	`g‘
(
ş›ÁId
).
	`g‘V®ue
()).
	`isEqu®To
(
lockCouÁ
);

103 
	`as£¹Th©
(
ş›Á
.
	`g‘Locks
().
	`g‘
(
lockId
).
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LockS‹Ty³
.
HAS_LEASE
);

104 
	`as£¹Th©
(
lockRevokedOb£rvabËs
.
	`g‘
(
ş›ÁId
).
	`g‘V®ue
()).
	`isEqu®To
(0);

106 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

107 
Sy¡em
.
out
.
	`´šn
("UÃx³ùedƒxû±iÚ: " + 
e
);

108 
throw
 
e
;

109 } 
fš®ly
 {

110 
	`shutdown
();

118 @
Te¡


119 
public
 
	$‹¡SšgËLockCl›ÁMuÉËLocks
(è
throws
 
Exû±iÚ
 {

121 
fš®
 
numLocks
 = 10;

123 
Œy
 {

125 
cÜfuS”v”
 = 
	`runS”v”
(
aùiveS™eCÜfuPÜt
, 
Œue
);

126 
	`š™Ÿlize
();

129 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

131 
UUID
 
ş›ÁId
 = UUID.
	`¿ndomUUID
();

132 
LockCl›Á
 
ş›Á
 = 
	`ü—‹LockCl›Á
(
ş›ÁId
);

135 
LockLi¡’”
 
li¡’”
 = 
	`ü—‹LockCl›ÁLi¡’”
(
ş›ÁId
);

137 
Li¡
<
LockD©aTy³s
.
LockId
> 
lockIds
 = 
Ãw
 
A¼ayLi¡
<>();

138 
i
=0; i<
numLocks
; i++) {

140 
ş›Á
.
	`»gi¡”IÁ”e¡
(
LOCK_GROUP
, 
LOCK_NAME
 + 
i
, 
li¡’”
);

141 
lockIds
.
	`add
(
LockD©aTy³s
.
LockId
.
	`ÃwBud”
()

142 .
	`£tLockGroup
(
LOCK_GROUP
)

143 .
	`£tLockName
(
LOCK_NAME
 + 
i
)

144 .
	`bud
());

148 
wa™CÚd™iÚ
 = 
Wa™CÚd™iÚTy³
.
LOCK_ACQUIRED
;

149 
i
=0; i<
numLocks
; i++) {

150 
Sy¡em
.
out
.
	`´šn
("***** Wa™ uÁ†ock " + 
i
 + " is‡cquired");

151 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

154 
	`as£¹Th©
(
lockAcquœedOb£rvabËs
.
	`g‘
(
ş›ÁId
).
	`g‘V®ue
()).
	`isEqu®To
(
numLocks
);

155 
lockIds
.
	`fÜEach
(
lockId
 ->

156 
	`as£¹Th©
(
ş›Á
.
	`g‘Locks
().
	`g‘
(
lockId
).
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LockS‹Ty³
.
HAS_LEASE
));

157 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

158 
Sy¡em
.
out
.
	`´šn
("UÃx³ùedƒxû±iÚ: " + 
e
);

159 
throw
 
e
;

160 } 
fš®ly
 {

161 
	`shutdown
();

163 
	}
}

171 @
Te¡


172 
public
 
	$‹¡MuÉËLockCl›ÁsSameLock
(è
throws
 
Exû±iÚ
 {

174 
fš®
 
numCl›Ás
 = 3;

175 
M­
<
UUID
, 
LockCl›Á
> 
ş›ÁIdToLockCl›Á
 = 
Ãw
 
HashM­
<>();

176 
M­
<
UUID
, 
LockLi¡’”
> 
ş›ÁIdToLockLi¡’”
 = 
Ãw
 
HashM­
<>();

178 
Œy
 {

179 
cÜfuS”v”
 = 
	`runS”v”
(
aùiveS™eCÜfuPÜt
, 
Œue
);

180 
	`š™Ÿlize
();

182 
LockD©aTy³s
.
LockId
 
lockId
 = LockD©aTy³s.LockId.
	`ÃwBud”
()

183 .
	`£tLockGroup
(
LOCK_GROUP
)

184 .
	`£tLockName
(
LOCK_NAME
)

185 .
	`bud
();

187 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

191 
i
=0; i<
numCl›Ás
; i++) {

192 
UUID
 
ş›ÁId
 = UUID.
	`¿ndomUUID
();

193 
LockCl›Á
 
ş›Á
 = 
	`ü—‹LockCl›Á
(
ş›ÁId
);

194 
LockLi¡’”
 
li¡’”
 = 
	`ü—‹LockCl›ÁLi¡’”
(
ş›ÁId
);

195 
ş›ÁIdToLockCl›Á
.
	`put
(
ş›ÁId
, 
ş›Á
);

196 
ş›ÁIdToLockLi¡’”
.
	`put
(
ş›ÁId
, 
li¡’”
);

200 
ExecutÜS”viû
 
executÜS”viû
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numCl›Ás
);

202 
CŞËùiÚ
<
C®ÏbË
<
BoŞ—n
>> 
ÿÎabËLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

203 
ş›ÁIdToLockCl›Á
.
	`fÜEach
Ğ(
id
, 
ş›Á
) -> {

204 
ÿÎabËLi¡
.
	`add
(() -> {

205 
ş›Á
.
	`»gi¡”IÁ”e¡
(
LOCK_GROUP
, 
LOCK_NAME
, 
ş›ÁIdToLockLi¡’”
.
	`g‘
(
id
));

206  
Œue
;

210 
Li¡
<
Futu»
<
BoŞ—n
>> 
futu»s
 = 
executÜS”viû
.
	`švokeAÎ
(
ÿÎabËLi¡
);

213 
Futu»
<
BoŞ—n
> 
futu»
 : 
futu»s
) {

214 ià(!
futu»
.
	`isDÚe
()) {

215 
futu»
.
	`wa™
();

217 
	`as£¹Th©
(
futu»
.
	`g‘
()).
	`isTrue
();

221 ià(
	`lockHasNÙB“nAcquœed
(
lockAcquœedOb£rvabËs
)) {

222 
wa™CÚd™iÚ
 = 
Wa™CÚd™iÚTy³
.
LOCK_ACQUIRED
;

223 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

227 
Li¡
<
LockCl›Á
> 
ş›ÁsW™hLock
 = 
	`g‘Cl›ÁsTh©AcquœedLock
(
lockId
, 
ş›ÁIdToLockCl›Á
);

228 
	`as£¹Th©
(
ş›ÁsW™hLock
.
	`size
()).
	`isEqu®To
(1);

229 
LockCl›Á
 
ş›ÁW™hLock
 = 
ş›ÁsW™hLock
.
	`g‘
(0);

233 
i
=0; i < 
RENEW_CYCLES
; i++) {

234 
Sy¡em
.
out
.
	`´šn
("***** Wait until†ock is„enewed");

236 
SË•
.
	`¦“pUnš‹¼u±ibly
(
Du¿tiÚ
.
	`ofSecÚds
(
LOCK_TIME_CONSTANT
 + 1));

237 
ş›ÁsW™hLock
 = 
	`g‘Cl›ÁsTh©AcquœedLock
(
lockId
, 
ş›ÁIdToLockCl›Á
);

238 
	`as£¹Th©
(
ş›ÁsW™hLock
.
	`size
()).
	`isEqu®To
(1);

239 
	`as£¹Th©
(
ş›ÁsW™hLock
.
	`g‘
(0)).
	`isEqu®To
(
ş›ÁW™hLock
);

242 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

243 
Sy¡em
.
out
.
	`´šn
("CaughˆExû±iÚ: " + 
e
);

244 
throw
 
e
;

245 } 
fš®ly
 {

246 
	`shutdown
();

248 
	}
}

256 @
Te¡


257 
public
 
	$‹¡MuÉËLockCl›ÁsSameLockFau»
(è
throws
 
Exû±iÚ
 {

259 
fš®
 
numCl›Ás
 = 3;

260 
M­
<
UUID
, 
LockCl›Á
> 
ş›ÁIdToLockCl›Á
 = 
Ãw
 
HashM­
<>();

261 
M­
<
UUID
, 
LockLi¡’”
> 
ş›ÁIdToLockLi¡’”
 = 
Ãw
 
HashM­
<>();

263 
Œy
 {

264 
cÜfuS”v”
 = 
	`runS”v”
(
aùiveS™eCÜfuPÜt
, 
Œue
);

265 
	`š™Ÿlize
();

267 
LockD©aTy³s
.
LockId
 
lockId
 = LockD©aTy³s.LockId.
	`ÃwBud”
()

268 .
	`£tLockGroup
(
LOCK_GROUP
)

269 .
	`£tLockName
(
LOCK_NAME
)

270 .
	`bud
();

272 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

275 
i
=0; i<
numCl›Ás
; i++) {

276 
UUID
 
ş›ÁId
 = UUID.
	`¿ndomUUID
();

277 
LockCl›Á
 
ş›Á
 = 
	`ü—‹LockCl›Á
(
ş›ÁId
);

278 
LockLi¡’”
 
li¡’”
 = 
	`ü—‹LockCl›ÁLi¡’”
(
ş›ÁId
);

279 
ş›ÁIdToLockCl›Á
.
	`put
(
ş›ÁId
, 
ş›Á
);

280 
ş›ÁIdToLockLi¡’”
.
	`put
(
ş›ÁId
, 
li¡’”
);

284 
ExecutÜS”viû
 
executÜS”viû
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numCl›Ás
);

286 
CŞËùiÚ
<
C®ÏbË
<
BoŞ—n
>> 
ÿÎabËLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

287 
ş›ÁIdToLockCl›Á
.
	`fÜEach
Ğ(
id
, 
ş›Á
) -> {

288 
ÿÎabËLi¡
.
	`add
(() -> {

289 
ş›Á
.
	`»gi¡”IÁ”e¡
(
LOCK_GROUP
, 
LOCK_NAME
, 
ş›ÁIdToLockLi¡’”
.
	`g‘
(
id
));

290  
Œue
;

294 
Li¡
<
Futu»
<
BoŞ—n
>> 
futu»s
 = 
executÜS”viû
.
	`švokeAÎ
(
ÿÎabËLi¡
);

297 
Futu»
<
BoŞ—n
> 
futu»
 : 
futu»s
) {

298 ià(!
futu»
.
	`isDÚe
()) {

299 
futu»
.
	`wa™
();

301 
	`as£¹Th©
(
futu»
.
	`g‘
()).
	`isTrue
();

305 ià(
	`lockHasNÙB“nAcquœed
(
lockAcquœedOb£rvabËs
)) {

306 
wa™CÚd™iÚ
 = 
Wa™CÚd™iÚTy³
.
LOCK_ACQUIRED
;

307 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

311 
Li¡
<
LockCl›Á
> 
ş›ÁsW™hLock
 = 
	`g‘Cl›ÁsTh©AcquœedLock
(
lockId
, 
ş›ÁIdToLockCl›Á
);

312 
	`as£¹Th©
(
ş›ÁsW™hLock
.
	`size
()).
	`isEqu®To
(1);

313 
LockCl›Á
 
ş›ÁW™hLock
 = 
ş›ÁsW™hLock
.
	`g‘
(0);

316 
ş›ÁIdToRuÁimeM­
.
	`g‘
(
ş›ÁW™hLock
.
	`g‘Cl›ÁId
()).
	`shutdown
();

318 
Sy¡em
.
out
.
	`´šn
("***** Re-acquire†ock");

321 ià(
	`lockHasNÙB“nAcquœed
(
lockAcquœedOb£rvabËs
)) {

322 
wa™CÚd™iÚ
 = 
Wa™CÚd™iÚTy³
.
LOCK_ACQUIRED
;

323 
blockUÁWa™CÚd™iÚ
.
	`acquœe
();

327 
ş›ÁsW™hLock
 = 
	`g‘Cl›ÁsTh©AcquœedLock
(
lockId
, 
ş›ÁIdToLockCl›Á
);

328 
	`as£¹Th©
(
ş›ÁsW™hLock
.
	`size
()).
	`isEqu®To
(1);

329 
LockCl›Á
 
ÃwCl›ÁW™hLock
 = 
ş›ÁsW™hLock
.
	`g‘
(0);

331 
	`as£¹Th©
(
ÃwCl›ÁW™hLock
).
	`isNÙEqu®To
(
ş›ÁsW™hLock
);

333 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

334 
Sy¡em
.
out
.
	`´šn
("CaughˆExû±iÚ: " + 
e
);

335 
throw
 
e
;

336 } 
fš®ly
 {

337 
	`shutdown
();

339 
	}
}

341 
´iv©e
 
boŞ—n
 
lockHasNÙB“nAcquœed
(
M­
<
UUID
, 
Ob£rvabËV®ue
> 
lockAcquœedOb£rvabËs
) {

342  
	glockAcquœedOb£rvabËs
.
v®ues
().
¡»am
()

343 .
®lM©ch
(
acquœedOb£rvabË
 ->‡cquœedOb£rvabË.
g‘V®ue
() == 0);

346 
´iv©e
 
	gLi¡
<
	gLockCl›Á
> 
g‘Cl›ÁsTh©AcquœedLock
(
LockD©aTy³s
.
LockId
 
lockId
, 
M­
<
UUID
, 
LockCl›Á
> 
idToCl›Á
) {

347  
	gidToCl›Á
.
v®ues
().
¡»am
()

348 .
f‹r
(
ş›Á
 -> cl›Á.
g‘Locks
().
g‘
(
lockId
).
g‘S‹
().
g‘Ty³
().
equ®s
(
LockS‹Ty³
.
HAS_LEASE
))

349 .
cŞËù
(
CŞËùÜs
.
toLi¡
());

352 
´iv©e
 
LockCl›Á
 
	$ü—‹LockCl›Á
(
UUID
 
ş›ÁId
è
throws
 
Exû±iÚ
 {

353 
Œy
 {

354 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

355 .
	`bud”
()

356 .
	`bud
();

357 
CÜfuRuÁime
 
¹
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
).
	`·r£CÚfigu¿tiÚSŒšg
(
cÜfuEndpošt
).
	`cÚÃù
();

358 
ş›ÁIdToRuÁimeM­
.
	`put
(
ş›ÁId
, 
¹
);

359  
Ãw
 
	`LockCl›Á
(
ş›ÁId
, 
¹
);

361 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

362 
throw
 
e
;

364 
	}
}

366 
´iv©e
 
LockLi¡’”
 
	$ü—‹LockCl›ÁLi¡’”
(
UUID
 
ş›ÁId
) {

367 
LockLi¡’”
 
li¡’”
 = 
Ãw
 
	`Te¡LockLi¡’”
();

368 
lockAcquœedOb£rvabËs
.
	`put
(
ş›ÁId
, ((
Te¡LockLi¡’”
è
li¡’”
).
	`g‘LockAcquœed
());

369 
lockRevokedOb£rvabËs
.
	`put
(
ş›ÁId
, ((
Te¡LockLi¡’”
è
li¡’”
).
	`g‘LockRevoked
());

370 
lockAcquœedOb£rvabËs
.
	`fÜEach
((
id
, 
o
è-> o.
	`addOb£rv”
(
this
));

371 
lockRevokedOb£rvabËs
.
	`fÜEach
((
id
, 
o
è-> o.
	`addOb£rv”
(
this
));

372  
li¡’”
;

373 
	}
}

375 
´iv©e
 
	$š™Ÿlize
() {

376 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

377 .
	`bud”
()

378 .
	`bud
();

379 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
).
	`·r£CÚfigu¿tiÚSŒšg
(
cÜfuEndpošt
).
	`cÚÃù
();

381 
LockS‹
.
	`£tDu¿tiÚB‘w“nL—£R’ew®s
(
LOCK_TIME_CONSTANT
);

382 
LockS‹
.
	`£tMaxTimeFÜNÙifiÿtiÚLi¡’”Proûssšg
(
LOCK_TIME_CONSTANT
);

383 
LockCl›Á
.
	`£tDu¿tiÚB‘w“nLockMÚ™ÜRuns
(
LOCK_TIME_CONSTANT
);

384 
Lock
.
	`£tL—£Du¿tiÚ
(
LOCK_LEASE_DURATION
);

385 
	}
}

387 
´iv©e
 
	$shutdown
() {

388 ià(
ruÁime
 !ğ
nuÎ
) {

389 
ruÁime
.
	`shutdown
();

392 ià(
cÜfuS”v”
 !ğ
nuÎ
) {

393 
cÜfuS”v”
.
	`de¡roy
();

395 
	}
}

400 @
Ov”ride


401 
public
 
	$upd©e
(
Ob£rvabË
 
o
, 
Objeù
 
¬g
) {

402 
wa™CÚd™iÚ
) {

403 
LOCK_ACQUIRED
:

404 ià(
	`ob£rvabËOfTy³
(
o
, 
lockAcquœedOb£rvabËs
)) {

405 
blockUÁWa™CÚd™iÚ
.
	`»Ëa£
();

408 
LOCK_REVOKED
:

409 ià(
	`ob£rvabËOfTy³
(
o
, 
lockRevokedOb£rvabËs
)) {

410 
blockUÁWa™CÚd™iÚ
.
	`»Ëa£
();

416 
	}
}

418 
´iv©e
 
boŞ—n
 
ob£rvabËOfTy³
(
Ob£rvabË
 
ob£rvabË
, 
M­
<
UUID
, 
Ob£rvabËV®ue
> 
lockOb£rvabËs
) {

419  
	glockOb£rvabËs
.
v®ues
().
¡»am
().
ªyM©ch
Ğ
o
 -> o =ğ
ob£rvabË
);

422 
	eWa™CÚd™iÚTy³
 {

423 
	gNONE
,

424 
	gLOCK_ACQUIRED
,

425 
	gLOCK_REVOKED


	@test/src/test/java/org/corfudb/integration/LogReplicationIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gP”si¡edWr™”M‘ad©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gDeçuÉD©aCÚŒŞ
.
	gDeçuÉD©aCÚŒŞCÚfig
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gSourûMªag”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚFSM
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚS‹Ty³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gOb£rvabËAckMsg
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

22 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

25 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

26 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

28 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

29 
impÜt
 
	gjava
.
	gut
.
	gOb£rvabË
;

30 
impÜt
 
	gjava
.
	gut
.
	gOb£rv”
;

31 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

32 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

34 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

35 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

37 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	g¦“p
;

38 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

39 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

40 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gP”si¡edWr™”M‘ad©a
.
	gP”si¡edWr™”M‘ad©aTy³
.
	gLa¡LogProûs£d
;

41 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gP”si¡edWr™”M‘ad©a
.
	gP”si¡edWr™”M‘ad©aTy³
.
	gLa¡SÇpAµlyDÚe
;

42 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gP”si¡edWr™”M‘ad©a
.
	gP”si¡edWr™”M‘ad©aTy³
.
	gLa¡SÇpS¹
;

43 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gckSŒ—msAndTrim
;

49 @
Slf4j


50 
public
 cÏs 
	cLogR•liÿtiÚIT
 
ex‹nds
 
Ab¡¿ùIT
 
im¶em’ts
 
	mOb£rv”
 {

52 
fš®
 
SŒšg
 
	mSOURCE_ENDPOINT
 = 
DEFAULT_HOST
 + ":" + 
DEFAULT_PORT
;

53 
fš®
 
	mWRITER_PORT
 = 
DEFAULT_PORT
 + 1;

54 
fš®
 
SŒšg
 
	mDESTINATION_ENDPOINT
 = 
DEFAULT_HOST
 + ":" + 
WRITER_PORT
;

56 
fš®
 
UUID
 
	mPRIMARY_SITE_ID
 = UUID.
¿ndomUUID
();

57 
fš®
 
UUID
 
	mREMOTE_SITE_ID
 = UUID.
¿ndomUUID
();

58 
fš®
 
SŒšg
 
	mTABLE_PREFIX
 = "test";

60 
´iv©e
 
fš®
 
	mNUM_KEYS
 = 4;

62 
´iv©e
 
fš®
 
	mNUM_KEYS_LARGE
 = 1000;

63 
´iv©e
 
fš®
 
	mNUM_KEYS_VERY_LARGE
 = 20000;

65 
´iv©e
 
fš®
 
	mNUM_STREAMS
 = 1;

66 
´iv©e
 
fš®
 
	mTOTAL_STREAM_COUNT
 = 3;

67 
´iv©e
 
fš®
 
	mWRITE_CYCLES
 = 4;

69 
´iv©e
 
fš®
 
	mSTATE_CHANGE_CHECKS
 = 20;

70 
´iv©e
 
fš®
 
	mWAIT_STATE_CHANGE
 = 300;

73 
´iv©e
 
fš®
 
	mDELETE_PACE
 = 4;

75 
´iv©e
 
fš®
 
	mSYNC_CANCEL_DELAY
 = 200;

77 
´iv©e
 
Te¡CÚfig
 
	m‹¡CÚfig
 = 
Ãw
 TestConfig();

80 
´iv©e
 
DeçuÉD©aCÚŒŞCÚfig
 
	mdeçuÉD©aCÚŒŞCÚfig
 = 
Ãw
 DeçuÉD©aCÚŒŞCÚfig(
çl£
, 0);

82 
Proûss
 
	msourûS”v”
;

83 
Proûss
 
	mde¡š©iÚS”v”
;

86 
CÜfuRuÁime
 
	m¤cD©aRuÁime
 = 
nuÎ
;

89 
CÜfuRuÁime
 
	m»ad”RuÁime
 = 
nuÎ
;

92 
CÜfuRuÁime
 
	mwr™”RuÁime
 = 
nuÎ
;

95 
CÜfuRuÁime
 
	md¡D©aRuÁime
 = 
nuÎ
;

97 
SourûFÜw¬dšgD©aS’d”
 
	msourûD©aS’d”
;

100 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	m¤cCÜfuTabËs
 = 
Ãw
 
HashM­
<>();

101 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	md¡CÜfuTabËs
 = 
Ãw
 
HashM­
<>();

104 
	mHashM­
<
	mSŒšg
, HashM­<
	mLÚg
, LÚg>> 
	m¤cD©aFÜV”ifiÿtiÚ
 = 
Ãw
 
HashM­
<>();

105 
	mHashM­
<
	mSŒšg
, HashM­<
	mLÚg
, LÚg>> 
	md¡D©aFÜV”ifiÿtiÚ
 = 
Ãw
 
HashM­
<>();

107 
CÜfuRuÁime
 
	m¤cTe¡RuÁime
;

108 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	m¤cTe¡TabËs
 = 
Ãw
 
HashM­
<>();

110 
CÜfuRuÁime
 
	md¡Te¡RuÁime
;

111 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	md¡Te¡TabËs
 = 
Ãw
 
HashM­
<>();

114 
	mLi¡
<
	mLogR•liÿtiÚEÁry
> 
	mmsgQ
 = 
Ãw
 
A¼ayLi¡
<>();

119 
´iv©e
 
Ob£rvabËAckMsg
 
	mackMes§ges
;

122 
´iv©e
 
Ob£rvabËV®ue
 
	m”rÜsLogEÁrySync
;

125 
´iv©e
 
Ob£rvabËV®ue
 
	md©aCÚŒŞC®ls
;

128 
´iv©e
 
Ob£rvabËV®ue
 
	m»scheduËSÇpshÙSync
;

131 
´iv©e
 
Ob£rvabËV®ue
 
	msškReûivedMes§ges
;

136 
´iv©e
 
	mex³ùedAckMes§ges
 = 0;

139 
´iv©e
 
	mex³ùedAckTime¡amp
 = -1;

142 
´iv©e
 
	mex³ùedE¼Üs
 = 1;

145 
´iv©e
 
	mex³ùedD©aCÚŒŞC®ls
 = 1;

148 
´iv©e
 
	mex³ùedRescheduËSÇpshÙSync
 = 1;

151 
´iv©e
 
	mex³ùedSškReûivedMes§ges
 = 0;

156 
´iv©e
 
fš®
 
Sem­hÜe
 
	mblockUÁEx³ùedV®ueR—ched
 = 
Ãw
 Sem­hÜe(1, 
Œue
);

159 
´iv©e
 
	mSNAPSHOT_SYNC_DROPS
 = 2;

162 
	mCÜfuTabË
<
	mSŒšg
, 
	mLÚg
> 
	m»ad”M‘aD©aTabË
;

163 
	mCÜfuTabË
<
	mSŒšg
, 
	mLÚg
> 
	mwr™”M‘aD©aTabË
;

174 
´iv©e
 
	$£tupEnv
(è
throws
 
IOExû±iÚ
 {

176 
sourûS”v”
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

177 .
	`£tHo¡
(
DEFAULT_HOST
)

178 .
	`£tPÜt
(
DEFAULT_PORT
)

179 .
	`£tSšgË
(
Œue
)

180 .
	`runS”v”
();

183 
de¡š©iÚS”v”
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

184 .
	`£tHo¡
(
DEFAULT_HOST
)

185 .
	`£tPÜt
(
WRITER_PORT
)

186 .
	`£tSšgË
(
Œue
)

187 .
	`runS”v”
();

189 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

190 .
	`bud”
()

191 .
	`bud
();

193 
¤cD©aRuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
).
	`£tT¿n§ùiÚLoggšg
(
Œue
);

194 
¤cD©aRuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
SOURCE_ENDPOINT
);

195 
¤cD©aRuÁime
.
	`cÚÃù
();

197 
¤cTe¡RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

198 
¤cTe¡RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
SOURCE_ENDPOINT
);

199 
¤cTe¡RuÁime
.
	`cÚÃù
();

201 
»ad”RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

202 
»ad”RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
SOURCE_ENDPOINT
);

203 
»ad”RuÁime
.
	`cÚÃù
();

205 
wr™”RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

206 
wr™”RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DESTINATION_ENDPOINT
);

207 
wr™”RuÁime
.
	`cÚÃù
();

209 
d¡D©aRuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

210 
d¡D©aRuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DESTINATION_ENDPOINT
);

211 
d¡D©aRuÁime
.
	`cÚÃù
();

213 
d¡Te¡RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

214 
d¡Te¡RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DESTINATION_ENDPOINT
);

215 
d¡Te¡RuÁime
.
	`cÚÃù
();

217 
wr™”M‘aD©aTabË
 = 
d¡Te¡RuÁime
.
	`g‘ObjeùsV›w
()

218 .
	`bud
()

219 .
	`£tSŒ—mName
(
P”si¡edWr™”M‘ad©a
.
	`g‘P”si¡edWr™”M‘ad©aTabËName
(
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
))

220 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
LÚg
>>() {

222 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
JSON
)

223 .
	`İ’
();

226 
´iv©e
 
	$ş—nEnv
() {

227 ià(
¤cD©aRuÁime
 !ğ
nuÎ
) {

228 
¤cD©aRuÁime
.
	`shutdown
();

229 
¤cTe¡RuÁime
.
	`shutdown
();

230 
d¡D©aRuÁime
.
	`shutdown
();

231 
d¡Te¡RuÁime
.
	`shutdown
();

233 
»ad”RuÁime
.
	`shutdown
();

234 
wr™”RuÁime
.
	`shutdown
();

237 ià(
sourûD©aS’d”
 !ğ
nuÎ
) {

238 
sourûD©aS’d”
.
	`shutdown
();

240 
	}
}

249 
´iv©e
 
İ’SŒ—ms
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, 
CÜfuRuÁime
 
¹
, 
numSŒ—ms
) {

250 
	gi
 = 0; i < 
	gnumSŒ—ms
; i++) {

251 
SŒšg
 
	gÇme
 = 
TABLE_PREFIX
 + 
i
;

253 
	gCÜfuTabË
<
	gLÚg
, LÚg> 
	gbË
 = 
¹
.
g‘ObjeùsV›w
()

254 .
bud
()

255 .
£tSŒ—mName
(
Çme
)

256 .
£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
LÚg
, Long>>() {

258 .
£tS”Ÿliz”
(
S”Ÿliz”s
.
PRIMITIVE
)

259 .
İ’
();

260 
	gbËs
.
put
(
Çme
, 
bË
);

268 
´iv©e
 
g’”©eTXD©a
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
,

269 
HashM­
<
SŒšg
, HashM­<
LÚg
, LÚg>> 
hashM­
,

270 
numKeys
, 
CÜfuRuÁime
 
¹
, 
¡¬tV®ue
) {

271 
SŒšg
 
	g¡»amName
 : 
bËs
.
keyS‘
()) {

272 
g’”©eT¿n§ùiÚsCrossTabËs
(
bËs
, 
CŞËùiÚs
.
sšgËtÚ
(
¡»amName
), 
hashM­
, 
numKeys
, 
¹
, 
¡¬tV®ue
);

280 
´iv©e
 
g’”©eT¿n§ùiÚsCrossTabËs
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
,

281 
S‘
<
SŒšg
> 
bËsCrossTxs
,

282 
HashM­
<
SŒšg
, HashM­<
LÚg
, LÚg>> 
bËsFÜV”ifiÿtiÚ
,

283 
numKeys
, 
CÜfuRuÁime
 
¹
, 
¡¬tV®ue
) {

284 
	gútD–‘e
 = 0;

285 
	gi
 = 0; i < 
	gnumKeys
; i++) {

286 
	g¹
.
g‘ObjeùsV›w
().
TXBegš
();

287 
SŒšg
 
	gÇme
 : 
bËsCrossTxs
) {

288 
bËsFÜV”ifiÿtiÚ
.
putIfAb£Á
(
Çme
, 
Ãw
 
HashM­
<>());

289 
	gkey
 = 
i
 + 
¡¬tV®ue
;

290 
	gbËs
.
g‘
(
Çme
).
put
(
key
, key);

291 
	gbËsFÜV”ifiÿtiÚ
.
g‘
(
Çme
).
put
(
key
, key);

294 ià(
	g‹¡CÚfig
.
	gd–‘eOP
 && (
	gi
 % 
	gDELETE_PACE
 == 0)) {

295 
bËs
.
g‘
(
Çme
).
d–‘e
(
key
 - 1);

296 
	gbËsFÜV”ifiÿtiÚ
.
g‘
(
Çme
).
»move
(
key
 - 1);

297 
	gútD–‘e
++;

300 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

301 
	g
 = 
¹
.
g‘Add»ssS·ûV›w
().
g‘LogAdd»ssS·û
().
g‘Add»ssM­
().
g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
).
g‘Ta
();

302 
	gex³ùedAckTime¡amp
 = 
M©h
.
max
(

, 
ex³ùedAckTime¡amp
);

305 ià(
	gútD–‘e
 > 0) {

306 
	gSy¡em
.
	gout
.
´šn
("d–‘úˆ" + 
útD–‘e
);

311 
v”ifyD©a
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, HashM­<SŒšg, HashM­<LÚg, LÚg>> 
hashM­
) {

312 
SŒšg
 
	gÇme
 : 
hashM­
.
keyS‘
()) {

313 
CÜfuTabË
<
LÚg
, 
	gLÚg
> 
	gbË
 = 
bËs
.
g‘
(
Çme
);

314 
	gHashM­
<
	gLÚg
, LÚg> 
	gm­Keys
 = 
hashM­
.
g‘
(
Çme
);

316 
	gSy¡em
.
	gout
.
´šn
("TabË[" + 
Çme
 + "]: " + 
bË
.
keyS‘
().
size
() + " keys; Expected "

317 + 
m­Keys
.
size
() + " keys");

319 
as£¹Th©
(
m­Keys
.
keyS‘
().
cÚšsAÎ
(
bË
.keyS‘())).
isTrue
();

320 
as£¹Th©
(
bË
.
keyS‘
().
cÚšsAÎ
(
m­Keys
.keyS‘())).
isTrue
();

321 
as£¹Th©
(
bË
.
keyS‘
().
size
(è=ğ
m­Keys
.keyS‘().size()).
isTrue
();

323 
LÚg
 
	gkey
 : 
m­Keys
.
keyS‘
()) {

324 
as£¹Th©
(
bË
.
g‘
(
key
)).
isEqu®To
(
m­Keys
.get(key));

329 
´iv©e
 
v”ifyNoD©a
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
) {

330 
CÜfuTabË
 
	gbË
 : 
bËs
.
v®ues
()) {

331 
as£¹Th©
(
bË
.
keyS‘
().
isEm±y
());

342 @
Te¡


343 
public
 
	$‹¡SÇpshÙAndLogEÁrySyncThroughMªag”
(è
throws
 
Exû±iÚ
 {

346 
	`£tupEnv
();

349 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 
NUM_STREAMS
);

353 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS);

356 
Sy¡em
.
out
.
	`´šn
("\n****** Verify Source Data");

357 
	`v”ifyD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

360 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
);

361 
Sy¡em
.
out
.
	`´šn
("****** Verify No Data in Destination Site");

362 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

365 
	`¡¬tSÇpshÙSync
(
¤cCÜfuTabËs
.
	`keyS‘
());

367 
Sy¡em
.
out
.
	`´šn
(">>>>> END Snapshot Sync");

370 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

371 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

374 
ex³ùedAckMes§ges
 = (
NUM_KEYS
) + 1;

377 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS*2);

378 
Sy¡em
.
out
.
	`´šn
("****** Verify Source Data for†ogƒntry (incremental updates)");

379 
	`v”ifyD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

382 
Sy¡em
.
out
.
	`´šn
("***** Start Log Entry Replication");

385 
Sy¡em
.
out
.
	`´šn
("****** Wait until†ogƒntry sync completes‡nd ACKs‡re„eceived");

386 
blockUÁEx³ùedV®ueR—ched
.
	`acquœe
();

389 
Sy¡em
.
out
.
	`´šn
("****** Verify Destination Data for†ogƒntry (incremental updates)");

390 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

392 
	`v”ifyP”si¡edSÇpshÙM‘ad©a
();

393 
	`v”ifyP”si¡edLogEÁryM‘ad©a
();

394 
	}
}

396 
´iv©e
 
fš®
 
SŒšg
 
	gt0
 = 
TABLE_PREFIX
 + 0;

397 
´iv©e
 
fš®
 
SŒšg
 
	gt1
 = 
TABLE_PREFIX
 + 1;

398 
´iv©e
 
fš®
 
SŒšg
 
	gt2
 = 
TABLE_PREFIX
 + 2;

411 @
Te¡


412 
public
 
	$‹¡V®idSÇpshÙSyncCrossTabËs
(è
throws
 
Exû±iÚ
 {

415 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

416 
üossTabËs
.
	`add
(
t0
);

417 
üossTabËs
.
	`add
(
t1
);

419 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

422 
	`¡¬tSÇpshÙSync
(
üossTabËs
);

425 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

427 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

428 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

430 
	`ş—nEnv
();

431 
	}
}

440 @
Te¡


441 
public
 
	$‹¡Inv®idSÇpshÙSyncCrossTabËs
(è
throws
 
Exû±iÚ
 {

443 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

444 
üossTabËs
.
	`add
(
t0
);

445 
üossTabËs
.
	`add
(
t1
);

446 
üossTabËs
.
	`add
(
t2
);

449 
S‘
<
SŒšg
> 
»¶iÿ‹TabËs
 = 
Ãw
 
HashS‘
<>();

450 
»¶iÿ‹TabËs
.
	`add
(
t0
);

451 
»¶iÿ‹TabËs
.
	`add
(
t1
);

453 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

456 
	`¡¬tSÇpshÙSync
(
»¶iÿ‹TabËs
);

459 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

461 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

462 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

463 
	`ş—nEnv
();

464 
	}
}

473 @
Te¡


474 
public
 
	$‹¡SÇpshÙSyncNoTabËsToR•liÿ‹
(è
throws
 
Exû±iÚ
 {

476 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

477 
üossTabËs
.
	`add
(
t0
);

478 
üossTabËs
.
	`add
(
t1
);

479 
üossTabËs
.
	`add
(
t2
);

481 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

485 
	`as£¹Th©ThrownBy
((è-> 
	`¡¬tSÇpshÙSync
(
Ãw
 
HashS‘
<>())).
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

486 
	`ş—nEnv
();

487 
	}
}

493 @
Te¡


494 
public
 
	$‹¡SÇpshÙSyncFÜEm±yLog
(è
throws
 
Exû±iÚ
 {

496 
	`£tupEnv
();

499 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 
NUM_STREAMS
);

502 
Sy¡em
.
out
.
	`´šn
("****** Verify No Data in Source Site");

503 
	`v”ifyNoD©a
(
¤cCÜfuTabËs
);

506 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
);

507 
Sy¡em
.
out
.
	`´šn
("****** Verify No Data in Destination Site");

508 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

511 
S‘
<
SŒšg
> 
bËsToR•liÿ‹
 = 
Ãw
 
HashS‘
<>();

512 
bËsToR•liÿ‹
.
	`add
(
t0
);

513 
bËsToR•liÿ‹
.
	`add
(
t1
);

517 
	`¡¬tSÇpshÙSync
(
bËsToR•liÿ‹
);

520 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

522 
	`ş—nEnv
();

523 
	}
}

530 @
Te¡


531 
public
 
	$‹¡SÇpshÙSyncFÜNoD©a
(è
throws
 
Exû±iÚ
 {

533 
	`£tupEnv
();

536 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 
TOTAL_STREAM_COUNT
);

537 
S‘
<
SŒšg
> 
bËsAüossTx
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
	`asLi¡
(
t0
, 
t1
, 
t2
));

538 
	`g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
bËsAüossTx
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
*NUM_KEYS, 
¤cD©aRuÁime
, 0);

541 
Sy¡em
.
out
.
	`´šn
("****** Verify Data in Source Site");

542 
	`v”ifyD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

545 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
);

546 
Sy¡em
.
out
.
	`´šn
("****** Verify No Data in Destination Site");

547 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

550 
SŒšg
 
t3
 = 
TABLE_PREFIX
 + 
TOTAL_STREAM_COUNT
;

551 
S‘
<
SŒšg
> 
bËsToR•liÿ‹
 = 
Ãw
 
HashS‘
<>(
A¼ays
.
	`asLi¡
(
t3
));

555 
	`¡¬tSÇpshÙSync
(
bËsToR•liÿ‹
);

558 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

559 
	`ş—nEnv
();

560 
	}
}

566 @
Te¡


567 
public
 
	$‹¡LogEÁrySyncFÜEm±yLog
(è
throws
 
Exû±iÚ
 {

569 
	`£tupEnv
();

572 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 
NUM_STREAMS
);

575 
Sy¡em
.
out
.
	`´šn
("****** Verify No Data in Source Site");

576 
	`v”ifyNoD©a
(
¤cCÜfuTabËs
);

579 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
);

580 
Sy¡em
.
out
.
	`´šn
("****** Verify No Data in Destination Site");

581 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

584 
‹¡CÚfig
.
	`ş—r
();

585 
LogR•liÿtiÚFSM
 
fsm
 = 
	`¡¬tLogEÁrySync
(
CŞËùiÚs
.
	`sšgËtÚ
(
t0
), 
WAIT
.
NONE
);

588 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
Œue
);

590 
»Œ›s
 = 0;

593 
»Œ›s
 < 
STATE_CHANGE_CHECKS
) {

594 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
çl£
);

595 
»Œ›s
++;

596 
	`¦“p
(
WAIT_STATE_CHANGE
);

600 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

602 
	`ş—nEnv
();

603 
	}
}

611 @
Te¡


612 
public
 
	$‹¡LogEÁrySyncV®idCrossTabËs
(è
throws
 
Exû±iÚ
 {

614 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

615 
üossTabËs
.
	`add
(
t0
);

616 
üossTabËs
.
	`add
(
t1
);

619 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

622 
ex³ùedAckMes§ges
 = 
NUM_KEYS
*
WRITE_CYCLES
;

623 
‹¡CÚfig
.
	`ş—r
();

624 
	`¡¬tLogEÁrySync
(
üossTabËs
);

627 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

629 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

632 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

633 
	}
}

636 @
Te¡


637 
public
 
	$‹¡LogEÁrySyncV®idCrossTabËsW™hDrİMsg
(è
throws
 
Exû±iÚ
 {

639 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

640 
üossTabËs
.
	`add
(
t0
);

641 
üossTabËs
.
	`add
(
t1
);

643 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

646 
ex³ùedAckMes§ges
 = 
NUM_KEYS
*
WRITE_CYCLES
;

648 
‹¡CÚfig
.
	`ş—r
().
	`£tDrİMes§geLev–
(1);

649 
	`¡¬tLogEÁrySync
(
üossTabËs
, 
WAIT
.
ON_ACK
);

652 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

654 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

657 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

658 
	}
}

661 @
Te¡


662 
public
 
	$‹¡LogEÁrySyncV®idCrossTabËsW™hTrigg”Timeout
(è
throws
 
Exû±iÚ
 {

664 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

665 
üossTabËs
.
	`add
(
t0
);

666 
üossTabËs
.
	`add
(
t1
);

668 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

671 
ex³ùedAckMes§ges
 = 
NUM_KEYS
*
WRITE_CYCLES
;

673 
‹¡CÚfig
.
	`ş—r
().
	`£tDrİMes§geLev–
(2);

674 
	`¡¬tLogEÁrySync
(
üossTabËs
, 
WAIT
.
ON_ERROR
);

675 
	}
}

686 @
Te¡


687 
public
 
	$‹¡LogEÁrySyncInv®idCrossTabËs
(è
throws
 
Exû±iÚ
 {

689 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

690 
üossTabËs
.
	`add
(
t0
);

691 
üossTabËs
.
	`add
(
t1
);

692 
üossTabËs
.
	`add
(
t2
);

695 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

697 
S‘
<
SŒšg
> 
»¶iÿ‹TabËs
 = 
Ãw
 
HashS‘
<>();

698 
»¶iÿ‹TabËs
.
	`add
(
t0
);

699 
»¶iÿ‹TabËs
.
	`add
(
t1
);

703 
‹¡CÚfig
.
	`ş—r
();

704 
LogR•liÿtiÚFSM
 
fsm
 = 
	`¡¬tLogEÁrySync
(
»¶iÿ‹TabËs
, 
WAIT
.
ON_ERROR
);

706 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
STOPPED
, 
Œue
);

709 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

711 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

714 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

715 
	}
}

730 @
Te¡


731 
public
 
	$‹¡LogEÁrySyncInv®idCrossTabËsP¬tŸl
(è
throws
 
Exû±iÚ
 {

733 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

734 
üossTabËs
.
	`add
(
t0
);

735 
üossTabËs
.
	`add
(
t1
);

736 
üossTabËs
.
	`add
(
t2
);

739 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
çl£
);

741 
S‘
<
SŒšg
> 
»¶iÿ‹TabËs
 = 
Ãw
 
HashS‘
<>();

742 
»¶iÿ‹TabËs
.
	`add
(
t0
);

743 
»¶iÿ‹TabËs
.
	`add
(
t1
);

747 
‹¡CÚfig
.
	`ş—r
();

748 
LogR•liÿtiÚFSM
 
fsm
 = 
	`¡¬tLogEÁrySync
(
»¶iÿ‹TabËs
, 
WAIT
.
ON_ERROR
);

750 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
STOPPED
, 
Œue
);

753 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

756 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

758 
HashM­
<
SŒšg
, HashM­<
LÚg
, LÚg>> 
·¹ŸlSrcHashM­
 = 
Ãw
 HashMap<>();

759 
·¹ŸlSrcHashM­
.
	`put
(
t0
, 
Ãw
 
HashM­
<>());

760 
·¹ŸlSrcHashM­
.
	`put
(
t1
, 
Ãw
 
HashM­
<>());

761 
i
=
NUM_KEYS
; i<NUM_KEYS*2; i++) {

762 
·¹ŸlSrcHashM­
.
	`g‘
(
t0
).
	`put
(()
i
, ()i);

763 
·¹ŸlSrcHashM­
.
	`g‘
(
t1
).
	`put
(()
i
, ()i);

767 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
·¹ŸlSrcHashM­
);

768 
	}
}

775 @
Te¡


776 
public
 
	$‹¡LogEÁrySyncV®idCrossTabËsW™hWr™šgAtSrc
(è
throws
 
Exû±iÚ
 {

778 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

779 
üossTabËs
.
	`add
(
t0
);

780 
üossTabËs
.
	`add
(
t1
);

782 
	`‹¡SÇpshÙSyncCrossTabËs
(
üossTabËs
, 
Œue
);

785 
ex³ùedAckMes§ges
 = 
NUM_KEYS
*
WRITE_CYCLES
;

787 
‹¡CÚfig
.
	`ş—r
();

788 
‹¡CÚfig
.
	`£tWr™šgSrc
(
Œue
);

789 
‹¡CÚfig
.
	`£tD–‘eOP
(
Œue
);

791 
‹¡CÚfig
.
	`£tWa™On
(
WAIT
.
ON_ACK
);

792 
	`¡¬tLogEÁrySync
(
üossTabËs
, 
WAIT
.
ON_ACK
);

795 
Sy¡em
.
out
.
	`´šn
("****** Verify Data on Destination");

797 
¤cD©aFÜV”ifiÿtiÚ
.
	`g‘
(
t2
).
	`ş—r
();

800 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

801 
	`as£¹Th©
(
ex³ùedAckTime¡amp
).
	`isEqu®To
(
wr™”M‘aD©aTabË
.
	`g‘
(
La¡LogProûs£d
.
	`g‘V®
()));

802 
	`v”ifyP”si¡edSÇpshÙM‘ad©a
();

803 
	`v”ifyP”si¡edLogEÁryM‘ad©a
();

804 
	}
}

812 @
Te¡


813 
public
 
	$‹¡SÇpshÙSyncW™hIn™ŸlTrimmedExû±iÚs
(è
throws
 
Exû±iÚ
 {

814 
fš®
 
FRACTION_LOG_TRIM
 = 10;

817 
	`£tupEnv
();

820 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 1);

821 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 1);

824 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS_LARGE
, 
¤cD©aRuÁime
, 0);

827 
	`Œim
(
¤cD©aRuÁime
, 
NUM_KEYS_LARGE
/
FRACTION_LOG_TRIM
);

832 
ex³ùedE¼Üs
 = 1;

833 
SourûMªag”
 
sourûMªag”
 = 
	`¡¬tSÇpshÙSync
(
¤cCÜfuTabËs
.
	`keyS‘
(), 
A¼ays
.
	`asLi¡
(
WAIT
.
ON_ERROR
));

837 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

838 
	}
}

846 @
Te¡


847 
public
 
	$‹¡SÇpshÙSyncW™hTrimmedExû±iÚs
(è
throws
 
Exû±iÚ
 {

848 
fš®
 
RX_MESSAGES_LIMIT
 = 2;

851 
	`£tupEnv
();

854 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 1);

855 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 1);

859 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS_LARGE
, 
¤cD©aRuÁime
, 0);

863 
ex³ùedSškReûivedMes§ges
 = 
RX_MESSAGES_LIMIT
;

864 
ex³ùedAckTime¡amp
 = -1;

865 
‹¡CÚfig
.
	`£tWa™On
(
WAIT
.
ON_ACK_TS
);

866 
SourûMªag”
 
sourûMªag”
 = 
	`¡¬tSÇpshÙSync
(
¤cCÜfuTabËs
.
	`keyS‘
(), 
A¼ays
.
	`asLi¡
(
WAIT
.
ON_ACK_TS
, WAIT.
ON_ERROR
, WAIT.
ON_SINK_RECEIVE
));

869 
Tok’
 
tok’
 = 
	`ckSŒ—msAndTrim
(
¤cD©aRuÁime
, 
¤cCÜfuTabËs
);

870 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

871 
ex³ùedAckTime¡amp
 = 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

873 
Sy¡em
.
out
.
	`´šn
("****** Wait until‡n Trimmed Error happens");

874 
blockUÁEx³ùedV®ueR—ched
.
	`acquœe
();

875 
Sy¡em
.
out
.
	`´šn
("****** Got‡nƒxpected Error");

878 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
()

879 < 
tok’
.
	`g‘Sequ’û
()) {

884 
Sy¡em
.
out
.
	`´šn
("****** Wait until snapshot sync is completed (ack„eceived)");

885 
blockUÁEx³ùedV®ueR—ched
.
	`acquœe
();

888 
	`checkS‹Chªge
(
sourûMªag”
.
	`g‘LogR•liÿtiÚFSM
(), 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
Œue
);

889 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

890 
	}
}

898 @
Te¡


899 
public
 
	$‹¡LogEÁrySyncW™hIn™ŸlTrimmedExû±iÚs
(è
throws
 
Exû±iÚ
 {

900 
fš®
 
FRACTION_LOG_TRIM
 = 10;

903 
	`£tupEnv
();

906 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 1);

907 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 1);

910 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS_LARGE
, 
¤cD©aRuÁime
, 0);

913 
	`Œim
(
¤cD©aRuÁime
, 
NUM_KEYS_LARGE
/
FRACTION_LOG_TRIM
);

918 
ex³ùedE¼Üs
 = 1;

919 
LogR•liÿtiÚFSM
 
fsm
 = 
	`¡¬tLogEÁrySync
(
¤cCÜfuTabËs
.
	`keyS‘
(), 
A¼ays
.
	`asLi¡
(
WAIT
.
ON_ERROR
), 
Œue
,

920 
Ãw
 
	`DeçuÉD©aCÚŒŞCÚfig
(
Œue
, 
NUM_KEYS_LARGE
));

924 
Sy¡em
.
out
.
	`´šn
("****** Verify‚o data‡t destination");

925 
	`v”ifyNoD©a
(
d¡CÜfuTabËs
);

926 
	}
}

934 @
Te¡


935 
public
 
	$‹¡LogEÁrySyncW™hTrim
(è
throws
 
Exû±iÚ
 {

936 
fš®
 
RX_MESSAGES_LIMIT
 = 2;

937 
fš®
 
TRIM_RATIO
 = 
NUM_KEYS_LARGE
 - 20;

940 
	`£tupEnv
();

943 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 1);

944 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 1);

948 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS_LARGE
, 
¤cD©aRuÁime
, 0);

952 
ex³ùedSškReûivedMes§ges
 = 
RX_MESSAGES_LIMIT
;

955 
LogR•liÿtiÚFSM
 
fsm
 = 
	`¡¬tLogEÁrySync
(
¤cCÜfuTabËs
.
	`keyS‘
(), 
A¼ays
.
	`asLi¡
(
WAIT
.
ON_SINK_RECEIVE
),

956 
çl£
, 
Ãw
 
	`DeçuÉD©aCÚŒŞCÚfig
(çl£, 
NUM_KEYS_LARGE
));

958 
Sy¡em
.
out
.
	`´šn
("****** Trim†og, willrigger‡ full snapshot sync");

960 
Tok’
 
toke
 = 
	`ckSŒ—msAndTrim
(
¤cD©aRuÁime
, 
¤cCÜfuTabËs
);

963 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
(è< 
toke
.getSequence()) {

967 
Sy¡em
.
out
.
	`´šn
("****** Waitill IN_SNAPSHOT_SYNC");

968 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
, 
Œue
);

970 
Sy¡em
.
out
.
	`´šn
("Block untill full snapshotransfer complete");

971 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
Œue
);

973 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
d¡D©aFÜV”ifiÿtiÚ
);

974 
	`ş—nEnv
();

975 
	}
}

983 @
Te¡


984 
public
 
	$‹¡LogEÁrySyncL¬geTabËs
(è
throws
 
Exû±iÚ
 {

986 
	`£tupEnv
();

989 
	`İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 1);

990 
	`İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 1);

992 
num_keys
 = 
NUM_KEYS_VERY_LARGE
;

996 
Sy¡em
.
out
.
	`´šn
("****** Generate TX Data");

997 
	`g’”©eTXD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
num_keys
, 
¤cD©aRuÁime
, 0);

1001 
Sy¡em
.
out
.
	`´šn
("****** Start Log Entry Sync");

1002 
ex³ùedAckMes§ges
 = 
num_keys
;

1003 
LogR•liÿtiÚFSM
 
fsm
 = 
	`¡¬tLogEÁrySync
(
¤cCÜfuTabËs
.
	`keyS‘
(), 
A¼ays
.
	`asLi¡
(
WAIT
.
ON_ACK
),

1004 
çl£
, 
Ãw
 
	`DeçuÉD©aCÚŒŞCÚfig
(
Œue
, 
NUM_KEYS_LARGE
));

1006 
Sy¡em
.
out
.
	`´šn
("****** TÙ® " + 
num_keys
 + " ACK messages„eceived. Verify State.");

1009 
	`checkS‹Chªge
(
fsm
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
Œue
);

1010 
	`v”ifyD©a
(
d¡CÜfuTabËs
, 
d¡D©aFÜV”ifiÿtiÚ
);

1011 
	`ş—nEnv
();

1012 
	}
}

1019 
´iv©e
 
‹¡SÇpshÙSyncCrossTabËs
(
S‘
<
SŒšg
> 
üossTabËT¿n§ùiÚs
, 
boŞ—n
 
¡¬tCrossTx
è
throws
 
	gExû±iÚ
 {

1021 
£tupEnv
();

1024 
	gtÙ®SŒ—ms
 = 
TOTAL_STREAM_COUNT
;

1025 
İ’SŒ—ms
(
¤cCÜfuTabËs
, 
¤cD©aRuÁime
, 
tÙ®SŒ—ms
);

1028 ià(
	g¡¬tCrossTx
) {

1029 
g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
üossTabËT¿n§ùiÚs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, 0);

1033 
g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
CŞËùiÚs
.
sšgËtÚ
(
t0
), 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS);

1036 
g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
CŞËùiÚs
.
sšgËtÚ
(
t1
), 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS);

1039 
g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
CŞËùiÚs
.
sšgËtÚ
(
t2
), 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, 0);

1042 
g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
üossTabËT¿n§ùiÚs
, 
¤cD©aFÜV”ifiÿtiÚ
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS*2);

1045 
v”ifyD©a
(
¤cCÜfuTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
);

1048 
İ’SŒ—ms
(
d¡CÜfuTabËs
, 
d¡D©aRuÁime
, 
tÙ®SŒ—ms
);

1049 
	gSy¡em
.
	gout
.
´šn
("****** Verify No Data in Destination Site");

1050 
v”ifyNoD©a
(
d¡CÜfuTabËs
);

1053 
	$¡¬tTxAtSrc
() {

1054 
S‘
<
SŒšg
> 
üossTabËs
 = 
Ãw
 
HashS‘
<>();

1055 
üossTabËs
.
	`add
(
t0
);

1056 
üossTabËs
.
	`add
(
t1
);

1058 
	`g’”©eT¿n§ùiÚsCrossTabËs
(
¤cCÜfuTabËs
, 
üossTabËs
, 
¤cD©aFÜV”ifiÿtiÚ
,

1059 
NUM_KEYS_LARGE
, 
¤cD©aRuÁime
, 
NUM_KEYS
*
WRITE_CYCLES
);

1060 
	}
}

1062 
	$¡¬tTxD¡
() {

1064 
	}
}

1067 
´iv©e
 
	$Œim
(
CÜfuRuÁime
 
¹
, 
ŒimAdd»ss
) {

1068 
Sy¡em
.
out
.
	`´šn
("Trim‡t: " + 
ŒimAdd»ss
);

1069 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
Ãw
 
	`Tok’
(0, 
ŒimAdd»ss
));

1070 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

1071 
	}
}

1076 
	$¡¬tTx
() {

1077 
ScheduËdExecutÜS”viû
 
scheduËdExecutÜS”viû
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(2);

1078 ià(
‹¡CÚfig
.
wr™šgSrc
) {

1079 
ex³ùedAckMes§ges
 +ğ
NUM_KEYS_LARGE
;

1080 
scheduËdExecutÜS”viû
.
	`subm™
(
this
::
¡¬tTxAtSrc
);

1082 ià(
‹¡CÚfig
.
wr™šgD¡
) {

1083 
scheduËdExecutÜS”viû
.
	`subm™
(
this
::
¡¬tTxD¡
);

1085 
	}
}

1087 
´iv©e
 
SourûMªag”
 
¡¬tSÇpshÙSync
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
è
throws
 
	gExû±iÚ
 {

1088  
¡¬tSÇpshÙSync
(
bËsToR•liÿ‹
, 
WAIT
.
ON_ACK
);

1091 
´iv©e
 
SourûMªag”
 
¡¬tSÇpshÙSync
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
, 
WAIT
 
wa™CÚd™iÚ
è
throws
 
	gExû±iÚ
 {

1092  
¡¬tSÇpshÙSync
(
bËsToR•liÿ‹
, 
A¼ays
.
asLi¡
(
wa™CÚd™iÚ
));

1095 
´iv©e
 
SourûMªag”
 
¡¬tSÇpshÙSync
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
, 
Li¡
<
WAIT
> 
wa™CÚd™iÚs
è
throws
 
	gExû±iÚ
 {

1099 
	gex³ùedAckMes§ges
 = 1;

1100 
SourûMªag”
 
	glogR•liÿtiÚSourûMªag”
 = 
£tupSourûMªag”AndOb£rvedV®ues
(
bËsToR•liÿ‹
,

1101 
wa™CÚd™iÚs
);

1104 
	gSy¡em
.
	gout
.
´šn
("****** Start Snapshot Sync");

1105 
	glogR•liÿtiÚSourûMªag”
.
¡¬tSÇpshÙSync
();

1108 
	gSy¡em
.
	gout
.
´šn
("****** Wait until wait condition is met");

1109 
	gblockUÁEx³ùedV®ueR—ched
.
acquœe
();

1111  
	glogR•liÿtiÚSourûMªag”
;

1121 
´iv©e
 
LogR•liÿtiÚFSM
 
¡¬tLogEÁrySync
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
, 
WAIT
 
wa™CÚd™iÚ
è
throws
 
	gExû±iÚ
 {

1122  
¡¬tLogEÁrySync
(
bËsToR•liÿ‹
, 
A¼ays
.
asLi¡
(
wa™CÚd™iÚ
), 
Œue
, 
deçuÉD©aCÚŒŞCÚfig
);

1125 
´iv©e
 
LogR•liÿtiÚFSM
 
¡¬tLogEÁrySync
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
è
throws
 
	gExû±iÚ
 {

1126 
	g‹¡CÚfig
.
£tWa™On
(
WAIT
.
ON_ACK
);

1127  
¡¬tLogEÁrySync
(
bËsToR•liÿ‹
, 
WAIT
.
ON_ACK
);

1132 
´iv©e
 
LogR•liÿtiÚFSM
 
¡¬tLogEÁrySync
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
, 
Li¡
<
WAIT
> 
wa™CÚd™iÚs
,

1133 
boŞ—n
 
šjeùTxD©a
,

1134 
DeçuÉD©aCÚŒŞCÚfig
 
d©aCÚŒŞCÚfig
è
throws
 
	gExû±iÚ
 {

1136 
SourûMªag”
 
	glogR•liÿtiÚSourûMªag”
 = 
£tupSourûMªag”AndOb£rvedV®ues
(
bËsToR•liÿ‹
,

1137 
wa™CÚd™iÚs
);

1140 
	gSy¡em
.
	gout
.
´šn
("****** S¹ Log EÁry Synøw™h srø " + 
¤cD©aRuÁime
.
g‘Add»ssS·ûV›w
().
g‘LogTa
()

1141 + " d¡a " + 
d¡D©aRuÁime
.
g‘Add»ssS·ûV›w
().
g‘LogTa
());

1142 
	glogR•liÿtiÚSourûMªag”
.
¡¬tR•liÿtiÚ
();

1145 ià(
	gšjeùTxD©a
) {

1146 
¡¬tTx
();

1150 
	gSy¡em
.
	gout
.
´šn
("****** Wait untilhe wait condition is met");

1151 
	gblockUÁEx³ùedV®ueR—ched
.
acquœe
();

1153  
	glogR•liÿtiÚSourûMªag”
.
g‘LogR•liÿtiÚFSM
();

1156 
´iv©e
 
SourûMªag”
 
£tupSourûMªag”AndOb£rvedV®ues
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
,

1157 
WAIT
 
wa™CÚd™iÚ
è
throws
 
	gIÁ”ru±edExû±iÚ
 {

1158  
£tupSourûMªag”AndOb£rvedV®ues
(
bËsToR•liÿ‹
, 
A¼ays
.
asLi¡
(
wa™CÚd™iÚ
));

1161 
´iv©e
 
SourûMªag”
 
£tupSourûMªag”AndOb£rvedV®ues
(
S‘
<
SŒšg
> 
bËsToR•liÿ‹
,

1162 
Li¡
<
WAIT
> 
wa™CÚd™iÚs
è
throws
 
	gIÁ”ru±edExû±iÚ
 {

1164 
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
bËsToR•liÿ‹
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

1167 
	gsourûD©aS’d”
 = 
Ãw
 
SourûFÜw¬dšgD©aS’d”
(
DESTINATION_ENDPOINT
, 
cÚfig
, 
‹¡CÚfig
.
g‘DrİMes§geLev–
());

1170 
SourûMªag”
 
	glogR•liÿtiÚSourûMªag”
 = 
Ãw
 SourûMªag”(
»ad”RuÁime
, 
sourûD©aS’d”
, 
cÚfig
);

1174 
	gsourûD©aS’d”
.
£tSourûMªag”
(
logR•liÿtiÚSourûMªag”
);

1177 
WAIT
 
	gwa™CÚd™iÚ
 : 
wa™CÚd™iÚs
) {

1178 
wa™CÚd™iÚ
) {

1179 
ON_ACK
:

1180 
ON_ACK_TS
:

1182 
ackMes§ges
 = 
sourûD©aS’d”
.
g‘AckMes§ges
();

1183 
	gackMes§ges
.
addOb£rv”
(
this
);

1185 
	gON_ERROR
:

1186 
”rÜsLogEÁrySync
 = 
sourûD©aS’d”
.
g‘E¼Üs
();

1187 
	g”rÜsLogEÁrySync
.
addOb£rv”
(
this
);

1189 
	gON_DATA_CONTROL_CALL
:

1192 
	gON_RESCHEDULE_SNAPSHOT_SYNC
:

1195 
	gON_SINK_RECEIVE
:

1196 
sškReûivedMes§ges
 = 
sourûD©aS’d”
.
g‘SškMªag”
().
g‘RxMes§geCouÁ
();

1197 
	gsškReûivedMes§ges
.
addOb£rv”
(
this
);

1204 ià(!
	gwa™CÚd™iÚs
.
cÚšs
(
WAIT
.
NONE
)) {

1207 
	gblockUÁEx³ùedV®ueR—ched
.
acquœe
();

1210  
	glogR•liÿtiÚSourûMªag”
;

1218 
´iv©e
 
	$checkS‹Chªge
(
LogR•liÿtiÚFSM
 
fsm
, 
LogR•liÿtiÚS‹Ty³
 
fš®S‹
, 
boŞ—n
 
wa™UÁ
) {

1221 
fsm
.
	`g‘S‹
().
	`g‘Ty³
(è!ğ
fš®S‹
 && 
wa™UÁ
) {

1225 
	`as£¹Th©
(
fsm
.
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
fš®S‹
);

1226 
	}
}

1229 @
Ov”ride


1230 
public
 
	$upd©e
(
Ob£rvabË
 
o
, 
Objeù
 
¬g
) {

1231 ià(
o
 =ğ
ackMes§ges
) {

1233 
	`v”ifyEx³ùedAckMes§ge
((
Ob£rvabËAckMsg
)
o
);

1234 } ià(
o
 =ğ
”rÜsLogEÁrySync
) {

1235 
	`v”ifyEx³ùedV®ue
(
ex³ùedE¼Üs
, 
”rÜsLogEÁrySync
.
	`g‘V®ue
());

1236 } ià(
o
 =ğ
d©aCÚŒŞC®ls
) {

1237 
	`v”ifyEx³ùedV®ue
(
ex³ùedD©aCÚŒŞC®ls
, 
d©aCÚŒŞC®ls
.
	`g‘V®ue
());

1238 } ià(
o
 =ğ
»scheduËSÇpshÙSync
) {

1239 
	`v”ifyEx³ùedV®ue
(
ex³ùedRescheduËSÇpshÙSync
, 
d©aCÚŒŞC®ls
.
	`g‘V®ue
());

1240 } ià(
o
 =ğ
sškReûivedMes§ges
) {

1241 
	`v”ifyEx³ùedV®ue
(
ex³ùedSškReûivedMes§ges
, 
sškReûivedMes§ges
.
	`g‘V®ue
());

1243 
	}
}

1245 
´iv©e
 
	$v”ifyEx³ùedV®ue
(
ex³ùedV®ue
, 
cu¼’tV®ue
) {

1248 ià(
ex³ùedV®ue
 =ğ
cu¼’tV®ue
) {

1249 
blockUÁEx³ùedV®ueR—ched
.
	`»Ëa£
();

1251 
	}
}

1253 
´iv©e
 
	$v”ifyEx³ùedAckMes§ge
(
Ob£rvabËAckMsg
 
ob£rvabËAckMsg
) {

1255 ià(
ob£rvabËAckMsg
.
	`g‘D©aMes§ge
(è!ğ
nuÎ
) {

1256 
LogR•liÿtiÚEÁry
 
logR•liÿtiÚEÁry
 = 
ob£rvabËAckMsg
.
	`g‘D©aMes§ge
();

1258 
‹¡CÚfig
.
wa™On
) {

1259 
ON_ACK
:

1260 
	`v”ifyEx³ùedV®ue
(
ex³ùedAckMes§ges
, 
ackMes§ges
.
	`g‘MsgCÁ
());

1262 
ON_ACK_TS
:

1263 
	`v”ifyEx³ùedV®ue
(
ex³ùedAckTime¡amp
, 
logR•liÿtiÚEÁry
.
	`g‘M‘ad©a
().
time¡amp
);

1267 
	}
}

1269 
´iv©e
 
	$v”ifyP”si¡edSÇpshÙM‘ad©a
() {

1270 
Ï¡SÇpS¹
 = 
wr™”M‘aD©aTabË
.
	`g‘
(
La¡SÇpS¹
.
	`g‘V®
());

1271 
Ï¡SÇpDÚe
 = 
wr™”M‘aD©aTabË
.
	`g‘
(
La¡SÇpAµlyDÚe
.
	`g‘V®
());

1273 
Sy¡em
.
out
.
	`´šn
("\Æa¡SÇpS¹ " + 
Ï¡SÇpS¹
 + "†a¡SÇpDÚ" + 
Ï¡SÇpDÚe
);

1274 
	`as£¹Th©
(
Ï¡SÇpS¹
 =ğ
Ï¡SÇpDÚe
).
	`isTrue
();

1275 
	}
}

1277 
´iv©e
 
	$v”ifyP”si¡edLogEÁryM‘ad©a
() {

1278 
Ï¡LogProûs£d
 = 
wr™”M‘aD©aTabË
.
	`g‘
(
La¡LogProûs£d
.
	`g‘V®
());

1280 
Sy¡em
.
out
.
	`´šn
("\Æa¡LogProûs£d " + 
Ï¡LogProûs£d
 + "ƒx³ùedTime¡am°" + 
ex³ùedAckTime¡amp
);

1281 
	`as£¹Th©
(
ex³ùedAckTime¡amp
 =ğ
Ï¡LogProûs£d
).
	`isTrue
();

1282 
	}
}

1284 
public
 
	eWAIT
 {

1285 
	gON_ACK
,

1286 
	gON_ACK_TS
,

1287 
	gON_ERROR
,

1288 
	gON_DATA_CONTROL_CALL
,

1289 
	gON_RESCHEDULE_SNAPSHOT_SYNC
,

1290 
	gON_SINK_RECEIVE
,

1292 
	gNONE


1295 @
D©a


1296 
public
 şas 
	cTe¡CÚfig
 {

1297 
	gdrİMes§geLev–
 = 0;

1298 
boŞ—n
 
	gŒim
 = 
çl£
;

1299 
boŞ—n
 
	gwr™šgSrc
 = 
çl£
;

1300 
boŞ—n
 
	gwr™šgD¡
 = 
çl£
;

1301 
boŞ—n
 
	gd–‘eOP
 = 
çl£
;

1302 
WAIT
 
	gwa™On
 = WAIT.
ON_ACK
;

1304 
public
 
Te¡CÚfig
() {}

1306 
public
 
Te¡CÚfig
 
ş—r
() {

1307 
	gdrİMes§geLev–
 = 0;

1308 
	gŒim
 = 
çl£
;

1309 
	gwr™šgSrc
 = 
çl£
;

1310 
	gwr™šgD¡
 = 
çl£
;

1311 
	gd–‘eOP
 = 
çl£
;

1312  
	gthis
;

	@test/src/test/java/org/corfudb/integration/LogSizeQuotaIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÙaExûededExû±iÚ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

18 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeStÜe
;

19 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

20 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

21 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

25 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

26 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

28 
public
 cÏs 
	cLogSizeQuÙaIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

30 
fš®
 
	m·ylßdSize
 = 1000;

32 
´iv©e
 
Proûss
 
	$runS”v”W™hQuÙa
(
pÜt
, 
quÙa
, 
boŞ—n
 
sšgËNode
è
throws
 
Exû±iÚ
 {

33 
SŒšg
 
logP©h
 = 
	`g‘CÜfuS”v”LogP©h
(
DEFAULT_HOST
, 
pÜt
);

34 
FeStÜe
 
cÜfuDœBack’d
 = 
Fes
.
	`g‘FeStÜe
(
P©hs
.
	`g‘
(
CORFU_LOG_PATH
));

35 
fsSize
 = 
cÜfuDœBack’d
.
	`g‘TÙ®S·û
();

36 
fš®
 
HUNDRED
 = 100.0;

37 
fš®
 
quÙaInP”c
 = 
quÙa
 * 
HUNDRED
 / 
fsSize
;

38  
Ãw
 
	`CÜfuS”v”RuÂ”
()

39 .
	`£tHo¡
(
DEFAULT_HOST
)

40 .
	`£tPÜt
(
pÜt
)

41 .
	`£tSšgË
(
sšgËNode
)

42 .
	`£tLogP©h
(
logP©h
)

43 .
	`£tLogSizeLim™P”ûÁage
(
DoubË
.
	`toSŒšg
(
quÙaInP”c
))

44 .
	`runS”v”
();

47 
´iv©e
 
	$exhau¡QuÙa
(
ISŒ—mV›w
 
sv
) {

48 
fš®
 
by‹
[] 
·ylßd
 = 
Ãw
 by‹[
·ylßdSize
];

49 
Œue
) {

50 
Œy
 {

51 
sv
.
	`­³nd
(
·ylßd
);

52 } 
	`ÿtch
 (
QuÙaExûededExû±iÚ
 
eq
) {

56 
	}
}

58 @
Te¡


59 
public
 
	$‹¡LogUn™QuÙa
(è
throws
 
Exû±iÚ
 {

69 
maxLogSize
 = 
FeUts
.
ONE_MB
 / 2;

70 
Proûss
 
£rv”_1
 = 
	`runS”v”W™hQuÙa
(
DEFAULT_PORT
, 
maxLogSize
, 
Œue
);

73 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

75 
M­
<
SŒšg
, SŒšg> 
m­
 = 
¹
.
	`g‘ObjeùsV›w
()

76 .
	`bud
()

77 .
	`£tSŒ—mName
("s1")

78 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

79 .
	`İ’
();

82 
m­
.
	`put
("k1", "v1");

83 
m­
.
	`put
("k2", "v2");

87 
UUID
 
¡»amId
 = UUID.
	`¿ndomUUID
();

88 
ISŒ—mV›w
 
sv
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

90 
	`exhau¡QuÙa
(
sv
);

93 
boŞ—n
 
txnAbÜ‹d
 = 
çl£
;

94 
Œy
 {

95 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

96 
m­
.
	`put
("largeEntry", "Val");

97 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

98 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

99 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
QUOTA_EXCEEDED
);

100 
txnAbÜ‹d
 = 
Œue
;

103 
	`as£¹Th©
(
txnAbÜ‹d
).
	`isTrue
();

106 
fš®
 
em±ySlÙs
 = 
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
;

107 
x
 = 0; x < 
em±ySlÙs
; x++) {

108 
¹
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

112 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

113 .
	`bud”
()

114 .
	`´iÜ™yLev–
(
PriÜ™yLev–
.
HIGH
)

115 .
	`bud
();

117 
CÜfuRuÁime
 
´ivegedRt
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
);

118 
´ivegedRt
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

119 
´ivegedRt
.
	`cÚÃù
();

122 
SŒ—mšgM­
<
SŒšg
, SŒšg> 
m­2
 = 
´ivegedRt
.
	`g‘ObjeùsV›w
()

123 .
	`bud
()

124 .
	`£tSŒ—mName
("s1")

125 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

126 .
	`İ’
();

129 
m­2
.
	`put
("k4", "v4");

132 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

133 
mcw
.
	`addM­
(
m­2
);

134 
Tok’
 
tok’
 = 
mcw
.
	`­³ndCheckpošts
(
´ivegedRt
, "privilegedWriter");

135 
´ivegedRt
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

136 
´ivegedRt
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

140 
m­
.
	`put
("k3", "v3");

144 
CÜfuRuÁime
 
¹3
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

145 
M­
<
SŒšg
, SŒšg> 
m­3
 = 
¹3
.
	`g‘ObjeùsV›w
()

146 .
	`bud
()

147 .
	`£tSŒ—mName
("s1")

148 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

149 .
	`İ’
();

151 
	`as£¹Th©
(
m­3
.
	`g‘
("k1")).
	`isEqu®To
("v1");

152 
	`as£¹Th©
(
m­3
.
	`g‘
("k2")).
	`isEqu®To
("v2");

153 
	`as£¹Th©
(
m­3
.
	`g‘
("k3")).
	`isEqu®To
("v3");

154 
	`as£¹Th©
(
m­3
.
	`g‘
("k4")).
	`isEqu®To
("v4");

155 
	}
}

157 @
Te¡


158 
public
 
	$»¡¬tTe¡
(è
throws
 
Exû±iÚ
 {

160 
maxLogSize
 = 
FeUts
.
ONE_MB
 / 2;

161 
Proûss
 
£rv”_1
 = 
	`runS”v”W™hQuÙa
(
DEFAULT_PORT
, 
maxLogSize
, 
Œue
);

163 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

164 
UUID
 
¡»amId
 = UUID.
	`¿ndomUUID
();

165 
ISŒ—mV›w
 
sv
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

166 
	`exhau¡QuÙa
(
sv
);

169 
	`shutdownCÜfuS”v”
(
£rv”_1
);

170 
£rv”_1
 = 
	`runS”v”W™hQuÙa
(
DEFAULT_PORT
, 
maxLogSize
, 
Œue
);

172 
	`as£¹Th©ThrownBy
((è-> 
sv
.
	`­³nd
(
Ãw
 
by‹
[
·ylßdSize
]))

173 .
	`isIn¡ªûOf
(
QuÙaExûededExû±iÚ
.
şass
);

174 
	}
}

176 @
Te¡


177 
public
 
	$şu¡”šgTe¡
(è
throws
 
Exû±iÚ
 {

179 
maxLogSize
 = 
FeUts
.
ONE_MB
 / 2;

180 
n1PÜt
 = 
DEFAULT_PORT
;

181 
n2PÜt
 = 
DEFAULT_PORT
 + 1;

182 
n3PÜt
 = 
DEFAULT_PORT
 + 2;

183 
Proûss
 
£rv”_1
 = 
	`runS”v”W™hQuÙa
(
n1PÜt
, 
maxLogSize
, 
Œue
);

184 
Proûss
 
£rv”_2
 = 
	`runS”v”W™hQuÙa
(
n2PÜt
, 
maxLogSize
, 
çl£
);

185 
Proûss
 
£rv”_3
 = 
	`runS”v”W™hQuÙa
(
n3PÜt
, 
maxLogSize
, 
çl£
);

187 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

188 
ISŒ—mV›w
 
sv
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
UUID
.
	`¿ndomUUID
());

189 
	`exhau¡QuÙa
(
sv
);

191 
fš®
 
Du¿tiÚ
 
timeout
 = Du¿tiÚ.
	`ofMšu‹s
(5);

192 
fš®
 
Du¿tiÚ
 
pŞlP”iod
 = Du¿tiÚ.
	`ofMlis
(50);

193 
fš®
 
wÜkæowNumR‘ry
 = 3;

195 
¹
.
	`g‘Mªagem’tV›w
().
	`addNode
(
DEFAULT_HOST
 + ":" + 
n2PÜt
, 
wÜkæowNumR‘ry
,

196 
timeout
, 
pŞlP”iod
);

197 
¹
.
	`g‘Mªagem’tV›w
().
	`addNode
(
DEFAULT_HOST
 + ":" + 
n3PÜt
, 
wÜkæowNumR‘ry
,

198 
timeout
, 
pŞlP”iod
);

200 
fš®
 
şu¡”SizeN3
 = 3;

201 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AÎS”v”s
().
	`size
(è=ğ
şu¡”SizeN3


202 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
¹
);

205 
	`as£¹Th©ThrownBy
((è-> 
sv
.
	`­³nd
(
Ãw
 
by‹
[
·ylßdSize
]))

206 .
	`isIn¡ªûOf
(
QuÙaExûededExû±iÚ
.
şass
);

209 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

210 .
	`bud”
()

211 .
	`´iÜ™yLev–
(
PriÜ™yLev–
.
HIGH
)

212 .
	`bud
();

214 
CÜfuRuÁime
 
´ivegedRt
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
);

215 
´ivegedRt
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

216 
´ivegedRt
.
	`cÚÃù
();

218 
ISŒ—mV›w
 
sv2
 = 
´ivegedRt
.
	`g‘SŒ—msV›w
().
	`g‘
(
UUID
.
	`¿ndomUUID
());

219 
cu¼Ta
 = 
´ivegedRt
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Sequ’û
();

220 
	`as£¹Th©
(
sv2
.
	`­³nd
(
Ãw
 
by‹
[
·ylßdSize
])).
	`isEqu®To
(
cu¼Ta
 + 1);

224 
	`shutdownCÜfuS”v”
(
£rv”_2
);

225 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AùiveLayoutS”v”s
().
	`size
(è=ğ2, 
¹
);

226 
	`runS”v”W™hQuÙa
(
n2PÜt
, 
maxLogSize
, 
çl£
);

227 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Segm’ts
().
	`size
() == 1 &&

228 
Ïyout
.
	`g‘AùiveLayoutS”v”s
().
	`size
(è=ğ
şu¡”SizeN3
, 
¹
);

229 
	}
}

	@test/src/test/java/org/corfudb/integration/MemoryFootprintIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gGauge
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

24 @
Slf4j


25 
public
 cÏs 
	cMemÜyFoÙ´štIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

27 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

28 
´iv©e
 
	mcÜfuSŒšgNodePÜt
;

29 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

33 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”
(
SŒšg
 
ho¡
, 
pÜt
è
throws
 
IOExû±iÚ
 {

34  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

35 .
	`£tHo¡
(
ho¡
)

36 .
	`£tPÜt
(
pÜt
)

37 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
ho¡
, 
pÜt
))

38 .
	`£tSšgË
(
Œue
)

39 .
	`runS”v”
();

43 @
BefÜe


44 
public
 
	$lßdPrİ”t›s
() {

45 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

46 
cÜfuSŒšgNodePÜt
 = 
IÁeg”
.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodePort"));

47 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
("%s:%d",

48 
cÜfuSšgËNodeHo¡
,

49 
cÜfuSŒšgNodePÜt
);

50 
	}
}

60 @
Te¡


61 
public
 
	$‹¡CÜfuTabËPutMemÜyFoÙ´št
(è
throws
 
Exû±iÚ
 {

63 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

66 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

69 
CÜfuTabË
 
‹¡TabË
 = 
ruÁime


70 .
	`g‘ObjeùsV›w
()

71 .
	`bud
()

72 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Objeù
>>() {})

73 .
	`£tSŒ—mName
("volbeat")

74 .
	`İ’
();

77 
Sy¡em
.
	`gc
();

80 
fš®
 
Gauge
<
LÚg
> 
cÜfuTabËSizeGauge
 = 
M‘ricsUts
.
	`addMemÜyM—su»rFÜ
(

81 
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
(),

82 
‹¡TabË
);

83 
fš®
 
LÚg
 
š™ŸlSize
 = 
cÜfuTabËSizeGauge
.
	`g‘V®ue
();

86 
fš®
 
couÁ
 = 100;

87 
fš®
 
’ŒySize
 = 100000;

88 
i
 = 0; i < 
couÁ
; i++) {

89 
‹¡TabË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), 
Ãw
 
by‹
[
’ŒySize
]);

93 
fš®
 
LÚg
 
sizeAá”Puts
 = 
cÜfuTabËSizeGauge
.
	`g‘V®ue
();

94 
	`as£¹Th©
(
sizeAá”Puts
 - 
š™ŸlSize
)

95 .
	`isG»©”ThªOrEqu®To
(
couÁ
 * 
’ŒySize
);

96 
log
.
	`šfo
("initialSize:{}, sizeAfterPuts:{}",

97 
š™ŸlSize
,

98 
sizeAá”Puts
);

101 
	`as£¹Th©
(
‹¡TabË
.
	`size
()).
	`isEqu®To
(
couÁ
);

102 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

103 
	}
}

113 @
Te¡


114 
public
 
	$‹¡CÜfuTabËRemoveMemÜyFoÙ´št
(è
throws
 
Exû±iÚ
 {

116 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

119 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

122 
CÜfuTabË
 
‹¡TabË
 = 
ruÁime


123 .
	`g‘ObjeùsV›w
()

124 .
	`bud
()

125 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Objeù
>>() {})

126 .
	`£tSŒ—mName
("volbeat")

127 .
	`İ’
();

130 
fš®
 
Gauge
<
LÚg
> 
cÜfuTabËSizeGauge
 =

131 
M‘ricsUts
.
	`addMemÜyM—su»rFÜ
(
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
(), 
‹¡TabË
);

134 
fš®
 
couÁ
 = 100;

135 
fš®
 
’ŒySize
 = 100000;

136 
i
 = 0; i < 
couÁ
; i++) {

137 
‹¡TabË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), 
Ãw
 
by‹
[
’ŒySize
]);

140 
fš®
 
LÚg
 
sizeAá”Puts
 = 
cÜfuTabËSizeGauge
.
	`g‘V®ue
();

143 
i
 = 0; i < 
couÁ
 - 1; i++) {

144 
fš®
 
SŒšg
 
keyToRemove
 = SŒšg.
	`v®ueOf
(
i
);

145 
‹¡TabË
.
	`»move
(
keyToRemove
);

149 
Sy¡em
.
	`gc
();

150 
fš®
 
LÚg
 
sizeAá”Removes
 = 
cÜfuTabËSizeGauge
.
	`g‘V®ue
();

151 
	`as£¹Th©
(
sizeAá”Removes
).
	`isLessThªOrEqu®To
(
sizeAá”Puts
);

152 
log
.
	`šfo
("sizeAfterPuts:{}, sizeAfterRemoves:{}",

153 
sizeAá”Puts
,

154 
sizeAá”Removes
);

157 
	`as£¹Th©
(
‹¡TabË
.
	`size
()).
	`isEqu®To
(1);

158 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

159 
	}
}

	@test/src/test/java/org/corfudb/integration/ReplicationReaderWriterIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogEÁryWr™”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gP”si¡edWr™”M‘ad©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gSŒ—msSÇpshÙWr™”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—dMes§ge
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msLogEÁryR—d”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msSÇpshÙR—d”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

27 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

29 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

30 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

31 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

32 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

33 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

34 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

35 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

36 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

37 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

38 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

40 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	g¦“p
;

41 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

44 @
Slf4j


45 
public
 cÏs 
	cR•liÿtiÚR—d”Wr™”IT
 
ex‹nds
 
	mAb¡¿ùIT
 {

46 
fš®
 
SŒšg
 
	mDEFAULT_ENDPOINT
 = 
DEFAULT_HOST
 + ":" + 
DEFAULT_PORT
;

47 
fš®
 
	mWRITER_PORT
 = 
DEFAULT_PORT
 + 1;

48 
fš®
 
SŒšg
 
	mWRITER_ENDPOINT
 = 
DEFAULT_HOST
 + ":" + 
WRITER_PORT
;

49 
´iv©e
 
fš®
 
	mSTART_VAL
 = 11;

50 
´iv©e
 
fš®
 
	mNUM_KEYS
 = 10;

51 
´iv©e
 
fš®
 
	mNUM_STREAMS
 = 2;

52 
public
 
fš®
 
	mNUM_TRANSACTIONS
 = 100;

53 
fš®
 
UUID
 
	mPRIMARY_SITE_ID
 = UUID.
¿ndomUUID
();

54 
fš®
 
UUID
 
	mREMOTE_SITE_ID
 = UUID.
¿ndomUUID
();

57 
Proûss
 
	m£rv”1
;

58 
Proûss
 
	m£rv”2
;

61 
CÜfuRuÁime
 
	m¤cD©aRuÁime
 = 
nuÎ
;

64 
CÜfuRuÁime
 
	m»ad”RuÁime
 = 
nuÎ
;

67 
CÜfuRuÁime
 
	mwr™”RuÁime
 = 
nuÎ
;

70 
CÜfuRuÁime
 
	md¡D©aRuÁime
 = 
nuÎ
;

72 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	m¤cTabËs
 = 
Ãw
 
HashM­
<>();

73 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	md¡TabËs
 = 
Ãw
 
HashM­
<>();

74 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	mshadowTabËs
 = 
Ãw
 
HashM­
<>();

76 
CÜfuRuÁime
 
	m¤cTe¡RuÁime
;

77 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	m¤cTe¡TabËs
 = 
Ãw
 
HashM­
<>();

79 
CÜfuRuÁime
 
	md¡Te¡RuÁime
;

80 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	md¡Te¡TabËs
 = 
Ãw
 
HashM­
<>();

85 
	mHashM­
<
	mSŒšg
, HashM­<
	mLÚg
, LÚg>> 
	m¤cHashM­
 = 
Ãw
 
HashM­
<
SŒšg
, HashMap<Long, Long>>();

86 
	mHashM­
<
	mSŒšg
, HashM­<
	mLÚg
, LÚg>> 
	md¡HashM­
 = 
Ãw
 
HashM­
<
SŒšg
, HashMap<Long, Long>>();

91 
	mLi¡
<
	mÜg
.
	mcÜfudb
.
	m´ÙocŞs
.
	mwœ•rÙocŞ
.
	mlog»¶iÿtiÚ
.
	mLogR•liÿtiÚEÁry
> 
	mmsgQ
 = 
Ãw
 
A¼ayLi¡
<>();

93 
	$£tupEnv
(è
throws
 
IOExû±iÚ
 {

95 
£rv”1
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

96 .
	`£tHo¡
(
DEFAULT_HOST
)

97 .
	`£tPÜt
(
DEFAULT_PORT
)

98 .
	`£tSšgË
(
Œue
)

99 .
	`runS”v”
();

101 
£rv”2
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

102 .
	`£tHo¡
(
DEFAULT_HOST
)

103 .
	`£tPÜt
(
WRITER_PORT
)

104 .
	`£tSšgË
(
Œue
)

105 .
	`runS”v”
();

107 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

108 .
	`bud”
()

109 .
	`bud
();

111 
¤cD©aRuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

112 
¤cD©aRuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

113 
¤cD©aRuÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

115 
¤cTe¡RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

116 
¤cTe¡RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

117 
¤cTe¡RuÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

119 
»ad”RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

120 
»ad”RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
);

121 
»ad”RuÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

123 
wr™”RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

124 
wr™”RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
WRITER_ENDPOINT
);

125 
wr™”RuÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

127 
d¡D©aRuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

128 
d¡D©aRuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
WRITER_ENDPOINT
);

129 
d¡D©aRuÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

131 
d¡Te¡RuÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
·¿ms
);

132 
d¡Te¡RuÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
WRITER_ENDPOINT
);

133 
d¡Te¡RuÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

136 
public
 
	`İ’SŒ—ms
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, 
CÜfuRuÁime
 
¹
) {

137 
	`İ’SŒ—ms
(
bËs
, 
¹
, 
NUM_STREAMS
, 
S”Ÿliz”s
.
PRIMITIVE
, 
çl£
);

138 
	}
}

140 
public
 
İ’SŒ—ms
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, 
CÜfuRuÁime
 
¹
, 
boŞ—n
 
shadow
) {

141 
İ’SŒ—ms
(
bËs
, 
¹
, 
NUM_STREAMS
, 
S”Ÿliz”s
.
PRIMITIVE
, 
shadow
);

144 
public
 
İ’SŒ—ms
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, 
CÜfuRuÁime
 
¹
, 
num_¡»ams
) {

145 
İ’SŒ—ms
(
bËs
, 
¹
, 
num_¡»ams
, 
S”Ÿliz”s
.
PRIMITIVE
);

148 
public
 
İ’SŒ—ms
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, 
CÜfuRuÁime
 
¹
, 
num_¡»ams
,

149 
IS”Ÿliz”
 
£rŸliz”
, 
boŞ—n
 
shadow
) {

150 
	gi
 = 0; i < 
	gnum_¡»ams
; i++) {

151 
SŒšg
 
	gÇme
 = "‹¡" + 
i
;

152 ià(
	gshadow
) {

153 
	gÇme
 = 
Çme
 + "_shadow";

155 
	gCÜfuTabË
<
	gLÚg
, LÚg> 
	gbË
 = 
¹
.
g‘ObjeùsV›w
()

156 .
bud
()

157 .
£tSŒ—mName
(
Çme
)

158 .
£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
LÚg
, Long>>() {

160 .
£tS”Ÿliz”
(
£rŸliz”
)

161 .
İ’
();

162 
	gbËs
.
put
(
Çme
, 
bË
);

166 
public
 
İ’SŒ—ms
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, 
CÜfuRuÁime
 
¹
, 
num_¡»ams
,

167 
IS”Ÿliz”
 
£rŸliz”
) {

168 
İ’SŒ—ms
(
bËs
, 
¹
, 
num_¡»ams
, 
£rŸliz”
, 
çl£
);

172 
public
 
g’”©eD©a
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
,

173 
HashM­
<
SŒšg
, HashM­<
LÚg
, LÚg>> 
hashM­
,

174 
numKeys
, 
CÜfuRuÁime
 
¹
, 
¡¬tv®
) {

175 
	gi
 = 0; i < 
	gnumKeys
; i++) {

176 
SŒšg
 
	gÇme
 : 
bËs
.
keyS‘
()) {

177 
hashM­
.
putIfAb£Á
(
Çme
, 
Ãw
 
HashM­
<>());

178 
	gkey
 = 
i
 + 
¡¬tv®
;

179 
	gbËs
.
g‘
(
Çme
).
put
(
key
, key);

180 
	glog
.
Œaû
(" " + 
¹
.
g‘Add»ssS·ûV›w
().
g‘LogTa
(è+ " seq " +„t.
g‘Sequ’ûrV›w
().
qu”y
().
g‘Sequ’û
());

181 
	ghashM­
.
g‘
(
Çme
).
put
(
key
, key);

187 
public
 
g’”©eT¿n§ùiÚs
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
,

188 
HashM­
<
SŒšg
, HashM­<
LÚg
, LÚg>> 
hashM­
,

189 
numT
, 
CÜfuRuÁime
 
¹
, 
¡¬tv®
) {

190 
	gj
 = 0;

191 
	gi
 = 0; i < 
	gnumT
; i++) {

192 
	g¹
.
g‘ObjeùsV›w
().
TXBegš
();

193 
SŒšg
 
	gÇme
 : 
bËs
.
keyS‘
()) {

194 
hashM­
.
putIfAb£Á
(
Çme
, 
Ãw
 
HashM­
<>());

195 
	gkey
 = 
j
 + 
¡¬tv®
;

196 
	gbËs
.
g‘
(
Çme
).
put
(
key
, key);

197 
	glog
.
Œaû
(" " + 
¹
.
g‘Add»ssS·ûV›w
().
g‘LogTa
(è+ " seq " +„t.
g‘Sequ’ûrV›w
().
qu”y
().
g‘Sequ’û
());

198 
	ghashM­
.
g‘
(
Çme
).
put
(
key
, key);

199 
	gj
++;

201 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

203 
	gSy¡em
.
	gout
.
´šn
("\ng’”©Œª§ùiÚ num " + 
numT
);

206 
public
 
v”ifyD©a
(
SŒšg
 
g
, 
HashM­
<SŒšg, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, HashM­<SŒšg, HashM­<LÚg, LÚg>> 
hashM­
) {

207 
	gSy¡em
.
	gout
.
´šn
("\n" + 
g
);

208 
SŒšg
 
	gÇme
 : 
hashM­
.
keyS‘
()) {

209 
CÜfuTabË
<
LÚg
, 
	gLÚg
> 
	gbË
 = 
bËs
.
g‘
(
Çme
);

210 
	gHashM­
<
	gLÚg
, LÚg> 
	gm­Keys
 = 
hashM­
.
g‘
(
Çme
);

211 
	gSy¡em
.
	gout
.
´šn
("bË " + 
Çme
 + " key siz" + 
bË
.
keyS‘
().
size
() +

212 " hashM­ siz" + 
m­Keys
.
size
());

214 
as£¹Th©
(
m­Keys
.
keyS‘
().
cÚšsAÎ
(
bË
.keyS‘())).
isTrue
();

215 
as£¹Th©
(
bË
.
keyS‘
().
cÚšsAÎ
(
m­Keys
.keyS‘())).
isTrue
();

216 
as£¹Th©
(
bË
.
keyS‘
().
size
(è=ğ
m­Keys
.keyS‘().size()).
isTrue
();

218 
LÚg
 
	gkey
 : 
m­Keys
.
keyS‘
()) {

219 
as£¹Th©
(
bË
.
g‘
(
key
)).
isEqu®To
(
m­Keys
.get(key));

224 
public
 
v”ifyTabË
(
SŒšg
 
g
, 
HashM­
<SŒšg, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
, HashM­<SŒšg, CÜfuTabË<LÚg, LÚg>> 
hashM­
) {

225 
	gSy¡em
.
	gout
.
´šn
("\n" + 
g
);

226 
SŒšg
 
	gÇme
 : 
hashM­
.
keyS‘
()) {

227 
CÜfuTabË
<
LÚg
, 
	gLÚg
> 
	gbË
 = 
bËs
.
g‘
(
Çme
);

228 
	gCÜfuTabË
<
	gLÚg
, LÚg> 
	gm­Keys
 = 
hashM­
.
g‘
(
Çme
);

229 
	gSy¡em
.
	gout
.
´šn
("bË " + 
Çme
 + " key siz" + 
bË
.
keyS‘
().
size
() +

230 " hashM­ siz" + 
m­Keys
.
size
());

232 
as£¹Th©
(
m­Keys
.
keyS‘
().
cÚšsAÎ
(
bË
.keyS‘())).
isTrue
();

233 
as£¹Th©
(
bË
.
keyS‘
().
cÚšsAÎ
(
m­Keys
.keyS‘())).
isTrue
();

234 
as£¹Th©
(
bË
.
keyS‘
().
size
(è=ğ
m­Keys
.keyS‘().size()).
isTrue
();

236 
LÚg
 
	gkey
 : 
m­Keys
.
keyS‘
()) {

237 
as£¹Th©
(
bË
.
g‘
(
key
)).
isEqu®To
(
m­Keys
.get(key));

242 
public
 
v”ifyNoD©a
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
) {

243 
CÜfuTabË
 
	gbË
 : 
bËs
.
v®ues
()) {

244 
as£¹Th©
(
bË
.
keyS‘
().
isEm±y
()).
isTrue
();

249 
	$v”ifyTxSŒ—m
(
CÜfuRuÁime
 
¹
) {

250 
SŒ—mO±iÚs
 
İtiÚs
 = SŒ—mO±iÚs.
	`bud”
()

251 .
	`ÿcheEÁr›s
(
çl£
)

252 .
	`bud
();

254 
ISŒ—mV›w
 
txSŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘Un§ã
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
, 
İtiÚs
);

255 
Li¡
<
ILogD©a
> 
d©aLi¡
 = 
txSŒ—m
.
	`»maššg
();

256 
Sy¡em
.
out
.
	`´šn
("\nd©aLi¡ siz" + 
d©aLi¡
.
	`size
());

257 
ILogD©a
 
d©a
 : 
txSŒ—m
.
	`»maššg
()) {

258 
Sy¡em
.
out
.
	`´šn
(
d©a
);

260 
	}
}

262 
public
 
»adLogEÁryMsgs
(
Li¡
<
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
> 
msgQ
, 
S‘
<
SŒšg
> 
¡»ams
, 
CÜfuRuÁime
 
¹
è
throws


263 
	gTrimmedExû±iÚ
 {

264 
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
¡»ams
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

265 
SŒ—msLogEÁryR—d”
 
	g»ad”
 = 
Ãw
 SŒ—msLogEÁryR—d”(
¹
, 
cÚfig
);

266 
	g»ad”
.
£tGlob®Ba£SÇpshÙ
(
Add»ss
.
NON_ADDRESS
, Address.NON_ADDRESS);

268 
	gi
 = 0; i < 
	gNUM_TRANSACTIONS
; i++) {

269 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gmes§ge
 = 
»ad”
.
»ad
(
PRIMARY_SITE_ID
);

271 ià(
	gmes§ge
 =ğ
nuÎ
) {

272 
Sy¡em
.
out
.
´šn
("**********data message is‚ull");

273 
as£¹Th©
(
çl£
).
isTrue
();

275 ià(
	gmes§ge
 =ğ
nuÎ
) {

276 
Sy¡em
.
out
.
´šn
("**********data message is‚ull");

277 
as£¹Th©
(
çl£
).
isTrue
();

281 
	gmsgQ
.
add
(
mes§ge
);

287 
public
 
wr™eLogEÁryMsgs
(
Li¡
<
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
> 
msgQ
, 
S‘
<
SŒšg
> 
¡»ams
, 
CÜfuRuÁime
 
¹
) {

288 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
¡»ams
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

289 
P”si¡edWr™”M‘ad©a
 
	g³rsi¡edWr™”M‘ad©a
 = 
Ãw
 P”si¡edWr™”M‘ad©a(
¹
, 0, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

290 
LogEÁryWr™”
 
	gwr™”
 = 
Ãw
 LogEÁryWr™”(
¹
, 
cÚfig
, 
³rsi¡edWr™”M‘ad©a
);

292 ià(
	gmsgQ
.
isEm±y
()) {

293 
	gSy¡em
.
	gout
.
´šn
("msgQ isƒmpty");

296 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gd©a
 = 
msgQ
.
g‘
(0);

299 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gmsg
 : 
msgQ
) {

300 
wr™”
.
­¶y
(
msg
);

304 
public
 
	$´štTas
(
SŒšg
 
g
, 
CÜfuRuÁime
 
¹0
, CÜfuRuÁim
¹1
) {

305 
Sy¡em
.
out
.
	`´šn
("\n" + 
g
);

306 
Sy¡em
.
out
.
	`´šn
("¤ød©aTa " + 
¹0
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
());

307 
Sy¡em
.
out
.
	`´šn
("d¡ d©aTa " + 
¹1
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
());

309 
	}
}

311 @
Te¡


312 
public
 
	$‹¡TwoS”v”sCªUp
 (è
throws
 
IOExû±iÚ
 {

313 
Sy¡em
.
out
.
	`´šn
("\ntest start");

314 
	`£tupEnv
();

316 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

317 
	`İ’SŒ—ms
(
¤cTe¡TabËs
, 
¤cTe¡RuÁime
);

318 
	`İ’SŒ—ms
(
d¡TabËs
, 
d¡D©aRuÁime
);

319 
	`İ’SŒ—ms
(
d¡Te¡TabËs
, 
d¡Te¡RuÁime
);

322 
	`g’”©eD©a
(
¤cTabËs
, 
¤cHashM­
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS);

325 
	`g’”©eD©a
(
d¡TabËs
, 
d¡HashM­
, 
NUM_KEYS
, 
d¡D©aRuÁime
, NUM_KEYS*2);

327 
	`v”ifyD©a
("¤ùabËs", 
¤cTabËs
, 
¤cHashM­
);

328 
	`v”ifyD©a
("¤cTe¡TabËs", 
¤cTe¡TabËs
, 
¤cHashM­
);

330 
	`v”ifyD©a
("d¡CÜfuTabËs", 
d¡TabËs
, 
d¡HashM­
);

331 
	`v”ifyD©a
("d¡Te¡TabËs", 
d¡Te¡TabËs
, 
d¡HashM­
);

333 
	}
}

335 
public
 
»adSÇpLogMsgs
(
Li¡
<
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
> 
msgQ
, 
S‘
<
SŒšg
> 
¡»ams
, 
CÜfuRuÁime
 
¹
) {

336 
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
¡»ams
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

337 
SŒ—msSÇpshÙR—d”
 
	g»ad”
 = 
Ãw
 SŒ—msSÇpshÙR—d”(
¹
, 
cÚfig
);

338 
	gút
 = 0;

340 
	g»ad”
.
»£t
(
¹
.
g‘Add»ssS·ûV›w
().
g‘LogTa
());

341 
	gŒue
) {

342 
	gút
++;

343 
SÇpshÙR—dMes§ge
 
	g¢­shÙR—dMes§ge
 = 
»ad”
.
»ad
(
PRIMARY_SITE_ID
);

344 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gd©a
 : 
¢­shÙR—dMes§ge
.
g‘Mes§ges
()) {

345 
msgQ
.
add
(
d©a
);

349 ià(
	g¢­shÙR—dMes§ge
.
isEndR—d
()) {

355 
public
 
wr™eSÇpLogMsgs
(
Li¡
<
Üg
.
cÜfudb
.
´ÙocŞs
.
wœ•rÙocŞ
.
log»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
> 
msgQ
, 
S‘
<
SŒšg
> 
¡»ams
, 
CÜfuRuÁime
 
¹
) {

356 
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
¡»ams
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

357 
P”si¡edWr™”M‘ad©a
 
	g³rsi¡edWr™”M‘ad©a
 = 
Ãw
 P”si¡edWr™”M‘ad©a(
¹
, 0, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

358 
SŒ—msSÇpshÙWr™”
 
	gwr™”
 = 
Ãw
 SŒ—msSÇpshÙWr™”(
¹
, 
cÚfig
, 
³rsi¡edWr™”M‘ad©a
);

362 ià(
	gmsgQ
.
isEm±y
()) {

363 
	gSy¡em
.
	gout
.
´šn
("msgQ isƒmpty");

366 
	gs™eEpoch
 = 
msgQ
.
g‘
(0).
g‘M‘ad©a
().
g‘S™eEpoch
();

367 
	g¢­shÙ
 = 
msgQ
.
g‘
(0).
g‘M‘ad©a
().
g‘SÇpshÙTime¡amp
();

368 
	g³rsi¡edWr™”M‘ad©a
.
£tSrcBa£SÇpshÙS¹
(
s™eEpoch
, 
¢­shÙ
);

369 
	gwr™”
.
»£t
(
s™eEpoch
, 
¢­shÙ
);

371 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
LogR•liÿtiÚEÁry
 
	gmsg
 : 
msgQ
) {

372 
wr™”
.
­¶y
(
msg
);

375 
LÚg
 
	g£q
 = 
wr™”
.
g‘P”si¡edWr™”M‘ad©a
().
g‘La¡SÇpSeqNum
() + 1;

376 
	gwr™”
.
­¶yShadowSŒ—ms
(
£q
);

379 
	$acûssTxSŒ—m
(
I‹¿tÜ
 
™”©Ü
, 
num
) {

381 
i
 = 0;

382 
™”©Ü
.
	`hasNext
(è&& 
i
++ < 
num
) {

383 
ILogD©a
 
d©a
 = (ILogD©aè
™”©Ü
.
	`Ãxt
();

386 
	}
}

388 
public
 
ş—rTabËs
(
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
) {

389 
	gCÜfuTabË
<
	gLÚg
, LÚg> 
	gbË
 : 
bËs
.
v®ues
()) {

390 
bË
.
ş—r
();

394 
public
 
	$ŒimAlÚe
 (
add»ss
, 
CÜfuRuÁime
 
¹
) {

396 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(0, 
add»ss
);

397 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

398 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

399 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

400 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

401 
Sy¡em
.
out
.
	`´šn
("Œim‡ˆ" + 
tok’
 + " cu¼’tTa " + 
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
());

402 
	}
}

407 
public
 
Tok’
 
ckSŒ—msAndTrim
(
CÜfuRuÁime
 
¹
, 
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
bËs
) {

408 
MuÉiCheckpoštWr™”
 
	gmcw1
 = 
Ãw
 MultiCheckpointWriter();

409 
CÜfuTabË
 
	gm­
 : 
bËs
.
v®ues
()) {

410 
mcw1
.
addM­
(
m­
);

413 
Tok’
 
	gcheckpoštAdd»ss
 = 
mcw1
.
­³ndCheckpošts
(
¹
, "test");

416 
ŒimAlÚe
(
checkpoštAdd»ss
.
g‘Sequ’û
(), 
¹
);

417  
	gcheckpoštAdd»ss
;

420 
public
 
	$Œim
(
add»ss
, 
CÜfuRuÁime
 
¹
) {

421 
Tok’
 
tok’
 = 
	`ckSŒ—msAndTrim
(
¹
, 
¤cTabËs
);

423 
Tok’
 
ŒimM¬k
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

425 
ŒimM¬k
.
	`g‘Sequ’û
(è!ğ(
tok’
.getSequence() + 1)) {

426 
Sy¡em
.
out
.
	`´šn
("ŒimM¬k " + 
ŒimM¬k
 + "rimTok’ " + 
tok’
);

427 
ŒimM¬k
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

430 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

431 
Sy¡em
.
out
.
	`´šn
("Œim " + 
tok’
);

432 
	}
}

434 
	$ŒimD–ay
() {

435 
Œy
 {

436 
msgQ
.
	`isEm±y
()) {

437 
	`¦“p
(1);

439 
	`Œim
(
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
()- 2, srcDataRuntime);

440 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

441 
Sy¡em
.
out
.
	`´šn
("ÿughˆªƒxû±iÚ " + 
e
);

443 
	}
}

445 
	$ŒimAlÚeD–ay
() {

446 
Œy
 {

447 
msgQ
.
	`isEm±y
()) {

448 
	`¦“p
(1);

450 
	`ŒimAlÚe
(
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
(), srcDataRuntime);

451 } 
	`ÿtch
 ( 
Exû±iÚ
 
e
) {

452 
Sy¡em
.
out
.
	`´šn
("ÿughˆªƒxû±iÚ " + 
e
);

454 
	}
}

460 @
Te¡


461 
public
 
	$‹¡TrimmedExû±iÚFÜTxSŒ—m
(è
throws
 
IOExû±iÚ
 {

462 
fš®
 
»ads
 = 10;

463 
	`£tupEnv
();

464 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

465 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
¤cHashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, 
NUM_KEYS
);

468 
ISŒ—mV›w
 
txSŒ—m
 = 
¤cTe¡RuÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
);

469 

 = 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

470 
SŒ—m
<
ILogD©a
> 
¡»am
 = 
txSŒ—m
.
	`¡»amUpTo
(

);

471 
I‹¿tÜ
 
™”©Ü
 = 
¡»am
.
	`™”©Ü
();

473 
	`acûssTxSŒ—m
(
™”©Ü
, 
»ads
);

474 
Exû±iÚ
 
»suÉ
 = 
nuÎ
;

475 
	`Œim
(

, 
¤cD©aRuÁime
);

477 
Œy
 {

478 
	`acûssTxSŒ—m
(
™”©Ü
, ()

);

479 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

480 
»suÉ
 = 
e
;

481 
Sy¡em
.
out
.
	`´šn
("ÿughˆªƒxû±iÚ " + 
e
 + "a " + 

);

482 } 
fš®ly
 {

483 
	`as£¹Th©
(
»suÉ
).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

485 
	}
}

488 @
Te¡


489 
public
 
	$‹¡O³nTabËAá”TrimW™houtCheckpošt
 (è
throws
 
IOExû±iÚ
 {

490 
fš®
 
off£t
 = 20;

491 
	`£tupEnv
();

492 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

493 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
¤cHashM­
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS);

495 
	`ŒimAlÚe
(
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
(è- 
off£t
, srcDataRuntime);

497 
Œy
 {

498 
CÜfuTabË
<
LÚg
, LÚg> 
‹¡TabË
 = 
¤cTe¡RuÁime
.
	`g‘ObjeùsV›w
()

499 .
	`bud
()

500 .
	`£tSŒ—mName
("test0")

501 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
LÚg
, Long>>() {

503 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
PRIMITIVE
)

504 .
	`İ’
();

505 
size
 = 
‹¡TabË
.
	`size
();

506 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

507 
Sy¡em
.
out
.
	`´šn
("ÿughˆ¨exû±iÚ " + 
e
);

508 
	`as£¹Th©
(
e
).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

510 
	}
}

512 @
Te¡


513 
public
 
	$‹¡TrimmedExû±iÚFÜLogEÁryR—d”
(è
throws
 
IOExû±iÚ
 {

514 
	`£tupEnv
();

515 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

516 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
¤cHashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, 
NUM_KEYS
);

517 

 = 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

519 
ScheduËdExecutÜS”viû
 
scheduËdExecutÜS”viû
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(1);

520 
scheduËdExecutÜS”viû
.
	`subm™
(
this
::
ŒimAlÚeD–ay
);

521 
Exû±iÚ
 
»suÉ
 = 
nuÎ
;

523 
Œy
 {

524 
	`»adLogEÁryMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

525 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

526 
»suÉ
 = 
e
;

527 
Sy¡em
.
out
.
	`´šn
("msgQ siz" + 
msgQ
.
	`size
());

528 
Sy¡em
.
out
.
	`´šn
("ÿughˆªƒxû±iÚ " + 
e
 + "a " + 

);

529 } 
fš®ly
 {

530 
	`as£¹Th©
(
»suÉ
).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

532 
	}
}

535 @
Te¡


536 
public
 
	$‹¡TrimmedExû±iÚFÜSÇpshÙR—d”
(è
throws
 
IOExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

537 
	`£tupEnv
();

539 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
, 1);

540 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
¤cHashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, 
NUM_KEYS
);

542 
ScheduËdExecutÜS”viû
 
scheduËdExecutÜS”viû
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(1);

543 
scheduËdExecutÜS”viû
.
	`subm™
(
this
::
ŒimD–ay
);

545 

 = 
¤cD©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

546 
Exû±iÚ
 
»suÉ
 = 
nuÎ
;

548 
Œy
 {

549 
	`»adSÇpLogMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

550 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

551 
»suÉ
 = 
e
;

552 
Sy¡em
.
out
.
	`´šn
("msgQ siz" + 
msgQ
.
	`size
());

553 
Sy¡em
.
out
.
	`´šn
("ÿughˆªƒxû±iÚ " + 
e
 + "a " + 

);

554 } 
fš®ly
 {

555 
	`as£¹Th©
(
»suÉ
).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

559 
Œy
 {

560 
	`»adSÇpLogMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

561 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

562 
»suÉ
 = 
e
;

563 
Sy¡em
.
out
.
	`´šn
("msgQ siz" + 
msgQ
.
	`size
());

564 
Sy¡em
.
out
.
	`´šn
("£cÚdimÿughˆªƒxû±iÚ " + 
e
 + "a " + 

);

565 } 
fš®ly
 {

566 
	`as£¹Th©
(
»suÉ
).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

569 
	}
}

578 @
Te¡


579 
public
 
	$‹¡Wr™eSMREÁr›s
(è
throws
 
Exû±iÚ
 {

581 
Sy¡em
.
out
.
	`´šn
("\ntest start");

582 
	`£tupEnv
();

584 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

585 
	`g’”©eD©a
(
¤cTabËs
, 
¤cHashM­
, 
NUM_KEYS
, 
¤cD©aRuÁime
, NUM_KEYS);

586 
	`v”ifyD©a
("aá” wr™šgØ£rv”1", 
¤cTabËs
, 
¤cHashM­
);

587 
	`´štTas
("aá” wr™šgØ£rv”1", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

590 
SŒ—mO±iÚs
 
İtiÚs
 = SŒ—mO±iÚs.
	`bud”
()

591 .
	`ÿcheEÁr›s
(
çl£
)

592 .
	`bud
();

594 
SŒšg
 
Çme
 : 
¤cHashM­
.
	`keyS‘
()) {

595 
ISŒ—mV›w
 
¤cSV
 = 
¤cTe¡RuÁime
.
	`g‘SŒ—msV›w
().
	`g‘Un§ã
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
Çme
), 
İtiÚs
);

596 
ISŒ—mV›w
 
d¡SV
 = 
d¡Te¡RuÁime
.
	`g‘SŒ—msV›w
().
	`g‘Un§ã
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
Çme
), 
İtiÚs
);

598 
Li¡
<
ILogD©a
> 
d©aLi¡
 = 
¤cSV
.
	`»maššg
();

599 
ILogD©a
 
d©a
 : 
d©aLi¡
) {

600 
O·queEÁry
 
İaqueEÁry
 = O·queEÁry.
	`uÅack
(
d©a
);

601 
UUID
 
uuid
 : 
İaqueEÁry
.
	`g‘EÁr›s
().
	`keyS‘
()) {

602 
SMREÁry
 
’Œy
 : 
İaqueEÁry
.
	`g‘EÁr›s
().
	`g‘
(
uuid
)) {

603 
d¡SV
.
	`­³nd
(
’Œy
);

609 
	`´štTas
("aá” wr™šgØd¡", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

610 
	`İ’SŒ—ms
(
d¡TabËs
, 
wr™”RuÁime
);

611 
	`v”ifyD©a
("aá” wr™šgØd¡", 
d¡TabËs
, 
¤cHashM­
);

612 
	}
}

614 @
Te¡


615 
public
 
	$‹¡P”si¡’tTabË
(è
throws
 
IOExû±iÚ
 {

616 
	`£tupEnv
();

617 
Œy
 {

618 
P”si¡edWr™”M‘ad©a
 
m‘a
 = 
Ãw
 
	`P”si¡edWr™”M‘ad©a
(
wr™”RuÁime
, 0, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

619 
m‘a
.
	`g‘La¡Proûs£dLogTime¡amp
();

620 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

621 
e
.
	`g‘SckT¿û
();

622 
throw
 
e
;

624 
	}
}

626 @
Te¡


627 
public
 
	$‹¡SÇpT¿nsãr
(è
throws
 
Exû±iÚ
 {

629 
Sy¡em
.
out
.
	`´šn
("\ntest start ok");

630 
	`£tupEnv
();

632 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

633 
	`g’”©eD©a
(
¤cTabËs
, 
¤cHashM­
, 
NUM_KEYS
, 
¤cD©aRuÁime
, 
START_VAL
);

634 
	`v”ifyD©a
("aá” wr™šgØ¤c", 
¤cTabËs
, 
¤cHashM­
);

637 
	`İ’SŒ—ms
(
d¡TabËs
, 
d¡D©aRuÁime
);

638 
	`g’”©eD©a
(
d¡TabËs
, 
d¡HashM­
, 
NUM_KEYS
, 
d¡D©aRuÁime
, 
START_VAL
 + NUM_KEYS);

639 
	`v”ifyD©a
("aá” wr™šgØd¡", 
d¡TabËs
, 
d¡HashM­
);

641 
	`´štTas
("aá” wr™šgØ£rv”1", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

644 
	`»adSÇpLogMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

646 
d¡EÁr›s
 = 
msgQ
.
	`size
()*
¤cHashM­
.
	`keyS‘
().size();

647 
d¡P»Ta
 = 
d¡D©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

650 
	`wr™eSÇpLogMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
wr™”RuÁime
);

652 
diff
 = 
d¡D©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
(è- 
d¡P»Ta
;

653 
	`as£¹Th©
(
diff
 =ğ
d¡EÁr›s
);

654 
	`´štTas
("aá” wr™šgØ£rv”2", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

657 
	`v”ifyTabË
("aá” sÇ°wr™© d¡", 
d¡TabËs
, 
¤cTabËs
);

658 
Sy¡em
.
out
.
	`´šn
("test done");

659 
	}
}

662 @
Te¡


663 
public
 
	$‹¡LogEÁryT¿nsãrW™hNoS”Ÿliz”
(è
throws
 
IOExû±iÚ
 {

665 
Sy¡em
.
out
.
	`´šn
("\ntest start ok");

666 
	`£tupEnv
();

667 
IS”Ÿliz”
 
£rŸliz”
 = 
Ãw
 
	`Te¡S”Ÿliz”
(
By‹
.
MAX_VALUE
);

669 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
, 
NUM_STREAMS
, 
£rŸliz”
);

670 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
¤cHashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, NUM_TRANSACTIONS);

672 
HashM­
<
SŒšg
, 
CÜfuTabË
<
LÚg
, LÚg>> 
sšgËTabËs
 = 
Ãw
 HashMap<>();

673 
sšgËTabËs
.
	`putIfAb£Á
("‹¡0", 
¤cTabËs
.
	`g‘
("test0"));

674 
	`g’”©eT¿n§ùiÚs
(
sšgËTabËs
, 
¤cHashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, NUM_TRANSACTIONS);

677 
	`v”ifyD©a
("aá” wr™šgØ¤c", 
¤cTabËs
, 
¤cHashM­
);

679 
	`´štTas
("aá” wr™šgØ£rv”1", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

681 
	`v”ifyTxSŒ—m
(
¤cTe¡RuÁime
);

684 
	`»adLogEÁryMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

686 
d¡EÁr›s
 = 
msgQ
.
	`size
();

687 
d¡P»Ta
 = 
d¡D©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

690 
	`wr™eLogEÁryMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
wr™”RuÁime
);

692 
diff
 = 
d¡D©aRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
(è- 
d¡P»Ta
;

693 
	`´štTas
("aá” wr™šgØ£rv”2", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

696 
	`İ’SŒ—ms
(
d¡TabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
, 
£rŸliz”
);

698 
Exû±iÚ
 
»suÉ
 = 
nuÎ
;

699 
Œy
 {

700 
	`v”ifyD©a
("aá”†og wr™šg‡ˆd¡", 
d¡TabËs
, 
¤cHashM­
);

701 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

702 
Sy¡em
.
out
.
	`´šn
("caught‡nƒxception");

703 
»suÉ
 = 
e
;

704 } 
fš®ly
 {

705 
	`as£¹Th©
(
»suÉ
 
š¡ªûof
 
S”Ÿliz”Exû±iÚ
).
	`isTrue
();

707 
	}
}

709 @
Te¡


710 
public
 
	$‹¡LogEÁryT¿nsãrW™hS”Ÿliz”
(è
throws
 
IOExû±iÚ
 {

712 
Sy¡em
.
out
.
	`´šn
("\ntest start ok");

713 
	`£tupEnv
();

714 
IS”Ÿliz”
 
£rŸliz”
 = 
Ãw
 
	`Te¡S”Ÿliz”
(
By‹
.
MAX_VALUE
);

716 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
, 
NUM_STREAMS
, 
£rŸliz”
);

717 
	`İ’SŒ—ms
(
shadowTabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
, 
£rŸliz”
, 
Œue
);

718 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
¤cHashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, NUM_TRANSACTIONS);

721 
	`»adLogEÁryMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

724 
	`wr™eLogEÁryMsgs
(
msgQ
, 
¤cHashM­
.
	`keyS‘
(), 
wr™”RuÁime
);

728 
	`İ’SŒ—ms
(
d¡TabËs
, 
d¡D©aRuÁime
, 
NUM_STREAMS
, 
£rŸliz”
);

730 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
£rŸliz”
);

731 
	`v”ifyD©a
("aá”†og wr™šg‡ˆd¡", 
d¡TabËs
, 
¤cHashM­
);

732 
S”Ÿliz”s
.
	`»moveS”Ÿliz”
(
£rŸliz”
);

733 
	}
}

	@test/src/test/java/org/corfudb/integration/SealIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

10 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

15 
public
 cÏs 
	cS—lIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

17 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

18 
	mcÜfuSšgËNodePÜt
;

20 @
BefÜe


21 
public
 
	$lßdPrİ”t›s
() {

22 
cÜfuSšgËNodeHo¡
 = (
SŒšg
è
PROPERTIES
.
	`g‘
("corfuSingleNodeHost");

23 
cÜfuSšgËNodePÜt
 = 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
PROPERTIES
.
	`g‘
("corfuSingleNodePort"));

26 @
Te¡


27 
public
 
	$RuÁimeW™hWrÚgEpochG‘Upd©ed
(è
throws
 
Exû±iÚ
 {

28 
Proûss
 
cÜfuProûss
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

29 .
	`£tHo¡
(
cÜfuSšgËNodeHo¡
)

30 .
	`£tPÜt
(
cÜfuSšgËNodePÜt
)

31 .
	`runS”v”
();

32 
CÜfuRuÁime
 
ü1
 = 
	`ü—‹DeçuÉRuÁime
();

33 
CÜfuRuÁime
 
ü2
 = 
	`ü—‹DeçuÉRuÁime
();

35 
befÜeAdd»ss
 = 
ü2
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
().
	`g‘Tok’
().
	`g‘Sequ’û
();

43 
Layout
 
cu¼’tLayout
 = 
Ãw
 
	`Layout
(
ü1
.
	`g‘LayoutV›w
().
	`g‘Cu¼’tLayout
());

45 
cu¼’tLayout
.
	`£tEpoch
(cu¼’tLayout.
	`g‘Epoch
() + 1);

47 
ü1
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
cu¼’tLayout
).
	`£®MšS”v”S‘
();

49 
ü1
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
cu¼’tLayout
, 0);

51 
ü1
.
	`šv®id©eLayout
();

52 
ü1
.
	`g‘LayoutV›w
().
	`g‘Layout
();

54 
ü1
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

55 .
	`g‘Sequ’ûrCl›Á
(
cÜfuSšgËNodeHo¡
 + ":" + 
cÜfuSšgËNodePÜt
)

56 .
	`boÙ¡¿p
(1L, 
CŞËùiÚs
.
	`em±yM­
(), 
cu¼’tLayout
.
	`g‘Epoch
(), 
Œue
)

57 .
	`g‘
();

70 
LÚg
 
aá”Add»ss
 = 
ü2
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
().
	`g‘Tok’
().
	`g‘Sequ’û
();

71 
	`as£¹Th©
(
ü2
.
	`g‘LayoutV›w
().
	`g‘Cu¼’tLayout
().
	`g‘Epoch
()).

72 
	`isEqu®To
(
ü1
.
	`g‘LayoutV›w
().
	`g‘Cu¼’tLayout
().
	`g‘Epoch
());

73 
	`as£¹Th©
(
aá”Add»ss
).
	`isEqu®To
(
befÜeAdd»ss
+1);

75 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

77 
ü1
.
	`shutdown
();

78 
ü2
.
	`shutdown
();

79 
	}
}

	@test/src/test/java/org/corfudb/integration/SecurityIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

15 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

16 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

23 @
Slf4j


24 
public
 cÏs 
	cSecur™yIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

25 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

26 
´iv©e
 
	mcÜfuSŒšgNodePÜt
;

27 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

29 
´iv©e
 
boŞ—n
 
	msEÇbËd
 = 
Œue
;

30 
´iv©e
 
SŒšg
 
	m£rv”P©hToKeyStÜe
;

31 
´iv©e
 
SŒšg
 
	m£rv”P©hToKeyStÜePasswÜd
;

32 
´iv©e
 
SŒšg
 
	m£rv”P©hToTru¡StÜe
;

33 
´iv©e
 
SŒšg
 
	m£rv”P©hToTru¡StÜePasswÜd
;

34 
´iv©e
 
SŒšg
 
	mruÁimeP©hToKeyStÜe
;

35 
´iv©e
 
SŒšg
 
	mruÁimeP©hToKeyStÜePasswÜd
;

36 
´iv©e
 
SŒšg
 
	mruÁimeP©hToTru¡StÜe
;

37 
´iv©e
 
SŒšg
 
	mruÁimeP©hToTru¡StÜePasswÜd
;

40 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”Tls
(è
throws
 
IOExû±iÚ
 {

41  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

42 .
	`£tHo¡
(
cÜfuSšgËNodeHo¡
)

43 .
	`£tPÜt
(
cÜfuSŒšgNodePÜt
)

44 .
	`£tTlsEÇbËd
(
sEÇbËd
)

45 .
	`£tKeyStÜe
(
£rv”P©hToKeyStÜe
)

46 .
	`£tKeyStÜePasswÜd
(
£rv”P©hToKeyStÜePasswÜd
)

47 .
	`£tTru¡StÜe
(
£rv”P©hToTru¡StÜe
)

48 .
	`£tTru¡StÜePasswÜd
(
£rv”P©hToTru¡StÜePasswÜd
)

49 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
))

50 .
	`£tSšgË
(
Œue
)

51 .
	`runS”v”
();

61 @
BefÜe


62 
public
 
	$lßdPrİ”t›s
() {

64 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

65 
cÜfuSŒšgNodePÜt
 = 
IÁeg”
.
	`·r£IÁ
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodePort"));

67 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
("%s:%d",

68 
cÜfuSšgËNodeHo¡
,

69 
cÜfuSŒšgNodePÜt
);

72 
£rv”P©hToKeyStÜe
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToKeyStore");

73 
£rv”P©hToKeyStÜePasswÜd
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToKeyStorePassword");

74 
£rv”P©hToTru¡StÜe
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToTrustStore");

75 
£rv”P©hToTru¡StÜePasswÜd
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("serverPathToTrustStorePassword");

76 
ruÁimeP©hToKeyStÜe
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToKeyStore");

77 
ruÁimeP©hToKeyStÜePasswÜd
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToKeyStorePassword");

78 
ruÁimeP©hToTru¡StÜe
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToTrustStore");

79 
ruÁimeP©hToTru¡StÜePasswÜd
 = 
	`g‘Prİ”tyAbsŞu‹P©h
("runtimePathToTrustStorePassword");

80 
	}
}

90 
´iv©e
 
SŒšg
 
	$g‘Prİ”tyAbsŞu‹P©h
(
SŒšg
 
·thPrİ”ty
) {

91 ià((
PROPERTIES
.
	`g‘Prİ”ty
(
·thPrİ”ty
)è=ğ
nuÎ
 ||

92 
Fes
.
	`nÙExi¡s
(
P©hs
.
	`g‘
(
PROPERTIES
.
	`g‘Prİ”ty
(
·thPrİ”ty
)).
	`toAbsŞu‹P©h
())) {

93 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
(

94 
SŒšg
.
	`fÜm©
("CorfuDB.properties contains invalid or‚onƒxistent value for :%s",

95 
·thPrİ”ty
));

98  
P©hs
.
	`g‘
(
PROPERTIES
.
	`g‘Prİ”ty
(
·thPrİ”ty
)).
	`toAbsŞu‹P©h
().
	`toSŒšg
();

99 
	}
}

109 @
Te¡


110 
public
 
	$‹¡S”v”RuÁimeTlsEÇbËdM‘hod
(è
throws
 
Exû±iÚ
 {

112 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”Tls
();

115 
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
sšgËNodeEndpošt
)

116 .
	`’abËTls
(
ruÁimeP©hToKeyStÜe
,

117 
ruÁimeP©hToKeyStÜePasswÜd
,

118 
ruÁimeP©hToTru¡StÜe
,

119 
ruÁimeP©hToTru¡StÜePasswÜd
)

120 .
	`£tCacheDi§bËd
(
Œue
)

121 .
	`cÚÃù
();

124 
CÜfuTabË
 
‹¡TabË
 = 
ruÁime


125 .
	`g‘ObjeùsV›w
()

126 .
	`bud
()

127 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Objeù
>>() {})

128 .
	`£tSŒ—mName
("volbeat")

129 .
	`İ’
();

132 
fš®
 
š™ŸlSize
 = 
‹¡TabË
.
	`size
();

135 
fš®
 
couÁ
 = 100;

136 
fš®
 
’ŒySize
 = 1000;

137 
i
 = 0; i < 
couÁ
; i++) {

138 
‹¡TabË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), 
Ãw
 
by‹
[
’ŒySize
]);

142 
fš®
 
sizeAá”Puts
 = 
‹¡TabË
.
	`size
();

143 
	`as£¹Th©
(
sizeAá”Puts
).
	`isG»©”ThªOrEqu®To
(
š™ŸlSize
);

144 
log
.
	`šfo
("In™ŸÈTabË Size: {} - Fš®TabË Size:{}", 
š™ŸlSize
, 
sizeAá”Puts
);

147 
	`as£¹Th©
(
‹¡TabË
.
	`size
()).
	`isEqu®To
(
couÁ
);

148 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

149 
	}
}

159 @
Te¡


160 
public
 
	$‹¡S”v”RuÁimeTlsEÇbËdByP¬am‘”
(è
throws
 
Exû±iÚ
 {

162 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”Tls
();

165 
fš®
 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
ruÁimeP¬am‘”s
 = CorfuRuntime.CorfuRuntimeParameters

166 .
	`bud”
()

167 .
	`ÏyoutS”v”
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
sšgËNodeEndpošt
))

168 .
	`sEÇbËd
(
sEÇbËd
)

169 .
	`keyStÜe
(
ruÁimeP©hToKeyStÜe
)

170 .
	`ksPasswÜdFe
(
ruÁimeP©hToKeyStÜePasswÜd
)

171 .
	`Œu¡StÜe
(
ruÁimeP©hToTru¡StÜe
)

172 .
	`tsPasswÜdFe
(
ruÁimeP©hToTru¡StÜePasswÜd
)

173 .
	`bud
();

176 
ruÁime
 = 
CÜfuRuÁime


177 .
	`äomP¬am‘”s
(
ruÁimeP¬am‘”s
)

178 .
	`cÚÃù
();

181 
CÜfuTabË
 
‹¡TabË
 = 
ruÁime


182 .
	`g‘ObjeùsV›w
()

183 .
	`bud
()

184 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Objeù
>>() {})

185 .
	`£tSŒ—mName
("volbeat")

186 .
	`İ’
();

189 
fš®
 
š™ŸlSize
 = 
‹¡TabË
.
	`size
();

192 
fš®
 
couÁ
 = 100;

193 
fš®
 
’ŒySize
 = 1000;

194 
i
 = 0; i < 
couÁ
; i++) {

195 
‹¡TabË
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), 
Ãw
 
by‹
[
’ŒySize
]);

199 
fš®
 
sizeAá”Puts
 = 
‹¡TabË
.
	`size
();

200 
	`as£¹Th©
(
sizeAá”Puts
).
	`isG»©”ThªOrEqu®To
(
š™ŸlSize
);

201 
log
.
	`šfo
("In™ŸÈTabË Size: {} - Fš®TabË Size:{}", 
š™ŸlSize
, 
sizeAá”Puts
);

204 
	`as£¹Th©
(
‹¡TabË
.
	`size
()).
	`isEqu®To
(
couÁ
);

205 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

206 
	}
}

214 @
	$Te¡
(
ex³ùed
 = 
UÄecov”abËCÜfuE¼Ü
.
şass
)

215 
public
 
	$‹¡IncÜ»ùKeyStÜeExû±iÚ
(è
throws
 
Exû±iÚ
 {

217 
	`runSšgËP”si¡’tS”v”Tls
();

220 
fš®
 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
ruÁimeP¬am‘”s
 = CorfuRuntime.CorfuRuntimeParameters

221 .
	`bud”
()

222 .
	`ÏyoutS”v”
(
NodeLoÿtÜ
.
	`·r£SŒšg
(
sšgËNodeEndpošt
))

223 .
	`sEÇbËd
(
sEÇbËd
)

224 .
	`keyStÜe
(
ruÁimeP©hToKeyStÜe
)

225 .
	`ksPasswÜdFe
(
ruÁimeP©hToKeyStÜePasswÜd
)

226 .
	`Œu¡StÜe
(
ruÁimeP©hToKeyStÜe
)

227 .
	`tsPasswÜdFe
(
ruÁimeP©hToTru¡StÜePasswÜd
)

228 .
	`bud
();

231 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
ruÁimeP¬am‘”s
).
	`cÚÃù
();

232 
	}
}

	@test/src/test/java/org/corfudb/integration/ServerRestartIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gio
.
	gFe
;

7 
impÜt
 
	gjava
.
	gio
.
	gFeOuutSŒ—m
;

8 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

9 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

12 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

14 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

18 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdFutu»
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdTh»adPoŞExecutÜ
;

25 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTh»adLoÿlRªdom
;

26 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCheckpoštWr™”
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gIndex
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒšgIndex”
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒšgMuÉiIndex”
;

38 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

39 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

40 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gSËTok’Exû±iÚ
;

41 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

42 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

43 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

44 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

45 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

53 
public
 cÏs 
	cS”v”Re¡¬tIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

56 
´iv©e
 
	mITERATIONS
;

58 
´iv©e
 
	mCLIENT_RESTART_PERCENTAGE
;

60 
´iv©e
 
	mSERVER_RESTART_PERCENTAGE
;

62 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

63 
´iv©e
 
	mcÜfuSšgËNodePÜt
;

65 @
BefÜe


66 
public
 
	$lßdPrİ”t›s
() {

67 
ITERATIONS
 = 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
PROPERTIES
.
	`g‘
("RandomizedRecoveryIterations"));

68 
CLIENT_RESTART_PERCENTAGE
 = 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
PROPERTIES
.
	`g‘
("ClientRestartPercentage"));

69 
SERVER_RESTART_PERCENTAGE
 = 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
PROPERTIES
.
	`g‘
("ServerRestartPercentage"));

70 
cÜfuSšgËNodeHo¡
 = (
SŒšg
è
PROPERTIES
.
	`g‘
("corfuSingleNodeHost");

71 
cÜfuSšgËNodePÜt
 = 
IÁeg”
.
	`·r£IÁ
((
SŒšg
è
PROPERTIES
.
	`g‘
("corfuSingleNodePort"));

74 
´iv©e
 
Proûss
 
	$runCÜfuS”v”
(è
throws
 
IOExû±iÚ
 {

75  
Ãw
 
	`CÜfuS”v”RuÂ”
()

76 .
	`£tHo¡
(
cÜfuSšgËNodeHo¡
)

77 .
	`£tPÜt
(
cÜfuSšgËNodePÜt
)

78 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
cÜfuSšgËNodeHo¡
, 
cÜfuSšgËNodePÜt
))

79 .
	`runS”v”
();

80 
	}
}

82 
´iv©e
 
Rªdom
 
	$g‘RªdomNumb”G’”©Ü
() {

83 
fš®
 
Rªdom
 
¿ndomS“d
 = 
Ãw
 
	`Rªdom
();

84 
fš®
 
SEED
 = 
¿ndomS“d
.
	`ÃxtLÚg
();

86 
‹¡Stus
 +ğ"SEED=" + 
LÚg
.
	`toHexSŒšg
(
SEED
);

87  
Ãw
 
	`Rªdom
(
SEED
);

88 
	}
}

96 @
Te¡


97 
public
 
	$‹¡RªdomizedRecov”y
(è
throws
 
Exû±iÚ
 {

100 
fš®
 
TOTAL_PERCENTAGE
 = 100;

103 
fš®
 
MAPS
 = 3;

105 
fš®
 
INSERTIONS
 = 100;

107 
fš®
 
KEYS
 = 20;

111 
fš®
 
boŞ—n
 
TEST_SEQUENCE_LOGGING
 = 
çl£
;

112 
fš®
 
Fe
 
‹¡Sequ’ûLogFe
 = 
Ãw
 
	`Fe
(
TEST_SEQUENCE_LOG_PATH
);

113 ià(!
‹¡Sequ’ûLogFe
.
	`exi¡s
()) {

114 
‹¡Sequ’ûLogFe
.
	`ü—‹NewFe
();

117 
fš®
 
ExecutÜS”viû
 
executÜS”viû
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
();

119 
fš®
 
Rªdom
 
¿nd
 = 
	`g‘RªdomNumb”G’”©Ü
();

122 
Proûss
 
cÜfuS”v”Proûss
 = 
	`runCÜfuS”v”
();

125 
Li¡
<
CÜfuRuÁime
> 
ruÁimeLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

127 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
smrM­Li¡
 = 
Ãw
 
A¼ayLi¡
<>();

128 
i
 = 0; i < 
MAPS
; i++) {

129 
fš®
 
ii
 = 
i
;

130 
Futu»
<
BoŞ—n
> 
futu»
 = 
executÜS”viû
.
	`subm™
(() -> {

131 
CÜfuRuÁime
 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

132 
ruÁimeLi¡
.
	`add
(
ruÁime
);

133 
smrM­Li¡
.
	`add
(
	`ü—‹M­
(
ruÁime
, 
IÁeg”
.
	`toSŒšg
(
ii
)));

134  
Œue
;

136 
futu»
.
	`g‘
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

138 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
ex³ùedM­Li¡
 = 
Ãw
 
A¼ayLi¡
<>();

139 
i
 = 0; i < 
MAPS
; i++) {

140 
ex³ùedM­Li¡
.
	`add
(
Ãw
 
HashM­
<>());

143 
	`Œy
 (
fš®
 
FeOuutSŒ—m
 
fos
 = 
Ãw
 
	`FeOuutSŒ—m
(
‹¡Sequ’ûLogFe
)) {

145 
i
 = 0; i < 
ITERATIONS
; i++) {

147 
boŞ—n
 
£rv”Re¡¬t
 = 
¿nd
.
	`ÃxtIÁ
(
TOTAL_PERCENTAGE
è< 
SERVER_RESTART_PERCENTAGE
;

148 
boŞ—n
 
ş›ÁRe¡¬t
 = 
¿nd
.
	`ÃxtIÁ
(
TOTAL_PERCENTAGE
è< 
CLIENT_RESTART_PERCENTAGE
;

150 ià(
TEST_SEQUENCE_LOGGING
) {

151 
fos
.
	`wr™e
(
	`g‘Re¡¬tS‹RecÜd
(
i
, 
£rv”Re¡¬t
, 
ş›ÁRe¡¬t
).
	`g‘By‹s
());

154 ià(
ş›ÁRe¡¬t
) {

155 
smrM­Li¡
.
	`ş—r
();

156 
ruÁimeLi¡
.
	`·¿Î–SŒ—m
().
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

157 
j
 = 0; j < 
MAPS
; j++) {

158 
fš®
 
jj
 = 
j
;

159 
Futu»
<
BoŞ—n
> 
futu»
 = 
executÜS”viû
.
	`subm™
(() -> {

160 
CÜfuRuÁime
 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

161 
ruÁimeLi¡
.
	`add
(
ruÁime
);

162 
smrM­Li¡
.
	`add
(
	`ü—‹M­
(
ruÁime
, 
IÁeg”
.
	`toSŒšg
(
jj
)));

163  
Œue
;

165 
futu»
.
	`g‘
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

170 
Œue
) {

171 
Œy
 {

172 ià(
i
 != 0) {

173 
j
 = 0; j < 
MAPS
; j++) {

174 
	`as£¹Th©
(
ex³ùedM­Li¡
.
	`g‘
(
j
)).
	`isEqu®To
(
smrM­Li¡
.get(j));

178 } 
	`ÿtch
 (
N‘wÜkExû±iÚ
 
Ã
) {

179 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

184 
j
 = 0; j < 
INSERTIONS
; j++) {

185 
v®ue
 = 
¿nd
.
	`ÃxtIÁ
();

186 
m­
 = 
¿nd
.
	`ÃxtIÁ
(
MAPS
);

187 
SŒšg
 
key
 = 
IÁeg”
.
	`toSŒšg
(
¿nd
.
	`ÃxtIÁ
(
KEYS
));

189 
smrM­Li¡
.
	`g‘
(
m­
).
	`put
(
key
, 
v®ue
);

190 
ex³ùedM­Li¡
.
	`g‘
(
m­
).
	`put
(
key
, 
v®ue
);

192 ià(
TEST_SEQUENCE_LOGGING
) {

193 
fos
.
	`wr™e
(
	`g‘M­In£¹iÚ
(
i
, 
m­
, 
key
, 
v®ue
).
	`g‘By‹s
());

197 ià(
TEST_SEQUENCE_LOGGING
) {

198 
fos
.
	`wr™e
(
	`g‘M­S‹RecÜd
(
i
, 
ex³ùedM­Li¡
).
	`g‘By‹s
());

201 ià(
£rv”Re¡¬t
) {

202 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
)).
	`isTrue
();

203 
cÜfuS”v”Proûss
 = 
	`runCÜfuS”v”
();

207 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
)).
	`isTrue
();

209 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

210 
throw
 
e
;

213 
ruÁimeLi¡
.
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

214 
	}
}

222 @
Te¡


223 
public
 
	$‹¡SšgËNodeRecov”yT¿n§ùiÚ®Cl›ÁNe¡ed
(è
throws
 
Exû±iÚ
 {

224 
	`runSšgËNodeRecov”yT¿n§ùiÚ®Cl›Á
(
Œue
);

225 
	}
}

232 @
Te¡


233 
public
 
	$‹¡SšgËNodeRecov”yT¿n§ùiÚ®Cl›Á
(è
throws
 
Exû±iÚ
 {

234 
	`runSšgËNodeRecov”yT¿n§ùiÚ®Cl›Á
(
çl£
);

235 
	}
}

237 
´iv©e
 
	$runSšgËNodeRecov”yT¿n§ùiÚ®Cl›Á
(
boŞ—n
 
Ã¡ed
è
throws
 
Exû±iÚ
 {

240 
fš®
 
MAPS
 = 5;

241 
fš®
 
MAX_LIMIT_KEY_RANGE_PRE_SHUTDOWN
 = 20;

242 
fš®
 
MIN_LIMIT_KEY_RANGE_DURING_SHUTDOWN
 = 30;

243 
fš®
 
MAX_LIMIT_KEY_RANGE_DURING_SHUTDOWN
 = 60;

244 
fš®
 
MIN_LIMIT_KEY_RANGE_POST_SHUTDOWN
 = 100;

245 
fš®
 
MAX_LIMIT_KEY_RANGE_POST_SHUTDOWN
 = 200;

246 
fš®
 
CLIENT_DELAY_POST_SHUTDOWN
 = 50;

248 
fš®
 
CORFU_SERVER_DOWN_TIME
 = 4000;

250 
fš®
 
Rªdom
 
¿nd
 = 
	`g‘RªdomNumb”G’”©Ü
();

253 
fš®
 
Proûss
 
cÜfuS”v”Proûss
 = 
	`runCÜfuS”v”
();

254 
	`as£¹Th©
(
cÜfuS”v”Proûss
.
	`isAlive
()).
	`isTrue
();

257 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

260 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
smrM­Li¡
 = 
Ãw
 
A¼ayLi¡
<>();

261 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
ex³ùedM­Li¡
 = 
Ãw
 
A¼ayLi¡
<>();

262 
i
 = 0; i < 
MAPS
; i++) {

263 
smrM­Li¡
.
	`add
(
	`ü—‹M­
(
ruÁime
, 
IÁeg”
.
	`toSŒšg
(
i
)));

264 
ex³ùedM­Li¡
.
	`add
(
Ãw
 
HashM­
<>());

268 
i
 = 0; i < 
ITERATIONS
; i++) {

269 
	`as£¹Th©
(
	`execu‹T¿n§ùiÚ
(
ruÁime
, 
smrM­Li¡
, 
ex³ùedM­Li¡
, 0,

270 
MAX_LIMIT_KEY_RANGE_PRE_SHUTDOWN
, 
Ã¡ed
, 
¿nd
)).
	`isTrue
();

274 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
)).
	`isTrue
();

278 
ScheduËdTh»adPoŞExecutÜ
 
ofæše
 = 
Ãw
 
	`ScheduËdTh»adPoŞExecutÜ
(1);

279 
ScheduËdFutu»
<
BoŞ—n
> 
ofæšeT¿n§ùiÚsSucûeded
 = 
ofæše
.
	`scheduË
(() -> {

280 
i
 = 0; i < 
ITERATIONS
; i++) {

281 
boŞ—n
 
txS‹
 = 
	`execu‹T¿n§ùiÚ
(
ruÁime
, 
smrM­Li¡
, 
ex³ùedM­Li¡
,

282 
MIN_LIMIT_KEY_RANGE_DURING_SHUTDOWN
, 
MAX_LIMIT_KEY_RANGE_DURING_SHUTDOWN
,

283 
Ã¡ed
, 
¿nd
);

285 ià(!
txS‹
) {

286  
çl£
;

290  
Œue
;

291 }, 
CLIENT_DELAY_POST_SHUTDOWN
, 
TimeUn™
.
MILLISECONDS
);

292 
ofæše
.
	`shutdown
();

294 
Th»ad
.
	`¦“p
(
CORFU_SERVER_DOWN_TIME
);

297 
Proûss
 
cÜfuS”v”ProûssRe¡¬t
 = 
	`runCÜfuS”v”
();

298 
ofæše
.
	`awa™T”mš©iÚ
(
LÚg
.
MAX_VALUE
, 
TimeUn™
.
NANOSECONDS
);

301 
ruÁime
.
	`šv®id©eLayout
();

302 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

305 
i
 = 0; i < 
ITERATIONS
; i++) {

306 
	`as£¹Th©
(
	`execu‹T¿n§ùiÚ
(
ruÁime
, 
smrM­Li¡
, 
ex³ùedM­Li¡
,

307 
MIN_LIMIT_KEY_RANGE_POST_SHUTDOWN
, 
MAX_LIMIT_KEY_RANGE_POST_SHUTDOWN
,

308 
Ã¡ed
, 
¿nd
)).
	`isTrue
();

314 
ScheduËdTh»adPoŞExecutÜ
 
exec
 = 
Ãw
 
	`ScheduËdTh»adPoŞExecutÜ
(1);

315 
ScheduËdFutu»
<
BoŞ—n
> 
futu»
 = 
exec
.
	`scheduË
(() -> {

317 
i
 = 0; i < 
ex³ùedM­Li¡
.
	`size
(); i++) {

318 
M­
<
SŒšg
, 
IÁeg”
> 
ex³ùedM­
 = 
ex³ùedM­Li¡
.
	`g‘
(
i
);

319 
M­
<
SŒšg
, 
IÁeg”
> 
smrM­
 = 
smrM­Li¡
.
	`g‘
(
i
);

320 ià(!
ex³ùedM­
.
	`equ®s
(
smrM­
)) {

321  
çl£
;

324  
Œue
;

325 }, 
CLIENT_DELAY_POST_SHUTDOWN
, 
TimeUn™
.
MILLISECONDS
);

328 
exec
.
	`shutdown
();

329 
Œy
 {

330 
exec
.
	`awa™T”mš©iÚ
(
LÚg
.
MAX_VALUE
, 
TimeUn™
.
NANOSECONDS
);

331 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

332 
e
.
	`´štSckT¿û
();

336 
	`as£¹Th©
(
futu»
.
	`g‘
()).
	`isTrue
();

337 
	`as£¹Th©
(
ofæšeT¿n§ùiÚsSucûeded
.
	`g‘
()).
	`isTrue
();

340 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”ProûssRe¡¬t
)).
	`isTrue
();

341 
	}
}

343 
´iv©e
 
boŞ—n
 
execu‹T¿n§ùiÚ
(
CÜfuRuÁime
 
ruÁime
, 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
smrM­Li¡
,

344 
Li¡
<
M­
<
SŒšg
, 
IÁeg”
>> 
ex³ùedM­Li¡
, 
mšKeyRªge
,

345 
maxKeyRªge
, 
boŞ—n
 
Ã¡ed
, 
Rªdom
 
¿nd
) {

348 
fš®
 
	gINSERTIONS
 = 100;

349 
boŞ—n
 
	g»Œy
 = 
Œue
;

351 
boŞ—n
 
	gsucûss
 = 
çl£
;

353 
	g»Œy
) {

354 
	gŒy
 {

355 
	g»Œy
 = 
çl£
;

357 
	gruÁime
.
g‘ObjeùsV›w
().
TXBegš
();

360 
	gj
 = 0; j < 
	gINSERTIONS
; j++) {

361 
	gv®ue
 = 
¿nd
.
ÃxtIÁ
();

362 
SŒšg
 
	gkey
 = 
IÁeg”
.
toSŒšg
(
Th»adLoÿlRªdom
.
cu¼’t
().
ÃxtIÁ
(
mšKeyRªge
, 
maxKeyRªge
 + 1));

364 
	gi
 = 0; i < 
	gsmrM­Li¡
.
size
(); i++) {

365 ià(
	gÃ¡ed
) {

366 
	gsmrM­Li¡
.
g‘
(
i
).
compu‹
(
key
, (
k
, 
v
è-> (v =ğ
nuÎ
è? 
v®ue
 : v);

367 
	gex³ùedM­Li¡
.
g‘
(
i
).
compu‹
(
key
, (
k
, 
v
è-> (v =ğ
nuÎ
è? 
v®ue
 : v);

369 
	gsmrM­Li¡
.
g‘
(
i
).
put
(
key
, 
v®ue
);

370 
	gex³ùedM­Li¡
.
g‘
(
i
).
put
(
key
, 
v®ue
);

376 
	gruÁime
.
g‘ObjeùsV›w
().
TXEnd
();

378 
	gsucûss
 = 
Œue
;

380 
	gi
 = 0; i < 
	gsmrM­Li¡
.
size
(); i++) {

381 
as£¹Th©
(
ex³ùedM­Li¡
.
g‘
(
i
)).
isEqu®To
(
smrM­Li¡
.get(i));

383 } 
ÿtch
 (
Exû±iÚ
 
e
) {

384 
as£¹Th©
(
e
).
isExaùlyIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

387 ià(((
	gT¿n§ùiÚAbÜ‹dExû±iÚ
è
	ge
).
g‘AbÜtCau£
(è!ğ
AbÜtCau£
.
NETWORK
) {

388 
»Œy
 = 
Œue
;

393  
	gsucûss
;

396 
´iv©e
 
SŒšg
 
	$g‘Re¡¬tS‹RecÜd
(
™”©iÚ
, 
boŞ—n
 
£rv”Re¡¬t
, boŞ—À
ş›ÁRe¡¬t
) {

397  "[" + 
™”©iÚ
 + "]: S”v”Re¡¬t=" + 
£rv”Re¡¬t
 + ", Cl›ÁRe¡¬t=" + 
ş›ÁRe¡¬t
;

398 
	}
}

400 
´iv©e
 
SŒšg
 
g‘M­S‹RecÜd
(
™”©iÚ
, 
Li¡
<
M­
<SŒšg, 
IÁeg”
>> 
m­S‹Li¡
) {

401 
SŒšgBud”
 
	gsb
 = 
Ãw
 StringBuilder();

402 
	gsb
.
­³nd
("[" + 
™”©iÚ
 + "]: Map State :\n");

403 
	gi
 = 0; i < 
	gm­S‹Li¡
.
size
(); i++) {

404 
	gsb
.
­³nd
("m­#" + 
i
 + " m­ = " + 
m­S‹Li¡
.
g‘
(i).
toSŒšg
() + "\n");

406  
	gsb
.
toSŒšg
();

409 
´iv©e
 
SŒšg
 
	$g‘M­In£¹iÚ
(
™”©iÚ
, 
¡»amId
, 
SŒšg
 
key
, 
v®ue
) {

410  "[" + 
™”©iÚ
 + "]: M­…uˆ=> sŒ—mId=" + 
¡»amId
 + " key=" + 
key
 + " v®ue=" + 
v®ue
;

411 
	}
}

423 @
Te¡


424 
public
 
	$£qu’ûrTasRecov”yTe¡
(è
throws
 
Exû±iÚ
 {

426 
Proûss
 
cÜfuS”v”Proûss
 = 
	`runCÜfuS”v”
();

427 
fš®
 
š£¹iÚs
 = 10;

428 
UUID
 
¡»amNameA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("mapA");

429 
UUID
 
¡»amNameB
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("mapB");

431 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

432 
M­
<
SŒšg
, 
IÁeg”
> 
m­A
 = 
	`ü—‹M­
(
ruÁime
, "mapA");

433 
M­
<
SŒšg
, 
IÁeg”
> 
m­B
 = 
	`ü—‹M­
(
ruÁime
, "mapB");

435 
i
 = 0; i < 
š£¹iÚs
; i++) {

436 
m­A
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), i);

438 
i
 = 0; i < 
š£¹iÚs
; i++) {

439 
m­B
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), i);

443 
fš®
 
ÃwM­ASŒ—mTa
 = 9;

444 
fš®
 
ÃwM­BSŒ—mTa
 = 19;

445 
fš®
 
ÃwGlob®Ta
 = 19;

447 
	`»¡¬tS”v”
(
ruÁime
, 
DEFAULT_ENDPOINT
);

449 
Tok’Re¥Ú£
 
tok’Re¥Ú£A
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amNameA
);

450 
Tok’Re¥Ú£
 
tok’Re¥Ú£B
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amNameB
);

452 
	`as£¹Th©
(
tok’Re¥Ú£A
.
	`g‘Tok’
().
	`g‘Sequ’û
()).
	`isEqu®To
(
ÃwGlob®Ta
 + 1);

453 
	`as£¹Th©
(
tok’Re¥Ú£A
.
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amNameA
))

454 .
	`isEqu®To
(
ÃwM­ASŒ—mTa
);

456 
	`as£¹Th©
(
tok’Re¥Ú£B
.
	`g‘Tok’
().
	`g‘Sequ’û
()).
	`isEqu®To
(
ÃwGlob®Ta
 + 2);

457 
	`as£¹Th©
(
tok’Re¥Ú£B
.
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amNameB
))

458 .
	`isEqu®To
(
ÃwM­BSŒ—mTa
);

460 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
)).
	`isTrue
();

462 
	}
}

470 @
Te¡


471 
public
 
	$disÿrdTok’ReûivedInP»viousEpoch
(è
throws
 
Exû±iÚ
 {

472 
fš®
 
timeToWa™InSecÚds
 = 3;

474 
Proûss
 
cÜfuS”v”Proûss
 = 
	`runCÜfuS”v”
();

475 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

478 
Tok’Re¥Ú£
 
fœ¡Œ
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

480 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
)).
	`isTrue
();

482 
cÜfuS”v”Proûss
 = 
	`runCÜfuS”v”
();

484 
ruÁime
.
	`šv®id©eLayout
();

485 
Tok’Re¥Ú£
 
Œ
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

487 
	`as£¹Th©
(
Œ
.
	`g‘Epoch
())

488 .
	`isEqu®To
(1);

491 
Tok’
 
¡®eTok’
 = 
Ãw
 
	`Tok’
(
Œ
.
	`g‘Epoch
(è- 1,r.
	`g‘Sequ’û
());

492 
Tok’Re¥Ú£
 
mockTr
 = 
Ãw
 
	`Tok’Re¥Ú£
(
¡®eTok’
, 
CŞËùiÚs
.
	`em±yM­
());

494 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

497 
Com¶‘abËFutu»
 
cf
 = 
CFUts
.
	`w™hš
(Com¶‘abËFutu».
	`suµlyAsync
(() -> {

498 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
mockTr
, 
‹¡Paylßd
);

499  
Œue
;

500 }), 
Du¿tiÚ
.
	`ofSecÚds
(
timeToWa™InSecÚds
));

502 
Œy
 {

503 
cf
.
	`g‘
();

504 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

505 
	`as£¹Th©
(
e
.
	`g‘Cau£
()).
	`isNÙIn¡ªûOf
(
TimeoutExû±iÚ
.
şass
);

506 
	`as£¹Th©
(
e
.
	`g‘Cau£
()).
	`isIn¡ªûOf
(
SËTok’Exû±iÚ
.
şass
);

509 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”Proûss
)).
	`isTrue
();

510 
	}
}

512 
´iv©e
 
CÜfuTabË
 
	$ü—‹TabË
(
CÜfuRuÁime
 
cÜfuRuÁime
, 
Index
.
Regi¡ry
 
šdex”
) {

513  
cÜfuRuÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

514 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

515 .
	`£tArgum’ts
(
šdex”
)

516 .
	`£tSŒ—mName
("test")

517 .
	`İ’
();

518 
	}
}

529 @
Te¡


530 
public
 
	$‹¡CÜfuTabËIndexRecÚ¡ruùiÚ
(è
throws
 
Exû±iÚ
 {

533 
Proûss
 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

536 
CÜfuRuÁime
 
ruÁime1
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

537 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË1
 = 
	`ü—‹TabË
(
ruÁime1
, 
Ãw
 
	`SŒšgIndex”
());

538 
fš®
 
num
 = 1000;

539 
i
 = 0; i < 
num
; i++) {

540 
cÜfuTabË1
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i));

544 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

545 
mcw
.
	`addM­
(
cÜfuTabË1
);

546 
Tok’
 
ŒimM¬k
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime1
, "author");

547 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
c1a
 =

548 
cÜfuTabË1
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "9");

549 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
c1b
 =

550 
cÜfuTabË1
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_VALUE
, "9");

551 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimM¬k
);

552 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

553 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

554 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

557 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

558 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

561 
CÜfuRuÁime
 
ruÁime2
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

562 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË2
 = 
	`ü—‹TabË
(
ruÁime2
, 
Ãw
 
	`SŒšgIndex”
());

563 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
c2
 =

564 
cÜfuTabË2
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "9");

565 
	`as£¹Th©
(
c1a
.
	`size
()).
	`isEqu®To
(
c2
.size());

566 
	`as£¹Th©
(
c1a
.
	`cÚšsAÎ
(
c2
)).
	`isTrue
();

569 
CÜfuRuÁime
 
ruÁime3
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
)

570 .
	`£tCacheDi§bËd
(
Œue
)

571 .
	`cÚÃù
();

572 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË3
 = 
	`ü—‹TabË
(
ruÁime3
, 
Ãw
 
	`SŒšgIndex”
());

573 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
c3
 =

574 
cÜfuTabË3
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_VALUE
, "9");

575 
	`as£¹Th©
(
c1b
.
	`size
()).
	`isEqu®To
(
c3
.size());

576 
	`as£¹Th©
(
c1b
.
	`cÚšsAÎ
(
c3
)).
	`isTrue
();

579 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

581 
ruÁime1
.
	`shutdown
();

582 
ruÁime2
.
	`shutdown
();

583 
ruÁime3
.
	`shutdown
();

584 
	}
}

596 @
Te¡


597 
public
 
	$‹¡CÜfuTabËMuÉiIndexRecÚ¡ruùiÚ
(è
throws
 
Exû±iÚ
 {

599 
Proûss
 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

602 
CÜfuRuÁime
 
ruÁime1
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

603 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË1
 = 
	`ü—‹TabË
(
ruÁime1
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

605 
fš®
 
numEÁr›s
 = 1000;

606 
i
 = 0; i < 
numEÁr›s
; i++) {

607 
SŒšgBud”
 
v®ue
 = 
Ãw
 
	`SŒšgBud”
();

608 
v®ue
.
	`­³nd
("tag")

609 .
	`­³nd
(
i
)

610 .
	`­³nd
("ag")

611 .
	`­³nd
(
i
 + 1)

612 .
	`­³nd
("ag")

613 .
	`­³nd
(
i
 + 2);

614 
SŒšg
 
key
 = "key" + 
i
;

615 
cÜfuTabË1
.
	`put
(
key
, 
v®ue
.
	`toSŒšg
());

619 
MuÉiCheckpoštWr™”
 
muÉiCheckpoštWr™”
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

620 
muÉiCheckpoštWr™”
.
	`addM­
(
cÜfuTabË1
);

621 
Tok’
 
ŒimM¬k
 = 
muÉiCheckpoštWr™”
.
	`­³ndCheckpošts
(
ruÁime1
, "Sam.Behnam");

622 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
»suÉIn™Ÿl
 =

623 
cÜfuTabË1
.
	`g‘ByIndex
(
SŒšgMuÉiIndex”
.
BY_EACH_WORD
, "tag666");

624 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimM¬k
);

625 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

626 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

627 
ruÁime1
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

630 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

631 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

634 
CÜfuRuÁime
 
ruÁime2
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

635 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË2
 = 
	`ü—‹TabË
(
ruÁime2
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

636 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
»suÉAá”Re¡¬t
 =

637 
cÜfuTabË2
.
	`g‘ByIndex
(
SŒšgMuÉiIndex”
.
BY_EACH_WORD
, "tag666");

638 
	`as£¹Th©
(
»suÉAá”Re¡¬t
.
	`size
()).
	`isEqu®To
(
»suÉIn™Ÿl
.size());

639 
	`as£¹Th©
(
»suÉAá”Re¡¬t
.
	`cÚšsAÎ
(
»suÉIn™Ÿl
)).
	`isTrue
();

642 
CÜfuRuÁime
 
ruÁime3
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
)

643 .
	`£tCacheDi§bËd
(
Œue
)

644 .
	`cÚÃù
();

645 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË3
 = 
	`ü—‹TabË
(
ruÁime3
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

646 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
»suÉDi§bËdCacheAndFasLßd”
 =

647 
cÜfuTabË3
.
	`g‘ByIndex
(
SŒšgMuÉiIndex”
.
BY_EACH_WORD
, "tag666");

648 
	`as£¹Th©
(
»suÉDi§bËdCacheAndFasLßd”
.
	`size
()).
	`isEqu®To
(
»suÉIn™Ÿl
.size());

649 
	`as£¹Th©
(
»suÉDi§bËdCacheAndFasLßd”
.
	`cÚšsAÎ
(
»suÉIn™Ÿl
)).
	`isTrue
();

652 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

654 
ruÁime1
.
	`shutdown
();

655 
ruÁime2
.
	`shutdown
();

656 
ruÁime3
.
	`shutdown
();

657 
	}
}

677 @
Te¡


678 
public
 
	$‹¡UnÜd”edCheckpoštsAndRe¡¬tS”v”
(è
throws
 
Exû±iÚ
 {

679 
fš®
 
numEÁr›s
 = 25;

680 
fš®
 
¢­shÙAdd»ss1
 = 10;

681 
fš®
 
¢­shÙAdd»ss2
 = 15;

683 
CÜfuRuÁime
 
r
 = 
nuÎ
;

684 
CÜfuRuÁime
 
¹2
 = 
nuÎ
;

685 
CÜfuRuÁime
 
¹3
 = 
nuÎ
;

688 
Proûss
 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

690 
Œy
 {

691 
r
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

694 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË1
 = 
	`ü—‹TabË
(
r
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

697 
i
 = 0; i < 
numEÁr›s
; i++) {

698 
cÜfuTabË1
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

702 
CheckpoštWr™”
 
ıw2
 = 
Ãw
 
	`CheckpoštWr™”
(
r
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"),

703 "checkpoš‹r-2", 
cÜfuTabË1
);

704 
Tok’
 
ı2Tok’
 = 
ıw2
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss2
 - 1));

707 
CheckpoštWr™”
 
ıw1
 = 
Ãw
 
	`CheckpoštWr™”
(
r
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"),

708 "checkpoš‹r-1", 
cÜfuTabË1
);

709 
ıw1
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss1
 - 1));

712 
r
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ı2Tok’
);

715 
¹2
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

716 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË2
 = 
	`ü—‹TabË
(
¹2
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

718 
¹2
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

719 
cÜfuTabË2
.
	`put
("a", "a");

720 
¹2
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

722 
	`as£¹Th©
(
cÜfuTabË2
.
	`size
()).
	`isEqu®To
(
numEÁr›s
 + 1);

725 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

726 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

729 
¹3
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

730 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË3
 = 
	`ü—‹TabË
(
¹3
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

732 
¹3
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

733 
cÜfuTabË3
.
	`put
("b", "b");

734 
¹3
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

736 
	`as£¹Th©
(
cÜfuTabË3
.
	`size
()).
	`isEqu®To
(
numEÁr›s
 + 2);

737 } 
fš®ly
 {

738 ià(
r
 !ğ
nuÎ
èr.
	`shutdown
();

739 ià(
¹2
 !ğ
nuÎ
è¹2.
	`shutdown
();

740 ià(
¹3
 !ğ
nuÎ
è¹3.
	`shutdown
();

742 
	`shutdownCÜfuS”v”
(
cÜfuProûss
);

744 
	}
}

750 @
Te¡


751 
public
 
	$checkSŒ—mAdd»ssS·ûRebutW™hTrim
(è
throws
 
Exû±iÚ
 {

752 
fš®
 
numEÁr›s
 = 10;

754 
fš®
 
Li¡
<
LÚg
> 
ex³ùedAdd»s£s
 = 
Ãw
 
A¼ayLi¡
<>(

755 
A¼ays
.
	`asLi¡
(14L, 15L, 16L, 17L, 18L, 19L, 20L, 21L, 22L, 23L));

757 
CÜfuRuÁime
 
r
 = 
nuÎ
;

758 
CÜfuRuÁime
 
ruÁimeRe¡¬t
 = 
nuÎ
;

761 
Proûss
 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

763 
Œy
 {

765 
r
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

768 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­Te¡
 = 
	`ü—‹TabË
(
r
, 
Ãw
 
	`SŒšgMuÉiIndex”
());

771 
i
 = 0; i < 
numEÁr›s
; i++) {

772 
m­Te¡
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

776 
MuÉiCheckpoštWr™”
 
ıw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

777 
ıw
.
	`addM­
(
m­Te¡
);

778 
Tok’
 
ıAdd»ss
 = 
ıw
.
	`­³ndCheckpošts
(
r
, "cp-test");

781 
r
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıAdd»ss
);

782 
r
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

783 
r
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

784 
r
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

787 
i
 = 
numEÁr›s
; i <‚umEntries * 2; i++) {

788 
m­Te¡
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

792 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuProûss
)).
	`isTrue
();

793 
cÜfuProûss
 = 
	`runCÜfuS”v”
();

796 
ruÁimeRe¡¬t
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

799 
SŒ—mAdd»ssS·û
 
add»ssS·û
 = 
ruÁimeRe¡¬t
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
()

800 .
	`g‘Add»ssM­
()

801 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

804 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
ıAdd»ss
.
	`g‘Sequ’û
());

806 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
ex³ùedAdd»s£s
.
	`size
());

807 
ex³ùedAdd»s£s
.
	`fÜEach
(
add»ss
 -> 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`cÚšs
×dd»ss)).
	`isTrue
());

808 } 
fš®ly
 {

809 ià(
r
 !ğ
nuÎ
èr.
	`shutdown
();

810 ià(
ruÁimeRe¡¬t
 !ğ
nuÎ
èruÁimeRe¡¬t.
	`shutdown
();

811 
	`shutdownCÜfuS”v”
(
cÜfuProûss
);

813 
	}
}

	@test/src/test/java/org/corfudb/integration/SourceForwardingDataSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gSškMªag”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gSourûMªag”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gOb£rvabËAckMsg
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gDeçuÉD©aCÚŒŞ
.
	gDeçuÉD©aCÚŒŞCÚfig
;

17 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

22 
public
 cÏs 
	cSourûFÜw¬dšgD©aS’d”
 
im¶em’ts
 
	mD©aS’d”
 {

24 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

27 
´iv©e
 
SškMªag”
 
	mde¡š©iÚLogR•liÿtiÚMªag”
;

30 
´iv©e
 
AckD©aS’d”
 
	mde¡š©iÚD©aS’d”
;

33 
´iv©e
 
DeçuÉD©aCÚŒŞ
 
	mde¡š©iÚD©aCÚŒŞ
;

35 
´iv©e
 
ExecutÜS”viû
 
	mchªÃlExecutÜWÜk”s
;

37 
´iv©e
 
	m»ûivedMes§ges
 = 0;

39 
´iv©e
 
	m”rÜCouÁ
 = 0;

41 @
	mVisibËFÜTe¡šg


42 @
G‘‹r


43 
´iv©e
 
Ob£rvabËAckMsg
 
	mackMes§ges
 = 
Ãw
 ObservableAckMsg();

50 
fš®
 
public
 
	mDROP_MSG_ONCE
 = 1;

52 
´iv©e
 
	mifDrİMsg
 = 0;

54 
fš®
 
	mDROP_INCREMENT
 = 4;

56 
´iv©e
 
	mfœ¡Drİ
 = 
DROP_INCREMENT
;

58 @
G‘‹r


59 
´iv©e
 
Ob£rvabËV®ue
 
	m”rÜs
 = 
Ãw
 Ob£rvabËV®ue(
”rÜCouÁ
);

61 
public
 
	$SourûFÜw¬dšgD©aS’d”
(
SŒšg
 
de¡š©iÚEndpošt
, 
LogR•liÿtiÚCÚfig
 
cÚfig
, 
ifDrİMsg
) {

62 
this
.
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(CÜfuRuÁime.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
())

63 .
	`·r£CÚfigu¿tiÚSŒšg
(
de¡š©iÚEndpošt
)

64 .
	`cÚÃù
();

65 
this
.
de¡š©iÚD©aS’d”
 = 
Ãw
 
	`AckD©aS’d”
();

66 
this
.
de¡š©iÚD©aCÚŒŞ
 = 
Ãw
 
	`DeçuÉD©aCÚŒŞ
Òew 
	`DeçuÉD©aCÚŒŞCÚfig
(
çl£
, 0));

67 
this
.
de¡š©iÚLogR•liÿtiÚMªag”
 = 
Ãw
 
	`SškMªag”
(
ruÁime
.
	`g‘LayoutS”v”s
().
	`g‘
(0), 
cÚfig
);

68 
this
.
chªÃlExecutÜWÜk”s
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
();

69 
this
.
ifDrİMsg
 = ifDropMsg;

72 @
Ov”ride


73 
public
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
	$£nd
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

75 ià(
ifDrİMsg
 > 0 && 
mes§ge
.
	`g‘M‘ad©a
().
time¡amp
 =ğ
fœ¡Drİ
) {

76 
Sy¡em
.
out
.
	`´šn
("****** Drİ†ogƒÁry " + 
mes§ge
.
	`g‘M‘ad©a
().
time¡amp
);

77 ià(
ifDrİMsg
 =ğ
DROP_MSG_ONCE
) {

78 
fœ¡Drİ
 +ğ
DROP_INCREMENT
;

81  
Ãw
 
Com¶‘abËFutu»
<>();

84 
fš®
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
cf
 = 
Ãw
 CompletableFuture<>();

88 
LogR•liÿtiÚEÁry
 
ack
 = 
de¡š©iÚLogR•liÿtiÚMªag”
.
	`»ûive
(
mes§ge
);

89 
cf
.
	`com¶‘e
(
ack
);

90 
ackMes§ges
.
	`£tV®ue
(
ack
);

91  
cf
;

92 
	}
}

94 @
Ov”ride


95 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
£nd
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
) {

96 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	gÏ¡S’tMes§ge
 = 
nuÎ
;

97 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	gtmp
;

99 
LogR•liÿtiÚEÁry
 
	gmes§ge
 : 
mes§ges
) {

100 
tmp
 = 
£nd
(
mes§ge
);

101 ià(
	gmes§ge
.
g‘M‘ad©a
().
g‘Mes§geM‘ad©aTy³
().
equ®s
(
Mes§geTy³
.
SNAPSHOT_END
) ||

102 
	gmes§ge
.
g‘M‘ad©a
().
g‘Mes§geM‘ad©aTy³
().
equ®s
(
Mes§geTy³
.
LOG_ENTRY_MESSAGE
)) {

103 
	gÏ¡S’tMes§ge
 = 
tmp
;

107 
	gŒy
 {

108 ià(
	gÏ¡S’tMes§ge
 !ğ
nuÎ
) {

109 
LogR•liÿtiÚEÁry
 
’Œy
 = 
Ï¡S’tMes§ge
.
g‘
();

110 
	gackMes§ges
.
£tV®ue
(
’Œy
);

112 } 
ÿtch
 (
Exû±iÚ
 
e
) {

113 
	gSy¡em
.
	gout
.
´št
("Caughˆªƒxû±iÚ " + 
e
);

116  
	gÏ¡S’tMes§ge
;

119 @
Ov”ride


120 
public
 
	$ÚE¼Ü
(
LogR•liÿtiÚE¼Ü
 
”rÜ
) {

121 
”rÜCouÁ
++;

122 
”rÜs
.
	`£tV®ue
(
”rÜCouÁ
);

123 
	}
}

128 
public
 
	$£tSourûMªag”
(
SourûMªag”
 
sourûMªag”
) {

129 
de¡š©iÚD©aS’d”
.
	`£tSourûMªag”
(
sourûMªag”
);

130 
de¡š©iÚD©aCÚŒŞ
.
	`£tSourûMªag”
(
sourûMªag”
);

131 
	}
}

134 
public
 
SškMªag”
 
	$g‘SškMªag”
() {

135  
de¡š©iÚLogR•liÿtiÚMªag”
;

136 
	}
}

138 
public
 
CÜfuRuÁime
 
	$g‘Wr™”RuÁime
() {

139  
this
.
ruÁime
;

140 
	}
}

142 
public
 
	$shutdown
() {

143 ià(
de¡š©iÚD©aS’d”
 !ğ
nuÎ
 && de¡š©iÚD©aS’d”.
	`g‘SourûMªag”
() !=‚ull) {

144 
de¡š©iÚD©aS’d”
.
	`g‘SourûMªag”
().
	`shutdown
();

147 ià(
de¡š©iÚLogR•liÿtiÚMªag”
 !ğ
nuÎ
) {

148 
de¡š©iÚLogR•liÿtiÚMªag”
.
	`shutdown
();

150 
	}
}

	@test/src/test/java/org/corfudb/integration/StreamAddressDiscoveryIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCheckpoštWr™”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

20 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

22 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

23 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

30 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

32 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

33 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gç
;

46 
public
 cÏs 
	cSŒ—mAdd»ssDiscov”yIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

48 
´iv©e
 
CÜfuRuÁime
 
	$ü—‹DeçuÉRuÁimeUsšgFŞlowBackpoš‹rs
() {

49 
CÜfuRuÁime
 
ruÁime
 = 
	`ü—‹RuÁime
(
DEFAULT_ENDPOINT
);

50 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tFŞlowBackpoš‹rsEÇbËd
(
Œue
)

51 .
	`£tCacheDi§bËd
(
çl£
);

52  
ruÁime
;

55 
´iv©e
 
CÜfuRuÁime
 
	$ü—‹DeçuÉRuÁimeUsšgAdd»ssM­s
() {

56 
CÜfuRuÁime
 
ruÁime
 = 
	`ü—‹RuÁime
(
DEFAULT_ENDPOINT
);

57 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tFŞlowBackpoš‹rsEÇbËd
(
çl£
)

58 .
	`£tCacheDi§bËd
(
çl£
);

59 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tSŒ—mB©chSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

60  
ruÁime
;

61 
	}
}

63 
´iv©e
 
	$»adFromNewRuÁimeFŞlowšgBackpoš‹rs
(
SŒšg
 
¡»amName
, 
ex³ùedSize
) {

64  
	`»adFromNewRuÁime
(
	`ü—‹DeçuÉRuÁimeUsšgFŞlowBackpoš‹rs
(), 
¡»amName
, 
ex³ùedSize
);

65 
	}
}

67 
´iv©e
 
	$»adFromNewRuÁimeUsšgAdd»ssM­s
(
SŒšg
 
¡»amName
, 
ex³ùedSize
) {

68  
	`»adFromNewRuÁime
(
	`ü—‹DeçuÉRuÁimeUsšgAdd»ssM­s
(), 
¡»amName
, 
ex³ùedSize
);

69 
	}
}

71 
´iv©e
 
	$»adFromNewRuÁime
(
CÜfuRuÁime
 
¹
, 
SŒšg
 
¡»amName
, 
ex³ùedSize
) {

72 
Œy
 {

73 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

74 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

76 .
	`£tSŒ—mName
(
¡»amName
)

77 .
	`İ’
();

79 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

80 
	`as£¹Th©
(
bË
.
	`size
()).
	`isEqu®To
(
ex³ùedSize
);

81  
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
;

82 } 
fš®ly
 {

83 
¹
.
	`shutdown
();

85 
	}
}

107 @
Te¡


108 
public
 
	$b’chM¬kSŒ—mRebutInP»£nûOfHŞes
(è
throws
 
Exû±iÚ
 {

109 
fš®
 
SŒšg
 
¡»am1Name
 = "stream1";

110 
fš®
 
SŒšg
 
¡»am2Name
 = "stream2";

113 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

115 
ruÁime
 = 
	`ü—‹RuÁimeW™hCache
();

117 
Œy
 {

119 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË1
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

120 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

122 .
	`£tSŒ—mName
(
¡»am1Name
)

123 .
	`İ’
();

125 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LARGE
; i++) {

126 
bË1
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

130 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË2
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

131 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

133 .
	`£tSŒ—mName
(
¡»am2Name
)

134 .
	`İ’
();

136 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LARGE
; i++) {

137 
bË2
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

141 
Tok’
 
tok’
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am1Name
)).
	`g‘Tok’
();

142 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

143 .
	`g‘LogUn™Cl›Á
("tcp://localhost:9000")

144 .
	`wr™e
(
LogD©a
.
	`g‘HŞe
(
tok’
));

148 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

149 
bË1
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

153 
tÙ®TimeFŞlowBackpoš‹rs
 = 
	`»adFromNewRuÁimeFŞlowšgBackpoš‹rs
(
¡»am1Name
,

154 
PARAMETERS
.
NUM_ITERATIONS_LARGE
);

155 
Sy¡em
.
out
.
	`´šn
("**** Totalime‚ew„untimeo send 'Stream 1' (following backpointers): "

156 + 
tÙ®TimeFŞlowBackpoš‹rs
);

159 
tÙ®TimeAdd»ssM­s
 = 
	`»adFromNewRuÁimeUsšgAdd»ssM­s
(
¡»am1Name
,

160 
PARAMETERS
.
NUM_ITERATIONS_LARGE
);

161 
Sy¡em
.
out
.
	`´šn
("**** Totalime‚ew„untimeo send 'Stream 1' (address maps): "

162 + 
tÙ®TimeAdd»ssM­s
);

164 
	`as£¹Th©
(
tÙ®TimeAdd»ssM­s
).
	`isLessThªOrEqu®To
(
tÙ®TimeFŞlowBackpoš‹rs
);

165 } 
fš®ly
 {

166 
	`shutdownCÜfuS”v”
(
£rv”
);

168 
	}
}

183 @
Te¡


184 
public
 
	$b’chm¬kMuÉiTh»adedPutsSh¬edRuÁime
(è
throws
 
Exû±iÚ
 {

186 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

189 
CÜfuRuÁime
 
¹1w
 = 
	`ü—‹DeçuÉRuÁimeUsšgFŞlowBackpoš‹rs
();

192 
CÜfuRuÁime
 
¹2w
 = 
	`ü—‹DeçuÉRuÁimeUsšgAdd»ssM­s
();

195 
fš®
 
numTh»ads
 = 10;

196 
fš®
 
numKeys
 = 
PARAMETERS
.
NUM_ITERATIONS_LARGE
;

198 
Œy
 {

199 
Sy¡em
.
out
.
	`´šn
("**** Start multi-threaded benchmark");

201 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
¹1w
.
	`g‘ObjeùsV›w
().
	`bud
()

202 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

204 .
	`£tSŒ—mName
("streamTable")

205 .
	`İ’
();

207 
ExecutÜS”viû
 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

208 
LÚg
 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

210 
i
 = 0; i < 
numKeys
; i++) {

211 
fš®
 
v®ue
 = 
i
;

212 
executÜ
.
	`subm™
(() -> {

213 
¹1w
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

214 
bË
.
	`put
(
v®ue
, 
SŒšg
.
	`v®ueOf
(value));

215 
¹1w
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

219 
executÜ
.
	`shutdown
();

220 
executÜ
.
	`awa™T”mš©iÚ
(2, 
TimeUn™
.
MINUTES
);

221 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** Multi-threaded…uts (%shreads, %s keys) completed in:" +

223 
numTh»ads
, 
numKeys
, (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
)));

225 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË2
 = 
¹2w
.
	`g‘ObjeùsV›w
().
	`bud
()

226 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

228 .
	`£tSŒ—mName
("streamTable")

229 .
	`İ’
();

231 
ExecutÜS”viû
 
executÜ2
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

232 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

234 
i
 = 0; i < 
numKeys
; i++) {

235 
fš®
 
v®ue
 = 
i
;

236 
executÜ2
.
	`subm™
(() -> {

237 
¹2w
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

238 
bË2
.
	`put
(
v®ue
, 
SŒšg
.
	`v®ueOf
(value));

239 
¹2w
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

243 
executÜ2
.
	`shutdown
();

244 
executÜ2
.
	`awa™T”mš©iÚ
(2, 
TimeUn™
.
MINUTES
);

245 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** Multi-threaded…uts (%shreads, %s keys) completed in:" +

247 
numTh»ads
, 
numKeys
, (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
)));

250 
tÙ®TimeFŞlowBackpoš‹rs
 = 
	`»adFromNewRuÁimeFŞlowšgBackpoš‹rs
("streamTable",

251 
numKeys
);

252 
Sy¡em
.
out
.
	`´šn
("**** Totalime‚ew„untimeo send 'Stream 1' (following backpointers): "

253 + 
tÙ®TimeFŞlowBackpoš‹rs
);

256 
tÙ®TimeAdd»ssM­s
 = 
	`»adFromNewRuÁimeUsšgAdd»ssM­s
("streamTable",

257 
numKeys
);

258 
Sy¡em
.
out
.
	`´šn
("**** Totalime‚ew„untimeo send 'Stream 1' (address maps): "

259 + 
tÙ®TimeAdd»ssM­s
);

261 
	`as£¹Th©
(
tÙ®TimeAdd»ssM­s
).
	`isLessThªOrEqu®To
(
tÙ®TimeFŞlowBackpoš‹rs
);

262 } 
fš®ly
 {

263 
¹1w
.
	`shutdown
();

264 
¹2w
.
	`shutdown
();

265 
	`shutdownCÜfuS”v”
(
£rv”
);

267 
	}
}

275 @
Te¡


276 
public
 
	$b’chm¬kMuÉiTh»adedPutsMuÉiCl›Ás
(è
throws
 
Exû±iÚ
 {

278 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

280 
M­
<
CÜfuRuÁime
, 
CÜfuTabË
<
IÁeg”
, 
SŒšg
>> 
ruÁimeToTabË
 = 
Ãw
 
HashM­
<>();

281 
Li¡
<
CÜfuRuÁime
> 
ruÁimesFŞlowBackpoš‹rs
 = 
Ãw
 
A¼ayLi¡
<>();

282 
Li¡
<
CÜfuRuÁime
> 
ruÁimesAdd»ssM­s
 = 
Ãw
 
A¼ayLi¡
<>();

285 
fš®
 
numTh»ads
 = 10;

286 
fš®
 
numCl›Ás
 = 10;

287 
fš®
 
numKeys
 = 
PARAMETERS
.
NUM_ITERATIONS_LARGE
;

289 
i
 = 0; i < 
numCl›Ás
; i++) {

290 
CÜfuRuÁime
 
¹
 = 
	`ü—‹DeçuÉRuÁimeUsšgFŞlowBackpoš‹rs
().
	`£tCacheDi§bËd
(
çl£
);

291 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

292 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

294 .
	`£tSŒ—mName
("streamTable")

295 .
	`İ’
();

296 
ruÁimeToTabË
.
	`put
(
¹
, 
bË
);

297 
ruÁimesFŞlowBackpoš‹rs
.
	`add
(
¹
);

300 
i
 = 0; i < 
numCl›Ás
; i++) {

301 
CÜfuRuÁime
 
¹
 = 
	`ü—‹DeçuÉRuÁimeUsšgAdd»ssM­s
();

302 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

303 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

305 .
	`£tSŒ—mName
("streamTable")

306 .
	`İ’
();

307 
ruÁimeToTabË
.
	`put
(
¹
, 
bË
);

308 
ruÁimesAdd»ssM­s
.
	`add
(
¹
);

311 
Œy
 {

312 
Sy¡em
.
out
.
	`´šn
("**** Start multi-threaded benchmark");

315 
ExecutÜS”viû
 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

316 
LÚg
 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

318 
ruÁimeIndex
 = 0;

319 
i
 = 0; i < 
numKeys
; i++) {

320 ià(
ruÁimeIndex
 >ğ
numCl›Ás
) {

321 
ruÁimeIndex
 = 0;

323 
fš®
 
CÜfuRuÁime
 
¹
 = 
ruÁimesFŞlowBackpoš‹rs
.
	`g‘
(
ruÁimeIndex
);

324 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
ruÁimeToTabË
.
	`g‘
(
¹
);

325 
fš®
 
v®ue
 = 
i
;

326 
executÜ
.
	`subm™
(() -> {

327 
¹
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

328 
bË
.
	`put
(
v®ue
, 
SŒšg
.
	`v®ueOf
(value));

329 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

331 
ruÁimeIndex
++;

334 
executÜ
.
	`shutdown
();

335 
executÜ
.
	`awa™T”mš©iÚ
(2, 
TimeUn™
.
MINUTES
);

336 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** Multi-threaded…uts (%shreads, %s keys) completed in:" +

338 
numTh»ads
, 
numKeys
, (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
)));

341 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

342 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

344 
ruÁimeIndex
 = 0;

345 
i
 = 0; i < 
numKeys
; i++) {

346 ià(
ruÁimeIndex
 >ğ
numCl›Ás
) {

347 
ruÁimeIndex
 = 0;

349 
fš®
 
CÜfuRuÁime
 
¹
 = 
ruÁimesAdd»ssM­s
.
	`g‘
(
ruÁimeIndex
);

350 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
ruÁimeToTabË
.
	`g‘
(
¹
);

351 
fš®
 
v®ue
 = 
i
;

352 
executÜ
.
	`subm™
(() -> {

353 
¹
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

354 
bË
.
	`put
(
v®ue
, 
SŒšg
.
	`v®ueOf
(value));

355 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

357 
ruÁimeIndex
++;

360 
executÜ
.
	`shutdown
();

361 
executÜ
.
	`awa™T”mš©iÚ
(2, 
TimeUn™
.
MINUTES
);

362 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** Multi-threaded…uts (%shreads, %s keys) completed in:" +

364 
numTh»ads
, 
numKeys
, (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
)));

367 
tÙ®TimeFŞlowBackpoš‹rs
 = 
	`»adFromNewRuÁimeFŞlowšgBackpoš‹rs
("streamTable",

368 
numKeys
);

369 
Sy¡em
.
out
.
	`´šn
("**** Totalime‚ew„untimeo send stream (following backpointers): "

370 + 
tÙ®TimeFŞlowBackpoš‹rs
);

373 
tÙ®TimeAdd»ssM­s
 = 
	`»adFromNewRuÁimeUsšgAdd»ssM­s
("streamTable",

374 
numKeys
);

375 
Sy¡em
.
out
.
	`´šn
("**** Totalime‚ew„untimeo send stream (address maps): "

376 + 
tÙ®TimeAdd»ssM­s
);

378 
	`as£¹Th©
(
tÙ®TimeAdd»ssM­s
).
	`isLessThªOrEqu®To
(
tÙ®TimeFŞlowBackpoš‹rs
);

379 } 
fš®ly
 {

380 
CÜfuRuÁime
 
¹
 : 
ruÁimesFŞlowBackpoš‹rs
) {

381 
¹
.
	`shutdown
();

384 
CÜfuRuÁime
 
¹
 : 
ruÁimesAdd»ssM­s
) {

385 
¹
.
	`shutdown
();

388 
	`shutdownCÜfuS”v”
(
£rv”
);

390 
	}
}

397 @
Te¡


398 
public
 
	$b’chm¬kMuÉiTh»adedPutsR—dsTx
(è
throws
 
Exû±iÚ
 {

400 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

403 
CÜfuRuÁime
 
¹1
 = 
	`ü—‹RuÁimeW™hCache
();

406 
CÜfuRuÁime
 
¹2
 = 
	`ü—‹DeçuÉRuÁimeUsšgFŞlowBackpoš‹rs
();

409 
CÜfuRuÁime
 
¹3
 = 
	`ü—‹DeçuÉRuÁimeUsšgAdd»ssM­s
();

412 
fš®
 
numTh»ads
 = 10;

413 
fš®
 
numKeys
 = 10000;

415 
Œy
 {

416 
Sy¡em
.
out
.
	`´šn
("Start multi-threaded benchmark");

418 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
¹1
.
	`g‘ObjeùsV›w
().
	`bud
()

419 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

421 .
	`£tSŒ—mName
("streamTable")

422 .
	`İ’
();

424 
ExecutÜS”viû
 
executÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

425 
ExecutÜS”viû
 
executÜ2
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

426 
ExecutÜS”viû
 
executÜ3
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numTh»ads
);

428 
LÚg
 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

430 
i
 = 0; i < 
numKeys
; i++) {

431 
fš®
 
v®ue
 = 
i
;

432 
executÜ
.
	`subm™
(() -> {

433 
¹1
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
	`bud
().
	`begš
();

434 
bË
.
	`put
(
v®ue
, 
SŒšg
.
	`v®ueOf
(value));

435 
¹1
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

439 
executÜ
.
	`shutdown
();

440 
executÜ
.
	`awa™T”mš©iÚ
(1, 
TimeUn™
.
MINUTES
);

442 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** Multi-threaded…uts (%shreads, %s keys) completed in: %s ms",

443 
numTh»ads
, 
numKeys
, (
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
)));

446 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË2
 = 
¹2
.
	`g‘ObjeùsV›w
().
	`bud
()

447 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

449 .
	`£tSŒ—mName
("streamTable")

450 .
	`İ’
();

452 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

453 
i
 = 0; i < 
numKeys
; i++) {

454 
fš®
 
v®ue
 = 
i
;

455 
executÜ2
.
	`subm™
(() -> {

456 
¹2
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
	`bud
().
	`begš
();

457 
	`as£¹Th©
(
bË2
.
	`g‘
(
v®ue
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(value));

458 
¹2
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

462 
executÜ2
.
	`shutdown
();

463 
executÜ2
.
	`awa™T”mš©iÚ
(1, 
TimeUn™
.
MINUTES
);

465 
fŞlowBackpoš‹rsTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
;

467 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** New„untime„ead (following backpointers) completed in: %s ms",

468 
fŞlowBackpoš‹rsTime
));

470 
	`as£¹Th©
(
bË2
.
	`size
()).
	`isEqu®To
(
numKeys
);

473 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË3
 = 
¹3
.
	`g‘ObjeùsV›w
().
	`bud
()

474 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

476 .
	`£tSŒ—mName
("streamTable")

477 .
	`İ’
();

479 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

480 
i
 = 0; i < 
numKeys
; i++) {

481 
fš®
 
v®ue
 = 
i
;

482 
executÜ3
.
	`subm™
(() -> {

483 
¹3
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
	`bud
().
	`begš
();

484 
	`as£¹Th©
(
bË3
.
	`g‘
(
v®ue
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(value));

485 
¹3
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

489 
executÜ3
.
	`shutdown
();

490 
executÜ3
.
	`awa™T”mš©iÚ
(1, 
TimeUn™
.
MINUTES
);

492 
add»ssM­Time
 = 
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
¡¬tTime
;

494 
Sy¡em
.
out
.
	`´šn
(
SŒšg
.
	`fÜm©
("**** New„untime„ead (stream‡ddress maps) completed in: %s ms",

495 
add»ssM­Time
));

497 
	`as£¹Th©
(
bË3
.
	`size
()).
	`isEqu®To
(
numKeys
);

498 
	`as£¹Th©
(
add»ssM­Time
).
	`isLessThªOrEqu®To
(
fŞlowBackpoš‹rsTime
);

499 } 
	`ÿtch
(
Exû±iÚ
 
e
) {

500 
Sy¡em
.
out
.
	`´šn
("**** Exû±iÚ: " + 
e
);

502 } 
fš®ly
 {

503 
¹1
.
	`shutdown
();

504 
¹2
.
	`shutdown
();

505 
¹3
.
	`shutdown
();

506 
	`shutdownCÜfuS”v”
(
£rv”
);

508 
	}
}

527 @
Te¡


528 
public
 
	$checkpoštAndTrimAtDifã»ÁPošt
(è
throws
 
Exû±iÚ
 {

530 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

531 
CÜfuRuÁime
 
deçuÉRT
 = 
	`ü—‹DeçuÉRuÁime
();

532 
CÜfuRuÁime
 
¹
 = 
	`ü—‹DeçuÉRuÁime
();

534 
Œy
 {

535 
fš®
 
sizeM­1
 = 4;

536 
fš®
 
sizeM­2
 = 6;

538 
SŒ—mšgM­
<
SŒšg
, SŒšg> 
m­1
 = 
deçuÉRT
.
	`g‘ObjeùsV›w
().
	`bud
()

539 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

541 .
	`£tSŒ—mName
("stream1")

542 .
	`İ’
();

544 
SŒ—mšgM­
<
SŒšg
, SŒšg> 
m­2
 = 
deçuÉRT
.
	`g‘ObjeùsV›w
().
	`bud
()

545 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

547 .
	`£tSŒ—mName
("stream2")

548 .
	`İ’
();

551 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­1
, "0", "0");

552 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­2
, "1", "1");

553 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­1
, "2", "2");

554 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­2
, "3", "3");

555 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­2
, "4", "4");

556 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­1
, "5", "5");

559 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

560 
mcw1
.
	`addM­
(
m­1
);

561 
Tok’
 
mšCheckpoštAdd»ss
 = 
mcw1
.
	`­³ndCheckpošts
(
deçuÉRT
, "author");

563 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­1
, "9", "9");

564 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­2
, "10", "10");

565 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­2
, "11", "11");

568 
MuÉiCheckpoštWr™”
 
mcw2
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

569 
mcw2
.
	`addM­
(
m­2
);

570 
Tok’
 
maxCheckpoštAdd»ss
 = 
mcw2
.
	`­³ndCheckpošts
(
deçuÉRT
, "author");

572 
	`Œª§ùiÚ®Wr™e
(
deçuÉRT
, 
m­2
, "15", "15");

574 
	`as£¹Th©
(
m­1
).
	`hasSize
(
sizeM­1
);

575 
	`as£¹Th©
(
m­2
).
	`hasSize
(
sizeM­2
);

578 
deçuÉRT
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
mšCheckpoštAdd»ss
);

581 
M­
<
SŒšg
, SŒšg> 
m­1¹
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

582 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

584 .
	`£tSŒ—mName
("stream1")

585 .
	`İ’
();

587 
M­
<
SŒšg
, SŒšg> 
m­2¹
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

588 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

590 .
	`£tSŒ—mName
("stream2")

591 .
	`İ’
();

593 
	`as£¹Th©
(
m­1¹
.
	`size
()).
	`isEqu®To
(
sizeM­1
);

594 
	`as£¹Th©
(
m­2¹
.
	`size
()).
	`isEqu®To
(
sizeM­2
);

595 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

596 
	`ç
("Exû±iÚhrown", 
e
);

597 } 
fš®ly
 {

598 
deçuÉRT
.
	`shutdown
();

599 
¹
.
	`shutdown
();

600 
	`shutdownCÜfuS”v”
(
£rv”
);

602 
	}
}

604 
´iv©e
 
Œª§ùiÚ®Wr™e
(
CÜfuRuÁime
 
¹
, 
M­
<
SŒšg
, SŒšg> 
m­
, SŒšg 
key
, SŒšg 
v®ue
) {

605 
	g¹
.
g‘ObjeùsV›w
().
TXBud
().
ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
bud
().
begš
();

606 
	gm­
.
put
(
key
, 
v®ue
);

607 
	g¹
.
g‘ObjeùsV›w
().
TXEnd
();

631 @
Te¡


632 
public
 
	$checkpoštAndTrimAtDifã»ÁPoštSÇpshÙ
(è
throws
 
Exû±iÚ
 {

634 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

635 
CÜfuRuÁime
 
wr™eRuÁime
 = 
	`ü—‹DeçuÉRuÁime
();

636 
CÜfuRuÁime
 
»adRuÁime
 = 
	`ü—‹DeçuÉRuÁime
();

638 
Œy
 {

639 
fš®
 
b©chWr™e
 = 5;

640 
fš®
 
ŒimAdd»ss
 = 3L;

641 
fš®
 
¢­shÙAdd»ss
 = 9L;

642 
fš®
 
sizeAtSÇpshÙ
 = 6;

644 
SŒ—mšgM­
<
SŒšg
, SŒšg> 
m­1
 = 
wr™eRuÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

645 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

647 .
	`£tSŒ—mName
("stream1")

648 .
	`İ’
();

650 
i
=0; i<
b©chWr™e
; i++) {

651 
	`Œª§ùiÚ®Wr™e
(
wr™eRuÁime
, 
m­1
, 
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

655 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

656 
mcw1
.
	`addM­
(
m­1
);

657 
Tok’
 
mšCheckpoštAdd»ss
 = 
mcw1
.
	`­³ndCheckpošts
(
wr™eRuÁime
, "author");

659 
i
=
b©chWr™e
; i<batchWrite + batchWrite; i++) {

660 
	`Œª§ùiÚ®Wr™e
(
wr™eRuÁime
, 
m­1
, 
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

664 
MuÉiCheckpoštWr™”
 
mcw2
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

665 
mcw2
.
	`addM­
(
m­1
);

666 
Tok’
 
maxCheckpoštAdd»ss
 = 
mcw2
.
	`­³ndCheckpošts
(
wr™eRuÁime
, "author");

668 
	`as£¹Th©
(
m­1
).
	`hasSize
(
b©chWr™e
+batchWrite);

671 
wr™eRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
Ãw
 
	`Tok’
(
mšCheckpoštAdd»ss
.
	`g‘Epoch
(), 
ŒimAdd»ss
));

674 
M­
<
SŒšg
, SŒšg> 
m­1¹
 = 
»adRuÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

675 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

677 .
	`£tSŒ—mName
("stream1")

678 .
	`İ’
();

681 
»adRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

682 .
	`¢­shÙ
(
Ãw
 
	`Tok’
(
maxCheckpoštAdd»ss
.
	`g‘Epoch
(), 
¢­shÙAdd»ss
))

683 .
	`bud
()

684 .
	`begš
();

685 
	`as£¹Th©
(
m­1¹
).
	`hasSize
(
sizeAtSÇpshÙ
);

686 
»adRuÁime
.
	`g‘ObjeùsV›w
()

687 .
	`TXEnd
();

688 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

689 
	`ç
("Exû±iÚhrown", 
e
);

690 } 
fš®ly
 {

691 
wr™eRuÁime
.
	`shutdown
();

692 
»adRuÁime
.
	`shutdown
();

693 
	`shutdownCÜfuS”v”
(
£rv”
);

695 
	}
}

711 @
Te¡


712 
public
 
	$‹¡SŒ—mRebut
(è
throws
 
Exû±iÚ
 {

714 
Li¡
<
CÜfuRuÁime
> 
ruÁimes
 = 
Ãw
 
A¼ayLi¡
<>();

716 
fš®
 
š£¹iÚs
 = 10;

717 
fš®
 
š£¹iÚsB
 = 2;

718 
fš®
 
SŒšg
 
¡»am1
 = "mapA";

719 
fš®
 
SŒšg
 
¡»am2
 = "mapB";

720 
fš®
 
¢­shÙAdd»ss
 = 7;

723 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

725 
Œy
 {

726 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

727 
ruÁimes
.
	`add
(
ruÁime
);

730 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­A
 = 
	`ü—‹M­
(
ruÁime
, 
¡»am1
);

731 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­B
 = 
	`ü—‹M­
(
ruÁime
, 
¡»am2
);

734 
i
 = 0; i < 
š£¹iÚs
 - 
š£¹iÚsB
; i++) {

735 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

739 
i
 = 0; i < 
š£¹iÚsB
; i++) {

740 
m­B
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

745 
i
 = 
š£¹iÚs
; i < insertions * 2; i++) {

746 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

750 
CheckpoštWr™”
 
ıw
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am1
),

751 "checkpoš‹r-‹¡", 
m­A
);

752 
Tok’
 
ıAdd»ss
 = 
ıw
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss
));

755 
CheckpoštWr™”
 
ıwB
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am2
),

756 "checkpoš‹r-‹¡", 
m­B
);

757 
ıwB
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss
));

760 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıAdd»ss
);

761 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

762 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

763 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

766 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
£rv”
)).
	`isTrue
();

767 
£rv”
 = 
	`runDeçuÉS”v”
();

770 
CÜfuRuÁime
 
ruÁimeRe¡¬t
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

771 
ruÁimes
.
	`add
(
ruÁimeRe¡¬t
);

774 
SŒ—mAdd»ssS·û
 
add»ssS·ûA
 = 
ruÁimeRe¡¬t
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
()

775 .
	`g‘Add»ssM­
()

776 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am1
));

780 
	`as£¹Th©
(
add»ssS·ûA
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
¢­shÙAdd»ss
);

781 
	`as£¹Th©
(
add»ssS·ûA
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
š£¹iÚs
);

784 
SŒ—mAdd»ssS·û
 
add»ssS·ûB
 = 
ruÁimeRe¡¬t
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
()

785 .
	`g‘Add»ssM­
()

786 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am2
));

790 
	`as£¹Th©
(
add»ssS·ûB
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
¢­shÙAdd»ss
);

791 
	`as£¹Th©
(
add»ssS·ûB
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
š£¹iÚsB
);

794 
M­
<
SŒšg
, 
IÁeg”
> 
m­BRe¡¬t
 = 
	`ü—‹M­
(
ruÁimeRe¡¬t
, 
¡»am2
);

795 
	`as£¹Th©
(
m­BRe¡¬t
).
	`hasSize
(
š£¹iÚsB
);

798 
M­
<
SŒšg
, 
IÁeg”
> 
m­ARe¡¬t
 = 
	`ü—‹M­
(
ruÁimeRe¡¬t
, 
¡»am1
);

799 
	`as£¹Th©
(
m­ARe¡¬t
).
	`hasSize
(
š£¹iÚs
*2 - 
š£¹iÚsB
);

801 } 
fš®ly
 {

802 
ruÁimes
.
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

803 
	`shutdownCÜfuS”v”
(
£rv”
);

805 
	}
}

824 @
Te¡


825 
public
 
	$‹¡SŒ—mRebutW™hHŞeAsFœ¡EÁryAá”Trim
(è
throws
 
Exû±iÚ
 {

827 
Li¡
<
CÜfuRuÁime
> 
ruÁimes
 = 
Ãw
 
A¼ayLi¡
<>();

829 
fš®
 
š£¹iÚs
 = 10;

830 
fš®
 
SŒšg
 
¡»amNameA
 = "mapA";

831 
fš®
 
SŒšg
 
¡»amNameB
 = "mapB";

832 
fš®
 
¢­shÙAdd»ss
 = 8;

833 
fš®
 
checkpoštS¹RecÜd
 = 21L;

836 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

838 
Œy
 {

839 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

840 
ruÁimes
.
	`add
(
ruÁime
);

843 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­A
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amNameA
);

844 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­B
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amNameB
);

847 
i
 = 0; i < 
š£¹iÚs
 - 1; i++) {

848 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

851 
m­B
.
	`put
("a", 0);

854 
Tok’
 
tok’
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameA
)).
	`g‘Tok’
();

855 
LogD©a
 
hŞe
 = LogD©a.
	`g‘HŞe
(
tok’
);

856 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

857 .
	`g‘LogUn™Cl›Á
(
NodeLoÿtÜ
.
	`bud”
()

858 .
	`ho¡
(
DEFAULT_HOST
)

859 .
	`pÜt
(
DEFAULT_PORT
)

860 .
	`bud
()

861 .
	`toEndpoštU¾
())

862 .
	`wr™e
(
hŞe
);

866 
i
 = 
š£¹iÚs
; i < insertions * 2; i++) {

867 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

872 
CheckpoštWr™”
 
ıw
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameA
),

873 "checkpošt-‹¡", 
m­A
);

874 
Tok’
 
ıAdd»ss
 = 
ıw
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss
));

877 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıAdd»ss
);

878 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

879 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

880 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

883 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
£rv”
)).
	`isTrue
();

884 
£rv”
 = 
	`runDeçuÉS”v”
();

887 
CÜfuRuÁime
 
ruÁimeRe¡¬t
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

888 
ruÁimes
.
	`add
(
ruÁimeRe¡¬t
);

891 
LogEÁry
 
ıS¹
 = (
CheckpoštEÁry
è
ruÁimeRe¡¬t
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
checkpoštS¹RecÜd
)

892 .
	`g‘Paylßd
(
ruÁimeRe¡¬t
);

893 
	`as£¹Th©
(((
CheckpoštEÁry
è
ıS¹
).
	`g‘Diù
()

894 .
	`g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
)).
	`isEqu®To
("8");

897 
SŒ—mAdd»ssS·û
 
add»ssS·ûA
 = 
ruÁimeRe¡¬t
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
()

898 .
	`g‘Add»ssM­
()

899 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameA
));

902 
	`as£¹Th©
(
add»ssS·ûA
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
¢­shÙAdd»ss
);

903 
	`as£¹Th©
(
add»ssS·ûA
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
š£¹iÚs
);

906 
M­
<
SŒšg
, 
IÁeg”
> 
m­ARe¡¬t
 = 
	`ü—‹M­
(
ruÁimeRe¡¬t
, 
¡»amNameA
);

907 
	`as£¹Th©
(
m­ARe¡¬t
).
	`hasSize
(
š£¹iÚs
 * 2 - 1);

908 } 
fš®ly
 {

909 
ruÁimes
.
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

910 
	`shutdownCÜfuS”v”
(
£rv”
);

912 
	}
}

932 @
Te¡


933 
public
 
	$‹¡SŒ—mRebutW™hHŞeAsFœ¡EÁryAá”TrimNoCP
(è
throws
 
Exû±iÚ
 {

935 
Li¡
<
CÜfuRuÁime
> 
ruÁimes
 = 
Ãw
 
A¼ayLi¡
<>();

937 
fš®
 
š£¹iÚs
 = 10;

938 
fš®
 
SŒšg
 
¡»amNameA
 = "mapA";

939 
fš®
 
SŒšg
 
¡»amNameB
 = "mapB";

940 
fš®
 
¢­shÙAdd»ss
 = 10;

943 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

945 
Œy
 {

946 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

947 
ruÁimes
.
	`add
(
ruÁime
);

950 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­A
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amNameA
);

951 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­B
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amNameB
);

954 
i
 = 0; i < 
š£¹iÚs
; i++) {

955 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

959 
Tok’
 
tok’
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameB
)).
	`g‘Tok’
();

960 
LogD©a
 
hŞe
 = LogD©a.
	`g‘HŞe
(
tok’
);

961 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

962 .
	`g‘LogUn™Cl›Á
("tcp://localhost:9000")

963 .
	`wr™e
(
hŞe
);

966 
i
 = 0; i < 
š£¹iÚs
; i++) {

967 
m­B
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

971 
CheckpoštWr™”
 
ıw
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameA
),

972 "checkpoš‹r-‹¡", 
m­A
);

973 
Tok’
 
ıAdd»ss
 = 
ıw
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss
 - 1));

976 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıAdd»ss
);

977 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

978 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

979 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

983 
CÜfuRuÁime
 
¹2
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

984 
ruÁimes
.
	`add
(
¹2
);

987 
SŒ—mAdd»ssS·û
 
add»ssS·ûB
 = 
¹2
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
()

988 .
	`g‘Add»ssM­
()

989 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameB
));

992 
	`as£¹Th©
(
add»ssS·ûB
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

993 
	`as£¹Th©
(
add»ssS·ûB
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
š£¹iÚs
);

996 
M­
<
SŒšg
, 
IÁeg”
> 
m­BNewRuÁime
 = 
	`ü—‹M­
(
¹2
, 
¡»amNameB
);

997 
	`as£¹Th©
(
m­BNewRuÁime
).
	`hasSize
(
š£¹iÚs
);

1000 
M­
<
SŒšg
, 
IÁeg”
> 
m­ANewRuÁime
 = 
	`ü—‹M­
(
¹2
, 
¡»amNameA
);

1001 
	`as£¹Th©
(
m­ANewRuÁime
).
	`hasSize
(
š£¹iÚs
);

1004 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
£rv”
)).
	`isTrue
();

1005 
£rv”
 = 
	`runDeçuÉS”v”
();

1008 
CÜfuRuÁime
 
ruÁimeRe¡¬t
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

1009 
ruÁimes
.
	`add
(
ruÁimeRe¡¬t
);

1012 
add»ssS·ûB
 = 
ruÁimeRe¡¬t
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
()

1013 .
	`g‘Add»ssM­
()

1014 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amNameB
));

1017 
	`as£¹Th©
(
add»ssS·ûB
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

1018 
	`as£¹Th©
(
add»ssS·ûB
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
š£¹iÚs
);

1021 
M­
<
SŒšg
, 
IÁeg”
> 
m­BRe¡¬t
 = 
	`ü—‹M­
(
ruÁimeRe¡¬t
, 
¡»amNameB
);

1022 
	`as£¹Th©
(
m­BRe¡¬t
).
	`hasSize
(
š£¹iÚs
);

1025 
M­
<
SŒšg
, 
IÁeg”
> 
m­ARe¡¬t
 = 
	`ü—‹M­
(
ruÁimeRe¡¬t
, 
¡»amNameA
);

1026 
	`as£¹Th©
(
m­ARe¡¬t
).
	`hasSize
(
š£¹iÚs
);

1027 } 
fš®ly
 {

1028 
ruÁimes
.
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

1029 
	`shutdownCÜfuS”v”
(
£rv”
);

1031 
	}
}

1040 @
Te¡


1041 
public
 
	$‹¡CheckpoštWh’La¡Add»ssIsHŞe
(è
throws
 
Exû±iÚ
 {

1042 
fš®
 
numEÁr›s
 = 10;

1045 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

1047 
Œy
 {

1049 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

1052 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

1053 
fš®
 
SŒšg
 
¡»amB
 = "streamB";

1054 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
mA
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amA
);

1055 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
mB
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amB
);

1058 
i
 = 0; i < 
numEÁr›s
; i++) {

1059 
mA
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

1063 
Tok’
 
tok’
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
)).
	`g‘Tok’
();

1064 
LogD©a
 
hŞe
 = LogD©a.
	`g‘HŞe
(
tok’
);

1065 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

1066 .
	`g‘LogUn™Cl›Á
(
NodeLoÿtÜ
.
	`bud”
()

1067 .
	`ho¡
(
DEFAULT_HOST
)

1068 .
	`pÜt
(
DEFAULT_PORT
)

1069 .
	`bud
()

1070 .
	`toEndpoštU¾
())

1071 .
	`wr™e
(
hŞe
);

1074 
i
 = 0; i < 
numEÁr›s
; i++) {

1075 
mB
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), i);

1079 
CheckpoštWr™”
 
ıwA
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
),

1080 "checkpoš‹r-Te¡", 
mA
);

1081 
Tok’
 
ıTok’A
 = 
ıwA
.
	`­³ndCheckpošt
();

1084 
CheckpoštWr™”
 
ıwB
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amB
),

1085 "checkpoš‹r-Te¡", 
mB
);

1086 
ıwB
.
	`­³ndCheckpošt
();

1089 
mA
.
	`put
(
SŒšg
.
	`v®ueOf
(
numEÁr›s
),‚umEntries);

1092 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıTok’A
);

1095 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

1096 .
	`g‘LogUn™Cl›Á
(
NodeLoÿtÜ
.
	`bud”
()

1097 .
	`ho¡
(
DEFAULT_HOST
)

1098 .
	`pÜt
(
DEFAULT_PORT
)

1099 .
	`bud
()

1100 .
	`toEndpoštU¾
())

1101 .
	`æushCache
();

1104 
CÜfuRuÁime
 
¹2
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

1105 
M­
<
SŒšg
, 
IÁeg”
> 
mA2
 = 
	`ü—‹M­
(
¹2
, 
¡»amA
);

1108 
Œy
 {

1109 
¹2
.
	`g‘ObjeùsV›w
().
	`TXBud
()

1110 .
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
)

1111 .
	`bud
()

1112 .
	`begš
();

1113 
	`as£¹Th©
(
mA2
.
	`size
()).
	`isEqu®To
(
numEÁr›s
 + 1);

1116 
i
 = 0; i <ğ
numEÁr›s
; i++) {

1117 
	`as£¹Th©
(
mA2
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(i);

1119 } 
fš®ly
 {

1120 
¹2
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

1121 
¹2
.
	`shutdown
();

1122 
ruÁime
.
	`shutdown
();

1124 } 
fš®ly
 {

1125 
	`shutdownCÜfuS”v”
(
£rv”
);

1127 
	}
}

1135 @
Te¡


1136 
public
 
	$‹¡Em±yCheckpoštRebutOnRe¡¬t
(è
throws
 
Exû±iÚ
 {

1138 
Proûss
 
£rv”
 = 
	`runDeçuÉS”v”
();

1141 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

1144 
CÜfuRuÁime
 
¹Re¡¬t
 = 
nuÎ
;

1146 
Œy
 {

1148 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

1149 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
m­
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amA
);

1152 
CheckpoštWr™”
 
ıwA
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
),

1153 "checkpoš‹r-Te¡", 
m­
);

1154 
Tok’
 
ıTok’
 = 
ıwA
.
	`­³ndCheckpošt
();

1157 
	`as£¹Th©
(
ıTok’
.
	`g‘Sequ’û
()).
	`isEqu®To
(0L);

1161 
LogEÁry
 
ıS¹
 = (
CheckpoštEÁry
è
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(1L).
	`g‘Paylßd
(runtime);

1162 
	`as£¹Th©
(((
CheckpoštEÁry
è
ıS¹
).
	`g‘Diù
()

1163 .
	`g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
)).
	`isEqu®To
("0");

1166 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıTok’
);

1169 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

1170 .
	`g‘LogUn™Cl›Á
(
NodeLoÿtÜ
.
	`bud”
()

1171 .
	`ho¡
(
DEFAULT_HOST
)

1172 .
	`pÜt
(
DEFAULT_PORT
)

1173 .
	`bud
()

1174 .
	`toEndpoštU¾
())

1175 .
	`æushCache
();

1178 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
£rv”
)).
	`isTrue
();

1179 
£rv”
 = 
	`runDeçuÉS”v”
();

1182 
¹Re¡¬t
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

1185 
M­
<
SŒšg
, 
IÁeg”
> 
m­Re¡¬t
 = 
	`ü—‹M­
(
¹Re¡¬t
, 
¡»amA
);

1186 
	`as£¹Th©
(
m­Re¡¬t
).
	`hasSize
(0);

1188 } 
fš®ly
 {

1189 
	`shutdownCÜfuS”v”
(
£rv”
);

1191 ià(
ruÁime
 !ğ
nuÎ
èruÁime.
	`shutdown
();

1192 ià(
¹Re¡¬t
 !ğ
nuÎ
è¹Re¡¬t.
	`shutdown
();

1194 
	}
}

1196 
SŒšg
 
	$g‘CÚÃùiÚSŒšg
(
pÜt
) {

1197  
Ab¡¿ùIT
.
DEFAULT_HOST
 + ":" + 
pÜt
;

1198 
	}
}

1213 @
Te¡


1214 
public
 
	$‹¡CheckpoštEm±yM­AndSequ’ûrFaov”
(è
throws
 
Exû±iÚ
 {

1215 
	`‹¡CheckpoštEm±yM­W™hSequ’ûrFaov”
(
çl£
);

1216 
	}
}

1223 @
Te¡


1224 
public
 
	$‹¡CheckpoštEm±yM­W™hR—d”HŞeAndSequ’ûrFaov”
(è
throws
 
Exû±iÚ
 {

1225 
	`‹¡CheckpoštEm±yM­W™hSequ’ûrFaov”
(
Œue
);

1226 
	}
}

1228 
´iv©e
 
	$‹¡CheckpoštEm±yM­W™hSequ’ûrFaov”
(
boŞ—n
 
»ad”HŞe
è
throws
 
Exû±iÚ
 {

1229 
fš®
 
n0PÜt
 = 9000;

1230 
fš®
 
n1PÜt
 = 9001;

1231 
fš®
 
n2PÜt
 = 9002;

1233 
fš®
 
şu¡”SizeN2
 = 2;

1234 
fš®
 
şu¡”SizeN3
 = 3;

1236 
fš®
 
wÜkæowNumR‘ry
 = 3;

1237 
fš®
 
Du¿tiÚ
 
timeout
 = Du¿tiÚ.
	`ofMšu‹s
(5);

1238 
fš®
 
Du¿tiÚ
 
pŞlP”iod
 = Du¿tiÚ.
	`ofMlis
(50);

1241 
Proûss
 
£rv”_1
 = 
	`runS”v”
(
n0PÜt
, 
Œue
);

1242 
Proûss
 
£rv”_2
 = 
	`runS”v”
(
n1PÜt
, 
çl£
);

1243 
Proûss
 
£rv”_3
 = 
	`runS”v”
(
n2PÜt
, 
çl£
);

1245 
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
DEFAULT_ENDPOINT
).
	`cÚÃù
();

1247 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

1248 
timeout
, 
pŞlP”iod
);

1249 
ruÁime
.
	`šv®id©eLayout
();

1250 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN2
);

1252 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

1253 
timeout
, 
pŞlP”iod
);

1254 
ruÁime
.
	`šv®id©eLayout
();

1255 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN3
);

1257 
fš®
 
tÙ®EÁr›s
 = 2L;

1258 
exŒaEÁry
 = 0;

1260 
Œy
 {

1262 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

1263 
SŒ—mšgM­
<
SŒšg
, 
IÁeg”
> 
mA
 = 
	`ü—‹M­
(
ruÁime
, 
¡»amA
);

1265 
UUID
 
¡»amID
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
);

1266 
UUID
 
checkpoštId
 = 
CÜfuRuÁime
.
	`g‘CheckpoštSŒ—mIdFromId
(
¡»amID
);

1268 ià(
»ad”HŞe
) {

1270 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amID
).
	`g‘Tok’
();

1271 
	`as£¹Th©
(
mA
.
	`size
()).
	`isEqu®To
(0);

1272 
exŒaEÁry
 = 1;

1276 
CheckpoštWr™”
 
ıwA
 = 
Ãw
 
	`CheckpoštWr™”
(
ruÁime
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
),

1277 "checkpoš‹r-Te¡", 
mA
);

1278 
Tok’
 
ıTok’A
 = 
ıwA
.
	`­³ndCheckpošt
();

1281 
SŒ—msAdd»ssRe¥Ú£
 
logUn™Re¥Ú£
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
();

1282 
Tok’Re¥Ú£
 
£qu’ûrTas
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amID
, 
checkpoštId
);

1285 
	`as£¹Th©
(
logUn™Re¥Ú£
.
	`g‘Add»ssM­
().
	`g‘
(
checkpoštId
).
	`g‘Ta
()).
	`isEqu®To
(
tÙ®EÁr›s
 + 
exŒaEÁry
);

1286 
	`as£¹Th©
(
logUn™Re¥Ú£
.
	`g‘Add»ssM­
().
	`g‘
(
¡»amID
).
	`g‘Ta
()).
	`isEqu®To
(
exŒaEÁry
);

1288 
	`as£¹Th©
(
£qu’ûrTas
.
	`g‘SŒ—mTa
(
¡»amID
)).
	`isEqu®To
(
exŒaEÁry
);

1289 
	`as£¹Th©
(
£qu’ûrTas
.
	`g‘SŒ—mTa
(
checkpoštId
)).
	`isEqu®To
(
tÙ®EÁr›s
 + 
exŒaEÁry
);

1292 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ıTok’A
);

1294 
cu¼’tEpoch
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

1297 
	`shutdownCÜfuS”v”
(
£rv”_1
);

1299 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Epoch
(è> 
cu¼’tEpoch
, 
ruÁime
);

1302 
logUn™Re¥Ú£
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogAdd»ssS·û
();

1303 
£qu’ûrTas
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amID
, 
checkpoštId
);

1305 
	`as£¹Th©
(
logUn™Re¥Ú£
.
	`g‘Add»ssM­
().
	`g‘
(
checkpoštId
).
	`g‘Ta
()).
	`isEqu®To
(
tÙ®EÁr›s
 + 
exŒaEÁry
);

1306 
	`as£¹Th©
(
logUn™Re¥Ú£
.
	`g‘Add»ssM­
().
	`g‘
(
¡»amID
).
	`g‘Ta
()).
	`isEqu®To
(
exŒaEÁry
);

1308 
	`as£¹Th©
(
£qu’ûrTas
.
	`g‘SŒ—mTa
(
¡»amID
)).
	`isEqu®To
(
exŒaEÁry
);

1309 
	`as£¹Th©
(
£qu’ûrTas
.
	`g‘SŒ—mTa
(
checkpoštId
)).
	`isEqu®To
(
tÙ®EÁr›s
 + 
exŒaEÁry
);

1310 } 
fš®ly
 {

1311 
	`shutdownCÜfuS”v”
(
£rv”_2
);

1312 
	`shutdownCÜfuS”v”
(
£rv”_3
);

1314 
	}
}

	@test/src/test/java/org/corfudb/integration/StreamingIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuSŒ—mEÁr›s
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuSŒ—mEÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mLi¡’”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabË
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËSchema
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTxBud”
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

19 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

21 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

25 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

30 
public
 cÏs 
	cSŒ—mšgIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

32 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

33 
´iv©e
 
	mcÜfuSŒšgNodePÜt
;

34 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

38 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”
(
SŒšg
 
ho¡
, 
pÜt
è
throws
 
IOExû±iÚ
 {

39  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

40 .
	`£tHo¡
(
ho¡
)

41 .
	`£tPÜt
(
pÜt
)

42 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
ho¡
, 
pÜt
))

43 .
	`£tSšgË
(
Œue
)

44 .
	`runS”v”
();

50 @
BefÜe


51 
public
 
	$lßdPrİ”t›s
() {

52 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

53 
cÜfuSŒšgNodePÜt
 = 
IÁeg”
.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodePort"));

54 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
("%s:%d",

55 
cÜfuSšgËNodeHo¡
,

56 
cÜfuSŒšgNodePÜt
);

57 
	}
}

65 
´iv©e
 cÏs 
	cSŒ—mLi¡’”Im¶
 
im¶em’ts
 
	gSŒ—mLi¡’”
 {

67 @
G‘‹r


68 
´iv©e
 
fš®
 
SŒšg
 
	gÇme
;

70 @
G‘‹r


71 
´iv©e
 
fš®
 
	gLškedLi¡
<
	gCÜfuSŒ—mEÁr›s
> 
	gupd©es
 = 
Ãw
 
LškedLi¡
<>();

73 
public
 
SŒ—mLi¡’”Im¶
(
SŒšg
 
Çme
) {

74 
	gthis
.
	gÇme
 = 
Çme
;

77 @
Ov”ride


78 
public
 
ÚNext
(
CÜfuSŒ—mEÁr›s
 
»suÉs
) {

79 
	gupd©es
.
add
(
»suÉs
);

82 @
Ov”ride


83 
public
 
ÚE¼Ü
(
ThrowabË
 
throwabË
) {

86 @
Ov”ride


87 
public
 
boŞ—n
 
equ®s
(
Objeù
 
o
) {

88  
	gthis
.
hashCode
(è=ğ
o
.hashCode();

91 @
Ov”ride


92 
public
 
hashCode
() {

93  
	gÇme
.
hashCode
();

96 @
Ov”ride


97 
public
 
SŒšg
 
toSŒšg
() {

98  
	gÇme
;

113 @
Te¡


114 
public
 
	$‹¡SŒ—mšgSšgËTabË
(è
throws
 
Exû±iÚ
 {

116 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

119 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

121 
ruÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
);

122 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

125 
Time¡amp
 
ts1
 = 
¡Üe
.
	`g‘Time¡amp
();

128 
TabË
<
Uuid
, Uuid, Uuid> 
n1t1
 = 
¡Üe
.
	`İ’TabË
(

129 "n1", "t1", 
Uuid
.
şass
,

130 
Uuid
.
şass
, Uuid.class,

131 
TabËO±iÚs
.
	`bud”
().
	`bud
()

135 
fš®
 
numUpd©es
 = 3;

136 
i
 = 0; i < 
numUpd©es
; i++) {

137 
Uuid
 
uuid
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(
i
).
	`£tLsb
(i).
	`bud
();

138 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
("n1");

139 
tx
.
	`upd©e
("t1", 
uuid
, uuid, uuid).
	`comm™
();

143 
SŒ—mLi¡’”Im¶
 
s1n1t1
 = 
Ãw
 
	`SŒ—mLi¡’”Im¶
("s1n1t1");

144 
¡Üe
.
	`subsüibe
(
s1n1t1
, "n1",

145 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
	`TabËSchema
("t1", 
Uuid
.
şass
, Uuid.şass, Uuid.şass)), 
ts1
);

148 
TimeUn™
.
SECONDS
.
	`¦“p
(2);

150 
LškedLi¡
<
CÜfuSŒ—mEÁr›s
> 
upd©es
 = 
s1n1t1
.
	`g‘Upd©es
();

151 
	`as£¹Th©
(
upd©es
.
	`size
(è=ğ
numUpd©es
).
	`isTrue
();

152 
i
 = 0; i < 
numUpd©es
; i++) {

153 
Uuid
 
uuid
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(
i
).
	`£tLsb
(i).
	`bud
();

154 
CÜfuSŒ—mEÁr›s
 
upd©e
 = 
upd©es
.
	`g‘
(
i
);

155 
	`as£¹Th©
(
upd©e
.
	`g‘EÁr›s
().
	`size
(è=ğ1).
	`isTrue
();

156 
Li¡
<
CÜfuSŒ—mEÁry
> 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

157 
	`as£¹Th©
(
’Œy
.
	`size
(è=ğ1).
	`isTrue
();

158 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
().
	`equ®s
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
UPDATE
)).
	`isTrue
();

159 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Key
().
	`equ®s
(
uuid
)).
	`isTrue
();

160 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Paylßd
().
	`equ®s
(
uuid
)).
	`isTrue
();

161 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘M‘ad©a
().
	`equ®s
(
uuid
)).
	`isTrue
();

165 
SŒ—mLi¡’”Im¶
 
s2n1t1
 = 
Ãw
 
	`SŒ—mLi¡’”Im¶
("s2n1t1");

166 
¡Üe
.
	`subsüibe
(
s2n1t1
, "n1",

167 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
	`TabËSchema
("t1", 
Uuid
.
şass
, Uuid.şass, Uuid.şass)), 
nuÎ
);

169 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
("n1");

170 
Uuid
 
uuid0
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(0).
	`£tLsb
(0).
	`bud
();

171 
tx
.
	`d–‘e
("t1", 
uuid0
).
	`comm™
();

173 
TimeUn™
.
SECONDS
.
	`¦“p
(2);

176 
upd©es
 = 
s1n1t1
.
	`g‘Upd©es
();

177 
CÜfuSŒ—mEÁr›s
 
upd©e
 = 
upd©es
.
	`g‘La¡
();

178 
	`as£¹Th©
(
upd©e
.
	`g‘EÁr›s
().
	`size
(è=ğ1).
	`isTrue
();

179 
Li¡
<
CÜfuSŒ—mEÁry
> 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

180 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Add»ss
()).
	`isG»©”Thª
(0L);

181 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Epoch
()).
	`isEqu®To
(0L);

182 
	`as£¹Th©
(
’Œy
.
	`size
(è=ğ1).
	`isTrue
();

183 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
().
	`equ®s
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
DELETE
)).
	`isTrue
();

184 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Key
().
	`equ®s
(
uuid0
)).
	`isTrue
();

185 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Paylßd
(è=ğ
nuÎ
).
	`isTrue
();

186 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘M‘ad©a
(è=ğ
nuÎ
).
	`isTrue
();

188 
upd©es
 = 
s2n1t1
.
	`g‘Upd©es
();

190 
	`as£¹Th©
(
upd©es
.
	`size
(è=ğ1).
	`isTrue
();

191 
upd©e
 = 
upd©es
.
	`g‘La¡
();

192 
	`as£¹Th©
(
upd©e
.
	`g‘EÁr›s
().
	`size
(è=ğ1).
	`isTrue
();

193 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

194 
	`as£¹Th©
(
’Œy
.
	`size
(è=ğ1).
	`isTrue
();

195 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
().
	`equ®s
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
DELETE
)).
	`isTrue
();

196 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Key
().
	`equ®s
(
uuid0
)).
	`isTrue
();

197 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Paylßd
(è=ğ
nuÎ
).
	`isTrue
();

198 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘M‘ad©a
(è=ğ
nuÎ
).
	`isTrue
();

201 
¡Üe
.
	`unsubsüibe
(
s1n1t1
);

202 
TimeUn™
.
SECONDS
.
	`¦“p
(2);

204 
tx
 = 
¡Üe
.
	`tx
("n1");

205 
Uuid
 
uuid1
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(1).
	`£tLsb
(1).
	`bud
();

206 
tx
.
	`d–‘e
("t1", 
uuid1
).
	`comm™
();

209 
TimeUn™
.
SECONDS
.
	`¦“p
(2);

210 
upd©es
 = 
s1n1t1
.
	`g‘Upd©es
();

211 
	`as£¹Th©
(
upd©es
.
	`size
(è=ğ
numUpd©es
 + 1).
	`isTrue
();

212 
upd©es
 = 
s2n1t1
.
	`g‘Upd©es
();

213 
	`as£¹Th©
(
upd©es
.
	`size
(è=ğ2).
	`isTrue
();

214 
upd©e
 = 
upd©es
.
	`g‘La¡
();

215 
	`as£¹Th©
(
upd©e
.
	`g‘EÁr›s
().
	`size
(è=ğ1).
	`isTrue
();

216 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

217 
	`as£¹Th©
(
’Œy
.
	`size
(è=ğ1).
	`isTrue
();

218 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
().
	`equ®s
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
DELETE
)).
	`isTrue
();

219 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Key
().
	`equ®s
(
uuid1
)).
	`isTrue
();

222 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

223 
	}
}

235 @
Te¡


236 
public
 
	$‹¡SŒ—mšgMuÉiTabËSŒ—ms
(è
throws
 
Exû±iÚ
 {

238 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
, 
cÜfuSŒšgNodePÜt
);

241 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

243 
ruÁime
.
	`£tT¿n§ùiÚLoggšg
(
Œue
);

244 
CÜfuStÜe
 
¡Üe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

247 
Time¡amp
 
ts1
 = 
¡Üe
.
	`g‘Time¡amp
();

250 
TabË
<
Uuid
, Uuid, Uuid> 
n1t1
 = 
¡Üe
.
	`İ’TabË
(

251 "n1", "t1", 
Uuid
.
şass
,

252 
Uuid
.
şass
, Uuid.class,

253 
TabËO±iÚs
.
	`bud”
().
	`bud
()

256 
TabË
<
Uuid
, Uuid, Uuid> 
n2t1
 = 
¡Üe
.
	`İ’TabË
(

257 "n2", "t1", 
Uuid
.
şass
,

258 
Uuid
.
şass
, Uuid.class,

259 
TabËO±iÚs
.
	`bud”
().
	`bud
()

263 
fš®
 
numUpd©es
 = 3;

264 
i
 = 0; i < 
numUpd©es
; i++) {

265 
Uuid
 
uuid
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(
i
).
	`£tLsb
(i).
	`bud
();

266 
TxBud”
 
tx
 = 
¡Üe
.
	`tx
("n1");

267 
tx
.
	`upd©e
("t1", 
uuid
, uuid, uuid).
	`comm™
();

268 
TxBud”
 
tx2
 = 
¡Üe
.
	`tx
("n2");

269 
tx2
.
	`upd©e
("t1", 
uuid
, uuid, uuid).
	`comm™
();

273 
SŒ—mLi¡’”Im¶
 
s1n1t1
 = 
Ãw
 
	`SŒ—mLi¡’”Im¶
("s1n1t1");

275 
SŒ—mLi¡’”Im¶
 
s2n2t1
 = 
Ãw
 
	`SŒ—mLi¡’”Im¶
("s2n2t1");

276 
¡Üe
.
	`subsüibe
(
s1n1t1
, "n1",

277 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
	`TabËSchema
("t1", 
Uuid
.
şass
, Uuid.şass, Uuid.şass)), 
ts1
);

278 
¡Üe
.
	`subsüibe
(
s2n2t1
, "n2",

279 
CŞËùiÚs
.
	`sšgËtÚLi¡
(
Ãw
 
	`TabËSchema
("t1", 
Uuid
.
şass
, Uuid.şass, Uuid.şass)), 
ts1
);

282 
TimeUn™
.
SECONDS
.
	`¦“p
(2);

283 
LškedLi¡
<
CÜfuSŒ—mEÁr›s
> 
upd©es
 = 
s1n1t1
.
	`g‘Upd©es
();

284 
	`as£¹Th©
(
upd©es
.
	`size
()).
	`isEqu®To
(
numUpd©es
);

285 
i
 = 0; i < 
numUpd©es
; i++) {

286 
Uuid
 
uuid
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(
i
).
	`£tLsb
(i).
	`bud
();

287 
CÜfuSŒ—mEÁr›s
 
upd©e
 = 
upd©es
.
	`g‘
(
i
);

288 
	`as£¹Th©
(
upd©e
.
	`g‘EÁr›s
()).
	`hasSize
(1);

289 
Li¡
<
CÜfuSŒ—mEÁry
> 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

290 
	`as£¹Th©
(
’Œy
).
	`hasSize
(1);

291 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
()).
	`isEqu®To
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
UPDATE
);

292 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Key
()).
	`isEqu®To
(
uuid
);

293 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Paylßd
()).
	`isEqu®To
(
uuid
);

294 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘M‘ad©a
()).
	`isEqu®To
(
uuid
);

297 
LškedLi¡
<
CÜfuSŒ—mEÁr›s
> 
upd©es2
 = 
s2n2t1
.
	`g‘Upd©es
();

298 
	`as£¹Th©
(
upd©es2
.
	`size
()).
	`isEqu®To
(
numUpd©es
);

299 
i
 = 0; i < 
numUpd©es
; i++) {

300 
Uuid
 
uuid
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(
i
).
	`£tLsb
(i).
	`bud
();

301 
CÜfuSŒ—mEÁr›s
 
upd©e
 = 
upd©es2
.
	`g‘
(
i
);

302 
	`as£¹Th©
(
upd©e
.
	`g‘EÁr›s
()).
	`hasSize
(1);

303 
Li¡
<
CÜfuSŒ—mEÁry
> 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

304 
	`as£¹Th©
(
’Œy
).
	`hasSize
(1);

305 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
()).
	`isEqu®To
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
UPDATE
);

306 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Key
()).
	`isEqu®To
(
uuid
);

307 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘Paylßd
()).
	`isEqu®To
(
uuid
);

308 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘M‘ad©a
()).
	`isEqu®To
(
uuid
);

312 
n1t1
.
	`ş—r
();

315 
TimeUn™
.
SECONDS
.
	`¦“p
(1);

316 
upd©es
 = 
s1n1t1
.
	`g‘Upd©es
();

317 
	`as£¹Th©
(
upd©es
.
	`size
()).
	`isG»©”Thª
(0);

319 
CÜfuSŒ—mEÁr›s
 
upd©e
 = 
upd©es
.
	`g‘
(upd©es.
	`size
() - 1);

320 
Li¡
<
CÜfuSŒ—mEÁry
> 
’Œy
 = 
upd©e
.
	`g‘EÁr›s
().
	`v®ues
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

321 
	`as£¹Th©
(
’Œy
.
	`g‘
(0).
	`g‘O³¿tiÚ
()).
	`isEqu®To
(
CÜfuSŒ—mEÁry
.
O³¿tiÚTy³
.
CLEAR
);

324 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

325 
	}
}

	@test/src/test/java/org/corfudb/integration/TestSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

6 
impÜt
 
	glombok
.
	gV®ue
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

10 
impÜt
 
	gjava
.
	gÏng
.
	g»f
.
	gSoáReã»nû
;

11 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

12 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

14 
public
 cÏs 
	cTe¡S”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

16 
´iv©e
 
by‹
 
	mty³Id’tif›r
;

17 
´iv©e
 
IS”Ÿliz”
 
	md–eg©e
 = 
nuÎ
;

20 
public
 
	$Te¡S”Ÿliz”
(
by‹
 
ty³Id’tif›r
) {

21 
this
.
ty³Id’tif›r
 =ypeIdentifier;

24 
public
 
	$Te¡S”Ÿliz”
(
by‹
 
ty³Id’tif›r
, 
IS”Ÿliz”
 
d–eg©e
) {

25 
this
.
ty³Id’tif›r
 =ypeIdentifier;

26 
this
.
d–eg©e
 = delegate;

27 
	}
}

29 
public
 
	$£tTy³
(
by‹
 
ty³
) {

30 
ty³Id’tif›r
 = 
ty³
;

31 
	}
}

33 @
Ov”ride


34 
public
 
by‹
 
	$g‘Ty³
() {

35  
ty³Id’tif›r
;

36 
	}
}

38 @
Ov”ride


39 
public
 
LÚg
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

40  
b
.
	`»adLÚg
();

41 
	}
}

43 @
Ov”ride


44 
public
 
	$£rŸlize
(
Objeù
 
objeù
, 
By‹Buf
 
bufãr
) {

45 
bufãr
.
	`wr™eLÚg
((
LÚg
)
objeù
);

47 
	}
}

	@test/src/test/java/org/corfudb/integration/TransactionStreamIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiSMREÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gM­
;

18 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

24 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

34 
public
 cÏs 
	cT¿n§ùiÚSŒ—mIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

40 
´iv©e
 
CÚsumeD–
(
M­
<
UUID
, 
IÁeg”
> 
m­
, 
Li¡
<
ILogD©a
> 
d–s
) {

41 
ILogD©a
 
	mld
 : 
d–s
) {

42 
MuÉiObjeùSMREÁry
 
muÉiObjSmr
 = (MuÉiObjeùSMREÁryè
ld
.
g‘Paylßd
(
nuÎ
);

43 
	mM­
.
	mEÁry
<
	mUUID
, 
	mMuÉiSMREÁry
> 
	mmuÉiSMREÁry
 : 
muÉiObjSmr
.
g‘EÁryM­
().
’ŒyS‘
()) {

44 
SMREÁry
 
upd©e
 : 
muÉiSMREÁry
.
g‘V®ue
().
g‘Upd©es
()) {

45 
key
 = (è
upd©e
.
g‘SMRArgum’ts
()[0];

46 
	mv®
 = (è
upd©e
.
g‘SMRArgum’ts
()[1];

47 
as£¹Th©
(
key
).
isEqu®To
(
v®
);

48 
	mÃwV®
 = 
m­
.
g‘OrDeçuÉ
(
muÉiSMREÁry
.
g‘Key
(), 0è+ 
	mkey
;

49 
	mm­
.
put
(
muÉiSMREÁry
.
g‘Key
(), 
ÃwV®
);

55 @
Te¡


56 
public
 
	$txnSŒ—mTe¡
(è
throws
 
Exû±iÚ
 {

58 
Proûss
 
£rv”_1
 = 
Ãw
 
	`CÜfuS”v”RuÂ”
()

59 .
	`£tHo¡
(
DEFAULT_HOST
)

60 .
	`£tPÜt
(
DEFAULT_PORT
)

61 .
	`£tSšgË
(
Œue
)

62 .
	`runS”v”
();

64 
fš®
 
ruÁimeCacheSize
 = 5;

65 
fš®
 
numWr™”s
 = 4;

66 
fš®
 
numWr™esP”Th»ad
 = 500;

67 
fš®
 
pŞlP”iodMs
 = 50;

68 
fš®
 
timeout
 = 30;

70 
ExecutÜS”viû
 
cÚsum”
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
();

71 
Li¡
<
CÜfuRuÁime
> 
cÚsum”Rts
 = 
Ãw
 
A¼ayLi¡
<>();

74 
Futu»
<
M­
<
UUID
, 
IÁeg”
>> 
cÚsum”S‹
 = 
cÚsum”
.
	`subm™
(() -> {

76 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

77 .
	`bud”
()

78 .
	`maxCacheEÁr›s
(
ruÁimeCacheSize
)

79 .
	`bud
();

81 
CÜfuRuÁime
 
cÚsum”Rt
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
)

82 .
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
)

83 .
	`£tT¿n§ùiÚLoggšg
(
Œue
)

84 .
	`cÚÃù
();

86 
cÚsum”Rts
.
	`add
(
cÚsum”Rt
);

88 
ISŒ—mV›w
 
txSŒ—m
 = 
cÚsum”Rt
.
	`g‘SŒ—msV›w
().
	`g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
);

90 
M­
<
UUID
, 
IÁeg”
> 
couÁ”s
 = 
Ãw
 
HashM­
<>(
numWr™”s
);

91 
cÚsumed
 = 0;

95 
cÚsumed
 < 
numWr™”s
 * 
numWr™esP”Th»ad
) {

96 
Li¡
<
ILogD©a
> 
’Œ›s
 = 
txSŒ—m
.
	`»maššg
();

98 ià(!
’Œ›s
.
	`isEm±y
()) {

99 
	`CÚsumeD–
(
couÁ”s
, 
’Œ›s
);

102 
cÚsumed
 +ğ
’Œ›s
.
	`size
();

103 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
pŞlP”iodMs
);

106  
couÁ”s
;

110 
ExecutÜS”viû
 
´oduûrs
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(
numWr™”s
);

112 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

113 .
	`bud”
()

114 .
	`maxCacheEÁr›s
(
ruÁimeCacheSize
)

115 .
	`bud
();

117 
CÜfuRuÁime
 
´oduûrsRt
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
)

118 .
	`·r£CÚfigu¿tiÚSŒšg
(
DEFAULT_ENDPOINT
)

119 .
	`£tT¿n§ùiÚLoggšg
(
Œue
)

120 .
	`cÚÃù
();

125 
x
 = 1; x <ğ
numWr™”s
; x++) {

126 
fš®
 
idx
 = 
x
;

127 
´oduûrs
.
	`subm™
(() -> {

128 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
m­
 = 
´oduûrsRt
.
	`g‘ObjeùsV›w
()

129 .
	`bud
()

130 .
	`£tSŒ—mName
(
SŒšg
.
	`v®ueOf
(
idx
))

131 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

132 .
	`İ’
();

133 
i
 = 1; i <ğ
numWr™esP”Th»ad
; i++) {

134 
´oduûrsRt
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

135 
m­
.
	`put
(
i
, i);

136 
´oduûrsRt
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

141 
´oduûrs
.
	`shutdown
();

142 
cÚsum”
.
	`shutdown
();

144 
M­
<
UUID
, 
IÁeg”
> 
couÁ”s
 = 
cÚsum”S‹
.
	`g‘
(
timeout
, 
TimeUn™
.
SECONDS
);

145 
	`as£¹Th©
(
couÁ”s
).
	`hasSize
(
numWr™”s
);

149 
sumOfWr™esP”TabË
 = (
numWr™esP”Th»ad
 * (numWritesPerThread + 1)) / 2;

150 
x
 = 1; x <ğ
numWr™”s
; x++) {

151 
	`as£¹Th©
(
couÁ”s
.
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
SŒšg
.
	`v®ueOf
(
x
)))).
	`isEqu®To
(
sumOfWr™esP”TabË
);

153 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
m­
 = 
´oduûrsRt
.
	`g‘ObjeùsV›w
()

154 .
	`bud
()

155 .
	`£tSŒ—mName
(
SŒšg
.
	`v®ueOf
(
x
))

156 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

157 .
	`İ’
();

158 
	`as£¹Th©
(
m­
.
	`size
()).
	`isEqu®To
(
numWr™esP”Th»ad
);

161 
´oduûrsRt
.
	`shutdown
();

162 
cÚsum”Rts
.
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

163 
	`shutdownCÜfuS”v”
(
£rv”_1
);

164 
	}
}

	@test/src/test/java/org/corfudb/integration/WorkflowIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.*;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gH¬Ãss
.
	grun
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
.
	gNode
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

18 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

19 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

35 @
Slf4j


36 
public
 cÏs 
	cWÜkæowIT
 
ex‹nds
 
	mAb¡¿ùIT
 {

38 
´iv©e
 
fš®
 
SŒšg
 
	mho¡
 = "localhost";

40 
SŒšg
 
	$g‘CÚÃùiÚSŒšg
(
pÜt
) {

41  
ho¡
 + ":" + 
pÜt
;

44 
fš®
 
Du¿tiÚ
 
timeout
 = Du¿tiÚ.
	`ofMšu‹s
(5);

45 
fš®
 
Du¿tiÚ
 
pŞlP”iod
 = Du¿tiÚ.
	`ofMlis
(50);

46 
fš®
 
wÜkæowNumR‘ry
 = 3;

48 @
Te¡


49 
public
 
	$addAndRemoveNodeIT
(è
throws
 
Exû±iÚ
 {

50 
fš®
 
SŒšg
 
¡»amName
 = "s1";

51 
fš®
 
n1PÜt
 = 9000;

52 
fš®
 
numI‹r
 = 11
_000
;

55 
Proûss
 
£rv”_1
 = 
	`runS”v”
(
n1PÜt
, 
Œue
);

58 
fš®
 
n2PÜt
 = 9001;

59 
Proûss
 
£rv”_2
 = 
	`runS”v”
(
n2PÜt
, 
çl£
);

62 
fš®
 
n3PÜt
 = 9002;

63 
Proûss
 
£rv”_3
 = 
	`runS”v”
(
n3PÜt
, 
çl£
);

65 
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
))

66 .
	`£tCacheDi§bËd
(
Œue
).
	`cÚÃù
();

68 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

69 .
	`bud
()

70 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

71 .
	`£tSŒ—mName
(
¡»amName
)

72 .
	`İ’
();

74 
x
 = 0; x < 
numI‹r
; x++) {

75 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
x
), String.valueOf(x));

78 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

79 
timeout
, 
pŞlP”iod
);

82 
fš®
 
şu¡”SizeN2
 = 2;

83 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AÎS”v”s
().
	`size
(è=ğ
şu¡”SizeN2


84 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
ruÁime
);

86 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

87 
mcw
.
	`addM­
(
bË
);

89 
Tok’
 
´efix
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "Maithem");

91 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
´efix
);

93 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

94 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

95 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

98 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n3PÜt
), 
wÜkæowNumR‘ry
,

99 
timeout
, 
pŞlP”iod
);

102 
fš®
 
şu¡”SizeN3
 = 3;

103 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AÎS”v”s
().
	`size
(è=ğ
şu¡”SizeN3


104 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
ruÁime
);

107 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`»moveNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

108 
timeout
, 
pŞlP”iod
);

109 
ruÁime
.
	`šv®id©eLayout
();

110 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN2
);

114 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`»moveNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

115 
timeout
, 
pŞlP”iod
);

116 
	`shutdownCÜfuS”v”
(
£rv”_2
);

120 
	`wa™FÜLayoutChªge
(
Ïyout
 ->

121 
Ïyout
.
	`g‘AÎS”v”s
().
	`size
() == 2

122 && !
Ïyout
.
	`g‘AÎS”v”s
().
	`cÚšs
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
)), 
ruÁime
);

125 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(
	`g‘CÚÃùiÚSŒšg
(
n3PÜt
), 
wÜkæowNumR‘ry
,

126 
timeout
, 
pŞlP”iod
);

127 
	`shutdownCÜfuS”v”
(
£rv”_3
);

129 
ruÁime
.
	`šv®id©eLayout
();

130 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(1);

132 
£rv”_2
 = 
	`runS”v”
(
n2PÜt
, 
çl£
);

134 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

135 
timeout
, 
pŞlP”iod
);

137 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘AÎS”v”s
().
	`size
(è=ğ
şu¡”SizeN2


138 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
ruÁime
);

140 
x
 = 0; x < 
numI‹r
; x++) {

141 
SŒšg
 
v
 = (SŒšgè
bË
.
	`g‘
(SŒšg.
	`v®ueOf
(
x
));

142 
	`as£¹Th©
(
v
).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(
x
));

145 
	`shutdownCÜfuS”v”
(
£rv”_1
);

146 
	`shutdownCÜfuS”v”
(
£rv”_2
);

147 
	}
}

154 @
Te¡


155 
public
 
	$şu¡”ResizšgTe¡1
(è
throws
 
Exû±iÚ
 {

156 
fš®
 
n0PÜt
 = 9000;

157 
fš®
 
n1PÜt
 = 9001;

158 
fš®
 
n2PÜt
 = 9002;

160 
fš®
 
şu¡”SizeN1
 = 1;

161 
fš®
 
şu¡”SizeN2
 = 2;

162 
fš®
 
şu¡”SizeN3
 = 3;

164 
Proûss
 
p0
 = 
	`runS”v”
(
n0PÜt
, 
Œue
);

165 
Proûss
 
p1
 = 
	`runS”v”
(
n1PÜt
, 
çl£
);

166 
Proûss
 
p2
 = 
	`runS”v”
(
n2PÜt
, 
çl£
);

168 
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
	`g‘CÚÃùiÚSŒšg
(
n0PÜt
)).
	`cÚÃù
();

169 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

170 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

171 .
	`£tSŒ—mName
("bË1").
	`İ’
();

173 
fš®
 
™”
 = 1000;

174 
x
 = 0; x < 
™”
; x++) {

175 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
x
), String.valueOf(x));

178 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

179 
timeout
, 
pŞlP”iod
);

180 
ruÁime
.
	`šv®id©eLayout
();

182 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN2
);

184 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

185 
timeout
, 
pŞlP”iod
);

186 
ruÁime
.
	`šv®id©eLayout
();

188 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN1
);

190 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

191 
timeout
, 
pŞlP”iod
);

193 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

194 
timeout
, 
pŞlP”iod
);

196 
ruÁime
.
	`šv®id©eLayout
();

197 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN3
);

199 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`»moveNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

200 
timeout
, 
pŞlP”iod
);

201 
ruÁime
.
	`šv®id©eLayout
();

202 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN2
);

204 
x
 = 0; x < 
™”
; x++) {

205 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
x
))).
	`isEqu®To
(String.valueOf(x));

208 
	`shutdownCÜfuS”v”
(
p0
);

209 
	`shutdownCÜfuS”v”
(
p1
);

210 
	`shutdownCÜfuS”v”
(
p2
);

211 
	}
}

213 @
Te¡


214 
public
 
	$şu¡”ResizšgTe¡2
(è
throws
 
Exû±iÚ
 {

217 
fš®
 
n0PÜt
 = 9000;

218 
fš®
 
n1PÜt
 = 9001;

219 
fš®
 
n2PÜt
 = 9002;

221 
fš®
 
şu¡”SizeN1
 = 1;

222 
fš®
 
şu¡”SizeN3
 = 3;

224 
Proûss
 
p0
 = 
	`runS”v”
(
n0PÜt
, 
Œue
);

225 
Proûss
 
p1
 = 
	`runS”v”
(
n1PÜt
, 
çl£
);

226 
Proûss
 
p2
 = 
	`runS”v”
(
n2PÜt
, 
çl£
);

228 
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
	`g‘CÚÃùiÚSŒšg
(
n0PÜt
)).
	`cÚÃù
();

229 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

230 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

231 .
	`£tSŒ—mName
("bË1").
	`İ’
();

233 
fš®
 
™”
 = 100;

234 
x
 = 0; x < 
™”
; x++) {

235 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
x
), String.valueOf(x));

238 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

239 
timeout
, 
pŞlP”iod
);

241 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

242 
timeout
, 
pŞlP”iod
);

244 
ruÁime
.
	`šv®id©eLayout
();

245 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN3
);

248 
	`shutdownCÜfuS”v”
(
p1
);

249 
	`shutdownCÜfuS”v”
(
p2
);

252 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(
	`g‘CÚÃùiÚSŒšg
(
n1PÜt
), 
wÜkæowNumR‘ry
,

253 
timeout
, 
pŞlP”iod
);

254 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`fÜûRemoveNode
(
	`g‘CÚÃùiÚSŒšg
(
n2PÜt
), 
wÜkæowNumR‘ry
,

255 
timeout
, 
pŞlP”iod
);

256 
ruÁime
.
	`šv®id©eLayout
();

257 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`size
()).
	`isEqu®To
(
şu¡”SizeN1
);

259 
x
 = 0; x < 
™”
; x++) {

260 
	`as£¹Th©
(
bË
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
x
))).
	`isEqu®To
(String.valueOf(x));

263 
	`shutdownCÜfuS”v”
(
p0
);

264 
	}
}

275 @
Te¡


276 
public
 
	$addNodeW™hTrim
(è
throws
 
Exû±iÚ
 {

277 
H¬Ãss
 
h¬Ãss
 = H¬Ãss.
	`g‘DeçuÉH¬Ãss
();

279 
fš®
 
numNodes
 = 3;

280 
fš®
 
PORT_1
 = 9001;

281 
fš®
 
PORT_2
 = 9002;

282 
Li¡
<
Node
> 
nodeLi¡
 = 
h¬Ãss
.
	`d•loyClu¡”
(1);

283 
Node
 
n0
 = 
nodeLi¡
.
	`g‘
(0);

284 
Node
 
n1
 = 
h¬Ãss
.
	`d•loyUnboÙ¡¿µedNode
(
PORT_1
);

285 
Node
 
n2
 = 
h¬Ãss
.
	`d•loyUnboÙ¡¿µedNode
(
PORT_2
);

287 
ruÁime
 = 
h¬Ãss
.
	`ü—‹RuÁimeFÜNode
(
n0
);

288 
fš®
 
SŒšg
 
¡»amName
 = "test";

289 
CÜfuTabË
<
SŒšg
, 
IÁeg”
> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

290 .
	`bud
()

291 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {})

292 .
	`£tSŒ—mName
(
¡»amName
)

293 .
	`İ’
();

294 
fš®
 
’Œ›sCouÁ
 = 1
_000
;

297 
i
 = 0; i < 
’Œ›sCouÁ
; i++) {

298 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), i);

302 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

303 
mcw
.
	`addM­
(
bË
);

304 
Tok’
 
´efixTrimAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "author");

305 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
´efixTrimAdd»ss
);

306 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

307 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

308 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

311 
	`as£¹Th©
(
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
()).
	`isEqu®To
(
’Œ›sCouÁ
+1);

315 
fš®
 
checkpoštEÁr›sCouÁ
 = 22;

318 
i
 = 0; i < 
’Œ›sCouÁ
; i++) {

319 
bË
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), i);

321 
fš®
 
¡»amTa
 = 
’Œ›sCouÁ
 + 
checkpoštEÁr›sCouÁ
 +ƒntriesCount - 1;

324 
fš®
 
»Œ›s
 = 3;

325 
fš®
 
Du¿tiÚ
 
timeout
 = 
PARAMETERS
.
TIMEOUT_LONG
;

326 
fš®
 
Du¿tiÚ
 
pŞlP”iod
 = 
PARAMETERS
.
TIMEOUT_VERY_SHORT
;

327 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
("loÿlho¡:9001", 
»Œ›s
, 
timeout
, 
pŞlP”iod
);

328 
ruÁime
.
	`g‘Mªagem’tV›w
().
	`addNode
("loÿlho¡:9002", 
»Œ›s
, 
timeout
, 
pŞlP”iod
);

330 
ruÁime
.
	`šv®id©eLayout
();

331 
Layout
 
ÏyoutAá”Adds
 = 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

332 
	`as£¹Th©
(
ÏyoutAá”Adds
.
	`g‘Segm’ts
().
	`¡»am
()

333 .
	`®lM©ch
(
s
 -> s.
	`g‘AÎLogS”v”s
().
	`size
(è=ğ
numNodes
)).
	`isTrue
();

335 
	`run
(
n0
.
shutdown
);

338 
	`as£¹Th©
(
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
()).
	`isEqu®To
(
’Œ›sCouÁ
+1);

340 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

341 ià(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(è> 
ÏyoutAá”Adds
.getEpoch()) {

344 
ruÁime
.
	`šv®id©eLayout
();

345 
SË•
.
	`¦“pUnš‹¼u±ibly
(
PARAMETERS
.
TIMEOUT_SHORT
);

349 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘LogUn™Cl›Á
("loÿlho¡:9001").
	`g‘TrimM¬k
().
	`g‘
())

350 .
	`isEqu®To
(
´efixTrimAdd»ss
.
	`g‘Sequ’û
() + 1);

351 
	`as£¹Th©
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘LogUn™Cl›Á
("loÿlho¡:9002").
	`g‘TrimM¬k
().
	`g‘
())

352 .
	`isEqu®To
(
´efixTrimAdd»ss
.
	`g‘Sequ’û
() + 1);

353 
	`as£¹Th©
(
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘AÎTas
().
	`g‘SŒ—mTas
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
)))

354 .
	`isEqu®To
(
¡»amTa
+1);

357 
	`run
(
n1
.
shutdown
, 
n2
.shutdown);

358 
	}
}

401 @
Te¡


402 
public
 
	$‹¡RuÁimeGCFÜAùiveT¿n§ùiÚsInTrimRªgeSšgËTh»ad
(è
throws
 
Exû±iÚ
 {

404 
	`runDeçuÉS”v”
();

405 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

407 
fš®
 
numD©aEÁr›s
 = 10;

410 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

411 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

413 .
	`£tSŒ—mName
("test")

414 .
	`İ’
();

417 
i
 = 0; i < 
numD©aEÁr›s
 - 2; i++) {

418 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

419 
bË
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

420 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

424 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

425 
mcw
.
	`addM­
(
bË
);

426 
Tok’
 
´efixTrim
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "author");

429 
i
 = 
numD©aEÁr›s
 - 2; i <‚umDataEntries; i++) {

430 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

431 
bË
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

432 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

437 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

438 .
	`¢­shÙ
(
Ãw
 
	`Tok’
(0,1))

439 .
	`bud
()

440 .
	`begš
();

441 
bË
.
	`g‘
(0);

442 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

445 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
´efixTrim
);

448 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

451 
	`as£¹Th©
(
bË
).
	`hasSize
(
numD©aEÁr›s
);

452 
i
 = 0; i < 
numD©aEÁr›s
; i++) {

453 
	`as£¹Th©
(
bË
.
	`g‘
(
i
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(i));

457 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

474 
	`as£¹Th©
(
bË
).
	`hasSize
(
numD©aEÁr›s
);

475 
i
 = 0; i < 
numD©aEÁr›s
; i++) {

476 
	`as£¹Th©
(
bË
.
	`g‘
(
i
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(i));

478 
	}
}

529 @
Te¡


530 
public
 
	$‹¡RuÁimeGCFÜAùiveT¿n§ùiÚsInTrimRªgeMuÉiTh»ad
(è
throws
 
Exû±iÚ
 {

532 
	`runDeçuÉS”v”
();

533 
ruÁime
 = 
	`ü—‹DeçuÉRuÁime
();

535 
š™Key
 = 0;

536 
fš®
 
numD©aEÁr›s
 = 10;

539 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

540 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

542 .
	`£tSŒ—mName
("test")

543 .
	`İ’
();

546 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

547 
bË
.
	`put
(
š™Key
, 
SŒšg
.
	`v®ueOf
(initKey));

548 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

550 
š™Key
++;

552 
CouÁDownL©ch
 
couÁDownL©ch1
 = 
Ãw
 
	`CouÁDownL©ch
(1);

553 
CouÁDownL©ch
 
couÁDownL©ch2
 = 
Ãw
 
	`CouÁDownL©ch
(1);

554 
CouÁDownL©ch
 
couÁDownL©ch3
 = 
Ãw
 
	`CouÁDownL©ch
(1);

556 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(() -> {

558 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

559 
bË
.
	`put
(
numD©aEÁr›s
, 
SŒšg
.
	`v®ueOf
(numDataEntries));

560 
couÁDownL©ch1
.
	`couÁDown
();

561 
Œy
 {

562 
couÁDownL©ch2
.
	`awa™
();

563 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

564 
e
.
	`´štSckT¿û
();

570 
bË
.
	`g‘
(0);

571 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

572 
couÁDownL©ch3
.
	`couÁDown
();

574 
t
.
	`¡¬t
();

576 
couÁDownL©ch1
.
	`awa™
();

579 
i
 = 
š™Key
; i < 
numD©aEÁr›s
 - 2; i++) {

580 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

581 
bË
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

582 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

586 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

587 
mcw
.
	`addM­
(
bË
);

588 
Tok’
 
´efixTrim
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "author");

591 
i
 = 
numD©aEÁr›s
 - 2; i <‚umDataEntries; i++) {

592 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

593 
bË
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

594 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

597 
couÁDownL©ch2
.
	`couÁDown
();

598 
couÁDownL©ch3
.
	`awa™
();

601 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
´efixTrim
);

604 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

605 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

608 
	`as£¹Th©
(
bË
).
	`hasSize
(
numD©aEÁr›s
 + 1);

609 
i
 = 0; i <ğ
numD©aEÁr›s
; i++) {

610 
	`as£¹Th©
(
bË
.
	`g‘
(
i
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(i));

613 
t
.
	`još
();

629 
	`as£¹Th©
(
bË
).
	`hasSize
(
numD©aEÁr›s
 + 1);

630 
i
 = 0; i <ğ
numD©aEÁr›s
; i++) {

631 
	`as£¹Th©
(
bË
.
	`g‘
(
i
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(i));

633 
	}
}

665 @
Te¡


666 
public
 
	$‹¡RuÁimeGCW™hSŒ—mW™hNoUpd©esAá”Checkpošt
(è
throws
 
Exû±iÚ
 {

668 
	`runDeçuÉS”v”
();

669 
ruÁime
 = 
	`ü—‹RuÁimeW™hCache
();

671 
fš®
 
numD©aEÁr›s
 = 5;

674 
CÜfuTabË
<
IÁeg”
, 
SŒšg
> 
bË
 = 
ruÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

675 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

677 .
	`£tSŒ—mName
("test")

678 .
	`İ’
();

681 
i
 = 0; i < 
numD©aEÁr›s
; i++) {

682 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
).
	`bud
().
	`begš
();

683 
bË
.
	`put
(
i
, 
SŒšg
.
	`v®ueOf
(i));

684 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

688 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

689 
mcw
.
	`addM­
(
bË
);

690 
Tok’
 
´efixTrim
 = 
mcw
.
	`­³ndCheckpošts
(
ruÁime
, "author");

693 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
´efixTrim
);

696 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

697 .
	`¢­shÙ
(
Ãw
 
	`Tok’
(0,2))

698 .
	`bud
()

699 .
	`begš
();

700 
bË
.
	`g‘
(0);

701 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

704 
i
 = 0; i < 
numD©aEÁr›s
; i++) {

705 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
	`bud
().
	`begš
();

706 
	`as£¹Th©
(
bË
.
	`g‘
(
i
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(i));

707 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

711 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

714 
i
 = 0; i < 
numD©aEÁr›s
; i++) {

715 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBud
().
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
).
	`bud
().
	`begš
();

716 
	`as£¹Th©
(
bË
.
	`g‘
(
i
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(i));

717 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

734 
	`as£¹Th©
(
bË
.
	`g‘
(0)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(0));

735 
	}
}

	@test/src/test/java/org/corfudb/integration/cluster/Harness/Action.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
;

10 
ab¡¿ù
 
public
 cÏs 
	cAùiÚ
 {

12 
´Ùeùed
 
Node
 
	mnode
;

14 
public
 
ab¡¿ù
 
	$run
(è
throws
 
Exû±iÚ
 ;

	@test/src/test/java/org/corfudb/integration/cluster/Harness/Node.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

10 
public
 cÏs 
	cNode
 {

12 @
G‘‹r


13 
fš®
 
SŒšg
 
	madd»ss
;

15 @
G‘‹r


16 
SŒšg
 
	mşu¡”Add»ss
;

18 @
G‘‹r


19 
fš®
 
SŒšg
 
	mlogP©h
;

21 
fš®
 
public
 
AùiÚ
 
	mshutdown
;

23 
fš®
 
public
 
AùiÚ
 
	m¡¬t
;

25 
public
 
	$Node
(
SŒšg
 
add»ss
, SŒšg 
şu¡”Add»ss
, SŒšg 
logP©h
) {

26 
this
.
add»ss
 =‡ddress;

27 
this
.
şu¡”Add»ss
 = clusterAddress;

28 
this
.
logP©h
 =†ogPath;

29 
this
.
shutdown
 = 
Ãw
 
	`ShutdownAùiÚ
(this);

30 
this
.
¡¬t
 = 
Ãw
 
	`S¹AùiÚ
(this);

33 
public
 
	$Node
(
SŒšg
 
add»ss
, SŒšg 
logP©h
) {

34 
	`this
(
add»ss
, 
nuÎ
, 
logP©h
);

35 
	}
}

37 
public
 
SŒšg
 
	$g‘ProûssKlCommªd
() {

38 
SŒšg
 
pÜt
 = 
add»ss
.
	`¥l™
(":")[1];

39  "p aux | g»°CÜfuS”v” | g»°"+ 
pÜt
 +" |awk '{print $2}'| xargs kill -9";

40 
	}
}

	@test/src/test/java/org/corfudb/integration/cluster/Harness/ShutdownAction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
;

8 
public
 cÏs 
	cShutdownAùiÚ
 
ex‹nds
 
	mAùiÚ
 {

10 
public
 
	$ShutdownAùiÚ
(
Node
 
node
) {

11 
this
.
node
 =‚ode;

14 @
Ov”ride


15 
public
 
	$run
(è
throws
 
Exû±iÚ
 {

16 
ProûssBud”
 
bud”
 = 
Ãw
 
	`ProûssBud”
();

17 
bud”
.
	`commªd
("sh", "-c", 
node
.
	`g‘ProûssKlCommªd
());

18 
Proûss
 
p
 = 
bud”
.
	`¡¬t
();

19 
p
.
	`wa™FÜ
();

20 
	}
}

	@test/src/test/java/org/corfudb/integration/cluster/Harness/StartAction.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gşu¡”
.
	gH¬Ãss
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gAb¡¿ùIT
;

10 
public
 cÏs 
	cS¹AùiÚ
 
ex‹nds
 
	mAùiÚ
 {

12 
public
 
	$S¹AùiÚ
(
Node
 
node
) {

13 
this
.
node
 =‚ode;

16 
public
 
	$run
(è
throws
 
Exû±iÚ
 {

17 
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

18 .
	`£tHo¡
(
node
.
	`g‘Add»ss
().
	`¥l™
(":")[0])

19 .
	`£tPÜt
(
IÁeg”
.
	`v®ueOf
(
node
.
	`g‘Add»ss
().
	`¥l™
(":")[1]))

20 .
	`£tLogP©h
(
node
.
	`g‘LogP©h
())

21 .
	`£tSšgË
(
çl£
)

22 .
	`runS”v”
();

23 
	}
}

	@test/src/test/java/org/corfudb/logreplication/fsm/EmptyDataSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

13 
public
 cÏs 
	cEm±yD©aS’d”
 
im¶em’ts
 
	mD©aS’d”
 {

15 @
Ov”ride


16 
public
 
	mCom¶‘abËFutu»
<
	mLogR•liÿtiÚEÁry
> 
	$£nd
(
LogR•liÿtiÚEÁry
 
mes§ge
è{  
Ãw
 
Com¶‘abËFutu»
<>(); }

18 @
Ov”ride


19 
public
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
	`£nd
(
Li¡
<LogR•liÿtiÚEÁry> 
mes§ges
è{  
Ãw
 Com¶‘abËFutu»<>(); 
	}
}

21 @
Ov”ride


22 
public
 
	$ÚE¼Ü
(
LogR•liÿtiÚE¼Ü
 
”rÜ
è{
	}
}

	@test/src/test/java/org/corfudb/logreplication/fsm/EmptySnapshotReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—dMes§ge
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—d”
;

6 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

12 
public
 cÏs 
	cEm±ySÇpshÙR—d”
 
im¶em’ts
 
	mSÇpshÙR—d”
 {

13 @
Ov”ride


14 
public
 
SÇpshÙR—dMes§ge
 
	$»ad
(
UUID
 
¢­shÙReque¡Id
) {

15  
Ãw
 
	`SÇpshÙR—dMes§ge
(
CŞËùiÚs
.
EMPTY_LIST
, 
Œue
);

18 @
Ov”ride


19 
public
 
	$»£t
(
¢­shÙTime¡amp
) {

21 
	}
}

23 @
Ov”ride


24 
public
 
	$£tS™eEpoch
(
s™eEpoch
) {

26 
	}
}

	@test/src/test/java/org/corfudb/logreplication/fsm/LogReplicationFSMTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gDeçuÉR—dProûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogEÁryR—d”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogR•liÿtiÚEv’tM‘ad©a
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—d”
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙS’d”
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msSÇpshÙR—d”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
.
	gLogR•liÿtiÚEv’t
.
	gLogR•liÿtiÚEv’tTy³
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

26 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

27 
impÜt
 
	gjava
.
	gut
.
	gOb£rvabË
;

28 
impÜt
 
	gjava
.
	gut
.
	gOb£rv”
;

29 
impÜt
 
	gjava
.
	gut
.
	gQueue
;

30 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

31 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

32 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

34 
impÜt
 
	gjava
.
	gÏng
.
	gTh»ad
.
	g¦“p
;

35 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

40 
public
 cÏs 
	cLogR•liÿtiÚFSMTe¡
 
ex‹nds
 
Ab¡¿ùV›wTe¡
 
im¶em’ts
 
	mOb£rv”
 {

43 
´iv©e
 
fš®
 
	mNUM_ENTRIES
 = 10;

44 
´iv©e
 
fš®
 
	mLARGE_NUM_ENTRIES
 = 100;

45 
´iv©e
 
fš®
 
SŒšg
 
	mPAYLOAD_FORMAT
 = "%s hello world";

46 
´iv©e
 
fš®
 
SŒšg
 
	mTEST_STREAM_NAME
 = "StreamA";

47 
´iv©e
 
fš®
 
	mBATCH_SIZE
 = 2;

48 
´iv©e
 
fš®
 
	mWAIT_TIME
 = 100;

49 
fš®
 
UUID
 
	mPRIMARY_SITE_ID
 = UUID.
¿ndomUUID
();

50 
fš®
 
UUID
 
	mREMOTE_SITE_ID
 = UUID.
¿ndomUUID
();

53 
´iv©e
 
fš®
 
Sem­hÜe
 
	mŒªs™iÚAvaabË
 = 
Ãw
 Sem­hÜe(1, 
Œue
);

55 
´iv©e
 
Ob£rvabËV®ue
 
	mŒªs™iÚOb£rvabË
;

58 
´iv©e
 
boŞ—n
 
	mob£rveSÇpshÙSync
 = 
çl£
;

59 
´iv©e
 
	mlim™SÇpshÙMes§ges
 = 0;

60 
´iv©e
 
Ob£rvabËV®ue
 
	m¢­shÙMes§geCouÁ”Ob£rvabË
;

62 
´iv©e
 
LogR•liÿtiÚFSM
 
	mfsm
;

63 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

64 
´iv©e
 
D©aS’d”
 
	md©aS’d”
;

65 
´iv©e
 
SÇpshÙR—d”
 
	m¢­shÙR—d”
;

66 
´iv©e
 
LogEÁryR—d”
 
	mlogEÁryR—d”
;

68 @
BefÜe


69 
public
 
	$£tRuÁime
() {

70 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

71 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tCodecTy³
(
Codec
.
Ty³
.
NONE
.
	`toSŒšg
());

87 @
Te¡


88 
public
 
	$‹¡LogR•liÿtiÚFSMT¿ns™iÚs
(è
throws
 
Exû±iÚ
 {

90 
	`š™LogR•liÿtiÚFSM
(
R—d”Im¶em’tiÚ
.
EMPTY
);

93 
LogR•liÿtiÚS‹
 
š™S‹
 = 
fsm
.
	`g‘S‹
();

94 
	`as£¹Th©
(
š™S‹
.
	`g‘Ty³
()).
	`isEqu®To
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

96 
Œªs™iÚAvaabË
.
	`acquœe
();

99 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_STOP
, 
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

102 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_START
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

105 
UUID
 
¢­shÙSyncId
 = 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_REQUEST
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
, 
Œue
);

108 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_COMPLETE
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
¢­shÙSyncId
, 
çl£
);

113 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_STOP
, 
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
, 
Œue
);

114 
	}
}

127 @
Te¡


128 
public
 
	$‹¡TrimExû±iÚFSM
(è
throws
 
Exû±iÚ
 {

129 
	`š™LogR•liÿtiÚFSM
(
R—d”Im¶em’tiÚ
.
EMPTY
);

132 
Œªs™iÚAvaabË
.
	`acquœe
();

135 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_START
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

140 
	`š£¹D–ay
(
WAIT_TIME
);

144 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
, 
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
, 
UUID
.
	`¿ndomUUID
(), 
çl£
);

148 
UUID
 
logEÁrySyncID
 = 
fsm
.
	`g‘S‹s
().
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
).
	`g‘T¿ns™iÚEv’tId
();

149 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SYNC_CANCEL
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
, 
logEÁrySyncID
, 
Œue
);

150 
	}
}

152 
´iv©e
 
	$š£¹D–ay
(
timeMli£cÚds
è
throws
 
IÁ”ru±edExû±iÚ
 {

153 
	`¦“p
(
timeMli£cÚds
);

154 
	}
}

170 @
Te¡


171 
public
 
	$‹¡LogR•liÿtiÚSÇpshÙT¿nsm™‹rNoB©ch
(è
throws
 
Exû±iÚ
 {

172 
	`‹¡SÇpshÙS’d”
(
NUM_ENTRIES
);

173 
	}
}

190 @
Te¡


191 
public
 
	$‹¡LogR•liÿtiÚSÇpshÙT¿nsm™‹rB©ch
(è
throws
 
Exû±iÚ
 {

192 
	`‹¡SÇpshÙS’d”
(
BATCH_SIZE
);

193 
	}
}

195 
´iv©e
 
	$‹¡SÇpshÙS’d”
(
b©chSize
è
throws
 
Exû±iÚ
 {

198 
	`š™LogR•liÿtiÚFSM
(
R—d”Im¶em’tiÚ
.
TEST
);

201 ((
Te¡SÇpshÙR—d”
)
¢­shÙR—d”
).
	`£tB©chSize
(
b©chSize
);

204 
	`wr™eToSŒ—m
();

207 
Œªs™iÚAvaabË
.
	`acquœe
();

210 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_REQUEST
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
);

214 
numT¿ns™iÚ
 = (
NUM_ENTRIES
/(
b©chSize
* 
SÇpshÙS’d”
.
SNAPSHOT_BATCH_SIZE
)) + 1;

215 
Queue
<
LogR•liÿtiÚEÁry
> 
li¡’”Queue
 = ((
Te¡D©aS’d”
è
d©aS’d”
).
	`g‘EÁryQueue
();

218 
i
 = 0; i < 
numT¿ns™iÚ
; i++) {

219 
Sy¡em
.
out
.
	`´št
("\ÂumT¿ns™iÚ " + 
numT¿ns™iÚ
 + " i " + 
i
);

220 
Œªs™iÚAvaabË
.
	`acquœe
();

223 
	`as£¹Th©
(
fsm
.
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

224 
	`as£¹Th©
(
li¡’”Queue
.
	`size
()).
	`isEqu®To
(
NUM_ENTRIES
);

226 
i
 = 0; i < 
NUM_ENTRIES
; i++) {

227 
	`as£¹Th©
(
li¡’”Queue
.
	`pŞl
().
	`g‘Paylßd
())

228 .
	`isEqu®To
Ğ
SŒšg
.
	`fÜm©
(
PAYLOAD_FORMAT
, 
i
).
	`g‘By‹s
());

230 
	}
}

244 @
Te¡


245 
public
 
	$ÿnûlSÇpshÙSyncInProg»ssAndR‘ry
(è
throws
 
Exû±iÚ
 {

248 
ob£rveSÇpshÙSync
 = 
Œue
;

251 
	`š™LogR•liÿtiÚFSM
(
R—d”Im¶em’tiÚ
.
TEST
);

255 ((
Te¡SÇpshÙR—d”
)
¢­shÙR—d”
).
	`£tB©chSize
(
BATCH_SIZE
);

256 
lim™SÇpshÙMes§ges
 = 2;

259 
	`wr™eToSŒ—m
();

262 
Œªs™iÚAvaabË
.
	`acquœe
();

265 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_REQUEST
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
);

269 
Œªs™iÚAvaabË
.
	`acquœe
();

270 
fsm
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_STOP
));

272 
boŞ—n
 
Œªs™iÚOccu¼ed
 = 
Œue
;

273 
Œªs™iÚOccu¼ed
) {

274 ià(
fsm
.
	`g‘S‹
().
	`g‘Ty³
(è=ğ
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
) {

275 
Œªs™iÚOccu¼ed
 = 
çl£
;

279 
	`as£¹Th©
(
fsm
.
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LogR•liÿtiÚS‹Ty³
.
INITIALIZED
);

281 ((
Te¡D©aS’d”
è
d©aS’d”
).
	`»£t
();

284 
ob£rveSÇpshÙSync
 = 
çl£
;

287 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_REQUEST
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
, 
Œue
);

289 
i
 = 0; i<(
NUM_ENTRIES
/(
BATCH_SIZE
 * 
SÇpshÙS’d”
.
SNAPSHOT_BATCH_SIZE
)) + 1; i++) {

290 
Œªs™iÚAvaabË
.
	`acquœe
();

293 
	`as£¹Th©
(
fsm
.
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

295 
Queue
<
LogR•liÿtiÚEÁry
> 
li¡’”Queue
 = ((
Te¡D©aS’d”
è
d©aS’d”
).
	`g‘EÁryQueue
();

297 
	`as£¹Th©
(
li¡’”Queue
.
	`size
()).
	`isEqu®To
(
NUM_ENTRIES
);

299 
i
=0; i<
NUM_ENTRIES
; i++) {

300 
	`as£¹Th©
(
li¡’”Queue
.
	`pŞl
().
	`g‘Paylßd
())

301 .
	`isEqu®To
Ğ
SŒšg
.
	`fÜm©
(
PAYLOAD_FORMAT
, 
i
).
	`g‘By‹s
());

303 
	}
}

311 @
Te¡


312 
public
 
	$‹¡SÇpshÙSyncSŒ—mIm¶em’tiÚ
(è
throws
 
Exû±iÚ
 {

315 
	`š™LogR•liÿtiÚFSM
(
R—d”Im¶em’tiÚ
.
STREAMS
);

318 
	`wr™eToM­
();

321 
Œªs™iÚAvaabË
.
	`acquœe
();

327 
	`Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
.
SNAPSHOT_SYNC_REQUEST
, 
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
, 
Œue
);

331 
Sy¡em
.
out
.
	`´šn
("**** Wait for snapshot synco complete");

335 
i
 = 0; i<(
LARGE_NUM_ENTRIES
/(
SŒ—msSÇpshÙR—d”
.
MAX_NUM_SMR_ENTRY
* 
SÇpshÙS’d”
.
SNAPSHOT_BATCH_SIZE
)) + 1; i++) {

336 
Œªs™iÚAvaabË
.
	`acquœe
();

339 
	`as£¹Th©
(
fsm
.
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
LogR•liÿtiÚS‹Ty³
.
IN_LOG_ENTRY_SYNC
);

341 
Queue
<
LogR•liÿtiÚEÁry
> 
li¡’”Queue
 = ((
Te¡D©aS’d”
è
d©aS’d”
).
	`g‘EÁryQueue
();

343 
	`as£¹Th©
(
li¡’”Queue
.
	`size
()).
	`isEqu®To
(
LARGE_NUM_ENTRIES
/
SŒ—msSÇpshÙR—d”
.
MAX_NUM_SMR_ENTRY
);

346 
	`wr™eTxInüem’lUpd©es
();

348 
šüem’lUpd©es
 = 0;

350 
šüem’lUpd©es
 < 
NUM_ENTRIES
) {

351 ((
Te¡D©aS’d”
)
d©aS’d”
).
	`g‘EÁryQueue
().
	`pŞl
();

352 
šüem’lUpd©es
++;

355 
	`as£¹Th©
(
šüem’lUpd©es
).
	`isEqu®To
(
NUM_ENTRIES
);

356 
	}
}

358 
´iv©e
 
	$wr™eTxInüem’lUpd©es
() {

359 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

360 .
	`bud
()

361 .
	`£tSŒ—mName
(
TEST_STREAM_NAME
)

362 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

363 .
	`İ’
();

365 
i
=0; i<
NUM_ENTRIES
; i++) {

366 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

367 
m­
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

368 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

370 
	}
}

372 
´iv©e
 
	$wr™eToSŒ—m
() {

373 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
(
TEST_STREAM_NAME
.
	`g‘By‹s
());

374 
Li¡
<
Tok’Re¥Ú£
> 
wr™eTok’s
 = 
Ãw
 
A¼ayLi¡
<>();

377 
i
=0; i < 
NUM_ENTRIES
; i++) {

378 
Tok’Re¥Ú£
 
»¥Ú£
 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

379 
wr™eTok’s
.
	`add
(
»¥Ú£
);

380 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
»¥Ú£
, 
SŒšg
.
	`fÜm©
(
PAYLOAD_FORMAT
, 
i
).
	`g‘By‹s
());

384 
šdex
 = 0;

385 
Tok’Re¥Ú£
 
tok’
 : 
wr™eTok’s
) {

386 
	`as£¹Th©
(
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(()
tok’
.
	`g‘Sequ’û
()).
	`g‘Paylßd
(
	`g‘RuÁime
()))

387 .
	`isEqu®To
Ğ
SŒšg
.
	`fÜm©
(
PAYLOAD_FORMAT
, 
šdex
).
	`g‘By‹s
());

388 
šdex
++;

390 
	}
}

392 
´iv©e
 
	$wr™eToM­
() {

393 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

394 .
	`bud
()

395 .
	`£tSŒ—mName
(
TEST_STREAM_NAME
)

396 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

397 .
	`İ’
();

399 
i
=0; i<
LARGE_NUM_ENTRIES
; i++) {

400 
m­
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), String.valueOf(i));

402 
	}
}

411 
´iv©e
 
	$š™LogR•liÿtiÚFSM
(
R—d”Im¶em’tiÚ
 
»ad”Im¶
) {

413 
logEÁryR—d”
 = 
Ãw
 
	`Te¡LogEÁryR—d”
();

414 
d©aS’d”
 = 
Ãw
 
	`Te¡D©aS’d”
();

416 
»ad”Im¶
) {

417 
EMPTY
:

419 
¢­shÙR—d”
 = 
Ãw
 
	`Em±ySÇpshÙR—d”
();

420 
d©aS’d”
 = 
Ãw
 
	`Em±yD©aS’d”
();

422 
TEST
:

426 
Te¡R—d”CÚfigu¿tiÚ
 
‹¡CÚfig
 = Te¡R—d”CÚfigu¿tiÚ.
	`bud”
()

427 .
	`’dpošt
(
	`g‘DeçuÉEndpošt
())

428 .
	`numEÁr›s
(
NUM_ENTRIES
)

429 .
	`·ylßdFÜm©
(
PAYLOAD_FORMAT
)

430 .
	`¡»amName
(
TEST_STREAM_NAME
)

431 .
	`b©chSize
(
BATCH_SIZE
).
	`bud
();

433 
¢­shÙR—d”
 = 
Ãw
 
	`Te¡SÇpshÙR—d”
(
‹¡CÚfig
);

434 
d©aS’d”
 = 
Ãw
 
	`Te¡D©aS’d”
();

436 
STREAMS
:

438 
LogR•liÿtiÚCÚfig
 
logR•liÿtiÚCÚfig
 = 
Ãw
 
	`LogR•liÿtiÚCÚfig
(
CŞËùiÚs
.
	`sšgËtÚ
(
TEST_STREAM_NAME
),

439 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

440 
¢­shÙR—d”
 = 
Ãw
 
	`SŒ—msSÇpshÙR—d”
(
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
(),

441 
logR•liÿtiÚCÚfig
);

442 
d©aS’d”
 = 
Ãw
 
	`Te¡D©aS’d”
();

448 
fsm
 = 
Ãw
 
	`LogR•liÿtiÚFSM
(
ruÁime
, 
¢­shÙR—d”
, 
d©aS’d”
, 
logEÁryR—d”
,

449 
Ãw
 
	`DeçuÉR—dProûssÜ
(
ruÁime
),‚ew 
	`LogR•liÿtiÚCÚfig
(
CŞËùiÚs
.
EMPTY_SET
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
),

450 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
(
Ãw
 
	`Th»adFaùÜyBud”
().
	`£tNameFÜm©
("fsm-wÜk”").
	`bud
()));

451 
Œªs™iÚOb£rvabË
 = 
fsm
.
	`g‘NumT¿ns™iÚs
();

452 
Œªs™iÚOb£rvabË
.
	`addOb£rv”
(
this
);

454 ià(
ob£rveSÇpshÙSync
) {

455 
Sy¡em
.
out
.
	`´šn
("Observe snapshot sync");

456 
¢­shÙMes§geCouÁ”Ob£rvabË
 = ((
InSÇpshÙSyncS‹
è
fsm
.
	`g‘S‹s
()

457 .
	`g‘
(
LogR•liÿtiÚS‹Ty³
.
IN_SNAPSHOT_SYNC
)).
	`g‘SÇpshÙS’d”
().
	`g‘Ob£rvedCouÁ”
();

458 
¢­shÙMes§geCouÁ”Ob£rvabË
.
	`addOb£rv”
(
this
);

460 
	}
}

469 
´iv©e
 
UUID
 
	$Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
 
ev’tTy³
,

470 
LogR•liÿtiÚS‹Ty³
 
ex³ùedS‹
,

471 
UUID
 
ev’tId
, 
boŞ—n
 
wa™UÁEx³ùed
)

472 
throws
 
IÁ”ru±edExû±iÚ
 {

474 
Sy¡em
.
out
.
	`´šn
("In£¹ƒv’t: " + 
ev’tTy³
);

476 
LogR•liÿtiÚEv’t
 
ev’t
;

478 ià(
ev’tId
 !ğ
nuÎ
) {

481 
ev’t
 = 
Ãw
 
	`LogR•liÿtiÚEv’t
(
ev’tTy³
,‚ew 
	`LogR•liÿtiÚEv’tM‘ad©a
(
ev’tId
));

483 
ev’t
 = 
Ãw
 
	`LogR•liÿtiÚEv’t
(
ev’tTy³
);

486 
fsm
.
	`šput
(
ev’t
);

488 
Œªs™iÚAvaabË
.
	`acquœe
();

491 
wa™UÁEx³ùed
) {

492 ià(
fsm
.
	`g‘S‹
().
	`g‘Ty³
(è=ğ
ex³ùedS‹
) {

493  
ev’t
.
	`g‘Ev’tID
();

495 
Œªs™iÚAvaabË
.
	`acquœe
();

499 
	`as£¹Th©
(
fsm
.
	`g‘S‹
().
	`g‘Ty³
()).
	`isEqu®To
(
ex³ùedS‹
);

501  
ev’t
.
	`g‘Ev’tID
();

502 
	}
}

516 
´iv©e
 
UUID
 
	$Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
 
ev’tTy³
,

517 
LogR•liÿtiÚS‹Ty³
 
ex³ùedS‹
, 
boŞ—n
 
wa™UÁEx³ùed
è
throws
 
IÁ”ru±edExû±iÚ
 {

518  
	`Œªs™iÚ
(
ev’tTy³
, 
ex³ùedS‹
, 
nuÎ
, 
wa™UÁEx³ùed
);

519 
	}
}

521 
´iv©e
 
UUID
 
	$Œªs™iÚ
(
LogR•liÿtiÚEv’tTy³
 
ev’tTy³
,

522 
LogR•liÿtiÚS‹Ty³
 
ex³ùedS‹
è
throws
 
IÁ”ru±edExû±iÚ
 {

523  
	`Œªs™iÚ
(
ev’tTy³
, 
ex³ùedS‹
, 
nuÎ
, 
çl£
);

524 
	}
}

529 @
Ov”ride


530 
public
 
	$upd©e
(
Ob£rvabË
 
obs
, 
Objeù
 
¬g
) {

531 ià(
obs
 =ğ
Œªs™iÚOb£rvabË
)

533 
Œªs™iÚAvaabË
.
	`»Ëa£
();

535 } ià(
obs
 =ğ
¢­shÙMes§geCouÁ”Ob£rvabË
) {

536 ià(
lim™SÇpshÙMes§ges
 =ğ
¢­shÙMes§geCouÁ”Ob£rvabË
.
	`g‘V®ue
(è&& 
ob£rveSÇpshÙSync
) {

540 
Sy¡em
.
out
.
	`´šn
("REPLICATION STOP");

541 
fsm
.
	`šput
(
Ãw
 
	`LogR•liÿtiÚEv’t
(
LogR•liÿtiÚEv’tTy³
.
REPLICATION_STOP
));

544 
	}
}

546 
public
 
	eR—d”Im¶em’tiÚ
 {

547 
	gEMPTY
,

548 
	gTEST
,

549 
	gSTREAMS


	@test/src/test/java/org/corfudb/logreplication/fsm/ReplicationReaderWriterTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogEÁryWr™”
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚCÚfig
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gP”si¡edWr™”M‘ad©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gSŒ—msSÇpshÙWr™”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogEÁryR—d”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—dMes§ge
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msLogEÁryR—d”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSŒ—msSÇpshÙR—d”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuStÜe
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gQu”y
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabË
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTabËO±iÚs
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gTxBud”
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gO·queSŒ—m
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
;

30 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

32 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

33 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

34 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

35 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

36 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

37 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

38 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

39 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

41 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚsFÜCÏssTy³s
.
	gas£¹Th©
;

42 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gNUM_TRANSACTIONS
;

43 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gg’”©eT¿n§ùiÚs
;

44 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gİ’SŒ—ms
;

45 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	g´štTas
;

46 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	g»adLogEÁryMsgs
;

47 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gv”ifyD©a
;

48 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gv”ifyNoD©a
;

49 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gR•liÿtiÚR—d”Wr™”IT
.
	gwr™eLogEÁryMsgs
;

51 
public
 cÏs 
	cR•liÿtiÚR—d”Wr™”Te¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

52 
´iv©e
 
fš®
 
	mSTART_VAL
 = 1;

53 
fš®
 
UUID
 
	mPRIMARY_SITE_ID
 = UUID.
¿ndomUUID
();

54 
fš®
 
UUID
 
	mREMOTE_SITE_ID
 = UUID.
¿ndomUUID
();

55 
fš®
 
	mNUM_KEYS
 = 4;

57 
CÜfuRuÁime
 
	m¤cD©aRuÁime
 = 
nuÎ
;

58 
CÜfuRuÁime
 
	md¡D©aRuÁime
 = 
nuÎ
;

59 
CÜfuRuÁime
 
	m»ad”RuÁime
 = 
nuÎ
;

60 
CÜfuRuÁime
 
	mwr™”RuÁime
 = 
nuÎ
;

62 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	m¤cTabËs
 = 
Ãw
 
HashM­
<>();

63 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	md¡TabËs
 = 
Ãw
 
HashM­
<>();

64 
	mHashM­
<
	mSŒšg
, 
	mCÜfuTabË
<
	mLÚg
, LÚg>> 
	mshadowTabËs
 = 
Ãw
 
HashM­
<>();

65 
LogEÁryR—d”
 
	mlogEÁryR—d”
;

66 
LogEÁryWr™”
 
	mlogEÁryWr™”
;

71 
	mHashM­
<
	mSŒšg
, HashM­<
	mLÚg
, LÚg>> 
	mhashM­
 = 
Ãw
 
HashM­
<
SŒšg
, HashMap<Long, Long>>();

76 
	mLi¡
<
	mLogR•liÿtiÚEÁry
> 
	mmsgQ
 = 
Ãw
 
A¼ayLi¡
<
LogR•liÿtiÚEÁry
>();

78 
public
 
	$£tup
() {

79 
¤cD©aRuÁime
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

80 
¤cD©aRuÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

81 
d¡D©aRuÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

82 
»ad”RuÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

83 
wr™”RuÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

85 
UUID
 
uuid
 = UUID.
	`¿ndomUUID
();

86 
LogR•liÿtiÚCÚfig
 
cÚfig
 = 
Ãw
 
	`LogR•liÿtiÚCÚfig
(
hashM­
.
	`keyS‘
(), 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

87 
P”si¡edWr™”M‘ad©a
 
³rsi¡edWr™”M‘ad©a
 = 
Ãw
 
	`P”si¡edWr™”M‘ad©a
(
»ad”RuÁime
, 0, 
uuid
, uuid);

88 
logEÁryR—d”
 = 
Ãw
 
	`SŒ—msLogEÁryR—d”
(
»ad”RuÁime
, 
cÚfig
);

89 
logEÁryWr™”
 = 
Ãw
 
	`LogEÁryWr™”
(
wr™”RuÁime
, 
cÚfig
, 
³rsi¡edWr™”M‘ad©a
);

92 @
Te¡


93 
public
 
	$‹¡LogEÁryR•liÿtiÚ
() {

94 
	`£tup
();

96 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

97 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
hashM­
, 
R•liÿtiÚR—d”Wr™”IT
.
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, 
START_VAL
);

98 
	`´štTas
("aá” wr™šg d©¨tØ¤øbËs", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

100 
	`»adLogEÁryMsgs
(
msgQ
, 
¤cTabËs
.
	`keyS‘
(), 
»ad”RuÁime
);

102 
	`wr™eLogEÁryMsgs
(
msgQ
, 
¤cTabËs
.
	`keyS‘
(), 
wr™”RuÁime
);

103 
	`´štTas
("aá”…Ïyšg mes§g© d¡", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

104 
	`İ’SŒ—ms
(
d¡TabËs
, 
d¡D©aRuÁime
);

106 
	`v”ifyD©a
("aá” wr™šg†ogƒÁry‡ˆd¡", 
d¡TabËs
, 
hashM­
);

107 
	}
}

109 
»adMsgs
(
Li¡
<
LogR•liÿtiÚEÁry
> 
msgQ
, 
S‘
<
SŒšg
> 
¡»ams
, 
CÜfuRuÁime
 
¹
) {

110 
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
¡»ams
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

111 
SŒ—msSÇpshÙR—d”
 
	g»ad”
 = 
Ãw
 SŒ—msSÇpshÙR—d”(
¹
, 
cÚfig
);

113 
	g»ad”
.
»£t
(
¹
.
g‘Add»ssS·ûV›w
().
g‘LogTa
());

114 
	gŒue
) {

115 
SÇpshÙR—dMes§ge
 
	g¢­shÙR—dMes§ge
 = 
»ad”
.
»ad
(
UUID
.
¿ndomUUID
());

116 
	gmsgQ
.
addAÎ
(
¢­shÙR—dMes§ge
.
g‘Mes§ges
());

117 ià(
	g¢­shÙR—dMes§ge
.
isEndR—d
()) {

123 
wr™eMsgs
(
Li¡
<
LogR•liÿtiÚEÁry
> 
msgQ
, 
S‘
<
SŒšg
> 
¡»ams
, 
CÜfuRuÁime
 
¹
) {

124 
UUID
 
	guuid
 = UUID.
¿ndomUUID
();

125 
LogR•liÿtiÚCÚfig
 
	gcÚfig
 = 
Ãw
 LogR•liÿtiÚCÚfig(
¡»ams
, 
PRIMARY_SITE_ID
, 
REMOTE_SITE_ID
);

126 
P”si¡edWr™”M‘ad©a
 
	g³rsi¡edWr™”M‘ad©a
 = 
Ãw
 P”si¡edWr™”M‘ad©a(
¹
, 0, 
uuid
, uuid);

127 
SŒ—msSÇpshÙWr™”
 
	gwr™”
 = 
Ãw
 SŒ—msSÇpshÙWr™”(
¹
, 
cÚfig
, 
³rsi¡edWr™”M‘ad©a
);

129 
	gwr™”
.
»£t
(
msgQ
.
g‘
(0).
g‘M‘ad©a
().
g‘S™eEpoch
(), msgQ.g‘(0).g‘M‘ad©a().
g‘SÇpshÙTime¡amp
());

131 
LogR•liÿtiÚEÁry
 
	gmsg
 : 
msgQ
) {

132 
wr™”
.
­¶y
(
msg
);

134 
LÚg
 
	g£q
 = 
wr™”
.
g‘P”si¡edWr™”M‘ad©a
().
g‘La¡SÇpSeqNum
() + 1;

140 
	gwr™”
.
­¶yShadowSŒ—ms
(
£q
);

143 @
Te¡


144 
public
 
	$‹¡SÇpshÙR•liÿtiÚ
() {

145 
	`£tup
();

146 
	`İ’SŒ—ms
(
¤cTabËs
, 
¤cD©aRuÁime
);

148 
	`g’”©eT¿n§ùiÚs
(
¤cTabËs
, 
hashM­
, 
NUM_TRANSACTIONS
, 
¤cD©aRuÁime
, 
START_VAL
);

149 
	`´štTas
("aá” wr™šg d©¨tØ¤øbËs", 
¤cD©aRuÁime
, 
d¡D©aRuÁime
);

151 
	`»adMsgs
(
msgQ
, 
hashM­
.
	`keyS‘
(), 
»ad”RuÁime
);

154 
SŒšg
 
Çme
 : 
¤cTabËs
.
	`keyS‘
()) {

155 
CÜfuTabË
<
LÚg
, LÚg> 
bË
 = 
¤cTabËs
.
	`g‘
(
Çme
);

156 
bË
.
	`ş—r
();

159 
	`v”ifyNoD©a
(
¤cTabËs
);

161 
R•liÿtiÚR—d”Wr™”IT
.
	`wr™eSÇpLogMsgs
(
msgQ
, 
¤cTabËs
.
	`keyS‘
(), 
wr™”RuÁime
);

165 
	`İ’SŒ—ms
(
d¡TabËs
, 
d¡D©aRuÁime
);

166 
	`v”ifyD©a
("aá” wr™šg†ogƒÁry‡ˆd¡", 
d¡TabËs
, 
hashM­
);

167 
	}
}

179 @
Te¡


180 
public
 
	$‹¡UFOW™hLogUpd©e
(è
throws
 
NoSuchM‘hodExû±iÚ
, 
IÎeg®AcûssExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
 {

181 
SŒšg
 
Çme¥aû
 = "default_namespace";

182 
SŒšg
 
bËAName
 = "tableA";

183 
SŒšg
 
bËBName
 = "tableB";

184 
SŒšg
 
bËCName
 = "tableC";

187 
CÜfuRuÁime
 
ruÁime1
 = 
	`g‘DeçuÉRuÁime
().
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

188 
CÜfuStÜe
 
cÜfuStÜe1
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime1
);

190 
TabË
<
Uuid
, Uuid, Uuid> 
bËA
 = 
cÜfuStÜe1
.
	`İ’TabË
(
Çme¥aû
, 
bËAName
,

191 
Uuid
.
şass
, Uuid.şass, Uuid.şass, 
TabËO±iÚs
.
	`bud”
().
	`bud
());

193 
TabË
<
Uuid
, Uuid, Uuid> 
bËB
 = 
cÜfuStÜe1
.
	`İ’TabË
(
Çme¥aû
, 
bËBName
,

194 
Uuid
.
şass
, Uuid.şass, Uuid.şass, 
TabËO±iÚs
.
	`bud”
().
	`bud
());

196 
TabË
<
Uuid
, Uuid, Uuid> 
bËC
 = 
cÜfuStÜe1
.
	`İ’TabË
(
Çme¥aû
, 
bËCName
,

197 
Uuid
.
şass
, Uuid.şass, Uuid.şass, 
TabËO±iÚs
.
	`bud”
().
	`bud
());

199 
UUID
 
uuidA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
bËA
.
	`g‘FuÎyQu®if›dTabËName
());

200 
UUID
 
uuidB
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
bËB
.
	`g‘FuÎyQu®if›dTabËName
());

201 
UUID
 
uuidC
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
bËC
.
	`g‘FuÎyQu®if›dTabËName
());

205 
i
 = 0; i < 
NUM_KEYS
; i ++) {

206 
UUID
 
uuid
 = UUID.
	`¿ndomUUID
();

207 
Uuid
 
key
 = Uuid.
	`ÃwBud”
()

208 .
	`£tMsb
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
()).
	`£tLsb
(uuid.
	`g‘L—¡SignifiÿÁB™s
())

209 .
	`bud
();

210 
cÜfuStÜe1
.
	`tx
(
Çme¥aû
).
	`upd©e
(
bËAName
, 
key
, key, key).
	`comm™
();

214 
CÜfuRuÁime
 
ruÁime2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`£tT¿n§ùiÚLoggšg
(
Œue
).
	`cÚÃù
();

215 
CÜfuStÜe
 
cÜfuStÜe2
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime2
);

216 
TabË
<
Uuid
, Uuid, Uuid> 
bËC2
 = 
cÜfuStÜe2
.
	`İ’TabË
(
Çme¥aû
, 
bËCName
,

217 
Uuid
.
şass
, Uuid.şass, Uuid.şass, 
TabËO±iÚs
.
	`bud”
().
	`bud
());

219 
SŒ—mO±iÚs
 
İtiÚs
 = SŒ—mO±iÚs.
	`bud”
()

220 .
	`ignÜeTrimmed
(
çl£
)

221 .
	`ÿcheEÁr›s
(
çl£
)

222 .
	`bud
();

224 
SŒ—m
 
¡»amA
 = (
Ãw
 
	`O·queSŒ—m
(
ruÁime2
,„uÁime2.
	`g‘SŒ—msV›w
().

225 
	`g‘
(
uuidA
, 
İtiÚs
))).
	`¡»amUpTo
(
ruÁime2
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
());

227 
ISŒ—mV›w
 
txSŒ—m
 = 
ruÁime2
.
	`g‘SŒ—msV›w
()

228 .
	`g‘Un§ã
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
, 
SŒ—mO±iÚs
.
	`bud”
()

229 .
	`ÿcheEÁr›s
(
çl£
)

230 .
	`bud
());

231 

 = 
ruÁime2
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
();

233 
I‹¿tÜ
<
O·queEÁry
> 
™”©Ü
 = 
¡»amA
.
	`™”©Ü
();

234 
™”©Ü
.
	`hasNext
()) {

235 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe2
.
	`g‘Time¡amp
();

236 
TxBud”
 
txBud”
 = 
cÜfuStÜe2
.
	`tx
(
Çme¥aû
);

240 
UUID
 
uuid
 = UUID.
	`¿ndomUUID
();

241 
Uuid
 
key
 = Uuid.
	`ÃwBud”
()

242 .
	`£tMsb
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
()).
	`£tLsb
(uuid.
	`g‘L—¡SignifiÿÁB™s
())

243 .
	`bud
();

244 
txBud”
.
	`upd©e
(
bËCName
, 
key
, key, key);

245 
O·queEÁry
 
İaqueEÁry
 = 
™”©Ü
.
	`Ãxt
();

246  
SMREÁry
 
smrEÁry
 : 
İaqueEÁry
.
	`g‘EÁr›s
().
	`g‘
(
uuidA
)) {

247 
txBud”
.
	`logUpd©e
(
bËBName
, 
smrEÁry
);

249 
txBud”
.
	`comm™
(
time¡amp
);

253 
txSŒ—m
.
	`£ek
(

);

254 
I‹¿tÜ
<
ILogD©a
> 
™”©Ü1
 = 
txSŒ—m
.
	`¡»amUpTo
(
ruÁime2
.
	`g‘Add»ssS·ûV›w
().
	`g‘LogTa
()).
	`™”©Ü
();

255 
™”©Ü1
.
	`hasNext
()) {

256 
ILogD©a
 
d©a
 = 
™”©Ü1
.
	`Ãxt
();

257 
d©a
.
	`g‘SŒ—ms
().
	`cÚšs
(
uuidB
);

260 
Qu”y
 
q
 = 
cÜfuStÜe1
.
	`qu”y
(
Çme¥aû
);

261 
S‘
<
Uuid
> 
aS‘
 = 
q
.
	`keyS‘
(
bËAName
, 
nuÎ
);

262 
S‘
<
Uuid
> 
bS‘
 = 
q
.
	`keyS‘
(
bËBName
, 
nuÎ
);

264 
Sy¡em
.
out
.
	`´št
("\ÇS‘ " + 
aS‘
 + "\n\nbS‘ " + 
bS‘
);

265 
	`as£¹Th©
(
bS‘
.
	`cÚšsAÎ
(
aS‘
)).
	`isTrue
();

266 
	`as£¹Th©
(
aS‘
.
	`cÚšsAÎ
(
bS‘
)).
	`isTrue
();

267 
	}
}

	@test/src/test/java/org/corfudb/logreplication/fsm/TestDataSender.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gD©aS’d”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚE¼Ü
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

9 
impÜt
 
	gjava
.
	gut
.
	gLškedLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gQueue
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

18 
public
 cÏs 
	cTe¡D©aS’d”
 
im¶em’ts
 
	mD©aS’d”
 {

20 @
G‘‹r


21 
´iv©e
 
	mQueue
<
	mLogR•liÿtiÚEÁry
> 
	m’ŒyQueue
 = 
Ãw
 
LškedLi¡
<>();

23 
public
 
	$Te¡D©aS’d”
() {

26 @
Ov”ride


27 
public
 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
	$£nd
(
LogR•liÿtiÚEÁry
 
mes§ge
) {

28 ià(
mes§ge
 !ğ
nuÎ
 && mes§ge.
	`g‘Paylßd
() !=‚ull) {

29 ià(
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
().
	`equ®s
(
Mes§geTy³
.
SNAPSHOT_MESSAGE
) ||

30 
mes§ge
.
	`g‘M‘ad©a
().
	`g‘Mes§geM‘ad©aTy³
().
	`equ®s
(
Mes§geTy³
.
LOG_ENTRY_MESSAGE
)) {

32 
’ŒyQueue
.
	`add
(
mes§ge
);

36 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
cf
 = 
Ãw
 CompletableFuture<>();

37 
LogR•liÿtiÚEÁry
 
ack
 = LogR•liÿtiÚEÁry.
	`g’”©eAck
(
mes§ge
.
	`g‘M‘ad©a
());

38 
cf
.
	`com¶‘e
(
ack
);

40  
cf
;

41 
	}
}

43 @
Ov”ride


44 
public
 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
£nd
(
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
) {

46 
	gCom¶‘abËFutu»
<
	gLogR•liÿtiÚEÁry
> 
	gÏ¡S’tMes§ge
 = 
Ãw
 
Com¶‘abËFutu»
<>();

48 ià(
	gmes§ges
 !ğ
nuÎ
 && !
mes§ges
.
isEm±y
()) {

49 
Com¶‘abËFutu»
<
LogR•liÿtiÚEÁry
> 
tmp
;

51 
LogR•liÿtiÚEÁry
 
	gmes§ge
 : 
mes§ges
) {

52 
tmp
 = 
£nd
(
mes§ge
);

53 ià(
	gmes§ge
.
g‘M‘ad©a
().
g‘Mes§geM‘ad©aTy³
().
equ®s
(
Mes§geTy³
.
SNAPSHOT_END
) ||

54 
	gmes§ge
.
g‘M‘ad©a
().
g‘Mes§geM‘ad©aTy³
().
equ®s
(
Mes§geTy³
.
LOG_ENTRY_MESSAGE
)) {

55 
	gÏ¡S’tMes§ge
 = 
tmp
;

60  
	gÏ¡S’tMes§ge
;

63 
public
 
	$»£t
() {

64 
’ŒyQueue
.
	`ş—r
();

65 
	}
}

67 @
Ov”ride


68 
public
 
	$ÚE¼Ü
(
LogR•liÿtiÚE¼Ü
 
”rÜ
è{
	}
}

	@test/src/test/java/org/corfudb/logreplication/fsm/TestLogEntryReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gLogEÁryR—d”
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

11 
public
 cÏs 
	cTe¡LogEÁryR—d”
 
im¶em’ts
 
	mLogEÁryR—d”
 {

13 
public
 
	$Te¡LogEÁryR—d”
() {}

15 @
Ov”ride


16 
public
 
LogR•liÿtiÚEÁry
 
	$»ad
(
UUID
 
logEÁryReque¡Id
) {

17  
nuÎ
;

18 
	}
}

20 @
Ov”ride


21 
public
 
	$»£t
(
Ï¡S’tBa£SÇpshÙTime¡amp
, 
Ï¡AckedTime¡amp
) {

23 
	}
}

25 @
Ov”ride


26 
public
 
	$£tS™eEpoch
(
s™eEpoch
) {

28 
	}
}

	@test/src/test/java/org/corfudb/logreplication/fsm/TestReaderConfiguration.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	glombok
.
	gBud”
;

4 
impÜt
 
	glombok
.
	gD©a
;

5 
impÜt
 
	glombok
.
	gS‘‹r
;

11 @
	gBud”


12 @
D©a


13 
public
 cÏs 
	cTe¡R—d”CÚfigu¿tiÚ
 {

15 
´iv©e
 
	mnumEÁr›s
;

17 
´iv©e
 
SŒšg
 
	m·ylßdFÜm©
;

19 
´iv©e
 
SŒšg
 
	m’dpošt
;

21 
´iv©e
 
SŒšg
 
	m¡»amName
;

24 @
S‘‹r


25 
´iv©e
 
	mb©chSize
;

	@test/src/test/java/org/corfudb/logreplication/fsm/TestSnapshotReader.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	gfsm
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁry
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gLogR•liÿtiÚEÁryM‘ad©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	glog»¶iÿtiÚ
.
	gMes§geTy³
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—dMes§ge
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	glog»¶iÿtiÚ
.
	g£nd
.
	gSÇpshÙR—d”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

20 
public
 cÏs 
	cTe¡SÇpshÙR—d”
 
im¶em’ts
 
	mSÇpshÙR—d”
 {

21 
	ms™eEpoch
 = 0;

23 
fš®
 
	mFIRST_ADDRESS
 = 0;

25 
´iv©e
 
Te¡R—d”CÚfigu¿tiÚ
 
	mcÚfig
;

28 
´iv©e
 
	mglob®Index
 = 
FIRST_ADDRESS
;

30 
´iv©e
 
CÜfuRuÁime
 
	mruÁime
;

32 
public
 
	$Te¡SÇpshÙR—d”
(
Te¡R—d”CÚfigu¿tiÚ
 
cÚfig
) {

33 
this
.
cÚfig
 = config;

34 
this
.
ruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
cÚfig
.
	`g‘Endpošt
()).
	`cÚÃù
();

37 @
Ov”ride


38 
public
 
SÇpshÙR—dMes§ge
 
	$»ad
(
UUID
 
¢­shÙReque¡Id
) {

40 
Li¡
<
LogR•liÿtiÚEÁry
> 
mes§ges
 = 
Ãw
 
A¼ayLi¡
<>();

43 
i
ğ
glob®Index
; i < (
cÚfig
.
	`g‘NumEÁr›s
(è+ 
FIRST_ADDRESS
) ; i++) {

44 
Objeù
 
d©a
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(()
i
).
	`g‘Paylßd
(runtime);

47 
LogR•liÿtiÚEÁryM‘ad©a
 
m‘ad©a
 = 
Ãw
 
	`LogR•liÿtiÚEÁryM‘ad©a
(
Mes§geTy³
.
SNAPSHOT_MESSAGE
, 
s™eEpoch
,

48 
¢­shÙReque¡Id
, 
i
, 
cÚfig
.
	`g‘NumEÁr›s
(), 
UUID
.
	`¿ndomUUID
());

49 
mes§ges
.
	`add
(
Ãw
 
	`LogR•liÿtiÚEÁry
(
m‘ad©a
, (
by‹
[])
d©a
));

50 
glob®Index
++;

53  
Ãw
 
	`SÇpshÙR—dMes§ge
(
mes§ges
, 
glob®Index
 =ğ(
cÚfig
.
	`g‘NumEÁr›s
(è+ 
FIRST_ADDRESS
));

54 
	}
}

56 @
Ov”ride


57 
public
 
	$»£t
(
¢­shÙTime¡amp
) {

58 
glob®Index
 = 
FIRST_ADDRESS
;

59 
	}
}

61 @
Ov”ride


62 
public
 
	$£tS™eEpoch
(
s™eEpoch
) {

63 
this
.
s™eEpoch
 = siteEpoch;

64 
	}
}

66 
public
 
	$£tB©chSize
(
b©chSize
) {

67 
cÚfig
.
	`£tB©chSize
(
b©chSize
);

68 
	}
}

	@test/src/test/java/org/corfudb/protocols/logprotocol/LogEntryTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gCu¡omS”Ÿliz”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

19 
public
 cÏs 
	cLogEÁryTe¡
 {

21 @
Te¡


22 
public
 
	$£ekToEndSMREÁry
 () {

26 
SMREÁry
 
smr1
 = 
Ãw
 
	`SMREÁry
("m‘hod",‚ew 
Objeù
[]{}, 
S”Ÿliz”s
.
PRIMITIVE
);

27 
SMREÁry
 
smr2
 = 
Ãw
 
	`SMREÁry
("m‘hod",‚ew 
Objeù
[]{"¬g1"}, 
S”Ÿliz”s
.
PRIMITIVE
);

29 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`bufãr
();

31 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
smr1
, 
buf
);

32 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
smr2
, 
buf
);

34 
SMREÁry
.
	`£ekToEnd
(
buf
);

35 
SMREÁry
 
»cov”edEÁry
 = (SMREÁryè
S”Ÿliz”s
.
CORFU
.
	`de£rŸlize
(
buf
, 
nuÎ
);

36 
	`as£¹Th©
(
»cov”edEÁry
).
	`isEqu®To
(
smr2
);

37 
buf
.
	`»£tR—d”Index
();

38 
»cov”edEÁry
 = (
SMREÁry
è
S”Ÿliz”s
.
CORFU
.
	`de£rŸlize
(
buf
, 
nuÎ
);

39 
	`as£¹Th©
(
»cov”edEÁry
).
	`isEqu®To
(
smr1
);

42 
buf
.
	`»£tR—d”Index
();

43 
SMREÁry
.
	`£ekToEnd
(
buf
);

44 
SMREÁry
.
	`£ekToEnd
(
buf
);

45 
	`as£¹Th©
(
buf
.
	`»ad”Index
()).
	`isEqu®To
(buf.
	`wr™”Index
());

48 @
Te¡


49 
public
 
	$£ekToEndMuÉiSMREÁry
() {

53 
SMREÁry
 
smr1
 = 
Ãw
 
	`SMREÁry
("m‘hod",‚ew 
Objeù
[]{}, 
S”Ÿliz”s
.
PRIMITIVE
);

54 
SMREÁry
 
smr2
 = 
Ãw
 
	`SMREÁry
("m‘hod",‚ew 
Objeù
[]{"¬g1"}, 
S”Ÿliz”s
.
PRIMITIVE
);

55 
MuÉiSMREÁry
 
muÉiSMR1
 = 
Ãw
 
	`MuÉiSMREÁry
();

56 
MuÉiSMREÁry
 
muÉiSMR2
 = 
Ãw
 
	`MuÉiSMREÁry
();

58 
muÉiSMR1
.
	`addTo
(
smr1
);

59 
muÉiSMR1
.
	`addTo
(
smr1
);

60 
muÉiSMR2
.
	`addTo
(
smr2
);

62 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`bufãr
();

64 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
muÉiSMR1
, 
buf
);

65 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
muÉiSMR2
, 
buf
);

67 
MuÉiSMREÁry
.
	`£ekToEnd
(
buf
);

68 
MuÉiSMREÁry
 
»cov”edMuÉiSMR
 = (MuÉiSMREÁryè
S”Ÿliz”s
.
CORFU
.
	`de£rŸlize
(
buf
, 
nuÎ
);

69 
	`as£¹Th©
(
»cov”edMuÉiSMR
).
	`isEqu®To
(
muÉiSMR2
);

70 
buf
.
	`»£tR—d”Index
();

71 
»cov”edMuÉiSMR
 = (
MuÉiSMREÁry
è
S”Ÿliz”s
.
CORFU
.
	`de£rŸlize
(
buf
, 
nuÎ
);

72 
	`as£¹Th©
(
»cov”edMuÉiSMR
).
	`isEqu®To
(
muÉiSMR1
);

75 
buf
.
	`»£tR—d”Index
();

76 
MuÉiSMREÁry
.
	`£ekToEnd
(
buf
);

77 
MuÉiSMREÁry
.
	`£ekToEnd
(
buf
);

78 
	`as£¹Th©
(
buf
.
	`»ad”Index
()).
	`isEqu®To
(buf.
	`wr™”Index
());

79 
	}
}

81 @
Te¡


82 
public
 
	$‹¡LazyDe£rŸliz©iÚ
() {

89 
MuÉiObjeùSMREÁry
 
muÉiObjSmrEÁry
 = 
Ãw
 
	`MuÉiObjeùSMREÁry
();

91 
UUID
 
id1
 = UUID.
	`¿ndomUUID
();

92 
UUID
 
id2
 = UUID.
	`¿ndomUUID
();

94 
SMREÁry
 
upd©e1
 = 
Ãw
 
	`SMREÁry
("m‘hod1",‚ew 
Objeù
[]{"¬g1"}, 
S”Ÿliz”s
.
PRIMITIVE
);

96 
IS”Ÿliz”
 
cu¡omS”Ÿliz”
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
((
by‹
)(
S”Ÿliz”s
.
SYSTEM_SERIALIZERS_COUNT
 + 2));

98 
SMREÁry
 
upd©e2
 = 
Ãw
 
	`SMREÁry
("m‘hod2",‚ew 
Objeù
[]{"¬g1"}, 
cu¡omS”Ÿliz”
);

100 
muÉiObjSmrEÁry
.
	`addTo
(
id1
, 
upd©e1
);

101 
muÉiObjSmrEÁry
.
	`addTo
(
id2
, 
upd©e2
);

103 
fš®
 
’ŒyAdd»ss
 = 5;

106 
By‹Buf
 
buf
 = 
UÅoŞed
.
	`bufãr
();

107 
muÉiObjSmrEÁry
.
	`£rŸlize
(
buf
);

109 
MuÉiObjeùSMREÁry
 
de£rŸlizedEÁry
 = (MuÉiObjeùSMREÁryè
LogEÁry
.
	`de£rŸlize
(
buf
, 
nuÎ
);

110 
de£rŸlizedEÁry
.
	`£tGlob®Add»ss
(
’ŒyAdd»ss
);

113 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mBufãrs
()).
	`cÚšsOÆyKeys
(
id1
, 
id2
);

117 
Li¡
<
SMREÁry
> 
¡»am1Upd©es
 = 
de£rŸlizedEÁry
.
	`g‘SMRUpd©es
(
id1
);

118 
	`as£¹Th©
(
¡»am1Upd©es
).
	`cÚšsExaùly
(
upd©e1
);

119 
¡»am1Upd©es
.
	`¡»am
().
	`fÜEach
(
’Œy
 -> 
	`as£¹Th©
ÓÁry.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
’ŒyAdd»ss
));

121 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mBufãrs
()).
	`cÚšsOÆyKeys
(
id2
);

122 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mUpd©es
()).
	`cÚšsOÆyKeys
(
id1
);

126 
	`as£¹Th©ThrownBy
((è-> 
de£rŸlizedEÁry
.
	`g‘SMRUpd©es
(
id2
)).
	`isIn¡ªûOf
(
S”Ÿliz”Exû±iÚ
.
şass
);

127 
	`as£¹Th©ThrownBy
(
de£rŸlizedEÁry
::
g‘EÁryM­
).
	`isIn¡ªûOf
(
S”Ÿliz”Exû±iÚ
.
şass
);

128 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mBufãrs
()).
	`cÚšsOÆyKeys
(
id2
);

129 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mUpd©es
()).
	`cÚšsOÆyKeys
(
id1
);

132 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”
);

134 
Li¡
<
SMREÁry
> 
¡»am2Upd©es
 = 
de£rŸlizedEÁry
.
	`g‘SMRUpd©es
(
id2
);

135 
	`as£¹Th©
(
¡»am2Upd©es
).
	`cÚšsExaùly
(
upd©e2
);

136 
¡»am2Upd©es
.
	`¡»am
().
	`fÜEach
(
’Œy
 -> 
	`as£¹Th©
ÓÁry.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
’ŒyAdd»ss
));

138 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mBufãrs
()).
	`isEm±y
();

139 
	`as£¹Th©
(
de£rŸlizedEÁry
.
	`g‘SŒ—mUpd©es
()).
	`cÚšsOÆyKeys
(
id1
, 
id2
);

143 
M­
<
UUID
, 
MuÉiSMREÁry
> 
®lUpd©es
 = 
de£rŸlizedEÁry
.
	`g‘EÁryM­
();

144 
	`as£¹Th©
(
®lUpd©es
).
	`cÚšsOÆyKeys
(
id1
, 
id2
);

146 
MuÉiSMREÁry
 
muÉiSMREÁry1
 = 
®lUpd©es
.
	`g‘
(
id1
);

147 
	`as£¹Th©
(
muÉiSMREÁry1
.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
’ŒyAdd»ss
);

148 
	`as£¹Th©
(
muÉiSMREÁry1
.
	`g‘Upd©es
()).
	`isEqu®To
(
A¼ays
.
	`asLi¡
(
upd©e1
));

149 
muÉiSMREÁry1
.
	`g‘Upd©es
().
	`¡»am
().
	`fÜEach
(
’Œy
 -> 
	`as£¹Th©
ÓÁry.
	`g‘Glob®Add»ss
())

150 .
	`isEqu®To
(
’ŒyAdd»ss
));

152 
MuÉiSMREÁry
 
muÉiSMREÁry2
 = 
®lUpd©es
.
	`g‘
(
id2
);

153 
	`as£¹Th©
(
muÉiSMREÁry2
.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
’ŒyAdd»ss
);

154 
	`as£¹Th©
(
muÉiSMREÁry2
.
	`g‘Upd©es
()).
	`isEqu®To
(
A¼ays
.
	`asLi¡
(
upd©e2
));

155 
muÉiSMREÁry2
.
	`g‘Upd©es
().
	`¡»am
().
	`fÜEach
(
’Œy
 -> 
	`as£¹Th©
ÓÁry.
	`g‘Glob®Add»ss
())

156 .
	`isEqu®To
(
’ŒyAdd»ss
));

157 
	}
}

	@test/src/test/java/org/corfudb/protocols/wireprotocol/TokenTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

7 
public
 cÏs 
	cTok’Te¡
 {

9 @
Te¡


10 
public
 
	$tok’Com·risiÚTe¡
() {

12 
Tok’
 
unš™Ÿlized
 = Tok’.
UNINITIALIZED
;

13 
Tok’
 
a
 = 
Ãw
 
	`Tok’
(0, 0);

14 
Tok’
 
a2
 = 
Ãw
 
	`Tok’
(0, 0);

15 
Tok’
 
b
 = 
Ãw
 
	`Tok’
(0, 1);

18 
	`as£¹Th©
(
unš™Ÿlized
.
	`com·»To
(
a
)).
	`isEqu®To
(-1);

19 
	`as£¹Th©
(
a
.
	`com·»To
(
a2
)).
	`isEqu®To
(0);

20 
	`as£¹Th©
(
a2
.
	`com·»To
(
b
)).
	`isEqu®To
(-1);

21 
	`as£¹Th©
(
b
.
	`com·»To
(
a
)).
	`isEqu®To
(1);

23 
	}
}

	@test/src/test/java/org/corfudb/runtime/CompressionTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”
.
	gRunW™h
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gruÂ”s
.
	gP¬am‘”ized
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

23 @
	$RunW™h
(
P¬am‘”ized
.
şass
)

24 
public
 cÏs 
	cCom´essiÚTe¡
 
ex‹nds
 
Ab¡¿ùV›wTe¡
 {

26 
´iv©e
 
SŒšg
 
codec
;

27 
´iv©e
 
fš®
 
by‹
[] 
DEFAULT_PAYLOAD
 = "·ylßd".
	`g‘By‹s
();

29 
public
 
	$Com´essiÚTe¡
(
SŒšg
 
codecTy³
) {

30 
this
.
codec
 = 
codecTy³
;

34 @
P¬am‘”ized
.
P¬am‘”s


35 
public
 
CŞËùiÚ
 
	$šput
() {

36  
SŒ—m
.
	`of
(
Codec
.
Ty³
.
	`v®ues
())

37 .
	`m­
(
Codec
.
Ty³
::
Çme
)

38 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

39 
	}
}

41 @
BefÜe


42 
public
 
	$š™Ÿlize
() {

44 
	`addSšgËS”v”
(
SERVERS
.
PORT_0
);

45 
	}
}

47 
´iv©e
 
CÜfuRuÁime
 
	$g‘RuÁimeW™hCodec
(
SŒšg
 
codecTy³
) {

49 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
();

50 
¹
.
	`g‘P¬am‘”s
().
	`£tCodecTy³
(
codecTy³
);

51 
¹
.
	`cÚÃù
();

52  
¹
;

53 
	}
}

55 
´iv©e
 
	$wr™eDeçuÉPaylßd
(
CÜfuRuÁime
 
¹
) {

57 
Tok’Re¥Ú£
 
tok’Re¥Ú£
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

58 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
tok’Re¥Ú£
, 
DEFAULT_PAYLOAD
);

60  
tok’Re¥Ú£
.
	`g‘Sequ’û
();

61 
	}
}

63 
´iv©e
 
Objeù
 
	$»ad
(
CÜfuRuÁime
 
¹
, 
add»ss
) {

65 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

66 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

69  
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
add»ss
)

70 .
	`g‘Paylßd
(
¹
);

71 
	}
}

73 
´iv©e
 
	gLi¡
<
	gSŒšg
> 
	$g‘R—d”sCodec
(
SŒšg
 
codec
) {

74  
SŒ—m
.
	`of
(
Codec
.
Ty³
.
	`v®ues
())

75 .
	`m­
(
Codec
.
Ty³
::
Çme
)

76 .
	`f‹r
(
ty³
 ->y³ !ğ
codec
)

77 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

78 
	}
}

84 @
Te¡


85 
public
 
	$‹¡EndToEndCom´essiÚ
() {

87 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁimeW™hCodec
(
codec
);

88 
add»ss
 = 
	`wr™eDeçuÉPaylßd
(
¹
);

91 
	`as£¹Th©
(
	`»ad
(
¹
, 
add»ss
)).
	`isEqu®To
(
DEFAULT_PAYLOAD
);

92 
	}
}

98 @
Te¡


99 
public
 
	$‹¡EndToEndCom´essiÚDifã»ÁCodec
() {

101 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁimeW™hCodec
(
codec
);

102 
add»ss
 = 
	`wr™eDeçuÉPaylßd
(
¹
);

105 
Li¡
<
SŒšg
> 
codecs
 = 
	`g‘R—d”sCodec
(
codec
);

108 
SŒšg
 
»ad”Codec
 : 
codecs
) {

109 
CÜfuRuÁime
 
»ad”Rt
 = 
	`g‘RuÁimeW™hCodec
(
»ad”Codec
);

110 
	`as£¹Th©
(
	`»ad
(
»ad”Rt
, 
add»ss
)).
	`isEqu®To
(
DEFAULT_PAYLOAD
);

112 
	}
}

118 @
Te¡


119 
public
 
	$‹¡IÁ”ËavedCom´es£dEÁr›s
() {

120 
Li¡
<
LÚg
> 
add»s£s
 = 
Ãw
 
A¼ayLi¡
<>();

122 
	`šput
().
	`¡»am
().
	`fÜEach
(
codecTy³
 -> {

123 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁimeW™hCodec
(
codecTy³
.
	`toSŒšg
());

124 
add»s£s
.
	`add
(
	`wr™eDeçuÉPaylßd
(
¹
));

127 
	`as£¹Th©
(
add»s£s
.
	`size
()).
	`isEqu®To
(
Codec
.
Ty³
.
	`v®ues
().
Ëngth
);

129 
CÜfuRuÁime
 
»ad”Rt
 = 
	`g‘RuÁimeW™hCodec
(
codec
);

130 
add»s£s
.
	`fÜEach
(
add»ss
 -> 
	`as£¹Th©
(
	`»ad
(
»ad”Rt
,‡dd»ss)).
	`isEqu®To
(
DEFAULT_PAYLOAD
));

131 
	}
}

	@test/src/test/java/org/corfudb/runtime/CorfuRuntimeTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gSy¡emUÇvaabËE¼Ü
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuIÁ”ru±edE¼Ü
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

19 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

24 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

25 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

31 
public
 cÏs 
	cCÜfuRuÁimeTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

32 
fš®
 
	mTIME_TO_WAIT_FOR_LAYOUT_IN_SEC
 = 5;

33 
fš®
 
	mTIMEOUT_CORFU_RUNTIME_IN_MS
 = 500;

40 @
BefÜe


41 
public
 
	$£tDeçuÉRuÁimeG‘Rou‹rFunùiÚ
() {

42 
CÜfuRuÁime
.
ov”rideG‘Rou‹rFunùiÚ
 =

43 (
ruÁime
, 
’dpošt
è-> 
su³r
.
	`g‘Rou‹rFunùiÚ
(runtime,ƒndpoint);

46 @
Te¡


47 
public
 
	$checkV®idLayout
(è
throws
 
Exû±iÚ
 {

49 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

54 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LARGE
, (
v
) -> {

55 
¹
.
	`šv®id©eLayout
();

59 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LARGE
, (
v
) -> {

60 
	`as£¹Th©
(
¹
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘RuÁime
()).
	`isEqu®To
(rt);

63 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_TWO
, PARAMETERS.
TIMEOUT_LONG
);

65 
	}
}

71 @
Te¡


72 
public
 
	$š‹¼u±edFÏgS‘
() {

73 
Œy
 {

74 
throw
 
Ãw
 
	`UÄecov”abËCÜfuIÁ”ru±edE¼Ü
Òew 
	`IÁ”ru±edExû±iÚ
());

75 } 
	`ÿtch
 (
UÄecov”abËCÜfuIÁ”ru±edE¼Ü
 
ok
) {

76 
As£¹iÚs
.
	`as£¹Th©
(
Th»ad
.
	`cu¼’tTh»ad
().
	`isIÁ”ru±ed
()).
	`isTrue
();

78 
	}
}

80 @
Te¡


81 
public
 
	$ÿnIn¡ªtŸ‹RuÁimeW™houtTe¡Ref
(è
throws
 
Exû±iÚ
 {

83 
	`addSšgËS”v”
(
SERVERS
.
PORT_0
);

85 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
());

86 
¹
.
	`cÚÃù
();

88 
	}
}

97 
´iv©e
 
Layout
 
	$g‘3NodeLayout
(è
throws
 
Exû±iÚ
 {

98 
	`addS”v”
(
SERVERS
.
PORT_0
);

99 
	`addS”v”
(
SERVERS
.
PORT_1
);

100 
	`addS”v”
(
SERVERS
.
PORT_2
);

101 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

102 .
	`£tEpoch
(1L)

103 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

104 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

105 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

106 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

107 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

108 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

109 .
	`budSegm’t
()

110 .
	`budSŒe
()

111 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

112 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

113 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

114 .
	`addToSegm’t
()

115 .
	`addToLayout
()

116 .
	`bud
();

118 
	`boÙ¡¿pAÎS”v”s
(
l
);

121 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

122 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

123 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

125  
l
;

126 
	}
}

139 @
Te¡


140 
public
 
	$dÛsNÙUpd©eToLayoutW™hSm®ËrEpoch
(è
throws
 
Exû±iÚ
 {

142 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
(
	`g‘3NodeLayout
()).
	`cÚÃù
();

145 
Layout
 
cu¼’tLayout
 = 
Ãw
 
	`Layout
(
¹
.
	`g‘LayoutV›w
().
	`g‘Cu¼’tLayout
());

146 
cu¼’tLayout
.
	`£tEpoch
(cu¼’tLayout.
	`g‘Epoch
() + 1);

147 
¹
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
cu¼’tLayout
).
	`£®MšS”v”S‘
();

150 
	`addCl›ÁRuË
(
¹
, 
SERVERS
.
ENDPOINT_2
,

151 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

154 
¹
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
cu¼’tLayout
, 0);

156 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_2
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
()).
	`isEqu®To
(1);

159 
¹
.
	`g‘Rou‹r
(
SERVERS
.
ENDPOINT_2
).
	`£tTimeoutRe¥Ú£
(1);

162 
¹
.
	`šv®id©eLayout
();

163 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
();

166 
	`ş—rCl›ÁRuËs
(
¹
);

167 
¹
.
	`g‘Rou‹r
(
SERVERS
.
ENDPOINT_2
).
	`£tTimeoutRe¥Ú£
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
());

171 
	`addCl›ÁRuË
(
¹
, 
SERVERS
.
ENDPOINT_0
,

172 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

173 
	`addCl›ÁRuË
(
¹
, 
SERVERS
.
ENDPOINT_1
,

174 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

176 
¹
.
	`g‘Rou‹r
(
SERVERS
.
ENDPOINT_0
).
	`£tTimeoutRe¥Ú£
(1);

177 
¹
.
	`g‘Rou‹r
(
SERVERS
.
ENDPOINT_1
).
	`£tTimeoutRe¥Ú£
(1);

180 
¹
.
	`šv®id©eLayout
();

183 
Com¶‘abËFutu»
 
cf
 = 
CFUts
.
	`w™hš
(
¹
.
Ïyout
, 
Du¿tiÚ
.
	`ofSecÚds
(
TIME_TO_WAIT_FOR_LAYOUT_IN_SEC
));

184 
Com¶‘abËFutu»
.
	`suµlyAsync
((è-> 
cf
);

186 
	`as£¹Th©ThrownBy
((è-> 
cf
.
	`g‘
()).
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
).
	`hasRoÙCau£In¡ªûOf
(
TimeoutExû±iÚ
.class);

187 
	}
}

190 @
Te¡


191 
public
 
	$dÛsNÙAÎowR—dsAá”S—lAndBefÜeNewLayout
(è
throws
 
Exû±iÚ
 {

192 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
().
	`£tCacheDi§bËd
(
Œue
).
	`cÚÃù
();

194 
Layout
 
l
 = 
Te¡LayoutBud”
.
	`sšgË
(0);

195 
	`boÙ¡¿pAÎS”v”s
(
l
);

197 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

198 
sv
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

200 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

201 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

205 
ruÁime
.
	`šv®id©eLayout
();

207 
LogUn™Cl›Á
 
luc
 = 
ruÁime


208 .
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
);

210 
	`as£¹Th©ThrownBy
((è-> 
luc
.
	`»ad
(0).
	`g‘
())

211 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

212 .
	`hasRoÙCau£In¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

213 
	}
}

223 @
Te¡


224 
public
 
	$cu¡omN‘wÜkExû±iÚHªdËr
(è
throws
 
Exû±iÚ
 {

225 şas 
	cTimeoutHªdËr
 {

226 
CÜfuRuÁime
 
¹
;

227 
maxTimeout
;

228 
Th»adLoÿl
<
LÚg
> 
loÿlTimeS¹
 = 
Ãw
 ThreadLocal<>();

230 
	`TimeoutHªdËr
(
CÜfuRuÁime
 
¹
, 
maxTimeout
) {

231 
this
.
¹
 =„t;

232 
this
.
maxTimeout
 = maxTimeout;

235 
	`¡¬tTimeout
() {

236 
loÿlTimeS¹
.
	`£t
(
Sy¡em
.
	`cu¼’tTimeMlis
());

239 
	`checkIfTimeout
() {

240 ià(
Sy¡em
.
	`cu¼’tTimeMlis
(è- 
loÿlTimeS¹
.
	`g‘
(è> 
maxTimeout
) {

241 
	`¡İRuÁimeAndThrowExû±iÚ
();

245 
	`¡İRuÁimeAndThrowExû±iÚ
() {

246 
¹
.
	`¡İ
();

247 
throw
 
Ãw
 
	`Sy¡emUÇvaabËE¼Ü
("Timeouˆ" + 
maxTimeout
 + "ƒlapsed");

251 
	`addSšgËS”v”
(
SERVERS
.
PORT_0
);

253 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

254 
TimeoutHªdËr
 
th
 = 
Ãw
 
	`TimeoutHªdËr
(
ruÁime
, 
TIMEOUT_CORFU_RUNTIME_IN_MS
);

255 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tBefÜeRpcHªdËr
(
th
::
¡¬tTimeout
);

256 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tSy¡emDownHªdËr
(
th
::
checkIfTimeout
);

257 
ruÁime
.
	`cÚÃù
();

259 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

260 
sv
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

262 
	`simuÏ‹EndpoštDiscÚÃùed
(
ruÁime
);

264 
	`as£¹Th©ThrownBy
((è-> 
sv
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
())).

265 
	`isIn¡ªûOf
(
Sy¡emUÇvaabËE¼Ü
.
şass
);

266 
	}
}

	@test/src/test/java/org/corfudb/runtime/checkpoint/CPSerializer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcheckpošt
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚBud”
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufIÅutSŒ—m
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufOuutSŒ—m
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

12 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

13 
impÜt
 
	gjava
.
	gio
.
	gIÅutSŒ—mR—d”
;

14 
impÜt
 
	gjava
.
	gio
.
	gOuutSŒ—mWr™”
;

15 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gTy³
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

21 
public
 cÏs 
	cCPS”Ÿliz”
 
im¶em’ts
 
	mIS”Ÿliz”
 {

22 
GsÚBud”
 
	mgsÚBud”
 = 
Ãw
 GsonBuilder();

23 
GsÚ
 
	mgsÚ
 = 
gsÚBud”
.
ü—‹
();

25 
´iv©e
 
fš®
 
by‹
 
	mty³
;

27 
public
 
	$CPS”Ÿliz”
(
by‹
 
ty³
) {

28 
this
.
ty³
 =ype;

31 
public
 
by‹
 
	$g‘Ty³
() {

32  
ty³
;

33 
	}
}

35 
public
 
Objeù
 
	$de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

36 
Ty³
 
m­Ty³
 = 
Ãw
 
Ty³Tok’
<
M­
<
SŒšg
, 
LÚg
>>(){}.
	`g‘Ty³
();

38 
şassNameL’gth
 = 
b
.
	`»adShÜt
();

39 
by‹
[] 
şassNameBy‹s
 = 
Ãw
 by‹[
şassNameL’gth
];

40 
b
.
	`»adBy‹s
(
şassNameBy‹s
, 0, 
şassNameL’gth
);

41 
SŒšg
 
şassName
 = 
Ãw
 
	`SŒšg
(
şassNameBy‹s
);

42 
boŞ—n
 
isM­
 = 
çl£
;

44 ià(
şassName
.
	`equ®s
("null")) {

45  
nuÎ
;

46 } ià(
şassName
.
	`’dsW™h
("HashMap")) {

47 
isM­
 = 
Œue
;

50 
	`Œy
 (
By‹BufIÅutSŒ—m
 
bbis
 = 
Ãw
 
	`By‹BufIÅutSŒ—m
(
b
)) {

51 
	`Œy
 (
IÅutSŒ—mR—d”
 
r
 = 
Ãw
 
	`IÅutSŒ—mR—d”
(
bbis
)) {

52 ià(
isM­
) {

53  
gsÚ
.
	`äomJsÚ
(
r
, 
m­Ty³
);

55  
gsÚ
.
	`äomJsÚ
(
r
, 
CÏss
.
	`fÜName
(
şassName
));

58 } 
	`ÿtch
 (
IOExû±iÚ
 | 
CÏssNÙFoundExû±iÚ
 
e
) {

59 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

61 
	}
}

63 
public
 
	$£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

64 
SŒšg
 
şassName
 = 
o
 =ğ
nuÎ
 ? "nuÎ" : o.
	`g‘CÏss
().
	`g‘Name
();

65 
by‹
[] 
şassNameBy‹s
 = 
şassName
.
	`g‘By‹s
();

66 
b
.
	`wr™eShÜt
(
şassNameBy‹s
.
Ëngth
);

67 
b
.
	`wr™eBy‹s
(
şassNameBy‹s
);

68 ià(
o
 =ğ
nuÎ
) {

71 
	`Œy
 (
By‹BufOuutSŒ—m
 
bbos
 = 
Ãw
 
	`By‹BufOuutSŒ—m
(
b
)) {

72 
	`Œy
 (
OuutSŒ—mWr™”
 
osw
 = 
Ãw
 
	`OuutSŒ—mWr™”
(
bbos
)) {

73 
gsÚ
.
	`toJsÚ
(
o
, 
osw
);

75 } 
	`ÿtch
 (
IOExû±iÚ
 
e
) {

76 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

78 
	}
}

	@test/src/test/java/org/corfudb/runtime/checkpoint/CheckpointSmokeTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcheckpošt
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

8 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gBiCÚsum”
;

14 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gCheckpoštEÁry
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiSMREÁry
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCheckpoštWr™”
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gAdd»ssM­SŒ—mV›w
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gBackpoš‹rSŒ—mV›w
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

35 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

42 
public
 cÏs 
	cCheckpoštSmokeTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

43 
fš®
 
by‹
 
	m£riz”By‹
 = (byte) 20;

44 
IS”Ÿliz”
 
	m£rŸliz”
 = 
Ãw
 
CPS”Ÿliz”
(
£riz”By‹
);

45 
public
 
CÜfuRuÁime
 
	mr
;

47 @
BefÜe


48 
public
 
	$£tRuÁime
(è
throws
 
Exû±iÚ
 {

50 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

51 
r
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

54 @
Te¡


55 
public
 
	$‹¡Em±yM­CP
(è
throws
 
Exû±iÚ
 {

56 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

57 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

58 .
	`£tSŒ—mName
("Map1")

59 .
	`İ’
();

61 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

62 
mcw
.
	`addM­
(
m­
);

65 
add»ss
 = 
mcw
.
	`­³ndCheckpošts
(
r
, "A1").
	`g‘Sequ’û
();

66 
	`as£¹Th©
(
add»ss
).
	`isEqu®To
(0L);

69 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("S1"));

70 
fš®
 
objSize
 = 100;

71 
a1
 = 
sv
.
	`­³nd
(
Ãw
 
by‹
[
objSize
]);

73 
fš®
 
ıEndAdd»ss
 = 3L;

75 
	`as£¹Th©
(
a1
).
	`isEqu®To
(
ıEndAdd»ss
);

77 
LogEÁry
 
ıS¹
 = (
CheckpoštEÁry
è
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(1L)

78 .
	`g‘Paylßd
(
r
);

79 
	`as£¹Th©
(((
CheckpoštEÁry
è
ıS¹
).
	`g‘Diù
()

80 .
	`g‘
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
)).
	`isEqu®To
("0");

81 
	}
}

105 @
Te¡


106 
public
 
	$smoke1Te¡
(è
throws
 
Exû±iÚ
 {

107 
fš®
 
SŒšg
 
¡»amName
 = "mystream";

108 
fš®
 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
);

109 
fš®
 
SŒšg
 
key1
 = "key1";

110 
fš®
 
key1V®
 = 42;

111 
fš®
 
SŒšg
 
key2
 = "key2";

112 
fš®
 
key2V®
 = 4242;

113 
fš®
 
SŒšg
 
key3
 = "key3";

114 
fš®
 
key3V®
 = 4343;

116 
fš®
 
SŒšg
 
key7
 = "key7";

117 
fš®
 
key7V®
 = 7777;

118 
fš®
 
SŒšg
 
key8
 = "key8";

119 
fš®
 
key8V®
 = 88;

120 
fš®
 
UUID
 
checkpoštId
 = UUID.
	`¿ndomUUID
();

121 
fš®
 
SŒšg
 
checkpoštAuthÜ
 = "Hey, it's me!";

124 
M­
<
SŒšg
, 
LÚg
> 
m
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

125 
m
.
	`put
(
key1
, 
key1V®
);

126 
m
.
	`put
(
key2
, 
key2V®
);

129 
	`wr™eCheckpoštRecÜds
(
¡»amId
, 
checkpoštAuthÜ
, 
checkpoštId
,

130 
Ãw
 
Objeù
[]{Ãw Objeù[]{
key8
, 
key8V®
},‚ew Objeù[]{
key7
, 
key7V®
}});

133 
m
.
	`put
(
key3
, 
key3V®
);

134 
	`as£¹Th©
(
m
.
	`g‘
(
key1
)).
	`isEqu®To
(
key1V®
);

135 
	`as£¹Th©
(
m
.
	`g‘
(
key2
)).
	`isEqu®To
(
key2V®
);

136 
	`as£¹Th©
(
m
.
	`g‘
(
key3
)).
	`isEqu®To
(
key3V®
);

137 
	`as£¹Th©
(
m
.
	`g‘
(
key7
)).
	`isNuÎ
();

138 
	`as£¹Th©
(
m
.
	`g‘
(
key8
)).
	`isNuÎ
();

141 
	`£tRuÁime
();

142 
M­
<
SŒšg
, 
LÚg
> 
m2
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

143 
	`as£¹Th©
(
m2
.
	`g‘
(
key1
)).
	`isNuÎ
();

144 
	`as£¹Th©
(
m2
.
	`g‘
(
key2
)).
	`isNuÎ
();

145 
	`as£¹Th©
(
m2
.
	`g‘
(
key3
)).
	`isEqu®To
(
key3V®
);

146 
	`as£¹Th©
(
m2
.
	`g‘
(
key7
)).
	`isEqu®To
(
key7V®
);

147 
	`as£¹Th©
(
m2
.
	`g‘
(
key8
)).
	`isEqu®To
(
key8V®
);

148 
	}
}

175 @
Te¡


176 
public
 
	$smoke2Te¡
(è
throws
 
Exû±iÚ
 {

177 
fš®
 
SŒšg
 
¡»amName
 = "mystream2";

178 
fš®
 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
);

179 
fš®
 
UUID
 
checkpoštId
 = UUID.
	`¿ndomUUID
();

180 
fš®
 
SŒšg
 
checkpoštAuthÜ
 = "Marty McFly";

181 
fš®
 
SŒšg
 
keyP»fixFœ¡
 = "first";

182 
fš®
 
SŒšg
 
keyP»fixMiddË1
 = "middle1";

183 
fš®
 
SŒšg
 
keyP»fixMiddË2
 = "middle2";

184 
fš®
 
SŒšg
 
keyP»fixLa¡
 = "last";

185 
fš®
 
numKeys
 = 4;

186 
fš®
 
SŒšg
 
key7
 = "key7";

187 
fš®
 
key7V®
 = 7777;

188 
fš®
 
SŒšg
 
key8
 = "key8";

189 
fš®
 
key8V®
 = 88;

190 
CÚsum”
<
M­
<
SŒšg
, 
LÚg
>> 
‹¡As£¹iÚs
 = (
m­
) -> {

191 
i
 = 0; i < 
numKeys
; i++) {

192 
	`as£¹Th©
(
m­
.
	`g‘
(
keyP»fixFœ¡
 + 
IÁeg”
.
	`toSŒšg
(
i
))).
	`isNuÎ
();

193 
	`as£¹Th©
(
m­
.
	`g‘
(
keyP»fixMiddË1
 + 
IÁeg”
.
	`toSŒšg
(
i
))).
	`isEqu®To
(i);

194 
	`as£¹Th©
(
m­
.
	`g‘
(
keyP»fixMiddË2
 + 
IÁeg”
.
	`toSŒšg
(
i
))).
	`isEqu®To
(i);

195 
	`as£¹Th©
(
m­
.
	`g‘
(
keyP»fixLa¡
 + 
IÁeg”
.
	`toSŒšg
(
i
))).
	`isEqu®To
(i);

197 
	`as£¹Th©
(
m­
.
	`g‘
(
key7
)).
	`isEqu®To
(
key7V®
);

198 
	`as£¹Th©
(
m­
.
	`g‘
(
key8
)).
	`isEqu®To
(
key8V®
);

201 
M­
<
SŒšg
, 
LÚg
> 
m
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

202 
i
 = 0; i < 
numKeys
; i++) {

203 
m
.
	`put
(
keyP»fixFœ¡
 + 
IÁeg”
.
	`toSŒšg
(
i
), () i);

206 
	`wr™eCheckpoštRecÜds
(
¡»amId
, 
checkpoštAuthÜ
, 
checkpoštId
,

207 
Ãw
 
Objeù
[]{Ãw Objeù[]{
key8
, 
key8V®
},‚ew Objeù[]{
key7
, 
key7V®
}},

208 (è-> { 
i
 = 0; i < 
numKeys
; i++è{ 
m
.
	`put
(
keyP»fixMiddË1
 + 
IÁeg”
.
	`toSŒšg
(i), () i); } },

209 (è-> { 
i
 = 0; i < 
numKeys
; i++è{ 
m
.
	`put
(
keyP»fixMiddË2
 + 
IÁeg”
.
	`toSŒšg
(i), () i); } },

210 
Œue
,rue,rue);

211 
i
 = 0; i < 
numKeys
; i++) {

212 
m
.
	`put
(
keyP»fixLa¡
 + 
IÁeg”
.
	`toSŒšg
(
i
), () i);

215 
	`£tRuÁime
();

216 
M­
<
SŒšg
, 
LÚg
> 
m2
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

217 
‹¡As£¹iÚs
.
	`acû±
(
m2
);

222 
fš®
 
UUID
 
checkpoštId2
 = UUID.
	`¿ndomUUID
();

223 
fš®
 
SŒšg
 
checkpoštAuthÜ2
 = "Incomplete 2";

224 
	`wr™eCheckpoštRecÜds
(
¡»amId
, 
checkpoštAuthÜ2
, 
checkpoštId2
,

225 
Ãw
 
Objeù
[]{Ãw Objeù[]{
key8
, 
key8V®
*2},‚ew Objeù[]{
key7
, 
key7V®
*2}},

226 (è-> {}, (è-> {}, 
Œue
,rue, 
çl£
);

228 
	`£tRuÁime
();

229 
M­
<
SŒšg
, 
LÚg
> 
m3
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

230 
‹¡As£¹iÚs
.
	`acû±
(
m3
);

231 
	}
}

235 @
Te¡


236 
public
 
	$checkpoštWr™”Te¡
(è
throws
 
Exû±iÚ
 {

237 
fš®
 
SŒšg
 
¡»amName
 = "mystream4";

238 
fš®
 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
);

239 
fš®
 
SŒšg
 
keyP»fix
 = "a-prefix";

240 
fš®
 
numKeys
 = 5;

241 
fš®
 
SŒšg
 
authÜ
 = "Me, myself,‡nd I";

242 
fš®
 
LÚg
 
fudgeFaùÜ
 = 75L;

243 
fš®
 
sm®lB©chSize
 = 4;

245 
SŒ—mšgM­
<
SŒšg
, 
LÚg
> 
m
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

246 
i
 = 0; i < 
numKeys
; i++) {

247 
m
.
	`put
(
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
), () i);

258 
m
.
	`put
("just one more", 0L);

262 
CheckpoštWr™”
 
ıw
 = 
Ãw
 
	`CheckpoštWr™”
(
	`g‘RuÁime
(), 
¡»amId
, 
authÜ
, (
CÜfuTabË
è
m
);

263 
ıw
.
	`£tS”Ÿliz”
(
£rŸliz”
);

264 
ıw
.
	`£tV®ueMutÜ
((
l
è-> (
LÚg
èÈ+ 
fudgeFaùÜ
);

265 
ıw
.
	`£tB©chSize
(
sm®lB©chSize
);

268 
r
.
	`g‘ObjeùsV›w
().
	`TXBud
()

269 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

270 .
	`bud
()

271 .
	`begš
();

272 
Tok’
 
¢­shÙ
 = 
T¿n§ùiÚ®CÚ‹xt


273 .
	`g‘Cu¼’tCÚ‹xt
()

274 .
	`g‘SÇpshÙTime¡amp
();

275 
Œy
 {

276 
ıw
.
	`¡¬tCheckpošt
(
¢­shÙ
);

277 
ıw
.
	`­³ndObjeùS‹
(
m
.
	`’ŒySŒ—m
());

278 
ıw
.
	`fšishCheckpošt
();

282 
	`£tRuÁime
();

283 
M­
<
SŒšg
, 
LÚg
> 
m2
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

284 
i
 = 0; i < 
numKeys
; i++) {

285 
	`as£¹Th©
(
m2
.
	`g‘
(
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
))).
	`desüibedAs
("get " + i)

286 .
	`isEqu®To
(
i
 + 
fudgeFaùÜ
);

288 } 
fš®ly
 {

289 
r
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

291 
	}
}

293 
	gmiddËT¿ck”
;

324 @
Te¡


325 
public
 
	$checkpoštWr™”IÁ”ËavedTe¡
(è
throws
 
Exû±iÚ
 {

326 
fš®
 
SŒšg
 
¡»amName
 = "mystream3";

327 
fš®
 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
);

328 
fš®
 
SŒšg
 
keyP»fixFœ¡
 = "first";

329 
fš®
 
SŒšg
 
keyP»fixMiddË
 = "middle";

330 
fš®
 
SŒšg
 
keyP»fixLa¡
 = "last";

331 
fš®
 
numKeys
 = 3;

332 
fš®
 
SŒšg
 
authÜ
 = "Me, myself,‡nd I";

333 
M­
<
SŒšg
,
LÚg
> 
¢­shÙ
 = 
Ãw
 
HashM­
<>();

335 
Li¡
<
M­
<
SŒšg
,
LÚg
>> 
hi¡Üy
 = 
Ãw
 
A¼ayLi¡
<>();

337 
BiCÚsum”
<
SŒšg
,
LÚg
> 
§veHi¡
 = ((
k
, 
v
) -> {

338 
¢­shÙ
.
	`put
(
k
, 
v
);

339 
hi¡Üy
.
	`add
(
ImmubËM­
.
	`cİyOf
(
¢­shÙ
));

343 
M­
<
SŒšg
, 
LÚg
> 
m
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

344 
i
 = 0; i < 
numKeys
; i++) {

345 
SŒšg
 
key
 = 
keyP»fixFœ¡
 + 
IÁeg”
.
	`toSŒšg
(
i
);

346 
m
.
	`put
(
key
, (è
i
);

347 
§veHi¡
.
	`acû±
(
key
, (è
i
);

351 
middËT¿ck”
 = -1;

352 
CheckpoštWr™”
<
CÜfuTabË
> 
ıw
 = 
Ãw
 
	`CheckpoštWr™”
(
	`g‘RuÁime
(), 
¡»amId
, 
authÜ
, (CÜfuTabËè
m
);

353 
ıw
.
	`£tS”Ÿliz”
(
£rŸliz”
);

354 
ıw
.
	`£tB©chSize
(1);

355 
ıw
.
	`£tPo¡Aµ’dFunc
((
ı
, 
pos
) -> {

357 
hi¡Üy
.
	`add
(
ImmubËM­
.
	`cİyOf
(
¢­shÙ
));

359 ià(
ı
.
	`g‘CpTy³
(è=ğ
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
CONTINUATION
) {

360 ià(
middËT¿ck”
 < 0) {

361 
middËT¿ck”
 = 0;

363 
SŒšg
 
k
 = 
keyP»fixMiddË
 + 
LÚg
.
	`toSŒšg
(
middËT¿ck”
);

366 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(() -> {

367 
m
.
	`put
(
k
, 
middËT¿ck”
);

368 
§veHi¡
.
	`acû±
(
k
, 
middËT¿ck”
);

370 
t
.
	`¡¬t
();

371 
Œy
 { 
t
.
	`još
(); } 
	`ÿtch
 (
Exû±iÚ
 
e
è{ 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(e); }

372 
middËT¿ck”
++;

377 
hi¡Üy
.
	`add
(
ImmubËM­
.
	`cİyOf
(
¢­shÙ
));

380 
Tok’
 
ıTok’
 = 
ıw
.
	`­³ndCheckpošt
();

385 
¡¬tAdd»ss
 = 
ıTok’
.
	`g‘Sequ’û
() + 1;

386 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
¡¬tAdd»ss
).
	`g‘CheckpoštTy³
())

387 .
	`isEqu®To
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
START
);

388 
fš®
 
cÚtRecÜdff£t
 = 
¡¬tAdd»ss
 + 1;

389 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
cÚtRecÜdff£t
).
	`g‘CheckpoštTy³
())

390 .
	`isEqu®To
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
CONTINUATION
);

391 
fš®
 
cÚt2RecÜdff£t
 = 
¡¬tAdd»ss
 + 3;

392 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
cÚt2RecÜdff£t
).
	`g‘CheckpoštTy³
())

393 .
	`isEqu®To
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
CONTINUATION
);

394 
fš®
 
cÚt3RecÜdff£t
 = 
¡¬tAdd»ss
 + 5;

395 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
cÚt3RecÜdff£t
).
	`g‘CheckpoštTy³
())

396 .
	`isEqu®To
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
CONTINUATION
);

397 
fš®
 
fšishRecÜd1Off£t
 = 
¡¬tAdd»ss
 + 7;

398 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
fšishRecÜd1Off£t
).
	`g‘CheckpoštTy³
())

399 .
	`isEqu®To
(
CheckpoštEÁry
.
CheckpoštEÁryTy³
.
END
);

402 
i
 = 0; i < 
numKeys
; i++) {

403 
SŒšg
 
key
 = 
keyP»fixLa¡
 + 
IÁeg”
.
	`toSŒšg
(
i
);

404 
m
.
	`put
(
key
, (è
i
);

405 
§veHi¡
.
	`acû±
(
key
, (è
i
);

410 
glob®Addr
 = 0; glob®Add¸< 
hi¡Üy
.
	`size
(); globalAddr++) {

411 
M­
<
SŒšg
,
LÚg
> 
ex³ùedHi¡Üy
;

412 ià(
glob®Addr
 <ğ
¡¬tAdd»ss
) {

415 
ex³ùedHi¡Üy
 = 
hi¡Üy
.
	`g‘
((è
¡¬tAdd»ss
);

417 
ex³ùedHi¡Üy
 = 
hi¡Üy
.
	`g‘
(
glob®Addr
);

421 
	`£tRuÁime
();

422 
M­
<
SŒšg
, 
LÚg
> 
m2
 = 
	`š¡ªtŸ‹M­
(
¡»amName
);

425 ià(
glob®Addr
 < 
¡¬tAdd»ss
 - 1) {

426 
fš®
 
thisAdd»ss
 = 
glob®Addr
;

427 
Œy
 {

428 
Tok’
 
ts
 = 
Ãw
 
	`Tok’
(0L, 
thisAdd»ss
);

429 
r
.
	`g‘ObjeùsV›w
().
	`TXBud
()

430 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

431 .
	`¢­shÙ
(
ts
)

432 .
	`bud
()

433 .
	`begš
();

434 
m2
.
	`size
();

435 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

436 
	`ç
();

437 } 
fš®ly
 {

438 
r
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

442 
Tok’
 
ts
 = 
Ãw
 
	`Tok’
(0L, 
glob®Addr
);

443 
r
.
	`g‘ObjeùsV›w
().
	`TXBud
()

444 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

445 .
	`¢­shÙ
(
ts
)

446 .
	`bud
()

447 .
	`begš
();

449 
	`as£¹Th©
(
m2
.
	`’ŒyS‘
())

450 .
	`desüibedAs
("SÇpshÙ‡ˆglob®†og‡dd»s " + 
glob®Addr
 + 1)

451 .
	`isEqu®To
(
ex³ùedHi¡Üy
.
	`’ŒyS‘
());

452 
r
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

455 
	}
}

457 
´iv©e
 
	gSŒ—mšgM­
<
	gSŒšg
, 
	gLÚg
> 
	$š¡ªtŸ‹M­
(
SŒšg
 
¡»amName
) {

458 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
£rŸliz”
);

459  
r
.
	`g‘ObjeùsV›w
()

460 .
	`bud
()

461 .
	`£tSŒ—mName
(
¡»amName
)

462 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
LÚg
>>() {})

463 .
	`£tS”Ÿliz”
(
£rŸliz”
)

464 .
	`İ’
();

465 
	}
}

467 
´iv©e
 
	$wr™eCheckpoštRecÜds
(
UUID
 
¡»amId
, 
SŒšg
 
checkpoštAuthÜ
, UUID 
checkpoštId
,

468 
Objeù
[] 
objeùs
)

469 
throws
 
Exû±iÚ
 {

470 
RuÂabË
 
l
 = () -> {};

471 
	`wr™eCheckpoštRecÜds
(
¡»amId
, 
checkpoštAuthÜ
, 
checkpoštId
, 
objeùs
,

472 
l
,†, 
Œue
,rue,rue);

473 
	}
}

475 
	g¡¬tAdd»ss
;

477 
´iv©e
 
	$wr™eCheckpoštRecÜds
(
UUID
 
¡»amId
, 
SŒšg
 
checkpoštAuthÜ
, UUID 
checkpoštId
,

478 
Objeù
[] 
objeùs
, 
RuÂabË
 
l1
, RuÂabË 
l2
,

479 
boŞ—n
 
wr™e1
, boŞ—À
wr™e2
, boŞ—À
wr™e3
)

480 
throws
 
Exû±iÚ
 {

481 
fš®
 
UUID
 
checkpoštSŒ—mID
 = 
CÜfuRuÁime
.
	`g‘CheckpoštSŒ—mIdFromId
(
¡»amId
);

482 
ISŒ—mV›w
 
sv
;

483 ià(
r
.
	`g‘P¬am‘”s
().
	`isFŞlowBackpoš‹rsEÇbËd
()) {

484 
sv
 = 
Ãw
 
	`Backpoš‹rSŒ—mV›w
(
r
, 
checkpoštSŒ—mID
);

486 
sv
 = 
Ãw
 
	`Add»ssM­SŒ—mV›w
(
r
, 
checkpoštSŒ—mID
);

488 
M­
<
CheckpoštEÁry
.
CheckpoštDiùKey
, 
SŒšg
> 
mdKV
 = 
Ãw
 
HashM­
<>();

489 
mdKV
.
	`put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_TIME
, "The…erfectime");

492 ià(
wr™e1
) {

493 
addr1
 = 
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amId
);

494 
mdKV
.
	`put
(
CheckpoštEÁry
.
CheckpoštDiùKey
.
START_LOG_ADDRESS
, 
LÚg
.
	`toSŒšg
(
addr1
 + 1));

495 
CheckpoštEÁry
 
ı1
 = 
Ãw
 
	`CheckpoštEÁry
(CheckpoštEÁry.
CheckpoštEÁryTy³
.
START
,

496 
checkpoštAuthÜ
, 
checkpoštId
, 
¡»amId
, 
mdKV
, 
nuÎ
);

497 
¡¬tAdd»ss
 = 
sv
.
	`­³nd
(
ı1
, 
nuÎ
,‚ull);

501 
l1
.
	`run
();

504 ià(
wr™e2
) {

505 
MuÉiSMREÁry
 
smrEÁr›s
 = 
Ãw
 
	`MuÉiSMREÁry
();

506 ià(
objeùs
 !ğ
nuÎ
) {

507 
i
 = 0; i < 
objeùs
.
Ëngth
; i++) {

508 
smrEÁr›s
.
	`addTo
(
Ãw
 
	`SMREÁry
("put", (
Objeù
[]è
objeùs
[
i
], 
£rŸliz”
));

511 
CheckpoštEÁry
 
ı2
 = 
Ãw
 
	`CheckpoštEÁry
(CheckpoštEÁry.
CheckpoštEÁryTy³
.
CONTINUATION
,

512 
checkpoštAuthÜ
, 
checkpoštId
, 
¡»amId
, 
mdKV
, 
smrEÁr›s
);

513 
sv
.
	`­³nd
(
ı2
, 
nuÎ
,‚ull);

517 
l2
.
	`run
();

520 ià(
wr™e3
) {

521 
CheckpoštEÁry
 
ı3
 = 
Ãw
 
	`CheckpoštEÁry
(CheckpoštEÁry.
CheckpoštEÁryTy³
.
END
,

522 
checkpoštAuthÜ
, 
checkpoštId
, 
¡»amId
, 
mdKV
, 
nuÎ
);

523 
sv
.
	`­³nd
(
ı3
, 
nuÎ
,‚ull);

525 
	}
}

527 @
Te¡


528 
public
 
	$MuÉiCheckpoštWr™”2Te¡
(è
throws
 
Exû±iÚ
 {

529 
	`MuÉiCheckpoštWr™”Te¡IÂ”
(
Œue
);

531 
	`MuÉiCheckpoštWr™”Te¡IÂ”
(
çl£
);

532 
	}
}

534 
public
 
	$MuÉiCheckpoštWr™”Te¡IÂ”
(
boŞ—n
 
cÚ£cutiveCkpošts
è
throws
 
Exû±iÚ
 {

536 
fš®
 
SŒšg
 
¡»amNameA
 = "my¡»am5A" + 
cÚ£cutiveCkpošts
;

537 
fš®
 
SŒšg
 
¡»amNameB
 = "my¡»am5B" + 
cÚ£cutiveCkpošts
;

538 
fš®
 
SŒšg
 
keyP»fix
 = "first";

539 
fš®
 
numKeys
 = 10;

540 
fš®
 
SŒšg
 
authÜ
 = "Me, myself,‡nd I";

543 
M­
<
SŒšg
, 
LÚg
> 
mA
 = 
	`š¡ªtŸ‹M­
(
¡»amNameA
);

544 
M­
<
SŒšg
, 
LÚg
> 
mB
 = 
	`š¡ªtŸ‹M­
(
¡»amNameB
);

545 
j
 = 0; j < 2*2; j++) {

546 
i
 = 0; i < 
numKeys
; i++) {

547 
SŒšg
 
key
 = "A" + 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
);

548 
mA
.
	`put
(
key
, (è
i
);

549 
key
 = "B" + 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
);

550 
mB
.
	`put
(
key
, (è
i
);

553 
mA
.
	`put
("one more", 1L);

554 
mB
.
	`put
("one more", 1L);

556 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

557 
mcw1
.
	`addM­
((
CÜfuTabË
è
mA
);

558 
mcw1
.
	`addM­
((
CÜfuTabË
è
mB
);

559 
fœ¡Glob®Add»ss1
 = 
mcw1
.
	`­³ndCheckpošts
(
r
, 
authÜ
).
	`g‘Sequ’û
();

560 
	`as£¹Th©
(
fœ¡Glob®Add»ss1
).
	`isG»©”Thª
(-1);

562 
	`£tRuÁime
();

566 ià(
cÚ£cutiveCkpošts
) {

567 
mA
.
	`put
("one more", 1L);

568 
mB
.
	`put
("one more", 1L);

571 
MuÉiCheckpoštWr™”
 
mcw2
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

572 
mcw2
.
	`addM­
((
CÜfuTabË
è
mA
);

573 
mcw2
.
	`addM­
((
CÜfuTabË
è
mB
);

574 
fœ¡Glob®Add»ss2
 = 
mcw2
.
	`­³ndCheckpošts
(
r
, 
authÜ
).
	`g‘Sequ’û
();

575 
	`as£¹Th©
(
fœ¡Glob®Add»ss2
).
	`isG»©”ThªOrEqu®To
(
fœ¡Glob®Add»ss1
);

577 
	`£tRuÁime
();

578 
M­
<
SŒšg
, 
LÚg
> 
m2A
 = 
	`š¡ªtŸ‹M­
(
¡»amNameA
);

579 
M­
<
SŒšg
, 
LÚg
> 
m2B
 = 
	`š¡ªtŸ‹M­
(
¡»amNameB
);

580 
i
 = 0; i < 
numKeys
; i++) {

581 
SŒšg
 
keyA
 = "A" + 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
);

582 
SŒšg
 
keyB
 = "B" + 
keyP»fix
 + 
IÁeg”
.
	`toSŒšg
(
i
);

583 
	`as£¹Th©
(
m2A
.
	`g‘
(
keyA
)).
	`isEqu®To
(
i
);

584 
	`as£¹Th©
(
m2B
.
	`g‘
(
keyB
)).
	`isEqu®To
(
i
);

586 
	}
}

588 @
Te¡


589 
public
 
	$em±yCheckPošt
(è
throws
 
Exû±iÚ
 {

590 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

591 
fš®
 
SŒšg
 
¡»amB
 = "streamB";

592 
M­
<
SŒšg
, 
LÚg
> 
mA
 = 
	`š¡ªtŸ‹M­
(
¡»amA
);

593 
M­
<
SŒšg
, 
LÚg
> 
mB
 = 
	`š¡ªtŸ‹M­
(
¡»amB
);

594 
fš®
 
SŒšg
 
authÜ
 = "CPWriter";

595 
fš®
 
™”
 = 1000;

597 
x
 = 0; x < 
™”
; x++) {

598 
mA
.
	`put
(
IÁeg”
.
	`toSŒšg
(
x
), () x);

599 
mB
.
	`put
(
IÁeg”
.
	`toSŒšg
(
x
), () x);

602 
SŒšg
 
key
 : 
mA
.
	`keyS‘
()) {

603 
mA
.
	`»move
(
key
);

606 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

607 
mcw1
.
	`addM­
((
CÜfuTabË
è
mA
);

608 
mcw1
.
	`addM­
((
CÜfuTabË
è
mB
);

609 
Tok’
 
ŒimAdd»ss
 = 
mcw1
.
	`­³ndCheckpošts
(
r
, 
authÜ
);

611 
r
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimAdd»ss
);

612 
r
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

613 
r
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

614 
r
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

616 
CÜfuRuÁime
 
¹2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

618 
M­
<
SŒšg
, 
LÚg
> 
mA2
 = 
¹2
.
	`g‘ObjeùsV›w
()

619 .
	`bud
()

620 .
	`£tSŒ—mName
(
¡»amA
)

621 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
LÚg
>>() {

623 .
	`£tS”Ÿliz”
(
£rŸliz”
)

624 .
	`İ’
();

626 
¹2
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

627 
mA2
.
	`put
("a", 2l);

628 
¹2
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

629 
	}
}

643 @
Te¡


644 
public
 
	$‹¡UnÜd”edCheckpošts
(è
throws
 
Exû±iÚ
 {

645 
fš®
 
numEÁr›s
 = 25;

646 
fš®
 
¢­shÙAdd»ss1
 = 10;

647 
fš®
 
¢­shÙAdd»ss2
 = 15;

650 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

651 
SŒ—mšgM­
<
SŒšg
, 
LÚg
> 
mA
 = 
	`š¡ªtŸ‹M­
(
¡»amA
);

654 
i
 = 0; i < 
numEÁr›s
; i++) {

655 
mA
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), () i);

659 
CheckpoštWr™”
 
ıw2
 = 
Ãw
 
	`CheckpoštWr™”
(
r
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
), "checkpoš‹r-2", 
mA
);

660 
Tok’
 
ı2Tok’
 = 
ıw2
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss2
 - 1));

663 
CheckpoštWr™”
 
ıw1
 = 
Ãw
 
	`CheckpoštWr™”
(
r
, 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amA
), "checkpoš‹r-1", 
mA
);

664 
ıw1
.
	`­³ndCheckpošt
(
Ãw
 
	`Tok’
(0, 
¢­shÙAdd»ss1
 - 1));

667 
r
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ı2Tok’
);

670 
CÜfuRuÁime
 
¹2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

671 
M­
<
SŒšg
, 
LÚg
> 
mA2
 = 
¹2
.
	`g‘ObjeùsV›w
()

672 .
	`bud
()

673 .
	`£tSŒ—mName
(
¡»amA
)

674 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
LÚg
>>() {

676 .
	`£tS”Ÿliz”
(
£rŸliz”
)

677 .
	`İ’
();

681 
¹2
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

682 
mA2
.
	`put
("a", 1l);

683 
¹2
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

685 
	`as£¹Th©
(
mA2
).
	`hasSize
(
numEÁr›s
 + 1);

686 
	}
}

695 @
Te¡


696 
public
 
	$‹¡CheckpoštTok’Prog»s£sFÜNÚWr™‹nSŒ—ms
(è
throws
 
Exû±iÚ
 {

697 
fš®
 
numEÁr›s
 = 5;

700 
fš®
 
SŒšg
 
¡»amA
 = "streamA";

701 
SŒ—mšgM­
<
SŒšg
, 
LÚg
> 
mA
 = 
	`š¡ªtŸ‹M­
(
¡»amA
);

704 
fš®
 
SŒšg
 
¡»amB
 = "streamB";

705 
SŒ—mšgM­
<
SŒšg
, 
LÚg
> 
mB
 = 
	`š¡ªtŸ‹M­
(
¡»amB
);

708 
i
 = 0; i < 
numEÁr›s
; i++) {

709 
mA
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), () i);

713 
i
 = 0; i < 
numEÁr›s
; i++) {

714 
mB
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), () i);

718 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

719 
mcw1
.
	`addM­
(
mA
);

720 
mcw1
.
	`addM­
(
mB
);

721 
Tok’
 
mšSÇpshÙ1
 = 
mcw1
.
	`­³ndCheckpošts
(
r
, "test-author");

725 
i
 = 
numEÁr›s
; i <‚umEntries*2; i++) {

726 
mB
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), () i);

731 
MuÉiCheckpoštWr™”
 
mcw2
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

732 
mcw2
.
	`addM­
(
mA
);

733 
mcw2
.
	`addM­
(
mB
);

734 
Tok’
 
mšSÇpshÙ2
 = 
mcw2
.
	`­³ndCheckpošts
(
r
, "test-author");

736 
	`as£¹Th©
(
mšSÇpshÙ2
).
	`isG»©”Thª
(
mšSÇpshÙ1
);

737 
	}
}

	@test/src/test/java/org/corfudb/runtime/checkpoint/CheckpointTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcheckpošt
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gI‹¿bËs
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gI‹¿tÜs
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

9 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

10 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

16 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

17 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

19 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gP”si¡edSŒ—mšgM­
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gAb¡¿ùObjeùTe¡
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuV”siÚPŞicy
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

37 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

38 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

43 @
Slf4j


44 
public
 cÏs 
	cCheckpoštTe¡
 
ex‹nds
 
	mAb¡¿ùObjeùTe¡
 {

46 
	mM­
<
	mSŒšg
, 
	mLÚg
> 
	$İ’M­
(
CÜfuRuÁime
 
¹
, 
SŒšg
 
m­Name
) {

47 
fš®
 
by‹
 
£rŸliz”By‹
 = (byte) 20;

48 
IS”Ÿliz”
 
£rŸliz”
 = 
Ãw
 
	`CPS”Ÿliz”
(
£rŸliz”By‹
);

49 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
£rŸliz”
);

50  (
CÜfuTabË
<
SŒšg
, 
LÚg
>)

51 
	`š¡ªtŸ‹CÜfuObjeù
(

52 
¹
,

53 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
LÚg
>>() {

55 
m­Name
,

56 
£rŸliz”
);

59 @
BefÜe


60 
public
 
	$š¡ªtŸ‹M­s
() {

61 
	`g‘DeçuÉRuÁime
();

62 
	}
}

64 
fš®
 
SŒšg
 
	g¡»amNameA
 = "mystreamA";

65 
fš®
 
SŒšg
 
	g¡»amNameB
 = "mystreamB";

66 
fš®
 
SŒšg
 
	gauthÜ
 = "ckpointTest";

68 
´iv©e
 
CÜfuRuÁime
 
	$g‘NewRuÁime
() {

69  
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

70 
	}
}

75 
	$m­Ckpošt
(
CÜfuRuÁime
 
¹
, 
CÜfuTabË
... 
m­s
è
throws
 
Exû±iÚ
 {

76 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

77 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

78 
CÜfuTabË
 
m­
 : 
m­s
) {

79 
mcw1
.
	`addM­
(
m­
);

82 
mcw1
.
	`­³ndCheckpošts
(
¹
, 
authÜ
);

84 
	}
}

86 vŞ©
Tok’
 
	gÏ¡V®idCheckpošt
 = Tok’.
UNINITIALIZED
;

91 
	$m­CkpoštAndTrim
(
CÜfuRuÁime
 
¹
, 
CÜfuTabË
... 
m­s
è
throws
 
Exû±iÚ
 {

92 
Tok’
 
checkpoštAdd»ss
 = Tok’.
UNINITIALIZED
;

93 
Tok’
 
Ï¡CheckpoštAdd»ss
 = Tok’.
UNINITIALIZED
;

95 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

96 
Œy
 {

97 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

98 
CÜfuTabË
 
m­
 : 
m­s
) {

99 
mcw1
.
	`addM­
(
m­
);

102 
checkpoštAdd»ss
 = 
mcw1
.
	`­³ndCheckpošts
(
¹
, 
authÜ
);

104 
Œy
 {

105 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

106 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

110 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
checkpoštAdd»ss
);

111 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

112 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

113 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

114 
Ï¡CheckpoštAdd»ss
 = 
checkpoštAdd»ss
;

115 
Ï¡V®idCheckpošt
 = 
checkpoštAdd»ss
;

116 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

118 
‹
.
	`´štSckT¿û
();

119 
throw
 
‹
;

120 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

125 
	`as£¹Th©
(
checkpoštAdd»ss
).
	`isEqu®To
(
Ï¡CheckpoštAdd»ss
);

129 
	}
}

138 
	$v®id©eM­Rebud
(
m­Size
, 
boŞ—n
 
ex³ùedFuÎsize
, boŞ—À
ŒimCªH­³n
) {

139 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

140 
Œy
 {

141 
M­
<
SŒšg
, 
LÚg
> 
loÿlm2A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

142 
M­
<
SŒšg
, 
LÚg
> 
loÿlm2B
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

143 
i
 = 0; i < 
loÿlm2A
.
	`size
(); i++) {

144 
	`as£¹Th©
(
loÿlm2A
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(() i);

146 
i
 = 0; i < 
loÿlm2B
.
	`size
(); i++) {

147 
	`as£¹Th©
(
loÿlm2B
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(0L);

149 ià(
ex³ùedFuÎsize
) {

150 
	`as£¹Th©
(
loÿlm2A
.
	`size
()).
	`isEqu®To
(
m­Size
);

151 
	`as£¹Th©
(
loÿlm2B
.
	`size
()).
	`isEqu®To
(
m­Size
);

153 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

154 ià(!
ŒimCªH­³n
) {

156 
‹
.
	`´štSckT¿û
();

157 
throw
 
‹
;

159 } 
fš®ly
 {

160 
¹
.
	`shutdown
();

162 
	}
}

169 
pİuÏ‹M­s
(
m­Size
, 
M­
<
SŒšg
, 
LÚg
> 
m­1
, M­<SŒšg, LÚg> 
m­2
) {

170 
	gi
 = 0; i < 
	gm­Size
; i++) {

171 
	gŒy
 {

172 
	gm­1
.
put
(
SŒšg
.
v®ueOf
(
i
), () i);

173 
	gm­2
.
put
(
SŒšg
.
v®ueOf
(
i
), () 0);

174 } 
ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

176 
	g‹
.
´štSckT¿û
();

177 
throw
 
	g‹
;

196 @
Te¡


197 
public
 
	$³riodicCkpoštTe¡
(è
throws
 
Exû±iÚ
 {

198 
fš®
 
m­Size
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

200 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

202 
M­
<
SŒšg
, 
LÚg
> 
m­A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

203 
M­
<
SŒšg
, 
LÚg
> 
m­B
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

206 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

207 
	`pİuÏ‹M­s
(
m­Size
, 
m­A
, 
m­B
);

212 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

213 
	`m­Ckpošt
(
¹
, (
CÜfuTabË
è
m­A
, (CÜfuTabËè
m­B
);

219 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
, 
ignÜed_sk_num
 -> {

220 
	`v®id©eM­Rebud
(
m­Size
, 
çl£
, false);

223 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_LONG
);

227 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

229 
¹
.
	`shutdown
();

230 
	}
}

244 @
Te¡


245 
public
 
	$em±yCkpoštTe¡
(è
throws
 
Exû±iÚ
 {

246 
fš®
 
m­Size
 = 0;

248 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

249 
M­
<
SŒšg
, 
LÚg
> 
m­A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

250 
M­
<
SŒšg
, 
LÚg
> 
m­B
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

252 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

253 
	`m­Ckpošt
(
¹
, (
CÜfuTabË
è
m­A
, (CÜfuTabËè
m­B
);

258 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
, 
ignÜed_sk_num
 -> {

259 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

262 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_LONG
);

266 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

268 
¹
.
	`shutdown
();

269 
	}
}

271 @
Te¡


272 
public
 
	$em±yCkpoštTe¡2
(è
throws
 
Exû±iÚ
 {

273 
fš®
 
m­Size
 = 0;

275 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

277 
¹
.
	`shutdown
();

278 
	}
}

297 @
Te¡


298 
public
 
	$³riodicCkpoštNoUpd©esTe¡
(è
throws
 
Exû±iÚ
 {

299 
fš®
 
m­Size
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

301 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

302 
M­
<
SŒšg
, 
LÚg
> 
m­A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

303 
M­
<
SŒšg
, 
LÚg
> 
m­B
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

306 
	`pİuÏ‹M­s
(
m­Size
, 
m­A
, 
m­B
);

309 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

310 
	`m­Ckpošt
(
¹
, (
CÜfuTabË
è
m­A
, (CÜfuTabËè
m­B
);

316 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
, 
ignÜed_sk_num
 -> {

317 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

320 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_LONG
);

324 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

326 
¹
.
	`shutdown
();

327 
	}
}

347 @
Te¡


348 
public
 
	$³riodicCkpoštTrimTe¡
(è
throws
 
Exû±iÚ
 {

349 
fš®
 
m­Size
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

350 
fš®
 
WAIT_TIME_SECONDS
 = 10;

352 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

354 
Œy
 {

355 
M­
<
SŒšg
, 
LÚg
> 
m­A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

356 
M­
<
SŒšg
, 
LÚg
> 
m­B
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

359 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

360 
	`pİuÏ‹M­s
(
m­Size
, 
m­A
, 
m­B
);

365 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

366 
	`m­CkpoštAndTrim
(
¹
, (
CÜfuTabË
è
m­A
, (CÜfuTabËè
m­B
);

372 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
, 
ignÜed_sk_num
 -> {

373 
	`v®id©eM­Rebud
(
m­Size
, 
çl£
, 
Œue
);

376 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_LONG
);

379 
Tok’
 
cu¼’tTrimM¬k
 = Tok’.
UNINITIALIZED
;

380 
cu¼’tTrimM¬k
.
	`g‘Sequ’û
(è!ğ
Ï¡V®idCheckpošt
.getSequence() + 1L) {

381 
cu¼’tTrimM¬k
 = 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

386 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

387 } 
fš®ly
 {

388 
¹
.
	`shutdown
();

390 
	}
}

399 @
Te¡


400 
public
 
	$´efixTrimNÙR—chšgSequ’ûr
(è
throws
 
Exû±iÚ
 {

401 
fš®
 
m­Size
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

402 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

404 
Te¡RuË
 
drİSequ’ûrTrim
 = 
Ãw
 
	`Te¡RuË
()

405 .
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
SEQUENCER_TRIM_REQ
))

406 .
	`drİ
();

407 
	`addCl›ÁRuË
(
¹
, 
drİSequ’ûrTrim
);

409 
Œy
 {

410 
M­
<
SŒšg
, 
LÚg
> 
m­A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

411 
M­
<
SŒšg
, 
LÚg
> 
m­B
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

414 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

415 
	`pİuÏ‹M­s
(
m­Size
, 
m­A
, 
m­B
);

420 
	`scheduËCÚcu¼’y
(1, 
ignÜed_sk_num
 -> {

421 
	`m­CkpoštAndTrim
(
¹
, (
CÜfuTabË
è
m­A
, (CÜfuTabËè
m­B
);

433 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
, 
ignÜed_sk_num
 -> {

434 
	`v®id©eM­Rebud
(
m­Size
, 
çl£
, 
Œue
);

437 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_LONG
);

440 
Tok’
 
cu¼’tTrimM¬k
 = Tok’.
UNINITIALIZED
;

441 
cu¼’tTrimM¬k
.
	`g‘Sequ’û
(è!ğ
Ï¡V®idCheckpošt
.getSequence() + 1L) {

442 
cu¼’tTrimM¬k
 = 
	`g‘NewRuÁime
().
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

447 
	`v®id©eM­Rebud
(
m­Size
, 
Œue
, 
çl£
);

448 } 
fš®ly
 {

449 
¹
.
	`shutdown
();

451 
	}
}

473 @
Te¡


474 
public
 
	$undoCkpoštTe¡
(è
throws
 
Exû±iÚ
 {

475 
fš®
 
m­Size
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

476 
fš®
 
ŒimPos™iÚ
 = 
m­Size
 / 2;

477 
fš®
 
¢­shÙPos™iÚ
 = 
ŒimPos™iÚ
 + 2;

479 
CouÁDownL©ch
 
Ïtch
 = 
Ãw
 
	`CouÁDownL©ch
(1);

481 
	`t
(1, () -> {

483 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

484 
Œy
 {

485 
M­
<
SŒšg
, 
LÚg
> 
m­A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

488 
i
 = 0; i < 
m­Size
; i++) {

489 
m­A
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), () i);

493 
MuÉiCheckpoštWr™”
 
mcw1
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

494 
mcw1
.
	`addM­
((
CÜfuTabË
è
m­A
);

495 
mcw1
.
	`­³ndCheckpošts
(
¹
, 
authÜ
);

498 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
ŒimPos™iÚ
);

499 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

500 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

501 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

502 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

504 
Ïtch
.
	`couÁDown
();

505 } 
fš®ly
 {

506 
¹
.
	`shutdown
();

510 
AtomicBoŞ—n
 
ŒimExû±iÚFÏg
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

513 
	`t
(2, () -> {

514 
Ïtch
.
	`awa™
();

515 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

517 
M­
<
SŒšg
, 
LÚg
> 
loÿlm2A
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

520 
Tok’
 
time¡amp
 = 
Ãw
 
	`Tok’
(0L, 
¢­shÙPos™iÚ
 - 1);

521 
¹
.
	`g‘ObjeùsV›w
().
	`TXBud
()

522 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

523 .
	`¢­shÙ
(
time¡amp
)

524 .
	`bud
()

525 .
	`begš
();

528 
Œy
 {

529 
loÿlm2A
.
	`g‘
(0);

530 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

531 
	`as£¹Th©
(
‹
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
TRIM
);

533 
ŒimExû±iÚFÏg
.
	`£t
(
Œue
);

536 
Œy
 {

537 ià(
ŒimExû±iÚFÏg
.
	`g‘
(è=ğ
çl£
) {

538 
	`as£¹Th©
(
loÿlm2A
.
	`size
())

539 .
	`isEqu®To
(
¢­shÙPos™iÚ
);

542 
i
 = 0; i < 
¢­shÙPos™iÚ
; i++) {

543 
	`as£¹Th©
(
loÿlm2A
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
)))

544 .
	`isEqu®To
((è
i
);

548 
i
 = 
¢­shÙPos™iÚ
; i < 
m­Size
; i++) {

549 
	`as£¹Th©
(
loÿlm2A
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
)))

550 .
	`isEqu®To
(
nuÎ
);

553 } 
fš®ly
 {

554 
¹
.
	`shutdown
();

558 
	}
}

560 @
Te¡


561 
public
 
	$´efixTrimTwiûAtSameAdd»ss
(è
throws
 
Exû±iÚ
 {

562 
fš®
 
m­Size
 = 5;

563 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

564 
M­
<
SŒšg
, 
LÚg
> 
m­1
 = 
	`İ’M­
(
¹
, 
¡»amNameA
);

565 
M­
<
SŒšg
, 
LÚg
> 
m­2
 = 
	`İ’M­
(
¹
, 
¡»amNameB
);

566 
	`pİuÏ‹M­s
(
m­Size
, 
m­1
, 
m­2
);

569 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 2);

570 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

571 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

574 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

575 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

576 
¹
.
	`shutdown
();

577 
	}
}

579 @
Te¡


580 
public
 
	$Œª§ùiÚ®R—dAá”Checkpošt
(è
throws
 
Exû±iÚ
 {

581 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

582 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

584 .
	`£tSŒ—mName
("test")

585 .
	`İ’
();

587 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

588 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

590 .
	`£tSŒ—mName
("test2")

591 .
	`İ’
();

594 
‹¡M­
.
	`put
("a", "a");

595 
‹¡M­
.
	`put
("b", "a");

596 
‹¡M­
.
	`put
("c", "a");

597 
‹¡M­2
.
	`put
("a", "c");

598 
‹¡M­2
.
	`put
("b", "c");

599 
‹¡M­2
.
	`put
("c", "c");

602 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

603 
mcw
.
	`addM­
((
CÜfuTabË
è
‹¡M­
);

604 
mcw
.
	`addM­
((
CÜfuTabË
è
‹¡M­2
);

605 
Tok’
 
checkpoštAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), "author");

608 
Tok’
 
time¡amp
 = 
Ãw
 
	`Tok’
(0L, 1);

609 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

610 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

611 .
	`¢­shÙ
(
time¡amp
)

612 .
	`bud
()

613 .
	`begš
();

615 
‹¡M­
.
	`g‘
("a");

616 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

619 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
checkpoštAdd»ss
);

620 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`gc
();

621 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

622 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

625 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

626 
‹¡M­
.
	`put
("a", "b");

627 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

628 
	}
}

638 @
Te¡


639 
public
 
	$‹¡P»fixTrimOnNÚAdd»ss
(è
throws
 
Exû±iÚ
 {

640 
fš®
 
m­Size
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

641 
fš®
 
SŒšg
 
¡»amName
 = "test";

643 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
();

644 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘NewRuÁime
();

646 
Œy
 {

647 
SŒ—mšgM­
<
SŒšg
, 
LÚg
> 
‹¡M­
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

648 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
LÚg
>>() {

650 .
	`£tSŒ—mName
(
¡»amName
)

651 .
	`İ’
();

654 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

655 
mcw
.
	`addM­
(
‹¡M­
);

656 
Tok’
 
checkpoštAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
¹
, 
authÜ
);

659 
i
 = 0; i < 
m­Size
; i++) {

660 
Œy
 {

661 
‹¡M­
.
	`put
(
SŒšg
.
	`v®ueOf
(
i
), () i);

662 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

664 
‹
.
	`´štSckT¿û
();

665 
throw
 
‹
;

670 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
checkpoštAdd»ss
);

671 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

672 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

673 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

676 
Œy
 {

677 
M­
<
SŒšg
, 
LÚg
> 
loÿlTe¡M­
 = 
	`İ’M­
(
ruÁime
, 
¡»amName
);

678 
i
 = 0; i < 
loÿlTe¡M­
.
	`size
(); i++) {

679 
	`as£¹Th©
(
loÿlTe¡M­
.
	`g‘
(
SŒšg
.
	`v®ueOf
(
i
))).
	`isEqu®To
(() i);

681 
	`as£¹Th©
(
loÿlTe¡M­
.
	`size
()).
	`isEqu®To
(
m­Size
);

682 } 
	`ÿtch
 (
TrimmedExû±iÚ
 
‹
) {

684 
‹
.
	`´štSckT¿û
();

685 
throw
 
‹
;

687 } 
fš®ly
 {

688 
¹
.
	`shutdown
();

689 
ruÁime
.
	`shutdown
();

691 
	}
}

696 @
Te¡


697 
public
 
	$P”si¡edCÜfuTabËTe¡s
() {

698 
SŒšg
 
·th
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

700 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
();

702 
UUID
 
bËId
 = UUID.
	`¿ndomUUID
();

703 
Suµl›r
<
SŒ—mšgM­
<
SŒšg
, SŒšg>> 
wr™”M­Suµl›r
 = () ->

704 
Ãw
 
P”si¡edSŒ—mšgM­
<>(
P©hs
.
	`g‘
(
·th
 + 
bËId
 + "writer"),

705 
P”si¡edSŒ—mšgM­
.
	`g‘P”si¡edSŒ—mšgM­O±iÚs
(),

706 
S”Ÿliz”s
.
JSON
, 
¹
);

708 
CÜfuTabË
<
SŒšg
, SŒšg> 
diskBackedM­
 = 
¹
.
	`g‘ObjeùsV›w
()

709 .
	`bud
()

710 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

711 .
	`¡»amID
(
bËId
)

712 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
JSON
)

713 .
	`£tArgum’ts
(
wr™”M­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
MONOTONIC
)

714 .
	`İ’
();

716 
fš®
 
numKeys
 = 303;

717 
x
 = 0; x < 
numKeys
; x++) {

718 
diskBackedM­
.
	`put
(
SŒšg
.
	`v®ueOf
(
x
), "payload" + x);

721 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

722 
mcw
.
	`addM­
(
diskBackedM­
);

723 
Tok’
 
tok’
 = 
mcw
.
	`­³ndCheckpošts
(
¹
, "Author1");

724 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

725 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

727 
CÜfuRuÁime
 
ÃwRt
 = 
	`g‘NewRuÁime
();

729 
Suµl›r
<
SŒ—mšgM­
<
SŒšg
, SŒšg>> 
»ad”M­Suµl›r
 = () ->

730 
Ãw
 
P”si¡edSŒ—mšgM­
<>(
P©hs
.
	`g‘
(
·th
 + 
bËId
 + "reader"),

731 
P”si¡edSŒ—mšgM­
.
	`g‘P”si¡edSŒ—mšgM­O±iÚs
(),

732 
S”Ÿliz”s
.
JSON
, 
¹
);

734 
CÜfuTabË
<
SŒšg
, SŒšg> 
ÃwDiskBackedM­
 = 
ÃwRt
.
	`g‘ObjeùsV›w
()

735 .
	`bud
()

736 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

737 .
	`¡»amID
(
bËId
)

738 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
JSON
)

739 .
	`£tArgum’ts
(
»ad”M­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
MONOTONIC
)

740 .
	`İ’
();

742 
	`as£¹Th©
(
I‹¿tÜs
.
	`–em’tsEqu®
(
ÃwDiskBackedM­
.
	`’ŒySŒ—m
().
	`™”©Ü
(),

743 
diskBackedM­
.
	`’ŒySŒ—m
().
	`™”©Ü
())).
	`isTrue
();

744 
	}
}

	@test/src/test/java/org/corfudb/runtime/checkpoint/CheckpointTrimTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcheckpošt
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

10 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

12 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùO³nO±iÚ
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

26 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

31 
public
 cÏs 
	cCheckpoštTrimTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

33 @
Te¡


34 
public
 
	$‹¡CheckpoštTrim
(è
throws
 
Exû±iÚ
 {

35 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

36 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

38 .
	`£tSŒ—mName
("test")

39 .
	`İ’
();

42 
‹¡M­
.
	`put
("a", "a");

43 
‹¡M­
.
	`put
("b", "b");

44 
‹¡M­
.
	`put
("c", "c");

47 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

48 
mcw
.
	`addM­
((
CÜfuTabË
è
‹¡M­
);

49 
Tok’
 
checkpoštAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), "author");

52 
	`Œim
(
checkpoštAdd»ss
);

55 
M­
<
SŒšg
, SŒšg> 
ÃwTe¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

56 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

58 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

59 .
	`£tSŒ—mName
("test")

60 .
	`İ’
();

63 
	`as£¹Th©
(
ÃwTe¡M­
)

64 .
	`cÚšsKeys
("a", "b", "c");

71 @
Te¡


72 
public
 
	$’su»MCWU£sR—lTa
(è
throws
 
Exû±iÚ
 {

73 
SŒ—mšgM­
<
SŒšg
, SŒšg> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

74 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

76 .
	`£tSŒ—mName
("test")

77 .
	`İ’
();

79 
fš®
 
š™M­Size
 = 10;

80 
x
 = 0; x < 
š™M­Size
; x++) {

81 
m­
.
	`put
(
SŒšg
.
	`v®ueOf
(
x
), String.valueOf(x));

85 
x
 = 0; x < 
š™M­Size
; x++) {

86 
	`g‘DeçuÉRuÁime
().
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

89 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

90 
mcw
.
	`addM­
(
m­
);

91 
Tok’
 
ŒimAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), "author");

92 
Tok’
 
¡®eTrimAdd»ss
 = 
Ãw
 
	`Tok’
(
ŒimAdd»ss
.
	`g‘Epoch
(è- 1,rimAdd»ss.
	`g‘Sequ’û
());

94 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
¡®eTrimAdd»ss
);

96 
Tok’
 
ex³ùedTrimM¬k
 = 
Ãw
 
	`Tok’
(
	`g‘RuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(),

97 
¡®eTrimAdd»ss
.
	`g‘Sequ’û
() + 1);

98 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
())

99 .
	`isEqu®ByCom·ršgTo
(
ex³ùedTrimM¬k
);

100 
	}
}

127 @
Te¡


128 
public
 
	$‹¡SucûssiveCheckpoštTrim
(è
throws
 
Exû±iÚ
 {

129 
fš®
 
nCheckpošts
 = 2;

130 
fš®
 
ckpoštG­
 = 5;

132 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

133 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

135 .
	`£tSŒ—mName
("test")

136 .
	`İ’
();

138 
Tok’
 
checkpoštAdd»ss
 = Tok’.
UNINITIALIZED
;

140 
ckpošt
 = 0; ckpošˆ< 
nCheckpošts
; ckpoint++) {

142 
‹¡M­
.
	`put
("a", "a" + 
ckpošt
);

143 
‹¡M­
.
	`put
("b", "b" + 
ckpošt
);

144 
‹¡M­
.
	`put
("c", "c" + 
ckpošt
);

147 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

148 
mcw
.
	`addM­
((
CÜfuTabË
è
‹¡M­
);

149 
checkpoštAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), "author");

153 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
checkpoštAdd»ss
.
	`g‘Epoch
(), checkpoštAdd»ss.
	`g‘Sequ’û
(è- 
ckpoštG­
 - 1);

154 
	`Œim
(
tok’
);

157 
M­
<
SŒšg
, SŒšg> 
ÃwTe¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

158 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

160 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

161 .
	`£tSŒ—mName
("test")

162 .
	`İ’
();

165 
Tok’
 
¢­shÙ
 = 
Ãw
 
	`Tok’
(0L, 
checkpoštAdd»ss
.
	`g‘Sequ’û
() - 1);

166 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

167 .
	`TXBud
()

168 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

169 .
	`¢­shÙ
(
¢­shÙ
)

170 .
	`bud
()

171 .
	`begš
();

174 
	`as£¹Th©
(
ÃwTe¡M­
.
	`g‘
("a"))

175 .
	`isEqu®To
("a" + (
nCheckpošts
 - 1));

176 
	}
}

182 @
Te¡


183 
public
 
	$¿wSŒ—mCÚsum”
() {

184 
fš®
 
BATCH_SIZE
 = 10;

185 
fš®
 
CHECKPOINT_SIZE
 = 3;

186 
fš®
 
SŒšg
 
CHECKPOINT_AUTHOR
 = "Author";

187 
fš®
 
SŒšg
 
bËName
 = "test";

188 
fš®
 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

189 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

190 .
	`£tSŒ—mName
(
bËName
)

191 .
	`İ’
();

193 
fš®
 
MuÉiCheckpoštWr™”
<
CÜfuTabË
> 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

194 
mcw
.
	`addM­
(
m­
);

196 
IÁSŒ—m
.
	`¿nge
(0, 
BATCH_SIZE
).
	`fÜEach
(
idx
 -> 
m­
.
	`put
(idx, idx));

199 
Tok’
 
checkpoštAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), 
CHECKPOINT_AUTHOR
);

201 
IÁSŒ—m
.
	`¿nge
(0, 
BATCH_SIZE
).
	`fÜEach
(
idx
 -> 
m­
.
	`put
(idx, idx));

204 
	`Œim
(
checkpoštAdd»ss
);

206 
CÜfuRuÁime
 
ÃwRuÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

207 
M­
<
IÁeg”
, IÁeg”> 
ÃwM­
 = 
ÃwRuÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

208 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {

210 .
	`£tSŒ—mName
(
bËName
)

211 .
	`İ’
();

213 
ISŒ—mV›w
 
s
 = 
ÃwRuÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
bËName
));

214 
s
.
	`£ek
(
BATCH_SIZE
 + 
CHECKPOINT_SIZE
);

218 
As£¹iÚs
.
	`as£¹Th©
(
SŒ—m
.
	`of
(
s
.
	`»maššgUpTo
(
LÚg
.
MAX_VALUE
), s.remainingUpTo(Long.MAX_VALUE))

219 .
	`m­
(
Li¡
::
size
).
	`m­ToIÁ
(
IÁeg”
::
štV®ue
).
	`sum
())

220 .
	`isEqu®To
(
BATCH_SIZE
);

222 
	`Œim
(
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), 
CHECKPOINT_AUTHOR
));

223 
IÁSŒ—m
.
	`¿nge
(0, 
BATCH_SIZE
).
	`fÜEach
(
idx
 -> 
ÃwM­
.
	`put
(idx, idx));

224 
As£¹iÚs
.
	`as£¹Th©ThrownBy
((è-> 
s
.
	`»maššgUpTo
(
LÚg
.
MAX_VALUE
))

225 .
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

226 
	}
}

233 
´iv©e
 
	$Œim
(
Tok’
 
tok’
) {

234 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

235 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`gc
();

236 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

237 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

238 
	}
}

241 @
Te¡


242 
public
 
	$‹¡CheckpoštTrimDuršgPÏyback
(è
throws
 
Exû±iÚ
 {

243 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

244 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

246 .
	`£tSŒ—mName
("test")

247 .
	`İ’
();

250 
‹¡M­
.
	`put
("a", "a");

251 
‹¡M­
.
	`put
("b", "b");

252 
‹¡M­
.
	`put
("c", "c");

255 
M­
<
SŒšg
, SŒšg> 
ÃwTe¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

256 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

258 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

259 .
	`£tSŒ—mName
("test")

260 .
	`İ’
();

263 
Tok’
 
¢­shÙ
 = 
Ãw
 
	`Tok’
(0L, 1);

264 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

265 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

266 .
	`¢­shÙ
(
¢­shÙ
)

267 .
	`bud
()

268 .
	`begš
();

270 
	`as£¹Th©
(
ÃwTe¡M­
)

271 .
	`cÚšsKeys
("a", "b")

272 .
	`hasSize
(2);

274 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

277 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

278 
mcw
.
	`addM­
((
CÜfuTabË
è
‹¡M­
);

279 
Tok’
 
checkpoštAdd»ss
 = 
mcw
.
	`­³ndCheckpošts
(
	`g‘RuÁime
(), "author");

282 
	`Œim
(
checkpoštAdd»ss
);

286 
	`as£¹Th©
(
ÃwTe¡M­
)

287 .
	`cÚšsKeys
("a", "b", "c");

288 
	}
}

295 @
Te¡


296 
public
 
	$‹¡TrimR‘ryS”v”EpochChªge
(è
throws
 
Exû±iÚ
{

298 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

299 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

301 .
	`£tSŒ—mName
("test")

302 .
	`İ’
();

305 
Layout
 
l
 = 
Ãw
 
	`Layout
(
	`g‘LayoutS”v”
(0).
	`g‘Cu¼’tLayout
());

306 
fš®
 
fš®Epoch
 = 
l
.
	`g‘Epoch
() + 1;

307 
l
.
	`£tEpoch
(
fš®Epoch
);

308 
	`g‘DeçuÉRuÁime
().
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

309 
	`g‘DeçuÉRuÁime
().
	`g‘LayoutV›w
().
	`upd©eLayout
(
l
, 1L);

311 
boŞ—n
 
exû±iÚCaught
 = 
çl£
;

314 
Œy
 {

315 
	`g‘DeçuÉRuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
Ãw
 
	`Tok’
(
fš®Epoch
, 
Add»ss
.
NON_ADDRESS
));

316 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

318 
exû±iÚCaught
 = 
Œue
;

319 
	`as£¹Th©
(
e
)

320 .
	`isIn¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

325 
	`as£¹Th©
(
exû±iÚCaught
).
	`isF®£
();

326 
Tok’
 
ŒimM¬k
 = 
	`g‘DeçuÉRuÁime
().
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

328 
	`as£¹Th©
(
ŒimM¬k
).
	`isEqu®To
(
Ãw
 
	`Tok’
(
fš®Epoch
, 0L));

329 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/AbstractClientTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

21 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùCl›ÁTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

26 
public
 
	$Ab¡¿ùCl›ÁTe¡
() {

28 
CÜfuRuÁime
.
ov”rideG‘Rou‹rFunùiÚ
 = 
this
::
g‘Rou‹rFunùiÚ
;

31 @
G‘‹r


32 
Te¡Cl›ÁRou‹r
 
rou‹r
;

34 @
G‘‹r


35 
Te¡S”v”Rou‹r
 
£rv”Rou‹r
;

37 @
BefÜe


38 
public
 
	$»£tTe¡
() {

39 
£rv”Rou‹r
 = 
Ãw
 
	`Te¡S”v”Rou‹r
();

40 
rou‹r
 = 
Ãw
 
	`Te¡Cl›ÁRou‹r
(
£rv”Rou‹r
);

41 
	`g‘S”v”sFÜTe¡
().
	`¡»am
().
	`fÜEach
(
£rv”Rou‹r
::
addS”v”
);

42 
	`g‘Cl›ÁsFÜTe¡
().
	`¡»am
().
	`fÜEach
(
rou‹r
::
addCl›Á
);

43 
	}
}

45 @
Aá”


46 
public
 
	$shutdownS”v”s
() {

47 
Ãw
 
HashS‘
<>(
£rv”Rou‹r
.
hªdËrM­
.
	`v®ues
()).
	`fÜEach
(
Ab¡¿ùS”v”
::
shutdown
);

48 
	}
}

53 
fš®
 
	gM­
<
	gCÜfuRuÁime
, M­<
	gSŒšg
, 
	gTe¡Cl›ÁRou‹r
>>

54 
	gruÁimeRou‹rM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

63 
´iv©e
 
ICl›ÁRou‹r
 
	$g‘Rou‹rFunùiÚ
(
CÜfuRuÁime
 
ruÁime
, 
SŒšg
 
’dpošt
) {

64 
ruÁimeRou‹rM­
.
	`putIfAb£Á
(
ruÁime
, 
Ãw
 
CÚcu¼’tHashM­
<>());

65 ià(!
’dpošt
.
	`¡¬tsW™h
("test:")) {

66 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("UnsuµÜ‹dƒndpošˆše¡: " + 
’dpošt
);

68  
ruÁimeRou‹rM­
.
	`g‘
(
ruÁime
).
	`compu‹IfAb£Á
(
’dpošt
,

69 
x
 -> {

70 
Te¡Cl›ÁRou‹r
 
tú
 =

71 
Ãw
 
	`Te¡Cl›ÁRou‹r
(
£rv”Rou‹r
);

72 
tú
.
	`addCl›Á
(
Ãw
 
	`Ba£HªdËr
())

73 .
	`addCl›Á
(
Ãw
 
	`Sequ’ûrHªdËr
())

74 .
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
())

75 .
	`addCl›Á
(
Ãw
 
	`LogUn™HªdËr
())

76 .
	`addCl›Á
(
Ãw
 
	`Mªagem’tHªdËr
());

77  
tú
;

80 
	}
}

82 
ab¡¿ù
 
	gS‘
<
	gAb¡¿ùS”v”
> 
g‘S”v”sFÜTe¡
();

84 
ab¡¿ù
 
	gS‘
<
	gICl›Á
> 
g‘Cl›ÁsFÜTe¡
();

86 
public
 
S”v”CÚ‹xt
 
	$deçuÉS”v”CÚ‹xt
() {

87  
Ãw
 
	`S”v”CÚ‹xtBud”
()

88 .
	`£tMemÜy
(
Œue
)

89 .
	`£tSšgË
(
çl£
)

90 .
	`£tS”v”Rou‹r
(
£rv”Rou‹r
)

91 .
	`bud
();

92 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/BaseHandlerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gBa£S”v”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
public
 cÏs 
	cBa£HªdËrTe¡
 
ex‹nds
 
	mAb¡¿ùCl›ÁTe¡
 {

17 
Ba£Cl›Á
 
	mş›Á
;

19 @
Ov”ride


20 
	mS‘
<
	mAb¡¿ùS”v”
> 
	$g‘S”v”sFÜTe¡
() {

21  
Ãw
 
ImmubËS‘
.
Bud”
<
Ab¡¿ùS”v”
>()

22 .
	`add
(
Ãw
 
	`Ba£S”v”
(
S”v”CÚ‹xtBud”
.
	`deçuÉTe¡CÚ‹xt
(0)))

23 .
	`bud
();

26 @
Ov”ride


27 
S‘
<
ICl›Á
> 
	$g‘Cl›ÁsFÜTe¡
() {

28 
Ba£HªdËr
 
ba£HªdËr
 = 
Ãw
 
	`Ba£HªdËr
();

29 
ş›Á
 = 
Ãw
 
	`Ba£Cl›Á
(
rou‹r
, 0L);

30  
Ãw
 
ImmubËS‘
.
Bud”
<
ICl›Á
>()

31 .
	`add
(
ba£HªdËr
)

32 .
	`bud
();

33 
	}
}

35 @
Te¡


36 
public
 
	$ÿnG‘V”siÚInfo
() {

37 
CFUts
.
	`g‘Unš‹¼u±ibly
(
ş›Á
.
	`g‘V”siÚInfo
());

38 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/LayoutHandlerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLayoutS”v”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAÌ—dyBoÙ¡¿µedExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gNoBoÙ¡¿pExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

21 
public
 cÏs 
	cLayoutHªdËrTe¡
 
ex‹nds
 
	mAb¡¿ùCl›ÁTe¡
 {

23 
LayoutCl›Á
 
	mş›Á
;

25 @
Ov”ride


26 
	mS‘
<
	mAb¡¿ùS”v”
> 
	$g‘S”v”sFÜTe¡
() {

27  
Ãw
 
ImmubËS‘
.
Bud”
<
Ab¡¿ùS”v”
>()

28 .
	`add
(
Ãw
 
	`LayoutS”v”
(
	`deçuÉS”v”CÚ‹xt
()))

29 .
	`bud
();

32 @
Ov”ride


33 
S‘
<
ICl›Á
> 
	$g‘Cl›ÁsFÜTe¡
() {

34 
LayoutHªdËr
 
ÏyoutHªdËr
 = 
Ãw
 
	`LayoutHªdËr
();

35 
ş›Á
 = 
Ãw
 
	`LayoutCl›Á
(
rou‹r
, 0L);

36  
Ãw
 
ImmubËS‘
.
Bud”
<
ICl›Á
>()

37 .
	`add
(
Ãw
 
	`Ba£HªdËr
())

38 .
	`add
(
ÏyoutHªdËr
)

39 .
	`bud
();

40 
	}
}

42 @
Te¡


43 
public
 
	$nÚBoÙ¡¿µedS”v”ThrowsExû±iÚ
() {

44 
	`as£¹Th©ThrownBy
(() -> {

45 
ş›Á
.
	`g‘Layout
().
	`g‘
();

46 }).
	`hasCau£In¡ªûOf
(
NoBoÙ¡¿pExû±iÚ
.
şass
);

47 
	}
}

49 @
Te¡


50 
public
 
	$boÙ¡¿pS”v”In¡®lsNewLayout
()

51 
throws
 
Exû±iÚ
 {

52 
Layout
 
l
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

53 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
l
).
	`g‘
())

54 .
	`isEqu®To
(
Œue
);

56 
	`as£¹Th©
(
ş›Á
.
	`g‘Layout
().
	`g‘
().
	`asJSONSŒšg
())

57 .
	`isEqu®To
(
l
.
	`asJSONSŒšg
());

58 
	}
}

60 @
Te¡


61 
public
 
	$ÿÂÙBoÙ¡¿pS”v”Twiû
()

62 
throws
 
Exû±iÚ
 {

63 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
)).
	`g‘
())

64 .
	`isEqu®To
(
Œue
);

65 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`boÙ¡¿pLayout
(
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
)).
	`g‘
())

66 .
	`hasCau£In¡ªûOf
(
AÌ—dyBoÙ¡¿µedExû±iÚ
.
şass
);

67 
	}
}

69 @
Te¡


70 
public
 
	$ÿnG‘NewLayoutInDifã»ÁEpoch
()

71 
throws
 
Exû±iÚ
 {

72 
Layout
 
l
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

73 
fš®
 
NEW_EPOCH
 = 42L;

74 
l
.
	`£tEpoch
(
NEW_EPOCH
);

75 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
l
).
	`g‘
())

76 .
	`isEqu®To
(
Œue
);

78 
	`as£¹Th©
(
ş›Á
.
	`g‘Layout
().
	`g‘
().
	`g‘Epoch
())

79 .
	`isEqu®To
(
NEW_EPOCH
);

80 
	}
}

82 
fš®
 
	gRANK_LOW
 = 5L;

83 
fš®
 
	gRANK_HIGH
 = 10L;

84 @
Te¡


85 
public
 
	$´•¬eRejeùsLow”Rªks
()

86 
throws
 
Exû±iÚ
 {

87 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

88 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
Ïyout
).
	`g‘
())

89 .
	`isEqu®To
(
Œue
);

90 
•och
 = 
Ïyout
.
	`g‘Epoch
();

91 
	`as£¹Th©
(
ş›Á
.
	`´•¬e
(
•och
, 
RANK_HIGH
).
	`g‘
(è!ğ
nuÎ
)

92 .
	`isEqu®To
(
Œue
);

94 
	`as£¹Th©ThrownBy
(() -> {

95 
ş›Á
.
	`´•¬e
(
•och
, 
RANK_LOW
).
	`g‘
();

96 }).
	`hasCau£In¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

98 
	`as£¹Th©ThrownBy
(() -> {

99 
ş›Á
.
	`´•¬e
(
•och
, 2L).
	`g‘
();

100 }).
	`hasCau£In¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

101 
	}
}

103 @
Te¡


104 
public
 
	$´İo£RejeùsLow”Rªks
()

105 
throws
 
Exû±iÚ
 {

106 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

107 
•och
 = 
Ïyout
.
	`g‘Epoch
();

108 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
Ïyout
).
	`g‘
())

109 .
	`isEqu®To
(
Œue
);

111 
	`as£¹Th©
(
ş›Á
.
	`´•¬e
(
•och
, 
RANK_HIGH
).
	`g‘
(è!ğ
nuÎ
)

112 .
	`isEqu®To
(
Œue
);

114 
	`as£¹Th©ThrownBy
(() -> {

115 
ş›Á
.
	`´İo£
(
•och
, 
RANK_LOW
, 
Ïyout
).
	`g‘
();

116 }).
	`hasCau£In¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

118 
	`as£¹Th©
(
ş›Á
.
	`´İo£
(
•och
, 
RANK_HIGH
, 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
)).
	`g‘
())

119 .
	`isEqu®To
(
Œue
);

120 
	}
}

122 @
Te¡


123 
public
 
	$´İo£RejeùsAÌ—dyPrİo£d
()

124 
throws
 
Exû±iÚ
 {

125 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

126 
•och
 = 
Ïyout
.
	`g‘Epoch
();

127 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
Ïyout
).
	`g‘
())

128 .
	`isEqu®To
(
Œue
);

130 
	`as£¹Th©
(
ş›Á
.
	`´•¬e
(
•och
, 
RANK_HIGH
).
	`g‘
(è!ğ
nuÎ
)

131 .
	`isEqu®To
(
Œue
);

133 
ş›Á
.
	`´İo£
(
•och
, 
RANK_HIGH
, 
Ïyout
).
	`g‘
();

135 
	`as£¹Th©ThrownBy
(() -> {

136 
ş›Á
.
	`´İo£
(
•och
, 
RANK_LOW
, 
Ïyout
).
	`g‘
();

137 }).
	`hasCau£In¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

139 
	`as£¹Th©ThrownBy
(() -> {

140 
ş›Á
.
	`´İo£
(
•och
, 
RANK_HIGH
, 
Ïyout
).
	`g‘
();

141 }).
	`hasCau£In¡ªûOf
(
OuŒªkedExû±iÚ
.
şass
);

142 
	}
}

144 @
Te¡


145 
public
 
	$comm™R‘uºsAck
()

146 
throws
 
Exû±iÚ
 {

147 
Layout
 
Ïyout
 = 
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
);

148 
•och
 = 
Ïyout
.
	`g‘Epoch
();

149 
	`as£¹Th©
(
ş›Á
.
	`boÙ¡¿pLayout
(
Ïyout
).
	`g‘
())

150 .
	`isEqu®To
(
Œue
);

152 
	`as£¹Th©
(
ş›Á
.
	`´•¬e
(
•och
, 
RANK_HIGH
).
	`g‘
(è!ğ
nuÎ
)

153 .
	`isEqu®To
(
Œue
);

154 
fš®
 
TEST_EPOCH
 = 777;

155 
Ïyout
.
	`£tEpoch
(
TEST_EPOCH
);

157 
	`as£¹Th©
(
ş›Á
.
	`comm™‹d
(
TEST_EPOCH
, 
Ïyout
).
	`g‘
())

158 .
	`isEqu®To
(
Œue
);

159 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/LogUnitHandlerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
.
	gMETADATA_SIZE
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

8 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

14 
impÜt
 
	gjava
.
	gio
.
	gFe
;

15 
impÜt
 
	gjava
.
	gio
.
	gRªdomAcûssFe
;

16 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

17 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFeStÜe
;

18 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

19 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

20 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

22 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

24 
impÜt
 
	gjava
.
	gut
.
	gM­
;

25 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

26 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

27 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

30 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

31 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gCÚd™iÚ
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gfÜm©
.
	gTy³s
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	glog
.
	gSŒ—mLogFes
;

38 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

39 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

40 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

41 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

42 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gPriÜ™yLev–
;

43 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

44 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÙaExûededExû±iÚ
;

45 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gSŒ—mAdd»ssS·û
;

46 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—msAdd»ssRe¥Ú£
;

47 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTasRe¥Ú£
;

48 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

49 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

50 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

51 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aCÜru±iÚExû±iÚ
;

52 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gD©aOuŒªkedExû±iÚ
;

53 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eCau£
;

54 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

55 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gV®ueAdİ‹dExû±iÚ
;

56 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

57 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

58 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

63 
public
 cÏs 
	cLogUn™HªdËrTe¡
 
ex‹nds
 
	mAb¡¿ùCl›ÁTe¡
 {

65 
´iv©e
 
LogUn™Cl›Á
 
	mş›Á
;

66 
´iv©e
 
S”v”CÚ‹xt
 
	m£rv”CÚ‹xt
;

68 
´iv©e
 
fš®
 
UUID
 
	mş›ÁId1
 = UUID.
äomSŒšg
("7903ba37-e3e7-407b-b9e9-f8eacaa94d5e");

69 
´iv©e
 
fš®
 
UUID
 
	mş›ÁId2
 = UUID.
äomSŒšg
("a15bbffc-91cb-4a96-bb30-e1ecc5f522da");

71 
´iv©e
 
LogD©a
 
	$g‘LogD©aW™houtId
(
add»ss
) {

72 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

73 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

74 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

75 
LogD©a
 
ld
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
);

76 
ld
.
	`£tGlob®Add»ss
(
add»ss
);

78  
ld
;

81 @
Ov”ride


82 
S‘
<
Ab¡¿ùS”v”
> 
	$g‘S”v”sFÜTe¡
() {

83 
SŒšg
 
dœP©h
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

84 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

85 .
	`£tSšgË
(
çl£
)

86 .
	`£tNoV”ify
(
çl£
)

87 .
	`£tMemÜy
(
çl£
)

88 .
	`£tLogP©h
(
dœP©h
)

89 .
	`£tS”v”Rou‹r
(
£rv”Rou‹r
)

90 .
	`bud
();

91 
LogUn™S”v”
 
£rv”
 = 
Ãw
 
	`LogUn™S”v”
(
£rv”CÚ‹xt
);

92  
Ãw
 
ImmubËS‘
.
Bud”
<
Ab¡¿ùS”v”
>()

93 .
	`add
(
£rv”
)

94 .
	`bud
();

95 
	}
}

97 @
Ov”ride


98 
	gS‘
<
	gICl›Á
> 
	$g‘Cl›ÁsFÜTe¡
() {

99 
LogUn™HªdËr
 
logUn™HªdËr
 = 
Ãw
 
	`LogUn™HªdËr
();

100 
ş›Á
 = 
Ãw
 
	`LogUn™Cl›Á
(
rou‹r
, 0L);

101  
Ãw
 
ImmubËS‘
.
Bud”
<
ICl›Á
>()

102 .
	`add
(
Ãw
 
	`Ba£HªdËr
())

103 .
	`add
(
logUn™HªdËr
)

104 .
	`bud
();

105 
	}
}

107 @
Te¡


108 
public
 
	$ÿnR—dWr™e
()

109 
throws
 
Exû±iÚ
 {

110 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

111 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

112 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

113 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

114 .
	`isEqu®To
(
D©aTy³
.
DATA
);

115 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
()))

116 .
	`isEqu®To
(
‹¡SŒšg
);

117 
	}
}

119 @
Te¡


120 
public
 
	$»adšgEm±yAdd»ss
(è
throws
 
Exû±iÚ
 {

121 
fš®
 
add»ss0
 = 0;

122 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(
add»ss0
).
	`g‘
().
	`g‘Add»s£s
().get(0L);

123 
	`as£¹Th©
(
r
.
	`isEm±y
()).
	`isTrue
();

124 
	`as£¹Th©
(
r
.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
add»ss0
);

125 
	`as£¹Th©
(
LogD©a
.
	`g‘Em±y
(0)).
	`isEqu®To
(LogData.getEmpty(0));

126 
	}
}

128 @
Te¡


129 
public
 
	$wr™eNÚSequ’tŸlRªge
(è
throws
 
Exû±iÚ
 {

130 
fš®
 
add»ss0
 = 0;

131 
fš®
 
add»ss4
 = 4;

133 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

134 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

135 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

136 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

137 
LogD©a
 
ld0
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
);

138 
ld0
.
	`£tGlob®Add»ss
(
add»ss0
);

139 
’Œ›s
.
	`add
(
ld0
);

141 
LogD©a
 
ld4
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
);

142 
ld4
.
	`£tGlob®Add»ss
(
add»ss4
);

143 
’Œ›s
.
	`add
(
ld4
);

145 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`wr™eRªge
(
’Œ›s
).
	`g‘
())

146 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

147 
	}
}

149 @
Te¡


150 
public
 
	$wr™eRªge
(è
throws
 
Exû±iÚ
 {

151 
fš®
 
numI‹r
 = 100;

153 
Li¡
<
LogD©a
> 
’Œ›s
 = 
Ãw
 
A¼ayLi¡
<>();

154 
x
 = 0; x < 
numI‹r
; x++) {

155 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

156 
by‹
[] 
¡»amEÁry
 = "Paylßd".
	`g‘By‹s
();

157 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
¡»amEÁry
, 
b
);

158 
LogD©a
 
ld
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
);

159 
ld
.
	`£tGlob®Add»ss
((è
x
);

160 
’Œ›s
.
	`add
(
ld
);

163 
ş›Á
.
	`wr™eRªge
(
’Œ›s
).
	`g‘
();

166 
As£¹iÚs
.
	`as£¹Th©Exû±iÚOfTy³
(
ExecutiÚExû±iÚ
.
şass
).
	`isThrownBy
(

167 (è-> 
ş›Á
.
	`wr™eRªge
(
’Œ›s
).
	`g‘
())

168 .
	`w™hCau£In¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

171 
LogUn™S”v”
 
£rv”2
 = 
Ãw
 
	`LogUn™S”v”
(
£rv”CÚ‹xt
);

172 
£rv”Rou‹r
.
	`»£t
();

173 
£rv”Rou‹r
.
	`addS”v”
(
£rv”2
);

175 
Li¡
<
LogD©a
> 
»adEÁr›s
 = 
Ãw
 
A¼ayLi¡
<>();

176 
x
 = 0; x < 
numI‹r
; x++) {

177 
LogD©a
 
ld
 = 
ş›Á
.
	`»ad
(
x
).
	`g‘
().
	`g‘Add»s£s
().get(() x);

178 
»adEÁr›s
.
	`add
(
ld
);

181 
	`as£¹Th©
(
’Œ›s
).
	`isEqu®To
(
»adEÁr›s
);

182 
	}
}

184 @
Te¡


185 
public
 
	$quÙaExûededTe¡
(è
throws
 
Exû±iÚ
 {

186 
£rv”Rou‹r
.
	`»£t
();

187 
SŒšg
 
dœP©h
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

188 
fš®
 
maxLogSizeInBy‹s
 = 1000;

189 
FeStÜe
 
cÜfuDœBack’d
 = 
Fes
.
	`g‘FeStÜe
(
P©hs
.
	`g‘
(
dœP©h
));

190 
fš®
 
fsSize
 = 
cÜfuDœBack’d
.
	`g‘TÙ®S·û
();

191 
fš®
 
maxLogSizeInP”ûÁage
 = 
maxLogSizeInBy‹s
 * 100.0 / 
fsSize
;

192 
S”v”CÚ‹xt
 
sc
 = 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

193 .
	`£tMemÜy
(
çl£
)

194 .
	`£tLogP©h
(
dœP©h
)

195 .
	`£tS”v”Rou‹r
(
£rv”Rou‹r
)

196 .
	`£tLogSizeLim™P”ûÁage
(
DoubË
.
	`toSŒšg
(
maxLogSizeInP”ûÁage
))

197 .
	`bud
();

198 
LogUn™S”v”
 
£rv”
 = 
Ãw
 
	`LogUn™S”v”
(
sc
);

199 
£rv”Rou‹r
.
	`addS”v”
(
£rv”
);

201 
fš®
 
add»ss0
 = 0L;

202 
fš®
 
add»ss1
 = 1L;

203 
fš®
 
add»ss2
 = 2L;

204 
fš®
 
add»ss3
 = 3L;

205 
fš®
 
add»ss4
 = 4L;

207 
by‹
[] 
·ylßd
 = 
Ãw
 by‹[
maxLogSizeInBy‹s
 / 2];

209 
ş›Á
.
	`wr™e
(
add»ss0
, 
nuÎ
, 
·ylßd
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

210 
ş›Á
.
	`wr™e
(
add»ss1
, 
nuÎ
, 
·ylßd
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

211 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`wr™e
(
add»ss2
, 
nuÎ
, 
·ylßd
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
())

212 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

213 .
	`hasRoÙCau£In¡ªûOf
(
QuÙaExûededExû±iÚ
.
şass
);

216 
ş›Á
.
	`wr™e
(
LogD©a
.
	`g‘HŞe
(
add»ss4
)).
	`g‘
();

218 
ş›Á
.
	`£tPriÜ™yLev–
(
PriÜ™yLev–
.
HIGH
);

219 
ş›Á
.
	`wr™e
(
add»ss3
, 
nuÎ
, 
·ylßd
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

220 
	`as£¹Th©
(
ş›Á
.
	`»ad
(
add»ss0
).
	`g‘
().
	`g‘Add»s£s
().g‘×dd»ss0).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
);

221 
	`as£¹Th©
(
ş›Á
.
	`»ad
(
add»ss1
).
	`g‘
().
	`g‘Add»s£s
().g‘×dd»ss1).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
);

222 
	`as£¹Th©
(
ş›Á
.
	`»ad
(
add»ss2
).
	`g‘
().
	`g‘Add»s£s
().g‘×dd»ss2).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
EMPTY
);

223 
	`as£¹Th©
(
ş›Á
.
	`»ad
(
add»ss3
).
	`g‘
().
	`g‘Add»s£s
().g‘×dd»ss3).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
);

224 
	`as£¹Th©
(
ş›Á
.
	`»ad
(
add»ss4
).
	`g‘
().
	`g‘Add»s£s
().g‘×dd»ss4).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
HOLE
);

225 
	}
}

227 @
Te¡


228 
public
 
	$»adšgTrimmedAdd»ss
(è
throws
 
Exû±iÚ
 {

229 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

230 
fš®
 
add»ss0
 = 0;

231 
fš®
 
add»ss1
 = 1;

232 
ş›Á
.
	`wr™e
(
add»ss0
, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

233 
ş›Á
.
	`wr™e
(
add»ss1
, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

234 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(
add»ss0
).
	`g‘
().
	`g‘Add»s£s
().get(0L);

235 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

236 .
	`isEqu®To
(
D©aTy³
.
DATA
);

237 
r
 = 
ş›Á
.
	`»ad
(
add»ss1
).
	`g‘
().
	`g‘Add»s£s
().get(1L);

238 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

239 .
	`isEqu®To
(
D©aTy³
.
DATA
);

241 
ş›Á
.
	`´efixTrim
(
Ãw
 
	`Tok’
(0L, 
add»ss0
)).
	`g‘
();

242 
ş›Á
.
	`com·ù
().
	`g‘
();

245 
LogUn™S”v”
 
£rv”2
 = 
Ãw
 
	`LogUn™S”v”
(
£rv”CÚ‹xt
);

246 
£rv”Rou‹r
.
	`»£t
();

247 
£rv”Rou‹r
.
	`addS”v”
(
£rv”2
);

249 
LogD©a
 
ŒimmedAdd»ss
 = 
ş›Á
.
	`»ad
(
add»ss0
).
	`g‘
().
	`g‘Add»s£s
().get(0L);

251 
	`as£¹Th©
(
ŒimmedAdd»ss
.
	`isTrimmed
()).
	`isTrue
();

252 
	`as£¹Th©
(
ŒimmedAdd»ss
.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
add»ss0
);

253 
	}
}

255 @
Te¡


256 
public
 
	$æushLogUn™Cache
(è
throws
 
Exû±iÚ
 {

257 
LogUn™S”v”
 
£rv”2
 = 
Ãw
 
	`LogUn™S”v”
(
£rv”CÚ‹xt
);

258 
£rv”Rou‹r
.
	`»£t
();

259 
£rv”Rou‹r
.
	`addS”v”
(
£rv”2
);

261 
	`as£¹Th©
(
£rv”2
.
	`g‘D©aCache
().
	`g‘Size
()).
	`isEqu®To
(0);

262 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

263 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

264 
	`as£¹Th©
(
£rv”2
.
	`g‘D©aCache
().
	`g‘Size
()).
	`isEqu®To
(1);

265 
ş›Á
.
	`æushCache
().
	`g‘
();

266 
	`as£¹Th©
(
£rv”2
.
	`g‘D©aCache
().
	`g‘Size
()).
	`isEqu®To
(0);

267 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

268 
	`as£¹Th©
(
£rv”2
.
	`g‘D©aCache
().
	`g‘Size
()).
	`isEqu®To
(1);

269 
	}
}

271 @
Te¡


272 
public
 
	$ÿnR—dWr™eRªked
()

273 
throws
 
Exû±iÚ
 {

274 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

276 
ş›Á
.
	`wr™e
(0, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(1), 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

277 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

278 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

279 .
	`isEqu®To
(
D©aTy³
.
DATA
);

280 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
()))

281 .
	`isEqu®To
(
‹¡SŒšg
);

283 
by‹
[] 
‹¡SŒšg2
 = "h–lØwÜld 2".
	`g‘By‹s
();

284 
ş›Á
.
	`wr™e
(0, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(2), 
‹¡SŒšg2
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

285 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

286 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

287 .
	`isEqu®To
(
D©aTy³
.
DATA
);

288 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
()))

289 .
	`isEqu®To
(
‹¡SŒšg2
);

290 
	}
}

293 @
Te¡


294 
public
 
	$ÿÂÙOuŒªk
(è
throws
 
ExecutiÚExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

295 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

297 
ş›Á
.
	`wr™e
(0, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(2), 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

298 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

299 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

300 .
	`isEqu®To
(
D©aTy³
.
DATA
);

301 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
()))

302 .
	`isEqu®To
(
‹¡SŒšg
);

304 
by‹
[] 
‹¡SŒšg2
 = "h–lØwÜld 2".
	`g‘By‹s
();

305 
Œy
 {

306 
ş›Á
.
	`wr™e
(0, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(1), 
‹¡SŒšg2
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

307 
	`ç
();

308 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

310 
	`as£¹Equ®s
(
D©aOuŒªkedExû±iÚ
.
şass
, 
e
.
	`g‘Cau£
().
	`g‘CÏss
());

312 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

313 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

314 .
	`isEqu®To
(
D©aTy³
.
DATA
);

315 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
()))

316 .
	`isEqu®To
(
‹¡SŒšg
);

317 
	}
}

319 @
Te¡


320 
public
 
	$v®ueCªBeAdİ‹d
(è
throws
 
ExecutiÚExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

321 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

323 
ş›Á
.
	`wr™e
(0, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(1), 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

324 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

325 
	`as£¹Th©
(
r
.
	`g‘Ty³
()è.
	`isEqu®To
(
D©aTy³
.
DATA
);

326 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
()))

327 .
	`isEqu®To
(
‹¡SŒšg
);

329 
Œy
 {

330 
ILogD©a
 
d©a
 = 
	`ü—‹Em±yD©a
(0, 
D©aTy³
.
RANK_ONLY
, 
Ãw
 
IM‘ad©a
.
	`D©aRªk
(2)).
	`g‘S”Ÿlized
();

331 
ş›Á
.
	`wr™e
(
d©a
).
	`g‘
();

332 
	`ç
();

333 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

335 
	`as£¹Equ®s
(
V®ueAdİ‹dExû±iÚ
.
şass
, 
e
.
	`g‘Cau£
().
	`g‘CÏss
());

336 
V®ueAdİ‹dExû±iÚ
 
ex
 = (V®ueAdİ‹dExû±iÚ)
e
.
	`g‘Cau£
();

337 
R—dRe¥Ú£
 
»ad
 = 
ex
.
	`g‘R—dRe¥Ú£
();

338 
LogD©a
 
log
 = 
»ad
.
	`g‘Add»s£s
().
	`g‘
(0l);

339 
	`as£¹Th©
(
log
.
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
);

340 
	`as£¹Th©
(
log
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
())).
	`isEqu®To
(
‹¡SŒšg
);;

342 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

343 
	`as£¹Th©
(
r
.
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
);

344 
	`as£¹Th©
(
r
.
	`g‘Paylßd
(
Ãw
 
	`CÜfuRuÁime
())).
	`isEqu®To
(
‹¡SŒšg
);

345 
	}
}

347 
´iv©e
 
	gILogD©a
.
S”Ÿliz©iÚHªdË
 
	$ü—‹Em±yD©a
(
pos™iÚ
, 
D©aTy³
 
ty³
, 
IM‘ad©a
.
D©aRªk
 
¿nk
) {

348 
ILogD©a
 
d©a
 = 
Ãw
 
	`LogD©a
(
ty³
);

349 
d©a
.
	`£tRªk
(
¿nk
);

350 
d©a
.
	`£tGlob®Add»ss
(
pos™iÚ
);

351  
d©a
.
	`g‘S”ŸlizedFÜm
();

352 
	}
}

354 @
Te¡


355 
public
 
	$ov”wr™eThrowsExû±iÚ
()

356 
throws
 
Exû±iÚ
 {

357 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

358 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

359 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`wr™e
(0, 
nuÎ
,

360 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
())

361 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

362 .
	`hasCau£In¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

363 
	}
}

365 @
Te¡


366 
public
 
	$hŞeFlCªnÙBeOv”wr™‹n
()

367 
throws
 
Exû±iÚ
 {

368 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

369 
fš®
 
add»ss0
 = 0;

370 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(0, 
add»ss0
);

371 
ş›Á
.
	`wr™e
(
LogD©a
.
	`g‘HŞe
(
tok’
)).
	`g‘
();

372 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(
add»ss0
).
	`g‘
().
	`g‘Add»s£s
().get(0L);

373 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

374 .
	`isEqu®To
(
D©aTy³
.
HOLE
);

375 
	`as£¹Th©
(
r
.
	`g‘Glob®Add»ss
()).
	`isEqu®To
(
add»ss0
);

377 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`wr™e
(
add»ss0
, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
())

378 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

379 .
	`hasCau£In¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

380 
	}
}

382 @
Te¡


383 
public
 
	$hŞeFlCªnÙOv”wr™e
()

384 
throws
 
Exû±iÚ
 {

385 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

386 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

388 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

389 
	`as£¹Th©
(
r
.
	`g‘Ty³
())

390 .
	`isEqu®To
(
D©aTy³
.
DATA
);

392 
CÚd™iÚ
<
ThrowabË
> 
cÚd™iÚOv”wr™e
 = 
Ãw
 CÚd™iÚ<>(
e
 -> {

393 ià(
e
.
	`g‘Cau£
().
	`g‘CÏss
().
	`equ®s
(
Ov”wr™eExû±iÚ
.
şass
)) {

394 
Ov”wr™eExû±iÚ
 
Û
 = (Ov”wr™eExû±iÚè
e
.
	`g‘Cau£
();

395  
Û
.
	`g‘Ov”Wr™eCau£
().
	`g‘Id
(è=ğ
Ov”wr™eCau£
.
DIFF_DATA
.getId();

397  
çl£
;

400 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(0, 0);

401 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`wr™e
(
LogD©a
.
	`g‘HŞe
(
tok’
)).
	`g‘
())

402 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

403 .
	`hasCau£In¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
)

404 .
	`has
(
cÚd™iÚOv”wr™e
);

405 
	}
}

407 @
Te¡


408 
public
 
	$muÉiR—dTe¡
(è
throws
 
Exû±iÚ
 {

409 
by‹
[] 
·ylßd
 = "·ylßd".
	`g‘By‹s
();

411 
CÜfuRuÁimeP¬am‘”s
 
p
 = CÜfuRuÁimeP¬am‘”s.
	`bud”
().
	`bud
();

412 
fš®
 
numB©ches
 = 3;

413 
x
 = 0; x < 
numB©ches
 * 
p
.
	`g‘BulkR—dSize
(); x++) {

414 
ş›Á
.
	`wr™e
(
x
, 
nuÎ
, 
·ylßd
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

418 
Li¡
<
LÚg
> 
h®fB©ch
 = 
Ãw
 
A¼ayLi¡
<>();

419 
fš®
 
h®f
 = 
p
.
	`g‘BulkR—dSize
() / 2;

420 
x
 = 0; x < 
h®f
; x++) {

421 
h®fB©ch
.
	`add
(
x
);

424 
R—dRe¥Ú£
 
»¥
 = 
ş›Á
.
	`»adAÎ
(
h®fB©ch
).
	`g‘
();

425 
	`as£¹Th©
(
»¥
.
	`g‘Add»s£s
().
	`size
()).
	`isEqu®To
(
h®f
);

428 
Li¡
<
LÚg
> 
twoB©chAdd»s£s
 = 
Ãw
 
A¼ayLi¡
<>();

429 
fš®
 
twoB©ches
 = 
p
.
	`g‘BulkR—dSize
() * 2;

430 
x
 = 0; x < 
twoB©ches
; x++) {

431 
twoB©chAdd»s£s
.
	`add
(
x
);

434 
»¥
 = 
ş›Á
.
	`»adAÎ
(
twoB©chAdd»s£s
).
	`g‘
();

435 
	`as£¹Th©
(
»¥
.
	`g‘Add»s£s
().
	`size
()).
	`isEqu®To
(
twoB©ches
);

436 
	}
}

438 @
Te¡


439 
public
 
	$backpoš‹rsCªBeWr™‹nAndR—d
()

440 
throws
 
Exû±iÚ
 {

441 
fš®
 
ADDRESS_0
 = 1337L;

442 
fš®
 
ADDRESS_1
 = 1338L;

444 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

445 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
,

446 
ImmubËM­
.<
UUID
, 
LÚg
>
	`bud”
()

447 .
	`put
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("h–lo"), 
ADDRESS_0
)

448 .
	`put
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("h–lo2"), 
ADDRESS_1
)

449 .
	`bud
()).
	`g‘
();

451 
LogD©a
 
r
 = 
ş›Á
.
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

452 
	`as£¹Th©
(
r
.
	`g‘Backpoš‹rM­
())

453 .
	`cÚšsEÁry
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("h–lo"), 
ADDRESS_0
);

454 
	`as£¹Th©
(
r
.
	`g‘Backpoš‹rM­
())

455 .
	`cÚšsEÁry
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("h–lo2"), 
ADDRESS_1
);

456 
	}
}

458 @
Te¡


459 
public
 
	$CÜru±edD©aR—dThrowsExû±iÚ
(è
throws
 
Exû±iÚ
 {

460 
by‹
[] 
‹¡SŒšg
 = "h–lØwÜld".
	`g‘By‹s
();

461 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

462 
ş›Á
.
	`wr™e
(
SŒ—mLogFes
.
RECORDS_PER_LOG_FILE
 + 1, 
nuÎ
,

463 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

466 
SŒšg
 
logDœ
 = 
£rv”CÚ‹xt
.
	`g‘S”v”CÚfig
().
	`g‘
("--log-·th"è+ 
Fe
.
£·¿tÜ
 + "log";

467 
SŒšg
 
logFeP©h
 = 
logDœ
 + 
Fe
.
£·¿tÜ
 + "0.log";

468 
RªdomAcûssFe
 
fe
 = 
Ãw
 
	`RªdomAcûssFe
(
logFeP©h
, "rw");

470 
By‹Bufãr
 
m‘aD©aBuf
 = By‹Bufãr.
	`®loÿ‹
(
METADATA_SIZE
);

471 
fe
.
	`g‘ChªÃl
().
	`»ad
(
m‘aD©aBuf
);

472 
m‘aD©aBuf
.
	`æ
();

474 
LogUn™S”v”
 
£rv”2
 = 
Ãw
 
	`LogUn™S”v”
(
£rv”CÚ‹xt
);

475 
£rv”Rou‹r
.
	`»£t
();

476 
£rv”Rou‹r
.
	`addS”v”
(
£rv”2
);

478 
Ty³s
.
M‘ad©a
 
m‘ad©a
 = Ty³s.M‘ad©a.
	`·r£From
(
m‘aD©aBuf
.
	`¬¿y
());

479 
fš®
 
feOff£t
 = 
IÁeg”
.
BYTES
 + 
METADATA_SIZE
 + 
m‘ad©a
.
	`g‘L’gth
() + 20;

480 
fš®
 
CORRUPT_BYTES
 = 0xFFFF;

481 
fe
.
	`£ek
(
feOff£t
);

482 
fe
.
	`wr™eIÁ
(
CORRUPT_BYTES
);

483 
fe
.
	`şo£
();

486 
	`as£¹Th©ThrownBy
((è-> 
ş›Á
.
	`»ad
(0).
	`g‘
())

487 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

488 .
	`hasCau£In¡ªûOf
(
D©aCÜru±iÚExû±iÚ
.
şass
);

489 
	}
}

497 @
Te¡


498 
public
 
	$logD©aWr™‹nIsEqu®ToLogD©aR—d
(è
throws
 
Exû±iÚ
 {

499 
add»ss
 = 0L;

500 
LogD©a
 
ld
 = 
	`g‘LogD©aW™houtId
(
add»ss
);

502 
ld
.
	`£tId
(
ş›ÁId1
);

503 
ş›Á
.
	`wr™e
(
ld
).
	`još
();

505 
LogD©a
 
ldPrime
 = 
ş›Á
.
	`»ad
(
add»ss
).
	`g‘
().
	`g‘Add»s£s
().get(address);

507 
	`as£¹Th©
(
ld
).
	`isEqu®To
(
ldPrime
);

508 
	`as£¹Th©
(
ldPrime
.
	`g‘M‘ad©aM­
().
	`g‘
(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
CLIENT_ID
))

509 .
	`isEqu®To
(
ş›ÁId1
);

510 
	`as£¹Th©
(
ldPrime
.
	`g‘M‘ad©aM­
().
	`g‘
(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
THREAD_ID
))

511 .
	`isEqu®To
(
Th»ad
.
	`cu¼’tTh»ad
().
	`g‘Id
());

512 
	}
}

519 @
Te¡


520 
public
 
	$logD©aWr™‹nFromOth”Th»adIsNÙEqu®
(è
throws
 
Exû±iÚ
 {

521 
add»ss
 = 0L;

522 
LogD©a
 
ldThisTh»ad
 = 
	`g‘LogD©aW™houtId
(
add»ss
);

523 
ldThisTh»ad
.
	`£tId
(
ş›ÁId1
);

524 
LogD©a
 
ldOth”Th»ad
 = 
	`g‘LogD©aW™houtId
(
add»ss
);

527 
	`t1
((è-> 
ldOth”Th»ad
.
	`£tId
(
ş›ÁId1
));

528 
ş›Á
.
	`wr™e
(
ldOth”Th»ad
).
	`još
();

530 
LogD©a
 
ldPrime
 = 
ş›Á
.
	`»ad
(
add»ss
).
	`g‘
().
	`g‘Add»s£s
().get(address);

531 
	`as£¹Th©
(
ldThisTh»ad
).
	`isNÙEqu®To
(
ldPrime
);

532 
	`as£¹Th©
(
ldOth”Th»ad
).
	`isEqu®To
(
ldPrime
);

533 
	}
}

540 @
Te¡


541 
public
 
	$logD©aWr™‹nW™hOth”Cl›ÁIdIsNÙEqu®
(è
throws
 
Exû±iÚ
 {

542 
add»ss
 = 0L;

544 
LogD©a
 
ldOÃ
 = 
	`g‘LogD©aW™houtId
(
add»ss
);

545 
LogD©a
 
ldTwo
 = 
	`g‘LogD©aW™houtId
(
add»ss
);

547 
ldOÃ
.
	`£tId
(
ş›ÁId1
);

548 
ldTwo
.
	`£tId
(
ş›ÁId2
);

550 
ş›Á
.
	`wr™e
(
ldOÃ
).
	`još
();

552 
LogD©a
 
ldR—d
 = 
ş›Á
.
	`»ad
(
add»ss
).
	`g‘
().
	`g‘Add»s£s
().get(address);

553 
	`as£¹Th©
(
ldR—d
).
	`isEqu®To
(
ldOÃ
);

554 
	`as£¹Th©
(
ldR—d
).
	`isNÙEqu®To
(
ldTwo
);

555 
	}
}

561 @
Te¡


562 
public
 
	$ÿnQu”yLogTa
(è
throws
 
Exû±iÚ
 {

563 
fš®
 
numEÁr›s
 = 2L;

566 
by‹
[] 
‹¡SŒšg
 = "h–lo".
	`g‘By‹s
();

567 
by‹
[] 
‹¡SŒšg2
 = "wÜld".
	`g‘By‹s
();

568 
ş›Á
.
	`wr™e
(0, 
nuÎ
, 
‹¡SŒšg
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

569 
ş›Á
.
	`wr™e
(1, 
nuÎ
, 
‹¡SŒšg2
, 
CŞËùiÚs
.
	`em±yM­
()).
	`g‘
();

571 
Com¶‘abËFutu»
<
TasRe¥Ú£
> 
cf
 = 
ş›Á
.
	`g‘LogTa
();

572 

 = 
cf
.
	`g‘
().
	`g‘LogTa
();

573 
	`as£¹Th©
(

).
	`isEqu®To
(
numEÁr›s
-1);

574 
	}
}

580 @
Te¡


581 
public
 
	$ÿnQu”ySŒ—mAdd»ssS·ûAndLogS·û
(è
throws
 
Exû±iÚ
 {

582 
fš®
 
UUID
 
¡»amId
 = UUID.
	`¿ndomUUID
();

583 
fš®
 
numEÁr›s
 = 2L;

584 
fš®
 
add»ssOÃ
 = 0L;

585 
fš®
 
add»ssTwo
 = 1L;

589 
LogD©a
 
ldOÃ
 = 
	`g‘LogD©aW™houtId
(
add»ssOÃ
);

590 
M­
<
UUID
, 
LÚg
> 
backpoš‹rM­
 = 
Ãw
 
HashM­
<>();

591 
backpoš‹rM­
.
	`put
(
¡»amId
, 
Add»ss
.
NON_EXIST
);

592 
ldOÃ
.
	`£tBackpoš‹rM­
(
backpoš‹rM­
);

593 
ş›Á
.
	`wr™e
(
ldOÃ
).
	`još
();

596 
LogD©a
 
ldTwo
 = 
	`g‘LogD©aW™houtId
(
add»ssTwo
);

597 
backpoš‹rM­
 = 
Ãw
 
HashM­
<>();

598 
backpoš‹rM­
.
	`put
(
¡»amId
, 
add»ssOÃ
);

599 
ldTwo
.
	`£tBackpoš‹rM­
(
backpoš‹rM­
);

600 
ş›Á
.
	`wr™e
(
ldTwo
).
	`još
();

603 
SŒ—mAdd»ssS·û
 
add»ssS·û
 = 
ş›Á
.
	`g‘LogAdd»ssS·û
().
	`još
().
	`g‘Add»ssM­
().
	`g‘
(
¡»amId
);

604 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

605 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
numEÁr›s
);

606 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`cÚšs
(
add»ssOÃ
));

609 
Com¶‘abËFutu»
<
SŒ—msAdd»ssRe¥Ú£
> 
cfLog
 = 
ş›Á
.
	`g‘LogAdd»ssS·û
();

610 
SŒ—msAdd»ssRe¥Ú£
 
»¥Ú£
 = 
cfLog
.
	`g‘
();

611 
add»ssS·û
 = 
»¥Ú£
.
	`g‘Add»ssM­
().
	`g‘
(
¡»amId
);

612 
	`as£¹Th©
(
add»ssS·û
.
	`g‘TrimM¬k
()).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

613 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`g‘LÚgC¬dš®™y
()).
	`isEqu®To
(
numEÁr›s
);

614 
	`as£¹Th©
(
add»ssS·û
.
	`g‘Add»ssM­
().
	`cÚšs
(
add»ssOÃ
));

615 
	`as£¹Th©
(
»¥Ú£
.
	`g‘LogTa
()).
	`isEqu®To
(
add»ssTwo
);

616 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/ManagementHandlerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gBa£S”v”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLayoutS”v”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gMªagem’tS”v”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gÜche¡¿tÜ
.
	gQu”yRe¥Ú£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

19 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

22 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

23 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

26 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

27 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

34 
public
 cÏs 
	cMªagem’tHªdËrTe¡
 
ex‹nds
 
	mAb¡¿ùCl›ÁTe¡
 {

36 
´iv©e
 
Mªagem’tCl›Á
 
	mş›Á
;

37 
´iv©e
 
Mªagem’tS”v”
 
	m£rv”
;

39 @
Ov”ride


40 
	mS‘
<
	mAb¡¿ùS”v”
> 
	$g‘S”v”sFÜTe¡
() {

41 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

42 .
	`£tMemÜy
(
Œue
)

43 .
	`£tSšgË
(
Œue
)

44 .
	`£tS”v”Rou‹r
(
£rv”Rou‹r
)

45 .
	`£tPÜt
(
SERVERS
.
PORT_0
)

46 .
	`bud
();

47 
£rv”
 = 
Ãw
 
	`Mªagem’tS”v”
(
£rv”CÚ‹xt
);

48 
M‘ricRegi¡ry
 
m‘ricRegi¡ry
 = 
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
();

49  
Ãw
 
ImmubËS‘
.
Bud”
<
Ab¡¿ùS”v”
>()

50 .
	`add
(
£rv”
)

52 .
	`add
(
Ãw
 
	`LayoutS”v”
(
£rv”CÚ‹xt
))

54 .
	`add
(
Ãw
 
	`Sequ’ûrS”v”
(
£rv”CÚ‹xt
))

55 .
	`add
(
Ãw
 
	`LogUn™S”v”
(
£rv”CÚ‹xt
))

56 .
	`add
(
Ãw
 
	`Ba£S”v”
(
£rv”CÚ‹xt
))

57 .
	`bud
();

60 @
Ov”ride


61 
S‘
<
ICl›Á
> 
	$g‘Cl›ÁsFÜTe¡
() {

62 
Mªagem’tHªdËr
 
mªagem’tHªdËr
 = 
Ãw
 
	`Mªagem’tHªdËr
();

63 
ş›Á
 = 
Ãw
 
	`Mªagem’tCl›Á
(
rou‹r
, 0L);

64  
Ãw
 
ImmubËS‘
.
Bud”
<
ICl›Á
>()

65 .
	`add
(
Ãw
 
	`Ba£HªdËr
())

66 .
	`add
(
mªagem’tHªdËr
)

67 .
	`bud
();

68 
	}
}

73 @
Aá”


74 
public
 
	$ş—nUp
() {

75 
£rv”
.
	`shutdown
();

76 
	}
}

83 @
Te¡


84 
public
 
	$hªdËBoÙ¡¿p
()

85 
throws
 
Exû±iÚ
 {

87 
	`as£¹Th©ThrownBy
(() ->

88 
ş›Á
.
	`boÙ¡¿pMªagem’t
(
Te¡LayoutBud”
.
	`sšgË
(
SERVERS
.
PORT_0
)).
	`g‘
())

89 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
);

90 
	}
}

92 @
Te¡


93 
public
 
	$qu”yWÜkæowRPCTe¡
(è
throws
 
Exû±iÚ
 {

95 
Qu”yRe¥Ú£
 
»¥
 = 
ş›Á
.
	`qu”yReque¡
(
UUID
.
	`¿ndomUUID
());

96 
	`as£¹Th©
(
»¥
.
	`isAùive
()).
	`isF®£
();

97 
	}
}

104 @
Te¡


105 
public
 
	$£ndNodeS‹Reque¡
()

106 
throws
 
Exû±iÚ
 {

107 
NodeS‹
 
nodeS‹
ğ
ş›Á
.
	`£ndNodeS‹Reque¡
().
	`g‘
();

108 
	`as£¹Th©
(
nodeS‹
).
	`isNÙNuÎ
();

109 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/NettyCommTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gboÙ¡¿p
.
	gS”v”BoÙ¡¿p
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlFutu»
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gBa£S”v”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gCÜfuS”v”Node
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gN‘tyS”v”Rou‹r
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gRuË
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gruËs
.
	gTempÜ¬yFŞd”
;

19 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

20 
impÜt
 
	gjava
.
	gio
.
	gFe
;

21 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

22 
impÜt
 
	gjava
.
	gÃt
.
	gS”v”Sock‘
;

23 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

24 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gSnd¬dCİyO±iÚ
;

25 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

26 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

28 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

33 @
Slf4j


34 
public
 cÏs 
	cN‘tyCommTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

36 @
RuË


37 
public
 
TempÜ¬yFŞd”
 
	m»lßdFŞd”
 = 
Ãw
 TemporaryFolder();

40 
´iv©e
 
IÁeg”
 
	$fšdRªdomO³nPÜt
(è
throws
 
IOExû±iÚ
 {

41 
	`Œy
 (

42 
S”v”Sock‘
 
sock‘
 = 
Ãw
 
	`S”v”Sock‘
(0);

44  
sock‘
.
	`g‘LoÿlPÜt
();

48 
´iv©e
 
Ba£Cl›Á
 
	$g‘Ba£Cl›Á
(
ICl›ÁRou‹r
 
rou‹r
) {

49  
Ãw
 
	`Ba£Cl›Á
(
rou‹r
, 0L);

50 
	}
}

52 @
Te¡


53 
public
 
	$Ã‰yS”v”Cl›ÁPšgabË
(è
throws
 
Exû±iÚ
 {

54 
	`runW™hBa£S”v”
(

55 (
pÜt
) -> {

56  
Ãw
 
	`N‘tyS”v”D©a
(
S”v”CÚ‹xtBud”
.
	`deçuÉCÚ‹xt
(
pÜt
));

58 (
pÜt
) -> {

59  
Ãw
 
	`N‘tyCl›ÁRou‹r
("loÿlho¡", 
pÜt
);

61 (
r
, 
d
) -> {

62 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

63 .
	`isTrue
();

65 
	}
}

67 @
Te¡


68 
public
 
	$Ã‰yS”v”Cl›ÁPšgabËAá”Fau»
(è
throws
 
Exû±iÚ
 {

69 
	`runW™hBa£S”v”
(

70 (
pÜt
) -> {

71  
Ãw
 
	`N‘tyS”v”D©a
(
S”v”CÚ‹xtBud”
.
	`deçuÉCÚ‹xt
(
pÜt
));

73 (
pÜt
) -> {

74  
Ãw
 
	`N‘tyCl›ÁRou‹r
("loÿlho¡", 
pÜt
);

76 (
r
, 
d
) -> {

77 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

78 .
	`isTrue
();

79 
d
.
	`shutdownS”v”
();

80 
d
.
	`boÙ¡¿pS”v”
();

82 
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
();

84 
	}
}

86 @
Te¡


87 
public
 
	$Ã‰yTlsNoMutu®Auth
(è
throws
 
Exû±iÚ
 {

88 
	`runW™hBa£S”v”
(

89 (
pÜt
) -> {

90 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
(

91 
Ãw
 
	`S”v”CÚ‹xtBud”
()

92 .
	`£tTlsEÇbËd
(
Œue
)

93 .
	`£tIm¶em’tiÚ
("auto")

94 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

95 .
	`£tTlsPrÙocŞs
("TLSv1.2")

96 .
	`£tKey¡Üe
("src/test/resources/security/s1.jks")

97 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

98 .
	`£tTru¡¡Üe
("src/test/resources/security/s1.jks")

99 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

100 .
	`£tPÜt
(
pÜt
)

101 .
	`bud
()

103  
d
;

105 (
pÜt
è-> 
Ãw
 
	`N‘tyCl›ÁRou‹r
(

106 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

107 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

108 .
	`sEÇbËd
(
Œue
)

109 .
	`keyStÜe
("src/test/resources/security/r1.jks")

110 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

111 .
	`Œu¡StÜe
("src/test/resources/security/trust1.jks")

112 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

113 .
	`bud
())

115 (
r
, 
d
) -> {

116 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

117 .
	`isTrue
();

119 
	}
}

121 @
Te¡


122 
public
 
	$Ã‰yTlsMutu®Auth
(è
throws
 
Exû±iÚ
 {

123 
	`runW™hBa£S”v”
(

124 (
pÜt
) -> {

125 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
Òew 
	`S”v”CÚ‹xtBud”
()

126 .
	`£tIm¶em’tiÚ
("auto")

127 .
	`£tTlsEÇbËd
(
Œue
)

128 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

129 .
	`£tTlsPrÙocŞs
("TLSv1.2")

130 .
	`£tKey¡Üe
("src/test/resources/security/s1.jks")

131 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

132 .
	`£tTru¡¡Üe
("src/test/resources/security/trust1.jks")

133 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

134 .
	`£tTlsMutu®AuthEÇbËd
(
Œue
)

135 .
	`£tPÜt
(
pÜt
)

136 .
	`bud
());

137  
d
;

139 (
pÜt
) -> {

140  
Ãw
 
	`N‘tyCl›ÁRou‹r
(

141 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

142 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

143 .
	`sEÇbËd
(
Œue
)

144 .
	`keyStÜe
("src/test/resources/security/r1.jks")

145 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

146 .
	`Œu¡StÜe
("src/test/resources/security/trust1.jks")

147 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

148 .
	`bud
());

150 (
r
, 
d
) -> {

151 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

152 .
	`isTrue
();

154 
	}
}

156 @
Te¡


157 
public
 
	$Ã‰yTlsUnknownS”v”
(è
throws
 
Exû±iÚ
 {

158 
	`runW™hBa£S”v”
(

159 (
pÜt
) -> {

160 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
Òew 
	`S”v”CÚ‹xtBud”
()

161 .
	`£tIm¶em’tiÚ
("auto")

162 .
	`£tTlsEÇbËd
(
Œue
)

163 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

164 .
	`£tTlsPrÙocŞs
("TLSv1.2")

165 .
	`£tKey¡Üe
("src/test/resources/security/s3.jks")

166 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

167 .
	`£tTru¡¡Üe
("src/test/resources/security/trust1.jks")

168 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

169 .
	`£tSa¦PÏšTextAuth
(
çl£
)

170 .
	`£tPÜt
(
pÜt
)

171 .
	`bud
());

172  
d
;

174 (
pÜt
) -> {

175  
Ãw
 
	`N‘tyCl›ÁRou‹r
(

176 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

177 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

178 .
	`sEÇbËd
(
Œue
)

179 .
	`keyStÜe
("src/test/resources/security/r1.jks")

180 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

181 .
	`Œu¡StÜe
("src/test/resources/security/trust2.jks")

182 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

183 .
	`bud
());

185 (
r
, 
d
) -> {

186 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

187 .
	`isF®£
();

189 
	}
}

191 @
Te¡


192 
public
 
	$Ã‰yTlsUnknownCl›Á
(è
throws
 
Exû±iÚ
 {

193 
	`runW™hBa£S”v”
(

194 (
pÜt
) -> {

195 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
Òew 
	`S”v”CÚ‹xtBud”
()

196 .
	`£tIm¶em’tiÚ
("auto")

197 .
	`£tTlsEÇbËd
(
Œue
)

198 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

199 .
	`£tTlsPrÙocŞs
("TLSv1.2")

200 .
	`£tKey¡Üe
("src/test/resources/security/s1.jks")

201 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

202 .
	`£tTru¡¡Üe
("src/test/resources/security/trust2.jks")

203 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

204 .
	`£tTlsMutu®AuthEÇbËd
(
Œue
)

205 .
	`£tPÜt
(
pÜt
)

206 .
	`bud
());

207  
d
;

209 (
pÜt
) -> {

210  
Ãw
 
	`N‘tyCl›ÁRou‹r
(

211 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

212 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

213 .
	`sEÇbËd
(
Œue
)

214 .
	`keyStÜe
("src/test/resources/security/r2.jks")

215 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

216 .
	`Œu¡StÜe
("src/test/resources/security/trust1.jks")

217 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

218 .
	`bud
());

220 (
r
, 
d
) -> {

221 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

222 .
	`isF®£
();

224 
	}
}

226 @
Te¡


227 
public
 
	$Ã‰yTlsUnknownCl›ÁNoMutu®Auth
(è
throws
 
Exû±iÚ
 {

228 
	`runW™hBa£S”v”
(

229 (
pÜt
) -> {

230 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
Òew 
	`S”v”CÚ‹xtBud”
()

231 .
	`£tIm¶em’tiÚ
("auto")

232 .
	`£tTlsEÇbËd
(
Œue
)

233 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

234 .
	`£tTlsPrÙocŞs
("TLSv1.2")

235 .
	`£tKey¡Üe
("src/test/resources/security/s1.jks")

236 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

237 .
	`£tTru¡¡Üe
("src/test/resources/security/trust2.jks")

238 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

239 .
	`£tPÜt
(
pÜt
)

240 .
	`bud
());

241  
d
;

243 (
pÜt
) -> {

244  
Ãw
 
	`N‘tyCl›ÁRou‹r
(

245 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

246 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

247 .
	`sEÇbËd
(
Œue
)

248 .
	`keyStÜe
("src/test/resources/security/r2.jks")

249 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

250 .
	`Œu¡StÜe
("src/test/resources/security/trust1.jks")

251 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

252 .
	`bud
());

254 (
r
, 
d
) -> {

255 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

256 .
	`isTrue
();

258 
	}
}

260 @
Te¡


261 
public
 
	$Ã‰ySa¦
(è
throws
 
Exû±iÚ
 {

262 
	`runW™hBa£S”v”
(

263 (
pÜt
) -> {

264 
Sy¡em
.
	`£tPrİ”ty
("java.security.auth.login.config",

266 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
Òew 
	`S”v”CÚ‹xtBud”
()

267 .
	`£tIm¶em’tiÚ
("auto")

268 .
	`£tTlsEÇbËd
(
Œue
)

269 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

270 .
	`£tTlsPrÙocŞs
("TLSv1.2")

271 .
	`£tKey¡Üe
("src/test/resources/security/s1.jks")

272 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

273 .
	`£tTru¡¡Üe
("src/test/resources/security/trust1.jks")

274 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

275 .
	`£tSa¦PÏšTextAuth
(
Œue
)

276 .
	`£tPÜt
(
pÜt
)

277 .
	`bud
());

278  
d
;

280 (
pÜt
) -> {

281  
Ãw
 
	`N‘tyCl›ÁRou‹r
(

282 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

283 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

284 .
	`sEÇbËd
(
Œue
)

285 .
	`keyStÜe
("src/test/resources/security/r1.jks")

286 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

287 .
	`Œu¡StÜe
("src/test/resources/security/trust1.jks")

288 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

289 .
	`§¦PÏšTextEÇbËd
(
Œue
)

290 .
	`u£ºameFe
("src/test/resources/security/username1")

291 .
	`·sswÜdFe
("src/test/resources/security/userpass1")

292 .
	`bud
());

294 (
r
, 
d
) -> {

295 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

296 .
	`isTrue
();

298 
	}
}

300 @
Te¡


301 
public
 
	$Ã‰yS”v”Cl›ÁHªdshakeDeçuÉId
(è
throws
 
Exû±iÚ
 {

302 
	`runW™hBa£S”v”
(

303 (
pÜt
) -> {

304  
Ãw
 
	`N‘tyS”v”D©a
(
S”v”CÚ‹xtBud”
.
	`deçuÉCÚ‹xt
(
pÜt
));

306 (
pÜt
) -> {

307 
NodeLoÿtÜ
 
Æ
 = NodeLoÿtÜ.
	`bud”
()

308 .
	`ho¡
("localhost")

309 .
	`pÜt
(
pÜt
)

310 .
	`nodeId
(
UUID
.
	`äomSŒšg
("00000000-0000-0000-0000-000000000000"))

311 .
	`bud
();

312  
Ãw
 
	`N‘tyCl›ÁRou‹r
(
Æ
, 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

314 (
r
, 
d
) -> {

315 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

316 .
	`isTrue
();

318 
	}
}

320 
´iv©e
 
UUID
 
	gnodeId
;

322 @
Te¡


323 
public
 
	$Ã‰yS”v”Cl›ÁHªdshakeM©chIds
(è
throws
 
Exû±iÚ
 {

324 
	`runW™hBa£S”v”
(

325 (
pÜt
) -> {

326 
S”v”CÚ‹xt
 
sc
 = 
S”v”CÚ‹xtBud”


327 .
	`deçuÉCÚ‹xt
(
pÜt
);

328 
nodeId
 = 
sc
.
	`g‘NodeId
();

329  
Ãw
 
	`N‘tyS”v”D©a
(
sc
);

331 (
pÜt
) -> {

332 
NodeLoÿtÜ
 
Æ
 = NodeLoÿtÜ.
	`bud”
()

333 .
	`ho¡
("localhost")

334 .
	`pÜt
(
pÜt
)

335 .
	`nodeId
(
nodeId
)

336 .
	`bud
();

337  
Ãw
 
	`N‘tyCl›ÁRou‹r
(
Æ
, 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

339 (
r
, 
d
) -> {

340 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

341 .
	`isTrue
();

343 
	}
}

345 @
Te¡


346 
public
 
	$Ã‰yS”v”Cl›ÁHªdshakeMism©chId
(è
throws
 
Exû±iÚ
 {

347 
	`runW™hBa£S”v”
(

348 (
pÜt
) -> {

349  
Ãw
 
	`N‘tyS”v”D©a
(
S”v”CÚ‹xtBud”
.
	`deçuÉCÚ‹xt
(
pÜt
));

351 (
pÜt
) -> {

352 
NodeLoÿtÜ
 
Æ
 = NodeLoÿtÜ.
	`bud”
()

353 .
	`ho¡
("localhost")

354 .
	`pÜt
(
pÜt
)

355 .
	`nodeId
(
UUID
.
	`ÇmeUUIDFromBy‹s
("‹¡".
	`g‘By‹s
()))

356 .
	`bud
();

357  
Ãw
 
	`N‘tyCl›ÁRou‹r
(
Æ
, 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
());

359 (
r
, 
d
) -> {

360 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

361 .
	`isF®£
();

363 
	}
}

365 @
Te¡


366 
public
 
	$Ã‰ySa¦WrÚgPasswÜd
(è
throws
 
Exû±iÚ
 {

367 
	`runW™hBa£S”v”
(

368 (
pÜt
) -> {

369 
Sy¡em
.
	`£tPrİ”ty
("java.security.auth.login.config",

371 
N‘tyS”v”D©a
 
d
 = 
Ãw
 
	`N‘tyS”v”D©a
Òew 
	`S”v”CÚ‹xtBud”
()

372 .
	`£tIm¶em’tiÚ
("auto")

373 .
	`£tTlsEÇbËd
(
Œue
)

374 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

375 .
	`£tTlsPrÙocŞs
("TLSv1.2")

376 .
	`£tKey¡Üe
("src/test/resources/security/s1.jks")

377 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/storepass")

378 .
	`£tTru¡¡Üe
("src/test/resources/security/trust1.jks")

379 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/storepass")

380 .
	`£tSa¦PÏšTextAuth
(
Œue
)

381 .
	`£tPÜt
(
pÜt
)

382 .
	`bud
());

383  
d
;

385 (
pÜt
) -> {

386  
Ãw
 
	`N‘tyCl›ÁRou‹r
(

387 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

388 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

389 .
	`sEÇbËd
(
Œue
)

390 .
	`keyStÜe
("src/test/resources/security/r1.jks")

391 .
	`ksPasswÜdFe
("src/test/resources/security/storepass")

392 .
	`Œu¡StÜe
("src/test/resources/security/trust1.jks")

393 .
	`tsPasswÜdFe
("src/test/resources/security/storepass")

394 .
	`§¦PÏšTextEÇbËd
(
Œue
)

395 .
	`u£ºameFe
("src/test/resources/security/username1")

396 .
	`·sswÜdFe
("src/test/resources/security/userpass2")

397 .
	`bud
());

399 (
r
, 
d
) -> {

400 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
r
).
	`pšgSync
())

401 .
	`isF®£
();

403 
	}
}

405 @
Te¡


406 
public
 
	$‹¡TlsUpd©eS”v”Tru¡
(è
throws
 
Exû±iÚ
 {

407 
	`»lßdedTru¡Mªag”Te¡H–³r
(
çl£
);

408 
	}
}

410 @
Te¡


411 
public
 
	$‹¡TlsUpd©eCl›ÁTru¡
(è
throws
 
Exû±iÚ
 {

412 
	`»lßdedTru¡Mªag”Te¡H–³r
(
Œue
);

413 
	}
}

422 
´iv©e
 
	$»lßdedTru¡Mªag”Te¡H–³r
(
boŞ—n
 
»¶aûCl›ÁTru¡
è
throws
 
Exû±iÚ
 {

423 
pÜt
 = 
	`fšdRªdomO³nPÜt
();

425 
Fe
 
ş›ÁTru¡NoS”v”
 = 
Ãw
 
	`Fe
("src/test/resources/security/reload/client_trust_no_server.jks");

426 
Fe
 
£rv”Tru¡NoCl›Á
 = 
Ãw
 
	`Fe
("src/test/resources/security/reload/server_trust_no_client.jks");

427 
Fe
 
ş›ÁTru¡W™hS”v”
 = 
Ãw
 
	`Fe
("src/test/resources/security/reload/client_trust_with_server.jks");

428 
Fe
 
£rv”Tru¡W™hCl›Á
 = 
Ãw
 
	`Fe
("src/test/resources/security/reload/server_trust_with_client.jks");

429 
Fe
 
£rv”Tru¡Fe
 = 
»lßdFŞd”
.
	`ÃwFe
("temp_server.jks");

430 
Fe
 
ş›ÁTru¡Fe
 = 
»lßdFŞd”
.
	`ÃwFe
("temp_client.jks");

432 ià(
»¶aûCl›ÁTru¡
) {

433 
Fes
.
	`cİy
(
ş›ÁTru¡NoS”v”
.
	`toP©h
(), 
ş›ÁTru¡Fe
.toP©h(), 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
);

434 
Fes
.
	`cİy
(
£rv”Tru¡W™hCl›Á
.
	`toP©h
(), 
£rv”Tru¡Fe
.toP©h(), 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
);

436 
Fes
.
	`cİy
(
ş›ÁTru¡W™hS”v”
.
	`toP©h
(), 
ş›ÁTru¡Fe
.toP©h(), 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
);

437 
Fes
.
	`cİy
(
£rv”Tru¡NoCl›Á
.
	`toP©h
(), 
£rv”Tru¡Fe
.toP©h(), 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
);

441 
N‘tyS”v”D©a
 
£rv”D©a
 = 
Ãw
 
	`N‘tyS”v”D©a
(

442 
Ãw
 
	`S”v”CÚ‹xtBud”
()

443 .
	`£tIm¶em’tiÚ
("auto")

444 .
	`£tTlsEÇbËd
(
Œue
)

445 .
	`£tTlsCh”s
("TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256")

446 .
	`£tTlsPrÙocŞs
("TLSv1.2")

447 .
	`£tKey¡Üe
("src/test/resources/security/reload/server_key.jks")

448 .
	`£tKey¡ÜePasswÜdFe
("src/test/resources/security/reload/password")

449 .
	`£tTru¡¡Üe
(
£rv”Tru¡Fe
.
	`g‘AbsŞu‹P©h
())

450 .
	`£tTru¡¡ÜePasswÜdFe
("src/test/resources/security/reload/password")

451 .
	`£tTlsMutu®AuthEÇbËd
(
Œue
)

452 .
	`£tPÜt
(
pÜt
)

453 .
	`bud
()

455 
£rv”D©a
.
	`boÙ¡¿pS”v”
();

458 
N‘tyCl›ÁRou‹r
 
ş›ÁRou‹r
 = 
Ãw
 
	`N‘tyCl›ÁRou‹r
(

459 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

460 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

461 .
	`sEÇbËd
(
Œue
)

462 .
	`keyStÜe
("src/test/resources/security/reload/client_key.jks")

463 .
	`ksPasswÜdFe
("src/test/resources/security/reload/password")

464 .
	`Œu¡StÜe
(
ş›ÁTru¡Fe
.
	`g‘AbsŞu‹P©h
())

465 .
	`tsPasswÜdFe
("src/test/resources/security/reload/password")

466 .
	`bud
());

468 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
ş›ÁRou‹r
).
	`pšgSync
()).
	`isF®£
();

469 
ş›ÁRou‹r
.
	`¡İ
();

472 ià(
»¶aûCl›ÁTru¡
) {

473 
Fes
.
	`cİy
(
ş›ÁTru¡W™hS”v”
.
	`toP©h
(), 
ş›ÁTru¡Fe
.toP©h(), 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
);

475 
Fes
.
	`cİy
(
£rv”Tru¡W™hCl›Á
.
	`toP©h
(), 
£rv”Tru¡Fe
.toP©h(), 
Snd¬dCİyO±iÚ
.
REPLACE_EXISTING
);

477 
ş›ÁRou‹r
 = 
Ãw
 
	`N‘tyCl›ÁRou‹r
(

478 
NodeLoÿtÜ
.
	`bud”
().
	`ho¡
("loÿlho¡").
	`pÜt
(
pÜt
).
	`bud
(),

479 
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

480 .
	`sEÇbËd
(
Œue
)

481 .
	`keyStÜe
("src/test/resources/security/reload/client_key.jks")

482 .
	`ksPasswÜdFe
("src/test/resources/security/reload/password")

483 .
	`Œu¡StÜe
(
ş›ÁTru¡Fe
.
	`g‘AbsŞu‹P©h
())

484 .
	`tsPasswÜdFe
("src/test/resources/security/reload/password")

485 .
	`bud
());

486 
ş›ÁRou‹r
.
	`g‘CÚÃùiÚFutu»
().
	`još
();

487 
	`as£¹Th©
(
	`g‘Ba£Cl›Á
(
ş›ÁRou‹r
).
	`pšgSync
()).
	`isTrue
();

488 
ş›ÁRou‹r
.
	`¡İ
();

490 
£rv”D©a
.
	`shutdownS”v”
();

491 
	}
}

493 
´iv©e
 
	$runW™hBa£S”v”
(
N‘tyS”v”D©aCÚ¡ruùÜ
 
nsdc
,

494 
N‘tyCl›ÁRou‹rCÚ¡ruùÜ
 
nüc
,

495 
N‘tyCommFunùiÚ
 
aùiÚFn
è
throws
 
Exû±iÚ
 {

496 
pÜt
 = 
	`fšdRªdomO³nPÜt
();

498 
N‘tyS”v”D©a
 
d
 = 
nsdc
.
	`ü—‹N‘tyS”v”D©a
(
pÜt
);

499 
N‘tyCl›ÁRou‹r
 
nü
 = 
nuÎ
;

500 
Œy
 {

501 
d
.
	`boÙ¡¿pS”v”
();

502 
nü
 = 
nüc
.
	`ü—‹N‘tyCl›ÁRou‹r
(
pÜt
);

503 
nü
.
	`addCl›Á
(
Ãw
 
	`Ba£HªdËr
());

504 
aùiÚFn
.
	`runTe¡
(
nü
, 
d
);

505 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

506 
log
.
	`”rÜ
("Exû±iÚ ", 
ex
);

507 
throw
 
ex
;

508 } 
fš®ly
 {

509 
Œy
 {

510 ià(
nü
 !ğ
nuÎ
) {

511 
nü
.
	`¡İ
();

513 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

514 
log
.
	`w¬n
("E¼Ü shu‰šg dowÀş›Á...", 
ex
);

516 
d
.
	`shutdownS”v”
();

519 
	}
}

521 @
FunùiÚ®IÁ”çû


522 
public
 
š‹rçû
 
	gN‘tyS”v”D©aCÚ¡ruùÜ
 {

523 
N‘tyS”v”D©a
 
ü—‹N‘tyS”v”D©a
(
pÜt
è
throws
 
	gExû±iÚ
;

526 @
FunùiÚ®IÁ”çû


527 
public
 
š‹rçû
 
	gN‘tyCl›ÁRou‹rCÚ¡ruùÜ
 {

528 
N‘tyCl›ÁRou‹r
 
ü—‹N‘tyCl›ÁRou‹r
(
pÜt
è
throws
 
	gExû±iÚ
;

531 @
FunùiÚ®IÁ”çû


532 
public
 
š‹rçû
 
	gN‘tyCommFunùiÚ
 {

533 
runTe¡
(
N‘tyCl›ÁRou‹r
 
r
, 
N‘tyS”v”D©a
 
d
è
throws
 
	gExû±iÚ
;

536 @
D©a


537 
public
 cÏs 
	cN‘tyS”v”D©a
 {

538 
S”v”BoÙ¡¿p
 
	gb
;

539 vŞ©
ChªÃlFutu»
 
	gf
;

541 
fš®
 
S”v”CÚ‹xt
 
	g£rv”CÚ‹xt
;

543 
´iv©e
 
fš®
 
SŒšg
 
	gadd»ss
 = "localhost";

545 
N‘tyS”v”D©a
(@
NÚnuÎ
 
S”v”CÚ‹xt
 
cÚ‹xt
) {

546 
	gthis
.
	g£rv”CÚ‹xt
 = 
cÚ‹xt
;

549 
boÙ¡¿pS”v”
() {

550 
Ba£S”v”
 
	gba£S”v”
 = 
Ãw
 Ba£S”v”(
£rv”CÚ‹xt
);

551 
N‘tyS”v”Rou‹r
 
	gn¤
 = 
Ãw
 N‘tyS”v”Rou‹r(
CŞËùiÚs
.
sšgËtÚLi¡
(
ba£S”v”
));

552 
CÜfuS”v”Node
 
	gcÜfuS”v”Node
 = 
Ãw
 CÜfuS”v”Node(
£rv”CÚ‹xt
,

553 
CŞËùiÚs
.
sšgËtÚM­
(
Ba£S”v”
.
şass
, 
ba£S”v”
));

554 
	gf
 = 
cÜfuS”v”Node
.
bšdS”v”
(
£rv”CÚ‹xt
.
g‘BossGroup
(),

555 
£rv”CÚ‹xt
.
g‘WÜk”Group
(),

556 
cÜfuS”v”Node
::
cÚfigu»BoÙ¡¿pO±iÚs
,

557 
£rv”CÚ‹xt
,

558 
n¤
,

559 
add»ss
,

560 
IÁeg”
.
·r£IÁ
((
SŒšg
è
£rv”CÚ‹xt


561 .
g‘S”v”CÚfig
().
g‘
("<port>")));

564 
shutdownS”v”
() {

565 
	gf
.
chªÃl
().
şo£
().
awa™Unš‹¼u±ibly
();

	@test/src/test/java/org/corfudb/runtime/clients/SequencerHandlerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gM‘ricRegi¡ry
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gAb¡¿ùS”v”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
.
	gSequ’ûrStus
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

15 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

16 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

17 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

24 
public
 cÏs 
	cSequ’ûrHªdËrTe¡
 
ex‹nds
 
	mAb¡¿ùCl›ÁTe¡
 {

26 
´iv©e
 
Sequ’ûrCl›Á
 
	mş›Á
;

28 @
Ov”ride


29 
	mS‘
<
	mAb¡¿ùS”v”
> 
	$g‘S”v”sFÜTe¡
() {

30 
M‘ricRegi¡ry
 
m‘ricRegi¡ry
 = 
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
();

31  
Ãw
 
ImmubËS‘
.
Bud”
<
Ab¡¿ùS”v”
>()

32 .
	`add
(
Ãw
 
	`Sequ’ûrS”v”
(
	`deçuÉS”v”CÚ‹xt
()))

33 .
	`bud
();

36 @
Ov”ride


37 
S‘
<
ICl›Á
> 
	$g‘Cl›ÁsFÜTe¡
() {

38 
Sequ’ûrHªdËr
 
£qu’ûrHªdËr
 = 
Ãw
 
	`Sequ’ûrHªdËr
();

39 
ş›Á
 = 
Ãw
 
	`Sequ’ûrCl›Á
(
rou‹r
, 0L);

40  
Ãw
 
ImmubËS‘
.
Bud”
<
ICl›Á
>()

41 .
	`add
(
£qu’ûrHªdËr
)

42 .
	`add
(
Ãw
 
	`Ba£HªdËr
())

43 .
	`bud
();

44 
	}
}

46 @
BefÜe


47 
public
 
	$boÙ¡¿pSequ’ûr
() {

48 
ş›Á
.
	`boÙ¡¿p
(0L, 
CŞËùiÚs
.
	`em±yM­
(), 0L,

49 
çl£
).
	`još
();

50 
	}
}

52 @
Te¡


53 
public
 
	$»que¡Sequ’ûrM‘rics
()

54 
throws
 
Exû±iÚ
 {

55 
Sequ’ûrM‘rics
 
£qu’ûrM‘rics
 = 
ş›Á
.
	`»que¡M‘rics
().
	`g‘
();

56 
	`as£¹Th©
(
£qu’ûrM‘rics
.
	`g‘Sequ’ûrStus
()).
	`isEqu®To
(
Sequ’ûrStus
.
READY
);

57 
	}
}

59 @
Te¡


60 
public
 
	$ÿnG‘ATok’
()

61 
throws
 
Exû±iÚ
 {

62 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`em±yLi¡
(), 1).
	`g‘
();

63 
	}
}

65 @
Te¡


66 
public
 
	$tok’sA»Inüem’tšg
()

67 
throws
 
Exû±iÚ
 {

68 
Tok’
 
tok’
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`em±yLi¡
(), 1).
	`g‘
().
	`g‘Tok’
();

69 
Tok’
 
tok’2
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`em±yLi¡
(), 1).
	`g‘
().
	`g‘Tok’
();

70 
	`as£¹Th©
(
tok’2
.
	`g‘Sequ’û
())

71 .
	`isG»©”Thª
(
tok’
.
	`g‘Sequ’û
());

72 
	}
}

74 @
Te¡


75 
public
 
	$checkTok’Pos™iÚWÜks
()

76 
throws
 
Exû±iÚ
 {

77 
Tok’
 
tok’
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`em±yLi¡
(), 1).
	`g‘
().
	`g‘Tok’
();

78 
Tok’
 
tok’2
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`em±yLi¡
(), 0).
	`g‘
().
	`g‘Tok’
();

79 
	`as£¹Th©
(
tok’
)

80 .
	`isEqu®To
(
tok’2
);

81 
	}
}

83 @
Te¡


84 
public
 
	$³rSŒ—mTok’sWÜk
()

85 
throws
 
Exû±iÚ
 {

86 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amA".
	`g‘By‹s
());

87 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»amB".
	`g‘By‹s
());

88 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
), 1).
	`g‘
();

89 
Tok’
 
tok’A
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
), 1).
	`g‘
().
	`g‘Tok’
();

90 
tok’A2
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
), 0).
	`g‘
().
	`g‘SŒ—mTa
(streamA);

91 
	`as£¹Th©
(
tok’A
.
	`g‘Sequ’û
())

92 .
	`isEqu®To
(
tok’A2
);

93 
tok’B
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
), 0).
	`g‘
().
	`g‘SŒ—mTa
(streamB);

94 
	`as£¹Th©
(
tok’B
)

95 .
	`isNÙEqu®To
(
tok’A2
);

96 
Tok’
 
tok’B2
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
), 1).
	`g‘
().
	`g‘Tok’
();

97 
tok’B3
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amB
), 0).
	`g‘
().
	`g‘SŒ—mTa
(streamB);

98 
	`as£¹Th©
(
tok’B2
.
	`g‘Sequ’û
())

99 .
	`isEqu®To
(
tok’B3
);

100 
tok’A3
 = 
ş›Á
.
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
¡»amA
), 0).
	`g‘
().
	`g‘SŒ—mTa
(streamA);

101 
	`as£¹Th©
(
tok’A3
)

102 .
	`isEqu®To
(
tok’A2
);

103 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/TestChannelContext.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹BufAÎoÿtÜ
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃl
;

9 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlFutu»
;

10 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËr
;

11 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

12 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlP–še
;

13 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlProg»ssivePromi£
;

14 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlPromi£
;

15 
impÜt
 
	gio
.
	gÃ‰y
.
	gut
.
	gA‰ribu‹
;

16 
impÜt
 
	gio
.
	gÃ‰y
.
	gut
.
	gA‰ribu‹Key
;

17 
impÜt
 
	gio
.
	gÃ‰y
.
	gut
.
	gcÚcu¼’t
.
	gEv’tExecutÜ
;

18 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

21 
impÜt
 
	gjava
.
	gÃt
.
	gSock‘Add»ss
;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

24 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

29 @
Slf4j


30 
public
 cÏs 
	cTe¡ChªÃlCÚ‹xt
 
im¶em’ts
 
	mChªÃlHªdËrCÚ‹xt
 {

32 @
FunùiÚ®IÁ”çû


33 
š‹rçû
 
	mHªdËMes§geFunùiÚ
 {

34 
hªdËMes§ge
(
Objeù
 
o
);

37 
HªdËMes§geFunùiÚ
 
	ghmf
;

39 
´iv©e
 
fš®
 
	gTHREAD_COUNT
 = 4;

40 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	gmsgExecutÜS”viû
 = 
ExecutÜs
.
ÃwFixedTh»adPoŞ
(
THREAD_COUNT
,

41 
Ãw
 
Th»adFaùÜyBud”
().
£tD«mÚ
(
Œue
).
£tNameFÜm©
("‹¡ChªÃl-%d").
bud
());

43 
public
 
	$Te¡ChªÃlCÚ‹xt
(
HªdËMes§geFunùiÚ
 
hmf
) {

44 
this
.
hmf
 = hmf;

45 
	}
}

47 
	$£ndMes§geAsync
(
Objeù
 
o
, Objeù 
Üig
) {

48 
Com¶‘abËFutu»
.
	`runAsync
(() -> {

49 
Œy
 {

50 
Objeù
 
ÜigC­tu»
 = 
Üig
;

51 ià(
o
 
š¡ªûof
 
By‹Buf
) {

52 
CÜfuMsg
 
m
 = CÜfuMsg.
	`de£rŸlize
((
By‹Buf
è
o
);

53 
hmf
.
	`hªdËMes§ge
(
m
);

54 ((
By‹Buf
è
o
).
	`»Ëa£
();

56 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

57 
log
.
	`w¬n
("E¼Ü duršg de£rŸliz©iÚ", 
e
);

59 }, 
msgExecutÜS”viû
);

60 
	}
}

62 @
Ov”ride


63 
public
 
ChªÃl
 
	$chªÃl
() {

64  
nuÎ
;

65 
	}
}

67 @
Ov”ride


68 
public
 
Ev’tExecutÜ
 
	$executÜ
() {

69  
nuÎ
;

70 
	}
}

72 @
Ov”ride


73 
public
 
SŒšg
 
	$Çme
() {

74  
nuÎ
;

75 
	}
}

77 @
Ov”ride


78 
public
 
ChªÃlHªdËr
 
	$hªdËr
() {

79  
nuÎ
;

80 
	}
}

82 @
Ov”ride


83 
public
 
boŞ—n
 
	$isRemoved
() {

84  
çl£
;

85 
	}
}

87 @
Ov”ride


88 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlRegi¡”ed
() {

89  
nuÎ
;

90 
	}
}

92 @
Ov”ride


93 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlUÄegi¡”ed
() {

94  
nuÎ
;

95 
	}
}

97 @
Ov”ride


98 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlAùive
() {

99  
nuÎ
;

100 
	}
}

102 @
Ov”ride


103 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlIÇùive
() {

104  
nuÎ
;

105 
	}
}

107 @
Ov”ride


108 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeExû±iÚCaught
(
ThrowabË
 
throwabË
) {

109  
nuÎ
;

110 
	}
}

112 @
Ov”ride


113 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeU£rEv’tTrigg”ed
(
Objeù
 
o
) {

114  
nuÎ
;

115 
	}
}

117 @
Ov”ride


118 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlR—d
(
Objeù
 
o
) {

119  
nuÎ
;

120 
	}
}

122 @
Ov”ride


123 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlR—dCom¶‘e
() {

124  
nuÎ
;

125 
	}
}

127 @
Ov”ride


128 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$fœeChªÃlWr™ab™yChªged
() {

129  
nuÎ
;

130 
	}
}

132 @
Ov”ride


133 
public
 
ChªÃlFutu»
 
	$bšd
(
Sock‘Add»ss
 
sock‘Add»ss
) {

134  
nuÎ
;

135 
	}
}

137 @
Ov”ride


138 
public
 
ChªÃlFutu»
 
	$cÚÃù
(
Sock‘Add»ss
 
sock‘Add»ss
) {

139  
nuÎ
;

140 
	}
}

142 @
Ov”ride


143 
public
 
ChªÃlFutu»
 
	$cÚÃù
(
Sock‘Add»ss
 
sock‘Add»ss
, Sock‘Add»s 
sock‘Add»ss1
) {

144  
nuÎ
;

145 
	}
}

147 @
Ov”ride


148 
public
 
ChªÃlFutu»
 
	$discÚÃù
() {

149  
nuÎ
;

150 
	}
}

152 @
Ov”ride


153 
public
 
ChªÃlFutu»
 
	$şo£
() {

154  
nuÎ
;

155 
	}
}

157 @
Ov”ride


158 
public
 
ChªÃlFutu»
 
	$d”egi¡”
() {

159  
nuÎ
;

160 
	}
}

162 @
Ov”ride


163 
public
 
ChªÃlFutu»
 
	$bšd
(
Sock‘Add»ss
 
sock‘Add»ss
, 
ChªÃlPromi£
 
chªÃlPromi£
) {

164  
nuÎ
;

165 
	}
}

167 @
Ov”ride


168 
public
 
ChªÃlFutu»
 
	$cÚÃù
(
Sock‘Add»ss
 
sock‘Add»ss
, 
ChªÃlPromi£
 
chªÃlPromi£
) {

169  
nuÎ
;

170 
	}
}

172 @
Ov”ride


173 
public
 
ChªÃlFutu»
 
	$cÚÃù
(
Sock‘Add»ss
 
sock‘Add»ss
, Sock‘Add»s 
sock‘Add»ss1
, 
ChªÃlPromi£
 
chªÃlPromi£
) {

174  
nuÎ
;

175 
	}
}

177 @
Ov”ride


178 
public
 
ChªÃlFutu»
 
	$discÚÃù
(
ChªÃlPromi£
 
chªÃlPromi£
) {

179  
nuÎ
;

180 
	}
}

182 @
Ov”ride


183 
public
 
ChªÃlFutu»
 
	$şo£
(
ChªÃlPromi£
 
chªÃlPromi£
) {

184  
nuÎ
;

185 
	}
}

187 @
Ov”ride


188 
public
 
ChªÃlFutu»
 
	$d”egi¡”
(
ChªÃlPromi£
 
chªÃlPromi£
) {

189  
nuÎ
;

190 
	}
}

192 @
Ov”ride


193 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$»ad
() {

194  
nuÎ
;

195 
	}
}

197 @
Ov”ride


198 
public
 
ChªÃlFutu»
 
	$wr™e
(
Objeù
 
o
) {

199 
By‹Buf
 
b
 = 
	`simuÏ‹S”Ÿliz©iÚ
(
o
);

200 
	`£ndMes§geAsync
(
b
,
o
);

201  
nuÎ
;

202 
	}
}

204 @
Ov”ride


205 
public
 
ChªÃlFutu»
 
	$wr™e
(
Objeù
 
o
, 
ChªÃlPromi£
 
chªÃlPromi£
) {

206 
By‹Buf
 
b
 = 
	`simuÏ‹S”Ÿliz©iÚ
(
o
);

207 
	`£ndMes§geAsync
(
b
,
o
);

208  
nuÎ
;

209 
	}
}

211 @
Ov”ride


212 
public
 
ChªÃlHªdËrCÚ‹xt
 
	$æush
() {

213  
nuÎ
;

214 
	}
}

216 @
Ov”ride


217 
public
 
ChªÃlFutu»
 
	$wr™eAndFlush
(
Objeù
 
o
, 
ChªÃlPromi£
 
chªÃlPromi£
) {

218 
By‹Buf
 
b
 = 
	`simuÏ‹S”Ÿliz©iÚ
(
o
);

219 
	`£ndMes§geAsync
(
b
,
o
);

220  
nuÎ
;

221 
	}
}

223 @
Ov”ride


224 
public
 
ChªÃlFutu»
 
	$wr™eAndFlush
(
Objeù
 
o
) {

225 
By‹Buf
 
b
 = 
	`simuÏ‹S”Ÿliz©iÚ
(
o
);

226 
	`£ndMes§geAsync
(
b
,
o
);

227  
nuÎ
;

228 
	}
}

230 
public
 
By‹Buf
 
	$simuÏ‹S”Ÿliz©iÚ
(
Objeù
 
mes§ge
) {

231 ià(
mes§ge
 
š¡ªûof
 
CÜfuMsg
) {

233 
By‹Buf
 
oBuf
 = 
UÅoŞed
.
	`bufãr
();

234 ((
CÜfuMsg
è
mes§ge
).
	`£rŸlize
(
oBuf
);

235 
oBuf
.
	`»£tR—d”Index
();

236  
oBuf
;

238 
throw
 
Ãw
 
	`UnsuµÜ‹dO³¿tiÚExû±iÚ
("Test framework does‚ot support serialization of objectype "

239 + 
mes§ge
.
	`g‘CÏss
());

240 
	}
}

242 @
Ov”ride


243 
public
 
ChªÃlP–še
 
	$p–še
() {

244  
nuÎ
;

245 
	}
}

247 @
Ov”ride


248 
public
 
By‹BufAÎoÿtÜ
 
	$®loc
() {

249  
nuÎ
;

250 
	}
}

252 @
Ov”ride


253 
public
 
ChªÃlPromi£
 
	$ÃwPromi£
() {

254  
nuÎ
;

255 
	}
}

257 @
Ov”ride


258 
public
 
ChªÃlProg»ssivePromi£
 
	$ÃwProg»ssivePromi£
() {

259  
nuÎ
;

260 
	}
}

262 @
Ov”ride


263 
public
 
ChªÃlFutu»
 
	$ÃwSucûededFutu»
() {

264  
nuÎ
;

265 
	}
}

267 @
Ov”ride


268 
public
 
ChªÃlFutu»
 
	$ÃwFaedFutu»
(
ThrowabË
 
throwabË
) {

269  
nuÎ
;

270 
	}
}

272 @
Ov”ride


273 
public
 
ChªÃlPromi£
 
	$voidPromi£
() {

274  
nuÎ
;

275 
	}
}

277 @
Ov”ride


278 
	gpublic
 <
	gT
> 
	gA‰ribu‹
<T> 
©Œ
(
A‰ribu‹Key
<
T
> 
©Œibu‹Key
) {

279  
	gnuÎ
;

286 @
Ov”ride


287 
	gpublic
 <
	gT
> 
boŞ—n
 
hasA‰r
(
A‰ribu‹Key
<
T
> 
©Œibu‹Key
) {

288  
	gçl£
;

	@test/src/test/java/org/corfudb/runtime/clients/TestClientRouter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gTim”
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

6 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gChªÃlHªdËrCÚ‹xt
;

7 
impÜt
 
	glombok
.
	gG‘‹r
;

8 
impÜt
 
	glombok
.
	gNÚNuÎ
;

9 
impÜt
 
	glombok
.
	gS‘‹r
;

10 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gN‘wÜkExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCÜfuCompÚ’t
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

21 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

22 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

23 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

24 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

25 
impÜt
 
	gjava
.
	gut
.
	gM­
;

26 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

27 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

28 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

29 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

30 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
.
	gPARAMETERS
;

37 @
	gSlf4j


40 @
Suµ»ssW¬nšgs
("checkstyle:magicnumber")

41 
public
 cÏs 
	cTe¡Cl›ÁRou‹r
 
im¶em’ts
 
	mICl›ÁRou‹r
 {

46 
public
 
	mLi¡
<
	mICl›Á
> 
	mş›ÁLi¡
;

51 
public
 
	mM­
<
	mCÜfuMsgTy³
, 
	mICl›Á
> 
	mhªdËrM­
;

56 
public
 
	mM­
<
	mLÚg
, 
	mCom¶‘abËFutu»
> 
	mout¡ªdšgReque¡s
;

58 
public
 vŞ©
AtomicLÚg
 
	m»que¡ID
;

60 @
	mG‘‹r


61 @
S‘‹r


62 
public
 
	m£rv”Epoch
;

64 @
	mG‘‹r


65 @
S‘‹r


66 
public
 
UUID
 
	mş›ÁID
;

68 
´iv©e
 vŞ©
boŞ—n
 
	mcÚÃùed
 = 
Œue
;

69 
´iv©e
 
	mM­
<
	mCÜfuMsgTy³
, 
	mSŒšg
> 
	mtim”NameCache
 = 
Ãw
 
HashM­
<>();

71 
public
 
	$simuÏ‹DiscÚÃùedEndpošt
() {

72 
cÚÃùed
 = 
çl£
;

78 @
G‘‹r


79 @
S‘‹r


80 
public
 
timeoutCÚÃù
 = 
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
();

84 @
G‘‹r


85 @
S‘‹r


86 
public
 
timeoutRe¥Ú£
 = 
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
();

90 @
G‘‹r


91 @
S‘‹r


92 
public
 
timeoutR‘ry
 = 
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
();

94 
public
 
Li¡
<
Te¡RuË
> 
ruËs
;

97 
Te¡S”v”Rou‹r
 
£rv”Rou‹r
;

100 
Te¡ChªÃlCÚ‹xt
 
chªÃlCÚ‹xt
;

105 @
G‘‹r


106 
SŒšg
 
ho¡
 = "testServer";

111 @
G‘‹r


112 
IÁeg”
 
pÜt
;

114 
public
 
	$Te¡Cl›ÁRou‹r
(
Te¡S”v”Rou‹r
 
£rv”Rou‹r
) {

115 
ş›ÁLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

116 
hªdËrM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

117 
out¡ªdšgReque¡s
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

118 
»que¡ID
 = 
Ãw
 
	`AtomicLÚg
();

119 
ş›ÁID
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("testClient");

120 
ruËs
 = 
Ãw
 
A¼ayLi¡
<>();

121 
this
.
£rv”Rou‹r
 = serverRouter;

122 
chªÃlCÚ‹xt
 = 
Ãw
 
	`Te¡ChªÃlCÚ‹xt
(
this
::
hªdËMes§ge
);

123 
pÜt
 = 
£rv”Rou‹r
.
	`g‘PÜt
();

124 
	}
}

126 
´iv©e
 
	$hªdËMes§ge
(
Objeù
 
o
) {

127 ià(
o
 
š¡ªûof
 
CÜfuMsg
) {

128 
CÜfuMsg
 
m
 = (CÜfuMsgè
o
;

129 ià(
	`v®id©eCl›ÁId
(
m
)) {

130 
ICl›Á
 
hªdËr
 = 
hªdËrM­
.
	`g‘
(
m
.
	`g‘MsgTy³
());

131 ià(
hªdËr
 =ğ
nuÎ
){

132 
throw
 
Ãw
 
	`IÎeg®S‹Exû±iÚ
("Cl›Á hªdË¸dÛ¢'ˆexi¡ fÜ mes§ge: " + 
m
.
	`g‘MsgTy³
());

135 
hªdËr
.
	`hªdËMes§ge
(
m
, 
nuÎ
);

138 
	}
}

140 
´iv©e
 
	$rou‹Mes§ge
(
CÜfuMsg
 
mes§ge
) {

141 
CÜfuMsg
 
m
 = 
	`simuÏ‹S”Ÿliz©iÚ
(
mes§ge
);

142 
£rv”Rou‹r
.
	`£ndS”v”Mes§ge
(
m
, 
chªÃlCÚ‹xt
);

143 
	}
}

151 @
Ov”ride


152 
public
 
ICl›ÁRou‹r
 
	$addCl›Á
(
ICl›Á
 
ş›Á
) {

154 
ş›Á
.
	`£tRou‹r
(
this
);

157 
ş›Á
.
	`g‘HªdËdTy³s
().
	`¡»am
()

158 .
	`fÜEach
(
x
 -> {

159 
hªdËrM­
.
	`put
(
x
, 
ş›Á
);

160 
log
.
	`Œaû
("Regi¡”ed {}ØhªdË mes§ge oàty³ {}", 
ş›Á
, 
x
);

164 
ş›ÁLi¡
.
	`add
(
ş›Á
);

165  
this
;

166 
	}
}

176 @
Ov”ride


177 
	gpublic
 <
	gT
> 
	gCom¶‘abËFutu»
<T> 
£ndMes§geAndG‘Com¶‘abË
(
ChªÃlHªdËrCÚ‹xt
 
ùx
,

178 @
NÚNuÎ
 
CÜfuMsg
 
mes§ge
) {

180 ià(!
	gcÚÃùed
) {

181 
	glog
.
Œaû
("DiscÚÃùedƒndpošˆ" + 
ho¡
 + ":" + 
pÜt
);

182 
throw
 
Ãw
 
N‘wÜkExû±iÚ
("DiscÚÃùedƒndpošt", 
NodeLoÿtÜ
.
bud”
()

183 .
ho¡
(host)

184 .
pÜt
ÕÜt).
bud
());

188 
fš®
 
Tim”
 
	groundTrMsgTim”
 = 
g‘Tim”
(
mes§ge
);

189 
fš®
 
	gTim”
.
CÚ‹xt
 
	groundTrMsgCÚ‹xt
 = 
M‘ricsUts


190 .
g‘CÚd™iÚ®CÚ‹xt
(
roundTrMsgTim”
);

193 
fš®
 
	gthisReque¡
 = 
»que¡ID
.
g‘AndInüem’t
();

195 
	gmes§ge
.
£tCl›ÁID
(
ş›ÁID
);

196 
	gmes§ge
.
£tReque¡ID
(
thisReque¡
);

198 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gcf
 = 
Ãw
 
Com¶‘abËFutu»
<>();

199 
	gout¡ªdšgReque¡s
.
put
(
thisReque¡
, 
cf
);

201 ià(
	gruËs
.
¡»am
().
®lM©ch
(
x
 -> x.
ev®u©e
(
mes§ge
, 
this
))) {

203 
	glog
.
Œaû
(
Th»ad
.
cu¼’tTh»ad
().
g‘Id
(è+ ":S’ˆmes§ge: {}", 
mes§ge
);

204 
rou‹Mes§ge
(
mes§ge
);

208 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gcfB’chm¬ked
 = 
cf
.
th’Aµly
(
x
 -> {

209 
M‘ricsUts
.
¡İCÚd™iÚ®CÚ‹xt
(
roundTrMsgCÚ‹xt
);

210  
x
;

214 
fš®
 
	gCom¶‘abËFutu»
<
	gT
> 
	gcfTimeout
 = 
CFUts
.
w™hš
(
cfB’chm¬ked
, 
Du¿tiÚ
.
ofMlis
(
timeoutRe¥Ú£
));

215 
	gcfTimeout
.
exû±iÚ®ly
(
e
 -> {

216 
out¡ªdšgReque¡s
.
»move
(
thisReque¡
);

217 
log
.
debug
("Remov»que¡ {} dutØtimeout!", 
thisReque¡
);

218  
nuÎ
;

220  
	gcfTimeout
;

224 
´iv©e
 
Tim”
 
g‘Tim”
(@
NÚNuÎ
 
CÜfuMsg
 
mes§ge
) {

225 ià(!
	gtim”NameCache
.
cÚšsKey
(
mes§ge
.
g‘MsgTy³
())) {

226 
	gtim”NameCache
.
put
(
mes§ge
.
g‘MsgTy³
(),

227 
CÜfuCompÚ’t
.
CLIENT_ROUTER
.
toSŒšg
() +

228 
mes§ge
.
g‘MsgTy³
().
Çme
().
toLow”Ca£
());

230  
	gCÜfuRuÁime
.
g‘DeçuÉM‘rics
()

231 .
tim”
(
tim”NameCache
.
g‘
(
mes§ge
.
g‘MsgTy³
()));

240 @
Ov”ride


241 
public
 
	$£ndMes§ge
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
mes§ge
) {

243 
fš®
 
thisReque¡
 = 
»que¡ID
.
	`g‘AndInüem’t
();

244 
mes§ge
.
	`£tCl›ÁID
(
ş›ÁID
);

245 
mes§ge
.
	`£tReque¡ID
(
thisReque¡
);

247 ià(
ruËs
.
	`¡»am
()

248 .
	`m­
(
x
 -> x.
	`ev®u©e
(
mes§ge
, 
this
))

249 .
	`®lM©ch
(
x
 -> x)) {

251 
	`rou‹Mes§ge
(
mes§ge
);

253 
	}
}

262 @
Ov”ride


263 
public
 
	$£ndRe¥Ú£ToS”v”
(
ChªÃlHªdËrCÚ‹xt
 
ùx
, 
CÜfuMsg
 
šMsg
, CÜfuMsg 
outMsg
) {

264 
outMsg
.
	`cİyBa£F›lds
(
šMsg
);

265 ià(
ruËs
.
	`¡»am
()

266 .
	`m­
(
x
 -> x.
	`ev®u©e
(
outMsg
, 
this
))

267 .
	`®lM©ch
(
x
 -> x)) {

269 
ùx
.
	`wr™eAndFlush
(
outMsg
);

270 
log
.
	`Œaû
("S’ˆ»¥Ú£: {}", 
outMsg
);

272 
	}
}

280 
´iv©e
 
boŞ—n
 
	$v®id©eCl›ÁId
(
CÜfuMsg
 
msg
) {

282 ià(!
msg
.
	`g‘Cl›ÁID
().
	`equ®s
(
ş›ÁID
)) {

283 
log
.
	`w¬n
("Incoming message intended for client {}, our id is {}, dropping!",

284 
msg
.
	`g‘Cl›ÁID
(), 
ş›ÁID
);

285  
çl£
;

287  
Œue
;

288 
	}
}

297 @
Suµ»ssW¬nšgs
("unchecked")

298 
	gpublic
 <
	gT
> 
	$com¶‘eReque¡
(
»que¡ID
, 
T
 
com¶‘iÚ
) {

299 
Com¶‘abËFutu»
<
T
> 
cf
;

300 ià((
cf
 = (
Com¶‘abËFutu»
<
T
>è
out¡ªdšgReque¡s
.
	`g‘
(
»que¡ID
)è!ğ
nuÎ
) {

301 
cf
.
	`com¶‘e
(
com¶‘iÚ
);

302 
out¡ªdšgReque¡s
.
	`»move
(
»que¡ID
);

304 
log
.
	`w¬n
("A‰em±edØcom¶‘»que¡ {}, buˆ»que¡‚Ù out¡ªdšg!", 
»que¡ID
);

306 
	}
}

314 
public
 
	$com¶‘eExû±iÚ®ly
(
»que¡ID
, 
ThrowabË
 
ÿu£
) {

315 
Com¶‘abËFutu»
 
cf
;

316 ià((
cf
 = 
out¡ªdšgReque¡s
.
	`g‘
(
»que¡ID
)è!ğ
nuÎ
) {

317 
cf
.
	`com¶‘eExû±iÚ®ly
(
ÿu£
);

318 
out¡ªdšgReque¡s
.
	`»move
(
»que¡ID
);

320 
log
.
	`w¬n
("A‰em±edØexû±iÚ®ly com¶‘»que¡ {}, buˆ»que¡‚Ù out¡ªdšg!", 
»que¡ID
);

322 
	}
}

327 @
Ov”ride


328 
public
 
	$¡¬t
() {

330 
	}
}

335 @
Ov”ride


336 
public
 
	$¡İ
() {

338 
	}
}

340 @
Ov”ride


341 
public
 
	$¡İ
(
boŞ—n
 
unu£d
) {

343 
	}
}

345 
public
 
CÜfuMsg
 
	$simuÏ‹S”Ÿliz©iÚ
(
CÜfuMsg
 
mes§ge
) {

347 
By‹Buf
 
oBuf
 = 
UÅoŞed
.
	`bufãr
();

348 
mes§ge
.
	`£rŸlize
(
oBuf
);

349 
oBuf
.
	`»£tR—d”Index
();

350 
CÜfuMsg
 
msg
 = CÜfuMsg.
	`de£rŸlize
(
oBuf
);

351 
oBuf
.
	`»Ëa£
();

352  
msg
;

353 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/TestClientRouterTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gBa£S”v”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

19 
public
 cÏs 
	cTe¡Cl›ÁRou‹rTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

21 
´iv©e
 
Ba£Cl›Á
 
	mbc
;

22 
´iv©e
 
Te¡Cl›ÁRou‹r
 
	mtü
;

24 @
BefÜe


25 
public
 
	$£tupRou‹r
() {

26 
Te¡S”v”Rou‹r
 
t¤
 = 
Ãw
 
	`Te¡S”v”Rou‹r
();

27 
Ba£S”v”
 
bs
 = 
Ãw
 
	`Ba£S”v”
(
S”v”CÚ‹xtBud”
.
	`deçuÉTe¡CÚ‹xt
(0));

28 
t¤
.
	`addS”v”
(
bs
);

29 
tü
 = 
Ãw
 
	`Te¡Cl›ÁRou‹r
(
t¤
);

30 
Ba£HªdËr
 
ba£HªdËr
 = 
Ãw
 
	`Ba£HªdËr
();

31 
tü
.
	`addCl›Á
(
ba£HªdËr
);

32 
bc
 = 
Ãw
 
	`Ba£Cl›Á
(
tü
, 0L);

36 @
Te¡


37 
public
 
	$‹¡RuËDrİsMes§ges
() {

38 
	`as£¹Th©
(
bc
.
	`pšgSync
())

39 .
	`isTrue
();

41 
tü
.
ruËs
.
	`add
(
Ãw
 
	`Te¡RuË
()

42 .
	`®ways
()

43 .
	`drİ
());

45 
	`as£¹Th©
(
bc
.
	`pšgSync
())

46 .
	`isF®£
();

47 
	}
}

49 @
Te¡


50 
public
 
	$ÚlyDrİEpochChªgeMes§ges
() {

51 
tü
.
ruËs
.
	`add
(
Ãw
 
	`Te¡RuË
()

52 .
	`m©ches
(
x
 -> x.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
SEAL
))

53 .
	`drİ
());

55 
	`as£¹Th©
(
bc
.
	`pšgSync
())

56 .
	`isTrue
();

58 
fš®
 
NEW_EPOCH
 = 9L;

59 
	`as£¹Th©ThrownBy
((è-> 
bc
.
	`£®RemÙeS”v”
(
NEW_EPOCH
).
	`g‘
())

60 .
	`hasCau£In¡ªûOf
(
TimeoutExû±iÚ
.
şass
);

61 
	}
}

	@test/src/test/java/org/corfudb/runtime/clients/TestRule.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gIS”v”Rou‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

7 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gCÚsum”
;

8 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gFunùiÚ
;

13 
public
 cÏs 
	cTe¡RuË
 {

16 
´iv©e
 
boŞ—n
 
	m®ways
 = 
çl£
;

17 
´iv©e
 
	mFunùiÚ
<
	mCÜfuMsg
, 
	mBoŞ—n
> 
	mm©ch”
 = 
nuÎ
;

20 
´iv©e
 
boŞ—n
 
	mdrİ
 = 
çl£
;

21 
´iv©e
 
boŞ—n
 
	mdrİEv’
 = 
çl£
;

22 
´iv©e
 
boŞ—n
 
	mdrİOdd
 = 
çl£
;

23 
´iv©e
 
	mCÚsum”
<
	mCÜfuMsg
> 
	mŒªsfÜm”
 = 
nuÎ
;

24 
´iv©e
 
	mFunùiÚ
<
	mCÜfuMsg
, CÜfuMsg> 
	mšjeùBefÜe
 = 
nuÎ
;

27 
´iv©e
 
AtomicIÁeg”
 
	mtimesM©ched
 = 
Ãw
 AtomicInteger();

32 
public
 
Te¡RuË
 
	$®ways
() {

33 
this
.
®ways
 = 
Œue
;

34  
this
;

40 
public
 
Te¡RuË
 
	$drİ
() {

41 
this
.
drİ
 = 
Œue
;

42  
this
;

43 
	}
}

51 
public
 
Te¡RuË
 
m©ches
(
FunùiÚ
<
CÜfuMsg
, 
BoŞ—n
> 
m©ch”
) {

52 
	gthis
.
	gm©ch”
 = 
m©ch”
;

53  
	gthis
;

59 
public
 
boŞ—n
 
	$ev®u©e
(
CÜfuMsg
 
mes§ge
, 
Objeù
 
rou‹r
) {

60 ià(
mes§ge
 =ğ
nuÎ
è 
çl£
;

61 ià(
	`m©ch
(
mes§ge
)) {

62 
m©chNumb”
 = 
timesM©ched
.
	`g‘AndInüem’t
();

63 ià(
drİ
è 
çl£
;

64 ià(
drİOdd
 && 
m©chNumb”
 % 2 !ğ0è 
çl£
;

65 ià(
drİEv’
 && 
m©chNumb”
 % 2 =ğ0è 
çl£
;

66 ià(
ŒªsfÜm”
 !ğ
nuÎ
èŒªsfÜm”.
	`acû±
(
mes§ge
);

67 ià(
šjeùBefÜe
 !ğ
nuÎ
 && 
rou‹r
 
š¡ªûof
 
ICl›ÁRou‹r
)

68 ((
ICl›ÁRou‹r
)
rou‹r
).
	`£ndMes§ge
(
nuÎ
, 
šjeùBefÜe
.
	`­¶y
(
mes§ge
));

69 ià(
šjeùBefÜe
 !ğ
nuÎ
 && 
rou‹r
 
š¡ªûof
 
IS”v”Rou‹r
)

70 ((
IS”v”Rou‹r
)
rou‹r
).
	`£ndRe¥Ú£
(
nuÎ
, 
šjeùBefÜe
.
	`­¶y
(
mes§ge
), injectBefore.apply(message));

72  
Œue
;

73 
	}
}

78 
boŞ—n
 
	$m©ch
(
CÜfuMsg
 
mes§ge
) {

79  
®ways
 || 
m©ch”
.
	`­¶y
(
mes§ge
);

80 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/CorfuMapTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

10 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

18 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

19 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

20 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

22 
impÜt
 
	glombok
.
	gD©a
;

23 
impÜt
 
	glombok
.
	gG‘‹r
;

24 
impÜt
 
	glombok
.
	gToSŒšg
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùO³nO±iÚ
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

38 
public
 cÏs 
	cCÜfuM­Te¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

39 @
G‘‹r


40 
fš®
 
SŒšg
 
	mdeçuÉCÚfigu¿tiÚSŒšg
 = 
g‘DeçuÉEndpošt
();

42 
public
 
CÜfuRuÁime
 
	mr
;

45 @
BefÜe


46 
public
 
	$£tRuÁime
(è
throws
 
Exû±iÚ
 {

47 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

50 @
Te¡


51 @
	`Suµ»ssW¬nšgs
("unchecked")

52 
public
 
	$ÿnR—dWr™eToSšgË
()

53 
throws
 
Exû±iÚ
 {

54 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

55 .
	`g‘ObjeùsV›w
()

56 .
	`bud
()

57 .
	`£tSŒ—mName
("test")

58 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

59 .
	`İ’
();

61 
‹¡M­
.
	`ş—r
();

62 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

63 .
	`isNuÎ
();

64 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

65 .
	`isEqu®To
("a");

66 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

67 .
	`isEqu®To
("b");

68 
	}
}

70 @
Te¡


71 
public
 
	$checkpoštCÜfuM­
(è
throws
 
Exû±iÚ
 {

72 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

73 .
	`g‘ObjeùsV›w
()

74 .
	`bud
()

75 .
	`£tSŒ—mName
("test")

76 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

77 .
	`İ’
();

79 
‹¡M­
.
	`put
("k1", "v1");

81 
S‘
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
’ŒyS‘
 = 
Ãw
 
HashS‘
<>();

83 
’ŒyS‘
.
	`addAÎ
(
‹¡M­
.
	`’ŒyS‘
());

84 
‹¡M­
.
	`put
("k1", "v2");

86 
	`as£¹Th©
(
’ŒyS‘
).
	`hasSize
(
‹¡M­
.
	`size
());

87 
M­
.
EÁry
<
SŒšg
, SŒšg> 
’Œy
 = 
’ŒyS‘
.
	`™”©Ü
().
	`Ãxt
();

89 
	`as£¹Th©
(
’Œy
).
	`isEqu®To
(
Ãw
 
Ab¡¿ùM­
.
	`Sim¶eImmubËEÁry
("k1", "v1"));

90 
	}
}

92 @
	gTe¡


93 @
Suµ»ssW¬nšgs
("unchecked")

94 
public
 
	$ÿnWr™eSÿnAndF‹rToSšgË
()

95 
throws
 
Exû±iÚ
 {

96 
M­
<
SŒšg
, SŒšg> 
cÜfuIn¡ªûsM­
 = 
	`g‘RuÁime
()

97 .
	`g‘ObjeùsV›w
()

98 .
	`bud
()

99 .
	`£tSŒ—mName
("test")

100 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

101 .
	`İ’
();

103 
cÜfuIn¡ªûsM­
.
	`ş—r
();

104 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("a", "CorfuServer"))

105 .
	`isNuÎ
();

106 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("b", "CorfuClient"))

107 .
	`isNuÎ
();

108 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("c", "CorfuClient"))

109 .
	`isNuÎ
();

110 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("d", "CorfuServer"))

111 .
	`isNuÎ
();

114 
P»diÿ‹
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
v®ueP»diÿ‹
 =

115 
p
 ->….
	`g‘V®ue
().
	`equ®s
("CorfuServer");

116 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
f‹»dM­
 = ((
CÜfuTabË
)
cÜfuIn¡ªûsM­
)

117 .
	`sÿnAndF‹rByEÁry
(
v®ueP»diÿ‹
);

119 
	`as£¹Th©
(
f‹»dM­
.
	`size
()).
	`isEqu®To
(2);

121 
M­
.
EÁry
<
SŒšg
, SŒšg> 
cÜfuIn¡ªû
 : 
f‹»dM­
) {

122 
	`as£¹Th©
(
cÜfuIn¡ªû
.
	`g‘V®ue
()).
	`isEqu®To
("CorfuServer");

126 
Li¡
<
SŒšg
> 
cÜfuS”v”Li¡
 = ((
CÜfuTabË
)
cÜfuIn¡ªûsM­
)

127 .
	`sÿnAndF‹r
(
p
 ->….
	`equ®s
("CorfuServer"));

129 
	`as£¹Th©
(
cÜfuS”v”Li¡
.
	`size
()).
	`isEqu®To
(2);

131 
SŒšg
 
cÜfuIn¡ªû
 : 
cÜfuS”v”Li¡
) {

132 
	`as£¹Th©
(
cÜfuIn¡ªû
).
	`isEqu®To
("CorfuServer");

134 
	}
}

136 @
	gTe¡


137 @
Suµ»ssW¬nšgs
("unchecked")

138 
public
 
	$ÿnG‘ID
()

139 
throws
 
Exû±iÚ
 {

140 
UUID
 
id
 = UUID.
	`¿ndomUUID
();

141 
ICÜfuSMR
 
‹¡M­
 = (ICÜfuSMRè
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

142 .
	`bud
()

143 .
	`£tSŒ—mID
(
id
)

144 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

145 .
	`İ’
();

147 
	`as£¹Th©
(
id
)

148 .
	`isEqu®To
(
‹¡M­
.
	`g‘CÜfuSŒ—mID
());

149 
	}
}

151 @
	gTe¡


152 @
Suµ»ssW¬nšgs
("unchecked")

153 
public
 
	$lßdsFŞlowedByG‘s
()

154 
throws
 
Exû±iÚ
 {

155 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

156 .
	`bud
()

157 .
	`£tSŒ—mName
("test")

158 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

159 .
	`İ’
();

161 
‹¡M­
.
	`ş—r
();

162 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

163 
	`as£¹Th©
(
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

164 .
	`isNuÎ
();

166 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

167 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
i
)))

168 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
));

170 
	}
}

172 @
	gTe¡


173 @
Suµ»ssW¬nšgs
("unchecked")

174 
public
 
	$ÿnCÚšOth”CÜfuObjeùs
()

175 
throws
 
Exû±iÚ
 {

176 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

177 .
	`bud
()

178 .
	`£tSŒ—mName
("test 1")

179 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

180 .
	`İ’
();

181 
‹¡M­
.
	`ş—r
();

182 
‹¡M­
.
	`put
("z", "e");

183 
M­
<
SŒšg
, M­<SŒšg, SŒšg>> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

184 .
	`bud
()

185 .
	`£tSŒ—mName
("test 2")

186 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, 
M­
<SŒšg, SŒšg>>
	`g‘M­Ty³
())

187 .
	`İ’
();

188 
‹¡M­2
.
	`put
("a", 
‹¡M­
);

190 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
("a").get("z"))

191 .
	`isEqu®To
("e");

193 
‹¡M­2
.
	`g‘
("a").
	`put
("y", "f");

195 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("y"))

196 .
	`isEqu®To
("f");

198 
M­
<
SŒšg
, SŒšg> 
‹¡M­3
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

199 .
	`bud
()

200 .
	`£tSŒ—mName
("test 1")

201 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

202 .
	`İ’
();

204 
	`as£¹Th©
(
‹¡M­3
.
	`g‘
("y"))

205 .
	`isEqu®To
("f");

207 
	}
}

209 @
	gTe¡


210 @
Suµ»ssW¬nšgs
("unchecked")

211 
public
 
	$ÿnCÚšNuÎObjeùs
()

212 
throws
 
Exû±iÚ
 {

213 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

214 .
	`bud
()

215 .
	`£tSŒ—mName
("a")

216 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

217 .
	`İ’
();

219 
‹¡M­
.
	`ş—r
();

220 
‹¡M­
.
	`put
("z", 
nuÎ
);

221 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

222 .
	`isEqu®To
(
nuÎ
);

223 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
()

224 .
	`g‘ObjeùsV›w
()

225 .
	`bud
()

226 .
	`£tSŒ—mName
("a")

227 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

228 .
	`İ’
();

230 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
("z"))

231 .
	`isEqu®To
(
nuÎ
);

232 
	}
}

234 @
Te¡


235 
public
 
	$lßdsFŞlowedByG‘sCÚcu¼’t
()

236 
throws
 
Exû±iÚ
 {

237 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

238 .
	`bud
()

239 .
	`£tSŒ—mID
(
UUID
.
	`¿ndomUUID
())

240 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

241 .
	`İ’
();

243 
fš®
 
num_th»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

244 
fš®
 
num_»cÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

245 
‹¡M­
.
	`ş—r
();

247 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

248 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

249 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

250 
	`as£¹Th©
(
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

251 .
	`isEqu®To
(
nuÎ
);

255 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

256 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

257 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("WPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

259 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

260 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

261 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

262 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
i
)))

263 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
));

267 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

268 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

269 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("RPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

270 
	}
}

273 @
	gTe¡


274 @
Suµ»ssW¬nšgs
("unchecked")

275 
public
 
	$lßdsFŞlowedByG‘sCÚcu¼’tMuÉiV›w
()

276 
throws
 
Exû±iÚ
 {

278 
fš®
 
lÚgHŞeFlR‘ryLim™
 = 50;

279 
r
.
	`g‘P¬am‘”s
().
	`£tHŞeFlR‘ry
(
lÚgHŞeFlR‘ryLim™
);

281 
fš®
 
num_th»ads
 = 5;

282 
fš®
 
num_»cÜds
 = 1000;

284 
M­
<
SŒšg
, SŒšg>[] 
‹¡M­
 =

285 
IÁSŒ—m
.
	`¿nge
(0, 
num_th»ads
)

286 .
	`m­ToObj
(
i
 -> {

287  
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

288 .
	`bud
()

289 .
	`£tSŒ—mID
(
UUID
.
	`¿ndomUUID
())

290 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, SŒšg>
	`g‘M­Ty³
())

291 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

292 .
	`İ’
();

294 .
	`toA¼ay
(
M­
[]::
Ãw
);

296 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

297 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

298 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

299 
	`as£¹Th©
(
‹¡M­
[
th»adNumb”
].
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

300 .
	`isEqu®To
(
nuÎ
);

304 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

305 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

306 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("WPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

308 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

309 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

310 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

311 
	`as£¹Th©
(
‹¡M­
[
th»adNumb”
].
	`g‘
(
IÁeg”
.
	`toSŒšg
(
i
)))

312 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
));

316 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

317 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

318 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("RPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

319 
	}
}

321 @
	gTe¡


322 @
Suµ»ssW¬nšgs
("unchecked")

323 
public
 
	$cŞËùiÚsSŒ—mIÁ”çû
()

324 
throws
 
Exû±iÚ
 {

325 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

326 .
	`bud
()

327 .
	`£tSŒ—mName
("test")

328 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

329 .
	`İ’
();

331 
‹¡M­
.
	`put
("a", "b");

332 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

333 ià(
‹¡M­
.
	`v®ues
().
	`¡»am
().
	`ªyM©ch
(
x
 -> x.
	`equ®s
("c"))) {

334 
throw
 
Ãw
 
	`Exû±iÚ
("test");

336 
‹¡M­
.
	`compu‹
("b",

337 (
k
, 
v
) -> "c");

338 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

339 
	`as£¹Th©
(
‹¡M­
)

340 .
	`cÚšsEÁry
("b", "c");

341 
	}
}

343 @
	gTe¡


344 @
Suµ»ssW¬nšgs
("unchecked")

345 
public
 
	$»adS‘DiffFromWr™eS‘
()

346 
throws
 
Exû±iÚ
 {

347 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

348 .
	`bud
()

349 .
	`£tSŒ—mName
("test1")

350 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

351 .
	`İ’
();

353 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

354 .
	`bud
()

355 .
	`£tSŒ—mName
("test2")

356 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

357 .
	`İ’
();

359 
‹¡M­
.
	`put
("a", "b");

360 
‹¡M­2
.
	`put
("a", "c");

362 
Sem­hÜe
 
s1
 = 
Ãw
 
	`Sem­hÜe
(0);

363 
Sem­hÜe
 
s2
 = 
Ãw
 
	`Sem­hÜe
(0);

364 
	`scheduËCÚcu¼’y
(1, 
th»adNumb”
 -> {

365 
s1
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
(),

366 
TimeUn™
.
MILLISECONDS
);

367 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

368 
‹¡M­2
.
	`put
("a", "d");

369 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

370 
s2
.
	`»Ëa£
();

373 
	`scheduËCÚcu¼’y
(1, 
th»adNumb”
 -> {

374 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

375 
‹¡M­
.
	`compu‹
("b", (
k
, 
v
è-> 
‹¡M­2
.
	`g‘
("a"));

376 
s1
.
	`»Ëa£
();

377 
s2
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
(),

378 
TimeUn™
.
MILLISECONDS
);

379 
	`as£¹Th©ThrownBy
((è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
())

380 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

382 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_TWO
, PARAMETERS.
TIMEOUT_NORMAL
);

383 
	}
}

385 @
	gTe¡


386 @
Suµ»ssW¬nšgs
("unchecked")

387 
public
 
	$ÿnUpd©eSšgËObjeùT¿n§ÿtiÚ®ly
()

388 
throws
 
Exû±iÚ
 {

389 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

390 .
	`bud
()

391 .
	`£tSŒ—mName
("test")

392 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

393 .
	`İ’
();

395 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

396 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

397 .
	`isNuÎ
();

398 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

399 .
	`isEqu®To
("a");

400 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

401 .
	`isEqu®To
("b");

402 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

403 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

404 .
	`isEqu®To
("b");

405 
	}
}

407 @
	gTe¡


408 @
Suµ»ssW¬nšgs
("unchecked")

409 
public
 
	$muÉËTXesA»Aµl›d
()

410 
throws
 
Exû±iÚ
 {

412 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

413 .
	`bud
()

414 .
	`£tSŒ—mName
("test")

415 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

416 .
	`İ’
();

418 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`asLÚgSŒ—m
()

420 .
	`fÜEach
(
l
 -> {

421 
Œy
 {

422 
	`as£¹Th©
(
‹¡M­
)

423 .
	`hasSize
((è
l
);

424 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

425 
	`as£¹Th©
(
‹¡M­
.
	`put
(
LÚg
.
	`toSŒšg
(
l
), Long.toString(l)))

426 .
	`isNuÎ
();

427 
	`as£¹Th©
(
‹¡M­
)

428 .
	`hasSize
((è
l
 + 1);

429 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

430 
	`as£¹Th©
(
‹¡M­
)

431 .
	`hasSize
((è
l
 + 1);

432 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

433 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

437 
	`as£¹Th©
(
‹¡M­
)

438 .
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

439 
	}
}

441 @
	gTe¡


442 @
Suµ»ssW¬nšgs
("unchecked")

443 
public
 
	$muÉËTXesA»Aµl›dWOAcûssÜs
()

444 
throws
 
Exû±iÚ
 {

446 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

447 .
	`bud
()

448 .
	`£tSŒ—mName
("test")

449 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

450 .
	`İ’
();

452 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`asLÚgSŒ—m
()

453 .
	`fÜEach
(
l
 -> {

454 
Œy
 {

455 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

456 
	`as£¹Th©
(
‹¡M­
.
	`put
(
LÚg
.
	`toSŒšg
(
l
), Long.toString(l)))

457 .
	`isNuÎ
();

458 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

459 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

460 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

464 
	`as£¹Th©
(
‹¡M­
)

465 .
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

466 
	}
}

469 @
	gTe¡


470 @
Suµ»ssW¬nšgs
("unchecked")

471 
public
 
	$mutÜFŞlowedByAT¿n§ùiÚ
()

472 
throws
 
Exû±iÚ
 {

473 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

474 .
	`bud
()

475 .
	`£tSŒ—mName
("test")

476 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

477 .
	`İ’
();

479 
‹¡M­
.
	`ş—r
();

480 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

481 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

482 .
	`isNuÎ
();

483 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

484 .
	`isEqu®To
("a");

485 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

486 .
	`isEqu®To
("b");

487 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

488 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

489 .
	`isEqu®To
("b");

490 
	}
}

492 @
	gTe¡


493 @
Suµ»ssW¬nšgs
("unchecked")

494 
public
 
	$objeùV›wCÜ»ùlyR•ÜtsInsideTX
()

495 
throws
 
Exû±iÚ
 {

496 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
())

497 .
	`isF®£
();

498 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

499 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
())

500 .
	`isTrue
();

501 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

502 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
())

503 .
	`isF®£
();

504 
	}
}

506 @
	gTe¡


507 @
Suµ»ssW¬nšgs
("unchecked")

508 
public
 
	$ÿnUpd©eSšgËObjeùT¿n§ÿtiÚ®lyWh’Cached
()

509 
throws
 
Exû±iÚ
 {

510 
r
.
	`£tCacheDi§bËd
(
çl£
);

512 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

513 .
	`bud
()

514 .
	`£tSŒ—mName
("test")

515 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

516 .
	`İ’
();

518 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

519 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

520 .
	`isNuÎ
();

521 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

522 .
	`isEqu®To
("a");

523 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

524 .
	`isEqu®To
("b");

525 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

526 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

527 .
	`isEqu®To
("b");

528 
	}
}

531 @
	gTe¡


532 @
Suµ»ssW¬nšgs
("unchecked")

533 
public
 
	$abÜ‹dT¿n§ùiÚsCªnÙBeR—dOnSšgËObjeù
()

534 
throws
 
Exû±iÚ
 {

535 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

536 .
	`bud
()

537 .
	`£tSŒ—mName
("test")

538 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

539 .
	`İ’
();

541 
‹¡M­
.
	`ş—r
();

542 
‹¡M­
.
	`put
("z", "z");

543 
	`as£¹Th©
(
‹¡M­
.
	`size
())

544 .
	`isEqu®To
(1);

547 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

548 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

549 .
	`isNuÎ
();

550 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

551 .
	`isEqu®To
("a");

552 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

553 .
	`isEqu®To
("b");

554 
‹¡M­
.
	`ş—r
();

555 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

556 
	`as£¹Th©
(
‹¡M­
.
	`size
())

557 .
	`isEqu®To
(1);

558 
	}
}

560 @
	gTe¡


561 @
Suµ»ssW¬nšgs
("unchecked")

562 
public
 
	$modifiÿtiÚDuršgT¿n§ùiÚCau£sAbÜt
()

563 
throws
 
Exû±iÚ
 {

564 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

565 .
	`bud
()

566 .
	`£tSŒ—mName
("A")

567 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

568 .
	`İ’
();

570 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "z"))

571 .
	`isNuÎ
();

573 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

574 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

575 .
	`isEqu®To
("z");

576 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

577 .
	`isEqu®To
("a");

578 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

579 .
	`isEqu®To
("b");

580 
Com¶‘abËFutu»
 
cf
 = Com¶‘abËFutu».
	`runAsync
(() -> {

581 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

582 .
	`bud
()

583 .
	`£tSŒ—mName
("A")

584 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
	`g‘DeçuÉS”Ÿliz”
())

585 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

586 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

587 .
	`İ’
();

589 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

590 
‹¡M­2
.
	`put
("a", "f");

591 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

593 
cf
.
	`još
();

594 
	`as£¹Th©ThrownBy
((è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
())

595 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

596 
	}
}

598 @
	gTe¡


599 @
Suµ»ssW¬nšgs
("unchecked")

600 
public
 
	$smrM­CªCÚšCu¡omObjeùs
()

601 
throws
 
Exû±iÚ
 {

602 
M­
<
SŒšg
, 
Te¡Objeù
> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

603 .
	`bud
()

604 .
	`£tSŒ—mName
("A")

605 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, 
Te¡Objeù
>
	`g‘M­Ty³
())

606 .
	`İ’
();

608 
‹¡M­
.
	`put
("A", 
Ãw
 
	`Te¡Objeù
("A", 2, 
ImmubËM­
.
	`of
("A", "B")));

609 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("A").
	`g‘Te¡SŒšg
())

610 .
	`isEqu®To
("A");

611 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("A").
	`g‘Te¡IÁ
())

612 .
	`isEqu®To
(2);

613 
	}
}

615 @
	gTe¡


616 @
Suµ»ssW¬nšgs
("unchecked")

617 
public
 
	$smrM­CªCÚšCu¡omObjeùsInsideTXes
()

618 
throws
 
Exû±iÚ
 {

619 
M­
<
SŒšg
, 
Te¡Objeù
> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

620 .
	`bud
()

621 .
	`£tSŒ—mName
("A")

622 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, 
Te¡Objeù
>
	`g‘M­Ty³
())

623 .
	`İ’
();

625 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
)

626 .
	`fÜEach
(
l
 -> {

627 
Œy
 {

628 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

629 
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
l
),

630 
Ãw
 
	`Te¡Objeù
(
IÁeg”
.
	`toSŒšg
(
l
),†,

631 
ImmubËM­
.
	`of
(

632 
IÁeg”
.
	`toSŒšg
(
l
),†)));

633 ià(
l
 > 0) {

634 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
l
 - 1)).
	`g‘Te¡IÁ
())

635 .
	`isEqu®To
(
l
 - 1);

637 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

638 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

639 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

643 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("3").
	`g‘Te¡SŒšg
())

644 .
	`isEqu®To
("3");

645 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("3").
	`g‘Te¡IÁ
())

646 .
	`isEqu®To
(
IÁeg”
.
	`·r£IÁ
("3"));

647 
	}
}

649 @
	gTe¡


650 @
Suµ»ssW¬nšgs
("unchecked")

651 
public
 
	$unu£dMutÜAcûssÜ
()

652 
throws
 
Exû±iÚ
 {

653 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

654 .
	`bud
()

655 .
	`£tSŒ—mName
("A")

656 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

657 .
	`İ’
();

659 
‹¡M­
.
	`put
("a", "z");

660 
	}
}

662 
AtomicIÁeg”
 
	gabÜts
;

664 
	$g‘MuÉiV›wSM
(
numTh»ads
) {

666 
UUID
 
m­SŒ—m
 = UUID.
	`¿ndomUUID
();

667 
M­
<
SŒšg
, SŒšg>[] 
‹¡M­
 =

668 
IÁSŒ—m
.
	`¿nge
(0, 
numTh»ads
)

669 .
	`m­ToObj
(
i
 -> {

670  
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

671 .
	`bud
()

672 .
	`£tSŒ—mID
(
m­SŒ—m
)

673 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, SŒšg>
	`g‘M­Ty³
())

674 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

675 .
	`İ’
();

677 .
	`toA¼ay
(
M­
[]::
Ãw
);

680 
fš®
 
numKeys
 = 
numTh»ads
 * 5;

682 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
();

685 
	`addTe¡S‹p
((
ignÜed_sk_num
) -> {

686 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

690 
	`addTe¡S‹p
Ğ(
sk_num
) -> {

691 
fš®
 
putKey
 = 
r
.
	`ÃxtIÁ
(
numKeys
);

692 
fš®
 
g‘Key
 = 
r
.
	`ÃxtIÁ
(
numKeys
);

693 
‹¡M­
[
sk_num
%
numTh»ads
].
	`put
(
IÁeg”
.
	`toSŒšg
(
putKey
),

694 
‹¡M­
[
sk_num
%
numTh»ads
].
	`g‘
(
IÁeg”
.
	`toSŒšg
(
g‘Key
)));

698 
	`addTe¡S‹p
Ğ(
ignÜed_sk_num
) -> {

699 
Œy
 {

700 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

701 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

702 
abÜts
.
	`šüem’tAndG‘
();

706 
	}
}

708 @
	gTe¡


709 @
Suµ»ssW¬nšgs
("unchecked")

710 
public
 
	$cÚcu¼’tAbÜtMuÉiV›wIÁ”Ëaved
()

711 
throws
 
Exû±iÚ
 {

712 
fš®
 
numTh»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

713 
fš®
 
numRecÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

716 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

717 
abÜts
 = 
Ãw
 
	`AtomicIÁeg”
();

719 
	`g‘MuÉiV›wSM
(
numTh»ads
);

721 
	`scheduËIÁ”Ëaved
(
numTh»ads
,‚umTh»ads*
numRecÜds
);

724 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("TPS", 
numRecÜds
 * 
numTh»ads
, 
¡¬tTime
);

725 
	`ÿlcuÏ‹AbÜtR©e
(
abÜts
.
	`g‘
(), 
numRecÜds
 * 
numTh»ads
);

726 
	}
}

728 @
	gTe¡


729 @
Suµ»ssW¬nšgs
("unchecked")

730 
public
 
	$cÚcu¼’tAbÜtMuÉiV›wTh»aded
()

731 
throws
 
Exû±iÚ
 {

732 
fš®
 
numTh»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

733 
fš®
 
numRecÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

735 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

736 
abÜts
 = 
Ãw
 
	`AtomicIÁeg”
();

738 
	`g‘MuÉiV›wSM
(
numTh»ads
);

740 
	`scheduËTh»aded
(
numTh»ads
,‚umTh»ads*
numRecÜds
);

743 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("TPS", 
numRecÜds
 * 
numTh»ads
, 
¡¬tTime
);

744 
	`ÿlcuÏ‹AbÜtR©e
(
abÜts
.
	`g‘
(), 
numRecÜds
 * 
numTh»ads
);

745 
	}
}

747 @
	gTe¡


748 @
Suµ»ssW¬nšgs
("unchecked")

749 
public
 
	$bulkR—ds
()

750 
throws
 
Exû±iÚ
 {

751 
UUID
 
¡»am
 = UUID.
	`¿ndomUUID
();

752 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

753 .
	`g‘ObjeùsV›w
()

754 .
	`bud
()

755 .
	`£tSŒ—mID
(
¡»am
)

756 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
,SŒšg>
	`g‘M­Ty³
())

757 .
	`İ’
();

759 
‹¡M­
.
	`ş—r
();

760 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

761 
	`as£¹Th©
(
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

762 .
	`isNuÎ
();

766 
fš®
 
num_th»ads
 = 1;

768 
¡¬tTime
 = 
Sy¡em
.
	`ÇnoTime
();

769 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

770 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, SŒšg>
	`g‘M­Ty³
())

771 .
	`£tSŒ—mID
(
¡»am
)

772 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

773 .
	`İ’
();

775 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(0)))

776 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(0));

777 
’dTime
 = 
Sy¡em
.
	`ÇnoTime
();

779 
fš®
 
MILLISECONDS_TO_MICROSECONDS
 = 1000;

780 
‹¡Stus
 +ğ"TimtØ£nd whŞ¡»am=" + 
SŒšg
.
	`fÜm©
("%d us",

781 (
’dTime
 - 
¡¬tTime
è/ 
MILLISECONDS_TO_MICROSECONDS
);

782 
	}
}

784 @
	gD©a


785 @
ToSŒšg


786 şas 
	cTe¡Objeù
 {

787 
fš®
 
SŒšg
 
	g‹¡SŒšg
;

788 
fš®
 
	g‹¡IÁ
;

789 
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gd“pM­
;

	@test/src/test/java/org/corfudb/runtime/collections/CorfuQueueTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g´im™ives
.
	gUnsigÃdBy‹s
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuQueue
.
	gCÜfuQueueRecÜd
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuQueue
.
	gCÜfuRecÜdId
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gCom·¿tÜ
;

12 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gT»eM­
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

26 
public
 cÏs 
	cCÜfuQueueTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

28 @
	mTe¡


29 @
Suµ»ssW¬nšgs
("unchecked")

30 
public
 
	$basicQueueOrd”
() {

31 
CÜfuQueue
<
SŒšg
>

32 
cÜfuQueue
 = 
Ãw
 
CÜfuQueue
<>(
	`g‘DeçuÉRuÁime
(), "test");

34 
CÜfuRecÜdId
 
idC
 = 
cÜfuQueue
.
	`’queue
("c");

35 
CÜfuRecÜdId
 
idB
 = 
cÜfuQueue
.
	`’queue
("b");

36 
CÜfuRecÜdId
 
idA
 = 
cÜfuQueue
.
	`’queue
("a");

38 
Li¡
<
CÜfuQueueRecÜd
<
SŒšg
>> 
»cÜds
 = 
cÜfuQueue
.
	`’ŒyLi¡
();

44 
	`as£¹Th©
(
»cÜds
.
	`g‘
(0).
	`g‘RecÜdId
().
	`g‘EÁryId
()).
	`isEqu®To
(
idC
.getEntryId());

45 
	`as£¹Th©
(
»cÜds
.
	`g‘
(1).
	`g‘RecÜdId
().
	`g‘EÁryId
()).
	`isEqu®To
(
idB
.getEntryId());

46 
	`as£¹Th©
(
»cÜds
.
	`g‘
(2).
	`g‘RecÜdId
().
	`g‘EÁryId
()).
	`isEqu®To
(
idA
.getEntryId());

48 
	`as£¹Th©
(
»cÜds
.
	`g‘
(0).
	`g‘EÁry
()).
	`isEqu®To
("c");

49 
	`as£¹Th©
(
»cÜds
.
	`g‘
(1).
	`g‘EÁry
()).
	`isEqu®To
("b");

50 
	`as£¹Th©
(
»cÜds
.
	`g‘
(2).
	`g‘EÁry
()).
	`isEqu®To
("a");

53 
cÜfuQueue
.
	`»moveEÁry
(
idB
);

55 
	`as£¹Th©ThrownBy
((è-> 
cÜfuQueue
.
	`’ŒyLi¡
(
IÁeg”
.
MAX_VALUE
)).

56 
	`isExaùlyIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

57 
Li¡
<
CÜfuQueueRecÜd
<
SŒšg
>> 
»cÜds2
 =

58 
cÜfuQueue
.
	`’ŒyLi¡
(
ShÜt
.
MAX_VALUE
);

59 
	`as£¹Th©
(
»cÜds2
.
	`g‘
(0).
	`g‘EÁry
()).
	`isEqu®To
("c");

60 
	`as£¹Th©
(
»cÜds2
.
	`g‘
(1).
	`g‘EÁry
()).
	`isEqu®To
("a");

63 
	`as£¹Th©
(
»cÜds
.
	`g‘
(0).
	`g‘RecÜdId
().
	`g‘Ord”šg
()).

64 
	`isLessThª
(
»cÜds2
.
	`g‘
(1).
	`g‘RecÜdId
().
	`g‘Ord”šg
());

66 
	`as£¹Th©
(
»cÜds
.
	`g‘
(0).
	`com·»To
(
»cÜds2
.g‘(1))).
	`isLessThª
(0);

67 
	`as£¹Th©
(
»cÜds
.
	`g‘
(0).
	`g‘RecÜdId
().
	`com·»To
(
»cÜds2
.g‘(1).g‘RecÜdId())).
	`isLessThª
(0);

70 @
Te¡


71 
public
 
	$queueW™hSecÚd¬yIndexCheck
() {

72 
CÜfuQueue
<
SŒšg
>

73 
cÜfuQueue
 = 
Ãw
 
CÜfuQueue
<>(
	`g‘DeçuÉRuÁime
(), "‹¡", 
S”Ÿliz”s
.
JAVA
,

74 
Index
.
Regi¡ry
.
	`em±y
());

76 
CÜfuRecÜdId
 
idC
 = 
cÜfuQueue
.
	`’queue
("c");

77 
CÜfuRecÜdId
 
idB
 = 
cÜfuQueue
.
	`’queue
("b");

78 
CÜfuRecÜdId
 
idA
 = 
cÜfuQueue
.
	`’queue
("a");

80 
fš®
 
ex³ùed
 = 3;

81 
Li¡
<
CÜfuQueueRecÜd
<
SŒšg
>> 
»cÜds
 = 
cÜfuQueue
.
	`’ŒyLi¡
();

82 
	`as£¹Th©
(
»cÜds
.
	`size
()).
	`isEqu®To
(
ex³ùed
);

83 
	}
}

85 @
Te¡


86 
public
 
	$by‹A¼ayËxCom·¿tÜCheck
() {

87 
şass
 
By‹A¼ay
 
im¶em’ts
 
Com·¿bË
<ByteArray>{

88 @
G‘‹r


89 
by‹
[] 
by‹s
;

90 
Com·¿tÜ
<
by‹
[]> 
com·¿tÜ
 = 
UnsigÃdBy‹s
.
	`Ëxicog¿phiÿlCom·¿tÜ
();

91 
	`By‹A¼ay
(
by‹
[] 
by‹s
è{ 
this
.bytes = bytes;}

93 @
Ov”ride


94 
public
 
	`com·»To
(
By‹A¼ay
 
x
) {

95  
com·¿tÜ
.
	`com·»
(
this
.
by‹s
, 
x
.bytes);

98 @
Ov”ride


99 
public
 
SŒšg
 
	`toSŒšg
() {

100  
by‹s
.
	`toSŒšg
();

103 
M­
<
By‹A¼ay
, 
SŒšg
> 
bm­
 = 
Ãw
 
T»eM­
<>();

104 
bm­
.
	`put
(
Ãw
 
	`By‹A¼ay
("xyz".
	`g‘By‹s
()), "xyz");

105 
bm­
.
	`put
(
Ãw
 
	`By‹A¼ay
("lmn".
	`g‘By‹s
()), "lmn");

106 
bm­
.
	`put
(
Ãw
 
	`By‹A¼ay
("fg".
	`g‘By‹s
()), "fg");

107 
bm­
.
	`put
(
Ãw
 
	`By‹A¼ay
("abcd".
	`g‘By‹s
()), "abcd");

108 
M­
.
EÁry
<
By‹A¼ay
, 
SŒšg
> 
b
 : 
bm­
.
	`’ŒyS‘
()) {

109 
Sy¡em
.
out
.
	`´šn
(
b
);

113 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/CorfuStoreTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDyÇmicMes§ge
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfo
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

18 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

20 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

22 
impÜt
 
	gjava
.
	gut
.
	gM­
;

23 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

24 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

26 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gDesütÜPrÙo
;

27 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
;

28 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜS‘
;

29 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gDesütÜV®id©iÚExû±iÚ
;

30 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
;

31 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

32 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gFœew®lRuË
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûs
;

44 @
Slf4j


45 
public
 cÏs 
	cCÜfuStÜeTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

46 @
Te¡


47 
public
 
	$basicTe¡
(è
throws
 
Exû±iÚ
 {

50 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

53 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
cÜfuRuÁime
);

56 
fš®
 
SŒšg
 
nsxMªag”
 = "nsx-manager";

58 
fš®
 
SŒšg
 
bËName
 = "EventInfo";

62 
TabË
<
Uuid
, 
Ev’tInfo
, 
MªagedResourûs
> 
bË
 = 
cÜfuStÜe
.
	`İ’TabË
(

63 
nsxMªag”
,

64 
bËName
,

65 
Uuid
.
şass
,

66 
Ev’tInfo
.
şass
,

67 
MªagedResourûs
.
şass
,

69 
TabËO±iÚs
.
	`bud”
().
	`bud
());

72 
fš®
 
couÁ
 = 100;

73 
Li¡
<
Uuid
> 
uuids
 = 
Ãw
 
A¼ayLi¡
<>();

74 
Li¡
<
Ev’tInfo
> 
ev’ts
 = 
Ãw
 
A¼ayLi¡
<>();

75 
MªagedResourûs
 
m‘ad©a
 = MªagedResourûs.
	`ÃwBud”
().
	`£tC»©eU£r
("MrPrÙo").
	`bud
();

79 
bË
.
	`ü—‹
(
Uuid
.
	`ÃwBud”
().
	`£tLsb
(0L).
	`£tMsb
(0L).
	`bud
(),

80 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("sim¶eCRUD").
	`bud
(),

81 
m‘ad©a
);

84 
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

87 
TxBud”
 
tx
 = 
cÜfuStÜe
.
	`tx
(
nsxMªag”
);

88 
i
 = 0; i < 
couÁ
; i++) {

89 
UUID
 
uuid
 = UUID.
	`ÇmeUUIDFromBy‹s
(
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

90 
Uuid
 
uuidMsg
 = Uuid.
	`ÃwBud”
()

91 .
	`£tMsb
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
())

92 .
	`£tLsb
(
uuid
.
	`g‘L—¡SignifiÿÁB™s
())

93 .
	`bud
();

94 
uuids
.
	`add
(
uuidMsg
);

96 
ev’ts
.
	`add
(
Ev’tInfo
.
	`ÃwBud”
()

97 .
	`£tId
(
i
)

98 .
	`£tName
("ev’t_" + 
i
)

99 .
	`£tEv’tTime
(
i
)

100 .
	`bud
());

102 
tx
.
	`upd©e
(
bËName
, 
uuids
.
	`g‘
(
i
), 
ev’ts
.g‘(i), 
m‘ad©a
);

104 
tx
.
	`comm™
();

107 
Qu”y
 
q
 = 
cÜfuStÜe
.
	`qu”y
(
nsxMªag”
);

110 
fš®
 
fiáy
 = 50;

111 
UUID
 
uuid
 = UUID.
	`ÇmeUUIDFromBy‹s
(
IÁeg”
.
	`toSŒšg
(
fiáy
).
	`g‘By‹s
());

112 
Uuid
 
lookupKey
 = Uuid.
	`ÃwBud”
()

113 .
	`£tMsb
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
())

114 .
	`£tLsb
(
uuid
.
	`g‘L—¡SignifiÿÁB™s
())

115 .
	`bud
();

117 
Ev’tInfo
 
ex³ùedV®ue
 = Ev’tInfo.
	`ÃwBud”
()

118 .
	`£tId
(
fiáy
)

119 .
	`£tName
("ev’t_" + 
fiáy
)

120 .
	`£tEv’tTime
(
fiáy
)

121 .
	`bud
();

123 
	`as£¹Th©ThrownBy
((è-> 
q
.
	`g‘RecÜd
(
nuÎ
, 
lookupKey
))

124 .
	`isExaùlyIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

126 
	`as£¹Th©
(
q
.
	`g‘RecÜd
(
bËName
, 
lookupKey
).
	`g‘Paylßd
()).
	`isEqu®To
(
ex³ùedV®ue
);

129 
fš®
 
fiáyLÚg
 = 50L;

130 
CŞËùiÚ
<
Mes§ge
> 
£cÚd¬yIndex
 = 
q
.
	`g‘ByIndex
(
bËName
, "ev’t_time", 
fiáyLÚg
).
	`g‘ResuÉ
()

131 .
	`¡»am
()

132 .
	`m­
(
M­
.
EÁry
::
g‘V®ue
)

133 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

134 
	`as£¹Th©
(
£cÚd¬yIndex
)

135 .
	`hasSize
(1)

136 .
	`cÚšsExaùly
(
ex³ùedV®ue
);

139 
fš®
 
sixty
 = 60;

141 
Qu”yResuÉ
<
CÜfuStÜeEÁry
<
Uuid
, 
Ev’tInfo
, 
MªagedResourûs
>> 
qu”yResuÉ
 =

142 
q
.
	`execu‹Qu”y
(
bËName
, 
»cÜd
 -> ((
Ev’tInfo
è»cÜd.
	`g‘Paylßd
()).
	`g‘Ev’tTime
(è>ğ
sixty
);

143 
	`as£¹Th©
(
qu”yResuÉ
.
	`g‘ResuÉ
().
	`size
())

144 .
	`isEqu®To
(
couÁ
 - 
sixty
);

146 
	`as£¹Th©
(
q
.
	`couÁ
(
bËName
, 
time¡amp
)).
	`isEqu®To
(1);

147 
	`as£¹Th©
(
q
.
	`couÁ
(
bËName
)).
	`isEqu®To
(
couÁ
 + 1);

149 
	`as£¹Th©
(
q
.
	`keyS‘
(
bËName
, 
nuÎ
)).
	`hasSize
(
couÁ
 + 1);

151 
	`as£¹Th©
(
cÜfuStÜe
.
	`li¡TabËs
(
nsxMªag”
))

152 .
	`cÚšsExaùly
(
CÜfuStÜeM‘ad©a
.
TabËName
.
	`ÃwBud”
()

153 .
	`£tName¥aû
(
nsxMªag”
)

154 .
	`£tTabËName
(
bËName
)

155 .
	`bud
());

165 @
Te¡


166 
public
 
	$checkM‘ad©aT¿n§ùiÚs
(è
throws
 
Exû±iÚ
 {

169 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

172 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
cÜfuRuÁime
);

175 
fš®
 
SŒšg
 
nsxMªag”
 = "nsx-manager";

177 
fš®
 
SŒšg
 
bËName
 = "EventInfo";

181 
TabË
<
Uuid
, 
Ev’tInfo
, 
MªagedResourûs
> 
bË
 = 
cÜfuStÜe
.
	`İ’TabË
(

182 
nsxMªag”
,

183 
bËName
,

184 
Uuid
.
şass
,

185 
Ev’tInfo
.
şass
,

186 
MªagedResourûs
.
şass
,

188 
TabËO±iÚs
.
	`bud”
().
	`bud
());

190 
UUID
 
uuid1
 = UUID.
	`ÇmeUUIDFromBy‹s
("1".
	`g‘By‹s
());

191 
Uuid
 
key1
 = Uuid.
	`ÃwBud”
()

192 .
	`£tMsb
(
uuid1
.
	`g‘Mo¡SignifiÿÁB™s
()).
	`£tLsb
(uuid1.
	`g‘L—¡SignifiÿÁB™s
())

193 .
	`bud
();

194 
MªagedResourûs
 
u£r_1
 = MªagedResourûs.
	`ÃwBud”
().
	`£tC»©eU£r
("u£r_1").
	`bud
();

195 
MªagedResourûs
 
u£r_2
 = MªagedResourûs.
	`ÃwBud”
().
	`£tC»©eU£r
("u£r_2").
	`bud
();

196 
ex³ùedV”siÚ
 = 0L;

198 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

199 .
	`ü—‹
(
bËName
,

200 
key1
,

201 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("abc").
	`bud
(),

202 
u£r_1
)

203 .
	`comm™
();

204 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

205 .
	`isEqu®To
(
MªagedResourûs
.
	`ÃwBud”
()

206 .
	`£tC»©eU£r
("user_1")

207 .
	`£tC»©eTime¡amp
(0L)

208 .
	`£tNe¡edTy³
(
Sam¶eSchema
.
Ne¡edTy³A
.
	`ÃwBud”
().
	`bud
())

209 .
	`£tV”siÚ
(
ex³ùedV”siÚ
++).
	`bud
());

212 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

213 .
	`upd©e
(
bËName
,

214 
key1
,

215 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("bcd").
	`bud
(),

216 
MªagedResourûs
.
	`ÃwBud”
().
	`£tC»©eU£r
("u£r_2").
	`£tV”siÚ
(0L).
	`bud
())

217 .
	`comm™
();

218 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

219 .
	`isEqu®To
(
MªagedResourûs
.
	`ÃwBud”
()

220 .
	`£tC»©eU£r
("user_2")

221 .
	`£tC»©eTime¡amp
(0L)

222 .
	`£tNe¡edTy³
(
Sam¶eSchema
.
Ne¡edTy³A
.
	`ÃwBud”
().
	`bud
())

223 .
	`£tV”siÚ
(
ex³ùedV”siÚ
++).
	`bud
());

226 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

227 .
	`upd©e
(
bËName
,

228 
key1
,

229 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("cde").
	`bud
(),

230 
u£r_2
)

231 .
	`comm™
();

232 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

233 .
	`isEqu®To
(
MªagedResourûs
.
	`ÃwBud”
()

234 .
	`£tC»©eU£r
("user_2")

235 .
	`£tC»©eTime¡amp
(0L)

236 .
	`£tNe¡edTy³
(
Sam¶eSchema
.
Ne¡edTy³A
.
	`ÃwBud”
().
	`bud
())

237 .
	`£tV”siÚ
(
ex³ùedV”siÚ
).
	`bud
());

239 
cÜfuStÜe
.
	`tx
(
nsxMªag”
).
	`d–‘e
(
bËName
, 
key1
).
	`comm™
();

240 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
)).
	`isNuÎ
();

241 
ex³ùedV”siÚ
 = 0L;

243 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

244 .
	`upd©e
(
bËName
,

245 
key1
,

246 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("def").
	`bud
(),

247 
u£r_2
)

248 .
	`comm™
();

249 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

250 .
	`isEqu®To
(
MªagedResourûs
.
	`ÃwBud”
(
u£r_2
)

251 .
	`£tC»©eTime¡amp
(0L)

252 .
	`£tNe¡edTy³
(
Sam¶eSchema
.
Ne¡edTy³A
.
	`ÃwBud”
().
	`bud
())

253 .
	`£tV”siÚ
(
ex³ùedV”siÚ
).
	`bud
());

256 
	`as£¹Th©ThrownBy
(() ->

257 
bË
.
	`upd©e
(
key1
, 
Ev’tInfo
.
	`g‘DeçuÉIn¡ªû
(), 
nuÎ
))

258 .
	`isExaùlyIn¡ªûOf
(
RuÁimeExû±iÚ
.
şass
);

261 
MªagedResourûs
 
wrÚgRevisiÚM‘ad©a
 = MªagedResourûs.
	`ÃwBud”
(
u£r_2
)

262 .
	`£tV”siÚ
(2).
	`bud
();

264 
	`as£¹Th©ThrownBy
(() ->

265 
bË
.
	`upd©e
(
key1
, 
Ev’tInfo
.
	`g‘DeçuÉIn¡ªû
(), 
wrÚgRevisiÚM‘ad©a
))

266 .
	`isExaùlyIn¡ªûOf
(
RuÁimeExû±iÚ
.
şass
);

267 
	}
}

274 @
Te¡


275 
public
 
	$checkNuÎM‘ad©aT¿n§ùiÚs
(è
throws
 
Exû±iÚ
 {

278 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

281 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
cÜfuRuÁime
);

284 
fš®
 
SŒšg
 
nsxMªag”
 = "nsx-manager";

286 
fš®
 
SŒšg
 
bËName
 = "EventInfo";

290 
TabË
<
Uuid
, 
Ev’tInfo
, 
MªagedResourûs
> 
bË
 = 
cÜfuStÜe
.
	`İ’TabË
(

291 
nsxMªag”
,

292 
bËName
,

293 
Uuid
.
şass
,

294 
Ev’tInfo
.
şass
,

295 
nuÎ
,

297 
TabËO±iÚs
.
	`bud”
().
	`bud
());

299 
UUID
 
uuid1
 = UUID.
	`ÇmeUUIDFromBy‹s
("1".
	`g‘By‹s
());

300 
Uuid
 
key1
 = Uuid.
	`ÃwBud”
().
	`£tMsb
(
uuid1
.
	`g‘Mo¡SignifiÿÁB™s
()).
	`£tLsb
(uuid1.
	`g‘L—¡SignifiÿÁB™s
()).
	`bud
();

301 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

302 .
	`ü—‹
(
bËName
,

303 
key1
,

304 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("abc").
	`bud
(),

305 
nuÎ
)

306 .
	`comm™
();

307 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

308 .
	`isNuÎ
();

310 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

311 .
	`upd©e
(
bËName
,

312 
key1
,

313 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("bcd").
	`bud
(),

314 
MªagedResourûs
.
	`ÃwBud”
().
	`£tC»©eU£r
("‹¡U£r").
	`£tV”siÚ
(1L).
	`bud
())

315 .
	`comm™
();

316 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

317 .
	`isNuÎ
();

319 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

320 .
	`upd©e
(
bËName
,

321 
key1
,

322 
Ev’tInfo
.
	`ÃwBud”
().
	`£tName
("cde").
	`bud
(),

323 
nuÎ
)

324 .
	`comm™
();

325 
	`as£¹Th©
(
cÜfuStÜe
.
	`İ’TabË
(
nsxMªag”
, 
bËName
).
	`g‘
(
key1
).
	`g‘M‘ad©a
())

326 .
	`isNuÎ
();

327 
	}
}

334 @
Te¡


335 
public
 
	$checkM‘ad©aM”gesOldF›ldsTe¡
(è
throws
 
Exû±iÚ
 {

337 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

340 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
cÜfuRuÁime
);

343 
fš®
 
SŒšg
 
nsxMªag”
 = "nsx-manager";

345 
fš®
 
SŒšg
 
bËName
 = "EventInfo";

349 
TabË
<
Uuid
, 
Ev’tInfo
, 
MªagedResourûs
> 
bË
 = 
cÜfuStÜe
.
	`İ’TabË
(

350 
nsxMªag”
,

351 
bËName
,

352 
Uuid
.
şass
,

353 
Ev’tInfo
.
şass
,

354 
MªagedResourûs
.
şass
,

356 
TabËO±iÚs
.
	`bud”
().
	`bud
());

358 
Uuid
 
key
 = Uuid.
	`ÃwBud”
().
	`£tLsb
(0L).
	`£tMsb
(0L).
	`bud
();

359 
Ev’tInfo
 
v®ue
 = Ev’tInfo.
	`ÃwBud”
().
	`£tName
("sim¶eV®ue").
	`bud
();

361 
time¡amp
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

362 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

363 .
	`ü—‹
(
bËName
, 
key
, 
v®ue
,

364 
MªagedResourûs
.
	`ÃwBud”
()

365 .
	`£tC»©eTime¡amp
(
time¡amp
).
	`bud
())

366 .
	`comm™
();

368 
cÜfuStÜe
.
	`tx
(
nsxMªag”
)

369 .
	`upd©e
(
bËName
, 
key
, 
v®ue
,

370 
MªagedResourûs
.
	`ÃwBud”
().
	`£tC»©eU£r
("C»©eU£r").
	`bud
())

371 .
	`comm™
();

373 
CÜfuRecÜd
<
Ev’tInfo
, 
MªagedResourûs
> 
»cÜd1
 = 
bË
.
	`g‘
(
key
);

374 
	`as£¹Th©
(
»cÜd1
.
	`g‘M‘ad©a
().
	`g‘C»©eTime¡amp
()).
	`isEqu®To
(
time¡amp
);

375 
	`as£¹Th©
(
»cÜd1
.
	`g‘M‘ad©a
().
	`g‘C»©eU£r
()).
	`isEqu®To
("CreateUser");

376 
	}
}

384 @
Te¡


385 
public
 
	$DyÇmicMes§gePrÙobufTe¡
(è
throws
 
Exû±iÚ
 {

386 
fš®
 
ruËId
 = 123;

387 
Fœew®lRuË
 
ruË
 = FirewallRule

388 .
	`ÃwBud”
()

389 .
	`£tRuËId
(
ruËId
)

390 .
	`£tRuËName
("TestRule")

391 .
	`£tIÅut
(
AµlŸnû
.
	`ÃwBud”
().
	`£tEndpošt
("127.0.0.1").
	`bud
())

392 .
	`£tOuut
(
AµlŸnû
.
	`ÃwBud”
().
	`£tEndpošt
("196.168.0.1").
	`bud
())

393 .
	`bud
();

395 
Mes§ge
 
mes§ge
 = 
ruË
;

397 
mes§ge
.
	`g‘AÎF›lds
().
	`fÜEach
((
f›ldDesütÜ
, 
f›ld
) -> {

398 ià(
f›ldDesütÜ
.
	`g‘O±iÚs
().
	`g‘Ex‹nsiÚ
(
CÜfuO±iÚs
.
schema
).
	`g‘SecÚd¬yKey
()) {

399 
log
.
	`šfo
("D‘eùed secÚd¬y key " + 
f›ldDesütÜ
.
	`g‘Name
(è+ " = " + 
f›ld
);

403 
FeDesütÜ
 
­¶ŸnûFeDesütÜ
 = 
AµlŸnû
.
	`g‘DesütÜ
().
	`g‘Fe
();

404 
FeDesütÜ
 
fœew®lFeDesütÜ
 = 
Fœew®lRuË
.
	`g‘DesütÜ
().
	`g‘Fe
();

405 
FeDesütÜ
 
schemaM‘ad©aFeDesütÜ
 = 
CÜfuO±iÚs
.
	`g‘DesütÜ
();

406 
FeDesütÜ
 
googËDesütÜ
 = 
DesütÜPrÙo
.
	`g‘DesütÜ
().
	`g‘Fe
();

408 
by‹
[] 
d©a
 = 
mes§ge
.
	`toBy‹A¼ay
();

409 
by‹
[] 
­¶ŸnûSchemaBy‹s
 = 
­¶ŸnûFeDesütÜ
.
	`toPrÙo
().
	`toBy‹A¼ay
();

410 
by‹
[] 
fœew®lSchemaBy‹s
 = 
fœew®lFeDesütÜ
.
	`toPrÙo
().
	`toBy‹A¼ay
();

411 
by‹
[] 
m‘ad©aSchemaBy‹s
 = 
schemaM‘ad©aFeDesütÜ
.
	`toPrÙo
().
	`toBy‹A¼ay
();

412 
by‹
[] 
googËSchemaBy‹s
 = 
googËDesütÜ
.
	`toPrÙo
().
	`toBy‹A¼ay
();

414 
FeDesütÜPrÙo
 
­¶ŸnûSchemaPrÙo
 = FeDesütÜPrÙo.
	`·r£From
(
­¶ŸnûSchemaBy‹s
);

415 
FeDesütÜPrÙo
 
fœew®lSchemaPrÙo
 = FeDesütÜPrÙo.
	`·r£From
(
fœew®lSchemaBy‹s
);

416 
FeDesütÜPrÙo
 
m‘ad©aSchemaPrÙo
 = FeDesütÜPrÙo.
	`·r£From
(
m‘ad©aSchemaBy‹s
);

417 
FeDesütÜPrÙo
 
googËDesütÜPrÙo
 = FeDesütÜPrÙo.
	`·r£From
(
googËSchemaBy‹s
);

419 
FeDesütÜS‘
 
feDesütÜS‘
 = FeDesütÜS‘.
	`ÃwBud”
()

420 .
	`addFe
(
­¶ŸnûSchemaPrÙo
)

421 .
	`addFe
(
fœew®lSchemaPrÙo
)

422 .
	`addFe
(
m‘ad©aSchemaPrÙo
)

423 .
	`addFe
(
googËDesütÜPrÙo
)

424 .
	`bud
();

426 
M­
<
SŒšg
, 
FeDesütÜPrÙo
> 
feDesütÜPrÙoM­
 = 
Ãw
 
HashM­
<>();

427 
feDesütÜS‘
.
	`g‘FeLi¡
().
	`fÜEach
(
feDesütÜPrÙo
 -> 
feDesütÜPrÙoM­
.
	`put
(

428 
feDesütÜPrÙo
.
	`g‘Name
(), fileDescriptorProto));

430 
Any
 
ªy
 = Any.
	`·ck
(
mes§ge
);

431 
by‹
[] 
ªyBy‹s
 = 
ªy
.
	`toBy‹A¼ay
();

432 
log
.
	`šfo
("{}", 
ªyBy‹s
);

433 
ªy
 = 
Any
.
	`·r£From
(
ªyBy‹s
);

434 
log
.
	`šfo
(
ªy
.
	`g‘Ty³U¾
());

435 
Mes§ge
 
m
 = 
ªy
.
	`uÅack
(
Fœew®lRuË
.
şass
);

436 
	`´štMes§ge
(
d©a
, 
feDesütÜPrÙoM­
);

437 
	}
}

439 
´štMes§ge
(
by‹
[] 
d©a
, 
M­
<
SŒšg
, 
FeDesütÜPrÙo
> 
m­
è
throws
 
	gExû±iÚ
 {

441 
FeDesütÜ
 
	gfœew®lDesütÜ
 = 
g‘DesütÜs
("§m¶e_schema.´Ùo", 
m­
);

442 
DyÇmicMes§ge
 
	gmsg
 = DyÇmicMes§ge.
·r£From
(
fœew®lDesütÜ
.
fšdMes§geTy³ByName
("Fœew®lRuË"), 
d©a
);

443 
	glog
.
šfo
(
msg
.
toSŒšg
());

446 
FeDesütÜ
 
g‘DesütÜs
(
SŒšg
 
Çme
, 
M­
<SŒšg, 
FeDesütÜPrÙo
> 
m­
è
throws
 
	gDesütÜV®id©iÚExû±iÚ
 {

448 
	gLi¡
<
	gFeDesütÜ
> 
	gli¡
 = 
Ãw
 
A¼ayLi¡
<>();

449 
SŒšg
 
	gs
 : 
m­
.
g‘
(
Çme
).
g‘D•’d’cyLi¡
()) {

450 
FeDesütÜ
 
desütÜs
 = 
g‘DesütÜs
(
s
, 
m­
);

451 
	gli¡
.
add
(
desütÜs
);

453 
	gFeDesütÜ
[] 
	gfeDesütÜs
 = 
li¡
.
toA¼ay
(
Ãw
 
FeDesütÜ
[li¡.
size
()]);

454  
	gFeDesütÜ
.
budFrom
(
m­
.
g‘
(
Çme
), 
feDesütÜs
);

	@test/src/test/java/org/corfudb/runtime/collections/CorfuTableTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

8 
impÜt
 
	gjava
.
	gut
.
	gCÚcu¼’tModifiÿtiÚExû±iÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

11 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

12 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

13 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	gd©a
.
	gM­EÁry
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

19 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

21 
public
 cÏs 
	cCÜfuTabËTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

23 
	mCŞËùiÚ
<
	mSŒšg
> 
´ojeù
(
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
’Œ›s
) {

24  
	m’Œ›s
.
¡»am
().
m­
(
’Œy
 ->ƒÁry.
g‘V®ue
()).
cŞËù
(
CŞËùÜs
.
toCŞËùiÚ
(
A¼ayLi¡
::
Ãw
));

27 @
Te¡


28 
public
 
	$İ’šgCÜfuTabËTwiû
() {

29 
CÜfuTabË
<
SŒšg
, String>

30 
š¡ªû1
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

31 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

32 .
	`£tArgum’ts
(
Ãw
 
	`SŒšgIndex”
())

33 .
	`£tSŒ—mName
("test")

34 .
	`İ’
();

36 
	`as£¹Th©
(
š¡ªû1
.
	`hasSecÚd¬yIndiûs
()).
	`isTrue
();

38 
CÜfuTabË
<
SŒšg
, String>

39 
š¡ªû2
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

40 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

41 .
	`£tSŒ—mName
("test")

42 .
	`İ’
();

48 
	}
}

50 @
	gTe¡


51 @
Suµ»ssW¬nšgs
("unchecked")

52 
public
 
	$ÿnR—dFromEachIndex
() {

53 
CÜfuTabË
<
SŒšg
, String>

54 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

55 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

56 .
	`£tArgum’ts
(
Ãw
 
	`SŒšgIndex”
())

57 .
	`£tSŒ—mName
("test")

58 .
	`İ’
();

60 
cÜfuTabË
.
	`put
("k1", "a");

61 
cÜfuTabË
.
	`put
("k2", "ab");

62 
cÜfuTabË
.
	`put
("k3", "b");

64 
	`as£¹Th©
(
	`´ojeù
(
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "a")))

65 .
	`cÚšsExaùly
("ab", "a");

67 
	`as£¹Th©
(
	`´ojeù
(
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_VALUE
, "ab")))

68 .
	`cÚšsExaùly
("ab");

69 
	}
}

75 @
Te¡
 (
ex³ùed
 = 
IÎeg®Argum’tExû±iÚ
.
şass
)

76 @
Suµ»ssW¬nšgs
("unchecked")

77 
public
 
	$ÿÂÙLookupByIndexWh’IndexNÙS³cif›d
() {

78 
CÜfuTabË
<
SŒšg
, String>

79 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

80 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

81 .
	`£tSŒ—mName
("test")

82 .
	`İ’
();

84 
cÜfuTabË
.
	`put
("k1", "a");

85 
cÜfuTabË
.
	`put
("k2", "ab");

86 
cÜfuTabË
.
	`put
("k3", "b");

88 
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "a");

89 
	}
}

95 @
Te¡
 (
ex³ùed
 = 
IÎeg®Argum’tExû±iÚ
.
şass
)

96 @
Suµ»ssW¬nšgs
("unchecked")

97 
public
 
	$ÿÂÙLookupByIndexAndF‹rWh’IndexNÙS³cif›d
() {

98 
CÜfuTabË
<
SŒšg
, String>

99 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

100 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

101 .
	`£tSŒ—mName
("test")

102 .
	`İ’
();

104 
cÜfuTabË
.
	`put
("a", "abcdef");

105 
cÜfuTabË
.
	`g‘ByIndexAndF‹r
(
SŒšgIndex”
.
BY_FIRST_LETTER
, 
p
 ->….
	`g‘V®ue
().
	`cÚšs
("cd"), "a");

106 
	}
}

111 @
	gTe¡


112 @
Suµ»ssW¬nšgs
("unchecked")

113 
public
 
	$ÿnR—dFromMuÉËIndiûs
() {

114 
CÜfuTabË
<
SŒšg
, SŒšg> 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
()

115 .
	`g‘ObjeùsV›w
()

116 .
	`bud
()

117 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

118 .
	`£tArgum’ts
(
Ãw
 
	`SŒšgMuÉiIndex”
())

119 .
	`£tSŒ—mName
("test-map")

120 .
	`İ’
();

122 
cÜfuTabË
.
	`put
("k1", "dog fox cat");

123 
cÜfuTabË
.
	`put
("k2", "dog bat");

124 
cÜfuTabË
.
	`put
("k3", "fox");

126 
fš®
 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
»suÉ
 =

127 
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgMuÉiIndex”
.
BY_EACH_WORD
, "fox");

128 
	`as£¹Th©
(
	`´ojeù
(
»suÉ
)).
	`cÚšsExaùlyInAnyOrd”
("dog fox cat", "fox");

129 
	}
}

131 @
	gTe¡


132 @
Suµ»ssW¬nšgs
("unchecked")

133 
public
 
	$em±yIndexesR‘uºEm±yV®ues
() {

134 
CÜfuTabË
<
SŒšg
, String>

135 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

136 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

137 .
	`£tArgum’ts
(
Ãw
 
	`SŒšgIndex”
())

138 .
	`£tSŒ—mName
("test")

139 .
	`İ’
();

142 
	`as£¹Th©
(
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "a"))

143 .
	`isEm±y
();

145 
	`as£¹Th©
(
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_VALUE
, "ab"))

146 .
	`isEm±y
();

147 
	}
}

154 @
	gTe¡


155 @
Suµ»ssW¬nšgs
("unchecked")

156 
public
 
	$´obËm©icIndexFunùiÚ
() {

158 
CÜfuTabË
<
SŒšg
, String>

159 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

160 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

161 .
	`£tArgum’ts
(
Ãw
 
SŒšgIndex”
.
	`FašgIndex
())

162 .
	`£tSŒ—mName
("failing-index")

163 .
	`İ’
();

165 
As£¹iÚs
.
	`as£¹Th©Exû±iÚOfTy³
(
UÄecov”abËCÜfuE¼Ü
.
şass
)

166 .
	`isThrownBy
((è-> 
cÜfuTabË
.
	`put
(
this
.
	`g‘CÏss
().
	`g‘CªÚiÿlName
(),

167 
this
.
	`g‘CÏss
().
	`g‘CªÚiÿlName
()))

168 .
	`w™hCau£In¡ªûOf
(
CÚcu¼’tModifiÿtiÚExû±iÚ
.
şass
);

169 
	}
}

175 @
	gTe¡


176 @
Suµ»ssW¬nšgs
("unchecked")

177 
public
 
	$´obËm©icIndexFunùiÚTx
() {

178 
CÜfuTabË
<
SŒšg
, String>

179 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

180 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

181 .
	`£tArgum’ts
(
Ãw
 
SŒšgIndex”
.
	`FašgIndex
())

182 .
	`£tSŒ—mName
("failing-index")

183 .
	`İ’
();

185 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

187 
As£¹iÚs
.
	`as£¹Th©Exû±iÚOfTy³
(
UÄecov”abËCÜfuE¼Ü
.
şass
)

188 .
	`isThrownBy
((è-> 
cÜfuTabË
.
	`put
(
this
.
	`g‘CÏss
().
	`g‘CªÚiÿlName
(),

189 
this
.
	`g‘CÏss
().
	`g‘CªÚiÿlName
()))

190 .
	`w™hCau£In¡ªûOf
(
CÚcu¼’tModifiÿtiÚExû±iÚ
.
şass
);

192 
As£¹iÚs
.
	`as£¹Th©
(
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
()).
	`isTrue
();

193 
	}
}

195 @
	gTe¡


196 @
Suµ»ssW¬nšgs
("unchecked")

197 
public
 
	$ÿnR—dW™houtIndexes
() {

198 
CÜfuTabË
<
SŒšg
, String>

199 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

200 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

201 .
	`£tSŒ—mName
("test")

202 .
	`İ’
();

204 
cÜfuTabË
.
	`put
("k1", "a");

205 
cÜfuTabË
.
	`put
("k2", "ab");

206 
cÜfuTabË
.
	`put
("k3", "b");

208 
	`as£¹Th©
(
cÜfuTabË
)

209 .
	`cÚšsExaùly
(
M­EÁry
.
	`’Œy
("k1", "a"),

210 
M­EÁry
.
	`’Œy
("k2", "ab"),

211 
M­EÁry
.
	`’Œy
("k3", "b"));

212 
	}
}

217 @
Te¡


218 
public
 
	$doUpd©eIndiûsOnRemove
(è
throws
 
Exû±iÚ
 {

219 
CÜfuTabË
<
SŒšg
, String>

220 
cÜfuTabË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

221 .
	`£tTy³Tok’
(
CÜfuTabË
.<
SŒšg
, SŒšg>
	`g‘TabËTy³
())

222 .
	`£tArgum’ts
(
Ãw
 
	`SŒšgIndex”
())

223 .
	`£tSŒ—mName
("test")

224 .
	`İ’
();

226 
cÜfuTabË
.
	`put
("k1", "a");

227 
cÜfuTabË
.
	`put
("k2", "ab");

228 
cÜfuTabË
.
	`put
("k3", "b");

229 
cÜfuTabË
.
	`»move
("k2");

231 
	`as£¹Th©
(
	`´ojeù
(
cÜfuTabË
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "a")))

232 .
	`cÚšsExaùly
("a");

233 
	}
}

239 @
Te¡


240 
public
 
	$¢­shÙInv¬ŸÁ
() {

241 
fš®
 
NUM_WRITES
 = 10;

242 
fš®
 
CÚ‹xtAw¬eM­
<
IÁeg”
, IÁeg”> 
m­
 = 
Ãw
 
SŒ—mšgM­DecÜ©Ü
<>();

243 
IÁSŒ—m
.
	`¿nge
(0, 
NUM_WRITES
).
	`fÜEach
(
num
 -> 
m­
.
	`put
(num,‚um));

245 
fš®
 
SŒ—m
<
M­
.
EÁry
<
IÁeg”
, IÁeg”>> 
»suÉ
 = 
m­
.
	`’ŒySŒ—m
();

246 
»suÉ
.
	`fÜEach
(
e
 -> 
m­
.
	`put
(
Ãw
 
	`Rªdom
().
	`ÃxtIÁ
(), 0));

247 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/DiskBackedCorfuClientTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gSŒ—ms
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gm©h
.
	gQuªtes
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	ggsÚ
.
	gGsÚ
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§ge
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

10 
impÜt
 
	glombok
.
	gBud”
;

11 
impÜt
 
	glombok
.
	gD©a
;

12 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gArb™¿r›s
;

13 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gArb™¿ry
;

14 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gFÜAÎ
;

15 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gPrİ”ty
;

16 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gProvide
;

17 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gcÚ¡¿šts
.
	gAÍhaCh¬s
;

18 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gcÚ¡¿šts
.
	gSize
;

19 
impÜt
 
	gÃt
.
	gjqwik
.
	g­i
.
	gcÚ¡¿šts
.
	gSŒšgL’gth
;

20 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gio
.
	gFeUts
;

21 
impÜt
 
	gÜg
.
	g­ache
.
	gcommÚs
.
	gÏng
.
	gRªdomSŒšgUts
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	guÄecov”abË
.
	gUÄecov”abËCÜfuE¼Ü
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuV”siÚPŞicy
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfo
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gAs£¹iÚs
;

33 
impÜt
 
	gÜg
.
	grocksdb
.
	gEnv
;

34 
impÜt
 
	gÜg
.
	grocksdb
.
	gO±iÚs
;

35 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDBExû±iÚ
;

36 
impÜt
 
	gÜg
.
	grocksdb
.
	gS¡FeMªag”
;

38 
impÜt
 
	gjava
.
	gio
.
	gInv®idObjeùExû±iÚ
;

39 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©h
;

40 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

41 
impÜt
 
	gjava
.
	gut
.
	gAb¡¿ùM­
.
	gSim¶eEÁry
;

42 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

43 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

44 
impÜt
 
	gjava
.
	gut
.
	gM­
;

45 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

46 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

47 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gSuµl›r
;

48 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

49 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

51 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

52 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

57 
public
 cÏs 
	cDiskBackedCÜfuCl›ÁTe¡
 
ex‹nds
 
Ab¡¿ùV›wTe¡
 
im¶em’ts
 
	mAutoClo£abË
 {

59 
´iv©e
 
fš®
 
P©h
 
	m³rsi¡edCacheLoÿtiÚ
 = 
P©hs
.
g‘
("/tmp/", "diskBackedMap2");

60 
´iv©e
 
fš®
 
	mSAMPLE_SIZE
 = 100;

61 
´iv©e
 
fš®
 
	mNUM_OF_TRIES
 = 1;

62 
´iv©e
 
fš®
 
	mSTRING_MIN
 = 5;

63 
´iv©e
 
fš®
 
	mSTRING_MAX
 = 10;

66 
public
 
	$DiskBackedCÜfuCl›ÁTe¡
() {

67 
Ab¡¿ùV›wTe¡
.
	`š™Ev’tGroup
();

68 
su³r
.
	`»£tTe¡s
();

71 @
Ov”ride


72 
public
 
	$şo£
() {

73 
su³r
.
	`ş—nupBufãrs
();

74 
Ab¡¿ùV›wTe¡
.
	`ş—nEv’tGroup
();

75 
	}
}

80 
public
 şas 
	cPojoS”Ÿliz”
 
im¶em’ts
 
	gIS”Ÿliz”
 {

81 
´iv©e
 
fš®
 
GsÚ
 
	ggsÚ
 = 
Ãw
 Gson();

82 
´iv©e
 
fš®
 
	gCÏss
<?> 
	gşazz
;

83 
´iv©e
 
fš®
 
	gSERIALIZER_OFFSET
 = 23;

85 
PojoS”Ÿliz”
(
CÏss
<?> 
şazz
) {

86 
	gthis
.
	gşazz
 = 
şazz
;

89 
´iv©e
 
	gby‹
[] 
by‹A¼ayFromBuf
(
fš®
 
By‹Buf
 
buf
) {

90 
By‹Buf
 
	g»adOÆyCİy
 = 
buf
.
asR—dOÆy
();

91 
	g»adOÆyCİy
.
»£tR—d”Index
();

92 
	gby‹
[] 
	goutA¼ay
 = 
Ãw
 
by‹
[
»adOÆyCİy
.
»adabËBy‹s
()];

93 
	g»adOÆyCİy
.
»adBy‹s
(
outA¼ay
);

94  
	goutA¼ay
;

97 @
Ov”ride


98 
public
 
by‹
 
g‘Ty³
() {

99  
	gSERIALIZER_OFFSET
;

102 @
Ov”ride


103 
public
 
Objeù
 
de£rŸlize
(
By‹Buf
 
b
, 
CÜfuRuÁime
 
¹
) {

104  
	ggsÚ
.
äomJsÚ
(
Ãw
 
SŒšg
(
by‹A¼ayFromBuf
(
b
)), 
şazz
);

107 @
Ov”ride


108 
public
 
£rŸlize
(
Objeù
 
o
, 
By‹Buf
 
b
) {

109 
	gb
.
wr™eBy‹s
(
gsÚ
.
toJsÚ
(
o
).
g‘By‹s
());

116 @
	gD©a


117 @
Bud”


118 
public
 şas 
	cPojo
 {

119 
public
 
fš®
 
SŒšg
 
	g·ylßd
;

122 
´iv©e
 
	gCÜfuTabË
<
	gSŒšg
, SŒšg> 
	$£tupTabË
() {

123 
fš®
 
P©h
 
³rsi¡edCacheLoÿtiÚ
 = 
P©hs
.
	`g‘
("/tmp/", "diskBackedMap");

124 
fš®
 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
().
	`£tC»©eIfMissšg
(
Œue
);

125 
fš®
 
Suµl›r
<
SŒ—mšgM­
> 
m­Suµl›r
 = (è-> 
Ãw
 
P”si¡edSŒ—mšgM­
<
SŒšg
, String>(

126 
³rsi¡edCacheLoÿtiÚ
, 
İtiÚs
,

127 
Ãw
 
	`PojoS”Ÿliz”
(
SŒšg
.
şass
), 
	`g‘RuÁime
());

128  
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

129 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

130 .
	`£tArgum’ts
(
m­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
DEFAULT
)

131 .
	`£tSŒ—mName
("diskBackedMap")

132 .
	`İ’
();

133 
	}
}

140 
´iv©e
 
	$execu‹Tx
(
RuÂabË
 
funùÜ
) {

141 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

142 
Œy
 {

143 
funùÜ
.
	`run
();

144 } 
fš®ly
 {

145 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

148 
	}
}

155 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

156 
	$feSy¡emLim™
(è
throws
 
Exû±iÚ
 {

157 
	`»£tTe¡s
();

159 
S¡FeMªag”
 
s¡FeMªag”
 = 
Ãw
 
	`S¡FeMªag”
(
Env
.
	`g‘DeçuÉ
());

160 
s¡FeMªag”
.
	`£tMaxAÎowedS·ûU§ge
(
FeUts
.
ONE_KB
);

161 
s¡FeMªag”
.
	`£tCom·ùiÚBufãrSize
(
FeUts
.
ONE_KB
);

163 
fš®
 
O±iÚs
 
İtiÚs
 =

164 
Ãw
 
	`O±iÚs
().
	`£tC»©eIfMissšg
(
Œue
)

165 .
	`£tS¡FeMªag”
(
s¡FeMªag”
)

167 .
	`£tWr™eBufãrSize
(
FeUts
.
ONE_KB
);

169 
fš®
 
Suµl›r
<
SŒ—mšgM­
> 
m­Suµl›r
 = (è-> 
Ãw
 
P”si¡edSŒ—mšgM­
<
SŒšg
, String>(

170 
³rsi¡edCacheLoÿtiÚ
, 
İtiÚs
, 
S”Ÿliz”s
.
JSON
, 
	`g‘RuÁime
());

171 
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

172 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

173 .
	`£tArgum’ts
(
m­Suµl›r
,
ICÜfuV”siÚPŞicy
.
DEFAULT
)

174 .
	`£tSŒ—mName
("diskBackedMap")

175 .
	`İ’
();

177 
fš®
 
ITERATION_COUNT
 = 100000;

178 
fš®
 
ENTITY_CHAR_SIZE
 = 1000;

180 
	`as£¹Th©ThrownBy
(() ->

181 
LÚgSŒ—m
.
	`¿ngeClo£d
(1, 
ITERATION_COUNT
).
	`fÜEach
(
idx
 -> {

182 
SŒšg
 
key
 = 
RªdomSŒšgUts
.
	`¿ndom
(
ENTITY_CHAR_SIZE
, 
Œue
,rue);

183 
SŒšg
 
v®ue
 = 
RªdomSŒšgUts
.
	`¿ndom
(
ENTITY_CHAR_SIZE
, 
Œue
,rue);

184 
bË
.
	`put
(
key
, 
v®ue
);

185 
SŒšg
 
³rsi¡edV®ue
 = 
bË
.
	`g‘
(
key
);

186 
As£¹iÚs
.
	`as£¹Equ®s
(
v®ue
, 
³rsi¡edV®ue
);

187 })).
	`isIn¡ªûOf
(
UÄecov”abËCÜfuE¼Ü
.
şass
)

188 .
	`hasCau£In¡ªûOf
(
RocksDBExû±iÚ
.
şass
);

190 
bË
.
	`şo£
();

191 
	}
}

197 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

198 
	$cu¡omS”Ÿliz”
() {

199 
	`»£tTe¡s
();

200 
fš®
 
O±iÚs
 
İtiÚs
 =

201 
Ãw
 
	`O±iÚs
().
	`£tC»©eIfMissšg
(
Œue
)

203 .
	`£tWr™eBufãrSize
(
FeUts
.
ONE_KB
);

204 
fš®
 
Suµl›r
<
SŒ—mšgM­
> 
m­Suµl›r
 = (è-> 
Ãw
 
P”si¡edSŒ—mšgM­
<
SŒšg
, 
Pojo
>(

205 
³rsi¡edCacheLoÿtiÚ
, 
İtiÚs
, 
Ãw
 
	`PojoS”Ÿliz”
(
Pojo
.
şass
), 
	`g‘RuÁime
());

206 
CÜfuTabË
<
SŒšg
, 
Pojo
>

207 
bË
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

208 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Pojo
>>() {})

209 .
	`£tArgum’ts
(
m­Suµl›r
, 
ICÜfuV”siÚPŞicy
.
DEFAULT
)

210 .
	`£tSŒ—mName
("diskBackedMap")

211 .
	`İ’
();

213 
fš®
 
ITERATION_COUNT
 = 100;

214 
fš®
 
ENTITY_CHAR_SIZE
 = 100;

216 
LÚgSŒ—m
.
	`¿ngeClo£d
(1, 
ITERATION_COUNT
).
	`fÜEach
(
idx
 -> {

217 
SŒšg
 
key
 = 
RªdomSŒšgUts
.
	`¿ndom
(
ENTITY_CHAR_SIZE
, 
Œue
,rue);

218 
Pojo
 
v®ue
 = Pojo.
	`bud”
()

219 .
	`·ylßd
(
RªdomSŒšgUts
.
	`¿ndom
(
ENTITY_CHAR_SIZE
, 
Œue
,rue))

220 .
	`bud
();

221 
bË
.
	`put
(
key
, 
v®ue
);

222 
Pojo
 
³rsi¡edV®ue
 = 
bË
.
	`g‘
(
key
);

223 
As£¹iÚs
.
	`as£¹Equ®s
(
v®ue
, 
³rsi¡edV®ue
);

226 
bË
.
	`şo£
();

227 
	}
}

232 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

233 
	`nÚTxPutSÿnAndF‹r
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

234 
	`»£tTe¡s
();

235 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

236 
	`execu‹Tx
((è-> 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`put
(value, value)));

237 
As£¹iÚs
.
	`as£¹Equ®s
(
š‹nded
.
	`size
(), 
bË
.size());

239 
	`execu‹Tx
(() -> {

240 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

241 
As£¹iÚs
.
	`as£¹Equ®s
(
š‹nded
, 
³rsi¡ed
);

242 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
³rsi¡ed
.size());

245 
	}
}

251 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

252 
	`txPutSÿnAndF‹r
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

253 
	`»£tTe¡s
();

254 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

255 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`put
(value, value));

256 
As£¹iÚs
.
	`as£¹Equ®s
(
š‹nded
.
	`size
(), 
bË
.size());

258 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

259 
As£¹iÚs
.
	`as£¹Equ®s
(
š‹nded
, 
³rsi¡ed
);

260 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
³rsi¡ed
.size());

262 
	}
}

267 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

268 
	`nÚTxPutG‘Remove
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

269 
	`»£tTe¡s
();

270 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

271 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`put
(value, value));

272 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
š‹nded
.size());

273 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`g‘
(value), value));

274 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`»move
(value), value));

276 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

277 
As£¹iÚs
.
	`as£¹True
(
³rsi¡ed
.
	`isEm±y
());

279 
	}
}

284 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

285 
	`txPutG‘Remove
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

286 
	`»£tTe¡s
();

287 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

288 
	`execu‹Tx
((è-> 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`put
(value, value)));

289 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
š‹nded
.size());

290 
	`execu‹Tx
(() -> {

291 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`g‘
(value), value));

292 
š‹nded
.
	`fÜEach
(
bË
::
»move
);

295 
	`execu‹Tx
(() -> {

296 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

297 
As£¹iÚs
.
	`as£¹True
(
³rsi¡ed
.
	`isEm±y
());

300 
	}
}

305 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

306 
	`m­KeyS‘
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

307 
	`»£tTe¡s
();

308 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

309 
	`execu‹Tx
((è-> 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`put
(value, value)));

310 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`keyS‘
(), 
š‹nded
);

312 
	}
}

317 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

318 
	`nÚTxIn£¹Remove
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

319 
	`»£tTe¡s
();

320 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

321 
	`execu‹Tx
((è-> 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`š£¹
(value, value)));

322 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
š‹nded
.size());

323 
	`execu‹Tx
((è-> 
š‹nded
.
	`fÜEach
(
bË
::
d–‘e
));

325 
	`execu‹Tx
(() -> {

326 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

327 
As£¹iÚs
.
	`as£¹True
(
³rsi¡ed
.
	`isEm±y
());

330 
	}
}

335 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

336 
	`txIn£¹Remove
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

337 
	`»£tTe¡s
();

338 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

339 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`š£¹
(value, value));

340 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
š‹nded
.size());

341 
š‹nded
.
	`fÜEach
(
bË
::
d–‘e
);

343 
	`execu‹Tx
(() -> {

344 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

345 
As£¹iÚs
.
	`as£¹True
(
³rsi¡ed
.
	`isEm±y
());

348 
	}
}

353 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

354 
	`nÚTxIn£¹CË¬
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

355 
	`»£tTe¡s
();

356 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

357 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`š£¹
(value, value));

358 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
š‹nded
.size());

359 
bË
.
	`ş—r
();

361 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

362 
As£¹iÚs
.
	`as£¹Equ®s
(
³rsi¡ed
.
	`size
(), 0);

363 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 0);

365 
	}
}

370 @
	$Prİ”ty
(
Œ›s
 = 
NUM_OF_TRIES
)

371 
	`txIn£¹CË¬
(@
FÜAÎ
 @
	$Size
(
SAMPLE_SIZE
è
S‘
<
SŒšg
> 
š‹nded
) {

372 
	`»£tTe¡s
();

373 
	`Œy
 (
fš®
 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
	`£tupTabË
()) {

374 
	`execu‹Tx
((è-> 
š‹nded
.
	`fÜEach
(
v®ue
 -> 
bË
.
	`š£¹
(value, value)));

375 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 
š‹nded
.size());

376 
	`execu‹Tx
(
bË
::
ş—r
);

378 
	`execu‹Tx
(() -> {

379 
fš®
 
S‘
<
SŒšg
> 
³rsi¡ed
 = 
Ãw
 
HashS‘
<>(
bË
.
	`sÿnAndF‹r
(
’Œy
 -> 
Œue
));

380 
As£¹iÚs
.
	`as£¹Equ®s
(
³rsi¡ed
.
	`size
(), 0);

381 
As£¹iÚs
.
	`as£¹Equ®s
(
bË
.
	`size
(), 0);

384 
	}
}

389 @
Provide


390 
	gArb™¿ry
<
	gS‘
<
	gUuid
>> 
	$uuidS‘
() {

391  
	`uuid
().
	`£t
();

392 
	}
}

397 @
Provide


398 
	gArb™¿ry
<
	gUuid
> 
	$uuid
() {

399  
Arb™¿r›s
.
	`š‹g”s
().
	`m­
(
idx
 -> 
UUID
.
	`¿ndomUUID
()).map(

400 
uuid
 -> 
Uuid
.
	`ÃwBud”
()

401 .
	`£tMsb
(
uuid
.
	`g‘Mo¡SignifiÿÁB™s
())

402 .
	`£tLsb
(
uuid
.
	`g‘L—¡SignifiÿÁB™s
())

403 .
	`bud
());

404 
	}
}

409 @
Provide


410 
	gArb™¿ry
<
	gS‘
<
	gEv’tInfo
>> 
	$ev’tInfoS‘
() {

411  
	`ev’tInfo
().
	`£t
();

412 
	}
}

417 @
Provide


418 
	gArb™¿ry
<
	gEv’tInfo
> 
	$ev’tInfo
() {

419  
Arb™¿r›s
.
	`š‹g”s
().
	`m­
(
idx
 ->

420 
Ev’tInfo
.
	`ÃwBud”
()

421 .
	`£tId
(
idx
)

422 .
	`£tName
("ev’t_" + 
idx
)

423 .
	`£tEv’tTime
(
idx
)

424 .
	`bud
());

425 
	}
}

430 
d©aStÜeIÁeg¿tiÚ
(

431 @
FÜAÎ
 @
SŒšgL’gth
(
mš
 = 
STRING_MIN
, 
max
 = 
STRING_MAX
è@
AÍhaCh¬s
 
SŒšg
 
Çme¥aû
,

432 @
FÜAÎ
 @
SŒšgL’gth
(
mš
 = 
STRING_MIN
, 
max
 = 
STRING_MAX
è@
AÍhaCh¬s
 
SŒšg
 
bËName
,

433 @
FÜAÎ
("uuid"è
Uuid
 
fœ¡Id
,

434 @
FÜAÎ
("ev’tInfo"è
Ev’tInfo
 
fœ¡Ev’t
,

435 @
FÜAÎ
("uuidS‘"è@
	$Size
(
SAMPLE_SIZE
è
S‘
<
Uuid
> 
ids
,

436 @
	`FÜAÎ
("ev’tInfoS‘"è@
	$Size
(
SAMPLE_SIZE
è
S‘
<
Ev’tInfo
> 
ev’ts
)

437 
throws
 
Exû±iÚ
 {

438 
	`»£tTe¡s
();

441 
CÜfuStÜe
 
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
	`g‘DeçuÉRuÁime
());

445 
fš®
 
P©h
 
³rsi¡edCacheLoÿtiÚ
 = 
P©hs
.
	`g‘
("/tmp/", "diskBackedMap");

446 
fš®
 
TabË
<
Uuid
, 
Ev’tInfo
, 
Sam¶eSchema
.
MªagedResourûs
> 
bË
 =

447 
cÜfuStÜe
.
	`İ’TabË
(
Çme¥aû
, 
bËName
,

448 
Uuid
.
şass
, 
Ev’tInfo
.class,

449 
Sam¶eSchema
.
MªagedResourûs
.
şass
,

451 
TabËO±iÚs
.
	`bud”
().
	`³rsi¡’tD©aP©h
(
³rsi¡edCacheLoÿtiÚ
).
	`bud
());

453 
Sam¶eSchema
.
MªagedResourûs
 
m‘ad©a
 = Sam¶eSchema.MªagedResourûs.
	`ÃwBud”
()

454 .
	`£tC»©eU£r
("MrPrÙo").
	`bud
();

458 
bË
.
	`ü—‹
(
fœ¡Id
, 
fœ¡Ev’t
, 
m‘ad©a
);

461 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

462 
TxBud”
 
tx
 = 
cÜfuStÜe
.
	`tx
(
Çme¥aû
);

464 
SŒ—ms
.
	`z
(
ids
.
	`¡»am
(), 
ev’ts
.¡»am(), 
Sim¶eEÁry
::
Ãw
)

465 .
	`fÜEach
(
·œ
 -> 
tx
.
	`upd©e
(
bËName
,…aœ.
	`g‘Key
(),…aœ.
	`g‘V®ue
(), 
m‘ad©a
));

466 
tx
.
	`comm™
();

468 
Sim¶eEÁry
<
Uuid
, 
Ev’tInfo
> 
§m¶e
 = 
SŒ—ms


469 .
	`z
(
ids
.
	`¡»am
(), 
ev’ts
.¡»am(), 
Sim¶eEÁry
::
Ãw
)

470 .
	`fšdAny
().
	`ÜEl£Throw
((è-> 
Ãw
 
	`Inv®idObjeùExû±iÚ
("Invalid state."));

472 
Qu”y
 
qu”y
 = 
cÜfuStÜe
.
	`qu”y
(
Çme¥aû
);

473 
	`as£¹Th©
(
qu”y
.
	`g‘RecÜd
(
bËName
, 
§m¶e
.
	`g‘Key
()).
	`g‘Paylßd
())

474 .
	`isEqu®To
(
§m¶e
.
	`g‘V®ue
());

476 
CŞËùiÚ
<
Mes§ge
> 
£cÚd¬yIndex
 = 
qu”y


477 .
	`g‘ByIndex
(
bËName
, "ev’t_time", 
§m¶e
.
	`g‘V®ue
().
	`g‘Ev’tTime
())

478 .
	`g‘ResuÉ
().
	`¡»am
().
	`m­
(
M­
.
EÁry
::
g‘V®ue
).
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

479 
	`as£¹Th©
(
£cÚd¬yIndex
).
	`cÚšsExaùly
(
§m¶e
.
	`g‘V®ue
());

481 
medŸnEv’tTime
 = (è
Quªtes
.
	`medŸn
().
	`compu‹
(
ev’ts
.
	`¡»am
()

482 .
	`m­
(
Ev’tInfo
::
g‘Ev’tTime
)

483 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()));

485 
ev’ts
.
	`add
(
fœ¡Ev’t
);

486 
S‘
<
Ev’tInfo
> 
f‹»dEv’ts
 = 
ev’ts
.
	`¡»am
().
	`f‹r
(

487 
ev’t
 ->ƒv’t.
	`g‘Ev’tTime
(è> 
medŸnEv’tTime
)

488 .
	`cŞËù
(
CŞËùÜs
.
	`toS‘
());

489 
Qu”yResuÉ
<
CÜfuStÜeEÁry
<
Uuid
, 
Ev’tInfo
, 
Sam¶eSchema
.
MªagedResourûs
>> 
qu”yResuÉ
 =

490 
qu”y
.
	`execu‹Qu”y
(
bËName
,

491 
»cÜd
 -> ((
Ev’tInfo
è»cÜd.
	`g‘Paylßd
()).
	`g‘Ev’tTime
(è> 
medŸnEv’tTime
);

492 
S‘
<
Ev’tInfo
> 
sÿÂedV®ues
 = 
qu”yResuÉ
.
	`g‘ResuÉ
().
	`¡»am
()

493 .
	`m­
(
CÜfuStÜeEÁry
::
g‘Paylßd
).
	`cŞËù
(
CŞËùÜs
.
	`toS‘
());

495 
	`as£¹Th©
(
f‹»dEv’ts
.
	`size
()).
	`isG»©”Thª
(0).
	`isLessThª
(
SAMPLE_SIZE
);

496 
	`as£¹Th©
(
sÿÂedV®ues
.
	`size
()).
	`isEqu®To
(
f‹»dEv’ts
.size());

498 
	`as£¹Th©
(
qu”y
.
	`couÁ
(
bËName
, 
time¡amp
)).
	`isEqu®To
(1);

499 
	`as£¹Th©
(
qu”y
.
	`couÁ
(
bËName
)).
	`isEqu®To
(
SAMPLE_SIZE
 + 1);

501 
	`as£¹Th©
(
cÜfuStÜe
.
	`li¡TabËs
(
Çme¥aû
))

502 .
	`cÚšsExaùly
(
CÜfuStÜeM‘ad©a
.
TabËName
.
	`ÃwBud”
()

503 .
	`£tName¥aû
(
Çme¥aû
)

504 .
	`£tTabËName
(
bËName
)

505 .
	`bud
());

506 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/PutIfAbsentMapTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gG‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tLškedQueue
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

22 
public
 cÏs 
	cPutIfAb£ÁM­Te¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

24 @
G‘‹r


25 
fš®
 
SŒšg
 
	mdeçuÉCÚfigu¿tiÚSŒšg
 = 
g‘DeçuÉEndpošt
();

27 @
Te¡


28 
public
 
	$putIfAb£ÁTe¡
() {

29 
	`g‘DeçuÉRuÁime
();

31 
PutIfAb£ÁM­
<
SŒšg
, SŒšg> 
¡ršgM­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

32 .
	`£tSŒ—mName
("stringMap")

33 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
PutIfAb£ÁM­
<
SŒšg
, String>>() {})

34 .
	`İ’
();

36 
¡ršgM­
.
	`put
("a", "b");

38 
	`as£¹Th©
(
¡ršgM­
.
	`g‘
("a"))

39 .
	`isEqu®To
("b");

41 
	`as£¹Th©
(
¡ršgM­
.
	`putIfAb£Á
("a", "c"))

42 .
	`isF®£
();

44 
	`as£¹Th©
(
¡ršgM­
.
	`g‘
("a"))

45 .
	`isEqu®To
("b");

48 @
Te¡


49 
public
 
	$putIfAb£ÁTe¡CÚcu¼’t
()

50 
throws
 
Exû±iÚ
 {

51 
	`g‘DeçuÉRuÁime
();

53 
PutIfAb£ÁM­
<
SŒšg
, SŒšg> 
¡ršgM­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

54 .
	`£tSŒ—mName
("stringMap")

55 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
PutIfAb£ÁM­
<
SŒšg
, String>>() {})

56 .
	`İ’
();

58 
CÚcu¼’tLškedQueue
<
BoŞ—n
> 
»suÉLi¡
 = 
Ãw
 ConcurrentLinkedQueue<>();

59 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
, 
x
 -> {

60 
»suÉLi¡
.
	`add
(
¡ršgM­
.
	`putIfAb£Á
("a", 
IÁeg”
.
	`toSŒšg
(
x
)));

62 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_LONG
);

64 
ŒueCouÁ
 = 
»suÉLi¡
.
	`¡»am
()

65 .
	`f‹r
(
x
 -> x)

66 .
	`couÁ
();

68 
	`as£¹Th©
(
ŒueCouÁ
)

69 .
	`isEqu®To
(1);

70 
	}
}

72 @
CÜfuObjeù


73 
public
 
şass
 
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>

74 
im¶em’ts
 
	gICÜfuSMR
<
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>> {

76 
	gHashM­
<
	gK
, 
	gV
> 
	gm­
 = 
Ãw
 
HashM­
<>();

78 @
MutÜAcûssÜ
(
Çme
="put")

79 
public
 
V
 
put
(
K
 
key
, V 
v®ue
) {

80  
	gm­
.
put
(
key
, 
v®ue
);

83 @
AcûssÜ


84 
public
 
V
 
g‘
(
K
 
key
) {

85  
	gm­
.
g‘
(
key
);

88 @
MutÜAcûssÜ
(
Çme
="putIfAbsent")

89 
public
 
boŞ—n
 
putIfAb£Á
(
K
 
key
, 
V
 
v®ue
) {

90 ià(
	gm­
.
g‘
(
key
è=ğ
nuÎ
) {

91 
m­
.
put
(
key
, 
v®ue
);

92  
	gŒue
;

94  
	gçl£
;

100 @
Ov”ride


101 
public
 
PutIfAb£ÁM­
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

102  
	gthis
;

	@test/src/test/java/org/corfudb/runtime/collections/RocksDbEntryIteratorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gjup™”
.
	g­i
.
	gAs£¹iÚs
;

10 
impÜt
 
	gÜg
.
	grocksdb
.
	gO±iÚs
;

11 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDB
;

12 
impÜt
 
	gÜg
.
	grocksdb
.
	gRocksDBExû±iÚ
;

14 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

15 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gNoSuchEËm’tExû±iÚ
;

18 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

19 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

21 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

22 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
.
	gPARAMETERS
;

31 
public
 cÏs 
	cRocksDbEÁryI‹¿tÜTe¡
 {

33 
´iv©e
 
	$g’”©eD©a
(
numEÁr›s
, 
IS”Ÿliz”
 
£rŸliz”
, 
RocksDB
 
rocksDb
) {

35 
IÁSŒ—m
.
	`¿nge
(0, 
numEÁr›s
).
	`fÜEach
(
num
 -> {

36 
Œy
 {

37 
By‹Buf
 
keyBy‹Buf
 = 
UÅoŞed
.
	`bufãr
();

38 
By‹Buf
 
v®By‹Buf
 = 
UÅoŞed
.
	`bufãr
();

39 
£rŸliz”
.
	`£rŸlize
(
num
, 
keyBy‹Buf
);

40 
£rŸliz”
.
	`£rŸlize
(
num
, 
v®By‹Buf
);

41 
by‹
[] 
key
 = 
Ãw
 by‹[
keyBy‹Buf
.
	`wr™”Index
()];

42 
keyBy‹Buf
.
	`»adBy‹s
(
key
);

43 
by‹
[] 
v®
 = 
A¼ays
.
	`cİyOf
(
key
, key.
Ëngth
);

44 
rocksDb
.
	`put
(
key
, 
v®
);

45 } 
	`ÿtch
 (
RocksDBExû±iÚ
 
e
) {

46 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

51 @
Te¡


52 
public
 
	$™”©ÜTe¡
(è
throws
 
Exû±iÚ
 {

53 
SŒšg
 
·th
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

54 
SŒšg
 
rocksDbP©h
 = 
P©hs
.
	`g‘
(
·th
, 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
()).
	`toAbsŞu‹P©h
().toString();

55 
fš®
 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
()

56 .
	`£tC»©eIfMissšg
(
Œue
);

57 
RocksDB
 
rocksDb
 = RocksDB.
	`İ’
(
İtiÚs
, 
rocksDbP©h
);

58 
IS”Ÿliz”
 
£rŸliz”
 = 
S”Ÿliz”s
.
PRIMITIVE
;

60 
fš®
 
numEÁr›s
 = 57;

62 
	`g’”©eD©a
(
numEÁr›s
, 
£rŸliz”
, 
rocksDb
);

64 
RocksDbEÁryI‹¿tÜ
<
IÁeg”
, IÁeg”> 
™”©Ü
 = 
Ãw
 RocksDbEÁryI‹¿tÜ<>(
rocksDb
, 
£rŸliz”
);

67 
IÁSŒ—m
.
	`¿nge
(0, 
numEÁr›s
).
	`fÜEach
(
num
 -> {

68 
M­
.
EÁry
<
IÁeg”
, IÁeg”> 
’Œy
 = 
™”©Ü
.
	`Ãxt
();

69 
	`as£¹Th©
(
’Œy
.
	`g‘Key
()).
	`isEqu®To
(
num
);

70 
	`as£¹Th©
(
’Œy
.
	`g‘V®ue
()).
	`isEqu®To
(
num
);

73 
	`as£¹Th©
(
™”©Ü
.
	`hasNext
()).
	`isF®£
();

74 
	`as£¹Th©ThrownBy
((è-> 
™”©Ü
.
	`Ãxt
())

75 .
	`isExaùlyIn¡ªûOf
(
NoSuchEËm’tExû±iÚ
.
şass
);

76 
	`as£¹Th©
(
™”©Ü
.
	`hasNext
()).
	`isF®£
();

80 
As£¹iÚs
.
	`as£¹DÛsNÙThrow
(
™”©Ü
::
şo£
);

81 
As£¹iÚs
.
	`as£¹DÛsNÙThrow
(
™”©Ü
::
şo£
);

82 
	}
}

84 @
Te¡


85 
public
 
	$‹¡KeysI‹¿tÜ
(è
throws
 
Exû±iÚ
 {

86 
SŒšg
 
·th
 = 
PARAMETERS
.
TEST_TEMP_DIR
;

87 
SŒšg
 
rocksDbP©h
 = 
P©hs
.
	`g‘
(
·th
, 
UUID
.
	`¿ndomUUID
().
	`toSŒšg
()).
	`toAbsŞu‹P©h
().toString();

88 
fš®
 
O±iÚs
 
İtiÚs
 = 
Ãw
 
	`O±iÚs
()

89 .
	`£tC»©eIfMissšg
(
Œue
);

90 
RocksDB
 
rocksDb
 = RocksDB.
	`İ’
(
İtiÚs
, 
rocksDbP©h
);

91 
IS”Ÿliz”
 
£rŸliz”
 = 
S”Ÿliz”s
.
PRIMITIVE
;

93 
fš®
 
numEÁr›s
 = 35;

95 
	`g’”©eD©a
(
numEÁr›s
, 
£rŸliz”
, 
rocksDb
);

97 
RocksDbEÁryI‹¿tÜ
<
IÁeg”
, IÁeg”> 
™”©Ü
 = 
Ãw
 RocksDbEÁryI‹¿tÜ<>(
rocksDb
, 
£rŸliz”
, 
çl£
);

99 
IÁSŒ—m
.
	`¿nge
(0, 
numEÁr›s
).
	`fÜEach
(
num
 -> {

100 
M­
.
EÁry
<
IÁeg”
, IÁeg”> 
’Œy
 = 
™”©Ü
.
	`Ãxt
();

101 
	`as£¹Th©
(
’Œy
.
	`g‘Key
()).
	`isEqu®To
(
num
);

102 
	`as£¹Th©
(
’Œy
.
	`g‘V®ue
()).
	`isNuÎ
();

105 
	`as£¹Th©
(
™”©Ü
.
	`hasNext
()).
	`isF®£
();

106 
As£¹iÚs
.
	`as£¹DÛsNÙThrow
(
™”©Ü
::
şo£
);

107 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/SMRMapEntrySetTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚsTe¡
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

10 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
public
 cÏs 
	cSMRM­EÁryS‘Te¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

19 @
Ov”ride


20 
public
 
	$TXBegš
(è{ 
	`O±imi¡icTXBegš
(); }

22 @
G‘‹r


23 
fš®
 
SŒšg
 
deçuÉCÚfigu¿tiÚSŒšg
 = 
	`g‘DeçuÉEndpošt
();

25 
public
 
CÜfuRuÁime
 
r
;

28 @
BefÜe


29 
public
 
	$£tRuÁime
(è
throws
 
Exû±iÚ
 {

30 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

31 
	}
}

33 @
Te¡


34 
public
 
	$mªuÏ‹S‘s
()

35 
throws
 
Exû±iÚ
 {

36 
M­
<
LÚg
, LÚg> 
‹¡M­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
,

41 
i
 = 0; i < (è
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++)

42 
‹¡M­
.
	`put
(
i
, i);

44 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(0L))

45 .
	`isEqu®To
(0L);

46 
	`as£¹Th©
(
‹¡M­
.
	`size
())

47 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

50 
S‘
<
LÚg
> 
keys
 = 
‹¡M­
.
	`keyS‘
();

51 
	`as£¹Th©
(
keys
.
	`size
())

52 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

53 
	`as£¹Th©
(
keys
.
	`cÚšs
(0L))

54 .
	`isTrue
();

58 
‹¡M­
.
	`»move
(0L);

60 
	`as£¹Th©
(
keys
.
	`size
())

61 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

62 
	`as£¹Th©
(
keys
.
	`cÚšs
(0L))

63 .
	`isTrue
();

65 
	`as£¹Th©
(
‹¡M­
.
	`cÚšsKey
(0L))

66 .
	`isF®£
();

67 
	`as£¹Th©
(
‹¡M­
.
	`size
())

68 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
-1);

70 
	}
}

72 @
Te¡


73 
public
 
	$mªuÏ‹S‘sCÚcu¼’t
()

74 
throws
 
Exû±iÚ
 {

75 
M­
<
LÚg
, LÚg> 
‹¡M­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
,

77 
CouÁDownL©ch
 
l1
 = 
Ãw
 
	`CouÁDownL©ch
(1);

78 
CouÁDownL©ch
 
l2
 = 
Ãw
 
	`CouÁDownL©ch
(1);

79 
CouÁDownL©ch
 
l3
 = 
Ãw
 
	`CouÁDownL©ch
(1);

82 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

85 
	`scheduËCÚcu¼’y
(
t
 -> {

88 
l1
.
	`couÁDown
();

91 
i
 = 0; i < (è
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++)

92 
‹¡M­
.
	`put
(
i
, i);

94 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(0L))

95 .
	`isEqu®To
(0L);

96 
	`as£¹Th©
(
‹¡M­
.
	`size
())

97 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

100 
l2
.
	`awa™
();

104 
‹¡M­
.
	`»move
(0L);

106 
	`as£¹Th©
(
‹¡M­
.
	`cÚšsKey
(0L))

107 .
	`isF®£
();

108 
	`as£¹Th©
(
‹¡M­
.
	`size
())

109 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
 - 1);

112 
l3
.
	`couÁDown
();

117 
	`scheduËCÚcu¼’y
(
t
 -> {

118 
l1
.
	`awa™
();

123 
S‘
<
LÚg
> 
keys
 = 
‹¡M­
.
	`keyS‘
();

124 
¢­shÙSize
 = 
keys
.
	`size
();

126 ià(
¢­shÙSize
 > 0)

127 
	`as£¹Th©
(
keys
.
	`cÚšs
(0L))

128 .
	`isTrue
();

131 
l2
.
	`couÁDown
();

134 
l3
.
	`g‘CouÁ
() > 0) {

135 
	`as£¹Th©
(
keys
.
	`size
())

136 .
	`isEqu®To
(
¢­shÙSize
);

137 ià(
¢­shÙSize
 > 0)

138 
	`as£¹Th©
(
keys
.
	`cÚšs
(0L))

139 .
	`isTrue
();

141 
l3
.
	`awa™
();

142 
	`as£¹Th©
(
keys
.
	`size
())

143 .
	`isEqu®To
(
¢­shÙSize
);

144 ià(
¢­shÙSize
 > 0)

145 
	`as£¹Th©
(
keys
.
	`cÚšs
(0L))

146 .
	`isTrue
();

149 
	`scheduËCÚcu¼’y
(
t
 -> {

150 
l3
.
	`awa™
();

153 
S‘
<
LÚg
> 
keys
 = 
‹¡M­
.
	`keyS‘
();

154 
	`as£¹Th©
(
keys
.
	`size
())

155 .
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
-1);

156 
	`as£¹Th©
(
keys
.
	`cÚšs
(0L))

157 .
	`isF®£
();

160 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
TIMEOUT_SHORT
);

162 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/SMRMapTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚ
;

9 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

12 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

17 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

18 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

20 
impÜt
 
	glombok
.
	gD©a
;

21 
impÜt
 
	glombok
.
	gG‘‹r
;

22 
impÜt
 
	glombok
.
	gToSŒšg
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùO³nO±iÚ
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

30 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

31 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

36 
public
 cÏs 
	cSMRM­Te¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

37 @
G‘‹r


38 
fš®
 
SŒšg
 
	mdeçuÉCÚfigu¿tiÚSŒšg
 = 
g‘DeçuÉEndpošt
();

40 
public
 
CÜfuRuÁime
 
	mr
;

43 @
BefÜe


44 
public
 
	$£tRuÁime
(è
throws
 
Exû±iÚ
 {

45 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

48 @
Te¡


49 @
	`Suµ»ssW¬nšgs
("unchecked")

50 
public
 
	$ÿnR—dWr™eToSšgË
()

51 
throws
 
Exû±iÚ
 {

52 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

53 .
	`g‘ObjeùsV›w
()

54 .
	`bud
()

55 .
	`£tSŒ—mName
("test")

56 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

57 .
	`İ’
();

59 
‹¡M­
.
	`ş—r
();

60 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

61 .
	`isNuÎ
();

62 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

63 .
	`isEqu®To
("a");

64 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

65 .
	`isEqu®To
("b");

66 
	}
}

68 @
	gTe¡


69 @
Suµ»ssW¬nšgs
("unchecked")

70 
public
 
	$ÿnR—dWr™eToSšgËPrim™ive
()

71 
throws
 
Exû±iÚ
 {

72 
	`g‘RuÁime
().
	`£tCacheDi§bËd
(
Œue
);

73 
M­
<
LÚg
, 
DoubË
> 
‹¡M­
 = 
	`g‘RuÁime
()

74 .
	`g‘ObjeùsV›w
()

75 .
	`bud
()

76 .
	`£tSŒ—mName
("test")

77 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
PRIMITIVE
)

78 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
LÚg
, 
DoubË
>>() {})

79 .
	`İ’
();

81 
fš®
 
PRIMITIVE_1
 = 2.4;

82 
fš®
 
PRIMITIVE_2
 = 4.5;

84 
‹¡M­
.
	`ş—r
();

85 
	`as£¹Th©
(
‹¡M­
.
	`put
(1L, 
PRIMITIVE_1
))

86 .
	`isNuÎ
();

87 
	`as£¹Th©
(
‹¡M­
.
	`put
(1L, 
PRIMITIVE_2
))

88 .
	`isEqu®To
(
PRIMITIVE_1
);

89 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(1L))

90 .
	`isEqu®To
(
PRIMITIVE_2
);

91 
	}
}

93 @
	gTe¡


94 @
Suµ»ssW¬nšgs
("unchecked")

95 
public
 
	$ÿnWr™eSÿnAndF‹rToSšgË
()

96 
throws
 
Exû±iÚ
 {

97 
M­
<
SŒšg
, SŒšg> 
cÜfuIn¡ªûsM­
 = 
	`g‘RuÁime
()

98 .
	`g‘ObjeùsV›w
()

99 .
	`bud
()

100 .
	`£tSŒ—mName
("test")

101 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

102 .
	`İ’
();

104 
cÜfuIn¡ªûsM­
.
	`ş—r
();

105 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("a", "CorfuServer"))

106 .
	`isNuÎ
();

107 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("b", "CorfuClient"))

108 .
	`isNuÎ
();

109 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("c", "CorfuClient"))

110 .
	`isNuÎ
();

111 
	`as£¹Th©
(
cÜfuIn¡ªûsM­
.
	`put
("d", "CorfuServer"))

112 .
	`isNuÎ
();

115 
P»diÿ‹
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
v®ueP»diÿ‹
 =

116 
p
 ->….
	`g‘V®ue
().
	`equ®s
("CorfuServer");

117 
CŞËùiÚ
<
M­
.
EÁry
<
SŒšg
, SŒšg>> 
f‹»dM­
 = ((
CÜfuTabË
)
cÜfuIn¡ªûsM­
)

118 .
	`sÿnAndF‹rByEÁry
(
v®ueP»diÿ‹
);

120 
	`as£¹Th©
(
f‹»dM­
.
	`size
()).
	`isEqu®To
(2);

122 
M­
.
EÁry
<
SŒšg
, SŒšg> 
cÜfuIn¡ªû
 : 
f‹»dM­
) {

123 
	`as£¹Th©
(
cÜfuIn¡ªû
.
	`g‘V®ue
()).
	`isEqu®To
("CorfuServer");

127 
Li¡
<
SŒšg
> 
cÜfuS”v”Li¡
 = ((
CÜfuTabË
)
cÜfuIn¡ªûsM­
)

128 .
	`sÿnAndF‹r
(
p
 ->….
	`equ®s
("CorfuServer"));

130 
	`as£¹Th©
(
cÜfuS”v”Li¡
.
	`size
()).
	`isEqu®To
(2);

132 
SŒšg
 
cÜfuIn¡ªû
 : 
cÜfuS”v”Li¡
) {

133 
	`as£¹Th©
(
cÜfuIn¡ªû
).
	`isEqu®To
("CorfuServer");

135 
	}
}

137 @
	gTe¡


138 @
Suµ»ssW¬nšgs
("unchecked")

139 
public
 
	$ÿnG‘ID
()

140 
throws
 
Exû±iÚ
 {

141 
UUID
 
id
 = UUID.
	`¿ndomUUID
();

142 
ICÜfuSMR
 
‹¡M­
 = (ICÜfuSMRè
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

143 .
	`bud
()

144 .
	`£tSŒ—mID
(
id
)

145 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

146 .
	`İ’
();

148 
	`as£¹Th©
(
id
)

149 .
	`isEqu®To
(
‹¡M­
.
	`g‘CÜfuSŒ—mID
());

150 
	}
}

152 @
	gTe¡


153 @
Suµ»ssW¬nšgs
("unchecked")

154 
public
 
	$lßdsFŞlowedByG‘s
()

155 
throws
 
Exû±iÚ
 {

156 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

157 .
	`bud
()

158 .
	`£tSŒ—mName
("test")

159 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

160 .
	`İ’
();

162 
‹¡M­
.
	`ş—r
();

163 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

164 
	`as£¹Th©
(
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

165 .
	`isNuÎ
();

167 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

168 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
i
)))

169 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
));

171 
	}
}

173 @
	gTe¡


174 @
Suµ»ssW¬nšgs
("unchecked")

175 
public
 
	$ÿnCÚšOth”CÜfuObjeùs
()

176 
throws
 
Exû±iÚ
 {

177 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

178 .
	`bud
()

179 .
	`£tSŒ—mName
("test 1")

180 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

181 .
	`İ’
();

182 
‹¡M­
.
	`ş—r
();

183 
‹¡M­
.
	`put
("z", "e");

184 
M­
<
SŒšg
, M­<SŒšg, SŒšg>> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

185 .
	`bud
()

186 .
	`£tSŒ—mName
("test 2")

187 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
M­
<String, String>>>() {})

188 .
	`İ’
();

189 
‹¡M­2
.
	`put
("a", 
‹¡M­
);

191 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
("a").get("z"))

192 .
	`isEqu®To
("e");

194 
‹¡M­2
.
	`g‘
("a").
	`put
("y", "f");

196 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("y"))

197 .
	`isEqu®To
("f");

199 
M­
<
SŒšg
, SŒšg> 
‹¡M­3
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

200 .
	`bud
()

201 .
	`£tSŒ—mName
("test 1")

202 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

203 .
	`İ’
();

205 
	`as£¹Th©
(
‹¡M­3
.
	`g‘
("y"))

206 .
	`isEqu®To
("f");

208 
	}
}

210 @
	gTe¡


211 @
Suµ»ssW¬nšgs
("unchecked")

212 
public
 
	$ÿnCÚšNuÎObjeùs
()

213 
throws
 
Exû±iÚ
 {

214 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

215 .
	`bud
()

216 .
	`£tSŒ—mName
("a")

217 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

218 .
	`İ’
();

220 
‹¡M­
.
	`ş—r
();

221 
‹¡M­
.
	`put
("z", 
nuÎ
);

222 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

223 .
	`isEqu®To
(
nuÎ
);

224 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
()

225 .
	`g‘ObjeùsV›w
()

226 .
	`bud
()

227 .
	`£tSŒ—mName
("a")

228 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

229 .
	`İ’
();

231 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
("z"))

232 .
	`isEqu®To
(
nuÎ
);

233 
	}
}

235 @
Te¡


236 
public
 
	$lßdsFŞlowedByG‘sCÚcu¼’t
()

237 
throws
 
Exû±iÚ
 {

238 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

239 .
	`bud
()

240 .
	`£tSŒ—mID
(
UUID
.
	`¿ndomUUID
())

241 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

242 .
	`İ’
();

244 
fš®
 
num_th»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

245 
fš®
 
num_»cÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

246 
‹¡M­
.
	`ş—r
();

248 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

249 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

250 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

251 
	`as£¹Th©
(
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

252 .
	`isEqu®To
(
nuÎ
);

256 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

257 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

258 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("WPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

260 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

261 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

262 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

263 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
i
)))

264 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
));

268 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

269 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

270 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("RPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

271 
	}
}

274 @
	gTe¡


275 @
Suµ»ssW¬nšgs
("unchecked")

276 
public
 
	$lßdsFŞlowedByG‘sCÚcu¼’tMuÉiV›w
()

277 
throws
 
Exû±iÚ
 {

279 
fš®
 
lÚgHŞeFlR‘ryLim™
 = 50;

280 
r
.
	`g‘P¬am‘”s
().
	`£tHŞeFlR‘ry
(
lÚgHŞeFlR‘ryLim™
);

282 
fš®
 
num_th»ads
 = 5;

283 
fš®
 
num_»cÜds
 = 1000;

285 
M­
<
SŒšg
, SŒšg>[] 
‹¡M­
 =

286 
IÁSŒ—m
.
	`¿nge
(0, 
num_th»ads
)

287 .
	`m­ToObj
(
i
 -> {

288  
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

289 .
	`bud
()

290 .
	`£tSŒ—mID
(
UUID
.
	`¿ndomUUID
())

291 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

293 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

294 .
	`İ’
();

296 .
	`toA¼ay
(
M­
[]::
Ãw
);

298 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

299 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

300 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

301 
	`as£¹Th©
(
‹¡M­
[
th»adNumb”
].
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

302 .
	`isEqu®To
(
nuÎ
);

306 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

307 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

308 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("WPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

310 
	`scheduËCÚcu¼’y
(
num_th»ads
, 
th»adNumb”
 -> {

311 
ba£
 = 
th»adNumb”
 * 
num_»cÜds
;

312 
i
 = 
ba£
; i < ba£ + 
num_»cÜds
; i++) {

313 
	`as£¹Th©
(
‹¡M­
[
th»adNumb”
].
	`g‘
(
IÁeg”
.
	`toSŒšg
(
i
)))

314 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
));

318 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

319 
	`execu‹ScheduËd
(
num_th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

320 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("RPS", 
num_»cÜds
 * 
num_th»ads
, 
¡¬tTime
);

321 
	}
}

323 @
	gTe¡


324 @
Suµ»ssW¬nšgs
("unchecked")

325 
public
 
	$cŞËùiÚsSŒ—mIÁ”çû
()

326 
throws
 
Exû±iÚ
 {

327 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

328 .
	`bud
()

329 .
	`£tSŒ—mName
("test")

330 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

331 .
	`İ’
();

333 
‹¡M­
.
	`put
("a", "b");

334 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

335 ià(
‹¡M­
.
	`v®ues
().
	`¡»am
().
	`ªyM©ch
(
x
 -> x.
	`equ®s
("c"))) {

336 
throw
 
Ãw
 
	`Exû±iÚ
("test");

338 
‹¡M­
.
	`compu‹
("b",

339 (
k
, 
v
) -> "c");

340 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

341 
	`as£¹Th©
(
‹¡M­
)

342 .
	`cÚšsEÁry
("b", "c");

343 
	}
}

345 @
	gTe¡


346 @
Suµ»ssW¬nšgs
("unchecked")

347 
public
 
	$»adS‘DiffFromWr™eS‘
()

348 
throws
 
Exû±iÚ
 {

349 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

350 .
	`bud
()

351 .
	`£tSŒ—mName
("test1")

352 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

353 .
	`İ’
();

355 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

356 .
	`bud
()

357 .
	`£tSŒ—mName
("test2")

358 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

359 .
	`İ’
();

361 
‹¡M­
.
	`put
("a", "b");

362 
‹¡M­2
.
	`put
("a", "c");

364 
Sem­hÜe
 
s1
 = 
Ãw
 
	`Sem­hÜe
(0);

365 
Sem­hÜe
 
s2
 = 
Ãw
 
	`Sem­hÜe
(0);

366 
	`scheduËCÚcu¼’y
(1, 
th»adNumb”
 -> {

367 
s1
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
(),

368 
TimeUn™
.
MILLISECONDS
);

369 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

370 
‹¡M­2
.
	`put
("a", "d");

371 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

372 
s2
.
	`»Ëa£
();

375 
	`scheduËCÚcu¼’y
(1, 
th»adNumb”
 -> {

376 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

377 
‹¡M­
.
	`compu‹
("b", (
k
, 
v
è-> 
‹¡M­2
.
	`g‘
("a"));

378 
s1
.
	`»Ëa£
();

379 
s2
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
(),

380 
TimeUn™
.
MILLISECONDS
);

381 
	`as£¹Th©ThrownBy
((è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
())

382 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

384 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_TWO
, PARAMETERS.
TIMEOUT_NORMAL
);

385 
	}
}

387 @
	gTe¡


388 @
Suµ»ssW¬nšgs
("unchecked")

389 
public
 
	$ÿnUpd©eSšgËObjeùT¿n§ùiÚ®ly
()

390 
throws
 
Exû±iÚ
 {

391 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

392 .
	`bud
()

393 .
	`£tSŒ—mName
("test")

394 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

395 .
	`İ’
();

397 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

398 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

399 .
	`isNuÎ
();

400 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

401 .
	`isEqu®To
("a");

402 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

403 .
	`isEqu®To
("b");

404 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

405 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

406 .
	`isEqu®To
("b");

407 
	}
}

409 @
	gTe¡


410 @
Suµ»ssW¬nšgs
("unchecked")

411 
public
 
	$muÉËTXesA»Aµl›d
()

412 
throws
 
Exû±iÚ
 {

414 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

415 .
	`bud
()

416 .
	`£tSŒ—mName
("test")

417 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

418 .
	`İ’
();

420 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`asLÚgSŒ—m
()

422 .
	`fÜEach
(
l
 -> {

423 
Œy
 {

424 
	`as£¹Th©
(
‹¡M­
)

425 .
	`hasSize
((è
l
);

426 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

427 
	`as£¹Th©
(
‹¡M­
.
	`put
(
LÚg
.
	`toSŒšg
(
l
), Long.toString(l)))

428 .
	`isNuÎ
();

429 
	`as£¹Th©
(
‹¡M­
)

430 .
	`hasSize
((è
l
 + 1);

431 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

432 
	`as£¹Th©
(
‹¡M­
)

433 .
	`hasSize
((è
l
 + 1);

434 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

435 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

439 
	`as£¹Th©
(
‹¡M­
)

440 .
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

441 
	}
}

443 @
	gTe¡


444 @
Suµ»ssW¬nšgs
("unchecked")

445 
public
 
	$muÉËTXesA»Aµl›dWOAcûssÜs
()

446 
throws
 
Exû±iÚ
 {

448 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

449 .
	`bud
()

450 .
	`£tSŒ—mName
("test")

451 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

452 .
	`İ’
();

454 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`asLÚgSŒ—m
()

455 .
	`fÜEach
(
l
 -> {

456 
Œy
 {

457 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

458 
	`as£¹Th©
(
‹¡M­
.
	`put
(
LÚg
.
	`toSŒšg
(
l
), Long.toString(l)))

459 .
	`isNuÎ
();

460 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

461 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

462 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

466 
	`as£¹Th©
(
‹¡M­
)

467 .
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

468 
	}
}

471 @
	gTe¡


472 @
Suµ»ssW¬nšgs
("unchecked")

473 
public
 
	$mutÜFŞlowedByAT¿n§ùiÚ
()

474 
throws
 
Exû±iÚ
 {

475 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

476 .
	`bud
()

477 .
	`£tSŒ—mName
("test")

478 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

479 .
	`İ’
();

481 
‹¡M­
.
	`ş—r
();

482 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

483 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

484 .
	`isNuÎ
();

485 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

486 .
	`isEqu®To
("a");

487 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

488 .
	`isEqu®To
("b");

489 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

490 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

491 .
	`isEqu®To
("b");

492 
	}
}

494 @
	gTe¡


495 @
Suµ»ssW¬nšgs
("unchecked")

496 
public
 
	$objeùV›wCÜ»ùlyR•ÜtsInsideTX
()

497 
throws
 
Exû±iÚ
 {

498 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
())

499 .
	`isF®£
();

500 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

501 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
())

502 .
	`isTrue
();

503 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

504 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAùive
())

505 .
	`isF®£
();

506 
	}
}

508 @
	gTe¡


509 @
Suµ»ssW¬nšgs
("unchecked")

510 
public
 
	$ÿnUpd©eSšgËObjeùT¿n§ùiÚ®lyWh’Cached
()

511 
throws
 
Exû±iÚ
 {

512 
r
.
	`£tCacheDi§bËd
(
çl£
);

514 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

515 .
	`bud
()

516 .
	`£tSŒ—mName
("test")

517 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

518 .
	`İ’
();

520 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

521 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

522 .
	`isNuÎ
();

523 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

524 .
	`isEqu®To
("a");

525 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

526 .
	`isEqu®To
("b");

527 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

528 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

529 .
	`isEqu®To
("b");

530 
	}
}

533 @
	gTe¡


534 @
Suµ»ssW¬nšgs
("unchecked")

535 
public
 
	$abÜ‹dT¿n§ùiÚsCªnÙBeR—dOnSšgËObjeù
()

536 
throws
 
Exû±iÚ
 {

537 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

538 .
	`bud
()

539 .
	`£tSŒ—mName
("test")

540 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

541 .
	`İ’
();

543 
‹¡M­
.
	`ş—r
();

544 
‹¡M­
.
	`put
("z", "z");

545 
	`as£¹Th©
(
‹¡M­
.
	`size
())

546 .
	`isEqu®To
(1);

549 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

550 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

551 .
	`isNuÎ
();

552 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

553 .
	`isEqu®To
("a");

554 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

555 .
	`isEqu®To
("b");

556 
‹¡M­
.
	`ş—r
();

557 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

558 
	`as£¹Th©
(
‹¡M­
.
	`size
())

559 .
	`isEqu®To
(1);

560 
	}
}

562 @
	gTe¡


563 @
Suµ»ssW¬nšgs
("unchecked")

564 
public
 
	$modifiÿtiÚDuršgT¿n§ùiÚCau£sAbÜt
()

565 
throws
 
Exû±iÚ
 {

566 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

567 .
	`bud
()

568 .
	`£tSŒ—mName
("A")

569 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

570 .
	`İ’
();

572 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "z"));

573 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

574 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

575 .
	`isEqu®To
("z");

576 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

577 .
	`isEqu®To
("a");

578 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

579 .
	`isEqu®To
("b");

580 
Com¶‘abËFutu»
 
cf
 = Com¶‘abËFutu».
	`runAsync
(() -> {

581 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

582 .
	`bud
()

583 .
	`£tSŒ—mName
("A")

584 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
	`g‘DeçuÉS”Ÿliz”
())

585 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

586 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

587 .
	`İ’
();

589 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

590 
‹¡M­2
.
	`put
("a", "f");

591 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

593 
cf
.
	`još
();

594 
	`as£¹Th©ThrownBy
((è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
())

595 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

596 
	}
}

598 @
	gTe¡


599 @
Suµ»ssW¬nšgs
("unchecked")

600 
public
 
	$smrM­CªCÚšCu¡omObjeùs
()

601 
throws
 
Exû±iÚ
 {

602 
M­
<
SŒšg
, 
Te¡Objeù
> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

603 .
	`bud
()

604 .
	`£tSŒ—mName
("A")

605 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Te¡Objeù
>>() {})

606 .
	`İ’
();

608 
‹¡M­
.
	`put
("A", 
Ãw
 
	`Te¡Objeù
("A", 2, 
ImmubËM­
.
	`of
("A", "B")));

609 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("A").
	`g‘Te¡SŒšg
())

610 .
	`isEqu®To
("A");

611 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("A").
	`g‘Te¡IÁ
())

612 .
	`isEqu®To
(2);

613 
	}
}

615 @
	gTe¡


616 @
Suµ»ssW¬nšgs
("unchecked")

617 
public
 
	$smrM­CªCÚšCu¡omObjeùsInsideTXes
()

618 
throws
 
Exû±iÚ
 {

619 
M­
<
SŒšg
, 
Te¡Objeù
> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

620 .
	`bud
()

621 .
	`£tSŒ—mName
("A")

622 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
Te¡Objeù
>>() {})

623 .
	`İ’
();

625 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
)

626 .
	`fÜEach
(
l
 -> {

627 
Œy
 {

628 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

629 
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
l
),

630 
Ãw
 
	`Te¡Objeù
(
IÁeg”
.
	`toSŒšg
(
l
),†,

631 
ImmubËM­
.
	`of
(

632 
IÁeg”
.
	`toSŒšg
(
l
),†)));

633 ià(
l
 > 0) {

634 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
l
 - 1)).
	`g‘Te¡IÁ
())

635 .
	`isEqu®To
(
l
 - 1);

637 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

638 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

639 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
(
e
);

643 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("3").
	`g‘Te¡SŒšg
())

644 .
	`isEqu®To
("3");

645 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("3").
	`g‘Te¡IÁ
())

646 .
	`isEqu®To
(
IÁeg”
.
	`·r£IÁ
("3"));

647 
	}
}

649 @
	gTe¡


650 @
Suµ»ssW¬nšgs
("unchecked")

651 
public
 
	$unu£dMutÜAcûssÜ
()

652 
throws
 
Exû±iÚ
 {

653 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

654 .
	`bud
()

655 .
	`£tSŒ—mName
("A")

656 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

657 .
	`İ’
();

659 
‹¡M­
.
	`put
("a", "z");

660 
	}
}

662 
AtomicIÁeg”
 
	gabÜts
;

664 
	$g‘MuÉiV›wSM
(
numTh»ads
) {

666 
UUID
 
m­SŒ—m
 = UUID.
	`¿ndomUUID
();

667 
M­
<
SŒšg
, SŒšg>[] 
‹¡M­
 =

668 
IÁSŒ—m
.
	`¿nge
(0, 
numTh»ads
)

669 .
	`m­ToObj
(
i
 -> {

670  
	`g‘RuÁime
().
	`g‘ObjeùsV›w
()

671 .
	`bud
()

672 .
	`£tSŒ—mID
(
m­SŒ—m
)

673 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

675 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

676 .
	`İ’
();

678 .
	`toA¼ay
(
M­
[]::
Ãw
);

681 
fš®
 
numKeys
 = 
numTh»ads
 * 5;

683 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
();

686 
	`addTe¡S‹p
((
ignÜed_sk_num
) -> {

687 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

691 
	`addTe¡S‹p
Ğ(
sk_num
) -> {

692 
fš®
 
putKey
 = 
r
.
	`ÃxtIÁ
(
numKeys
);

693 
fš®
 
g‘Key
 = 
r
.
	`ÃxtIÁ
(
numKeys
);

694 
‹¡M­
[
sk_num
%
numTh»ads
].
	`put
(
IÁeg”
.
	`toSŒšg
(
putKey
),

695 
‹¡M­
[
sk_num
%
numTh»ads
].
	`g‘
(
IÁeg”
.
	`toSŒšg
(
g‘Key
)));

699 
	`addTe¡S‹p
Ğ(
ignÜed_sk_num
) -> {

700 
Œy
 {

701 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

702 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

703 
abÜts
.
	`šüem’tAndG‘
();

707 
	}
}

709 @
	gTe¡


710 @
Suµ»ssW¬nšgs
("unchecked")

711 
public
 
	$cÚcu¼’tAbÜtMuÉiV›wIÁ”Ëaved
()

712 
throws
 
Exû±iÚ
 {

713 
fš®
 
numTh»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

714 
fš®
 
numRecÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

717 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

718 
abÜts
 = 
Ãw
 
	`AtomicIÁeg”
();

720 
	`g‘MuÉiV›wSM
(
numTh»ads
);

722 
	`scheduËIÁ”Ëaved
(
numTh»ads
,‚umTh»ads*
numRecÜds
);

725 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("TPS", 
numRecÜds
 * 
numTh»ads
, 
¡¬tTime
);

726 
	`ÿlcuÏ‹AbÜtR©e
(
abÜts
.
	`g‘
(), 
numRecÜds
 * 
numTh»ads
);

727 
	}
}

729 @
	gTe¡


730 @
Suµ»ssW¬nšgs
("unchecked")

731 
public
 
	$cÚcu¼’tAbÜtMuÉiV›wTh»aded
()

732 
throws
 
Exû±iÚ
 {

733 
fš®
 
numTh»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

734 
fš®
 
numRecÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

736 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

737 
abÜts
 = 
Ãw
 
	`AtomicIÁeg”
();

739 
	`g‘MuÉiV›wSM
(
numTh»ads
);

741 
	`scheduËTh»aded
(
numTh»ads
,‚umTh»ads*
numRecÜds
);

744 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("TPS", 
numRecÜds
 * 
numTh»ads
, 
¡¬tTime
);

745 
	`ÿlcuÏ‹AbÜtR©e
(
abÜts
.
	`g‘
(), 
numRecÜds
 * 
numTh»ads
);

746 
	}
}

748 @
	gTe¡


749 @
Suµ»ssW¬nšgs
("unchecked")

750 
public
 
	$bulkR—ds
()

751 
throws
 
Exû±iÚ
 {

752 
UUID
 
¡»am
 = UUID.
	`¿ndomUUID
();

753 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

754 .
	`g‘ObjeùsV›w
()

755 .
	`bud
()

756 .
	`£tSŒ—mID
(
¡»am
)

757 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

758 .
	`İ’
();

760 
‹¡M­
.
	`ş—r
();

761 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

762 
	`as£¹Th©
(
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
i
), Integer.toString(i)))

763 .
	`isNuÎ
();

767 
fš®
 
num_th»ads
 = 1;

769 
¡¬tTime
 = 
Sy¡em
.
	`ÇnoTime
();

770 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

771 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

772 .
	`£tSŒ—mID
(
¡»am
)

773 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

774 .
	`İ’
();

776 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(0)))

777 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(0));

778 
’dTime
 = 
Sy¡em
.
	`ÇnoTime
();

780 
fš®
 
MILLISECONDS_TO_MICROSECONDS
 = 1000;

781 
‹¡Stus
 +ğ"TimtØ£nd whŞ¡»am=" + 
SŒšg
.
	`fÜm©
("%d us",

782 (
’dTime
 - 
¡¬tTime
è/ 
MILLISECONDS_TO_MICROSECONDS
);

783 
	}
}

785 @
	gD©a


786 @
ToSŒšg


787 şas 
	cTe¡Objeù
 {

788 
fš®
 
SŒšg
 
	g‹¡SŒšg
;

789 
fš®
 
	g‹¡IÁ
;

790 
fš®
 
	gM­
<
	gSŒšg
, 
	gObjeù
> 
	gd“pM­
;

	@test/src/test/java/org/corfudb/runtime/collections/SMRMultiLogunitTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

22 
public
 cÏs 
	cSMRMuÉiLogun™Te¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

23 
public
 
fš®
 
	mONE_THOUSAND
 = 1000;

24 
public
 
fš®
 
	mONE_HUNDRED
 = 100;

25 
public
 
CÜfuRuÁime
 
	mruÁime
;

28 @
BefÜe


29 
public
 
	$£tRuÁime
() {

30 
	`addS”v”
(
SERVERS
.
PORT_0
);

31 
	`addS”v”
(
SERVERS
.
PORT_1
);

32 
	`addS”v”
(
SERVERS
.
PORT_2
);

33 
Layout
 
Ïyout
 = 
Ãw
 
	`Te¡LayoutBud”
()

34 .
	`£tEpoch
(1L)

35 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

36 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

37 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

38 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

39 .
	`budSegm’t
()

40 .
	`budSŒe
()

41 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

42 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

43 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

44 .
	`addToSegm’t
()

45 .
	`addToLayout
()

46 .
	`bud
();

47 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

48 
ruÁime
 = 
	`g‘RuÁime
().
	`cÚÃù
();

55 @
Te¡


56 
public
 
	$sim¶eWr™eR—d
() {

57 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

58 .
	`g‘ObjeùsV›w
()

59 .
	`bud
()

60 .
	`£tSŒ—mName
("test")

61 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

62 .
	`İ’
();

63 
	`as£¹Equ®s
(
‹¡M­
.
	`put
("1", "a"), 
nuÎ
);

64 
	`as£¹Equ®s
(
‹¡M­
.
	`g‘
("1"), "a");

65 
	}
}

72 @
Te¡


73 
public
 
	$wr™eDu®R—d
() {

74 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

75 .
	`g‘ObjeùsV›w
()

76 .
	`bud
()

77 .
	`£tSŒ—mName
("test")

78 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

79 .
	`İ’
();

80 
	`as£¹Equ®s
(
nuÎ
, 
‹¡M­
.
	`put
("1", "a"));

81 
	`as£¹Equ®s
("a", 
‹¡M­
.
	`g‘
("1"));

82 
M­
<
SŒšg
, SŒšg> 
ªÙh”M­
 = 
	`g‘RuÁime
()

83 .
	`g‘ObjeùsV›w
()

84 .
	`bud
()

85 .
	`£tSŒ—mName
("test")

86 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

87 .
	`İ’
();

88 
	`as£¹Equ®s
("a", 
ªÙh”M­
.
	`put
("1", "b"));

89 
	`as£¹Equ®s
("b", 
‹¡M­
.
	`g‘
("1"));

90 
	}
}

96 @
Te¡


97 
public
 
	$mªyWr™esTh’R—d
() {

98 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

99 .
	`g‘ObjeùsV›w
()

100 .
	`bud
()

101 .
	`£tSŒ—mName
("test")

102 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

103 .
	`İ’
();

104 
i
=0; i < 
ONE_THOUSAND
; i++) {

105 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

106 
SŒšg
 
v®
 = "v®ue" + SŒšg.
	`v®ueOf
(
i
);

107 
	`as£¹Equ®s
(
nuÎ
, 
‹¡M­
.
	`put
(
key
, 
v®
));

110 
M­
<
SŒšg
, SŒšg> 
ªÙh”M­
 = 
	`g‘RuÁime
()

111 .
	`g‘ObjeùsV›w
()

112 .
	`bud
()

113 .
	`£tSŒ—mName
("test")

114 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

115 .
	`İ’
();

116 
i
=0; i < 
ONE_THOUSAND
; i++) {

117 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

118 
SŒšg
 
v®
 = "v®ue" + SŒšg.
	`v®ueOf
(
i
);

119 
	`as£¹Equ®s
(
v®
, 
ªÙh”M­
.
	`g‘
(
key
));

121 
	}
}

130 @
	$Te¡
(
ex³ùed
 = 
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
)

131 
public
 
	$Œª§ùiÚ®MªyWr™esTh’R—d
(è
throws
 
T¿n§ùiÚAbÜ‹dExû±iÚ
 {

132 
numKeys
 = 
ONE_THOUSAND
;

133 
ObjeùsV›w
 
v›w
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
();

134 
fš®
 
CouÁDownL©ch
 
b¬r›r
 = 
Ãw
 
	`CouÁDownL©ch
(2);

136 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

137 .
	`g‘ObjeùsV›w
()

138 .
	`bud
()

139 .
	`£tSŒ—mName
("test")

140 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

141 .
	`İ’
();

144 
	`scheduËCÚcu¼’y
((
ignÜed_¡•
) -> {

145 
v›w
.
	`TXBegš
();

146 
i
=0; i < 
numKeys
; i++) {

147 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

148 
SŒšg
 
v®
 = "v®ue0_" + SŒšg.
	`v®ueOf
(
i
);

149 
‹¡M­
.
	`put
(
key
, 
v®
);

150 ià(
i
 == 0) {

151 
b¬r›r
.
	`couÁDown
();

152 
b¬r›r
.
	`awa™
();

154 ià(
i
 % 
ONE_HUNDRED
 == 0) {

155 
Th»ad
.
	`y›ld
();

158 
v›w
.
	`TXEnd
();

161 
	`scheduËCÚcu¼’y
((
ignÜed_¡•
) -> {

162 
v›w
.
	`TXBegš
();

163 
i
 = 0; i < 
numKeys
; i++) {

164 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

165 
SŒšg
 
v®
 = "v®ue1_" + SŒšg.
	`v®ueOf
(
i
);

166 
‹¡M­
.
	`put
(
key
, 
v®
);

167 ià(
i
 == 0) {

168 
b¬r›r
.
	`couÁDown
();

169 
b¬r›r
.
	`awa™
();

171 ià(
i
 % 
ONE_HUNDRED
 == 0) {

172 
Th»ad
.
	`y›ld
();

175 
v›w
.
	`TXEnd
();

178 
Œy
 {

179 
	`execu‹ScheduËd
(2, 
PARAMETERS
.
TIMEOUT_NORMAL
);

180 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

181 
throw
 
e
;

182 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

183 
e
.
	`´štSckT¿û
();

186 
SŒšg
 
ba£
 = "invalid";

187 
i
=0; i < 
numKeys
; i++) {

188 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

189 
SŒšg
 
v®
 = 
‹¡M­
.
	`g‘
(
key
);

190 ià(
v®
 !ğ
nuÎ
) {

191 ià(
i
 == 0) {

192 
und”scÜe
 = 
v®
.
	`šdexOf
("_");

193 
	`as£¹NÙEqu®s
(-1, 
und”scÜe
);

194 
ba£
 = 
v®
.
	`sub¡ršg
(0, 
und”scÜe
);

195 
Sy¡em
.
out
.
	`´šn
("ba£ i " + 
ba£
);

198 
	`as£¹Equ®s
(
Œue
, 
v®
.
	`cÚšs
(
ba£
));

200 
	}
}

207 @
Te¡


208 
public
 
	$muÉiTh»adedMªyWr™esTh’R—d
() {

209 
numKeys
 = 
ONE_THOUSAND
;

210 
ObjeùsV›w
 
v›w
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
();

211 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

212 .
	`g‘ObjeùsV›w
()

213 .
	`bud
()

214 .
	`£tSŒ—mName
("test")

215 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

216 .
	`İ’
();

218 
AtomicIÁeg”
 
th»adsCom¶‘e
 = 
Ãw
 
	`AtomicIÁeg”
(0);

219 
	`addTe¡S‹p
((
¡•
) -> {

220 
i
=0; i < 
numKeys
; i++) {

221 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

222 
SŒšg
 
v®
 = "v®ue" + SŒšg.
	`v®ueOf
(
¡•
è+ "_" + SŒšg.v®ueOf(
i
);

223 
‹¡M­
.
	`put
(
key
, 
v®
);

224 ià(
i
 % 
ONE_HUNDRED
 == 0) {

225 
Th»ad
.
	`y›ld
();

228 
th»adsCom¶‘e
.
	`šüem’tAndG‘
();

230 
Œy
 {

231 
	`scheduËTh»aded
(2, 2);

232 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

233 
e
.
	`´štSckT¿û
();

235 
	`as£¹Equ®s
(2, 
th»adsCom¶‘e
.
	`g‘
());

236 
i
=0; i < 
numKeys
; i++) {

237 
SŒšg
 
key
 = "key" + SŒšg.
	`v®ueOf
(
i
);

238 
SŒšg
 
v®
 = 
‹¡M­
.
	`g‘
(
key
);

239 
	`as£¹NÙNuÎ
(
v®
);

241 
	}
}

	@test/src/test/java/org/corfudb/runtime/collections/StringIndexer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gCÚcu¼’tModifiÿtiÚExû±iÚ
;

4 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

5 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

6 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

8 
public
 
şass
 
SŒšgIndex”
 
im¶em’ts
 
	gIndex
.
	gRegi¡ry
<
	gSŒšg
, String> {

10 
public
 
fš®
 
	gIndex
.
Name
 
	gBY_VALUE
 = () -> "BY_VALUE";

11 
public
 
fš®
 
	gIndex
.
Name
 
	gBY_FIRST_LETTER
 = () -> "BY_FIRST_LETTER";

13 
´iv©e
 
fš®
 
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>> 
	gBY_VALUE_INDEX
 =

14 
Ãw
 
Index
.
S³c
<>(

15 
BY_VALUE
,

16 (
	gIndex
.
	gFunùiÚ
<
	gSŒšg
, SŒšg, SŒšg>è(
	gkey
, 
	gv®
) -> val);

18 
´iv©e
 
fš®
 
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>> 
	gBY_FIRST_LETTER_INDEX
 =

19 
Ãw
 
Index
.
S³c
<>(

20 
BY_FIRST_LETTER
,

21 (
	gIndex
.
	gFunùiÚ
<
	gSŒšg
, SŒšg, SŒšg>è(
	gkey
, 
	gv®
) ->

22 
	gCh¬aù”
.
toSŒšg
(
v®
.
ch¬At
(0)));

24 @
Ov”ride


25 
public
 
	gI‹¿tÜ
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
™”©Ü
() {

26  
	gSŒ—m
.
of
(
BY_VALUE_INDEX
, 
BY_FIRST_LETTER_INDEX
).
™”©Ü
();

29 @
Ov”ride


30 
public
 
	gO±iÚ®
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
g‘
(
Index
.
Name
 
Çme
) {

31 
SŒšg
 
	gšdexName
 = (
Çme
 !ğ
nuÎ
)?‚ame.
g‘
() :‚ull;

33 ià(
	gBY_VALUE
.
g‘
().
equ®s
(
šdexName
)) {

34  
	gO±iÚ®
.
of
(
BY_VALUE_INDEX
);

36 } ià(
	gBY_FIRST_LETTER
.
g‘
().
equ®s
(
šdexName
)) {

37  
	gO±iÚ®
.
of
(
BY_FIRST_LETTER_INDEX
);

39  
	gO±iÚ®
.
em±y
();

43 
public
 şas 
	cFašgIndex
 
ex‹nds
 
	gSŒšgIndex”
 {

44 
public
 
fš®
 
	gIndex
.
Name
 
	gFAILING
 = () -> "FAILING";

46 
´iv©e
 
fš®
 
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>> 
	gFAILING_INDEX
 =

47 
Ãw
 
Index
.
S³c
<>(

48 
FAILING
,

49 (
	gIndex
.
	gFunùiÚ
<
	gSŒšg
, SŒšg, SŒšg>è(
	gkey
, 
	gv®ue
) -> {

50 
throw
 
Ãw
 
CÚcu¼’tModifiÿtiÚExû±iÚ
();

53 @
Ov”ride


54 
public
 
	gI‹¿tÜ
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
™”©Ü
() {

55  
	gSŒ—m
.
of
(
FAILING_INDEX
, FAILING_INDEX).
™”©Ü
();

	@test/src/test/java/org/corfudb/runtime/collections/StringMultiIndexer.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

4 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gI‹¿tÜ
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

13 
public
 
şass
 
SŒšgMuÉiIndex”
 
im¶em’ts
 
	gIndex
.
	gRegi¡ry
<
	gSŒšg
, String> {

14 
public
 
fš®
 
	gIndex
.
Name
 
	gBY_EACH_WORD
 = () -> "BY_EACH_WORD";

16 
´iv©e
 
fš®
 
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>> 
	gBY_WORD_INDEX
 =

17 
Ãw
 
Index
.
S³c
<>(
BY_EACH_WORD
,

18 (
	gIndex
.
	gMuÉiV®ueFunùiÚ
<
	gSŒšg
, SŒšg, SŒšg>è(
	gkey
, 
	gv®
è-> 
keyS‘OWÜds
(
v®
));

20 
´iv©e
 
	gI‹¿bË
<
	gSŒšg
> 
keyS‘OWÜds
(
SŒšg
 
v®
) {

21  
Ãw
 
	gHashS‘
<>(
	gA¼ays
.
asLi¡
(
v®
.
¥l™
(" ")));

24 @
Ov”ride


25 
public
 
	gO±iÚ®
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
g‘
(
Index
.
Name
 
Çme
) {

26 
SŒšg
 
	gšdexName
 = (
Çme
 !ğ
nuÎ
è?‚ame.
g‘
() :‚ull;

27 ià(
	gBY_EACH_WORD
.
g‘
().
equ®s
(
šdexName
)) {

28  
	gO±iÚ®
.
of
(
BY_WORD_INDEX
);

30  
	gO±iÚ®
.
em±y
();

34 @
Ov”ride


35 
public
 
	gI‹¿tÜ
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
™”©Ü
() {

36 
fš®
 
	gLi¡
<
	gIndex
.
	gS³c
<
	gSŒšg
, SŒšg, ? 
ex‹nds
 
	gCom·¿bË
<?>>> 
	gšdiûs
 = 
Ãw
 
A¼ayLi¡
<>();

37 
	gšdiûs
.
add
(
BY_WORD_INDEX
);

38  
	gšdiûs
.
™”©Ü
();

	@test/src/test/java/org/corfudb/runtime/concurrent/CorfuQueueTxTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcÚcu¼’t
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuQueue
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuQueue
.
	gCÜfuRecÜdId
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚsTe¡
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚTy³
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	glocks
.
	gR“Á¿ÁLock
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

17 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

19 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

25 @
Slf4j


26 
public
 cÏs 
	cCÜfuQueueTxTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

27 @
Ov”ride


28 
public
 
	$TXBegš
() {

29 
	`TXBegš
(
T¿n§ùiÚTy³
.
OPTIMISTIC
);

32 
public
 
	$TXBegš
(
T¿n§ùiÚTy³
 
ty³
) {

33 
ty³
){

34 
WRITE_AFTER_WRITE
:

35 
	`WWTXBegš
();

37 
OPTIMISTIC
:

38 
	`O±imi¡icTXBegš
();

41 
throw
 
Ãw
 
	`IÎeg®Argum’tExû±iÚ
("UnsuµÜ‹d TXNy³:"+
ty³
.
	`toSŒšg
());

43 
	}
}

45 
´Ùeùed
 
fš®
 
	gnumI‹¿tiÚs
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

46 
´Ùeùed
 
fš®
 
LÚg
 
	gnumCÚæiùKeys
 = 2L;

54 @
Te¡


55 
public
 
	$queueOrd”edByO±imi¡icTxn
(è
throws
 
Exû±iÚ
 {

56 
	`queueOrd”edByT¿n§ùiÚ
(
T¿n§ùiÚTy³
.
OPTIMISTIC
);

57 
	}
}

59 @
Te¡


60 
public
 
	$queueOrd”edByWWTxn
(è
throws
 
Exû±iÚ
 {

61 
	`queueOrd”edByT¿n§ùiÚ
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
);

62 
	}
}

64 
public
 
	$queueOrd”edByT¿n§ùiÚ
(
T¿n§ùiÚTy³
 
txnTy³
è
throws
 
Exû±iÚ
 {

65 
fš®
 
numTh»ads
 = 
PARAMETERS
.
CONCURRENCY_TWO
;

66 
M­
<
LÚg
, LÚg> 
cÚæiùM­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "conflictMap");

67 
CÜfuQueue
<
SŒšg
>

68 
cÜfuQueue
 = 
Ãw
 
CÜfuQueue
<>(
	`g‘RuÁime
(), "testQueue");

69 şas 
	cRecÜd
 {

70 @
G‘‹r


71 
public
 
CÜfuRecÜdId
 
id
;

72 @
G‘‹r


73 
public
 
SŒšg
 
d©a
;

75 
public
 
	`RecÜd
(
CÜfuRecÜdId
 
id
, 
SŒšg
 
d©a
) {

76 
this
.
id
 = id;

77 
this
.
d©a
 = data;

80 
A¼ayLi¡
<
RecÜd
> 
v®id©Ü
 = 
Ãw
 A¼ayLi¡<>(
numTh»ads
 * 
numI‹¿tiÚs
);

81 
R“Á¿ÁLock
 
lock
 = 
Ãw
 
	`R“Á¿ÁLock
();

83 
	`scheduËCÚcu¼’y
(
numTh»ads
, 
t
 ->

85 
LÚg
 
i
 = 0L; i < 
numI‹¿tiÚs
; i++) {

86 
SŒšg
 
queueD©a
 = 
t
.
	`toSŒšg
(è+ ":" + 
i
.toString();

87 
Œy
 {

88 
	`TXBegš
(
txnTy³
);

89 
LÚg
 
cošToss
 = 
Ãw
 
	`Rªdom
().
	`ÃxtLÚg
(è% 
numCÚæiùKeys
;

90 
cÚæiùM­
.
	`put
(
cošToss
, coinToss);

91 
CÜfuRecÜdId
 
id
 = 
cÜfuQueue
.
	`’queue
(
queueD©a
);

92 
lock
.
	`lock
();

93 
fš®
 
¡»amOff£t
 = 
	`TXEnd
();

94 
v®id©Ü
.
	`add
(
Ãw
 
	`RecÜd
(
id
, 
queueD©a
));

95 
log
.
	`debug
("ENQ:" + 
id
 + "=>" + 
queueD©a
 + "‡ˆ" + 
¡»amOff£t
);

96 
lock
.
	`uÆock
();

97 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
txExû±iÚ
) {

98 
log
.
	`debug
(
queueD©a
 + " ---> Abort!!! ");

100 
lock
.
	`uÆock
();

104 
	`execu‹ScheduËd
(
numTh»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

108 
Li¡
<
CÜfuQueue
.
CÜfuQueueRecÜd
<
SŒšg
>> 
»cÜds
 = 
cÜfuQueue
.
	`’ŒyLi¡
();

109 
	`as£¹Th©
(
v®id©Ü
.
	`size
()).
	`isEqu®To
(
»cÜds
.size());

112 
i
 = 0; i < 
v®id©Ü
.
	`size
(); i++) {

113 
log
.
	`debug
("EÁry:" + 
»cÜds
.
	`g‘
(
i
).
	`g‘RecÜdId
());

114 
	`as£¹Th©
(
v®id©Ü
.
	`g‘
(
i
).
	`g‘Id
().
	`equ®s
(
»cÜds
.g‘(i).
	`g‘RecÜdId
()));

115 
	`as£¹Th©
(
v®id©Ü
.
	`g‘
(
i
).
	`g‘D©a
()).
	`isEqu®To
(
»cÜds
.g‘(i).
	`g‘EÁry
());

119 
	`as£¹Th©ThrownBy
((è-> 
v®id©Ü
.
	`g‘
(0).
	`g‘Id
().
	`com·»To
(
»cÜds
.g‘(0).
	`g‘RecÜdId
())).

120 
	`isExaùlyIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

121 
	}
}

	@test/src/test/java/org/corfudb/runtime/concurrent/MapsAsMQsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcÚcu¼’t
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚsTe¡
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

15 @
Slf4j


16 
public
 cÏs 
	cM­sAsMQsTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

17 @
Ov”ride


18 
public
 
	$TXBegš
(è{ 
	`O±imi¡icTXBegš
(); }

21 
´Ùeùed
 
numI‹¿tiÚs
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

29 @
Te¡


30 
public
 
	$u£M­sAsMQs
(è
throws
 
Exû±iÚ
 {

31 
SŒšg
 
m­Name1
 = "testMapA";

32 
M­
<
LÚg
, LÚg> 
‹¡M­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name1
);

34 
fš®
 
nTh»ads
 = 4;

35 
CouÁDownL©ch
 
b¬r›r
 = 
Ãw
 
	`CouÁDownL©ch
(
nTh»ads
-1);

36 
Sem­hÜe
 
s1
 = 
Ãw
 
	`Sem­hÜe
(0);

37 
Sem­hÜe
 
s2
 = 
Ãw
 
	`Sem­hÜe
(0);

41 
	`scheduËCÚcu¼’y
(
t
 -> {

44 
b¬r›r
.
	`awa™
();

45 
log
.
	`debug
("all started");

47 
i
 = 0; i < 
numI‹¿tiÚs
; i++) {

49 
log
.
	`debug
("- s’dšg 1¡rigg” {}", 
i
);

50 
‹¡M­1
.
	`put
(1L, (è
i
);

53 
s2
.
	`acquœe
();

55 
log
.
	`debug
("- s2.awa™(èfšished‡ˆ{}", 
i
);

60 
	`scheduËCÚcu¼’y
(
t
 -> {

63 
b¬r›r
.
	`couÁDown
();

65 
busyD–ay
 = 1;

67 
i
 = 0; i < 
numI‹¿tiÚs
; i++) {

68 
‹¡M­1
.
	`g‘
(1Lè=ğ
nuÎ
 ||e¡M­1.g‘(1Lè!ğ(è
i
) {

69 
log
.
	`debug
Ğ"- wa™ fÜ 1¡rigg” {}", 
i
);

70 
Th»ad
.
	`¦“p
(
busyD–ay
);

72 
log
.
	`debug
Ğ"-„eûived 1¡rigg” {}", 
i
);

76 
log
.
	`debug
Ğ"- s’dšg 1¡ sigÇÈ{}", 
i
);

77 
s1
.
	`»Ëa£
();

82 
	`scheduËCÚcu¼’y
(
t
 -> {

85 
b¬r›r
.
	`couÁDown
();

87 
i
 = 0; i < 
numI‹¿tiÚs
; i++) {

88 
	`TXBegš
();

89 
log
.
	`debug
Ğ"-„eûived 1¡ cÚd™iÚ POST-lock PRE-awa™{}", 
i
);

92 
s1
.
	`acquœe
();

93 
log
.
	`debug
Ğ"-„eûived 1¡ cÚd™iÚ {}", 
i
);

96 
log
.
	`debug
Ğ"- s’dšg 2ndrigg” {}", 
i
);

97 
‹¡M­1
.
	`put
(2L, (è
i
);

98 
	`TXEnd
();

103 
	`scheduËCÚcu¼’y
(
t
 -> {

106 
b¬r›r
.
	`couÁDown
();

108 
busyD–ay
 = 1;

110 
i
 = 0; i < 
numI‹¿tiÚs
; i++) {

111 
‹¡M­1
.
	`g‘
(2Lè=ğ
nuÎ
 ||e¡M­1.g‘(2Lè!ğ(è
i
)

112 
Th»ad
.
	`¦“p
(
busyD–ay
);

113 
log
.
	`debug
Ğ"-„eûived 2ndrigg” {}", 
i
);

117 
log
.
	`debug
Ğ"- s’dšg 2nd sigÇÈ{}", 
i
);

118 
s2
.
	`»Ëa£
();

122 
	`execu‹ScheduËd
(
nTh»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

123 
	}
}

	@test/src/test/java/org/corfudb/runtime/concurrent/MultipleNonOverlappingTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcÚcu¼’t
;

3 
impÜt
 
	gjava
.
	gut
.
	gM­
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚsTe¡
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 @
Slf4j


14 
public
 cÏs 
	cMuÉËNÚOv”ÏµšgTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

15 @
Ov”ride


16 
public
 
	$TXBegš
(è{ 
	`WWTXBegš
(); }

38 @
Te¡


39 
public
 
	$‹¡SŒess
(è
throws
 
Exû±iÚ
 {

41 
SŒšg
 
m­Name
 = "testMapA";

42 
M­
<
LÚg
, LÚg> 
‹¡M­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name
);

44 
fš®
 
VAL
 = 1;

47 
fš®
 
OBJECT_NUM
 = 20;

48 
fš®
 
THREAD_NUM
 = 5;

50 
fš®
 
FINAL_SUM
 = 
OBJECT_NUM
;

51 
fš®
 
STEP
 = 
OBJECT_NUM
 / 
THREAD_NUM
;

54 
i
 = 0; i < 
FINAL_SUM
; i++) {

56 
j
 = 0; j < 
OBJECT_NUM
; j +ğ
STEP
) {

57 
NÚOv”ÏµšgWr™”
 
n
 = 
Ãw
 
	`NÚOv”ÏµšgWr™”
(
i
 + 1, 
j
, j + 
STEP
, 
VAL
);

58 
	`scheduËCÚcu¼’y
(
t
 -> { 
n
.
	`dowÜk
();});

60 
	`execu‹ScheduËd
(
THREAD_NUM
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

63 
As£¹
.
	`as£¹Equ®s
(
‹¡M­
.
	`size
(), 
FINAL_SUM
);

64 
LÚg
 
v®ue
 : 
‹¡M­
.
	`v®ues
()) {

65 
As£¹
.
	`as£¹Equ®s
((è
FINAL_SUM
, (è
v®ue
);

68 
	}
}

74 @
Te¡


75 
public
 
	$‹¡SŒess2
(è
throws
 
Exû±iÚ
 {

77 
SŒšg
 
m­Name1
 = "testMapA";

78 
M­
<
LÚg
, LÚg> 
‹¡M­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name1
);

79 
SŒšg
 
m­Name2
 = "testMapB";

80 
M­
<
LÚg
, LÚg> 
‹¡M­2
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name2
);

83 
fš®
 
VAL
 = 1;

86 
fš®
 
OBJECT_NUM
 = 20;

87 
fš®
 
THREAD_NUM
 = 5;

89 
fš®
 
FINAL_SUM1
 = 
OBJECT_NUM
;

90 
fš®
 
FINAL_SUM2
 = 
OBJECT_NUM
/2+1;

91 
fš®
 
STEP
 = 
OBJECT_NUM
 / 
THREAD_NUM
;

94 
i
 = 0; i < 
FINAL_SUM1
; i++) {

96 
j
 = 0; j < 
OBJECT_NUM
; j +ğ
STEP
) {

97 
NÚOv”ÏµšgWr™”
 
n
 = 
Ãw
 
	`NÚOv”ÏµšgWr™”
(
i
 + 1, 
j
, j + 
STEP
, 
VAL
);

98 
	`scheduËCÚcu¼’y
(
t
 -> { 
n
.
	`dowÜk2
();});

100 
	`execu‹ScheduËd
(
THREAD_NUM
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

104 
As£¹
.
	`as£¹Equ®s
(
‹¡M­2
.
	`size
(), 
FINAL_SUM1
);

105 
i
 = 0; i < 
OBJECT_NUM
; i++) {

106 
log
.
	`debug
("fš®e¡m­1.g‘({}èğ{}", 
i
, 
‹¡M­1
.
	`g‘
(i));

107 
log
.
	`debug
("fš®e¡m­2.g‘({}èğ{}", 
i
, 
‹¡M­2
.
	`g‘
(i));

108 ià(
i
 % 2 == 0)

109 
As£¹
.
	`as£¹Equ®s
(()
‹¡M­2
.
	`g‘
(
i
), (è
FINAL_SUM2
);

111 
As£¹
.
	`as£¹Equ®s
(()
‹¡M­2
.
	`g‘
(
i
), (è
FINAL_SUM1
);

114 
	}
}

117 
public
 cÏs 
	cNÚOv”ÏµšgWr™”
 {

119 
SŒšg
 
	gm­Name1
 = "testMapA";

120 
	gM­
<
	gLÚg
, LÚg> 
	g‹¡M­1
 = 
š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name1
);

121 
SŒšg
 
	gm­Name2
 = "testMapB";

122 
	gM­
<
	gLÚg
, LÚg> 
	g‹¡M­2
 = 
š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name2
);

125 
	g¡¬t
;

126 
	g’d
;

127 
	gv®
;

128 
	gex³ùedSum
;

130 
public
 
NÚOv”ÏµšgWr™”
(
ex³ùedSum
, 
¡¬t
, 
’d
, 
v®
) {

131 
	gthis
.
	gex³ùedSum
 = 
ex³ùedSum
;

132 
	gthis
.
	g¡¬t
 = 
¡¬t
;

133 
	gthis
.
	g’d
 = 
’d
;

134 
	gthis
.
	gv®
 = 
v®
;

140 
public
 
dowÜk
() {

141 
	gi
 = 
¡¬t
; i < 
	g’d
; i++) {

142 
sim¶eC»©eIm¶
(
i
, 
v®
);

149 
public
 
dowÜk2
() {

150 
	gi
 = 
¡¬t
; i < 
	g’d
; i++) {

151 
duoC»©eIm¶
(
i
, 
v®
);

161 
´iv©e
 
sim¶eC»©eIm¶
(
idx
, 
v®
) {

163 
TXBegš
();

165 ià(!
	g‹¡M­1
.
cÚšsKey
(
idx
)) {

166 ià(
	gex³ùedSum
 - 1 > 0)

167 
	glog
.
debug
("OBJ FAIL {} doesn'tƒxistƒxpected={}",

168 
idx
, 
ex³ùedSum
);

169 
	glog
.
debug
("OBJ {} PUT {}", 
idx
, 
v®
);

170 
	g‹¡M­1
.
put
(
idx
, 
v®
);

172 
	glog
.
debug
("OBJ {} GET", 
idx
);

173 
LÚg
 
	gv®ue
 = 
‹¡M­1
.
g‘
(
idx
);

174 ià(
	gv®ue
 !ğ(
ex³ùedSum
 - 1))

175 
log
.
debug
("OBJ FAIL {} v®ue={}ƒx³ùed={}", 
idx
, 
v®ue
,

176 
ex³ùedSum
 - 1);

177 
	glog
.
debug
("OBJ {} PUT {}+{}", 
idx
, 
v®ue
, 
v®
);

178 
	g‹¡M­1
.
put
(
idx
, 
v®ue
 + 
v®
);

181 
TXEnd
();

190 
´iv©e
 
duoC»©eIm¶
(
idx
, 
v®
) {

192 
TXBegš
();

194 ià(!
	g‹¡M­1
.
cÚšsKey
(
idx
)) {

195 ià(
	gex³ùedSum
 - 1 > 0)

196 
	glog
.
debug
("OBJ FAIL {} doesn'tƒxistƒxpected={}",

197 
idx
, 
ex³ùedSum
);

198 
	glog
.
debug
("OBJ {} PUT {}", 
idx
, 
v®
);

199 
	g‹¡M­1
.
put
(
idx
, 
v®
);

200 
	g‹¡M­2
.
put
(
idx
, 
v®
);

202 
	glog
.
debug
("OBJ {} GET", 
idx
);

203 
LÚg
 
	gv®ue
 = 
‹¡M­1
.
g‘
(
idx
);

204 ià(
	gv®ue
 !ğ(
ex³ùedSum
 - 1))

205 
log
.
debug
("OBJ FAIL {} v®ue={}ƒx³ùed={}", 
idx
, 
v®ue
,

206 
ex³ùedSum
 - 1);

207 
	glog
.
debug
("OBJ {} PUT {}+{}", 
idx
, 
v®ue
, 
v®
);

208 
	g‹¡M­1
.
put
(
idx
, 
v®ue
 + 
v®
);

211 
	glog
.
debug
("OBJ2 {} GET", 
idx
);

212 
LÚg
 
	gv®ue2
 = 
‹¡M­2
.
g‘
(
idx
);

213 ià(
	gidx
 % 2 == 0) {

214 ià(
v®ue2
 !ğ(
ex³ùedSum
/2))

215 
log
.
debug
("OBJ2 FAIL {} v®ue={}ƒx³ùed={}", 
idx
, 
v®ue2
,

216 
ex³ùedSum
/2);

217 ià(
	gex³ùedSum
 % 2 == 0) {

218 
log
.
debug
("OBJ2 {} PUT {}+{}", 
idx
, 
v®ue2
, 
v®
);

219 
	g‹¡M­2
.
put
(
idx
, 
v®ue2
 + 
v®
);

222 ià(
	gv®ue2
 !ğ(
ex³ùedSum
 - 1))

223 
log
.
debug
("OBJ2 FAIL {} v®ue={}ƒx³ùed={}", 
idx
, 
v®ue2
,

224 
ex³ùedSum
 - 1);

225 
	glog
.
debug
("OBJ2 {} PUT {}+{}", 
idx
, 
v®ue2
, 
v®
);

226 
	g‹¡M­2
.
put
(
idx
, 
v®ue2
 + 
v®
);

230 
TXEnd
();

237 
´Ùeùed
 
	$TXEnd
() {

238  
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

239 
	}
}

241 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
> T 
š¡ªtŸ‹CÜfuObjeù
(
CÏss
<T> 
tCÏss
, 
SŒšg
 
Çme
) {

247  (
	gT
è
g‘RuÁime
()

248 .
g‘ObjeùsV›w
()

249 .
bud
()

250 .
£tSŒ—mName
(
Çme
)

251 .
£tTy³
(
tCÏss
)

252 .
İ’
();

	@test/src/test/java/org/corfudb/runtime/concurrent/StreamSeekAtomicityTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcÚcu¼’t
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gAb¡¿ùT¿n§ùiÚsTe¡
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

17 @
Slf4j


18 
public
 cÏs 
	cSŒ—mS“kAtomic™yTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

19 @
Ov”ride


20 
public
 
	$TXBegš
(è{ 
	`O±imi¡icTXBegš
(); }

24 
´Ùeùed
 
numI‹¿tiÚs
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

32 @
Te¡


33 
public
 
	$ckComm™Atomic™y
(è
throws
 
Exû±iÚ
 {

34 
SŒšg
 
m­Name1
 = "testMapA";

35 
M­
<
LÚg
, LÚg> 
‹¡M­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name1
);

36 
CouÁDownL©ch
 
l1
 = 
Ãw
 
	`CouÁDownL©ch
(2);

37 
AtomicBoŞ—n
 
comm™DÚe
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

38 
fš®
 
NTHREADS
 = 3;

40 
	`scheduËCÚcu¼’y
(
t
 -> {

42 
txCÁ
;

43 
txCÁ
 = 0;xCÁ < 
numI‹¿tiÚs
;xCnt++) {

44 
	`TXBegš
();

48 
l1
.
	`awa™
();

51 
‹¡M­1
.
	`put
(1L, ()
txCÁ
);

54 
	`TXEnd
();

57 
comm™DÚe
.
	`£t
(
Œue
);

59 
As£¹
.
	`as£¹Equ®s
(()(
txCÁ
-1), (è
‹¡M­1
.
	`g‘
(1L));

63 
	`scheduËCÚcu¼’y
(
t
 -> {

64 
	`TXBegš
();

65 
‹¡M­1
.
	`g‘
(1L);

68 
l1
.
	`couÁDown
();

72 !
comm™DÚe
.
	`g‘
()){

73 
‹¡M­1
.
	`g‘
(1L);

78 
	`scheduËCÚcu¼’y
(
t
 -> {

80 
l1
.
	`couÁDown
();

83 !
comm™DÚe
.
	`g‘
() ){

84 
‹¡M­1
.
	`g‘
(1L);

88 
	`execu‹ScheduËd
(
NTHREADS
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

89 
	}
}

98 @
Te¡


99 
public
 
	$ckComm™Atomic™y2
(è
throws
 
Exû±iÚ
 {

100 
SŒšg
 
m­Name1
 = "testMapA";

101 
M­
<
LÚg
, LÚg> 
‹¡M­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name1
);

102 
SŒšg
 
m­Name2
 = "testMapB";

103 
M­
<
LÚg
, LÚg> 
‹¡M­2
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name2
);

105 
CouÁDownL©ch
 
l1
 = 
Ãw
 
	`CouÁDownL©ch
(2);

106 
AtomicBoŞ—n
 
comm™DÚe
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

107 
fš®
 
NTHREADS
 = 3;

109 
	`scheduËCÚcu¼’y
(
t
 -> {

111 
txCÁ
;

112 
txCÁ
 = 0;xCÁ < 
numI‹¿tiÚs
;xCnt++) {

113 
	`TXBegš
();

117 
l1
.
	`awa™
();

120 
‹¡M­1
.
	`put
(1L, ()
txCÁ
);

121 ià(
txCÁ
 % 2 == 0)

122 
‹¡M­2
.
	`put
(1L, ()
txCÁ
);

125 
	`TXEnd
();

128 
comm™DÚe
.
	`£t
(
Œue
);

130 
As£¹
.
	`as£¹Equ®s
(()(
txCÁ
-1), (è
‹¡M­1
.
	`g‘
(1L));

131 
As£¹
.
	`as£¹Equ®s
(()Ğ(
txCÁ
-1è% 2 =ğ0 ? (txCÁ-1è:xCÁ-2), (è
‹¡M­2
.
	`g‘
(1L));

135 
	`scheduËCÚcu¼’y
(
t
 -> {

136 
	`TXBegš
();

137 
‹¡M­1
.
	`g‘
(1L);

140 
l1
.
	`couÁDown
();

144 !
comm™DÚe
.
	`g‘
()){

145 
‹¡M­1
.
	`g‘
(1L);

146 
‹¡M­2
.
	`g‘
(1L);

151 
	`scheduËCÚcu¼’y
(
t
 -> {

153 
l1
.
	`couÁDown
();

156 !
comm™DÚe
.
	`g‘
() ){

157 
‹¡M­1
.
	`g‘
(1L);

158 
‹¡M­2
.
	`g‘
(1L);

162 
	`execu‹ScheduËd
(
NTHREADS
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

163 
	}
}

170 @
Te¡


171 
public
 
	$ckComm™Atomic™y3
(è
throws
 
Exû±iÚ
 {

172 
SŒšg
 
m­Name1
 = "testMapA";

173 
M­
<
LÚg
, LÚg> 
‹¡M­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name1
);

174 
SŒšg
 
m­Name2
 = "testMapB";

175 
M­
<
LÚg
, LÚg> 
‹¡M­2
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, 
m­Name2
);

177 
CouÁDownL©ch
 
l1
 = 
Ãw
 
	`CouÁDownL©ch
(2);

178 
AtomicBoŞ—n
 
comm™DÚe
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

179 
fš®
 
NTHREADS
 = 3;

181 
	`scheduËCÚcu¼’y
(
t
 -> {

183 
txCÁ
;

184 
txCÁ
 = 0;xCÁ < 
numI‹¿tiÚs
;xCnt++) {

185 
	`TXBegš
();

189 
l1
.
	`awa™
();

192 
‹¡M­1
.
	`put
(1L, ()
txCÁ
);

193 ià(
txCÁ
 % 2 == 0)

194 
‹¡M­2
.
	`put
(1L, ()
txCÁ
);

197 
	`TXEnd
();

200 
comm™DÚe
.
	`£t
(
Œue
);

202 
As£¹
.
	`as£¹Equ®s
(()(
txCÁ
-1), (è
‹¡M­1
.
	`g‘
(1L));

203 
As£¹
.
	`as£¹Equ®s
(()Ğ(
txCÁ
-1è% 2 =ğ0 ? (txCÁ-1è:xCÁ-2), (è
‹¡M­2
.
	`g‘
(1L));

207 
	`scheduËCÚcu¼’y
(
t
 -> {

208 
¥ecŸlV®
 = 
numI‹¿tiÚs
 + 1;

210 
	`TXBegš
();

211 
‹¡M­1
.
	`g‘
(1L);

214 
l1
.
	`couÁDown
();

218 !
comm™DÚe
.
	`g‘
()){

219 
‹¡M­1
.
	`put
(1L, 
¥ecŸlV®
);

220 
‹¡M­2
.
	`put
(1L, 
¥ecŸlV®
);

225 
	`scheduËCÚcu¼’y
(
t
 -> {

227 
l1
.
	`couÁDown
();

230 !
comm™DÚe
.
	`g‘
() ){

231 
‹¡M­1
.
	`g‘
(1L);

232 
‹¡M­2
.
	`g‘
(1L);

236 
	`execu‹ScheduËd
(
NTHREADS
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

237 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/AbstractObjectTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

11 
public
 cÏs 
	cAb¡¿ùObjeùTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

26 
	m´Ùeùed
 <
T
 
ex‹nds
 
	mICÜfuSMR
> T 
š¡ªtŸ‹CÜfuObjeù
(

27 
CÜfuRuÁime
 
r
, 
CÏss
<
T
> 
tCÏss
, 
SŒšg
 
Çme
) {

28  (
	mT
)

29 
	mr
.
g‘ObjeùsV›w
()

30 .
bud
()

31 .
£tSŒ—mName
(
Çme
)

32 .
£tTy³
(
tCÏss
)

33 .
İ’
();

35 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
> T 
š¡ªtŸ‹CÜfuObjeù
(
CÏss
<T> 
tCÏss
, 
SŒšg
 
Çme
) {

36  
š¡ªtŸ‹CÜfuObjeù
(
g‘RuÁime
(), 
tCÏss
, 
Çme
);

53 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
> 
Objeù
 
š¡ªtŸ‹CÜfuObjeù
(

54 
CÜfuRuÁime
 
r
, 
Ty³Tok’
<
T
> 
tTy³
, 
SŒšg
 
Çme
) {

55  
	gr
.
g‘ObjeùsV›w
()

56 .
bud
()

57 .
£tSŒ—mName
(
Çme
)

58 .
£tTy³Tok’
(
tTy³
)

59 .
İ’
();

61 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
> 
Objeù
 
š¡ªtŸ‹CÜfuObjeù
(
Ty³Tok’
<T> 
tTy³
, 
SŒšg
 
Çme
) {

62  
š¡ªtŸ‹CÜfuObjeù
(
g‘RuÁime
(), 
tTy³
, 
Çme
);

65 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
> 
Objeù
 
š¡ªtŸ‹CÜfuObjeù
(

66 
CÜfuRuÁime
 
r
, 
Ty³Tok’
<
T
> 
tTy³
, 
SŒšg
 
Çme
, 
IS”Ÿliz”
 
£rŸliz”
) {

67  
	gr
.
g‘ObjeùsV›w
()

68 .
bud
()

69 .
£tSŒ—mName
(
Çme
)

70 .
£tTy³Tok’
(
tTy³
)

71 .
£tS”Ÿliz”
(
£rŸliz”
)

72 .
İ’
();

	@test/src/test/java/org/corfudb/runtime/object/CompileProxyTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

12 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

22 
public
 cÏs 
	cCompeProxyTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

24 @
Te¡


25 
public
 
	$‹¡ObjeùM­Sim¶e
(è
throws
 
Exû±iÚ
 {

27 
M­
<
SŒšg
, SŒšg> 
m­
 = 
	`g‘DeçuÉRuÁime
()

28 .
	`g‘ObjeùsV›w
().
	`bud
()

29 .
	`£tSŒ—mName
("my stream")

30 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
,String>>() {})

31 .
	`İ’
();

33 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

34 
m­
.
	`put
("hello", "world");

35 
m­
.
	`put
("hell", "world");

36 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

38 
	`as£¹Th©
(
m­
)

39 .
	`cÚšsEÁry
("hello", "world");

40 
	`as£¹Th©
(
m­
)

41 .
	`cÚšsEÁry
("hell", "world");

44 @
Te¡


45 
public
 
	$‹¡TrimmedObjeù
(è
throws
 
Exû±iÚ
 {

46 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
();

50 
fš®
 
numOfTok’s
 = 10;

51 
SŒšg
 
¡»amName
 = "s1";

52 
¹
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»amName
));

55 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
numOfTok’s
);

56 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

57 
¹
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

58 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

60 
M­
<
SŒšg
, SŒšg> 
m­
 = 
¹
.
	`g‘ObjeùsV›w
().
	`bud
()

61 .
	`£tSŒ—mName
(
¡»amName
)

62 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
,String>>() {})

63 .
	`İ’
();

65 
	`as£¹Th©ThrownBy
(() -> {

66 
m­
.
	`g‘
("key1");

67 }).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

68 
	}
}

70 @
Te¡


71 
public
 
	$‹¡ObjeùCouÁ”Sim¶e
(è
throws
 
Exû±iÚ
 {

72 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”
 = 
	`g‘DeçuÉRuÁime
()

73 .
	`g‘ObjeùsV›w
().
	`bud
()

74 .
	`£tSŒ—mName
("my stream")

75 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuSh¬edCouÁ”
>() {

77 .
	`İ’
();

79 
fš®
 
VALUE
 = 33;

80 
sh¬edCouÁ”
.
	`£tV®ue
(
VALUE
);

81 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
())

82 .
	`isEqu®To
(
VALUE
);

83 
	}
}

92 @
Te¡


93 
public
 
	$‹¡ObjeùCouÁ”Wr™eCÚcu¼’cy
(è
throws
 
Exû±iÚ
 {

94 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”
 = 
	`g‘DeçuÉRuÁime
()

95 .
	`g‘ObjeùsV›w
().
	`bud
()

96 .
	`£tSŒ—mName
("my stream")

97 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuSh¬edCouÁ”
>() {

99 .
	`İ’
();

100 
fš®
 
cÚcu¼’cy
 = 
PARAMETERS
.
CONCURRENCY_LOTS
;

101 
fš®
 
INITIAL
 = -1;

103 
sh¬edCouÁ”
.
	`£tV®ue
(
INITIAL
);

104 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
())

105 .
	`isEqu®To
(
INITIAL
);

109 
	`scheduËCÚcu¼’y
(
cÚcu¼’cy
, 
t
 ->

110 
sh¬edCouÁ”
.
	`£tV®ue
(
t
)

112 
	`execu‹ScheduËd
(
cÚcu¼’cy
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

115 
ICÜfuSMR
<
CÜfuSh¬edCouÁ”
> 
compedSh¬edCouÁ”
 = (ICÜfuSMR<CÜfuSh¬edCouÁ”>è
sh¬edCouÁ”
;

116 
ICÜfuSMRProxyIÁ”Çl
<
CÜfuSh¬edCouÁ”
> 
´oxy_CORFUSMR
 = (ICÜfuSMRProxyIÁ”Çl<CÜfuSh¬edCouÁ”>è
compedSh¬edCouÁ”
.
	`g‘CÜfuSMRProxy
();

119 
befÜeSync
, 
aá”Sync
;

122 
	`as£¹Th©
(
befÜeSync
 = 
´oxy_CORFUSMR
.
	`g‘Und”lyšgObjeù
().
	`g‘Objeù
().
	`g‘V®ue
())

123 .
	`isEqu®To
(
INITIAL
);

126 
time¡amp
 = 1;ime¡am°<ğ
cÚcu¼’cy
;imestamp++) {

127 
´oxy_CORFUSMR
.
	`g‘Und”lyšgObjeù
()

128 .
	`syncObjeùUn§ã
(
time¡amp
);

129 
	`as£¹Th©
((
aá”Sync
 = 
´oxy_CORFUSMR
.
	`g‘Und”lyšgObjeù
().
	`g‘Objeù
().
	`g‘V®ue
()))

130 .
	`isB‘w“n
(0, 
cÚcu¼’cy
);

131 
	`as£¹Th©
(
befÜeSync
)

132 .
	`isNÙEqu®To
(
aá”Sync
);

133 
befÜeSync
 = 
aá”Sync
;

137 
	`as£¹Th©
((
aá”Sync
 = 
sh¬edCouÁ”
.
	`g‘V®ue
()))

138 .
	`isB‘w“n
(0, 
cÚcu¼’cy
);

139 
	`as£¹Th©
(
befÜeSync
)

140 .
	`isEqu®To
(
aá”Sync
);

141 
	}
}

148 @
Te¡


149 
public
 
	$‹¡ObjeùCouÁ”CASCÚcu¼’cy
(è
throws
 
Exû±iÚ
 {

150 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”
 = 
	`g‘DeçuÉRuÁime
()

151 .
	`g‘ObjeùsV›w
().
	`bud
()

152 .
	`£tSŒ—mName
("my stream")

153 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuSh¬edCouÁ”
>() {

155 .
	`İ’
();

156 
cÚcu¼’cy
 = 
PARAMETERS
.
CONCURRENCY_LOTS
;

157 
fš®
 
INITIAL
 = -1;

159 
sh¬edCouÁ”
.
	`£tV®ue
(
INITIAL
);

162 
AtomicIÁeg”
 
ÿsSucûeded
 = 
Ãw
 
	`AtomicIÁeg”
(0);

163 
	`scheduËCÚcu¼’y
(
cÚcu¼’cy
, 
t
 -> {

164 ià(
sh¬edCouÁ”
.
	`CAS
(
INITIAL
, 
t
) == INITIAL)

165 
ÿsSucûeded
.
	`šüem’tAndG‘
();

167 
	`execu‹ScheduËd
(
cÚcu¼’cy
, 
PARAMETERS
.
TIMEOUT_SHORT
);

170 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
())

171 .
	`isB‘w“n
(0, 
cÚcu¼’cy
);

172 
	`as£¹Th©
(
ÿsSucûeded
.
	`g‘
())

173 .
	`isEqu®To
(1);

174 
	}
}

185 @
Te¡


186 
public
 
	$‹¡ObjeùCouÁ”R—dCÚcu¼’cy
(è
throws
 
Exû±iÚ
 {

187 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”
 = 
	`g‘DeçuÉRuÁime
()

188 .
	`g‘ObjeùsV›w
().
	`bud
()

189 .
	`£tSŒ—mName
("my stream")

190 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuSh¬edCouÁ”
>() {

192 .
	`İ’
();

194 
numTasks
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

195 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
(
PARAMETERS
.
SEED
);

197 
sh¬edCouÁ”
.
	`£tV®ue
(-1);

198 
AtomicIÁeg”
 
Ï¡Upd©e
 = 
Ãw
 
	`AtomicIÁeg”
(-1);

200 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
())

201 .
	`isEqu®To
(
Ï¡Upd©e
.
	`g‘
());

204 
	`addTe¡S‹p
 ((
sk_num
) -> {

205 ià(
r
.
	`ÃxtBoŞ—n
()) {

206 
sh¬edCouÁ”
.
	`£tV®ue
(
sk_num
);

207 
Ï¡Upd©e
.
	`£t
(
sk_num
);

209 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
()).
	`isEqu®To
(
Ï¡Upd©e
.
	`g‘
());

214 
	`scheduËIÁ”Ëaved
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.CONCURRENCY_SOME*
numTasks
);

215 
	}
}

228 @
Te¡


229 
public
 
	$‹¡ObjeùCouÁ”CÚcu¼’cySŒ—m
(è
throws
 
Exû±iÚ
 {

230 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”
 = 
	`g‘DeçuÉRuÁime
()

231 .
	`g‘ObjeùsV›w
().
	`bud
()

232 .
	`£tSŒ—mName
("my stream")

233 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuSh¬edCouÁ”
>() {

235 .
	`İ’
();

237 
ICÜfuSMR
<
CÜfuSh¬edCouÁ”
> 
compedSh¬edCouÁ”
 = (ICÜfuSMR<CÜfuSh¬edCouÁ”>è
sh¬edCouÁ”
;

238 
ICÜfuSMRProxyIÁ”Çl
<
CÜfuSh¬edCouÁ”
> 
´oxy_CORFUSMR
 = (ICÜfuSMRProxyIÁ”Çl<CÜfuSh¬edCouÁ”>è
compedSh¬edCouÁ”
.
	`g‘CÜfuSMRProxy
();

241 
numTasks
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

242 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
(
PARAMETERS
.
SEED
);

244 
fš®
 
INITIAL
 = -1;

246 
sh¬edCouÁ”
.
	`£tV®ue
(
INITIAL
);

247 
AtomicIÁeg”
 
Ï¡Upd©e
 = 
Ãw
 
	`AtomicIÁeg”
(
INITIAL
);

248 
AtomicLÚg
 
Ï¡Upd©eSŒ—mPos™iÚ
 = 
Ãw
 
	`AtomicLÚg
(0);

250 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
())

251 .
	`isEqu®To
(
Ï¡Upd©e
.
	`g‘
());

253 
AtomicIÁeg”
 
Ï¡R—d
 = 
Ãw
 
	`AtomicIÁeg”
(
INITIAL
);

258 
	`addTe¡S‹p
((
sk_num
) -> {

260 ià(
r
.
	`ÃxtBoŞ—n
()) {

261 
sh¬edCouÁ”
.
	`£tV®ue
(
sk_num
);

262 
Ï¡Upd©e
.
	`£t
(
sk_num
);

263 
Ï¡Upd©eSŒ—mPos™iÚ
.
	`šüem’tAndG‘
();

268 
	`as£¹Th©
(
´oxy_CORFUSMR
.
	`g‘Und”lyšgObjeù
().
	`g‘Objeù
().
	`g‘V®ue
())

269 .
	`isEqu®To
(
Ï¡R—d
.
	`g‘
());

272 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
()).
	`isEqu®To
(
Ï¡Upd©e
.
	`g‘
());

275 
Ï¡R—d
.
	`£t
(
Ï¡Upd©e
.
	`g‘
());

283 
	`scheduËIÁ”Ëaved
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.CONCURRENCY_SOME*
numTasks
);

284 
	}
}

294 @
Te¡


295 
public
 
	$‹¡CÜfuM­CÚcu¼’cy
(è
throws
 
Exû±iÚ
 {

297 
M­
<
SŒšg
, SŒšg> 
m­
 = 
	`g‘DeçuÉRuÁime
()

298 .
	`g‘ObjeùsV›w
().
	`bud
()

299 .
	`£tSŒ—mName
("my stream")

300 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

302 .
	`İ’
();

303 
cÚcu¼’cy
 = 
PARAMETERS
.
CONCURRENCY_LOTS
;

306 
	`g‘DeçuÉRuÁime
().
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

311 
	`scheduËCÚcu¼’y
(
cÚcu¼’cy
, 
t
 -> {

312 
m­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
t
), "world");

314 
	`execu‹ScheduËd
(
cÚcu¼’cy
, 
PARAMETERS
.
TIMEOUT_SHORT
);

317 
i
 = 0; i < 
cÚcu¼’cy
; i++)

318 
	`as£¹Th©
(
m­
.
	`cÚšsKey
(
IÁeg”
.
	`toSŒšg
(
i
)))

319 .
	`isTrue
();

323 
	`as£¹Th©
(
m­
.
	`cÚšsKey
(
IÁeg”
.
	`toSŒšg
(
cÚcu¼’cy
)))

324 .
	`isF®£
();

326 
	}
}

334 @
Te¡


335 
public
 
	$‹¡ObjeùCompoundSim¶e
(è
throws
 
Exû±iÚ
 {

336 
CÜfuCompoundObj
 
sh¬edCÜfuCompound
 = 
	`g‘DeçuÉRuÁime
()

337 .
	`g‘ObjeùsV›w
().
	`bud
()

338 .
	`£tSŒ—mName
("my stream")

339 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuCompoundObj
>() {

341 .
	`İ’
();

343 
fš®
 
TESTVALUE
 = 33;

344 
sh¬edCÜfuCompound
.
	`£t
(sh¬edCÜfuCompound.
Ãw
 
	`IÂ”
("A", "B"), 
TESTVALUE
);

346 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘ID
())

347 .
	`isEqu®To
(
TESTVALUE
);

348 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘U£r
().
fœ¡Name
)

349 .
	`isEqu®To
("A");

350 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘U£r
().
Ï¡Name
)

351 .
	`isEqu®To
("B");

352 
	}
}

361 @
Te¡


362 
public
 
	$‹¡ObjeùCompoundWr™eCÚcu¼’cy
(è
throws
 
Exû±iÚ
 {

363 
CÜfuCompoundObj
 
sh¬edCÜfuCompound
 = 
	`g‘DeçuÉRuÁime
()

364 .
	`g‘ObjeùsV›w
().
	`bud
()

365 .
	`£tSŒ—mName
("my stream")

366 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuCompoundObj
>() {

368 .
	`İ’
();

370 
cÚcu¼’cy
 = 
PARAMETERS
.
CONCURRENCY_LOTS
;

373 
	`g‘DeçuÉRuÁime
().
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

376 
	`scheduËCÚcu¼’y
(
cÚcu¼’cy
, 
t
 -> {

377 
sh¬edCÜfuCompound
.
	`£t
(sh¬edCÜfuCompound.
Ãw
 
	`IÂ”
("A"+
t
, "B"+t),);

379 
	`execu‹ScheduËd
(
cÚcu¼’cy
, 
PARAMETERS
.
TIMEOUT_SHORT
);

382 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘ID
())

383 .
	`isB‘w“n
(0, 
cÚcu¼’cy
);

384 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘U£r
().
fœ¡Name
)

385 .
	`¡¬tsW™h
("A");

386 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘U£r
().
Ï¡Name
)

387 .
	`¡¬tsW™h
("B");

388 
	}
}

407 @
Te¡


408 
public
 
	$‹¡ObjeùCompoundWr™eCÚcu¼’cySŒ—m
(è
throws
 
Exû±iÚ
 {

409 
CÜfuCompoundObj
 
sh¬edCÜfuCompound
 = 
	`g‘DeçuÉRuÁime
()

410 .
	`g‘ObjeùsV›w
().
	`bud
()

411 .
	`£tSŒ—mName
("my stream")

412 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuCompoundObj
>() {

414 .
	`İ’
();

417 
ICÜfuSMR
<
CÜfuCompoundObj
> 
compedCÜfuCompound
 = (ICÜfuSMR<CÜfuCompoundObj>è
sh¬edCÜfuCompound
;

418 
ICÜfuSMRProxyIÁ”Çl
<
CÜfuCompoundObj
> 
´oxy_CORFUSMR
 = (ICÜfuSMRProxyIÁ”Çl<CÜfuCompoundObj>è
compedCÜfuCompound
.
	`g‘CÜfuSMRProxy
();

422 
sh¬edCÜfuCompound
.
	`£t
(sh¬edCÜfuCompound.
Ãw
 
	`IÂ”
("E" + 0, "F" + 0), 0);

426 
sh¬edCÜfuCompound
.
	`g‘ID
();

431 
	`addTe¡S‹p
((
sk_num
) -> {

432 
sh¬edCÜfuCompound
.
	`£t
(sh¬edCÜfuCompound.
Ãw
 
	`IÂ”
("C" + 
sk_num
, "D" +ask_num),ask_num);

436 
	`addTe¡S‹p
((
ignÜed_sk_num
) -> {

438 
	`as£¹Th©
(
´oxy_CORFUSMR
.
	`g‘Und”lyšgObjeù
().
	`g‘Objeù
().
	`g‘U£r
().
	`g‘Fœ¡Name
())

439 .
	`¡¬tsW™h
("E");

440 
	`as£¹Th©
(
´oxy_CORFUSMR
.
	`g‘Und”lyšgObjeù
().
	`g‘Objeù
().
	`g‘U£r
().
	`g‘La¡Name
())

441 .
	`¡¬tsW™h
("F");

445 
	`scheduËIÁ”Ëaved
(
PARAMETERS
.
CONCURRENCY_SOME
, PARAMETERS.
NUM_ITERATIONS_MODERATE
);

447 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘U£r
().
	`g‘Fœ¡Name
())

448 .
	`¡¬tsW™h
("C");

449 
	`as£¹Th©
(
sh¬edCÜfuCompound
.
	`g‘U£r
().
	`g‘La¡Name
())

450 .
	`¡¬tsW™h
("D");

452 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/ConflictParameterClass.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÚæiùP¬am‘”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

12 @
CÜfuObjeù


13 
public
 
şass
 
CÚæiùP¬am‘”CÏss
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÚæiùP¬am‘”CÏss
> {

15 @
MutÜ
(
Çme
 = "mutatorTest")

16 
public
 
mutÜTe¡
(
‹¡1
, @
CÚæiùP¬am‘”
 
‹¡2
) {

20 @
AcûssÜ


21 
public
 
acûssÜTe¡
(@
CÚæiùP¬am‘”
 
SŒšg
 
‹¡1
, SŒšg 
‹¡2
) {

25 @
MutÜAcûssÜ
(
Çme
 = "mutatorAccessorTest")

26 
public
 
Objeù
 
mutÜAcûssÜTe¡
(@
CÚæiùP¬am‘”
 
SŒšg
 
‹¡1
, SŒšg 
‹¡2
) {

33 @
Ov”ride


34 
public
 
CÚæiùP¬am‘”CÏss
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

35  
	gthis
;

	@test/src/test/java/org/corfudb/runtime/object/CorfuCompoundObj.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	glombok
.
	gS‘‹r
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

12 @
CÜfuObjeù


13 
public
 
şass
 
CÜfuCompoundObj
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuCompoundObj
> {

15 
public
 cÏs 
	cIÂ”
 {

16 @
	gS‘‹r
 @
G‘‹r


17 
SŒšg
 
	gfœ¡Name
, 
	gÏ¡Name
;

19 
public
 
IÂ”
(
SŒšg
 
f
, SŒšg 
l
è{ 
	gfœ¡Name
 = f; 
	gÏ¡Name
 =†; }

22 
IÂ”
 
	gu£r
;

23 
	gID
;

25 @
MutÜ
(
Çme
 = "set")

26 
public
 
	$£t
(
IÂ”
 
š
, 
id
) {

27 
this
.
u£r
 = 
š
;

28 
this
.
ID
 = 
id
;

29 
	}
}

31 @
AcûssÜ


32 
public
 
IÂ”
 
	$g‘U£r
(è{  
u£r
;
	}
}

34 @
AcûssÜ


35 
public
 
	$g‘ID
(è{  
ID
;
	}
}

40 @
Ov”ride


41 
public
 
CÜfuCompoundObj
 
	$g‘CÚ‹xt
(
CÚ‹xt
 
cÚ‹xt
) {

42  
this
;

43 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/CorfuSMRObjectConcurrencyTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

10 
public
 cÏs 
	cCÜfuSMRObjeùCÚcu¼’cyTe¡
 
ex‹nds
 
	mAb¡¿ùObjeùTe¡
 {

11 @
Te¡


12 
public
 
	$‹¡CÜfuSh¬edCouÁ”CÚcu¼’tR—ds
(è
throws
 
Exû±iÚ
 {

13 
	`g‘DeçuÉRuÁime
();

15 
fš®
 
COUNTER_INITIAL
 = 55;

17 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”
 = (CorfuSharedCounter)

18 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuSh¬edCouÁ”
.
şass
, "test");

20 
sh¬edCouÁ”
.
	`£tV®ue
(
COUNTER_INITIAL
);

22 
cÚcu¼’cy
 = 
PARAMETERS
.
CONCURRENCY_SOME
 * 2;

23 
wr™ecÚcu¼’cy
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

24 
wr™”wÜk
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

26 
sh¬edCouÁ”
.
	`£tV®ue
(-1);

27 
	`as£¹Th©
(
sh¬edCouÁ”
.
	`g‘V®ue
())

28 .
	`isEqu®To
(-1);

30 
	`scheduËCÚcu¼’y
(
wr™ecÚcu¼’cy
, 
t
 -> {

31 
i
 = 0; i < 
wr™”wÜk
; i++)

32 
sh¬edCouÁ”
.
	`£tV®ue
(
t
*
wr™”wÜk
 + 
i
);

35 
	`scheduËCÚcu¼’y
(
cÚcu¼’cy
-
wr™ecÚcu¼’cy
, 
t
 -> {

36 
Ï¡»ad
 = -1;

37 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

38 
»s
 = 
sh¬edCouÁ”
.
	`g‘V®ue
();

39 
boŞ—n
 
as£¹æag
 =

41 Ğ((
Ï¡»ad
 < 
wr™”wÜk
 && 
»s
 < writerwork) || (lastread >= writerwork &&„es >= writerwork) ) &&†astread <=„es ) ||

42 Ğ(
Ï¡»ad
 < 
wr™”wÜk
 && 
»s
 >= writerwork) || (lastread >= writerwork &&„es < writerwork) )

44 
	`as£¹Th©
(
as£¹æag
)

45 .
	`isTrue
();

49 
	`execu‹ScheduËd
(
cÚcu¼’cy
, 
PARAMETERS
.
TIMEOUT_LONG
);

52 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/CorfuSMRObjectProxyTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gM­
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gCu¡omS”Ÿliz”
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
public
 cÏs 
	cCÜfuSMRObjeùProxyTe¡
 
ex‹nds
 
	mAb¡¿ùObjeùTe¡
 {

21 @
	mTe¡


22 @
Suµ»ssW¬nšgs
("unchecked")

23 
public
 
	$ÿnR—dWr™eToSšgË
()

24 
throws
 
Exû±iÚ
 {

25 
	`g‘DeçuÉRuÁime
();

27 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = (Map<String, String>)

28 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
,String>>() {}, "test");

30 
‹¡M­
.
	`ş—r
();

31 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "a"))

32 .
	`isNuÎ
();

33 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

34 .
	`isEqu®To
("a");

35 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("a"))

36 .
	`isEqu®To
("b");

38 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = (Map<String, String>)

39 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
,String>>() {}, "test");

41 
	`as£¹Th©
(
‹¡M­2
.
	`g‘
("a"))

42 .
	`isEqu®To
("b");

45 @
Te¡


46 
public
 
	$ÿnO³nObjeùW™hTwoRuÁimes
()

47 
throws
 
Exû±iÚ
 {

48 
	`g‘DeçuÉRuÁime
();

50 
fš®
 
TEST_VALUE
 = 42;

51 
Te¡CÏss
 
‹¡CÏss
 = (TestClass)

52 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
Te¡CÏss
>() {}, "test");

54 
‹¡CÏss
.
	`£t
(
TEST_VALUE
);

55 
	`as£¹Th©
(
‹¡CÏss
.
	`g‘
())

56 .
	`isEqu®To
(
TEST_VALUE
);

58 
CÜfuRuÁime
 
ruÁime2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
());

59 
ruÁime2
.
	`cÚÃù
();

61 
Te¡CÏss
 
‹¡CÏss2
 = (TestClass)

62 
	`š¡ªtŸ‹CÜfuObjeù
(
ruÁime2
,

63 
Ãw
 
Ty³Tok’
<
Te¡CÏss
>() {}, "test");

65 
	`as£¹Th©
(
‹¡CÏss2
.
	`g‘
())

66 .
	`isEqu®To
(
TEST_VALUE
);

67 
	}
}

69 @
	gTe¡


70 @
Suµ»ssW¬nšgs
("unchecked")

71 
public
 
	$ÿnU£AÂÙ©iÚs
()

72 
throws
 
Exû±iÚ
 {

73 
	`g‘DeçuÉRuÁime
();

75 
Te¡CÏssUsšgAÂÙ©iÚ
 
‹¡
 = (TestClassUsingAnnotation)

76 
	`š¡ªtŸ‹CÜfuObjeù
(
Ãw
 
Ty³Tok’
<
Te¡CÏssUsšgAÂÙ©iÚ
>() {}, "test");

78 
	`as£¹Th©
(
‹¡
.
	`‹¡Fn1
())

79 .
	`isTrue
();

81 
	`as£¹Th©
(
‹¡
.
	`‹¡Inüem’t
())

82 .
	`isTrue
();

84 
	`as£¹Th©
(
‹¡
.
	`g‘V®ue
())

85 .
	`isNÙZ”o
();

88 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`g‘ObjeùCache
().
	`ş—r
();

90 
Te¡CÏssUsšgAÂÙ©iÚ
 
‹¡2
 = (TestClassUsingAnnotation)

91 
	`š¡ªtŸ‹CÜfuObjeù
(
Te¡CÏssUsšgAÂÙ©iÚ
.
şass
, "test");

93 
	`as£¹Th©
(
‹¡
)

94 .
	`isNÙSameAs
(
‹¡2
);

96 
	`as£¹Th©
(
‹¡2
.
	`g‘V®ue
())

97 .
	`isNÙZ”o
();

98 
	}
}

100 @
	gTe¡


101 @
Suµ»ssW¬nšgs
("unchecked")

102 
public
 
	$ÿnU£Cu¡omS”Ÿliz”
(è
throws
 
Exû±iÚ
 {

104 
IS”Ÿliz”
 
cu¡omS”Ÿliz”
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
((
by‹
è(
S”Ÿliz”s
.
SYSTEM_SERIALIZERS_COUNT
 + 1));

105 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”
);

106 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

108 
M­
<
SŒšg
, SŒšg> 
‹¡
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

109 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

110 .
	`£tSŒ—mName
("test")

111 .
	`£tS”Ÿliz”
(
cu¡omS”Ÿliz”
)

112 .
	`İ’
();

114 
‹¡
.
	`put
("a", "b");

115 
‹¡
.
	`g‘
("a");

116 
	`as£¹Th©
(
‹¡
.
	`g‘
("a")).
	`isEqu®To
("b");

117 
	}
}

126 @
Te¡


127 
public
 
	$dÛsNÙRe£tS”Ÿliz”IfM­AÌ—dyExi¡s
(è
throws
 
Exû±iÚ
 {

128 
IS”Ÿliz”
 
cu¡omS”Ÿliz”
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
((
by‹
è(
S”Ÿliz”s
.
SYSTEM_SERIALIZERS_COUNT
 + 1));

129 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”
);

130 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

132 
M­
<
SŒšg
, SŒšg> 
‹¡
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

133 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

134 .
	`£tSŒ—mName
("test")

135 .
	`£tS”Ÿliz”
(
cu¡omS”Ÿliz”
)

136 .
	`İ’
();

138 
M­
<
SŒšg
, SŒšg> 
‹¡2
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

139 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

140 .
	`£tSŒ—mName
("test")

141 .
	`£tS”Ÿliz”
(
S”Ÿliz”s
.
	`g‘DeçuÉS”Ÿliz”
())

142 .
	`İ’
();

144 
ObjeùsV›w
.
ObjeùID
 
m­Id
 = 
Ãw
 ObjectsView.

145 
	`ObjeùID
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("‹¡"), 
CÜfuTabË
.
şass
);

147 
CÜfuCompeProxy
 
ı
 = ((CÜfuCompeProxyè((
ICÜfuSMR
è
r
.
	`g‘ObjeùsV›w
().

148 
	`g‘ObjeùCache
().

149 
	`g‘
(
m­Id
)).

150 
	`g‘CÜfuSMRProxy
());

152 
	`as£¹Th©
(
ı
.
	`g‘S”Ÿliz”
()).
	`isEqu®To
(
cu¡omS”Ÿliz”
);

153 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/CorfuSharedCounter.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

11 @
CÜfuObjeù


12 
public
 
şass
 
CÜfuSh¬edCouÁ”
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuSh¬edCouÁ”
> {

13 
	gv®ue
 = 0;

16 
public
 
CÜfuSh¬edCouÁ”
(
š™v®ue
è{ 
	gv®ue
 = initvalue; }

20 
public
 
CÜfuSh¬edCouÁ”
(è{ 
this
(0); }

22 @
AcûssÜ


23 
public
 
g‘V®ue
(è{  
	gv®ue
; }

25 @
MutÜ
(
Çme
 = "setValue")

26 
public
 
£tV®ue
(
ÃwV®ue
è{ 
v®ue
 =‚ewValue; }

28 @
MutÜAcûssÜ
(
Çme
 = "CAS")

29 
CAS
(
‹¡V®ue
, 
ÃwV®ue
) {

30 
	gcurV®ue
 = 
v®ue
;

31 ià(
	gcurV®ue
 =ğ
‹¡V®ue
)

32 
v®ue
 = 
ÃwV®ue
;

33  
	gcurV®ue
;

36 @
Ov”ride


37 
public
 
CÜfuSh¬edCouÁ”
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

38  
	gthis
;

	@test/src/test/java/org/corfudb/runtime/object/ObjectBuilderTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSMRObjeù
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gReæeùiÚUts
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

11 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

16 
public
 cÏs 
	cObjeùBud”Te¡
 {

18 
public
 
š‹rçû
 
	mBa£IÁ”çû
 { }

19 
public
 
š‹rçû
 
ChdIÁ”çû
 
ex‹nds
 
	gBa£IÁ”çû
 { }

21 şas 
	cChdIm¶
 
im¶em’ts
 
	gChdIÁ”çû
 { }

23 şas 
	cBa£
 { }

24 şas 
	cChd
 
ex‹nds
 
	gBa£
 { }

26 
public
 şas 
	cExam¶eIÁ”çû
 {

27 
public
 
Exam¶eIÁ”çû
(
ChdIÁ”çû
 
ba£
) {

31 
public
 
Exam¶eIÁ”çû
(
Ba£IÁ”çû
 
ba£
) {

32 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Not supposeo be called");

36 
public
 şas 
	cExam¶e
 {

37 
public
 
Exam¶e
() {

41 
public
 
Exam¶e
(
Ba£
 
ba£
) {

42 
throw
 
Ãw
 
IÎeg®S‹Exû±iÚ
("Not supposeo be called");

45 
public
 
Exam¶e
(
Chd
 
ba£
) {

50 @
Te¡


51 
public
 
	$‹¡ObjeùW™hInv®idSŒ—mId
() {

52 
CÜfuRuÁime
 
¹
 = 
Ãw
 
	`CÜfuRuÁime
();

53 
	`as£¹Th©ThrownBy
(() -> {

54 
SMRObjeù
.
	`bud”
()

55 .
	`ruÁime
(
¹
)

56 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

57 .
	`İ’
();

58 }).
	`isIn¡ªûOf
(
NuÎPoš‹rExû±iÚ
.
şass
)

59 .
	`hasMes§geS¹šgW™h
("streamID is marked‚on-null but is‚ull");

60 
	}
}

70 @
Te¡


71 
public
 
	$cÚ¡ruùÜM©chšg
()

72 
throws
 
IÎeg®AcûssExû±iÚ
, 
In¡ªtŸtiÚExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
 {

73 
Objeù
[] 
¬gs
 = { 
Ãw
 
	`Chd
() };

74 
ReæeùiÚUts
.
	`fšdM©chšgCÚ¡ruùÜ
(

75 
Exam¶e
.
şass
.
	`g‘Deş¬edCÚ¡ruùÜs
(), 
¬gs
);

76 
	}
}

86 @
Te¡


87 
public
 
	$cÚ¡ruùÜIÁ”çûM©chšg
()

88 
throws
 
IÎeg®AcûssExû±iÚ
, 
In¡ªtŸtiÚExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
 {

89 
Objeù
[] 
¬gs
 = { 
Ãw
 
	`ChdIm¶
() };

90 
ReæeùiÚUts
.
	`fšdM©chšgCÚ¡ruùÜ
(

91 
Exam¶eIÁ”çû
.
şass
.
	`g‘Deş¬edCÚ¡ruùÜs
(), 
¬gs
);

92 
	}
}

102 @
Te¡


103 
public
 
	$noArgeCÚ¡ruùÜM©ch
()

104 
throws
 
IÎeg®AcûssExû±iÚ
, 
In¡ªtŸtiÚExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
 {

105 
Objeù
[] 
¬gs
 = { };

106 
ReæeùiÚUts
.
	`fšdM©chšgCÚ¡ruùÜ
(

107 
Exam¶e
.
şass
.
	`g‘Deş¬edCÚ¡ruùÜs
(), 
¬gs
);

108 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/TestClass.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

9 @
CÜfuObjeù


10 
public
 
şass
 
Te¡CÏss
 
im¶em’ts
 
	gICÜfuSMR
<
	gTe¡CÏss
> {

11 
	g‹¡IÁ
;

13 @
MutÜ
(
Çme
="set")

14 
public
 
£t
(
toS‘
) {

15 
‹¡IÁ
 = 
toS‘
;

18 
public
 
g‘
() {

19  
	g‹¡IÁ
;

25 @
Ov”ride


26 
public
 
Te¡CÏss
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

27  
	gthis
;

	@test/src/test/java/org/corfudb/runtime/object/TestClassUsingAnnotation.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.*;

5 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

10 @
	$CÜfuObjeù
(
objeùTy³
 = 
ObjeùTy³
.
SMR
,

11 
cÚ¡ruùÜTy³
 = 
CÚ¡ruùÜTy³
.
RUNTIME
,

12 
¡©eSourû
 = 
S‹Sourû
.
SELF


14 
public
 
şass
 
Te¡CÏssUsšgAÂÙ©iÚ
 
im¶em’ts
 
ICÜfuSMR
<TestClassUsingAnnotation> {

16 
AtomicIÁeg”
 
a1
;

18 
public
 
	`Te¡CÏssUsšgAÂÙ©iÚ
() {

19 
a1
 = 
Ãw
 
	`AtomicIÁeg”
();

22 @
PassThrough


23 
public
 
boŞ—n
 
	`‹¡Fn1
() {

24  
Œue
;

27 @
	`MutÜAcûssÜ
(
Çme
 = "testIncrement")

28 
public
 
boŞ—n
 
	`‹¡Inüem’t
() {

29  
a1
.
	`šüem’tAndG‘
() != 0;

32 @
AcûssÜ


33 
public
 
	`g‘V®ue
() {

34  
a1
.
	`g‘
();

37 @
	`MutÜ
(
Çme
 = "reset")

38 
public
 
	`»£t
() {

39 
a1
.
	`£t
(0);

45 @
Ov”ride


46 
public
 
Te¡CÏssUsšgAÂÙ©iÚ
 
	`g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

47  
this
;

49 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/TransactionalObject.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÜfuObjeù
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gT¿n§ùiÚ®M‘hod
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
.
	gT¿n§ùiÚ®CÚ‹xt
;

11 @
CÜfuObjeù


12 
public
 
şass
 
T¿n§ùiÚ®Objeù
 
im¶em’ts
 
	gICÜfuSMR
<
	gT¿n§ùiÚ®Objeù
> {

13 @
	gT¿n§ùiÚ®M‘hod


14 @
AcûssÜ


15 
public
 
boŞ—n
 
isInNe¡edT¿n§ùiÚ
() {

16  
	gT¿n§ùiÚ®CÚ‹xt
.
isInNe¡edT¿n§ùiÚ
();

19 @
	gT¿n§ùiÚ®M‘hod


20 @
AcûssÜ


21 
public
 
boŞ—n
 
isInT¿n§ùiÚ
() {

22  
	gT¿n§ùiÚ®CÚ‹xt
.
isInT¿n§ùiÚ
();

25 @
	gT¿n§ùiÚ®M‘hod


26 @
AcûssÜ


27 
public
 
throwRuÁimeExû±iÚ
() {

28 
throw
 
Ãw
 
RuÁimeExû±iÚ
("Sneaky„untimeƒxception");

34 @
Ov”ride


35 
public
 
T¿n§ùiÚ®Objeù
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

36  
	gthis
;

	@test/src/test/java/org/corfudb/runtime/object/transactions/AbstractTransactionContextTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”A¼ay
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gICÜfuTabË
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuSh¬edCouÁ”
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

21 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùT¿n§ùiÚCÚ‹xtTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

23 
´Ùeùed
 
	mICÜfuTabË
<
	mSŒšg
, SŒšg> 
	m‹¡M­
;

25 @
BefÜe


26 
public
 
	$»£tM­
() {

27 
‹¡M­
 = 
nuÎ
;

30 
public
 
ICÜfuTabË
<
SŒšg
, SŒšg> 
	$g‘M­
() {

31 ià(
‹¡M­
 =ğ
nuÎ
) {

32 
‹¡M­
 = (
ICÜfuTabË
<
SŒšg
, SŒšg>è
	`š¡ªtŸ‹CÜfuObjeù
(

33 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {},

37  
‹¡M­
;

38 
	}
}

40 
SŒšg
 
	$put
(
SŒšg
 
key
, SŒšg 
v®ue
) {

41  
	`g‘M­
().
	`put
(
key
, 
v®ue
);

42 
	}
}

44 
SŒšg
 
	$g‘
(
SŒšg
 
key
) {

45  
	`g‘M­
().
	`g‘
(
key
);

46 
	}
}

49 
	$wr™e
(
SŒšg
 
key
, SŒšg 
v®ue
) {

50 
	`g‘M­
().
	`š£¹
(
key
, 
v®ue
);

51 
	}
}

55 
fš®
 
	gINITIAL
 = 32;

56 
fš®
 
	gOVERWRITE_ONCE
 = 33;

57 
fš®
 
	gOVERWRITE_TWICE
 = 34;

59 
	gnumTasks
;

60 
	gA¼ayLi¡
<
	gCÜfuSh¬edCouÁ”
> 
	gsh¬edCouÁ”s
;

61 
AtomicIÁeg”A¼ay
 
	gcomm™Stus
;

62 
fš®
 
	gCOMMITVALUE
 = 1;

63 
AtomicIÁeg”A¼ay
 
	g¢­Stus
;

68 
	$£tupCouÁ”s
() {

70 
numTasks
 = 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
;

71 
sh¬edCouÁ”s
 = 
Ãw
 
A¼ayLi¡
<>();

73 
i
 = 0; i < 
numTasks
; i++)

74 
sh¬edCouÁ”s
.
	`add
(
i
,

75 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuSh¬edCouÁ”
.
şass
, "‹¡"+
i
)

79 
i
 = 0; i < 
numTasks
; i++)

80 
sh¬edCouÁ”s
.
	`g‘
(
i
).
	`£tV®ue
(
INITIAL
);

82 
comm™Stus
 = 
Ãw
 
	`AtomicIÁeg”A¼ay
(
numTasks
);

83 
¢­Stus
 = 
Ãw
 
	`AtomicIÁeg”A¼ay
(
numTasks
);

84 
	}
}

90 @
Te¡


91 
public
 
	$’su»Em±yWr™eS‘IsNÙWr™‹n
() {

92 
	`TXBegš
();

93 
»suÉ
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

94 
ILogD©a
 
ld
 =

95 
	`g‘RuÁime
()

96 .
	`g‘Add»ssS·ûV›w
()

97 .
	`³ek
(0);

98 
	`as£¹Th©
(
ld
)

99 .
	`isNuÎ
();

101 
	`as£¹Th©
(
»suÉ
)

102 .
	`isEqu®To
(
Ab¡¿ùT¿n§ùiÚ®CÚ‹xt
.
NOWRITE_ADDRESS
);

103 
	}
}

105 @
Te¡


106 
public
 
	$’su»U£rTsIsInh”™ed
() {

107 
Tok’Re¥Ú£
 
»¥
 = 
	`g‘RuÁime
().
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

108 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
»¥
, "d©a".
	`g‘By‹s
());

110 
fš®
 
Tok’
 
·»ÁTs
 = 
»¥
.
	`g‘Tok’
();

112 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

113 .
	`¢­shÙ
(
·»ÁTs
)

114 .
	`bud
()

115 .
	`begš
();

116 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

117 .
	`bud
()

118 .
	`begš
();

122 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt


123 .
	`g‘Cu¼’tCÚ‹xt
()

124 .
	`g‘SÇpshÙTime¡amp
())

125 .
	`isEqu®To
(
·»ÁTs
);

126 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

127 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt


128 .
	`g‘Cu¼’tCÚ‹xt
()

129 .
	`g‘SÇpshÙTime¡amp
())

130 .
	`isEqu®To
(
·»ÁTs
);

131 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

132 
	}
}

134 @
Te¡


135 
public
 
	$’su»TsIsS‘FromTa
() {

136 
fš®
 
numTok’s
 = 5;

137 
fš®
 
ÃwTa
 = 
numTok’s
 - 1;

139 
x
 = 0; x < 
numTok’s
; x++) {

140 
	`g‘RuÁime
().
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

143 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

144 .
	`bud
()

145 .
	`begš
();

146 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

147 .
	`bud
()

148 .
	`begš
();

152 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt


153 .
	`g‘Cu¼’tCÚ‹xt
()

154 .
	`g‘SÇpshÙTime¡amp
().
	`g‘Sequ’û
())

155 .
	`isEqu®To
(
ÃwTa
);

156 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

157 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt


158 .
	`g‘Cu¼’tCÚ‹xt
()

159 .
	`g‘SÇpshÙTime¡amp
().
	`g‘Sequ’û
())

160 .
	`isEqu®To
(
ÃwTa
);

161 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

162 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/AbstractTransactionsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gAb¡¿ùObjeùTe¡
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùT¿n§ùiÚsTe¡
 
ex‹nds
 
	mAb¡¿ùObjeùTe¡
 {

15 @
BefÜe


16 
public
 
	$becomeCÜfuAµ
() {

17 
	`g‘DeçuÉRuÁime
();

24 
public
 
ab¡¿ù
 
	`TXBegš
();

29 
´Ùeùed
 
	$TXEnd
() {

30  
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

31 
	}
}

34 
´Ùeùed
 
	$TXAbÜt
() {

35 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

36 
	}
}

41 
´Ùeùed
 
	$O±imi¡icTXBegš
() {

42 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

43 .
	`ty³
(
T¿n§ùiÚTy³
.
OPTIMISTIC
)

44 .
	`bud
()

45 .
	`begš
();

46 
	}
}

51 
´Ùeùed
 
	$SÇpshÙTXBegš
() {

53 
Tok’
 
t2
 = 
Ãw
 
	`Tok’
(0l, 2l);

54 
Tok’Re¥Ú£
 
s2
 = 
Ãw
 
	`Tok’Re¥Ú£
(
t2
, 
CŞËùiÚs
.
	`em±yM­
());

56 ià(
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`³ek
(
t2
.
	`g‘Sequ’û
()è=ğ
nuÎ
) {

57 
by‹
[] 
d©a
 = "d©a".
	`g‘By‹s
();

58 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
s2
, 
d©a
);

61 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

62 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

63 .
	`¢­shÙ
(
Ãw
 
	`Tok’
(0L, 2L))

64 .
	`bud
()

65 .
	`begš
();

66 
	}
}

71 
´Ùeùed
 
	$WWTXBegš
() {

72 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

73 .
	`ty³
(
T¿n§ùiÚTy³
.
WRITE_AFTER_WRITE
)

74 .
	`bud
()

75 .
	`begš
();

76 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/ImplicitTransactionsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gT¿n§ùiÚ®Objeù
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

7 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

12 
public
 cÏs 
	cIm¶ic™T¿n§ùiÚsTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
{

14 @
Ov”ride


15 
public
 
	$TXBegš
() {

16 
	`O±imi¡icTXBegš
();

27 @
Te¡


28 
public
 
	$im¶ic™T¿n§ùiÚ®M‘hodA»NÙNe¡ed
(è
throws
 
Exû±iÚ
 {

29 
T¿n§ùiÚ®Objeù
 
to
 = 
	`g‘DeçuÉRuÁime
()

30 .
	`g‘ObjeùsV›w
().
	`bud
()

31 .
	`£tSŒ—mName
("my stream")

32 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
T¿n§ùiÚ®Objeù
>() {

34 .
	`İ’
();

36 
	`TXBegš
();

37 
	`as£¹Th©
(
to
.
	`isInT¿n§ùiÚ
()).
	`isTrue
();

38 
	`as£¹Th©
(
to
.
	`isInNe¡edT¿n§ùiÚ
()).
	`isF®£
();

39 
	`TXEnd
();

40 
	}
}

48 @
Te¡


49 
public
 
	$im¶ic™T¿n§ùiÚ®M‘hodIsInT¿n§ùiÚ
(è
throws
 
Exû±iÚ
 {

50 
T¿n§ùiÚ®Objeù
 
to
 = 
	`g‘DeçuÉRuÁime
()

51 .
	`g‘ObjeùsV›w
().
	`bud
()

52 .
	`£tSŒ—mName
("my stream")

53 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
T¿n§ùiÚ®Objeù
>() {

55 .
	`İ’
();

57 
	`as£¹Th©
(
to
.
	`isInT¿n§ùiÚ
()).
	`isTrue
();

58 
	}
}

64 @
Te¡


65 
public
 
	$ruÁimeExû±iÚAbÜtNe¡edT¿n§ùiÚ
(è
throws
 
Exû±iÚ
 {

66 
T¿n§ùiÚ®Objeù
 
to
 = 
	`g‘DeçuÉRuÁime
()

67 .
	`g‘ObjeùsV›w
().
	`bud
()

68 .
	`£tSŒ—mName
("my stream")

69 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
T¿n§ùiÚ®Objeù
>() {

71 .
	`İ’
();

73 
	`TXBegš
();

74 
Œy
 {

75 
to
.
	`throwRuÁimeExû±iÚ
();

76 
	`TXEnd
();

77 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

78 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt
.
	`isInT¿n§ùiÚ
()).
	`isF®£
();

80 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/OptimisticTXConcurrencyTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

17 
public
 cÏs 
	cO±imi¡icTXCÚcu¼’cyTe¡
 
ex‹nds
 
	mTXCÚæiùSûÇriosTe¡
 {

18 @
Ov”ride


19 
public
 
	$TXBegš
(è{ 
	`O±imi¡icTXBegš
(); }

23 
public
 
	$‹¡O·c™yO±imi¡ic
(
boŞ—n
 
isIÁ”Ëaved
è
throws
 
Exû±iÚ
 {

25 
	`‹¡O·c™y
(
isIÁ”Ëaved
);

28 
sk_num
 = 0;ask_num < 
numTasks
;ask_num++) {

29 ià(
comm™Stus
.
	`g‘
(
sk_num
è!ğ
COMMITVALUE
) {

30 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
((
sk_num
 + 1è% 
numTasks
).
	`g‘V®ue
())

31 .
	`isNÙEqu®To
(
¢­Stus
.
	`g‘
(
sk_num
));

32 
	`as£¹Th©
(
comm™Stus
.
	`g‘
((
sk_num
 + 1è% 
numTasks
))

33 .
	`isEqu®To
(
COMMITVALUE
);

36 
	}
}

38 @
Te¡


39 
public
 
	$‹¡O·c™yIÁ”Ëaved
(è
throws
 
Exû±iÚ
 {

41 
	`‹¡O·c™yO±imi¡ic
(
Œue
);

42 
	}
}

44 @
Te¡


45 
public
 
	$‹¡O·c™yTh»aded
(è
throws
 
Exû±iÚ
 {

47 
	`‹¡O·c™yO±imi¡ic
(
çl£
);

48 
	}
}

54 
public
 
	$‹¡O±imism
(
boŞ—n
 
‹¡IÁ”Ëaved
è
throws
 
Exû±iÚ
 {

56 
	`‹¡RWCÚæiùs
(
‹¡IÁ”Ëaved
);

59 
sk_num
 = 0;ask_num < 
numTasks
;ask_num++) {

60 ià(
comm™Stus
.
	`g‘
(
sk_num
è!ğ
COMMITVALUE
)

61 
	`as£¹Th©
(
comm™Stus
.
	`g‘
((
sk_num
 + 1è% 
numTasks
è=ğ
COMMITVALUE
 ||

62 
comm™Stus
.
	`g‘
((
sk_num
 - 1è% 
numTasks
è=ğ
COMMITVALUE
)

63 .
	`isTrue
();

66 
	}
}

68 @
Te¡


69 
public
 
	$‹¡O±imismIÁ”Ëaved
(è
throws
 
Exû±iÚ
 {

70 
	`‹¡O±imism
(
Œue
);

71 
	}
}

73 @
Te¡


74 
public
 
	$‹¡O±imismTh»aded
(è
throws
 
Exû±iÚ
 {

75 
	`‹¡O±imism
(
çl£
);

76 
	}
}

78 @
Te¡


79 
public
 
	$‹¡NoWr™eCÚæiùSim¶eO±imi¡ic
(è
throws
 
Exû±iÚ
 {

80 
	`‹¡NoWr™eCÚæiùSim¶e
();

81 
	`as£¹Th©
(
comm™Stus
.
	`g‘
(0è=ğ
COMMITVALUE
 || commitStatus.get(1) == COMMITVALUE)

82 .
	`isTrue
();

83 
	}
}

85 @
Te¡


86 
public
 
	$‹¡AbÜtWWIÁ”Ëaved
()

87 
throws
 
Exû±iÚ


89 
	`cÚcu¼’tAbÜtTe¡
(
Œue
);

92 
	}
}

94 @
Te¡


95 
public
 
	$‹¡AbÜtWWTh»aded
()

96 
throws
 
Exû±iÚ


98 
	`cÚcu¼’tAbÜtTe¡
(
çl£
);

101 
	}
}

103 @
Te¡


104 
public
 
	$checkRŞlbackNe¡ed
(è
throws
 
Exû±iÚ
 {

105 
A¼ayLi¡
<
M­
> 
m­s
 = 
Ãw
 ArrayList<>();

107 
fš®
 
nm­s
 = 2;

108 
i
 = 0; i < 
nm­s
; i++)

109 
m­s
.
	`add
Ğ(
CÜfuTabË
<
IÁeg”
, 
SŒšg
>è
	`š¡ªtŸ‹CÜfuObjeù
(

110 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>(è{}, "‹¡ sŒ—m" + 
i
)

112 
fš®
 
key1
 = 1, 
key2
 = 2, 
key3
 = 3;

113 
fš®
 
SŒšg
 
t¡1
 = "foo", 
t¡2
 = "bar";

114 
fš®
 
nNe¡s
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
;

117 
	`t
(1, () -> {

118 
	`TXBegš
();

119 
m­s
.
	`g‘
(0).g‘(
key1
);

120 
m­s
.
	`g‘
(1).g‘(
key1
);

124 
	`t
(2, () -> {

125 
i
 = 0; i < 
nNe¡s
; i++) {

126 
	`TXBegš
();

127 
m­s
.
	`g‘
((
i
%
nm­s
)).
	`put
(
key1
, (˜%‚m­sè=ğ0 ? 
t¡1
 : 
t¡2
);

128 
m­s
.
	`g‘
((
i
%
nm­s
)).
	`put
(
key2
, (˜%‚m­sè=ğ0 ? 
t¡1
 : 
t¡2
);

129 
m­s
.
	`g‘
((
i
%
nm­s
)).
	`put
(
key3
, (˜%‚m­sè=ğ0 ? 
t¡1
 : 
t¡2
);

133 
	`t
(1, () -> {

134 
	`as£¹Th©
(
m­s
.
	`g‘
(0).g‘(
key1
))

135 .
	`isEqu®To
(
nuÎ
);

136 
	`as£¹Th©
(
m­s
.
	`g‘
(1).g‘(
key1
))

137 .
	`isEqu®To
(
nuÎ
);

140 
	}
}

146 @
Te¡


147 
public
 
	$cÚcu¼’tT¿n§ùiÚsNÚCÚæiùšgKeysSameHash
() {

149 
UUID
 
¡»amID
 = UUID.
	`äomSŒšg
("a0a6f485-db5c-33a2-92b2-a1edb188e5c7");

150 
UUID
 
key1
 = UUID.
	`äomSŒšg
("01003000-0000-0cb5-0000-000000000001");

151 
UUID
 
key2
 = UUID.
	`äomSŒšg
("01003000-0000-0cb6-0000-000000000002");

154 
	`as£¹Th©
(
key1
.
	`hashCode
()).
	`isEqu®To
(
key2
.hashCode());

156 
M­
<
UUID
, 
SŒšg
> 
m­Te¡
 = 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`bud
()

157 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
UUID
, 
SŒšg
>>() {})

158 .
	`£tSŒ—mID
(
¡»amID
)

159 .
	`İ’
();

160 
m­Te¡
.
	`ş—r
();

162 
	`t
(1, 
this
::
TXBegš
);

164 
	`t
(1, (è-> 
m­Te¡
.
	`put
(
key1
, "v1"));

166 
	`t
(2, 
this
::
TXBegš
);

167 
	`t
(2, (è-> 
m­Te¡
.
	`put
(
key2
, "v2"));

169 
	`t
(1, 
this
::
TXEnd
);

170 
	`t
(2, 
this
::
TXEnd
)

171 .
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

172 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/OptimisticTransactionContextTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÚæiùP¬am‘”CÏss
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gICÜfuHashabË
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

24 
impÜt
 
	gjava
.
	gnio
.
	gBy‹Bufãr
;

25 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

26 
impÜt
 
	gjava
.
	gut
.
	gM­
;

27 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

28 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

30 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

31 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©Code
;

36 
public
 cÏs 
	cO±imi¡icT¿n§ùiÚCÚ‹xtTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚCÚ‹xtTe¡
 {

37 @
Ov”ride


38 
public
 
	$TXBegš
() {

39 
	`O±imi¡icTXBegš
();

42 @
Te¡


43 
public
 
	$‹¡S·ÂšgT¿n§ùiÚ
() {

44 
UUID
 
¡»am1Id
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream1");

45 
ISŒ—mV›w
 
sv
 = 
	`g‘DeçuÉRuÁime
().
	`g‘SŒ—msV›w
().
	`g‘
(
¡»am1Id
);

47 
M­
<
SŒšg
, SŒšg> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

48 .
	`bud
()

49 .
	`£tSŒ—mName
("stream2")

50 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

51 .
	`İ’
();

53 
	`as£¹Th©
(
sv
.
	`»maššg
()).
	`isEm±y
();

54 
	`as£¹Th©
(
m­
).
	`isEm±y
();

56 
SMREÁry
 
smrEÁry1
 = 
Ãw
 
	`SMREÁry
("m‘hod",‚ew 
Objeù
[]{"¬g1"}, 
S”Ÿliz”s
.
PRIMITIVE
);

57 
SMREÁry
 
smrEÁry2
 = 
Ãw
 
	`SMREÁry
("m‘hod2",‚ew 
Objeù
[]{"¬g1"}, 
S”Ÿliz”s
.
PRIMITIVE
);

60 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

61 
m­
.
	`put
("k1", "v1");

62 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`logUpd©e
(
¡»am1Id
, 
smrEÁry1
);

63 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

65 
	`as£¹Th©
(
sv
.
	`»maššg
()).
	`isEm±y
();

66 
	`as£¹Th©
(
m­
).
	`isEm±y
();

68 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

69 
m­
.
	`put
("k1", "v1");

70 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`logUpd©e
(
¡»am1Id
, 
smrEÁry1
);

71 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

73 
MuÉiObjeùSMREÁry
 
ex³ùed
 = 
Ãw
 
	`MuÉiObjeùSMREÁry
();

74 
ex³ùed
.
	`addTo
(
¡»am1Id
, 
smrEÁry1
);

75 
MuÉiObjeùSMREÁry
 
comm™‹dMuÉiSMR
 = (MuÉiObjeùSMREÁryè
sv
.
	`»maššg
().
	`™”©Ü
().
	`Ãxt
().
	`g‘Paylßd
(
nuÎ
);

76 
comm™‹dMuÉiSMR
.
	`g‘SMRUpd©es
(
¡»am1Id
);

78 
	`as£¹Th©
(
comm™‹dMuÉiSMR
.
	`g‘SMRUpd©es
(
¡»am1Id
)).
	`cÚšsExaùly
(
smrEÁry1
);

79 
	`as£¹Th©
(
m­
).
	`hasSize
(1);

81 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

82 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

83 
	`t
(1, (è-> 
m­
.
	`put
("k2", "v2"));

84 
	`t
(2, (è-> 
m­
.
	`put
("k2", "v3"));

85 
	`t
(2, (è-> 
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`logUpd©e
(
¡»am1Id
, 
smrEÁry2
));

86 
	`t
(1, 
this
::
TXEnd
);

87 
	`t
(2, 
this
::
TXEnd
)

88 .
	`as£¹Throws
()

89 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

91 
	`as£¹Th©
(
m­
).
	`hasSize
(2);

92 
	`as£¹Th©
(
m­
).
	`cÚšsOÆyKeys
("k1", "k2");

93 
	`as£¹Th©
(
m­
).
	`cÚšsV®ues
("v1", "v2");

94 
	`as£¹Th©
(
sv
.
	`»maššg
()).
	`isEm±y
();

95 
	}
}

101 @
Te¡


102 
public
 
	$checkCÚæiùP¬am‘”s
() {

103 
CÚæiùP¬am‘”CÏss
 
‹¡Objeù
 = 
	`g‘DeçuÉRuÁime
()

104 .
	`g‘ObjeùsV›w
().
	`bud
()

105 .
	`£tSŒ—mName
("my stream")

106 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÚæiùP¬am‘”CÏss
>() {})

107 .
	`İ’
();

109 
fš®
 
SŒšg
 
TEST_0
 = "0";

110 
fš®
 
SŒšg
 
TEST_1
 = "1";

111 
fš®
 
TEST_2
 = 2;

112 
fš®
 
TEST_3
 = 3;

113 
fš®
 
SŒšg
 
TEST_4
 = "4";

114 
fš®
 
SŒšg
 
TEST_5
 = "5";

116 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

118 
‹¡Objeù
.
	`acûssÜTe¡
(
TEST_0
, 
TEST_1
);

120 
‹¡Objeù
.
	`mutÜTe¡
(
TEST_2
, 
TEST_3
);

122 
‹¡Objeù
.
	`mutÜAcûssÜTe¡
(
TEST_4
, 
TEST_5
);

125 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
()

126 .
	`g‘R—dS‘Info
().
	`g‘CÚæiùs
()

127 .
	`v®ues
()

128 .
	`¡»am
()

129 .
	`æ©M­
(
x
 -> x.
	`¡»am
())

130 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()))

131 .
	`cÚšs
(
TEST_0
, 
TEST_4
);

134 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
()

135 .
	`g‘R—dS‘Info
()

136 .
	`g‘CÚæiùs
().
	`v®ues
().
	`¡»am
()

137 .
	`æ©M­
(
x
 -> x.
	`¡»am
())

138 .
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()))

139 .
	`dÛsNÙCÚš
(
TEST_2
, 
TEST_3
, 
TEST_5
);

141 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

142 
	}
}

145 @
	gD©a


146 @
AÎArgsCÚ¡ruùÜ


147 şas 
	cCu¡omCÚæiùObjeù
 {

148 
fš®
 
SŒšg
 
	gk1
;

149 
fš®
 
SŒšg
 
	gk2
;

158 @
Te¡


159 
public
 
	$cu¡omCÚæiùObjeùsCÚæiùAbÜts
() {

160 
Cu¡omCÚæiùObjeù
 
c1
 = 
Ãw
 
	`Cu¡omCÚæiùObjeù
("a", "a");

161 
Cu¡omCÚæiùObjeù
 
c2
 = 
Ãw
 
	`Cu¡omCÚæiùObjeù
("a", "a");

163 
M­
<
Cu¡omCÚæiùObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

164 .
	`bud
()

165 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
Cu¡omCÚæiùObjeù
, 
SŒšg
>>() {

167 .
	`£tSŒ—mName
("test")

168 .
	`İ’
();

170 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

171 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

172 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

173 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

174 
	`t
(1, 
this
::
TXEnd
);

175 
	`t
(2, 
this
::
TXEnd
)

176 .
	`as£¹Throws
()

177 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

178 
	}
}

188 @
Te¡


189 
public
 
	$checkSlowWr™”TxAbÜtsOnHŞeFl
() {

194 
fš®
 
Du¿tiÚ
 
hŞeFlTimeout
 = Du¿tiÚ.
	`ofSecÚds
(1);

195 
UUID
 
¡»amID
 = UUID.
	`¿ndomUUID
();

196 
CÜfuRuÁime
 
¹Wr™”
 = 
	`g‘DeçuÉRuÁime
();

197 
CÜfuRuÁime
 
¹R—d”
 = 
	`g‘NewRuÁime
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

198 .
	`hŞeFlTimeout
(
hŞeFlTimeout
)

199 .
	`bud
())

200 .
	`·r£CÚfigu¿tiÚSŒšg
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
())

201 .
	`cÚÃù
();

203 
M­
<
SŒšg
, SŒšg> 
m­
 = 
¹Wr™”


204 .
	`g‘ObjeùsV›w
().
	`bud
()

205 .
	`£tSŒ—mID
(
¡»amID
)

206 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

207 .
	`İ’
();

209 
Te¡RuË
 
‹¡RuË
 = 
Ãw
 
	`Te¡RuË
()

210 .
	`m©ches
(
m
 -> {

211 ià(
m
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
WRITE
)) {

212 
¹R—d”
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amID
).
	`Ãxt
();

213  
Œue
;

215  
çl£
;

218 
	`addCl›ÁRuË
(
¹Wr™”
, 
‹¡RuË
);

220 
Œy
 {

221 
	`O±imi¡icTXBegš
();

222 
m­
.
	`put
("k1", "v1");

223 
	`TXEnd
();

224 
As£¹
.
	`ç
();

225 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

226 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
OVERWRITE
);

229 
	`as£¹Th©
(
m­
).
	`dÛsNÙCÚšKey
("k1");

230 
	}
}

237 @
Te¡


238 
public
 
	$checkSlowWr™”TxAbÜtsOnOv”wr™eDiffD©a
() {

239 
UUID
 
¡»amID
 = UUID.
	`¿ndomUUID
();

240 
CÜfuRuÁime
 
¹SlowWr™”
 = 
	`g‘DeçuÉRuÁime
();

241 
CÜfuRuÁime
 
¹IÁ”£ù
 = 
Ãw
 
	`CÜfuRuÁime
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
()).
	`cÚÃù
();

243 
M­
<
SŒšg
, SŒšg> 
m­
 = 
¹SlowWr™”


244 .
	`g‘ObjeùsV›w
().
	`bud
()

245 .
	`£tSŒ—mID
(
¡»amID
)

246 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

247 .
	`İ’
();

249 [] 
»Œy
 = 
Ãw
 [1];

250 
»Œy
[0] = 0;

252 
Te¡RuË
 
‹¡RuË
 = 
Ãw
 
	`Te¡RuË
()

253 .
	`m©ches
(
m
 -> {

254 ià(
m
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
WRITE
è&& 
»Œy
[0] < 
¹SlowWr™”
.
	`g‘P¬am‘”s
().
	`g‘Wr™eR‘ry
()) {

255 
¹IÁ”£ù
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’
(0, 
»Œy
[0]), "h–lØwÜld".
	`g‘By‹s
());

256 
»Œy
[0]++;

257  
Œue
;

259  
çl£
;

262 
	`addCl›ÁRuË
(
¹SlowWr™”
, 
‹¡RuË
);

264 
Œy
 {

265 
	`O±imi¡icTXBegš
();

266 
m­
.
	`put
("k2", "v2");

267 
	`TXEnd
();

268 
As£¹
.
	`ç
();

269 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

270 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
OVERWRITE
);

273 
	`as£¹Th©
(
m­
).
	`dÛsNÙCÚšKey
("k1");

274 
	}
}

282 @
Te¡


283 
public
 
	$checkSlowWr™”TxSucûedsOnSameD©aOv”wr™e
() {

284 
UUID
 
¡»amID
 = UUID.
	`¿ndomUUID
();

285 
CÜfuRuÁime
 
¹SlowWr™”
 = 
	`g‘DeçuÉRuÁime
();

286 
CÜfuRuÁime
 
¹Prİag©eWr™e
 = 
Ãw
 
	`CÜfuRuÁime
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
()).
	`cÚÃù
();

288 [] 
»Œy
 = 
Ãw
 [1];

289 
»Œy
[0] = 0;

291 
Te¡RuË
 
‹¡RuË
 = 
Ãw
 
	`Te¡RuË
()

292 .
	`m©ches
(
m
 -> {

293 ià(
m
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
WRITE
)) {

294 
¹Prİag©eWr™e
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’
(0, 0), "h–lØwÜld".
	`g‘By‹s
());

295 
»Œy
[0]++;

296  
Œue
;

298  
çl£
;

301 
	`addCl›ÁRuË
(
¹SlowWr™”
, 
‹¡RuË
);

303 
Œy
 {

304 
	`O±imi¡icTXBegš
();

305 
¹SlowWr™”
.
	`g‘SŒ—msV›w
().
	`­³nd
("h–lØwÜld".
	`g‘By‹s
(), 
nuÎ
, 
¡»amID
);

306 
	`TXEnd
();

307 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

308 
As£¹
.
	`ç
();

310 
	}
}

318 @
Te¡


319 
public
 
	$cu¡omCÚæiùObjeùsNoCÚæiùNoAbÜt
() {

320 
Cu¡omCÚæiùObjeù
 
c1
 = 
Ãw
 
	`Cu¡omCÚæiùObjeù
("a", "a");

321 
Cu¡omCÚæiùObjeù
 
c2
 = 
Ãw
 
	`Cu¡omCÚæiùObjeù
("a", "b");

323 
M­
<
Cu¡omCÚæiùObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

324 .
	`bud
()

325 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
Cu¡omCÚæiùObjeù
, 
SŒšg
>>() {

327 .
	`£tSŒ—mName
("test")

328 .
	`İ’
();

330 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

331 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

332 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

333 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

334 
	`t
(1, 
this
::
TXEnd
);

335 
	`t
(2, 
this
::
TXEnd
)

336 .
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

337 
	}
}

340 @
	gD©a


341 @
AÎArgsCÚ¡ruùÜ


342 şas 
	cCu¡omSameHashCÚæiùObjeù
 {

343 
fš®
 
SŒšg
 
	gk1
;

344 
fš®
 
SŒšg
 
	gk2
;

352 @
Te¡


353 
public
 
	$cu¡omSameHashAlwaysCÚæiùs
() {

355 
S”Ÿliz”s
.
	`g‘DeçuÉS”Ÿliz”
().
	`»gi¡”Cu¡omHash”
(
Cu¡omSameHashCÚæiùObjeù
.
şass
,

356 
o
 -> 
Ãw
 
by‹
[0]);

358 
Cu¡omSameHashCÚæiùObjeù
 
c1
 = 
Ãw
 
	`Cu¡omSameHashCÚæiùObjeù
("a", "a");

359 
Cu¡omSameHashCÚæiùObjeù
 
c2
 = 
Ãw
 
	`Cu¡omSameHashCÚæiùObjeù
("a", "b");

361 
M­
<
Cu¡omSameHashCÚæiùObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

362 .
	`bud
()

363 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
Cu¡omSameHashCÚæiùObjeù
, 
SŒšg
>>() {

365 .
	`£tSŒ—mName
("test")

366 .
	`İ’
();

368 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

369 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

370 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

371 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

372 
	`t
(1, 
this
::
TXEnd
);

373 
	`t
(2, 
this
::
TXEnd
)

374 .
	`as£¹Throws
()

375 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

376 
	}
}

378 @
	gD©a


379 @
AÎArgsCÚ¡ruùÜ


380 şas 
	cCu¡omHashCÚæiùObjeù
 {

381 
fš®
 
SŒšg
 
	gk1
;

382 
fš®
 
SŒšg
 
	gk2
;

391 @
Te¡


392 
public
 
	$cu¡omHasDÛsNÙCÚæiù
() {

395 
S”Ÿliz”s
.
	`g‘DeçuÉS”Ÿliz”
().
	`»gi¡”Cu¡omHash”
(
Cu¡omSameHashCÚæiùObjeù
.
şass
,

396 
o
 -> {

397 
By‹Bufãr
 
b
 = By‹Bufãr.
	`w¿p
(
Ãw
 
by‹
[
o
.
k1
.
	`Ëngth
(è+ o.
k2
.length()]);

398 
b
.
	`put
(
o
.
k1
.
	`g‘By‹s
());

399 
b
.
	`put
(
o
.
k2
.
	`g‘By‹s
());

400  
b
.
	`¬¿y
();

403 
Cu¡omHashCÚæiùObjeù
 
c1
 = 
Ãw
 
	`Cu¡omHashCÚæiùObjeù
("a", "a");

404 
Cu¡omHashCÚæiùObjeù
 
c2
 = 
Ãw
 
	`Cu¡omHashCÚæiùObjeù
("a", "b");

406 
M­
<
Cu¡omHashCÚæiùObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

407 .
	`bud
()

408 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
Cu¡omHashCÚæiùObjeù
, 
SŒšg
>>() {

410 .
	`£tSŒ—mName
("test")

411 .
	`İ’
();

413 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

414 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

415 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

416 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

417 
	`t
(1, 
this
::
TXEnd
);

418 
	`t
(2, 
this
::
TXEnd
)

419 .
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

420 
	}
}

422 @
	gD©a


423 @
AÎArgsCÚ¡ruùÜ


424 şas 
	cIHashAlwaysCÚæiùObjeù
 
im¶em’ts
 
	gICÜfuHashabË
 {

425 
fš®
 
SŒšg
 
	gk1
;

426 
fš®
 
SŒšg
 
	gk2
;

428 @
Ov”ride


429 
public
 
	gby‹
[] 
g’”©eCÜfuHash
() {

430  
Ãw
 
	gby‹
[0];

438 @
Te¡


439 
public
 
	$IHashAlwaysCÚæiùs
() {

440 
IHashAlwaysCÚæiùObjeù
 
c1
 = 
Ãw
 
	`IHashAlwaysCÚæiùObjeù
("a", "a");

441 
IHashAlwaysCÚæiùObjeù
 
c2
 = 
Ãw
 
	`IHashAlwaysCÚæiùObjeù
("a", "b");

443 
M­
<
IHashAlwaysCÚæiùObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

444 .
	`bud
()

445 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IHashAlwaysCÚæiùObjeù
, 
SŒšg
>>() {

447 .
	`£tSŒ—mName
("test")

448 .
	`İ’
();

450 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

451 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

452 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

453 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

454 
	`t
(1, 
this
::
TXEnd
);

455 
	`t
(2, 
this
::
TXEnd
)

456 .
	`as£¹Throws
()

457 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

458 
	}
}

461 @
	gD©a


462 @
AÎArgsCÚ¡ruùÜ


463 şas 
	cIHashCÚæiùObjeù
 
im¶em’ts
 
	gICÜfuHashabË
 {

464 
fš®
 
SŒšg
 
	gk1
;

465 
fš®
 
SŒšg
 
	gk2
;

467 @
Ov”ride


468 
public
 
	gby‹
[] 
g’”©eCÜfuHash
() {

469 
By‹Bufãr
 
	gb
 = By‹Bufãr.
w¿p
(
Ãw
 
by‹
[
k1
.
Ëngth
(è+ 
k2
.length()]);

470 
	gb
.
put
(
k1
.
g‘By‹s
());

471 
	gb
.
put
(
k2
.
g‘By‹s
());

472  
	gb
.
¬¿y
();

480 @
Te¡


481 
public
 
	$IHashNoCÚæiùs
() {

482 
IHashCÚæiùObjeù
 
c1
 = 
Ãw
 
	`IHashCÚæiùObjeù
("a", "a");

483 
IHashCÚæiùObjeù
 
c2
 = 
Ãw
 
	`IHashCÚæiùObjeù
("a", "b");

485 
M­
<
IHashCÚæiùObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

486 .
	`bud
()

487 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IHashCÚæiùObjeù
, 
SŒšg
>>() {

489 .
	`£tSŒ—mName
("test")

490 .
	`İ’
();

492 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

493 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

494 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

495 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

496 
	`t
(1, 
this
::
TXEnd
);

497 
	`t
(2, 
this
::
TXEnd
)

498 .
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

499 
	}
}

501 @
D©a


502 şas 
	cEx‹ndedIHashObjeù
 
ex‹nds
 
	gIHashCÚæiùObjeù
 {

504 
public
 
Ex‹ndedIHashObjeù
(
SŒšg
 
k1
, SŒšg 
k2
) {

505 
su³r
(
k1
, 
k2
);

511 
public
 
SŒšg
 
g‘K1K2
() {

512  
	gk1
 + 
	gk2
;

520 @
Te¡


521 
public
 
	$Ex‹ndedIHashNoCÚæiùs
() {

522 
Ex‹ndedIHashObjeù
 
c1
 = 
Ãw
 
	`Ex‹ndedIHashObjeù
("a", "a");

523 
Ex‹ndedIHashObjeù
 
c2
 = 
Ãw
 
	`Ex‹ndedIHashObjeù
("a", "b");

525 
M­
<
Ex‹ndedIHashObjeù
, 
SŒšg
> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

526 .
	`bud
()

527 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
Ex‹ndedIHashObjeù
, 
SŒšg
>>() {

529 .
	`£tSŒ—mName
("test")

530 .
	`İ’
();

532 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

533 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

534 
	`t
(1, (è-> 
m­
.
	`put
(
c1
, "v1"));

535 
	`t
(2, (è-> 
m­
.
	`put
(
c2
, "v2"));

536 
	`t
(1, 
this
::
TXEnd
);

537 
	`t
(2, 
this
::
TXEnd
)

538 .
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

539 
	}
}

545 @
Te¡


546 
public
 
	$»adOwnWr™es
() {

547 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

548 
	`t
(1, (è-> 
	`put
("k", "v"));

549 
	`t
(1, (è-> 
	`g‘
("k"))

550 .
	`as£¹ResuÉ
()

551 .
	`isEqu®To
("v");

552 
	`t
(1, 
this
::
TXEnd
);

553 
	}
}

559 @
Te¡


560 
public
 
	$Ùh”Th»adCªnÙR—dO±imi¡icWr™es
() {

561 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

562 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

565 
	`t
(1, (è-> 
	`put
("k", "v1"));

567 
	`t
(2, (è-> 
	`g‘
("k"))

568 .
	`as£¹ResuÉ
()

569 .
	`isNuÎ
();

572 
	`t
(2, (è-> 
	`put
("k", "v2"));

574 
	`t
(1, (è-> 
	`g‘
("k"))

575 .
	`as£¹ResuÉ
()

576 .
	`isNÙEqu®To
("v2");

577 
	}
}

583 @
Te¡


584 
public
 
	$modifyšgMuÉËKeysCau£sAbÜt
() {

586 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

587 
	`t
(1, (è-> 
	`put
("k1", "v1"));

588 
	`t
(1, (è-> 
	`put
("k2", "v2"));

591 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

592 
	`t
(2, (è-> 
	`put
("k1", "v3"));

593 
	`t
(2, 
this
::
TXEnd
);

596 
	`t
(1, 
this
::
TXEnd
)

597 .
	`as£¹Throws
()

598 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

599 
	}
}

605 @
Te¡


606 
public
 
	$O±imi¡icSŒ—mG‘Upd©edCÜ»ùlyW™hNe¡edT¿n§ùiÚ
() {

607 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

608 
	`t
(1, (è-> 
	`put
("k", "v0"));

611 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

612 
	`t
(1, (è-> 
	`g‘
("k"))

613 .
	`as£¹ResuÉ
()

614 .
	`isEqu®To
("v0");

615 
	`t
(1, (è-> 
	`put
("k", "v1"));

616 
	`t
(1, 
this
::
TXEnd
);

620 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

621 
	`t
(1, (è-> 
	`g‘
("k"))

622 .
	`as£¹ResuÉ
()

623 .
	`isEqu®To
("v1");

624 
	`t
(1, (è-> 
	`put
("k", "v2"));

625 
	`t
(1, 
this
::
TXEnd
);

628 
	`t
(1, (è-> 
	`g‘
("k"))

629 .
	`as£¹ResuÉ
()

630 .
	`isEqu®To
("v2");

631 
	`t
(1, 
this
::
TXEnd
);

632 
	`as£¹Th©
(
	`g‘M­
())

633 .
	`cÚšsEÁry
("k", "v2");

635 
	}
}

642 @
Te¡


643 
public
 
	$th»adShouldAbÜtAá”CÚæiù
() {

645 
	`t
(1, (è-> 
	`put
("k", "v0"));

646 
	`t
(1, (è-> 
	`put
("k1", "v1"));

647 
	`t
(1, (è-> 
	`put
("k2", "v2"));

649 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

650 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

651 
	`t
(1, (è-> 
	`g‘
("k"))

652 .
	`as£¹ResuÉ
()

653 .
	`isEqu®To
("v0");

654 
	`t
(2, (è-> 
	`g‘
("k"))

655 .
	`as£¹ResuÉ
()

656 .
	`isEqu®To
("v0");

658 
	`t
(1, (è-> 
	`put
("k", "v1"));

659 
	`t
(1, 
this
::
TXEnd
);

662 
	`t
(2, (è-> 
	`put
("k", "v2"));

663 
	`t
(2, 
this
::
TXEnd
)

664 .
	`as£¹Throws
()

665 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

668 
	`as£¹Th©
(
	`g‘M­
())

669 .
	`cÚšsEÁry
("k", "v1");

670 
	}
}

678 @
Te¡


679 
public
 
	$Ã¡edT¿n§ùiÚsHaveSameTy³
() {

680 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

681 
	`t
(1, 
this
::
WWTXBegš
).
	`as£¹Throws
().
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

682 
	`t
(1, 
this
::
SÇpshÙTXBegš
).
	`as£¹Throws
().
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

683 
	`t
(1, 
this
::
TXEnd
);

684 
	}
}

692 @
Te¡


693 
public
 
	$Ã¡edT¿n§ùiÚsCªBeR—dDuršgComm™
() {

695 
	`t
(1, (è-> 
	`put
("k", "v1"));

697 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

698 
	`t
(1, (è-> 
	`put
("k", "v2"))

699 .
	`as£¹ResuÉ
()

700 .
	`isEqu®To
("v1");

703 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

704 
	`t
(1, (è-> 
	`g‘
("k"))

705 .
	`as£¹ResuÉ
()

706 .
	`isEqu®To
("v2");

708 
	`t
(1, (è-> 
	`put
("k", "v3"))

709 .
	`as£¹ResuÉ
()

710 .
	`isEqu®To
("v2");

712 
	`t
(1, 
this
::
TXEnd
);

714 
	`t
(1, (è-> 
	`g‘
("k"))

715 .
	`as£¹ResuÉ
()

716 .
	`isEqu®To
("v3");

718 
	`t
(1, 
this
::
TXEnd
);

721 
	`as£¹Th©
(
	`g‘M­
())

722 .
	`cÚšsEÁry
("k", "v3");

723 
	}
}

729 @
Te¡


730 
public
 
	$Ã¡edT¿n§ùiÚsA»IsŞ©edAüossTh»ads
() {

732 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

733 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

735 
	`t
(1, (è-> 
	`put
("k", "v1"));

736 
	`t
(2, (è-> 
	`put
("k", "v2"));

738 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

739 
	`t
(2, 
this
::
O±imi¡icTXBegš
);

741 
	`t
(1, (è-> 
	`g‘
("k"))

742 .
	`as£¹ResuÉ
()

743 .
	`isEqu®To
("v1");

744 
	`t
(2, (è-> 
	`g‘
("k"))

745 .
	`as£¹ResuÉ
()

746 .
	`isEqu®To
("v2");

748 
	`t
(1, (è-> 
	`put
("k", "v3"));

749 
	`t
(2, (è-> 
	`put
("k", "v4"));

751 
	`t
(1, (è-> 
	`g‘
("k"))

752 .
	`as£¹ResuÉ
()

753 .
	`isEqu®To
("v3");

754 
	`t
(2, (è-> 
	`g‘
("k"))

755 .
	`as£¹ResuÉ
()

756 .
	`isEqu®To
("v4");

759 
	`t
(1, 
this
::
TXEnd
);

760 
	`t
(2, 
this
::
TXEnd
);

763 
	`t
(1, (è-> 
	`g‘
("k"))

764 .
	`as£¹ResuÉ
()

765 .
	`isEqu®To
("v3");

766 
	`t
(2, (è-> 
	`g‘
("k"))

767 .
	`as£¹ResuÉ
()

768 .
	`isEqu®To
("v4");

771 
	`t
(1, 
this
::
TXEnd
);

772 
	`t
(2, 
this
::
TXEnd
)

773 .
	`as£¹Throws
()

774 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

777 
	`as£¹Th©
(
	`g‘M­
())

778 .
	`cÚšsEÁry
("k", "v3")

779 .
	`dÛsNÙCÚšEÁry
("k", "v4");

780 
	}
}

787 @
Te¡


788 
public
 
	$Ã¡edT¿n§ùiÚCªBeAbÜ‹d
() {

789 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

790 
	`t
(1, (è-> 
	`put
("k", "v1"));

791 
	`t
(1, (è-> 
	`g‘
("k"))

792 .
	`as£¹ResuÉ
()

793 .
	`isEqu®To
("v1");

794 
	`t
(1, 
this
::
O±imi¡icTXBegš
);

795 
	`t
(1, (è-> 
	`put
("k", "v2"));

796 
	`t
(1, (è-> 
	`g‘
("k"))

797 .
	`as£¹ResuÉ
()

798 .
	`isEqu®To
("v2");

799 
	`t
(1, 
this
::
TXAbÜt
);

800 
	`t
(1, (è-> 
	`g‘
("k"))

801 .
	`as£¹ResuÉ
()

802 .
	`isEqu®To
("v1");

803 
	`t
(1, 
this
::
TXEnd
);

804 
	`as£¹Th©
(
	`g‘M­
())

805 .
	`cÚšsEÁry
("k", "v1");

806 
	}
}

813 @
Te¡


814 
public
 
	$wr™eOÆyT¿n§ùiÚComm™sInMemÜy
() {

816 
	`O±imi¡icTXBegš
();

817 
	`wr™e
("k", "v1");

818 
	`wr™e
("k", "v2");

819 
	`TXEnd
();

823 
	`as£¹Th©
(
	`g‘M­
())

824 .
	`cÚšsEÁry
("k", "v2");

825 
	}
}

841 @
Te¡


842 
public
 
	$cŞlide16B™
(è
throws
 
Exû±iÚ
 {

843 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

844 
M­
<
SŒšg
, SŒšg> 
m1
 = 
¹
.
	`g‘ObjeùsV›w
()

845 .
	`bud
()

846 .
	`£tSŒ—mName
("test-1")

847 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

849 .
	`İ’
();

851 
M­
<
SŒšg
, SŒšg> 
m2
 = 
¹
.
	`g‘ObjeùsV›w
()

852 .
	`bud
()

853 .
	`£tSŒ—mName
("test-2")

854 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

856 .
	`İ’
();

858 
	`t1
((è-> 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
());

859 
	`t2
((è-> 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
());

860 
	`t1
((è-> 
m1
.
	`put
("azusavnj", "1"));

861 
	`t2
((è-> 
m2
.
	`put
("ajkenmbb", "2"));

862 
	`t1
((è-> 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
());

863 
	`t2
((è-> 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
())

864 .
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

865 
	}
}

875 @
Te¡


876 
public
 
	$txnS·nsEpochsCªComm™IfPrim¬ySequ’ûrS·nsCÚ£cutiveEpochs
(è
throws
 
Exû±iÚ
 {

877 
	`t1
(
this
::
O±imi¡icTXBegš
);

878 
	`t2
(
this
::
O±imi¡icTXBegš
);

879 
	`t1
((è-> 
	`wr™e
("k1", "v1"));

880 
	`t2
((è-> 
	`wr™e
("k2", "v2"));

883 
	`t1
((è-> 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`g‘SÇpshÙTime¡amp
().
	`g‘Epoch
()).
	`isEqu®To
(0L));

884 
	`t2
((è-> 
	`as£¹Th©
(
T¿n§ùiÚ®CÚ‹xt
.
	`g‘Cu¼’tCÚ‹xt
().
	`g‘SÇpshÙTime¡amp
().
	`g‘Epoch
()).
	`isEqu®To
(0L));

886 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

888 
Layout
 
Ïyout
 = 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
();

889 
Layout
 
ÃwLayout1
 = 
Ãw
 
	`Layout
(
Ïyout
);

890 
ÃwLayout1
.
	`ÃxtEpoch
();

892 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

895 
¹
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout1
).
	`£®MšS”v”S‘
();

896 
¹
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
ÃwLayout1
, 1L);

897 
¹
.
	`g‘LayoutMªagem’tV›w
().
	`»cÚfigu»Sequ’ûrS”v”s
(
Ïyout
, 
ÃwLayout1
, 
çl£
);

899 
	`as£¹Th©
(
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
).
	`g‘Sequ’ûrEpoch
()).
	`isEqu®To
(
ÃwLayout1
.
	`g‘Epoch
());

900 
	`as£¹Th©
(
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
).
	`g‘EpochRªgeLow”Bound
()).
	`isEqu®To
(
Ïyout
.
	`g‘Epoch
());

903 
	`t1
(
this
::
TXEnd
).
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

905 
Layout
 
ÃwLayout2
 = 
Ãw
 
	`Layout
(
ÃwLayout1
);

906 
ÃwLayout2
.
	`ÃxtEpoch
();

909 
¹
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout2
).
	`£®MšS”v”S‘
();

910 
¹
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
ÃwLayout2
, 1L);

911 
¹
.
	`šv®id©eLayout
();

913 
ÃwLayout2
.
	`ÃxtEpoch
();

914 
¹
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout2
).
	`£®MšS”v”S‘
();

915 
¹
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
ÃwLayout2
, 1L);

918 
¹
.
	`g‘LayoutMªagem’tV›w
().
	`»cÚfigu»Sequ’ûrS”v”s
(
ÃwLayout1
, 
ÃwLayout2
, 
Œue
);

920 
	`as£¹Th©
(
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
).
	`g‘Sequ’ûrEpoch
()).
	`isEqu®To
(
ÃwLayout2
.
	`g‘Epoch
());

921 
	`as£¹Th©
(
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
).
	`g‘EpochRªgeLow”Bound
()).
	`isEqu®To
(
ÃwLayout2
.
	`g‘Epoch
());

924 
	`t2
(
this
::
TXEnd
).
	`as£¹Throws
().
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

925 
	}
}

932 @
Te¡


933 
public
 
	$txnCªComm™IfOv”wr™‹nAndR‘ry
(è
throws
 
Exû±iÚ
 {

935 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘RuÁime
().
	`g‘P¬am‘”s
())

936 .
	`·r£CÚfigu¿tiÚSŒšg
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
());

937 
¹
.
	`cÚÃù
();

939 
	`O±imi¡icTXBegš
();

941 
	`put
("k1", "v1");

942 
	`put
("k2", "v2");

946 
cu¼’tTa
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Sequ’û
();

947 
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
cu¼’tTa
 + 1);

949 
	`as£¹Th©Code
(
this
::
TXEnd
).
	`dÛsNÙThrowAnyExû±iÚ
();

951 
	`as£¹Th©
(
¹
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Sequ’û
()).
	`isEqu®To
(
cu¼’tTa
 + 2);

952 
	`as£¹Th©
(
	`g‘
("k1")).
	`isEqu®To
("v1");

953 
	`as£¹Th©
(
	`g‘
("k2")).
	`isEqu®To
("v2");

954 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/SequencerServerCacheTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gCacheWr™”
;

6 
impÜt
 
	gcom
.
	gg™hub
.
	gb’mªes
.
	gÿfãše
.
	gÿche
.
	gRemov®Cau£
;

7 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

8 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”Cache
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”Cache
.
	gCÚæiùTxSŒ—m
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gAb¡¿ùObjeùTe¡
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

17 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

18 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNuÎabË
;

19 
impÜt
 
	gjava
.
	gut
.
	gM­
;

20 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

26 @
Slf4j


27 
public
 cÏs 
	cSequ’ûrS”v”CacheTe¡
 
ex‹nds
 
	mAb¡¿ùObjeùTe¡
 {

29 @
Te¡


30 
public
 
	$‹¡Sequ’ûrCacheTrim
() {

32 
	`g‘DeçuÉRuÁime
();

34 
M­
<
IÁeg”
, IÁeg”> 
m­
 = 
	`g‘DeçuÉRuÁime
()

35 .
	`g‘ObjeùsV›w
()

36 .
	`bud
()

37 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {

39 .
	`£tSŒ—mName
("test")

40 .
	`İ’
();

42 
fš®
 
numTxn
 = 500;

43 
fš®
 
Tok’
 
ŒimAdd»ss
 = 
Ãw
 
	`Tok’
(
	`g‘DeçuÉRuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 250);

44 
x
 = 0; x < 
numTxn
; x++) {

45 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

46 
m­
.
	`put
(
x
, x);

47 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

50 
Sequ’ûrS”v”
 
£qu’ûrS”v”
 = 
	`g‘Sequ’ûr
(0);

51 
Sequ’ûrS”v”Cache
 
ÿche
 = 
£qu’ûrS”v”
.
	`g‘Cache
();

52 
	`as£¹Th©
(
ÿche
.
	`size
()).
	`isEqu®To
(
numTxn
);

53 
	`g‘DeçuÉRuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimAdd»ss
);

57 
	`g‘DeçuÉRuÁime
().
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

58 .
	`g‘Prim¬ySequ’ûrCl›Á
()

59 .
	`ŒimCache
(
ŒimAdd»ss
.
	`g‘Sequ’û
()).
	`još
();

60 
	`as£¹Th©
(
ÿche
.
	`size
()).
	`isEqu®To
((è
ŒimAdd»ss
.
	`g‘Sequ’û
());

67 @
Te¡


68 
public
 
	$‹¡Cache
() {

69 
fš®
 
AtomicBoŞ—n
 
ü™iÿlV¬ŸbË
 = 
Ãw
 
	`AtomicBoŞ—n
();

71 
Sequ’ûrS”v”Cache
 
ÿche
 = 
Ãw
 
	`Sequ’ûrS”v”Cache
(1,‚ew 
CacheWr™”
<
CÚæiùTxSŒ—m
, 
LÚg
>() {

72 @
Ov”ride


73 
public
 
	`wr™e
(@
NÚnuÎ
 
CÚæiùTxSŒ—m
 
key
, @NÚnuÎ 
LÚg
 
v®ue
) {

74 
log
.
	`šfo
("Wr™e: [{}, {}]. Th»ad: {}", 
key
, 
v®ue
, 
Th»ad
.
	`cu¼’tTh»ad
().
	`g‘Name
());

77 @
Ov”ride


78 
public
 
	`d–‘e
(@
NÚnuÎ
 
CÚæiùTxSŒ—m
 
key
, @
NuÎabË
 
LÚg
 
v®ue
, @NÚnuÎ 
Remov®Cau£
 
ÿu£
) {

79 
log
.
	`šfo
("D–‘»cÜd: {}. Th»ad: {}", 
key
, 
Th»ad
.
	`cu¼’tTh»ad
().
	`g‘Name
());

80 
ü™iÿlV¬ŸbË
.
	`£t
(
Œue
);

84 
fš®
 
CÚæiùTxSŒ—m
 
fœ¡Key
 = 
Ãw
 
	`CÚæiùTxSŒ—m
(
UUID
.
	`¿ndomUUID
(),‚ew 
by‹
[]{});

85 
fš®
 
CÚæiùTxSŒ—m
 
£cÚdKey
 = 
Ãw
 
	`CÚæiùTxSŒ—m
(
UUID
.
	`¿ndomUUID
(),‚ew 
by‹
[]{});

86 
fš®
 
fœ¡V®ue
 = 1L;

87 
fš®
 
£cÚdV®ue
 = 2L;

88 
fš®
 
™”©iÚs
 = 10;

90 
i
 = 0; i < 
™”©iÚs
; i++) {

91 
ü™iÿlV¬ŸbË
.
	`£t
(
çl£
);

93 
ÿche
.
	`put
(
fœ¡Key
, 
fœ¡V®ue
);

94 
ÿche
.
	`put
(
£cÚdKey
, 
£cÚdV®ue
);

96 
	`as£¹Th©
(
ÿche
.
	`size
()).
	`isOÃ
();

97 
	`as£¹Th©
(
ÿche
.
	`g‘IfP»£Á
(
fœ¡Key
)).
	`isNuÎ
();

99 
ÿche
.
	`šv®id©eAÎ
();

100 
	`as£¹Th©
(
ÿche
.
	`size
()).
	`isZ”o
();

102 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/SnapshotTransactionContextTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
public
 cÏs 
	cSÇpshÙT¿n§ùiÚCÚ‹xtTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚCÚ‹xtTe¡
 {

11 @
Ov”ride


12 
public
 
	$TXBegš
(è{ 
	`SÇpshÙTXBegš
(); }

15 @
Te¡


16 
public
 
	$deçuÉSÇpshÙTe¡
() {

17 
	`t1
((è-> 
	`put
("k" , "v1"));

18 
	`t1
((è-> 
	`put
("k" , "v2"));

21 
	`t2
((è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBud
()

22 .
	`ty³
(
T¿n§ùiÚTy³
.
SNAPSHOT
)

23 .
	`bud
()

24 .
	`begš
());

27 
	`t2
((è-> 
	`g‘
("k")).
	`as£¹ResuÉ
().
	`isEqu®To
("v2");

28 
	`t2
((è-> 
	`TXEnd
());

29 
	}
}

34 @
Te¡


35 
public
 
	$¢­shÙR—dabË
() {

37 
	`t
(1, (è-> 
	`put
("k" , "v1"));

38 
	`t
(1, (è-> 
	`put
("k" , "v2"));

39 
	`t
(1, (è-> 
	`put
("k" , "v3"));

40 
	`t
(1, (è-> 
	`put
("k" , "v4"));

42 
	`t
(1, 
this
::
SÇpshÙTXBegš
);

43 
	`t
(1, (è-> 
	`g‘
("k"))

44 .
	`as£¹ResuÉ
().
	`isEqu®To
("v3");

45 
	`t
(1, 
this
::
TXEnd
);

46 
	}
}

51 @
Te¡


52 
public
 
	$¢­shÙR—dabËW™hCÚcu¼’tWr™es
() {

54 
	`t1
((è-> 
	`put
("k" , "v1"));

55 
	`t2
((è-> 
	`put
("k" , "v2"));

56 
	`t3
((è-> 
	`put
("k" , "v3"));

57 
	`t4
((è-> 
	`put
("k" , "v4"));

59 
	`t2
(
this
::
SÇpshÙTXBegš
);

60 
	`t2
((è-> 
	`g‘
("k"))

61 .
	`as£¹ResuÉ
().
	`isEqu®To
("v3");

62 
	`t4
((è-> 
	`put
("k" , "v4"));

63 
	`t2
((è-> 
	`g‘
("k"))

64 .
	`as£¹ResuÉ
().
	`isEqu®To
("v3");

65 
	`t2
(
this
::
TXEnd
);

66 
	}
}

69 @
Te¡


70 
public
 
	$‹¡SÇpshÙTxNe¡edIm¶ic™Tx
() {

71 
CÜfuTabË
<
SŒšg
, 
IÁeg”
> 
m­
 = (CorfuTable<String, Integer>)

72 
	`š¡ªtŸ‹CÜfuObjeù
(

73 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {

77 
	`t
(0, (è-> 
m­
.
	`put
("a", 1));

78 
	`t
(0, (è-> 
m­
.
	`put
("b", 1));

79 
	`t
(0, 
this
::
SÇpshÙTXBegš
);

80 
	`t
(0, (è-> 
m­
.
	`fÜEach
((
k
,
v
) ->{

83 
	`t
(0, (è-> 
	`TXEnd
());

84 
	}
}

87 @
Te¡


88 
public
 
	$‹¡SÇpshÙTxNe¡edEx¶ic™Tx
() {

89 
CÜfuTabË
<
SŒšg
, 
IÁeg”
> 
m­
 = (CorfuTable<String, Integer>)

90 
	`š¡ªtŸ‹CÜfuObjeù
(

91 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
>>() {

95 
	`t
(0, (è-> 
m­
.
	`put
("a", 1));

96 
	`t
(0, (è-> 
m­
.
	`put
("b", 1));

97 
	`t
(0, 
this
::
SÇpshÙTXBegš
);

99 
	`t
(0, 
this
::
TXBegš
);

100 
	`t
(0, (è-> 
m­
.
	`fÜEach
((
k
,
v
) ->{

103 
	`t
(0, 
this
::
TXEnd
);

104 
	`t
(0, 
this
::
TXEnd
);

106 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/StreamTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

8 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gICÜfuTabË
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒšgIndex”
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAµ’dExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

22 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

32 
public
 cÏs 
	cSŒ—mTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

33 @
Ov”ride


34 
public
 
	$TXBegš
(è{ 
	`O±imi¡icTXBegš
(); }

41 
ICÜfuTabË
<
SŒšg
, 
IÁeg”
> 
m­1
, 
m­2
, 
m­3
;

43 
´iv©e
 
fš®
 
NUM_BATCHES
 = 3;

44 
´iv©e
 
fš®
 
BATCH_SZ
 = 1
_0
;

45 
´iv©e
 
fš®
 
numTasks
 = 
NUM_BATCHES
 * 
BATCH_SZ
;

50 
´iv©e
 
fš®
 
SEED
 = 434343;

51 
Rªdom
 
¿nd
 = 
Ãw
 
	`Rªdom
(
SEED
);

53 
´iv©e
 
fš®
 
READ_PERCENT
 = 80;

54 
´iv©e
 
fš®
 
MAX_PERCENT
 = 100;

56 
´iv©e
 
Tok’
 
	$g‘TrimM¬k
(
CÜfuRuÁime
 
¹
, 
£q
) {

57  
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
£q
);

58 
	}
}

60 @
Te¡


61 
public
 
	$‹¡Ov”Wr™eR‘ry
() {

62 
UUID
 
svId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream1");

63 
fš®
 
Tok’
 
ŒimM¬k
 = 
	`g‘TrimM¬k
(
	`g‘RuÁime
(), g‘RuÁime().
	`g‘P¬am‘”s
().
	`g‘Wr™eR‘ry
() - 1);

64 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimM¬k
);

65 
fš®
 
·ylßdSize
 = 100;

66 
	`as£¹Th©ThrownBy
((è-> 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`­³nd
(

67 
Ãw
 
by‹
[
·ylßdSize
], 
nuÎ
, 
svId
))

68 .
	`isIn¡ªûOf
(
Aµ’dExû±iÚ
.
şass
);

69 
	}
}

71 @
Te¡


72 
public
 
	$‹¡Backpoš‹rsSvOv”wr™eR‘ry
() {

73 
UUID
 
svId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream1");

74 
fš®
 
Tok’
 
ŒimM¬k
 = 
	`g‘TrimM¬k
(
	`g‘RuÁime
(), g‘RuÁime().
	`g‘P¬am‘”s
().
	`g‘Wr™eR‘ry
() - 1);

75 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimM¬k
);

76 
fš®
 
·ylßdSize
 = 100;

77 
ISŒ—mV›w
 
sv
 = 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘
(
svId
);

78 
	`as£¹Th©ThrownBy
((è-> 
sv
.
	`­³nd
(
Ãw
 
by‹
[
·ylßdSize
]))

79 .
	`isIn¡ªûOf
(
Aµ’dExû±iÚ
.
şass
);

80 
	}
}

82 @
Te¡


83 
public
 
	$‹¡TxnOv”wr™eR‘ry
(è
throws
 
Exû±iÚ
 {

84 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(CÜfuTabË.
şass
, "A");

85 
fš®
 
Tok’
 
ŒimM¬k
 = 
	`g‘TrimM¬k
(
	`g‘RuÁime
(), g‘RuÁime().
	`g‘P¬am‘”s
().
	`g‘Wr™eR‘ry
() - 1);

86 
fš®
 
SŒšg
 
key
 = "key";

87 
fš®
 
SŒšg
 
v®
 = "val";

88 
LogUn™Cl›Á
 
lu
 = 
	`g‘RuÁime
().
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

89 .
	`g‘LogUn™Cl›Á
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
());

90 
lu
.
	`´efixTrim
(
ŒimM¬k
).
	`g‘
();

91 
	`TXBegš
();

92 
m­
.
	`put
(
key
, 
v®
);

94 
	`as£¹Th©ThrownBy
((è->
	`TXEnd
())

95 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

96 
	}
}

98 @
Te¡


99 
public
 
	$£qu’ûrTrimTe¡
() {

101 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(CÜfuTabË.
şass
, "A");

102 
fš®
 
numEÁr›s
 = 10;

103 
	`TXBegš
();

104 
m­
.
	`g‘
("a");

105 
	`t2
(() -> {

106 
	`TXBegš
();

107 
x
 = 0; x < 
numEÁr›s
; x++) {

108 
m­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
x
), Integer.toString(x));

110 
	`TXEnd
();

113 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
	`g‘RuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 1);

114 
	`g‘RuÁime
().
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

116 
x
 = 0; x < 
numEÁr›s
; x++) {

117 
m­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
x
), Integer.toString(x));

120 
boŞ—n
 
abÜtExû±iÚ
 = 
çl£
;

122 
Œy
 {

123 
	`TXEnd
();

124 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

125 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
SEQUENCER_TRIM
);

126 
abÜtExû±iÚ
 = 
Œue
;

129 
	`as£¹Th©
(
abÜtExû±iÚ
).
	`isTrue
();

130 
	}
}

132 @
Te¡


133 
public
 
	$£qu’ûrOv”æowTe¡
() {

135 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(CÜfuTabË.
şass
, "A");

136 
fš®
 
numEÁr›s
 = 2000;

137 
boŞ—n
 
abÜtExû±iÚ
 = 
çl£
;

139 
Œy
 {

140 
	`TXBegš
();

141 
m­
.
	`put
("0", "0");

143 
	`t1
(() -> {

144 
x
 = 0; x < 
numEÁr›s
; x++) {

145 
	`TXBegš
();

146 
m­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
x
), Integer.toString(x));

147 
	`TXEnd
();

151 
	`TXEnd
();

152 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

153 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
SEQUENCER_OVERFLOW
);

154 
abÜtExû±iÚ
 = 
Œue
;

156 
	`as£¹Th©
(
abÜtExû±iÚ
).
	`isTrue
();

157 
	}
}

159 @
Te¡


160 
public
 
	$mixBackpoš‹rs
() {

161 
fš®
 
sm®lNumb”
 = 5;

166 
m­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "A"); m­1.
	`ş—r
();

167 
m­2
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "B"); m­2.
	`ş—r
();

168 
m­3
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "foo"); m­3.
	`ş—r
();

172 
	`WWTXBegš
();

173 
i
 = 0; i < 
sm®lNumb”
; i++) {

174 
m­1
.
	`put
("m1" + 
i
, i);

175 
m­2
.
	`put
("m2" + 
i
, i);

176 
m­3
.
	`put
("m3" + 
i
, i);

178 
	`TXEnd
();

181 
fš®
 
cÚcu¼’cy
 = 4;

183 
j
 = 0; j < 
cÚcu¼’cy
; j++)

184 
	`t
(
j
, () -> {

185 
	`WWTXBegš
();

188 
	`t
(
cÚcu¼’cy
, (è-> { 
	`WWTXBegš
(); 
m­2
.
	`put
("foo", 0); 
	`TXEnd
(); });

192 
j
 = 0; j < 
cÚcu¼’cy
; j++) {

193 
fš®
 
th»adNum
 = 
j
;

194 
	`t
(
th»adNum
, () -> {

195 
Œy
 {

196 
m­3
.
	`put
("b¬" + 
th»adNum
, 0);

197 
	`TXEnd
();

198 } 
	`ÿtch
 (
NuÎPoš‹rExû±iÚ
 
Ã
) {

199 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
();

203 
	}
}

208 
public
 
	$g’”©eM­s
() {

212 
m­1
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "A");

213 
m­2
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "B");

214 
m­3
 = 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuTabË
.
şass
, "foo");

217 
i
 = 0; i < 
NUM_BATCHES
; i++) {

218 
	`WWTXBegš
();

219 
j
 = 0; j < 
BATCH_SZ
; j++) {

220 
m­1
.
	`put
("m1" + (
i
 * 
BATCH_SZ
 + 
j
), i);

221 
m­2
.
	`put
("m2" + (
i
 * 
BATCH_SZ
 + 
j
), i);

222 
m­3
.
	`put
("m3" + (
i
 * 
BATCH_SZ
 + 
j
), i);

224 
	`TXEnd
();

226 
	}
}

235 
public
 
	$cÚcu¼’tSŒ—mRWLßd
(
ignÜedTh»adNum
, 
»adP”ûÁ
) {

236 
fš®
 
AtomicIÁeg”
 
abÜts
 = 
Ãw
 
	`AtomicIÁeg”
(0);

238 
i
 = 0; i < 
NUM_BATCHES
; i++) {

239 
fš®
 
fi
 = 
i
;

241 
	`addTe¡S‹p
(
sk_num
 -> {

242 
	`WWTXBegš
();

245 
j
 = 0; j < 
BATCH_SZ
; j++) {

246 
fš®
 
fj
 = 
j
;

248 
	`addTe¡S‹p
(
sk_num
 -> {

250 
r1
 = 
¿nd
.
	`ÃxtIÁ
(
numTasks
);

251 
r2
 = 
¿nd
.
	`ÃxtIÁ
(
numTasks
);

252 
r3
 = 
¿nd
.
	`ÃxtIÁ
(
numTasks
);

253 
accumuÏtÜ
 = 0;

254 
accumuÏtÜ
 +ğ
m­1
.
	`g‘
("m1" + 
r1
);

255 
accumuÏtÜ
 +ğ
m­2
.
	`g‘
("m2" + 
r2
);

256 
accumuÏtÜ
 +ğ
m­3
.
	`g‘
("m3" + 
r3
);

259 ià(
¿nd
.
	`ÃxtIÁ
(
MAX_PERCENT
è>ğ
»adP”ûÁ
) {

260 ià(
¿nd
.
	`ÃxtIÁ
(2) == 1)

261 
m­2
.
	`put
("m2" + 
¿nd
.
	`ÃxtIÁ
(
numTasks
), 
accumuÏtÜ
);

263 
m­3
.
	`put
("m3" + 
¿nd
.
	`ÃxtIÁ
(
numTasks
), 
accumuÏtÜ
);

268 
	`addTe¡S‹p
(
sk_num
 -> {

269 
Œy
 {

270 
	`TXEnd
();

271 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

272 
abÜts
.
	`g‘AndInüem’t
();

277 
	`addTe¡S‹p
(
sk_num
 ->

278 
	`ÿlcuÏ‹AbÜtR©e
(
abÜts
.
	`g‘
(), 
numTasks
)

281 
	}
}

286 @
Te¡


287 
public
 
	$‹¡CÚcu¼’tSŒ—mRW
() {

289 
fš®
 
NUM_THREADS
 = 3;

290 
A¼ayLi¡
<
Th»ad
> 
tLi¡
 = 
Ãw
 ArrayList<>();

293 
	`g’”©eM­s
();

294 
	`cÚcu¼’tSŒ—mRWLßd
(-1, 
READ_PERCENT
);

295 
	`scheduËIÁ”Ëaved
(
NUM_THREADS
, NUM_THREADS);

296 
	}
}

302 @
	$Te¡
 (
ex³ùed
 = 
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
)

303 
public
 
	$checkT¿n§ùiÚAbÜtIfLookupByIndexWh’IndexNÙS³cif›d
() {

304 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(CÜfuTabË.
şass
, "Test");

306 
Œy
 {

307 
	`TXBegš
();

308 
m­
.
	`put
("ak", "av");

309 
m­
.
	`g‘ByIndex
(
SŒšgIndex”
.
BY_FIRST_LETTER
, "a");

310 
	`TXEnd
();

311 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

312 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
UNDEFINED
);

313 
	`as£¹Th©
(
e
.
	`g‘Cau£
().
	`g‘CÏss
()).
	`isEqu®To
(
IÎeg®Argum’tExû±iÚ
.
şass
);

314 
throw
 
e
;

316 
	}
}

322 @
	$Te¡
 (
ex³ùed
 = 
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
)

323 
public
 
	$checkT¿n§ùiÚAbÜtIfLookupByIndexAndF‹rWh’IndexNÙS³cif›d
() {

324 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`š¡ªtŸ‹CÜfuObjeù
(CÜfuTabË.
şass
, "Test");

326 
Œy
 {

327 
	`TXBegš
();

328 
m­
.
	`put
("ab", "cccc");

329 
m­
.
	`put
("ac", "bbbb");

330 
m­
.
	`put
("ad", "bcbc");

331 
m­
.
	`g‘ByIndexAndF‹r
(
SŒšgIndex”
.
BY_FIRST_LETTER
, 
p
 ->….
	`g‘V®ue
().
	`cÚšs
("c"),"a");

332 
	`TXEnd
();

333 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

334 
	`as£¹Th©
(
e
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
UNDEFINED
);

335 
	`as£¹Th©
(
e
.
	`g‘Cau£
().
	`g‘CÏss
()).
	`isEqu®To
(
IÎeg®Argum’tExû±iÚ
.
şass
);

336 
throw
 
e
;

338 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/TXConflictScenariosTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”A¼ay
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuSh¬edCouÁ”
;

14 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

19 
public
 
ab¡¿ù
 cÏs 
	cTXCÚæiùSûÇriosTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚCÚ‹xtTe¡
 {

45 
	$‹¡O·c™y
(
boŞ—n
 
‹¡IÁ”Ëaved
)

46 
throws
 
Exû±iÚ
 {

48 
	`£tupCouÁ”s
();

51 
	`addTe¡S‹p
((
ignÜed_sk_num
) -> {

52 
	`TXBegš
();

56 
	`addTe¡S‹p
((
sk_num
) -> {

57 
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`£tV®ue
(
OVERWRITE_ONCE
);

61 
	`addTe¡S‹p
((
sk_num
) -> {

62 
¢­Stus
.
	`£t
(
sk_num
, 
sh¬edCouÁ”s
.
	`g‘
(Ñask_num + 1è% 
numTasks
).
	`g‘V®ue
());

66 
	`addTe¡S‹p
((
sk_num
) -> {

67 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`g‘V®ue
())

68 .
	`isEqu®To
(
OVERWRITE_ONCE
);

72 
	`addTe¡S‹p
((
sk_num
) -> {

73 
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`£tV®ue
(
OVERWRITE_TWICE
);

78 
	`addTe¡S‹p
((
sk_num
) -> {

79 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
((
sk_num
 + 1è% 
numTasks
).
	`g‘V®ue
())

80 .
	`isEqu®To
(
¢­Stus
.
	`g‘
(
sk_num
));

84 
	`addTe¡S‹p
((
sk_num
) -> {

85 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`g‘V®ue
())

86 .
	`isEqu®To
(
OVERWRITE_TWICE
);

91 
	`addTe¡S‹p
((
sk_num
) -> {

92 
Œy
 {

93 
	`TXEnd
();

94 
comm™Stus
.
	`£t
(
sk_num
, 
COMMITVALUE
);

95 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

100 ià(
‹¡IÁ”Ëaved
)

101 
	`scheduËIÁ”Ëaved
(
PARAMETERS
.
CONCURRENCY_SOME
, 
numTasks
);

103 
	`scheduËTh»aded
(
PARAMETERS
.
CONCURRENCY_SOME
, 
numTasks
);

131 
	$‹¡RWCÚæiùs
(
boŞ—n
 
‹¡IÁ”Ëaved
)

132 
throws
 
Exû±iÚ
 {

134 
	`£tupCouÁ”s
();

136 
	`as£¹Th©
(
numTasks
).
	`isG»©”Thª
(1);

139 
	`addTe¡S‹p
((
ignÜed_sk_num
) -> {

140 
	`TXBegš
();

144 
	`addTe¡S‹p
((
sk_num
) -> {

145 
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`£tV®ue
(
OVERWRITE_ONCE
);

149 
	`addTe¡S‹p
((
sk_num
) -> {

150 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
((
sk_num
 + 1è% 
numTasks
).
	`g‘V®ue
())

151 .
	`isB‘w“n
(
INITIAL
, 
OVERWRITE_ONCE
);

155 
	`addTe¡S‹p
((
sk_num
) -> {

156 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`g‘V®ue
())

157 .
	`isEqu®To
(
OVERWRITE_ONCE
);

161 
	`addTe¡S‹p
((
sk_num
) -> {

162 
sh¬edCouÁ”s
.
	`g‘
((
sk_num
 + 1è% 
numTasks
).
	`£tV®ue
(
OVERWRITE_TWICE
);

166 
	`addTe¡S‹p
((
sk_num
) -> {

167 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
((
sk_num
 + 1è% 
numTasks
).
	`g‘V®ue
())

168 .
	`isEqu®To
(
OVERWRITE_TWICE
);

172 
	`addTe¡S‹p
((
sk_num
) -> {

173 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
(
sk_num
).
	`g‘V®ue
())

174 .
	`isEqu®To
(
OVERWRITE_ONCE
);

179 
	`addTe¡S‹p
((
sk_num
) -> {

180 
Œy
 {

181 
	`TXEnd
();

182 
comm™Stus
.
	`£t
(
sk_num
, 
COMMITVALUE
);

183 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

189 ià(
‹¡IÁ”Ëaved
)

190 
	`scheduËIÁ”Ëaved
(
PARAMETERS
.
CONCURRENCY_SOME
, 
numTasks
);

192 
	`scheduËTh»aded
(
PARAMETERS
.
CONCURRENCY_SOME
, 
numTasks
);

194 
	}
}

196 
	$‹¡NoWr™eCÚæiùSim¶e
(è
throws
 
Exû±iÚ
 {

198 
fš®
 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”1
 =

199 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuSh¬edCouÁ”
.
şass
, "test"+1);

200 
fš®
 
CÜfuSh¬edCouÁ”
 
sh¬edCouÁ”2
 =

201 
	`š¡ªtŸ‹CÜfuObjeù
(
CÜfuSh¬edCouÁ”
.
şass
, "test"+2);

203 
comm™Stus
 = 
Ãw
 
	`AtomicIÁeg”A¼ay
(2);

205 
	`t
(1, 
this
::
TXBegš
);

206 
	`t
(2, 
this
::
TXBegš
);

208 
	`t
(1, (è-> { 
sh¬edCouÁ”1
.
	`£tV®ue
(
OVERWRITE_ONCE
);});

209 
	`t
(2, (è-> { 
sh¬edCouÁ”2
.
	`£tV®ue
(
OVERWRITE_ONCE
);});

211 
	`t
(1, (è-> 
sh¬edCouÁ”1
.
	`g‘V®ue
());

212 
	`t
(2, (è-> 
sh¬edCouÁ”2
.
	`g‘V®ue
());

214 
	`t
(1, (è-> 
sh¬edCouÁ”2
.
	`g‘V®ue
());

215 
	`t
(2, (è-> 
sh¬edCouÁ”1
.
	`g‘V®ue
());

217 
	`t
(1, (è-> { 
sh¬edCouÁ”1
.
	`£tV®ue
(
OVERWRITE_TWICE
);});

218 
	`t
(2, (è-> { 
sh¬edCouÁ”2
.
	`£tV®ue
(
OVERWRITE_TWICE
);});

220 
	`t
(1, (è-> 
sh¬edCouÁ”1
.
	`g‘V®ue
());

221 
	`t
(1, (è-> 
sh¬edCouÁ”2
.
	`g‘V®ue
());

223 
	`t
(2, (è-> 
sh¬edCouÁ”2
.
	`g‘V®ue
());

224 
	`t
(2, (è-> 
sh¬edCouÁ”1
.
	`g‘V®ue
());

226 
	`t
(1, () -> {

227 
Œy
 {

228 
	`TXEnd
();

229 
comm™Stus
.
	`£t
(0, 
COMMITVALUE
);

230 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

235 
	`t
(2, () -> {

236 
Œy
 {

237 
	`TXEnd
();

238 
comm™Stus
.
	`£t
(1, 
COMMITVALUE
);

239 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

243 
	}
}

245 @
	gTe¡


246 @
Suµ»ssW¬nšgs
("unchecked")

247 
public
 
	$fšeg¿šedUpd©esDoNÙCÚæiù
()

248 
throws
 
Exû±iÚ
 {

249 
AtomicBoŞ—n
 
comm™Stus
 = 
Ãw
 
	`AtomicBoŞ—n
(
Œue
);

251 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘M­
();

253 
M­
<
SŒšg
, SŒšg> 
‹¡M­2
 = (Map<String, String>)

254 
	`š¡ªtŸ‹CÜfuObjeù
(

255 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {}, "test stream");

257 
	`t
(1, (è-> 
	`TXBegš
() );

258 
	`t
(1, (è-> 
‹¡M­
.
	`put
("a", "a") );

259 
	`t
(1, (è-> 
	`as£¹Th©
(
‹¡M­
.
	`put
("a", "b"))

260 .
	`isEqu®To
("a") );

262 
	`t
(2, (è-> 
	`TXBegš
() );

263 
	`t
(2, (è-> 
‹¡M­2
.
	`put
("b", "f") );

264 
	`t
(2, (è-> 
	`as£¹Th©
(
‹¡M­2
.
	`put
("b", "g"))

265 .
	`isEqu®To
("f") );

266 
	`t
(2, (è-> 
	`TXEnd
() );

268 
	`t
(1, () -> {

269 
Œy
 {

270 
	`TXEnd
();

271 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

272 
comm™Stus
.
	`£t
(
çl£
);

277 
	`as£¹Th©
(
comm™Stus
.
	`g‘
())

278 .
	`isTrue
();

279 
	}
}

281 
	$g‘AbÜtTe¡SM
() {

282 
Rªdom
 
¿nd
 = 
Ãw
 
	`Rªdom
(
PARAMETERS
.
SEED
);

284 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘M­
();

285 
‹¡M­
.
	`ş—r
();

288 
	`addTe¡S‹p
((
ignÜed_sk_num
è-> 
	`TXBegš
() );

291 
	`addTe¡S‹p
Ğ(
sk_num
) -> {

294 
‹¡M­
.
	`put
(
IÁeg”
.
	`toSŒšg
(
sk_num
),

295 
IÁeg”
.
	`toSŒšg
(
sk_num
));

298 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++)

299 
‹¡M­
.
	`g‘
(
IÁeg”
.
	`toSŒšg
(
¿nd
.
	`ÃxtIÁ
(
PARAMETERS
.
NUM_ITERATIONS_MODERATE
)));

303 
	`addTe¡S‹p
Ğ(
sk_num
) -> {

304 
Œy
 {

305 
	`TXEnd
();

306 
comm™Stus
.
	`£t
(
sk_num
, 
COMMITVALUE
);

307 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

310 
	}
}

312 
public
 
	$cÚcu¼’tAbÜtTe¡
(
boŞ—n
 
‹¡IÁ”Ëaved
)

313 
throws
 
Exû±iÚ


315 
fš®
 
numTh»ads
 = 
PARAMETERS
.
CONCURRENCY_SOME
;

316 
fš®
 
numRecÜds
 = 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
;

317 
numTasks
 = 
numTh»ads
*
numRecÜds
;

319 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

321 
comm™Stus
 = 
Ãw
 
	`AtomicIÁeg”A¼ay
(
numTasks
);

323 
	`g‘AbÜtTe¡SM
();

326 ià(
‹¡IÁ”Ëaved
)

327 
	`scheduËIÁ”Ëaved
(
numTh»ads
, 
numTasks
);

329 
	`scheduËTh»aded
(
numTh»ads
, 
numTasks
);

331 
abÜts
 = 0;

332 
i
 = 0; i < 
numTasks
; i++)

333 ià(
comm™Stus
.
	`g‘
(
i
è!ğ
COMMITVALUE
)

334 
abÜts
++;

337 
	`ÿlcuÏ‹Reque¡sP”SecÚd
("TPS", 
numRecÜds
 * 
numTh»ads
, 
¡¬tTime
);

338 
	`ÿlcuÏ‹AbÜtR©e
(
abÜts
, 
numRecÜds
 * 
numTh»ads
);

339 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/TXsFromTwoRuntimesTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gICÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

18 
public
 cÏs 
	cTXsFromTwoRuÁimesTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

19 @
Ov”ride


20 
public
 
	$TXBegš
(è{ 
	`O±imi¡icTXBegš
(); }

24 @
Te¡


25 
public
 
	$¡agg”edTXsCÚæiù
(è
throws
 
Exû±iÚ
 {

26 
fš®
 
nTXs
 = 5;

27 
fš®
 
Sem­hÜe
 
£m0
 = 
Ãw
 
	`Sem­hÜe
(0),

28 
£m1
 = 
Ãw
 
	`Sem­hÜe
(0);

34 
fš®
 
Th»ad
 
th»ad1
 = 
Ãw
 
	`Th»ad
( () -> {

35 
CÜfuRuÁime
 
myruÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
());

36 
myruÁime
.
	`cÚÃù
();

38 
ICÜfuTabË
<
IÁeg”
, IÁeg”> 
mym­
 =

39 
myruÁime
.
	`g‘ObjeùsV›w
()

40 .
	`bud
()

41 .
	`£tSŒ—mName
("nonidepmpotentmaptest")

42 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

43 .
	`İ’
() ;

45 
	`as£¹Th©
(
mym­
.
	`g‘
("world1"))

46 .
	`isEqu®To
(
nuÎ
);

48 
t
 = 0; < 
nTXs
;++) {

49 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

50 
mym­
.
	`put
(
nTXs
+
t
,);

51 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

54 
	`as£¹Th©
(
mym­
.
	`size
())

55 .
	`isEqu®To
(
nTXs
);

58 
£m0
.
	`»Ëa£
();

61 
Œy
 {

62 
£m1
.
	`acquœe
();

63 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

64 
e
.
	`´štSckT¿û
();

68 
	`as£¹Th©
(
mym­
.
	`size
())

69 .
	`isEqu®To
(
nTXs
);

72 
fš®
 
Th»ad
 
th»ad0
 = 
Ãw
 
	`Th»ad
( () -> {

73 
CÜfuRuÁime
 
myruÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
());

74 
myruÁime
.
	`cÚÃù
();

76 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
mym­
 =

77 
myruÁime
.
	`g‘ObjeùsV›w
()

78 .
	`bud
()

79 .
	`£tSŒ—mName
("nonidepmpotentmaptest")

80 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

81 .
	`İ’
();

84 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

85 
	`as£¹Th©
(
mym­
.
	`g‘
(
nTXs
))

86 .
	`isEqu®To
(
nuÎ
);

87 
mym­
.
	`put
(0, mym­.
	`size
());

90 
th»ad1
.
	`¡¬t
();

92 
boŞ—n
 
isAbÜt
 = 
çl£
;

93 
Œy
 {

96 
£m0
.
	`acquœe
();

97 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

99 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

100 
e
.
	`´štSckT¿û
();

101 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

102 
	`as£¹Th©
(
‹
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
CONFLICT
);

103 
isAbÜt
 = 
Œue
;

107 
£m1
.
	`»Ëa£
();

110 
	`as£¹Th©
(
isAbÜt
)

111 .
	`isTrue
();

114 
	`as£¹Th©
(
mym­
.
	`size
())

115 .
	`isEqu®To
(
nTXs
);

119 
th»ad0
.
	`¡¬t
();

121 
fš®
 
WAIT_TIME
 = 10000;

122 
Œy
 {

123 
th»ad0
.
	`još
(
WAIT_TIME
);

124 
th»ad1
.
	`još
(
WAIT_TIME
);

125 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

126 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
();

128 
	}
}

130 @
Te¡


131 
public
 
	$¡agg”edTXsNoCÚæiù
(è
throws
 
Exû±iÚ
 {

132 
fš®
 
nTXs
 = 5;

133 
fš®
 
Sem­hÜe
 
£m0
 = 
Ãw
 
	`Sem­hÜe
(0),

134 
£m1
 = 
Ãw
 
	`Sem­hÜe
(0);

140 
fš®
 
Th»ad
 
th»ad1
 = 
Ãw
 
	`Th»ad
( () -> {

141 
CÜfuRuÁime
 
myruÁime
 = 
Ãw
 
	`CÜfuRuÁime
(
	`g‘DeçuÉEndpošt
());

142 
myruÁime
.
	`cÚÃù
();

144 
ICÜfuTabË
<
IÁeg”
, IÁeg”> 
mym­
 =

145 
myruÁime
.
	`g‘ObjeùsV›w
()

146 .
	`bud
()

147 .
	`£tSŒ—mName
("nonidepmpotentmaptest")

148 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

149 .
	`İ’
() ;

151 
	`as£¹Th©
(
mym­
.
	`g‘
("world1"))

152 .
	`isEqu®To
(
nuÎ
);

154 
t
 = 0; < 
nTXs
;++) {

155 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

156 
mym­
.
	`put
(
nTXs
+
t
,);

157 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

160 
	`as£¹Th©
(
mym­
.
	`size
())

161 .
	`isEqu®To
(
nTXs
);

164 
£m0
.
	`»Ëa£
();

167 
Œy
 {

168 
£m1
.
	`acquœe
();

169 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

170 
e
.
	`´štSckT¿û
();

174 
	`as£¹Th©
(
mym­
.
	`size
())

175 .
	`isEqu®To
(
nTXs
+1);

176 
	`as£¹Th©
(
mym­
.
	`g‘
(0))

177 .
	`isEqu®To
(0);

180 
fš®
 
Th»ad
 
th»ad0
 = 
Ãw
 
	`Th»ad
( () -> {

181 
CÜfuRuÁime
 
myruÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
());

182 
myruÁime
.
	`cÚÃù
();

184 
ICÜfuTabË
<
IÁeg”
, IÁeg”> 
mym­
 =

185 
myruÁime
.
	`g‘ObjeùsV›w
()

186 .
	`bud
()

187 .
	`£tSŒ—mName
("nonidepmpotentmaptest")

188 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

189 .
	`İ’
();

192 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

193 
	`as£¹Th©
(
mym­
.
	`g‘
(0))

194 .
	`isEqu®To
(
nuÎ
);

195 
mym­
.
	`compu‹IfAb£Á
(0, (
K
) -> {

197  
mym­
.
	`size
();

201 
th»ad1
.
	`¡¬t
();

203 
boŞ—n
 
isAbÜt
 = 
çl£
;

204 
Œy
 {

207 
£m0
.
	`acquœe
();

208 
myruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

210 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

211 
e
.
	`´štSckT¿û
();

212 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

213 
isAbÜt
 = 
Œue
;

217 
£m1
.
	`»Ëa£
();

220 
	`as£¹Th©
(
isAbÜt
)

221 .
	`isF®£
();

225 
	`as£¹Th©
(
mym­
.
	`size
())

226 .
	`isEqu®To
(
nTXs
+1);

227 
	`as£¹Th©
(
mym­
.
	`g‘
(0))

228 .
	`isEqu®To
(0);

233 
th»ad0
.
	`¡¬t
();

235 
fš®
 
WAIT_TIME
 = 10000;

236 
Œy
 {

237 
th»ad0
.
	`još
(
WAIT_TIME
);

238 
th»ad1
.
	`još
(
WAIT_TIME
);

239 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
›
) {

240 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
();

242 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/TransactionAbortedTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

6 
impÜt
 
	gjava
.
	gut
.
	gM­
;

7 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

9 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxyIÁ”Çl
;

14 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

26 
public
 cÏs 
	cT¿n§ùiÚAbÜ‹dTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚCÚ‹xtTe¡
 {

32 @
Ov”ride


33 
public
 
	$TXBegš
() {

34 
	`WWTXBegš
();

37 @
Te¡


38 
public
 
	$abÜtT¿n§ùiÚTe¡
(è
throws
 
Exû±iÚ
 {

39 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

41 
M­
<
SŒšg
, SŒšg> 
m­
 = 
ruÁime
.
	`g‘ObjeùsV›w
()

42 .
	`bud
()

43 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

44 .
	`£tSŒ—mName
(
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
())

45 .
	`İ’
();

46 
fš®
 
SŒšg
 
key
 = "key";

47 
fš®
 
SŒšg
 
v®ue
 = "value";

49 
	`t1
(
this
::
TXBegš
);

50 
	`t2
(
this
::
TXBegš
);

52 
AtomicLÚg
 
ofãndšgAdd»ss
 = 
Ãw
 
	`AtomicLÚg
(-1);

53 
	`t1
(() -> {

54 
m­
.
	`put
(
key
, 
v®ue
);

55 
ofãndšgAdd»ss
.
	`£t
(
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
());

56 }).
	`as£¹DÛsNÙThrow
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

58 
	`t2
(() -> {

59 
Œy
 {

60 
m­
.
	`put
(
key
, 
v®ue
);

61 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

62  
çl£
;

63 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
e
) {

65 
	`as£¹Th©
(
e
.
	`g‘CÚæiùSŒ—m
()

66 .
	`equ®s
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
this
.
	`g‘CÏss
().
	`g‘Sim¶eName
())));

69 
	`as£¹Th©
(
e
.
	`g‘OfãndšgAdd»ss
().
	`equ®s
(
ofãndšgAdd»ss
.
	`g‘
()));

72 
fš®
 
ICÜfuSMRProxyIÁ”Çl
 
´oxyIÁ”Çl
 =

73 
e
.
	`g‘CÚ‹xt
().
	`g‘Wr™eS‘Info
().
	`g‘CÚæiùs
().
	`keyS‘
().
	`¡»am
().
	`fšdFœ¡
().
	`g‘
();

74 
fš®
 
by‹
[] 
keyHash
 = 
CÚæiùS‘Info
.
	`g’”©eHashFromObjeù
(
´oxyIÁ”Çl
, 
key
);

75 
	`as£¹Th©
(
A¼ays
.
	`equ®s
(
keyHash
, 
e
.
	`g‘CÚæiùKey
())).
	`isTrue
();

76  
Œue
;

78 }).
	`as£¹ResuÉ
().
	`isEqu®To
(
Œue
);

79 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/UndoTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

17 
public
 cÏs 
	cUndoTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚsTe¡
 {

18 @
Ov”ride


19 
public
 
	$TXBegš
(è{ 
	`WWTXBegš
(); }

22 @
Te¡


23 
public
 
	$ckCÜ»ùUndo
()

24 
throws
 
Exû±iÚ
 {

25 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

26 .
	`g‘ObjeùsV›w
()

27 .
	`bud
()

28 .
	`£tSŒ—mName
("test")

29 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

31 .
	`İ’
();

34 
	`t
(0, (è-> 
‹¡M­
.
	`put
("z", "z"));

39 
	`t
(0, (è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
());

40 
	`t
(0, () -> {

41 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

42 .
	`isEqu®To
("z");

43 
‹¡M­
.
	`put
("a", "a");

47 
	`t
(1, () -> {

48 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

49 .
	`isEqu®To
("z");

50 
‹¡M­
.
	`put
("y", "y");

56 
	`t
(0, () -> {

57 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

58 .
	`isEqu®To
("z");

59 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("y"))

60 .
	`isEqu®To
(
nuÎ
);

61 
	`as£¹Th©
(
‹¡M­
.
	`size
())

62 .
	`isEqu®To
(2);

64 
	}
}

66 @
Te¡


67 
public
 
	$ÿnRŞlbackW™houtUndo
()

68 
throws
 
Exû±iÚ
 {

69 
M­
<
SŒšg
, SŒšg> 
‹¡M­
 = 
	`g‘RuÁime
()

70 .
	`g‘ObjeùsV›w
()

71 .
	`bud
()

72 .
	`£tSŒ—mName
("test")

73 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

75 .
	`İ’
();

78 
	`t
(0, (è-> 
‹¡M­
.
	`put
("z", "z"));

83 
	`t
(0, (è-> 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
());

84 
	`t
(0, () -> {

85 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

86 .
	`isEqu®To
("z");

87 
‹¡M­
.
	`put
("a", "a");

91 
	`t
(1, () -> {

92 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

93 .
	`isEqu®To
("z");

94 
‹¡M­
.
	`put
("y", "y");

95 
‹¡M­
.
	`ş—r
();

96 
	`as£¹Th©
(
‹¡M­
.
	`size
())

97 .
	`isEqu®To
(0);

98 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

99 .
	`isEqu®To
(
nuÎ
);

106 
	`t
(0, () -> {

107 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("z"))

108 .
	`isEqu®To
("z");

109 
	`as£¹Th©
(
‹¡M­
.
	`g‘
("y"))

110 .
	`isEqu®To
(
nuÎ
);

111 
	`as£¹Th©
(
‹¡M­
.
	`size
())

112 .
	`isEqu®To
(2);

114 
	}
}

126 @
Te¡


127 
public
 
	$ÿnUndoAá”NoUndo
()

128 
throws
 
Exû±iÚ
 {

129 
M­
<
IÁeg”
, 
SŒšg
> 
‹¡M­
 = 
	`g‘RuÁime
()

130 .
	`g‘ObjeùsV›w
()

131 .
	`bud
()

132 .
	`£tSŒ—mName
("test")

133 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

135 .
	`İ’
();

136 
fš®
 
¥ecŸlKey
 = 10;

137 
fš®
 
SŒšg
 
nÜm®V®ue
 = "z", 
¥ecŸlV®ue
 = "y";

138 
fš®
 
m­Size
 = 10 * 
PARAMETERS
.
NUM_ITERATIONS_LARGE
;

141 
i
 = 0; i < 
m­Size
; i++)

142 
‹¡M­
.
	`put
(
i
, 
nÜm®V®ue
);

145 
	`t
(0, () -> {

146 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

147 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
¥ecŸlKey
))

148 .
	`isEqu®To
(
nÜm®V®ue
);

152 
	`t
(1, () -> {

153 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

154 
‹¡M­
.
	`ş—r
();

155 
	`as£¹Th©
(
‹¡M­
.
	`size
())

156 .
	`isEqu®To
(0);

157 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
¥ecŸlKey
))

158 .
	`isEqu®To
(
nuÎ
);

163 
	`t
(0, () -> {

164 
¡¬tTime
, 
’dTime
;

165 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

166 
‹¡M­
.
	`g‘
(
¥ecŸlKey
);

167 
’dTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

169 ià(!
‹¡Stus
.
	`equ®s
("")) {

170 
‹¡Stus
 += ";";

172 
‹¡Stus
 += "reset„ebuildime="

173 + 
SŒšg
.
	`fÜm©
("%.0f", ()(
’dTime
-
¡¬tTime
))

179 
	`t
(1, () -> {

180 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

181 
	`as£¹Th©
(
‹¡M­
.
	`size
())

182 .
	`isEqu®To
(
m­Size
);

184 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

185 
‹¡M­
.
	`put
(
¥ecŸlKey
, 
¥ecŸlV®ue
);

186 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
¥ecŸlKey
))

187 .
	`isEqu®To
(
¥ecŸlV®ue
);

191 
	`t
(0, () -> {

192 
¡¬tTime
, 
’dTime
;

193 
¡¬tTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

194 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
¥ecŸlKey
))

195 .
	`isEqu®To
(
nÜm®V®ue
);

196 
’dTime
 = 
Sy¡em
.
	`cu¼’tTimeMlis
();

198 ià(!
‹¡Stus
.
	`equ®s
("")) {

199 
‹¡Stus
 += ";";

201 
‹¡Stus
 += "undo„ebuildime=" +

202 
SŒšg
.
	`fÜm©
("%.0f", ()(
’dTime
-
¡¬tTime
))

206 
	}
}

208 @
Te¡


209 
public
 
	$ckRŞlbackToRightPÏû
()

210 
throws
 
Exû±iÚ
 {

211 
M­
<
IÁeg”
, 
SŒšg
> 
‹¡M­
 = 
	`g‘RuÁime
()

212 .
	`g‘ObjeùsV›w
()

213 .
	`bud
()

214 .
	`£tSŒ—mName
("test")

215 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

217 .
	`İ’
();

219 
fš®
 
¥ecŸlKey
 = 10;

220 
fš®
 
SŒšg
 
nÜm®V®ue
 = "z", 
¥ecŸlV®ue
 = "y";

221 
fš®
 
m­Size
 = 10 * 
PARAMETERS
.
NUM_ITERATIONS_LARGE
;

224 
	`WWTXBegš
();

225 
‹¡M­
.
	`put
(
¥ecŸlKey
, 
nÜm®V®ue
);

226 
	`TXEnd
();

229 
	`t
(1, (è-> 
	`WWTXBegš
());

233 
	`WWTXBegš
();

234 
‹¡M­
.
	`putIfAb£Á
(
¥ecŸlKey
, 
¥ecŸlV®ue
);

235 
	`TXEnd
();

241 
	`t
(2, () -> {

242 
	`WWTXBegš
();

243 
‹¡M­
.
	`»move
(
¥ecŸlKey
);

244 
	`TXEnd
();

248 
	`t
(1, () -> {

249 
	`as£¹Th©
(
‹¡M­
.
	`g‘
(
¥ecŸlKey
))

250 .
	`isEqu®To
(
nÜm®V®ue
);

251 
	`TXEnd
();

253 
	}
}

255 
fš®
 
	g¥ecŸlKey
 = 10;

256 
fš®
 
SŒšg
 
	gnÜm®V®ue
 = "z", 
	g¥ecŸlV®ue
 = "y", 
	g¥ecŸlV®ue2
 = "x";

257 
fš®
 
	gt1
 = 1, 
	gt2
 = 2, 
	gt3
 = 3;

270 @
Te¡


271 
public
 
	$ckMuÉiSŒ—mRŞlback
()

272 
throws
 
Exû±iÚ
 {

273 
A¼ayLi¡
<
M­
> 
m­s
 = 
Ãw
 ArrayList<>();

275 
fš®
 
nm­s
 = 3;

276 
i
 = 0; i < 
nm­s
; i++)

277 
m­s
.
	`add
Ğ(
CÜfuTabË
<
IÁeg”
, 
SŒšg
>è
	`š¡ªtŸ‹CÜfuObjeù
(

278 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>(è{}, "‹¡ sŒ—m" + 
i
)

282 
	`üossSŒ—m
(
m­s
, 
nÜm®V®ue
);

286 
	`t
(
t1
, () -> {

287 
	`WWTXBegš
();

288 
m­s
.
	`g‘
(0).
	`size
();

295 
	`t
(
t2
, () -> {

296 
	`WWTXBegš
();

297 
m­s
.
	`g‘
(0).
	`size
();

304 
	`t
(
t3
, (è-> 
	`üossSŒ—m
(
m­s
, 
¥ecŸlV®ue
));

307 
	`t
(
t1
, () -> {

308 
M­
 
m
 : 
m­s
) {

309 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
))

310 .
	`isEqu®To
(
nÜm®V®ue
);

311 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
+1))

312 .
	`isEqu®To
(
nÜm®V®ue
);

318 
	`t
(
t2
, () -> {

319 
M­
 
m
 : 
m­s
)

320 
m
.
	`put
(
¥ecŸlKey
, 
¥ecŸlV®ue2
);

324 
M­
 
m
 : 
m­s
) {

325 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
))

326 .
	`isEqu®To
(
¥ecŸlV®ue
);

327 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
 + 1))

328 .
	`isEqu®To
(
¥ecŸlV®ue
);

332 
	`t
(
t2
, () -> {

333 
boŞ—n
 
abÜ‹d
 = 
çl£
;

334 
Œy
 {

335 
	`TXEnd
();

336 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 
‹
) {

337 
	`as£¹Th©
(
‹
.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
CONFLICT
);

338 
abÜ‹d
 = 
Œue
;

340 
	`as£¹Th©
(
abÜ‹d
);

344 
M­
 
m
 : 
m­s
) {

345 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
))

346 .
	`isEqu®To
(
¥ecŸlV®ue
);

347 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
 + 1))

348 .
	`isEqu®To
(
¥ecŸlV®ue
);

351 
	}
}

369 @
Te¡


370 
public
 
	$ckMuÉiSŒ—mRŞlback2
()

371 
throws
 
Exû±iÚ
 {

372 
A¼ayLi¡
<
M­
> 
m­s
 = 
Ãw
 ArrayList<>();

374 
fš®
 
nm­s
 = 3;

375 
i
 = 0; i < 
nm­s
; i++)

376 
m­s
.
	`add
Ğ(
CÜfuTabË
<
IÁeg”
, 
SŒšg
>è
	`š¡ªtŸ‹CÜfuObjeù
(

377 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>(è{}, "‹¡ sŒ—m" + 
i
)

381 
	`üossSŒ—m
(
m­s
, 
nÜm®V®ue
);

385 
	`t
(
t1
, () -> {

386 
	`WWTXBegš
();

387 
m­s
.
	`g‘
(0).
	`size
();

393 
	`t
(
t2
, () -> {

394 
	`WWTXBegš
();

395 
m­s
.
	`g‘
(0).
	`size
();

402 
	`t
(
t3
, (è-> 
	`üossSŒ—m
(
m­s
, 
¥ecŸlV®ue
));

406 
	`t
(
t2
, () -> {

407 
M­
 
m
 : 
m­s
)

408 
m
.
	`put
(
¥ecŸlKey
, 
¥ecŸlV®ue2
);

412 
	`t
(
t1
, () -> {

413 
M­
 
m
 : 
m­s
) {

414 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
))

415 .
	`isEqu®To
(
nÜm®V®ue
);

416 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
+1))

417 .
	`isEqu®To
(
nÜm®V®ue
);

422 
M­
 
m
 : 
m­s
) {

423 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
))

424 .
	`isEqu®To
(
¥ecŸlV®ue
);

425 
	`as£¹Th©
(
m
.
	`g‘
(
¥ecŸlKey
 + 1))

426 .
	`isEqu®To
(
¥ecŸlV®ue
);

429 
	}
}

431 
´Ùeùed
 
üossSŒ—m
(
A¼ayLi¡
<
M­
> 
m­s
, 
SŒšg
 
v®ue
) {

433 
WWTXBegš
();

434 
M­
 
	gm
 : 
m­s
)

435 
m
.
put
(
¥ecŸlKey
, 
v®ue
);

436 
TXEnd
();

439 
M­
 
	gm
 : 
m­s
)

440 
m
.
put
(
¥ecŸlKey
 + 1, 
v®ue
);

	@test/src/test/java/org/corfudb/runtime/object/transactions/WriteAfterWriteTransactionContextTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiSMREÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gObjeùsV›w
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

20 
public
 cÏs 
	cWr™eAá”Wr™eT¿n§ùiÚCÚ‹xtTe¡
 
ex‹nds
 
	mAb¡¿ùT¿n§ùiÚCÚ‹xtTe¡
 {

25 @
Ov”ride


26 
public
 
	$TXBegš
(è{ 
	`WWTXBegš
(); }

29 @
Te¡


30 
public
 
	$cÚcu¼’tModifiÿtiÚsCau£AbÜt
()

32 
	`g‘RuÁime
().
	`£tT¿n§ùiÚLoggšg
(
Œue
);

34 
	`g‘M­
();

36 
	`t
(1, (è-> 
	`wr™e
("k" , "v1"));

37 
	`t
(1, 
this
::
WWTXBegš
);

38 
	`t
(2, 
this
::
WWTXBegš
);

39 
	`t
(1, (è-> 
	`g‘
("k"));

40 
	`t
(2, (è-> 
	`g‘
("k"));

41 
	`t
(1, (è-> 
	`wr™e
("k" , "v2"));

42 
	`t
(2, (è-> 
	`wr™e
("k" , "v3"));

43 
	`t
(1, 
this
::
TXEnd
);

44 
	`t
(2, 
this
::
TXEnd
)

45 .
	`as£¹Throws
()

46 .
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

48 
	`as£¹Th©
(
	`g‘M­
())

49 .
	`cÚšsEÁry
("k", "v2")

50 .
	`dÛsNÙCÚšEÁry
("k", "v3");

52 
ISŒ—mV›w
 
txSŒ—m
 = 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
()

53 .
	`g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
);

55 
Li¡
<
ILogD©a
> 
txns
 = 
txSŒ—m
.
	`»maššgUpTo
(
LÚg
.
MAX_VALUE
);

56 
	`as£¹Th©
(
txns
).
	`hasSize
(1);

57 
	`as£¹Th©
(
txns
.
	`g‘
(0).
	`g‘LogEÁry
(
	`g‘RuÁime
()).
	`g‘Ty³
()).
isEqu®To


58 (
LogEÁry
.
LogEÁryTy³
.
MULTIOBJSMR
);

60 
MuÉiObjeùSMREÁry
 
tx1
 = (MuÉiObjeùSMREÁry)
txns
.
	`g‘
(0).
g‘LogEÁry


61 (
	`g‘RuÁime
());

62 
	`as£¹Th©
(
tx1
.
	`g‘EÁryM­
().
	`size
()).
	`isEqu®To
(1);

63 
MuÉiSMREÁry
 
’ŒyM­
 = 
tx1
.
	`g‘EÁryM­
().
	`’ŒyS‘
().
	`™”©Ü
()

64 .
	`Ãxt
().
	`g‘V®ue
();

65 
	`as£¹Th©
(
’ŒyM­
).
	`isNÙNuÎ
();

66 
	`as£¹Th©
(
’ŒyM­
.
	`g‘Upd©es
().
	`size
()).
	`isEqu®To
(1);

67 
SMREÁry
 
smrEÁry
 = 
’ŒyM­
.
	`g‘Upd©es
().
	`g‘
(0);

68 
Objeù
[] 
¬gs
 = 
smrEÁry
.
	`g‘SMRArgum’ts
();

69 
	`as£¹Th©
(
smrEÁry
.
	`g‘SMRM‘hod
()).
	`isEqu®To
("put");

70 
	`as£¹Th©
((
SŒšg
è
¬gs
[0]).
	`isEqu®To
("k");

71 
	`as£¹Th©
((
SŒšg
è
¬gs
[1]).
	`isEqu®To
("v2");

72 
	}
}

	@test/src/test/java/org/corfudb/runtime/object/transactions/WriteWriteTXConcurrencyTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gŒª§ùiÚs
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

6 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

7 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

16 
public
 cÏs 
	cWr™eWr™eTXCÚcu¼’cyTe¡
 
ex‹nds
 
	mTXCÚæiùSûÇriosTe¡
 {

18 @
Ov”ride


19 
public
 
	$TXBegš
(è{ 
	`WWTXBegš
(); }

21 @
Te¡


22 
public
 
	$sim¶eWWTe¡
() {

25 
CÜfuTabË
<
SŒšg
, 
IÁeg”
> 
m­
 = ( CorfuTable<String, Integer>)

26 
	`š¡ªtŸ‹CÜfuObjeù
(

27 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, 
IÁeg”
> >() { },

30 
AtomicIÁeg”


31 
v®A
 = 
Ãw
 
	`AtomicIÁeg”
(0),

32 
v®B
 = 
Ãw
 
	`AtomicIÁeg”
(0);

35 
	`t
(0, (è-> 
	`WWTXBegš
());

36 
	`t
(0, (è-> 
m­
.
	`put
("a", 1));

37 
	`t
(0, (è-> 
m­
.
	`put
("b", 1));

39 
	`t
(1, (è-> 
	`WWTXBegš
());

40 
	`t
(1, () -> {

41 
IÁeg”
 
ga
 = 
m­
.
	`g‘
("a");

42 ià(
ga
 !ğ
nuÎ
è
v®A
.
	`£t
(ga);

44 
	`t
(1, () -> {

45 
IÁeg”
 
gb
 = 
m­
.
	`g‘
("b");

46 ià(
gb
 !ğ
nuÎ
è
v®B
.
	`£t
(gb);

49 
	`t
(1, (è-> 
	`TXEnd
());

51 
	`t
(0, (è-> 
	`TXEnd
());

53 
	`as£¹Th©
(
v®A
.
	`g‘
()).
	`isEqu®To
(
v®B
.get());

54 
	}
}

57 @
Te¡


58 
public
 
	$‹¡O·c™yIÁ”Ëaved
(è
throws
 
Exû±iÚ
 {

60 
	`‹¡O·c™yWW
(
Œue
);

61 
	}
}

63 @
Te¡


64 
public
 
	$‹¡O·c™yTh»aded
(è
throws
 
Exû±iÚ
 {

66 
	`‹¡O·c™yWW
(
çl£
);

67 
	}
}

70 
public
 
	$‹¡O·c™yWW
(
boŞ—n
 
‹¡IÁ”Ëaved
è
throws
 
Exû±iÚ
 {

71 
	`‹¡O·c™y
(
‹¡IÁ”Ëaved
);

74 
sk_num
 = 0;ask_num < 
numTasks
;ask_num++) {

75 ià(
comm™Stus
.
	`g‘
(
sk_num
è!ğ
COMMITVALUE
) {

76 
	`as£¹Th©
(
sh¬edCouÁ”s
.
	`g‘
((
sk_num
 + 1è% 
numTasks
).
	`g‘V®ue
())

77 .
	`isNÙEqu®To
(
¢­Stus
.
	`g‘
(
sk_num
));

78 
	`as£¹Th©
(
comm™Stus
.
	`g‘
((
sk_num
 + 1è% 
numTasks
))

79 .
	`isEqu®To
(
COMMITVALUE
);

82 
	}
}

88 
public
 
	$‹¡RWCÚæiùWW
(
boŞ—n
 
‹¡IÁ”Ëaved
è
throws
 
Exû±iÚ
 {

90 
	`‹¡RWCÚæiùs
(
‹¡IÁ”Ëaved
);

93 
sk_num
 = 0;ask_num < 
numTasks
;ask_num++) {

94 ià(
comm™Stus
.
	`g‘
(
sk_num
è!ğ
COMMITVALUE
)

95 
	`as£¹Th©
(
comm™Stus
.
	`g‘
((
sk_num
 + 1è% 
numTasks
è=ğ
COMMITVALUE
 ||

96 
comm™Stus
.
	`g‘
((
sk_num
 - 1è% 
numTasks
è=ğ
COMMITVALUE
)

97 .
	`isTrue
();

100 
	}
}

102 @
Te¡


103 
public
 
	$‹¡RWCÚæiùWWIÁ”Ëaved
(è
throws
 
Exû±iÚ
 {

104 
	`‹¡RWCÚæiùWW
(
Œue
);

105 
	}
}

107 @
Te¡


108 
public
 
	$‹¡RWCÚæiùWWTh»aded
(è
throws
 
Exû±iÚ
 {

109 
	`‹¡RWCÚæiùWW
(
çl£
);

110 
	}
}

112 @
Te¡


113 
public
 
	$‹¡NoWr™eCÚæiùSim¶eWW
(è
throws
 
Exû±iÚ
 {

114 
	`‹¡NoWr™eCÚæiùSim¶e
();

117 
	`as£¹Th©
(
comm™Stus
.
	`g‘
(0))

118 .
	`isEqu®To
(
COMMITVALUE
);

119 
	`as£¹Th©
(
comm™Stus
.
	`g‘
(1))

120 .
	`isEqu®To
(
COMMITVALUE
);

121 
	}
}

134 
public
 
	$‹¡AbÜtWW
(
boŞ—n
 
‹¡IÁ”Ëaved
)

135 
throws
 
Exû±iÚ


137 
	`cÚcu¼’tAbÜtTe¡
(
‹¡IÁ”Ëaved
);

140 
çl£abÜts
 = 0;

141 
S‘
<
IÁeg”
> 
çl£cŞlisiÚs
 = 
Ãw
 
HashS‘
<>();

142 
i
 = 0; i < 
numTasks
; i++ )

143 ià(! 
çl£cŞlisiÚs
.
	`add
(
IÁeg”
.
	`toSŒšg
(
i
).
	`hashCode
()èè
çl£abÜts
++;

145 
abÜts
 = 0;

146 
i
 = 0; i < 
numTasks
; i++)

147 ià(
comm™Stus
.
	`g‘
(
i
è!ğ
COMMITVALUE
)

148 
abÜts
++;

150 
	`as£¹Th©
(
abÜts
)

151 .
	`isEqu®To
(
çl£abÜts
);

152 
	}
}

154 @
Te¡


155 
public
 
	$‹¡AbÜtWWIÁ”Ëaved
()

156 
throws
 
Exû±iÚ


158 
	`‹¡AbÜtWW
(
Œue
);

159 
	}
}

161 @
Te¡


162 
public
 
	$‹¡AbÜtWWTh»aded
()

163 
throws
 
Exû±iÚ


165 
	`‹¡AbÜtWW
(
çl£
);

166 
	}
}

	@test/src/test/java/org/corfudb/runtime/utils/NodeLocatorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	guts
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
.
	gPrÙocŞ
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
public
 cÏs 
	cNodeLoÿtÜTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

13 @
Te¡


14 
public
 
	$šv®idNodeThrowsExû±iÚ
() {

15 
	`as£¹Th©ThrownBy
((è-> 
NodeLoÿtÜ
.
	`·r£SŒšg
("invalid{}"))

16 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

20 @
Te¡


21 
public
 
	$ËgacyNodeP¬£s
() {

22 
fš®
 
PORT_NUM
 = 3000;

23 
NodeLoÿtÜ
 
loÿtÜ
 = NodeLoÿtÜ.
	`·r£SŒšg
("10.0.0.1:3000");

25 
	`as£¹Th©
(
loÿtÜ
.
	`g‘Ho¡
())

26 .
	`isEqu®To
("10.0.0.1");

28 
	`as£¹Th©
(
loÿtÜ
.
	`g‘PÜt
())

29 .
	`isEqu®To
(
PORT_NUM
);

31 
	`as£¹Th©
(
loÿtÜ
.
	`g‘NodeId
())

32 .
	`isNuÎ
();

34 
	`as£¹Th©
(
loÿtÜ
.
	`g‘PrÙocŞ
())

35 .
	`isEqu®To
(
PrÙocŞ
.
TCP
);

36 
	}
}

38 @
Te¡


39 
public
 
	$nodeCªBeCÚv”‹dBackAndFÜth
() {

40 
NodeLoÿtÜ
 
loÿtÜ
 = NodeLoÿtÜ.
	`bud”
()

41 .
	`ho¡
("localhost")

42 .
	`pÜt
(1)

43 .
	`´ÙocŞ
(
PrÙocŞ
.
TCP
)

44 .
	`bud
();

45 
NodeLoÿtÜ
 
·r£d
 = NodeLoÿtÜ.
	`·r£SŒšg
(
loÿtÜ
.
	`toEndpoštU¾
());

47 
	`as£¹Th©
(
loÿtÜ
).
	`isEqu®ToCom·ršgF›ldByF›ld
(
·r£d
);

48 
	`as£¹Th©
(
loÿtÜ
).
	`isEqu®To
(
·r£d
);

49 
	}
}

51 @
Te¡


52 
public
 
	$nodeCªBeCÚv”‹dBackAndFÜthW™hNoNodeId
() {

53 
NodeLoÿtÜ
 
loÿtÜ
 = NodeLoÿtÜ.
	`bud”
()

54 .
	`ho¡
("localhost")

55 .
	`pÜt
(1)

56 .
	`nodeId
(
nuÎ
)

57 .
	`´ÙocŞ
(
PrÙocŞ
.
TCP
)

58 .
	`bud
();

60 
NodeLoÿtÜ
 
·r£d
 = NodeLoÿtÜ.
	`·r£SŒšg
(
loÿtÜ
.
	`toSŒšg
());

62 
	`as£¹Th©
(
loÿtÜ
).
	`isEqu®ToCom·ršgF›ldByF›ld
(
·r£d
);

63 
	`as£¹Th©
(
loÿtÜ
).
	`isEqu®To
(
·r£d
);

64 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/AbstractViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gDeçuÉEv’tLoİGroup
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

10 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

11 
impÜt
 
	glombok
.
	gD©a
;

12 
impÜt
 
	glombok
.
	gG‘‹r
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gBa£S”v”
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gIS”v”Rou‹r
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLayoutS”v”
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gMªagem’tS”v”
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gFau»D‘eùÜ
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gmªagem’t
.
	gN‘wÜkSŒ‘ch”
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutBoÙ¡¿pReque¡
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrRecov”yMsg
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
.
	gCÜfuRuÁimeP¬am‘”s
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gBa£HªdËr
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gICl›ÁRou‹r
;

32 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLayoutHªdËr
;

33 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™HªdËr
;

34 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gMªagem’tHªdËr
;

35 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gSequ’ûrHªdËr
;

36 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡Cl›ÁRou‹r
;

37 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

38 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

40 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

41 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

42 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”CÏss
;

43 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

45 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

46 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

47 
impÜt
 
	gjava
.
	gut
.
	gM­
;

48 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

49 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

50 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

51 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜeCÏss
;

80 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùV›wTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

81 
´iv©e
 
fš®
 
	mQUIET_PERIOD
 = 100;

82 
´iv©e
 
fš®
 
	mTIMEOUT
 = 300;

85 @
G‘‹r


86 
CÜfuRuÁime
 
	mruÁime
;

89 
fš®
 
	mM­
<
	mSŒšg
, 
	mTe¡S”v”
> 
	m‹¡S”v”M­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

92 
fš®
 
	mM­
<
	mCÜfuRuÁime
, M­<
	mSŒšg
, 
	mTe¡Cl›ÁRou‹r
>>

93 
	mruÁimeRou‹rM­
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

96 
´iv©e
 
fš®
 
SŒšg
 
	m‹¡Ho¡Çme
 = "tcp://test";

99 
public
 
	$Ab¡¿ùV›wTe¡
() {

100 
	`this
(
çl£
);

103 
public
 
	$Ab¡¿ùV›wTe¡
(
boŞ—n
 
fŞlowBackpoš‹rs
) {

105 
CÜfuRuÁime
.
ov”rideG‘Rou‹rFunùiÚ
 = 
this
::
g‘Rou‹rFunùiÚ
;

106 
ruÁime
 = 
CÜfuRuÁime
.
	`äomP¬am‘”s
(
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

107 .
	`fŞlowBackpoš‹rsEÇbËd
(
fŞlowBackpoš‹rs
)

108 .
	`Ã‰yEv’tLoİ
(
NETTY_EVENT_LOOP
)

109 .
	`bud
());

112 
ruÁime
.
	`g‘P¬am‘”s
().
	`£tHŞeFlR‘ry
(0);

113 
	}
}

115 
public
 
CÜfuRuÁime
 
g‘NewRuÁime
(@
NÚnuÎ
 
NodeLoÿtÜ
 
node
) {

116 
CÜfuRuÁime
 
	gruÁime
 = 
g‘NewRuÁime
(
CÜfuRuÁimeP¬am‘”s


117 .
bud”
()

118 .
bud
());

119 
	gruÁime
.
·r£CÚfigu¿tiÚSŒšg
(
node
.
g‘Ho¡
(è+ ":" +‚ode.
g‘PÜt
());

120  
	gruÁime
;

123 
public
 
CÜfuRuÁime
 
g‘NewRuÁime
(@
NÚnuÎ
 
CÜfuRuÁimeP¬am‘”s
 
·¿m‘”s
) {

124 
	g·¿m‘”s
.
£tN‘tyEv’tLoİ
(
NETTY_EVENT_LOOP
);

125  
	gCÜfuRuÁime
.
äomP¬am‘”s
(
·¿m‘”s
);

128 
public
 
NodeLoÿtÜ
 
	$g‘DeçuÉNode
() {

129  
NodeLoÿtÜ
.
	`bud”
()

130 .
	`ho¡
("test")

131 .
	`pÜt
(
SERVERS
.
PORT_0
)

132 .
	`nodeId
(
	`g‘S”v”
(
SERVERS
.
PORT_0
).
£rv”CÚ‹xt
.
	`g‘NodeId
())

133 .
	`bud
();

134 
	}
}

136 
public
 
	$simuÏ‹EndpoštDiscÚÃùed
(
CÜfuRuÁime
 
ruÁime
) {

137 ((
Te¡Cl›ÁRou‹r
è
ruÁime
.
	`g‘Rou‹r
(
	`g‘DeçuÉEndpošt
()))

138 .
	`simuÏ‹DiscÚÃùedEndpošt
();

139 
	}
}

148 
´Ùeùed
 
ICl›ÁRou‹r
 
	$g‘Rou‹rFunùiÚ
(
CÜfuRuÁime
 
ruÁime
, 
SŒšg
 
’dpošt
) {

149 
ruÁimeRou‹rM­
.
	`putIfAb£Á
(
ruÁime
, 
Ãw
 
CÚcu¼’tHashM­
<>());

150 ià(!
’dpošt
.
	`¡¬tsW™h
("‹¡:"è&& !’dpošt.¡¬tsW™h(
‹¡Ho¡Çme
)) {

151 
throw
 
Ãw
 
	`RuÁimeExû±iÚ
("UnsuµÜ‹dƒndpošˆše¡: " + 
’dpošt
);

153  
ruÁimeRou‹rM­
.
	`g‘
(
ruÁime
).
	`compu‹IfAb£Á
(
’dpošt
,

154 
x
 -> {

155 
SŒšg
 
£rv”Name
 = 
’dpošt
.
	`¡¬tsW™h
(
‹¡Ho¡Çme
) ?

156 
’dpošt
.
	`sub¡ršg
Óndpošt.
	`šdexOf
("‹¡"),ƒndpošt.
	`Ëngth
() - 1)

157 : 
’dpošt
;

158 
Te¡Cl›ÁRou‹r
 
tú
 =

159 
Ãw
 
	`Te¡Cl›ÁRou‹r
(
‹¡S”v”M­
.
	`g‘
(
£rv”Name
).
	`g‘S”v”Rou‹r
());

160 
tú
.
	`addCl›Á
(
Ãw
 
	`Ba£HªdËr
())

161 .
	`addCl›Á
(
Ãw
 
	`Sequ’ûrHªdËr
())

162 .
	`addCl›Á
(
Ãw
 
	`LayoutHªdËr
())

163 .
	`addCl›Á
(
Ãw
 
	`LogUn™HªdËr
())

164 .
	`addCl›Á
(
Ãw
 
	`Mªagem’tHªdËr
());

165  
tú
;

168 
	}
}

173 @
BefÜe


174 
public
 
	$»£tTe¡s
() {

175 
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
());

177 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`»£tCaches
();

178 
	}
}

180 @
Aá”


181 
public
 
	$ş—nupBufãrs
() {

182 
‹¡S”v”M­
.
	`v®ues
().
	`fÜEach
(
£rv”
 -> {

183 
£rv”
.
	`g‘LogUn™S”v”
().
	`shutdown
();

184 
£rv”
.
	`g‘Mªagem’tS”v”
().
	`shutdown
();

185 
£rv”
.
	`g‘LayoutS”v”
().
	`shutdown
();

186 
£rv”
.
	`g‘Sequ’ûrS”v”
().
	`shutdown
();

187 
£rv”
.
	`g‘Ba£S”v”
().
	`shutdown
();

190 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXAùive
()) {

191 
ruÁime
.
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

194 
ruÁimeRou‹rM­
.
	`keyS‘
().
	`fÜEach
(
CÜfuRuÁime
::
shutdown
);

195 
ruÁimeRou‹rM­
.
	`ş—r
();

196 
‹¡S”v”M­
.
	`ş—r
();

197 
ruÁime
.
	`shutdown
();

198 
	}
}

205 
public
 
	$addS”v”
(
pÜt
, 
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

206 
Ãw
 
	`Te¡S”v”
(
£rv”CÚ‹xt
).
	`addToTe¡
(
pÜt
, 
this
);

207 
	}
}

213 
public
 
	$addS”v”
(
pÜt
) {

214 
Ãw
 
	`Te¡S”v”
Òew 
	`S”v”CÚ‹xtBud”
().
	`£tSšgË
(
çl£
)

215 .
	`£tS”v”Rou‹r
(
Ãw
 
	`Te¡S”v”Rou‹r
(
pÜt
))

216 .
	`£tPÜt
(
pÜt
).
	`bud
())

217 .
	`addToTe¡
(
pÜt
, 
this
);

218 
	}
}

225 
public
 
	$addSšgËS”v”
(
pÜt
) {

226 
Te¡S”v”
 
‹¡S”v”
 = 
Ãw
 
	`Te¡S”v”
(
pÜt
);

227 
‹¡S”v”
.
	`addToTe¡
(
pÜt
, 
this
);

228 
Layout
 
Ïyout
 = 
‹¡S”v”
.
	`g‘LayoutS”v”
().
	`g‘Cu¼’tLayout
();

229 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

230 
	}
}

238 
public
 
Te¡S”v”
 
	$g‘S”v”
(
pÜt
) {

239  
‹¡S”v”M­
.
	`g‘
("‹¡:" + 
pÜt
);

240 
	}
}

247 
public
 
LogUn™S”v”
 
	$g‘LogUn™
(
pÜt
) {

248  
	`g‘S”v”
(
pÜt
).
	`g‘LogUn™S”v”
();

249 
	}
}

256 
public
 
Sequ’ûrS”v”
 
	$g‘Sequ’ûr
(
pÜt
) {

257  
	`g‘S”v”
(
pÜt
).
	`g‘Sequ’ûrS”v”
();

258 
	}
}

265 
public
 
LayoutS”v”
 
	$g‘LayoutS”v”
(
pÜt
) {

266  
	`g‘S”v”
(
pÜt
).
	`g‘LayoutS”v”
();

267 
	}
}

275 
public
 
Mªagem’tS”v”
 
	$g‘Mªagem’tS”v”
(
pÜt
) {

276  
	`g‘S”v”
(
pÜt
).
	`g‘Mªagem’tS”v”
();

277 
	}
}

279 
public
 
IS”v”Rou‹r
 
	$g‘S”v”Rou‹r
(
pÜt
) {

280  
	`g‘S”v”
(
pÜt
).
	`g‘S”v”Rou‹r
();

281 
	}
}

287 
public
 
	$boÙ¡¿pAÎS”v”s
(
Layout
 
l
)

289 
‹¡S”v”M­
.
	`’ŒyS‘
().
	`·¿Î–SŒ—m
()

290 .
	`fÜEach
(
e
 -> {

291 
e
.
	`g‘V®ue
().
ÏyoutS”v”


292 .
	`hªdËMes§ge
(
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP
.
	`·ylßdMsg
(
Ãw
 
	`LayoutBoÙ¡¿pReque¡
(
l
)),

293 
nuÎ
, 
e
.
	`g‘V®ue
().
£rv”Rou‹r
);

294 
e
.
	`g‘V®ue
().
mªagem’tS”v”


295 .
	`hªdËMes§ge
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
.
	`·ylßdMsg
(
l
),

296 
nuÎ
, 
e
.
	`g‘V®ue
().
£rv”Rou‹r
);

298 
Te¡S”v”
 
´im¬ySequ’ûrNode
 = 
‹¡S”v”M­
.
	`g‘
(
l
.
	`g‘Sequ’ûrs
().get(0));

299 
´im¬ySequ’ûrNode
.
£qu’ûrS”v”


300 .
	`hªdËMes§ge
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
.
	`·ylßdMsg
(
Ãw
 
	`Sequ’ûrRecov”yMsg
(0L,

301 
CŞËùiÚs
.
	`em±yM­
(), 
l
.
	`g‘Epoch
(), 
çl£
)), 
nuÎ
,

302 
´im¬ySequ’ûrNode
.
£rv”Rou‹r
);

303 
	}
}

311 
	$£tAgg»ssiveD‘eùÜTimeouts
(... 
mªagem’tS”v”sPÜts
) {

312 
A¼ays
.
	`¡»am
(
mªagem’tS”v”sPÜts
).
	`fÜEach
(
pÜt
 -> {

313 
N‘wÜkSŒ‘ch”
 
¡»tch”
 = N‘wÜkSŒ‘ch”.
	`bud”
()

314 .
	`³riodD–
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
)

315 .
	`maxP”iod
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
)

316 .
	`š™ŸlPŞlIÁ”v®
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
)

317 .
	`bud
();

319 
Fau»D‘eùÜ
 
çu»D‘eùÜ
 = 
	`g‘Mªagem’tS”v”
(
pÜt
)

320 .
	`g‘Mªagem’tAg’t
()

321 .
	`g‘RemÙeMÚ™ÜšgS”viû
()

322 .
	`g‘Fau»D‘eùÜ
();

323 
çu»D‘eùÜ
.
	`£tN‘wÜkSŒ‘ch”
(
¡»tch”
);

325 
	}
}

333 
Layout
 
	$šüem’tClu¡”Epoch
(
CÜfuRuÁime
 
cÜfuRuÁime
è
throws
 
OuŒªkedExû±iÚ
 {

334 
cÜfuRuÁime
.
	`šv®id©eLayout
();

335 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

336 
Ïyout
.
	`£tEpoch
Öayout.
	`g‘Epoch
() + 1);

337 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

338 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout
, 1L);

339  
Ïyout
;

340 
	}
}

346 
public
 
CÜfuRuÁime
 
	$g‘DeçuÉRuÁime
() {

347 ià(!
‹¡S”v”M­
.
	`cÚšsKey
(
	`g‘Endpošt
(
SERVERS
.
PORT_0
))) {

348 
	`addSšgËS”v”
(
SERVERS
.
PORT_0
);

350  
	`g‘RuÁime
().
	`cÚÃù
();

351 
	}
}

353 
Ev’tLoİGroup
 
	gNETTY_EVENT_LOOP
;

355 @
BefÜeCÏss


356 
public
 
	$š™Ev’tGroup
() {

357 
NETTY_EVENT_LOOP
 =

358 
Ãw
 
	`DeçuÉEv’tLoİGroup
(
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2,

359 
Ãw
 
	`Th»adFaùÜyBud”
()

360 .
	`£tNameFÜm©
("netty-%d")

361 .
	`£tD«mÚ
(
Œue
)

362 .
	`£tUnÿughtExû±iÚHªdËr
((
th»ad
, 
throwabË
) -> {

363 
	`as£¹Th©
(
çl£
)

364 .
	`as
("Th»ad " + 
th»ad
.
	`g‘Name
()

366 + 
throwabË
.
	`g‘CÏss
().
	`g‘Sim¶eName
())

367 .
	`isTrue
();

369 .
	`bud
());

370 
	}
}

372 @
Aá”CÏss


373 
public
 
	$ş—nEv’tGroup
() {

374 
NETTY_EVENT_LOOP
.
	`shutdownG¿ûfuÎy
(
QUIET_PERIOD
, 
TIMEOUT
, 
TimeUn™
.
MILLISECONDS
).
	`syncUnš‹¼u±ibly
();

375 
	}
}

382 
public
 
CÜfuRuÁime
 
	$g‘RuÁime
(
Layout
 
l
) {

383 
CÜfuRuÁimeP¬am‘”s
 
·¿m‘”s
 = CÜfuRuÁimeP¬am‘”s.
	`bud”
()

384 .
	`Ã‰yEv’tLoİ
(
NETTY_EVENT_LOOP
)

385 .
	`bud
();

386 
CÜfuRuÁime
 
ruÁime
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿m‘”s
);

387 
ruÁime
.
	`·r£CÚfigu¿tiÚSŒšg
(
l
.
ÏyoutS”v”s
.
	`¡»am
()

388 .
	`cŞËù
(
CŞËùÜs
.
	`joššg
(",")));

389  
ruÁime
;

390 
	}
}

397 
public
 
	$ş—rCl›ÁRuËs
(
CÜfuRuÁime
 
r
) {

398 
ruÁimeRou‹rM­
.
	`g‘
(
r
).
	`v®ues
().
	`fÜEach
(
x
 -> x.
ruËs
.
	`ş—r
());

399 
	}
}

405 
public
 
	$addCl›ÁRuË
(
Te¡RuË
 
ruË
) {

406 
	`addCl›ÁRuË
(
	`g‘RuÁime
(), 
ruË
);

407 
	}
}

414 
public
 
	$addCl›ÁRuË
(
CÜfuRuÁime
 
r
, 
Te¡RuË
 
ruË
) {

415 
ruÁimeRou‹rM­
.
	`g‘
(
r
).
	`v®ues
().
	`fÜEach
(
x
 -> x.
ruËs
.
	`add
(
ruË
));

416 
	}
}

424 
public
 
	$addCl›ÁRuË
(
CÜfuRuÁime
 
r
, 
SŒšg
 
ş›ÁRou‹rEndpošt
, 
Te¡RuË
 
ruË
) {

425 
ruÁimeRou‹rM­
.
	`g‘
(
r
).g‘(
ş›ÁRou‹rEndpošt
).
ruËs
.
	`add
(
ruË
);

426 
	}
}

432 
public
 
	$ş—rS”v”RuËs
(
pÜt
) {

433 
	`g‘S”v”
(
pÜt
).
	`g‘S”v”Rou‹r
().
ruËs
.
	`ş—r
();

434 
	}
}

441 
public
 
	$addS”v”RuË
(
pÜt
, 
Te¡RuË
 
ruË
) {

442 
	`g‘S”v”
(
pÜt
).
	`g‘S”v”Rou‹r
().
ruËs
.
	`add
(
ruË
);

443 
	}
}

449 
public
 
SŒšg
 
	$g‘DeçuÉCÚfigu¿tiÚSŒšg
() {

450  
	`g‘DeçuÉEndpošt
();

451 
	}
}

457 
public
 
SŒšg
 
	$g‘DeçuÉEndpošt
() {

458  
	`g‘Endpošt
(
SERVERS
.
PORT_0
);

459 
	}
}

466 
public
 
SŒšg
 
	$g‘Endpošt
(
pÜt
) {

467  "‹¡:" + 
pÜt
;

468 
	}
}

475 @
D©a


476 
´iv©e
 şas 
	cTe¡S”v”
 {

477 
S”v”CÚ‹xt
 
	g£rv”CÚ‹xt
;

478 
Ba£S”v”
 
	gba£S”v”
;

479 
Sequ’ûrS”v”
 
	g£qu’ûrS”v”
;

480 
LayoutS”v”
 
	gÏyoutS”v”
;

481 
LogUn™S”v”
 
	glogUn™S”v”
;

482 
Mªagem’tS”v”
 
	gmªagem’tS”v”
;

483 
IS”v”Rou‹r
 
	g£rv”Rou‹r
;

484 
	gpÜt
;

486 
Te¡S”v”
(
M­
<
SŒšg
, 
Objeù
> 
İtsM­
) {

487 
this
(
Ãw
 
S”v”CÚ‹xt
(
İtsM­
));

488 
	g£rv”CÚ‹xt
.
£tS”v”Rou‹r
(
Ãw
 
Te¡S”v”Rou‹r
());

491 
Te¡S”v”
(
S”v”CÚ‹xt
 
£rv”CÚ‹xt
) {

492 
	gthis
.
	g£rv”CÚ‹xt
 = 
£rv”CÚ‹xt
;

493 
	gthis
.
	g£rv”Rou‹r
 = 
£rv”CÚ‹xt
.
g‘S”v”Rou‹r
();

494 ià(
	g£rv”Rou‹r
 =ğ
nuÎ
) {

495 
£rv”Rou‹r
 = 
Ãw
 
Te¡S”v”Rou‹r
();

497 
	gthis
.
	gba£S”v”
 = 
Ãw
 
Ba£S”v”
(
£rv”CÚ‹xt
);

498 
	gthis
.
	g£qu’ûrS”v”
 = 
Ãw
 
Sequ’ûrS”v”
(
£rv”CÚ‹xt
);

499 
	gthis
.
	gÏyoutS”v”
 = 
Ãw
 
LayoutS”v”
(
£rv”CÚ‹xt
);

500 
	gthis
.
	glogUn™S”v”
 = 
Ãw
 
LogUn™S”v”
(
£rv”CÚ‹xt
);

501 
	gthis
.
	gmªagem’tS”v”
 = 
Ãw
 
Mªagem’tS”v”
(
£rv”CÚ‹xt
);

503 
	gthis
.
	g£rv”Rou‹r
.
addS”v”
(
ba£S”v”
);

504 
	gthis
.
	g£rv”Rou‹r
.
addS”v”
(
£qu’ûrS”v”
);

505 
	gthis
.
	g£rv”Rou‹r
.
addS”v”
(
ÏyoutS”v”
);

506 
	gthis
.
	g£rv”Rou‹r
.
addS”v”
(
logUn™S”v”
);

507 
	gthis
.
	g£rv”Rou‹r
.
addS”v”
(
mªagem’tS”v”
);

510 
Te¡S”v”
(
pÜt
) {

511 
this
(
S”v”CÚ‹xtBud”
.
deçuÉTe¡CÚ‹xt
(
pÜt
).
g‘S”v”CÚfig
());

514 
addToTe¡
(
pÜt
, 
Ab¡¿ùV›wTe¡
 
‹¡
) {

516 ià(
	g‹¡
.
	g‹¡S”v”M­
.
putIfAb£Á
("‹¡:" + 
pÜt
, 
this
è!ğ
nuÎ
) {

517 
throw
 
Ãw
 
RuÁimeExû±iÚ
("S”v”‡Ì—dy„egi¡”ed‡ˆpÜˆ" + 
pÜt
);

522 
public
 
Te¡S”v”Rou‹r
 
g‘S”v”Rou‹r
() {

523  (
	gTe¡S”v”Rou‹r
è
	gthis
.
	g£rv”Rou‹r
;

	@test/src/test/java/org/corfudb/runtime/view/AddressSpaceViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gÿche
.
	gCache
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gCÚtiguousS‘
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gDisü‘eDomaš
;

6 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gRªge
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”As£¹iÚs
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.*;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gM‘ricsUts
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

15 
impÜt
 
	gjava
.
	gut
.*;

17 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

23 
public
 cÏs 
	cAdd»ssS·ûV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

25 
´iv©e
 
	$£tupNodes
() {

26 
	`addS”v”
(
SERVERS
.
PORT_0
);

27 
	`addS”v”
(
SERVERS
.
PORT_1
);

28 
	`addS”v”
(
SERVERS
.
PORT_2
);

31 
	`boÙ¡¿pAÎS”v”s
(
Ãw
 
	`Te¡LayoutBud”
()

32 .
	`£tEpoch
(1L)

33 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

34 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

35 .
	`budSegm’t
()

36 .
	`budSŒe
()

37 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

38 .
	`addToSegm’t
()

39 .
	`budSŒe
()

40 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

41 .
	`addToSegm’t
()

42 .
	`budSŒe
()

43 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

44 .
	`addToSegm’t
()

45 .
	`addToLayout
()

46 .
	`bud
());

49 @
Te¡


50 
public
 
	$šcÜ»ùCacheS‘tšg
() {

51 
	`£tupNodes
();

52 
fš®
 
ÚeMb
 = 1
_000_000
;

54 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

55 .
	`bud”
()

56 .
	`maxCacheWeight
(
ÚeMb
)

57 .
	`maxCacheEÁr›s
(
ÚeMb
)

58 .
	`bud
();

60 
CÜfuRuÁime
 
¹
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
)

61 .
	`·r£CÚfigu¿tiÚSŒšg
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
())

62 .
	`cÚÃù
();

64 
	`as£¹Th©ThrownBy
((è-> 
¹
.
	`g‘Add»ssS·ûV›w
())

65 .
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

66 
	}
}

68 @
Te¡


69 
public
 
	$‹¡Add»ssS·ûCache
(è
throws
 
Exû±iÚ
 {

70 
	`£tupNodes
();

74 
fš®
 
ÚeMb
 = 1
_000_000
;

76 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

77 .
	`bud”
()

78 .
	`maxCacheWeight
(
ÚeMb
)

79 .
	`bud
();

81 
CÜfuRuÁime
 
¹
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
)

82 .
	`·r£CÚfigu¿tiÚSŒšg
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
())

83 .
	`cÚÃù
();

85 
fš®
 
·ylßdSize
 = 4000;

86 
by‹
[] 
·ylßd
 = 
Ãw
 by‹[
·ylßdSize
];

88 
maxCacheSize
 = 
ÚeMb
 / 
M‘ricsUts
.
sizeOf
.
	`d“pSizeOf
(
·ylßd
);

90 
x
 = 0; x < 
maxCacheSize
 * 2; x++) {

91 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
UUID
.
	`¿ndomUUID
()).
	`­³nd
(
·ylßd
);

94 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘R—dCache
().
	`size
()).
	`isLessThª
(
maxCacheSize
);

95 
	}
}

97 @
	gTe¡


98 @
Suµ»ssW¬nšgs
("unchecked")

99 
public
 
	$’su»SŒšgWÜks
(è
throws
 
Exû±iÚ
 {

100 
	`£tupNodes
();

101 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

102 
¹
.
	`g‘P¬am‘”s
().
	`£tCodecTy³
(
Codec
.
Ty³
.
NONE
.
	`toSŒšg
());

104 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

105 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

107 
fš®
 
•och
 = 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

109 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(
•och
, 0),

110 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

111 "h–lØwÜld".
	`g‘By‹s
());

113 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

114 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

116 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`cÚšsSŒ—m
(
¡»amA
))

117 .
	`isTrue
();

120 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_0
))

121 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

122 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_1
))

123 .
	`isEm±yAtAdd»ss
(0);

124 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_2
))

125 .
	`isEm±yAtAdd»ss
(0);

127 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(
•och
, 1),

128 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

129 "1".
	`g‘By‹s
());

130 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_0
))

131 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

132 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_1
))

133 .
	`m©chesD©aAtAdd»ss
(1, "1".
	`g‘By‹s
());

134 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_2
))

135 .
	`isEm±yAtAdd»ss
(0);

136 
	}
}

138 @
Te¡


139 
public
 
	$‹¡UnÿchedWr™es
() {

140 
	`£tupNodes
();

141 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

143 
fš®
 
•och
 = 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

146 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(
•och
, 0),

147 
CŞËùiÚs
.
	`sšgËtÚM­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("¡»am1"), 
Add»ss
.
NO_BACKPOINTER
)),

148 "·ylßd".
	`g‘By‹s
(), 
CacheO±iÚ
.
WRITE_THROUGH
);

150 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(
•och
, 1),

151 
CŞËùiÚs
.
	`sšgËtÚM­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("¡»am1"), 
Add»ss
.
NO_BACKPOINTER
)),

152 "·ylßd".
	`g‘By‹s
(), 
CacheO±iÚ
.
WRITE_AROUND
);

155 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(
•och
, 2),

156 
CŞËùiÚs
.
	`sšgËtÚM­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("¡»am1"), 
Add»ss
.
NO_BACKPOINTER
)),

157 "·ylßd".
	`g‘By‹s
());

160 
Cache
<
LÚg
, 
ILogD©a
> 
ş›ÁCache
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘R—dCache
();

162 
	`as£¹Th©
(
ş›ÁCache
.
	`g‘IfP»£Á
(0L)).
	`isNÙNuÎ
();

163 
	`as£¹Th©
(
ş›ÁCache
.
	`g‘IfP»£Á
(1L)).
	`isNuÎ
();

166 
	`as£¹Th©
(
ş›ÁCache
.
	`g‘IfP»£Á
(2L)).
	`isNÙNuÎ
();

167 
	}
}

169 @
Te¡


170 
public
 
	$‹¡G‘TrimM¬k
() {

171 
	`£tupNodes
();

172 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

173 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
()).
	`isEqu®To
(0);

174 
fš®
 
Tok’
 
ŒimAdd»ss
 = 
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 10);

176 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimAdd»ss
);

177 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
().
	`g‘Sequ’û
()).
	`isEqu®To
(
ŒimAdd»ss
.getSequence() + 1);

178 
	}
}

180 @
	gTe¡


181 @
Suµ»ssW¬nšgs
("unchecked")

182 
public
 
	$’su»SŒšgR—dAÎWÜks
(è
throws
 
Exû±iÚ
 {

183 
	`£tupNodes
();

184 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

186 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

188 
fš®
 
ADDRESS_0
 = 0;

189 
fš®
 
ADDRESS_1
 = 1;

190 
fš®
 
ADDRESS_2
 = 3;

191 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
ADDRESS_0
);

192 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
tok’
, 
‹¡Paylßd
);

194 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
ADDRESS_0
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

195 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

198 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’
Ôt.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
ADDRESS_1
),

199 "1".
	`g‘By‹s
());

201 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’
Ôt.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
ADDRESS_2
),

202 "3".
	`g‘By‹s
());

204 
Li¡
<
LÚg
> 
rs
 = 
Ãw
 
A¼ayLi¡
<>();

205 
rs
.
	`add
(
ADDRESS_0
);

206 
rs
.
	`add
(
ADDRESS_1
);

207 
rs
.
	`add
(
ADDRESS_2
);

209 
M­
<
LÚg
, 
ILogD©a
> 
m
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
rs
);

211 
	`as£¹Th©
(
m
.
	`g‘
(
ADDRESS_0
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

212 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

213 
	`as£¹Th©
(
m
.
	`g‘
(
ADDRESS_1
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

214 .
	`isEqu®To
("1".
	`g‘By‹s
());

215 
	`as£¹Th©
(
m
.
	`g‘
(
ADDRESS_2
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

216 .
	`isEqu®To
("3".
	`g‘By‹s
());

217 
	}
}

219 @
	gTe¡


220 @
Suµ»ssW¬nšgs
("unchecked")

221 
public
 
	$»adAÎW™hHŞeFl
(è
throws
 
Exû±iÚ
 {

222 
	`£tupNodes
();

223 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

225 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

227 
fš®
 
ADDRESS_0
 = 0;

228 
fš®
 
ADDRESS_1
 = 1;

229 
fš®
 
ADDRESS_2
 = 3;

230 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
ADDRESS_0
);

231 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
tok’
, 
‹¡Paylßd
);

233 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
ADDRESS_0
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

234 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

236 
Rªge
 
¿nge
 = Rªge.
	`şo£d
(
ADDRESS_0
, 
ADDRESS_2
);

237 
CÚtiguousS‘
<
LÚg
> 
add»s£s
 = CÚtiguousS‘.
	`ü—‹
(
¿nge
, 
Disü‘eDomaš
.
	`lÚgs
());

239 
M­
<
LÚg
, 
ILogD©a
> 
m
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
add»s£s
);

241 
	`as£¹Th©
(
m
.
	`g‘
(
ADDRESS_0
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

242 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

243 
	`as£¹Th©
(
m
.
	`g‘
(
ADDRESS_1
).
	`isHŞe
()).
	`isTrue
();

244 
	`as£¹Th©
(
m
.
	`g‘
(
ADDRESS_2
).
	`isHŞe
()).
	`isTrue
();

245 
	}
}

251 @
Te¡


252 
public
 
	$‹¡MuÉiR—dS·nsSegm’ts
() {

253 
fš®
 
£gm’tEnd
 = 5L;

254 
	`addS”v”
(
SERVERS
.
PORT_0
);

255 
	`addS”v”
(
SERVERS
.
PORT_1
);

256 
	`addS”v”
(
SERVERS
.
PORT_2
);

258 
	`boÙ¡¿pAÎS”v”s
(
Ãw
 
	`Te¡LayoutBud”
()

259 .
	`£tEpoch
(1L)

260 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

261 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

262 .
	`budSegm’t
()

263 .
	`£tS¹
(0L)

264 .
	`£tEnd
(
£gm’tEnd
)

265 .
	`budSŒe
()

266 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

267 .
	`addToSegm’t
()

268 .
	`budSŒe
()

269 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

270 .
	`addToSegm’t
()

271 .
	`addToLayout
()

272 .
	`budSegm’t
()

273 .
	`£tS¹
(
£gm’tEnd
)

274 .
	`£tEnd
(-1L)

275 .
	`budSŒe
()

276 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

277 .
	`addToSegm’t
()

278 .
	`budSŒe
()

279 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

280 .
	`addToSegm’t
()

281 .
	`addToLayout
()

282 .
	`bud
());

285 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

286 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

287 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

289 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
();

290 
¹
.
	`£tCacheDi§bËd
(
Œue
);

291 
¹
.
	`cÚÃù
();

293 
fš®
 
SŒšg
 
‹¡SŒšg
 = "hello world ";

295 
fš®
 
numAdd»s£s
 = 10L;

296 
i
 = 0L; i < 
numAdd»s£s
; i++) {

297 
Tok’Re¥Ú£
 
tok’
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
();

298 
¹
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
tok’
, (
‹¡SŒšg
 + 
i
).
	`g‘By‹s
());

301 
M­
<
LÚg
, 
ILogD©a
> 
»adResuÉ
 = 
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(

302 
CÚtiguousS‘
.
	`ü—‹
(
Rªge
.
	`şo£d
(0L, 
numAdd»s£s
 - 1), 
Disü‘eDomaš
.
	`lÚgs
()));

304 
»adResuÉ
.
	`fÜEach
((
addr
, 
d©a
) ->

305 
	`as£¹Th©
(
d©a
.
	`g‘Paylßd
(
¹
)).
	`isEqu®To
((
‹¡SŒšg
 + 
addr
).
	`g‘By‹s
()));

306 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/ChainReplicationViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

11 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”As£¹iÚs
.
	gas£¹Th©
;

19 
public
 cÏs 
	cChašR•liÿtiÚV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

22 @
	mTe¡


23 @
Suµ»ssW¬nšgs
("unchecked")

24 
public
 
	$ÿnR—dWr™eToSšgË
()

25 
throws
 
Exû±iÚ
 {

26 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

27 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

28 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

30 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(
ruÁime
.
	`g‘LayoutV›w
()

31 .
	`g‘Layout
().
	`g‘Epoch
(), 0),

32 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

33 
‹¡Paylßd
);

35 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

36 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

38 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`cÚšsSŒ—m
(
¡»amA
))

39 .
	`isTrue
();

42 @
Te¡


43 @
	`Suµ»ssW¬nšgs
("unchecked")

44 
public
 
	$ÿnR—dWr™eToSšgËCÚcu¼’t
()

45 
throws
 
Exû±iÚ
 {

46 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

48 
fš®
 
numb”Th»ads
 = 5;

49 
fš®
 
numb”RecÜds
 = 1
_000
;

51 
	`scheduËCÚcu¼’y
(
numb”Th»ads
, 
th»adNumb”
 -> {

52 
ba£
 = 
th»adNumb”
 * 
numb”RecÜds
;

53 
i
 = 
ba£
; i < ba£ + 
numb”RecÜds
; i++) {

54 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(

55 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
i
),

56 
CŞËùiÚs
.
	`sšgËtÚM­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("a"), 
Add»ss
.
NO_BACKPOINTER
)),

57 
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

60 
	`execu‹ScheduËd
(
numb”Th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

62 
	`scheduËCÚcu¼’y
(
numb”Th»ads
, 
th»adNumb”
 -> {

63 
ba£
 = 
th»adNumb”
 * 
numb”RecÜds
;

64 
i
 = 
ba£
; i < ba£ + 
numb”RecÜds
; i++) {

65 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
i
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

66 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

69 
	`execu‹ScheduËd
(
numb”Th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

70 
	}
}

72 @
	gTe¡


73 @
Suµ»ssW¬nšgs
("unchecked")

74 
public
 
	$ÿnR—dWr™eToMuÉË
()

75 
throws
 
Exû±iÚ
 {

77 
	`addS”v”
(
SERVERS
.
PORT_0
);

78 
	`addS”v”
(
SERVERS
.
PORT_1
);

79 
	`addS”v”
(
SERVERS
.
PORT_2
);

81 
	`boÙ¡¿pAÎS”v”s
(
Ãw
 
	`Te¡LayoutBud”
()

82 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

83 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

84 .
	`budSegm’t
()

85 .
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
)

86 .
	`budSŒe
()

87 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

88 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

89 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

90 .
	`addToSegm’t
()

91 .
	`addToLayout
()

92 .
	`bud
());

96 
CÜfuRuÁime
 
r
 = 
	`g‘RuÁime
().
	`cÚÃù
();

99 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

100 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

102 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(

103 
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 0),

104 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

105 
‹¡Paylßd
);

107 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

108 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

110 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L)

111 .
	`cÚšsSŒ—m
(
¡»amA
)).
	`isTrue
();

112 
	}
}

114 @
	gTe¡


115 @
Suµ»ssW¬nšgs
("unchecked")

116 
public
 
	$’su»AÎUn™sCÚšD©a
()

117 
throws
 
Exû±iÚ
 {

119 
	`addS”v”
(
SERVERS
.
PORT_0
);

120 
	`addS”v”
(
SERVERS
.
PORT_1
);

121 
	`addS”v”
(
SERVERS
.
PORT_2
);

123 
	`boÙ¡¿pAÎS”v”s
(
Ãw
 
	`Te¡LayoutBud”
()

124 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

125 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

126 .
	`budSegm’t
()

127 .
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
)

128 .
	`budSŒe
()

129 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

130 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

131 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

132 .
	`addToSegm’t
()

133 .
	`addToLayout
()

134 .
	`bud
());

137 
CÜfuRuÁime
 
r
 = 
	`g‘RuÁime
().
	`cÚÃù
();

138 
r
.
	`g‘P¬am‘”s
().
	`£tCodecTy³
(
Codec
.
Ty³
.
NONE
.
	`toSŒšg
());

140 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

141 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

143 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(0, 0),

144 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

145 
‹¡Paylßd
);

147 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

148 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

150 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`cÚšsSŒ—m
(
¡»amA
));

153 
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_0
))

154 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

155 
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_1
))

156 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

157 
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_2
))

158 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

159 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/CorfuGuidGeneratorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

7 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

15 
public
 cÏs 
	cCÜfuGuidG’”©ÜTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

17 @
Te¡


18 
public
 
	$¬eUniqueAndOrd”edLÚg
() {

19 
fš®
 
™”©iÚs
 = 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
;

20 
CÜfuGuidG’”©Ü
 
guidG’”©Ü
 = CÜfuGuidG’”©Ü.
	`g‘In¡ªû
(
	`g‘DeçuÉRuÁime
().
	`cÚÃù
());

21 
Ï¡V®ue
 = 0;

22 
HashS‘
<
LÚg
> 
uniq
 = 
Ãw
 HashS‘<>(
™”©iÚs
);

23 
i
 = 0; i < 
™”©iÚs
; i++) {

24 
cu¼’t
 = 
guidG’”©Ü
.
	`ÃxtLÚg
();

25 
CÜfuGuid
 
ts
 = 
Ãw
 
	`CÜfuGuid
(
cu¼’t
);

27 
	`as£¹Th©
(
ts
.
	`g‘UniqueIn¡ªûId
()).
	`isLessThª
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

28 
	`as£¹Th©
(
guidG’”©Ü
.
	`toSŒšg
(
cu¼’t
)).
	`isNÙNuÎ
();

30 
	`as£¹Th©
(
uniq
).
	`dÛsNÙCÚš
(
cu¼’t
);

32 
	`as£¹Th©
(
cu¼’t
).
	`isG»©”Thª
(
Ï¡V®ue
);

33 
Ï¡V®ue
 = 
cu¼’t
;

34 
uniq
.
	`add
(
cu¼’t
);

37 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/LayoutManagementViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gLayoutModifiÿtiÚExû±iÚ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
.
	gR•liÿtiÚMode
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

19 @
Slf4j


20 
public
 cÏs 
	cLayoutMªagem’tV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

22 @
Te¡


23 
public
 
	$»moveNodeTe¡
(è
throws
 
Exû±iÚ
 {

27 
	`addS”v”
(
SERVERS
.
PORT_0
);

28 
	`addS”v”
(
SERVERS
.
PORT_1
);

29 
	`addS”v”
(
SERVERS
.
PORT_2
);

31 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

32 .
	`£tEpoch
(1L)

33 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

34 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

35 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

36 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

37 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

38 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

39 .
	`budSegm’t
()

40 .
	`£tR•liÿtiÚMode
(
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

41 .
	`budSŒe
()

42 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

43 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

44 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

45 .
	`addToSegm’t
()

46 .
	`addToLayout
()

47 .
	`bud
();

48 
	`boÙ¡¿pAÎS”v”s
(
l
);

50 
CÜfuRuÁime
 
r
 = 
	`g‘RuÁime
().
	`cÚÃù
();

53 
r
.
	`šv®id©eLayout
();

54 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
r
.
	`g‘LayoutV›w
().
	`g‘Layout
());

55 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`LayoutBud”
(
Ïyout
)

56 .
	`»moveLayoutS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

57 .
	`»moveSequ’ûrS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

58 .
	`»moveLogun™S”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

59 .
	`»moveUÄe¥ÚsiveS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

60 .
	`£tEpoch
(
Ïyout
.
	`g‘Epoch
() + 1)

61 .
	`bud
();

63 
x
 = 0; x < 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘Inv®id©eR‘ry
(); x++) {

64 
Œy
 {

65 
r
.
	`g‘LayoutMªagem’tV›w
().
	`»moveNode
(
Ïyout
, 
	`g‘Endpošt
(
SERVERS
.
PORT_2
));

66 
r
.
	`šv®id©eLayout
();

68 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
e
) {

73 
r
.
	`šv®id©eLayout
();

74 
Layout
 
l2
 = 
r
.
	`g‘LayoutV›w
().
	`g‘Layout
();

77 
	`as£¹Th©
(
l2
).
	`isEqu®To
(
ex³ùedLayout
);

79 
•och
 = 
r
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

84 
	`as£¹Th©ThrownBy
((è-> 
r
.
	`g‘LayoutMªagem’tV›w
().
	`»moveNode
(
l2
, 
	`g‘Endpošt
(
SERVERS
.
PORT_1
)))

85 .
	`isIn¡ªûOf
(
LayoutModifiÿtiÚExû±iÚ
.
şass
);

88 
	`as£¹Th©
(
r
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(
•och
);

95 @
Te¡


96 
public
 
	$‹¡RemoveNodeR—ssignsRe¥ÚsiveSequ’ûr
(è
throws
 
Exû±iÚ
 {

98 
	`addS”v”
(
SERVERS
.
PORT_0
);

99 
	`addS”v”
(
SERVERS
.
PORT_1
);

100 
	`addS”v”
(
SERVERS
.
PORT_2
);

102 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

103 .
	`£tEpoch
(1L)

104 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

105 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

106 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

107 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

108 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

109 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

110 .
	`budSegm’t
()

111 .
	`£tR•liÿtiÚMode
(
R•liÿtiÚMode
.
CHAIN_REPLICATION
)

112 .
	`budSŒe
()

113 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

114 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

115 .
	`addToSegm’t
()

116 .
	`addToLayout
()

117 .
	`addUÄe¥ÚsiveS”v”
(
SERVERS
.
PORT_1
)

118 .
	`bud
();

119 
	`boÙ¡¿pAÎS”v”s
(
l
);

122 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`shutdown
();

123 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`shutdown
();

124 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`shutdown
();

126 
CÜfuRuÁime
 
¹
 = 
	`g‘RuÁime
().
	`cÚÃù
();

128 
¹
.
	`šv®id©eLayout
();

129 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
());

133 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`LayoutBud”
(
Ïyout
)

134 .
	`»moveLayoutS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

135 .
	`»moveSequ’ûrS”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

136 .
	`»moveLogun™S”v”
(
	`g‘Endpošt
(
SERVERS
.
PORT_2
))

137 .
	`£tEpoch
(
Ïyout
.
	`g‘Epoch
() + 1)

138 .
	`bud
();

139 
ex³ùedLayout
.
	`£tSequ’ûrs
(
A¼ays
.
	`asLi¡
(
SERVERS
.
ENDPOINT_0
, SERVERS.
ENDPOINT_1
));

142 
x
 = 0; x < 
ruÁime
.
	`g‘P¬am‘”s
().
	`g‘Inv®id©eR‘ry
(); x++) {

143 
Œy
 {

144 
¹
.
	`g‘LayoutMªagem’tV›w
().
	`»moveNode
(
Ïyout
, 
	`g‘Endpošt
(
SERVERS
.
PORT_2
));

145 
¹
.
	`šv®id©eLayout
();

147 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
e
) {

152 
¹
.
	`šv®id©eLayout
();

153 
Layout
 
l2
 = 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
();

157 
	`as£¹Th©
(
l2
).
	`isEqu®To
(
ex³ùedLayout
);

158 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/LayoutSealTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

6 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

8 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

9 
impÜt
 
	gjava
.
	gut
.
	gM­
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

22 
public
 cÏs 
	cLayoutS—lTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

32 
public
 
RuÁimeLayout
 
	$g‘RuÁimeLayout
(
Layout
.
R•liÿtiÚMode
 
»¶iÿtiÚMode
) {

33 
	`addS”v”
(
SERVERS
.
PORT_0
);

34 
	`addS”v”
(
SERVERS
.
PORT_1
);

35 
	`addS”v”
(
SERVERS
.
PORT_2
);

36 
	`addS”v”
(
SERVERS
.
PORT_3
);

37 
	`addS”v”
(
SERVERS
.
PORT_4
);

39 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

40 .
	`£tEpoch
(1)

41 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

42 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

43 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

44 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

45 .
	`budSegm’t
()

46 .
	`£tR•liÿtiÚMode
(
»¶iÿtiÚMode
)

47 .
	`budSŒe
()

48 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

49 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

50 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

51 .
	`addToSegm’t
()

52 .
	`budSŒe
()

53 .
	`addLogUn™
(
SERVERS
.
PORT_3
)

54 .
	`addLogUn™
(
SERVERS
.
PORT_4
)

55 .
	`addToSegm’t
()

56 .
	`addToLayout
()

57 .
	`bud
();

58 
	`boÙ¡¿pAÎS”v”s
(
l
);

59 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

60 
RuÁimeLayout
 
ruÁimeLayout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
);

61 
	`£tAgg»ssiveTimeouts
(
ruÁimeLayout
);

63 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

64 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

65 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

66 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_3
).
	`shutdown
();

67 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_4
).
	`shutdown
();

68  
ruÁimeLayout
;

74 
public
 
	$£tAgg»ssiveTimeouts
(
RuÁimeLayout
 
ruÁimeLayout
) {

76 
Li¡
<
IÁeg”
> 
£rv”PÜts
 = 
Ãw
 
A¼ayLi¡
<>();

77 
£rv”PÜts
.
	`add
(
SERVERS
.
PORT_0
);

78 
£rv”PÜts
.
	`add
(
SERVERS
.
PORT_1
);

79 
£rv”PÜts
.
	`add
(
SERVERS
.
PORT_2
);

80 
£rv”PÜts
.
	`add
(
SERVERS
.
PORT_3
);

81 
£rv”PÜts
.
	`add
(
SERVERS
.
PORT_4
);

82 
Li¡
<
SŒšg
> 
rou‹rEndpošts
 = 
Ãw
 
A¼ayLi¡
<>();

83 
rou‹rEndpošts
.
	`add
(
SERVERS
.
ENDPOINT_0
);

84 
rou‹rEndpošts
.
	`add
(
SERVERS
.
ENDPOINT_1
);

85 
rou‹rEndpošts
.
	`add
(
SERVERS
.
ENDPOINT_2
);

86 
rou‹rEndpošts
.
	`add
(
SERVERS
.
ENDPOINT_3
);

87 
rou‹rEndpošts
.
	`add
(
SERVERS
.
ENDPOINT_4
);

88 
£rv”PÜts
.
	`fÜEach
(
£rv”PÜt
 -> {

89 
rou‹rEndpošts
.
	`fÜEach
(
rou‹rEndpošt
 -> {

90 
ruÁimeLayout
.
	`g‘RuÁime
().
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutCÚÃù
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

91 
ruÁimeLayout
.
	`g‘RuÁime
().
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutRe¥Ú£
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

92 
ruÁimeLayout
.
	`g‘RuÁime
().
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutR‘ry
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

95 
	}
}

97 
public
 
	gM­
<
	gLÚg
, 
	gIÁeg”
> 
	$cŞËùS”v”Epochs
(... 
pÜts
) {

98 
M­
<
LÚg
, 
IÁeg”
> 
»s
 = 
Ãw
 
HashM­
<>();

99 
x
 = 0; x < 
pÜts
.
Ëngth
; x++) {

100 
•och
 = 
	`g‘LayoutS”v”
(
pÜts
[
x
]).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Epoch
();

101 
couÁ
 = 
»s
.
	`g‘OrDeçuÉ
(
•och
, 0);

102 
»s
.
	`put
(
•och
, 
couÁ
 + 1);

104  
»s
;

105 
	}
}

111 
public
 
	$as£¹LayoutEpochs
(
•ochLayoutS”v”0
, 
•ochLayoutS”v”1
, 
•ochLayoutS”v”2
) {

112 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochLayoutS”v”0
);

113 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochLayoutS”v”1
);

114 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_2
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochLayoutS”v”2
);

115 
	}
}

121 
public
 
	$as£¹S”v”Rou‹rEpochs
(
•ochS”v”Rou‹r0
, 
•ochS”v”Rou‹r1
, 
•ochS”v”Rou‹r2
, 
•ochS”v”Rou‹r3
, 
•ochS”v”Rou‹r4
) {

122 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘S”v”CÚ‹xt
()

123 .
	`g‘S”v”Rou‹r
().
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochS”v”Rou‹r0
);

124 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Rou‹r
()

125 .
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochS”v”Rou‹r1
);

126 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_2
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Rou‹r
()

127 .
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochS”v”Rou‹r2
);

128 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_3
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Rou‹r
()

129 .
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochS”v”Rou‹r3
);

130 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_4
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Rou‹r
()

131 .
	`g‘S”v”Epoch
()).
	`isEqu®To
(
•ochS”v”Rou‹r4
);

132 
	}
}

139 @
Te¡


140 
public
 
	$sucûssfulChašS—l
() {

141 
RuÁimeLayout
 
ruÁimeLayout
 = 
	`g‘RuÁimeLayout
(
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
);

142 
Layout
 
l
 = 
ruÁimeLayout
.
	`g‘Layout
();

143 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

144 
ruÁimeLayout
.
	`£®MšS”v”S‘
();

146 [] 
pÜts
 = 
l
.
	`g‘AÎS”v”s
().
	`¡»am
().
	`m­ToIÁ
(
s
 -> 
IÁeg”
.
	`·r£IÁ
(s.
	`¥l™
(":")[1])).
	`toA¼ay
();

147 
M­
<
LÚg
, 
IÁeg”
> 
•ochs
 = 
	`cŞËùS”v”Epochs
(
pÜts
);

149 
	`as£¹Th©
(
•ochs
.
	`g‘
(
l
.
	`g‘Epoch
())).
	`isG»©”ThªOrEqu®To
((
pÜts
.
Ëngth
 / 2) + 1);

150 
	}
}

160 @
Te¡


161 
public
 
	$çšgChašS—l
() {

162 
RuÁimeLayout
 
ruÁimeLayout
 = 
	`g‘RuÁimeLayout
(
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
);

163 
Layout
 
l
 = 
ruÁimeLayout
.
	`g‘Layout
();

165 
	`addCl›ÁRuË
(
ruÁimeLayout
.
	`g‘RuÁime
(), 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

166 
	`addCl›ÁRuË
(
ruÁimeLayout
.
	`g‘RuÁime
(), 
SERVERS
.
ENDPOINT_3
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

167 
	`addCl›ÁRuË
(
ruÁimeLayout
.
	`g‘RuÁime
(), 
SERVERS
.
ENDPOINT_4
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

169 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

170 
	`as£¹Th©ThrownBy
(
ruÁimeLayout
::
£®MšS”v”S‘
)

171 .
	`isIn¡ªûOf
(
QuÜumUÄ—chabËExû±iÚ
.
şass
);

172 
	`as£¹LayoutEpochs
(2, 1, 2);

173 
	`as£¹S”v”Rou‹rEpochs
(2, 1, 2, 1, 1);

174 
	}
}

181 @
Te¡


182 
public
 
	$sucûssfulQuÜumS—l
() {

183 
RuÁimeLayout
 
ruÁimeLayout
 = 
	`g‘RuÁimeLayout
(
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
);

184 
Layout
 
l
 = 
ruÁimeLayout
.
	`g‘Layout
();

185 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

186 
Œy
 {

187 
ruÁimeLayout
.
	`£®MšS”v”S‘
();

188 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
e
) {

189 
e
.
	`´štSckT¿û
();

191 
	`as£¹LayoutEpochs
(2, 2, 2);

192 
	`as£¹S”v”Rou‹rEpochs
(2, 2, 2, 2, 2);

193 
	}
}

203 @
Te¡


204 
public
 
	$çšgQuÜumS—l
() {

205 
RuÁimeLayout
 
ruÁimeLayout
 = 
	`g‘RuÁimeLayout
(
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
);

206 
Layout
 
l
 = 
ruÁimeLayout
.
	`g‘Layout
();

208 
	`addCl›ÁRuË
(
ruÁimeLayout
.
	`g‘RuÁime
(), 
SERVERS
.
ENDPOINT_3
,

209 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

211 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

212 
	`as£¹Th©ThrownBy
(
ruÁimeLayout
::
£®MšS”v”S‘
)

213 .
	`isIn¡ªûOf
(
QuÜumUÄ—chabËExû±iÚ
.
şass
);

214 
	`as£¹LayoutEpochs
(2, 2, 2);

215 
	`as£¹S”v”Rou‹rEpochs
(2, 2, 2, 1, 2);

216 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/LayoutTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	ggroovy
.
	gut
.
	gloggšg
.
	gSlf4j
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

6 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

8 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

9 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gF›ld
;

10 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gModif›r
.
	gTRANSIENT
;

12 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

13 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

19 @
Slf4j


20 
public
 cÏs 
	cLayoutTe¡
 {

23 
´iv©e
 
SŒšg
 
	$g‘ResourûJSONFeAsSŒšg
(
SŒšg
 
feName
)

24 
throws
 
IOExû±iÚ
{

26  
Ãw
 
	`SŒšg
(
Fes
.
	`»adAÎBy‹s
(
P©hs
.
	`g‘
("¤c/‹¡/»sourûs/JSONLayouts", 
feName
)));

29 @
	$Te¡
(
ex³ùed
 = 
NuÎPoš‹rExû±iÚ
.
şass
)

30 
public
 
	$shouldNÙDe£rŸlizeEm±yLayout
()

31 
throws
 
Exû±iÚ
 {

33 
SŒšg
 
JSONEm±yLayout
 = 
	`g‘ResourûJSONFeAsSŒšg
("EmptyLayout.json");

34 
Layout
 
shouldY›ldExû±iÚ
 = Layout.
	`äomJSONSŒšg
(
JSONEm±yLayout
);

35 
	}
}

37 @
Te¡


38 
public
 
	$checkAÎAùiveLayoutS”v”s
(è
throws
 
IOExû±iÚ
 {

39 
SŒšg
 
JSONEm±yLayout
 = 
	`g‘ResourûJSONFeAsSŒšg
("DefaultLayout.json");

40 
Layout
 
Ïyout
 = Layout.
	`äomJSONSŒšg
(
JSONEm±yLayout
);

41 
Ïyout
.
uÄe¥ÚsiveS”v”s
.
	`add
("localhost:9001");

43 
	`as£¹Th©
(
Ïyout
.
	`g‘AùiveLayoutS”v”s
()).
	`cÚšsExaùly
("localhost:9000", "localhost:9002");

44 
	}
}

46 @
	$Te¡
(
ex³ùed
 = 
NuÎPoš‹rExû±iÚ
.
şass
)

47 
public
 
	$shouldNÙDe£rŸlizeMissšgRequœedF›ldLayout
()

48 
throws
 
Exû±iÚ
{

50 
SŒšg
 
JSONMissšgRequœedF›ldLayout
 = 
	`g‘ResourûJSONFeAsSŒšg
("MissingRequiredFieldLayout.json");

51 
Layout
 
shouldY›ldExû±iÚ
 = Layout.
	`äomJSONSŒšg
(
JSONMissšgRequœedF›ldLayout
);

52 
	}
}

54 @
	$Te¡
(
ex³ùed
 = 
NuÎPoš‹rExû±iÚ
.
şass
)

55 
public
 
	$shouldNÙDe£rŸlizeMissšgRequœedF›ldIÂ”Layout
()

56 
throws
 
Exû±iÚ
 {

57 
SŒšg
 
JSONMissšgRequœedF›ldIÂ”Layout
 = 
	`g‘ResourûJSONFeAsSŒšg
("MissingRequiredFieldInStripes.json");

58 
Layout
 
shouldY›ldExû±iÚ
 = Layout.
	`äomJSONSŒšg
(
JSONMissšgRequœedF›ldIÂ”Layout
);

59 
	}
}

61 @
Te¡


62 
public
 
	$ÿnDe£rŸlizeMissšgNÙRequœedF›ldLayout
(è
throws
 
Exû±iÚ
 {

63 
SŒšg
 
JSONMissšgNÙRequœedF›ldLayout
 = 
	`g‘ResourûJSONFeAsSŒšg
("MissingNotRequiredFieldLayout.json");

64 
Layout
 
§ãLayout
 = Layout.
	`äomJSONSŒšg
(
JSONMissšgNÙRequœedF›ldLayout
);

67 
F›ld
[] 
f›lds
 = 
Layout
.
şass
.
	`g‘Deş¬edF›lds
();

68 
F›ld
 
f
 : 
f›lds
) {

69 ià(!
f
.
	`isAcûssibË
()) {

70 
f
.
	`£tAcûssibË
(
Œue
);

74 ià(
f
.
	`g‘Modif›rs
(è!ğ
TRANSIENT
) {

75 
	`as£¹Th©
(
f
.
	`g‘
(
§ãLayout
)).
	`isNÙNuÎ
();

78 
	}
}

80 @
	$Te¡
(
ex³ùed
 = 
IÎeg®Argum’tExû±iÚ
.
şass
)

81 
public
 
	$shouldInv®id©eNÙV®idLayout
(è
throws
 
Exû±iÚ
 {

82 
SŒšg
 
JSONEm±ySequ’ûrLi¡Layout
 = 
	`g‘ResourûJSONFeAsSŒšg
("EmptyListOfSequencers.json");

83 
Layout
 
shouldY›ldExû±iÚ
 = Layout.
	`äomJSONSŒšg
(
JSONEm±ySequ’ûrLi¡Layout
);

84 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/LayoutViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOuŒªkedExû±iÚ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgClu¡”Exû±iÚ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

14 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

18 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

19 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

20 
impÜt
 
	gjava
.
	gut
.
	gM­
;

21 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.*;

22 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

24 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

25 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

30 @
Slf4j


31 
public
 cÏs 
	cLayoutV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

40 
public
 
	$£tAgg»ssiveTimeouts
(
Layout
 
Ïyout
, 
CÜfuRuÁime
... 
cÜfuRuÁimes
) {

41 
Ïyout
.
	`g‘AÎS”v”s
().
	`fÜEach
(
rou‹rEndpošt
 -> {

42 
CÜfuRuÁime
 
ruÁime
 : 
cÜfuRuÁimes
) {

43 
ruÁime
.
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutCÚÃù
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

44 
ruÁime
.
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutRe¥Ú£
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

45 
ruÁime
.
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutR‘ry
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

50 @
Te¡


51 
public
 
	$ÿnS‘Layout
()

52 
throws
 
Exû±iÚ
 {

53 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

54 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

55 .
	`£tEpoch
(1)

56 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

57 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

58 .
	`budSegm’t
()

59 .
	`budSŒe
()

60 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

61 .
	`addToSegm’t
()

62 .
	`addToLayout
()

63 .
	`£tClu¡”Id
(
r
.
şu¡”Id
)

64 .
	`bud
();

65 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

66 
r
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
l
, 1L);

67 
r
.
	`šv®id©eLayout
();

68 
	`as£¹Th©
(
r
.
	`g‘LayoutV›w
().
	`g‘Layout
().
•och
)

69 .
	`isEqu®To
(1L);

70 
	}
}

75 @
Te¡


76 
public
 
	$ÿÂÙS‘LayoutW™hWrÚgId
()

77 
throws
 
Exû±iÚ
 {

78 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

79 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

80 .
	`£tEpoch
(1)

81 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

82 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

83 .
	`budSegm’t
()

84 .
	`budSŒe
()

85 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

86 .
	`addToSegm’t
()

87 .
	`addToLayout
()

88 .
	`£tClu¡”Id
(
UUID
.
	`ÇmeUUIDFromBy‹s
("wrÚg clu¡”".
	`g‘By‹s
()))

89 .
	`bud
();

90 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

91 
r
.
	`šv®id©eLayout
();

92 
	`as£¹Th©ThrownBy
((è-> 
r
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
l
, 1L))

93 .
	`isIn¡ªûOf
(
WrÚgClu¡”Exû±iÚ
.
şass
);

94 
	}
}

96 @
Te¡


97 
public
 
	$g‘UUID
() {

98 
UUID
 
uuid
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("nsx-policy-manager‡ll_opened_streams 1183");

99 
Sy¡em
.
out
.
	`´šn
("");

100 
Sy¡em
.
out
.
	`´šn
("UUID:: " + 
uuid
);

101 
	}
}

103 @
Te¡


104 
public
 
	$ÿnTŞ”©eLayoutS”v”Fau»
()

105 
throws
 
Exû±iÚ
 {

106 
	`addS”v”
(
SERVERS
.
PORT_0
);

107 
	`addS”v”
(
SERVERS
.
PORT_1
);

109 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

110 .
	`£tEpoch
(1L)

111 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

112 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

113 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

114 .
	`budSegm’t
()

115 .
	`budSŒe
()

116 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

117 .
	`addToSegm’t
()

118 .
	`addToLayout
()

119 .
	`bud
();

120 
	`boÙ¡¿pAÎS”v”s
(
l
);

122 
CÜfuRuÁime
 
r
 = 
	`g‘RuÁime
().
	`cÚÃù
();

123 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

124 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

125 
	`£tAgg»ssiveTimeouts
(
l
, 
r
);

128 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
()

129 .
	`®ways
()

130 .
	`drİ
());

132 
r
.
	`šv®id©eLayout
();

134 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("hi")).
	`hasNext
();

135 
	}
}

149 @
Te¡


150 
public
 
	$»cÚfigu¿tiÚDuršgD©aO³¿tiÚs
()

151 
throws
 
Exû±iÚ
 {

152 
	`addS”v”
(
SERVERS
.
PORT_0
);

153 
	`addS”v”
(
SERVERS
.
PORT_1
);

154 
	`addS”v”
(
SERVERS
.
PORT_2
);

155 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

156 .
	`£tEpoch
(1L)

157 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

158 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

159 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

160 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

161 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

162 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

163 .
	`budSegm’t
()

164 .
	`budSŒe
()

165 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

166 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

167 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

168 .
	`addToSegm’t
()

169 .
	`addToLayout
()

170 .
	`bud
();

171 
	`boÙ¡¿pAÎS”v”s
(
l
);

172 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

174 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

175 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

176 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

177 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
);

180 
CouÁDownL©ch
 
¡¬tRecÚfigu¿tiÚL©ch
 = 
Ãw
 
	`CouÁDownL©ch
(1);

181 
CouÁDownL©ch
 
ÏyoutRecÚfigu»dL©ch
 = 
Ãw
 
	`CouÁDownL©ch
(1);

183 
Th»ad
 
t
 = 
Ãw
 
	`Th»ad
(() -> {

184 
Œy
 {

185 
¡¬tRecÚfigu¿tiÚL©ch
.
	`awa™
();

186 
cÜfuRuÁime
.
	`šv®id©eLayout
();

189 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

191 
Layout
 
ÃwLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

192 .
	`£tEpoch
(
l
.
	`g‘Epoch
() + 1)

193 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

194 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

195 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

196 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

197 .
	`budSegm’t
()

198 .
	`budSŒe
()

199 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

200 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

201 .
	`addToSegm’t
()

202 .
	`addToLayout
()

203 .
	`bud
();

206 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout
).
	`£®MšS”v”S‘
();

208 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
ÃwLayout
,‚ewLayout.
	`g‘Epoch
());

209 
cÜfuRuÁime
.
	`šv®id©eLayout
();

210 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

211 .
	`g‘Sequ’ûrCl›Á
(
SERVERS
.
ENDPOINT_0
)

212 .
	`boÙ¡¿p
(0L, 
CŞËùiÚs
.
	`em±yM­
(), 
ÃwLayout
.
	`g‘Epoch
(), 
Œue
).
	`g‘
();

213 
log
.
	`debug
("Ïyouˆupd©ed‚ew†ayouˆ{}", 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

214 
ÏyoutRecÚfigu»dL©ch
.
	`couÁDown
();

215 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

216 
log
.
	`”rÜ
("GOT ERROR HERE !!");

217 
e
.
	`´štSckT¿û
();

220 
t
.
	`¡¬t
();

223 
ISŒ—mV›w
 
sv
 = 
cÜfuRuÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

226 
	`wr™eAndR—dSŒ—m
(
cÜfuRuÁime
, 
sv
, 
¡¬tRecÚfigu¿tiÚL©ch
, 
ÏyoutRecÚfigu»dL©ch
);

228 
	`wr™eAndR—dSŒ—m
(
cÜfuRuÁime
, 
sv
, 
¡¬tRecÚfigu¿tiÚL©ch
, 
ÏyoutRecÚfigu»dL©ch
);

229 
t
.
	`još
();

230 
	}
}

232 
´iv©e
 
	$wr™eAndR—dSŒ—m
(
CÜfuRuÁime
 
cÜfuRuÁime
, 
ISŒ—mV›w
 
sv
, 
CouÁDownL©ch
 
¡¬tRecÚfigu¿tiÚL©ch
, CouÁDownL©ch 
ÏyoutRecÚfigu»dL©ch
è
throws
 
IÁ”ru±edExû±iÚ
 {

233 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

234 
sv
.
	`­³nd
(
‹¡Paylßd
);

235 
¡¬tRecÚfigu¿tiÚL©ch
.
	`couÁDown
();

236 
ÏyoutRecÚfigu»dL©ch
.
	`awa™
();

237 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
cÜfuRuÁime
)).
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

238 
	`as£¹Th©
(
sv
.
	`Ãxt
()).
	`isEqu®To
(
nuÎ
);

239 
	}
}

248 @
Te¡


249 
public
 
	$g‘CÚ£nsusFromCu¼’tMemb”s1Node
(è
throws
 
Exû±iÚ
 {

250 
	`addS”v”
(
SERVERS
.
PORT_0
);

251 
	`addS”v”
(
SERVERS
.
PORT_1
);

253 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

254 .
	`£tEpoch
(1L)

255 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

256 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

257 .
	`budSegm’t
()

258 .
	`budSŒe
()

259 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

260 .
	`addToSegm’t
()

261 .
	`addToLayout
()

262 .
	`bud
();

263 
	`boÙ¡¿pAÎS”v”s
(
l
);

264 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

267 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

268 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

270 
Layout
 
ÃwLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

271 .
	`£tEpoch
(2L)

272 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

273 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

274 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

275 .
	`budSegm’t
()

276 .
	`budSŒe
()

277 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

278 .
	`addToSegm’t
()

279 .
	`addToLayout
()

280 .
	`bud
();

282 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

283 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

284 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
ÃwLayout
, 1L);

286 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
ÃwLayout
);

287 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
ÃwLayout
);

288 
	}
}

300 @
Te¡


301 
public
 
	$g‘CÚ£nsusFromCu¼’tMemb”s3Nodes
(è
throws
 
Exû±iÚ
 {

302 
	`addS”v”
(
SERVERS
.
PORT_0
);

303 
	`addS”v”
(
SERVERS
.
PORT_1
);

304 
	`addS”v”
(
SERVERS
.
PORT_2
);

305 
	`addS”v”
(
SERVERS
.
PORT_3
);

307 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

308 .
	`£tEpoch
(1L)

309 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

310 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

311 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

312 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

313 .
	`budSegm’t
()

314 .
	`budSŒe
()

315 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

316 .
	`addToSegm’t
()

317 .
	`addToLayout
()

318 .
	`bud
();

319 
Layout
 
cİy
 = 
Ãw
 
	`Layout
(
l
);

320 
	`boÙ¡¿pAÎS”v”s
(
cİy
);

321 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

324 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

325 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

326 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

327 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_3
).
	`shutdown
();

329 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

331 
Layout
 
ÃwLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

332 .
	`£tEpoch
(2L)

333 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

334 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

335 .
	`addLayoutS”v”
(
SERVERS
.
PORT_3
)

336 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

337 .
	`budSegm’t
()

338 .
	`budSŒe
()

339 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

340 .
	`addToSegm’t
()

341 .
	`addToLayout
()

342 .
	`bud
();

345 
Layout
 
ŞdLayout
 = 
Ãw
 
	`Layout
(
l
);

346 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

347 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

350 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
ÃwLayout
, 1L);

352 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
ŞdLayout
);

353 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
ÃwLayout
);

354 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_2
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
ÃwLayout
);

355 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_3
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
ÃwLayout
);

356 
	}
}

358 
´iv©e
 
fš®
 
	gM­
<
	gSŒšg
, M­<
	gCÜfuMsgTy³
, 
	gLi¡
<
	gSem­hÜe
>>> 
	gmes§geLocks
 =

359 
Ãw
 
CÚcu¼’tHashM­
<>();

361 
´iv©e
 
	$hŞdMes§ge
(
CÜfuRuÁime
 
cÜfuRuÁime
, 
SŒšg
 
ş›ÁRou‹rEndpošt
,

362 
CÜfuMsgTy³
 
cÜfuMsgTy³
) {

363 
Sem­hÜe
 
lock
 = 
Ãw
 
	`Sem­hÜe
(0);

364 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
ş›ÁRou‹rEndpošt
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
msg
 -> {

365 ià(
msg
.
	`g‘MsgTy³
().
	`equ®s
(
cÜfuMsgTy³
)) {

366 
M­
<
CÜfuMsgTy³
, 
Li¡
<
Sem­hÜe
>> 
lockM­
 =

367 
mes§geLocks
.
	`g‘OrDeçuÉ
(
ş›ÁRou‹rEndpošt
, 
Ãw
 
HashM­
<>());

368 
Li¡
<
Sem­hÜe
> 
lockLi¡
 = 
lockM­
.
	`g‘OrDeçuÉ
(
cÜfuMsgTy³
, 
Ãw
 
A¼ayLi¡
<>());

369 
lockLi¡
.
	`add
(
lock
);

371 
lockM­
.
	`put
(
cÜfuMsgTy³
, 
lockLi¡
);

372 
mes§geLocks
.
	`put
(
ş›ÁRou‹rEndpošt
, 
lockM­
);

374 
Œy
 {

375 
lock
.
	`acquœe
();

376 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
e
) {

377 
e
.
	`´štSckT¿û
();

380  
Œue
;

382 
	}
}

384 
´iv©e
 
	$»Ëa£Mes§ges
(
SŒšg
 
ş›ÁRou‹rEndpošt
, 
CÜfuMsgTy³
 
cÜfuMsgTy³
) {

385 
mes§geLocks
.
	`compu‹IfP»£Á
(
ş›ÁRou‹rEndpošt
, (
s
, 
cÜfuMsgTy³Li¡M­
) -> {

386 
cÜfuMsgTy³Li¡M­
.
	`compu‹IfP»£Á
(
cÜfuMsgTy³
, (
msgTy³
, 
£m­hÜes
) -> {

387 
£m­hÜes
.
	`fÜEach
(
Sem­hÜe
::
»Ëa£
);

388  
nuÎ
;

390  
cÜfuMsgTy³Li¡M­
;

392 
	}
}

412 @
Te¡


413 
public
 
	$´•¬eR‘uºLayoutW™hHighe¡Rªk
(è
throws
 
Exû±iÚ
 {

415 
	`addS”v”
(
SERVERS
.
PORT_0
);

416 
	`addS”v”
(
SERVERS
.
PORT_1
);

417 
	`addS”v”
(
SERVERS
.
PORT_2
);

419 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

420 .
	`£tEpoch
(1L)

421 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

422 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

423 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

424 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

425 .
	`budSegm’t
()

426 .
	`budSŒe
()

427 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

428 .
	`addToSegm’t
()

429 .
	`addToLayout
()

430 .
	`bud
();

431 
	`boÙ¡¿pAÎS”v”s
(
l
);

432 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

434 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

435 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

436 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

437 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
);

439 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

440 .
	`£tEpoch
(2L)

441 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

442 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

443 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

444 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

445 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

446 .
	`budSegm’t
()

447 .
	`budSŒe
()

448 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

449 .
	`addToSegm’t
()

450 .
	`addToLayout
()

451 .
	`bud
();

453 
Layout
 
l2
 = 
Ãw
 
	`Te¡LayoutBud”
()

454 .
	`£tEpoch
(2L)

455 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

456 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

457 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

458 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

459 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

460 .
	`budSegm’t
()

461 .
	`budSŒe
()

462 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

463 .
	`addToSegm’t
()

464 .
	`addToLayout
()

465 .
	`bud
();

467 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

468 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

471 
fš®
 
¿nk1
 = 1L;

472 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_2
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

473 
Layout
 
®»adyPrİo£dLayout1
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´•¬e
(
l1
.
	`g‘Epoch
(), 
¿nk1
);

474 
	`as£¹Th©
(
®»adyPrİo£dLayout1
).
	`isNuÎ
();

475 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

476 
Œy
 {

477 
®»adyPrİo£dLayout1
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´İo£
(
l1
.
	`g‘Epoch
(), 
¿nk1
,†1);

478 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
ignÜe
) {

480 
	`as£¹Th©
(
®»adyPrİo£dLayout1
).
	`isNuÎ
();

481 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime
);

484 
fš®
 
¿nk2
 = 2L;

485 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_0
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

486 
Layout
 
®»adyPrİo£dLayout2
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´•¬e
(
l2
.
	`g‘Epoch
(), 
¿nk2
);

487 
	`as£¹Th©
(
®»adyPrİo£dLayout2
).
	`isNuÎ
();

488 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_2
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

489 
Œy
 {

490 
®»adyPrİo£dLayout2
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´İo£
(
l2
.
	`g‘Epoch
(), 
¿nk2
,†2);

491 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
ignÜe
) {

493 
	`as£¹Th©
(
®»adyPrİo£dLayout2
).
	`isNuÎ
();

494 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime
);

497 
fš®
 
¿nk3
 = 3L;

498 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_2
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

499 
Layout
 
®»adyPrİo£dLayout3
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´•¬e
(
l
.
	`g‘Epoch
(), 
¿nk3
);

500 
	`as£¹Th©
(
®»adyPrİo£dLayout3
).
	`isEqu®To
(
l2
);

501 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime
);

503 
fš®
 
¿nk4
 = 4L;

504 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

505 
®»adyPrİo£dLayout3
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´•¬e
(
l
.
	`g‘Epoch
(), 
¿nk4
);

506 
	`as£¹Th©
(
®»adyPrİo£dLayout3
).
	`isEqu®To
(
l1
);

507 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime
);

509 
fš®
 
¿nk5
 = 5L;

510 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_0
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

511 
®»adyPrİo£dLayout3
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`´•¬e
(
l
.
	`g‘Epoch
(), 
¿nk5
);

512 
	`as£¹Th©
(
®»adyPrİo£dLayout3
).
	`isEqu®To
(
l2
);

513 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime
);

514 
	}
}

535 @
Te¡


536 
public
 
	$d–ayedPrİo£Te¡
(è
throws
 
Exû±iÚ
 {

538 
	`addS”v”
(
SERVERS
.
PORT_0
);

539 
	`addS”v”
(
SERVERS
.
PORT_1
);

540 
	`addS”v”
(
SERVERS
.
PORT_2
);

542 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

543 .
	`£tEpoch
(1L)

544 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

545 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

546 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

547 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

548 .
	`budSegm’t
()

549 .
	`budSŒe
()

550 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

551 .
	`addToSegm’t
()

552 .
	`addToLayout
()

553 .
	`bud
();

554 
	`boÙ¡¿pAÎS”v”s
(
l
);

555 
CÜfuRuÁime
 
cÜfuRuÁime1
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

556 
CÜfuRuÁime
 
cÜfuRuÁime2
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

558 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

559 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

560 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

561 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime1
, 
cÜfuRuÁime2
);

563 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

564 .
	`£tEpoch
(2L)

565 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

566 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

567 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

568 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

569 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

570 .
	`budSegm’t
()

571 .
	`budSŒe
()

572 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

573 .
	`addToSegm’t
()

574 .
	`addToLayout
()

575 .
	`bud
();

577 
Layout
 
l2
 = 
Ãw
 
	`Te¡LayoutBud”
()

578 .
	`£tEpoch
(2L)

579 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

580 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

581 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

582 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

583 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

584 .
	`budSegm’t
()

585 .
	`budSŒe
()

586 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

587 .
	`addToSegm’t
()

588 .
	`addToLayout
()

589 .
	`bud
();

591 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

592 
cÜfuRuÁime1
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

594 
Sem­hÜe
 
´İo£Lock
 = 
Ãw
 
	`Sem­hÜe
(0);

595 
ExecutÜS”viû
 
executÜS”viû
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
();

598 
fš®
 
¿nk1
 = 1L;

599 
Layout
 
®»adyPrİo£dLayout1
 = 
cÜfuRuÁime1
.
	`g‘LayoutV›w
().
	`´•¬e
(
l1
.
	`g‘Epoch
(), 
¿nk1
);

600 
	`as£¹Th©
(
®»adyPrİo£dLayout1
).
	`isNuÎ
();

603 
	`addCl›ÁRuË
(
cÜfuRuÁime1
, 
SERVERS
.
ENDPOINT_2
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

606 
	`addCl›ÁRuË
(
cÜfuRuÁime1
, 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
msg
 -> {

607 ià(
msg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
LAYOUT_PROPOSE
)) {

608 
´İo£Lock
.
	`»Ëa£
();

610  
Œue
;

612 
	`hŞdMes§ge
(
cÜfuRuÁime1
, 
SERVERS
.
ENDPOINT_1
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE
);

615 
Futu»
<
BoŞ—n
> 
futu»
 = 
executÜS”viû
.
	`subm™
(() -> {

616 
Œy
 {

617 
cÜfuRuÁime1
.
	`g‘LayoutV›w
().
	`´İo£
(
l1
.
	`g‘Epoch
(), 
¿nk1
,†1);

618 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
e
) {

619  
Œue
;

620 } 
	`ÿtch
 (
OuŒªkedExû±iÚ
 
ignÜe
) {

622  
çl£
;

625 
AtomicBoŞ—n
 
´İo§lRejeùed
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

626 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
msg
 -> {

627 ià(
msg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
LAYOUT_PROPOSE_REJECT
)) {

628 
´İo§lRejeùed
.
	`£t
(
Œue
);

630  
Œue
;

633 
´İo£Lock
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

635 
fš®
 
¿nk2
 = 2L;

636 
	`addCl›ÁRuË
(
cÜfuRuÁime2
, 
SERVERS
.
ENDPOINT_0
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

637 
Layout
 
®»adyPrİo£dLayout2
 = 
cÜfuRuÁime2
.
	`g‘LayoutV›w
().
	`´•¬e
(
l2
.
	`g‘Epoch
(), 
¿nk2
);

638 
	`as£¹Th©
(
®»adyPrİo£dLayout2
).
	`isNuÎ
();

640 
mes§geLocks
.
	`isEm±y
()) {

641 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

644 
	`»Ëa£Mes§ges
(
SERVERS
.
ENDPOINT_1
, 
CÜfuMsgTy³
.
LAYOUT_PROPOSE
);

645 
Œy
 {

646 
®»adyPrİo£dLayout2
 = 
cÜfuRuÁime2
.
	`g‘LayoutV›w
().
	`´İo£
(
l2
.
	`g‘Epoch
(), 
¿nk2
,†2);

647 
	`as£¹Th©
(
®»adyPrİo£dLayout2
).
	`isEqu®To
(
l2
);

648 } 
	`ÿtch
 (
QuÜumUÄ—chabËExû±iÚ
 
ignÜe
) {

653 
	`as£¹Th©
(
futu»
.
	`g‘
()).
	`isTrue
();

654 
	`as£¹Th©
(
´İo§lRejeùed
.
	`g‘
()).
	`isTrue
();

656 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime1
);

658 
fš®
 
¿nk3
 = 3L;

659 
Layout
 
®»adyPrİo£dLayout3
 = 
cÜfuRuÁime1
.
	`g‘LayoutV›w
().
	`´•¬e
(
l
.
	`g‘Epoch
(), 
¿nk3
);

660 
	`as£¹Th©
(
®»adyPrİo£dLayout3
).
	`isEqu®To
(
l2
);

661 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/LogUnitSealTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gLogUn™Cl›Á
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

10 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

11 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

13 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©Code
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

23 
public
 cÏs 
	cLogUn™S—lTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

25 
´iv©e
 
RuÁimeLayout
 
	$g‘RuÁimeLayout
(
•och
) {

26 
	`addS”v”
(
SERVERS
.
PORT_0
);

28 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

29 .
	`£tEpoch
(
•och
)

30 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

31 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

32 .
	`budSegm’t
()

33 .
	`budSŒe
()

34 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

35 .
	`addToSegm’t
()

36 .
	`addToLayout
()

37 .
	`bud
();

39 
	`boÙ¡¿pAÎS”v”s
(
l
);

40 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

41 
RuÁimeLayout
 
ruÁimeLayout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
);

43 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

45  
ruÁimeLayout
;

53 @
Te¡


54 
public
 
	$checkO³¿tiÚW™hOldEpochFaedAá”S—l
() {

55 
•och
 = 1L;

56 
RuÁimeLayout
 
ruÁimeLayout
 = 
	`g‘RuÁimeLayout
(
•och
);

57 
Layout
 
Ïyout
 = 
ruÁimeLayout
.
	`g‘Layout
();

58 
LogUn™Cl›Á
 
ş›Á
 = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
);

59 
Li¡
<
Com¶‘abËFutu»
<
BoŞ—n
>> 
sucûssOpFutu»s2
 = 
Ãw
 
A¼ayLi¡
<>();

60 
Li¡
<
Com¶‘abËFutu»
<
BoŞ—n
>> 
çedOpFutu»s
 = 
Ãw
 
A¼ayLi¡
<>();

62 
fš®
 
numOp
 = 3;

63 
add»ss
 = 0L;

65 
i
 = 0; i < 
numOp
; i++) {

66 
LogD©a
 
ld
 = LogD©a.
	`g‘HŞe
(
add»ss
++);

67 
ş›Á
.
	`wr™e
(
ld
).
	`još
();

71 
Ïyout
.
	`£tEpoch
Öayout.
	`g‘Epoch
() + 1);

72 
ruÁimeLayout
.
	`£®MšS”v”S‘
();

77 
	`as£¹Th©ThrownBy
((è-> 
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
)

78 .
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Rou‹r
().
	`£tS”v”Epoch
(
•och
))

79 .
	`isExaùlyIn¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
);

82 
i
 = 0; i < 
numOp
; i++) {

83 
LogD©a
 
ld
 = LogD©a.
	`g‘HŞe
(
add»ss
++);

84 
çedOpFutu»s
.
	`add
(
ş›Á
.
	`wr™e
(
ld
));

88 
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘S”v”CÚ‹xt
().
	`g‘S”v”Rou‹r
().
	`£tS”v”Epoch
(
Ïyout
.
	`g‘Epoch
());

89 
ruÁimeLayout
 = 
Ãw
 
	`RuÁimeLayout
(
Ïyout
, 
	`g‘RuÁime
(layout));

90 
ş›Á
 = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
);

93 
i
 = 0; i < 
numOp
; i++) {

94 
LogD©a
 
ld
 = LogD©a.
	`g‘HŞe
(
add»ss
++);

95 
sucûssOpFutu»s2
.
	`add
(
ş›Á
.
	`wr™e
(
ld
));

100 
çedOpFutu»s
.
	`fÜEach
(
f
 -> 
	`as£¹Th©ThrownBy
(f::
g‘
)

101 .
	`isIn¡ªûOf
(
ExecutiÚExû±iÚ
.
şass
)

102 .
	`hasCau£ExaùlyIn¡ªûOf
(
WrÚgEpochExû±iÚ
.
şass
));

104 
sucûssOpFutu»s2
.
	`fÜEach
(
f
 -> 
	`as£¹Th©Code
(f::
g‘
).
	`dÛsNÙThrowAnyExû±iÚ
());

105 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/ManagementViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gSequ’ûrS”v”
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuPaylßdMsg
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLayoutComm™‹dReque¡
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gNodeS‹
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSequ’ûrM‘rics
.
	gSequ’ûrStus
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gçu»d‘eùÜ
.
	gNodeCÚÃùiv™y
.
	gNodeCÚÃùiv™yTy³
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gICÜfuTabË
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gAbÜtCau£
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”v”NÙR—dyExû±iÚ
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

28 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

29 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gCÚÃùiv™yStus
;

30 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

31 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

32 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
;

33 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

35 
impÜt
 
	gjava
.
	gut
.
	gA¼ays
;

36 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

37 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

38 
impÜt
 
	gjava
.
	gut
.
	gM­
;

39 
impÜt
 
	gjava
.
	gut
.
	gRªdom
;

40 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

41 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

42 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCouÁDownL©ch
;

43 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutiÚExû±iÚ
;

44 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

45 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

46 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicBoŞ—n
;

48 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

49 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

50 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Uts
.
	g£tAgg»ssiveTimeouts
;

51 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Uts
.
	gwa™FÜLayoutChªge
;

52 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

59 @
Slf4j


60 
public
 cÏs 
	cMªagem’tV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

62 @
G‘‹r


63 
´Ùeùed
 
CÜfuRuÁime
 
	mcÜfuRuÁime
 = 
nuÎ
;

65 
´iv©e
 
	$wa™FÜSequ’ûrToBoÙ¡¿p
(
´im¬ySequ’ûrPÜt
è
throws
 
IÁ”ru±edExû±iÚ
 {

67 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

68 ià(
	`g‘Sequ’ûr
(
´im¬ySequ’ûrPÜt
).
	`g‘Sequ’ûrEpoch
(è!ğ
Layout
.
INVALID_EPOCH
) {

71 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

73 
As£¹
.
	`ç
();

83 @
Te¡


84 
public
 
	$švokeFau»HªdËr
()

85 
throws
 
Exû±iÚ
 {

89 
fš®
 
Sem­hÜe
 
çu»D‘eùed
 = 
Ãw
 
	`Sem­hÜe
(1, 
Œue
);

91 
	`addS”v”
(
SERVERS
.
PORT_0
);

92 
	`addS”v”
(
SERVERS
.
PORT_1
);

93 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

94 .
	`£tEpoch
(1L)

95 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

96 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

97 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

98 .
	`budSegm’t
()

99 .
	`budSŒe
()

100 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

101 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

102 .
	`addToSegm’t
()

103 .
	`addToLayout
()

104 .
	`bud
();

105 
	`boÙ¡¿pAÎS”v”s
(
l
);

108 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

110 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

113 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

114 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

116 
çu»D‘eùed
.
	`acquœe
();

119 
	`addS”v”RuË
(
SERVERS
.
PORT_0
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

123 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

124 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 -> {

125 ià(
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³


126 .
MANAGEMENT_FAILURE_DETECTED
)) {

127 
çu»D‘eùed
.
	`»Ëa£
();

129  
Œue
;

132 
	`as£¹Th©
(
çu»D‘eùed
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toNªos
(),

133 
TimeUn™
.
NANOSECONDS
)).
	`isEqu®To
(
Œue
);

134 
	}
}

142 @
Te¡


143 
public
 
	$»moveSšgËNodeFau»
() {

144 
	`addS”v”
(
SERVERS
.
PORT_0
);

145 
	`addS”v”
(
SERVERS
.
PORT_1
);

146 
	`addS”v”
(
SERVERS
.
PORT_2
);

148 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

149 .
	`£tEpoch
(1L)

150 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

151 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

152 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

153 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

154 .
	`budSegm’t
()

155 .
	`budSŒe
()

156 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

157 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

158 .
	`addToSegm’t
()

159 .
	`addToLayout
()

160 .
	`bud
();

161 
	`boÙ¡¿pAÎS”v”s
(
l
);

163 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

166 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

167 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

168 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

169 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

172 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
, SERVERS.
PORT_1
, SERVERS.
PORT_2
);

175 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

176 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

179 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
SERVERS
.
ENDPOINT_1
) &&

180 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
() == 1,

181 
cÜfuRuÁime
);

184 
Layout
 
l2
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

185 
	`as£¹Th©
(
l2
.
	`g‘Epoch
()).
	`isG»©”Thª
(
l
.getEpoch());

186 
	`as£¹Th©
(
l2
.
	`g‘LayoutS”v”s
().
	`size
()).
	`isEqu®To
(
l
.
	`g‘AÎS”v”s
().size());

187 
	`as£¹Th©
(
l2
.
	`g‘AÎAùiveS”v”s
().
	`size
()).
	`isEqu®To
(
l
.
	`g‘AÎS”v”s
().size() - 1);

188 
	`as£¹Th©
(
l2
.
	`g‘UÄe¥ÚsiveS”v”s
()).
	`cÚšs
(
SERVERS
.
ENDPOINT_1
);

189 
	}
}

191 
´iv©e
 
Layout
 
	$g‘Mªagem’tTe¡Layout
(è
throws
 
IÁ”ru±edExû±iÚ
 {

192 
	`addS”v”
(
SERVERS
.
PORT_0
);

193 
	`addS”v”
(
SERVERS
.
PORT_1
);

194 
	`addS”v”
(
SERVERS
.
PORT_2
);

196 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

197 .
	`£tEpoch
(1L)

198 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

199 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

200 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

201 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

202 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

203 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

204 .
	`budSegm’t
()

205 .
	`budSŒe
()

206 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

207 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

208 .
	`addToSegm’t
()

209 .
	`addToLayout
()

210 .
	`£tClu¡”Id
(
UUID
.
	`¿ndomUUID
())

211 .
	`bud
();

212 
	`boÙ¡¿pAÎS”v”s
(
l
);

213 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

215 
	`wa™FÜSequ’ûrToBoÙ¡¿p
(
SERVERS
.
PORT_0
);

218 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

219 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

220 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

221 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

223 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
, SERVERS.
PORT_1
, SERVERS.
PORT_2
);

225  
l
;

226 
	}
}

228 
´iv©e
 
Layout
 
	$g‘3NodeLayout
(è
throws
 
IÁ”ru±edExû±iÚ
 {

229 
	`addS”v”
(
SERVERS
.
PORT_0
);

230 
	`addS”v”
(
SERVERS
.
PORT_1
);

231 
	`addS”v”
(
SERVERS
.
PORT_2
);

233 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

234 .
	`£tEpoch
(1L)

235 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

236 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

237 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

238 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

239 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

240 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

241 .
	`budSegm’t
()

242 .
	`budSŒe
()

243 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

244 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

245 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

246 .
	`addToSegm’t
()

247 .
	`addToLayout
()

248 .
	`£tClu¡”Id
(
UUID
.
	`¿ndomUUID
())

249 .
	`bud
();

250 
	`boÙ¡¿pAÎS”v”s
(
l
);

251 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

253 
	`wa™FÜSequ’ûrToBoÙ¡¿p
(
SERVERS
.
PORT_0
);

256 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

257 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

258 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

259 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

261 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
, SERVERS.
PORT_1
, SERVERS.
PORT_2
);

263  
l
;

264 
	}
}

274 @
Te¡


275 
public
 
	$checkNodeS‹
()

276 
throws
 
Exû±iÚ
 {

277 
	`addS”v”
(
SERVERS
.
PORT_0
);

279 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

280 .
	`£tEpoch
(1L)

281 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

282 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

283 .
	`budSegm’t
()

284 .
	`budSŒe
()

285 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

286 .
	`addToSegm’t
()

287 .
	`addToLayout
()

288 .
	`bud
();

289 
	`boÙ¡¿pAÎS”v”s
(
l
);

292 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

295 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

296 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

298 
NodeS‹
 
nodeS‹
ğ
nuÎ
;

301 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

303 
nodeS‹
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

304 .
	`g‘Mªagem’tCl›Á
(
SERVERS
.
ENDPOINT_0
).
	`£ndNodeS‹Reque¡
().
	`g‘
();

306 ià(
nodeS‹
.
	`g‘CÚÃùiv™y
().
	`g‘Ty³
(è=ğ
NodeCÚÃùiv™yTy³
.
CONNECTED


307 && !
nodeS‹
.
	`g‘CÚÃùiv™y
().
	`g‘CÚÃùedNodes
().
	`isEm±y
()) {

310 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

312 
	`as£¹Th©
(
nodeS‹
).
	`isNÙNuÎ
();

313 
	`as£¹Th©
(
nodeS‹
.
	`g‘CÚÃùiv™y
()).
	`isNÙNuÎ
();

314 
	`as£¹Th©
(
nodeS‹
.
	`g‘CÚÃùiv™y
().
	`g‘CÚÃùedNodes
()).
	`cÚšs
(
SERVERS
.
ENDPOINT_0
);

315 
	}
}

336 @
Te¡


337 
public
 
	$hªdËT¿ns›ÁFau»
(è
throws
 
Exû±iÚ
 {

338 
log
.
	`šfo
("Boolean flagurnedorue whenhe MANAGEMENT_FAILURE_DETECTED message " +

341 
fš®
 
Sem­hÜe
 
çu»D‘eùed
 = 
Ãw
 
	`Sem­hÜe
(2, 
Œue
);

343 
	`addS”v”
(
SERVERS
.
PORT_0
);

344 
	`addS”v”
(
SERVERS
.
PORT_1
);

345 
	`addS”v”
(
SERVERS
.
PORT_2
);

347 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

348 .
	`£tEpoch
(1L)

349 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

350 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

351 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

352 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

353 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

354 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

355 .
	`budSegm’t
()

356 .
	`budSŒe
()

357 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

358 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

359 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

360 .
	`addToSegm’t
()

361 .
	`addToLayout
()

362 .
	`£tClu¡”Id
(
UUID
.
	`¿ndomUUID
())

363 .
	`bud
();

364 
	`boÙ¡¿pAÎS”v”s
(
l
);

365 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

367 
	`wa™FÜSequ’ûrToBoÙ¡¿p
(
SERVERS
.
PORT_0
);

369 
log
.
	`šfo
("Setting‡ggressiveimeouts");

370 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

371 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

372 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

373 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

375 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
, SERVERS.
PORT_1
, SERVERS.
PORT_2
);

377 
çu»D‘eùed
.
	`acquœe
(2);

379 
log
.
	`šfo
("Only‡llow SERVERS.PORT_0o manage failures. Preventhe other servers from handling failures.");

380 
Te¡RuË
 
‹¡RuË
 = 
Ãw
 
	`Te¡RuË
()

381 .
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
SEAL
)

382 || 
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
))

383 .
	`drİ
();

385 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

386 
SERVERS
.
ENDPOINT_1
, 
‹¡RuË
);

387 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

388 
SERVERS
.
ENDPOINT_2
, 
‹¡RuË
);

389 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

390 
SERVERS
.
ENDPOINT_1
, 
‹¡RuË
);

391 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

392 
SERVERS
.
ENDPOINT_2
, 
‹¡RuË
);

393 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

394 
SERVERS
.
ENDPOINT_1
, 
‹¡RuË
);

395 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

396 
SERVERS
.
ENDPOINT_2
, 
‹¡RuË
);

399 
log
.
	`šfo
("Prevent ENDPOINT_1 from sealing.");

400 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

401 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
()

402 .
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
SEAL
))

403 .
	`drİ
());

404 
log
.
	`šfo
("Simulate ENDPOINT_2 failure from ENDPOINT_1 (only Management Server)");

405 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

406 
SERVERS
.
ENDPOINT_2
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

408 
log
.
	`šfo
("Adding‡„ule on SERVERS.PORT_1oogglehe flag when it " +

411 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

412 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 -> {

413 ià(
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
)) {

414 
çu»D‘eùed
.
	`»Ëa£
();

416  
Œue
;

419 
log
.
	`šfo
("Go‡head when sealing of ENDPOINT_0akes…lace.");

420 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

421 ià(
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_0
).
	`g‘S”v”Epoch
() == 2L) {

422 
çu»D‘eùed
.
	`»Ëa£
();

425 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

428 
	`as£¹Th©
(
çu»D‘eùed
.
	`ŒyAcquœe
(2, 
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toNªos
(),

429 
TimeUn™
.
NANOSECONDS
)).
	`isEqu®To
(
Œue
);

431 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

432 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 ->

433 
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
))

434 .
	`drİ
());

436 
log
.
	`šfo
("Asserthat only‡…artial seal was successful. " +

439 
	`as£¹Th©
(
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_0
).
	`g‘S”v”Epoch
()).
	`isEqu®To
(2L);

440 
	`as£¹Th©
(
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_1
).
	`g‘S”v”Epoch
()).
	`isEqu®To
(1L);

441 
	`as£¹Th©
(
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_2
).
	`g‘S”v”Epoch
()).
	`isEqu®To
(1L);

442 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
()).
	`isEqu®To
(1L);

443 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
()).
	`isEqu®To
(1L);

444 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_2
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
()).
	`isEqu®To
(1L);

447 
log
.
	`šfo
("Simulate‚ormal operations for‡ll servers‡nd clients.");

448 
	`ş—rCl›ÁRuËs
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

451 
log
.
	`šfo
("Allow management servero detect…artial seal‡nd correcthis issue.");

452 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

453 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

454 
log
.
	`šfo
("Assert successful seal of‡ll servers.");

456 
£rv”0Epoch
 = 
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_0
).
	`g‘S”v”Epoch
();

457 
£rv”1Epoch
 = 
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_1
).
	`g‘S”v”Epoch
();

458 
£rv”2Epoch
 = 
	`g‘S”v”Rou‹r
(
SERVERS
.
PORT_2
).
	`g‘S”v”Epoch
();

459 
£rv”0LayoutEpoch
 = 
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
();

460 
£rv”1LayoutEpoch
 = 
	`g‘LayoutS”v”
(
SERVERS
.
PORT_1
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
();

461 
£rv”2LayoutEpoch
 = 
	`g‘LayoutS”v”
(
SERVERS
.
PORT_2
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
();

463 
Li¡
<
LÚg
> 
•ochs
 = 
A¼ays
.
	`asLi¡
(

464 
£rv”0Epoch
, 
£rv”1Epoch
, 
£rv”2Epoch
,

465 
£rv”0LayoutEpoch
, 
£rv”1LayoutEpoch
, 
£rv”2LayoutEpoch


468 ià(
•ochs
.
	`¡»am
().
	`®lM©ch
(
•och
 ->ƒpoch == 2)) {

471 
log
.
	`w¬n
("Th£® i nÙ com¶‘y‘. Wa™ fÜ‚exˆ™”©iÚ. S”v” •ochs: {}", 
•ochs
);

473 
	`ç
();

475 
	}
}

477 
´iv©e
 
	$šduûSequ’ûrFau»AndWa™
() {

479 
cu¼’tEpoch
 = 
	`g‘CÜfuRuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
();

483 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

484 
	`addS”v”RuË
(
SERVERS
.
PORT_0
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

487 
	`wa™FÜLayoutChªge
(
Ïyout
 ->

488 
Ïyout
.
	`g‘Epoch
(è> 
cu¼’tEpoch
 && !Ïyout.
	`g‘Prim¬ySequ’ûr
().
	`equ®s
(
SERVERS
.
ENDPOINT_0
),

489 
	`g‘CÜfuRuÁime
());

490 
	}
}

501 @
Te¡


502 
public
 
	$‹¡Sequ’ûrFaov”
(è
throws
 
Exû±iÚ
 {

503 
	`g‘Mªagem’tTe¡Layout
();

505 
fš®
 
befÜeFau»
 = 5L;

506 
fš®
 
aá”Fau»
 = 10L;

508 
ISŒ—mV›w
 
sv
 = 
	`g‘CÜfuRuÁime
().
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

509 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

510 
sv
.
	`­³nd
(
‹¡Paylßd
);

511 
sv
.
	`­³nd
(
‹¡Paylßd
);

512 
sv
.
	`­³nd
(
‹¡Paylßd
);

513 
sv
.
	`­³nd
(
‹¡Paylßd
);

514 
sv
.
	`­³nd
(
‹¡Paylßd
);

516 
	`as£¹Th©
(
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
).
	`g‘Glob®LogTa
()).
	`isEqu®To
(
befÜeFau»
);

517 
	`as£¹Th©
(
	`g‘Sequ’ûr
(
SERVERS
.
PORT_1
).
	`g‘Glob®LogTa
()).
	`isEqu®To
(0L);

519 
	`šduûSequ’ûrFau»AndWa™
();

521 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
() == 1

522 && 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
SERVERS
.
ENDPOINT_0
), 
	`g‘CÜfuRuÁime
());

523 
Layout
 
ÃwLayout
 = 
Ãw
 
	`Layout
(
	`g‘CÜfuRuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
());

526 
Tok’Re¥Ú£
 
tok’Re¥Ú£
 = 
	`g‘CÜfuRuÁime
().
	`g‘Sequ’ûrV›w
().
	`qu”y
();

528 
	`as£¹Th©
(
tok’Re¥Ú£
.
	`g‘Sequ’û
()).
	`isEqu®To
(
befÜeFau»
 - 1);

530 
sv
.
	`­³nd
(
‹¡Paylßd
);

531 
sv
.
	`­³nd
(
‹¡Paylßd
);

532 
sv
.
	`­³nd
(
‹¡Paylßd
);

533 
sv
.
	`­³nd
(
‹¡Paylßd
);

534 
sv
.
	`­³nd
(
‹¡Paylßd
);

536 
	`as£¹Th©
(
ÃwLayout
.
	`g‘UÄe¥ÚsiveS”v”s
()).
	`cÚšsExaùly
(
SERVERS
.
ENDPOINT_0
);

538 
tok’Re¥Ú£
 = 
	`g‘CÜfuRuÁime
().
	`g‘Sequ’ûrV›w
().
	`qu”y
();

539 
	`as£¹Th©
(
tok’Re¥Ú£
.
	`g‘Sequ’û
()).
	`isEqu®To
(
aá”Fau»
 - 1);

540 
	}
}

542 
	g´Ùeùed
 <
T
 
ex‹nds
 
	gICÜfuSMR
> 
Objeù
 
š¡ªtŸ‹CÜfuObjeù
(
Ty³Tok’
<T> 
tTy³
, 
SŒšg
 
Çme
) {

543  
g‘CÜfuRuÁime
().
g‘ObjeùsV›w
()

544 .
bud
()

545 .
£tSŒ—mName
(
Çme
)

546 .
£tTy³Tok’
(
tTy³
)

547 .
İ’
();

551 
´Ùeùed
 
	gICÜfuTabË
<
	gIÁeg”
, 
	gSŒšg
> 
	$g‘M­
() {

552 
ICÜfuTabË
<
IÁeg”
, 
SŒšg
> 
‹¡M­
;

554 
‹¡M­
 = (
ICÜfuTabË
<
IÁeg”
, 
SŒšg
>è
	`š¡ªtŸ‹CÜfuObjeù
(

555 
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, 
SŒšg
>>() {

559  
‹¡M­
;

560 
	}
}

562 
´Ùeùed
 
	$TXBegš
() {

563 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

564 
	}
}

566 
´Ùeùed
 
	$TXEnd
() {

567 
	`g‘CÜfuRuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

568 
	}
}

573 @
Te¡


574 
public
 
	$ckSequ’ûrFaov”TXResŞutiÚ
(è
throws
 
Exû±iÚ
 {

576 
	`g‘Mªagem’tTe¡Layout
();

578 
M­
<
IÁeg”
, 
SŒšg
> 
m­
 = 
	`g‘M­
();

582 
	`t
(0, () -> {

583 
	`TXBegš
();

584 
m­
.
	`g‘
(0);

587 
fš®
 
SŒšg
 
·ylßd
 = "hello";

588 
fš®
 
nUpd©es
 = 5;

591 
	`t
(1, () -> {

592 
i
 = 0; i < 
nUpd©es
; i++)

593 
m­
.
	`put
(
i
, 
·ylßd
);

601 
	`šduûSequ’ûrFau»AndWa™
();

602 
	`t
(0, () -> {

603 
boŞ—n
 
comm™
 = 
Œue
;

604 
m­
.
	`put
(
nUpd©es
 + 1, 
·ylßd
);

605 
Œy
 {

606 
	`TXEnd
();

607 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 

) {

608 
	`as£¹Th©
(

.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
NEW_SEQUENCER
);

609 
comm™
 = 
çl£
;

611 
	`as£¹Th©
(
comm™
)

612 .
	`isF®£
();

616 
	`t
(0, () -> {

617 
	`TXBegš
();

618 
m­
.
	`g‘
(0);

622 
	`t
(1, () -> {

623 
i
 = 0; i < 
nUpd©es
; i++)

624 
m­
.
	`put
(
i
, 
·ylßd
 + 1);

627 
	`t
(0, () -> {

628 
boŞ—n
 
comm™
 = 
Œue
;

629 
m­
.
	`put
(
nUpd©es
 + 1, 
·ylßd
);

630 
Œy
 {

631 
	`TXEnd
();

632 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 

) {

633 
comm™
 = 
çl£
;

635 
	`as£¹Th©
(
comm™
)

636 .
	`isTrue
();

638 
	}
}

644 @
Te¡


645 
public
 
	$ckSequ’ûrFaov”TXResŞutiÚ1
(è
throws
 
Exû±iÚ
 {

646 
	`g‘Mªagem’tTe¡Layout
();

648 
M­
<
IÁeg”
, 
SŒšg
> 
m­
 = 
	`g‘M­
();

649 
fš®
 
SŒšg
 
·ylßd
 = "hello";

650 
fš®
 
nUpd©es
 = 5;

652 
i
 = 0; i < 
nUpd©es
; i++)

653 
m­
.
	`put
(
i
, 
·ylßd
);

657 
	`t
(0, () -> {

658 
	`TXBegš
();

659 
m­
.
	`g‘
(0);

663 
	`t
(1, () -> {

664 
i
 = 0; i < 
nUpd©es
; i++)

665 
m­
.
	`put
(
i
, 
·ylßd
 + 1);

673 
	`šduûSequ’ûrFau»AndWa™
();

675 
	`t
(0, () -> {

676 
boŞ—n
 
comm™
 = 
Œue
;

677 
m­
.
	`put
(
nUpd©es
 + 1, 
·ylßd
);

678 
Œy
 {

679 
	`TXEnd
();

680 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 

) {

681 
	`as£¹Th©
(

.
	`g‘AbÜtCau£
()).
	`isEqu®To
(
AbÜtCau£
.
NEW_SEQUENCER
);

682 
comm™
 = 
çl£
;

684 
	`as£¹Th©
(
comm™
)

685 .
	`isF®£
();

689 
	`t
(0, () -> {

690 
	`TXBegš
();

691 
m­
.
	`g‘
(0);

695 
	`t
(1, () -> {

696 
i
 = 0; i < 
nUpd©es
; i++)

697 
m­
.
	`put
(
i
, 
·ylßd
 + 2);

700 
	`t
(0, () -> {

701 
boŞ—n
 
comm™
 = 
Œue
;

702 
m­
.
	`put
(
nUpd©es
 + 1, 
·ylßd
);

703 
Œy
 {

704 
	`TXEnd
();

705 } 
	`ÿtch
 (
T¿n§ùiÚAbÜ‹dExû±iÚ
 

) {

706 
comm™
 = 
çl£
;

708 
	`as£¹Th©
(
comm™
)

709 .
	`isTrue
();

711 
	}
}

729 @
Te¡


730 
public
 
	$£qu’ûrFaov”Backpoš‹rCheck
(è
throws
 
Exû±iÚ
 {

731 
	`g‘Mªagem’tTe¡Layout
();

733 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

734 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am B".
	`g‘By‹s
());

735 
UUID
 
¡»amC
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am C".
	`g‘By‹s
());

737 
fš®
 
¡»amA_backpoš‹rRecov”ed
 = 2L;

738 
fš®
 
¡»amB_backpoš‹rRecov”ed
 = 3L;

740 
fš®
 
¡»amA_backpoš‹rFš®
 = 4L;

741 
fš®
 
¡»amB_backpoš‹rFš®
 = 7L;

743 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amA
, 
Add»ss
.
NON_EXIST
);

744 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amB
, 
Add»ss
.
NON_EXIST
);

745 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amA
, 0L);

746 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amB
, 1L);

748 
	`šduûSequ’ûrFau»AndWa™
();

750 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amA
, 
¡»amA_backpoš‹rRecov”ed
);

751 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amC
, 
Add»ss
.
NON_EXIST
);

752 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amA
, 
¡»amA_backpoš‹rFš®
);

753 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amB
, 
¡»amB_backpoš‹rRecov”ed
);

754 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amB
, 
¡»amB_backpoš‹rFš®
);

755 
	}
}

765 
´iv©e
 
	$g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
UUID
 
¡»amID
, 
LÚg
 
ex³ùedBackpoš‹rV®ue
) {

766 
Tok’Re¥Ú£
 
tok’Re¥Ú£
 =

767 
cÜfuRuÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amID
);

768 ià(
ex³ùedBackpoš‹rV®ue
 =ğ
nuÎ
) {

769 
	`as£¹Th©
(
tok’Re¥Ú£
.
	`g‘Backpoš‹rM­
()).
	`isEm±y
();

771 
	`as£¹Th©
(
tok’Re¥Ú£
.
	`g‘Backpoš‹rM­
()).
	`cÚšsEÁry
(
¡»amID
, 
ex³ùedBackpoš‹rV®ue
);

773 
cÜfuRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
tok’Re¥Ú£
,

774 "‹¡".
	`g‘By‹s
());

775 
	}
}

782 @
Te¡


783 
public
 
	$blockRecov”ySequ’ûrUÁRe£t
(è
throws
 
Exû±iÚ
 {

785 
fš®
 
Sem­hÜe
 
»£tD‘eùed
 = 
Ãw
 
	`Sem­hÜe
(1);

786 
Layout
 
Ïyout
 = 
	`g‘Mªagem’tTe¡Layout
();

788 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

790 
	`g‘Tok’Wr™eAndAs£¹BackPoš‹r
(
¡»amA
, 
Add»ss
.
NON_EXIST
);

792 
»£tD‘eùed
.
	`acquœe
();

795 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

796 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
msg
 -> msg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
)).
	`drİ
());

797 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

798 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
msg
 -> {

799 ià(
msg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
)) {

800 
Œy
 {

804 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
)

805 .
	`g‘Sequ’ûrCl›Á
(
SERVERS
.
ENDPOINT_1
)

806 .
	`ÃxtTok’
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
CÜfuRuÁime


807 .
	`g‘SŒ—mID
("‹¡SŒ—m")), 1).
	`g‘
();

808 
	`ç
();

809 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 | 
ExecutiÚExû±iÚ
 
e
) {

810 
»£tD‘eùed
.
	`»Ëa£
();

813  
çl£
;

816 
	`šduûSequ’ûrFau»AndWa™
();

818 
	`as£¹Th©
(
»£tD‘eùed


819 .
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_NORMAL
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
))

820 .
	`isTrue
();

823 
cÜfuRuÁime
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream"));

824 
	}
}

826 @
Te¡


827 
public
 
	$£®DÛsNÙModifyCl›ÁEpoch
(è
throws
 
Exû±iÚ
 {

828 
Layout
 
l
 = 
	`g‘Mªagem’tTe¡Layout
();

831 
Layout
 
ÃwLayout
 = 
Ãw
 
	`Layout
(
l
);

832 
ÃwLayout
.
	`£tEpoch
ÒewLayout.
	`g‘Epoch
() + 1);

833 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout
).
	`£®MšS”v”S‘
();

834 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(
l
.getEpoch());

835 
	}
}

845 @
Te¡


846 
public
 
	$upd©eT¿šgLayoutS”v”s
(è
throws
 
Exû±iÚ
 {

848 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
	`g‘Mªagem’tTe¡Layout
());

850 
AtomicBoŞ—n
 
comm™W™hDifã»ÁEpoch
 = 
Ãw
 
	`AtomicBoŞ—n
(
çl£
);

852 
fš®
 
CouÁDownL©ch
 
Ïtch
 = 
Ãw
 
	`CouÁDownL©ch
(1);

853 
Te¡RuË
 
š‹rû±Comm™
 = 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 -> {

854 ià(
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
LAYOUT_COMMITTED
)) {

855 ià(((
CÜfuPaylßdMsg
<
LayoutComm™‹dReque¡
>è
cÜfuMsg
).
	`g‘Paylßd
().
	`g‘Layout
().
	`g‘Epoch
() == 2) {

856 
Ïtch
.
	`couÁDown
();

858 
comm™W™hDifã»ÁEpoch
.
	`£t
(
Œue
);

861  
Œue
;

864 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
š‹rû±Comm™
);

865 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
š‹rû±Comm™
);

866 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
š‹rû±Comm™
);

868 
fš®
 
highRªk
 = 10L;

870 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
SERVERS
.
ENDPOINT_0
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

871 
Ïyout
.
	`£tEpoch
(2L);

872 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

875 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout
, 
highRªk
);

877 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

878 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

879 ià(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
().
	`equ®s
(
Ïyout
))

884 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
().
	`g‘Epoch
()).
	`isEqu®To
(2L);

885 
	`as£¹Th©
(
	`g‘LayoutS”v”
(
SERVERS
.
PORT_0
).
	`g‘Cu¼’tLayout
()).
	`isEqu®To
(
Ïyout
);

886 
Ïtch
.
	`awa™
();

887 
	`as£¹Th©
(
comm™W™hDifã»ÁEpoch
.
	`g‘
()).
	`isF®£
();

888 
	}
}

896 @
Te¡


897 
public
 
	$blockLayoutUpd©eAá”S—l
(è
throws
 
IÁ”ru±edExû±iÚ
 {

899 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
	`g‘Mªagem’tTe¡Layout
());

901 
Te¡RuË
 
drİP»·»Msg
 = 
Ãw
 
	`Te¡RuË
()

902 .
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
LAYOUT_PREPARE
))

903 .
	`drİ
();

906 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
drİP»·»Msg
);

907 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
drİP»·»Msg
);

908 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
drİP»·»Msg
);

911 
Ïyout
.
	`£tEpoch
(2L);

912 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

915 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

916 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

917 ià(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
() == 2L) {

918 
	`ç
();

920 
cÜfuRuÁime
.
	`šv®id©eLayout
();

922 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(1L);

923 
	}
}

932 @
Te¡


933 
public
 
	$unblockS—ËdClu¡”
(è
throws
 
Exû±iÚ
 {

934 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

935 
Layout
 
l
 = 
Ãw
 
	`Layout
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

936 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
);

938 
	`wa™FÜSequ’ûrToBoÙ¡¿p
(
SERVERS
.
PORT_0
);

940 
l
.
	`£tEpoch
Ö.
	`g‘Epoch
() + 1);

941 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
l
).
	`£®MšS”v”S‘
();

943 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

944 
Th»ad
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

945 ià(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(è=ğ
l
.getEpoch()) {

948 
cÜfuRuÁime
.
	`šv®id©eLayout
();

950 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
()).
	`isEqu®To
(
l
.getEpoch());

951 
	}
}

963 @
Te¡


964 
public
 
	$‹¡NodeH—lšg
() {

965 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
nuÎ
;

966 
Œy
 {

967 
	`addS”v”
(
SERVERS
.
PORT_0
);

968 
	`addS”v”
(
SERVERS
.
PORT_1
);

969 
	`addS”v”
(
SERVERS
.
PORT_2
);

970 
Layout
 
l
 = 
Ãw
 
	`Te¡LayoutBud”
()

971 .
	`£tEpoch
(1L)

972 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

973 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

974 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

975 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

976 .
	`budSegm’t
()

977 .
	`budSŒe
()

978 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

979 .
	`addToSegm’t
()

980 .
	`addToLayout
()

981 .
	`bud
();

982 
	`boÙ¡¿pAÎS”v”s
(
l
);

984 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
l
).
	`cÚÃù
();

985 
	`£tAgg»ssiveTimeouts
(
l
, 
cÜfuRuÁime
,

986 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

987 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
);

989 
	`addS”v”RuË
(
SERVERS
.
PORT_2
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

990 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
()

991 .
	`equ®s
(
CŞËùiÚs
.
	`sšgËtÚLi¡
(
SERVERS
.
ENDPOINT_2
)), 
cÜfuRuÁime
);

993 
	`ş—rS”v”RuËs
(
SERVERS
.
PORT_2
);

994 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
().
	`isEm±y
()

995 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
cÜfuRuÁime
);

996 } 
fš®ly
 {

997 ià(
cÜfuRuÁime
 !ğ
nuÎ
) {

998 
cÜfuRuÁime
.
	`shutdown
();

1001 
	}
}

1010 @
Te¡


1011 
public
 
	$‹¡AddNodeW™houtC©chup
(è
throws
 
Exû±iÚ
 {

1012 
CÜfuRuÁime
 
¹
 = 
nuÎ
;

1013 
Œy
 {

1014 
	`addS”v”
(
SERVERS
.
PORT_0
);

1016 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

1017 .
	`£tEpoch
(0L)

1018 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

1019 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

1020 .
	`budSegm’t
()

1021 .
	`budSŒe
()

1022 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

1023 .
	`addToSegm’t
()

1024 .
	`addToLayout
()

1025 .
	`bud
();

1026 
	`boÙ¡¿pAÎS”v”s
(
l1
);

1028 
S”v”CÚ‹xt
 
sc1
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

1029 .
	`£tSšgË
(
çl£
)

1030 .
	`£tS”v”Rou‹r
(
Ãw
 
	`Te¡S”v”Rou‹r
(
SERVERS
.
PORT_1
))

1031 .
	`£tPÜt
(
SERVERS
.
PORT_1
)

1032 .
	`bud
();

1033 
	`addS”v”
(
SERVERS
.
PORT_1
, 
sc1
);

1035 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
())

1036 .
	`cÚÃù
();

1039 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"))

1040 .
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

1042 
¹
.
	`g‘LayoutMªagem’tV›w
().
	`addNode
(
l1
, 
SERVERS
.
ENDPOINT_1
,

1043 
Œue
,

1044 
Œue
,

1045 
Œue
,

1046 
çl£
,

1049 
¹
.
	`šv®id©eLayout
();

1050 
Layout
 
ÏyoutPha£2
 = 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
();

1052 
Layout
 
l2
 = 
Ãw
 
	`Te¡LayoutBud”
()

1053 .
	`£tEpoch
(1L)

1054 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

1055 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

1056 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

1057 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

1058 .
	`budSegm’t
()

1059 .
	`£tS¹
(0L)

1060 .
	`£tEnd
(1L)

1061 .
	`budSŒe
()

1062 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

1063 .
	`addToSegm’t
()

1064 .
	`addToLayout
()

1065 .
	`budSegm’t
()

1066 .
	`£tS¹
(1L)

1067 .
	`£tEnd
(-1L)

1068 .
	`budSŒe
()

1069 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

1070 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

1071 .
	`addToSegm’t
()

1072 .
	`addToLayout
()

1073 .
	`bud
();

1074 
	`as£¹Th©
(
l2
.
	`asJSONSŒšg
()).
	`isEqu®To
(
ÏyoutPha£2
.asJSONString());

1075 } 
fš®ly
 {

1076 ià(
¹
 !ğ
nuÎ
) {

1077 
¹
.
	`shutdown
();

1080 
	}
}

1095 @
Te¡


1096 
public
 
	$»g»ssTok’CouÁToV®idDi¥©chedTok’s
(è
throws
 
Exû±iÚ
 {

1097 
fš®
 
UUID
 
¡»amA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA");

1098 
fš®
 
UUID
 
¡»amB
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamB");

1099 
by‹
[] 
·ylßd
 = "‹¡_·ylßd".
	`g‘By‹s
();

1101 
Layout
 
Ïyout_1
 = 
Ãw
 
	`Layout
(
	`g‘Mªagem’tTe¡Layout
());

1106 
Te¡RuË
 
mngtAg’tDrİAÎ
 = 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
();

1107 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

1108 
mngtAg’tDrİAÎ
);

1109 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

1110 
mngtAg’tDrİAÎ
);

1111 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

1112 
mngtAg’tDrİAÎ
);

1115 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

1116 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

1117 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

1119 
Sequ’ûrS”v”
 
£rv”0
 = 
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
);

1120 
Sequ’ûrS”v”
 
£rv”1
 = 
	`g‘Sequ’ûr
(
SERVERS
.
PORT_1
);

1122 
CÜfuRuÁime
 
ruÁime_1
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

1123 
CÜfuRuÁime
 
ruÁime_2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

1125 
ISŒ—mV›w
 
¡»amV›wA
 = 
ruÁime_1
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

1126 
ISŒ—mV›w
 
¡»amV›wB
 = 
ruÁime_1
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amB
);

1130 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1131 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1132 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1133 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1134 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1136 
¡»amV›wB
.
	`­³nd
(
·ylßd
);

1137 
¡»amV›wB
.
	`­³nd
(
·ylßd
);

1138 
¡»amV›wB
.
	`­³nd
(
·ylßd
);

1139 
¡»amV›wB
.
	`­³nd
(
·ylßd
);

1140 
¡»amV›wB
.
	`­³nd
(
·ylßd
);

1143 
	`addCl›ÁRuË
(
ruÁime_1
, 
SERVERS
.
ENDPOINT_0
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

1145 
Layout
 
Ïyout_2
 = 
Ãw
 
	`LayoutBud”
(
Ïyout_1
)

1146 .
	`assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_0
))

1147 .
	`bud
();

1148 
Ïyout_2
.
	`£tEpoch
Öayout_2.
	`g‘Epoch
() + 1);

1149 
ruÁime_1
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout_2
).
	`£®MšS”v”S‘
();

1150 
ruÁime_1
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout_2
, 1L);

1151 
ruÁime_1
.
	`g‘LayoutMªagem’tV›w
().
	`»cÚfigu»Sequ’ûrS”v”s
(
Ïyout_1
, 
Ïyout_2
, 
çl£
);

1152 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘Epoch
(è=ğ
Ïyout_2
.g‘Epoch(), 
ruÁime_1
);

1154 
	`ş—rCl›ÁRuËs
(
ruÁime_1
);

1157 
fš®
 
tok’CouÁ
 = 5;

1158 
x
 = 0; x < 
tok’CouÁ
; x++) {

1159 
ruÁime_2
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

1160 
ruÁime_2
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amB
);

1163 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1164 
¡»amV›wA
.
	`­³nd
(
·ylßd
);

1166 
fš®
 
ex³ùedS”v”0Tok’s
 = 20;

1167 
fš®
 
ex³ùedS”v”1Tok’s
 = 12;

1168 
	`as£¹Th©
(
£rv”0
.
	`g‘Sequ’ûrEpoch
()).
	`isEqu®To
(
Ïyout_1
.
	`g‘Epoch
());

1169 
	`as£¹Th©
(
£rv”1
.
	`g‘Sequ’ûrEpoch
()).
	`isEqu®To
(
Ïyout_2
.
	`g‘Epoch
());

1170 
	`as£¹Th©
(
£rv”0
.
	`g‘Glob®LogTa
()).
	`isEqu®To
(
ex³ùedS”v”0Tok’s
);

1171 
	`as£¹Th©
(
£rv”1
.
	`g‘Glob®LogTa
()).
	`isEqu®To
(
ex³ùedS”v”1Tok’s
);

1174 
Layout
 
Ïyout_3
 = 
Ãw
 
	`LayoutBud”
(
Ïyout_2
)

1175 .
	`assignRe¥ÚsiveSequ’ûrAsPrim¬y
(
CŞËùiÚs
.
	`sšgËtÚ
(
SERVERS
.
ENDPOINT_1
))

1176 .
	`bud
();

1177 
Ïyout_3
.
	`£tEpoch
Öayout_3.
	`g‘Epoch
() + 1);

1178 
ruÁime_1
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout_3
).
	`£®MšS”v”S‘
();

1179 
ruÁime_1
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout_3
, 1L);

1180 
ruÁime_1
.
	`g‘LayoutMªagem’tV›w
().
	`»cÚfigu»Sequ’ûrS”v”s
(
Ïyout_2
, 
Ïyout_3
, 
çl£
);

1184 
	`as£¹Th©
(
£rv”0
.
	`g‘Sequ’ûrEpoch
()).
	`isEqu®To
(
Ïyout_3
.
	`g‘Epoch
());

1185 
	`as£¹Th©
(
£rv”1
.
	`g‘Sequ’ûrEpoch
()).
	`isEqu®To
(
Ïyout_2
.
	`g‘Epoch
());

1186 
	`as£¹Th©
(
£rv”0
.
	`g‘Glob®LogTa
()).
	`isEqu®To
(
ex³ùedS”v”1Tok’s
);

1187 
	`as£¹Th©
(
£rv”1
.
	`g‘Glob®LogTa
()).
	`isEqu®To
(
ex³ùedS”v”1Tok’s
);

1190 
fš®
 
ex³ùedBackpoš‹rSŒ—mA
 = 11;

1191 
Tok’Re¥Ú£
 
tok’Re¥Ú£
 = 
ruÁime_1
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

1192 
	`as£¹Th©
(
tok’Re¥Ú£
.
	`g‘Backpoš‹rM­
().
	`g‘
(
¡»amA
))

1193 .
	`isEqu®To
(
ex³ùedBackpoš‹rSŒ—mA
);

1194 
	}
}

1203 @
Te¡


1204 
public
 
	$hªdËUnBoÙ¡¿µedSequ’ûr
(è
throws
 
Exû±iÚ
 {

1205 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
	`g‘Mªagem’tTe¡Layout
());

1206 
fš®
 
highRªk
 = 10L;

1210 
Ïyout
.
	`£tEpoch
Öayout.
	`g‘Epoch
() + 1);

1211 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

1214 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout
, 
highRªk
);

1216 
	`as£¹Th©ThrownBy
((è-> 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

1217 .
	`g‘Prim¬ySequ’ûrCl›Á
()

1218 .
	`»que¡M‘rics
().
	`g‘
()).
	`hasCau£In¡ªûOf
(
S”v”NÙR—dyExû±iÚ
.
şass
);

1221 
cÜfuRuÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
();

1224 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘Prim¬ySequ’ûrCl›Á
()

1225 .
	`»que¡M‘rics
().
	`g‘
().
	`g‘Sequ’ûrStus
()).
	`isEqu®To
(
Sequ’ûrStus
.
READY
);

1226 
	}
}

1257 @
Te¡


1258 
public
 
	$qu”yClu¡”Stus
(è
throws
 
Exû±iÚ
 {

1259 
	`g‘3NodeLayout
();

1260 
	`g‘CÜfuRuÁime
().
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘AÎS”v”s
().
	`fÜEach
(
’dpošt
 ->

1261 
	`g‘CÜfuRuÁime
().
	`g‘Rou‹r
(
’dpošt
)

1262 .
	`£tTimeoutRe¥Ú£
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
()));

1265 
Clu¡”StusR•Üt
 
şu¡”Stus
 = 
	`g‘CÜfuRuÁime
().
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

1266 
M­
<
SŒšg
, 
CÚÃùiv™yStus
> 
nodeCÚÃùiv™yM­
 = 
şu¡”Stus
.
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

1267 
M­
<
SŒšg
, 
NodeStus
> 
nodeStusM­
 = 
şu¡”Stus
.
	`g‘Clu¡”NodeStusM­
();

1268 
Clu¡”StusR•Üt
.
Clu¡”StusR–Ÿb™y
 
şu¡”StusR–Ÿb™y
 = 
şu¡”Stus
.
	`g‘Clu¡”StusR–Ÿb™y
();

1269 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1270 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1271 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1272 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
NodeStus
.
UP
);

1273 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
NodeStus
.
UP
);

1274 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
NodeStus
.
UP
);

1275 
	`as£¹Th©
(
şu¡”StusR–Ÿb™y
).
	`isEqu®To
(
Clu¡”StusR•Üt
.
Clu¡”StusR–Ÿb™y
.
STRONG_QUORUM
);

1276 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

1282 
Te¡RuË
 
ruË
 = 
Ãw
 
	`Te¡RuË
()

1283 .
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
PING
))

1284 .
	`drİ
();

1285 
	`addCl›ÁRuË
(
	`g‘CÜfuRuÁime
(), 
SERVERS
.
ENDPOINT_0
, 
ruË
);

1286 
	`addCl›ÁRuË
(
	`g‘CÜfuRuÁime
(), 
SERVERS
.
ENDPOINT_1
, 
ruË
);

1287 
şu¡”Stus
 = 
	`g‘CÜfuRuÁime
().
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

1288 
nodeCÚÃùiv™yM­
 = 
şu¡”Stus
.
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

1289 
nodeStusM­
 = 
şu¡”Stus
.
	`g‘Clu¡”NodeStusM­
();

1290 
şu¡”StusR–Ÿb™y
 = 
şu¡”Stus
.
	`g‘Clu¡”StusR–Ÿb™y
();

1291 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1292 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1293 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1294 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
NodeStus
.
UP
);

1295 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
NodeStus
.
UP
);

1296 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
NodeStus
.
UP
);

1297 
	`as£¹Th©
(
şu¡”StusR–Ÿb™y
).
	`isEqu®To
(
Clu¡”StusR•Üt
.
Clu¡”StusR–Ÿb™y
.
STRONG_QUORUM
);

1298 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
STABLE
);

1301 
ISŒ—mV›w
 
¡»amV›w
 = 
	`g‘CÜfuRuÁime
().
	`g‘SŒ—msV›w
()

1302 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream"));

1303 
fš®
 
’Œ›sCouÁ
 = 10;

1304 
fš®
 
by‹
[] 
·ylßd
 = "·ylßd".
	`g‘By‹s
();

1305 
i
 = 0; i < 
’Œ›sCouÁ
; i++) {

1306 
¡»amV›w
.
	`­³nd
(
·ylßd
);

1310 
	`ş—rCl›ÁRuËs
(
	`g‘CÜfuRuÁime
());

1311 
	`addS”v”RuË
(
SERVERS
.
PORT_0
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

1312 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
().
	`size
() == 1

1313 && 
Ïyout
.
	`g‘UÄe¥ÚsiveS”v”s
().
	`cÚšs
(
SERVERS
.
ENDPOINT_0
)

1314 && 
Ïyout
.
	`g‘Segm’ts
().
	`size
() == 1,

1315 
	`g‘CÜfuRuÁime
());

1316 
şu¡”Stus
 = 
	`g‘CÜfuRuÁime
().
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

1317 
nodeCÚÃùiv™yM­
 = 
şu¡”Stus
.
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

1318 
nodeStusM­
 = 
şu¡”Stus
.
	`g‘Clu¡”NodeStusM­
();

1319 
şu¡”StusR–Ÿb™y
 = 
şu¡”Stus
.
	`g‘Clu¡”StusR–Ÿb™y
();

1320 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1321 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1322 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1323 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
NodeStus
.
DOWN
);

1324 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
NodeStus
.
UP
);

1325 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
NodeStus
.
UP
);

1326 
	`as£¹Th©
(
şu¡”StusR–Ÿb™y
).
	`isEqu®To
(
Clu¡”StusR•Üt
.
Clu¡”StusR–Ÿb™y
.
STRONG_QUORUM
);

1327 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DEGRADED
);

1333 
Sem­hÜe
 
Ïtch1
 = 
Ãw
 
	`Sem­hÜe
(1);

1334 
Ïtch1
.
	`acquœe
();

1335 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

1336 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 -> {

1337 ià(
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
MANAGEMENT_FAILURE_DETECTED
)) {

1338 
Ïtch1
.
	`»Ëa£
();

1339  
Œue
;

1341  
çl£
;

1342 }).
	`drİ
());

1343 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

1344 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(),

1345 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

1346 
	`as£¹Th©
(
Ïtch1
.
	`ŒyAcquœe
(
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
))

1347 .
	`isTrue
();

1348 
şu¡”Stus
 = 
	`g‘CÜfuRuÁime
().
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

1349 
nodeCÚÃùiv™yM­
 = 
şu¡”Stus
.
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

1350 
nodeStusM­
 = 
şu¡”Stus
.
	`g‘Clu¡”NodeStusM­
();

1351 
şu¡”StusR–Ÿb™y
 = 
şu¡”Stus
.
	`g‘Clu¡”StusR–Ÿb™y
();

1352 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1353 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1354 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

1355 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
NodeStus
.
NA
);

1356 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
NodeStus
.
NA
);

1357 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
NodeStus
.
NA
);

1358 
	`as£¹Th©
(
şu¡”StusR–Ÿb™y
).
	`isEqu®To
(
Clu¡”StusR•Üt
.
Clu¡”StusR–Ÿb™y
.
WEAK_NO_QUORUM
);

1359 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
UNAVAILABLE
);

1363 
	`ş—rCl›ÁRuËs
(
	`g‘CÜfuRuÁime
());

1364 
	`addS”v”RuË
(
SERVERS
.
PORT_2
, 
Ãw
 
	`Te¡RuË
().
	`drİ
().
	`®ways
());

1365 
şu¡”Stus
 = 
	`g‘CÜfuRuÁime
().
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

1366 
nodeCÚÃùiv™yM­
 = 
şu¡”Stus
.
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

1367 
nodeStusM­
 = 
şu¡”Stus
.
	`g‘Clu¡”NodeStusM­
();

1368 
şu¡”StusR–Ÿb™y
 = 
şu¡”Stus
.
	`g‘Clu¡”StusR–Ÿb™y
();

1369 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1370 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1371 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
UNRESPONSIVE
);

1372 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
NodeStus
.
NA
);

1373 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
NodeStus
.
NA
);

1374 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
NodeStus
.
NA
);

1375 
	`as£¹Th©
(
şu¡”StusR–Ÿb™y
).
	`isEqu®To
(
Clu¡”StusR•Üt
.
Clu¡”StusR–Ÿb™y
.
UNAVAILABLE
);

1376 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
UNAVAILABLE
);

1377 
	}
}

1391 @
Te¡


1392 
public
 
	$Œigg”Sy¡emDownHªdËrInD—dlock
(è
throws
 
Exû±iÚ
 {

1394 
	`addS”v”
(
SERVERS
.
PORT_0
);

1395 
	`addS”v”
(
SERVERS
.
PORT_1
);

1397 
Layout
 
Ïyout
 = 
Ãw
 
	`Te¡LayoutBud”
()

1398 .
	`£tEpoch
(1L)

1399 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

1400 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

1401 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

1402 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

1403 .
	`budSegm’t
()

1404 .
	`budSŒe
()

1405 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

1406 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

1407 .
	`addToSegm’t
()

1408 .
	`addToLayout
()

1409 .
	`£tClu¡”Id
(
UUID
.
	`¿ndomUUID
())

1410 .
	`bud
();

1411 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

1412 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
Ïyout
).
	`cÚÃù
();

1414 
CÜfuRuÁime
 
mªagem’tRuÁime0
 = 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
)

1415 .
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
();

1416 
CÜfuRuÁime
 
mªagem’tRuÁime1
 = 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
)

1417 .
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
();

1419 
	`wa™FÜSequ’ûrToBoÙ¡¿p
(
SERVERS
.
PORT_0
);

1422 
	`£tAgg»ssiveTimeouts
(
Ïyout
, 
cÜfuRuÁime
, 
mªagem’tRuÁime0
, 
mªagem’tRuÁime1
);

1423 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
, SERVERS.
PORT_1
);

1426 
ISŒ—mV›w
 
¡»amV›w
 = 
cÜfuRuÁime
.
	`g‘SŒ—msV›w
()

1427 .
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("testStream"));

1428 
fš®
 
by‹
[] 
·ylßd
 = "‹¡".
	`g‘By‹s
();

1429 
fš®
 
num
 = 10;

1430 
i
 = 0; i < 
num
; i++) {

1431 
¡»amV›w
.
	`­³nd
(
·ylßd
);

1435 
fš®
 
Sem­hÜe
 
£m­hÜe
 = 
Ãw
 
	`Sem­hÜe
(2);

1436 
£m­hÜe
.
	`acquœe
(2);

1438 
fš®
 
sysDownTrigg”Lim™
 = 3;

1439 
mªagem’tRuÁime0
.
	`g‘P¬am‘”s
().
	`£tSy¡emDownHªdËrTrigg”Lim™
(
sysDownTrigg”Lim™
);

1440 
mªagem’tRuÁime1
.
	`g‘P¬am‘”s
().
	`£tSy¡emDownHªdËrTrigg”Lim™
(
sysDownTrigg”Lim™
);

1442 
Te¡RuË
 
‹¡RuË
 = 
Ãw
 
	`Te¡RuË
()

1443 .
	`m©ches
(
m
 -> m.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
SEAL
))

1444 .
	`drİ
();

1445 
	`addCl›ÁRuË
(
mªagem’tRuÁime0
, 
‹¡RuË
);

1446 
	`addCl›ÁRuË
(
mªagem’tRuÁime1
, 
‹¡RuË
);

1450 
	`addS”v”RuË
(
SERVERS
.
PORT_0
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
m
 -> {

1451 ià(
m
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
LOG_ADDRESS_SPACE_RESPONSE
)) {

1452 
£m­hÜe
.
	`»Ëa£
();

1453  
Œue
;

1455  
çl£
;

1456 }).
	`drİ
());

1459 
Layout
 
Ïyout1
 = 
Ãw
 
	`Layout
(
Ïyout
);

1460 
Ïyout1
.
	`£tEpoch
Öayout1.
	`g‘Epoch
() + 1);

1461 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout1
).
	`£®MšS”v”S‘
();

1462 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout1
, 1L);

1464 
	`as£¹Th©
(
£m­hÜe


1465 .
	`ŒyAcquœe
(2, 
PARAMETERS
.
TIMEOUT_LONG
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
))

1466 .
	`isTrue
();

1470 
cÜfuRuÁime
.
	`šv®id©eLayout
();

1471 
Layout
 
Ïyout2
 = 
Ãw
 
	`Layout
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

1472 
Ïyout2
.
	`£tEpoch
Öayout2.
	`g‘Epoch
() + 1);

1473 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout2
).
	`£®MšS”v”S‘
();

1476 
	`ş—rCl›ÁRuËs
(
mªagem’tRuÁime0
);

1477 
	`ş—rCl›ÁRuËs
(
mªagem’tRuÁime1
);

1479 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

1480 ià(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(è=ğ
Ïyout2
.getEpoch()) {

1483 
cÜfuRuÁime
.
	`šv®id©eLayout
();

1484 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
());

1488 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
())

1489 .
	`isEqu®To
(
Ïyout2
.
	`g‘Epoch
());

1491 
	`ş—rS”v”RuËs
(
SERVERS
.
PORT_0
);

1494 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
()).
	`isNÙNuÎ
();

1495 
	}
}

1502 @
Te¡


1503 
public
 
	$unblockSequ’ûrRecov”yOnD—dlock
(è
throws
 
Exû±iÚ
 {

1504 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

1505 
fš®
 
Layout
 
Ïyout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

1507 
	`£tAgg»ssiveTimeouts
(
Ïyout
, 
cÜfuRuÁime
,

1508 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

1509 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
);

1511 
fš®
 
sysDownTrigg”Lim™
 = 3;

1512 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
().
	`g‘P¬am‘”s
()

1513 .
	`£tSy¡emDownHªdËrTrigg”Lim™
(
sysDownTrigg”Lim™
);

1516 
	`addS”v”RuË
(
SERVERS
.
PORT_0
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
m
 -> m.
	`g‘MsgTy³
()

1517 .
	`equ®s
(
CÜfuMsgTy³
.
READ_RESPONSE
)).
	`drİ
());

1519 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
()

1520 .
	`g‘CÜfuRuÁime
().
	`g‘LayoutMªagem’tV›w
()

1521 .
	`asyncSequ’ûrBoÙ¡¿p
(
Ïyout
,

1522 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
()

1523 .
	`g‘RemÙeMÚ™ÜšgS”viû
().
	`g‘Fau»D‘eùÜWÜk”
())

1524 .
	`g‘
();

1525 
	}
}

1537 @
Te¡


1538 
public
 
	$‹¡S—ËdDeg¿dedClu¡”H—lšg
(è
throws
 
Exû±iÚ
 {

1539 
	`g‘3NodeLayout
();

1540 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

1542 
	`addS”v”RuË
(
SERVERS
.
PORT_2
, 
Ãw
 
	`Te¡RuË
().
	`®ways
().
	`drİ
());

1544 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

1545 
cÜfuRuÁime
.
	`šv®id©eLayout
();

1546 ià(!
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘UÄe¥ÚsiveS”v”s
().
	`isEm±y
()) {

1549 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

1552 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

1553 
Ïyout
.
	`£tEpoch
Öayout.
	`g‘Epoch
() + 1);

1554 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

1556 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

1557 
cÜfuRuÁime
.
	`šv®id©eLayout
();

1558 ià(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(è=ğ
Ïyout
.getEpoch()) {

1561 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

1564 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
()).
	`isEqu®To
(
Ïyout
);

1565 
	}
}

1572 
´iv©e
 
	$wr™eRªdomEÁryToTabË
(
CÜfuTabË
 
bË
) {

1573 
Rªdom
 
r
 = 
Ãw
 
	`Rªdom
();

1574 
cÜfuRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

1575 
bË
.
	`put
(
r
.
	`ÃxtIÁ
(),„.nextInt());

1576 
cÜfuRuÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

1577 
	}
}

1586 @
Te¡


1587 
public
 
	$‹¡Sequ’ûrCacheOv”æowOnFaov”
(è
throws
 
Exû±iÚ
 {

1588 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

1590 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
cÜfuRuÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

1591 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {

1593 .
	`£tSŒ—mName
("test")

1594 .
	`İ’
();

1596 
	`wr™eRªdomEÁryToTabË
(
bË
);

1598 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
(è=ğ
CÜfuMsgTy³
.
WRITE
)

1599 .
	`drİ
());

1600 
Com¶‘abËFutu»
<
BoŞ—n
> 
futu»
 = Com¶‘abËFutu».
	`suµlyAsync
(() -> {

1601 
	`wr™eRªdomEÁryToTabË
(
bË
);

1602  
Œue
;

1605 
	`addCl›ÁRuË
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
(), 
Ãw
 
	`Te¡RuË
()

1606 .
	`m©ches
(
cÜfuMsg
 -> cÜfuMsg.
	`g‘MsgTy³
(è=ğ
CÜfuMsgTy³
.
BOOTSTRAP_SEQUENCER
).
	`drİ
());

1609 
	`šüem’tClu¡”Epoch
(
cÜfuRuÁime
);

1610 
Layout
 
Ïyout
 = 
	`šüem’tClu¡”Epoch
(
cÜfuRuÁime
);

1613 
	`ş—rCl›ÁRuËs
(
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

1614 
	`g‘Sequ’ûr
(
SERVERS
.
PORT_0
).
	`g‘Sequ’ûrEpoch
(è!ğ
Ïyout
.
	`g‘Epoch
()) {

1615 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

1617 
	`ş—rCl›ÁRuËs
(
cÜfuRuÁime
);

1622 
	`wr™eRªdomEÁryToTabË
(
bË
);

1624 
futu»
.
	`ÿnûl
(
Œue
);

1625 
	}
}

1633 @
Te¡


1634 
public
 
	$‹¡P¬tŸlBoÙ¡¿pNodeSucûss
(è
throws
 
ExecutiÚExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

1635 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

1636 
	`addS”v”
(
SERVERS
.
PORT_1
);

1637 
Layout
 
Ïyout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

1640 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘LayoutCl›Á
(
SERVERS
.
ENDPOINT_1
).
	`boÙ¡¿pLayout
(
Ïyout
);

1643 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutMªagem’tV›w
().
	`boÙ¡¿pNewNode
(
SERVERS
.
ENDPOINT_1
).
	`g‘
()).
	`isTrue
();

1644 
	}
}

1654 @
Te¡


1655 
public
 
	$‹¡P¬tŸlBoÙ¡¿pNodeFau»
() {

1656 
cÜfuRuÁime
 = 
	`g‘DeçuÉRuÁime
();

1657 
	`addS”v”
(
SERVERS
.
PORT_1
);

1658 
Layout
 
Ïyout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

1661 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
().
	`g‘LayoutCl›Á
(
SERVERS
.
ENDPOINT_1
).
	`boÙ¡¿pLayout
(
Ïyout
);

1663 
	`addCl›ÁRuË
(
cÜfuRuÁime
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
cÜfuMsg
 ->

1664 
cÜfuMsg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
)).
	`drİ
());

1665 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutMªagem’tV›w
().
	`boÙ¡¿pNewNode
(
SERVERS
.
ENDPOINT_1
).
	`još
()).
	`isTrue
();

1666 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/ObjectsViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

7 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gSem­hÜe
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gLogEÁry
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiObjeùSMREÁry
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiSMREÁry
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gSMREÁry
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gT¿n§ùiÚAbÜ‹dExû±iÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

21 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

26 
public
 cÏs 
	cObjeùsV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

28 @
	mTe¡


29 @
Suµ»ssW¬nšgs
("unchecked")

30 
public
 
	$ÿnAbÜtNoT¿n§ùiÚ
()

31 
throws
 
Exû±iÚ
 {

33 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

34 
r
.
	`g‘ObjeùsV›w
().
	`TXAbÜt
();

37 @
Te¡


38 @
	`Suµ»ssW¬nšgs
("unchecked")

39 
public
 
	$abÜ‹dT¿n§ùiÚDÛsNÙCÚæiù
()

40 
throws
 
Exû±iÚ
 {

41 
fš®
 
SŒšg
 
m­A
 = "map‡";

43 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
()

44 .
	`£tT¿n§ùiÚLoggšg
(
Œue
);

46 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

47 .
	`bud
()

48 .
	`£tSŒ—mName
(
m­A
)

49 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

50 .
	`İ’
();

53 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­Cİy
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

54 .
	`bud
()

55 .
	`£tSŒ—mName
(
m­A
)

56 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

57 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

58 .
	`İ’
();

61 
m­
.
	`put
("initial", "value");

63 
Sem­hÜe
 
s1
 = 
Ãw
 
	`Sem­hÜe
(0);

64 
Sem­hÜe
 
s2
 = 
Ãw
 
	`Sem­hÜe
(0);

71 
	`scheduËCÚcu¼’y
(1, 
t
 -> {

72 
	`as£¹Th©ThrownBy
(() -> {

73 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

74 
m­
.
	`g‘
("k");

75 
s1
.
	`»Ëa£
();

76 
s2
.
	`acquœe
();

77 
m­
.
	`put
("k", "v1");

78 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

79 }).
	`isIn¡ªûOf
(
T¿n§ùiÚAbÜ‹dExû±iÚ
.
şass
);

82 
	`scheduËCÚcu¼’y
(1, 
t
 -> {

83 
s1
.
	`acquœe
();

84 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXBegš
();

85 
m­Cİy
.
	`put
("k", "v2");

86 
	`g‘RuÁime
().
	`g‘ObjeùsV›w
().
	`TXEnd
();

87 
s2
.
	`»Ëa£
();

90 
	`execu‹ScheduËd
(2, 
PARAMETERS
.
TIMEOUT_LONG
);

93 
	`as£¹Th©
(
m­
)

94 .
	`cÚšsEÁry
("k", "v2");

96 
ISŒ—mV›w
 
txSŒ—m
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
ObjeùsV›w


97 .
TRANSACTION_STREAM_ID
);

98 
Li¡
<
ILogD©a
> 
txns
 = 
txSŒ—m
.
	`»maššgUpTo
(
LÚg
.
MAX_VALUE
);

99 
	`as£¹Th©
(
txns
).
	`hasSize
(1);

100 
	`as£¹Th©
(
txns
.
	`g‘
(0).
	`g‘LogEÁry
(
	`g‘RuÁime
()).
	`g‘Ty³
())

101 .
	`isEqu®To
(
LogEÁry
.
LogEÁryTy³
.
MULTIOBJSMR
);

103 
MuÉiObjeùSMREÁry
 
tx1
 = (MuÉiObjeùSMREÁry)
txns
.
	`g‘
(0).
g‘LogEÁry


104 (
	`g‘RuÁime
());

105 
MuÉiSMREÁry
 
’ŒyM­
 = 
tx1
.
	`g‘EÁryM­
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
m­A
));

106 
	`as£¹Th©
(
’ŒyM­
).
	`isNÙNuÎ
();

108 
	`as£¹Th©
(
’ŒyM­
.
	`g‘Upd©es
().
	`size
()).
	`isEqu®To
(1);

110 
SMREÁry
 
smrEÁry
 = 
’ŒyM­
.
	`g‘Upd©es
().
	`g‘
(0);

111 
Objeù
[] 
¬gs
 = 
smrEÁry
.
	`g‘SMRArgum’ts
();

112 
	`as£¹Th©
(
smrEÁry
.
	`g‘SMRM‘hod
()).
	`isEqu®To
("put");

113 
	`as£¹Th©
((
SŒšg
è
¬gs
[0]).
	`isEqu®To
("k");

114 
	`as£¹Th©
((
SŒšg
è
¬gs
[1]).
	`isEqu®To
("v2");

115 
	}
}

117 @
Te¡


118 
public
 
	$šcÜ»ùNe¡šgTe¡
() {

119 
CÜfuRuÁime
 
r1
 = 
	`g‘DeçuÉRuÁime
();

120 
CÜfuRuÁime
 
r2
 = CÜfuRuÁime.
	`äomP¬am‘”s
(CÜfuRuÁime.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
()

121 .
	`Ã‰yEv’tLoİ
(
NETTY_EVENT_LOOP
)

122 .
	`bud
());

123 
CÜfuTabË
<
SŒšg
, SŒšg> 
m­
 = 
	`g‘DeçuÉRuÁime
().
	`g‘ObjeùsV›w
()

124 .
	`bud
()

125 .
	`£tSŒ—mName
("mapa")

126 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

127 .
	`İ’
();

129 
r1
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

130 
m­
.
	`g‘
("key1");

133 
	`as£¹Th©ThrownBy
((è-> 
r2
.
	`g‘ObjeùsV›w
().
	`TXBegš
()).
	`isIn¡ªûOf
(
IÎeg®S‹Exû±iÚ
.
şass
);

134 
	}
}

136 @
	gTe¡


137 @
Suµ»ssW¬nšgs
("unchecked")

138 
public
 
	$uÄ–©edSŒ—mDÛsNÙCÚæiù
()

139 
throws
 
Exû±iÚ
 {

141 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

143 
M­
<
SŒšg
, SŒšg> 
smrM­
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

144 .
	`£tSŒ—mName
("map‡")

145 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

146 .
	`İ’
();

148 
ISŒ—mV›w
 
¡»amB
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("b"));

149 
smrM­
.
	`put
("a", "b");

150 
¡»amB
.
	`­³nd
(
Ãw
 
	`SMREÁry
("hi",‚ew 
Objeù
[]{"h–lo"}, 
S”Ÿliz”s
.
PRIMITIVE
));

153 
	`as£¹Th©
(
smrM­
)

154 .
	`dÛsNÙCÚšKey
("b");

155 
r
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

156 
SŒšg
 
b
 = 
smrM­
.
	`g‘
("a");

157 
smrM­
.
	`put
("b", 
b
);

158 
r
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

160 
	`as£¹Th©
(
smrM­
)

161 .
	`cÚšsEÁry
("b", "b");

162 
	}
}

164 @
	gTe¡


165 @
Suµ»ssW¬nšgs
("unchecked")

166 
public
 
	$uÄ–©edT¿n§ùiÚDÛsNÙCÚæiù
()

167 
throws
 
Exû±iÚ
 {

169 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

171 
M­
<
SŒšg
, SŒšg> 
smrM­
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

172 .
	`£tSŒ—mName
("map‡")

173 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

174 .
	`İ’
();

176 
M­
<
SŒšg
, SŒšg> 
smrM­B
 = 
r
.
	`g‘ObjeùsV›w
().
	`bud
()

177 .
	`£tSŒ—mName
("map b")

178 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

179 .
	`İ’
();

181 
smrM­
.
	`put
("a", "b");

183 
r
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

184 
SŒšg
 
b
 = 
smrM­
.
	`g‘
("a");

185 
smrM­B
.
	`put
("b", 
b
);

186 
r
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

189 
	`as£¹Th©
(
smrM­
)

190 .
	`dÛsNÙCÚšKey
("b");

191 
r
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

192 
b
 = 
smrM­
.
	`g‘
("a");

193 
smrM­
.
	`put
("b", 
b
);

194 
r
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

196 
	`as£¹Th©
(
smrM­
)

197 .
	`cÚšsEÁry
("b", "b");

198 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/QuorumFuturesFactoryTest.java

5 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

7 
impÜt
 
	gÜg
.
	g­ache
.
	gmav’
.
	gwagÚ
.
	gCÚÃùiÚExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gQuÜumUÄ—chabËExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
impÜt
 
	gjava
.
	gut
.
	gLškedHashS‘
;

13 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

14 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.*;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.*;

22 
public
 cÏs 
	cQuÜumFutu»sFaùÜyTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

24 @
Te¡


25 
public
 
	$‹¡SšgËFutu»Incom¶‘eCom¶‘e
(è
throws
 
Exû±iÚ
 {

26 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

27 
Futu»
<
SŒšg
> 
»suÉ
 = 
QuÜumFutu»sFaùÜy
.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
);

28 
Œy
 {

29 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

30 
	`ç
();

31 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

34 
	`as£¹F®£
(
»suÉ
.
	`isDÚe
());

35 
f1
.
	`com¶‘e
("ok");

36 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

37 
	`as£¹Equ®s
("ok", 
v®ue
);

38 
	`as£¹True
(
»suÉ
.
	`isDÚe
());

41 @
Te¡


42 
public
 
	$‹¡Infš™eG‘
(è
throws
 
Exû±iÚ
 {

43 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

44 
Futu»
<
SŒšg
> 
»suÉ
 = 
QuÜumFutu»sFaùÜy
.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
);

45 
f1
.
	`com¶‘e
("ok");

46 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
();

47 
	`as£¹Equ®s
("ok", 
v®ue
);

48 
	`as£¹True
(
»suÉ
.
	`isDÚe
());

49 
	}
}

52 @
Te¡


53 
public
 
	$‹¡2Futu»sIncom¶‘eCom¶‘e
(è
throws
 
Exû±iÚ
 {

54 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

55 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

56 
Futu»
<
SŒšg
> 
»suÉ
 = 
QuÜumFutu»sFaùÜy
.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
);

57 
Œy
 {

58 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

59 
	`ç
();

60 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

63 
f2
.
	`com¶‘e
("ok");

64 
Œy
 {

65 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

66 
	`ç
();

67 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

70 
f1
.
	`com¶‘e
("ok");

71 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

72 
	`as£¹Equ®s
("ok", 
v®ue
);

73 
	}
}

75 @
Te¡


76 
public
 
	$‹¡3Futu»sIncom¶‘eCom¶‘e
(è
throws
 
Exû±iÚ
 {

77 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

78 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

79 
Com¶‘abËFutu»
<
SŒšg
> 
f3
 = 
Ãw
 CompletableFuture<>();

80 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
, 
f3
);

81 
Œy
 {

82 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

83 
	`ç
();

84 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

87 
f2
.
	`com¶‘e
("ok");

88 
Œy
 {

89 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

90 
	`ç
();

91 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

94 
f3
.
	`com¶‘e
("ok");

95 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

96 
	`as£¹Equ®s
("ok", 
v®ue
);

97 
f1
.
	`com¶‘e
("ok");

98 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

99 
	`as£¹Equ®s
("ok", 
v®ue
);

100 
	`as£¹F®£
(
»suÉ
.
	`isCÚæiù
());

101 
	}
}

107 @
Te¡


108 
public
 
	$‹¡3Futu»sW™hFœ¡WšÃrIncom¶‘eCom¶‘e
(è
throws
 
Exû±iÚ
 {

109 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

110 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

111 
Com¶‘abËFutu»
<
SŒšg
> 
f3
 = 
Ãw
 CompletableFuture<>();

112 
Futu»
<
SŒšg
> 
»suÉ
 = 
QuÜumFutu»sFaùÜy
.
	`g‘Fœ¡WšsFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
, 
f3
);

113 
Œy
 {

114 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

115 
	`ç
();

116 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

119 
f2
.
	`com¶‘e
("ok");

120 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

121 
	`as£¹Equ®s
("ok", 
v®ue
);

122 
	}
}

125 @
Te¡


126 
public
 
	$‹¡Exû±iÚ
(è
throws
 
Exû±iÚ
 {

127 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

128 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

129 
Com¶‘abËFutu»
<
SŒšg
> 
f3
 = 
Ãw
 CompletableFuture<>();

130 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
, 
f3
);

131 
f1
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`CÚÃùiÚExû±iÚ
(""));

132 
f3
.
	`com¶‘e
("");

133 
Œy
 {

134 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

135 
	`ç
();

136 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

139 
f2
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`IÎeg®Argum’tExû±iÚ
());

140 
Œy
 {

141 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

142 
	`ç
();

143 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

146 
	`as£¹True
(
»suÉ
.
	`isDÚe
());

147 
S‘
<
CÏss
> 
£t
 = 
Ãw
 
LškedHashS‘
<>();

148 
ThrowabË
 
t
: 
»suÉ
.
	`g‘ThrowabËs
()) {

149 
£t
.
	`add
(
t
.
	`g‘CÏss
());

151 
	`as£¹True
(
£t
.
	`cÚšs
(
CÚÃùiÚExû±iÚ
.
şass
));

152 
	`as£¹True
(
£t
.
	`cÚšs
(
IÎeg®Argum’tExû±iÚ
.
şass
));

153 
	}
}

155 @
Te¡


156 
public
 
	$‹¡FaFa¡Exû±iÚSšgË
(è
throws
 
Exû±iÚ
 {

157 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

158 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

159 
Com¶‘abËFutu»
<
SŒšg
> 
f3
 = 
Ãw
 CompletableFuture<>();

160 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
,

161 
Ãw
 
Com¶‘abËFutu»
[]{
f1
, 
f2
, 
f3
}, 
NuÎPoš‹rExû±iÚ
.
şass
, 
IÎeg®AcûssE¼Ü
.class);

162 
f1
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`NuÎPoš‹rExû±iÚ
());

163 
Œy
 {

164 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

165 
	`ç
();

166 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

169 
	`as£¹True
(
»suÉ
.
	`isDÚe
());

170 
S‘
<
CÏss
> 
£t
 = 
Ãw
 
LškedHashS‘
<>();

171 
ThrowabË
 
t
: 
»suÉ
.
	`g‘ThrowabËs
()) {

172 
£t
.
	`add
(
t
.
	`g‘CÏss
());

174 
	`as£¹True
(
£t
.
	`cÚšs
(
NuÎPoš‹rExû±iÚ
.
şass
));

175 
	}
}

178 @
Te¡


179 
public
 
	$‹¡CªûËdFromInside
(è
throws
 
Exû±iÚ
 {

180 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

181 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
);

182 
f1
.
	`ÿnûl
(
Œue
);

183 
Œy
 {

184 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

185 
	`ç
();

186 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

187 
	`as£¹True
(
e
.
	`g‘Cau£
(è
š¡ªûof
 
QuÜumUÄ—chabËExû±iÚ
);

188 
	`as£¹Equ®s
(0, ((
QuÜumUÄ—chabËExû±iÚ
)
e
.
	`g‘Cau£
()).
	`g‘R—chabË
());

189 
	`as£¹Equ®s
(1, ((
QuÜumUÄ—chabËExû±iÚ
)
e
.
	`g‘Cau£
()).
	`g‘Requœed
());

191 
	`as£¹True
(
»suÉ
.
	`isCªûÎed
());

192 
	`as£¹True
(
»suÉ
.
	`isDÚe
());

193 
	`as£¹F®£
(
»suÉ
.
	`isCÚæiù
());

194 
	`as£¹True
(
»suÉ
.
	`g‘ThrowabËs
().
	`isEm±y
());

195 
	}
}

198 @
Te¡


199 
public
 
	$‹¡CªûËdPlusExû±iÚ
(è
throws
 
Exû±iÚ
 {

200 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

201 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

202 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
);

203 
f1
.
	`ÿnûl
(
Œue
);

204 
f2
.
	`com¶‘eExû±iÚ®ly
(
Ãw
 
	`NuÎPoš‹rExû±iÚ
());

205 
Œy
 {

206 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

207 
	`ç
();

208 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

211 
	`as£¹True
(
»suÉ
.
	`isCªûÎed
());

212 
	`as£¹True
(
»suÉ
.
	`isDÚe
());

213 
	`as£¹Equ®s
(
»suÉ
.
	`g‘ThrowabËs
().
	`™”©Ü
().
	`Ãxt
().
	`g‘CÏss
(), 
NuÎPoš‹rExû±iÚ
.
şass
);

214 
	}
}

217 @
Te¡


218 
public
 
	$‹¡3Futu»sCom¶‘eW™hResŞvedCÚæiù
(è
throws
 
Exû±iÚ
 {

219 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

220 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

221 
Com¶‘abËFutu»
<
SŒšg
> 
f3
 = 
Ãw
 CompletableFuture<>();

222 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
, 
f3
);

223 
f2
.
	`com¶‘e
("ok");

224 
Œy
 {

225 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

226 
	`ç
();

227 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

230 
f3
.
	`com¶‘e
("not-ok");

231 
Œy
 {

232 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

233 } 
	`ÿtch
 (
TimeoutExû±iÚ
 
e
) {

236 
f1
.
	`com¶‘e
("ok");

237 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

238 
	`as£¹Equ®s
("ok", 
v®ue
);

239 
	`as£¹True
(
»suÉ
.
	`isCÚæiù
());

240 
	}
}

243 @
Te¡


244 
public
 
	$‹¡3Futu»sCom¶‘eW™hUÄesŞvedCÚæiù
(è
throws
 
Exû±iÚ
 {

245 
Com¶‘abËFutu»
<
SŒšg
> 
f1
 = 
Ãw
 CompletableFuture<>();

246 
Com¶‘abËFutu»
<
SŒšg
> 
f2
 = 
Ãw
 CompletableFuture<>();

247 
Com¶‘abËFutu»
<
SŒšg
> 
f3
 = 
Ãw
 CompletableFuture<>();

248 
QuÜumFutu»sFaùÜy
.
Compos™eFutu»
<
SŒšg
> 
»suÉ
 = QuÜumFutu»sFaùÜy.
	`g‘QuÜumFutu»
(SŒšg::
com·»To
, 
f1
, 
f2
, 
f3
);

249 
f2
.
	`com¶‘e
("ok");

250 
f3
.
	`com¶‘e
("not-ok");

251 
f1
.
	`com¶‘e
("1/3 split brain");

252 
Œy
 {

253 
Objeù
 
v®ue
 = 
»suÉ
.
	`g‘
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
(), 
TimeUn™
.
MILLISECONDS
);

254 
	`ç
();

255 } 
	`ÿtch
 (
ExecutiÚExû±iÚ
 
e
) {

256 
	`as£¹True
(
e
.
	`g‘Cau£
(è
š¡ªûof
 
QuÜumUÄ—chabËExû±iÚ
);

257 
	`as£¹Equ®s
(1, ((
QuÜumUÄ—chabËExû±iÚ
è
e
.
	`g‘Cau£
()).
	`g‘R—chabË
());

258 
	`as£¹Equ®s
(2, ((
QuÜumUÄ—chabËExû±iÚ
è
e
.
	`g‘Cau£
()).
	`g‘Requœed
());

260 
	`as£¹True
(
»suÉ
.
	`isCÚæiù
());

261 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/QuorumReplicationStreamViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

6 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

8 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

13 
public
 cÏs 
	cQuÜumR•liÿtiÚSŒ—mV›wTe¡
 
ex‹nds
 
	mSŒ—mV›wTe¡
 {

14 @
	mBefÜe


15 @
Ov”ride


16 
public
 
	$£tRuÁime
(è
throws
 
Exû±iÚ
 {

17 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

19 
Layout
 
ÃwLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘Layout
();

20 
ÃwLayout
.
	`g‘Segm’t
(0L).
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
);

21 
ÃwLayout
.
	`£tEpoch
(1);

22 
r
.
	`£tCacheDi§bËd
(
Œue
);

23 
r
.
	`g‘LayoutV›w
().
	`comm™‹d
(1L, 
ÃwLayout
);

24 
r
.
	`šv®id©eLayout
();

25 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
ÃwLayout
).
	`g‘Prim¬ySequ’ûrCl›Á
()

26 .
	`boÙ¡¿p
(0L, 
CŞËùiÚs
.
	`em±yM­
(), 1L, 
çl£
).
	`g‘
();

30 @
Te¡


31 @
	`Suµ»ssW¬nšgs
("unchecked")

32 
public
 
	$ÿnR—dWr™eFromSŒ—m
()

33 
throws
 
Exû±iÚ
 {

34 
su³r
.
	`ÿnR—dWr™eFromSŒ—m
();

35 
	}
}

37 @
	gTe¡


38 @
Suµ»ssW¬nšgs
("unchecked")

39 
public
 
	$ÿnR—dWr™eFromSŒ—mCÚcu¼’t
()

40 
throws
 
Exû±iÚ
 {

41 
su³r
.
	`ÿnR—dWr™eFromSŒ—mCÚcu¼’t
();

42 
	`as£¹NÙNuÎ
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Rªk
());

43 
	}
}

45 @
	gTe¡


46 @
Suµ»ssW¬nšgs
("unchecked")

47 
public
 
	$ÿnR—dWr™eFromCachedSŒ—m
()

48 
throws
 
Exû±iÚ
 {

49 
su³r
.
	`ÿnR—dWr™eFromCachedSŒ—m
();

50 
	}
}

52 @
Te¡


53 
public
 
	$ÿnS“kOnSŒ—m
()

54 
throws
 
Exû±iÚ


56 
su³r
.
	`ÿnS“kOnSŒ—m
();

57 
	}
}

59 @
Te¡


60 
public
 
	$ÿnDoP»viousOnSŒ—m
()

61 
throws
 
Exû±iÚ


63 
su³r
.
	`ÿnDoP»viousOnSŒ—m
();

64 
	}
}

66 @
	gTe¡


67 @
Suµ»ssW¬nšgs
("unchecked")

68 
public
 
	$¡»amCªSurviveOv”wr™eExû±iÚ
()

69 
throws
 
Exû±iÚ
 {

70 
su³r
.
	`¡»amCªSurviveOv”wr™eExû±iÚ
();

71 
	}
}

73 @
	gTe¡


74 @
Suµ»ssW¬nšgs
("unchecked")

75 
public
 
	$¡»amWlHŞeFl
()

76 
throws
 
Exû±iÚ
 {

77 
su³r
.
	`¡»amWlHŞeFl
();

78 
	}
}

81 @
	gTe¡


82 @
Suµ»ssW¬nšgs
("unchecked")

83 
public
 
	$¡»amW™hHŞeFl
()

84 
throws
 
Exû±iÚ
 {

85 
su³r
.
	`¡»amW™hHŞeFl
();

86 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/SequencerViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gSŒ—mAdd»ssRªge
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
impÜt
 
	gÜg
.
	grßršgb™m­
.
	glÚglÚg
.
	gRßršg64NavigabËM­
;

11 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

18 
public
 cÏs 
	cSequ’ûrV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

20 @
G‘‹r


21 
fš®
 
SŒšg
 
	mdeçuÉCÚfigu¿tiÚSŒšg
 = 
g‘DeçuÉEndpošt
();

23 @
Te¡


24 
public
 
	$ÿnAcquœeFœ¡Tok’
() {

25 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

26 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
().
	`g‘Tok’
())

27 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 0L));

30 @
Te¡


31 
public
 
	$ÿnQu”yMuÉËSŒ—ms
() {

32 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

34 
fš®
 
tÙ®SŒ—ms
 = 3;

35 
UUID
 
¡»am1
 = UUID.
	`¿ndomUUID
();

36 
UUID
 
¡»am2
 = UUID.
	`¿ndomUUID
();

37 
UUID
 
¡»am3
 = UUID.
	`¿ndomUUID
();

39 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»am1
).
	`g‘Tok’
())

40 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0l, 0l));

41 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»am2
).
	`g‘Tok’
())

42 .
	`isEqu®To
(
Ãw
 
	`Tok’
( 0l, 1l));

44 
Tok’Re¥Ú£
 
»¥Ú£
 = 
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»am1
, 
¡»am2
, 
¡»am3
);

45 
	`as£¹Th©
(
»¥Ú£
.
	`g‘SŒ—mTasCouÁ
()).
	`isEqu®To
(
tÙ®SŒ—ms
);

46 
	`as£¹Th©
(
»¥Ú£
.
	`g‘SŒ—mTa
(
¡»am1
)).
	`isEqu®To
(0l);

47 
	`as£¹Th©
(
»¥Ú£
.
	`g‘SŒ—mTa
(
¡»am2
)).
	`isEqu®To
(1l);

48 
	`as£¹Th©
(
»¥Ú£
.
	`g‘SŒ—mTa
(
¡»am3
)).
	`isEqu®To
(
Add»ss
.
NON_EXIST
);

49 
	}
}

51 @
Te¡


52 
public
 
	$tok’sA»Inüem’tšg
() {

53 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

54 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
().
	`g‘Tok’
())

55 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 0L));

56 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
().
	`g‘Tok’
())

57 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 1L));

58 
	}
}

60 @
Te¡


61 
public
 
	$checkTok’WÜks
() {

62 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

63 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
().
	`g‘Tok’
())

64 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 0L));

65 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Tok’
())

66 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 0L));

67 
	}
}

69 @
Te¡


70 
public
 
	$checkSŒ—mTok’sWÜk
() {

71 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

72 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

73 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am B".
	`g‘By‹s
());

75 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
).
	`g‘Tok’
())

76 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 0L));

77 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amA
))

78 .
	`isEqu®To
(0L);

79 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amB
).
	`g‘Tok’
())

80 .
	`isEqu®To
(
Ãw
 
	`Tok’
(0L, 1L));

81 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amB
))

82 .
	`isEqu®To
(1L);

83 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amA
))

84 .
	`isEqu®To
(0L);

85 
	}
}

87 @
Te¡


88 
public
 
	$checkBackPoš‹rsWÜk
() {

89 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

90 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

91 
UUID
 
¡»amB
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am B".
	`g‘By‹s
());

93 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
).
	`g‘Backpoš‹rM­
())

94 .
	`cÚšsEÁry
(
¡»amA
, 
Add»ss
.
NON_EXIST
);

95 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
Ãw
 
UUID
[] {
¡»amA
}).
	`g‘Backpoš‹rM­
())

96 .
	`isEm±y
();

97 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amB
).
	`g‘Backpoš‹rM­
())

98 .
	`cÚšsEÁry
(
¡»amB
, 
Add»ss
.
NON_EXIST
);

99 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
Ãw
 
UUID
[] {
¡»amB
}).
	`g‘Backpoš‹rM­
())

100 .
	`isEm±y
();

101 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
).
	`g‘Backpoš‹rM­
())

102 .
	`cÚšsEÁry
(
¡»amA
, 0L);

103 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amB
).
	`g‘Backpoš‹rM­
())

104 .
	`cÚšsEÁry
(
¡»amB
, 1L);

105 
	}
}

111 @
Te¡


112 
public
 
	$checkSŒ—mAdd»ssS·ûAüossEpochs
(è
throws
 
Exû±iÚ
 {

113 
CÜfuRuÁime
 
cÚŒŞRuÁime
 = 
	`g‘DeçuÉRuÁime
();

114 
CÜfuRuÁime
 
r
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

115 
Layout
 
Üigš®Layout
 = 
cÚŒŞRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

117 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

119 
fš®
 
tok’CouÁ
 = 3;

120 
Rßršg64NavigabËM­
 
ex³ùedM­
 = 
Ãw
 
	`Rßršg64NavigabËM­
();

121 
i
 = 0; i < 
tok’CouÁ
; i++) {

122 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

123 
ex³ùedM­
.
	`add
(
i
);

126 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`g‘SŒ—mAdd»ssS·û
(

127 
Ãw
 
	`SŒ—mAdd»ssRªge
(
¡»amA
, 
tok’CouÁ
, 
Add»ss
.
NON_ADDRESS
)).
	`g‘Add»ssM­
())

128 .
	`isEqu®To
(
ex³ùedM­
);

131 
	`šüem’tClu¡”Epoch
(
cÚŒŞRuÁime
);

132 
cÚŒŞRuÁime
.
	`šv®id©eLayout
();

133 
Layout
 
ÃwLayout
 = 
cÚŒŞRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

134 
cÚŒŞRuÁime
.
	`g‘LayoutMªagem’tV›w
().
	`»cÚfigu»Sequ’ûrS”v”s
(
Üigš®Layout
, 
ÃwLayout
, 
çl£
);

138 
	`as£¹Th©
(
r
.
	`g‘Sequ’ûrV›w
().
	`g‘SŒ—mAdd»ssS·û
(

139 
Ãw
 
	`SŒ—mAdd»ssRªge
(
¡»amA
, 
tok’CouÁ
, 
Add»ss
.
NON_ADDRESS
)).
	`g‘Add»ssM­
())

140 .
	`isEqu®To
(
ex³ùedM­
);

141 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/SnowflakeGuidGeneratorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

5 
impÜt
 
	gjava
.
	gut
.
	gHashS‘
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

8 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

13 
public
 cÏs 
	cSnowæakeGuidG’”©ÜTe¡
 {

15 @
Te¡


16 
public
 
	$¬eUniqueAndOrd”edLÚg
() {

17 
fš®
 
™”©iÚs
 = 1000;

18 
Ord”edGuidG’”©Ü
 
guidG’”©Ü
 = 
Ãw
 
	`SnowæakeGuidG’”©Ü
(
Sy¡em
.
	`id’t™yHashCode
(
this
));

19 
Ï¡V®ue
 = 0;

20 
HashS‘
<
LÚg
> 
uniq
 = 
Ãw
 HashS‘<>(
™”©iÚs
);

21 
i
 = 0; i < 
™”©iÚs
; i++) {

22 
cu¼’t
 = 
guidG’”©Ü
.
	`ÃxtLÚg
();

23 
	`as£¹Th©
(
cu¼’t
).
	`isG»©”Thª
(
Ï¡V®ue
);

24 
Ï¡V®ue
 = 
cu¼’t
;

25 
	`as£¹Th©
(
uniq
).
	`dÛsNÙCÚš
(
cu¼’t
);

26 
uniq
.
	`add
(
cu¼’t
);

30 @
Te¡


31 
public
 
	$¬eUniqueAndOrd”edUUID
() {

32 
fš®
 
™”©iÚs
 = 1000;

33 
Ord”edGuidG’”©Ü
 
guidG’”©Ü
 = 
Ãw
 
	`SnowæakeGuidG’”©Ü
(
Sy¡em
.
	`id’t™yHashCode
(
this
));

34 
UUID
 
Ï¡V®ue
 = 
Ãw
 
	`UUID
(0,0);

35 
HashS‘
<
UUID
> 
uniq
 = 
Ãw
 HashS‘<>(
™”©iÚs
);

36 
i
 = 0; i < 
™”©iÚs
; i++) {

37 
UUID
 
cu¼’t
 = 
guidG’”©Ü
.
	`ÃxtUUID
();

38 
	`as£¹Th©
(
cu¼’t
).
	`isG»©”Thª
(
Ï¡V®ue
);

39 
Ï¡V®ue
 = 
cu¼’t
;

40 
	`as£¹Th©
(
uniq
).
	`dÛsNÙCÚš
(
cu¼’t
);

41 
uniq
.
	`add
(
cu¼’t
);

43 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/StateTransferTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gCÚtiguousS‘
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gDisü‘eDomaš
;

5 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gRªge
;

6 
impÜt
 
	glombok
.
	gG‘‹r
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gcom´essiÚ
.
	gCodec
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xt
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gS”v”CÚ‹xtBud”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gÜche¡¿tÜ
.
	gaùiÚs
.
	gRe¡ÜeRedundªcyM”geSegm’ts
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	g»dundªcy
.
	gRedundªcyC®cuÏtÜ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gR—dRe¥Ú£
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gş›Ás
.
	gTe¡RuË
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gR‘ryExhau¡edExû±iÚ
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”StusR–Ÿb™y
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gCÚÃùiv™yStus
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gNodeStus
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gCFUts
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gNodeLoÿtÜ
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

28 
impÜt
 
	gÜg
.
	gjun™
.
	gAá”
;

29 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

30 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

32 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

33 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

34 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

35 
impÜt
 
	gjava
.
	gut
.
	gM­
;

36 
impÜt
 
	gjava
.
	gut
.
	gM­
.
	gEÁry
;

37 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

38 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCom¶‘abËFutu»
;

39 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeoutExû±iÚ
;

40 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicLÚg
;

41 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gCŞËùÜs
;

42 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gLÚgSŒ—m
;

44 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

45 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

46 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gClu¡”StusR•Üt
.
	gClu¡”Stus
.
	gSTABLE
;

47 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Uts
.
	g£tAgg»ssiveTimeouts
;

48 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Uts
.
	gwa™FÜLayoutChªge
;

53 
public
 cÏs 
	cS‹T¿nsãrTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

55 @
G‘‹r


56 
´Ùeùed
 
CÜfuRuÁime
 
	mcÜfuRuÁime
 = 
nuÎ
;

58 @
BefÜe


59 
public
 
	$ş—rRuÁime
() {

60 
cÜfuRuÁime
 = 
nuÎ
;

63 @
Aá”


64 
public
 
	$shutdownRuÁime
() {

65 ià(
cÜfuRuÁime
 !ğ
nuÎ
 && !cÜfuRuÁime.
	`isShutdown
()) {

66 
cÜfuRuÁime
.
	`shutdown
();

68 
	}
}

70 
´iv©e
 
	gM­
<
	gLÚg
, 
	gLogD©a
> 
	$g‘AÎNÚEm±yD©a
(
CÜfuRuÁime
 
cÜfuRuÁime
,

71 
SŒšg
 
’dpošt
, 
’d
è
throws
 
Exû±iÚ
 {

72 
R—dRe¥Ú£
 
»adRe¥Ú£
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
()

73 .
	`g‘LogUn™Cl›Á
(
’dpošt
)

74 .
	`»adAÎ
(
CÚtiguousS‘
.
	`ü—‹
(
Rªge
.
	`şo£d
(0L, 
’d
), 
Disü‘eDomaš
.
	`lÚgs
()).
	`asLi¡
())

75 .
	`g‘
();

76  
»adRe¥Ú£
.
	`g‘Add»s£s
().
	`’ŒyS‘
()

77 .
	`¡»am
()

78 .
	`f‹r
(
lÚgLogD©aEÁry
 -> !lÚgLogD©aEÁry.
	`g‘V®ue
().
	`isEm±y
())

79 .
	`cŞËù
(
CŞËùÜs
.
	`toM­
(
EÁry
::
g‘Key
, EÁry::
g‘V®ue
));

80 
	}
}

83 @
Te¡


88 
public
 
	$v”ifyAddNode
(è
throws
 
Exû±iÚ
 {

89 
	`addS”v”
(
SERVERS
.
PORT_0
);

90 
	`addS”v”
(
SERVERS
.
PORT_1
);

92 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

93 .
	`£tEpoch
(1L)

94 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

95 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

96 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

97 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

98 .
	`budSegm’t
()

99 .
	`£tS¹
(0L)

100 .
	`£tEnd
(-1)

101 .
	`budSŒe
()

102 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

103 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

104 .
	`addToSegm’t
()

105 .
	`addToLayout
()

106 .
	`bud
();

108 
	`boÙ¡¿pAÎS”v”s
(
l1
);

109 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

112 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

113 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

114 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

115 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

117 
	`addS”v”
(
SERVERS
.
PORT_2
);

118 
fš®
 
addNodeR‘r›s
 = 3;

119 
¹
.
	`g‘Mªagem’tV›w
()

120 .
	`addNode
(
SERVERS
.
ENDPOINT_2
, 
addNodeR‘r›s
, 
Du¿tiÚ
.
	`ofMšu‹s
(1L), Du¿tiÚ.
	`ofSecÚds
(1));

122 
¹
.
	`šv®id©eLayout
();

123 
fš®
 
ex³ùedEpoch
 = 3L;

125 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

126 .
	`£tEpoch
(
ex³ùedEpoch
)

127 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

128 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

129 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

130 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

131 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

132 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

133 .
	`budSegm’t
()

134 .
	`£tS¹
(0L)

135 .
	`£tEnd
(-1L)

136 .
	`budSŒe
()

137 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

138 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

139 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

140 .
	`addToSegm’t
()

141 .
	`addToLayout
()

142 .
	`bud
();

144 
	`as£¹Th©
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
()).
	`isEqu®To
(
ex³ùedLayout
);

145 
Ï¡Add»ss
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

146 
M­
<
LÚg
, 
LogD©a
> 
m­_0
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_0
, 
Ï¡Add»ss
);

147 
M­
<
LÚg
, 
LogD©a
> 
m­_2
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_2
, 
Ï¡Add»ss
);

149 
	`as£¹Th©
(
m­_2
.
	`’ŒyS‘
()).
	`cÚšsOÆyEËm’tsOf
(
m­_0
.entrySet());

150 
	}
}

152 @
Te¡


158 
public
 
	$v”ifyRedundªcyRe¡Ü©iÚ
(è
throws
 
Exû±iÚ
 {

159 
	`addS”v”
(
SERVERS
.
PORT_0
);

160 
	`addS”v”
(
SERVERS
.
PORT_1
);

161 
	`addS”v”
(
SERVERS
.
PORT_2
);

162 
fš®
 
wr™‹nAdd»s£sB©ch1
 = 3L;

163 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

164 .
	`£tEpoch
(1L)

165 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

166 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

167 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

168 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

169 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

170 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

171 .
	`budSegm’t
()

172 .
	`£tS¹
(0L)

173 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

174 .
	`budSŒe
()

175 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

176 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

177 .
	`addToSegm’t
()

178 .
	`addToLayout
()

179 .
	`budSegm’t
()

180 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

181 .
	`£tEnd
(-1L)

182 .
	`budSŒe
()

183 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

184 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

185 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

186 .
	`addToSegm’t
()

187 .
	`addToLayout
()

188 .
	`bud
();

190 
	`boÙ¡¿pAÎS”v”s
(
l1
);

192 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

193 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

194 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

195 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

196 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

198 
Clu¡”StusR•Üt
 
şu¡”Stus
 = 
nuÎ
;

199 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

200 
şu¡”Stus
 = 
¹
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

201 ià(
şu¡”Stus
.
	`g‘Clu¡”Stus
().
	`equ®s
(
Clu¡”Stus
.
DB_SYNCING
)) {

202 
SË•
.
	`¦“pUnš‹¼u±ibly
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
);

208 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

209 .
	`£tEpoch
(2L)

210 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

211 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

212 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

213 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

214 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

215 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

216 .
	`budSegm’t
()

217 .
	`£tS¹
(0L)

218 .
	`£tEnd
(-1L)

219 .
	`budSŒe
()

220 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

221 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

222 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

223 .
	`addToSegm’t
()

224 .
	`addToLayout
()

225 .
	`bud
();

227 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
STABLE
);

228 
¹
.
	`šv®id©eLayout
();

229 
	`as£¹Th©
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
()).
	`isEqu®To
(
ex³ùedLayout
);

230 
Ï¡Add»ss
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

231 
M­
<
LÚg
, 
LogD©a
> 
m­_0
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_0
, 
Ï¡Add»ss
);

232 
M­
<
LÚg
, 
LogD©a
> 
m­_2
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_2
, 
Ï¡Add»ss
);

234 
	`as£¹Th©
(
m­_2
.
	`’ŒyS‘
()).
	`cÚšsOÆyEËm’tsOf
(
m­_0
.entrySet());

236 
	}
}

249 @
Te¡


250 
public
 
	$v”ifyS‹T¿nsãrAndM”ge
(è
throws
 
Exû±iÚ
 {

251 
	`addS”v”
(
SERVERS
.
PORT_0
);

252 
	`addS”v”
(
SERVERS
.
PORT_1
);

254 
fš®
 
wr™‹nAdd»s£sB©ch1
 = 3L;

255 
fš®
 
wr™‹nAdd»s£sB©ch2
 = 6L;

256 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

257 .
	`£tEpoch
(1L)

258 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

259 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

260 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

261 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

262 .
	`budSegm’t
()

263 .
	`£tS¹
(0L)

264 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

265 .
	`budSŒe
()

266 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

267 .
	`addToSegm’t
()

268 .
	`addToLayout
()

269 .
	`budSegm’t
()

270 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

271 .
	`£tEnd
(-1L)

272 .
	`budSŒe
()

273 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

274 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

275 .
	`addToSegm’t
()

276 .
	`addToLayout
()

277 .
	`bud
();

278 
	`boÙ¡¿pAÎS”v”s
(
l1
);

280 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

282 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

284 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

285 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

286 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

289 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

290 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

291 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

293 
	`addS”v”
(
SERVERS
.
PORT_2
);

294 
fš®
 
addNodeR‘r›s
 = 3;

295 
¹
.
	`g‘Mªagem’tV›w
()

296 .
	`addNode
(
SERVERS
.
ENDPOINT_2
, 
addNodeR‘r›s
, 
Du¿tiÚ
.
	`ofMšu‹s
(1L), Du¿tiÚ.
	`ofSecÚds
(1));

298 
¹
.
	`šv®id©eLayout
();

299 
fš®
 
fš®EpochAá”Add
 = 3L;

301 
Layout
 
ex³ùedLayout1
 = 
Ãw
 
	`Te¡LayoutBud”
()

302 .
	`£tEpoch
(
fš®EpochAá”Add
)

303 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

304 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

305 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

306 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

307 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

308 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

309 .
	`budSegm’t
()

310 .
	`£tS¹
(0L)

311 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

312 .
	`budSŒe
()

313 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

314 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

315 .
	`addToSegm’t
()

316 .
	`addToLayout
()

317 .
	`budSegm’t
()

318 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

319 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch2
)

320 .
	`budSŒe
()

321 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

322 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

323 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

324 .
	`addToSegm’t
()

325 .
	`addToLayout
()

326 .
	`budSegm’t
()

327 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch2
)

328 .
	`£tEnd
(-1L)

329 .
	`budSŒe
()

330 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

331 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

332 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

333 .
	`addToSegm’t
()

334 .
	`addToLayout
()

335 .
	`bud
();

337 
Clu¡”StusR•Üt
 
şu¡”Stus
 = 
¹
.
	`g‘Mªagem’tV›w
().
	`g‘Clu¡”Stus
();

338 
M­
<
SŒšg
, 
CÚÃùiv™yStus
> 
nodeCÚÃùiv™yM­
 = 
şu¡”Stus
.
	`g‘Cl›ÁS”v”CÚÃùiv™yStusM­
();

339 
M­
<
SŒšg
, 
NodeStus
> 
nodeStusM­
 = 
şu¡”Stus
.
	`g‘Clu¡”NodeStusM­
();

340 
Clu¡”StusR–Ÿb™y
 
şu¡”StusR–Ÿb™y
 = 
şu¡”Stus
.
	`g‘Clu¡”StusR–Ÿb™y
();

341 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

342 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

343 
	`as£¹Th©
(
nodeCÚÃùiv™yM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
CÚÃùiv™yStus
.
RESPONSIVE
);

344 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_0
)).
	`isEqu®To
(
NodeStus
.
UP
);

345 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_1
)).
	`isEqu®To
(
NodeStus
.
DB_SYNCING
);

346 
	`as£¹Th©
(
nodeStusM­
.
	`g‘
(
SERVERS
.
ENDPOINT_2
)).
	`isEqu®To
(
NodeStus
.
UP
);

347 
	`as£¹Th©
(
şu¡”Stus
.
	`g‘Clu¡”Stus
()).
	`isEqu®To
(
Clu¡”Stus
.
DB_SYNCING
);

348 
	`as£¹Th©
(
şu¡”StusR–Ÿb™y
).
	`isEqu®To
(
Clu¡”StusR–Ÿb™y
.
STRONG_QUORUM
);

351 
	`as£¹Th©
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`equ®s
(
ex³ùedLayout1
)

352 || 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
()

353 .
	`equ®s
(
Ãw
 
	`LayoutBud”
(
ex³ùedLayout1
).
	`£tEpoch
(
fš®EpochAá”Add
 + 1).
	`bud
())).
	`isTrue
();

355 
Ï¡Add»ss
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

357 
M­
<
LÚg
, 
LogD©a
> 
m­_0
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_0
, 
Ï¡Add»ss
);

358 
M­
<
LÚg
, 
LogD©a
> 
m­_2
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_2
, 
Ï¡Add»ss
);

360 
	`as£¹Th©
(
m­_2
.
	`’ŒyS‘
()).
	`cÚšsOÆyEËm’tsOf
(
m­_0
.entrySet());

361 
	}
}

394 @
Te¡


395 
public
 
	$v”ifyS‹T¿nsãrAndM”geInH—l
(è
throws
 
Exû±iÚ
 {

397 
	`addS”v”
(
SERVERS
.
PORT_0
);

398 
	`addS”v”
(
SERVERS
.
PORT_1
);

399 
	`addS”v”
(
SERVERS
.
PORT_2
);

401 
	`addS”v”RuË
(
SERVERS
.
PORT_2
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(

402 
msg
 -> !msg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
LAYOUT_BOOTSTRAP
)

403 && !
msg
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
MANAGEMENT_BOOTSTRAP_REQUEST
))

404 .
	`drİ
());

406 
fš®
 
wr™‹nAdd»s£sB©ch1
 = 3L;

407 
fš®
 
wr™‹nAdd»s£sB©ch2
 = 6L;

408 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

409 .
	`£tEpoch
(1L)

410 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

411 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

412 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

413 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

414 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

415 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

416 .
	`budSegm’t
()

417 .
	`£tS¹
(0L)

418 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

419 .
	`budSŒe
()

420 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

421 .
	`addToSegm’t
()

422 .
	`addToLayout
()

423 .
	`budSegm’t
()

424 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

425 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch2
)

426 .
	`budSŒe
()

427 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

428 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

429 .
	`addToSegm’t
()

430 .
	`addToLayout
()

431 .
	`budSegm’t
()

432 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch2
)

433 .
	`£tEnd
(-1L)

434 .
	`budSŒe
()

435 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

436 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

437 .
	`addToSegm’t
()

438 .
	`addToLayout
()

439 .
	`addUÄe¥ÚsiveS”v”
(
SERVERS
.
PORT_2
)

440 .
	`bud
();

441 
	`boÙ¡¿pAÎS”v”s
(
l1
);

443 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

444 
	`£tAgg»ssiveTimeouts
(
l1
, 
¹
,

445 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`g‘Mªagem’tAg’t
().
	`g‘CÜfuRuÁime
());

446 
	`£tAgg»ssiveD‘eùÜTimeouts
(
SERVERS
.
PORT_0
);

447 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

450 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

451 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

452 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

455 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

456 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

457 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

460 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

461 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

462 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

465 
	`ş—rS”v”RuËs
(
SERVERS
.
PORT_2
);

467 
¹
.
	`šv®id©eLayout
();

470 
	`wa™FÜLayoutChªge
(
Ïyout
 ->†ayout.
	`g‘UÄe¥ÚsiveS”v”s
().
	`isEm±y
() &&

471 
Ïyout
.
£gm’ts
.
	`size
() == 1,

472 
¹
);

474 
fš®
 
SŒšg
[] 
ex³ùedNodes
 = 
Ãw
 SŒšg[]{
SERVERS
.
ENDPOINT_0
,

475 
SERVERS
.
ENDPOINT_1
,

476 
SERVERS
.
ENDPOINT_2
};

477 
fš®
 
Layout
 
aùu®Layout
 = 
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
();

480 
	`as£¹Th©
(
aùu®Layout
.
	`g‘AÎAùiveS”v”s
()).
	`cÚšsExaùlyInAnyOrd”
(
ex³ùedNodes
);

483 
	`as£¹Th©
(
aùu®Layout
.
	`g‘Segm’ts
().
	`size
()).
	`isEqu®To
(1);

486 
	`as£¹Th©
(
aùu®Layout
.
	`g‘Segm’ts
().
	`g‘
(0).
¡¬t
).
	`isEqu®To
(0);

487 
	`as£¹Th©
(
aùu®Layout
.
	`g‘Segm’ts
().
	`g‘
(0).
’d
).
	`isEqu®To
(-1);

490 
	`as£¹Th©
(
aùu®Layout
.
	`g‘UÄe¥ÚsiveS”v”s
()).
	`isEm±y
();

493 
	`as£¹Th©
(
aùu®Layout
.
	`g‘LayoutS”v”s
()).
	`cÚšsExaùly
(
ex³ùedNodes
);

496 
	`as£¹Th©
(
aùu®Layout
.
	`g‘Sequ’ûrs
()).
	`cÚšsExaùly
(
ex³ùedNodes
);

498 
fš®
 
Ï¡Add»ss
 = 
¹
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

501 
M­
<
LÚg
, 
LogD©a
> 
m­_0
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_0
, 
Ï¡Add»ss
);

502 
M­
<
LÚg
, 
LogD©a
> 
m­_2
 = 
	`g‘AÎNÚEm±yD©a
(
¹
, 
SERVERS
.
ENDPOINT_2
, 
Ï¡Add»ss
);

503 
	`as£¹Th©
(
m­_2
.
	`’ŒyS‘
()).
	`cÚšsOÆyEËm’tsOf
(
m­_0
.entrySet());

504 
	}
}

521 @
Te¡


522 
public
 
	$v”ifyS‹T¿nsãrNÙH­³nButM”geSucûeds
() {

523 
	`addS”v”
(
SERVERS
.
PORT_0
);

524 
	`addS”v”
(
SERVERS
.
PORT_1
);

526 
fš®
 
£gm’tSize
 = 5L;

527 
fš®
 
numSegm’ts
 = 3;

529 
Layout
 
Ïyout
 = 
Ãw
 
	`Te¡LayoutBud”
()

530 .
	`£tEpoch
(1L)

531 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

532 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

533 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

534 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

535 .
	`budSegm’t
()

536 .
	`£tS¹
(0L)

537 .
	`£tEnd
(
£gm’tSize
)

538 .
	`budSŒe
()

539 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

540 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

541 .
	`addToSegm’t
()

542 .
	`addToLayout
()

543 .
	`budSegm’t
()

544 .
	`£tS¹
(
£gm’tSize
)

545 .
	`£tEnd
(
£gm’tSize
 * 2)

546 .
	`budSŒe
()

547 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

548 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

549 .
	`addToSegm’t
()

550 .
	`addToLayout
()

551 .
	`budSegm’t
()

552 .
	`£tS¹
(
£gm’tSize
 * 2)

553 .
	`£tEnd
(-1L)

554 .
	`budSŒe
()

555 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

556 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

557 .
	`addToSegm’t
()

558 .
	`addToLayout
()

559 .
	`bud
();

562 
	`addS”v”RuË
(
SERVERS
.
PORT_1
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(
m
 ->

563 
m
.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
READ_RESPONSE
)).
	`drİ
());

565 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

567 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

569 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

570 
i
 = 0; i < 
£gm’tSize
 * 
numSegm’ts
; i++) {

571 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

575 
	`wa™FÜLayoutChªge
(
l
 ->†.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
¹
);

576 
	}
}

585 @
Te¡


586 
public
 
	$v”ifyP¬tŸlS‹T¿nsãrCom¶‘iÚOnR‘ry
(è
throws
 
Exû±iÚ
 {

588 
S”v”CÚ‹xt
 
sc1
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

589 .
	`£tSšgË
(
çl£
)

590 .
	`£tS”v”Rou‹r
(
Ãw
 
	`Te¡S”v”Rou‹r
(
SERVERS
.
PORT_0
))

591 .
	`£tPÜt
(
SERVERS
.
PORT_0
).
	`bud
();

592 
	`addS”v”
(
SERVERS
.
PORT_0
, 
sc1
);

594 
S”v”CÚ‹xt
 
sc2
 = 
Ãw
 
	`S”v”CÚ‹xtBud”
()

595 .
	`£tMemÜy
(
çl£
)

596 .
	`£tSšgË
(
çl£
)

597 .
	`£tLogP©h
(
PARAMETERS
.
TEST_TEMP_DIR
)

598 .
	`£tS”v”Rou‹r
(
Ãw
 
	`Te¡S”v”Rou‹r
(
SERVERS
.
PORT_1
))

599 .
	`£tPÜt
(
SERVERS
.
PORT_1
).
	`bud
();

600 
	`addS”v”
(
SERVERS
.
PORT_1
, 
sc2
);

602 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

603 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

605 
fš®
 
wr™‹nAdd»s£sB©ch1
 = 100;

606 
fš®
 
wr™‹nAdd»s£sB©ch2
 = 5;

608 
Layout
 
Ïyout
 = 
Ãw
 
	`Te¡LayoutBud”
()

609 .
	`£tEpoch
(1L)

610 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

611 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

612 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

613 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

614 .
	`budSegm’t
()

615 .
	`£tS¹
(0L)

616 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

617 .
	`budSŒe
()

618 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

619 .
	`addToSegm’t
()

620 .
	`addToLayout
()

621 .
	`budSegm’t
()

622 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

623 .
	`£tEnd
(-1)

624 .
	`budSŒe
()

625 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

626 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

627 .
	`addToSegm’t
()

628 .
	`addToLayout
()

629 .
	`bud
();

630 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

632 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

634 
	`£tAgg»ssiveTimeouts
(
Ïyout
, 
¹
);

636 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

638 
i
 = 0; i < (
wr™‹nAdd»s£sB©ch1
 + 
wr™‹nAdd»s£sB©ch2
); i++) {

639 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

642 
fš®
 
tÙ®Wr™‹n
 = 50L;

644 
fš®
 
¿ngeWr™eAÎowedCouÁ
 = (
tÙ®Wr™‹n
 / 
¹
.
	`g‘P¬am‘”s
().
	`g‘BulkR—dSize
());

646 
AtomicLÚg
 
®lowedWr™es
 = 
Ãw
 
	`AtomicLÚg
(
¿ngeWr™eAÎowedCouÁ
);

649 
	`addCl›ÁRuË
(
¹
, 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(

650 
msg
 -> msg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
RANGE_WRITE
) &&

651 
®lowedWr™es
.
	`deüem’tAndG‘
(è< 0).
	`drİ
());

653 
fš®
 
Re¡ÜeRedundªcyM”geSegm’ts
 
aùiÚ1
 = RestoreRedundancyMergeSegments

654 .
	`bud”
()

655 .
	`cu¼’tNode
(
SERVERS
.
ENDPOINT_1
)

656 .
	`»dundªcyC®cuÏtÜ
(
Ãw
 
	`RedundªcyC®cuÏtÜ
(
SERVERS
.
ENDPOINT_1
))

657 .
	`bud
();

660 
	`as£¹Th©ThrownBy
((è-> 
aùiÚ1
.
	`im¶
(
¹
))

661 .
	`isIn¡ªûOf
(
R‘ryExhau¡edExû±iÚ
.
şass
)

662 .
	`hasRoÙCau£In¡ªûOf
(
TimeoutExû±iÚ
.
şass
);

665 
A¼ayLi¡
<
LÚg
> 
knownAdd»s£s
 = 
Ãw
 A¼ayLi¡<>(
¹
.
	`g‘LayoutV›w
()

666 .
	`g‘RuÁimeLayout
()

667 .
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_1
)

668 .
	`»que¡KnownAdd»s£s
(0L, 
wr™‹nAdd»s£sB©ch1
 + 
wr™‹nAdd»s£sB©ch2
)

669 .
	`g‘
()

670 .
	`g‘KnownAdd»s£s
());

672 
Li¡
<
LÚg
> 
Œªsã¼edRªge
 = 
LÚgSŒ—m
.
	`¿nge
(0L, 
tÙ®Wr™‹n
).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

673 
fš®
 
¡¬t
 = 100L;

674 
fš®
 
’d
 = 105L;

676 
Li¡
<
LÚg
> 
İ’Segm’tD©a
 = 
LÚgSŒ—m
.
	`¿nge
(
¡¬t
, 
’d
).
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
());

678 
Œªsã¼edRªge
.
	`addAÎ
(
İ’Segm’tD©a
);

679 
	`as£¹Th©
(
knownAdd»s£s
).
	`isEqu®To
(
Œªsã¼edRªge
);

681 
	`ş—rCl›ÁRuËs
(
¹
);

684 
AtomicLÚg
 
d–B©ches
 = 
Ãw
 
	`AtomicLÚg
(0L);

687 
	`addCl›ÁRuË
(
¹
, 
SERVERS
.
ENDPOINT_1
, 
Ãw
 
	`Te¡RuË
().
	`m©ches
(

688 
msg
 -> msg.
	`g‘MsgTy³
().
	`equ®s
(
CÜfuMsgTy³
.
RANGE_WRITE
) &&

689 
d–B©ches
.
	`šüem’tAndG‘
() > 0));

691 
aùiÚ1
.
	`im¶
(
¹
);

693 
knownAdd»s£s
 = 
Ãw
 
A¼ayLi¡
<>(
¹
.
	`g‘LayoutV›w
()

694 .
	`g‘RuÁimeLayout
()

695 .
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_1
)

696 .
	`»que¡KnownAdd»s£s
(0L, 
wr™‹nAdd»s£sB©ch1
 + 
wr™‹nAdd»s£sB©ch2
)

697 .
	`g‘
()

698 .
	`g‘KnownAdd»s£s
());

701 
	`as£¹Th©
(
knownAdd»s£s
).
	`isEqu®To
(
LÚgSŒ—m


702 .
	`¿nge
(0L, 
wr™‹nAdd»s£sB©ch1
 + 
wr™‹nAdd»s£sB©ch2
)

703 .
	`boxed
().
	`cŞËù
(
CŞËùÜs
.
	`toLi¡
()));

706 
	`as£¹Th©
(
d–B©ches
.
	`g‘
(è* 
¹
.
	`g‘P¬am‘”s
().
	`g‘BulkR—dSize
())

707 .
	`isEqu®To
(
tÙ®Wr™‹n
);

709 
	}
}

711 
´iv©e
 
S”v”CÚ‹xt
 
	$cÚfigu»CÚ‹xt
(
pÜt
) {

712  
Ãw
 
	`S”v”CÚ‹xtBud”
()

713 .
	`£tSšgË
(
çl£
)

714 .
	`£tS”v”Rou‹r
(
Ãw
 
	`Te¡S”v”Rou‹r
(
pÜt
))

715 .
	`£tPÜt
(
pÜt
).
	`bud
();

716 
	}
}

718 
´iv©e
 
Re¡ÜeRedundªcyM”geSegm’ts
 
	$g‘Re¡ÜeAùiÚ
(
SŒšg
 
’dpošt
) {

719  
Re¡ÜeRedundªcyM”geSegm’ts


720 .
	`bud”
()

721 .
	`cu¼’tNode
(
’dpošt
)

722 .
	`»dundªcyC®cuÏtÜ
(
Ãw
 
	`RedundªcyC®cuÏtÜ
(
’dpošt
))

723 .
	`bud
();

724 
	}
}

726 
´iv©e
 
CÜfuRuÁime
 
	$g‘Te¡RuÁime
(
pÜt
, 
UUID
 
nodeId
) {

727  
	`g‘NewRuÁime
(
NodeLoÿtÜ
.
	`bud”
()

728 .
	`ho¡
("test")

729 .
	`pÜt
(
pÜt
)

730 .
	`nodeId
(
nodeId
)

731 .
	`bud
()).
	`cÚÃù
();

732 
	}
}

734 
´iv©e
 
	gCom¶‘abËFutu»
<
	gVoid
> 
	$runRe¡Üe
(
Re¡ÜeRedundªcyM”geSegm’ts
 
»¡Üe
, 
CÜfuRuÁime
 
¹
) {

735  
Com¶‘abËFutu»
.
	`runAsync
(() -> {

736 
Œy
 {

737 
»¡Üe
.
	`im¶
(
¹
);

738 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

739 
e
.
	`´štSckT¿û
();

742 
	}
}

747 @
Te¡


748 
public
 
	$v”ifyCÚcu¼’tCom¶‘iÚ
(è
throws
 
Exû±iÚ
 {

750 
£rv”1
 = 
SERVERS
.
PORT_0
;

751 
£rv”2
 = 
SERVERS
.
PORT_1
;

752 
£rv”3
 = 
SERVERS
.
PORT_2
;

754 
S”v”CÚ‹xt
 
sc1
 = 
	`cÚfigu»CÚ‹xt
(
£rv”1
);

756 
	`addS”v”
(
£rv”1
, 
sc1
);

758 
S”v”CÚ‹xt
 
sc2
 = 
	`cÚfigu»CÚ‹xt
(
£rv”2
);

760 
	`addS”v”
(
£rv”2
, 
sc2
);

762 
S”v”CÚ‹xt
 
sc3
 = 
	`cÚfigu»CÚ‹xt
(
£rv”3
);

764 
	`addS”v”
(
£rv”3
, 
sc3
);

766 
fš®
 
wr™‹nAdd»s£sB©ch1
 = 100;

768 
Layout
 
Ïyout
 = 
Ãw
 
	`Te¡LayoutBud”
()

769 .
	`£tEpoch
(1L)

770 .
	`addLayoutS”v”
(
£rv”1
)

771 .
	`addLayoutS”v”
(
£rv”2
)

772 .
	`addLayoutS”v”
(
£rv”3
)

773 .
	`addSequ’ûr
(
£rv”1
)

774 .
	`addSequ’ûr
(
£rv”2
)

775 .
	`addSequ’ûr
(
£rv”3
)

776 .
	`budSegm’t
()

777 .
	`£tS¹
(0L)

778 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

779 .
	`budSŒe
()

780 .
	`addLogUn™
(
£rv”1
)

781 .
	`addToSegm’t
()

782 .
	`addToLayout
()

783 .
	`budSegm’t
()

784 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

785 .
	`£tEnd
(-1)

786 .
	`budSŒe
()

787 .
	`addLogUn™
(
£rv”1
)

788 .
	`addLogUn™
(
£rv”2
)

789 .
	`addLogUn™
(
£rv”3
)

790 .
	`addToSegm’t
()

791 .
	`addToLayout
()

792 .
	`bud
();

794 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

797 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

799 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
¹
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

801 
i
 = 0; i < (
wr™‹nAdd»s£sB©ch1
); i++) {

802 
‹¡SŒ—m
.
	`­³nd
("‹¡Paylßd".
	`g‘By‹s
());

805 
fš®
 
Re¡ÜeRedundªcyM”geSegm’ts
 
aùiÚ1
 = 
	`g‘Re¡ÜeAùiÚ
(
SERVERS
.
ENDPOINT_1
);

806 
fš®
 
Re¡ÜeRedundªcyM”geSegm’ts
 
aùiÚ2
 = 
	`g‘Re¡ÜeAùiÚ
(
SERVERS
.
ENDPOINT_2
);

809 
Li¡
<
Com¶‘abËFutu»
<
Void
>> 
futu»s
 = 
Ãw
 
	`A¼ayLi¡
();

811 
CÜfuRuÁime
 
¹1
 = 
	`g‘Te¡RuÁime
(
£rv”2
, 
sc1
.
	`g‘NodeId
());

812 
CÜfuRuÁime
 
¹2
 = 
	`g‘Te¡RuÁime
(
£rv”3
, 
sc2
.
	`g‘NodeId
());

814 
futu»s
.
	`add
(
	`runRe¡Üe
(
aùiÚ1
, 
¹1
));

815 
futu»s
.
	`add
(
	`runRe¡Üe
(
aùiÚ2
, 
¹2
));

817 
	`wa™FÜLayoutChªge
(
l
 ->†.
	`g‘Segm’ts
().
	`size
(è=ğ1, 
¹
);

819 
CFUts
.
	`£qu’û
(
futu»s
);

821 
¹
.
	`šv®id©eLayout
();

822 
	`as£¹Th©
(
¹
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Segm’ts
().
	`size
())

823 .
	`isEqu®To
(1);

824 
	}
}

838 @
Te¡


839 
public
 
	$‹¡S‹T¿nsãrW™hNÚeDeçuÉCodec
() {

841 
fš®
 
by‹
[] 
DEFAULT_PAYLOAD
 = "‹¡Paylßd".
	`g‘By‹s
();

843 
	`addS”v”
(
SERVERS
.
PORT_0
);

844 
	`addS”v”
(
SERVERS
.
PORT_1
);

846 
fš®
 
wr™‹nAdd»s£sB©ch1
 = 3L;

847 
fš®
 
wr™‹nAdd»s£sB©ch2
 = 6L;

850 
Layout
 
l1
 = 
Ãw
 
	`Te¡LayoutBud”
()

851 .
	`£tEpoch
(1L)

852 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

853 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

854 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

855 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

856 .
	`budSegm’t
()

857 .
	`£tS¹
(0L)

858 .
	`£tEnd
(
wr™‹nAdd»s£sB©ch1
)

859 .
	`budSŒe
()

860 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

861 .
	`addToSegm’t
()

862 .
	`addToLayout
()

863 .
	`budSegm’t
()

864 .
	`£tS¹
(
wr™‹nAdd»s£sB©ch1
)

865 .
	`£tEnd
(-1L)

866 .
	`budSŒe
()

867 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

868 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

869 .
	`addToSegm’t
()

870 .
	`addToLayout
()

871 .
	`bud
();

872 
	`boÙ¡¿pAÎS”v”s
(
l1
);

876 
cÜfuRuÁime
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

877 
cÜfuRuÁime
.
	`g‘P¬am‘”s
().
	`£tCodecTy³
(
Codec
.
Ty³
.
LZ4
.
	`toSŒšg
());

879 
CÜfuRuÁime
 
¹NoCodec
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

880 
¹NoCodec
.
	`g‘P¬am‘”s
().
	`£tCodecTy³
(
Codec
.
Ty³
.
NONE
.
	`toSŒšg
());

883 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘P¬am‘”s
().
	`g‘CodecTy³
())

884 .
	`isNÙEqu®To
(
¹NoCodec
.
	`g‘P¬am‘”s
().
	`g‘CodecTy³
())

885 .
	`isNÙEqu®To
(
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
.
	`bud”
().
	`bud
().
	`g‘CodecTy³
());

888 
ISŒ—mV›w
 
‹¡SŒ—m
 = 
cÜfuRuÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

889 
ISŒ—mV›w
 
‹¡SŒ—mNoCodec
 = 
¹NoCodec
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("test"));

892 
i
 = 0; i < 
wr™‹nAdd»s£sB©ch1
; i++) {

893 
‹¡SŒ—m
.
	`­³nd
(
DEFAULT_PAYLOAD
);

897 
i
 = (è
wr™‹nAdd»s£sB©ch1
; i < 
wr™‹nAdd»s£sB©ch2
; i++) {

898 
‹¡SŒ—mNoCodec
.
	`­³nd
(
DEFAULT_PAYLOAD
);

902 
	`addS”v”
(
SERVERS
.
PORT_2
);

903 
fš®
 
addNodeR‘r›s
 = 3;

904 
cÜfuRuÁime
.
	`g‘Mªagem’tV›w
()

905 .
	`addNode
(
SERVERS
.
ENDPOINT_2
, 
addNodeR‘r›s
, 
Du¿tiÚ
.
	`ofMšu‹s
(1L), Du¿tiÚ.
	`ofSecÚds
(1));

906 
cÜfuRuÁime
.
	`šv®id©eLayout
();

907 
fš®
 
•ochAá”Add
 = 4L;

908 
Layout
 
ex³ùedLayout
 = 
Ãw
 
	`Te¡LayoutBud”
()

909 .
	`£tEpoch
(
•ochAá”Add
)

910 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

911 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

912 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

913 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

914 .
	`addSequ’ûr
(
SERVERS
.
PORT_1
)

915 .
	`addSequ’ûr
(
SERVERS
.
PORT_2
)

916 .
	`budSegm’t
()

917 .
	`£tS¹
(0L)

918 .
	`£tEnd
(-1L)

919 .
	`budSŒe
()

920 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

921 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

922 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

923 .
	`addToSegm’t
()

924 .
	`addToLayout
()

925 .
	`bud
();

928 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

929 ià(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(è>ğ
•ochAá”Add
) {

932 
cÜfuRuÁime
.
	`šv®id©eLayout
();

933 
SË•
.
	`¦“pUnš‹¼u±ibly
(
PARAMETERS
.
TIMEOUT_SHORT
);

936 
	`as£¹Th©
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
()).
	`isEqu®To
(
ex³ùedLayout
);

939 
CÜfuRuÁime
 
¹
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

942 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

943 
¹
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

946 
i
 = 0; i < 
wr™‹nAdd»s£sB©ch2
; i++) {

947 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
i
)

948 .
	`g‘Paylßd
(
¹
)).
	`isEqu®To
(
DEFAULT_PAYLOAD
);

951 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/StreamViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gSŒ—mšgM­
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gCÜfuCompeProxy
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gV”siÚLockedObjeù
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

16 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

20 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

21 
impÜt
 
	gjava
.
	gut
.
	gM­
;

22 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

23 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gIÁSŒ—m
;

25 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

26 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

31 
public
 cÏs 
	cSŒ—mV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

33 
public
 
CÜfuRuÁime
 
	mr
;

35 @
BefÜe


36 
public
 
	$£tRuÁime
(è
throws
 
Exû±iÚ
 {

37 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

40 @
Te¡


41 
public
 
	$nÚCach—bËSŒ—m
() {

45 
UUID
 
id1
 = UUID.
	`¿ndomUUID
();

46 
UUID
 
id2
 = UUID.
	`¿ndomUUID
();

48 
CÜfuRuÁime
 
´oduûr
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
())

49 .
	`cÚÃù
();

51 
ISŒ—mV›w
 
sv1
 = 
´oduûr
.
	`g‘SŒ—msV›w
().
	`g‘
(
id1
);

52 
ISŒ—mV›w
 
sv2
 = 
´oduûr
.
	`g‘SŒ—msV›w
().
	`g‘
(
id2
);

54 
fš®
 
numWr™es
 = 300;

55 
fš®
 
·ylßdSize
 = 100;

56 
fš®
 
by‹
[] 
·ylßd
 = 
Ãw
 by‹[
·ylßdSize
];

58 
x
 = 0; x < 
numWr™es
; x++) {

59 
sv1
.
	`­³nd
(
·ylßd
);

60 
sv2
.
	`­³nd
(
·ylßd
);

63 
CÜfuRuÁime
 
cÚsum”
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
())

64 .
	`cÚÃù
();

66 
SŒ—mO±iÚs
 
ÿcheSŒ—mO±iÚ
 = SŒ—mO±iÚs.
	`bud”
()

67 .
	`ÿcheEÁr›s
(
Œue
)

68 .
	`bud
();

70 
SŒ—mO±iÚs
 
noCacheSŒ—mO±iÚ
 = SŒ—mO±iÚs.
	`bud”
()

71 .
	`ÿcheEÁr›s
(
çl£
)

72 .
	`bud
();

74 
ISŒ—mV›w
 
ÿchedSŒ—m
 = 
cÚsum”
.
	`g‘SŒ—msV›w
().
	`g‘
(
id1
, 
ÿcheSŒ—mO±iÚ
);

75 
ISŒ—mV›w
 
nÚCach—bËSŒ—m
 = 
cÚsum”
.
	`g‘SŒ—msV›w
().
	`g‘
(
id2
, 
noCacheSŒ—mO±iÚ
);

77 
ÿchedSŒ—m
.
	`Ãxt
();

78 
nÚCach—bËSŒ—m
.
	`Ãxt
();

80 
fš®
 
syncAdd»ss1
 = 5;

81 
fš®
 
syncAdd»ss2
 = 100;

82 
fš®
 
syncAdd»ss3
 = 200;

85 
ÿchedSŒ—m
.
	`ÃxtUpTo
(
syncAdd»ss1
);

86 
nÚCach—bËSŒ—m
.
	`ÃxtUpTo
(
syncAdd»ss1
);

88 
ÿchedSŒ—m
.
	`»maššgUpTo
(
syncAdd»ss2
);

89 
nÚCach—bËSŒ—m
.
	`»maššgUpTo
(
syncAdd»ss2
);

91 
ÿchedSŒ—m
.
	`¡»amUpTo
(
syncAdd»ss3
);

92 
nÚCach—bËSŒ—m
.
	`¡»amUpTo
(
syncAdd»ss3
);

94 
ÿchedSŒ—m
.
	`»maššg
();

95 
nÚCach—bËSŒ—m
.
	`»maššg
();

98 
	`as£¹Th©
(
cÚsum”
.
	`g‘Add»ssS·ûV›w
().
	`g‘R—dCache
().
	`size
()).
	`isEqu®To
(
numWr™es
);

100 
ILogD©a
 
ld
 : 
cÚsum”
.
	`g‘Add»ssS·ûV›w
().
	`g‘R—dCache
().
	`asM­
().
	`v®ues
()) {

101 
	`as£¹Th©
(
ld
.
	`hasBackpoš‹r
(
id1
)).
	`isTrue
();

102 
	`as£¹Th©
(
ld
.
	`g‘Backpoš‹rM­
()).
	`hasSize
(1);

104 
	}
}

106 @
	gTe¡


107 @
Suµ»ssW¬nšgs
("unchecked")

108 
public
 
	$ÿnR—dWr™eFromSŒ—m
()

109 
throws
 
Exû±iÚ
 {

110 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

111 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

113 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

114 
sv
.
	`­³nd
(
‹¡Paylßd
);

116 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

117 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

119 
	`as£¹Th©
(
sv
.
	`Ãxt
())

120 .
	`isEqu®To
(
nuÎ
);

121 
	}
}

127 @
Te¡


128 
public
 
	$‹¡RemaššgUpToW™hTrim
() {

129 
SŒ—mO±iÚs
 
İtiÚs
 = SŒ—mO±iÚs.
	`bud”
()

130 .
	`ignÜeTrimmed
(
Œue
)

131 .
	`bud
();

133 
ISŒ—mV›w
 
txSŒ—m
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
, 
İtiÚs
);

134 
fš®
 
fœ¡I‹r
 = 50;

135 
x
 = 0; x < 
fœ¡I‹r
; x++) {

136 
by‹
[] 
d©a
 = "H–lØWÜld!".
	`g‘By‹s
();

137 
txSŒ—m
.
	`­³nd
(
d©a
);

140 
Li¡
<
ILogD©a
> 
’Œ›s
 = 
txSŒ—m
.
	`»maššgUpTo
((
fœ¡I‹r
 - 1) / 2);

141 
	`as£¹Th©
(
’Œ›s
.
	`size
()).
	`isEqu®To
(
fœ¡I‹r
 / 2);

143 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), (
fœ¡I‹r
 - 1) / 2);

144 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

145 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

146 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

148 
’Œ›s
 = 
txSŒ—m
.
	`»maššgUpTo
((
fœ¡I‹r
 - 1) / 2);

149 
	`as£¹Th©
(
’Œ›s
.
	`size
()).
	`isEqu®To
(0);

151 
’Œ›s
 = 
txSŒ—m
.
	`»maššgUpTo
(
fœ¡I‹r
);

152 
	`as£¹Th©
(
’Œ›s
.
	`size
()).
	`isEqu®To
((
fœ¡I‹r
 / 2));

155 
CÜfuRuÁime
 
¹2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
())

156 .
	`cÚÃù
();

157 
ISŒ—mV›w
 
txSŒ—m2
 = 
¹2
.
	`g‘SŒ—msV›w
()

158 .
	`g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
, 
İtiÚs
);

159 
	`as£¹Th©ThrownBy
((è-> 
txSŒ—m2
.
	`»maššg
())

160 .
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

162 
txSŒ—m2
.
	`£ek
(
fœ¡I‹r
 / 2);

163 
’Œ›s
 = 
txSŒ—m2
.
	`»maššgUpTo
(
LÚg
.
MAX_VALUE
);

164 
	`as£¹Th©
(
’Œ›s
.
	`size
()).
	`isEqu®To
((
fœ¡I‹r
 / 2));

165 
	}
}

167 @
	gTe¡


168 @
Suµ»ssW¬nšgs
("unchecked")

169 
public
 
	$ÿnR—dWr™eFromSŒ—mCÚcu¼’t
()

170 
throws
 
Exû±iÚ
 {

171 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

172 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

174 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

175 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
,

176 
i
 -> 
sv
.
	`­³nd
(
‹¡Paylßd
));

177 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
,

178 
PARAMETERS
.
TIMEOUT_NORMAL
);

180 
	`scheduËCÚcu¼’y
(
PARAMETERS
.
NUM_ITERATIONS_LOW
,

181 
i
 -> 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

182 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
()));

183 
	`execu‹ScheduËd
(
PARAMETERS
.
CONCURRENCY_SOME
,

184 
PARAMETERS
.
TIMEOUT_NORMAL
);

185 
	`as£¹Th©
(
sv
.
	`Ãxt
())

186 .
	`isEqu®To
(
nuÎ
);

187 
	}
}

189 @
	gTe¡


190 @
Suµ»ssW¬nšgs
("unchecked")

191 
public
 
	$ÿnR—dWr™eFromCachedSŒ—m
()

192 
throws
 
Exû±iÚ
 {

193 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
()

194 .
	`£tCacheDi§bËd
(
çl£
);

195 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

196 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

198 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

199 
sv
.
	`­³nd
(
‹¡Paylßd
);

201 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

202 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

204 
	`as£¹Th©
(
sv
.
	`Ãxt
())

205 .
	`isEqu®To
(
nuÎ
);

206 
	}
}

208 @
Te¡


209 
public
 
	$ÿnS“kOnSŒ—m
()

210 
throws
 
Exû±iÚ


212 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

213 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(

214 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A"));

217 
sv
.
	`­³nd
("a".
	`g‘By‹s
());

218 
sv
.
	`­³nd
("b".
	`g‘By‹s
());

219 
sv
.
	`­³nd
("c".
	`g‘By‹s
());

222 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
))

223 .
	`isEqu®To
("a".
	`g‘By‹s
());

224 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
))

225 .
	`isEqu®To
("b".
	`g‘By‹s
());

228 
sv
.
	`£ek
(0);

229 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
))

230 .
	`isEqu®To
("a".
	`g‘By‹s
());

233 
sv
.
	`£ek
(2);

234 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
))

235 .
	`isEqu®To
("c".
	`g‘By‹s
());

238 
sv
.
	`£ek
(1);

239 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
))

240 .
	`isEqu®To
("b".
	`g‘By‹s
());

241 
	}
}

243 @
Te¡


244 
public
 
	$ÿnDoP»viousOnSŒ—m
()

245 
throws
 
Exû±iÚ


247 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

248 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(

249 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A"));

252 
sv
.
	`­³nd
("a".
	`g‘By‹s
());

253 
sv
.
	`­³nd
("b".
	`g‘By‹s
());

254 
sv
.
	`­³nd
("c".
	`g‘By‹s
());

257 
	`as£¹Th©
(
sv
.
	`´evious
())

258 .
	`isNuÎ
();

261 
sv
.
	`Ãxt
();

262 
sv
.
	`Ãxt
();

265 
	`as£¹Th©
(
sv
.
	`´evious
().
	`g‘Paylßd
(
r
))

266 .
	`isEqu®To
("a".
	`g‘By‹s
());

269 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
))

270 .
	`isEqu®To
("b".
	`g‘By‹s
());

272 
sv
.
	`Ãxt
();

273 
sv
.
	`Ãxt
();

276 
	`as£¹Th©
(
sv
.
	`´evious
().
	`g‘Paylßd
(
r
))

277 .
	`isEqu®To
("b".
	`g‘By‹s
());

278 
	}
}

280 @
	gTe¡


281 @
Suµ»ssW¬nšgs
("unchecked")

282 
public
 
	$¡»amCªSurviveOv”wr™eExû±iÚ
()

283 
throws
 
Exû±iÚ
 {

284 
UUID
 
¡»amA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A");

285 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

289 
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L);

292 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

293 
sv
.
	`­³nd
(
‹¡Paylßd
);

295 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

296 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

298 
	`as£¹Th©
(
sv
.
	`Ãxt
())

299 .
	`isEqu®To
(
nuÎ
);

300 
	}
}

302 @
	gTe¡


303 @
Suµ»ssW¬nšgs
("unchecked")

304 
public
 
	$¡»amWlHŞeFl
()

305 
throws
 
Exû±iÚ
 {

307 
UUID
 
¡»amA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A");

308 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

311 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

314 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

315 
sv
.
	`­³nd
(
‹¡Paylßd
);

317 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

318 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

320 
	`as£¹Th©
(
sv
.
	`Ãxt
())

321 .
	`isEqu®To
(
nuÎ
);

322 
	}
}

325 @
	gTe¡


326 @
Suµ»ssW¬nšgs
("unchecked")

327 
public
 
	$¡»amW™hHŞeFl
()

328 
throws
 
Exû±iÚ
 {

329 
UUID
 
¡»amA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A");

331 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

332 
by‹
[] 
‹¡Paylßd2
 = "h–lØwÜld2".
	`g‘By‹s
();

334 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

335 
sv
.
	`­³nd
(
‹¡Paylßd
);

338 
Tok’Re¥Ú£
 
Œ
 =

339 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

343 
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
Œ
.
	`g‘Tok’
().
	`g‘Sequ’û
());

346 
Œ
 = 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

350 
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
Œ
.
	`g‘Tok’
().
	`g‘Sequ’û
());

353 
sv
.
	`­³nd
(
‹¡Paylßd2
);

356 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

357 .
	`isEqu®To
(
‹¡Paylßd
);

359 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

360 .
	`isEqu®To
(
‹¡Paylßd2
);

361 
	}
}

363 @
	gTe¡


364 @
Suµ»ssW¬nšgs
("unchecked")

365 
public
 
	$´efixTrimThrowsExû±iÚ
()

366 
throws
 
Exû±iÚ
 {

368 
UUID
 
¡»amA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A");

369 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

372 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

373 
sv
.
	`­³nd
(
‹¡Paylßd
);

376 
Tok’
 
tok’
 = 
Ãw
 
	`Tok’
(
ruÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 0);

377 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

378 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`gc
();

379 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

380 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

383 
	`as£¹Th©ThrownBy
((è-> 
sv
.
	`Ãxt
())

384 .
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

385 
	}
}

387 @
Te¡


388 
public
 
	$‹¡P»viousW™hNoCheckpošts
() {

389 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

390 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
Add»ss
.
NON_ADDRESS
);

391 
	`as£¹Th©
(
sv
.
	`cu¼’t
()).
	`isNuÎ
();

392 
fš®
 
pos0
 = 0l;

393 
by‹
[] 
·ylßd
 = "’Œy1".
	`g‘By‹s
();

394 
	`as£¹Th©
(
sv
.
	`­³nd
(
·ylßd
)).
	`isEqu®To
(
pos0
);

395 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
Add»ss
.
NON_ADDRESS
);

396 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
r
)).
	`isEqu®To
(
·ylßd
);

397 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
pos0
);

398 
	`as£¹Th©
(
sv
.
	`´evious
()).
	`isNuÎ
();

399 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
Add»ss
.
NON_ADDRESS
);

402 
	`as£¹Th©
(
sv
.
	`´evious
()).
	`isNuÎ
();

403 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
Add»ss
.
NON_ADDRESS
);

404 
	}
}

406 @
Te¡


407 
public
 
	$‹¡P»viousW™hSŒ—mCheckpošt
(è
throws
 
Exû±iÚ
 {

408 
SŒšg
 
¡»am
 = "stream1";

409 
SŒ—mšgM­
<
SŒšg
, SŒšg> 
m­
 = 
r
.
	`g‘ObjeùsV›w
()

410 .
	`bud
()

411 .
	`£tSŒ—mName
(
¡»am
)

412 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

413 .
	`İ’
();

415 
m­
.
	`put
("k1", "k1");

417 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am
);

418 
ba£V”siÚ
 = 
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
(
¡»amId
);

420 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

421 
mcw
.
	`addM­
(
m­
);

422 
Tok’
 
tok’
 = 
mcw
.
	`­³ndCheckpošts
(
r
, "cp");

425 
m­
.
	`put
("k2", "k2");

426 
m­
.
	`put
("k3", "k3");

428 
M­
<
SŒšg
, SŒšg> 
m­Cİy
 = 
r
.
	`g‘ObjeùsV›w
()

429 .
	`bud
()

430 .
	`£tSŒ—mName
(
¡»am
)

431 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

432 .
	`İtiÚ
(
ObjeùO³nO±iÚ
.
NO_CACHE
)

433 .
	`İ’
();

435 
m­Cİy
.
	`size
();

436 
V”siÚLockedObjeù
 
vlo
 = ((
CÜfuCompeProxy
è((
ICÜfuSMR
è
m­Cİy
).

437 
	`g‘CÜfuSMRProxy
()).
	`g‘Und”lyšgObjeù
();

439 
Tok’
 
fš®V”siÚ
 = 
r
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Tok’
();

441 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
(
¡»am
));

446 
sv
.
	`ÃxtUpTo
(
LÚg
.
MAX_VALUE
è!ğ
nuÎ
);

448 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
fš®V”siÚ
.
	`g‘Sequ’û
());

449 
	`as£¹Th©
(
sv
.
	`´evious
()).
	`isNÙNuÎ
();

450 
	`as£¹Th©
(
sv
.
	`´evious
()).
	`isNuÎ
();

452 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
ba£V”siÚ
 + 1);

455 
	`as£¹Th©ThrownBy
((è-> 
sv
.
	`´evious
()).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

456 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
ba£V”siÚ
 + 1);

457 
	}
}

467 
´iv©e
 
	$synchrÚousP»fixTrim
(
CÜfuRuÁime
 
ruÁime
, 
•och
, 
add»ss
) {

468 
fš®
 
Tok’
 
´evTrimM¬k
 = 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
();

469 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
Ãw
 
	`Tok’
(
•och
, 
add»ss
));

470 
´evTrimM¬k
.
	`equ®s
(
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`g‘TrimM¬k
())) { }

471 
	}
}

479 @
Te¡


480 
public
 
	$txLogTrim
() {

481 
fš®
 
CÜfuRuÁime
.
CÜfuRuÁimeP¬am‘”s
 
·¿ms
 = CorfuRuntime.CorfuRuntimeParameters

482 .
	`bud”
()

483 .
	`bud
();

484 
fš®
 
CÜfuRuÁime
 
loÿlRuÁime
 = CÜfuRuÁime.
	`äomP¬am‘”s
(
·¿ms
)

485 .
	`£tT¿n§ùiÚLoggšg
(
Œue
)

486 .
	`·r£CÚfigu¿tiÚSŒšg
(
	`g‘DeçuÉCÚfigu¿tiÚSŒšg
())

487 .
	`cÚÃù
();

488 
fš®
 
CÜfuTabË
<
SŒšg
, String>

489 
š¡ªû1
 = 
loÿlRuÁime
.
	`g‘ObjeùsV›w
().
	`bud
()

490 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

491 .
	`£tSŒ—mName
("txTestMap")

492 .
	`İ’
();

495 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`fÜEach
(
idx
 -> {

496 
loÿlRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

497 
š¡ªû1
.
	`put
(
SŒšg
.
	`v®ueOf
(
idx
), String.valueOf(idx));

498 
loÿlRuÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

502 
fš®
 
•och
 = 0L;

503 
	`synchrÚousP»fixTrim
(
loÿlRuÁime
, 
•och
, 
PARAMETERS
.
NUM_ITERATIONS_LOW
/2/2);

506 
loÿlRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

507 
loÿlRuÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

509 
ISŒ—mV›w
 
txSŒ—m
 = 
loÿlRuÁime
.
	`g‘SŒ—msV›w
()

510 .
	`g‘
(
ObjeùsV›w
.
TRANSACTION_STREAM_ID
);

513 
	`as£¹Th©ThrownBy
((è-> 
txSŒ—m
.
	`»maššg
()).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

516 
txSŒ—m
.
	`£ek
(
PARAMETERS
.
NUM_ITERATIONS_LOW
/2);

517 
txSŒ—m
.
	`»maššg
();

520 
IÁSŒ—m
.
	`¿nge
(0, 
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`fÜEach
(
idx
 -> {

521 
loÿlRuÁime
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

522 
š¡ªû1
.
	`put
(
SŒšg
.
	`v®ueOf
(
idx
), String.valueOf(idx));

523 
loÿlRuÁime
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

527 
	`synchrÚousP»fixTrim
(
loÿlRuÁime
, 
•och
,

528 
PARAMETERS
.
NUM_ITERATIONS_LOW
 + PARAMETERS.NUM_ITERATIONS_LOW/2);

531 
	`as£¹Th©ThrownBy
((è-> 
txSŒ—m
.
	`»maššg
()).
	`isIn¡ªûOf
(
TrimmedExû±iÚ
.
şass
);

534 
txSŒ—m
.
	`£ek
(
loÿlRuÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
().
	`g‘Sequ’û
());

535 
txSŒ—m
.
	`»maššg
();

536 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/StreamsViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

7 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

9 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
public
 cÏs 
	cSŒ—msV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

16 @
BefÜe


17 
public
 
	$£tRuÁime
() {

18 
	`g‘DeçuÉRuÁime
().
	`cÚÃù
();

21 @
Te¡


22 
public
 
	$‹¡SŒ—msV›wCË¬
() {

23 
UUID
 
id1
 = UUID.
	`¿ndomUUID
();

24 
UUID
 
id2
 = UUID.
	`¿ndomUUID
();

25 
ISŒ—mV›w
 
sv1
 = 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘
(
id1
);

26 
ISŒ—mV›w
 
sv2
 = 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘
(
id1
);

27 
ISŒ—mV›w
 
sv3
 = 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘
(
id2
);

28 
ISŒ—mV›w
 
sv4
 = 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘Un§ã
(
id2
);

29 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘O³ÃdSŒ—ms
()).
	`cÚšsExaùly
(
sv1
, 
sv2
, 
sv3
);

30 
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`ş—r
();

31 
	`as£¹Th©
(
	`g‘RuÁime
().
	`g‘SŒ—msV›w
().
	`g‘O³ÃdSŒ—ms
()).
	`isEm±y
();

32 
	}
}

34 @
Te¡


35 
public
 
	$‹¡CÚcu¼’tO³nGC
(è
throws
 
Exû±iÚ
 {

36 
SŒ—msV›w
 
¡»amsV›w
 = 
	`g‘DeçuÉRuÁime
().
	`g‘SŒ—msV›w
();

37 
fš®
 
ŒimM¬k
 = 1;

38 
fš®
 
numI‹r
 = 100;

39 
fš®
 
·¿Î–Num
 = 3;

41 
	`scheduËCÚcu¼’y
(
numI‹r
, 
t
 -> 
¡»amsV›w
.
	`g‘
(
UUID
.
	`¿ndomUUID
()));

42 
	`scheduËCÚcu¼’y
(
numI‹r
, 
t
 -> 
¡»amsV›w
.
	`gc
(
ŒimM¬k
));

43 
	`execu‹ScheduËd
(
·¿Î–Num
, 
PARAMETERS
.
TIMEOUT_NORMAL
);

44 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/ViewsGarbageCollectorTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

9 
impÜt
 
	gÜg
.
	gehÿche
..
	gSizeOf
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

21 
public
 cÏs 
	cV›wsG¬bageCŞËùÜTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

23 @
	mTe¡


24 @
IgnÜe


25 
public
 
	$‹¡RuÁimeGC
(è
throws
 
Exû±iÚ
 {

27 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
();

29 
CÜfuTabË
<
SŒšg
, SŒšg> 
bË
 = 
¹
.
	`g‘ObjeùsV›w
()

30 .
	`bud
()

31 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
SŒšg
, String>>() {})

32 .
	`£tSŒ—mName
("table1")

33 .
	`İ’
();

35 
	`as£¹Th©
(
¹
.
	`g‘G¬bageCŞËùÜ
().
	`isS¹ed
()).
	`isTrue
();

37 
SizeOf
 
sizeOf
 = SizeOf.
	`ÃwIn¡ªû
();

38 
sizeAá”C»©iÚ
 = 
sizeOf
.
	`d“pSizeOf
(
bË
);

39 
¹
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

40 
	`as£¹Th©
(
sizeAá”C»©iÚ
).
	`isLessThªOrEqu®To
(
sizeOf
.
	`d“pSizeOf
(
bË
));

42 
fš®
 
numWr™es
 = 100;

45 
x
 = 0; x < 
numWr™es
; x++) {

46 
bË
.
	`put
(
SŒšg
.
	`v®ueOf
(
x
), String.valueOf(x));

49 
sizeOfTabËAá”Wr™e
 = 
sizeOf
.
	`d“pSizeOf
(
bË
);

51 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

52 
mcw
.
	`addM­
(
bË
);

53 
Tok’
 
ŒimM¬k
 = 
mcw
.
	`­³ndCheckpošts
(
¹
, "cp1");

54 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
ŒimM¬k
);

55 
¹
.
	`g‘P¬am‘”s
().
	`£tRuÁimeGCP”iod
(
Du¿tiÚ
.
	`ofMšu‹s
(0));

56 
¹
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

57 
sizeOfTabËAá”Gc
 = 
sizeOf
.
	`d“pSizeOf
(
bË
);

58 
fš®
 
numOfS‘sSŒ—mS‘s
 = 3;

59 
	`as£¹Th©
(
sizeOfTabËAá”Gc
)

60 .
	`isLessThª
(
sizeOfTabËAá”Wr™e
 - (
numWr™es
 * 
LÚg
.
BYTES
 * 
numOfS‘sSŒ—mS‘s
));

61 
	`as£¹Th©
(
¹
.
	`g‘Add»ssS·ûV›w
().
	`g‘R—dCache
().
	`asM­
()).
	`isEm±y
();

62 
¹
.
	`shutdown
();

63 
	`as£¹Th©
(
¹
.
	`g‘G¬bageCŞËùÜ
().
	`isS¹ed
()).
	`isF®£
();

65 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/replication/AbstractReplicationProtocolTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

23 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùR•liÿtiÚPrÙocŞTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

26 
ab¡¿ù
 
IR•liÿtiÚPrÙocŞ
 
g‘PrÙocŞ
();

29 
ab¡¿ù
 
£tupNodes
();

31 
LogD©a
 
	$g‘LogD©a
(
glob®Add»ss
, 
by‹
[] 
·ylßd
)

33 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

34 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
(
·ylßd
, 
b
);

35 
LogD©a
 
d
 = 
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
);

36 
d
.
	`£tGlob®Add»ss
(
glob®Add»ss
);

37  
d
;

43 @
Te¡


44 @
	`Suµ»ssW¬nšgs
("unchecked")

45 
public
 
	$ÿnWr™eR—d
()

46 
throws
 
Exû±iÚ
 {

47 
	`£tupNodes
();

50 
fš®
 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

51 
fš®
 
IR•liÿtiÚPrÙocŞ
 
½
 = 
	`g‘PrÙocŞ
();

52 
fš®
 
RuÁimeLayout
 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

54 
LogD©a
 
d©a
 = 
	`g‘LogD©a
(0, "h–lØwÜld".
	`g‘By‹s
());

55 
½
.
	`wr™e
(
ruÁimeLayout
, 
d©a
);

56 
ILogD©a
 
»ad
 = 
½
.
	`»ad
(
ruÁimeLayout
, 0);

58 
	`as£¹Th©
(
»ad
.
	`g‘Ty³
())

59 .
	`isEqu®To
(
D©aTy³
.
DATA
);

60 
	`as£¹Th©
(
»ad
.
	`g‘Glob®Add»ss
())

61 .
	`isEqu®To
(0);

62 
	`as£¹Th©
(
»ad
.
	`g‘Paylßd
(
r
))

63 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

64 
	}
}

69 @
	gTe¡


70 @
Suµ»ssW¬nšgs
("unchecked")

71 
public
 
	$»adOÆyComm™‹d
()

72 
throws
 
Exû±iÚ
 {

73 
	`£tupNodes
();

76 
fš®
 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

77 
fš®
 
IR•liÿtiÚPrÙocŞ
 
½
 = 
	`g‘PrÙocŞ
();

78 
fš®
 
RuÁimeLayout
 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

80 
ILogD©a
 
»ad
 = 
½
.
	`»ad
(
ruÁimeLayout
, 0);

82 
	`as£¹Th©
(
»ad
.
	`g‘Ty³
())

83 .
	`isNÙEqu®To
(
D©aTy³
.
EMPTY
);

85 
»ad
 = 
½
.
	`»ad
(
ruÁimeLayout
, 1);

87 
	`as£¹Th©
(
»ad
.
	`g‘Ty³
())

88 .
	`isNÙEqu®To
(
D©aTy³
.
EMPTY
);

89 
	}
}

95 @
	gTe¡


96 @
Suµ»ssW¬nšgs
("unchecked")

97 
public
 
	$ov”wr™eThrowsExû±iÚ
()

98 
throws
 
Exû±iÚ
 {

99 
	`£tupNodes
();

102 
fš®
 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

103 
fš®
 
IR•liÿtiÚPrÙocŞ
 
½
 = 
	`g‘PrÙocŞ
();

104 
fš®
 
RuÁimeLayout
 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

106 
LogD©a
 
d1
 = 
	`g‘LogD©a
(0, "1".
	`g‘By‹s
());

107 
LogD©a
 
d2
 = 
	`g‘LogD©a
(0, "2".
	`g‘By‹s
());

108 
½
.
	`wr™e
(
ruÁimeLayout
, 
d1
);

109 
	`as£¹Th©ThrownBy
((è-> 
½
.
	`wr™e
(
ruÁimeLayout
, 
d2
))

110 .
	`isIn¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

111 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/replication/ChainReplicationProtocolTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gOv”wr™eExû±iÚ
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gWrÚgEpochExû±iÚ
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gRuÁimeLayout
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

13 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

14 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

15 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gç
;

21 
public
 cÏs 
	cChašR•liÿtiÚPrÙocŞTe¡
 
ex‹nds
 
	mAb¡¿ùR•liÿtiÚPrÙocŞTe¡
 {

24 @
Ov”ride


25 
IR•liÿtiÚPrÙocŞ
 
	$g‘PrÙocŞ
() {

26  
Ãw


27 
	`ChašR•liÿtiÚPrÙocŞ
(
Ãw


28 
	`AlwaysHŞeFlPŞicy
());

32 @
Ov”ride


33 
	$£tupNodes
() {

34 
	`addS”v”
(
SERVERS
.
PORT_0
);

35 
	`addS”v”
(
SERVERS
.
PORT_1
);

36 
	`addS”v”
(
SERVERS
.
PORT_2
);

38 
	`boÙ¡¿pAÎS”v”s
(
Ãw
 
	`Te¡LayoutBud”
()

39 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

40 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

41 .
	`budSegm’t
()

42 .
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
CHAIN_REPLICATION
)

43 .
	`budSŒe
()

44 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

45 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

46 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

47 .
	`addToSegm’t
()

48 .
	`addToLayout
()

49 .
	`bud
());

50 
	}
}

55 @
Te¡


56 
public
 
	$çedWr™eIsPrİag©ed
()

57 
throws
 
Exû±iÚ
 {

58 
	`£tupNodes
();

60 
fš®
 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

61 
fš®
 
IR•liÿtiÚPrÙocŞ
 
½
 = 
	`g‘PrÙocŞ
();

62 
fš®
 
RuÁimeLayout
 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

64 
LogD©a
 
çedWr™e
 = 
	`g‘LogD©a
(0, "çed".
	`g‘By‹s
());

65 
LogD©a
 
šcom¶‘eWr™e
 = 
	`g‘LogD©a
(0, "šcom¶‘e".
	`g‘By‹s
());

68 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
).
	`wr™e
(
šcom¶‘eWr™e
);

72 
	`as£¹Th©ThrownBy
((è-> 
½
.
	`wr™e
(
ruÁimeLayout
, 
çedWr™e
))

73 .
	`isIn¡ªûOf
(
Ov”wr™eExû±iÚ
.
şass
);

77 
ILogD©a
 
»adResuÉ
 = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
)

78 .
	`»ad
(0).
	`g‘
().
	`g‘Add»s£s
().get(0L);

80 
	`as£¹Th©
(
»adResuÉ
.
	`g‘Paylßd
(
r
))

81 .
	`isEqu®To
("šcom¶‘e".
	`g‘By‹s
());

82 
	}
}

88 @
Te¡


89 
public
 
	$çedWr™eCªBeR—d
() {

90 
	`£tupNodes
();

92 
fš®
 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

93 
fš®
 
IR•liÿtiÚPrÙocŞ
 
½
 = 
	`g‘PrÙocŞ
();

94 
fš®
 
RuÁimeLayout
 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

96 
LogD©a
 
šcom¶‘eWr™e
 = 
	`g‘LogD©a
(0, "šcom¶‘e".
	`g‘By‹s
());

99 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
).
	`wr™e
(
šcom¶‘eWr™e
);

103 
ILogD©a
 
»adResuÉ
 = 
½
.
	`»ad
(
ruÁimeLayout
, 0);

105 
	`as£¹Th©
(
»adResuÉ
.
	`g‘Paylßd
(
r
))

106 .
	`isEqu®To
("šcom¶‘e".
	`g‘By‹s
());

107 
	}
}

109 
´iv©e
 
	$»moveLogUn™
(
Layout
 
cu¼’tLayout
, 
SŒšg
 
’dpošt
è
throws
 
Exû±iÚ
 {

110 
CÜfuRuÁime
 
cÜfuRuÁime
 = 
	`g‘RuÁime
(
cu¼’tLayout
).
	`cÚÃù
();

111 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
());

112 
Ïyout
.
	`£tEpoch
Öayout.
	`g‘Epoch
() + 1);

113 
Ïyout
.
	`g‘LayoutS”v”s
().
	`add
(
’dpošt
);

114 
Ïyout
.
	`g‘Segm’t
(0L).
	`g‘SŒes
().
	`g‘
(0).
	`g‘LogS”v”s
().
	`»move
(
’dpošt
);

115 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
).
	`£®MšS”v”S‘
();

116 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`upd©eLayout
(
Ïyout
, 1L);

117 
	}
}

128 @
Te¡


129 
public
 
	$ÿÂÙWr™eAüossEpochs
(è
throws
 
Exû±iÚ
 {

130 
	`£tupNodes
();

131 
fš®
 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

132 
Layout
 
Ïyout
 = 
Ãw
 
	`Layout
(
r
.
	`g‘LayoutV›w
().
	`g‘Layout
());

133 
RuÁimeLayout
 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

134 
fš®
 
IR•liÿtiÚPrÙocŞ
 
½
 = 
	`g‘PrÙocŞ
();

136 
LogD©a
 
šcom¶‘eWr™e
 = 
	`g‘LogD©a
(0, "šcom¶‘e".
	`g‘By‹s
());

139 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
).
	`wr™e
(
šcom¶‘eWr™e
);

140 
	`»moveLogUn™
(
Ïyout
, 
SERVERS
.
ENDPOINT_2
);

141 
r
.
	`šv®id©eLayout
();

142 
r
.
	`g‘LayoutV›w
().
	`g‘Layout
();

143 
ruÁimeLayout
 = 
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
();

145 
Œy
 {

147 
½
.
	`»ad
(
r
.
	`g‘LayoutV›w
().
	`g‘RuÁimeLayout
(
Ïyout
), 0L);

148 
	`ç
("No wrongƒpoch on write.");

149 } 
	`ÿtch
 (
WrÚgEpochExû±iÚ
 
we
) {

150 
	`as£¹Th©
(
we
.
	`g‘CÜ»ùEpoch
()).
	`isEqu®To
(1L);

153 
LogD©a
 
logD©a
 = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_0
).
	`»ad
(0L).
	`g‘
()

154 .
	`g‘Add»s£s
().
	`g‘
(0L);

155 
	`as£¹Th©
(
logD©a
.
	`g‘D©a
()).
	`cÚšsExaùly
(
šcom¶‘eWr™e
.getData());

156 
logD©a
 = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_1
).
	`»ad
(0L).
	`g‘
()

157 .
	`g‘Add»s£s
().
	`g‘
(0L);

158 
	`as£¹Th©
(
logD©a
.
	`g‘D©a
()).
	`isNuÎOrEm±y
();

159 
logD©a
 = 
ruÁimeLayout
.
	`g‘LogUn™Cl›Á
(
SERVERS
.
ENDPOINT_2
).
	`»ad
(0L).
	`g‘
()

160 .
	`g‘Add»s£s
().
	`g‘
(0L);

161 
	`as£¹Th©
(
logD©a
.
	`g‘D©a
()).
	`isNuÎOrEm±y
();

162 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/replication/QuorumReplicationProtocolAdditionalTests.java

5 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

7 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gBy‹Buf
;

8 
impÜt
 
	gio
.
	gÃ‰y
.
	gbufãr
.
	gUÅoŞed
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gLogUn™S”v”As£¹iÚs
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡S”v”Rou‹r
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsg
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gCÜfuMsgTy³
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gD©aTy³
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gIM‘ad©a
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gLogD©a
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

20 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

21 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gWr™eReque¡
;

22 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

23 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

24 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAdd»ss
;

25 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

26 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
.
	gISŒ—mV›w
;

27 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

28 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

29 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

31 
impÜt
 
	gjava
.
	gut
.
	gCŞËùiÚs
;

32 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

33 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

35 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

36 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹NÙNuÎ
;

41 
public
 cÏs 
	cQuÜumR•liÿtiÚPrÙocŞAdd™iÚ®Te¡s
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

44 
public
 
fš®
 
UUID
 
	m‹¡Cl›ÁId
 = UUID.
ÇmeUUIDFromBy‹s
("TEST_CLIENT".
g‘By‹s
());

45 
´iv©e
 
Layout
 
	mÏyout
 = 
nuÎ
;

46 
´iv©e
 
CÜfuRuÁime
 
	mcÜfuRuÁime
 = 
nuÎ
;

48 @
BefÜe


49 
public
 
	$befÜe
() {

51 
	`addS”v”
(
SERVERS
.
PORT_0
);

52 
	`addS”v”
(
SERVERS
.
PORT_1
);

53 
	`addS”v”
(
SERVERS
.
PORT_2
);

55 
Ïyout
 = 
Ãw
 
	`Te¡LayoutBud”
()

56 .
	`£tEpoch
(1L)

57 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

58 .
	`addLayoutS”v”
(
SERVERS
.
PORT_1
)

59 .
	`addLayoutS”v”
(
SERVERS
.
PORT_2
)

60 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

61 .
	`budSegm’t
()

62 .
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

63 .
	`budSŒe
()

64 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

65 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

66 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

67 .
	`addToSegm’t
()

68 .
	`addToLayout
()

69 .
	`bud
();

70 
	`boÙ¡¿pAÎS”v”s
(
Ïyout
);

71 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

72 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

73 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

75 
Ïyout
.
	`g‘Segm’t
(0L).
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
);

77 
cÜfuRuÁime
 = 
Ãw
 
	`CÜfuRuÁime
();

78 
cÜfuRuÁime
.
	`£tCacheDi§bËd
(
Œue
);

79 
Ïyout
.
	`g‘LayoutS”v”s
().
	`fÜEach
(
cÜfuRuÁime
::
addLayoutS”v”
);

82 
Ïyout
.
	`g‘AÎS”v”s
().
	`fÜEach
(
£rv”Endpošt
 -> {

83 
cÜfuRuÁime
.
	`g‘Rou‹r
(
£rv”Endpošt
).
	`£tTimeoutCÚÃù
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

84 
cÜfuRuÁime
.
	`g‘Rou‹r
(
£rv”Endpošt
).
	`£tTimeoutRe¥Ú£
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

85 
cÜfuRuÁime
.
	`g‘Rou‹r
(
£rv”Endpošt
).
	`£tTimeoutR‘ry
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

88 
cÜfuRuÁime
.
	`cÚÃù
();

93 
public
 
CÜfuRuÁime
 
	$g‘DeçuÉRuÁime
() {

94  
cÜfuRuÁime
;

95 
	}
}

97 @
	gTe¡


98 @
Suµ»ssW¬nšgs
("unchecked")

99 
public
 
	$checkRecov”yWr™eTrigg”edFromR—dRecov”sD©aWh’TheQuÜumIsLo¡
()

100 
throws
 
Exû±iÚ
 {

103 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

105 
LogUn™S”v”
 
u0
 = 
	`g‘LogUn™
(
SERVERS
.
PORT_0
);

106 
LogUn™S”v”
 
u1
 = 
	`g‘LogUn™
(
SERVERS
.
PORT_1
);

107 
LogUn™S”v”
 
u2
 = 
	`g‘LogUn™
(
SERVERS
.
PORT_2
);

109 
fš®
 
ADDRESS_0
 = 0L;

112 
By‹Buf
 
b
 = 
UÅoŞed
.
	`bufãr
();

113 
S”Ÿliz”s
.
CORFU
.
	`£rŸlize
("0".
	`g‘By‹s
(), 
b
);

114 
Wr™eReque¡
 
m
 = Wr™eReque¡.
	`bud”
()

115 .
	`d©a
(
Ãw
 
	`LogD©a
(
D©aTy³
.
DATA
, 
b
))

116 .
	`bud
();

117 
m
.
	`£tGlob®Add»ss
(
ADDRESS_0
);

118 
m
.
	`£tRªk
(
Ãw
 
IM‘ad©a
.
	`D©aRªk
(0));

119 
m
.
	`£tBackpoš‹rM­
(
CŞËùiÚs
.
	`em±yM­
());

120 
	`£ndMes§ge
(
u1
, 
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
));

121 
	`£ndMes§ge
(
u2
, 
CÜfuMsgTy³
.
WRITE
.
	`·ylßdMsg
(
m
));

122 
u2
.
	`shutdown
();

124 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
u0
)

125 .
	`isEm±yAtAdd»ss
(
ADDRESS_0
);

127 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

128 .
	`isEqu®To
("0".
	`g‘By‹s
());

130 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
u1
)

131 .
	`m©chesD©aAtAdd»ss
(
ADDRESS_0
, "0".
	`g‘By‹s
());

133 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
u0
)

134 .
	`m©chesD©aAtAdd»ss
(
ADDRESS_0
, "0".
	`g‘By‹s
());

136 
	}
}

140 @
	gTe¡


141 @
Suµ»ssW¬nšgs
("unchecked")

142 
public
 
	$checkR—dOnEm±yPos™iÚ
()

143 
throws
 
Exû±iÚ
 {

146 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

148 
LogUn™S”v”
 
u0
 = 
	`g‘LogUn™
(
SERVERS
.
PORT_0
);

150 
UUID
 
¡»amA
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream A");

152 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

156 
Tok’Re¥Ú£
 
Œ
 =

157 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

159 
ISŒ—mV›w
 
sv
 = 
r
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amA
);

160 
sv
.
	`­³nd
(
‹¡Paylßd
);

162 
Œ
 = 
r
.
	`g‘Sequ’ûrV›w
().
	`Ãxt
(
¡»amA
);

165 
	`as£¹Th©
(
sv
.
	`Ãxt
().
	`g‘Paylßd
(
	`g‘RuÁime
()))

166 .
	`isEqu®To
(
‹¡Paylßd
);

168 
add»ss
 = 0;

169 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
add»ss
++).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
HOLE
);

170 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
add»ss
++).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
DATA
);

171 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
add»ss
++).
	`g‘Ty³
()).
	`isEqu®To
(
D©aTy³
.
HOLE
);

176 
	}
}

180 @
	gTe¡


181 @
Suµ»ssW¬nšgs
("unchecked")

182 
public
 
	$ÿnR—dWr™e
()

183 
throws
 
Exû±iÚ
 {

184 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

185 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

186 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

187 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
Ô.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 0),

188 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

189 
‹¡Paylßd
);

190 
ILogD©a
 
x
 = 
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0);

191 
	`as£¹NÙNuÎ
(
x
.
	`g‘Rªk
());

192 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(r))

193 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

195 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`cÚšsSŒ—m
(
¡»amA
))

196 .
	`isTrue
();

198 
	`as£¹Th©
((
IM‘ad©a
.
D©aRªk
è
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘M‘ad©aM­
()

199 .
	`g‘
(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
RANK
)).
	`isNÙNuÎ
();

201 
	}
}

203 @
	gTe¡


204 @
Suµ»ssW¬nšgs
("unchecked")

205 
public
 
	$ÿnR—dWr™eCÚcu¼’t
()

206 
throws
 
Exû±iÚ
 {

207 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

209 
fš®
 
numb”Th»ads
 = 5;

210 
fš®
 
numb”RecÜds
 = 1
_000
;

212 
	`scheduËCÚcu¼’y
(
numb”Th»ads
, 
th»adNumb”
 -> {

213 
ba£
 = 
th»adNumb”
 * 
numb”RecÜds
;

214 
i
 = 
ba£
; i < ba£ + 
numb”RecÜds
; i++) {

215 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
Ô.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 
i
),

216 
CŞËùiÚs
.
	`sšgËtÚM­
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("a"), 
Add»ss
.
NO_BACKPOINTER
)),

217 
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

220 
	`execu‹ScheduËd
(
numb”Th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

222 
	`scheduËCÚcu¼’y
(
numb”Th»ads
, 
th»adNumb”
 -> {

223 
ba£
 = 
th»adNumb”
 * 
numb”RecÜds
;

224 
i
 = 
ba£
; i < ba£ + 
numb”RecÜds
; i++) {

225 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(
i
).
	`g‘Paylßd
(
	`g‘RuÁime
()))

226 .
	`isEqu®To
(
IÁeg”
.
	`toSŒšg
(
i
).
	`g‘By‹s
());

229 
	`execu‹ScheduËd
(
numb”Th»ads
, 
PARAMETERS
.
TIMEOUT_LONG
);

230 
	`as£¹NÙNuÎ
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Rªk
());

231 
	`as£¹Th©
((
IM‘ad©a
.
D©aRªk
è
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘M‘ad©aM­
()

232 .
	`g‘
(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
RANK
)).
	`isNÙNuÎ
();

233 
	}
}

235 @
	gTe¡


236 @
Suµ»ssW¬nšgs
("unchecked")

237 
public
 
	$ÿnR—dWr™eToMuÉË
()

238 
throws
 
Exû±iÚ
 {

242 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

245 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

246 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

248 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
Ô.
	`g‘LayoutV›w
().
	`g‘Layout
().
	`g‘Epoch
(), 0),

249 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

250 
‹¡Paylßd
);

252 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

253 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

255 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L)

256 .
	`cÚšsSŒ—m
(
¡»amA
)).
	`isTrue
();

257 
	`as£¹Th©
((
IM‘ad©a
.
D©aRªk
è
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘M‘ad©aM­
()

258 .
	`g‘
(
IM‘ad©a
.
LogUn™M‘ad©aTy³
.
RANK
)).
	`isNÙNuÎ
();

260 
	}
}

262 @
	gTe¡


263 @
Suµ»ssW¬nšgs
("unchecked")

264 
public
 
	$’su»AÎUn™sCÚšD©a
()

265 
throws
 
Exû±iÚ
 {

269 
CÜfuRuÁime
 
r
 = 
	`g‘DeçuÉRuÁime
();

271 
UUID
 
¡»amA
 = UUID.
	`ÇmeUUIDFromBy‹s
("¡»am A".
	`g‘By‹s
());

272 
by‹
[] 
‹¡Paylßd
 = "h–lØwÜld".
	`g‘By‹s
();

274 
r
.
	`g‘Add»ssS·ûV›w
().
	`wr™e
(
Ãw
 
	`Tok’Re¥Ú£
Òew 
	`Tok’
(1, 0),

275 
CŞËùiÚs
.
	`sšgËtÚM­
(
¡»amA
, 
Add»ss
.
NO_BACKPOINTER
)),

276 
‹¡Paylßd
);

278 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`g‘Paylßd
(
	`g‘RuÁime
()))

279 .
	`isEqu®To
("h–lØwÜld".
	`g‘By‹s
());

281 
	`as£¹Th©
(
r
.
	`g‘Add»ssS·ûV›w
().
	`»ad
(0L).
	`cÚšsSŒ—m
(
¡»amA
));

284 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_0
))

285 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

286 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_1
))

287 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

288 
LogUn™S”v”As£¹iÚs
.
	`as£¹Th©
(
	`g‘LogUn™
(
SERVERS
.
PORT_2
))

289 .
	`m©chesD©aAtAdd»ss
(0, 
‹¡Paylßd
);

290 
	}
}

294 
public
 
	$£ndMes§ge
(
LogUn™S”v”
 
s
, 
CÜfuMsg
 
mes§ge
) {

295 
Te¡S”v”Rou‹r
 
rou‹r
 = 
Ãw
 
	`Te¡S”v”Rou‹r
();

296 
rou‹r
.
	`addS”v”
(
s
);

297 
mes§ge
.
	`£tCl›ÁID
(
‹¡Cl›ÁId
);

298 
mes§ge
.
	`£tReque¡ID
(
»que¡CouÁ”
.
	`g‘AndInüem’t
());

299 
rou‹r
.
	`£ndS”v”Mes§ge
(
mes§ge
);

300 
	}
}

302 
´iv©e
 
AtomicIÁeg”
 
	g»que¡CouÁ”
 = 
Ãw
 AtomicInteger(0);

	@test/src/test/java/org/corfudb/runtime/view/replication/QuorumReplicationProtocolTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g»¶iÿtiÚ
;

3 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gšäa¡ruùu»
.
	gTe¡LayoutBud”
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

13 @
IgnÜe


14 
public
 cÏs 
	cQuÜumR•liÿtiÚPrÙocŞTe¡
 
ex‹nds
 
	mAb¡¿ùR•liÿtiÚPrÙocŞTe¡
 {

17 @
Ov”ride


18 
IR•liÿtiÚPrÙocŞ
 
	$g‘PrÙocŞ
() {

19  
Ãw
 
	`QuÜumR•liÿtiÚPrÙocŞ
Òew 
	`AlwaysHŞeFlPŞicy
());

23 @
Ov”ride


24 
	$£tupNodes
() {

25 
	`addS”v”
(
SERVERS
.
PORT_0
);

26 
	`addS”v”
(
SERVERS
.
PORT_1
);

27 
	`addS”v”
(
SERVERS
.
PORT_2
);

29 
	`boÙ¡¿pAÎS”v”s
(
Ãw
 
	`Te¡LayoutBud”
()

30 .
	`addLayoutS”v”
(
SERVERS
.
PORT_0
)

31 .
	`addSequ’ûr
(
SERVERS
.
PORT_0
)

32 .
	`budSegm’t
()

33 .
	`£tR•liÿtiÚMode
(
Layout
.
R•liÿtiÚMode
.
QUORUM_REPLICATION
)

34 .
	`budSŒe
()

35 .
	`addLogUn™
(
SERVERS
.
PORT_0
)

36 .
	`addLogUn™
(
SERVERS
.
PORT_1
)

37 .
	`addLogUn™
(
SERVERS
.
PORT_2
)

38 .
	`addToSegm’t
()

39 .
	`addToLayout
()

40 .
	`bud
());

41 
	`g‘RuÁime
().
	`£tCacheDi§bËd
(
Œue
);

42 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_0
).
	`shutdown
();

43 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_1
).
	`shutdown
();

44 
	`g‘Mªagem’tS”v”
(
SERVERS
.
PORT_2
).
	`shutdown
();

45 
	}
}

50 @
Ov”ride


51 
public
 
	$ov”wr™eThrowsExû±iÚ
()

52 
throws
 
Exû±iÚ
 {

55 
su³r
.
	`ov”wr™eThrowsExû±iÚ
();

56 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/stream/AbstractStreamViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gILogD©a
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’Re¥Ú£
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gTrimmedExû±iÚ
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gSŒ—mO±iÚs
;

12 
impÜt
 
	gÜg
.
	gjun™
.
	gIgnÜe
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

15 
impÜt
 
	gjava
.
	gtime
.
	gDu¿tiÚ
;

16 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

24 
public
 
ab¡¿ù
 cÏs 
	cAb¡¿ùSŒ—mV›wTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

26 
public
 
	$Ab¡¿ùSŒ—mV›wTe¡
(
boŞ—n
 
fŞlowBackpoš‹rs
) {

27 
	`su³r
(
fŞlowBackpoš‹rs
);

33 @
Te¡


34 
public
 
	$hasNextTe¡
() {

35 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

37 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

38 
sv
.
	`­³nd
("h–lØwÜld".
	`g‘By‹s
());

40 
	`as£¹Th©
(
sv
.
	`hasNext
()).
	`isTrue
();

41 
sv
.
	`Ãxt
();

42 
	`as£¹Th©
(
sv
.
	`hasNext
()).
	`isF®£
();

43 
	}
}

52 @
Te¡


53 
public
 
	$»adQueueTe¡
() {

54 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

55 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

56 
fš®
 
‹n
 = 10;

59 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

60 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

65 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

66 
	`as£¹Th©
(
sv
.
	`hasNext
()).
	`isTrue
();

67 
by‹
[] 
·yLßd
 = (by‹[]è
sv
.
	`Ãxt
().
	`g‘Paylßd
(
ruÁime
);

68 
	`as£¹Th©
(
Ãw
 
	`SŒšg
(
·yLßd
).
	`equ®s
(
SŒšg
.
	`v®ueOf
(
i
)))

69 .
	`isTrue
();

70 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
i
);

72 ià(
i
 % 
‹n
 == 1) {

73 
j
 = 0; j < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; j++) {

74 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

82 
i
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
 - 1; i >= 0; i--) {

83 
by‹
[] 
·yLßd
 = (by‹[]è
sv
.
	`cu¼’t
().
	`g‘Paylßd
(
ruÁime
);

84 
	`as£¹Th©
(
Ãw
 
	`SŒšg
(
·yLßd
).
	`equ®s
(
SŒšg
.
	`v®ueOf
(
i
)))

85 .
	`isTrue
();

86 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
i
);

87 
sv
.
	`´evious
();

89 ià(
i
 % 
‹n
 == 1) {

90 
j
 = 0; j < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; j++) {

91 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

96 
	}
}

101 @
Te¡


102 
public
 
	$£ekSkTe¡
() {

103 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

104 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

105 
fš®
 
by‹
[] 
ENTRY_0
 = {0};

106 
fš®
 
by‹
[] 
ENTRY_1
 = {1};

107 
fš®
 
by‹
[] 
ENTRY_2
 = {2};

109 
sv
.
	`­³nd
(
ENTRY_0
);

110 
sv
.
	`­³nd
(
ENTRY_1
);

111 
sv
.
	`­³nd
(
ENTRY_2
);

112 
sv
.
	`»£t
();

116 
sv
.
	`£ek
(2);

119 
	`as£¹Th©
((
by‹
[])
sv
.
	`´evious
().
	`g‘Paylßd
(
ruÁime
))

120 .
	`isEqu®To
(
ENTRY_0
);

121 
	}
}

124 @
Te¡


125 
public
 
	$mÜeR—dQueueTe¡
() {

126 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

127 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

130 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

131 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

135 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

136 
	`as£¹Th©
(
sv
.
	`hasNext
()).
	`isTrue
();

137 
sv
.
	`Ãxt
();

142 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_VERY_LOW
; i++) {

143 ià(
i
 % 2 == 0) {

144 
	`as£¹Th©
(
sv
.
	`hasNext
()).
	`isF®£
();

145 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

146 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

148 
by‹
[] 
·yLßd
 = (by‹[]è
sv
.
	`Ãxt
().
	`g‘Paylßd
(
ruÁime
);

149 
	`as£¹Th©
(
Ãw
 
	`SŒšg
(
·yLßd
).
	`equ®s
(
SŒšg
.
	`v®ueOf
(
i
)));

151 
	}
}

157 @
Te¡


158 
public
 
	$h—dOfSŒ—mBackpoš‹rT”mš©iÚ
() {

160 
fš®
 
tÙ®EÁr›s
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
 + 1;

161 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

164 
ISŒ—mV›w
 
svA
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

165 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

166 
svA
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

170 
ISŒ—mV›w
 
svB
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamB"));

171 
svB
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(0).
	`g‘By‹s
());

174 
svB
.
	`»maššgUpTo
(
tÙ®EÁr›s
);

175 
	`as£¹Th©
(((
Th»adSaãSŒ—mV›w
è
svB
).
	`g‘Und”lyšgSŒ—m
().
	`g‘TÙ®Upd©es
()).
	`isEqu®To
(1L);

176 
	}
}

178 @
	gIgnÜe


179 @
Te¡


180 
public
 
	$‹¡SŒ—mGC
(è
throws
 
Exû±iÚ
 {

181 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

183 
ISŒ—mV›w
 
svA
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

184 
ISŒ—mV›w
 
svB
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("streamA"));

188 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

189 
svA
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

193 
ISŒ—mV›w
 
bpsvA
 = ((
Th»adSaãSŒ—mV›w
è
svA
).
	`g‘Und”lyšgSŒ—m
();

194 
ISŒ—mV›w
 
bpsvB
 = ((
Th»adSaãSŒ—mV›w
è
svA
).
	`g‘Und”lyšgSŒ—m
();

195 
	`as£¹Th©
(
svA
.
	`»maššg
()).
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

196 
	`as£¹Th©
(
svB
.
	`»maššg
()).
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

197 
	`as£¹Th©
(((
Ab¡¿ùQueuedSŒ—mV›w
è
bpsvA
).
	`g‘CÚ‹xt
().
»sŞvedQueue
).
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

198 
	`as£¹Th©
(((
Ab¡¿ùQueuedSŒ—mV›w
è
bpsvB
).
	`g‘CÚ‹xt
().
»sŞvedQueue
).
	`hasSize
(
PARAMETERS
.
NUM_ITERATIONS_LOW
);

199 
Tok’Re¥Ú£
 

 = 
ruÁime
.
	`g‘Sequ’ûrV›w
().
	`qu”y
();

200 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(

.
	`g‘Tok’
());

202 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

205 
svA
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
PARAMETERS
.
NUM_ITERATIONS_LOW
).
	`g‘By‹s
());

206 
bpsvA
 = ((
Th»adSaãSŒ—mV›w
è
svA
).
	`g‘Und”lyšgSŒ—m
();

207 
bpsvB
 = ((
Th»adSaãSŒ—mV›w
è
svA
).
	`g‘Und”lyšgSŒ—m
();

208 
	`as£¹Th©
(
svA
.
	`»maššg
()).
	`hasSize
(1);

209 
	`as£¹Th©
(
svB
.
	`»maššg
()).
	`hasSize
(1);

212 
ruÁime
.
	`g‘G¬bageCŞËùÜ
().
	`runRuÁimeGC
();

213 
	`as£¹Th©
(((
Ab¡¿ùQueuedSŒ—mV›w
è
bpsvA
).
	`g‘CÚ‹xt
().
»sŞvedQueue
).
	`hasSize
(1);

214 
	`as£¹Th©
(((
Ab¡¿ùQueuedSŒ—mV›w
è
bpsvA
).
	`g‘CÚ‹xt
().
»adQueue
).
	`isEm±y
();

215 
	`as£¹Th©
(((
Ab¡¿ùQueuedSŒ—mV›w
è
bpsvA
).
	`g‘CÚ‹xt
().
»adCpQueue
).
	`isEm±y
();

216 
	}
}

218 
fš®
 
	gŒimM¬k
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
 / 2;

219 
fš®
 
	gŒav”£M¬k
 = 
PARAMETERS
.
NUM_ITERATIONS_LOW
 / 4;

231 @
Te¡


232 
public
 
	$Œav”£TrimmedSŒ—mIgnÜeTrim
(è
throws
 
Exû±iÚ
 {

236 
ISŒ—mV›w
 
sv
 = 
	`Œav”£SŒ—mBefÜeTrimM¬k
(
Œue
);

240 
Li¡
<
ILogD©a
> 
¡»am
 = 
sv
.
	`»maššg
();

241 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_LOW
 - 1);

242 
	`as£¹Th©
(
¡»am
.
	`size
()).
	`isEqu®To
(
ŒimM¬k
 - 1);

244 
»maššgCouÁ”
 = 
ŒimM¬k
 + 1;

245 
ILogD©a
 
d©a
: 
¡»am
) {

246 
by‹
[] 
·yLßd
 = (by‹[]è
d©a
.
	`g‘Paylßd
(
this
.
	`g‘RuÁime
());

247 
	`as£¹Th©
(
Ãw
 
	`SŒšg
(
·yLßd
)).
	`isEqu®To
(
SŒšg
.
	`v®ueOf
(
»maššgCouÁ”
));

248 
»maššgCouÁ”
++;

250 
	}
}

262 @
	$Te¡
(
ex³ùed
 = 
TrimmedExû±iÚ
.
şass
)

263 
public
 
	$Œav”£TrimmedSŒ—mDÚtIgnÜeTrim
(è
throws
 
Exû±iÚ
 {

266 
ISŒ—mV›w
 
sv
 = 
	`Œav”£SŒ—mBefÜeTrimM¬k
(
çl£
);

269 
sv
.
	`»maššg
();

270 
	}
}

272 
´iv©e
 
ISŒ—mV›w
 
	$Œav”£SŒ—mBefÜeTrimM¬k
(
boŞ—n
 
ignÜeTrimmed
)

273 
throws
 
IÁ”ru±edExû±iÚ
 {

275 
CÜfuRuÁime
 
ruÁime
 = 
	`g‘DeçuÉRuÁime
();

276 
SŒ—mO±iÚs
 
İtiÚs
 = SŒ—mO±iÚs.
	`bud”
()

277 .
	`ignÜeTrimmed
(
ignÜeTrimmed
)

278 .
	`bud
();

279 
ISŒ—mV›w
 
sv
 = 
ruÁime
.
	`g‘SŒ—msV›w
().
	`g‘
(
CÜfuRuÁime
.
	`g‘SŒ—mID
("¡»amA"), 
İtiÚs
);

280 
fš®
 
•och
 = 0L;

281 
fš®
 
Du¿tiÚ
 
wa™FÜTrim
 = Du¿tiÚ.
	`ofSecÚds
(5);

284 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_LOW
; i++) {

285 
sv
.
	`­³nd
(
SŒšg
.
	`v®ueOf
(
i
).
	`g‘By‹s
());

289 
i
 = 0; i < 
Œav”£M¬k
; i++) {

290 
	`as£¹Th©
(
sv
.
	`hasNext
()).
	`isTrue
();

291 
by‹
[] 
·yLßd
 = (by‹[]è
sv
.
	`Ãxt
().
	`g‘Paylßd
(
ruÁime
);

292 
	`as£¹Th©
(
Ãw
 
	`SŒšg
(
·yLßd
).
	`equ®s
(
SŒšg
.
	`v®ueOf
(
i
)))

293 .
	`isTrue
();

294 
	`as£¹Th©
(
sv
.
	`g‘Cu¼’tGlob®Pos™iÚ
()).
	`isEqu®To
(
i
);

298 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
Ãw
 
	`Tok’
(
•och
, 
ŒimM¬k
));

301 
TimeUn™
.
MILLISECONDS
.
	`¦“p
(
wa™FÜTrim
.
	`toMlis
());

302 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eS”v”Caches
();

303 
ruÁime
.
	`g‘Add»ssS·ûV›w
().
	`šv®id©eCl›ÁCache
();

305  
sv
;

306 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/stream/AddressMapStreamViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
public
 cÏs 
	cAdd»ssM­SŒ—mV›wTe¡
 
ex‹nds
 
	mAb¡¿ùSŒ—mV›wTe¡
 {

5 
public
 
	$Add»ssM­SŒ—mV›wTe¡
() {

6 
	`su³r
(
çl£
);

8 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/stream/BackpointerStreamViewTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

4 
public
 cÏs 
	cBackpoš‹rSŒ—mV›wTe¡
 
ex‹nds
 
	mAb¡¿ùSŒ—mV›wTe¡
 {

6 
public
 
	$Backpoš‹rSŒ—mV›wTe¡
() {

7 
	`su³r
(
Œue
);

10 
	}
}

	@test/src/test/java/org/corfudb/runtime/view/stream/OpaqueStreamTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	g¡»am
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	g»æeù
.
	gTy³Tok’
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gCu¡omS”Ÿliz”
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gMuÉiSMREÁry
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	glog´ÙocŞ
.
	gO·queEÁry
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	g´ÙocŞs
.
	gwœ•rÙocŞ
.
	gTok’
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gMuÉiCheckpoštWr™”
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.
	gCÜfuTabË
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gexû±iÚs
.
	gS”Ÿliz”Exû±iÚ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gAb¡¿ùV›wTe¡
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gIS”Ÿliz”
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
.
	gS”Ÿliz”s
;

16 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

17 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

19 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

20 
impÜt
 
	gjava
.
	gut
.
	g¡»am
.
	gSŒ—m
;

22 
public
 cÏs 
	cO·queSŒ—mTe¡
 
ex‹nds
 
	mAb¡¿ùV›wTe¡
 {

24 @
Te¡


25 
public
 
	$‹¡MagicBy‹
() {

26 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
();

28 
IS”Ÿliz”
 
cu¡omS”Ÿliz”
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
((
by‹
è(
S”Ÿliz”s
.
SYSTEM_SERIALIZERS_COUNT
 + 2));

29 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”
);

31 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream1");

33 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
m­
 = 
¹
.
	`g‘ObjeùsV›w
()

34 .
	`bud
()

35 .
	`£tSŒ—mID
(
¡»amId
)

36 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

37 .
	`£tS”Ÿliz”
(
cu¡omS”Ÿliz”
)

38 .
	`İ’
() ;

41 
¹
.
	`g‘ObjeùsV›w
().
	`TXBegš
();

42 
fš®
 
key1
 = 1;

43 
fš®
 
key2
 = 2;

44 
fš®
 
key3
 = 3;

45 
m­
.
	`put
(
key1
, key1);

46 
m­
.
	`put
(
key2
, key2);

47 
m­
.
	`put
(
key3
, key3);

48 
¹
.
	`g‘ObjeùsV›w
().
	`TXEnd
();

51 
S”Ÿliz”s
.
	`»moveS”Ÿliz”
(
cu¡omS”Ÿliz”
);

53 
CÜfuRuÁime
 
¹2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

55 
ISŒ—mV›w
 
sv
 = 
¹2
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

56 
O·queSŒ—m
 
İaqueSŒ—m
 = 
Ãw
 
	`O·queSŒ—m
(
¹2
, 
sv
);

57 
fš®
 
¢­shÙ
 = 100;

58 
SŒ—m
<
O·queEÁry
> 
¡»am
 = 
İaqueSŒ—m
.
	`¡»amUpTo
(
¢­shÙ
);

60 
¡»am
.
	`fÜEach
(
’Œy
 -> {

61 
Sy¡em
.
out
.
	`´šn
(
’Œy
.
	`g‘V”siÚ
(è+ " " +ƒÁry.
	`g‘EÁr›s
());

66 @
Te¡


67 
public
 
	$‹¡BasicSŒ—mšg
() {

68 
CÜfuRuÁime
 
¹
 = 
	`g‘DeçuÉRuÁime
();

70 
IS”Ÿliz”
 
cu¡omS”Ÿliz”
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
((
by‹
è(
S”Ÿliz”s
.
SYSTEM_SERIALIZERS_COUNT
 + 2));

71 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”
);

73 
UUID
 
¡»amId
 = 
CÜfuRuÁime
.
	`g‘SŒ—mID
("stream1");

75 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
m­
 = 
¹
.
	`g‘ObjeùsV›w
()

76 .
	`bud
()

77 .
	`£tSŒ—mID
(
¡»amId
)

78 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

79 .
	`£tS”Ÿliz”
(
cu¡omS”Ÿliz”
)

80 .
	`İ’
() ;

83 
fš®
 
key1
 = 1;

84 
fš®
 
key2
 = 2;

85 
fš®
 
key3
 = 3;

86 
m­
.
	`put
(
key1
, key1);

87 
m­
.
	`put
(
key2
, key2);

88 
m­
.
	`put
(
key3
, key3);

90 
MuÉiCheckpoštWr™”
 
mcw
 = 
Ãw
 
	`MuÉiCheckpoštWr™”
();

91 
mcw
.
	`addM­
(
m­
);

92 
Tok’
 
tok’
 = 
mcw
.
	`­³ndCheckpošts
(
¹
, "baah");

94 
¹
.
	`g‘Add»ssS·ûV›w
().
	`´efixTrim
(
tok’
);

96 
S”Ÿliz”s
.
	`»moveS”Ÿliz”
(
cu¡omS”Ÿliz”
);

98 
CÜfuRuÁime
 
¹2
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

100 
ISŒ—mV›w
 
sv
 = 
¹2
.
	`g‘SŒ—msV›w
().
	`g‘
(
¡»amId
);

101 
O·queSŒ—m
 
İaqueSŒ—m
 = 
Ãw
 
	`O·queSŒ—m
(
¹2
, 
sv
);

102 
fš®
 
¢­shÙ
 = 100;

103 
SŒ—m
<
O·queEÁry
> 
¡»am
 = 
İaqueSŒ—m
.
	`¡»amUpTo
(
¢­shÙ
);

105 
¡»am
.
	`fÜEach
(
’Œy
 -> {

106 
Sy¡em
.
out
.
	`´šn
(
’Œy
.
	`g‘V”siÚ
(è+ " " +ƒÁry.
	`g‘EÁr›s
());

109 
CÜfuRuÁime
 
¹3
 = 
	`g‘NewRuÁime
(
	`g‘DeçuÉNode
()).
	`cÚÃù
();

111 
CÜfuTabË
<
IÁeg”
, IÁeg”> 
m­2
 = 
¹3
.
	`g‘ObjeùsV›w
()

112 .
	`bud
()

113 .
	`£tSŒ—mID
(
¡»amId
)

114 .
	`£tTy³Tok’
(
Ãw
 
Ty³Tok’
<
CÜfuTabË
<
IÁeg”
, Integer>>() {})

115 .
	`İ’
() ;

117 
	`as£¹Th©ThrownBy
((è-> 
m­2
.
	`size
()).
	`isIn¡ªûOf
(
S”Ÿliz”Exû±iÚ
.
şass
);

118 
	}
}

	@test/src/test/java/org/corfudb/security/tls/ReloadableTrustManagerTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
;

3 
impÜt
 
	gjava
.
	gio
.
	gBy‹A¼ayIÅutSŒ—m
;

4 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gFes
;

5 
impÜt
 
	gjava
.
	gnio
.
	gfe
.
	gP©hs
;

6 
impÜt
 
	gjava
.
	g£cur™y
.
	gû¹
.
	gC”tifiÿ‹Exû±iÚ
;

7 
impÜt
 
	gjava
.
	g£cur™y
.
	gû¹
.
	gC”tifiÿ‹FaùÜy
;

8 
impÜt
 
	gjava
.
	g£cur™y
.
	gû¹
.
	gX509C”tifiÿ‹
;

9 
impÜt
 
	gÜg
.
	g­ache
.
	gx”ûs
.
	gim¶
.
	gdv
.
	gut
.
	gBa£64
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

11 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gç
;

13 
public
 cÏs 
	cR–ßdabËTru¡Mªag”Te¡
 {

14 
´iv©e
 
SŒšg
 
	mPASSWORD_FILE
 = "src/test/resources/security/reload/password";

15 
´iv©e
 
SŒšg
 
	mCLIENT_CERT
 = "src/test/resources/security/reload/client.cert";

16 
´iv©e
 
SŒšg
 
	mSERVER_CERT
 = "src/test/resources/security/reload/server.cert";

18 @
Te¡


19 
public
 
	$‹¡S”v”CheckCl›Á
(è
throws
 
Exû±iÚ
 {

20 
R–ßdabËTru¡Mªag”
 
mªag”
 = 
Ãw
 
	`R–ßdabËTru¡Mªag”
(

21 "¤c/‹¡/»sourûs/£cur™y/»lßd/£rv”_Œu¡_w™h_ş›Á.jks", 
PASSWORD_FILE
);

23 
X509C”tifiÿ‹
 
û¹
 = 
	`g‘C”tifiÿ‹
(
CLIENT_CERT
);

25 
mªag”
.
	`checkCl›ÁTru¡ed
(
Ãw
 
X509C”tifiÿ‹
[]{
û¹
}, "RSA");

28 @
Te¡


29 
public
 
	$‹¡S”v”CheckCl›ÁFa
(è
throws
 
Exû±iÚ
 {

30 
R–ßdabËTru¡Mªag”
 
mªag”
 = 
Ãw
 
	`R–ßdabËTru¡Mªag”
(

31 "¤c/‹¡/»sourûs/£cur™y/»lßd/£rv”_Œu¡_no_ş›Á.jks", 
PASSWORD_FILE
);

33 
X509C”tifiÿ‹
 
û¹
 = 
	`g‘C”tifiÿ‹
(
CLIENT_CERT
);

35 
Œy
 {

36 
mªag”
.
	`checkCl›ÁTru¡ed
(
Ãw
 
X509C”tifiÿ‹
[]{
û¹
}, "RSA");

37 
	`ç
();

38 } 
	`ÿtch
 (
C”tifiÿ‹Exû±iÚ
 
e
) {

41 
	}
}

43 @
Te¡


44 
public
 
	$‹¡Cl›ÁCheckS”v”
(è
throws
 
Exû±iÚ
 {

45 
R–ßdabËTru¡Mªag”
 
mªag”
 = 
Ãw
 
	`R–ßdabËTru¡Mªag”
(

46 "¤c/‹¡/»sourûs/£cur™y/»lßd/ş›Á_Œu¡_w™h_£rv”.jks", 
PASSWORD_FILE
);

48 
X509C”tifiÿ‹
 
û¹
 = 
	`g‘C”tifiÿ‹
(
SERVER_CERT
);

50 
mªag”
.
	`checkS”v”Tru¡ed
(
Ãw
 
X509C”tifiÿ‹
[]{
û¹
}, "RSA");

51 
	}
}

53 @
Te¡


54 
public
 
	$‹¡Cl›ÁCheckS”v”Fa
(è
throws
 
Exû±iÚ
 {

55 
R–ßdabËTru¡Mªag”
 
mªag”
 = 
Ãw
 
	`R–ßdabËTru¡Mªag”
(

56 "¤c/‹¡/»sourûs/£cur™y/»lßd/ş›Á_Œu¡_no_£rv”.jks", 
PASSWORD_FILE
);

58 
X509C”tifiÿ‹
 
û¹
 = 
	`g‘C”tifiÿ‹
(
SERVER_CERT
);

60 
Œy
 {

61 
mªag”
.
	`checkCl›ÁTru¡ed
(
Ãw
 
X509C”tifiÿ‹
[]{
û¹
}, "RSA");

62 
	`ç
();

63 } 
	`ÿtch
 (
C”tifiÿ‹Exû±iÚ
 
e
) {

66 
	}
}

68 
´iv©e
 
X509C”tifiÿ‹
 
	$g‘C”tifiÿ‹
(
SŒšg
 
û¹Fe
è
throws
 
Exû±iÚ
 {

69 
SŒšg
 
ş›ÁC”t
 = (
Ãw
 
	`SŒšg
(
Fes
.
	`»adAÎBy‹s
(
P©hs
.
	`g‘
(
û¹Fe
)))).
	`Œim
();

70 
by‹
 [] 
decoded
 = 
Ba£64
.
	`decode
(
ş›ÁC”t
);

71 
C”tifiÿ‹FaùÜy
 
cf
 = C”tifiÿ‹FaùÜy.
	`g‘In¡ªû
("X.509");

72  (
X509C”tifiÿ‹
)
cf
.
	`g’”©eC”tifiÿ‹
(
Ãw
 
	`By‹A¼ayIÅutSŒ—m
(
decoded
));

73 
	}
}

	@test/src/test/java/org/corfudb/security/tls/TlsUtilsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g£cur™y
.
	gs
;

3 
impÜt
 
	gjava
.
	g£cur™y
.
	gKeyStÜe
;

4 
impÜt
 
	gjavax
.
	gÃt
.
	gs¦
.
	gSSLExû±iÚ
;

5 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹Equ®s
;

8 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹F®£
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gAs£¹
.
	gas£¹True
;

11 
public
 cÏs 
	cTlsUtsTe¡
 {

12 
´iv©e
 
SŒšg
 
	mPASSWORD_FILE
 = "src/test/resources/security/reload/password";

13 
´iv©e
 
SŒšg
 
	mKEY_STORE_FILE
 = "src/test/resources/security/reload/client_trust_with_server.jks";

15 @
Te¡


16 
public
 
	$‹¡G‘PasswÜd
(è
throws
 
Exû±iÚ
 {

17 
SŒšg
 
·sswÜd
 = 
TlsUts
.
	`g‘KeyStÜePasswÜd
(
PASSWORD_FILE
);

18 
	`as£¹Equ®s
("·sswÜd", 
·sswÜd
);

21 @
Te¡


22 
public
 
	$‹¡G‘Em±yPasswÜd
(è
throws
 
Exû±iÚ
 {

23 
SŒšg
 
·sswÜd
 = 
TlsUts
.
	`g‘KeyStÜePasswÜd
(
nuÎ
);

24 
	`as£¹Equ®s
("", 
·sswÜd
);

25 
	}
}

27 @
Te¡


28 
public
 
	$‹¡BadPasswÜdFe
(è
throws
 
Exû±iÚ
 {

29 
Œy
 {

30 
TlsUts
.
	`g‘KeyStÜePasswÜd
("definitely fake†ocation");

31 
	`as£¹F®£
(
Œue
);

32 } 
	`ÿtch
 (
SSLExû±iÚ
 
e
) {

33 
	`as£¹True
(
e
.
	`g‘Mes§ge
().
	`¡¬tsW™h
("Unableo„ead…assword file"));

35 
	}
}

37 @
Te¡


38 
public
 
	$‹¡O³nKeyStÜe
(è
throws
 
Exû±iÚ
 {

39 
SŒšg
 
·sswÜd
 = 
TlsUts
.
	`g‘KeyStÜePasswÜd
(
PASSWORD_FILE
);

40 
KeyStÜe
 
keyStÜe
 = 
TlsUts
.
	`İ’KeyStÜe
(
KEY_STORE_FILE
, 
·sswÜd
);

41 
	`as£¹Equ®s
(2, 
keyStÜe
.
	`size
());

42 
	}
}

44 @
Te¡


45 
public
 
	$‹¡O³nKeyStÜeBadPasswÜd
(è
throws
 
Exû±iÚ
 {

46 
Œy
 {

47 
TlsUts
.
	`İ’KeyStÜe
(
KEY_STORE_FILE
, "fake…assword");

48 } 
	`ÿtch
 (
SSLExû±iÚ
 
e
) {

49 
	`as£¹Equ®s
("Keystore wasampered with, or…assword was incorrect",

50 
e
.
	`g‘Cau£
().
	`g‘Mes§ge
());

52 
	}
}

54 @
Te¡


55 
public
 
	$‹¡O³nKeyStÜeBadLoÿtiÚ
(è
throws
 
Exû±iÚ
 {

56 
Œy
 {

57 
TlsUts
.
	`İ’KeyStÜe
("definitely fake†ocation", "fake…assword");

58 } 
	`ÿtch
 (
SSLExû±iÚ
 
e
) {

59 
	`as£¹True
(
e
.
	`g‘Mes§ge
().
	`’dsW™h
("doesn'tƒxist."));

61 
	}
}

	@test/src/test/java/org/corfudb/test/DisabledOnTravis.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g‹¡
;

3 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gInh”™ed
;

4 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚ
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gªnÙ©iÚ
.
	gR‘’tiÚPŞicy
;

12 @
R‘’tiÚ
(
R‘’tiÚPŞicy
.
RUNTIME
)

13 @
Inh”™ed


14 
	gpublic
 @
š‹rçû
 
	gDi§bËdOnT¿vis
 {

	@test/src/test/java/org/corfudb/test/TestUtils.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g‹¡
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
.
	gPARAMETERS
;

6 
impÜt
 
	gjava
.
	gut
.
	gfunùiÚ
.
	gP»diÿ‹
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gv›w
.
	gLayout
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gSË•
;

15 
public
 cÏs 
	cTe¡Uts
 {

24 
public
 
	$£tAgg»ssiveTimeouts
(
Layout
 
Ïyout
, 
CÜfuRuÁime
... 
cÜfuRuÁimes
) {

25 
Ïyout
.
	`g‘AÎS”v”s
().
	`fÜEach
(
rou‹rEndpošt
 -> {

26 
CÜfuRuÁime
 
ruÁime
 : 
cÜfuRuÁimes
) {

27 
ruÁime
.
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutCÚÃù
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

28 
ruÁime
.
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutRe¥Ú£
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

29 
ruÁime
.
	`g‘Rou‹r
(
rou‹rEndpošt
).
	`£tTimeoutR‘ry
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
.
	`toMlis
());

41 
public
 
	`wa™FÜLayoutChªge
(
P»diÿ‹
<
Layout
> 
v”if›r
, 
CÜfuRuÁime
 
cÜfuRuÁime
) {

42 
cÜfuRuÁime
.
	`šv®id©eLayout
();

43 
Layout
 
»äeshedLayout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

45 
i
 = 0; i < 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
; i++) {

46 ià(
v”if›r
.
	`‹¡
(
»äeshedLayout
)) {

49 
cÜfuRuÁime
.
	`šv®id©eLayout
();

50 
»äeshedLayout
 = 
cÜfuRuÁime
.
	`g‘LayoutV›w
().
	`g‘Layout
();

51 
SË•
.
	`¦“pUnš‹¼u±ibly
(
PARAMETERS
.
TIMEOUT_VERY_SHORT
);

53 
	`as£¹Th©
(
v”if›r
.
	`‹¡
(
»äeshedLayout
)).
	`isTrue
();

54 
	}
}

	@test/src/test/java/org/corfudb/test/concurrent/TestThreadGroups.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gcÚcu¼’t
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

4 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gDeçuÉEv’tLoİGroup
;

5 
impÜt
 
	gio
.
	gÃ‰y
.
	gchªÃl
.
	gEv’tLoİGroup
;

6 
impÜt
 
	gjavax
.
	gªnÙ©iÚ
.
	gNÚnuÎ
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gut
.
	gcÚcu¼’t
.
	gSšgËtÚResourû
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

11 
public
 cÏs 
	cTe¡Th»adGroups
 {

13 
´iv©e
 
fš®
 
	mQUIET_PERIOD
 = 50;

14 
´iv©e
 
fš®
 
	mTIMEOUT
 = 100;

18 
public
 
	mSšgËtÚResourû
<
	mEv’tLoİGroup
> 
	mNETTY_BOSS_GROUP
 =

19 
SšgËtÚResourû
.
w™hIn™Ÿl
(() ->

20 
g‘Ev’tLoİGroup
(1, "boss-%d"));

25 
public
 
	mSšgËtÚResourû
<
	mEv’tLoİGroup
> 
	mNETTY_WORKER_GROUP
 =

26 
SšgËtÚResourû
.
w™hIn™Ÿl
(() ->

27 
g‘Ev’tLoİGroup
(
g‘Te¡Th»adCouÁ
(), "worker-%d"));

32 
public
 
	mSšgËtÚResourû
<
	mEv’tLoİGroup
> 
	mNETTY_CLIENT_GROUP
 =

33 
SšgËtÚResourû
.
w™hIn™Ÿl
(() ->

34 
g‘Ev’tLoİGroup
(
g‘Te¡Th»adCouÁ
(), "client-%d"));

40 
public
 
	$shutdownTh»adGroups
() {

41 
NETTY_BOSS_GROUP
.
	`ş—nup
(
group
 -> group.
	`shutdownG¿ûfuÎy
(
QUIET_PERIOD
, 
TIMEOUT
, 
TimeUn™
.
MILLISECONDS
));

42 
NETTY_WORKER_GROUP
.
	`ş—nup
(
group
 -> group.
	`shutdownG¿ûfuÎy
(
QUIET_PERIOD
, 
TIMEOUT
, 
TimeUn™
.
MILLISECONDS
));

43 
NETTY_CLIENT_GROUP
.
	`ş—nup
(
group
 -> group.
	`shutdownG¿ûfuÎy
(
QUIET_PERIOD
, 
TIMEOUT
, 
TimeUn™
.
MILLISECONDS
));

50 
´iv©e
 
	$g‘Te¡Th»adCouÁ
(){

51  
RuÁime
.
	`g‘RuÁime
().
	`avaabËProûssÜs
() * 2;

52 
	}
}

60 
´iv©e
 
Ev’tLoİGroup
 
g‘Ev’tLoİGroup
(
numTh»ads
, @
NÚnuÎ
 
SŒšg
 
ÇmeFÜm©
) {

61  
Ãw
 
DeçuÉEv’tLoİGroup
(
numTh»ads
,

62 
Ãw
 
Th»adFaùÜyBud”
()

63 .
£tNameFÜm©
(
ÇmeFÜm©
)

64 .
£tD«mÚ
(
Œue
)

65 .
bud
());

	@test/src/test/java/org/corfudb/util/MemoryFootprintMeasurerIT.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

5 
impÜt
 
	gcom
.
	gcodah®e
.
	gm‘rics
.
	gGauge
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gš‹g¿tiÚ
.
	gAb¡¿ùIT
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

9 
impÜt
 
	gÜg
.
	gjun™
.
	gBefÜe
;

10 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

12 
impÜt
 
	gjava
.
	gio
.
	gIOExû±iÚ
;

13 
impÜt
 
	gjava
.
	gut
.
	gA¼ayLi¡
;

14 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

15 
impÜt
 
	gjava
.
	gut
.
	gLi¡
;

16 
impÜt
 
	gjava
.
	gut
.
	gM­
;

24 @
Slf4j


25 
public
 cÏs 
	cMemÜyFoÙ´štM—su»rIT
 
ex‹nds
 
	mAb¡¿ùIT
{

26 
´iv©e
 
SŒšg
 
	mcÜfuSšgËNodeHo¡
;

27 
´iv©e
 
	mcÜfuSŒšgNodePÜt
;

28 
´iv©e
 
SŒšg
 
	msšgËNodeEndpošt
;

32 
´iv©e
 
Proûss
 
	$runSšgËP”si¡’tS”v”
(
SŒšg
 
ho¡
, 
pÜt
è
throws
 
IOExû±iÚ
 {

33  
Ãw
 
Ab¡¿ùIT
.
	`CÜfuS”v”RuÂ”
()

34 .
	`£tHo¡
(
ho¡
)

35 .
	`£tPÜt
(
pÜt
)

36 .
	`£tLogP©h
(
	`g‘CÜfuS”v”LogP©h
(
ho¡
, 
pÜt
))

37 .
	`£tSšgË
(
Œue
)

38 .
	`runS”v”
();

42 @
BefÜe


43 
public
 
	$lßdPrİ”t›s
() {

44 
cÜfuSšgËNodeHo¡
 = 
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodeHost");

45 
cÜfuSŒšgNodePÜt
 = 
IÁeg”
.
	`v®ueOf
(
PROPERTIES
.
	`g‘Prİ”ty
("corfuSingleNodePort"));

46 
sšgËNodeEndpošt
 = 
SŒšg
.
	`fÜm©
("%s:%d",

47 
cÜfuSšgËNodeHo¡
,

48 
cÜfuSŒšgNodePÜt
);

49 
	}
}

61 @
Te¡


62 
public
 
	$‹¡MemÜyFoÙ´štM—su»rUsšgA¼ayLi¡
(è
throws
 
Exû±iÚ
 {

63 
fš®
 
sm®lSize
 = 10;

64 
fš®
 
ÏrgeSize
 = 10000;

67 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
,

68 
cÜfuSŒšgNodePÜt
);

71 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

74 
Li¡
<
by‹
[]> 
¬¿yLi¡
 = 
Ãw
 
A¼ayLi¡
<>();

77 
fš®
 
Gauge
<
LÚg
> 
¬¿yLi¡SizeGauge
 =

78 
M‘ricsUts
.
	`addMemÜyM—su»rFÜ
(
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
(), 
¬¿yLi¡
);

79 
fš®
 
LÚg
 
š™ŸlA¼aySize
 = 
¬¿yLi¡SizeGauge
.
	`g‘V®ue
();

82 
¬¿yLi¡
.
	`add
(
Ãw
 
by‹
[
sm®lSize
]);

83 
fš®
 
LÚg
 
¬¿ySizeAá”Sm®lInü—£
 = 
¬¿yLi¡SizeGauge
.
	`g‘V®ue
();

84 
log
.
	`šfo
("A¼ayLi¡ size:{}", 
¬¿ySizeAá”Sm®lInü—£
);

85 
	`as£¹Th©
(
¬¿ySizeAá”Sm®lInü—£
 - 
š™ŸlA¼aySize
)

86 .
	`isG»©”ThªOrEqu®To
(
sm®lSize
);

88 
¬¿yLi¡
.
	`add
(
Ãw
 
by‹
[
ÏrgeSize
]);

89 
fš®
 
LÚg
 
¬¿ySizeAá”L¬geInü—£
 = 
¬¿yLi¡SizeGauge
.
	`g‘V®ue
();

90 
log
.
	`šfo
("A¼ayLi¡ size:{}", 
¬¿ySizeAá”L¬geInü—£
);

91 
	`as£¹Th©
(
¬¿ySizeAá”L¬geInü—£
 - 
¬¿ySizeAá”Sm®lInü—£
)

92 .
	`isG»©”ThªOrEqu®To
(
ÏrgeSize
);

95 
¬¿yLi¡
.
	`ş—r
();

96 
Sy¡em
.
	`gc
();

97 
fš®
 
LÚg
 
¬¿ySizeAá”Remov®
 = 
¬¿yLi¡SizeGauge
.
	`g‘V®ue
();

98 
log
.
	`šfo
("A¼ayLi¡ size:{}", 
¬¿ySizeAá”Remov®
);

99 
	`as£¹Th©
(
¬¿ySizeAá”Remov®
).
	`isLessThª
(
¬¿ySizeAá”L¬geInü—£
);

102 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

103 
	}
}

116 @
Te¡


117 
public
 
	$‹¡W—kReã»nûRemov®
(è
throws
 
Exû±iÚ
 {

119 
Proûss
 
cÜfuS”v”
 = 
	`runSšgËP”si¡’tS”v”
(
cÜfuSšgËNodeHo¡
,

120 
cÜfuSŒšgNodePÜt
);

123 
ruÁime
 = 
	`ü—‹RuÁime
(
sšgËNodeEndpošt
);

126 
M­
<
SŒšg
, SŒšg> 
m­1
 = 
Ãw
 
HashM­
<>();

127 
fš®
 
Gauge
<
LÚg
> 
m­1M—su»r
 =

128 
M‘ricsUts
.
	`addMemÜyM—su»rFÜ
(
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
(), 
m­1
);

130 
fš®
 
couÁM­1
 = 300000;

131 
i
 = 0; i < 
couÁM­1
; i++) {

132 
m­1
.
	`put
("t1-key-" + 
i
, "t1-value-" + i);

135 
log
.
	`šfo
("Size of map1 before„emoving„eference: {}",

136 
m­1M—su»r
.
	`g‘V®ue
());

139 
m­1
 = 
nuÎ
;

140 
Sy¡em
.
	`gc
();

143 
M­
<
SŒšg
, SŒšg> 
m­2
 = 
Ãw
 
HashM­
<>();

144 
fš®
 
Gauge
<
LÚg
> 
m­2M—su»r
 =

145 
M‘ricsUts
.
	`addMemÜyM—su»rFÜ
(
CÜfuRuÁime
.
	`g‘DeçuÉM‘rics
(), 
m­2
);

147 
fš®
 
couÁM­2
 = 1000;

148 
i
 = 0; i < 
couÁM­2
; i++) {

149 
m­2
.
	`put
("t2-key-" + 
i
, "t2-value" + i);

154 
	`as£¹Th©
(
m­1M—su»r
.
	`g‘V®ue
()).
	`isEqu®To
(0);

155 
	`as£¹Th©
(
m­2M—su»r
.
	`g‘V®ue
()).
	`isNÙEqu®To
(0);

156 
log
.
	`šfo
("Size of map1‡fter‚ulling outhe„eference:{}",

157 
m­1M—su»r
.
	`g‘V®ue
());

158 
log
.
	`šfo
("Size of map2‡fter‡theƒnd ofest:{}",

159 
m­2M—su»r
.
	`g‘V®ue
());

162 
	`as£¹Th©
(
	`shutdownCÜfuS”v”
(
cÜfuS”v”
)).
	`isTrue
();

163 
	}
}

	@test/src/test/java/org/corfudb/util/UuidUtilsTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
;

3 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

4 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©ThrownBy
;

6 
impÜt
 
	gjava
.
	gut
.
	gUUID
;

7 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

9 
public
 cÏs 
	cUuidUtsTe¡
 {

12 @
Te¡


13 
public
 
	$ba£64SŒšgEqu®sUuid
() {

14 
fš®
 
UUID
 
‹¡Id
 = UUID.
	`ÇmeUUIDFromBy‹s
("‹¡".
	`g‘By‹s
());

15 
fš®
 
SŒšg
 
ba£64
 = 
UuidUts
.
	`asBa£64
(
‹¡Id
);

17 
	`as£¹Th©
(
UuidUts
.
	`äomBa£64
(
ba£64
))

18 .
	`isEqu®To
(
‹¡Id
);

22 @
Te¡


23 
public
 
	$nÚBa£64SŒšgThrowsExû±iÚ
() {

24 
	`as£¹Th©ThrownBy
((è-> 
UuidUts
.
	`äomBa£64
("!!!!!!!!!!!"))

25 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

26 
	}
}

31 @
Te¡


32 
public
 
	$shÜtBa£64SŒšgThrowsExû±iÚ
() {

33 
	`as£¹Th©ThrownBy
((è-> 
UuidUts
.
	`äomBa£64
("AAAA"))

34 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

35 
	}
}

40 @
Te¡


41 
public
 
	$lÚgBa£64SŒšgThrowsExû±iÚ
() {

42 
	`as£¹Th©ThrownBy
((è-> 
UuidUts
.
	`äomBa£64
("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"))

43 .
	`isIn¡ªûOf
(
IÎeg®Argum’tExû±iÚ
.
şass
);

44 
	}
}

	@test/src/test/java/org/corfudb/util/retry/IRetryTest.java

5 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g»Œy
;

7 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

9 
impÜt
 
	gjava
.
	gsql
.
	gSQLExû±iÚ
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	g©omic
.
	gAtomicIÁeg”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gAb¡¿ùCÜfuTe¡
;

13 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

18 
public
 cÏs 
	cIR‘ryTe¡
 
ex‹nds
 
	mAb¡¿ùCÜfuTe¡
 {

20 @
Te¡


21 
public
 
	$‹¡IR‘ryR‘uºsV®ueAá”LÙsOfR‘r›s
(è
throws
 
SQLExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

22 
AtomicIÁeg”
 
»Œ›s
 = 
Ãw
 
	`AtomicIÁeg”
(0);

23 
SŒšg
 
e
 = 
IR‘ry
.
	`bud
(
ExpÚ’tŸlBackoffR‘ry
.
şass
, 
SQLExû±iÚ
.class, () -> {

24 ià(
»Œ›s
.
	`g‘AndInüem’t
()< 
PARAMETERS
.
NUM_ITERATIONS_MODERATE
) {

25 
throw
 
Ãw
 
	`R‘ryN“dedExû±iÚ
();

28 }).
	`£tO±iÚs
(
x
 -> x.
	`£tBa£
(1))

29 .
	`run
();

30 
	`as£¹Th©
(
e
).
	`isEqu®To
("ok");

31 
	`as£¹Th©
(
»Œ›s
.
	`g‘
()).
	`isEqu®To
(
PARAMETERS
.
NUM_ITERATIONS_MODERATE
+1);

34 @
	$Te¡
(
ex³ùed
 = 
SQLExû±iÚ
.
şass
)

35 
public
 
	$‹¡IR‘ryIsAbËToThrowCaughtExû±iÚs
()

36 
throws
 
SQLExû±iÚ
, 
IÁ”ru±edExû±iÚ
 {

37 
IR‘ry
.
	`bud
(
ExpÚ’tŸlBackoffR‘ry
.
şass
, 
SQLExû±iÚ
.class, () -> {

38 
throw
 
Ãw
 
	`SQLExû±iÚ
();

39 }).
	`run
();

40 
	}
}

	@test/src/test/java/org/corfudb/util/serializer/SerializersTest.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gut
.
	g£rŸliz”
;

3 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gCu¡omS”Ÿliz”
;

4 
impÜt
 
	gÜg
.
	gjun™
.
	gTe¡
;

6 
impÜt
 
	gÜg
.
	gas£¹j
.
	gcÜe
.
	g­i
.
	gAs£¹iÚs
.
	gas£¹Th©
;

11 
public
 cÏs 
	cS”Ÿliz”sTe¡
 {

13 @
	$Te¡
 (
ex³ùed
 = 
RuÁimeExû±iÚ
.
şass
)

14 
public
 
	$»gi¡”S”Ÿliz”W™hInv®idTy³Te¡
() {

15 
fš®
 
by‹
 
SERIALIZER_TYPE0
 = 10;

16 
IS”Ÿliz”
 
cu¡omS”Ÿliz”
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
(
SERIALIZER_TYPE0
);

17 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”
);

20 @
Te¡


21 
public
 
	$»gi¡”MuÉËS”Ÿliz”sTe¡
() {

22 
fš®
 
by‹
 
ty³1
 = (byte) 11;

23 
fš®
 
by‹
 
ty³2
 = (byte) 12;

25 
IS”Ÿliz”
 
cu¡omS”Ÿliz”1
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
(
ty³1
);

26 
IS”Ÿliz”
 
cu¡omS”Ÿliz”2
 = 
Ãw
 
	`Cu¡omS”Ÿliz”
(
ty³2
);

28 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”1
);

29 
S”Ÿliz”s
.
	`»gi¡”S”Ÿliz”
(
cu¡omS”Ÿliz”2
);

31 
	`as£¹Th©
(
S”Ÿliz”s
.
	`g‘S”Ÿliz”
(
ty³1
)).
	`isEqu®To
(
cu¡omS”Ÿliz”1
);

32 
	`as£¹Th©
(
S”Ÿliz”s
.
	`g‘S”Ÿliz”
(
ty³2
)).
	`isEqu®To
(
cu¡omS”Ÿliz”2
);

33 
	}
}

	@test/src/test/java/org/corfudb/utils/TestLockListener.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
;

3 
impÜt
 
	glombok
.
	gG‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gcommÚ
.
	gut
.
	gOb£rvabËV®ue
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
;

6 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockLi¡’”
;

8 
public
 cÏs 
	cTe¡LockLi¡’”
 
im¶em’ts
 
	mLockLi¡’”
 {

10 
´iv©e
 
	mlockAcquœedCouÁ
 = 0;

11 
´iv©e
 
	mlockRevokedCouÁ
 = 0;

13 @
G‘‹r


14 
´iv©e
 
Ob£rvabËV®ue
 
	mlockAcquœed
 = 
Ãw
 Ob£rvabËV®ue(
lockAcquœedCouÁ
);

16 @
G‘‹r


17 
´iv©e
 
Ob£rvabËV®ue
 
	mlockRevoked
 = 
Ãw
 Ob£rvabËV®ue(
lockRevokedCouÁ
);

19 @
Ov”ride


20 
public
 
	$lockAcquœed
(
LockD©aTy³s
.
LockId
 
lockId
) {

21 
lockAcquœedCouÁ
++;

22 
Sy¡em
.
out
.
	`´šn
("***** Lock ha b“Àacquœed : " + 
lockAcquœedCouÁ
 + " fÜ: " + 
lockId
.
	`g‘LockName
());

24 
lockAcquœed
.
	`£tV®ue
(
lockAcquœedCouÁ
);

27 @
Ov”ride


28 
public
 
	$lockRevoked
(
LockD©aTy³s
.
LockId
 
lockId
) {

29 
Sy¡em
.
out
.
	`´šn
("***** Lock ha b“À»voked fÜ: " + 
lockId
.
	`g‘LockName
());

31 
lockRevokedCouÁ
++;

32 
lockAcquœed
.
	`£tV®ue
(
lockRevokedCouÁ
);

33 
	}
}

	@test/target/generated-sources/org/corfudb/runtime/CorfuOptions.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

6 
public
 
fš®
 cÏs 
	cCÜfuO±iÚs
 {

7 
´iv©e
 
	$CÜfuO±iÚs
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
»gi¡ry
.
	`add
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
schema
);

11 
	}
}

13 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

14 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

15 
	`»gi¡”AÎEx‹nsiÚs
(

16 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

17 
	}
}

18 
public
 
š‹rçû
 
SchemaO±iÚsOrBud”
 
ex‹nds


20 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

29 
boŞ—n
 
hasSecÚd¬yKey
();

37 
boŞ—n
 
g‘SecÚd¬yKey
();

46 
boŞ—n
 
hasV”siÚ
();

54 
boŞ—n
 
g‘V”siÚ
();

63 
public
 
fš®
 
şass
 
SchemaO±iÚs
 
ex‹nds


64 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


66 
	gSchemaO±iÚsOrBud”
 {

68 
´iv©e
 
SchemaO±iÚs
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

69 
su³r
(
bud”
);

71 
´iv©e
 
SchemaO±iÚs
() {

72 
	g£cÚd¬yKey_
 = 
çl£
;

73 
	gv”siÚ_
 = 
çl£
;

76 @
	gjava
.
	gÏng
.
Ov”ride


77 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


78 
g‘UnknownF›lds
() {

79  
	gthis
.
	gunknownF›lds
;

81 
´iv©e
 
SchemaO±iÚs
(

82 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

83 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

84 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

85 
this
();

86 
	gmubË_b™F›ld0_
 = 0;

87 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

88 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

89 
	gŒy
 {

90 
boŞ—n
 
	gdÚe
 = 
çl£
;

91 !
	gdÚe
) {

92 
	gg
 = 
šput
.
»adTag
();

93 
	gg
) {

95 
dÚe
 = 
Œue
;

98 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

99 
ex‹nsiÚRegi¡ry
, 
g
)) {

100 
	gdÚe
 = 
Œue
;

105 
b™F›ld0_
 |= 0x00000001;

106 
	g£cÚd¬yKey_
 = 
šput
.
»adBoŞ
();

110 
b™F›ld0_
 |= 0x00000002;

111 
	gv”siÚ_
 = 
šput
.
»adBoŞ
();

116 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

117 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

118 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

119 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

120 
e
).
£tUnfšishedMes§ge
(
this
);

121 } 
	gfš®ly
 {

122 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

123 
makeEx‹nsiÚsImmubË
();

126 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


127 
g‘DesütÜ
() {

128  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

131 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


132 
š‹º®G‘F›ldAcûssÜTabË
() {

133  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË


134 .
’su»F›ldAcûssÜsIn™Ÿlized
(

135 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
şass
, org.cÜfudb.ruÁime.CÜfuO±iÚs.SchemaO±iÚs.
Bud”
.class);

138 
´iv©e
 
	gb™F›ld0_
;

139 
public
 
fš®
 
	gSECONDARY_KEY_FIELD_NUMBER
 = 1;

140 
´iv©e
 
boŞ—n
 
	g£cÚd¬yKey_
;

148 
public
 
boŞ—n
 
hasSecÚd¬yKey
() {

149  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

158 
public
 
boŞ—n
 
g‘SecÚd¬yKey
() {

159  
	g£cÚd¬yKey_
;

162 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 2;

163 
´iv©e
 
boŞ—n
 
	gv”siÚ_
;

171 
public
 
boŞ—n
 
hasV”siÚ
() {

172  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

181 
public
 
boŞ—n
 
g‘V”siÚ
() {

182  
	gv”siÚ_
;

185 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

186 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

187 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

188 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

189 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

191 
	gmemoizedIsIn™Ÿlized
 = 1;

192  
	gŒue
;

195 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

196 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

197 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

198 
ouut
.
wr™eBoŞ
(1, 
£cÚd¬yKey_
);

200 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

201 
ouut
.
wr™eBoŞ
(2, 
v”siÚ_
);

203 
	gunknownF›lds
.
wr™eTo
(
ouut
);

206 
public
 
g‘S”ŸlizedSize
() {

207 
	gsize
 = 
memoizedSize
;

208 ià(
	gsize
 !ğ-1è 
size
;

210 
	gsize
 = 0;

211 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

212 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


213 .
compu‹BoŞSize
(1, 
£cÚd¬yKey_
);

215 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

216 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


217 .
compu‹BoŞSize
(2, 
v”siÚ_
);

219 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

220 
	gmemoizedSize
 = 
size
;

221  
	gsize
;

224 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

225 @
	gjava
.
	gÏng
.
Ov”ride


226 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

227 ià(
	gobj
 =ğ
this
) {

228  
Œue
;

230 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
)) {

231  
	gsu³r
.
equ®s
(
obj
);

233 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.SchemaO±iÚsè
obj
;

235 
boŞ—n
 
	g»suÉ
 = 
Œue
;

236 
	g»suÉ
 = 
»suÉ
 && (
hasSecÚd¬yKey
(è=ğ
Ùh”
.hasSecondaryKey());

237 ià(
hasSecÚd¬yKey
()) {

238 
	g»suÉ
 = 
»suÉ
 && (
g‘SecÚd¬yKey
()

239 =ğ
Ùh”
.
g‘SecÚd¬yKey
());

241 
	g»suÉ
 = 
»suÉ
 && (
hasV”siÚ
(è=ğ
Ùh”
.hasVersion());

242 ià(
hasV”siÚ
()) {

243 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

244 =ğ
Ùh”
.
g‘V”siÚ
());

246 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

247  
	g»suÉ
;

250 @
	gjava
.
	gÏng
.
Ov”ride


251 
public
 
hashCode
() {

252 ià(
	gmemoizedHashCode
 != 0) {

253  
memoizedHashCode
;

255 
	ghash
 = 41;

256 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

257 ià(
hasSecÚd¬yKey
()) {

258 
	ghash
 = (37 * 
hash
è+ 
SECONDARY_KEY_FIELD_NUMBER
;

259 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

260 
g‘SecÚd¬yKey
());

262 ià(
hasV”siÚ
()) {

263 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

264 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

265 
g‘V”siÚ
());

267 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

268 
	gmemoizedHashCode
 = 
hash
;

269  
	ghash
;

272 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

273 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

274 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

275  
	gPARSER
.
·r£From
(
d©a
);

277 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

278 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

279 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

280 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

281  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

283 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(
by‹
[] 
d©a
)

284 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

285  
	gPARSER
.
·r£From
(
d©a
);

287 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

288 
by‹
[] 
d©a
,

289 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

290 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

291  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

293 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

294 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

295  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


296 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

298 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

299 
java
.
io
.
IÅutSŒ—m
 
šput
,

300 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

301 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

302  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


303 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

305 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

306 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

307  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


308 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

310 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£D–im™edFrom
(

311 
java
.
io
.
IÅutSŒ—m
 
šput
,

312 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

313 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

314  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


315 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

317 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

318 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

319 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

320  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


321 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

323 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
·r£From
(

324 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

325 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

326 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

327  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


328 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

331 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

332 
public
 
Bud”
 
ÃwBud”
() {

333  
	gDEFAULT_INSTANCE
.
toBud”
();

335 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
 
´ÙÙy³
) {

336  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

338 
public
 
Bud”
 
toBud”
() {

339  
	gthis
 =ğ
DEFAULT_INSTANCE


340 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

343 @
	gjava
.
	gÏng
.
Ov”ride


344 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

345 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

346 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

347  
	gbud”
;

356 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


357 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


359 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚsOrBud”
 {

360 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


361 
g‘DesütÜ
() {

362  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

365 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


366 
š‹º®G‘F›ldAcûssÜTabË
() {

367  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË


368 .
’su»F›ldAcûssÜsIn™Ÿlized
(

369 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
şass
, org.cÜfudb.ruÁime.CÜfuO±iÚs.SchemaO±iÚs.
Bud”
.class);

373 
´iv©e
 
Bud”
() {

374 
maybeFÜûBud”In™Ÿliz©iÚ
();

377 
´iv©e
 
Bud”
(

378 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

379 
su³r
(
·»Á
);

380 
maybeFÜûBud”In™Ÿliz©iÚ
();

382 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

383 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


384 .
	g®waysU£F›ldBud”s
) {

387 
public
 
Bud”
 
ş—r
() {

388 
	gsu³r
.
ş—r
();

389 
	g£cÚd¬yKey_
 = 
çl£
;

390 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

391 
	gv”siÚ_
 = 
çl£
;

392 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

393  
	gthis
;

396 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


397 
g‘DesütÜFÜTy³
() {

398  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

401 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

402  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
.
g‘DeçuÉIn¡ªû
();

405 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
bud
() {

406 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	g»suÉ
 = 
budP¬tŸl
();

407 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

408 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

410  
	g»suÉ
;

413 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
budP¬tŸl
() {

414 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.SchemaO±iÚs(
this
);

415 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

416 
	gto_b™F›ld0_
 = 0;

417 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

418 
to_b™F›ld0_
 |= 0x00000001;

420 
	g»suÉ
.
	g£cÚd¬yKey_
 = 
£cÚd¬yKey_
;

421 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

422 
to_b™F›ld0_
 |= 0x00000002;

424 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

425 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

426 
ÚBut
();

427  
	g»suÉ
;

430 
public
 
Bud”
 
şÚe
() {

431  (
	gBud”
è
	gsu³r
.
şÚe
();

433 
public
 
Bud”
 
£tF›ld
(

434 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

435 
Objeù
 
v®ue
) {

436  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

438 
public
 
Bud”
 
ş—rF›ld
(

439 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

440  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

442 
public
 
Bud”
 
ş—rOÃof
(

443 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

444  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

446 
public
 
Bud”
 
£tR•—‹dF›ld
(

447 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

448 
šdex
, 
Objeù
 
v®ue
) {

449  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

451 
public
 
Bud”
 
addR•—‹dF›ld
(

452 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

453 
Objeù
 
v®ue
) {

454  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

456 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

457 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
) {

458  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
)
Ùh”
);

460 
	gsu³r
.
m”geFrom
(
Ùh”
);

461  
	gthis
;

465 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
 
Ùh”
) {

466 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
g‘DeçuÉIn¡ªû
()è 
this
;

467 ià(
	gÙh”
.
hasSecÚd¬yKey
()) {

468 
£tSecÚd¬yKey
(
Ùh”
.
g‘SecÚd¬yKey
());

470 ià(
	gÙh”
.
hasV”siÚ
()) {

471 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

473 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

474 
ÚChªged
();

475  
	gthis
;

478 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

479  
	gŒue
;

482 
public
 
Bud”
 
m”geFrom
(

483 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

484 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

485 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

486 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	g·r£dMes§ge
 = 
nuÎ
;

487 
	gŒy
 {

488 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

489 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

490 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
è
e
.
g‘UnfšishedMes§ge
();

491 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

492 } 
	gfš®ly
 {

493 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

494 
m”geFrom
(
·r£dMes§ge
);

497  
	gthis
;

499 
´iv©e
 
	gb™F›ld0_
;

501 
´iv©e
 
boŞ—n
 
	g£cÚd¬yKey_
 ;

509 
public
 
boŞ—n
 
hasSecÚd¬yKey
() {

510  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

519 
public
 
boŞ—n
 
g‘SecÚd¬yKey
() {

520  
	g£cÚd¬yKey_
;

529 
public
 
Bud”
 
£tSecÚd¬yKey
(
boŞ—n
 
v®ue
) {

530 
	gb™F›ld0_
 |= 0x00000001;

531 
	g£cÚd¬yKey_
 = 
v®ue
;

532 
ÚChªged
();

533  
	gthis
;

542 
public
 
Bud”
 
ş—rSecÚd¬yKey
() {

543 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

544 
	g£cÚd¬yKey_
 = 
çl£
;

545 
ÚChªged
();

546  
	gthis
;

549 
´iv©e
 
boŞ—n
 
	gv”siÚ_
 ;

557 
public
 
boŞ—n
 
hasV”siÚ
() {

558  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

567 
public
 
boŞ—n
 
g‘V”siÚ
() {

568  
	gv”siÚ_
;

577 
public
 
Bud”
 
£tV”siÚ
(
boŞ—n
 
v®ue
) {

578 
	gb™F›ld0_
 |= 0x00000002;

579 
	gv”siÚ_
 = 
v®ue
;

580 
ÚChªged
();

581  
	gthis
;

590 
public
 
Bud”
 
ş—rV”siÚ
() {

591 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

592 
	gv”siÚ_
 = 
çl£
;

593 
ÚChªged
();

594  
	gthis
;

596 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

597 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

598  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

601 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

602 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

603  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

611 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
	gDEFAULT_INSTANCE
;

613 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
();

616 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
g‘DeçuÉIn¡ªû
() {

617  
	gDEFAULT_INSTANCE
;

620 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gSchemaO±iÚs
>

621 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
SchemaO±iÚs
>() {

622 
public
 
SchemaO±iÚs
 
·r£P¬tŸlFrom
(

623 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

624 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

625 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

626  
Ãw
 
SchemaO±iÚs
(
šput
, 
ex‹nsiÚRegi¡ry
);

630 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gSchemaO±iÚs
> 
·r£r
() {

631  
	gPARSER
;

634 @
	gjava
.
	gÏng
.
Ov”ride


635 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gSchemaO±iÚs
> 
g‘P¬£rFÜTy³
() {

636  
	gPARSER
;

639 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
SchemaO±iÚs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

640  
	gDEFAULT_INSTANCE
;

645 
public
 
fš®
 
	gSCHEMA_FIELD_NUMBER
 = 1036;

653 
public
 
fš®


654 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§ge
.
	gG’”©edEx‹nsiÚ
<

655 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gF›ldO±iÚs
,

656 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
	gSchemaO±iÚs
> 
	gschema
 = 
com
.
googË
.
´Ùobuf
.
G’”©edMes§ge


657 .
ÃwFeScİedG’”©edEx‹nsiÚ
(

658 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
şass
,

659 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
SchemaO±iÚs
.
g‘DeçuÉIn¡ªû
());

660 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


661 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
;

662 
´iv©e
 
fš®


663 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


664 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË
;

666 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


667 
	$g‘DesütÜ
() {

668  
desütÜ
;

669 
	}
}

670 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


671 
	gdesütÜ
;

673 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

681 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

682 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

683 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

684 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

685 
desütÜ
 = 
roÙ
;

686  
	gnuÎ
;

689 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


690 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

691 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

692 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
g‘DesütÜ
(),

693 }, 
assigÃr
);

694 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
 =

695 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

696 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_f›ldAcûssÜTabË
 = 
Ãw


697 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

698 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_SchemaO±iÚs_desütÜ
,

699 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "SecondaryKey", "Version", });

700 
	gschema
.
š‹º®In™
(
desütÜ
.
g‘Ex‹nsiÚs
().
g‘
(0));

701 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
g‘DesütÜ
();

	@test/target/generated-sources/org/corfudb/runtime/CorfuStoreMetadata.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
;

6 
public
 
fš®
 cÏs 
	cCÜfuStÜeM‘ad©a
 {

7 
´iv©e
 
	$CÜfuStÜeM‘ad©a
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
Time¡ampOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
g‘Epoch
();

29 
g‘Sequ’û
();

38 
public
 
fš®
 
şass
 
Time¡amp
 
ex‹nds


39 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


41 
	gTime¡ampOrBud”
 {

43 
´iv©e
 
Time¡amp
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

44 
su³r
(
bud”
);

46 
´iv©e
 
Time¡amp
() {

47 
	g•och_
 = 0L;

48 
	g£qu’û_
 = 0L;

51 @
	gjava
.
	gÏng
.
Ov”ride


52 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


53 
g‘UnknownF›lds
() {

54  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

56 
´iv©e
 
Time¡amp
(

57 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

58 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

59 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

60 
this
();

61 
	gmubË_b™F›ld0_
 = 0;

62 
	gŒy
 {

63 
boŞ—n
 
	gdÚe
 = 
çl£
;

64 !
	gdÚe
) {

65 
	gg
 = 
šput
.
»adTag
();

66 
	gg
) {

68 
dÚe
 = 
Œue
;

71 ià(!
šput
.
skF›ld
(
g
)) {

72 
dÚe
 = 
Œue
;

78 
•och_
 = 
šput
.
»adIÁ64
();

83 
£qu’û_
 = 
šput
.
»adIÁ64
();

88 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

89 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

90 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

91 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

92 
e
).
£tUnfšishedMes§ge
(
this
);

93 } 
	gfš®ly
 {

94 
makeEx‹nsiÚsImmubË
();

97 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


98 
g‘DesütÜ
() {

99  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

102 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


103 
š‹º®G‘F›ldAcûssÜTabË
() {

104  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË


105 .
’su»F›ldAcûssÜsIn™Ÿlized
(

106 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.Time¡amp.
Bud”
.class);

109 
public
 
fš®
 
	gEPOCH_FIELD_NUMBER
 = 1;

110 
´iv©e
 
	g•och_
;

114 
public
 
g‘Epoch
() {

115  
	g•och_
;

118 
public
 
fš®
 
	gSEQUENCE_FIELD_NUMBER
 = 2;

119 
´iv©e
 
	g£qu’û_
;

123 
public
 
g‘Sequ’û
() {

124  
	g£qu’û_
;

127 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

128 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

129 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

130 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

131 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

133 
	gmemoizedIsIn™Ÿlized
 = 1;

134  
	gŒue
;

137 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

138 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

139 ià(
	g•och_
 != 0L) {

140 
ouut
.
wr™eIÁ64
(1, 
•och_
);

142 ià(
	g£qu’û_
 != 0L) {

143 
ouut
.
wr™eIÁ64
(2, 
£qu’û_
);

147 
public
 
g‘S”ŸlizedSize
() {

148 
	gsize
 = 
memoizedSize
;

149 ià(
	gsize
 !ğ-1è 
size
;

151 
	gsize
 = 0;

152 ià(
	g•och_
 != 0L) {

153 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


154 .
compu‹IÁ64Size
(1, 
•och_
);

156 ià(
	g£qu’û_
 != 0L) {

157 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


158 .
compu‹IÁ64Size
(2, 
£qu’û_
);

160 
	gmemoizedSize
 = 
size
;

161  
	gsize
;

164 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

165 @
	gjava
.
	gÏng
.
Ov”ride


166 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

167 ià(
	gobj
 =ğ
this
) {

168  
Œue
;

170 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
)) {

171  
	gsu³r
.
equ®s
(
obj
);

173 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.Time¡ampè
obj
;

175 
boŞ—n
 
	g»suÉ
 = 
Œue
;

176 
	g»suÉ
 = 
»suÉ
 && (
g‘Epoch
()

177 =ğ
Ùh”
.
g‘Epoch
());

178 
	g»suÉ
 = 
»suÉ
 && (
g‘Sequ’û
()

179 =ğ
Ùh”
.
g‘Sequ’û
());

180  
	g»suÉ
;

183 @
	gjava
.
	gÏng
.
Ov”ride


184 
public
 
hashCode
() {

185 ià(
	gmemoizedHashCode
 != 0) {

186  
memoizedHashCode
;

188 
	ghash
 = 41;

189 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

190 
	ghash
 = (37 * 
hash
è+ 
EPOCH_FIELD_NUMBER
;

191 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

192 
g‘Epoch
());

193 
	ghash
 = (37 * 
hash
è+ 
SEQUENCE_FIELD_NUMBER
;

194 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

195 
g‘Sequ’û
());

196 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

197 
	gmemoizedHashCode
 = 
hash
;

198  
	ghash
;

201 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

202 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

203 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

204  
	gPARSER
.
·r£From
(
d©a
);

206 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

207 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

208 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

209 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

210  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

212 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(
by‹
[] 
d©a
)

213 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

214  
	gPARSER
.
·r£From
(
d©a
);

216 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

217 
by‹
[] 
d©a
,

218 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

219 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

220  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

222 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

223 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

224  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


225 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

227 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

228 
java
.
io
.
IÅutSŒ—m
 
šput
,

229 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

230 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

231  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


232 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

234 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

235 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

236  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


237 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

239 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£D–im™edFrom
(

240 
java
.
io
.
IÅutSŒ—m
 
šput
,

241 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

242 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

243  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


244 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

246 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

247 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

248 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

249  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


250 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

252 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
·r£From
(

253 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

254 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

255 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

256  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


257 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

260 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

261 
public
 
Bud”
 
ÃwBud”
() {

262  
	gDEFAULT_INSTANCE
.
toBud”
();

264 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
 
´ÙÙy³
) {

265  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

267 
public
 
Bud”
 
toBud”
() {

268  
	gthis
 =ğ
DEFAULT_INSTANCE


269 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

272 @
	gjava
.
	gÏng
.
Ov”ride


273 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

274 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

275 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

276  
	gbud”
;

285 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


286 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


288 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡ampOrBud”
 {

289 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


290 
g‘DesütÜ
() {

291  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

294 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


295 
š‹º®G‘F›ldAcûssÜTabË
() {

296  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË


297 .
’su»F›ldAcûssÜsIn™Ÿlized
(

298 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.Time¡amp.
Bud”
.class);

302 
´iv©e
 
Bud”
() {

303 
maybeFÜûBud”In™Ÿliz©iÚ
();

306 
´iv©e
 
Bud”
(

307 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

308 
su³r
(
·»Á
);

309 
maybeFÜûBud”In™Ÿliz©iÚ
();

311 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

312 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


313 .
	g®waysU£F›ldBud”s
) {

316 
public
 
Bud”
 
ş—r
() {

317 
	gsu³r
.
ş—r
();

318 
	g•och_
 = 0L;

320 
	g£qu’û_
 = 0L;

322  
	gthis
;

325 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


326 
g‘DesütÜFÜTy³
() {

327  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

330 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
g‘DeçuÉIn¡ªûFÜTy³
() {

331  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
.
g‘DeçuÉIn¡ªû
();

334 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
bud
() {

335 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	g»suÉ
 = 
budP¬tŸl
();

336 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

337 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

339  
	g»suÉ
;

342 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
budP¬tŸl
() {

343 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.Time¡amp(
this
);

344 
	g»suÉ
.
	g•och_
 = 
•och_
;

345 
	g»suÉ
.
	g£qu’û_
 = 
£qu’û_
;

346 
ÚBut
();

347  
	g»suÉ
;

350 
public
 
Bud”
 
şÚe
() {

351  (
	gBud”
è
	gsu³r
.
şÚe
();

353 
public
 
Bud”
 
£tF›ld
(

354 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

355 
Objeù
 
v®ue
) {

356  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

358 
public
 
Bud”
 
ş—rF›ld
(

359 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

360  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

362 
public
 
Bud”
 
ş—rOÃof
(

363 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

364  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

366 
public
 
Bud”
 
£tR•—‹dF›ld
(

367 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

368 
šdex
, 
Objeù
 
v®ue
) {

369  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

371 
public
 
Bud”
 
addR•—‹dF›ld
(

372 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

373 
Objeù
 
v®ue
) {

374  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

376 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

377 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTime¡amp
) {

378  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
)
Ùh”
);

380 
	gsu³r
.
m”geFrom
(
Ùh”
);

381  
	gthis
;

385 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
 
Ùh”
) {

386 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
.
g‘DeçuÉIn¡ªû
()è 
this
;

387 ià(
	gÙh”
.
g‘Epoch
() != 0L) {

388 
£tEpoch
(
Ùh”
.
g‘Epoch
());

390 ià(
	gÙh”
.
g‘Sequ’û
() != 0L) {

391 
£tSequ’û
(
Ùh”
.
g‘Sequ’û
());

393 
ÚChªged
();

394  
	gthis
;

397 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

398  
	gŒue
;

401 
public
 
Bud”
 
m”geFrom
(

402 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

403 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

404 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

405 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	g·r£dMes§ge
 = 
nuÎ
;

406 
	gŒy
 {

407 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

408 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

409 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
è
e
.
g‘UnfšishedMes§ge
();

410 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

411 } 
	gfš®ly
 {

412 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

413 
m”geFrom
(
·r£dMes§ge
);

416  
	gthis
;

419 
´iv©e
 
	g•och_
 ;

423 
public
 
g‘Epoch
() {

424  
	g•och_
;

429 
public
 
Bud”
 
£tEpoch
(
v®ue
) {

431 
	g•och_
 = 
v®ue
;

432 
ÚChªged
();

433  
	gthis
;

438 
public
 
Bud”
 
ş—rEpoch
() {

440 
	g•och_
 = 0L;

441 
ÚChªged
();

442  
	gthis
;

445 
´iv©e
 
	g£qu’û_
 ;

449 
public
 
g‘Sequ’û
() {

450  
	g£qu’û_
;

455 
public
 
Bud”
 
£tSequ’û
(
v®ue
) {

457 
	g£qu’û_
 = 
v®ue
;

458 
ÚChªged
();

459  
	gthis
;

464 
public
 
Bud”
 
ş—rSequ’û
() {

466 
	g£qu’û_
 = 0L;

467 
ÚChªged
();

468  
	gthis
;

470 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

471 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

472  
	gthis
;

475 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

476 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

477  
	gthis
;

485 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
	gDEFAULT_INSTANCE
;

487 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
Time¡amp
();

490 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
g‘DeçuÉIn¡ªû
() {

491  
	gDEFAULT_INSTANCE
;

494 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTime¡amp
>

495 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Time¡amp
>() {

496 
public
 
Time¡amp
 
·r£P¬tŸlFrom
(

497 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

498 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

499 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

500  
Ãw
 
Time¡amp
(
šput
, 
ex‹nsiÚRegi¡ry
);

504 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTime¡amp
> 
·r£r
() {

505  
	gPARSER
;

508 @
	gjava
.
	gÏng
.
Ov”ride


509 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTime¡amp
> 
g‘P¬£rFÜTy³
() {

510  
	gPARSER
;

513 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
Time¡amp
 
g‘DeçuÉIn¡ªûFÜTy³
() {

514  
	gDEFAULT_INSTANCE
;

519 
public
 
š‹rçû
 
TabËNameOrBud”
 
ex‹nds


521 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

526 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name¥aû
();

530 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


531 
g‘Name¥aûBy‹s
();

536 
	gjava
.
	gÏng
.
SŒšg
 
g‘TabËName
();

540 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


541 
g‘TabËNameBy‹s
();

550 
public
 
fš®
 
şass
 
TabËName
 
ex‹nds


551 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


553 
	gTabËNameOrBud”
 {

555 
´iv©e
 
TabËName
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

556 
su³r
(
bud”
);

558 
´iv©e
 
TabËName
() {

559 
	gÇme¥aû_
 = "";

560 
	gbËName_
 = "";

563 @
	gjava
.
	gÏng
.
Ov”ride


564 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


565 
g‘UnknownF›lds
() {

566  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

568 
´iv©e
 
TabËName
(

569 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

570 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

571 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

572 
this
();

573 
	gmubË_b™F›ld0_
 = 0;

574 
	gŒy
 {

575 
boŞ—n
 
	gdÚe
 = 
çl£
;

576 !
	gdÚe
) {

577 
	gg
 = 
šput
.
»adTag
();

578 
	gg
) {

580 
dÚe
 = 
Œue
;

583 ià(!
šput
.
skF›ld
(
g
)) {

584 
dÚe
 = 
Œue
;

589 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

591 
	gÇme¥aû_
 = 
s
;

595 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

597 
	gbËName_
 = 
s
;

602 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

603 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

604 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

605 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

606 
e
).
£tUnfšishedMes§ge
(
this
);

607 } 
	gfš®ly
 {

608 
makeEx‹nsiÚsImmubË
();

611 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


612 
g‘DesütÜ
() {

613  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

616 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


617 
š‹º®G‘F›ldAcûssÜTabË
() {

618  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË


619 .
’su»F›ldAcûssÜsIn™Ÿlized
(

620 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
Bud”
.class);

623 
public
 
fš®
 
	gNAMESPACE_FIELD_NUMBER
 = 1;

624 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gÇme¥aû_
;

628 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name¥aû
() {

629 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

630 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

631  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

633 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

634 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

635 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

636 
	gÇme¥aû_
 = 
s
;

637  
	gs
;

643 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


644 
g‘Name¥aûBy‹s
() {

645 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

646 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

647 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

648 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

649 (
java
.
Ïng
.
SŒšg
è
»f
);

650 
	gÇme¥aû_
 = 
b
;

651  
	gb
;

653  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

657 
public
 
fš®
 
	gTABLE_NAME_FIELD_NUMBER
 = 2;

658 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gbËName_
;

662 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘TabËName
() {

663 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

664 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

665  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

667 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

668 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

669 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

670 
	gbËName_
 = 
s
;

671  
	gs
;

677 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


678 
g‘TabËNameBy‹s
() {

679 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

680 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

681 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

682 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

683 (
java
.
Ïng
.
SŒšg
è
»f
);

684 
	gbËName_
 = 
b
;

685  
	gb
;

687  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

691 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

692 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

693 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

694 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

695 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

697 
	gmemoizedIsIn™Ÿlized
 = 1;

698  
	gŒue
;

701 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

702 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

703 ià(!
g‘Name¥aûBy‹s
().
isEm±y
()) {

704 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
Çme¥aû_
);

706 ià(!
g‘TabËNameBy‹s
().
isEm±y
()) {

707 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
bËName_
);

711 
public
 
g‘S”ŸlizedSize
() {

712 
	gsize
 = 
memoizedSize
;

713 ià(
	gsize
 !ğ-1è 
size
;

715 
	gsize
 = 0;

716 ià(!
g‘Name¥aûBy‹s
().
isEm±y
()) {

717 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
Çme¥aû_
);

719 ià(!
g‘TabËNameBy‹s
().
isEm±y
()) {

720 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
bËName_
);

722 
	gmemoizedSize
 = 
size
;

723  
	gsize
;

726 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

727 @
	gjava
.
	gÏng
.
Ov”ride


728 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

729 ià(
	gobj
 =ğ
this
) {

730  
Œue
;

732 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
)) {

733  
	gsu³r
.
equ®s
(
obj
);

735 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËNameè
obj
;

737 
boŞ—n
 
	g»suÉ
 = 
Œue
;

738 
	g»suÉ
 = 
»suÉ
 && 
g‘Name¥aû
()

739 .
equ®s
(
Ùh”
.
g‘Name¥aû
());

740 
	g»suÉ
 = 
»suÉ
 && 
g‘TabËName
()

741 .
equ®s
(
Ùh”
.
g‘TabËName
());

742  
	g»suÉ
;

745 @
	gjava
.
	gÏng
.
Ov”ride


746 
public
 
hashCode
() {

747 ià(
	gmemoizedHashCode
 != 0) {

748  
memoizedHashCode
;

750 
	ghash
 = 41;

751 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

752 
	ghash
 = (37 * 
hash
è+ 
NAMESPACE_FIELD_NUMBER
;

753 
	ghash
 = (53 * 
hash
è+ 
g‘Name¥aû
().
hashCode
();

754 
	ghash
 = (37 * 
hash
è+ 
TABLE_NAME_FIELD_NUMBER
;

755 
	ghash
 = (53 * 
hash
è+ 
g‘TabËName
().
hashCode
();

756 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

757 
	gmemoizedHashCode
 = 
hash
;

758  
	ghash
;

761 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

762 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

763 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

764  
	gPARSER
.
·r£From
(
d©a
);

766 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

767 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

768 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

769 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

770  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

772 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(
by‹
[] 
d©a
)

773 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

774  
	gPARSER
.
·r£From
(
d©a
);

776 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

777 
by‹
[] 
d©a
,

778 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

779 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

780  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

782 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

783 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

784  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


785 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

787 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

788 
java
.
io
.
IÅutSŒ—m
 
šput
,

789 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

790 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

791  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


792 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

794 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

795 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

796  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


797 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

799 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£D–im™edFrom
(

800 
java
.
io
.
IÅutSŒ—m
 
šput
,

801 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

802 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

803  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


804 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

806 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

807 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

808 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

809  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


810 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

812 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
·r£From
(

813 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

814 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

815 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

816  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


817 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

820 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

821 
public
 
Bud”
 
ÃwBud”
() {

822  
	gDEFAULT_INSTANCE
.
toBud”
();

824 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
´ÙÙy³
) {

825  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

827 
public
 
Bud”
 
toBud”
() {

828  
	gthis
 =ğ
DEFAULT_INSTANCE


829 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

832 @
	gjava
.
	gÏng
.
Ov”ride


833 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

834 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

835 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

836  
	gbud”
;

845 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


846 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


848 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËNameOrBud”
 {

849 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


850 
g‘DesütÜ
() {

851  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

854 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


855 
š‹º®G‘F›ldAcûssÜTabË
() {

856  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË


857 .
’su»F›ldAcûssÜsIn™Ÿlized
(

858 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
Bud”
.class);

862 
´iv©e
 
Bud”
() {

863 
maybeFÜûBud”In™Ÿliz©iÚ
();

866 
´iv©e
 
Bud”
(

867 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

868 
su³r
(
·»Á
);

869 
maybeFÜûBud”In™Ÿliz©iÚ
();

871 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

872 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


873 .
	g®waysU£F›ldBud”s
) {

876 
public
 
Bud”
 
ş—r
() {

877 
	gsu³r
.
ş—r
();

878 
	gÇme¥aû_
 = "";

880 
	gbËName_
 = "";

882  
	gthis
;

885 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


886 
g‘DesütÜFÜTy³
() {

887  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

890 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘DeçuÉIn¡ªûFÜTy³
() {

891  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
.
g‘DeçuÉIn¡ªû
();

894 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
bud
() {

895 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	g»suÉ
 = 
budP¬tŸl
();

896 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

897 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

899  
	g»suÉ
;

902 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
budP¬tŸl
() {

903 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËName(
this
);

904 
	g»suÉ
.
	gÇme¥aû_
 = 
Çme¥aû_
;

905 
	g»suÉ
.
	gbËName_
 = 
bËName_
;

906 
ÚBut
();

907  
	g»suÉ
;

910 
public
 
Bud”
 
şÚe
() {

911  (
	gBud”
è
	gsu³r
.
şÚe
();

913 
public
 
Bud”
 
£tF›ld
(

914 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

915 
Objeù
 
v®ue
) {

916  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

918 
public
 
Bud”
 
ş—rF›ld
(

919 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

920  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

922 
public
 
Bud”
 
ş—rOÃof
(

923 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

924  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

926 
public
 
Bud”
 
£tR•—‹dF›ld
(

927 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

928 
šdex
, 
Objeù
 
v®ue
) {

929  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

931 
public
 
Bud”
 
addR•—‹dF›ld
(

932 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

933 
Objeù
 
v®ue
) {

934  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

936 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

937 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
) {

938  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
)
Ùh”
);

940 
	gsu³r
.
m”geFrom
(
Ùh”
);

941  
	gthis
;

945 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
Ùh”
) {

946 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
()è 
this
;

947 ià(!
	gÙh”
.
g‘Name¥aû
().
isEm±y
()) {

948 
	gÇme¥aû_
 = 
Ùh”
.
Çme¥aû_
;

949 
ÚChªged
();

951 ià(!
	gÙh”
.
g‘TabËName
().
isEm±y
()) {

952 
	gbËName_
 = 
Ùh”
.
bËName_
;

953 
ÚChªged
();

955 
ÚChªged
();

956  
	gthis
;

959 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

960  
	gŒue
;

963 
public
 
Bud”
 
m”geFrom
(

964 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

965 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

966 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

967 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	g·r£dMes§ge
 = 
nuÎ
;

968 
	gŒy
 {

969 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

970 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

971 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
è
e
.
g‘UnfšishedMes§ge
();

972 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

973 } 
	gfš®ly
 {

974 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

975 
m”geFrom
(
·r£dMes§ge
);

978  
	gthis
;

981 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gÇme¥aû_
 = "";

985 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name¥aû
() {

986 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

987 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

988 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

989 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

990 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

991 
	gÇme¥aû_
 = 
s
;

992  
	gs
;

994  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1000 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1001 
g‘Name¥aûBy‹s
() {

1002 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme¥aû_
;

1003 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1004 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1005 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1006 (
java
.
Ïng
.
SŒšg
è
»f
);

1007 
	gÇme¥aû_
 = 
b
;

1008  
	gb
;

1010  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1016 
public
 
Bud”
 
£tName¥aû
(

1017 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1018 ià(
	gv®ue
 =ğ
nuÎ
) {

1019 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1022 
	gÇme¥aû_
 = 
v®ue
;

1023 
ÚChªged
();

1024  
	gthis
;

1029 
public
 
Bud”
 
ş—rName¥aû
() {

1031 
	gÇme¥aû_
 = 
g‘DeçuÉIn¡ªû
().
g‘Name¥aû
();

1032 
ÚChªged
();

1033  
	gthis
;

1038 
public
 
Bud”
 
£tName¥aûBy‹s
(

1039 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1040 ià(
	gv®ue
 =ğ
nuÎ
) {

1041 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1043 
checkBy‹SŒšgIsUtf8
(
v®ue
);

1045 
	gÇme¥aû_
 = 
v®ue
;

1046 
ÚChªged
();

1047  
	gthis
;

1050 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gbËName_
 = "";

1054 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘TabËName
() {

1055 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

1056 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

1057 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1058 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1059 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1060 
	gbËName_
 = 
s
;

1061  
	gs
;

1063  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1069 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1070 
g‘TabËNameBy‹s
() {

1071 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
bËName_
;

1072 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1073 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1074 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1075 (
java
.
Ïng
.
SŒšg
è
»f
);

1076 
	gbËName_
 = 
b
;

1077  
	gb
;

1079  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1085 
public
 
Bud”
 
£tTabËName
(

1086 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1087 ià(
	gv®ue
 =ğ
nuÎ
) {

1088 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1091 
	gbËName_
 = 
v®ue
;

1092 
ÚChªged
();

1093  
	gthis
;

1098 
public
 
Bud”
 
ş—rTabËName
() {

1100 
	gbËName_
 = 
g‘DeçuÉIn¡ªû
().
g‘TabËName
();

1101 
ÚChªged
();

1102  
	gthis
;

1107 
public
 
Bud”
 
£tTabËNameBy‹s
(

1108 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1109 ià(
	gv®ue
 =ğ
nuÎ
) {

1110 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1112 
checkBy‹SŒšgIsUtf8
(
v®ue
);

1114 
	gbËName_
 = 
v®ue
;

1115 
ÚChªged
();

1116  
	gthis
;

1118 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1119 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1120  
	gthis
;

1123 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1124 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1125  
	gthis
;

1133 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gDEFAULT_INSTANCE
;

1135 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
();

1138 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘DeçuÉIn¡ªû
() {

1139  
	gDEFAULT_INSTANCE
;

1142 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËName
>

1143 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TabËName
>() {

1144 
public
 
TabËName
 
·r£P¬tŸlFrom
(

1145 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1146 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1147 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1148  
Ãw
 
TabËName
(
šput
, 
ex‹nsiÚRegi¡ry
);

1152 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËName
> 
·r£r
() {

1153  
	gPARSER
;

1156 @
	gjava
.
	gÏng
.
Ov”ride


1157 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËName
> 
g‘P¬£rFÜTy³
() {

1158  
	gPARSER
;

1161 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1162  
	gDEFAULT_INSTANCE
;

1167 
public
 
š‹rçû
 
TabËDesütÜsOrBud”
 
ex‹nds


1169 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1179 
g‘FeDesütÜsCouÁ
();

1188 
boŞ—n
 
cÚšsFeDesütÜs
(

1189 
java
.
Ïng
.
SŒšg
 
key
);

1193 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1194 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1195 
g‘FeDesütÜs
();

1204 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1205 
g‘FeDesütÜsM­
();

1215 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrDeçuÉ
(

1216 
java
.
Ïng
.
SŒšg
 
key
,

1217 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
deçuÉV®ue
);

1227 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrThrow
(

1228 
java
.
Ïng
.
SŒšg
 
key
);

1237 
public
 
fš®
 
şass
 
TabËDesütÜs
 
ex‹nds


1238 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1240 
	gTabËDesütÜsOrBud”
 {

1242 
´iv©e
 
TabËDesütÜs
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1243 
su³r
(
bud”
);

1245 
´iv©e
 
TabËDesütÜs
() {

1248 @
	gjava
.
	gÏng
.
Ov”ride


1249 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1250 
g‘UnknownF›lds
() {

1251  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

1253 
´iv©e
 
TabËDesütÜs
(

1254 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1255 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1256 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1257 
this
();

1258 
	gmubË_b™F›ld0_
 = 0;

1259 
	gŒy
 {

1260 
boŞ—n
 
	gdÚe
 = 
çl£
;

1261 !
	gdÚe
) {

1262 
	gg
 = 
šput
.
»adTag
();

1263 
	gg
) {

1265 
dÚe
 = 
Œue
;

1268 ià(!
šput
.
skF›ld
(
g
)) {

1269 
dÚe
 = 
Œue
;

1274 ià(!((
mubË_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

1275 
feDesütÜs_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

1276 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1277 
	gmubË_b™F›ld0_
 |= 0x00000001;

1279 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1280 
	gfeDesütÜs__
 = 
šput
.
»adMes§ge
(

1281 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
g‘P¬£rFÜTy³
(), 
ex‹nsiÚRegi¡ry
);

1282 
	gfeDesütÜs_
.
g‘MubËM­
().
put
(

1283 
feDesütÜs__
.
g‘Key
(), feDesütÜs__.
g‘V®ue
());

1288 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1289 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

1290 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

1291 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

1292 
e
).
£tUnfšishedMes§ge
(
this
);

1293 } 
	gfš®ly
 {

1294 
makeEx‹nsiÚsImmubË
();

1297 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1298 
g‘DesütÜ
() {

1299  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

1302 @
Suµ»ssW¬nšgs
({"rawtypes"})

1303 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘M­F›ld
(

1304 
numb”
) {

1305 
	gnumb”
) {

1307  
š‹º®G‘FeDesütÜs
();

1309 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1310 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1313 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1314 
š‹º®G‘F›ldAcûssÜTabË
() {

1315  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË


1316 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1317 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËDesütÜs.
Bud”
.class);

1320 
public
 
fš®
 
	gFILEDESCRIPTORS_FIELD_NUMBER
 = 1;

1321 
´iv©e
 
fš®
 cÏs 
	cFeDesütÜsDeçuÉEÁryHŞd”
 {

1322 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­EÁry
<

1323 
	gjava
.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gdeçuÉEÁry
 =

1324 
com
.
googË
.
´Ùobuf
.
M­EÁry


1325 .<
java
.
Ïng
.
SŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>
ÃwDeçuÉIn¡ªû
(

1326 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
,

1327 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
STRING
,

1329 
com
.
googË
.
´Ùobuf
.
WœeFÜm©
.
F›ldTy³
.
MESSAGE
,

1330 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
.
g‘DeçuÉIn¡ªû
());

1332 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

1333 
	gjava
.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gfeDesütÜs_
;

1334 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1335 
š‹º®G‘FeDesütÜs
() {

1336 ià(
	gfeDesütÜs_
 =ğ
nuÎ
) {

1337  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

1338 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1340  
	gfeDesütÜs_
;

1343 
public
 
g‘FeDesütÜsCouÁ
() {

1344  
š‹º®G‘FeDesütÜs
().
g‘M­
().
size
();

1355 
public
 
boŞ—n
 
cÚšsFeDesütÜs
(

1356 
java
.
Ïng
.
SŒšg
 
key
) {

1357 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1358  
š‹º®G‘FeDesütÜs
().
g‘M­
().
cÚšsKey
(
key
);

1363 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1364 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜs
() {

1365  
g‘FeDesütÜsM­
();

1376 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜsM­
() {

1377  
š‹º®G‘FeDesütÜs
().
g‘M­
();

1388 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrDeçuÉ
(

1389 
java
.
Ïng
.
SŒšg
 
key
,

1390 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
deçuÉV®ue
) {

1391 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1392 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1393 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1394  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

1405 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrThrow
(

1406 
java
.
Ïng
.
SŒšg
 
key
) {

1407 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1408 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1409 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1410 ià(!
	gm­
.
cÚšsKey
(
key
)) {

1411 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

1413  
	gm­
.
g‘
(
key
);

1416 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

1417 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1418 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

1419 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

1420 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

1422 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
	g™em
 : 
g‘FeDesütÜsM­
().
v®ues
()) {

1423 ià(!
™em
.
isIn™Ÿlized
()) {

1424 
memoizedIsIn™Ÿlized
 = 0;

1425  
	gçl£
;

1428 
	gmemoizedIsIn™Ÿlized
 = 1;

1429  
	gŒue
;

1432 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

1433 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1434 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1435 .
£rŸlizeSŒšgM­To
(

1436 
ouut
,

1437 
š‹º®G‘FeDesütÜs
(),

1438 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
,

1442 
public
 
g‘S”ŸlizedSize
() {

1443 
	gsize
 = 
memoizedSize
;

1444 ià(
	gsize
 !ğ-1è 
size
;

1446 
	gsize
 = 0;

1447 
	gjava
.
	gut
.
	gM­
.
	gEÁry
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	g’Œy


1448 : 
š‹º®G‘FeDesütÜs
().
g‘M­
().
’ŒyS‘
()) {

1449 
com
.
googË
.
´Ùobuf
.
M­EÁry
<
java
.
Ïng
.
SŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1450 
	gfeDesütÜs__
 = 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
.
ÃwBud”FÜTy³
()

1451 .
£tKey
(
’Œy
.
g‘Key
())

1452 .
£tV®ue
(
’Œy
.
g‘V®ue
())

1453 .
bud
();

1454 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1455 .
compu‹Mes§geSize
(1, 
feDesütÜs__
);

1457 
	gmemoizedSize
 = 
size
;

1458  
	gsize
;

1461 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

1462 @
	gjava
.
	gÏng
.
Ov”ride


1463 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

1464 ià(
	gobj
 =ğ
this
) {

1465  
Œue
;

1467 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
)) {

1468  
	gsu³r
.
equ®s
(
obj
);

1470 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËDesütÜsè
obj
;

1472 
boŞ—n
 
	g»suÉ
 = 
Œue
;

1473 
	g»suÉ
 = 
»suÉ
 && 
š‹º®G‘FeDesütÜs
().
equ®s
(

1474 
Ùh”
.
š‹º®G‘FeDesütÜs
());

1475  
	g»suÉ
;

1478 @
	gjava
.
	gÏng
.
Ov”ride


1479 
public
 
hashCode
() {

1480 ià(
	gmemoizedHashCode
 != 0) {

1481  
memoizedHashCode
;

1483 
	ghash
 = 41;

1484 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

1485 ià(!
š‹º®G‘FeDesütÜs
().
g‘M­
().
isEm±y
()) {

1486 
	ghash
 = (37 * 
hash
è+ 
FILEDESCRIPTORS_FIELD_NUMBER
;

1487 
	ghash
 = (53 * 
hash
è+ 
š‹º®G‘FeDesütÜs
().
hashCode
();

1489 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

1490 
	gmemoizedHashCode
 = 
hash
;

1491  
	ghash
;

1494 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1495 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

1496 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1497  
	gPARSER
.
·r£From
(
d©a
);

1499 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1500 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

1501 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1502 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1503  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1505 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(
by‹
[] 
d©a
)

1506 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1507  
	gPARSER
.
·r£From
(
d©a
);

1509 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1510 
by‹
[] 
d©a
,

1511 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1512 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1513  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1515 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1516 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1517  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1518 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1520 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1521 
java
.
io
.
IÅutSŒ—m
 
šput
,

1522 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1523 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1524  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1525 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1527 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1528 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1529  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1530 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

1532 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£D–im™edFrom
(

1533 
java
.
io
.
IÅutSŒ—m
 
šput
,

1534 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1535 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1536  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1537 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1539 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1540 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

1541 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1542  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1543 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1545 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
·r£From
(

1546 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1547 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1548 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1549  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1550 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1553 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

1554 
public
 
Bud”
 
ÃwBud”
() {

1555  
	gDEFAULT_INSTANCE
.
toBud”
();

1557 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
´ÙÙy³
) {

1558  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

1560 
public
 
Bud”
 
toBud”
() {

1561  
	gthis
 =ğ
DEFAULT_INSTANCE


1562 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1565 @
	gjava
.
	gÏng
.
Ov”ride


1566 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1567 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1568 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1569  
	gbud”
;

1578 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1579 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1581 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜsOrBud”
 {

1582 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1583 
g‘DesütÜ
() {

1584  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

1587 @
Suµ»ssW¬nšgs
({"rawtypes"})

1588 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘M­F›ld
(

1589 
numb”
) {

1590 
	gnumb”
) {

1592  
š‹º®G‘FeDesütÜs
();

1594 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1595 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1598 @
Suµ»ssW¬nšgs
({"rawtypes"})

1599 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
M­F›ld
 
š‹º®G‘MubËM­F›ld
(

1600 
numb”
) {

1601 
	gnumb”
) {

1603  
š‹º®G‘MubËFeDesütÜs
();

1605 
throw
 
Ãw
 
RuÁimeExû±iÚ
(

1606 "Inv®id m­ f›ld‚umb”: " + 
numb”
);

1609 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1610 
š‹º®G‘F›ldAcûssÜTabË
() {

1611  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË


1612 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1613 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËDesütÜs.
Bud”
.class);

1617 
´iv©e
 
Bud”
() {

1618 
maybeFÜûBud”In™Ÿliz©iÚ
();

1621 
´iv©e
 
Bud”
(

1622 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1623 
su³r
(
·»Á
);

1624 
maybeFÜûBud”In™Ÿliz©iÚ
();

1626 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1627 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1628 .
	g®waysU£F›ldBud”s
) {

1631 
public
 
Bud”
 
ş—r
() {

1632 
	gsu³r
.
ş—r
();

1633 
š‹º®G‘MubËFeDesütÜs
().
ş—r
();

1634  
	gthis
;

1637 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1638 
g‘DesütÜFÜTy³
() {

1639  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

1642 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1643  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
.
g‘DeçuÉIn¡ªû
();

1646 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
bud
() {

1647 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	g»suÉ
 = 
budP¬tŸl
();

1648 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1649 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1651  
	g»suÉ
;

1654 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
budP¬tŸl
() {

1655 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËDesütÜs(
this
);

1656 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

1657 
	g»suÉ
.
	gfeDesütÜs_
 = 
š‹º®G‘FeDesütÜs
();

1658 
	g»suÉ
.
	gfeDesütÜs_
.
makeImmubË
();

1659 
ÚBut
();

1660  
	g»suÉ
;

1663 
public
 
Bud”
 
şÚe
() {

1664  (
	gBud”
è
	gsu³r
.
şÚe
();

1666 
public
 
Bud”
 
£tF›ld
(

1667 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1668 
Objeù
 
v®ue
) {

1669  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1671 
public
 
Bud”
 
ş—rF›ld
(

1672 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1673  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1675 
public
 
Bud”
 
ş—rOÃof
(

1676 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1677  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1679 
public
 
Bud”
 
£tR•—‹dF›ld
(

1680 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1681 
šdex
, 
Objeù
 
v®ue
) {

1682  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1684 
public
 
Bud”
 
addR•—‹dF›ld
(

1685 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1686 
Objeù
 
v®ue
) {

1687  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1689 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1690 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËDesütÜs
) {

1691  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
)
Ùh”
);

1693 
	gsu³r
.
m”geFrom
(
Ùh”
);

1694  
	gthis
;

1698 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
Ùh”
) {

1699 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
.
g‘DeçuÉIn¡ªû
()è 
this
;

1700 
š‹º®G‘MubËFeDesütÜs
().
m”geFrom
(

1701 
Ùh”
.
š‹º®G‘FeDesütÜs
());

1702 
ÚChªged
();

1703  
	gthis
;

1706 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1707 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
	g™em
 : 
g‘FeDesütÜsM­
().
v®ues
()) {

1708 ià(!
™em
.
isIn™Ÿlized
()) {

1709  
çl£
;

1712  
	gŒue
;

1715 
public
 
Bud”
 
m”geFrom
(

1716 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1717 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1718 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1719 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	g·r£dMes§ge
 = 
nuÎ
;

1720 
	gŒy
 {

1721 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1722 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1723 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
è
e
.
g‘UnfšishedMes§ge
();

1724 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1725 } 
	gfš®ly
 {

1726 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1727 
m”geFrom
(
·r£dMes§ge
);

1730  
	gthis
;

1732 
´iv©e
 
	gb™F›ld0_
;

1734 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<

1735 
	gjava
.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gfeDesütÜs_
;

1736 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1737 
š‹º®G‘FeDesütÜs
() {

1738 ià(
	gfeDesütÜs_
 =ğ
nuÎ
) {

1739  
com
.
googË
.
´Ùobuf
.
M­F›ld
.
em±yM­F›ld
(

1740 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1742  
	gfeDesütÜs_
;

1744 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gM­F›ld
<
	gjava
.
	gÏng
.
	gSŒšg
, com.googË.´Ùobuf.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1745 
š‹º®G‘MubËFeDesütÜs
() {

1746 
ÚChªged
();;

1747 ià(
	gfeDesütÜs_
 =ğ
nuÎ
) {

1748 
feDesütÜs_
 = 
com
.
googË
.
´Ùobuf
.
M­F›ld
.
ÃwM­F›ld
(

1749 
FeDesütÜsDeçuÉEÁryHŞd”
.
deçuÉEÁry
);

1751 ià(!
	gfeDesütÜs_
.
isMubË
()) {

1752 
	gfeDesütÜs_
 = 
feDesütÜs_
.
cİy
();

1754  
	gfeDesütÜs_
;

1757 
public
 
g‘FeDesütÜsCouÁ
() {

1758  
š‹º®G‘FeDesütÜs
().
g‘M­
().
size
();

1769 
public
 
boŞ—n
 
cÚšsFeDesütÜs
(

1770 
java
.
Ïng
.
SŒšg
 
key
) {

1771 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1772  
š‹º®G‘FeDesütÜs
().
g‘M­
().
cÚšsKey
(
key
);

1777 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1778 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜs
() {

1779  
g‘FeDesütÜsM­
();

1790 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
g‘FeDesütÜsM­
() {

1791  
š‹º®G‘FeDesütÜs
().
g‘M­
();

1802 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrDeçuÉ
(

1803 
java
.
Ïng
.
SŒšg
 
key
,

1804 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
deçuÉV®ue
) {

1805 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1806 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1807 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1808  
	gm­
.
cÚšsKey
(
key
è? m­.
g‘
(keyè: 
deçuÉV®ue
;

1819 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
FeDesütÜPrÙo
 
g‘FeDesütÜsOrThrow
(

1820 
java
.
Ïng
.
SŒšg
 
key
) {

1821 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1822 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
> 
	gm­
 =

1823 
š‹º®G‘FeDesütÜs
().
g‘M­
();

1824 ià(!
	gm­
.
cÚšsKey
(
key
)) {

1825 
throw
 
Ãw
 
	gjava
.
	gÏng
.
IÎeg®Argum’tExû±iÚ
();

1827  
	gm­
.
g‘
(
key
);

1830 
public
 
Bud”
 
ş—rFeDesütÜs
() {

1831 
g‘MubËFeDesütÜs
().
ş—r
();

1832  
	gthis
;

1843 
public
 
Bud”
 
»moveFeDesütÜs
(

1844 
java
.
Ïng
.
SŒšg
 
key
) {

1845 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1846 
g‘MubËFeDesütÜs
().
»move
(
key
);

1847  
	gthis
;

1852 @
	gjava
.
	gÏng
.
D•»ÿ‹d


1853 
public
 
	gjava
.
	gut
.
	gM­
<java.
	gÏng
.
	gSŒšg
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gFeDesütÜPrÙo
>

1854 
g‘MubËFeDesütÜs
() {

1855  
š‹º®G‘MubËFeDesütÜs
().
g‘MubËM­
();

1865 
public
 
Bud”
 
putFeDesütÜs
(

1866 
java
.
Ïng
.
SŒšg
 
key
,

1867 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
 
v®ue
) {

1868 ià(
	gkey
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1869 ià(
	gv®ue
 =ğ
nuÎ
è{ 
throw
 
Ãw
 
java
.
Ïng
.
NuÎPoš‹rExû±iÚ
(); }

1870 
g‘MubËFeDesütÜs
().
put
(
key
, 
v®ue
);

1871  
	gthis
;

1882 
public
 
Bud”
 
putAÎFeDesütÜs
(

1883 
java
.
ut
.
M­
<java.
Ïng
.
SŒšg
, 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
FeDesütÜPrÙo
> 
v®ues
) {

1884 
g‘MubËFeDesütÜs
().
putAÎ
(
v®ues
);

1885  
	gthis
;

1887 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1888 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1889  
	gthis
;

1892 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1893 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1894  
	gthis
;

1902 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
	gDEFAULT_INSTANCE
;

1904 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËDesütÜs
();

1907 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
g‘DeçuÉIn¡ªû
() {

1908  
	gDEFAULT_INSTANCE
;

1911 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËDesütÜs
>

1912 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TabËDesütÜs
>() {

1913 
public
 
TabËDesütÜs
 
·r£P¬tŸlFrom
(

1914 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1915 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1916 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1917  
Ãw
 
TabËDesütÜs
(
šput
, 
ex‹nsiÚRegi¡ry
);

1921 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËDesütÜs
> 
·r£r
() {

1922  
	gPARSER
;

1925 @
	gjava
.
	gÏng
.
Ov”ride


1926 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËDesütÜs
> 
g‘P¬£rFÜTy³
() {

1927  
	gPARSER
;

1930 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËDesütÜs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1931  
	gDEFAULT_INSTANCE
;

1936 
public
 
š‹rçû
 
TabËM‘ad©aOrBud”
 
ex‹nds


1938 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1943 
boŞ—n
 
hasTabËName
();

1947 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘TabËName
();

1951 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËNameOrBud”
 
g‘TabËNameOrBud”
();

1960 
boŞ—n
 
g‘DiskBa£d
();

1969 
boŞ—n
 
g‘Cache
();

1978 
public
 
fš®
 
şass
 
TabËM‘ad©a
 
ex‹nds


1979 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1981 
	gTabËM‘ad©aOrBud”
 {

1983 
´iv©e
 
TabËM‘ad©a
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1984 
su³r
(
bud”
);

1986 
´iv©e
 
TabËM‘ad©a
() {

1987 
	gdiskBa£d_
 = 
çl£
;

1988 
	gÿche_
 = 
çl£
;

1991 @
	gjava
.
	gÏng
.
Ov”ride


1992 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1993 
g‘UnknownF›lds
() {

1994  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

1996 
´iv©e
 
TabËM‘ad©a
(

1997 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1998 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1999 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2000 
this
();

2001 
	gmubË_b™F›ld0_
 = 0;

2002 
	gŒy
 {

2003 
boŞ—n
 
	gdÚe
 = 
çl£
;

2004 !
	gdÚe
) {

2005 
	gg
 = 
šput
.
»adTag
();

2006 
	gg
) {

2008 
dÚe
 = 
Œue
;

2011 ià(!
šput
.
skF›ld
(
g
)) {

2012 
dÚe
 = 
Œue
;

2017 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
Bud”
 
subBud”
 = 
nuÎ
;

2018 ià(
	gbËName_
 !ğ
nuÎ
) {

2019 
subBud”
 = 
bËName_
.
toBud”
();

2021 
	gbËName_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

2022 ià(
	gsubBud”
 !ğ
nuÎ
) {

2023 
subBud”
.
m”geFrom
(
bËName_
);

2024 
	gbËName_
 = 
subBud”
.
budP¬tŸl
();

2031 
diskBa£d_
 = 
šput
.
»adBoŞ
();

2036 
ÿche_
 = 
šput
.
»adBoŞ
();

2041 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2042 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

2043 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

2044 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

2045 
e
).
£tUnfšishedMes§ge
(
this
);

2046 } 
	gfš®ly
 {

2047 
makeEx‹nsiÚsImmubË
();

2050 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2051 
g‘DesütÜ
() {

2052  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

2055 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2056 
š‹º®G‘F›ldAcûssÜTabË
() {

2057  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË


2058 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2059 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËM‘ad©a.
Bud”
.class);

2062 
public
 
fš®
 
	gTABLE_NAME_FIELD_NUMBER
 = 1;

2063 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gbËName_
;

2067 
public
 
boŞ—n
 
hasTabËName
() {

2068  
	gbËName_
 !ğ
nuÎ
;

2073 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘TabËName
() {

2074  
	gbËName_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
(è: 
bËName_
;

2079 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËNameOrBud”
 
g‘TabËNameOrBud”
() {

2080  
g‘TabËName
();

2083 
public
 
fš®
 
	gDISK_BASED_FIELD_NUMBER
 = 2;

2084 
´iv©e
 
boŞ—n
 
	gdiskBa£d_
;

2092 
public
 
boŞ—n
 
g‘DiskBa£d
() {

2093  
	gdiskBa£d_
;

2096 
public
 
fš®
 
	gCACHE_FIELD_NUMBER
 = 3;

2097 
´iv©e
 
boŞ—n
 
	gÿche_
;

2105 
public
 
boŞ—n
 
g‘Cache
() {

2106  
	gÿche_
;

2109 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

2110 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2111 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

2112 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

2113 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

2115 
	gmemoizedIsIn™Ÿlized
 = 1;

2116  
	gŒue
;

2119 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

2120 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2121 ià(
	gbËName_
 !ğ
nuÎ
) {

2122 
ouut
.
wr™eMes§ge
(1, 
g‘TabËName
());

2124 ià(
	gdiskBa£d_
 !ğ
çl£
) {

2125 
ouut
.
wr™eBoŞ
(2, 
diskBa£d_
);

2127 ià(
	gÿche_
 !ğ
çl£
) {

2128 
ouut
.
wr™eBoŞ
(3, 
ÿche_
);

2132 
public
 
g‘S”ŸlizedSize
() {

2133 
	gsize
 = 
memoizedSize
;

2134 ià(
	gsize
 !ğ-1è 
size
;

2136 
	gsize
 = 0;

2137 ià(
	gbËName_
 !ğ
nuÎ
) {

2138 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2139 .
compu‹Mes§geSize
(1, 
g‘TabËName
());

2141 ià(
	gdiskBa£d_
 !ğ
çl£
) {

2142 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2143 .
compu‹BoŞSize
(2, 
diskBa£d_
);

2145 ià(
	gÿche_
 !ğ
çl£
) {

2146 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2147 .
compu‹BoŞSize
(3, 
ÿche_
);

2149 
	gmemoizedSize
 = 
size
;

2150  
	gsize
;

2153 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

2154 @
	gjava
.
	gÏng
.
Ov”ride


2155 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

2156 ià(
	gobj
 =ğ
this
) {

2157  
Œue
;

2159 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©a
)) {

2160  
	gsu³r
.
equ®s
(
obj
);

2162 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËM‘ad©aè
obj
;

2164 
boŞ—n
 
	g»suÉ
 = 
Œue
;

2165 
	g»suÉ
 = 
»suÉ
 && (
hasTabËName
(è=ğ
Ùh”
.hasTableName());

2166 ià(
hasTabËName
()) {

2167 
	g»suÉ
 = 
»suÉ
 && 
g‘TabËName
()

2168 .
equ®s
(
Ùh”
.
g‘TabËName
());

2170 
	g»suÉ
 = 
»suÉ
 && (
g‘DiskBa£d
()

2171 =ğ
Ùh”
.
g‘DiskBa£d
());

2172 
	g»suÉ
 = 
»suÉ
 && (
g‘Cache
()

2173 =ğ
Ùh”
.
g‘Cache
());

2174  
	g»suÉ
;

2177 @
	gjava
.
	gÏng
.
Ov”ride


2178 
public
 
hashCode
() {

2179 ià(
	gmemoizedHashCode
 != 0) {

2180  
memoizedHashCode
;

2182 
	ghash
 = 41;

2183 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

2184 ià(
hasTabËName
()) {

2185 
	ghash
 = (37 * 
hash
è+ 
TABLE_NAME_FIELD_NUMBER
;

2186 
	ghash
 = (53 * 
hash
è+ 
g‘TabËName
().
hashCode
();

2188 
	ghash
 = (37 * 
hash
è+ 
DISK_BASED_FIELD_NUMBER
;

2189 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

2190 
g‘DiskBa£d
());

2191 
	ghash
 = (37 * 
hash
è+ 
CACHE_FIELD_NUMBER
;

2192 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

2193 
g‘Cache
());

2194 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

2195 
	gmemoizedHashCode
 = 
hash
;

2196  
	ghash
;

2199 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2200 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

2201 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2202  
	gPARSER
.
·r£From
(
d©a
);

2204 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2205 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

2206 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2207 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2208  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2210 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(
by‹
[] 
d©a
)

2211 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2212  
	gPARSER
.
·r£From
(
d©a
);

2214 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2215 
by‹
[] 
d©a
,

2216 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2217 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2218  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2220 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2221 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2222  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2223 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2225 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2226 
java
.
io
.
IÅutSŒ—m
 
šput
,

2227 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2228 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2229  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2230 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2232 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2233 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2234  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2235 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

2237 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£D–im™edFrom
(

2238 
java
.
io
.
IÅutSŒ—m
 
šput
,

2239 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2240 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2241  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2242 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2244 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2245 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2246 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2247  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2248 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2250 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
·r£From
(

2251 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2252 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2253 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2254  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2255 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2258 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2259 
public
 
Bud”
 
ÃwBud”
() {

2260  
	gDEFAULT_INSTANCE
.
toBud”
();

2262 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
´ÙÙy³
) {

2263  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2265 
public
 
Bud”
 
toBud”
() {

2266  
	gthis
 =ğ
DEFAULT_INSTANCE


2267 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2270 @
	gjava
.
	gÏng
.
Ov”ride


2271 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2272 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2273 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2274  
	gbud”
;

2283 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


2284 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


2286 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©aOrBud”
 {

2287 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2288 
g‘DesütÜ
() {

2289  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

2292 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2293 
š‹º®G‘F›ldAcûssÜTabË
() {

2294  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË


2295 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2296 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËM‘ad©a.
Bud”
.class);

2300 
´iv©e
 
Bud”
() {

2301 
maybeFÜûBud”In™Ÿliz©iÚ
();

2304 
´iv©e
 
Bud”
(

2305 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2306 
su³r
(
·»Á
);

2307 
maybeFÜûBud”In™Ÿliz©iÚ
();

2309 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

2310 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2311 .
	g®waysU£F›ldBud”s
) {

2314 
public
 
Bud”
 
ş—r
() {

2315 
	gsu³r
.
ş—r
();

2316 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2317 
bËName_
 = 
nuÎ
;

2319 
	gbËName_
 = 
nuÎ
;

2320 
	gbËNameBud”_
 = 
nuÎ
;

2322 
	gdiskBa£d_
 = 
çl£
;

2324 
	gÿche_
 = 
çl£
;

2326  
	gthis
;

2329 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2330 
g‘DesütÜFÜTy³
() {

2331  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

2334 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2335  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©a
.
g‘DeçuÉIn¡ªû
();

2338 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
bud
() {

2339 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	g»suÉ
 = 
budP¬tŸl
();

2340 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

2341 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

2343  
	g»suÉ
;

2346 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
budP¬tŸl
() {

2347 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.TabËM‘ad©a(
this
);

2348 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2349 
»suÉ
.
bËName_
 =ableName_;

2351 
	g»suÉ
.
	gbËName_
 = 
bËNameBud”_
.
bud
();

2353 
	g»suÉ
.
	gdiskBa£d_
 = 
diskBa£d_
;

2354 
	g»suÉ
.
	gÿche_
 = 
ÿche_
;

2355 
ÚBut
();

2356  
	g»suÉ
;

2359 
public
 
Bud”
 
şÚe
() {

2360  (
	gBud”
è
	gsu³r
.
şÚe
();

2362 
public
 
Bud”
 
£tF›ld
(

2363 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2364 
Objeù
 
v®ue
) {

2365  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

2367 
public
 
Bud”
 
ş—rF›ld
(

2368 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

2369  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

2371 
public
 
Bud”
 
ş—rOÃof
(

2372 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

2373  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

2375 
public
 
Bud”
 
£tR•—‹dF›ld
(

2376 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2377 
šdex
, 
Objeù
 
v®ue
) {

2378  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

2380 
public
 
Bud”
 
addR•—‹dF›ld
(

2381 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2382 
Objeù
 
v®ue
) {

2383  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

2385 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

2386 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËM‘ad©a
) {

2387  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
)
Ùh”
);

2389 
	gsu³r
.
m”geFrom
(
Ùh”
);

2390  
	gthis
;

2394 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
Ùh”
) {

2395 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
.
g‘DeçuÉIn¡ªû
()è 
this
;

2396 ià(
	gÙh”
.
hasTabËName
()) {

2397 
m”geTabËName
(
Ùh”
.
g‘TabËName
());

2399 ià(
	gÙh”
.
g‘DiskBa£d
(è!ğ
çl£
) {

2400 
£tDiskBa£d
(
Ùh”
.
g‘DiskBa£d
());

2402 ià(
	gÙh”
.
g‘Cache
(è!ğ
çl£
) {

2403 
£tCache
(
Ùh”
.
g‘Cache
());

2405 
ÚChªged
();

2406  
	gthis
;

2409 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2410  
	gŒue
;

2413 
public
 
Bud”
 
m”geFrom
(

2414 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2415 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2416 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2417 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	g·r£dMes§ge
 = 
nuÎ
;

2418 
	gŒy
 {

2419 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

2420 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2421 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
è
e
.
g‘UnfšishedMes§ge
();

2422 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

2423 } 
	gfš®ly
 {

2424 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

2425 
m”geFrom
(
·r£dMes§ge
);

2428  
	gthis
;

2431 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
	gbËName_
 = 
nuÎ
;

2432 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

2433 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
	gBud”
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.
	gTabËNameOrBud”
> 
	gbËNameBud”_
;

2437 
public
 
boŞ—n
 
hasTabËName
() {

2438  
	gbËNameBud”_
 !ğ
nuÎ
 || 
bËName_
 !=‚ull;

2443 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËName
 
g‘TabËName
() {

2444 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2445  
bËName_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
() :ableName_;

2447  
	gbËNameBud”_
.
g‘Mes§ge
();

2453 
public
 
Bud”
 
£tTabËName
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
v®ue
) {

2454 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2455 ià(
v®ue
 =ğ
nuÎ
) {

2456 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2458 
	gbËName_
 = 
v®ue
;

2459 
ÚChªged
();

2461 
	gbËNameBud”_
.
£tMes§ge
(
v®ue
);

2464  
	gthis
;

2469 
public
 
Bud”
 
£tTabËName
(

2470 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
Bud”
 
bud”FÜV®ue
) {

2471 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2472 
bËName_
 = 
bud”FÜV®ue
.
bud
();

2473 
ÚChªged
();

2475 
	gbËNameBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

2478  
	gthis
;

2483 
public
 
Bud”
 
m”geTabËName
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
 
v®ue
) {

2484 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2485 ià(
bËName_
 !ğ
nuÎ
) {

2486 
bËName_
 =

2487 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
ÃwBud”
(
bËName_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

2489 
	gbËName_
 = 
v®ue
;

2491 
ÚChªged
();

2493 
	gbËNameBud”_
.
m”geFrom
(
v®ue
);

2496  
	gthis
;

2501 
public
 
Bud”
 
ş—rTabËName
() {

2502 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2503 
bËName_
 = 
nuÎ
;

2504 
ÚChªged
();

2506 
	gbËName_
 = 
nuÎ
;

2507 
	gbËNameBud”_
 = 
nuÎ
;

2510  
	gthis
;

2515 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
.
Bud”
 
g‘TabËNameBud”
() {

2517 
ÚChªged
();

2518  
g‘TabËNameF›ldBud”
().
g‘Bud”
();

2523 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËNameOrBud”
 
g‘TabËNameOrBud”
() {

2524 ià(
	gbËNameBud”_
 !ğ
nuÎ
) {

2525  
bËNameBud”_
.
g‘Mes§geOrBud”
();

2527  
	gbËName_
 =ğ
nuÎ
 ?

2528 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
.
g‘DeçuÉIn¡ªû
(è: 
bËName_
;

2534 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

2535 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.TabËName.
	gBud”
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.
	gTabËNameOrBud”
>

2536 
g‘TabËNameF›ldBud”
() {

2537 ià(
	gbËNameBud”_
 =ğ
nuÎ
) {

2538 
bËNameBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

2539 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËName
, 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gTabËName
.
	gBud”
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.
	gTabËNameOrBud”
>(

2540 
g‘TabËName
(),

2541 
g‘P¬’tFÜChd»n
(),

2542 
isCËª
());

2543 
	gbËName_
 = 
nuÎ
;

2545  
	gbËNameBud”_
;

2548 
´iv©e
 
boŞ—n
 
	gdiskBa£d_
 ;

2556 
public
 
boŞ—n
 
g‘DiskBa£d
() {

2557  
	gdiskBa£d_
;

2566 
public
 
Bud”
 
£tDiskBa£d
(
boŞ—n
 
v®ue
) {

2568 
	gdiskBa£d_
 = 
v®ue
;

2569 
ÚChªged
();

2570  
	gthis
;

2579 
public
 
Bud”
 
ş—rDiskBa£d
() {

2581 
	gdiskBa£d_
 = 
çl£
;

2582 
ÚChªged
();

2583  
	gthis
;

2586 
´iv©e
 
boŞ—n
 
	gÿche_
 ;

2594 
public
 
boŞ—n
 
g‘Cache
() {

2595  
	gÿche_
;

2604 
public
 
Bud”
 
£tCache
(
boŞ—n
 
v®ue
) {

2606 
	gÿche_
 = 
v®ue
;

2607 
ÚChªged
();

2608  
	gthis
;

2617 
public
 
Bud”
 
ş—rCache
() {

2619 
	gÿche_
 = 
çl£
;

2620 
ÚChªged
();

2621  
	gthis
;

2623 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

2624 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2625  
	gthis
;

2628 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

2629 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2630  
	gthis
;

2638 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
	gDEFAULT_INSTANCE
;

2640 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
TabËM‘ad©a
();

2643 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
g‘DeçuÉIn¡ªû
() {

2644  
	gDEFAULT_INSTANCE
;

2647 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËM‘ad©a
>

2648 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
TabËM‘ad©a
>() {

2649 
public
 
TabËM‘ad©a
 
·r£P¬tŸlFrom
(

2650 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2651 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2652 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

2653  
Ãw
 
TabËM‘ad©a
(
šput
, 
ex‹nsiÚRegi¡ry
);

2657 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËM‘ad©a
> 
·r£r
() {

2658  
	gPARSER
;

2661 @
	gjava
.
	gÏng
.
Ov”ride


2662 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gTabËM‘ad©a
> 
g‘P¬£rFÜTy³
() {

2663  
	gPARSER
;

2666 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
TabËM‘ad©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2667  
	gDEFAULT_INSTANCE
;

2672 
public
 
š‹rçû
 
RecÜdOrBud”
 
ex‹nds


2674 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

2679 
boŞ—n
 
hasPaylßd
();

2683 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘Paylßd
();

2687 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘PaylßdOrBud”
();

2692 
boŞ—n
 
hasM‘ad©a
();

2696 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘M‘ad©a
();

2700 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘M‘ad©aOrBud”
();

2709 
public
 
fš®
 
şass
 
RecÜd
 
ex‹nds


2710 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


2712 
	gRecÜdOrBud”
 {

2714 
´iv©e
 
RecÜd
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

2715 
su³r
(
bud”
);

2717 
´iv©e
 
RecÜd
() {

2720 @
	gjava
.
	gÏng
.
Ov”ride


2721 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


2722 
g‘UnknownF›lds
() {

2723  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

2725 
´iv©e
 
RecÜd
(

2726 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2727 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2728 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2729 
this
();

2730 
	gmubË_b™F›ld0_
 = 0;

2731 
	gŒy
 {

2732 
boŞ—n
 
	gdÚe
 = 
çl£
;

2733 !
	gdÚe
) {

2734 
	gg
 = 
šput
.
»adTag
();

2735 
	gg
) {

2737 
dÚe
 = 
Œue
;

2740 ià(!
šput
.
skF›ld
(
g
)) {

2741 
dÚe
 = 
Œue
;

2746 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
subBud”
 = 
nuÎ
;

2747 ià(
	g·ylßd_
 !ğ
nuÎ
) {

2748 
subBud”
 = 
·ylßd_
.
toBud”
();

2750 
	g·ylßd_
 = 
šput
.
»adMes§ge
(
com
.
googË
.
´Ùobuf
.
Any
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

2751 ià(
	gsubBud”
 !ğ
nuÎ
) {

2752 
subBud”
.
m”geFrom
(
·ylßd_
);

2753 
	g·ylßd_
 = 
subBud”
.
budP¬tŸl
();

2759 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
subBud”
 = 
nuÎ
;

2760 ià(
	gm‘ad©a_
 !ğ
nuÎ
) {

2761 
subBud”
 = 
m‘ad©a_
.
toBud”
();

2763 
	gm‘ad©a_
 = 
šput
.
»adMes§ge
(
com
.
googË
.
´Ùobuf
.
Any
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

2764 ià(
	gsubBud”
 !ğ
nuÎ
) {

2765 
subBud”
.
m”geFrom
(
m‘ad©a_
);

2766 
	gm‘ad©a_
 = 
subBud”
.
budP¬tŸl
();

2773 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2774 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

2775 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

2776 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

2777 
e
).
£tUnfšishedMes§ge
(
this
);

2778 } 
	gfš®ly
 {

2779 
makeEx‹nsiÚsImmubË
();

2782 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2783 
g‘DesütÜ
() {

2784  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

2787 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2788 
š‹º®G‘F›ldAcûssÜTabË
() {

2789  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË


2790 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2791 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.RecÜd.
Bud”
.class);

2794 
public
 
fš®
 
	gPAYLOAD_FIELD_NUMBER
 = 1;

2795 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	g·ylßd_
;

2799 
public
 
boŞ—n
 
hasPaylßd
() {

2800  
	g·ylßd_
 !ğ
nuÎ
;

2805 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘Paylßd
() {

2806  
	g·ylßd_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
·ylßd_
;

2811 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘PaylßdOrBud”
() {

2812  
g‘Paylßd
();

2815 
public
 
fš®
 
	gMETADATA_FIELD_NUMBER
 = 2;

2816 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	gm‘ad©a_
;

2820 
public
 
boŞ—n
 
hasM‘ad©a
() {

2821  
	gm‘ad©a_
 !ğ
nuÎ
;

2826 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘M‘ad©a
() {

2827  
	gm‘ad©a_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
m‘ad©a_
;

2832 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘M‘ad©aOrBud”
() {

2833  
g‘M‘ad©a
();

2836 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

2837 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2838 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

2839 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

2840 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

2842 
	gmemoizedIsIn™Ÿlized
 = 1;

2843  
	gŒue
;

2846 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

2847 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2848 ià(
	g·ylßd_
 !ğ
nuÎ
) {

2849 
ouut
.
wr™eMes§ge
(1, 
g‘Paylßd
());

2851 ià(
	gm‘ad©a_
 !ğ
nuÎ
) {

2852 
ouut
.
wr™eMes§ge
(2, 
g‘M‘ad©a
());

2856 
public
 
g‘S”ŸlizedSize
() {

2857 
	gsize
 = 
memoizedSize
;

2858 ià(
	gsize
 !ğ-1è 
size
;

2860 
	gsize
 = 0;

2861 ià(
	g·ylßd_
 !ğ
nuÎ
) {

2862 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2863 .
compu‹Mes§geSize
(1, 
g‘Paylßd
());

2865 ià(
	gm‘ad©a_
 !ğ
nuÎ
) {

2866 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2867 .
compu‹Mes§geSize
(2, 
g‘M‘ad©a
());

2869 
	gmemoizedSize
 = 
size
;

2870  
	gsize
;

2873 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

2874 @
	gjava
.
	gÏng
.
Ov”ride


2875 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

2876 ià(
	gobj
 =ğ
this
) {

2877  
Œue
;

2879 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
)) {

2880  
	gsu³r
.
equ®s
(
obj
);

2882 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	gÙh”
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.RecÜdè
obj
;

2884 
boŞ—n
 
	g»suÉ
 = 
Œue
;

2885 
	g»suÉ
 = 
»suÉ
 && (
hasPaylßd
(è=ğ
Ùh”
.hasPayload());

2886 ià(
hasPaylßd
()) {

2887 
	g»suÉ
 = 
»suÉ
 && 
g‘Paylßd
()

2888 .
equ®s
(
Ùh”
.
g‘Paylßd
());

2890 
	g»suÉ
 = 
»suÉ
 && (
hasM‘ad©a
(è=ğ
Ùh”
.hasMetadata());

2891 ià(
hasM‘ad©a
()) {

2892 
	g»suÉ
 = 
»suÉ
 && 
g‘M‘ad©a
()

2893 .
equ®s
(
Ùh”
.
g‘M‘ad©a
());

2895  
	g»suÉ
;

2898 @
	gjava
.
	gÏng
.
Ov”ride


2899 
public
 
hashCode
() {

2900 ià(
	gmemoizedHashCode
 != 0) {

2901  
memoizedHashCode
;

2903 
	ghash
 = 41;

2904 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

2905 ià(
hasPaylßd
()) {

2906 
	ghash
 = (37 * 
hash
è+ 
PAYLOAD_FIELD_NUMBER
;

2907 
	ghash
 = (53 * 
hash
è+ 
g‘Paylßd
().
hashCode
();

2909 ià(
hasM‘ad©a
()) {

2910 
	ghash
 = (37 * 
hash
è+ 
METADATA_FIELD_NUMBER
;

2911 
	ghash
 = (53 * 
hash
è+ 
g‘M‘ad©a
().
hashCode
();

2913 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

2914 
	gmemoizedHashCode
 = 
hash
;

2915  
	ghash
;

2918 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2919 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

2920 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2921  
	gPARSER
.
·r£From
(
d©a
);

2923 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2924 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

2925 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2926 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2927  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2929 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(
by‹
[] 
d©a
)

2930 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2931  
	gPARSER
.
·r£From
(
d©a
);

2933 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2934 
by‹
[] 
d©a
,

2935 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2936 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2937  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2939 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2940 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2941  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2942 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2944 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2945 
java
.
io
.
IÅutSŒ—m
 
šput
,

2946 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2947 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2948  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2949 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2951 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2952 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2953  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2954 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

2956 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£D–im™edFrom
(

2957 
java
.
io
.
IÅutSŒ—m
 
šput
,

2958 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2959 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2960  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2961 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2963 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2964 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2965 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2966  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2967 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2969 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
·r£From
(

2970 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2971 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2972 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2973  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2974 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2977 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2978 
public
 
Bud”
 
ÃwBud”
() {

2979  
	gDEFAULT_INSTANCE
.
toBud”
();

2981 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
 
´ÙÙy³
) {

2982  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2984 
public
 
Bud”
 
toBud”
() {

2985  
	gthis
 =ğ
DEFAULT_INSTANCE


2986 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2989 @
	gjava
.
	gÏng
.
Ov”ride


2990 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2991 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2992 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2993  
	gbud”
;

3002 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


3003 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


3005 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜdOrBud”
 {

3006 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3007 
g‘DesütÜ
() {

3008  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

3011 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3012 
š‹º®G‘F›ldAcûssÜTabË
() {

3013  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË


3014 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3015 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
.
şass
, org.cÜfudb.ruÁime.CÜfuStÜeM‘ad©a.RecÜd.
Bud”
.class);

3019 
´iv©e
 
Bud”
() {

3020 
maybeFÜûBud”In™Ÿliz©iÚ
();

3023 
´iv©e
 
Bud”
(

3024 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3025 
su³r
(
·»Á
);

3026 
maybeFÜûBud”In™Ÿliz©iÚ
();

3028 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

3029 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3030 .
	g®waysU£F›ldBud”s
) {

3033 
public
 
Bud”
 
ş—r
() {

3034 
	gsu³r
.
ş—r
();

3035 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3036 
·ylßd_
 = 
nuÎ
;

3038 
	g·ylßd_
 = 
nuÎ
;

3039 
	g·ylßdBud”_
 = 
nuÎ
;

3041 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3042 
m‘ad©a_
 = 
nuÎ
;

3044 
	gm‘ad©a_
 = 
nuÎ
;

3045 
	gm‘ad©aBud”_
 = 
nuÎ
;

3047  
	gthis
;

3050 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3051 
g‘DesütÜFÜTy³
() {

3052  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

3055 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3056  
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
.
g‘DeçuÉIn¡ªû
();

3059 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
bud
() {

3060 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	g»suÉ
 = 
budP¬tŸl
();

3061 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

3062 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

3064  
	g»suÉ
;

3067 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
budP¬tŸl
() {

3068 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.RecÜd(
this
);

3069 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3070 
»suÉ
.
·ylßd_
 =…ayload_;

3072 
	g»suÉ
.
	g·ylßd_
 = 
·ylßdBud”_
.
bud
();

3074 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3075 
»suÉ
.
m‘ad©a_
 = metadata_;

3077 
	g»suÉ
.
	gm‘ad©a_
 = 
m‘ad©aBud”_
.
bud
();

3079 
ÚBut
();

3080  
	g»suÉ
;

3083 
public
 
Bud”
 
şÚe
() {

3084  (
	gBud”
è
	gsu³r
.
şÚe
();

3086 
public
 
Bud”
 
£tF›ld
(

3087 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3088 
Objeù
 
v®ue
) {

3089  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

3091 
public
 
Bud”
 
ş—rF›ld
(

3092 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

3093  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

3095 
public
 
Bud”
 
ş—rOÃof
(

3096 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

3097  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

3099 
public
 
Bud”
 
£tR•—‹dF›ld
(

3100 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3101 
šdex
, 
Objeù
 
v®ue
) {

3102  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

3104 
public
 
Bud”
 
addR•—‹dF›ld
(

3105 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3106 
Objeù
 
v®ue
) {

3107  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

3109 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

3110 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
	gRecÜd
) {

3111  
m”geFrom
((
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
)
Ùh”
);

3113 
	gsu³r
.
m”geFrom
(
Ùh”
);

3114  
	gthis
;

3118 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
 
Ùh”
) {

3119 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
.
g‘DeçuÉIn¡ªû
()è 
this
;

3120 ià(
	gÙh”
.
hasPaylßd
()) {

3121 
m”gePaylßd
(
Ùh”
.
g‘Paylßd
());

3123 ià(
	gÙh”
.
hasM‘ad©a
()) {

3124 
m”geM‘ad©a
(
Ùh”
.
g‘M‘ad©a
());

3126 
ÚChªged
();

3127  
	gthis
;

3130 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3131  
	gŒue
;

3134 
public
 
Bud”
 
m”geFrom
(

3135 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3136 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3137 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3138 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	g·r£dMes§ge
 = 
nuÎ
;

3139 
	gŒy
 {

3140 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

3141 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3142 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
è
e
.
g‘UnfšishedMes§ge
();

3143 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

3144 } 
	gfš®ly
 {

3145 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

3146 
m”geFrom
(
·r£dMes§ge
);

3149  
	gthis
;

3152 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	g·ylßd_
 = 
nuÎ
;

3153 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3154 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
> 
	g·ylßdBud”_
;

3158 
public
 
boŞ—n
 
hasPaylßd
() {

3159  
	g·ylßdBud”_
 !ğ
nuÎ
 || 
·ylßd_
 !=‚ull;

3164 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘Paylßd
() {

3165 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3166  
·ylßd_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
() :…ayload_;

3168  
	g·ylßdBud”_
.
g‘Mes§ge
();

3174 
public
 
Bud”
 
£tPaylßd
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3175 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3176 ià(
v®ue
 =ğ
nuÎ
) {

3177 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3179 
	g·ylßd_
 = 
v®ue
;

3180 
ÚChªged
();

3182 
	g·ylßdBud”_
.
£tMes§ge
(
v®ue
);

3185  
	gthis
;

3190 
public
 
Bud”
 
£tPaylßd
(

3191 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
bud”FÜV®ue
) {

3192 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3193 
·ylßd_
 = 
bud”FÜV®ue
.
bud
();

3194 
ÚChªged
();

3196 
	g·ylßdBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

3199  
	gthis
;

3204 
public
 
Bud”
 
m”gePaylßd
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3205 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3206 ià(
·ylßd_
 !ğ
nuÎ
) {

3207 
·ylßd_
 =

3208 
com
.
googË
.
´Ùobuf
.
Any
.
ÃwBud”
(
·ylßd_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

3210 
	g·ylßd_
 = 
v®ue
;

3212 
ÚChªged
();

3214 
	g·ylßdBud”_
.
m”geFrom
(
v®ue
);

3217  
	gthis
;

3222 
public
 
Bud”
 
ş—rPaylßd
() {

3223 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3224 
·ylßd_
 = 
nuÎ
;

3225 
ÚChªged
();

3227 
	g·ylßd_
 = 
nuÎ
;

3228 
	g·ylßdBud”_
 = 
nuÎ
;

3231  
	gthis
;

3236 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
Bud”
 
g‘PaylßdBud”
() {

3238 
ÚChªged
();

3239  
g‘PaylßdF›ldBud”
().
g‘Bud”
();

3244 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘PaylßdOrBud”
() {

3245 ià(
	g·ylßdBud”_
 !ğ
nuÎ
) {

3246  
·ylßdBud”_
.
g‘Mes§geOrBud”
();

3248  
	g·ylßd_
 =ğ
nuÎ
 ?

3249 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
·ylßd_
;

3255 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3256 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>

3257 
g‘PaylßdF›ldBud”
() {

3258 ià(
	g·ylßdBud”_
 =ğ
nuÎ
) {

3259 
·ylßdBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

3260 
com
.
googË
.
´Ùobuf
.
Any
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>(

3261 
g‘Paylßd
(),

3262 
g‘P¬’tFÜChd»n
(),

3263 
isCËª
());

3264 
	g·ylßd_
 = 
nuÎ
;

3266  
	g·ylßdBud”_
;

3269 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
	gm‘ad©a_
 = 
nuÎ
;

3270 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3271 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
> 
	gm‘ad©aBud”_
;

3275 
public
 
boŞ—n
 
hasM‘ad©a
() {

3276  
	gm‘ad©aBud”_
 !ğ
nuÎ
 || 
m‘ad©a_
 !=‚ull;

3281 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Any
 
g‘M‘ad©a
() {

3282 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3283  
m‘ad©a_
 =ğ
nuÎ
 ? 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
() : metadata_;

3285  
	gm‘ad©aBud”_
.
g‘Mes§ge
();

3291 
public
 
Bud”
 
£tM‘ad©a
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3292 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3293 ià(
v®ue
 =ğ
nuÎ
) {

3294 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3296 
	gm‘ad©a_
 = 
v®ue
;

3297 
ÚChªged
();

3299 
	gm‘ad©aBud”_
.
£tMes§ge
(
v®ue
);

3302  
	gthis
;

3307 
public
 
Bud”
 
£tM‘ad©a
(

3308 
com
.
googË
.
´Ùobuf
.
Any
.
Bud”
 
bud”FÜV®ue
) {

3309 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3310 
m‘ad©a_
 = 
bud”FÜV®ue
.
bud
();

3311 
ÚChªged
();

3313 
	gm‘ad©aBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

3316  
	gthis
;

3321 
public
 
Bud”
 
m”geM‘ad©a
(
com
.
googË
.
´Ùobuf
.
Any
 
v®ue
) {

3322 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3323 ià(
m‘ad©a_
 !ğ
nuÎ
) {

3324 
m‘ad©a_
 =

3325 
com
.
googË
.
´Ùobuf
.
Any
.
ÃwBud”
(
m‘ad©a_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

3327 
	gm‘ad©a_
 = 
v®ue
;

3329 
ÚChªged
();

3331 
	gm‘ad©aBud”_
.
m”geFrom
(
v®ue
);

3334  
	gthis
;

3339 
public
 
Bud”
 
ş—rM‘ad©a
() {

3340 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3341 
m‘ad©a_
 = 
nuÎ
;

3342 
ÚChªged
();

3344 
	gm‘ad©a_
 = 
nuÎ
;

3345 
	gm‘ad©aBud”_
 = 
nuÎ
;

3348  
	gthis
;

3353 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
Bud”
 
g‘M‘ad©aBud”
() {

3355 
ÚChªged
();

3356  
g‘M‘ad©aF›ldBud”
().
g‘Bud”
();

3361 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
AnyOrBud”
 
g‘M‘ad©aOrBud”
() {

3362 ià(
	gm‘ad©aBud”_
 !ğ
nuÎ
) {

3363  
m‘ad©aBud”_
.
g‘Mes§geOrBud”
();

3365  
	gm‘ad©a_
 =ğ
nuÎ
 ?

3366 
com
.
googË
.
´Ùobuf
.
Any
.
g‘DeçuÉIn¡ªû
(è: 
m‘ad©a_
;

3372 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

3373 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
, com.googË.´Ùobuf.Any.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>

3374 
g‘M‘ad©aF›ldBud”
() {

3375 ià(
	gm‘ad©aBud”_
 =ğ
nuÎ
) {

3376 
m‘ad©aBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

3377 
com
.
googË
.
´Ùobuf
.
Any
, 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAny
.
	gBud”
, com.googË.´Ùobuf.
	gAnyOrBud”
>(

3378 
g‘M‘ad©a
(),

3379 
g‘P¬’tFÜChd»n
(),

3380 
isCËª
());

3381 
	gm‘ad©a_
 = 
nuÎ
;

3383  
	gm‘ad©aBud”_
;

3385 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

3386 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3387  
	gthis
;

3390 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

3391 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3392  
	gthis
;

3400 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
	gDEFAULT_INSTANCE
;

3402 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuStÜeM‘ad©a
.
RecÜd
();

3405 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
g‘DeçuÉIn¡ªû
() {

3406  
	gDEFAULT_INSTANCE
;

3409 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gRecÜd
>

3410 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
RecÜd
>() {

3411 
public
 
RecÜd
 
·r£P¬tŸlFrom
(

3412 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3413 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3414 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

3415  
Ãw
 
RecÜd
(
šput
, 
ex‹nsiÚRegi¡ry
);

3419 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gRecÜd
> 
·r£r
() {

3420  
	gPARSER
;

3423 @
	gjava
.
	gÏng
.
Ov”ride


3424 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gRecÜd
> 
g‘P¬£rFÜTy³
() {

3425  
	gPARSER
;

3428 
public
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
.
RecÜd
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3429  
	gDEFAULT_INSTANCE
;

3434 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3435 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
;

3436 
´iv©e
 
fš®


3437 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3438 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË
;

3439 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3440 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
;

3441 
´iv©e
 
fš®


3442 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3443 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË
;

3444 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3445 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
;

3446 
´iv©e
 
fš®


3447 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3448 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË
;

3449 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3450 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
;

3451 
´iv©e
 
fš®


3452 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3453 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_f›ldAcûssÜTabË
;

3454 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3455 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
;

3456 
´iv©e
 
fš®


3457 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3458 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË
;

3459 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3460 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
;

3461 
´iv©e
 
fš®


3462 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3463 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË
;

3465 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


3466 
	$g‘DesütÜ
() {

3467  
desütÜ
;

3468 
	}
}

3469 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


3470 
	gdesütÜ
;

3472 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

3490 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

3491 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

3492 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

3493 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

3494 
desütÜ
 = 
roÙ
;

3495  
	gnuÎ
;

3498 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


3499 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

3500 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

3501 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
g‘DesütÜ
(),

3502 
com
.
googË
.
´Ùobuf
.
AnyPrÙo
.
g‘DesütÜ
(),

3503 }, 
assigÃr
);

3504 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
 =

3505 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

3506 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_f›ldAcûssÜTabË
 = 
Ãw


3507 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3508 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_Time¡amp_desütÜ
,

3509 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Epoch", "Sequence", });

3510 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
 =

3511 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

3512 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_f›ldAcûssÜTabË
 = 
Ãw


3513 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3514 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËName_desütÜ
,

3515 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Namespace", "TableName", });

3516 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
 =

3517 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(2);

3518 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_f›ldAcûssÜTabË
 = 
Ãw


3519 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3520 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
,

3521 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "FileDescriptors", });

3522 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
 =

3523 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_desütÜ
.
g‘Ne¡edTy³s
().
g‘
(0);

3524 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_f›ldAcûssÜTabË
 = 
Ãw


3525 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3526 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËDesütÜs_FeDesütÜsEÁry_desütÜ
,

3527 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Key", "Value", });

3528 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
 =

3529 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(3);

3530 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_f›ldAcûssÜTabË
 = 
Ãw


3531 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3532 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_TabËM‘ad©a_desütÜ
,

3533 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "TableName", "DiskBased", "Cache", });

3534 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
 =

3535 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(4);

3536 
	gš‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_f›ldAcûssÜTabË
 = 
Ãw


3537 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

3538 
š‹º®_¡©ic_Üg_cÜfudb_ruÁime_RecÜd_desütÜ
,

3539 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Payload", "Metadata", });

3540 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
g‘DesütÜ
();

3541 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAnyPrÙo
.
g‘DesütÜ
();

	@test/target/generated-sources/org/corfudb/test/SampleAppliance.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g‹¡
;

6 
public
 
fš®
 cÏs 
	cSam¶eAµlŸnû
 {

7 
´iv©e
 
	$Sam¶eAµlŸnû
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
AµlŸnûOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
boŞ—n
 
hasEndpošt
();

28 
	gjava
.
	gÏng
.
SŒšg
 
g‘Endpošt
();

32 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


33 
g‘EndpoštBy‹s
();

38 
public
 
fš®
 
şass
 
AµlŸnû
 
ex‹nds


39 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


41 
	gAµlŸnûOrBud”
 {

43 
´iv©e
 
AµlŸnû
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

44 
su³r
(
bud”
);

46 
´iv©e
 
AµlŸnû
() {

47 
	g’dpošt_
 = "";

50 @
	gjava
.
	gÏng
.
Ov”ride


51 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


52 
g‘UnknownF›lds
() {

53  
	gthis
.
	gunknownF›lds
;

55 
´iv©e
 
AµlŸnû
(

56 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

57 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

58 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

59 
this
();

60 
	gmubË_b™F›ld0_
 = 0;

61 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

62 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

63 
	gŒy
 {

64 
boŞ—n
 
	gdÚe
 = 
çl£
;

65 !
	gdÚe
) {

66 
	gg
 = 
šput
.
»adTag
();

67 
	gg
) {

69 
dÚe
 = 
Œue
;

72 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

73 
ex‹nsiÚRegi¡ry
, 
g
)) {

74 
	gdÚe
 = 
Œue
;

79 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

80 
	gb™F›ld0_
 |= 0x00000001;

81 
	g’dpošt_
 = 
bs
;

86 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

87 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

88 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

89 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

90 
e
).
£tUnfšishedMes§ge
(
this
);

91 } 
	gfš®ly
 {

92 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

93 
makeEx‹nsiÚsImmubË
();

96 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


97 
g‘DesütÜ
() {

98  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_desütÜ
;

101 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


102 
š‹º®G‘F›ldAcûssÜTabË
() {

103  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_f›ldAcûssÜTabË


104 .
’su»F›ldAcûssÜsIn™Ÿlized
(

105 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
şass
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
Bud”
.class);

108 
´iv©e
 
	gb™F›ld0_
;

109 
public
 
fš®
 
	gENDPOINT_FIELD_NUMBER
 = 1;

110 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	g’dpošt_
;

114 
public
 
boŞ—n
 
hasEndpošt
() {

115  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

120 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Endpošt
() {

121 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
’dpošt_
;

122 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

123  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

125 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

126 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

127 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

128 ià(
	gbs
.
isV®idUtf8
()) {

129 
	g’dpošt_
 = 
s
;

131  
	gs
;

137 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


138 
g‘EndpoštBy‹s
() {

139 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
’dpošt_
;

140 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

141 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

142 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

143 (
java
.
Ïng
.
SŒšg
è
»f
);

144 
	g’dpošt_
 = 
b
;

145  
	gb
;

147  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

151 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

152 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

153 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

154 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

155 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

157 
	gmemoizedIsIn™Ÿlized
 = 1;

158  
	gŒue
;

161 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

162 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

163 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

164 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
’dpošt_
);

166 
	gunknownF›lds
.
wr™eTo
(
ouut
);

169 
public
 
g‘S”ŸlizedSize
() {

170 
	gsize
 = 
memoizedSize
;

171 ià(
	gsize
 !ğ-1è 
size
;

173 
	gsize
 = 0;

174 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

175 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
’dpošt_
);

177 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

178 
	gmemoizedSize
 = 
size
;

179  
	gsize
;

182 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

183 @
	gjava
.
	gÏng
.
Ov”ride


184 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

185 ià(
	gobj
 =ğ
this
) {

186  
Œue
;

188 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
)) {

189  
	gsu³r
.
equ®s
(
obj
);

191 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.AµlŸnûè
obj
;

193 
boŞ—n
 
	g»suÉ
 = 
Œue
;

194 
	g»suÉ
 = 
»suÉ
 && (
hasEndpošt
(è=ğ
Ùh”
.hasEndpoint());

195 ià(
hasEndpošt
()) {

196 
	g»suÉ
 = 
»suÉ
 && 
g‘Endpošt
()

197 .
equ®s
(
Ùh”
.
g‘Endpošt
());

199 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

200  
	g»suÉ
;

203 @
	gjava
.
	gÏng
.
Ov”ride


204 
public
 
hashCode
() {

205 ià(
	gmemoizedHashCode
 != 0) {

206  
memoizedHashCode
;

208 
	ghash
 = 41;

209 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

210 ià(
hasEndpošt
()) {

211 
	ghash
 = (37 * 
hash
è+ 
ENDPOINT_FIELD_NUMBER
;

212 
	ghash
 = (53 * 
hash
è+ 
g‘Endpošt
().
hashCode
();

214 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

215 
	gmemoizedHashCode
 = 
hash
;

216  
	ghash
;

219 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(

220 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

221 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

222  
	gPARSER
.
·r£From
(
d©a
);

224 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(

225 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

226 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

227 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

228  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

230 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(
by‹
[] 
d©a
)

231 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

232  
	gPARSER
.
·r£From
(
d©a
);

234 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(

235 
by‹
[] 
d©a
,

236 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

237 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

238  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

240 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

241 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

242  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


243 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

245 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(

246 
java
.
io
.
IÅutSŒ—m
 
šput
,

247 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

248 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

249  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


250 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

252 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

253 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

254  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


255 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

257 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£D–im™edFrom
(

258 
java
.
io
.
IÅutSŒ—m
 
šput
,

259 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

260 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

261  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


262 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

264 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(

265 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

266 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

267  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


268 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

270 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
·r£From
(

271 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

272 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

273 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

274  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


275 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

278 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

279 
public
 
Bud”
 
ÃwBud”
() {

280  
	gDEFAULT_INSTANCE
.
toBud”
();

282 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
´ÙÙy³
) {

283  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

285 
public
 
Bud”
 
toBud”
() {

286  
	gthis
 =ğ
DEFAULT_INSTANCE


287 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

290 @
	gjava
.
	gÏng
.
Ov”ride


291 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

292 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

293 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

294  
	gbud”
;

299 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


300 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


302 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnûOrBud”
 {

303 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


304 
g‘DesütÜ
() {

305  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_desütÜ
;

308 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


309 
š‹º®G‘F›ldAcûssÜTabË
() {

310  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_f›ldAcûssÜTabË


311 .
’su»F›ldAcûssÜsIn™Ÿlized
(

312 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
şass
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
Bud”
.class);

316 
´iv©e
 
Bud”
() {

317 
maybeFÜûBud”In™Ÿliz©iÚ
();

320 
´iv©e
 
Bud”
(

321 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

322 
su³r
(
·»Á
);

323 
maybeFÜûBud”In™Ÿliz©iÚ
();

325 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

326 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


327 .
	g®waysU£F›ldBud”s
) {

330 
public
 
Bud”
 
ş—r
() {

331 
	gsu³r
.
ş—r
();

332 
	g’dpošt_
 = "";

333 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

334  
	gthis
;

337 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


338 
g‘DesütÜFÜTy³
() {

339  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_desütÜ
;

342 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘DeçuÉIn¡ªûFÜTy³
() {

343  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
g‘DeçuÉIn¡ªû
();

346 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
bud
() {

347 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	g»suÉ
 = 
budP¬tŸl
();

348 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

349 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

351  
	g»suÉ
;

354 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
budP¬tŸl
() {

355 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.AµlŸnû(
this
);

356 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

357 
	gto_b™F›ld0_
 = 0;

358 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

359 
to_b™F›ld0_
 |= 0x00000001;

361 
	g»suÉ
.
	g’dpošt_
 = 
’dpošt_
;

362 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

363 
ÚBut
();

364  
	g»suÉ
;

367 
public
 
Bud”
 
şÚe
() {

368  (
	gBud”
è
	gsu³r
.
şÚe
();

370 
public
 
Bud”
 
£tF›ld
(

371 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

372 
Objeù
 
v®ue
) {

373  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

375 
public
 
Bud”
 
ş—rF›ld
(

376 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

377  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

379 
public
 
Bud”
 
ş—rOÃof
(

380 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

381  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

383 
public
 
Bud”
 
£tR•—‹dF›ld
(

384 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

385 
šdex
, 
Objeù
 
v®ue
) {

386  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

388 
public
 
Bud”
 
addR•—‹dF›ld
(

389 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

390 
Objeù
 
v®ue
) {

391  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

393 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

394 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
) {

395  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
)
Ùh”
);

397 
	gsu³r
.
m”geFrom
(
Ùh”
);

398  
	gthis
;

402 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
Ùh”
) {

403 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
()è 
this
;

404 ià(
	gÙh”
.
hasEndpošt
()) {

405 
	gb™F›ld0_
 |= 0x00000001;

406 
	g’dpošt_
 = 
Ùh”
.
’dpošt_
;

407 
ÚChªged
();

409 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

410 
ÚChªged
();

411  
	gthis
;

414 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

415  
	gŒue
;

418 
public
 
Bud”
 
m”geFrom
(

419 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

420 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

421 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

422 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	g·r£dMes§ge
 = 
nuÎ
;

423 
	gŒy
 {

424 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

425 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

426 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
è
e
.
g‘UnfšishedMes§ge
();

427 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

428 } 
	gfš®ly
 {

429 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

430 
m”geFrom
(
·r£dMes§ge
);

433  
	gthis
;

435 
´iv©e
 
	gb™F›ld0_
;

437 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	g’dpošt_
 = "";

441 
public
 
boŞ—n
 
hasEndpošt
() {

442  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

447 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Endpošt
() {

448 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
’dpošt_
;

449 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

450 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

451 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

452 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

453 ià(
	gbs
.
isV®idUtf8
()) {

454 
	g’dpošt_
 = 
s
;

456  
	gs
;

458  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

464 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


465 
g‘EndpoštBy‹s
() {

466 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
’dpošt_
;

467 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

468 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

469 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

470 (
java
.
Ïng
.
SŒšg
è
»f
);

471 
	g’dpošt_
 = 
b
;

472  
	gb
;

474  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

480 
public
 
Bud”
 
£tEndpošt
(

481 
java
.
Ïng
.
SŒšg
 
v®ue
) {

482 ià(
	gv®ue
 =ğ
nuÎ
) {

483 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

485 
	gb™F›ld0_
 |= 0x00000001;

486 
	g’dpošt_
 = 
v®ue
;

487 
ÚChªged
();

488  
	gthis
;

493 
public
 
Bud”
 
ş—rEndpošt
() {

494 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

495 
	g’dpošt_
 = 
g‘DeçuÉIn¡ªû
().
g‘Endpošt
();

496 
ÚChªged
();

497  
	gthis
;

502 
public
 
Bud”
 
£tEndpoštBy‹s
(

503 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

504 ià(
	gv®ue
 =ğ
nuÎ
) {

505 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

507 
	gb™F›ld0_
 |= 0x00000001;

508 
	g’dpošt_
 = 
v®ue
;

509 
ÚChªged
();

510  
	gthis
;

512 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

513 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

514  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

517 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

518 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

519  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

527 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gDEFAULT_INSTANCE
;

529 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
();

532 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘DeçuÉIn¡ªû
() {

533  
	gDEFAULT_INSTANCE
;

536 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gAµlŸnû
>

537 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
AµlŸnû
>() {

538 
public
 
AµlŸnû
 
·r£P¬tŸlFrom
(

539 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

540 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

541 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

542  
Ãw
 
AµlŸnû
(
šput
, 
ex‹nsiÚRegi¡ry
);

546 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gAµlŸnû
> 
·r£r
() {

547  
	gPARSER
;

550 @
	gjava
.
	gÏng
.
Ov”ride


551 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gAµlŸnû
> 
g‘P¬£rFÜTy³
() {

552  
	gPARSER
;

555 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘DeçuÉIn¡ªûFÜTy³
() {

556  
	gDEFAULT_INSTANCE
;

561 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


562 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_desütÜ
;

563 
´iv©e
 
fš®


564 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


565 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_f›ldAcûssÜTabË
;

567 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


568 
	$g‘DesütÜ
() {

569  
desütÜ
;

570 
	}
}

571 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


572 
	gdesütÜ
;

574 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

579 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

580 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

581 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

582 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

583 
desütÜ
 = 
roÙ
;

584  
	gnuÎ
;

587 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


588 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

589 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

590 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
g‘DesütÜ
(),

591 }, 
assigÃr
);

592 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_desütÜ
 =

593 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

594 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_f›ldAcûssÜTabË
 = 
Ãw


595 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

596 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_AµlŸnû_desütÜ
,

597 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Endpoint", });

598 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
g‘DesütÜ
();

	@test/target/generated-sources/org/corfudb/test/SampleSchema.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g‹¡
;

6 
public
 
fš®
 cÏs 
	cSam¶eSchema
 {

7 
´iv©e
 
	$Sam¶eSchema
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
»gi¡ry
.
	`add
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
mgİtiÚs
);

11 
	}
}

13 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

14 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

15 
	`»gi¡”AÎEx‹nsiÚs
(

16 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

17 
	}
}

18 
public
 
š‹rçû
 
Fœew®lRuËOrBud”
 
ex‹nds


20 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

25 
boŞ—n
 
hasRuËId
();

29 
g‘RuËId
();

34 
boŞ—n
 
hasRuËName
();

38 
	gjava
.
	gÏng
.
SŒšg
 
g‘RuËName
();

42 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


43 
g‘RuËNameBy‹s
();

48 
boŞ—n
 
hasIÅut
();

52 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘IÅut
();

56 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘IÅutOrBud”
();

61 
boŞ—n
 
hasOuut
();

65 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘Ouut
();

69 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘OuutOrBud”
();

74 
public
 
fš®
 
şass
 
Fœew®lRuË
 
ex‹nds


75 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


77 
	gFœew®lRuËOrBud”
 {

79 
´iv©e
 
Fœew®lRuË
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

80 
su³r
(
bud”
);

82 
´iv©e
 
Fœew®lRuË
() {

83 
	gruËId_
 = 0L;

84 
	gruËName_
 = "";

87 @
	gjava
.
	gÏng
.
Ov”ride


88 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


89 
g‘UnknownF›lds
() {

90  
	gthis
.
	gunknownF›lds
;

92 
´iv©e
 
Fœew®lRuË
(

93 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

94 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

95 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

96 
this
();

97 
	gmubË_b™F›ld0_
 = 0;

98 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

99 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

100 
	gŒy
 {

101 
boŞ—n
 
	gdÚe
 = 
çl£
;

102 !
	gdÚe
) {

103 
	gg
 = 
šput
.
»adTag
();

104 
	gg
) {

106 
dÚe
 = 
Œue
;

109 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

110 
ex‹nsiÚRegi¡ry
, 
g
)) {

111 
	gdÚe
 = 
Œue
;

116 
b™F›ld0_
 |= 0x00000001;

117 
	gruËId_
 = 
šput
.
»adIÁ64
();

121 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

122 
	gb™F›ld0_
 |= 0x00000002;

123 
	gruËName_
 = 
bs
;

127 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
Bud”
 
subBud”
 = 
nuÎ
;

128 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

129 
subBud”
 = 
šput_
.
toBud”
();

131 
	gšput_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
PARSER
, 
ex‹nsiÚRegi¡ry
);

132 ià(
	gsubBud”
 !ğ
nuÎ
) {

133 
subBud”
.
m”geFrom
(
šput_
);

134 
	gšput_
 = 
subBud”
.
budP¬tŸl
();

136 
	gb™F›ld0_
 |= 0x00000004;

140 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
Bud”
 
subBud”
 = 
nuÎ
;

141 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

142 
subBud”
 = 
ouut_
.
toBud”
();

144 
	gouut_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
PARSER
, 
ex‹nsiÚRegi¡ry
);

145 ià(
	gsubBud”
 !ğ
nuÎ
) {

146 
subBud”
.
m”geFrom
(
ouut_
);

147 
	gouut_
 = 
subBud”
.
budP¬tŸl
();

149 
	gb™F›ld0_
 |= 0x00000008;

154 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

155 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

156 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

157 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

158 
e
).
£tUnfšishedMes§ge
(
this
);

159 } 
	gfš®ly
 {

160 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

161 
makeEx‹nsiÚsImmubË
();

164 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


165 
g‘DesütÜ
() {

166  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_desütÜ
;

169 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


170 
š‹º®G‘F›ldAcûssÜTabË
() {

171  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_f›ldAcûssÜTabË


172 .
’su»F›ldAcûssÜsIn™Ÿlized
(

173 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Fœew®lRuË.
Bud”
.class);

176 
´iv©e
 
	gb™F›ld0_
;

177 
public
 
fš®
 
	gRULE_ID_FIELD_NUMBER
 = 1;

178 
´iv©e
 
	gruËId_
;

182 
public
 
boŞ—n
 
hasRuËId
() {

183  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

188 
public
 
g‘RuËId
() {

189  
	gruËId_
;

192 
public
 
fš®
 
	gRULE_NAME_FIELD_NUMBER
 = 2;

193 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gruËName_
;

197 
public
 
boŞ—n
 
hasRuËName
() {

198  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

203 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘RuËName
() {

204 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ruËName_
;

205 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

206  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

208 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

209 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

210 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

211 ià(
	gbs
.
isV®idUtf8
()) {

212 
	gruËName_
 = 
s
;

214  
	gs
;

220 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


221 
g‘RuËNameBy‹s
() {

222 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ruËName_
;

223 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

224 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

225 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

226 (
java
.
Ïng
.
SŒšg
è
»f
);

227 
	gruËName_
 = 
b
;

228  
	gb
;

230  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

234 
public
 
fš®
 
	gINPUT_FIELD_NUMBER
 = 3;

235 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gšput_
;

239 
public
 
boŞ—n
 
hasIÅut
() {

240  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

245 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘IÅut
() {

246  
	gšput_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
šput_
;

251 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘IÅutOrBud”
() {

252  
	gšput_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
šput_
;

255 
public
 
fš®
 
	gOUTPUT_FIELD_NUMBER
 = 4;

256 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gouut_
;

260 
public
 
boŞ—n
 
hasOuut
() {

261  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

266 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘Ouut
() {

267  
	gouut_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
ouut_
;

272 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘OuutOrBud”
() {

273  
	gouut_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
ouut_
;

276 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

277 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

278 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

279 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

280 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

282 
	gmemoizedIsIn™Ÿlized
 = 1;

283  
	gŒue
;

286 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

287 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

288 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

289 
ouut
.
wr™eIÁ64
(1, 
ruËId_
);

291 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

292 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
ruËName_
);

294 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

295 
ouut
.
wr™eMes§ge
(3, 
g‘IÅut
());

297 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

298 
ouut
.
wr™eMes§ge
(4, 
g‘Ouut
());

300 
	gunknownF›lds
.
wr™eTo
(
ouut
);

303 
public
 
g‘S”ŸlizedSize
() {

304 
	gsize
 = 
memoizedSize
;

305 ià(
	gsize
 !ğ-1è 
size
;

307 
	gsize
 = 0;

308 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

309 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


310 .
compu‹IÁ64Size
(1, 
ruËId_
);

312 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

313 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
ruËName_
);

315 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

316 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


317 .
compu‹Mes§geSize
(3, 
g‘IÅut
());

319 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

320 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


321 .
compu‹Mes§geSize
(4, 
g‘Ouut
());

323 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

324 
	gmemoizedSize
 = 
size
;

325  
	gsize
;

328 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

329 @
	gjava
.
	gÏng
.
Ov”ride


330 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

331 ià(
	gobj
 =ğ
this
) {

332  
Œue
;

334 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gFœew®lRuË
)) {

335  
	gsu³r
.
equ®s
(
obj
);

337 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Fœew®lRuËè
obj
;

339 
boŞ—n
 
	g»suÉ
 = 
Œue
;

340 
	g»suÉ
 = 
»suÉ
 && (
hasRuËId
(è=ğ
Ùh”
.hasRuleId());

341 ià(
hasRuËId
()) {

342 
	g»suÉ
 = 
»suÉ
 && (
g‘RuËId
()

343 =ğ
Ùh”
.
g‘RuËId
());

345 
	g»suÉ
 = 
»suÉ
 && (
hasRuËName
(è=ğ
Ùh”
.hasRuleName());

346 ià(
hasRuËName
()) {

347 
	g»suÉ
 = 
»suÉ
 && 
g‘RuËName
()

348 .
equ®s
(
Ùh”
.
g‘RuËName
());

350 
	g»suÉ
 = 
»suÉ
 && (
hasIÅut
(è=ğ
Ùh”
.hasInput());

351 ià(
hasIÅut
()) {

352 
	g»suÉ
 = 
»suÉ
 && 
g‘IÅut
()

353 .
equ®s
(
Ùh”
.
g‘IÅut
());

355 
	g»suÉ
 = 
»suÉ
 && (
hasOuut
(è=ğ
Ùh”
.hasOutput());

356 ià(
hasOuut
()) {

357 
	g»suÉ
 = 
»suÉ
 && 
g‘Ouut
()

358 .
equ®s
(
Ùh”
.
g‘Ouut
());

360 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

361  
	g»suÉ
;

364 @
	gjava
.
	gÏng
.
Ov”ride


365 
public
 
hashCode
() {

366 ià(
	gmemoizedHashCode
 != 0) {

367  
memoizedHashCode
;

369 
	ghash
 = 41;

370 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

371 ià(
hasRuËId
()) {

372 
	ghash
 = (37 * 
hash
è+ 
RULE_ID_FIELD_NUMBER
;

373 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

374 
g‘RuËId
());

376 ià(
hasRuËName
()) {

377 
	ghash
 = (37 * 
hash
è+ 
RULE_NAME_FIELD_NUMBER
;

378 
	ghash
 = (53 * 
hash
è+ 
g‘RuËName
().
hashCode
();

380 ià(
hasIÅut
()) {

381 
	ghash
 = (37 * 
hash
è+ 
INPUT_FIELD_NUMBER
;

382 
	ghash
 = (53 * 
hash
è+ 
g‘IÅut
().
hashCode
();

384 ià(
hasOuut
()) {

385 
	ghash
 = (37 * 
hash
è+ 
OUTPUT_FIELD_NUMBER
;

386 
	ghash
 = (53 * 
hash
è+ 
g‘Ouut
().
hashCode
();

388 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

389 
	gmemoizedHashCode
 = 
hash
;

390  
	ghash
;

393 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(

394 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

395 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

396  
	gPARSER
.
·r£From
(
d©a
);

398 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(

399 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

400 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

401 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

402  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

404 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(
by‹
[] 
d©a
)

405 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

406  
	gPARSER
.
·r£From
(
d©a
);

408 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(

409 
by‹
[] 
d©a
,

410 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

411 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

412  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

414 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

415 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

416  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


417 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

419 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(

420 
java
.
io
.
IÅutSŒ—m
 
šput
,

421 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

422 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

423  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


424 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

426 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

427 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

428  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


429 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

431 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£D–im™edFrom
(

432 
java
.
io
.
IÅutSŒ—m
 
šput
,

433 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

434 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

435  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


436 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

438 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(

439 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

440 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

441  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


442 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

444 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
·r£From
(

445 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

446 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

447 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

448  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


449 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

452 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

453 
public
 
Bud”
 
ÃwBud”
() {

454  
	gDEFAULT_INSTANCE
.
toBud”
();

456 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
 
´ÙÙy³
) {

457  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

459 
public
 
Bud”
 
toBud”
() {

460  
	gthis
 =ğ
DEFAULT_INSTANCE


461 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

464 @
	gjava
.
	gÏng
.
Ov”ride


465 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

466 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

467 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

468  
	gbud”
;

473 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


474 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


476 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gFœew®lRuËOrBud”
 {

477 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


478 
g‘DesütÜ
() {

479  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_desütÜ
;

482 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


483 
š‹º®G‘F›ldAcûssÜTabË
() {

484  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_f›ldAcûssÜTabË


485 .
’su»F›ldAcûssÜsIn™Ÿlized
(

486 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Fœew®lRuË.
Bud”
.class);

490 
´iv©e
 
Bud”
() {

491 
maybeFÜûBud”In™Ÿliz©iÚ
();

494 
´iv©e
 
Bud”
(

495 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

496 
su³r
(
·»Á
);

497 
maybeFÜûBud”In™Ÿliz©iÚ
();

499 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

500 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


501 .
	g®waysU£F›ldBud”s
) {

502 
g‘IÅutF›ldBud”
();

503 
g‘OuutF›ldBud”
();

506 
public
 
Bud”
 
ş—r
() {

507 
	gsu³r
.
ş—r
();

508 
	gruËId_
 = 0L;

509 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

510 
	gruËName_
 = "";

511 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

512 ià(
	gšputBud”_
 =ğ
nuÎ
) {

513 
šput_
 = 
nuÎ
;

515 
	gšputBud”_
.
ş—r
();

517 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

518 ià(
	gouutBud”_
 =ğ
nuÎ
) {

519 
ouut_
 = 
nuÎ
;

521 
	gouutBud”_
.
ş—r
();

523 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

524  
	gthis
;

527 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


528 
g‘DesütÜFÜTy³
() {

529  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_desütÜ
;

532 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
g‘DeçuÉIn¡ªûFÜTy³
() {

533  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gFœew®lRuË
.
g‘DeçuÉIn¡ªû
();

536 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
bud
() {

537 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
	g»suÉ
 = 
budP¬tŸl
();

538 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

539 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

541  
	g»suÉ
;

544 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
budP¬tŸl
() {

545 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Fœew®lRuË(
this
);

546 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

547 
	gto_b™F›ld0_
 = 0;

548 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

549 
to_b™F›ld0_
 |= 0x00000001;

551 
	g»suÉ
.
	gruËId_
 = 
ruËId_
;

552 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

553 
to_b™F›ld0_
 |= 0x00000002;

555 
	g»suÉ
.
	gruËName_
 = 
ruËName_
;

556 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

557 
to_b™F›ld0_
 |= 0x00000004;

559 ià(
	gšputBud”_
 =ğ
nuÎ
) {

560 
»suÉ
.
šput_
 = input_;

562 
	g»suÉ
.
	gšput_
 = 
šputBud”_
.
bud
();

564 ià(((
	gäom_b™F›ld0_
 & 0x00000008) == 0x00000008)) {

565 
to_b™F›ld0_
 |= 0x00000008;

567 ià(
	gouutBud”_
 =ğ
nuÎ
) {

568 
»suÉ
.
ouut_
 = output_;

570 
	g»suÉ
.
	gouut_
 = 
ouutBud”_
.
bud
();

572 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

573 
ÚBut
();

574  
	g»suÉ
;

577 
public
 
Bud”
 
şÚe
() {

578  (
	gBud”
è
	gsu³r
.
şÚe
();

580 
public
 
Bud”
 
£tF›ld
(

581 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

582 
Objeù
 
v®ue
) {

583  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

585 
public
 
Bud”
 
ş—rF›ld
(

586 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

587  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

589 
public
 
Bud”
 
ş—rOÃof
(

590 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

591  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

593 
public
 
Bud”
 
£tR•—‹dF›ld
(

594 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

595 
šdex
, 
Objeù
 
v®ue
) {

596  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

598 
public
 
Bud”
 
addR•—‹dF›ld
(

599 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

600 
Objeù
 
v®ue
) {

601  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

603 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

604 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gFœew®lRuË
) {

605  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
)
Ùh”
);

607 
	gsu³r
.
m”geFrom
(
Ùh”
);

608  
	gthis
;

612 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
 
Ùh”
) {

613 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
.
g‘DeçuÉIn¡ªû
()è 
this
;

614 ià(
	gÙh”
.
hasRuËId
()) {

615 
£tRuËId
(
Ùh”
.
g‘RuËId
());

617 ià(
	gÙh”
.
hasRuËName
()) {

618 
	gb™F›ld0_
 |= 0x00000002;

619 
	gruËName_
 = 
Ùh”
.
ruËName_
;

620 
ÚChªged
();

622 ià(
	gÙh”
.
hasIÅut
()) {

623 
m”geIÅut
(
Ùh”
.
g‘IÅut
());

625 ià(
	gÙh”
.
hasOuut
()) {

626 
m”geOuut
(
Ùh”
.
g‘Ouut
());

628 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

629 
ÚChªged
();

630  
	gthis
;

633 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

634  
	gŒue
;

637 
public
 
Bud”
 
m”geFrom
(

638 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

639 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

640 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

641 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
	g·r£dMes§ge
 = 
nuÎ
;

642 
	gŒy
 {

643 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

644 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

645 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
è
e
.
g‘UnfšishedMes§ge
();

646 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

647 } 
	gfš®ly
 {

648 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

649 
m”geFrom
(
·r£dMes§ge
);

652  
	gthis
;

654 
´iv©e
 
	gb™F›ld0_
;

656 
´iv©e
 
	gruËId_
 ;

660 
public
 
boŞ—n
 
hasRuËId
() {

661  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

666 
public
 
g‘RuËId
() {

667  
	gruËId_
;

672 
public
 
Bud”
 
£tRuËId
(
v®ue
) {

673 
	gb™F›ld0_
 |= 0x00000001;

674 
	gruËId_
 = 
v®ue
;

675 
ÚChªged
();

676  
	gthis
;

681 
public
 
Bud”
 
ş—rRuËId
() {

682 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

683 
	gruËId_
 = 0L;

684 
ÚChªged
();

685  
	gthis
;

688 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gruËName_
 = "";

692 
public
 
boŞ—n
 
hasRuËName
() {

693  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

698 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘RuËName
() {

699 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ruËName_
;

700 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

701 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

702 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

703 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

704 ià(
	gbs
.
isV®idUtf8
()) {

705 
	gruËName_
 = 
s
;

707  
	gs
;

709  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

715 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


716 
g‘RuËNameBy‹s
() {

717 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ruËName_
;

718 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

719 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

720 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

721 (
java
.
Ïng
.
SŒšg
è
»f
);

722 
	gruËName_
 = 
b
;

723  
	gb
;

725  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

731 
public
 
Bud”
 
£tRuËName
(

732 
java
.
Ïng
.
SŒšg
 
v®ue
) {

733 ià(
	gv®ue
 =ğ
nuÎ
) {

734 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

736 
	gb™F›ld0_
 |= 0x00000002;

737 
	gruËName_
 = 
v®ue
;

738 
ÚChªged
();

739  
	gthis
;

744 
public
 
Bud”
 
ş—rRuËName
() {

745 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

746 
	gruËName_
 = 
g‘DeçuÉIn¡ªû
().
g‘RuËName
();

747 
ÚChªged
();

748  
	gthis
;

753 
public
 
Bud”
 
£tRuËNameBy‹s
(

754 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

755 ià(
	gv®ue
 =ğ
nuÎ
) {

756 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

758 
	gb™F›ld0_
 |= 0x00000002;

759 
	gruËName_
 = 
v®ue
;

760 
ÚChªged
();

761  
	gthis
;

764 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gšput_
 = 
nuÎ
;

765 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

766 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
> 
	gšputBud”_
;

770 
public
 
boŞ—n
 
hasIÅut
() {

771  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

776 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘IÅut
() {

777 ià(
	gšputBud”_
 =ğ
nuÎ
) {

778  
šput_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
() : input_;

780  
	gšputBud”_
.
g‘Mes§ge
();

786 
public
 
Bud”
 
£tIÅut
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
v®ue
) {

787 ià(
	gšputBud”_
 =ğ
nuÎ
) {

788 ià(
v®ue
 =ğ
nuÎ
) {

789 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

791 
	gšput_
 = 
v®ue
;

792 
ÚChªged
();

794 
	gšputBud”_
.
£tMes§ge
(
v®ue
);

796 
	gb™F›ld0_
 |= 0x00000004;

797  
	gthis
;

802 
public
 
Bud”
 
£tIÅut
(

803 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
Bud”
 
bud”FÜV®ue
) {

804 ià(
	gšputBud”_
 =ğ
nuÎ
) {

805 
šput_
 = 
bud”FÜV®ue
.
bud
();

806 
ÚChªged
();

808 
	gšputBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

810 
	gb™F›ld0_
 |= 0x00000004;

811  
	gthis
;

816 
public
 
Bud”
 
m”geIÅut
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
v®ue
) {

817 ià(
	gšputBud”_
 =ğ
nuÎ
) {

818 ià(((
b™F›ld0_
 & 0x00000004) == 0x00000004) &&

819 
šput_
 !ğ
nuÎ
 &&

820 
šput_
 !ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
()) {

821 
šput_
 =

822 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
ÃwBud”
(
šput_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

824 
	gšput_
 = 
v®ue
;

826 
ÚChªged
();

828 
	gšputBud”_
.
m”geFrom
(
v®ue
);

830 
	gb™F›ld0_
 |= 0x00000004;

831  
	gthis
;

836 
public
 
Bud”
 
ş—rIÅut
() {

837 ià(
	gšputBud”_
 =ğ
nuÎ
) {

838 
šput_
 = 
nuÎ
;

839 
ÚChªged
();

841 
	gšputBud”_
.
ş—r
();

843 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

844  
	gthis
;

849 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
Bud”
 
g‘IÅutBud”
() {

850 
	gb™F›ld0_
 |= 0x00000004;

851 
ÚChªged
();

852  
g‘IÅutF›ldBud”
().
g‘Bud”
();

857 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘IÅutOrBud”
() {

858 ià(
	gšputBud”_
 !ğ
nuÎ
) {

859  
šputBud”_
.
g‘Mes§geOrBud”
();

861  
	gšput_
 =ğ
nuÎ
 ?

862 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
šput_
;

868 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

869 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
>

870 
g‘IÅutF›ldBud”
() {

871 ià(
	gšputBud”_
 =ğ
nuÎ
) {

872 
šputBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

873 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
, 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
>(

874 
g‘IÅut
(),

875 
g‘P¬’tFÜChd»n
(),

876 
isCËª
());

877 
	gšput_
 = 
nuÎ
;

879  
	gšputBud”_
;

882 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gouut_
 = 
nuÎ
;

883 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

884 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
> 
	gouutBud”_
;

888 
public
 
boŞ—n
 
hasOuut
() {

889  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

894 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘Ouut
() {

895 ià(
	gouutBud”_
 =ğ
nuÎ
) {

896  
ouut_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
() : output_;

898  
	gouutBud”_
.
g‘Mes§ge
();

904 
public
 
Bud”
 
£tOuut
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
v®ue
) {

905 ià(
	gouutBud”_
 =ğ
nuÎ
) {

906 ià(
v®ue
 =ğ
nuÎ
) {

907 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

909 
	gouut_
 = 
v®ue
;

910 
ÚChªged
();

912 
	gouutBud”_
.
£tMes§ge
(
v®ue
);

914 
	gb™F›ld0_
 |= 0x00000008;

915  
	gthis
;

920 
public
 
Bud”
 
£tOuut
(

921 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
Bud”
 
bud”FÜV®ue
) {

922 ià(
	gouutBud”_
 =ğ
nuÎ
) {

923 
ouut_
 = 
bud”FÜV®ue
.
bud
();

924 
ÚChªged
();

926 
	gouutBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

928 
	gb™F›ld0_
 |= 0x00000008;

929  
	gthis
;

934 
public
 
Bud”
 
m”geOuut
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
v®ue
) {

935 ià(
	gouutBud”_
 =ğ
nuÎ
) {

936 ià(((
b™F›ld0_
 & 0x00000008) == 0x00000008) &&

937 
ouut_
 !ğ
nuÎ
 &&

938 
ouut_
 !ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
()) {

939 
ouut_
 =

940 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
ÃwBud”
(
ouut_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

942 
	gouut_
 = 
v®ue
;

944 
ÚChªged
();

946 
	gouutBud”_
.
m”geFrom
(
v®ue
);

948 
	gb™F›ld0_
 |= 0x00000008;

949  
	gthis
;

954 
public
 
Bud”
 
ş—rOuut
() {

955 ià(
	gouutBud”_
 =ğ
nuÎ
) {

956 
ouut_
 = 
nuÎ
;

957 
ÚChªged
();

959 
	gouutBud”_
.
ş—r
();

961 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

962  
	gthis
;

967 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
Bud”
 
g‘OuutBud”
() {

968 
	gb™F›ld0_
 |= 0x00000008;

969 
ÚChªged
();

970  
g‘OuutF›ldBud”
().
g‘Bud”
();

975 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘OuutOrBud”
() {

976 ià(
	gouutBud”_
 !ğ
nuÎ
) {

977  
ouutBud”_
.
g‘Mes§geOrBud”
();

979  
	gouut_
 =ğ
nuÎ
 ?

980 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
ouut_
;

986 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

987 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
>

988 
g‘OuutF›ldBud”
() {

989 ià(
	gouutBud”_
 =ğ
nuÎ
) {

990 
ouutBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

991 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
, 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
>(

992 
g‘Ouut
(),

993 
g‘P¬’tFÜChd»n
(),

994 
isCËª
());

995 
	gouut_
 = 
nuÎ
;

997  
	gouutBud”_
;

999 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1000 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1001  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

1004 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1005 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1006  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

1014 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
	gDEFAULT_INSTANCE
;

1016 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Fœew®lRuË
();

1019 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
g‘DeçuÉIn¡ªû
() {

1020  
	gDEFAULT_INSTANCE
;

1023 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gFœew®lRuË
>

1024 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Fœew®lRuË
>() {

1025 
public
 
Fœew®lRuË
 
·r£P¬tŸlFrom
(

1026 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1027 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1028 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1029  
Ãw
 
Fœew®lRuË
(
šput
, 
ex‹nsiÚRegi¡ry
);

1033 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gFœew®lRuË
> 
·r£r
() {

1034  
	gPARSER
;

1037 @
	gjava
.
	gÏng
.
Ov”ride


1038 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gFœew®lRuË
> 
g‘P¬£rFÜTy³
() {

1039  
	gPARSER
;

1042 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Fœew®lRuË
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1043  
	gDEFAULT_INSTANCE
;

1048 
public
 
š‹rçû
 
LogiÿlSw™chOrBud”
 
ex‹nds


1050 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1055 
boŞ—n
 
hasSw™chId
();

1059 
g‘Sw™chId
();

1064 
boŞ—n
 
hasIÅut
();

1068 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘IÅut
();

1072 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘IÅutOrBud”
();

1077 
	gjava
.
	gut
.
	gLi¡
<java.
	gÏng
.
	gLÚg
> 
g‘A¿yLi¡
();

1081 
g‘A¿yCouÁ
();

1085 
g‘A¿y
(
šdex
);

1090 
public
 
fš®
 
şass
 
LogiÿlSw™ch
 
ex‹nds


1091 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1093 
	gLogiÿlSw™chOrBud”
 {

1095 
´iv©e
 
LogiÿlSw™ch
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1096 
su³r
(
bud”
);

1098 
´iv©e
 
LogiÿlSw™ch
() {

1099 
	gsw™chId_
 = 0L;

1100 
	g¬ay_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

1103 @
	gjava
.
	gÏng
.
Ov”ride


1104 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1105 
g‘UnknownF›lds
() {

1106  
	gthis
.
	gunknownF›lds
;

1108 
´iv©e
 
LogiÿlSw™ch
(

1109 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1110 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1111 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1112 
this
();

1113 
	gmubË_b™F›ld0_
 = 0;

1114 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

1115 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

1116 
	gŒy
 {

1117 
boŞ—n
 
	gdÚe
 = 
çl£
;

1118 !
	gdÚe
) {

1119 
	gg
 = 
šput
.
»adTag
();

1120 
	gg
) {

1122 
dÚe
 = 
Œue
;

1125 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

1126 
ex‹nsiÚRegi¡ry
, 
g
)) {

1127 
	gdÚe
 = 
Œue
;

1132 
b™F›ld0_
 |= 0x00000001;

1133 
	gsw™chId_
 = 
šput
.
»adIÁ64
();

1137 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
Bud”
 
subBud”
 = 
nuÎ
;

1138 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1139 
subBud”
 = 
šput_
.
toBud”
();

1141 
	gšput_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
PARSER
, 
ex‹nsiÚRegi¡ry
);

1142 ià(
	gsubBud”
 !ğ
nuÎ
) {

1143 
subBud”
.
m”geFrom
(
šput_
);

1144 
	gšput_
 = 
subBud”
.
budP¬tŸl
();

1146 
	gb™F›ld0_
 |= 0x00000002;

1150 ià(!((
mubË_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

1151 
¬ay_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<java.
Ïng
.
LÚg
>();

1152 
	gmubË_b™F›ld0_
 |= 0x00000004;

1154 
	g¬ay_
.
add
(
šput
.
»adIÁ64
());

1158 
Ëngth
 = 
šput
.
»adRawV¬št32
();

1159 
	glim™
 = 
šput
.
pushLim™
(
Ëngth
);

1160 ià(!((
	gmubË_b™F›ld0_
 & 0x00000004è=ğ0x00000004è&& 
šput
.
g‘By‹sUÁLim™
() > 0) {

1161 
¬ay_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<java.
Ïng
.
LÚg
>();

1162 
	gmubË_b™F›ld0_
 |= 0x00000004;

1164 
	gšput
.
g‘By‹sUÁLim™
() > 0) {

1165 
	g¬ay_
.
add
(
šput
.
»adIÁ64
());

1167 
	gšput
.
pİLim™
(
lim™
);

1172 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1173 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

1174 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

1175 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

1176 
e
).
£tUnfšishedMes§ge
(
this
);

1177 } 
	gfš®ly
 {

1178 ià(((
	gmubË_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

1179 
¬ay_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(aray_);

1181 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

1182 
makeEx‹nsiÚsImmubË
();

1185 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1186 
g‘DesütÜ
() {

1187  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_desütÜ
;

1190 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1191 
š‹º®G‘F›ldAcûssÜTabË
() {

1192  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_f›ldAcûssÜTabË


1193 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1194 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.LogiÿlSw™ch.
Bud”
.class);

1197 
´iv©e
 
	gb™F›ld0_
;

1198 
public
 
fš®
 
	gSWITCH_ID_FIELD_NUMBER
 = 1;

1199 
´iv©e
 
	gsw™chId_
;

1203 
public
 
boŞ—n
 
hasSw™chId
() {

1204  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

1209 
public
 
g‘Sw™chId
() {

1210  
	gsw™chId_
;

1213 
public
 
fš®
 
	gINPUT_FIELD_NUMBER
 = 2;

1214 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gšput_
;

1218 
public
 
boŞ—n
 
hasIÅut
() {

1219  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

1224 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘IÅut
() {

1225  
	gšput_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
šput_
;

1230 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘IÅutOrBud”
() {

1231  
	gšput_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
šput_
;

1234 
public
 
fš®
 
	gARAY_FIELD_NUMBER
 = 3;

1235 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<java.
	gÏng
.
	gLÚg
> 
	g¬ay_
;

1239 
public
 
	gjava
.
	gut
.
	gLi¡
<java.
	gÏng
.
	gLÚg
>

1240 
g‘A¿yLi¡
() {

1241  
	g¬ay_
;

1246 
public
 
g‘A¿yCouÁ
() {

1247  
	g¬ay_
.
size
();

1252 
public
 
g‘A¿y
(
šdex
) {

1253  
	g¬ay_
.
g‘
(
šdex
);

1256 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

1257 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1258 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

1259 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

1260 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

1262 
	gmemoizedIsIn™Ÿlized
 = 1;

1263  
	gŒue
;

1266 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

1267 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1268 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

1269 
ouut
.
wr™eIÁ64
(1, 
sw™chId_
);

1271 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1272 
ouut
.
wr™eMes§ge
(2, 
g‘IÅut
());

1274 
	gi
 = 0; i < 
	g¬ay_
.
size
(); i++) {

1275 
	gouut
.
wr™eIÁ64
(3, 
¬ay_
.
g‘
(
i
));

1277 
	gunknownF›lds
.
wr™eTo
(
ouut
);

1280 
public
 
g‘S”ŸlizedSize
() {

1281 
	gsize
 = 
memoizedSize
;

1282 ià(
	gsize
 !ğ-1è 
size
;

1284 
	gsize
 = 0;

1285 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

1286 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1287 .
compu‹IÁ64Size
(1, 
sw™chId_
);

1289 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1290 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1291 .
compu‹Mes§geSize
(2, 
g‘IÅut
());

1294 
	gd©aSize
 = 0;

1295 
	gi
 = 0; i < 
	g¬ay_
.
size
(); i++) {

1296 
	gd©aSize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1297 .
compu‹IÁ64SizeNoTag
(
¬ay_
.
g‘
(
i
));

1299 
	gsize
 +ğ
d©aSize
;

1300 
	gsize
 +ğ1 * 
g‘A¿yLi¡
().
size
();

1302 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

1303 
	gmemoizedSize
 = 
size
;

1304  
	gsize
;

1307 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

1308 @
	gjava
.
	gÏng
.
Ov”ride


1309 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

1310 ià(
	gobj
 =ğ
this
) {

1311  
Œue
;

1313 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gLogiÿlSw™ch
)) {

1314  
	gsu³r
.
equ®s
(
obj
);

1316 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.LogiÿlSw™chè
obj
;

1318 
boŞ—n
 
	g»suÉ
 = 
Œue
;

1319 
	g»suÉ
 = 
»suÉ
 && (
hasSw™chId
(è=ğ
Ùh”
.hasSwitchId());

1320 ià(
hasSw™chId
()) {

1321 
	g»suÉ
 = 
»suÉ
 && (
g‘Sw™chId
()

1322 =ğ
Ùh”
.
g‘Sw™chId
());

1324 
	g»suÉ
 = 
»suÉ
 && (
hasIÅut
(è=ğ
Ùh”
.hasInput());

1325 ià(
hasIÅut
()) {

1326 
	g»suÉ
 = 
»suÉ
 && 
g‘IÅut
()

1327 .
equ®s
(
Ùh”
.
g‘IÅut
());

1329 
	g»suÉ
 = 
»suÉ
 && 
g‘A¿yLi¡
()

1330 .
equ®s
(
Ùh”
.
g‘A¿yLi¡
());

1331 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

1332  
	g»suÉ
;

1335 @
	gjava
.
	gÏng
.
Ov”ride


1336 
public
 
hashCode
() {

1337 ià(
	gmemoizedHashCode
 != 0) {

1338  
memoizedHashCode
;

1340 
	ghash
 = 41;

1341 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

1342 ià(
hasSw™chId
()) {

1343 
	ghash
 = (37 * 
hash
è+ 
SWITCH_ID_FIELD_NUMBER
;

1344 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

1345 
g‘Sw™chId
());

1347 ià(
hasIÅut
()) {

1348 
	ghash
 = (37 * 
hash
è+ 
INPUT_FIELD_NUMBER
;

1349 
	ghash
 = (53 * 
hash
è+ 
g‘IÅut
().
hashCode
();

1351 ià(
g‘A¿yCouÁ
() > 0) {

1352 
	ghash
 = (37 * 
hash
è+ 
ARAY_FIELD_NUMBER
;

1353 
	ghash
 = (53 * 
hash
è+ 
g‘A¿yLi¡
().
hashCode
();

1355 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

1356 
	gmemoizedHashCode
 = 
hash
;

1357  
	ghash
;

1360 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(

1361 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

1362 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1363  
	gPARSER
.
·r£From
(
d©a
);

1365 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(

1366 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

1367 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1368 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1369  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1371 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(
by‹
[] 
d©a
)

1372 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1373  
	gPARSER
.
·r£From
(
d©a
);

1375 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(

1376 
by‹
[] 
d©a
,

1377 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1378 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1379  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1381 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1382 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1383  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1384 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1386 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(

1387 
java
.
io
.
IÅutSŒ—m
 
šput
,

1388 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1389 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1390  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1391 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1393 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1394 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1395  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1396 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

1398 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£D–im™edFrom
(

1399 
java
.
io
.
IÅutSŒ—m
 
šput
,

1400 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1401 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1402  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1403 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1405 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(

1406 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

1407 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1408  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1409 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1411 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
·r£From
(

1412 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1413 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1414 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1415  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1416 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1419 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

1420 
public
 
Bud”
 
ÃwBud”
() {

1421  
	gDEFAULT_INSTANCE
.
toBud”
();

1423 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
 
´ÙÙy³
) {

1424  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

1426 
public
 
Bud”
 
toBud”
() {

1427  
	gthis
 =ğ
DEFAULT_INSTANCE


1428 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1431 @
	gjava
.
	gÏng
.
Ov”ride


1432 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1433 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1434 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1435  
	gbud”
;

1440 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1441 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1443 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gLogiÿlSw™chOrBud”
 {

1444 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1445 
g‘DesütÜ
() {

1446  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_desütÜ
;

1449 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1450 
š‹º®G‘F›ldAcûssÜTabË
() {

1451  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_f›ldAcûssÜTabË


1452 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1453 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.LogiÿlSw™ch.
Bud”
.class);

1457 
´iv©e
 
Bud”
() {

1458 
maybeFÜûBud”In™Ÿliz©iÚ
();

1461 
´iv©e
 
Bud”
(

1462 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1463 
su³r
(
·»Á
);

1464 
maybeFÜûBud”In™Ÿliz©iÚ
();

1466 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1467 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1468 .
	g®waysU£F›ldBud”s
) {

1469 
g‘IÅutF›ldBud”
();

1472 
public
 
Bud”
 
ş—r
() {

1473 
	gsu³r
.
ş—r
();

1474 
	gsw™chId_
 = 0L;

1475 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

1476 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1477 
šput_
 = 
nuÎ
;

1479 
	gšputBud”_
.
ş—r
();

1481 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

1482 
	g¬ay_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

1483 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1484  
	gthis
;

1487 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1488 
g‘DesütÜFÜTy³
() {

1489  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_desütÜ
;

1492 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1493  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gLogiÿlSw™ch
.
g‘DeçuÉIn¡ªû
();

1496 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
bud
() {

1497 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
	g»suÉ
 = 
budP¬tŸl
();

1498 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1499 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1501  
	g»suÉ
;

1504 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
budP¬tŸl
() {

1505 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.LogiÿlSw™ch(
this
);

1506 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

1507 
	gto_b™F›ld0_
 = 0;

1508 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

1509 
to_b™F›ld0_
 |= 0x00000001;

1511 
	g»suÉ
.
	gsw™chId_
 = 
sw™chId_
;

1512 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

1513 
to_b™F›ld0_
 |= 0x00000002;

1515 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1516 
»suÉ
.
šput_
 = input_;

1518 
	g»suÉ
.
	gšput_
 = 
šputBud”_
.
bud
();

1520 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

1521 
¬ay_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(aray_);

1522 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1524 
	g»suÉ
.
	g¬ay_
 = 
¬ay_
;

1525 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

1526 
ÚBut
();

1527  
	g»suÉ
;

1530 
public
 
Bud”
 
şÚe
() {

1531  (
	gBud”
è
	gsu³r
.
şÚe
();

1533 
public
 
Bud”
 
£tF›ld
(

1534 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1535 
Objeù
 
v®ue
) {

1536  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1538 
public
 
Bud”
 
ş—rF›ld
(

1539 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1540  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1542 
public
 
Bud”
 
ş—rOÃof
(

1543 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1544  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1546 
public
 
Bud”
 
£tR•—‹dF›ld
(

1547 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1548 
šdex
, 
Objeù
 
v®ue
) {

1549  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1551 
public
 
Bud”
 
addR•—‹dF›ld
(

1552 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1553 
Objeù
 
v®ue
) {

1554  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1556 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1557 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gLogiÿlSw™ch
) {

1558  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
)
Ùh”
);

1560 
	gsu³r
.
m”geFrom
(
Ùh”
);

1561  
	gthis
;

1565 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
 
Ùh”
) {

1566 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
.
g‘DeçuÉIn¡ªû
()è 
this
;

1567 ià(
	gÙh”
.
hasSw™chId
()) {

1568 
£tSw™chId
(
Ùh”
.
g‘Sw™chId
());

1570 ià(
	gÙh”
.
hasIÅut
()) {

1571 
m”geIÅut
(
Ùh”
.
g‘IÅut
());

1573 ià(!
	gÙh”
.
	g¬ay_
.
isEm±y
()) {

1574 ià(
	g¬ay_
.
isEm±y
()) {

1575 
	g¬ay_
 = 
Ùh”
.
¬ay_
;

1576 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1578 
’su»A¿yIsMubË
();

1579 
	g¬ay_
.
addAÎ
(
Ùh”
.
¬ay_
);

1581 
ÚChªged
();

1583 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

1584 
ÚChªged
();

1585  
	gthis
;

1588 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1589  
	gŒue
;

1592 
public
 
Bud”
 
m”geFrom
(

1593 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1594 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1595 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1596 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
	g·r£dMes§ge
 = 
nuÎ
;

1597 
	gŒy
 {

1598 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1599 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1600 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
è
e
.
g‘UnfšishedMes§ge
();

1601 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1602 } 
	gfš®ly
 {

1603 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1604 
m”geFrom
(
·r£dMes§ge
);

1607  
	gthis
;

1609 
´iv©e
 
	gb™F›ld0_
;

1611 
´iv©e
 
	gsw™chId_
 ;

1615 
public
 
boŞ—n
 
hasSw™chId
() {

1616  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

1621 
public
 
g‘Sw™chId
() {

1622  
	gsw™chId_
;

1627 
public
 
Bud”
 
£tSw™chId
(
v®ue
) {

1628 
	gb™F›ld0_
 |= 0x00000001;

1629 
	gsw™chId_
 = 
v®ue
;

1630 
ÚChªged
();

1631  
	gthis
;

1636 
public
 
Bud”
 
ş—rSw™chId
() {

1637 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

1638 
	gsw™chId_
 = 0L;

1639 
ÚChªged
();

1640  
	gthis
;

1643 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
	gšput_
 = 
nuÎ
;

1644 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1645 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
> 
	gšputBud”_
;

1649 
public
 
boŞ—n
 
hasIÅut
() {

1650  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

1655 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnû
 
g‘IÅut
() {

1656 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1657  
šput_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
() : input_;

1659  
	gšputBud”_
.
g‘Mes§ge
();

1665 
public
 
Bud”
 
£tIÅut
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
v®ue
) {

1666 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1667 ià(
v®ue
 =ğ
nuÎ
) {

1668 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1670 
	gšput_
 = 
v®ue
;

1671 
ÚChªged
();

1673 
	gšputBud”_
.
£tMes§ge
(
v®ue
);

1675 
	gb™F›ld0_
 |= 0x00000002;

1676  
	gthis
;

1681 
public
 
Bud”
 
£tIÅut
(

1682 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
Bud”
 
bud”FÜV®ue
) {

1683 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1684 
šput_
 = 
bud”FÜV®ue
.
bud
();

1685 
ÚChªged
();

1687 
	gšputBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

1689 
	gb™F›ld0_
 |= 0x00000002;

1690  
	gthis
;

1695 
public
 
Bud”
 
m”geIÅut
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
 
v®ue
) {

1696 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1697 ià(((
b™F›ld0_
 & 0x00000002) == 0x00000002) &&

1698 
šput_
 !ğ
nuÎ
 &&

1699 
šput_
 !ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
()) {

1700 
šput_
 =

1701 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
ÃwBud”
(
šput_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

1703 
	gšput_
 = 
v®ue
;

1705 
ÚChªged
();

1707 
	gšputBud”_
.
m”geFrom
(
v®ue
);

1709 
	gb™F›ld0_
 |= 0x00000002;

1710  
	gthis
;

1715 
public
 
Bud”
 
ş—rIÅut
() {

1716 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1717 
šput_
 = 
nuÎ
;

1718 
ÚChªged
();

1720 
	gšputBud”_
.
ş—r
();

1722 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

1723  
	gthis
;

1728 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
Bud”
 
g‘IÅutBud”
() {

1729 
	gb™F›ld0_
 |= 0x00000002;

1730 
ÚChªged
();

1731  
g‘IÅutF›ldBud”
().
g‘Bud”
();

1736 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
AµlŸnûOrBud”
 
g‘IÅutOrBud”
() {

1737 ià(
	gšputBud”_
 !ğ
nuÎ
) {

1738  
šputBud”_
.
g‘Mes§geOrBud”
();

1740  
	gšput_
 =ğ
nuÎ
 ?

1741 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
.
g‘DeçuÉIn¡ªû
(è: 
šput_
;

1747 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1748 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.AµlŸnû.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
>

1749 
g‘IÅutF›ldBud”
() {

1750 ià(
	gšputBud”_
 =ğ
nuÎ
) {

1751 
šputBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

1752 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
AµlŸnû
, 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
	gAµlŸnû
.
	gBud”
, org.cÜfudb.‹¡.Sam¶eAµlŸnû.
	gAµlŸnûOrBud”
>(

1753 
g‘IÅut
(),

1754 
g‘P¬’tFÜChd»n
(),

1755 
isCËª
());

1756 
	gšput_
 = 
nuÎ
;

1758  
	gšputBud”_
;

1761 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<java.
	gÏng
.
	gLÚg
> 
	g¬ay_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

1762 
´iv©e
 
’su»A¿yIsMubË
() {

1763 ià(!((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

1764 
¬ay_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<java.
Ïng
.
LÚg
>(aray_);

1765 
	gb™F›ld0_
 |= 0x00000004;

1771 
public
 
	gjava
.
	gut
.
	gLi¡
<java.
	gÏng
.
	gLÚg
>

1772 
g‘A¿yLi¡
() {

1773  
	gjava
.
	gut
.
	gCŞËùiÚs
.
unmodifŸbËLi¡
(
¬ay_
);

1778 
public
 
g‘A¿yCouÁ
() {

1779  
	g¬ay_
.
size
();

1784 
public
 
g‘A¿y
(
šdex
) {

1785  
	g¬ay_
.
g‘
(
šdex
);

1790 
public
 
Bud”
 
£tA¿y
(

1791 
šdex
, 
v®ue
) {

1792 
’su»A¿yIsMubË
();

1793 
	g¬ay_
.
£t
(
šdex
, 
v®ue
);

1794 
ÚChªged
();

1795  
	gthis
;

1800 
public
 
Bud”
 
addA¿y
(
v®ue
) {

1801 
’su»A¿yIsMubË
();

1802 
	g¬ay_
.
add
(
v®ue
);

1803 
ÚChªged
();

1804  
	gthis
;

1809 
public
 
Bud”
 
addAÎA¿y
(

1810 
java
.
Ïng
.
I‹¿bË
<? 
ex‹nds
 java.Ïng.
LÚg
> 
v®ues
) {

1811 
’su»A¿yIsMubË
();

1812 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAb¡¿ùMes§geL™e
.
	gBud”
.
addAÎ
(

1813 
v®ues
, 
¬ay_
);

1814 
ÚChªged
();

1815  
	gthis
;

1820 
public
 
Bud”
 
ş—rA¿y
() {

1821 
	g¬ay_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

1822 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1823 
ÚChªged
();

1824  
	gthis
;

1826 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1827 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1828  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

1831 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1832 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1833  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

1841 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
	gDEFAULT_INSTANCE
;

1843 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
LogiÿlSw™ch
();

1846 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
g‘DeçuÉIn¡ªû
() {

1847  
	gDEFAULT_INSTANCE
;

1850 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogiÿlSw™ch
>

1851 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LogiÿlSw™ch
>() {

1852 
public
 
LogiÿlSw™ch
 
·r£P¬tŸlFrom
(

1853 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1854 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1855 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1856  
Ãw
 
LogiÿlSw™ch
(
šput
, 
ex‹nsiÚRegi¡ry
);

1860 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogiÿlSw™ch
> 
·r£r
() {

1861  
	gPARSER
;

1864 @
	gjava
.
	gÏng
.
Ov”ride


1865 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLogiÿlSw™ch
> 
g‘P¬£rFÜTy³
() {

1866  
	gPARSER
;

1869 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
LogiÿlSw™ch
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1870  
	gDEFAULT_INSTANCE
;

1875 
public
 
š‹rçû
 
MªagedResourûsOrBud”
 
ex‹nds


1877 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1882 
boŞ—n
 
hasC»©eU£r
();

1886 
	gjava
.
	gÏng
.
SŒšg
 
g‘C»©eU£r
();

1890 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1891 
g‘C»©eU£rBy‹s
();

1896 
boŞ—n
 
hasV”siÚ
();

1900 
g‘V”siÚ
();

1905 
boŞ—n
 
hasC»©eTime¡amp
();

1909 
g‘C»©eTime¡amp
();

1914 
boŞ—n
 
hasNe¡edTy³
();

1918 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
g‘Ne¡edTy³
();

1922 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³AOrBud”
 
g‘Ne¡edTy³OrBud”
();

1927 
public
 
fš®
 
şass
 
MªagedResourûs
 
ex‹nds


1928 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1930 
	gMªagedResourûsOrBud”
 {

1932 
´iv©e
 
MªagedResourûs
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1933 
su³r
(
bud”
);

1935 
´iv©e
 
MªagedResourûs
() {

1936 
	gü—‹U£r_
 = "";

1937 
	gv”siÚ_
 = 0L;

1938 
	gü—‹Time¡amp_
 = 0L;

1941 @
	gjava
.
	gÏng
.
Ov”ride


1942 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1943 
g‘UnknownF›lds
() {

1944  
	gthis
.
	gunknownF›lds
;

1946 
´iv©e
 
MªagedResourûs
(

1947 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1948 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1949 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1950 
this
();

1951 
	gmubË_b™F›ld0_
 = 0;

1952 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

1953 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

1954 
	gŒy
 {

1955 
boŞ—n
 
	gdÚe
 = 
çl£
;

1956 !
	gdÚe
) {

1957 
	gg
 = 
šput
.
»adTag
();

1958 
	gg
) {

1960 
dÚe
 = 
Œue
;

1963 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

1964 
ex‹nsiÚRegi¡ry
, 
g
)) {

1965 
	gdÚe
 = 
Œue
;

1970 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

1971 
	gb™F›ld0_
 |= 0x00000001;

1972 
	gü—‹U£r_
 = 
bs
;

1976 
b™F›ld0_
 |= 0x00000002;

1977 
	gv”siÚ_
 = 
šput
.
»adIÁ64
();

1981 
b™F›ld0_
 |= 0x00000004;

1982 
	gü—‹Time¡amp_
 = 
šput
.
»adIÁ64
();

1986 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
Bud”
 
subBud”
 = 
nuÎ
;

1987 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

1988 
subBud”
 = 
Ã¡edTy³_
.
toBud”
();

1990 
	gÃ¡edTy³_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
PARSER
, 
ex‹nsiÚRegi¡ry
);

1991 ià(
	gsubBud”
 !ğ
nuÎ
) {

1992 
subBud”
.
m”geFrom
(
Ã¡edTy³_
);

1993 
	gÃ¡edTy³_
 = 
subBud”
.
budP¬tŸl
();

1995 
	gb™F›ld0_
 |= 0x00000008;

2000 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2001 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

2002 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

2003 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

2004 
e
).
£tUnfšishedMes§ge
(
this
);

2005 } 
	gfš®ly
 {

2006 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

2007 
makeEx‹nsiÚsImmubË
();

2010 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2011 
g‘DesütÜ
() {

2012  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

2015 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2016 
š‹º®G‘F›ldAcûssÜTabË
() {

2017  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË


2018 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2019 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.MªagedResourûs.
Bud”
.class);

2022 
´iv©e
 
	gb™F›ld0_
;

2023 
public
 
fš®
 
	gCREATE_USER_FIELD_NUMBER
 = 1;

2024 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gü—‹U£r_
;

2028 
public
 
boŞ—n
 
hasC»©eU£r
() {

2029  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

2034 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C»©eU£r
() {

2035 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

2036 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

2037  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2039 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2040 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2041 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2042 ià(
	gbs
.
isV®idUtf8
()) {

2043 
	gü—‹U£r_
 = 
s
;

2045  
	gs
;

2051 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2052 
g‘C»©eU£rBy‹s
() {

2053 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

2054 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

2055 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2056 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2057 (
java
.
Ïng
.
SŒšg
è
»f
);

2058 
	gü—‹U£r_
 = 
b
;

2059  
	gb
;

2061  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2065 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 2;

2066 
´iv©e
 
	gv”siÚ_
;

2070 
public
 
boŞ—n
 
hasV”siÚ
() {

2071  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

2076 
public
 
g‘V”siÚ
() {

2077  
	gv”siÚ_
;

2080 
public
 
fš®
 
	gCREATE_TIMESTAMP_FIELD_NUMBER
 = 3;

2081 
´iv©e
 
	gü—‹Time¡amp_
;

2085 
public
 
boŞ—n
 
hasC»©eTime¡amp
() {

2086  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

2091 
public
 
g‘C»©eTime¡amp
() {

2092  
	gü—‹Time¡amp_
;

2095 
public
 
fš®
 
	gNESTED_TYPE_FIELD_NUMBER
 = 4;

2096 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	gÃ¡edTy³_
;

2100 
public
 
boŞ—n
 
hasNe¡edTy³
() {

2101  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

2106 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
g‘Ne¡edTy³
() {

2107  
	gÃ¡edTy³_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
g‘DeçuÉIn¡ªû
(è: 
Ã¡edTy³_
;

2112 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³AOrBud”
 
g‘Ne¡edTy³OrBud”
() {

2113  
	gÃ¡edTy³_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
g‘DeçuÉIn¡ªû
(è: 
Ã¡edTy³_
;

2116 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

2117 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2118 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

2119 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

2120 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

2122 
	gmemoizedIsIn™Ÿlized
 = 1;

2123  
	gŒue
;

2126 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

2127 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2128 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

2129 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
ü—‹U£r_
);

2131 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

2132 
ouut
.
wr™eIÁ64
(2, 
v”siÚ_
);

2134 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

2135 
ouut
.
wr™eIÁ64
(3, 
ü—‹Time¡amp_
);

2137 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

2138 
ouut
.
wr™eMes§ge
(4, 
g‘Ne¡edTy³
());

2140 
	gunknownF›lds
.
wr™eTo
(
ouut
);

2143 
public
 
g‘S”ŸlizedSize
() {

2144 
	gsize
 = 
memoizedSize
;

2145 ià(
	gsize
 !ğ-1è 
size
;

2147 
	gsize
 = 0;

2148 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

2149 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
ü—‹U£r_
);

2151 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

2152 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2153 .
compu‹IÁ64Size
(2, 
v”siÚ_
);

2155 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

2156 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2157 .
compu‹IÁ64Size
(3, 
ü—‹Time¡amp_
);

2159 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

2160 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


2161 .
compu‹Mes§geSize
(4, 
g‘Ne¡edTy³
());

2163 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

2164 
	gmemoizedSize
 = 
size
;

2165  
	gsize
;

2168 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

2169 @
	gjava
.
	gÏng
.
Ov”ride


2170 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

2171 ià(
	gobj
 =ğ
this
) {

2172  
Œue
;

2174 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûs
)) {

2175  
	gsu³r
.
equ®s
(
obj
);

2177 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.MªagedResourûsè
obj
;

2179 
boŞ—n
 
	g»suÉ
 = 
Œue
;

2180 
	g»suÉ
 = 
»suÉ
 && (
hasC»©eU£r
(è=ğ
Ùh”
.hasCreateUser());

2181 ià(
hasC»©eU£r
()) {

2182 
	g»suÉ
 = 
»suÉ
 && 
g‘C»©eU£r
()

2183 .
equ®s
(
Ùh”
.
g‘C»©eU£r
());

2185 
	g»suÉ
 = 
»suÉ
 && (
hasV”siÚ
(è=ğ
Ùh”
.hasVersion());

2186 ià(
hasV”siÚ
()) {

2187 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

2188 =ğ
Ùh”
.
g‘V”siÚ
());

2190 
	g»suÉ
 = 
»suÉ
 && (
hasC»©eTime¡amp
(è=ğ
Ùh”
.hasCreateTimestamp());

2191 ià(
hasC»©eTime¡amp
()) {

2192 
	g»suÉ
 = 
»suÉ
 && (
g‘C»©eTime¡amp
()

2193 =ğ
Ùh”
.
g‘C»©eTime¡amp
());

2195 
	g»suÉ
 = 
»suÉ
 && (
hasNe¡edTy³
(è=ğ
Ùh”
.hasNestedType());

2196 ià(
hasNe¡edTy³
()) {

2197 
	g»suÉ
 = 
»suÉ
 && 
g‘Ne¡edTy³
()

2198 .
equ®s
(
Ùh”
.
g‘Ne¡edTy³
());

2200 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

2201  
	g»suÉ
;

2204 @
	gjava
.
	gÏng
.
Ov”ride


2205 
public
 
hashCode
() {

2206 ià(
	gmemoizedHashCode
 != 0) {

2207  
memoizedHashCode
;

2209 
	ghash
 = 41;

2210 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

2211 ià(
hasC»©eU£r
()) {

2212 
	ghash
 = (37 * 
hash
è+ 
CREATE_USER_FIELD_NUMBER
;

2213 
	ghash
 = (53 * 
hash
è+ 
g‘C»©eU£r
().
hashCode
();

2215 ià(
hasV”siÚ
()) {

2216 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

2217 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2218 
g‘V”siÚ
());

2220 ià(
hasC»©eTime¡amp
()) {

2221 
	ghash
 = (37 * 
hash
è+ 
CREATE_TIMESTAMP_FIELD_NUMBER
;

2222 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

2223 
g‘C»©eTime¡amp
());

2225 ià(
hasNe¡edTy³
()) {

2226 
	ghash
 = (37 * 
hash
è+ 
NESTED_TYPE_FIELD_NUMBER
;

2227 
	ghash
 = (53 * 
hash
è+ 
g‘Ne¡edTy³
().
hashCode
();

2229 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

2230 
	gmemoizedHashCode
 = 
hash
;

2231  
	ghash
;

2234 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(

2235 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

2236 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2237  
	gPARSER
.
·r£From
(
d©a
);

2239 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(

2240 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

2241 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2242 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2243  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2245 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(
by‹
[] 
d©a
)

2246 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2247  
	gPARSER
.
·r£From
(
d©a
);

2249 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(

2250 
by‹
[] 
d©a
,

2251 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2252 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2253  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

2255 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2256 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2257  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2258 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2260 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(

2261 
java
.
io
.
IÅutSŒ—m
 
šput
,

2262 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2263 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2264  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2265 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2267 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

2268 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2269  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2270 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

2272 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£D–im™edFrom
(

2273 
java
.
io
.
IÅutSŒ—m
 
šput
,

2274 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2275 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2276  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2277 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2279 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(

2280 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

2281 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2282  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2283 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

2285 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
·r£From
(

2286 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2287 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2288 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2289  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2290 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

2293 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

2294 
public
 
Bud”
 
ÃwBud”
() {

2295  
	gDEFAULT_INSTANCE
.
toBud”
();

2297 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
 
´ÙÙy³
) {

2298  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

2300 
public
 
Bud”
 
toBud”
() {

2301  
	gthis
 =ğ
DEFAULT_INSTANCE


2302 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

2305 @
	gjava
.
	gÏng
.
Ov”ride


2306 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

2307 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2308 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

2309  
	gbud”
;

2314 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


2315 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


2317 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûsOrBud”
 {

2318 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2319 
g‘DesütÜ
() {

2320  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

2323 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2324 
š‹º®G‘F›ldAcûssÜTabË
() {

2325  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË


2326 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2327 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.MªagedResourûs.
Bud”
.class);

2331 
´iv©e
 
Bud”
() {

2332 
maybeFÜûBud”In™Ÿliz©iÚ
();

2335 
´iv©e
 
Bud”
(

2336 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

2337 
su³r
(
·»Á
);

2338 
maybeFÜûBud”In™Ÿliz©iÚ
();

2340 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

2341 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


2342 .
	g®waysU£F›ldBud”s
) {

2343 
g‘Ne¡edTy³F›ldBud”
();

2346 
public
 
Bud”
 
ş—r
() {

2347 
	gsu³r
.
ş—r
();

2348 
	gü—‹U£r_
 = "";

2349 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

2350 
	gv”siÚ_
 = 0L;

2351 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

2352 
	gü—‹Time¡amp_
 = 0L;

2353 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2354 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2355 
Ã¡edTy³_
 = 
nuÎ
;

2357 
	gÃ¡edTy³Bud”_
.
ş—r
();

2359 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

2360  
	gthis
;

2363 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2364 
g‘DesütÜFÜTy³
() {

2365  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

2368 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2369  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûs
.
g‘DeçuÉIn¡ªû
();

2372 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
bud
() {

2373 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
	g»suÉ
 = 
budP¬tŸl
();

2374 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

2375 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

2377  
	g»suÉ
;

2380 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
budP¬tŸl
() {

2381 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.MªagedResourûs(
this
);

2382 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

2383 
	gto_b™F›ld0_
 = 0;

2384 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

2385 
to_b™F›ld0_
 |= 0x00000001;

2387 
	g»suÉ
.
	gü—‹U£r_
 = 
ü—‹U£r_
;

2388 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

2389 
to_b™F›ld0_
 |= 0x00000002;

2391 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

2392 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

2393 
to_b™F›ld0_
 |= 0x00000004;

2395 
	g»suÉ
.
	gü—‹Time¡amp_
 = 
ü—‹Time¡amp_
;

2396 ià(((
	gäom_b™F›ld0_
 & 0x00000008) == 0x00000008)) {

2397 
to_b™F›ld0_
 |= 0x00000008;

2399 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2400 
»suÉ
.
Ã¡edTy³_
 =‚estedType_;

2402 
	g»suÉ
.
	gÃ¡edTy³_
 = 
Ã¡edTy³Bud”_
.
bud
();

2404 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

2405 
ÚBut
();

2406  
	g»suÉ
;

2409 
public
 
Bud”
 
şÚe
() {

2410  (
	gBud”
è
	gsu³r
.
şÚe
();

2412 
public
 
Bud”
 
£tF›ld
(

2413 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2414 
Objeù
 
v®ue
) {

2415  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

2417 
public
 
Bud”
 
ş—rF›ld
(

2418 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

2419  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

2421 
public
 
Bud”
 
ş—rOÃof
(

2422 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

2423  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

2425 
public
 
Bud”
 
£tR•—‹dF›ld
(

2426 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2427 
šdex
, 
Objeù
 
v®ue
) {

2428  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

2430 
public
 
Bud”
 
addR•—‹dF›ld
(

2431 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

2432 
Objeù
 
v®ue
) {

2433  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

2435 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

2436 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûs
) {

2437  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
)
Ùh”
);

2439 
	gsu³r
.
m”geFrom
(
Ùh”
);

2440  
	gthis
;

2444 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
 
Ùh”
) {

2445 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
.
g‘DeçuÉIn¡ªû
()è 
this
;

2446 ià(
	gÙh”
.
hasC»©eU£r
()) {

2447 
	gb™F›ld0_
 |= 0x00000001;

2448 
	gü—‹U£r_
 = 
Ùh”
.
ü—‹U£r_
;

2449 
ÚChªged
();

2451 ià(
	gÙh”
.
hasV”siÚ
()) {

2452 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

2454 ià(
	gÙh”
.
hasC»©eTime¡amp
()) {

2455 
£tC»©eTime¡amp
(
Ùh”
.
g‘C»©eTime¡amp
());

2457 ià(
	gÙh”
.
hasNe¡edTy³
()) {

2458 
m”geNe¡edTy³
(
Ùh”
.
g‘Ne¡edTy³
());

2460 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

2461 
ÚChªged
();

2462  
	gthis
;

2465 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

2466  
	gŒue
;

2469 
public
 
Bud”
 
m”geFrom
(

2470 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2471 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2472 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

2473 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
	g·r£dMes§ge
 = 
nuÎ
;

2474 
	gŒy
 {

2475 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

2476 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2477 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
è
e
.
g‘UnfšishedMes§ge
();

2478 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

2479 } 
	gfš®ly
 {

2480 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

2481 
m”geFrom
(
·r£dMes§ge
);

2484  
	gthis
;

2486 
´iv©e
 
	gb™F›ld0_
;

2488 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gü—‹U£r_
 = "";

2492 
public
 
boŞ—n
 
hasC»©eU£r
() {

2493  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

2498 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C»©eU£r
() {

2499 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

2500 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

2501 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2502 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2503 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2504 ià(
	gbs
.
isV®idUtf8
()) {

2505 
	gü—‹U£r_
 = 
s
;

2507  
	gs
;

2509  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2515 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2516 
g‘C»©eU£rBy‹s
() {

2517 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

2518 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

2519 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2520 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2521 (
java
.
Ïng
.
SŒšg
è
»f
);

2522 
	gü—‹U£r_
 = 
b
;

2523  
	gb
;

2525  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

2531 
public
 
Bud”
 
£tC»©eU£r
(

2532 
java
.
Ïng
.
SŒšg
 
v®ue
) {

2533 ià(
	gv®ue
 =ğ
nuÎ
) {

2534 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2536 
	gb™F›ld0_
 |= 0x00000001;

2537 
	gü—‹U£r_
 = 
v®ue
;

2538 
ÚChªged
();

2539  
	gthis
;

2544 
public
 
Bud”
 
ş—rC»©eU£r
() {

2545 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

2546 
	gü—‹U£r_
 = 
g‘DeçuÉIn¡ªû
().
g‘C»©eU£r
();

2547 
ÚChªged
();

2548  
	gthis
;

2553 
public
 
Bud”
 
£tC»©eU£rBy‹s
(

2554 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2555 ià(
	gv®ue
 =ğ
nuÎ
) {

2556 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2558 
	gb™F›ld0_
 |= 0x00000001;

2559 
	gü—‹U£r_
 = 
v®ue
;

2560 
ÚChªged
();

2561  
	gthis
;

2564 
´iv©e
 
	gv”siÚ_
 ;

2568 
public
 
boŞ—n
 
hasV”siÚ
() {

2569  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

2574 
public
 
g‘V”siÚ
() {

2575  
	gv”siÚ_
;

2580 
public
 
Bud”
 
£tV”siÚ
(
v®ue
) {

2581 
	gb™F›ld0_
 |= 0x00000002;

2582 
	gv”siÚ_
 = 
v®ue
;

2583 
ÚChªged
();

2584  
	gthis
;

2589 
public
 
Bud”
 
ş—rV”siÚ
() {

2590 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

2591 
	gv”siÚ_
 = 0L;

2592 
ÚChªged
();

2593  
	gthis
;

2596 
´iv©e
 
	gü—‹Time¡amp_
 ;

2600 
public
 
boŞ—n
 
hasC»©eTime¡amp
() {

2601  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

2606 
public
 
g‘C»©eTime¡amp
() {

2607  
	gü—‹Time¡amp_
;

2612 
public
 
Bud”
 
£tC»©eTime¡amp
(
v®ue
) {

2613 
	gb™F›ld0_
 |= 0x00000004;

2614 
	gü—‹Time¡amp_
 = 
v®ue
;

2615 
ÚChªged
();

2616  
	gthis
;

2621 
public
 
Bud”
 
ş—rC»©eTime¡amp
() {

2622 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

2623 
	gü—‹Time¡amp_
 = 0L;

2624 
ÚChªged
();

2625  
	gthis
;

2628 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	gÃ¡edTy³_
 = 
nuÎ
;

2629 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

2630 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³A.
	gBud”
, org.cÜfudb.‹¡.Sam¶eSchema.
	gNe¡edTy³AOrBud”
> 
	gÃ¡edTy³Bud”_
;

2634 
public
 
boŞ—n
 
hasNe¡edTy³
() {

2635  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

2640 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
g‘Ne¡edTy³
() {

2641 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2642  
Ã¡edTy³_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
g‘DeçuÉIn¡ªû
() :‚estedType_;

2644  
	gÃ¡edTy³Bud”_
.
g‘Mes§ge
();

2650 
public
 
Bud”
 
£tNe¡edTy³
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
 
v®ue
) {

2651 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2652 ià(
v®ue
 =ğ
nuÎ
) {

2653 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2655 
	gÃ¡edTy³_
 = 
v®ue
;

2656 
ÚChªged
();

2658 
	gÃ¡edTy³Bud”_
.
£tMes§ge
(
v®ue
);

2660 
	gb™F›ld0_
 |= 0x00000008;

2661  
	gthis
;

2666 
public
 
Bud”
 
£tNe¡edTy³
(

2667 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
Bud”
 
bud”FÜV®ue
) {

2668 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2669 
Ã¡edTy³_
 = 
bud”FÜV®ue
.
bud
();

2670 
ÚChªged
();

2672 
	gÃ¡edTy³Bud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

2674 
	gb™F›ld0_
 |= 0x00000008;

2675  
	gthis
;

2680 
public
 
Bud”
 
m”geNe¡edTy³
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
 
v®ue
) {

2681 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2682 ià(((
b™F›ld0_
 & 0x00000008) == 0x00000008) &&

2683 
Ã¡edTy³_
 !ğ
nuÎ
 &&

2684 
Ã¡edTy³_
 !ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
g‘DeçuÉIn¡ªû
()) {

2685 
Ã¡edTy³_
 =

2686 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
ÃwBud”
(
Ã¡edTy³_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

2688 
	gÃ¡edTy³_
 = 
v®ue
;

2690 
ÚChªged
();

2692 
	gÃ¡edTy³Bud”_
.
m”geFrom
(
v®ue
);

2694 
	gb™F›ld0_
 |= 0x00000008;

2695  
	gthis
;

2700 
public
 
Bud”
 
ş—rNe¡edTy³
() {

2701 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2702 
Ã¡edTy³_
 = 
nuÎ
;

2703 
ÚChªged
();

2705 
	gÃ¡edTy³Bud”_
.
ş—r
();

2707 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

2708  
	gthis
;

2713 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
.
Bud”
 
g‘Ne¡edTy³Bud”
() {

2714 
	gb™F›ld0_
 |= 0x00000008;

2715 
ÚChªged
();

2716  
g‘Ne¡edTy³F›ldBud”
().
g‘Bud”
();

2721 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³AOrBud”
 
g‘Ne¡edTy³OrBud”
() {

2722 ià(
	gÃ¡edTy³Bud”_
 !ğ
nuÎ
) {

2723  
Ã¡edTy³Bud”_
.
g‘Mes§geOrBud”
();

2725  
	gÃ¡edTy³_
 =ğ
nuÎ
 ?

2726 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
g‘DeçuÉIn¡ªû
(è: 
Ã¡edTy³_
;

2732 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

2733 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³A.
	gBud”
, org.cÜfudb.‹¡.Sam¶eSchema.
	gNe¡edTy³AOrBud”
>

2734 
g‘Ne¡edTy³F›ldBud”
() {

2735 ià(
	gÃ¡edTy³Bud”_
 =ğ
nuÎ
) {

2736 
Ã¡edTy³Bud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

2737 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
, 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
.
	gBud”
, org.cÜfudb.‹¡.Sam¶eSchema.
	gNe¡edTy³AOrBud”
>(

2738 
g‘Ne¡edTy³
(),

2739 
g‘P¬’tFÜChd»n
(),

2740 
isCËª
());

2741 
	gÃ¡edTy³_
 = 
nuÎ
;

2743  
	gÃ¡edTy³Bud”_
;

2745 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

2746 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2747  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

2750 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

2751 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2752  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

2760 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
	gDEFAULT_INSTANCE
;

2762 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûs
();

2765 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
g‘DeçuÉIn¡ªû
() {

2766  
	gDEFAULT_INSTANCE
;

2769 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûs
>

2770 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
MªagedResourûs
>() {

2771 
public
 
MªagedResourûs
 
·r£P¬tŸlFrom
(

2772 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2773 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2774 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

2775  
Ãw
 
MªagedResourûs
(
šput
, 
ex‹nsiÚRegi¡ry
);

2779 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûs
> 
·r£r
() {

2780  
	gPARSER
;

2783 @
	gjava
.
	gÏng
.
Ov”ride


2784 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûs
> 
g‘P¬£rFÜTy³
() {

2785  
	gPARSER
;

2788 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2789  
	gDEFAULT_INSTANCE
;

2794 
public
 
š‹rçû
 
Ev’tInfoOrBud”
 
ex‹nds


2796 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

2801 
boŞ—n
 
hasId
();

2805 
g‘Id
();

2810 
boŞ—n
 
hasName
();

2814 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
();

2818 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2819 
g‘NameBy‹s
();

2824 
boŞ—n
 
hasPÜt
();

2828 
g‘PÜt
();

2833 
boŞ—n
 
hasEv’tTime
();

2837 
g‘Ev’tTime
();

2842 
boŞ—n
 
hasF»qu’cy
();

2846 
g‘F»qu’cy
();

2851 
public
 
fš®
 
şass
 
Ev’tInfo
 
ex‹nds


2852 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


2854 
	gEv’tInfoOrBud”
 {

2856 
´iv©e
 
Ev’tInfo
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

2857 
su³r
(
bud”
);

2859 
´iv©e
 
Ev’tInfo
() {

2860 
	gid_
 = 0;

2861 
	gÇme_
 = "";

2862 
	gpÜt_
 = 0;

2863 
	gev’tTime_
 = 0L;

2864 
	gäequ’cy_
 = 0;

2867 @
	gjava
.
	gÏng
.
Ov”ride


2868 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


2869 
g‘UnknownF›lds
() {

2870  
	gthis
.
	gunknownF›lds
;

2872 
´iv©e
 
Ev’tInfo
(

2873 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2874 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2875 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

2876 
this
();

2877 
	gmubË_b™F›ld0_
 = 0;

2878 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

2879 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

2880 
	gŒy
 {

2881 
boŞ—n
 
	gdÚe
 = 
çl£
;

2882 !
	gdÚe
) {

2883 
	gg
 = 
šput
.
»adTag
();

2884 
	gg
) {

2886 
dÚe
 = 
Œue
;

2889 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

2890 
ex‹nsiÚRegi¡ry
, 
g
)) {

2891 
	gdÚe
 = 
Œue
;

2896 
b™F›ld0_
 |= 0x00000001;

2897 
	gid_
 = 
šput
.
»adUIÁ32
();

2901 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

2902 
	gb™F›ld0_
 |= 0x00000002;

2903 
	gÇme_
 = 
bs
;

2907 
b™F›ld0_
 |= 0x00000004;

2908 
	gpÜt_
 = 
šput
.
»adUIÁ32
();

2912 
b™F›ld0_
 |= 0x00000008;

2913 
	gev’tTime_
 = 
šput
.
»adIÁ64
();

2917 
b™F›ld0_
 |= 0x00000010;

2918 
	gäequ’cy_
 = 
šput
.
»adUIÁ32
();

2923 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

2924 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

2925 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

2926 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

2927 
e
).
£tUnfšishedMes§ge
(
this
);

2928 } 
	gfš®ly
 {

2929 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

2930 
makeEx‹nsiÚsImmubË
();

2933 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2934 
g‘DesütÜ
() {

2935  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

2938 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2939 
š‹º®G‘F›ldAcûssÜTabË
() {

2940  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË


2941 .
’su»F›ldAcûssÜsIn™Ÿlized
(

2942 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Ev’tInfo.
Bud”
.class);

2945 
´iv©e
 
	gb™F›ld0_
;

2946 
public
 
fš®
 
	gID_FIELD_NUMBER
 = 1;

2947 
´iv©e
 
	gid_
;

2951 
public
 
boŞ—n
 
hasId
() {

2952  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

2957 
public
 
g‘Id
() {

2958  
	gid_
;

2961 
public
 
fš®
 
	gNAME_FIELD_NUMBER
 = 2;

2962 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gÇme_
;

2966 
public
 
boŞ—n
 
hasName
() {

2967  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

2972 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
() {

2973 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

2974 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

2975  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

2977 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

2978 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

2979 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

2980 ià(
	gbs
.
isV®idUtf8
()) {

2981 
	gÇme_
 = 
s
;

2983  
	gs
;

2989 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


2990 
g‘NameBy‹s
() {

2991 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

2992 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

2993 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

2994 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

2995 (
java
.
Ïng
.
SŒšg
è
»f
);

2996 
	gÇme_
 = 
b
;

2997  
	gb
;

2999  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3003 
public
 
fš®
 
	gPORT_FIELD_NUMBER
 = 3;

3004 
´iv©e
 
	gpÜt_
;

3008 
public
 
boŞ—n
 
hasPÜt
() {

3009  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

3014 
public
 
g‘PÜt
() {

3015  
	gpÜt_
;

3018 
public
 
fš®
 
	gEVENT_TIME_FIELD_NUMBER
 = 4;

3019 
´iv©e
 
	gev’tTime_
;

3023 
public
 
boŞ—n
 
hasEv’tTime
() {

3024  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

3029 
public
 
g‘Ev’tTime
() {

3030  
	gev’tTime_
;

3033 
public
 
fš®
 
	gFREQUENCY_FIELD_NUMBER
 = 5;

3034 
´iv©e
 
	gäequ’cy_
;

3038 
public
 
boŞ—n
 
hasF»qu’cy
() {

3039  ((
	gb™F›ld0_
 & 0x00000010) == 0x00000010);

3044 
public
 
g‘F»qu’cy
() {

3045  
	gäequ’cy_
;

3048 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

3049 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3050 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

3051 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

3052 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

3054 
	gmemoizedIsIn™Ÿlized
 = 1;

3055  
	gŒue
;

3058 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

3059 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3060 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

3061 
ouut
.
wr™eUIÁ32
(1, 
id_
);

3063 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

3064 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
Çme_
);

3066 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

3067 
ouut
.
wr™eUIÁ32
(3, 
pÜt_
);

3069 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

3070 
ouut
.
wr™eIÁ64
(4, 
ev’tTime_
);

3072 ià(((
	gb™F›ld0_
 & 0x00000010) == 0x00000010)) {

3073 
ouut
.
wr™eUIÁ32
(5, 
äequ’cy_
);

3075 
	gunknownF›lds
.
wr™eTo
(
ouut
);

3078 
public
 
g‘S”ŸlizedSize
() {

3079 
	gsize
 = 
memoizedSize
;

3080 ià(
	gsize
 !ğ-1è 
size
;

3082 
	gsize
 = 0;

3083 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

3084 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3085 .
compu‹UIÁ32Size
(1, 
id_
);

3087 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

3088 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
Çme_
);

3090 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

3091 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3092 .
compu‹UIÁ32Size
(3, 
pÜt_
);

3094 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

3095 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3096 .
compu‹IÁ64Size
(4, 
ev’tTime_
);

3098 ià(((
	gb™F›ld0_
 & 0x00000010) == 0x00000010)) {

3099 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3100 .
compu‹UIÁ32Size
(5, 
äequ’cy_
);

3102 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

3103 
	gmemoizedSize
 = 
size
;

3104  
	gsize
;

3107 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

3108 @
	gjava
.
	gÏng
.
Ov”ride


3109 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

3110 ià(
	gobj
 =ğ
this
) {

3111  
Œue
;

3113 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfo
)) {

3114  
	gsu³r
.
equ®s
(
obj
);

3116 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Ev’tInfoè
obj
;

3118 
boŞ—n
 
	g»suÉ
 = 
Œue
;

3119 
	g»suÉ
 = 
»suÉ
 && (
hasId
(è=ğ
Ùh”
.hasId());

3120 ià(
hasId
()) {

3121 
	g»suÉ
 = 
»suÉ
 && (
g‘Id
()

3122 =ğ
Ùh”
.
g‘Id
());

3124 
	g»suÉ
 = 
»suÉ
 && (
hasName
(è=ğ
Ùh”
.hasName());

3125 ià(
hasName
()) {

3126 
	g»suÉ
 = 
»suÉ
 && 
g‘Name
()

3127 .
equ®s
(
Ùh”
.
g‘Name
());

3129 
	g»suÉ
 = 
»suÉ
 && (
hasPÜt
(è=ğ
Ùh”
.hasPort());

3130 ià(
hasPÜt
()) {

3131 
	g»suÉ
 = 
»suÉ
 && (
g‘PÜt
()

3132 =ğ
Ùh”
.
g‘PÜt
());

3134 
	g»suÉ
 = 
»suÉ
 && (
hasEv’tTime
(è=ğ
Ùh”
.hasEventTime());

3135 ià(
hasEv’tTime
()) {

3136 
	g»suÉ
 = 
»suÉ
 && (
g‘Ev’tTime
()

3137 =ğ
Ùh”
.
g‘Ev’tTime
());

3139 
	g»suÉ
 = 
»suÉ
 && (
hasF»qu’cy
(è=ğ
Ùh”
.hasFrequency());

3140 ià(
hasF»qu’cy
()) {

3141 
	g»suÉ
 = 
»suÉ
 && (
g‘F»qu’cy
()

3142 =ğ
Ùh”
.
g‘F»qu’cy
());

3144 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

3145  
	g»suÉ
;

3148 @
	gjava
.
	gÏng
.
Ov”ride


3149 
public
 
hashCode
() {

3150 ià(
	gmemoizedHashCode
 != 0) {

3151  
memoizedHashCode
;

3153 
	ghash
 = 41;

3154 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

3155 ià(
hasId
()) {

3156 
	ghash
 = (37 * 
hash
è+ 
ID_FIELD_NUMBER
;

3157 
	ghash
 = (53 * 
hash
è+ 
g‘Id
();

3159 ià(
hasName
()) {

3160 
	ghash
 = (37 * 
hash
è+ 
NAME_FIELD_NUMBER
;

3161 
	ghash
 = (53 * 
hash
è+ 
g‘Name
().
hashCode
();

3163 ià(
hasPÜt
()) {

3164 
	ghash
 = (37 * 
hash
è+ 
PORT_FIELD_NUMBER
;

3165 
	ghash
 = (53 * 
hash
è+ 
g‘PÜt
();

3167 ià(
hasEv’tTime
()) {

3168 
	ghash
 = (37 * 
hash
è+ 
EVENT_TIME_FIELD_NUMBER
;

3169 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

3170 
g‘Ev’tTime
());

3172 ià(
hasF»qu’cy
()) {

3173 
	ghash
 = (37 * 
hash
è+ 
FREQUENCY_FIELD_NUMBER
;

3174 
	ghash
 = (53 * 
hash
è+ 
g‘F»qu’cy
();

3176 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

3177 
	gmemoizedHashCode
 = 
hash
;

3178  
	ghash
;

3181 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(

3182 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

3183 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3184  
	gPARSER
.
·r£From
(
d©a
);

3186 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(

3187 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

3188 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3189 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3190  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3192 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(
by‹
[] 
d©a
)

3193 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3194  
	gPARSER
.
·r£From
(
d©a
);

3196 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(

3197 
by‹
[] 
d©a
,

3198 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3199 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3200  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3202 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3203 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3204  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3205 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3207 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(

3208 
java
.
io
.
IÅutSŒ—m
 
šput
,

3209 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3210 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3211  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3212 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3214 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3215 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3216  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3217 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

3219 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£D–im™edFrom
(

3220 
java
.
io
.
IÅutSŒ—m
 
šput
,

3221 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3222 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3223  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3224 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3226 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(

3227 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

3228 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3229  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3230 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3232 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
·r£From
(

3233 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3234 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3235 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3236  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3237 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3240 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

3241 
public
 
Bud”
 
ÃwBud”
() {

3242  
	gDEFAULT_INSTANCE
.
toBud”
();

3244 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
 
´ÙÙy³
) {

3245  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

3247 
public
 
Bud”
 
toBud”
() {

3248  
	gthis
 =ğ
DEFAULT_INSTANCE


3249 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

3252 @
	gjava
.
	gÏng
.
Ov”ride


3253 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

3254 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3255 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

3256  
	gbud”
;

3261 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


3262 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


3264 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfoOrBud”
 {

3265 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3266 
g‘DesütÜ
() {

3267  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

3270 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3271 
š‹º®G‘F›ldAcûssÜTabË
() {

3272  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË


3273 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3274 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Ev’tInfo.
Bud”
.class);

3278 
´iv©e
 
Bud”
() {

3279 
maybeFÜûBud”In™Ÿliz©iÚ
();

3282 
´iv©e
 
Bud”
(

3283 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3284 
su³r
(
·»Á
);

3285 
maybeFÜûBud”In™Ÿliz©iÚ
();

3287 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

3288 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3289 .
	g®waysU£F›ldBud”s
) {

3292 
public
 
Bud”
 
ş—r
() {

3293 
	gsu³r
.
ş—r
();

3294 
	gid_
 = 0;

3295 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

3296 
	gÇme_
 = "";

3297 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

3298 
	gpÜt_
 = 0;

3299 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

3300 
	gev’tTime_
 = 0L;

3301 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

3302 
	gäequ’cy_
 = 0;

3303 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000010);

3304  
	gthis
;

3307 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3308 
g‘DesütÜFÜTy³
() {

3309  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

3312 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3313  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfo
.
g‘DeçuÉIn¡ªû
();

3316 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
bud
() {

3317 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
	g»suÉ
 = 
budP¬tŸl
();

3318 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

3319 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

3321  
	g»suÉ
;

3324 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
budP¬tŸl
() {

3325 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Ev’tInfo(
this
);

3326 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

3327 
	gto_b™F›ld0_
 = 0;

3328 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

3329 
to_b™F›ld0_
 |= 0x00000001;

3331 
	g»suÉ
.
	gid_
 = 
id_
;

3332 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

3333 
to_b™F›ld0_
 |= 0x00000002;

3335 
	g»suÉ
.
	gÇme_
 = 
Çme_
;

3336 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

3337 
to_b™F›ld0_
 |= 0x00000004;

3339 
	g»suÉ
.
	gpÜt_
 = 
pÜt_
;

3340 ià(((
	gäom_b™F›ld0_
 & 0x00000008) == 0x00000008)) {

3341 
to_b™F›ld0_
 |= 0x00000008;

3343 
	g»suÉ
.
	gev’tTime_
 = 
ev’tTime_
;

3344 ià(((
	gäom_b™F›ld0_
 & 0x00000010) == 0x00000010)) {

3345 
to_b™F›ld0_
 |= 0x00000010;

3347 
	g»suÉ
.
	gäequ’cy_
 = 
äequ’cy_
;

3348 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

3349 
ÚBut
();

3350  
	g»suÉ
;

3353 
public
 
Bud”
 
şÚe
() {

3354  (
	gBud”
è
	gsu³r
.
şÚe
();

3356 
public
 
Bud”
 
£tF›ld
(

3357 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3358 
Objeù
 
v®ue
) {

3359  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

3361 
public
 
Bud”
 
ş—rF›ld
(

3362 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

3363  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

3365 
public
 
Bud”
 
ş—rOÃof
(

3366 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

3367  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

3369 
public
 
Bud”
 
£tR•—‹dF›ld
(

3370 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3371 
šdex
, 
Objeù
 
v®ue
) {

3372  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

3374 
public
 
Bud”
 
addR•—‹dF›ld
(

3375 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

3376 
Objeù
 
v®ue
) {

3377  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

3379 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

3380 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gEv’tInfo
) {

3381  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
)
Ùh”
);

3383 
	gsu³r
.
m”geFrom
(
Ùh”
);

3384  
	gthis
;

3388 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
 
Ùh”
) {

3389 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
.
g‘DeçuÉIn¡ªû
()è 
this
;

3390 ià(
	gÙh”
.
hasId
()) {

3391 
£tId
(
Ùh”
.
g‘Id
());

3393 ià(
	gÙh”
.
hasName
()) {

3394 
	gb™F›ld0_
 |= 0x00000002;

3395 
	gÇme_
 = 
Ùh”
.
Çme_
;

3396 
ÚChªged
();

3398 ià(
	gÙh”
.
hasPÜt
()) {

3399 
£tPÜt
(
Ùh”
.
g‘PÜt
());

3401 ià(
	gÙh”
.
hasEv’tTime
()) {

3402 
£tEv’tTime
(
Ùh”
.
g‘Ev’tTime
());

3404 ià(
	gÙh”
.
hasF»qu’cy
()) {

3405 
£tF»qu’cy
(
Ùh”
.
g‘F»qu’cy
());

3407 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

3408 
ÚChªged
();

3409  
	gthis
;

3412 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3413  
	gŒue
;

3416 
public
 
Bud”
 
m”geFrom
(

3417 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3418 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3419 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3420 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
	g·r£dMes§ge
 = 
nuÎ
;

3421 
	gŒy
 {

3422 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

3423 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3424 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
è
e
.
g‘UnfšishedMes§ge
();

3425 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

3426 } 
	gfš®ly
 {

3427 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

3428 
m”geFrom
(
·r£dMes§ge
);

3431  
	gthis
;

3433 
´iv©e
 
	gb™F›ld0_
;

3435 
´iv©e
 
	gid_
 ;

3439 
public
 
boŞ—n
 
hasId
() {

3440  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

3445 
public
 
g‘Id
() {

3446  
	gid_
;

3451 
public
 
Bud”
 
£tId
(
v®ue
) {

3452 
	gb™F›ld0_
 |= 0x00000001;

3453 
	gid_
 = 
v®ue
;

3454 
ÚChªged
();

3455  
	gthis
;

3460 
public
 
Bud”
 
ş—rId
() {

3461 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

3462 
	gid_
 = 0;

3463 
ÚChªged
();

3464  
	gthis
;

3467 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gÇme_
 = "";

3471 
public
 
boŞ—n
 
hasName
() {

3472  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

3477 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
() {

3478 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

3479 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

3480 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

3481 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

3482 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

3483 ià(
	gbs
.
isV®idUtf8
()) {

3484 
	gÇme_
 = 
s
;

3486  
	gs
;

3488  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

3494 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


3495 
g‘NameBy‹s
() {

3496 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

3497 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

3498 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

3499 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

3500 (
java
.
Ïng
.
SŒšg
è
»f
);

3501 
	gÇme_
 = 
b
;

3502  
	gb
;

3504  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

3510 
public
 
Bud”
 
£tName
(

3511 
java
.
Ïng
.
SŒšg
 
v®ue
) {

3512 ià(
	gv®ue
 =ğ
nuÎ
) {

3513 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3515 
	gb™F›ld0_
 |= 0x00000002;

3516 
	gÇme_
 = 
v®ue
;

3517 
ÚChªged
();

3518  
	gthis
;

3523 
public
 
Bud”
 
ş—rName
() {

3524 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

3525 
	gÇme_
 = 
g‘DeçuÉIn¡ªû
().
g‘Name
();

3526 
ÚChªged
();

3527  
	gthis
;

3532 
public
 
Bud”
 
£tNameBy‹s
(

3533 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

3534 ià(
	gv®ue
 =ğ
nuÎ
) {

3535 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

3537 
	gb™F›ld0_
 |= 0x00000002;

3538 
	gÇme_
 = 
v®ue
;

3539 
ÚChªged
();

3540  
	gthis
;

3543 
´iv©e
 
	gpÜt_
 ;

3547 
public
 
boŞ—n
 
hasPÜt
() {

3548  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

3553 
public
 
g‘PÜt
() {

3554  
	gpÜt_
;

3559 
public
 
Bud”
 
£tPÜt
(
v®ue
) {

3560 
	gb™F›ld0_
 |= 0x00000004;

3561 
	gpÜt_
 = 
v®ue
;

3562 
ÚChªged
();

3563  
	gthis
;

3568 
public
 
Bud”
 
ş—rPÜt
() {

3569 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

3570 
	gpÜt_
 = 0;

3571 
ÚChªged
();

3572  
	gthis
;

3575 
´iv©e
 
	gev’tTime_
 ;

3579 
public
 
boŞ—n
 
hasEv’tTime
() {

3580  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

3585 
public
 
g‘Ev’tTime
() {

3586  
	gev’tTime_
;

3591 
public
 
Bud”
 
£tEv’tTime
(
v®ue
) {

3592 
	gb™F›ld0_
 |= 0x00000008;

3593 
	gev’tTime_
 = 
v®ue
;

3594 
ÚChªged
();

3595  
	gthis
;

3600 
public
 
Bud”
 
ş—rEv’tTime
() {

3601 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

3602 
	gev’tTime_
 = 0L;

3603 
ÚChªged
();

3604  
	gthis
;

3607 
´iv©e
 
	gäequ’cy_
 ;

3611 
public
 
boŞ—n
 
hasF»qu’cy
() {

3612  ((
	gb™F›ld0_
 & 0x00000010) == 0x00000010);

3617 
public
 
g‘F»qu’cy
() {

3618  
	gäequ’cy_
;

3623 
public
 
Bud”
 
£tF»qu’cy
(
v®ue
) {

3624 
	gb™F›ld0_
 |= 0x00000010;

3625 
	gäequ’cy_
 = 
v®ue
;

3626 
ÚChªged
();

3627  
	gthis
;

3632 
public
 
Bud”
 
ş—rF»qu’cy
() {

3633 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000010);

3634 
	gäequ’cy_
 = 0;

3635 
ÚChªged
();

3636  
	gthis
;

3638 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

3639 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3640  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

3643 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

3644 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

3645  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

3653 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
	gDEFAULT_INSTANCE
;

3655 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ev’tInfo
();

3658 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
g‘DeçuÉIn¡ªû
() {

3659  
	gDEFAULT_INSTANCE
;

3662 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEv’tInfo
>

3663 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Ev’tInfo
>() {

3664 
public
 
Ev’tInfo
 
·r£P¬tŸlFrom
(

3665 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3666 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3667 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

3668  
Ãw
 
Ev’tInfo
(
šput
, 
ex‹nsiÚRegi¡ry
);

3672 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEv’tInfo
> 
·r£r
() {

3673  
	gPARSER
;

3676 @
	gjava
.
	gÏng
.
Ov”ride


3677 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEv’tInfo
> 
g‘P¬£rFÜTy³
() {

3678  
	gPARSER
;

3681 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ev’tInfo
 
g‘DeçuÉIn¡ªûFÜTy³
() {

3682  
	gDEFAULT_INSTANCE
;

3687 
public
 
š‹rçû
 
UuidOrBud”
 
ex‹nds


3689 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

3694 
boŞ—n
 
hasMsb
();

3698 
g‘Msb
();

3703 
boŞ—n
 
hasLsb
();

3707 
g‘Lsb
();

3712 
public
 
fš®
 
şass
 
Uuid
 
ex‹nds


3713 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


3715 
	gUuidOrBud”
 {

3717 
´iv©e
 
Uuid
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

3718 
su³r
(
bud”
);

3720 
´iv©e
 
Uuid
() {

3721 
	gmsb_
 = 0L;

3722 
	glsb_
 = 0L;

3725 @
	gjava
.
	gÏng
.
Ov”ride


3726 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


3727 
g‘UnknownF›lds
() {

3728  
	gthis
.
	gunknownF›lds
;

3730 
´iv©e
 
Uuid
(

3731 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3732 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3733 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3734 
this
();

3735 
	gmubË_b™F›ld0_
 = 0;

3736 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

3737 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

3738 
	gŒy
 {

3739 
boŞ—n
 
	gdÚe
 = 
çl£
;

3740 !
	gdÚe
) {

3741 
	gg
 = 
šput
.
»adTag
();

3742 
	gg
) {

3744 
dÚe
 = 
Œue
;

3747 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

3748 
ex‹nsiÚRegi¡ry
, 
g
)) {

3749 
	gdÚe
 = 
Œue
;

3754 
b™F›ld0_
 |= 0x00000001;

3755 
	gmsb_
 = 
šput
.
»adUIÁ64
();

3759 
b™F›ld0_
 |= 0x00000002;

3760 
	glsb_
 = 
šput
.
»adUIÁ64
();

3765 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

3766 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

3767 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

3768 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

3769 
e
).
£tUnfšishedMes§ge
(
this
);

3770 } 
	gfš®ly
 {

3771 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

3772 
makeEx‹nsiÚsImmubË
();

3775 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3776 
g‘DesütÜ
() {

3777  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

3780 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3781 
š‹º®G‘F›ldAcûssÜTabË
() {

3782  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË


3783 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3784 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Uuid.
Bud”
.class);

3787 
´iv©e
 
	gb™F›ld0_
;

3788 
public
 
fš®
 
	gMSB_FIELD_NUMBER
 = 1;

3789 
´iv©e
 
	gmsb_
;

3793 
public
 
boŞ—n
 
hasMsb
() {

3794  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

3799 
public
 
g‘Msb
() {

3800  
	gmsb_
;

3803 
public
 
fš®
 
	gLSB_FIELD_NUMBER
 = 2;

3804 
´iv©e
 
	glsb_
;

3808 
public
 
boŞ—n
 
hasLsb
() {

3809  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

3814 
public
 
g‘Lsb
() {

3815  
	glsb_
;

3818 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

3819 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

3820 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

3821 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

3822 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

3824 
	gmemoizedIsIn™Ÿlized
 = 1;

3825  
	gŒue
;

3828 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

3829 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3830 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

3831 
ouut
.
wr™eUIÁ64
(1, 
msb_
);

3833 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

3834 
ouut
.
wr™eUIÁ64
(2, 
lsb_
);

3836 
	gunknownF›lds
.
wr™eTo
(
ouut
);

3839 
public
 
g‘S”ŸlizedSize
() {

3840 
	gsize
 = 
memoizedSize
;

3841 ià(
	gsize
 !ğ-1è 
size
;

3843 
	gsize
 = 0;

3844 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

3845 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3846 .
compu‹UIÁ64Size
(1, 
msb_
);

3848 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

3849 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


3850 .
compu‹UIÁ64Size
(2, 
lsb_
);

3852 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

3853 
	gmemoizedSize
 = 
size
;

3854  
	gsize
;

3857 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

3858 @
	gjava
.
	gÏng
.
Ov”ride


3859 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

3860 ià(
	gobj
 =ğ
this
) {

3861  
Œue
;

3863 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
)) {

3864  
	gsu³r
.
equ®s
(
obj
);

3866 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Uuidè
obj
;

3868 
boŞ—n
 
	g»suÉ
 = 
Œue
;

3869 
	g»suÉ
 = 
»suÉ
 && (
hasMsb
(è=ğ
Ùh”
.hasMsb());

3870 ià(
hasMsb
()) {

3871 
	g»suÉ
 = 
»suÉ
 && (
g‘Msb
()

3872 =ğ
Ùh”
.
g‘Msb
());

3874 
	g»suÉ
 = 
»suÉ
 && (
hasLsb
(è=ğ
Ùh”
.hasLsb());

3875 ià(
hasLsb
()) {

3876 
	g»suÉ
 = 
»suÉ
 && (
g‘Lsb
()

3877 =ğ
Ùh”
.
g‘Lsb
());

3879 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

3880  
	g»suÉ
;

3883 @
	gjava
.
	gÏng
.
Ov”ride


3884 
public
 
hashCode
() {

3885 ià(
	gmemoizedHashCode
 != 0) {

3886  
memoizedHashCode
;

3888 
	ghash
 = 41;

3889 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

3890 ià(
hasMsb
()) {

3891 
	ghash
 = (37 * 
hash
è+ 
MSB_FIELD_NUMBER
;

3892 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

3893 
g‘Msb
());

3895 ià(
hasLsb
()) {

3896 
	ghash
 = (37 * 
hash
è+ 
LSB_FIELD_NUMBER
;

3897 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

3898 
g‘Lsb
());

3900 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

3901 
	gmemoizedHashCode
 = 
hash
;

3902  
	ghash
;

3905 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(

3906 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

3907 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3908  
	gPARSER
.
·r£From
(
d©a
);

3910 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(

3911 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

3912 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3913 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3914  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3916 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(
by‹
[] 
d©a
)

3917 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3918  
	gPARSER
.
·r£From
(
d©a
);

3920 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(

3921 
by‹
[] 
d©a
,

3922 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3923 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

3924  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

3926 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3927 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3928  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3929 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3931 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(

3932 
java
.
io
.
IÅutSŒ—m
 
šput
,

3933 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3934 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3935  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3936 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3938 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

3939 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3940  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3941 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

3943 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£D–im™edFrom
(

3944 
java
.
io
.
IÅutSŒ—m
 
šput
,

3945 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3946 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3947  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3948 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3950 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(

3951 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

3952 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3953  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3954 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

3956 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
·r£From
(

3957 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

3958 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

3959 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

3960  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


3961 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

3964 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

3965 
public
 
Bud”
 
ÃwBud”
() {

3966  
	gDEFAULT_INSTANCE
.
toBud”
();

3968 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
 
´ÙÙy³
) {

3969  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

3971 
public
 
Bud”
 
toBud”
() {

3972  
	gthis
 =ğ
DEFAULT_INSTANCE


3973 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

3976 @
	gjava
.
	gÏng
.
Ov”ride


3977 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

3978 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

3979 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

3980  
	gbud”
;

3985 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


3986 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


3988 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuidOrBud”
 {

3989 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


3990 
g‘DesütÜ
() {

3991  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

3994 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


3995 
š‹º®G‘F›ldAcûssÜTabË
() {

3996  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË


3997 .
’su»F›ldAcûssÜsIn™Ÿlized
(

3998 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Uuid.
Bud”
.class);

4002 
´iv©e
 
Bud”
() {

4003 
maybeFÜûBud”In™Ÿliz©iÚ
();

4006 
´iv©e
 
Bud”
(

4007 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

4008 
su³r
(
·»Á
);

4009 
maybeFÜûBud”In™Ÿliz©iÚ
();

4011 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

4012 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4013 .
	g®waysU£F›ldBud”s
) {

4016 
public
 
Bud”
 
ş—r
() {

4017 
	gsu³r
.
ş—r
();

4018 
	gmsb_
 = 0L;

4019 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4020 
	glsb_
 = 0L;

4021 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

4022  
	gthis
;

4025 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4026 
g‘DesütÜFÜTy³
() {

4027  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

4030 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4031  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
.
g‘DeçuÉIn¡ªû
();

4034 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
bud
() {

4035 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
	g»suÉ
 = 
budP¬tŸl
();

4036 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

4037 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

4039  
	g»suÉ
;

4042 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
budP¬tŸl
() {

4043 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Uuid(
this
);

4044 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

4045 
	gto_b™F›ld0_
 = 0;

4046 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

4047 
to_b™F›ld0_
 |= 0x00000001;

4049 
	g»suÉ
.
	gmsb_
 = 
msb_
;

4050 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

4051 
to_b™F›ld0_
 |= 0x00000002;

4053 
	g»suÉ
.
	glsb_
 = 
lsb_
;

4054 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

4055 
ÚBut
();

4056  
	g»suÉ
;

4059 
public
 
Bud”
 
şÚe
() {

4060  (
	gBud”
è
	gsu³r
.
şÚe
();

4062 
public
 
Bud”
 
£tF›ld
(

4063 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4064 
Objeù
 
v®ue
) {

4065  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

4067 
public
 
Bud”
 
ş—rF›ld
(

4068 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

4069  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

4071 
public
 
Bud”
 
ş—rOÃof
(

4072 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

4073  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

4075 
public
 
Bud”
 
£tR•—‹dF›ld
(

4076 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4077 
šdex
, 
Objeù
 
v®ue
) {

4078  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

4080 
public
 
Bud”
 
addR•—‹dF›ld
(

4081 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4082 
Objeù
 
v®ue
) {

4083  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

4085 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

4086 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gUuid
) {

4087  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
)
Ùh”
);

4089 
	gsu³r
.
m”geFrom
(
Ùh”
);

4090  
	gthis
;

4094 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
 
Ùh”
) {

4095 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
.
g‘DeçuÉIn¡ªû
()è 
this
;

4096 ià(
	gÙh”
.
hasMsb
()) {

4097 
£tMsb
(
Ùh”
.
g‘Msb
());

4099 ià(
	gÙh”
.
hasLsb
()) {

4100 
£tLsb
(
Ùh”
.
g‘Lsb
());

4102 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

4103 
ÚChªged
();

4104  
	gthis
;

4107 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

4108  
	gŒue
;

4111 
public
 
Bud”
 
m”geFrom
(

4112 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4113 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4114 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4115 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
	g·r£dMes§ge
 = 
nuÎ
;

4116 
	gŒy
 {

4117 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

4118 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

4119 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
è
e
.
g‘UnfšishedMes§ge
();

4120 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

4121 } 
	gfš®ly
 {

4122 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

4123 
m”geFrom
(
·r£dMes§ge
);

4126  
	gthis
;

4128 
´iv©e
 
	gb™F›ld0_
;

4130 
´iv©e
 
	gmsb_
 ;

4134 
public
 
boŞ—n
 
hasMsb
() {

4135  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

4140 
public
 
g‘Msb
() {

4141  
	gmsb_
;

4146 
public
 
Bud”
 
£tMsb
(
v®ue
) {

4147 
	gb™F›ld0_
 |= 0x00000001;

4148 
	gmsb_
 = 
v®ue
;

4149 
ÚChªged
();

4150  
	gthis
;

4155 
public
 
Bud”
 
ş—rMsb
() {

4156 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4157 
	gmsb_
 = 0L;

4158 
ÚChªged
();

4159  
	gthis
;

4162 
´iv©e
 
	glsb_
 ;

4166 
public
 
boŞ—n
 
hasLsb
() {

4167  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

4172 
public
 
g‘Lsb
() {

4173  
	glsb_
;

4178 
public
 
Bud”
 
£tLsb
(
v®ue
) {

4179 
	gb™F›ld0_
 |= 0x00000002;

4180 
	glsb_
 = 
v®ue
;

4181 
ÚChªged
();

4182  
	gthis
;

4187 
public
 
Bud”
 
ş—rLsb
() {

4188 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

4189 
	glsb_
 = 0L;

4190 
ÚChªged
();

4191  
	gthis
;

4193 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

4194 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4195  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

4198 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

4199 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4200  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

4208 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
	gDEFAULT_INSTANCE
;

4210 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Uuid
();

4213 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
g‘DeçuÉIn¡ªû
() {

4214  
	gDEFAULT_INSTANCE
;

4217 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
>

4218 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Uuid
>() {

4219 
public
 
Uuid
 
·r£P¬tŸlFrom
(

4220 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4221 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4222 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

4223  
Ãw
 
Uuid
(
šput
, 
ex‹nsiÚRegi¡ry
);

4227 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
> 
·r£r
() {

4228  
	gPARSER
;

4231 @
	gjava
.
	gÏng
.
Ov”ride


4232 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
> 
g‘P¬£rFÜTy³
() {

4233  
	gPARSER
;

4236 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Uuid
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4237  
	gDEFAULT_INSTANCE
;

4242 
public
 
š‹rçû
 
Ne¡edTy³AOrBud”
 
ex‹nds


4244 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

4249 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
>

4250 
g‘TagLi¡
();

4254 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
g‘Tag
(
šdex
);

4258 
g‘TagCouÁ
();

4262 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³BOrBud”
>

4263 
g‘TagOrBud”Li¡
();

4267 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³BOrBud”
 
g‘TagOrBud”
(

4268 
šdex
);

4273 
public
 
fš®
 
şass
 
Ne¡edTy³A
 
ex‹nds


4274 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


4276 
	gNe¡edTy³AOrBud”
 {

4278 
´iv©e
 
Ne¡edTy³A
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

4279 
su³r
(
bud”
);

4281 
´iv©e
 
Ne¡edTy³A
() {

4282 
	gg_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

4285 @
	gjava
.
	gÏng
.
Ov”ride


4286 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


4287 
g‘UnknownF›lds
() {

4288  
	gthis
.
	gunknownF›lds
;

4290 
´iv©e
 
Ne¡edTy³A
(

4291 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4292 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4293 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4294 
this
();

4295 
	gmubË_b™F›ld0_
 = 0;

4296 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

4297 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

4298 
	gŒy
 {

4299 
boŞ—n
 
	gdÚe
 = 
çl£
;

4300 !
	gdÚe
) {

4301 
	gg
 = 
šput
.
»adTag
();

4302 
	gg
) {

4304 
dÚe
 = 
Œue
;

4307 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

4308 
ex‹nsiÚRegi¡ry
, 
g
)) {

4309 
	gdÚe
 = 
Œue
;

4314 ià(!((
mubË_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

4315 
g_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
>();

4316 
	gmubË_b™F›ld0_
 |= 0x00000001;

4318 
	gg_
.
add
(

4319 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
PARSER
, 
ex‹nsiÚRegi¡ry
));

4324 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

4325 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

4326 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

4327 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

4328 
e
).
£tUnfšishedMes§ge
(
this
);

4329 } 
	gfš®ly
 {

4330 ià(((
	gmubË_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

4331 
g_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(tag_);

4333 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

4334 
makeEx‹nsiÚsImmubË
();

4337 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4338 
g‘DesütÜ
() {

4339  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_desütÜ
;

4342 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4343 
š‹º®G‘F›ldAcûssÜTabË
() {

4344  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_f›ldAcûssÜTabË


4345 .
’su»F›ldAcûssÜsIn™Ÿlized
(

4346 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³A.
Bud”
.class);

4349 
public
 
fš®
 
	gTAG_FIELD_NUMBER
 = 1;

4350 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
> 
	gg_
;

4354 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
> 
g‘TagLi¡
() {

4355  
	gg_
;

4360 
public
 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³BOrBud”
>

4361 
g‘TagOrBud”Li¡
() {

4362  
	gg_
;

4367 
public
 
g‘TagCouÁ
() {

4368  
	gg_
.
size
();

4373 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
g‘Tag
(
šdex
) {

4374  
	gg_
.
g‘
(
šdex
);

4379 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³BOrBud”
 
g‘TagOrBud”
(

4380 
šdex
) {

4381  
	gg_
.
g‘
(
šdex
);

4384 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

4385 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

4386 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

4387 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

4388 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

4390 
	gmemoizedIsIn™Ÿlized
 = 1;

4391  
	gŒue
;

4394 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

4395 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4396 
	gi
 = 0; i < 
	gg_
.
size
(); i++) {

4397 
	gouut
.
wr™eMes§ge
(1, 
g_
.
g‘
(
i
));

4399 
	gunknownF›lds
.
wr™eTo
(
ouut
);

4402 
public
 
g‘S”ŸlizedSize
() {

4403 
	gsize
 = 
memoizedSize
;

4404 ià(
	gsize
 !ğ-1è 
size
;

4406 
	gsize
 = 0;

4407 
	gi
 = 0; i < 
	gg_
.
size
(); i++) {

4408 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


4409 .
compu‹Mes§geSize
(1, 
g_
.
g‘
(
i
));

4411 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

4412 
	gmemoizedSize
 = 
size
;

4413  
	gsize
;

4416 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

4417 @
	gjava
.
	gÏng
.
Ov”ride


4418 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

4419 ià(
	gobj
 =ğ
this
) {

4420  
Œue
;

4422 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
)) {

4423  
	gsu³r
.
equ®s
(
obj
);

4425 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Ne¡edTy³Aè
obj
;

4427 
boŞ—n
 
	g»suÉ
 = 
Œue
;

4428 
	g»suÉ
 = 
»suÉ
 && 
g‘TagLi¡
()

4429 .
equ®s
(
Ùh”
.
g‘TagLi¡
());

4430 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

4431  
	g»suÉ
;

4434 @
	gjava
.
	gÏng
.
Ov”ride


4435 
public
 
hashCode
() {

4436 ià(
	gmemoizedHashCode
 != 0) {

4437  
memoizedHashCode
;

4439 
	ghash
 = 41;

4440 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

4441 ià(
g‘TagCouÁ
() > 0) {

4442 
	ghash
 = (37 * 
hash
è+ 
TAG_FIELD_NUMBER
;

4443 
	ghash
 = (53 * 
hash
è+ 
g‘TagLi¡
().
hashCode
();

4445 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

4446 
	gmemoizedHashCode
 = 
hash
;

4447  
	ghash
;

4450 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(

4451 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

4452 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4453  
	gPARSER
.
·r£From
(
d©a
);

4455 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(

4456 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

4457 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4458 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4459  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

4461 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(
by‹
[] 
d©a
)

4462 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4463  
	gPARSER
.
·r£From
(
d©a
);

4465 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(

4466 
by‹
[] 
d©a
,

4467 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4468 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

4469  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

4471 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

4472 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4473  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4474 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

4476 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(

4477 
java
.
io
.
IÅutSŒ—m
 
šput
,

4478 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4479 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4480  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4481 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

4483 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

4484 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4485  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4486 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

4488 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£D–im™edFrom
(

4489 
java
.
io
.
IÅutSŒ—m
 
šput
,

4490 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4491 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4492  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4493 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

4495 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(

4496 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

4497 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4498  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4499 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

4501 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
·r£From
(

4502 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4503 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4504 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4505  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4506 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

4509 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

4510 
public
 
Bud”
 
ÃwBud”
() {

4511  
	gDEFAULT_INSTANCE
.
toBud”
();

4513 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
 
´ÙÙy³
) {

4514  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

4516 
public
 
Bud”
 
toBud”
() {

4517  
	gthis
 =ğ
DEFAULT_INSTANCE


4518 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

4521 @
	gjava
.
	gÏng
.
Ov”ride


4522 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

4523 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

4524 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

4525  
	gbud”
;

4530 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


4531 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


4533 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³AOrBud”
 {

4534 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4535 
g‘DesütÜ
() {

4536  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_desütÜ
;

4539 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


4540 
š‹º®G‘F›ldAcûssÜTabË
() {

4541  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_f›ldAcûssÜTabË


4542 .
’su»F›ldAcûssÜsIn™Ÿlized
(

4543 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³A.
Bud”
.class);

4547 
´iv©e
 
Bud”
() {

4548 
maybeFÜûBud”In™Ÿliz©iÚ
();

4551 
´iv©e
 
Bud”
(

4552 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

4553 
su³r
(
·»Á
);

4554 
maybeFÜûBud”In™Ÿliz©iÚ
();

4556 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

4557 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


4558 .
	g®waysU£F›ldBud”s
) {

4559 
g‘TagF›ldBud”
();

4562 
public
 
Bud”
 
ş—r
() {

4563 
	gsu³r
.
ş—r
();

4564 ià(
	ggBud”_
 =ğ
nuÎ
) {

4565 
g_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

4566 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4568 
	ggBud”_
.
ş—r
();

4570  
	gthis
;

4573 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


4574 
g‘DesütÜFÜTy³
() {

4575  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_desütÜ
;

4578 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4579  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
.
g‘DeçuÉIn¡ªû
();

4582 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
bud
() {

4583 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	g»suÉ
 = 
budP¬tŸl
();

4584 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

4585 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

4587  
	g»suÉ
;

4590 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
budP¬tŸl
() {

4591 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Ne¡edTy³A(
this
);

4592 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

4593 ià(
	ggBud”_
 =ğ
nuÎ
) {

4594 ià(((
b™F›ld0_
 & 0x00000001) == 0x00000001)) {

4595 
g_
 = 
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(tag_);

4596 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4598 
	g»suÉ
.
	gg_
 = 
g_
;

4600 
	g»suÉ
.
	gg_
 = 
gBud”_
.
bud
();

4602 
ÚBut
();

4603  
	g»suÉ
;

4606 
public
 
Bud”
 
şÚe
() {

4607  (
	gBud”
è
	gsu³r
.
şÚe
();

4609 
public
 
Bud”
 
£tF›ld
(

4610 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4611 
Objeù
 
v®ue
) {

4612  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

4614 
public
 
Bud”
 
ş—rF›ld
(

4615 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

4616  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

4618 
public
 
Bud”
 
ş—rOÃof
(

4619 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

4620  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

4622 
public
 
Bud”
 
£tR•—‹dF›ld
(

4623 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4624 
šdex
, 
Objeù
 
v®ue
) {

4625  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

4627 
public
 
Bud”
 
addR•—‹dF›ld
(

4628 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

4629 
Objeù
 
v®ue
) {

4630  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

4632 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

4633 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³A
) {

4634  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
)
Ùh”
);

4636 
	gsu³r
.
m”geFrom
(
Ùh”
);

4637  
	gthis
;

4641 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
 
Ùh”
) {

4642 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
.
g‘DeçuÉIn¡ªû
()è 
this
;

4643 ià(
	ggBud”_
 =ğ
nuÎ
) {

4644 ià(!
Ùh”
.
g_
.
isEm±y
()) {

4645 ià(
g_
.
isEm±y
()) {

4646 
g_
 = 
Ùh”
.tag_;

4647 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4649 
’su»TagIsMubË
();

4650 
	gg_
.
addAÎ
(
Ùh”
.
g_
);

4652 
ÚChªged
();

4655 ià(!
	gÙh”
.
	gg_
.
isEm±y
()) {

4656 ià(
	ggBud”_
.
isEm±y
()) {

4657 
	ggBud”_
.
di¥o£
();

4658 
	ggBud”_
 = 
nuÎ
;

4659 
	gg_
 = 
Ùh”
.
g_
;

4660 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4661 
	ggBud”_
 =

4662 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
®waysU£F›ldBud”s
 ?

4663 
g‘TagF›ldBud”
(è: 
nuÎ
;

4665 
	ggBud”_
.
addAÎMes§ges
(
Ùh”
.
g_
);

4669 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

4670 
ÚChªged
();

4671  
	gthis
;

4674 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

4675  
	gŒue
;

4678 
public
 
Bud”
 
m”geFrom
(

4679 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4680 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4681 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

4682 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	g·r£dMes§ge
 = 
nuÎ
;

4683 
	gŒy
 {

4684 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

4685 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

4686 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
è
e
.
g‘UnfšishedMes§ge
();

4687 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

4688 } 
	gfš®ly
 {

4689 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

4690 
m”geFrom
(
·r£dMes§ge
);

4693  
	gthis
;

4695 
´iv©e
 
	gb™F›ld0_
;

4697 
´iv©e
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
> 
	gg_
 =

4698 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

4699 
´iv©e
 
’su»TagIsMubË
() {

4700 ià(!((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

4701 
g_
 = 
Ãw
 
java
.
ut
.
A¼ayLi¡
<
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
>(tag_);

4702 
	gb™F›ld0_
 |= 0x00000001;

4706 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gR•—‹dF›ldBud”V3
<

4707 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³B.
	gBud”
, org.cÜfudb.‹¡.Sam¶eSchema.
	gNe¡edTy³BOrBud”
> 
	ggBud”_
;

4712 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
> 
g‘TagLi¡
() {

4713 ià(
	ggBud”_
 =ğ
nuÎ
) {

4714  
java
.
ut
.
CŞËùiÚs
.
unmodifŸbËLi¡
(
g_
);

4716  
	ggBud”_
.
g‘Mes§geLi¡
();

4722 
public
 
g‘TagCouÁ
() {

4723 ià(
	ggBud”_
 =ğ
nuÎ
) {

4724  
g_
.
size
();

4726  
	ggBud”_
.
g‘CouÁ
();

4732 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
g‘Tag
(
šdex
) {

4733 ià(
	ggBud”_
 =ğ
nuÎ
) {

4734  
g_
.
g‘
(
šdex
);

4736  
	ggBud”_
.
g‘Mes§ge
(
šdex
);

4742 
public
 
Bud”
 
£tTag
(

4743 
šdex
, 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
 
v®ue
) {

4744 ià(
	ggBud”_
 =ğ
nuÎ
) {

4745 ià(
v®ue
 =ğ
nuÎ
) {

4746 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

4748 
’su»TagIsMubË
();

4749 
	gg_
.
£t
(
šdex
, 
v®ue
);

4750 
ÚChªged
();

4752 
	ggBud”_
.
£tMes§ge
(
šdex
, 
v®ue
);

4754  
	gthis
;

4759 
public
 
Bud”
 
£tTag
(

4760 
šdex
, 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
Bud”
 
bud”FÜV®ue
) {

4761 ià(
	ggBud”_
 =ğ
nuÎ
) {

4762 
’su»TagIsMubË
();

4763 
	gg_
.
£t
(
šdex
, 
bud”FÜV®ue
.
bud
());

4764 
ÚChªged
();

4766 
	ggBud”_
.
£tMes§ge
(
šdex
, 
bud”FÜV®ue
.
bud
());

4768  
	gthis
;

4773 
public
 
Bud”
 
addTag
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
 
v®ue
) {

4774 ià(
	ggBud”_
 =ğ
nuÎ
) {

4775 ià(
v®ue
 =ğ
nuÎ
) {

4776 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

4778 
’su»TagIsMubË
();

4779 
	gg_
.
add
(
v®ue
);

4780 
ÚChªged
();

4782 
	ggBud”_
.
addMes§ge
(
v®ue
);

4784  
	gthis
;

4789 
public
 
Bud”
 
addTag
(

4790 
šdex
, 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
 
v®ue
) {

4791 ià(
	ggBud”_
 =ğ
nuÎ
) {

4792 ià(
v®ue
 =ğ
nuÎ
) {

4793 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

4795 
’su»TagIsMubË
();

4796 
	gg_
.
add
(
šdex
, 
v®ue
);

4797 
ÚChªged
();

4799 
	ggBud”_
.
addMes§ge
(
šdex
, 
v®ue
);

4801  
	gthis
;

4806 
public
 
Bud”
 
addTag
(

4807 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
Bud”
 
bud”FÜV®ue
) {

4808 ià(
	ggBud”_
 =ğ
nuÎ
) {

4809 
’su»TagIsMubË
();

4810 
	gg_
.
add
(
bud”FÜV®ue
.
bud
());

4811 
ÚChªged
();

4813 
	ggBud”_
.
addMes§ge
(
bud”FÜV®ue
.
bud
());

4815  
	gthis
;

4820 
public
 
Bud”
 
addTag
(

4821 
šdex
, 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
Bud”
 
bud”FÜV®ue
) {

4822 ià(
	ggBud”_
 =ğ
nuÎ
) {

4823 
’su»TagIsMubË
();

4824 
	gg_
.
add
(
šdex
, 
bud”FÜV®ue
.
bud
());

4825 
ÚChªged
();

4827 
	ggBud”_
.
addMes§ge
(
šdex
, 
bud”FÜV®ue
.
bud
());

4829  
	gthis
;

4834 
public
 
Bud”
 
addAÎTag
(

4835 
java
.
Ïng
.
I‹¿bË
<? 
ex‹nds
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
> 
v®ues
) {

4836 ià(
	ggBud”_
 =ğ
nuÎ
) {

4837 
’su»TagIsMubË
();

4838 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gAb¡¿ùMes§geL™e
.
	gBud”
.
addAÎ
(

4839 
v®ues
, 
g_
);

4840 
ÚChªged
();

4842 
	ggBud”_
.
addAÎMes§ges
(
v®ues
);

4844  
	gthis
;

4849 
public
 
Bud”
 
ş—rTag
() {

4850 ià(
	ggBud”_
 =ğ
nuÎ
) {

4851 
g_
 = 
java
.
ut
.
CŞËùiÚs
.
em±yLi¡
();

4852 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

4853 
ÚChªged
();

4855 
	ggBud”_
.
ş—r
();

4857  
	gthis
;

4862 
public
 
Bud”
 
»moveTag
(
šdex
) {

4863 ià(
	ggBud”_
 =ğ
nuÎ
) {

4864 
’su»TagIsMubË
();

4865 
	gg_
.
»move
(
šdex
);

4866 
ÚChªged
();

4868 
	ggBud”_
.
»move
(
šdex
);

4870  
	gthis
;

4875 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
.
Bud”
 
g‘TagBud”
(

4876 
šdex
) {

4877  
g‘TagF›ldBud”
().
g‘Bud”
(
šdex
);

4882 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³BOrBud”
 
g‘TagOrBud”
(

4883 
šdex
) {

4884 ià(
	ggBud”_
 =ğ
nuÎ
) {

4885  
g_
.
g‘
(
šdex
); } {

4886  
	ggBud”_
.
g‘Mes§geOrBud”
(
šdex
);

4892 
public
 
	gjava
.
	gut
.
	gLi¡
<? 
ex‹nds
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³BOrBud”
>

4893 
g‘TagOrBud”Li¡
() {

4894 ià(
	ggBud”_
 !ğ
nuÎ
) {

4895  
gBud”_
.
g‘Mes§geOrBud”Li¡
();

4897  
	gjava
.
	gut
.
	gCŞËùiÚs
.
unmodifŸbËLi¡
(
g_
);

4903 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
.
Bud”
 
addTagBud”
() {

4904  
g‘TagF›ldBud”
().
addBud”
(

4905 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
g‘DeçuÉIn¡ªû
());

4910 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
.
Bud”
 
addTagBud”
(

4911 
šdex
) {

4912  
g‘TagF›ldBud”
().
addBud”
(

4913 
šdex
, 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
g‘DeçuÉIn¡ªû
());

4918 
public
 
	gjava
.
	gut
.
	gLi¡
<
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
.
	gBud”
>

4919 
g‘TagBud”Li¡
() {

4920  
g‘TagF›ldBud”
().
g‘Bud”Li¡
();

4922 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gR•—‹dF›ldBud”V3
<

4923 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³B.
	gBud”
, org.cÜfudb.‹¡.Sam¶eSchema.
	gNe¡edTy³BOrBud”
>

4924 
g‘TagF›ldBud”
() {

4925 ià(
	ggBud”_
 =ğ
nuÎ
) {

4926 
gBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
R•—‹dF›ldBud”V3
<

4927 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
, 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
.
	gBud”
, org.cÜfudb.‹¡.Sam¶eSchema.
	gNe¡edTy³BOrBud”
>(

4928 
	gg_
,

4929 ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001),

4930 
g‘P¬’tFÜChd»n
(),

4931 
isCËª
());

4932 
	gg_
 = 
nuÎ
;

4934  
	ggBud”_
;

4936 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

4937 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4938  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

4941 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

4942 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

4943  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

4951 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
	gDEFAULT_INSTANCE
;

4953 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³A
();

4956 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
g‘DeçuÉIn¡ªû
() {

4957  
	gDEFAULT_INSTANCE
;

4960 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gNe¡edTy³A
>

4961 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Ne¡edTy³A
>() {

4962 
public
 
Ne¡edTy³A
 
·r£P¬tŸlFrom
(

4963 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

4964 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

4965 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

4966  
Ãw
 
Ne¡edTy³A
(
šput
, 
ex‹nsiÚRegi¡ry
);

4970 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gNe¡edTy³A
> 
·r£r
() {

4971  
	gPARSER
;

4974 @
	gjava
.
	gÏng
.
Ov”ride


4975 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gNe¡edTy³A
> 
g‘P¬£rFÜTy³
() {

4976  
	gPARSER
;

4979 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³A
 
g‘DeçuÉIn¡ªûFÜTy³
() {

4980  
	gDEFAULT_INSTANCE
;

4985 
public
 
š‹rçû
 
Ne¡edTy³BOrBud”
 
ex‹nds


4987 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

4992 
boŞ—n
 
hasSom‘hšg
();

4996 
	gjava
.
	gÏng
.
SŒšg
 
g‘Som‘hšg
();

5000 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


5001 
g‘Som‘hšgBy‹s
();

5006 
boŞ—n
 
hasSom‘hšg2
();

5010 
	gjava
.
	gÏng
.
SŒšg
 
g‘Som‘hšg2
();

5014 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


5015 
g‘Som‘hšg2By‹s
();

5020 
public
 
fš®
 
şass
 
Ne¡edTy³B
 
ex‹nds


5021 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


5023 
	gNe¡edTy³BOrBud”
 {

5025 
´iv©e
 
Ne¡edTy³B
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

5026 
su³r
(
bud”
);

5028 
´iv©e
 
Ne¡edTy³B
() {

5029 
	gsom‘hšg_
 = "";

5030 
	gsom‘hšg2_
 = "";

5033 @
	gjava
.
	gÏng
.
Ov”ride


5034 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


5035 
g‘UnknownF›lds
() {

5036  
	gthis
.
	gunknownF›lds
;

5038 
´iv©e
 
Ne¡edTy³B
(

5039 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5040 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5041 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5042 
this
();

5043 
	gmubË_b™F›ld0_
 = 0;

5044 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

5045 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

5046 
	gŒy
 {

5047 
boŞ—n
 
	gdÚe
 = 
çl£
;

5048 !
	gdÚe
) {

5049 
	gg
 = 
šput
.
»adTag
();

5050 
	gg
) {

5052 
dÚe
 = 
Œue
;

5055 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

5056 
ex‹nsiÚRegi¡ry
, 
g
)) {

5057 
	gdÚe
 = 
Œue
;

5062 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

5063 
	gb™F›ld0_
 |= 0x00000001;

5064 
	gsom‘hšg_
 = 
bs
;

5068 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

5069 
	gb™F›ld0_
 |= 0x00000002;

5070 
	gsom‘hšg2_
 = 
bs
;

5075 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

5076 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

5077 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

5078 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

5079 
e
).
£tUnfšishedMes§ge
(
this
);

5080 } 
	gfš®ly
 {

5081 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

5082 
makeEx‹nsiÚsImmubË
();

5085 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5086 
g‘DesütÜ
() {

5087  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_desütÜ
;

5090 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5091 
š‹º®G‘F›ldAcûssÜTabË
() {

5092  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_f›ldAcûssÜTabË


5093 .
’su»F›ldAcûssÜsIn™Ÿlized
(

5094 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³B.
Bud”
.class);

5097 
´iv©e
 
	gb™F›ld0_
;

5098 
public
 
fš®
 
	gSOMETHING_FIELD_NUMBER
 = 1;

5099 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gsom‘hšg_
;

5103 
public
 
boŞ—n
 
hasSom‘hšg
() {

5104  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

5109 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Som‘hšg
() {

5110 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg_
;

5111 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

5112  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

5114 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

5115 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

5116 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

5117 ià(
	gbs
.
isV®idUtf8
()) {

5118 
	gsom‘hšg_
 = 
s
;

5120  
	gs
;

5126 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


5127 
g‘Som‘hšgBy‹s
() {

5128 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg_
;

5129 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

5130 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

5131 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

5132 (
java
.
Ïng
.
SŒšg
è
»f
);

5133 
	gsom‘hšg_
 = 
b
;

5134  
	gb
;

5136  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

5140 
public
 
fš®
 
	gSOMETHING2_FIELD_NUMBER
 = 2;

5141 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gsom‘hšg2_
;

5145 
public
 
boŞ—n
 
hasSom‘hšg2
() {

5146  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

5151 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Som‘hšg2
() {

5152 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg2_
;

5153 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

5154  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

5156 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

5157 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

5158 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

5159 ià(
	gbs
.
isV®idUtf8
()) {

5160 
	gsom‘hšg2_
 = 
s
;

5162  
	gs
;

5168 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


5169 
g‘Som‘hšg2By‹s
() {

5170 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg2_
;

5171 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

5172 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

5173 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

5174 (
java
.
Ïng
.
SŒšg
è
»f
);

5175 
	gsom‘hšg2_
 = 
b
;

5176  
	gb
;

5178  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

5182 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

5183 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

5184 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

5185 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

5186 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

5188 
	gmemoizedIsIn™Ÿlized
 = 1;

5189  
	gŒue
;

5192 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

5193 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5194 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

5195 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
som‘hšg_
);

5197 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

5198 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
som‘hšg2_
);

5200 
	gunknownF›lds
.
wr™eTo
(
ouut
);

5203 
public
 
g‘S”ŸlizedSize
() {

5204 
	gsize
 = 
memoizedSize
;

5205 ià(
	gsize
 !ğ-1è 
size
;

5207 
	gsize
 = 0;

5208 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

5209 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
som‘hšg_
);

5211 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

5212 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
som‘hšg2_
);

5214 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

5215 
	gmemoizedSize
 = 
size
;

5216  
	gsize
;

5219 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

5220 @
	gjava
.
	gÏng
.
Ov”ride


5221 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

5222 ià(
	gobj
 =ğ
this
) {

5223  
Œue
;

5225 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
)) {

5226  
	gsu³r
.
equ®s
(
obj
);

5228 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Ne¡edTy³Bè
obj
;

5230 
boŞ—n
 
	g»suÉ
 = 
Œue
;

5231 
	g»suÉ
 = 
»suÉ
 && (
hasSom‘hšg
(è=ğ
Ùh”
.hasSomething());

5232 ià(
hasSom‘hšg
()) {

5233 
	g»suÉ
 = 
»suÉ
 && 
g‘Som‘hšg
()

5234 .
equ®s
(
Ùh”
.
g‘Som‘hšg
());

5236 
	g»suÉ
 = 
»suÉ
 && (
hasSom‘hšg2
(è=ğ
Ùh”
.hasSomething2());

5237 ià(
hasSom‘hšg2
()) {

5238 
	g»suÉ
 = 
»suÉ
 && 
g‘Som‘hšg2
()

5239 .
equ®s
(
Ùh”
.
g‘Som‘hšg2
());

5241 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

5242  
	g»suÉ
;

5245 @
	gjava
.
	gÏng
.
Ov”ride


5246 
public
 
hashCode
() {

5247 ià(
	gmemoizedHashCode
 != 0) {

5248  
memoizedHashCode
;

5250 
	ghash
 = 41;

5251 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

5252 ià(
hasSom‘hšg
()) {

5253 
	ghash
 = (37 * 
hash
è+ 
SOMETHING_FIELD_NUMBER
;

5254 
	ghash
 = (53 * 
hash
è+ 
g‘Som‘hšg
().
hashCode
();

5256 ià(
hasSom‘hšg2
()) {

5257 
	ghash
 = (37 * 
hash
è+ 
SOMETHING2_FIELD_NUMBER
;

5258 
	ghash
 = (53 * 
hash
è+ 
g‘Som‘hšg2
().
hashCode
();

5260 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

5261 
	gmemoizedHashCode
 = 
hash
;

5262  
	ghash
;

5265 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(

5266 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

5267 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5268  
	gPARSER
.
·r£From
(
d©a
);

5270 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(

5271 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

5272 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5273 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5274  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

5276 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(
by‹
[] 
d©a
)

5277 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5278  
	gPARSER
.
·r£From
(
d©a
);

5280 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(

5281 
by‹
[] 
d©a
,

5282 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5283 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5284  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

5286 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

5287 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5288  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5289 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

5291 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(

5292 
java
.
io
.
IÅutSŒ—m
 
šput
,

5293 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5294 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5295  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5296 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5298 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

5299 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5300  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5301 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

5303 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£D–im™edFrom
(

5304 
java
.
io
.
IÅutSŒ—m
 
šput
,

5305 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5306 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5307  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5308 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5310 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(

5311 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

5312 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5313  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5314 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

5316 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
·r£From
(

5317 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5318 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5319 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5320  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5321 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5324 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

5325 
public
 
Bud”
 
ÃwBud”
() {

5326  
	gDEFAULT_INSTANCE
.
toBud”
();

5328 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
 
´ÙÙy³
) {

5329  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

5331 
public
 
Bud”
 
toBud”
() {

5332  
	gthis
 =ğ
DEFAULT_INSTANCE


5333 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

5336 @
	gjava
.
	gÏng
.
Ov”ride


5337 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

5338 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

5339 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

5340  
	gbud”
;

5345 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


5346 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


5348 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³BOrBud”
 {

5349 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5350 
g‘DesütÜ
() {

5351  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_desütÜ
;

5354 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5355 
š‹º®G‘F›ldAcûssÜTabË
() {

5356  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_f›ldAcûssÜTabË


5357 .
’su»F›ldAcûssÜsIn™Ÿlized
(

5358 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.Ne¡edTy³B.
Bud”
.class);

5362 
´iv©e
 
Bud”
() {

5363 
maybeFÜûBud”In™Ÿliz©iÚ
();

5366 
´iv©e
 
Bud”
(

5367 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

5368 
su³r
(
·»Á
);

5369 
maybeFÜûBud”In™Ÿliz©iÚ
();

5371 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

5372 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5373 .
	g®waysU£F›ldBud”s
) {

5376 
public
 
Bud”
 
ş—r
() {

5377 
	gsu³r
.
ş—r
();

5378 
	gsom‘hšg_
 = "";

5379 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

5380 
	gsom‘hšg2_
 = "";

5381 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

5382  
	gthis
;

5385 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5386 
g‘DesütÜFÜTy³
() {

5387  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_desütÜ
;

5390 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
g‘DeçuÉIn¡ªûFÜTy³
() {

5391  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
.
g‘DeçuÉIn¡ªû
();

5394 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
bud
() {

5395 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
	g»suÉ
 = 
budP¬tŸl
();

5396 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

5397 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

5399  
	g»suÉ
;

5402 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
budP¬tŸl
() {

5403 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.Ne¡edTy³B(
this
);

5404 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

5405 
	gto_b™F›ld0_
 = 0;

5406 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

5407 
to_b™F›ld0_
 |= 0x00000001;

5409 
	g»suÉ
.
	gsom‘hšg_
 = 
som‘hšg_
;

5410 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

5411 
to_b™F›ld0_
 |= 0x00000002;

5413 
	g»suÉ
.
	gsom‘hšg2_
 = 
som‘hšg2_
;

5414 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

5415 
ÚBut
();

5416  
	g»suÉ
;

5419 
public
 
Bud”
 
şÚe
() {

5420  (
	gBud”
è
	gsu³r
.
şÚe
();

5422 
public
 
Bud”
 
£tF›ld
(

5423 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

5424 
Objeù
 
v®ue
) {

5425  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

5427 
public
 
Bud”
 
ş—rF›ld
(

5428 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

5429  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

5431 
public
 
Bud”
 
ş—rOÃof
(

5432 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

5433  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

5435 
public
 
Bud”
 
£tR•—‹dF›ld
(

5436 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

5437 
šdex
, 
Objeù
 
v®ue
) {

5438  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

5440 
public
 
Bud”
 
addR•—‹dF›ld
(

5441 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

5442 
Objeù
 
v®ue
) {

5443  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

5445 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

5446 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gNe¡edTy³B
) {

5447  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
)
Ùh”
);

5449 
	gsu³r
.
m”geFrom
(
Ùh”
);

5450  
	gthis
;

5454 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
 
Ùh”
) {

5455 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
.
g‘DeçuÉIn¡ªû
()è 
this
;

5456 ià(
	gÙh”
.
hasSom‘hšg
()) {

5457 
	gb™F›ld0_
 |= 0x00000001;

5458 
	gsom‘hšg_
 = 
Ùh”
.
som‘hšg_
;

5459 
ÚChªged
();

5461 ià(
	gÙh”
.
hasSom‘hšg2
()) {

5462 
	gb™F›ld0_
 |= 0x00000002;

5463 
	gsom‘hšg2_
 = 
Ùh”
.
som‘hšg2_
;

5464 
ÚChªged
();

5466 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

5467 
ÚChªged
();

5468  
	gthis
;

5471 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

5472  
	gŒue
;

5475 
public
 
Bud”
 
m”geFrom
(

5476 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5477 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5478 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5479 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
	g·r£dMes§ge
 = 
nuÎ
;

5480 
	gŒy
 {

5481 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

5482 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

5483 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
è
e
.
g‘UnfšishedMes§ge
();

5484 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

5485 } 
	gfš®ly
 {

5486 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

5487 
m”geFrom
(
·r£dMes§ge
);

5490  
	gthis
;

5492 
´iv©e
 
	gb™F›ld0_
;

5494 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gsom‘hšg_
 = "";

5498 
public
 
boŞ—n
 
hasSom‘hšg
() {

5499  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

5504 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Som‘hšg
() {

5505 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg_
;

5506 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

5507 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

5508 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

5509 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

5510 ià(
	gbs
.
isV®idUtf8
()) {

5511 
	gsom‘hšg_
 = 
s
;

5513  
	gs
;

5515  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

5521 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


5522 
g‘Som‘hšgBy‹s
() {

5523 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg_
;

5524 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

5525 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

5526 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

5527 (
java
.
Ïng
.
SŒšg
è
»f
);

5528 
	gsom‘hšg_
 = 
b
;

5529  
	gb
;

5531  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

5537 
public
 
Bud”
 
£tSom‘hšg
(

5538 
java
.
Ïng
.
SŒšg
 
v®ue
) {

5539 ià(
	gv®ue
 =ğ
nuÎ
) {

5540 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

5542 
	gb™F›ld0_
 |= 0x00000001;

5543 
	gsom‘hšg_
 = 
v®ue
;

5544 
ÚChªged
();

5545  
	gthis
;

5550 
public
 
Bud”
 
ş—rSom‘hšg
() {

5551 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

5552 
	gsom‘hšg_
 = 
g‘DeçuÉIn¡ªû
().
g‘Som‘hšg
();

5553 
ÚChªged
();

5554  
	gthis
;

5559 
public
 
Bud”
 
£tSom‘hšgBy‹s
(

5560 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

5561 ià(
	gv®ue
 =ğ
nuÎ
) {

5562 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

5564 
	gb™F›ld0_
 |= 0x00000001;

5565 
	gsom‘hšg_
 = 
v®ue
;

5566 
ÚChªged
();

5567  
	gthis
;

5570 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gsom‘hšg2_
 = "";

5574 
public
 
boŞ—n
 
hasSom‘hšg2
() {

5575  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

5580 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Som‘hšg2
() {

5581 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg2_
;

5582 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

5583 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

5584 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

5585 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

5586 ià(
	gbs
.
isV®idUtf8
()) {

5587 
	gsom‘hšg2_
 = 
s
;

5589  
	gs
;

5591  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

5597 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


5598 
g‘Som‘hšg2By‹s
() {

5599 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
som‘hšg2_
;

5600 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

5601 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

5602 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

5603 (
java
.
Ïng
.
SŒšg
è
»f
);

5604 
	gsom‘hšg2_
 = 
b
;

5605  
	gb
;

5607  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

5613 
public
 
Bud”
 
£tSom‘hšg2
(

5614 
java
.
Ïng
.
SŒšg
 
v®ue
) {

5615 ià(
	gv®ue
 =ğ
nuÎ
) {

5616 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

5618 
	gb™F›ld0_
 |= 0x00000002;

5619 
	gsom‘hšg2_
 = 
v®ue
;

5620 
ÚChªged
();

5621  
	gthis
;

5626 
public
 
Bud”
 
ş—rSom‘hšg2
() {

5627 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

5628 
	gsom‘hšg2_
 = 
g‘DeçuÉIn¡ªû
().
g‘Som‘hšg2
();

5629 
ÚChªged
();

5630  
	gthis
;

5635 
public
 
Bud”
 
£tSom‘hšg2By‹s
(

5636 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

5637 ià(
	gv®ue
 =ğ
nuÎ
) {

5638 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

5640 
	gb™F›ld0_
 |= 0x00000002;

5641 
	gsom‘hšg2_
 = 
v®ue
;

5642 
ÚChªged
();

5643  
	gthis
;

5645 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

5646 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

5647  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

5650 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

5651 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

5652  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

5660 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
	gDEFAULT_INSTANCE
;

5662 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
Ne¡edTy³B
();

5665 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
g‘DeçuÉIn¡ªû
() {

5666  
	gDEFAULT_INSTANCE
;

5669 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gNe¡edTy³B
>

5670 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Ne¡edTy³B
>() {

5671 
public
 
Ne¡edTy³B
 
·r£P¬tŸlFrom
(

5672 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5673 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5674 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

5675  
Ãw
 
Ne¡edTy³B
(
šput
, 
ex‹nsiÚRegi¡ry
);

5679 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gNe¡edTy³B
> 
·r£r
() {

5680  
	gPARSER
;

5683 @
	gjava
.
	gÏng
.
Ov”ride


5684 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gNe¡edTy³B
> 
g‘P¬£rFÜTy³
() {

5685  
	gPARSER
;

5688 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
Ne¡edTy³B
 
g‘DeçuÉIn¡ªûFÜTy³
() {

5689  
	gDEFAULT_INSTANCE
;

5694 
public
 
š‹rçû
 
MªagedResourûO±iÚsMsgOrBud”
 
ex‹nds


5696 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

5701 
boŞ—n
 
hasSkSÇpshÙ
();

5705 
boŞ—n
 
g‘SkSÇpshÙ
();

5710 
public
 
fš®
 
şass
 
MªagedResourûO±iÚsMsg
 
ex‹nds


5711 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


5713 
	gMªagedResourûO±iÚsMsgOrBud”
 {

5715 
´iv©e
 
MªagedResourûO±iÚsMsg
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

5716 
su³r
(
bud”
);

5718 
´iv©e
 
MªagedResourûO±iÚsMsg
() {

5719 
	gskSÇpshÙ_
 = 
çl£
;

5722 @
	gjava
.
	gÏng
.
Ov”ride


5723 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


5724 
g‘UnknownF›lds
() {

5725  
	gthis
.
	gunknownF›lds
;

5727 
´iv©e
 
MªagedResourûO±iÚsMsg
(

5728 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5729 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5730 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5731 
this
();

5732 
	gmubË_b™F›ld0_
 = 0;

5733 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

5734 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

5735 
	gŒy
 {

5736 
boŞ—n
 
	gdÚe
 = 
çl£
;

5737 !
	gdÚe
) {

5738 
	gg
 = 
šput
.
»adTag
();

5739 
	gg
) {

5741 
dÚe
 = 
Œue
;

5744 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

5745 
ex‹nsiÚRegi¡ry
, 
g
)) {

5746 
	gdÚe
 = 
Œue
;

5751 
b™F›ld0_
 |= 0x00000001;

5752 
	gskSÇpshÙ_
 = 
šput
.
»adBoŞ
();

5757 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

5758 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

5759 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

5760 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

5761 
e
).
£tUnfšishedMes§ge
(
this
);

5762 } 
	gfš®ly
 {

5763 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

5764 
makeEx‹nsiÚsImmubË
();

5767 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5768 
g‘DesütÜ
() {

5769  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_desütÜ
;

5772 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5773 
š‹º®G‘F›ldAcûssÜTabË
() {

5774  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_f›ldAcûssÜTabË


5775 .
’su»F›ldAcûssÜsIn™Ÿlized
(

5776 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.MªagedResourûO±iÚsMsg.
Bud”
.class);

5779 
´iv©e
 
	gb™F›ld0_
;

5780 
public
 
fš®
 
	gSKIP_SNAPSHOT_FIELD_NUMBER
 = 1;

5781 
´iv©e
 
boŞ—n
 
	gskSÇpshÙ_
;

5785 
public
 
boŞ—n
 
hasSkSÇpshÙ
() {

5786  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

5791 
public
 
boŞ—n
 
g‘SkSÇpshÙ
() {

5792  
	gskSÇpshÙ_
;

5795 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

5796 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

5797 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

5798 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

5799 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

5801 
	gmemoizedIsIn™Ÿlized
 = 1;

5802  
	gŒue
;

5805 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

5806 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5807 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

5808 
ouut
.
wr™eBoŞ
(1, 
skSÇpshÙ_
);

5810 
	gunknownF›lds
.
wr™eTo
(
ouut
);

5813 
public
 
g‘S”ŸlizedSize
() {

5814 
	gsize
 = 
memoizedSize
;

5815 ià(
	gsize
 !ğ-1è 
size
;

5817 
	gsize
 = 0;

5818 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

5819 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


5820 .
compu‹BoŞSize
(1, 
skSÇpshÙ_
);

5822 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

5823 
	gmemoizedSize
 = 
size
;

5824  
	gsize
;

5827 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

5828 @
	gjava
.
	gÏng
.
Ov”ride


5829 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

5830 ià(
	gobj
 =ğ
this
) {

5831  
Œue
;

5833 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûO±iÚsMsg
)) {

5834  
	gsu³r
.
equ®s
(
obj
);

5836 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.MªagedResourûO±iÚsMsgè
obj
;

5838 
boŞ—n
 
	g»suÉ
 = 
Œue
;

5839 
	g»suÉ
 = 
»suÉ
 && (
hasSkSÇpshÙ
(è=ğ
Ùh”
.hasSkipSnapshot());

5840 ià(
hasSkSÇpshÙ
()) {

5841 
	g»suÉ
 = 
»suÉ
 && (
g‘SkSÇpshÙ
()

5842 =ğ
Ùh”
.
g‘SkSÇpshÙ
());

5844 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

5845  
	g»suÉ
;

5848 @
	gjava
.
	gÏng
.
Ov”ride


5849 
public
 
hashCode
() {

5850 ià(
	gmemoizedHashCode
 != 0) {

5851  
memoizedHashCode
;

5853 
	ghash
 = 41;

5854 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

5855 ià(
hasSkSÇpshÙ
()) {

5856 
	ghash
 = (37 * 
hash
è+ 
SKIP_SNAPSHOT_FIELD_NUMBER
;

5857 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashBoŞ—n
(

5858 
g‘SkSÇpshÙ
());

5860 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

5861 
	gmemoizedHashCode
 = 
hash
;

5862  
	ghash
;

5865 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(

5866 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

5867 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5868  
	gPARSER
.
·r£From
(
d©a
);

5870 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(

5871 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

5872 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5873 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5874  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

5876 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(
by‹
[] 
d©a
)

5877 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5878  
	gPARSER
.
·r£From
(
d©a
);

5880 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(

5881 
by‹
[] 
d©a
,

5882 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5883 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

5884  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

5886 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

5887 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5888  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5889 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

5891 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(

5892 
java
.
io
.
IÅutSŒ—m
 
šput
,

5893 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5894 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5895  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5896 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5898 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

5899 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5900  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5901 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

5903 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£D–im™edFrom
(

5904 
java
.
io
.
IÅutSŒ—m
 
šput
,

5905 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5906 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5907  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5908 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5910 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(

5911 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

5912 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5913  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5914 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

5916 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
·r£From
(

5917 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

5918 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

5919 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

5920  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5921 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

5924 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

5925 
public
 
Bud”
 
ÃwBud”
() {

5926  
	gDEFAULT_INSTANCE
.
toBud”
();

5928 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
 
´ÙÙy³
) {

5929  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

5931 
public
 
Bud”
 
toBud”
() {

5932  
	gthis
 =ğ
DEFAULT_INSTANCE


5933 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

5936 @
	gjava
.
	gÏng
.
Ov”ride


5937 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

5938 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

5939 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

5940  
	gbud”
;

5945 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


5946 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


5948 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûO±iÚsMsgOrBud”
 {

5949 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5950 
g‘DesütÜ
() {

5951  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_desütÜ
;

5954 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


5955 
š‹º®G‘F›ldAcûssÜTabË
() {

5956  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_f›ldAcûssÜTabË


5957 .
’su»F›ldAcûssÜsIn™Ÿlized
(

5958 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
.
şass
, org.cÜfudb.‹¡.Sam¶eSchema.MªagedResourûO±iÚsMsg.
Bud”
.class);

5962 
´iv©e
 
Bud”
() {

5963 
maybeFÜûBud”In™Ÿliz©iÚ
();

5966 
´iv©e
 
Bud”
(

5967 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

5968 
su³r
(
·»Á
);

5969 
maybeFÜûBud”In™Ÿliz©iÚ
();

5971 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

5972 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


5973 .
	g®waysU£F›ldBud”s
) {

5976 
public
 
Bud”
 
ş—r
() {

5977 
	gsu³r
.
ş—r
();

5978 
	gskSÇpshÙ_
 = 
çl£
;

5979 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

5980  
	gthis
;

5983 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


5984 
g‘DesütÜFÜTy³
() {

5985  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_desütÜ
;

5988 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

5989  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûO±iÚsMsg
.
g‘DeçuÉIn¡ªû
();

5992 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
bud
() {

5993 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
	g»suÉ
 = 
budP¬tŸl
();

5994 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

5995 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

5997  
	g»suÉ
;

6000 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
budP¬tŸl
() {

6001 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.MªagedResourûO±iÚsMsg(
this
);

6002 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

6003 
	gto_b™F›ld0_
 = 0;

6004 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

6005 
to_b™F›ld0_
 |= 0x00000001;

6007 
	g»suÉ
.
	gskSÇpshÙ_
 = 
skSÇpshÙ_
;

6008 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

6009 
ÚBut
();

6010  
	g»suÉ
;

6013 
public
 
Bud”
 
şÚe
() {

6014  (
	gBud”
è
	gsu³r
.
şÚe
();

6016 
public
 
Bud”
 
£tF›ld
(

6017 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

6018 
Objeù
 
v®ue
) {

6019  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

6021 
public
 
Bud”
 
ş—rF›ld
(

6022 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

6023  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

6025 
public
 
Bud”
 
ş—rOÃof
(

6026 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

6027  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

6029 
public
 
Bud”
 
£tR•—‹dF›ld
(

6030 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

6031 
šdex
, 
Objeù
 
v®ue
) {

6032  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

6034 
public
 
Bud”
 
addR•—‹dF›ld
(

6035 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

6036 
Objeù
 
v®ue
) {

6037  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

6039 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

6040 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûO±iÚsMsg
) {

6041  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
)
Ùh”
);

6043 
	gsu³r
.
m”geFrom
(
Ùh”
);

6044  
	gthis
;

6048 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
 
Ùh”
) {

6049 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
.
g‘DeçuÉIn¡ªû
()è 
this
;

6050 ià(
	gÙh”
.
hasSkSÇpshÙ
()) {

6051 
£tSkSÇpshÙ
(
Ùh”
.
g‘SkSÇpshÙ
());

6053 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

6054 
ÚChªged
();

6055  
	gthis
;

6058 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

6059  
	gŒue
;

6062 
public
 
Bud”
 
m”geFrom
(

6063 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

6064 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

6065 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

6066 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
	g·r£dMes§ge
 = 
nuÎ
;

6067 
	gŒy
 {

6068 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

6069 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

6070 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
è
e
.
g‘UnfšishedMes§ge
();

6071 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

6072 } 
	gfš®ly
 {

6073 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

6074 
m”geFrom
(
·r£dMes§ge
);

6077  
	gthis
;

6079 
´iv©e
 
	gb™F›ld0_
;

6081 
´iv©e
 
boŞ—n
 
	gskSÇpshÙ_
 ;

6085 
public
 
boŞ—n
 
hasSkSÇpshÙ
() {

6086  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

6091 
public
 
boŞ—n
 
g‘SkSÇpshÙ
() {

6092  
	gskSÇpshÙ_
;

6097 
public
 
Bud”
 
£tSkSÇpshÙ
(
boŞ—n
 
v®ue
) {

6098 
	gb™F›ld0_
 |= 0x00000001;

6099 
	gskSÇpshÙ_
 = 
v®ue
;

6100 
ÚChªged
();

6101  
	gthis
;

6106 
public
 
Bud”
 
ş—rSkSÇpshÙ
() {

6107 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

6108 
	gskSÇpshÙ_
 = 
çl£
;

6109 
ÚChªged
();

6110  
	gthis
;

6112 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

6113 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

6114  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

6117 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

6118 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

6119  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

6127 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
	gDEFAULT_INSTANCE
;

6129 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
();

6132 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
g‘DeçuÉIn¡ªû
() {

6133  
	gDEFAULT_INSTANCE
;

6136 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûO±iÚsMsg
>

6137 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
MªagedResourûO±iÚsMsg
>() {

6138 
public
 
MªagedResourûO±iÚsMsg
 
·r£P¬tŸlFrom
(

6139 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

6140 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

6141 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

6142  
Ãw
 
MªagedResourûO±iÚsMsg
(
šput
, 
ex‹nsiÚRegi¡ry
);

6146 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûO±iÚsMsg
> 
·r£r
() {

6147  
	gPARSER
;

6150 @
	gjava
.
	gÏng
.
Ov”ride


6151 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûO±iÚsMsg
> 
g‘P¬£rFÜTy³
() {

6152  
	gPARSER
;

6155 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
MªagedResourûO±iÚsMsg
 
g‘DeçuÉIn¡ªûFÜTy³
() {

6156  
	gDEFAULT_INSTANCE
;

6161 
public
 
fš®
 
	gMGOPTIONS_FIELD_NUMBER
 = 54312;

6165 
public
 
fš®


6166 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§ge
.
	gG’”©edEx‹nsiÚ
<

6167 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
	gMes§geO±iÚs
,

6168 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eSchema
.
	gMªagedResourûO±iÚsMsg
> 
	gmgİtiÚs
 = 
com
.
googË
.
´Ùobuf
.
G’”©edMes§ge


6169 .
ÃwFeScİedG’”©edEx‹nsiÚ
(

6170 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
.
şass
,

6171 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
MªagedResourûO±iÚsMsg
.
g‘DeçuÉIn¡ªû
());

6172 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6173 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_desütÜ
;

6174 
´iv©e
 
fš®


6175 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6176 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_f›ldAcûssÜTabË
;

6177 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6178 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_desütÜ
;

6179 
´iv©e
 
fš®


6180 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6181 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_f›ldAcûssÜTabË
;

6182 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6183 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

6184 
´iv©e
 
fš®


6185 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6186 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË
;

6187 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6188 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

6189 
´iv©e
 
fš®


6190 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6191 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË
;

6192 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6193 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

6194 
´iv©e
 
fš®


6195 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6196 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË
;

6197 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6198 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_desütÜ
;

6199 
´iv©e
 
fš®


6200 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6201 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_f›ldAcûssÜTabË
;

6202 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6203 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_desütÜ
;

6204 
´iv©e
 
fš®


6205 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6206 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_f›ldAcûssÜTabË
;

6207 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


6208 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_desütÜ
;

6209 
´iv©e
 
fš®


6210 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


6211 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_f›ldAcûssÜTabË
;

6213 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


6214 
	$g‘DesütÜ
() {

6215  
desütÜ
;

6216 
	}
}

6217 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


6218 
	gdesütÜ
;

6220 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

6246 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

6247 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

6248 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

6249 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

6250 
desütÜ
 = 
roÙ
;

6251  
	gnuÎ
;

6254 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


6255 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

6256 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

6257 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
g‘DesütÜ
(),

6258 
com
.
googË
.
´Ùobuf
.
DesütÜPrÙos
.
g‘DesütÜ
(),

6259 
Üg
.
cÜfudb
.
‹¡
.
Sam¶eAµlŸnû
.
g‘DesütÜ
(),

6260 }, 
assigÃr
);

6261 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_desütÜ
 =

6262 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

6263 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_f›ldAcûssÜTabË
 = 
Ãw


6264 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6265 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Fœew®lRuË_desütÜ
,

6266 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "RuleId", "RuleName", "Input", "Output", });

6267 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_desütÜ
 =

6268 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

6269 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_f›ldAcûssÜTabË
 = 
Ãw


6270 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6271 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_LogiÿlSw™ch_desütÜ
,

6272 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "SwitchId", "Input", "Aray", });

6273 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
 =

6274 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(2);

6275 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË
 = 
Ãw


6276 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6277 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
,

6278 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "CreateUser", "Version", "CreateTimestamp", "NestedType", });

6279 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
 =

6280 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(3);

6281 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË
 = 
Ãw


6282 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6283 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
,

6284 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Id", "Name", "Port", "EventTime", "Frequency", });

6285 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
 =

6286 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(4);

6287 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË
 = 
Ãw


6288 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6289 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
,

6290 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Msb", "Lsb", });

6291 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_desütÜ
 =

6292 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(5);

6293 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_f›ldAcûssÜTabË
 = 
Ãw


6294 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6295 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³A_desütÜ
,

6296 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Tag", });

6297 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_desütÜ
 =

6298 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(6);

6299 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_f›ldAcûssÜTabË
 = 
Ãw


6300 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6301 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Ne¡edTy³B_desütÜ
,

6302 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Something", "Something2", });

6303 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_desütÜ
 =

6304 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(7);

6305 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_f›ldAcûssÜTabË
 = 
Ãw


6306 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

6307 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûO±iÚsMsg_desütÜ
,

6308 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "SkipSnapshot", });

6309 
	gmgİtiÚs
.
š‹º®In™
(
desütÜ
.
g‘Ex‹nsiÚs
().
g‘
(0));

6310 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
	g»gi¡ry
 =

6311 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
.
ÃwIn¡ªû
();

6312 
	g»gi¡ry
.
add
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
schema
);

6313 
	g»gi¡ry
.
add
(
Üg
.
cÜfudb
.
‹¡
.
Sam¶eSchema
.
mgİtiÚs
);

6314 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


6315 .
š‹º®Upd©eFeDesütÜ
(
desütÜ
, 
»gi¡ry
);

6316 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
g‘DesütÜ
();

6317 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜPrÙos
.
g‘DesütÜ
();

6318 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gSam¶eAµlŸnû
.
g‘DesütÜ
();

	@test/target/generated-sources/org/corfudb/test/TestSchema.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	g‹¡
;

6 
public
 
fš®
 cÏs 
	cTe¡Schema
 {

7 
´iv©e
 
	$Te¡Schema
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
UuidOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
boŞ—n
 
hasMsb
();

28 
g‘Msb
();

33 
boŞ—n
 
hasLsb
();

37 
g‘Lsb
();

42 
public
 
fš®
 
şass
 
Uuid
 
ex‹nds


43 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


45 
	gUuidOrBud”
 {

47 
´iv©e
 
Uuid
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

48 
su³r
(
bud”
);

50 
´iv©e
 
Uuid
() {

51 
	gmsb_
 = 0L;

52 
	glsb_
 = 0L;

55 @
	gjava
.
	gÏng
.
Ov”ride


56 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


57 
g‘UnknownF›lds
() {

58  
	gthis
.
	gunknownF›lds
;

60 
´iv©e
 
Uuid
(

61 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

62 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

63 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

64 
this
();

65 
	gmubË_b™F›ld0_
 = 0;

66 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

67 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

68 
	gŒy
 {

69 
boŞ—n
 
	gdÚe
 = 
çl£
;

70 !
	gdÚe
) {

71 
	gg
 = 
šput
.
»adTag
();

72 
	gg
) {

74 
dÚe
 = 
Œue
;

77 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

78 
ex‹nsiÚRegi¡ry
, 
g
)) {

79 
	gdÚe
 = 
Œue
;

84 
b™F›ld0_
 |= 0x00000001;

85 
	gmsb_
 = 
šput
.
»adUIÁ64
();

89 
b™F›ld0_
 |= 0x00000002;

90 
	glsb_
 = 
šput
.
»adUIÁ64
();

95 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

96 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

97 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

98 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

99 
e
).
£tUnfšishedMes§ge
(
this
);

100 } 
	gfš®ly
 {

101 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

102 
makeEx‹nsiÚsImmubË
();

105 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


106 
g‘DesütÜ
() {

107  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

110 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


111 
š‹º®G‘F›ldAcûssÜTabË
() {

112  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË


113 .
’su»F›ldAcûssÜsIn™Ÿlized
(

114 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
.
şass
, org.cÜfudb.‹¡.Te¡Schema.Uuid.
Bud”
.class);

117 
´iv©e
 
	gb™F›ld0_
;

118 
public
 
fš®
 
	gMSB_FIELD_NUMBER
 = 1;

119 
´iv©e
 
	gmsb_
;

123 
public
 
boŞ—n
 
hasMsb
() {

124  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

129 
public
 
g‘Msb
() {

130  
	gmsb_
;

133 
public
 
fš®
 
	gLSB_FIELD_NUMBER
 = 2;

134 
´iv©e
 
	glsb_
;

138 
public
 
boŞ—n
 
hasLsb
() {

139  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

144 
public
 
g‘Lsb
() {

145  
	glsb_
;

148 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

149 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

150 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

151 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

152 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

154 
	gmemoizedIsIn™Ÿlized
 = 1;

155  
	gŒue
;

158 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

159 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

160 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

161 
ouut
.
wr™eUIÁ64
(1, 
msb_
);

163 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

164 
ouut
.
wr™eUIÁ64
(2, 
lsb_
);

166 
	gunknownF›lds
.
wr™eTo
(
ouut
);

169 
public
 
g‘S”ŸlizedSize
() {

170 
	gsize
 = 
memoizedSize
;

171 ià(
	gsize
 !ğ-1è 
size
;

173 
	gsize
 = 0;

174 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

175 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


176 .
compu‹UIÁ64Size
(1, 
msb_
);

178 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

179 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


180 .
compu‹UIÁ64Size
(2, 
lsb_
);

182 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

183 
	gmemoizedSize
 = 
size
;

184  
	gsize
;

187 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

188 @
	gjava
.
	gÏng
.
Ov”ride


189 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

190 ià(
	gobj
 =ğ
this
) {

191  
Œue
;

193 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gUuid
)) {

194  
	gsu³r
.
equ®s
(
obj
);

196 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.Uuidè
obj
;

198 
boŞ—n
 
	g»suÉ
 = 
Œue
;

199 
	g»suÉ
 = 
»suÉ
 && (
hasMsb
(è=ğ
Ùh”
.hasMsb());

200 ià(
hasMsb
()) {

201 
	g»suÉ
 = 
»suÉ
 && (
g‘Msb
()

202 =ğ
Ùh”
.
g‘Msb
());

204 
	g»suÉ
 = 
»suÉ
 && (
hasLsb
(è=ğ
Ùh”
.hasLsb());

205 ià(
hasLsb
()) {

206 
	g»suÉ
 = 
»suÉ
 && (
g‘Lsb
()

207 =ğ
Ùh”
.
g‘Lsb
());

209 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

210  
	g»suÉ
;

213 @
	gjava
.
	gÏng
.
Ov”ride


214 
public
 
hashCode
() {

215 ià(
	gmemoizedHashCode
 != 0) {

216  
memoizedHashCode
;

218 
	ghash
 = 41;

219 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

220 ià(
hasMsb
()) {

221 
	ghash
 = (37 * 
hash
è+ 
MSB_FIELD_NUMBER
;

222 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

223 
g‘Msb
());

225 ià(
hasLsb
()) {

226 
	ghash
 = (37 * 
hash
è+ 
LSB_FIELD_NUMBER
;

227 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

228 
g‘Lsb
());

230 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

231 
	gmemoizedHashCode
 = 
hash
;

232  
	ghash
;

235 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(

236 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

237 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

238  
	gPARSER
.
·r£From
(
d©a
);

240 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(

241 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

242 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

243 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

244  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

246 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(
by‹
[] 
d©a
)

247 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

248  
	gPARSER
.
·r£From
(
d©a
);

250 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(

251 
by‹
[] 
d©a
,

252 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

253 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

254  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

256 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

257 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

258  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


259 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

261 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(

262 
java
.
io
.
IÅutSŒ—m
 
šput
,

263 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

264 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

265  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


266 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

268 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

269 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

270  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


271 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

273 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£D–im™edFrom
(

274 
java
.
io
.
IÅutSŒ—m
 
šput
,

275 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

276 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

277  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


278 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

280 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(

281 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

282 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

283  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


284 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

286 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
·r£From
(

287 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

288 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

289 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

290  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


291 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

294 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

295 
public
 
Bud”
 
ÃwBud”
() {

296  
	gDEFAULT_INSTANCE
.
toBud”
();

298 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
 
´ÙÙy³
) {

299  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

301 
public
 
Bud”
 
toBud”
() {

302  
	gthis
 =ğ
DEFAULT_INSTANCE


303 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

306 @
	gjava
.
	gÏng
.
Ov”ride


307 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

308 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

309 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

310  
	gbud”
;

315 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


316 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


318 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gUuidOrBud”
 {

319 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


320 
g‘DesütÜ
() {

321  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

324 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


325 
š‹º®G‘F›ldAcûssÜTabË
() {

326  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË


327 .
’su»F›ldAcûssÜsIn™Ÿlized
(

328 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
.
şass
, org.cÜfudb.‹¡.Te¡Schema.Uuid.
Bud”
.class);

332 
´iv©e
 
Bud”
() {

333 
maybeFÜûBud”In™Ÿliz©iÚ
();

336 
´iv©e
 
Bud”
(

337 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

338 
su³r
(
·»Á
);

339 
maybeFÜûBud”In™Ÿliz©iÚ
();

341 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

342 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


343 .
	g®waysU£F›ldBud”s
) {

346 
public
 
Bud”
 
ş—r
() {

347 
	gsu³r
.
ş—r
();

348 
	gmsb_
 = 0L;

349 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

350 
	glsb_
 = 0L;

351 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

352  
	gthis
;

355 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


356 
g‘DesütÜFÜTy³
() {

357  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

360 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
g‘DeçuÉIn¡ªûFÜTy³
() {

361  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gUuid
.
g‘DeçuÉIn¡ªû
();

364 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
bud
() {

365 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
	g»suÉ
 = 
budP¬tŸl
();

366 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

367 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

369  
	g»suÉ
;

372 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
budP¬tŸl
() {

373 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.Uuid(
this
);

374 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

375 
	gto_b™F›ld0_
 = 0;

376 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

377 
to_b™F›ld0_
 |= 0x00000001;

379 
	g»suÉ
.
	gmsb_
 = 
msb_
;

380 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

381 
to_b™F›ld0_
 |= 0x00000002;

383 
	g»suÉ
.
	glsb_
 = 
lsb_
;

384 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

385 
ÚBut
();

386  
	g»suÉ
;

389 
public
 
Bud”
 
şÚe
() {

390  (
	gBud”
è
	gsu³r
.
şÚe
();

392 
public
 
Bud”
 
£tF›ld
(

393 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

394 
Objeù
 
v®ue
) {

395  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

397 
public
 
Bud”
 
ş—rF›ld
(

398 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

399  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

401 
public
 
Bud”
 
ş—rOÃof
(

402 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

403  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

405 
public
 
Bud”
 
£tR•—‹dF›ld
(

406 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

407 
šdex
, 
Objeù
 
v®ue
) {

408  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

410 
public
 
Bud”
 
addR•—‹dF›ld
(

411 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

412 
Objeù
 
v®ue
) {

413  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

415 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

416 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gUuid
) {

417  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
)
Ùh”
);

419 
	gsu³r
.
m”geFrom
(
Ùh”
);

420  
	gthis
;

424 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
 
Ùh”
) {

425 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
.
g‘DeçuÉIn¡ªû
()è 
this
;

426 ià(
	gÙh”
.
hasMsb
()) {

427 
£tMsb
(
Ùh”
.
g‘Msb
());

429 ià(
	gÙh”
.
hasLsb
()) {

430 
£tLsb
(
Ùh”
.
g‘Lsb
());

432 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

433 
ÚChªged
();

434  
	gthis
;

437 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

438  
	gŒue
;

441 
public
 
Bud”
 
m”geFrom
(

442 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

443 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

444 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

445 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
	g·r£dMes§ge
 = 
nuÎ
;

446 
	gŒy
 {

447 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

448 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

449 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
è
e
.
g‘UnfšishedMes§ge
();

450 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

451 } 
	gfš®ly
 {

452 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

453 
m”geFrom
(
·r£dMes§ge
);

456  
	gthis
;

458 
´iv©e
 
	gb™F›ld0_
;

460 
´iv©e
 
	gmsb_
 ;

464 
public
 
boŞ—n
 
hasMsb
() {

465  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

470 
public
 
g‘Msb
() {

471  
	gmsb_
;

476 
public
 
Bud”
 
£tMsb
(
v®ue
) {

477 
	gb™F›ld0_
 |= 0x00000001;

478 
	gmsb_
 = 
v®ue
;

479 
ÚChªged
();

480  
	gthis
;

485 
public
 
Bud”
 
ş—rMsb
() {

486 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

487 
	gmsb_
 = 0L;

488 
ÚChªged
();

489  
	gthis
;

492 
´iv©e
 
	glsb_
 ;

496 
public
 
boŞ—n
 
hasLsb
() {

497  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

502 
public
 
g‘Lsb
() {

503  
	glsb_
;

508 
public
 
Bud”
 
£tLsb
(
v®ue
) {

509 
	gb™F›ld0_
 |= 0x00000002;

510 
	glsb_
 = 
v®ue
;

511 
ÚChªged
();

512  
	gthis
;

517 
public
 
Bud”
 
ş—rLsb
() {

518 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

519 
	glsb_
 = 0L;

520 
ÚChªged
();

521  
	gthis
;

523 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

524 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

525  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

528 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

529 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

530  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

538 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
	gDEFAULT_INSTANCE
;

540 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Uuid
();

543 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
g‘DeçuÉIn¡ªû
() {

544  
	gDEFAULT_INSTANCE
;

547 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
>

548 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Uuid
>() {

549 
public
 
Uuid
 
·r£P¬tŸlFrom
(

550 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

551 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

552 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

553  
Ãw
 
Uuid
(
šput
, 
ex‹nsiÚRegi¡ry
);

557 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
> 
·r£r
() {

558  
	gPARSER
;

561 @
	gjava
.
	gÏng
.
Ov”ride


562 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
> 
g‘P¬£rFÜTy³
() {

563  
	gPARSER
;

566 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Uuid
 
g‘DeçuÉIn¡ªûFÜTy³
() {

567  
	gDEFAULT_INSTANCE
;

572 
public
 
š‹rçû
 
Ev’tInfoOrBud”
 
ex‹nds


574 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

579 
boŞ—n
 
hasId
();

583 
g‘Id
();

588 
boŞ—n
 
hasName
();

592 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
();

596 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


597 
g‘NameBy‹s
();

602 
boŞ—n
 
hasPÜt
();

606 
g‘PÜt
();

611 
boŞ—n
 
hasEv’tTime
();

615 
g‘Ev’tTime
();

620 
boŞ—n
 
hasF»qu’cy
();

624 
g‘F»qu’cy
();

629 
public
 
fš®
 
şass
 
Ev’tInfo
 
ex‹nds


630 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


632 
	gEv’tInfoOrBud”
 {

634 
´iv©e
 
Ev’tInfo
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

635 
su³r
(
bud”
);

637 
´iv©e
 
Ev’tInfo
() {

638 
	gid_
 = 0;

639 
	gÇme_
 = "";

640 
	gpÜt_
 = 0;

641 
	gev’tTime_
 = 0L;

642 
	gäequ’cy_
 = 0;

645 @
	gjava
.
	gÏng
.
Ov”ride


646 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


647 
g‘UnknownF›lds
() {

648  
	gthis
.
	gunknownF›lds
;

650 
´iv©e
 
Ev’tInfo
(

651 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

652 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

653 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

654 
this
();

655 
	gmubË_b™F›ld0_
 = 0;

656 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

657 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

658 
	gŒy
 {

659 
boŞ—n
 
	gdÚe
 = 
çl£
;

660 !
	gdÚe
) {

661 
	gg
 = 
šput
.
»adTag
();

662 
	gg
) {

664 
dÚe
 = 
Œue
;

667 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

668 
ex‹nsiÚRegi¡ry
, 
g
)) {

669 
	gdÚe
 = 
Œue
;

674 
b™F›ld0_
 |= 0x00000001;

675 
	gid_
 = 
šput
.
»adUIÁ32
();

679 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

680 
	gb™F›ld0_
 |= 0x00000002;

681 
	gÇme_
 = 
bs
;

685 
b™F›ld0_
 |= 0x00000004;

686 
	gpÜt_
 = 
šput
.
»adUIÁ32
();

690 
b™F›ld0_
 |= 0x00000008;

691 
	gev’tTime_
 = 
šput
.
»adIÁ64
();

695 
b™F›ld0_
 |= 0x00000010;

696 
	gäequ’cy_
 = 
šput
.
»adUIÁ32
();

701 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

702 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

703 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

704 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

705 
e
).
£tUnfšishedMes§ge
(
this
);

706 } 
	gfš®ly
 {

707 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

708 
makeEx‹nsiÚsImmubË
();

711 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


712 
g‘DesütÜ
() {

713  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

716 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


717 
š‹º®G‘F›ldAcûssÜTabË
() {

718  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË


719 .
’su»F›ldAcûssÜsIn™Ÿlized
(

720 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
.
şass
, org.cÜfudb.‹¡.Te¡Schema.Ev’tInfo.
Bud”
.class);

723 
´iv©e
 
	gb™F›ld0_
;

724 
public
 
fš®
 
	gID_FIELD_NUMBER
 = 1;

725 
´iv©e
 
	gid_
;

729 
public
 
boŞ—n
 
hasId
() {

730  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

735 
public
 
g‘Id
() {

736  
	gid_
;

739 
public
 
fš®
 
	gNAME_FIELD_NUMBER
 = 2;

740 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gÇme_
;

744 
public
 
boŞ—n
 
hasName
() {

745  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

750 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
() {

751 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

752 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

753  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

755 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

756 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

757 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

758 ià(
	gbs
.
isV®idUtf8
()) {

759 
	gÇme_
 = 
s
;

761  
	gs
;

767 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


768 
g‘NameBy‹s
() {

769 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

770 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

771 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

772 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

773 (
java
.
Ïng
.
SŒšg
è
»f
);

774 
	gÇme_
 = 
b
;

775  
	gb
;

777  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

781 
public
 
fš®
 
	gPORT_FIELD_NUMBER
 = 3;

782 
´iv©e
 
	gpÜt_
;

786 
public
 
boŞ—n
 
hasPÜt
() {

787  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

792 
public
 
g‘PÜt
() {

793  
	gpÜt_
;

796 
public
 
fš®
 
	gEVENT_TIME_FIELD_NUMBER
 = 4;

797 
´iv©e
 
	gev’tTime_
;

801 
public
 
boŞ—n
 
hasEv’tTime
() {

802  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

807 
public
 
g‘Ev’tTime
() {

808  
	gev’tTime_
;

811 
public
 
fš®
 
	gFREQUENCY_FIELD_NUMBER
 = 5;

812 
´iv©e
 
	gäequ’cy_
;

816 
public
 
boŞ—n
 
hasF»qu’cy
() {

817  ((
	gb™F›ld0_
 & 0x00000010) == 0x00000010);

822 
public
 
g‘F»qu’cy
() {

823  
	gäequ’cy_
;

826 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

827 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

828 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

829 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

830 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

832 
	gmemoizedIsIn™Ÿlized
 = 1;

833  
	gŒue
;

836 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

837 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

838 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

839 
ouut
.
wr™eUIÁ32
(1, 
id_
);

841 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

842 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
Çme_
);

844 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

845 
ouut
.
wr™eUIÁ32
(3, 
pÜt_
);

847 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

848 
ouut
.
wr™eIÁ64
(4, 
ev’tTime_
);

850 ià(((
	gb™F›ld0_
 & 0x00000010) == 0x00000010)) {

851 
ouut
.
wr™eUIÁ32
(5, 
äequ’cy_
);

853 
	gunknownF›lds
.
wr™eTo
(
ouut
);

856 
public
 
g‘S”ŸlizedSize
() {

857 
	gsize
 = 
memoizedSize
;

858 ià(
	gsize
 !ğ-1è 
size
;

860 
	gsize
 = 0;

861 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

862 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


863 .
compu‹UIÁ32Size
(1, 
id_
);

865 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

866 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
Çme_
);

868 ià(((
	gb™F›ld0_
 & 0x00000004) == 0x00000004)) {

869 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


870 .
compu‹UIÁ32Size
(3, 
pÜt_
);

872 ià(((
	gb™F›ld0_
 & 0x00000008) == 0x00000008)) {

873 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


874 .
compu‹IÁ64Size
(4, 
ev’tTime_
);

876 ià(((
	gb™F›ld0_
 & 0x00000010) == 0x00000010)) {

877 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


878 .
compu‹UIÁ32Size
(5, 
äequ’cy_
);

880 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

881 
	gmemoizedSize
 = 
size
;

882  
	gsize
;

885 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

886 @
	gjava
.
	gÏng
.
Ov”ride


887 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

888 ià(
	gobj
 =ğ
this
) {

889  
Œue
;

891 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gEv’tInfo
)) {

892  
	gsu³r
.
equ®s
(
obj
);

894 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.Ev’tInfoè
obj
;

896 
boŞ—n
 
	g»suÉ
 = 
Œue
;

897 
	g»suÉ
 = 
»suÉ
 && (
hasId
(è=ğ
Ùh”
.hasId());

898 ià(
hasId
()) {

899 
	g»suÉ
 = 
»suÉ
 && (
g‘Id
()

900 =ğ
Ùh”
.
g‘Id
());

902 
	g»suÉ
 = 
»suÉ
 && (
hasName
(è=ğ
Ùh”
.hasName());

903 ià(
hasName
()) {

904 
	g»suÉ
 = 
»suÉ
 && 
g‘Name
()

905 .
equ®s
(
Ùh”
.
g‘Name
());

907 
	g»suÉ
 = 
»suÉ
 && (
hasPÜt
(è=ğ
Ùh”
.hasPort());

908 ià(
hasPÜt
()) {

909 
	g»suÉ
 = 
»suÉ
 && (
g‘PÜt
()

910 =ğ
Ùh”
.
g‘PÜt
());

912 
	g»suÉ
 = 
»suÉ
 && (
hasEv’tTime
(è=ğ
Ùh”
.hasEventTime());

913 ià(
hasEv’tTime
()) {

914 
	g»suÉ
 = 
»suÉ
 && (
g‘Ev’tTime
()

915 =ğ
Ùh”
.
g‘Ev’tTime
());

917 
	g»suÉ
 = 
»suÉ
 && (
hasF»qu’cy
(è=ğ
Ùh”
.hasFrequency());

918 ià(
hasF»qu’cy
()) {

919 
	g»suÉ
 = 
»suÉ
 && (
g‘F»qu’cy
()

920 =ğ
Ùh”
.
g‘F»qu’cy
());

922 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

923  
	g»suÉ
;

926 @
	gjava
.
	gÏng
.
Ov”ride


927 
public
 
hashCode
() {

928 ià(
	gmemoizedHashCode
 != 0) {

929  
memoizedHashCode
;

931 
	ghash
 = 41;

932 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

933 ià(
hasId
()) {

934 
	ghash
 = (37 * 
hash
è+ 
ID_FIELD_NUMBER
;

935 
	ghash
 = (53 * 
hash
è+ 
g‘Id
();

937 ià(
hasName
()) {

938 
	ghash
 = (37 * 
hash
è+ 
NAME_FIELD_NUMBER
;

939 
	ghash
 = (53 * 
hash
è+ 
g‘Name
().
hashCode
();

941 ià(
hasPÜt
()) {

942 
	ghash
 = (37 * 
hash
è+ 
PORT_FIELD_NUMBER
;

943 
	ghash
 = (53 * 
hash
è+ 
g‘PÜt
();

945 ià(
hasEv’tTime
()) {

946 
	ghash
 = (37 * 
hash
è+ 
EVENT_TIME_FIELD_NUMBER
;

947 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

948 
g‘Ev’tTime
());

950 ià(
hasF»qu’cy
()) {

951 
	ghash
 = (37 * 
hash
è+ 
FREQUENCY_FIELD_NUMBER
;

952 
	ghash
 = (53 * 
hash
è+ 
g‘F»qu’cy
();

954 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

955 
	gmemoizedHashCode
 = 
hash
;

956  
	ghash
;

959 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(

960 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

961 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

962  
	gPARSER
.
·r£From
(
d©a
);

964 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(

965 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

966 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

967 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

968  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

970 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(
by‹
[] 
d©a
)

971 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

972  
	gPARSER
.
·r£From
(
d©a
);

974 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(

975 
by‹
[] 
d©a
,

976 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

977 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

978  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

980 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

981 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

982  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


983 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

985 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(

986 
java
.
io
.
IÅutSŒ—m
 
šput
,

987 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

988 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

989  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


990 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

992 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

993 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

994  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


995 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

997 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£D–im™edFrom
(

998 
java
.
io
.
IÅutSŒ—m
 
šput
,

999 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1000 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1001  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1002 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1004 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(

1005 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

1006 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1007  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1008 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1010 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
·r£From
(

1011 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1012 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1013 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1014  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1015 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1018 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

1019 
public
 
Bud”
 
ÃwBud”
() {

1020  
	gDEFAULT_INSTANCE
.
toBud”
();

1022 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
 
´ÙÙy³
) {

1023  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

1025 
public
 
Bud”
 
toBud”
() {

1026  
	gthis
 =ğ
DEFAULT_INSTANCE


1027 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1030 @
	gjava
.
	gÏng
.
Ov”ride


1031 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1032 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1033 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1034  
	gbud”
;

1039 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1040 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1042 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gEv’tInfoOrBud”
 {

1043 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1044 
g‘DesütÜ
() {

1045  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

1048 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1049 
š‹º®G‘F›ldAcûssÜTabË
() {

1050  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË


1051 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1052 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
.
şass
, org.cÜfudb.‹¡.Te¡Schema.Ev’tInfo.
Bud”
.class);

1056 
´iv©e
 
Bud”
() {

1057 
maybeFÜûBud”In™Ÿliz©iÚ
();

1060 
´iv©e
 
Bud”
(

1061 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1062 
su³r
(
·»Á
);

1063 
maybeFÜûBud”In™Ÿliz©iÚ
();

1065 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1066 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1067 .
	g®waysU£F›ldBud”s
) {

1070 
public
 
Bud”
 
ş—r
() {

1071 
	gsu³r
.
ş—r
();

1072 
	gid_
 = 0;

1073 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

1074 
	gÇme_
 = "";

1075 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

1076 
	gpÜt_
 = 0;

1077 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1078 
	gev’tTime_
 = 0L;

1079 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

1080 
	gäequ’cy_
 = 0;

1081 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000010);

1082  
	gthis
;

1085 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1086 
g‘DesütÜFÜTy³
() {

1087  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

1090 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1091  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gEv’tInfo
.
g‘DeçuÉIn¡ªû
();

1094 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
bud
() {

1095 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
	g»suÉ
 = 
budP¬tŸl
();

1096 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1097 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1099  
	g»suÉ
;

1102 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
budP¬tŸl
() {

1103 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.Ev’tInfo(
this
);

1104 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

1105 
	gto_b™F›ld0_
 = 0;

1106 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

1107 
to_b™F›ld0_
 |= 0x00000001;

1109 
	g»suÉ
.
	gid_
 = 
id_
;

1110 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

1111 
to_b™F›ld0_
 |= 0x00000002;

1113 
	g»suÉ
.
	gÇme_
 = 
Çme_
;

1114 ià(((
	gäom_b™F›ld0_
 & 0x00000004) == 0x00000004)) {

1115 
to_b™F›ld0_
 |= 0x00000004;

1117 
	g»suÉ
.
	gpÜt_
 = 
pÜt_
;

1118 ià(((
	gäom_b™F›ld0_
 & 0x00000008) == 0x00000008)) {

1119 
to_b™F›ld0_
 |= 0x00000008;

1121 
	g»suÉ
.
	gev’tTime_
 = 
ev’tTime_
;

1122 ià(((
	gäom_b™F›ld0_
 & 0x00000010) == 0x00000010)) {

1123 
to_b™F›ld0_
 |= 0x00000010;

1125 
	g»suÉ
.
	gäequ’cy_
 = 
äequ’cy_
;

1126 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

1127 
ÚBut
();

1128  
	g»suÉ
;

1131 
public
 
Bud”
 
şÚe
() {

1132  (
	gBud”
è
	gsu³r
.
şÚe
();

1134 
public
 
Bud”
 
£tF›ld
(

1135 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1136 
Objeù
 
v®ue
) {

1137  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1139 
public
 
Bud”
 
ş—rF›ld
(

1140 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1141  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1143 
public
 
Bud”
 
ş—rOÃof
(

1144 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1145  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1147 
public
 
Bud”
 
£tR•—‹dF›ld
(

1148 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1149 
šdex
, 
Objeù
 
v®ue
) {

1150  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1152 
public
 
Bud”
 
addR•—‹dF›ld
(

1153 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1154 
Objeù
 
v®ue
) {

1155  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1157 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1158 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gEv’tInfo
) {

1159  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
)
Ùh”
);

1161 
	gsu³r
.
m”geFrom
(
Ùh”
);

1162  
	gthis
;

1166 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
 
Ùh”
) {

1167 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
.
g‘DeçuÉIn¡ªû
()è 
this
;

1168 ià(
	gÙh”
.
hasId
()) {

1169 
£tId
(
Ùh”
.
g‘Id
());

1171 ià(
	gÙh”
.
hasName
()) {

1172 
	gb™F›ld0_
 |= 0x00000002;

1173 
	gÇme_
 = 
Ùh”
.
Çme_
;

1174 
ÚChªged
();

1176 ià(
	gÙh”
.
hasPÜt
()) {

1177 
£tPÜt
(
Ùh”
.
g‘PÜt
());

1179 ià(
	gÙh”
.
hasEv’tTime
()) {

1180 
£tEv’tTime
(
Ùh”
.
g‘Ev’tTime
());

1182 ià(
	gÙh”
.
hasF»qu’cy
()) {

1183 
£tF»qu’cy
(
Ùh”
.
g‘F»qu’cy
());

1185 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

1186 
ÚChªged
();

1187  
	gthis
;

1190 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1191  
	gŒue
;

1194 
public
 
Bud”
 
m”geFrom
(

1195 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1196 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1197 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1198 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
	g·r£dMes§ge
 = 
nuÎ
;

1199 
	gŒy
 {

1200 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1201 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1202 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
è
e
.
g‘UnfšishedMes§ge
();

1203 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1204 } 
	gfš®ly
 {

1205 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1206 
m”geFrom
(
·r£dMes§ge
);

1209  
	gthis
;

1211 
´iv©e
 
	gb™F›ld0_
;

1213 
´iv©e
 
	gid_
 ;

1217 
public
 
boŞ—n
 
hasId
() {

1218  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

1223 
public
 
g‘Id
() {

1224  
	gid_
;

1229 
public
 
Bud”
 
£tId
(
v®ue
) {

1230 
	gb™F›ld0_
 |= 0x00000001;

1231 
	gid_
 = 
v®ue
;

1232 
ÚChªged
();

1233  
	gthis
;

1238 
public
 
Bud”
 
ş—rId
() {

1239 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

1240 
	gid_
 = 0;

1241 
ÚChªged
();

1242  
	gthis
;

1245 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gÇme_
 = "";

1249 
public
 
boŞ—n
 
hasName
() {

1250  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

1255 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘Name
() {

1256 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

1257 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

1258 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1259 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1260 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1261 ià(
	gbs
.
isV®idUtf8
()) {

1262 
	gÇme_
 = 
s
;

1264  
	gs
;

1266  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1272 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1273 
g‘NameBy‹s
() {

1274 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
Çme_
;

1275 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1276 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1277 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1278 (
java
.
Ïng
.
SŒšg
è
»f
);

1279 
	gÇme_
 = 
b
;

1280  
	gb
;

1282  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1288 
public
 
Bud”
 
£tName
(

1289 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1290 ià(
	gv®ue
 =ğ
nuÎ
) {

1291 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1293 
	gb™F›ld0_
 |= 0x00000002;

1294 
	gÇme_
 = 
v®ue
;

1295 
ÚChªged
();

1296  
	gthis
;

1301 
public
 
Bud”
 
ş—rName
() {

1302 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

1303 
	gÇme_
 = 
g‘DeçuÉIn¡ªû
().
g‘Name
();

1304 
ÚChªged
();

1305  
	gthis
;

1310 
public
 
Bud”
 
£tNameBy‹s
(

1311 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

1312 ià(
	gv®ue
 =ğ
nuÎ
) {

1313 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1315 
	gb™F›ld0_
 |= 0x00000002;

1316 
	gÇme_
 = 
v®ue
;

1317 
ÚChªged
();

1318  
	gthis
;

1321 
´iv©e
 
	gpÜt_
 ;

1325 
public
 
boŞ—n
 
hasPÜt
() {

1326  ((
	gb™F›ld0_
 & 0x00000004) == 0x00000004);

1331 
public
 
g‘PÜt
() {

1332  
	gpÜt_
;

1337 
public
 
Bud”
 
£tPÜt
(
v®ue
) {

1338 
	gb™F›ld0_
 |= 0x00000004;

1339 
	gpÜt_
 = 
v®ue
;

1340 
ÚChªged
();

1341  
	gthis
;

1346 
public
 
Bud”
 
ş—rPÜt
() {

1347 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000004);

1348 
	gpÜt_
 = 0;

1349 
ÚChªged
();

1350  
	gthis
;

1353 
´iv©e
 
	gev’tTime_
 ;

1357 
public
 
boŞ—n
 
hasEv’tTime
() {

1358  ((
	gb™F›ld0_
 & 0x00000008) == 0x00000008);

1363 
public
 
g‘Ev’tTime
() {

1364  
	gev’tTime_
;

1369 
public
 
Bud”
 
£tEv’tTime
(
v®ue
) {

1370 
	gb™F›ld0_
 |= 0x00000008;

1371 
	gev’tTime_
 = 
v®ue
;

1372 
ÚChªged
();

1373  
	gthis
;

1378 
public
 
Bud”
 
ş—rEv’tTime
() {

1379 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000008);

1380 
	gev’tTime_
 = 0L;

1381 
ÚChªged
();

1382  
	gthis
;

1385 
´iv©e
 
	gäequ’cy_
 ;

1389 
public
 
boŞ—n
 
hasF»qu’cy
() {

1390  ((
	gb™F›ld0_
 & 0x00000010) == 0x00000010);

1395 
public
 
g‘F»qu’cy
() {

1396  
	gäequ’cy_
;

1401 
public
 
Bud”
 
£tF»qu’cy
(
v®ue
) {

1402 
	gb™F›ld0_
 |= 0x00000010;

1403 
	gäequ’cy_
 = 
v®ue
;

1404 
ÚChªged
();

1405  
	gthis
;

1410 
public
 
Bud”
 
ş—rF»qu’cy
() {

1411 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000010);

1412 
	gäequ’cy_
 = 0;

1413 
ÚChªged
();

1414  
	gthis
;

1416 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1417 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1418  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

1421 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1422 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1423  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

1431 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
	gDEFAULT_INSTANCE
;

1433 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
Ev’tInfo
();

1436 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
g‘DeçuÉIn¡ªû
() {

1437  
	gDEFAULT_INSTANCE
;

1440 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEv’tInfo
>

1441 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Ev’tInfo
>() {

1442 
public
 
Ev’tInfo
 
·r£P¬tŸlFrom
(

1443 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1444 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1445 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1446  
Ãw
 
Ev’tInfo
(
šput
, 
ex‹nsiÚRegi¡ry
);

1450 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEv’tInfo
> 
·r£r
() {

1451  
	gPARSER
;

1454 @
	gjava
.
	gÏng
.
Ov”ride


1455 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gEv’tInfo
> 
g‘P¬£rFÜTy³
() {

1456  
	gPARSER
;

1459 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
Ev’tInfo
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1460  
	gDEFAULT_INSTANCE
;

1465 
public
 
š‹rçû
 
MªagedResourûsOrBud”
 
ex‹nds


1467 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

1472 
boŞ—n
 
hasC»©eU£r
();

1476 
	gjava
.
	gÏng
.
SŒšg
 
g‘C»©eU£r
();

1480 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1481 
g‘C»©eU£rBy‹s
();

1486 
boŞ—n
 
hasV”siÚ
();

1490 
g‘V”siÚ
();

1495 
public
 
fš®
 
şass
 
MªagedResourûs
 
ex‹nds


1496 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


1498 
	gMªagedResourûsOrBud”
 {

1500 
´iv©e
 
MªagedResourûs
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

1501 
su³r
(
bud”
);

1503 
´iv©e
 
MªagedResourûs
() {

1504 
	gü—‹U£r_
 = "";

1505 
	gv”siÚ_
 = 0L;

1508 @
	gjava
.
	gÏng
.
Ov”ride


1509 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


1510 
g‘UnknownF›lds
() {

1511  
	gthis
.
	gunknownF›lds
;

1513 
´iv©e
 
MªagedResourûs
(

1514 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1515 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1516 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1517 
this
();

1518 
	gmubË_b™F›ld0_
 = 0;

1519 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
Bud”
 
	gunknownF›lds
 =

1520 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
.
ÃwBud”
();

1521 
	gŒy
 {

1522 
boŞ—n
 
	gdÚe
 = 
çl£
;

1523 !
	gdÚe
) {

1524 
	gg
 = 
šput
.
»adTag
();

1525 
	gg
) {

1527 
dÚe
 = 
Œue
;

1530 ià(!
·r£UnknownF›ld
(
šput
, 
unknownF›lds
,

1531 
ex‹nsiÚRegi¡ry
, 
g
)) {

1532 
	gdÚe
 = 
Œue
;

1537 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
bs
 = 
šput
.
»adBy‹s
();

1538 
	gb™F›ld0_
 |= 0x00000001;

1539 
	gü—‹U£r_
 = 
bs
;

1543 
b™F›ld0_
 |= 0x00000002;

1544 
	gv”siÚ_
 = 
šput
.
»adIÁ64
();

1549 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1550 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

1551 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

1552 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

1553 
e
).
£tUnfšishedMes§ge
(
this
);

1554 } 
	gfš®ly
 {

1555 
	gthis
.
	gunknownF›lds
 = 
unknownF›lds
.
bud
();

1556 
makeEx‹nsiÚsImmubË
();

1559 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1560 
g‘DesütÜ
() {

1561  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

1564 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1565 
š‹º®G‘F›ldAcûssÜTabË
() {

1566  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË


1567 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1568 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
.
şass
, org.cÜfudb.‹¡.Te¡Schema.MªagedResourûs.
Bud”
.class);

1571 
´iv©e
 
	gb™F›ld0_
;

1572 
public
 
fš®
 
	gCREATE_USER_FIELD_NUMBER
 = 1;

1573 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	gü—‹U£r_
;

1577 
public
 
boŞ—n
 
hasC»©eU£r
() {

1578  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

1583 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C»©eU£r
() {

1584 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

1585 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1586  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1588 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1589 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1590 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1591 ià(
	gbs
.
isV®idUtf8
()) {

1592 
	gü—‹U£r_
 = 
s
;

1594  
	gs
;

1600 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1601 
g‘C»©eU£rBy‹s
() {

1602 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

1603 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

1604 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1605 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1606 (
java
.
Ïng
.
SŒšg
è
»f
);

1607 
	gü—‹U£r_
 = 
b
;

1608  
	gb
;

1610  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1614 
public
 
fš®
 
	gVERSION_FIELD_NUMBER
 = 2;

1615 
´iv©e
 
	gv”siÚ_
;

1619 
public
 
boŞ—n
 
hasV”siÚ
() {

1620  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

1625 
public
 
g‘V”siÚ
() {

1626  
	gv”siÚ_
;

1629 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

1630 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1631 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

1632 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

1633 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

1635 
	gmemoizedIsIn™Ÿlized
 = 1;

1636  
	gŒue
;

1639 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

1640 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1641 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

1642 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
ü—‹U£r_
);

1644 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1645 
ouut
.
wr™eIÁ64
(2, 
v”siÚ_
);

1647 
	gunknownF›lds
.
wr™eTo
(
ouut
);

1650 
public
 
g‘S”ŸlizedSize
() {

1651 
	gsize
 = 
memoizedSize
;

1652 ià(
	gsize
 !ğ-1è 
size
;

1654 
	gsize
 = 0;

1655 ià(((
	gb™F›ld0_
 & 0x00000001) == 0x00000001)) {

1656 
size
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
ü—‹U£r_
);

1658 ià(((
	gb™F›ld0_
 & 0x00000002) == 0x00000002)) {

1659 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


1660 .
compu‹IÁ64Size
(2, 
v”siÚ_
);

1662 
	gsize
 +ğ
unknownF›lds
.
g‘S”ŸlizedSize
();

1663 
	gmemoizedSize
 = 
size
;

1664  
	gsize
;

1667 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

1668 @
	gjava
.
	gÏng
.
Ov”ride


1669 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

1670 ià(
	gobj
 =ğ
this
) {

1671  
Œue
;

1673 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gMªagedResourûs
)) {

1674  
	gsu³r
.
equ®s
(
obj
);

1676 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
	gÙh”
 = (
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.MªagedResourûsè
obj
;

1678 
boŞ—n
 
	g»suÉ
 = 
Œue
;

1679 
	g»suÉ
 = 
»suÉ
 && (
hasC»©eU£r
(è=ğ
Ùh”
.hasCreateUser());

1680 ià(
hasC»©eU£r
()) {

1681 
	g»suÉ
 = 
»suÉ
 && 
g‘C»©eU£r
()

1682 .
equ®s
(
Ùh”
.
g‘C»©eU£r
());

1684 
	g»suÉ
 = 
»suÉ
 && (
hasV”siÚ
(è=ğ
Ùh”
.hasVersion());

1685 ià(
hasV”siÚ
()) {

1686 
	g»suÉ
 = 
»suÉ
 && (
g‘V”siÚ
()

1687 =ğ
Ùh”
.
g‘V”siÚ
());

1689 
	g»suÉ
 = 
»suÉ
 && 
unknownF›lds
.
equ®s
(
Ùh”
.unknownFields);

1690  
	g»suÉ
;

1693 @
	gjava
.
	gÏng
.
Ov”ride


1694 
public
 
hashCode
() {

1695 ià(
	gmemoizedHashCode
 != 0) {

1696  
memoizedHashCode
;

1698 
	ghash
 = 41;

1699 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

1700 ià(
hasC»©eU£r
()) {

1701 
	ghash
 = (37 * 
hash
è+ 
CREATE_USER_FIELD_NUMBER
;

1702 
	ghash
 = (53 * 
hash
è+ 
g‘C»©eU£r
().
hashCode
();

1704 ià(
hasV”siÚ
()) {

1705 
	ghash
 = (37 * 
hash
è+ 
VERSION_FIELD_NUMBER
;

1706 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

1707 
g‘V”siÚ
());

1709 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

1710 
	gmemoizedHashCode
 = 
hash
;

1711  
	ghash
;

1714 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(

1715 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

1716 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1717  
	gPARSER
.
·r£From
(
d©a
);

1719 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(

1720 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

1721 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1722 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1723  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1725 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(
by‹
[] 
d©a
)

1726 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1727  
	gPARSER
.
·r£From
(
d©a
);

1729 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(

1730 
by‹
[] 
d©a
,

1731 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1732 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1733  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1735 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1736 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1737  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1738 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1740 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(

1741 
java
.
io
.
IÅutSŒ—m
 
šput
,

1742 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1743 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1744  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1745 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1747 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1748 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1749  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1750 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

1752 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£D–im™edFrom
(

1753 
java
.
io
.
IÅutSŒ—m
 
šput
,

1754 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1755 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1756  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1757 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1759 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(

1760 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

1761 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1762  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1763 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1765 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
·r£From
(

1766 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1767 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1768 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1769  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1770 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1773 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

1774 
public
 
Bud”
 
ÃwBud”
() {

1775  
	gDEFAULT_INSTANCE
.
toBud”
();

1777 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
 
´ÙÙy³
) {

1778  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

1780 
public
 
Bud”
 
toBud”
() {

1781  
	gthis
 =ğ
DEFAULT_INSTANCE


1782 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1785 @
	gjava
.
	gÏng
.
Ov”ride


1786 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1787 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1788 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1789  
	gbud”
;

1794 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1795 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1797 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gMªagedResourûsOrBud”
 {

1798 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1799 
g‘DesütÜ
() {

1800  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

1803 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1804 
š‹º®G‘F›ldAcûssÜTabË
() {

1805  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË


1806 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1807 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
.
şass
, org.cÜfudb.‹¡.Te¡Schema.MªagedResourûs.
Bud”
.class);

1811 
´iv©e
 
Bud”
() {

1812 
maybeFÜûBud”In™Ÿliz©iÚ
();

1815 
´iv©e
 
Bud”
(

1816 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1817 
su³r
(
·»Á
);

1818 
maybeFÜûBud”In™Ÿliz©iÚ
();

1820 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1821 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1822 .
	g®waysU£F›ldBud”s
) {

1825 
public
 
Bud”
 
ş—r
() {

1826 
	gsu³r
.
ş—r
();

1827 
	gü—‹U£r_
 = "";

1828 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

1829 
	gv”siÚ_
 = 0L;

1830 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

1831  
	gthis
;

1834 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1835 
g‘DesütÜFÜTy³
() {

1836  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

1839 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1840  
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gMªagedResourûs
.
g‘DeçuÉIn¡ªû
();

1843 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
bud
() {

1844 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
	g»suÉ
 = 
budP¬tŸl
();

1845 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1846 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1848  
	g»suÉ
;

1851 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
budP¬tŸl
() {

1852 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.MªagedResourûs(
this
);

1853 
	gäom_b™F›ld0_
 = 
b™F›ld0_
;

1854 
	gto_b™F›ld0_
 = 0;

1855 ià(((
	gäom_b™F›ld0_
 & 0x00000001) == 0x00000001)) {

1856 
to_b™F›ld0_
 |= 0x00000001;

1858 
	g»suÉ
.
	gü—‹U£r_
 = 
ü—‹U£r_
;

1859 ià(((
	gäom_b™F›ld0_
 & 0x00000002) == 0x00000002)) {

1860 
to_b™F›ld0_
 |= 0x00000002;

1862 
	g»suÉ
.
	gv”siÚ_
 = 
v”siÚ_
;

1863 
	g»suÉ
.
	gb™F›ld0_
 = 
to_b™F›ld0_
;

1864 
ÚBut
();

1865  
	g»suÉ
;

1868 
public
 
Bud”
 
şÚe
() {

1869  (
	gBud”
è
	gsu³r
.
şÚe
();

1871 
public
 
Bud”
 
£tF›ld
(

1872 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1873 
Objeù
 
v®ue
) {

1874  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1876 
public
 
Bud”
 
ş—rF›ld
(

1877 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1878  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1880 
public
 
Bud”
 
ş—rOÃof
(

1881 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1882  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1884 
public
 
Bud”
 
£tR•—‹dF›ld
(

1885 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1886 
šdex
, 
Objeù
 
v®ue
) {

1887  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1889 
public
 
Bud”
 
addR•—‹dF›ld
(

1890 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1891 
Objeù
 
v®ue
) {

1892  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1894 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1895 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
	gMªagedResourûs
) {

1896  
m”geFrom
((
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
)
Ùh”
);

1898 
	gsu³r
.
m”geFrom
(
Ùh”
);

1899  
	gthis
;

1903 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
 
Ùh”
) {

1904 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
.
g‘DeçuÉIn¡ªû
()è 
this
;

1905 ià(
	gÙh”
.
hasC»©eU£r
()) {

1906 
	gb™F›ld0_
 |= 0x00000001;

1907 
	gü—‹U£r_
 = 
Ùh”
.
ü—‹U£r_
;

1908 
ÚChªged
();

1910 ià(
	gÙh”
.
hasV”siÚ
()) {

1911 
£tV”siÚ
(
Ùh”
.
g‘V”siÚ
());

1913 
	gthis
.
m”geUnknownF›lds
(
Ùh”
.
unknownF›lds
);

1914 
ÚChªged
();

1915  
	gthis
;

1918 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1919  
	gŒue
;

1922 
public
 
Bud”
 
m”geFrom
(

1923 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1924 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1925 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1926 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
	g·r£dMes§ge
 = 
nuÎ
;

1927 
	gŒy
 {

1928 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1929 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1930 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
è
e
.
g‘UnfšishedMes§ge
();

1931 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1932 } 
	gfš®ly
 {

1933 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1934 
m”geFrom
(
·r£dMes§ge
);

1937  
	gthis
;

1939 
´iv©e
 
	gb™F›ld0_
;

1941 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	gü—‹U£r_
 = "";

1945 
public
 
boŞ—n
 
hasC»©eU£r
() {

1946  ((
	gb™F›ld0_
 & 0x00000001) == 0x00000001);

1951 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘C»©eU£r
() {

1952 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

1953 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

1954 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

1955 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

1956 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

1957 ià(
	gbs
.
isV®idUtf8
()) {

1958 
	gü—‹U£r_
 = 
s
;

1960  
	gs
;

1962  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

1968 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


1969 
g‘C»©eU£rBy‹s
() {

1970 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
ü—‹U£r_
;

1971 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

1972 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

1973 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

1974 (
java
.
Ïng
.
SŒšg
è
»f
);

1975 
	gü—‹U£r_
 = 
b
;

1976  
	gb
;

1978  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

1984 
public
 
Bud”
 
£tC»©eU£r
(

1985 
java
.
Ïng
.
SŒšg
 
v®ue
) {

1986 ià(
	gv®ue
 =ğ
nuÎ
) {

1987 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1989 
	gb™F›ld0_
 |= 0x00000001;

1990 
	gü—‹U£r_
 = 
v®ue
;

1991 
ÚChªged
();

1992  
	gthis
;

1997 
public
 
Bud”
 
ş—rC»©eU£r
() {

1998 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000001);

1999 
	gü—‹U£r_
 = 
g‘DeçuÉIn¡ªû
().
g‘C»©eU£r
();

2000 
ÚChªged
();

2001  
	gthis
;

2006 
public
 
Bud”
 
£tC»©eU£rBy‹s
(

2007 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

2008 ià(
	gv®ue
 =ğ
nuÎ
) {

2009 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

2011 
	gb™F›ld0_
 |= 0x00000001;

2012 
	gü—‹U£r_
 = 
v®ue
;

2013 
ÚChªged
();

2014  
	gthis
;

2017 
´iv©e
 
	gv”siÚ_
 ;

2021 
public
 
boŞ—n
 
hasV”siÚ
() {

2022  ((
	gb™F›ld0_
 & 0x00000002) == 0x00000002);

2027 
public
 
g‘V”siÚ
() {

2028  
	gv”siÚ_
;

2033 
public
 
Bud”
 
£tV”siÚ
(
v®ue
) {

2034 
	gb™F›ld0_
 |= 0x00000002;

2035 
	gv”siÚ_
 = 
v®ue
;

2036 
ÚChªged
();

2037  
	gthis
;

2042 
public
 
Bud”
 
ş—rV”siÚ
() {

2043 
	gb™F›ld0_
 = (
b™F›ld0_
 & ~0x00000002);

2044 
	gv”siÚ_
 = 0L;

2045 
ÚChªged
();

2046  
	gthis
;

2048 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

2049 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2050  
	gsu³r
.
£tUnknownF›lds
(
unknownF›lds
);

2053 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

2054 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

2055  
	gsu³r
.
m”geUnknownF›lds
(
unknownF›lds
);

2063 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
	gDEFAULT_INSTANCE
;

2065 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
‹¡
.
Te¡Schema
.
MªagedResourûs
();

2068 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
g‘DeçuÉIn¡ªû
() {

2069  
	gDEFAULT_INSTANCE
;

2072 @
	gjava
.
	gÏng
.
D•»ÿ‹d
 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûs
>

2073 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
MªagedResourûs
>() {

2074 
public
 
MªagedResourûs
 
·r£P¬tŸlFrom
(

2075 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

2076 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

2077 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

2078  
Ãw
 
MªagedResourûs
(
šput
, 
ex‹nsiÚRegi¡ry
);

2082 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûs
> 
·r£r
() {

2083  
	gPARSER
;

2086 @
	gjava
.
	gÏng
.
Ov”ride


2087 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gMªagedResourûs
> 
g‘P¬£rFÜTy³
() {

2088  
	gPARSER
;

2091 
public
 
	gÜg
.
	gcÜfudb
.
	g‹¡
.
	gTe¡Schema
.
MªagedResourûs
 
g‘DeçuÉIn¡ªûFÜTy³
() {

2092  
	gDEFAULT_INSTANCE
;

2097 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2098 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
;

2099 
´iv©e
 
fš®


2100 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2101 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË
;

2102 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2103 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
;

2104 
´iv©e
 
fš®


2105 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2106 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË
;

2107 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


2108 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
;

2109 
´iv©e
 
fš®


2110 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


2111 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË
;

2113 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


2114 
	$g‘DesütÜ
() {

2115  
desütÜ
;

2116 
	}
}

2117 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


2118 
	gdesütÜ
;

2120 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

2129 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

2130 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

2131 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

2132 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

2133 
desütÜ
 = 
roÙ
;

2134  
	gnuÎ
;

2137 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


2138 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

2139 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

2140 
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
g‘DesütÜ
(),

2141 }, 
assigÃr
);

2142 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
 =

2143 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

2144 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_f›ldAcûssÜTabË
 = 
Ãw


2145 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

2146 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Uuid_desütÜ
,

2147 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Msb", "Lsb", });

2148 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
 =

2149 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

2150 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_f›ldAcûssÜTabË
 = 
Ãw


2151 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

2152 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_Ev’tInfo_desütÜ
,

2153 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Id", "Name", "Port", "EventTime", "Frequency", });

2154 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
 =

2155 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(2);

2156 
	gš‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_f›ldAcûssÜTabË
 = 
Ãw


2157 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

2158 
š‹º®_¡©ic_Üg_cÜfudb_‹¡_MªagedResourûs_desütÜ
,

2159 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "CreateUser", "Version", });

2160 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
	g»gi¡ry
 =

2161 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
.
ÃwIn¡ªû
();

2162 
	g»gi¡ry
.
add
(
Üg
.
cÜfudb
.
ruÁime
.
CÜfuO±iÚs
.
schema
);

2163 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


2164 .
š‹º®Upd©eFeDesütÜ
(
desütÜ
, 
»gi¡ry
);

2165 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuO±iÚs
.
g‘DesütÜ
();

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/collections/PutIfAbsentMapTest$PutIfAbsentMap$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuExecutiÚCÚ‹xt
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMR
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRProxy
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gICÜfuSMRUpÿÎT¬g‘
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoFunùiÚ
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
.
	gIUndoRecÜdFunùiÚ
;

21 @
In¡rum’‹dCÜfuObjeù


22 
public
 
şass
 
	gPutIfAb£ÁM­Te¡$PutIfAb£ÁM­$CORFUSMR
<
	gK
, 
	gV
> 
ex‹nds
 
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<K, V> 
im¶em’ts
 
	gICÜfuSMR
<PutIfAbsentMapTest.PutIfAbsentMap<K, V>> {

23 
public
 
	gICÜfuSMRProxy
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>> 
	g´oxy_CORFUSMR
;

25 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<PutIfAbsentMapTest.PutIfAbsentMap<K, V>>>()

26 .
put
("put", (
obj
, 
¬gs
è-> {  obj.put((
K
è¬gs[0], (
V
)‡rgs[1]);})

27 .
put
("putIfAb£Á", (
obj
, 
¬gs
è-> {  obj.
putIfAb£Á
((
K
è¬gs[0], (
V
è¬gs[1]);}).
bud
();

29 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<PutIfAb£ÁM­Te¡.PutIfAb£ÁM­<K, V>>>().
bud
();

31 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<PutIfAb£ÁM­Te¡.PutIfAb£ÁM­<K, V>>>().
bud
();

33 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

35 
public
 
PutIfAb£ÁM­Te¡$PutIfAb£ÁM­$CORFUSMR
() {

36 
su³r
();

39 
public
 
	gICÜfuSMRProxy
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>> 
g‘CÜfuSMRProxy
() {

40  
	g´oxy_CORFUSMR
;

43 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
PutIfAb£ÁM­Te¡
.
PutIfAb£ÁM­
<
K
, 
V
>> 
´oxy
) {

44 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

47 @
	gOv”ride


48 @
MutÜAcûssÜ
(

49 
Çme
 = "put"

51 
public
 
V
 
put
(
K
 
key
, V 
v®ue
) {

52 
	gadd»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("put",
Œue
,
nuÎ
,
key
, 
v®ue
);

53  (
	gV
è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
nuÎ
);

56 @
	gOv”ride


57 @
MutÜAcûssÜ
(

58 
Çme
 = "putIfAbsent"

60 
public
 
boŞ—n
 
putIfAb£Á
(
K
 
key
, 
V
 
v®ue
) {

61 
	gadd»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("putIfAb£Á",
Œue
,
nuÎ
,
key
, 
v®ue
);

62  (
	gboŞ—n
è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
nuÎ
);

65 @
	gOv”ride


66 @
AcûssÜ


67 
public
 
V
 
g‘
(
K
 
key
) {

68  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘
(
key
);},
nuÎ
);

71 @
Ov”ride


72 
public
 
	gPutIfAb£ÁM­Te¡
.
PutIfAb£ÁM­
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

73  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

76 @
Ov”ride


77 
public
 
hashCode
() {

78  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

81 @
Ov”ride


82 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

83  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

86 @
Ov”ride


87 
public
 
SŒšg
 
toSŒšg
() {

88  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

91 @
	gOv”ride


92 @
PassThrough


93 
public
 
şo£
() {

94 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

97 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>>> 
g‘CÜfuSMRUpÿÎM­
() {

98  
	gupÿÎM­_CORFUSMR
;

101 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>>> 
g‘CÜfuUndoRecÜdM­
() {

102  
	gundoRecÜdM­_CORFUSMR
;

105 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gPutIfAb£ÁM­Te¡
.
	gPutIfAb£ÁM­
<
	gK
, 
	gV
>>> 
g‘CÜfuUndoM­
() {

106  
	gundoM­_CORFUSMR
;

109 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

110  
	g»£tS‘_CORFUSMR
;

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/ConflictParameterClass$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gCÚæiùP¬am‘”
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

15 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

17 @
In¡rum’‹dCÜfuObjeù


18 
public
 
şass
 
CÚæiùP¬am‘”CÏss$CORFUSMR
 
ex‹nds
 
CÚæiùP¬am‘”CÏss
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÚæiùP¬am‘”CÏss
> {

19 
public
 
	gICÜfuSMRProxy
<
	gCÚæiùP¬am‘”CÏss
> 
	g´oxy_CORFUSMR
;

21 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÚæiùP¬am‘”CÏss
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<ConflictParameterClass>>()

22 .
put
("mutÜTe¡", (
obj
, 
¬gs
è-> { obj.
mutÜTe¡
((è¬gs[0], (è¬gs[1]); 
nuÎ
;})

23 .
put
("mutÜAcûssÜTe¡", (
obj
, 
¬gs
è-> {  obj.
mutÜAcûssÜTe¡
((
java
.
Ïng
.
SŒšg
è¬gs[0], (java.Ïng.SŒšgè¬gs[1]);}).
bud
();

25 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÚæiùP¬am‘”CÏss
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<CÚæiùP¬am‘”CÏss>>().
bud
();

27 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÚæiùP¬am‘”CÏss
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<CÚæiùP¬am‘”CÏss>>().
bud
();

29 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

31 
public
 
CÚæiùP¬am‘”CÏss$CORFUSMR
() {

32 
su³r
();

35 
public
 
	gICÜfuSMRProxy
<
	gCÚæiùP¬am‘”CÏss
> 
g‘CÜfuSMRProxy
() {

36  
	g´oxy_CORFUSMR
;

39 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
CÚæiùP¬am‘”CÏss
> 
´oxy
) {

40 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

43 @
	gOv”ride


44 @
AcûssÜ


45 
public
 
acûssÜTe¡
(@
CÚæiùP¬am‘”
 
SŒšg
 
‹¡1
, SŒšg 
‹¡2
) {

46 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
‹¡1
};

47  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
acûssÜTe¡
(
‹¡1
, 
‹¡2
);},
cÚæiùF›ld_CORFUSMR
);

50 @
Ov”ride


51 
public
 
SŒšg
 
toSŒšg
() {

52  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

55 @
	gOv”ride


56 @
PassThrough


57 
public
 
şo£
() {

58 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

61 @
Ov”ride


62 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

63  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

66 @
Ov”ride


67 
public
 
hashCode
() {

68  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

71 @
Ov”ride


72 
public
 
CÚæiùP¬am‘”CÏss
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

73  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

76 @
	gOv”ride


77 @
MutÜ
(

78 
Çme
 = "mutatorTest"

80 
public
 
mutÜTe¡
(
‹¡1
, @
CÚæiùP¬am‘”
 
‹¡2
) {

81 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
‹¡2
};

82 
	g´oxy_CORFUSMR
.
logUpd©e
("mutÜTe¡",
çl£
,
cÚæiùF›ld_CORFUSMR
,
‹¡1
, 
‹¡2
);

85 @
	gOv”ride


86 @
MutÜAcûssÜ
(

87 
Çme
 = "mutatorAccessorTest"

89 
public
 
Objeù
 
mutÜAcûssÜTe¡
(@
CÚæiùP¬am‘”
 
SŒšg
 
‹¡1
, SŒšg 
‹¡2
) {

90 
	gObjeù
[] 
	gcÚæiùF›ld_CORFUSMR
 = 
Ãw
 
Objeù
[]{
‹¡1
};

91 
	gadd»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("mutÜAcûssÜTe¡",
Œue
,
cÚæiùF›ld_CORFUSMR
,
‹¡1
, 
‹¡2
);

92  (
	gjava
.
	gÏng
.
	gObjeù
è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
cÚæiùF›ld_CORFUSMR
);

95 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÚæiùP¬am‘”CÏss
>> 
g‘CÜfuSMRUpÿÎM­
() {

96  
	gupÿÎM­_CORFUSMR
;

99 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÚæiùP¬am‘”CÏss
>> 
g‘CÜfuUndoRecÜdM­
() {

100  
	gundoRecÜdM­_CORFUSMR
;

103 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÚæiùP¬am‘”CÏss
>> 
g‘CÜfuUndoM­
() {

104  
	gundoM­_CORFUSMR
;

107 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

108  
	g»£tS‘_CORFUSMR
;

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/CorfuCompoundObj$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

15 @
In¡rum’‹dCÜfuObjeù


16 
public
 
şass
 
CÜfuCompoundObj$CORFUSMR
 
ex‹nds
 
CÜfuCompoundObj
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuCompoundObj
> {

17 
public
 
	gICÜfuSMRProxy
<
	gCÜfuCompoundObj
> 
	g´oxy_CORFUSMR
;

19 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuCompoundObj
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<CorfuCompoundObj>>()

20 .
put
("£t", (
obj
, 
¬gs
è-> { obj.
£t
((
Üg
.
cÜfudb
.
ruÁime
.
objeù
.
CÜfuCompoundObj
.
IÂ”
è¬gs[0], (è¬gs[1]); 
nuÎ
;}).
bud
();

22 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuCompoundObj
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<CÜfuCompoundObj>>().
bud
();

24 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuCompoundObj
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<CÜfuCompoundObj>>().
bud
();

26 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

28 
public
 
CÜfuCompoundObj$CORFUSMR
() {

29 
su³r
();

32 
public
 
	gICÜfuSMRProxy
<
	gCÜfuCompoundObj
> 
g‘CÜfuSMRProxy
() {

33  
	g´oxy_CORFUSMR
;

36 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
CÜfuCompoundObj
> 
´oxy
) {

37 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

40 @
	gOv”ride


41 @
AcûssÜ


42 
public
 
g‘ID
() {

43  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘ID
();},
nuÎ
);

46 @
Ov”ride


47 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

48  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

51 @
Ov”ride


52 
public
 
CÜfuCompoundObj
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

53  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

56 @
Ov”ride


57 
public
 
hashCode
() {

58  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

61 @
	gOv”ride


62 @
MutÜ
(

63 
Çme
 = "set"

65 
public
 
£t
(
CÜfuCompoundObj
.
IÂ”
 
š
, 
id
) {

66 
	g´oxy_CORFUSMR
.
logUpd©e
("£t",
çl£
,
nuÎ
,
š
, 
id
);

69 @
	gOv”ride


70 @
PassThrough


71 
public
 
şo£
() {

72 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

75 @
Ov”ride


76 
public
 
SŒšg
 
toSŒšg
() {

77  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

80 @
	gOv”ride


81 @
AcûssÜ


82 
public
 
	gCÜfuCompoundObj
.
IÂ”
 
g‘U£r
() {

83  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘U£r
();},
nuÎ
);

86 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuCompoundObj
>> 
g‘CÜfuSMRUpÿÎM­
() {

87  
	gupÿÎM­_CORFUSMR
;

90 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuCompoundObj
>> 
g‘CÜfuUndoRecÜdM­
() {

91  
	gundoRecÜdM­_CORFUSMR
;

94 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuCompoundObj
>> 
g‘CÜfuUndoM­
() {

95  
	gundoM­_CORFUSMR
;

98 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

99  
	g»£tS‘_CORFUSMR
;

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/CorfuSharedCounter$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

16 @
In¡rum’‹dCÜfuObjeù


17 
public
 
şass
 
CÜfuSh¬edCouÁ”$CORFUSMR
 
ex‹nds
 
CÜfuSh¬edCouÁ”
 
im¶em’ts
 
	gICÜfuSMR
<
	gCÜfuSh¬edCouÁ”
> {

18 
public
 
	gICÜfuSMRProxy
<
	gCÜfuSh¬edCouÁ”
> 
	g´oxy_CORFUSMR
;

20 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuSh¬edCouÁ”
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<CorfuSharedCounter>>()

21 .
put
("£tV®ue", (
obj
, 
¬gs
è-> { obj.
£tV®ue
((è¬gs[0]); 
nuÎ
;})

22 .
put
("CAS", (
obj
, 
¬gs
è-> {  obj.
CAS
((è¬gs[0], (è¬gs[1]);}).
bud
();

24 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<CÜfuSh¬edCouÁ”>>().
bud
();

26 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<CÜfuSh¬edCouÁ”>>().
bud
();

28 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

30 
public
 
CÜfuSh¬edCouÁ”$CORFUSMR
(
š™v®ue
) {

31 
su³r
(
š™v®ue
);

34 
public
 
CÜfuSh¬edCouÁ”$CORFUSMR
() {

35 
su³r
();

38 
public
 
	gICÜfuSMRProxy
<
	gCÜfuSh¬edCouÁ”
> 
g‘CÜfuSMRProxy
() {

39  
	g´oxy_CORFUSMR
;

42 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
CÜfuSh¬edCouÁ”
> 
´oxy
) {

43 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

46 @
Ov”ride


47 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

48  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

51 @
	gOv”ride


52 @
PassThrough


53 
public
 
şo£
() {

54 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

57 @
	gOv”ride


58 @
AcûssÜ


59 
public
 
g‘V®ue
() {

60  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘V®ue
();},
nuÎ
);

63 @
Ov”ride


64 
public
 
CÜfuSh¬edCouÁ”
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

65  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

68 @
Ov”ride


69 
public
 
hashCode
() {

70  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

73 @
	gOv”ride


74 @
MutÜ
(

75 
Çme
 = "setValue"

77 
public
 
£tV®ue
(
ÃwV®ue
) {

78 
´oxy_CORFUSMR
.
logUpd©e
("£tV®ue",
çl£
,
nuÎ
,
ÃwV®ue
);

81 @
Ov”ride


82 
public
 
SŒšg
 
toSŒšg
() {

83  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

86 @
	gOv”ride


87 @
MutÜAcûssÜ
(

88 
Çme
 = "CAS"

90 
CAS
(
‹¡V®ue
, 
ÃwV®ue
) {

91 
	gadd»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("CAS",
Œue
,
nuÎ
,
‹¡V®ue
, 
ÃwV®ue
);

92  (è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
nuÎ
);

95 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gCÜfuSh¬edCouÁ”
>> 
g‘CÜfuSMRUpÿÎM­
() {

96  
	gupÿÎM­_CORFUSMR
;

99 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
g‘CÜfuUndoRecÜdM­
() {

100  
	gundoRecÜdM­_CORFUSMR
;

103 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gCÜfuSh¬edCouÁ”
>> 
g‘CÜfuUndoM­
() {

104  
	gundoM­_CORFUSMR
;

107 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

108  
	g»£tS‘_CORFUSMR
;

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/TestClass$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

14 @
In¡rum’‹dCÜfuObjeù


15 
public
 
şass
 
Te¡CÏss$CORFUSMR
 
ex‹nds
 
Te¡CÏss
 
im¶em’ts
 
	gICÜfuSMR
<
	gTe¡CÏss
> {

16 
public
 
	gICÜfuSMRProxy
<
	gTe¡CÏss
> 
	g´oxy_CORFUSMR
;

18 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gTe¡CÏss
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<TestClass>>()

19 .
put
("£t", (
obj
, 
¬gs
è-> { obj.
£t
((è¬gs[0]); 
nuÎ
;}).
bud
();

21 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gTe¡CÏss
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<Te¡CÏss>>().
bud
();

23 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gTe¡CÏss
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<Te¡CÏss>>().
bud
();

25 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

27 
public
 
Te¡CÏss$CORFUSMR
() {

28 
su³r
();

31 
public
 
	gICÜfuSMRProxy
<
	gTe¡CÏss
> 
g‘CÜfuSMRProxy
() {

32  
	g´oxy_CORFUSMR
;

35 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
Te¡CÏss
> 
´oxy
) {

36 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

39 @
Ov”ride


40 
public
 
Te¡CÏss
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

41  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

44 @
Ov”ride


45 
public
 
SŒšg
 
toSŒšg
() {

46  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

49 @
Ov”ride


50 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

51  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

54 @
	gOv”ride


55 @
MutÜ
(

56 
Çme
 = "set"

58 
public
 
£t
(
toS‘
) {

59 
´oxy_CORFUSMR
.
logUpd©e
("£t",
çl£
,
nuÎ
,
toS‘
);

62 @
Ov”ride


63 
public
 
hashCode
() {

64  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

67 @
Ov”ride


68 
public
 
g‘
() {

69  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘
();},
nuÎ
);

72 @
	gOv”ride


73 @
PassThrough


74 
public
 
şo£
() {

75 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

78 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gTe¡CÏss
>> 
g‘CÜfuSMRUpÿÎM­
() {

79  
	gupÿÎM­_CORFUSMR
;

82 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gTe¡CÏss
>> 
g‘CÜfuUndoRecÜdM­
() {

83  
	gundoRecÜdM­_CORFUSMR
;

86 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gTe¡CÏss
>> 
g‘CÜfuUndoM­
() {

87  
	gundoM­_CORFUSMR
;

90 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

91  
	g»£tS‘_CORFUSMR
;

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/TestClassUsingAnnotation$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜ
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gMutÜAcûssÜ
;

14 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

16 @
In¡rum’‹dCÜfuObjeù


17 
public
 
şass
 
Te¡CÏssUsšgAÂÙ©iÚ$CORFUSMR
 
ex‹nds
 
Te¡CÏssUsšgAÂÙ©iÚ
 
im¶em’ts
 
	gICÜfuSMR
<
	gTe¡CÏssUsšgAÂÙ©iÚ
> {

18 
public
 
	gICÜfuSMRProxy
<
	gTe¡CÏssUsšgAÂÙ©iÚ
> 
	g´oxy_CORFUSMR
;

20 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gTe¡CÏssUsšgAÂÙ©iÚ
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICorfuSMRUpcallTarget<TestClassUsingAnnotation>>()

21 .
put
("‹¡Inüem’t", (
obj
, 
¬gs
è-> {  obj.
‹¡Inüem’t
();})

22 .
put
("»£t", (
obj
, 
¬gs
è-> { obj.
»£t
(); 
nuÎ
;}).
bud
();

24 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gTe¡CÏssUsšgAÂÙ©iÚ
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<Te¡CÏssUsšgAÂÙ©iÚ>>().
bud
();

26 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gTe¡CÏssUsšgAÂÙ©iÚ
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<Te¡CÏssUsšgAÂÙ©iÚ>>().
bud
();

28 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

30 
public
 
Te¡CÏssUsšgAÂÙ©iÚ$CORFUSMR
() {

31 
su³r
();

34 
public
 
	gICÜfuSMRProxy
<
	gTe¡CÏssUsšgAÂÙ©iÚ
> 
g‘CÜfuSMRProxy
() {

35  
	g´oxy_CORFUSMR
;

38 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
Te¡CÏssUsšgAÂÙ©iÚ
> 
´oxy
) {

39 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

42 @
	gOv”ride


43 @
PassThrough


44 
public
 
şo£
() {

45 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

48 @
	gOv”ride


49 @
MutÜAcûssÜ
(

50 
Çme
 = "testIncrement"

52 
public
 
boŞ—n
 
‹¡Inüem’t
() {

53 
add»ss_CORFUSMR
 = 
´oxy_CORFUSMR
.
logUpd©e
("‹¡Inüem’t",
Œue
,
nuÎ
);

54  (
	gboŞ—n
è
	g´oxy_CORFUSMR
.
g‘UpÿÎResuÉ
(
add»ss_CORFUSMR
, 
nuÎ
);

57 @
Ov”ride


58 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

59  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

62 @
	gOv”ride


63 @
AcûssÜ


64 
public
 
g‘V®ue
() {

65  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘V®ue
();},
nuÎ
);

68 @
	gOv”ride


69 @
PassThrough


70 
public
 
boŞ—n
 
‹¡Fn1
() {

71  
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> { o_CORFUSMR.
‹¡Fn1
();});

74 @
	gOv”ride


75 @
MutÜ
(

76 
Çme
 = "reset"

78 
public
 
»£t
() {

79 
´oxy_CORFUSMR
.
logUpd©e
("»£t",
çl£
,
nuÎ
);

82 @
Ov”ride


83 
public
 
SŒšg
 
toSŒšg
() {

84  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

87 @
Ov”ride


88 
public
 
hashCode
() {

89  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

92 @
Ov”ride


93 
public
 
Te¡CÏssUsšgAÂÙ©iÚ
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

94  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

97 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gTe¡CÏssUsšgAÂÙ©iÚ
>> 
g‘CÜfuSMRUpÿÎM­
() {

98  
	gupÿÎM­_CORFUSMR
;

101 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gTe¡CÏssUsšgAÂÙ©iÚ
>> 
g‘CÜfuUndoRecÜdM­
() {

102  
	gundoRecÜdM­_CORFUSMR
;

105 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gTe¡CÏssUsšgAÂÙ©iÚ
>> 
g‘CÜfuUndoM­
() {

106  
	gundoM­_CORFUSMR
;

109 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

110  
	g»£tS‘_CORFUSMR
;

	@test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/TransactionalObject$CORFUSMR.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gobjeù
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËM­
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gcŞËù
.
	gImmubËS‘
;

5 
impÜt
 
	gjava
.
	gÏng
.
	gObjeù
;

6 
impÜt
 
	gjava
.
	gÏng
.
	gOv”ride
;

7 
impÜt
 
	gjava
.
	gÏng
.
	gSŒšg
;

8 
impÜt
 
	gjava
.
	gut
.
	gM­
;

9 
impÜt
 
	gjava
.
	gut
.
	gS‘
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gAcûssÜ
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gIn¡rum’‹dCÜfuObjeù
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gPassThrough
;

13 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gªnÙ©iÚs
.
	gT¿n§ùiÚ®M‘hod
;

15 @
In¡rum’‹dCÜfuObjeù


16 
public
 
şass
 
T¿n§ùiÚ®Objeù$CORFUSMR
 
ex‹nds
 
T¿n§ùiÚ®Objeù
 
im¶em’ts
 
	gICÜfuSMR
<
	gT¿n§ùiÚ®Objeù
> {

17 
public
 
	gICÜfuSMRProxy
<
	gT¿n§ùiÚ®Objeù
> 
	g´oxy_CORFUSMR
;

19 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gT¿n§ùiÚ®Objeù
>> 
	gupÿÎM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, ICÜfuSMRUpÿÎT¬g‘<T¿n§ùiÚ®Objeù>>().
bud
();

21 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gT¿n§ùiÚ®Objeù
>> 
	gundoRecÜdM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoRecÜdFunùiÚ<T¿n§ùiÚ®Objeù>>().
bud
();

23 
public
 
fš®
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gT¿n§ùiÚ®Objeù
>> 
	gundoM­_CORFUSMR
 = 
Ãw
 
ImmubËM­
.
Bud”
<
SŒšg
, IUndoFunùiÚ<T¿n§ùiÚ®Objeù>>().
bud
();

25 
public
 
fš®
 
	gS‘
<
	gSŒšg
> 
	g»£tS‘_CORFUSMR
 = 
Ãw
 
ImmubËS‘
.
Bud”
<
SŒšg
>().
bud
();

27 
public
 
T¿n§ùiÚ®Objeù$CORFUSMR
() {

28 
su³r
();

31 
public
 
	gICÜfuSMRProxy
<
	gT¿n§ùiÚ®Objeù
> 
g‘CÜfuSMRProxy
() {

32  
	g´oxy_CORFUSMR
;

35 
public
 
£tCÜfuSMRProxy
(
ICÜfuSMRProxy
<
T¿n§ùiÚ®Objeù
> 
´oxy
) {

36 
	gthis
.
	g´oxy_CORFUSMR
 = 
´oxy
;

39 @
	gOv”ride


40 @
	gT¿n§ùiÚ®M‘hod


41 @
AcûssÜ


42 
public
 
throwRuÁimeExû±iÚ
() {

43 
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> {
su³r
.
throwRuÁimeExû±iÚ
();

44  
nuÎ
; });}

46 @
Ov”ride


47 
public
 
SŒšg
 
toSŒšg
() {

48  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
toSŒšg
();},
nuÎ
);

51 @
	gOv”ride


52 @
PassThrough


53 
public
 
şo£
() {

54 
	g´oxy_CORFUSMR
.
·ssThrough
(
o_CORFUSMR
 -> {o_CORFUSMR.
şo£
(); 
nuÎ
;});

57 @
Ov”ride


58 
public
 
T¿n§ùiÚ®Objeù
 
g‘CÚ‹xt
(
ICÜfuExecutiÚCÚ‹xt
.
CÚ‹xt
 
cÚ‹xt
) {

59  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
g‘CÚ‹xt
(
cÚ‹xt
);},
nuÎ
);

62 @
	gOv”ride


63 @
	gT¿n§ùiÚ®M‘hod


64 @
AcûssÜ


65 
public
 
boŞ—n
 
isInT¿n§ùiÚ
() {

66  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
isInT¿n§ùiÚ
();

69 @
Ov”ride


70 
public
 
boŞ—n
 
equ®s
(
Objeù
 
¬g0
) {

71  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
equ®s
(
¬g0
);},
nuÎ
);

74 @
Ov”ride


75 
public
 
hashCode
() {

76  
	g´oxy_CORFUSMR
.
acûss
(
o_CORFUSMR
 -> { o_CORFUSMR.
hashCode
();},
nuÎ
);

79 @
	gOv”ride


80 @
	gT¿n§ùiÚ®M‘hod


81 @
AcûssÜ


82 
public
 
boŞ—n
 
isInNe¡edT¿n§ùiÚ
() {

83  
	g´oxy_CORFUSMR
.
TXExecu‹
((è-> { 
su³r
.
isInNe¡edT¿n§ùiÚ
();

86 
public
 
	gM­
<
	gSŒšg
, 
	gICÜfuSMRUpÿÎT¬g‘
<
	gT¿n§ùiÚ®Objeù
>> 
g‘CÜfuSMRUpÿÎM­
() {

87  
	gupÿÎM­_CORFUSMR
;

90 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoRecÜdFunùiÚ
<
	gT¿n§ùiÚ®Objeù
>> 
g‘CÜfuUndoRecÜdM­
() {

91  
	gundoRecÜdM­_CORFUSMR
;

94 
public
 
	gM­
<
	gSŒšg
, 
	gIUndoFunùiÚ
<
	gT¿n§ùiÚ®Objeù
>> 
g‘CÜfuUndoM­
() {

95  
	gundoM­_CORFUSMR
;

98 
public
 
	gS‘
<
	gSŒšg
> 
g‘CÜfuRe£tS‘
() {

99  
	g»£tS‘_CORFUSMR
;

	@utils/src/main/java/org/corfudb/utils/lock/Lock.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gut
.
	gcÚcu¼’t
.
	gTh»adFaùÜyBud”
;

5 
impÜt
 
	glombok
.
	gG‘‹r
;

6 
impÜt
 
	glombok
.
	gS‘‹r
;

7 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockCl›Á
.
	gCl›ÁCÚ‹xt
;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
.*;

12 
impÜt
 
	gjava
.
	gut
.
	gHashM­
;

13 
impÜt
 
	gjava
.
	gut
.
	gM­
;

14 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

15 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

16 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜs
;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gLškedBlockšgQueue
;

74 @
Slf4j


75 
public
 cÏs 
	cLock
 {

78 @
	mS‘‹r


79 @
VisibËFÜTe¡šg


80 
public
 
	mËa£Du¿tiÚ
 = 300;

83 @
G‘‹r


84 
´iv©e
 
fš®
 
	mLockD©aTy³s
.
LockId
 
	mlockId
;

87 @
G‘‹r


88 
´iv©e
 
fš®
 
Cl›ÁCÚ‹xt
 
	mş›ÁCÚ‹xt
;

91 @
G‘‹r


92 
´iv©e
 
fš®
 
LockLi¡’”
 
	mlockLi¡’”
;

95 
´iv©e
 
fš®
 
	mLškedBlockšgQueue
<
	mLockEv’t
> 
	mev’tQueue
 = 
Ãw
 
LškedBlockšgQueue
<>();

98 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	mev’tCÚsum”
;

101 @
G‘‹r


102 
´iv©e
 vŞ©
LockS‹
 
	m¡©e
;

105 @
G‘‹r


106 
´iv©e
 
	mM­
<
	mLockS‹Ty³
, 
	mLockS‹
> 
	m¡©es
 = 
Ãw
 
HashM­
<>();

115 
public
 
	$Lock
(
LockD©aTy³s
.
LockId
 
lockId
, 
LockLi¡’”
 
lockLi¡’”
, 
LockCl›Á
.
Cl›ÁCÚ‹xt
 
ş›ÁCÚ‹xt
) {

116 
this
.
lockId
 =†ockId;

117 
this
.
ş›ÁCÚ‹xt
 = clientContext;

118 
this
.
lockLi¡’”
 =†ockListener;

119 
this
.
ev’tCÚsum”
 = 
ExecutÜs
.
	`ÃwSšgËTh»adExecutÜ
(
Ãw


120 
	`Th»adFaùÜyBud”
().
	`£tNameFÜm©
("lock-ev’t-cÚsum”").
	`bud
());

122 
	`š™ŸlizeS‹s
();

124 
this
.
¡©e
 = 
¡©es
.
	`g‘
(
LockS‹Ty³
.
NO_LEASE
);

126 
ev’tCÚsum”
.
	`subm™
(
this
::
cÚsume
);

132 
´iv©e
 
	$š™ŸlizeS‹s
() {

133 
¡©es
.
	`put
(
LockS‹Ty³
.
NO_LEASE
, 
Ãw
 
	`NoL—£S‹
(
this
));

134 
¡©es
.
	`put
(
LockS‹Ty³
.
HAS_LEASE
, 
Ãw
 
	`HasL—£S‹
(
this
));

135 
¡©es
.
	`put
(
LockS‹Ty³
.
STOPPED
, 
Ãw
 
	`HasL—£S‹
(
this
));

136 
	}
}

145 
public
 
	$šput
(
LockEv’t
 
ev’t
) {

146 
Œy
 {

147 ià(
¡©e
.
	`g‘Ty³
().
	`equ®s
(
LockS‹Ty³
.
STOPPED
)) {

149 
log
.
	`w¬n
("Lock S‹ Machšha b“À¡İ³d. Ev’ˆ{} wÈbdrİ³d.", 
ev’t
);

152 
ev’tQueue
.
	`put
(
ev’t
);

153 } 
	`ÿtch
 (
IÁ”ru±edExû±iÚ
 
ex
) {

154 
log
.
	`”rÜ
("Log R•liÿtiÚ iÁ”ru±ed Exû±iÚ: ", 
ex
);

156 
	}
}

163 
´iv©e
 
	$cÚsume
() {

164 
Œy
 {

165 ià(
¡©e
.
	`g‘Ty³
(è=ğ
LockS‹Ty³
.
STOPPED
) {

166 
log
.
	`šfo
("Lock State Machine has been stopped. No moreƒvents will be…rocessed.");

171 
LockEv’t
 
ev’t
 = 
ev’tQueue
.
	`ke
();

172 
Œy
 {

173 
O±iÚ®
<
LockS‹
> 
ÃwS‹
 = 
¡©e
.
	`´oûssEv’t
(
ev’t
);

174 ià(
ÃwS‹
.
	`isP»£Á
()) {

175 
log
.
	`Œaû
("T¿ns™iÚ from {}Ø{}", 
¡©e
, 
ÃwS‹
);

176 
	`Œªs™iÚ
(
¡©e
, 
ÃwS‹
.
	`g‘
());

177 
¡©e
 = 
ÃwS‹
.
	`g‘
();

179 } 
	`ÿtch
 (
IÎeg®T¿ns™iÚExû±iÚ
 
Ëg®S‹
) {

180 
log
.
	`”rÜ
("IÎeg®†ockƒv’ˆ{} wh’ iÀ¡©{}", 
ev’t
, 
¡©e
.
	`g‘Ty³
());

181 
	`šput
(
LockEv’t
.
UNRECOVERABLE_ERROR
);

184 
ev’tCÚsum”
.
	`subm™
(
this
::
cÚsume
);

185 } 
	`ÿtch
 (
ThrowabË
 
t
) {

186 
log
.
	`”rÜ
("E¼Ü oÀev’ˆcÚsum”: ", 
t
);

187 
	`šput
(
LockEv’t
.
UNRECOVERABLE_ERROR
);

189 
	}
}

197 
	$Œªs™iÚ
(
LockS‹
 
äom
, LockS‹ 
to
) {

198 
äom
.
	`ÚEx™
(
to
);

199 
to
.
	`ş—r
();

200 
to
.
	`ÚEÁry
(
äom
);

201 
	}
}

	@utils/src/main/java/org/corfudb/utils/lock/LockClient.java

7 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
;

10 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

11 
impÜt
 
	glombok
.
	gD©a
;

12 
impÜt
 
	glombok
.
	gG‘‹r
;

13 
impÜt
 
	glombok
.
	gNÚNuÎ
;

14 
impÜt
 
	glombok
.
	gS‘‹r
;

15 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

16 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

17 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
;

18 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g³rsi¡’û
.
	gLockStÜe
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
.
	gLockEv’t
;

21 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

22 
impÜt
 
	gjava
.
	gut
.*;

23 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.*;

37 @
Slf4j


38 
public
 cÏs 
	cLockCl›Á
 {

41 @
	mVisibËFÜTe¡šg


42 @
G‘‹r


43 
´iv©e
 
fš®
 
	mM­
<
	mLockId
, 
	mLock
> 
	mlocks
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

46 
´iv©e
 
fš®
 
LockStÜe
 
	mlockStÜe
;

49 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	mlockMÚ™ÜScheduËr
;

52 @
S‘‹r


53 
´iv©e
 
	mDu¿tiÚB‘w“nLockMÚ™ÜRuns
 = 60;

56 
´iv©e
 
fš®
 
Cl›ÁCÚ‹xt
 
	mş›ÁCÚ‹xt
;

59 
´iv©e
 
	mO±iÚ®
<
	mScheduËdFutu»
<?>> 
	mlockMÚ™ÜFutu»
 = 
O±iÚ®
.
em±y
();

61 @
G‘‹r


62 
´iv©e
 
UUID
 
	mş›ÁId
;

74 
public
 
	$LockCl›Á
(
UUID
 
ş›ÁId
, 
CÜfuRuÁime
 
cÜfuRuÁime
è
throws
 
NoSuchM‘hodExû±iÚ
, 
IÎeg®AcûssExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
 {

76 
ScheduËdExecutÜS”viû
 
skScheduËr
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(1, (
r
) ->

78 
Th»ad
 
t
 = 
ExecutÜs
.
	`deçuÉTh»adFaùÜy
().
	`ÃwTh»ad
(
r
);

79 
t
.
	`£tName
("LockTaskThread");

80 
t
.
	`£tD«mÚ
(
Œue
);

81  
t
;

84 
ExecutÜS”viû
 
lockLi¡’”ExecutÜ
 = 
ExecutÜs
.
	`ÃwFixedTh»adPoŞ
(1, (
r
) ->

86 
Th»ad
 
t
 = 
ExecutÜs
.
	`deçuÉTh»adFaùÜy
().
	`ÃwTh»ad
(
r
);

87 
t
.
	`£tName
("LockListenerThread");

88 
t
.
	`£tD«mÚ
(
Œue
);

89  
t
;

92 
this
.
lockMÚ™ÜScheduËr
 = 
ExecutÜs
.
	`ÃwScheduËdTh»adPoŞ
(1, (
r
) ->

94 
Th»ad
 
t
 = 
ExecutÜs
.
	`deçuÉTh»adFaùÜy
().
	`ÃwTh»ad
(
r
);

95 
t
.
	`£tName
("LockMonitorThread");

96 
t
.
	`£tD«mÚ
(
Œue
);

97  
t
;

100 
this
.
ş›ÁId
 = clientId;

101 
this
.
lockStÜe
 = 
Ãw
 
	`LockStÜe
(
cÜfuRuÁime
, 
ş›ÁId
);

102 
this
.
ş›ÁCÚ‹xt
 = 
Ãw
 
	`Cl›ÁCÚ‹xt
(
ş›ÁId
, 
lockStÜe
, 
skScheduËr
, 
lockLi¡’”ExecutÜ
);

116 
public
 
	`»gi¡”IÁ”e¡
(@
NÚNuÎ
 
SŒšg
 
lockGroup
, @NÚNuÎ SŒšg 
lockName
, 
LockLi¡’”
 
lockLi¡’”
) {

117 
LockId
 
lockId
 = 
LockD©aTy³s
.LockId.
	`ÃwBud”
()

118 .
	`£tLockGroup
(
lockGroup
)

119 .
	`£tLockName
(
lockName
)

120 .
	`bud
();

122 
Lock
 
lock
 = 
locks
.
	`compu‹IfAb£Á
(

123 
lockId
,

124 (
key
è-> 
Ãw
 
	`Lock
(
lockId
, 
lockLi¡’”
, 
ş›ÁCÚ‹xt
));

127 
lock
.
	`šput
(
LockEv’t
.
LEASE_REVOKED
);

129 
	`mÚ™ÜLocks
();

130 
	}
}

136 
´iv©e
 
	$mÚ™ÜLocks
() {

138 
lockMÚ™ÜFutu»
 = 
O±iÚ®
.
	`of
(
lockMÚ™ÜScheduËr
.
	`scheduËW™hFixedD–ay
(

140 
Œy
 {

141 
CŞËùiÚ
<
LockId
> 
locksW™hExpœedL—£s
 = 
lockStÜe
.
	`f‹rLocksW™hExpœedL—£s
(
locks
.
	`keyS‘
());

142 
LockId
 
lockId
 : 
locksW™hExpœedL—£s
) {

143 
log
.
	`Œaû
("LockCl›Á:†—£„evoked fÜ†ock {}", 
lockId
.
	`g‘LockName
());

144 
locks
.
	`g‘
(
lockId
).
	`šput
(
LockEv’t
.
LEASE_REVOKED
);

146 } 
	`ÿtch
 (
Exû±iÚ
 
ex
) {

150 
Du¿tiÚB‘w“nLockMÚ™ÜRuns
,

151 
Du¿tiÚB‘w“nLockMÚ™ÜRuns
,

152 
TimeUn™
.
SECONDS


155 
	}
}

161 @
D©a


162 
public
 cÏs 
	cCl›ÁCÚ‹xt
 {

164 
´iv©e
 
fš®
 
UUID
 
	gş›ÁUuid
;

165 
´iv©e
 
fš®
 
LockStÜe
 
	glockStÜe
;

166 
´iv©e
 
fš®
 
ScheduËdExecutÜS”viû
 
	gskScheduËr
;

167 
´iv©e
 
fš®
 
ExecutÜS”viû
 
	glockLi¡’”ExecutÜ
;

169 
public
 
Cl›ÁCÚ‹xt
(
UUID
 
ş›ÁUuid
, 
LockStÜe
 
lockStÜe
, 
ScheduËdExecutÜS”viû
 
skScheduËr
, 
ExecutÜS”viû
 
lockLi¡’”ExecutÜ
) {

170 
	gthis
.
	gş›ÁUuid
 = 
ş›ÁUuid
;

171 
	gthis
.
	glockStÜe
 = 
lockStÜe
;

172 
	gthis
.
	gskScheduËr
 = 
skScheduËr
;

173 
	gthis
.
	glockLi¡’”ExecutÜ
 = 
lockLi¡’”ExecutÜ
;

	@utils/src/main/java/org/corfudb/utils/lock/LockListener.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
;

11 
public
 
š‹rçû
 
	gLockLi¡’”
 {

15 
lockAcquœed
(
LockD©aTy³s
.
LockId
 
lockId
);

20 
lockRevoked
(
LockD©aTy³s
.
LockId
 
lockId
);

	@utils/src/main/java/org/corfudb/utils/lock/persistence/LockStore.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g³rsi¡’û
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
.
	gAÎArgsCÚ¡ruùÜ
;

5 
impÜt
 
	glombok
.
	gD©a
;

6 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

7 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuRuÁime
;

8 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gCÜfuStÜeM‘ad©a
;

9 
impÜt
 
	gÜg
.
	gcÜfudb
.
	gruÁime
.
	gcŞËùiÚs
.*;

10 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
;

11 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockD©a
;

12 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
;

14 
impÜt
 
	gjava
.
	gÏng
.
	g»æeù
.
	gInvoÿtiÚT¬g‘Exû±iÚ
;

15 
impÜt
 
	gjava
.
	gtime
.
	gIn¡ªt
;

16 
impÜt
 
	gjava
.
	gut
.*;

17 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gCÚcu¼’tHashM­
;

19 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLock
.
	gËa£Du¿tiÚ
;

34 @
Slf4j


35 
public
 cÏs 
	cLockStÜe
 {

38 
´iv©e
 
fš®
 
SŒšg
 
	mÇme¥aû
 = "CORFU_SYSTEM";

40 
´iv©e
 
fš®
 
SŒšg
 
	mbËName
 = "LOCK";

42 
´iv©e
 
fš®
 
Uuid
 
	mş›ÁId
;

44 
´iv©e
 
fš®
 
CÜfuStÜe
 
	mcÜfuStÜe
;

48 
´iv©e
 
	mM­
<
	mLockId
, 
	mOb£rvedLock
> 
	mob£rvedLocks
 = 
Ãw
 
CÚcu¼’tHashM­
<>();

58 
public
 
	$LockStÜe
(
CÜfuRuÁime
 
ruÁime
, 
UUID
 
ş›ÁUuid
è
throws
 
NoSuchM‘hodExû±iÚ
, 
IÎeg®AcûssExû±iÚ
, 
InvoÿtiÚT¬g‘Exû±iÚ
 {

59 
this
.
cÜfuStÜe
 = 
Ãw
 
	`CÜfuStÜe
(
ruÁime
);

60 
this
.
cÜfuStÜe
.
	`İ’TabË
(
Çme¥aû
,

61 
bËName
,

62 
LockId
.
şass
,

63 
LockD©a
.
şass
,

64 
nuÎ
,

65 
TabËO±iÚs
.
	`bud”
().
	`bud
());

67 
this
.
ş›ÁId
 = 
Uuid
.
	`ÃwBud”
()

68 .
	`£tMsb
(
ş›ÁUuid
.
	`g‘Mo¡SignifiÿÁB™s
())

69 .
	`£tLsb
(
ş›ÁUuid
.
	`g‘L—¡SignifiÿÁB™s
())

70 .
	`bud
();

86 
public
 
boŞ—n
 
	$acquœe
(
LockId
 
lockId
è
throws
 
LockStÜeExû±iÚ
 {

87 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

88 
O±iÚ®
<
LockD©a
> 
lockInD©a¡Üe
 = 
	`g‘
(
lockId
, 
time¡amp
);

90 ià(!
lockInD©a¡Üe
.
	`isP»£Á
()) {

91 
LockD©a
 
ÃwLockD©a
 = LockD©a.
	`ÃwBud”
()

92 .
	`£tLockId
(
lockId
)

93 .
	`£tL—£OwÃrId
(
ş›ÁId
)

94 .
	`£tL—£R’ew®Numb”
(0)

95 .
	`£tL—£Acquis™iÚNumb”
(0)

96 .
	`bud
();

98 
	`ü—‹
(
lockId
, 
ÃwLockD©a
, 
time¡amp
);

99 
log
.
	`debug
("Lock: {} Cl›Á:{}‡cquœed†ock. NØ´e-exi¡šg†—£ iÀd©a¡Üe.", 
lockId
, 
ş›ÁId
);

100  
Œue
;

102 ià(
	`isRevoÿbË
(
lockId
)) {

103 
LockD©a
 
ÃwLockD©a
 = LockD©a.
	`ÃwBud”
()

104 .
	`£tLockId
(
lockId
)

105 .
	`£tL—£OwÃrId
(
ş›ÁId
)

106 .
	`£tL—£R’ew®Numb”
(0)

107 .
	`£tL—£Acquis™iÚNumb”
(
lockInD©a¡Üe
.
	`g‘
().
	`g‘L—£Acquis™iÚNumb”
() + 1)

108 .
	`bud
();

110 
	`upd©e
(
lockId
, 
ÃwLockD©a
, 
time¡amp
);

111 
log
.
	`debug
("Lock: {} Cl›Á:{}‡cquœed†ock. Expœed†—£ iÀd©a¡Üe: {} ", 
lockId
, 
ş›ÁId
, 
lockInD©a¡Üe
.
	`g‘
());

112  
Œue
;

115 
log
.
	`debug
("Lock: {} Cl›Á:{} could‚Ù‡cquœlock. L—£ iÀd©a¡Üe: {}", 
lockId
, 
ş›ÁId
, 
lockInD©a¡Üe
.
	`g‘
());

116  
çl£
;

119 
	}
}

129 
public
 
boŞ—n
 
	$»Ãw
(
LockId
 
lockId
è
throws
 
LockStÜeExû±iÚ
 {

130 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
 = 
cÜfuStÜe
.
	`g‘Time¡amp
();

131 
O±iÚ®
<
LockD©a
> 
lockInD©a¡Üe
 = 
	`g‘
(
lockId
, 
time¡amp
);

133 ià(!
lockInD©a¡Üe
.
	`isP»£Á
()) {

135 
log
.
	`debug
("Lock: {} Cl›Á:{} could‚Ù„’ew†—£. NØlock iÀd©aba£.", 
lockId
, 
ş›ÁId
);

136  
çl£
;

137 } ià(!
lockInD©a¡Üe
.
	`g‘
().
	`g‘L—£OwÃrId
().
	`equ®s
(
ş›ÁId
)) {

139 
log
.
	`debug
("Lock: {} Cl›Á:{} could‚Ù„’ew†—£.L—£ iÀd©a¡Üe: {}", 
lockId
, 
ş›ÁId
, 
lockInD©a¡Üe
.
	`g‘
());

140  
çl£
;

143 
LockD©a
 
ÃwLockD©a
 = LockD©a.
	`ÃwBud”
()

144 .
	`£tLockId
(
lockId
)

145 .
	`£tL—£OwÃrId
(
lockInD©a¡Üe
.
	`g‘
().
	`g‘L—£OwÃrId
())

146 .
	`£tL—£R’ew®Numb”
(
lockInD©a¡Üe
.
	`g‘
().
	`g‘L—£R’ew®Numb”
() + 1)

147 .
	`bud
();

148 
	`upd©e
(
lockId
, 
ÃwLockD©a
, 
time¡amp
);

149 
log
.
	`debug
("Lock: {} Cl›Á:{}„’ewed†—£.", 
lockId
, 
ş›ÁId
);

150  
Œue
;

152 
	}
}

162 
public
 
	gCŞËùiÚ
<
	gLockId
> 
f‹rLocksW™hExpœedL—£s
(
CŞËùiÚ
<
LockId
> 
lockIds
è
throws
 
	gLockStÜeExû±iÚ
 {

163 
	gCŞËùiÚ
<
	gLockId
> 
	g»voÿbËL—£s
 = 
Ãw
 
A¼ayLi¡
<>();

164 
	gŒy
 {

166 
LockId
 
	glockId
: 
lockIds
) {

167 ià(
isRevoÿbË
(
lockId
)) {

168 
»voÿbËL—£s
.
add
(
lockId
);

171 } 
ÿtch
 (
Exû±iÚ
 
e
) {

172 
	glog
.
”rÜ
("Cl›Á: {} Exû±iÚ.", 
ş›ÁId
, 
e
);

173 
throw
 
Ãw
 
LockStÜeExû±iÚ
("Exû±iÚ whg‘tšgƒxpœed†—£ fÜ cl›Á " + 
ş›ÁId
, 
e
);

175  
	g»voÿbËL—£s
;

188 
´iv©e
 
	$ü—‹
(
LockId
 
lockId
, 
LockD©a
 
lockM‘aD©a
, 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
è
throws
 
LockStÜeExû±iÚ
 {

189 
Œy
 {

190 
log
.
	`šfo
("LockStÜe: c»©lock„ecÜd fÜ : {}", 
lockId
.
	`g‘LockName
());

191 
cÜfuStÜe
.
	`tx
(
Çme¥aû
)

192 .
	`ü—‹
(
bËName
,

193 
lockId
,

194 
lockM‘aD©a
,

195 
nuÎ
)

196 .
	`comm™
(
time¡amp
);

197 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

198 
log
.
	`”rÜ
("Lock: {} Exû±iÚ duršg c»©e.", 
lockId
, 
e
);

199 
throw
 
Ãw
 
	`LockStÜeExû±iÚ
("Exû±iÚ whü—tšg†ock " + 
lockId
, 
e
);

201 
	}
}

211 
´iv©e
 
	$upd©e
(
LockId
 
lockId
, 
LockD©a
 
lockM‘aD©a
, 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
è
throws
 
LockStÜeExû±iÚ
 {

212 
Œy
 {

213 
cÜfuStÜe
.
	`tx
(
Çme¥aû
)

214 .
	`upd©e
(
bËName
,

215 
lockId
,

216 
lockM‘aD©a
,

217 
nuÎ
)

218 .
	`comm™
(
time¡amp
);

219 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

220 
log
.
	`”rÜ
("Lock: {} Exû±iÚ duršg upd©e.", 
lockId
, 
e
);

221 
throw
 
Ãw
 
	`LockStÜeExû±iÚ
("Exû±iÚ whupd©šg†ock " + 
lockId
, 
e
);

223 
	}
}

233 
´iv©e
 
	gO±iÚ®
<
	gLockD©a
> 
	$g‘
(
LockId
 
lockId
, 
CÜfuStÜeM‘ad©a
.
Time¡amp
 
time¡amp
è
throws
 
LockStÜeExû±iÚ
 {

234 
Œy
 {

235 
CÜfuRecÜd
 
»cÜd
 = 
cÜfuStÜe
.
	`qu”y
(
Çme¥aû
).
	`g‘RecÜd
(
bËName
, 
time¡amp
, 
lockId
);

236 ià(
»cÜd
 !ğ
nuÎ
) {

237  
O±iÚ®
.
	`of
((
LockD©a
è
»cÜd
.
	`g‘Paylßd
());

239  
O±iÚ®
.
	`em±y
();

241 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

242 
log
.
	`”rÜ
("Lock: {} Exû±iÚ duršg g‘.", 
lockId
, 
e
);

243 
throw
 
Ãw
 
	`LockStÜeExû±iÚ
("Exû±iÚ whg‘tšg d©¨fÜ†ock " + 
lockId
, 
e
);

245 
	}
}

254 @
VisibËFÜTe¡šg


255 
public
 
	gO±iÚ®
<
	gLockD©a
> 
	$g‘
(
LockId
 
lockId
è
throws
 
LockStÜeExû±iÚ
 {

256 
Œy
 {

257 
CÜfuRecÜd
 
»cÜd
 = 
cÜfuStÜe
.
	`qu”y
(
Çme¥aû
).
	`g‘RecÜd
(
bËName
, 
lockId
);

258 ià(
»cÜd
 !ğ
nuÎ
) {

259  
O±iÚ®
.
	`of
((
LockD©a
è
»cÜd
.
	`g‘Paylßd
());

261  
O±iÚ®
.
	`em±y
();

263 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

264 
log
.
	`”rÜ
("Lock: {} Exû±iÚ duršg g‘.", 
lockId
, 
e
);

265 
throw
 
Ãw
 
	`LockStÜeExû±iÚ
("Exû±iÚ whg‘tšg d©¨fÜ†ock " + 
lockId
, 
e
);

267 
	}
}

276 
´iv©e
 
boŞ—n
 
	$isRevoÿbË
(
LockId
 
lockId
è
throws
 
LockStÜeExû±iÚ
 {

277 
O±iÚ®
<
LockD©a
> 
lockInD©a¡Üe
 = 
	`g‘
(
lockId
);

278 ià(
lockInD©a¡Üe
.
	`isP»£Á
()) {

279 
Ob£rvedLock
 
ob£rvedLock
 = 
ob£rvedLocks
.
	`g‘
(
lockId
);

280 ià((
ob£rvedLock
 =ğ
nuÎ
è|| (!ob£rvedLock.
lockD©a
.
	`equ®s
(
lockInD©a¡Üe
.
	`g‘
()))) {

284 
log
.
	`šfo
("LockStore:‚ew observed†ock");

285 
ob£rvedLocks
.
	`put
(
lockId
, 
Ãw
 
	`Ob£rvedLock
(
lockInD©a¡Üe
.
	`g‘
(), 
In¡ªt
.
	`now
()));

286  
çl£
;

289 
boŞ—n
 
Ëa£Expœed
 = 
ob£rvedLock
.
time¡amp
.
	`isBefÜe
(
In¡ªt
.
	`now
().
	`mšusSecÚds
(
Ëa£Du¿tiÚ
));

290 
log
.
	`šfo
("LockStÜe: check iàËa£ i expœed : {}", 
Ëa£Expœed
);

291  
Ëa£Expœed
;

294 
log
.
	`šfo
("LockStÜe:†ockId {}‚Ù…»£Á iÀ¡Üe", 
lockId
.
	`g‘LockName
());

295  
Œue
;

297 
	}
}

303 @
	gD©a


304 @
AÎArgsCÚ¡ruùÜ


305 
´iv©e
 cÏs 
	cOb£rvedLock
 {

306 
LockD©a
 
	glockD©a
;

307 
In¡ªt
 
	gtime¡amp
;

	@utils/src/main/java/org/corfudb/utils/lock/persistence/LockStoreException.java

6 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g³rsi¡’û
;

14 
public
 cÏs 
	cLockStÜeExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

15 
public
 
	$LockStÜeExû±iÚ
(
SŒšg
 
mes§ge
) {

16 
	`su³r
(
mes§ge
);

19 
public
 
	$LockStÜeExû±iÚ
(
SŒšg
 
mes§ge
, 
ThrowabË
 
throwabË
) {

20 
	`su³r
(
mes§ge
, 
throwabË
);

21 
	}
}

	@utils/src/main/java/org/corfudb/utils/lock/states/HasLeaseState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLock
;

6 
impÜt
 
	gjava
.
	gtime
.
	gIn¡ªt
;

7 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gFutu»
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdFutu»
;

10 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

21 @
Slf4j


22 
public
 cÏs 
	cHasL—£S‹
 
ex‹nds
 
	mLockS‹
 {

26 
´iv©e
 
	mDURATION_BETWEEN_LEASE_CHECKS
 = 60;

30 
´iv©e
 
	mO±iÚ®
<
	mScheduËdFutu»
<?>> 
	mËa£R’ew®Futu»
 = 
O±iÚ®
.
em±y
();

33 
´iv©e
 
	mO±iÚ®
<
	mScheduËdFutu»
<?>> 
	mËa£MÚ™ÜFutu»
 = 
O±iÚ®
.
em±y
();

37 
´iv©e
 vŞ©
	mO±iÚ®
<
	mIn¡ªt
> 
	mËa£Time
 = 
O±iÚ®
.
em±y
();

44 
public
 
	$HasL—£S‹
(
Lock
 
lock
) {

45 
	`su³r
(
lock
);

55 @
Ov”ride


56 
public
 
O±iÚ®
<
LockS‹
> 
	$´oûssEv’t
(
LockEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
 {

57 
log
.
	`debug
("Lock: {}†ockƒv’t:{} iÀ¡©e:{}", 
lock
.
	`g‘LockId
(), 
ev’t
, 
	`g‘Ty³
());

58 
ev’t
) {

59 
LEASE_ACQUIRED
: {

62 
log
.
	`w¬n
("Lock: {} uÃx³ùed†ockƒv’t:{} iÀ¡©e:{}", 
lock
.
	`g‘LockId
(), 
ev’t
, 
	`g‘Ty³
());

63 
Ëa£Time
 = 
O±iÚ®
.
	`of
(
In¡ªt
.
	`now
());

64  
O±iÚ®
.
	`em±y
();

66 
LEASE_RENEWED
: {

69 
Ëa£Time
 = 
O±iÚ®
.
	`of
(
In¡ªt
.
	`now
());

70  
O±iÚ®
.
	`em±y
();

72 
LEASE_REVOKED
:

74 
LEASE_EXPIRED
: {

76 
Ëa£Time
 = 
O±iÚ®
.
	`em±y
();

77  
O±iÚ®
.
	`of
(
lock
.
	`g‘S‹s
().
	`g‘
(
LockS‹Ty³
.
NO_LEASE
));

79 
UNRECOVERABLE_ERROR
: {

80 
log
.
	`”rÜ
("Lock: {} uÃx³ùed†ockƒv’t:{} iÀ¡©e:{}", 
lock
.
	`g‘LockId
(), 
ev’t
, 
	`g‘Ty³
());

81 
Ëa£Time
 = 
O±iÚ®
.
	`em±y
();

82  
O±iÚ®
.
	`of
(
lock
.
	`g‘S‹s
().
	`g‘
(
LockS‹Ty³
.
STOPPED
));

85 
log
.
	`”rÜ
("UÃx³ùed†ockƒv’ˆ{} wh’ iÀ¡©{}.", 
ev’t
, 
	`g‘Ty³
());

86 
throw
 
Ãw
 
	`IÎeg®T¿ns™iÚExû±iÚ
(
ev’t
, 
	`g‘Ty³
());

89 
	}
}

103 @
Ov”ride


104 
public
 
	$ÚEÁry
(
LockS‹
 
äom
) {

105 
	`nÙify
((è-> 
lock
.
	`g‘LockLi¡’”
().
	`lockAcquœed
Öock.
	`g‘LockId
()), "Lock Acquired");

107 
Ëa£Time
 = 
O±iÚ®
.
	`of
(
In¡ªt
.
	`now
());

108 
	`¡¬tL—£R’ew®
();

109 
	`¡¬tL—£MÚ™Ü
();

110 
	}
}

124 @
Ov”ride


125 
public
 
	$ÚEx™
(
LockS‹
 
to
) {

126 
	`nÙify
((è-> 
lock
.
	`g‘LockLi¡’”
().
	`lockRevoked
Öock.
	`g‘LockId
()), "Lock Revoked");

128 
Ëa£Time
 = 
O±iÚ®
.
	`em±y
();

129 
	`¡İL—£R’ew®
();

130 
	`¡İL—£MÚ™Ü
();

131 
	}
}

133 @
Ov”ride


134 
public
 
LockS‹Ty³
 
	$g‘Ty³
() {

135  
LockS‹Ty³
.
HAS_LEASE
;

136 
	}
}

147 
´iv©e
 
	$nÙify
(
RuÂabË
 
ruÂabË
, 
SŒšg
 
ÿÎback
) {

148 
Futu»
<?> 
skFutu»
 = 
lockLi¡’”ExecutÜ
.
	`subm™
(
ruÂabË
);

149 
skScheduËr
.
	`scheduË
(() -> {

150 ià(!
skFutu»
.
	`isDÚe
()) {

151 
skFutu»
.
	`ÿnûl
(
Œue
);

152 
log
.
	`”rÜ
("Lock: {} {} c®lback cªûÎed dutØtimeout!", 
lock
.
	`g‘LockId
(), 
ÿÎback
);

154 }, 
MaxTimeFÜNÙifiÿtiÚLi¡’”Proûssšg
, 
TimeUn™
.
SECONDS
);

155 
	}
}

162 
´iv©e
 
	$¡¬tL—£R’ew®
() {

164 
	`synchrÚized
 (
Ëa£R’ew®Futu»
) {

165 ià(!
Ëa£R’ew®Futu»
.
	`isP»£Á
(è||†—£R’ew®Futu».
	`g‘
().
	`isDÚe
())

166 
Ëa£R’ew®Futu»
 = 
O±iÚ®
.
	`of
(
skScheduËr
.
	`scheduËW™hFixedD–ay
(

168 
Œy
 {

169 ià(
lockStÜe
.
	`»Ãw
(
lock
.
	`g‘LockId
())) {

170 
lock
.
	`šput
(
LockEv’t
.
LEASE_RENEWED
);

171 
Ëa£Time
 = 
O±iÚ®
.
	`of
(
In¡ªt
.
	`now
());

173 
log
.
	`šfo
("Lock: {}†—£„evoked fÜ†ock {}", 
lock
.
	`g‘LockId
());

174 
lock
.
	`šput
(
LockEv’t
.
LEASE_REVOKED
);

176 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

177 
log
.
	`”rÜ
("Lock: {} could‚Ù„’ew†—£ fÜ†ock {}", 
lock
.
	`g‘LockId
(), 
e
);

181 
Du¿tiÚB‘w“nL—£R’ew®s
,

182 
TimeUn™
.
SECONDS


186 
	}
}

192 
´iv©e
 
	$¡¬tL—£MÚ™Ü
() {

193 
	`synchrÚized
 (
Ëa£MÚ™ÜFutu»
) {

194 ià(!
Ëa£MÚ™ÜFutu»
.
	`isP»£Á
(è||†—£MÚ™ÜFutu».
	`g‘
().
	`isDÚe
())

195 
Ëa£MÚ™ÜFutu»
 = 
O±iÚ®
.
	`of
(
skScheduËr
.
	`scheduËW™hFixedD–ay
(

197 ià(
Ëa£Time
.
	`isP»£Á
(è&&†—£Time.
	`g‘
().
	`isBefÜe
(
In¡ªt
.
	`now
().
	`mšusSecÚds
(
Lock
.
Ëa£Du¿tiÚ
))) {

198 
log
.
	`šfo
("Lock: {}†—£ƒxpœed fÜ†ock {}", 
lock
.
	`g‘LockId
());

199 
lock
.
	`šput
(
LockEv’t
.
LEASE_EXPIRED
);

204 
DURATION_BETWEEN_LEASE_CHECKS
,

205 
TimeUn™
.
SECONDS


209 
	}
}

214 
´iv©e
 
	$¡İL—£R’ew®
() {

215 
	`synchrÚized
 (
Ëa£R’ew®Futu»
) {

216 ià(
Ëa£R’ew®Futu»
.
	`isP»£Á
(è&& !Ëa£R’ew®Futu».
	`g‘
().
	`isDÚe
()) {

217 
boŞ—n
 
ÿnûÎed
 = 
Ëa£R’ew®Futu»
.
	`g‘
().
	`ÿnûl
(
çl£
);

218 ià(!
ÿnûÎed
) {

219 
log
.
	`”rÜ
("Lock: Could‚Ù cªûÈthfutu» fÜ†—£„’ew®!!!", 
lock
.
	`g‘LockId
());

223 
	}
}

228 
´iv©e
 
	$¡İL—£MÚ™Ü
() {

229 
	`synchrÚized
 (
Ëa£MÚ™ÜFutu»
) {

230 ià(
Ëa£MÚ™ÜFutu»
.
	`isP»£Á
(è&& !Ëa£MÚ™ÜFutu».
	`g‘
().
	`isDÚe
()) {

231 
boŞ—n
 
ÿnûÎed
 = 
Ëa£MÚ™ÜFutu»
.
	`g‘
().
	`ÿnûl
(
çl£
);

232 ià(!
ÿnûÎed
) {

233 
log
.
	`”rÜ
("Lock: {} Could‚Ù cªûÈthfutu» fÜ†—£ mÚ™Ü!!!", 
lock
.
	`g‘LockId
());

237 
	}
}

	@utils/src/main/java/org/corfudb/utils/lock/states/IllegalTransitionException.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

10 
public
 cÏs 
	cIÎeg®T¿ns™iÚExû±iÚ
 
ex‹nds
 
	mExû±iÚ
 {

18 
public
 
	$IÎeg®T¿ns™iÚExû±iÚ
(
LockEv’t
 
ev’t
, 
LockS‹Ty³
 
¡©eTy³
) {

19 
	`su³r
(
SŒšg
.
	`fÜm©
("IÎeg®¿ns™iÚ fÜƒv’ˆ% whš s‹ %s", 
ev’t
, 
¡©eTy³
));

21 
	}
}

	@utils/src/main/java/org/corfudb/utils/lock/states/LockEvent.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

11 
public
 
	eLockEv’t
 {

12 
	mLEASE_ACQUIRED
,

13 
	mLEASE_RENEWED
,

14 
	mLEASE_REVOKED
,

15 
	mLEASE_EXPIRED
,

16 
	mUNRECOVERABLE_ERROR


	@utils/src/main/java/org/corfudb/utils/lock/states/LockState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

3 
impÜt
 
	glombok
.
	gS‘‹r
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLock
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g³rsi¡’û
.
	gLockStÜe
;

7 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gExecutÜS”viû
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdExecutÜS”viû
;

17 
public
 
ab¡¿ù
 cÏs 
	cLockS‹
 {

20 @
S‘‹r


21 
public
 
	mDu¿tiÚB‘w“nL—£R’ew®s
 = 60;

24 @
S‘‹r


25 
public
 
	mMaxTimeFÜNÙifiÿtiÚLi¡’”Proûssšg
 = 60;

28 
´Ùeùed
 
fš®
 
Lock
 
	mlock
;

30 
´Ùeùed
 
fš®
 
LockStÜe
 
	mlockStÜe
;

32 
´Ùeùed
 
fš®
 
ScheduËdExecutÜS”viû
 
	mskScheduËr
;

34 
´Ùeùed
 
fš®
 
ExecutÜS”viû
 
	mlockLi¡’”ExecutÜ
;

36 
public
 
	$LockS‹
(
Lock
 
lock
) {

37 
this
.
lock
 =†ock;

38 
this
.
lockStÜe
 = 
lock
.
	`g‘Cl›ÁCÚ‹xt
().
	`g‘LockStÜe
();

39 
this
.
skScheduËr
 = 
lock
.
	`g‘Cl›ÁCÚ‹xt
().
	`g‘TaskScheduËr
();

40 
this
.
lockLi¡’”ExecutÜ
 = 
lock
.
	`g‘Cl›ÁCÚ‹xt
().
	`g‘LockLi¡’”ExecutÜ
();

46 
public
 
ab¡¿ù
 
LockS‹Ty³
 
	`g‘Ty³
();

54 
public
 
ab¡¿ù
 
O±iÚ®
<
LockS‹
> 
	$´oûssEv’t
(
LockEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
;

61 
public
 
	$ÚEÁry
(
LockS‹
 
äom
) {

62 
	}
}

69 
public
 
	$ÚEx™
(
LockS‹
 
to
) {

70 
	}
}

75 
public
 
	$ş—r
() {

76 
	}
}

	@utils/src/main/java/org/corfudb/utils/lock/states/LockStateType.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

11 
public
 
	eLockS‹Ty³
 {

12 
	mNO_LEASE
,

13 
	mHAS_LEASE
,

14 
	mSTOPPED


	@utils/src/main/java/org/corfudb/utils/lock/states/NoLeaseState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

3 
impÜt
 
	gcom
.
	ggoogË
.
	gcommÚ
.
	gªnÙ©iÚs
.
	gVisibËFÜTe¡šg
;

4 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

5 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLock
;

7 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

8 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gScheduËdFutu»
;

9 
impÜt
 
	gjava
.
	gut
.
	gcÚcu¼’t
.
	gTimeUn™
;

20 @
Slf4j


21 
public
 cÏs 
	cNoL—£S‹
 
ex‹nds
 
	mLockS‹
 {

23 
public
 
	$NoL—£S‹
(
Lock
 
lock
) {

24 
	`su³r
(
lock
);

34 @
Ov”ride


35 
public
 
O±iÚ®
<
LockS‹
> 
	$´oûssEv’t
(
LockEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
 {

36 
log
.
	`debug
("Lock: {}†ockƒv’t:{} iÀ¡©e:{}", 
lock
.
	`g‘LockId
(), 
ev’t
, 
	`g‘Ty³
());

37 
ev’t
) {

38 
LEASE_ACQUIRED
: {

40  
O±iÚ®
.
	`of
(
lock
.
	`g‘S‹s
().
	`g‘
(
LockS‹Ty³
.
HAS_LEASE
));

42 
LEASE_RENEWED
: {

44 
log
.
	`w¬n
("Lock: {}„’ewedƒv’ˆ¬rived†©e!", 
lock
.
	`g‘LockId
());

45  
O±iÚ®
.
	`em±y
();

47 
LEASE_REVOKED
: {

49 
	`acquœeL—£
();

50  
O±iÚ®
.
	`em±y
();

52 
LEASE_EXPIRED
: {

53 
log
.
	`w¬n
("Lock: {}†ock wa expœed by†oÿÈmÚ™Ü!", 
lock
.
	`g‘LockId
());

54  
O±iÚ®
.
	`em±y
();

56 
UNRECOVERABLE_ERROR
: {

57 
log
.
	`”rÜ
("Lock: {} uÃx³ùed†ockƒv’t:{} iÀ¡©e:{}", 
lock
.
	`g‘LockId
(), 
ev’t
, 
	`g‘Ty³
());

58  
O±iÚ®
.
	`of
(
lock
.
	`g‘S‹s
().
	`g‘
(
LockS‹Ty³
.
STOPPED
));

61 
log
.
	`”rÜ
("UÃx³ùed†ockƒv’ˆ{} wh’ iÀ¡©{}.", 
ev’t
, 
	`g‘Ty³
());

62 
throw
 
Ãw
 
	`IÎeg®T¿ns™iÚExû±iÚ
(
ev’t
, 
	`g‘Ty³
());

64 
	}
}

70 @
Ov”ride


71 
public
 
	$ÚEÁry
(
LockS‹
 
äom
è{
	}
}

78 @
Ov”ride


79 
public
 
	$ÚEx™
(
LockS‹
 
to
è{
	}
}

81 @
Ov”ride


82 
public
 
LockS‹Ty³
 
	$g‘Ty³
() {

83  
LockS‹Ty³
.
NO_LEASE
;

84 
	}
}

91 
´iv©e
 
	$acquœeL—£
() {

92 
Œy
 {

93 ià(
lockStÜe
.
	`acquœe
(
lock
.
	`g‘LockId
())) {

94 
lock
.
	`šput
(
LockEv’t
.
LEASE_ACQUIRED
);

96 } 
	`ÿtch
 (
Exû±iÚ
 
e
) {

97 
log
.
	`”rÜ
("Lock: {} could‚Ù‡cquœËa£ {}", 
lock
.
	`g‘LockId
(), 
e
);

99 
	}
}

	@utils/src/main/java/org/corfudb/utils/lock/states/StoppedState.java

1 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	g¡©es
;

3 
impÜt
 
	glombok
..
¦f4j
.
Slf4j
;

4 
impÜt
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLock
;

6 
impÜt
 
	gjava
.
	gut
.
	gO±iÚ®
;

15 @
Slf4j


16 
public
 cÏs 
	cStİ³dS‹
 
ex‹nds
 
	mLockS‹
 {

18 
public
 
	$Stİ³dS‹
(
Lock
 
lock
) {

19 
	`su³r
(
lock
);

29 @
Ov”ride


30 
public
 
O±iÚ®
<
LockS‹
> 
	$´oûssEv’t
(
LockEv’t
 
ev’t
è
throws
 
IÎeg®T¿ns™iÚExû±iÚ
 {

31 
ev’t
) {

32 
LEASE_ACQUIRED
:

33 
LEASE_RENEWED
:

34 
LEASE_REVOKED
:

35 
LEASE_EXPIRED
:

36 
UNRECOVERABLE_ERROR
:

37  
O±iÚ®
.
	`em±y
();

39 
log
.
	`w¬n
("UÃx³ùed†ockƒv’ˆ{} wh’ iÀ¡©{}.", 
ev’t
, 
	`g‘Ty³
());

40 
throw
 
Ãw
 
	`IÎeg®T¿ns™iÚExû±iÚ
(
ev’t
, 
	`g‘Ty³
());

42 
	}
}

45 @
Ov”ride


46 
public
 
	$ÚEÁry
(
LockS‹
 
äom
) {

47 
	}
}

50 @
Ov”ride


51 
public
 
	$ÚEx™
(
LockS‹
 
to
) {

52 
	}
}

55 @
Ov”ride


56 
public
 
LockS‹Ty³
 
	$g‘Ty³
() {

57  
LockS‹Ty³
.
STOPPED
;

58 
	}
}

	@utils/target/generated-sources/org/corfudb/utils/CommonTypes.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
;

6 
public
 
fš®
 cÏs 
	cCommÚTy³s
 {

7 
´iv©e
 
	$CommÚTy³s
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
UuidOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
g‘Msb
();

29 
g‘Lsb
();

34 
public
 
fš®
 
şass
 
Uuid
 
ex‹nds


35 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


37 
	gUuidOrBud”
 {

39 
´iv©e
 
Uuid
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

40 
su³r
(
bud”
);

42 
´iv©e
 
Uuid
() {

43 
	gmsb_
 = 0L;

44 
	glsb_
 = 0L;

47 @
	gjava
.
	gÏng
.
Ov”ride


48 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


49 
g‘UnknownF›lds
() {

50  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

52 
´iv©e
 
Uuid
(

53 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

54 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

55 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

56 
this
();

57 
	gmubË_b™F›ld0_
 = 0;

58 
	gŒy
 {

59 
boŞ—n
 
	gdÚe
 = 
çl£
;

60 !
	gdÚe
) {

61 
	gg
 = 
šput
.
»adTag
();

62 
	gg
) {

64 
dÚe
 = 
Œue
;

67 ià(!
šput
.
skF›ld
(
g
)) {

68 
dÚe
 = 
Œue
;

74 
msb_
 = 
šput
.
»adFixed64
();

79 
lsb_
 = 
šput
.
»adFixed64
();

84 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

85 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

86 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

87 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

88 
e
).
£tUnfšishedMes§ge
(
this
);

89 } 
	gfš®ly
 {

90 
makeEx‹nsiÚsImmubË
();

93 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


94 
g‘DesütÜ
() {

95  
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_desütÜ
;

98 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


99 
š‹º®G‘F›ldAcûssÜTabË
() {

100  
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_f›ldAcûssÜTabË


101 .
’su»F›ldAcûssÜsIn™Ÿlized
(

102 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
şass
, org.cÜfudb.uts.CommÚTy³s.Uuid.
Bud”
.class);

105 
public
 
fš®
 
	gMSB_FIELD_NUMBER
 = 1;

106 
´iv©e
 
	gmsb_
;

110 
public
 
g‘Msb
() {

111  
	gmsb_
;

114 
public
 
fš®
 
	gLSB_FIELD_NUMBER
 = 2;

115 
´iv©e
 
	glsb_
;

119 
public
 
g‘Lsb
() {

120  
	glsb_
;

123 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

124 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

125 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

126 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

127 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

129 
	gmemoizedIsIn™Ÿlized
 = 1;

130  
	gŒue
;

133 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

134 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

135 ià(
	gmsb_
 != 0L) {

136 
ouut
.
wr™eFixed64
(1, 
msb_
);

138 ià(
	glsb_
 != 0L) {

139 
ouut
.
wr™eFixed64
(2, 
lsb_
);

143 
public
 
g‘S”ŸlizedSize
() {

144 
	gsize
 = 
memoizedSize
;

145 ià(
	gsize
 !ğ-1è 
size
;

147 
	gsize
 = 0;

148 ià(
	gmsb_
 != 0L) {

149 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


150 .
compu‹Fixed64Size
(1, 
msb_
);

152 ià(
	glsb_
 != 0L) {

153 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


154 .
compu‹Fixed64Size
(2, 
lsb_
);

156 
	gmemoizedSize
 = 
size
;

157  
	gsize
;

160 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

161 @
	gjava
.
	gÏng
.
Ov”ride


162 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

163 ià(
	gobj
 =ğ
this
) {

164  
Œue
;

166 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
)) {

167  
	gsu³r
.
equ®s
(
obj
);

169 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	gÙh”
 = (
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.Uuidè
obj
;

171 
boŞ—n
 
	g»suÉ
 = 
Œue
;

172 
	g»suÉ
 = 
»suÉ
 && (
g‘Msb
()

173 =ğ
Ùh”
.
g‘Msb
());

174 
	g»suÉ
 = 
»suÉ
 && (
g‘Lsb
()

175 =ğ
Ùh”
.
g‘Lsb
());

176  
	g»suÉ
;

179 @
	gjava
.
	gÏng
.
Ov”ride


180 
public
 
hashCode
() {

181 ià(
	gmemoizedHashCode
 != 0) {

182  
memoizedHashCode
;

184 
	ghash
 = 41;

185 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

186 
	ghash
 = (37 * 
hash
è+ 
MSB_FIELD_NUMBER
;

187 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

188 
g‘Msb
());

189 
	ghash
 = (37 * 
hash
è+ 
LSB_FIELD_NUMBER
;

190 
	ghash
 = (53 * 
hash
è+ 
com
.
googË
.
´Ùobuf
.
IÁ”Çl
.
hashLÚg
(

191 
g‘Lsb
());

192 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

193 
	gmemoizedHashCode
 = 
hash
;

194  
	ghash
;

197 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(

198 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

199 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

200  
	gPARSER
.
·r£From
(
d©a
);

202 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(

203 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

204 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

205 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

206  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

208 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(
by‹
[] 
d©a
)

209 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

210  
	gPARSER
.
·r£From
(
d©a
);

212 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(

213 
by‹
[] 
d©a
,

214 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

215 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

216  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

218 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

219 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

220  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


221 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

223 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(

224 
java
.
io
.
IÅutSŒ—m
 
šput
,

225 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

226 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

227  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


228 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

230 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

231 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

232  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


233 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

235 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£D–im™edFrom
(

236 
java
.
io
.
IÅutSŒ—m
 
šput
,

237 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

238 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

239  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


240 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

242 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(

243 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

244 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

245  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


246 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

248 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
·r£From
(

249 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

250 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

251 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

252  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


253 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

256 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

257 
public
 
Bud”
 
ÃwBud”
() {

258  
	gDEFAULT_INSTANCE
.
toBud”
();

260 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
 
´ÙÙy³
) {

261  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

263 
public
 
Bud”
 
toBud”
() {

264  
	gthis
 =ğ
DEFAULT_INSTANCE


265 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

268 @
	gjava
.
	gÏng
.
Ov”ride


269 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

270 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

271 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

272  
	gbud”
;

277 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


278 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


280 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuidOrBud”
 {

281 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


282 
g‘DesütÜ
() {

283  
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_desütÜ
;

286 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


287 
š‹º®G‘F›ldAcûssÜTabË
() {

288  
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_f›ldAcûssÜTabË


289 .
’su»F›ldAcûssÜsIn™Ÿlized
(

290 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
şass
, org.cÜfudb.uts.CommÚTy³s.Uuid.
Bud”
.class);

294 
´iv©e
 
Bud”
() {

295 
maybeFÜûBud”In™Ÿliz©iÚ
();

298 
´iv©e
 
Bud”
(

299 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

300 
su³r
(
·»Á
);

301 
maybeFÜûBud”In™Ÿliz©iÚ
();

303 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

304 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


305 .
	g®waysU£F›ldBud”s
) {

308 
public
 
Bud”
 
ş—r
() {

309 
	gsu³r
.
ş—r
();

310 
	gmsb_
 = 0L;

312 
	glsb_
 = 0L;

314  
	gthis
;

317 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


318 
g‘DesütÜFÜTy³
() {

319  
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_desütÜ
;

322 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
g‘DeçuÉIn¡ªûFÜTy³
() {

323  
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
.
g‘DeçuÉIn¡ªû
();

326 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
bud
() {

327 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	g»suÉ
 = 
budP¬tŸl
();

328 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

329 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

331  
	g»suÉ
;

334 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
budP¬tŸl
() {

335 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.Uuid(
this
);

336 
	g»suÉ
.
	gmsb_
 = 
msb_
;

337 
	g»suÉ
.
	glsb_
 = 
lsb_
;

338 
ÚBut
();

339  
	g»suÉ
;

342 
public
 
Bud”
 
şÚe
() {

343  (
	gBud”
è
	gsu³r
.
şÚe
();

345 
public
 
Bud”
 
£tF›ld
(

346 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

347 
Objeù
 
v®ue
) {

348  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

350 
public
 
Bud”
 
ş—rF›ld
(

351 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

352  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

354 
public
 
Bud”
 
ş—rOÃof
(

355 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

356  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

358 
public
 
Bud”
 
£tR•—‹dF›ld
(

359 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

360 
šdex
, 
Objeù
 
v®ue
) {

361  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

363 
public
 
Bud”
 
addR•—‹dF›ld
(

364 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

365 
Objeù
 
v®ue
) {

366  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

368 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

369 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
) {

370  
m”geFrom
((
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
)
Ùh”
);

372 
	gsu³r
.
m”geFrom
(
Ùh”
);

373  
	gthis
;

377 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
 
Ùh”
) {

378 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
g‘DeçuÉIn¡ªû
()è 
this
;

379 ià(
	gÙh”
.
g‘Msb
() != 0L) {

380 
£tMsb
(
Ùh”
.
g‘Msb
());

382 ià(
	gÙh”
.
g‘Lsb
() != 0L) {

383 
£tLsb
(
Ùh”
.
g‘Lsb
());

385 
ÚChªged
();

386  
	gthis
;

389 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

390  
	gŒue
;

393 
public
 
Bud”
 
m”geFrom
(

394 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

395 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

396 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

397 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	g·r£dMes§ge
 = 
nuÎ
;

398 
	gŒy
 {

399 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

400 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

401 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
è
e
.
g‘UnfšishedMes§ge
();

402 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

403 } 
	gfš®ly
 {

404 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

405 
m”geFrom
(
·r£dMes§ge
);

408  
	gthis
;

411 
´iv©e
 
	gmsb_
 ;

415 
public
 
g‘Msb
() {

416  
	gmsb_
;

421 
public
 
Bud”
 
£tMsb
(
v®ue
) {

423 
	gmsb_
 = 
v®ue
;

424 
ÚChªged
();

425  
	gthis
;

430 
public
 
Bud”
 
ş—rMsb
() {

432 
	gmsb_
 = 0L;

433 
ÚChªged
();

434  
	gthis
;

437 
´iv©e
 
	glsb_
 ;

441 
public
 
g‘Lsb
() {

442  
	glsb_
;

447 
public
 
Bud”
 
£tLsb
(
v®ue
) {

449 
	glsb_
 = 
v®ue
;

450 
ÚChªged
();

451  
	gthis
;

456 
public
 
Bud”
 
ş—rLsb
() {

458 
	glsb_
 = 0L;

459 
ÚChªged
();

460  
	gthis
;

462 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

463 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

464  
	gthis
;

467 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

468 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

469  
	gthis
;

477 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	gDEFAULT_INSTANCE
;

479 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
();

482 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
g‘DeçuÉIn¡ªû
() {

483  
	gDEFAULT_INSTANCE
;

486 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
>

487 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
Uuid
>() {

488 
public
 
Uuid
 
·r£P¬tŸlFrom
(

489 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

490 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

491 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

492  
Ãw
 
Uuid
(
šput
, 
ex‹nsiÚRegi¡ry
);

496 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
> 
·r£r
() {

497  
	gPARSER
;

500 @
	gjava
.
	gÏng
.
Ov”ride


501 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gUuid
> 
g‘P¬£rFÜTy³
() {

502  
	gPARSER
;

505 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
g‘DeçuÉIn¡ªûFÜTy³
() {

506  
	gDEFAULT_INSTANCE
;

511 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


512 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_desütÜ
;

513 
´iv©e
 
fš®


514 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


515 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_f›ldAcûssÜTabË
;

517 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


518 
	$g‘DesütÜ
() {

519  
desütÜ
;

520 
	}
}

521 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


522 
	gdesütÜ
;

524 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

529 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

530 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

531 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

532 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

533 
desütÜ
 = 
roÙ
;

534  
	gnuÎ
;

537 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


538 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

539 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

540 }, 
assigÃr
);

541 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_desütÜ
 =

542 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

543 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_f›ldAcûssÜTabË
 = 
Ãw


544 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

545 
š‹º®_¡©ic_Üg_cÜfudb_uts_Uuid_desütÜ
,

546 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "Msb", "Lsb", });

	@utils/target/generated-sources/org/corfudb/utils/lock/LockDataTypes.java

4 
·ckage
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
;

6 
public
 
fš®
 cÏs 
	cLockD©aTy³s
 {

7 
´iv©e
 
	$LockD©aTy³s
() {}

8 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

9 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
»gi¡ry
) {

10 
	}
}

12 
public
 
	$»gi¡”AÎEx‹nsiÚs
(

13 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
»gi¡ry
) {

14 
	`»gi¡”AÎEx‹nsiÚs
(

15 (
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
è
»gi¡ry
);

16 
	}
}

17 
public
 
š‹rçû
 
LockIdOrBud”
 
ex‹nds


19 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

24 
	gjava
.
	gÏng
.
SŒšg
 
g‘LockGroup
();

28 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


29 
g‘LockGroupBy‹s
();

34 
	gjava
.
	gÏng
.
SŒšg
 
g‘LockName
();

38 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


39 
g‘LockNameBy‹s
();

48 
public
 
fš®
 
şass
 
LockId
 
ex‹nds


49 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


51 
	gLockIdOrBud”
 {

53 
´iv©e
 
LockId
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

54 
su³r
(
bud”
);

56 
´iv©e
 
LockId
() {

57 
	glockGroup_
 = "";

58 
	glockName_
 = "";

61 @
	gjava
.
	gÏng
.
Ov”ride


62 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


63 
g‘UnknownF›lds
() {

64  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

66 
´iv©e
 
LockId
(

67 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

68 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

69 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

70 
this
();

71 
	gmubË_b™F›ld0_
 = 0;

72 
	gŒy
 {

73 
boŞ—n
 
	gdÚe
 = 
çl£
;

74 !
	gdÚe
) {

75 
	gg
 = 
šput
.
»adTag
();

76 
	gg
) {

78 
dÚe
 = 
Œue
;

81 ià(!
šput
.
skF›ld
(
g
)) {

82 
dÚe
 = 
Œue
;

87 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

89 
	glockGroup_
 = 
s
;

93 
java
.
Ïng
.
SŒšg
 
s
 = 
šput
.
»adSŒšgRequœeUtf8
();

95 
	glockName_
 = 
s
;

100 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

101 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

102 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

103 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

104 
e
).
£tUnfšishedMes§ge
(
this
);

105 } 
	gfš®ly
 {

106 
makeEx‹nsiÚsImmubË
();

109 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


110 
g‘DesütÜ
() {

111  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_desütÜ
;

114 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


115 
š‹º®G‘F›ldAcûssÜTabË
() {

116  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_f›ldAcûssÜTabË


117 .
’su»F›ldAcûssÜsIn™Ÿlized
(

118 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
şass
, org.cÜfudb.uts.lock.LockD©aTy³s.LockId.
Bud”
.class);

121 
public
 
fš®
 
	gLOCK_GROUP_FIELD_NUMBER
 = 1;

122 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	glockGroup_
;

126 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘LockGroup
() {

127 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockGroup_
;

128 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

129  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

131 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

132 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

133 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

134 
	glockGroup_
 = 
s
;

135  
	gs
;

141 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


142 
g‘LockGroupBy‹s
() {

143 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockGroup_
;

144 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

145 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

146 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

147 (
java
.
Ïng
.
SŒšg
è
»f
);

148 
	glockGroup_
 = 
b
;

149  
	gb
;

151  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

155 
public
 
fš®
 
	gLOCK_NAME_FIELD_NUMBER
 = 2;

156 
´iv©e
 vŞ©
	gjava
.
	gÏng
.
Objeù
 
	glockName_
;

160 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘LockName
() {

161 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockName_
;

162 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

163  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

165 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

166 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

167 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

168 
	glockName_
 = 
s
;

169  
	gs
;

175 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


176 
g‘LockNameBy‹s
() {

177 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockName_
;

178 ià(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
) {

179 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

180 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

181 (
java
.
Ïng
.
SŒšg
è
»f
);

182 
	glockName_
 = 
b
;

183  
	gb
;

185  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

189 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

190 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

191 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

192 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

193 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

195 
	gmemoizedIsIn™Ÿlized
 = 1;

196  
	gŒue
;

199 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

200 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

201 ià(!
g‘LockGroupBy‹s
().
isEm±y
()) {

202 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 1, 
lockGroup_
);

204 ià(!
g‘LockNameBy‹s
().
isEm±y
()) {

205 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
wr™eSŒšg
(
ouut
, 2, 
lockName_
);

209 
public
 
g‘S”ŸlizedSize
() {

210 
	gsize
 = 
memoizedSize
;

211 ià(
	gsize
 !ğ-1è 
size
;

213 
	gsize
 = 0;

214 ià(!
g‘LockGroupBy‹s
().
isEm±y
()) {

215 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(1, 
lockGroup_
);

217 ià(!
g‘LockNameBy‹s
().
isEm±y
()) {

218 
	gsize
 +ğ
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
compu‹SŒšgSize
(2, 
lockName_
);

220 
	gmemoizedSize
 = 
size
;

221  
	gsize
;

224 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

225 @
	gjava
.
	gÏng
.
Ov”ride


226 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

227 ià(
	gobj
 =ğ
this
) {

228  
Œue
;

230 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
)) {

231  
	gsu³r
.
equ®s
(
obj
);

233 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	gÙh”
 = (
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.LockIdè
obj
;

235 
boŞ—n
 
	g»suÉ
 = 
Œue
;

236 
	g»suÉ
 = 
»suÉ
 && 
g‘LockGroup
()

237 .
equ®s
(
Ùh”
.
g‘LockGroup
());

238 
	g»suÉ
 = 
»suÉ
 && 
g‘LockName
()

239 .
equ®s
(
Ùh”
.
g‘LockName
());

240  
	g»suÉ
;

243 @
	gjava
.
	gÏng
.
Ov”ride


244 
public
 
hashCode
() {

245 ià(
	gmemoizedHashCode
 != 0) {

246  
memoizedHashCode
;

248 
	ghash
 = 41;

249 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

250 
	ghash
 = (37 * 
hash
è+ 
LOCK_GROUP_FIELD_NUMBER
;

251 
	ghash
 = (53 * 
hash
è+ 
g‘LockGroup
().
hashCode
();

252 
	ghash
 = (37 * 
hash
è+ 
LOCK_NAME_FIELD_NUMBER
;

253 
	ghash
 = (53 * 
hash
è+ 
g‘LockName
().
hashCode
();

254 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

255 
	gmemoizedHashCode
 = 
hash
;

256  
	ghash
;

259 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(

260 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

261 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

262  
	gPARSER
.
·r£From
(
d©a
);

264 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(

265 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

266 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

267 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

268  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

270 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(
by‹
[] 
d©a
)

271 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

272  
	gPARSER
.
·r£From
(
d©a
);

274 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(

275 
by‹
[] 
d©a
,

276 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

277 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

278  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

280 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

281 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

282  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


283 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

285 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(

286 
java
.
io
.
IÅutSŒ—m
 
šput
,

287 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

288 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

289  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


290 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

292 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

293 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

294  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


295 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

297 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£D–im™edFrom
(

298 
java
.
io
.
IÅutSŒ—m
 
šput
,

299 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

300 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

301  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


302 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

304 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(

305 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

306 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

307  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


308 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

310 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
·r£From
(

311 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

312 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

313 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

314  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


315 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

318 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

319 
public
 
Bud”
 
ÃwBud”
() {

320  
	gDEFAULT_INSTANCE
.
toBud”
();

322 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
 
´ÙÙy³
) {

323  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

325 
public
 
Bud”
 
toBud”
() {

326  
	gthis
 =ğ
DEFAULT_INSTANCE


327 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

330 @
	gjava
.
	gÏng
.
Ov”ride


331 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

332 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

333 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

334  
	gbud”
;

343 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


344 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


346 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockIdOrBud”
 {

347 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


348 
g‘DesütÜ
() {

349  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_desütÜ
;

352 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


353 
š‹º®G‘F›ldAcûssÜTabË
() {

354  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_f›ldAcûssÜTabË


355 .
’su»F›ldAcûssÜsIn™Ÿlized
(

356 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
şass
, org.cÜfudb.uts.lock.LockD©aTy³s.LockId.
Bud”
.class);

360 
´iv©e
 
Bud”
() {

361 
maybeFÜûBud”In™Ÿliz©iÚ
();

364 
´iv©e
 
Bud”
(

365 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

366 
su³r
(
·»Á
);

367 
maybeFÜûBud”In™Ÿliz©iÚ
();

369 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

370 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


371 .
	g®waysU£F›ldBud”s
) {

374 
public
 
Bud”
 
ş—r
() {

375 
	gsu³r
.
ş—r
();

376 
	glockGroup_
 = "";

378 
	glockName_
 = "";

380  
	gthis
;

383 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


384 
g‘DesütÜFÜTy³
() {

385  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_desütÜ
;

388 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
g‘DeçuÉIn¡ªûFÜTy³
() {

389  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
.
g‘DeçuÉIn¡ªû
();

392 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
bud
() {

393 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	g»suÉ
 = 
budP¬tŸl
();

394 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

395 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

397  
	g»suÉ
;

400 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
budP¬tŸl
() {

401 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.LockId(
this
);

402 
	g»suÉ
.
	glockGroup_
 = 
lockGroup_
;

403 
	g»suÉ
.
	glockName_
 = 
lockName_
;

404 
ÚBut
();

405  
	g»suÉ
;

408 
public
 
Bud”
 
şÚe
() {

409  (
	gBud”
è
	gsu³r
.
şÚe
();

411 
public
 
Bud”
 
£tF›ld
(

412 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

413 
Objeù
 
v®ue
) {

414  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

416 
public
 
Bud”
 
ş—rF›ld
(

417 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

418  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

420 
public
 
Bud”
 
ş—rOÃof
(

421 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

422  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

424 
public
 
Bud”
 
£tR•—‹dF›ld
(

425 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

426 
šdex
, 
Objeù
 
v®ue
) {

427  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

429 
public
 
Bud”
 
addR•—‹dF›ld
(

430 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

431 
Objeù
 
v®ue
) {

432  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

434 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

435 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
) {

436  
m”geFrom
((
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
)
Ùh”
);

438 
	gsu³r
.
m”geFrom
(
Ùh”
);

439  
	gthis
;

443 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
 
Ùh”
) {

444 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
g‘DeçuÉIn¡ªû
()è 
this
;

445 ià(!
	gÙh”
.
g‘LockGroup
().
isEm±y
()) {

446 
	glockGroup_
 = 
Ùh”
.
lockGroup_
;

447 
ÚChªged
();

449 ià(!
	gÙh”
.
g‘LockName
().
isEm±y
()) {

450 
	glockName_
 = 
Ùh”
.
lockName_
;

451 
ÚChªged
();

453 
ÚChªged
();

454  
	gthis
;

457 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

458  
	gŒue
;

461 
public
 
Bud”
 
m”geFrom
(

462 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

463 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

464 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

465 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	g·r£dMes§ge
 = 
nuÎ
;

466 
	gŒy
 {

467 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

468 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

469 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
è
e
.
g‘UnfšishedMes§ge
();

470 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

471 } 
	gfš®ly
 {

472 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

473 
m”geFrom
(
·r£dMes§ge
);

476  
	gthis
;

479 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	glockGroup_
 = "";

483 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘LockGroup
() {

484 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockGroup_
;

485 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

486 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

487 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

488 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

489 
	glockGroup_
 = 
s
;

490  
	gs
;

492  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

498 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


499 
g‘LockGroupBy‹s
() {

500 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockGroup_
;

501 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

502 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

503 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

504 (
java
.
Ïng
.
SŒšg
è
»f
);

505 
	glockGroup_
 = 
b
;

506  
	gb
;

508  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

514 
public
 
Bud”
 
£tLockGroup
(

515 
java
.
Ïng
.
SŒšg
 
v®ue
) {

516 ià(
	gv®ue
 =ğ
nuÎ
) {

517 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

520 
	glockGroup_
 = 
v®ue
;

521 
ÚChªged
();

522  
	gthis
;

527 
public
 
Bud”
 
ş—rLockGroup
() {

529 
	glockGroup_
 = 
g‘DeçuÉIn¡ªû
().
g‘LockGroup
();

530 
ÚChªged
();

531  
	gthis
;

536 
public
 
Bud”
 
£tLockGroupBy‹s
(

537 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

538 ià(
	gv®ue
 =ğ
nuÎ
) {

539 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

541 
checkBy‹SŒšgIsUtf8
(
v®ue
);

543 
	glockGroup_
 = 
v®ue
;

544 
ÚChªged
();

545  
	gthis
;

548 
´iv©e
 
	gjava
.
	gÏng
.
Objeù
 
	glockName_
 = "";

552 
public
 
	gjava
.
	gÏng
.
SŒšg
 
g‘LockName
() {

553 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockName_
;

554 ià(!(
»f
 
š¡ªûof
 
	gjava
.
	gÏng
.
	gSŒšg
)) {

555 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gbs
 =

556 (
com
.
googË
.
´Ùobuf
.
By‹SŒšg
è
»f
;

557 
	gjava
.
	gÏng
.
SŒšg
 
	gs
 = 
bs
.
toSŒšgUtf8
();

558 
	glockName_
 = 
s
;

559  
	gs
;

561  (
	gjava
.
	gÏng
.
	gSŒšg
è
	g»f
;

567 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg


568 
g‘LockNameBy‹s
() {

569 
	gjava
.
	gÏng
.
Objeù
 
	g»f
 = 
lockName_
;

570 ià(
»f
 
š¡ªûof
 
	gSŒšg
) {

571 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
By‹SŒšg
 
	gb
 =

572 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
.
cİyFromUtf8
(

573 (
java
.
Ïng
.
SŒšg
è
»f
);

574 
	glockName_
 = 
b
;

575  
	gb
;

577  (
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gBy‹SŒšg
è
	g»f
;

583 
public
 
Bud”
 
£tLockName
(

584 
java
.
Ïng
.
SŒšg
 
v®ue
) {

585 ià(
	gv®ue
 =ğ
nuÎ
) {

586 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

589 
	glockName_
 = 
v®ue
;

590 
ÚChªged
();

591  
	gthis
;

596 
public
 
Bud”
 
ş—rLockName
() {

598 
	glockName_
 = 
g‘DeçuÉIn¡ªû
().
g‘LockName
();

599 
ÚChªged
();

600  
	gthis
;

605 
public
 
Bud”
 
£tLockNameBy‹s
(

606 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
v®ue
) {

607 ià(
	gv®ue
 =ğ
nuÎ
) {

608 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

610 
checkBy‹SŒšgIsUtf8
(
v®ue
);

612 
	glockName_
 = 
v®ue
;

613 
ÚChªged
();

614  
	gthis
;

616 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

617 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

618  
	gthis
;

621 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

622 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

623  
	gthis
;

631 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	gDEFAULT_INSTANCE
;

633 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
();

636 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
g‘DeçuÉIn¡ªû
() {

637  
	gDEFAULT_INSTANCE
;

640 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLockId
>

641 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LockId
>() {

642 
public
 
LockId
 
·r£P¬tŸlFrom
(

643 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

644 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

645 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

646  
Ãw
 
LockId
(
šput
, 
ex‹nsiÚRegi¡ry
);

650 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLockId
> 
·r£r
() {

651  
	gPARSER
;

654 @
	gjava
.
	gÏng
.
Ov”ride


655 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLockId
> 
g‘P¬£rFÜTy³
() {

656  
	gPARSER
;

659 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
g‘DeçuÉIn¡ªûFÜTy³
() {

660  
	gDEFAULT_INSTANCE
;

665 
public
 
š‹rçû
 
LockD©aOrBud”
 
ex‹nds


667 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gMes§geOrBud”
 {

672 
boŞ—n
 
hasLockId
();

676 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
g‘LockId
();

680 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockIdOrBud”
 
g‘LockIdOrBud”
();

689 
boŞ—n
 
hasL—£OwÃrId
();

697 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
g‘L—£OwÃrId
();

705 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
UuidOrBud”
 
g‘L—£OwÃrIdOrBud”
();

714 
g‘L—£Acquis™iÚNumb”
();

723 
g‘L—£R’ew®Numb”
();

732 
public
 
fš®
 
şass
 
LockD©a
 
ex‹nds


733 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
G’”©edMes§geV3
 
im¶em’ts


735 
	gLockD©aOrBud”
 {

737 
´iv©e
 
LockD©a
(
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”
<?> 
bud”
) {

738 
su³r
(
bud”
);

740 
´iv©e
 
LockD©a
() {

741 
	gËa£Acquis™iÚNumb”_
 = 0;

742 
	gËa£R’ew®Numb”_
 = 0;

745 @
	gjava
.
	gÏng
.
Ov”ride


746 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
UnknownF›ldS‘


747 
g‘UnknownF›lds
() {

748  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gUnknownF›ldS‘
.
g‘DeçuÉIn¡ªû
();

750 
´iv©e
 
LockD©a
(

751 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

752 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

753 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

754 
this
();

755 
	gmubË_b™F›ld0_
 = 0;

756 
	gŒy
 {

757 
boŞ—n
 
	gdÚe
 = 
çl£
;

758 !
	gdÚe
) {

759 
	gg
 = 
šput
.
»adTag
();

760 
	gg
) {

762 
dÚe
 = 
Œue
;

765 ià(!
šput
.
skF›ld
(
g
)) {

766 
dÚe
 = 
Œue
;

771 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
Bud”
 
subBud”
 = 
nuÎ
;

772 ià(
	glockId_
 !ğ
nuÎ
) {

773 
subBud”
 = 
lockId_
.
toBud”
();

775 
	glockId_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

776 ià(
	gsubBud”
 !ğ
nuÎ
) {

777 
subBud”
.
m”geFrom
(
lockId_
);

778 
	glockId_
 = 
subBud”
.
budP¬tŸl
();

784 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
Bud”
 
subBud”
 = 
nuÎ
;

785 ià(
	gËa£OwÃrId_
 !ğ
nuÎ
) {

786 
subBud”
 = 
Ëa£OwÃrId_
.
toBud”
();

788 
	gËa£OwÃrId_
 = 
šput
.
»adMes§ge
(
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
·r£r
(), 
ex‹nsiÚRegi¡ry
);

789 ià(
	gsubBud”
 !ğ
nuÎ
) {

790 
subBud”
.
m”geFrom
(
Ëa£OwÃrId_
);

791 
	gËa£OwÃrId_
 = 
subBud”
.
budP¬tŸl
();

798 
Ëa£Acquis™iÚNumb”_
 = 
šput
.
»adIÁ32
();

803 
Ëa£R’ew®Numb”_
 = 
šput
.
»adIÁ32
();

808 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

809 
throw
 
	ge
.
£tUnfšishedMes§ge
(
this
);

810 } 
ÿtch
 (
java
.
io
.
IOExû±iÚ
 
e
) {

811 
throw
 
Ãw
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
(

812 
e
).
£tUnfšishedMes§ge
(
this
);

813 } 
	gfš®ly
 {

814 
makeEx‹nsiÚsImmubË
();

817 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


818 
g‘DesütÜ
() {

819  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_desütÜ
;

822 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


823 
š‹º®G‘F›ldAcûssÜTabË
() {

824  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_f›ldAcûssÜTabË


825 .
’su»F›ldAcûssÜsIn™Ÿlized
(

826 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
.
şass
, org.cÜfudb.uts.lock.LockD©aTy³s.LockD©a.
Bud”
.class);

829 
public
 
fš®
 
	gLOCK_ID_FIELD_NUMBER
 = 1;

830 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	glockId_
;

834 
public
 
boŞ—n
 
hasLockId
() {

835  
	glockId_
 !ğ
nuÎ
;

840 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
g‘LockId
() {

841  
	glockId_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
g‘DeçuÉIn¡ªû
(è: 
lockId_
;

846 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockIdOrBud”
 
g‘LockIdOrBud”
() {

847  
g‘LockId
();

850 
public
 
fš®
 
	gLEASE_OWNER_ID_FIELD_NUMBER
 = 2;

851 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	gËa£OwÃrId_
;

859 
public
 
boŞ—n
 
hasL—£OwÃrId
() {

860  
	gËa£OwÃrId_
 !ğ
nuÎ
;

869 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
g‘L—£OwÃrId
() {

870  
	gËa£OwÃrId_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
g‘DeçuÉIn¡ªû
(è: 
Ëa£OwÃrId_
;

879 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
UuidOrBud”
 
g‘L—£OwÃrIdOrBud”
() {

880  
g‘L—£OwÃrId
();

883 
public
 
fš®
 
	gLEASE_ACQUISITION_NUMBER_FIELD_NUMBER
 = 3;

884 
´iv©e
 
	gËa£Acquis™iÚNumb”_
;

892 
public
 
g‘L—£Acquis™iÚNumb”
() {

893  
	gËa£Acquis™iÚNumb”_
;

896 
public
 
fš®
 
	gLEASE_RENEWAL_NUMBER_FIELD_NUMBER
 = 4;

897 
´iv©e
 
	gËa£R’ew®Numb”_
;

905 
public
 
g‘L—£R’ew®Numb”
() {

906  
	gËa£R’ew®Numb”_
;

909 
´iv©e
 
by‹
 
	gmemoizedIsIn™Ÿlized
 = -1;

910 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

911 
by‹
 
	gisIn™Ÿlized
 = 
memoizedIsIn™Ÿlized
;

912 ià(
	gisIn™Ÿlized
 =ğ1è 
Œue
;

913 ià(
	gisIn™Ÿlized
 =ğ0è 
çl£
;

915 
	gmemoizedIsIn™Ÿlized
 = 1;

916  
	gŒue
;

919 
public
 
wr™eTo
(
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m
 
ouut
)

920 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

921 ià(
	glockId_
 !ğ
nuÎ
) {

922 
ouut
.
wr™eMes§ge
(1, 
g‘LockId
());

924 ià(
	gËa£OwÃrId_
 !ğ
nuÎ
) {

925 
ouut
.
wr™eMes§ge
(2, 
g‘L—£OwÃrId
());

927 ià(
	gËa£Acquis™iÚNumb”_
 != 0) {

928 
ouut
.
wr™eIÁ32
(3, 
Ëa£Acquis™iÚNumb”_
);

930 ià(
	gËa£R’ew®Numb”_
 != 0) {

931 
ouut
.
wr™eIÁ32
(4, 
Ëa£R’ew®Numb”_
);

935 
public
 
g‘S”ŸlizedSize
() {

936 
	gsize
 = 
memoizedSize
;

937 ià(
	gsize
 !ğ-1è 
size
;

939 
	gsize
 = 0;

940 ià(
	glockId_
 !ğ
nuÎ
) {

941 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


942 .
compu‹Mes§geSize
(1, 
g‘LockId
());

944 ià(
	gËa£OwÃrId_
 !ğ
nuÎ
) {

945 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


946 .
compu‹Mes§geSize
(2, 
g‘L—£OwÃrId
());

948 ià(
	gËa£Acquis™iÚNumb”_
 != 0) {

949 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


950 .
compu‹IÁ32Size
(3, 
Ëa£Acquis™iÚNumb”_
);

952 ià(
	gËa£R’ew®Numb”_
 != 0) {

953 
size
 +ğ
com
.
googË
.
´Ùobuf
.
CodedOuutSŒ—m


954 .
compu‹IÁ32Size
(4, 
Ëa£R’ew®Numb”_
);

956 
	gmemoizedSize
 = 
size
;

957  
	gsize
;

960 
´iv©e
 
fš®
 
	g£rŸlV”siÚUID
 = 0L;

961 @
	gjava
.
	gÏng
.
Ov”ride


962 
public
 
boŞ—n
 
equ®s
(
fš®
 
java
.
Ïng
.
Objeù
 
obj
) {

963 ià(
	gobj
 =ğ
this
) {

964  
Œue
;

966 ià(!(
obj
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockD©a
)) {

967  
	gsu³r
.
equ®s
(
obj
);

969 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
	gÙh”
 = (
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.LockD©aè
obj
;

971 
boŞ—n
 
	g»suÉ
 = 
Œue
;

972 
	g»suÉ
 = 
»suÉ
 && (
hasLockId
(è=ğ
Ùh”
.hasLockId());

973 ià(
hasLockId
()) {

974 
	g»suÉ
 = 
»suÉ
 && 
g‘LockId
()

975 .
equ®s
(
Ùh”
.
g‘LockId
());

977 
	g»suÉ
 = 
»suÉ
 && (
hasL—£OwÃrId
(è=ğ
Ùh”
.hasLeaseOwnerId());

978 ià(
hasL—£OwÃrId
()) {

979 
	g»suÉ
 = 
»suÉ
 && 
g‘L—£OwÃrId
()

980 .
equ®s
(
Ùh”
.
g‘L—£OwÃrId
());

982 
	g»suÉ
 = 
»suÉ
 && (
g‘L—£Acquis™iÚNumb”
()

983 =ğ
Ùh”
.
g‘L—£Acquis™iÚNumb”
());

984 
	g»suÉ
 = 
»suÉ
 && (
g‘L—£R’ew®Numb”
()

985 =ğ
Ùh”
.
g‘L—£R’ew®Numb”
());

986  
	g»suÉ
;

989 @
	gjava
.
	gÏng
.
Ov”ride


990 
public
 
hashCode
() {

991 ià(
	gmemoizedHashCode
 != 0) {

992  
memoizedHashCode
;

994 
	ghash
 = 41;

995 
	ghash
 = (19 * 
hash
è+ 
g‘DesütÜFÜTy³
().
hashCode
();

996 ià(
hasLockId
()) {

997 
	ghash
 = (37 * 
hash
è+ 
LOCK_ID_FIELD_NUMBER
;

998 
	ghash
 = (53 * 
hash
è+ 
g‘LockId
().
hashCode
();

1000 ià(
hasL—£OwÃrId
()) {

1001 
	ghash
 = (37 * 
hash
è+ 
LEASE_OWNER_ID_FIELD_NUMBER
;

1002 
	ghash
 = (53 * 
hash
è+ 
g‘L—£OwÃrId
().
hashCode
();

1004 
	ghash
 = (37 * 
hash
è+ 
LEASE_ACQUISITION_NUMBER_FIELD_NUMBER
;

1005 
	ghash
 = (53 * 
hash
è+ 
g‘L—£Acquis™iÚNumb”
();

1006 
	ghash
 = (37 * 
hash
è+ 
LEASE_RENEWAL_NUMBER_FIELD_NUMBER
;

1007 
	ghash
 = (53 * 
hash
è+ 
g‘L—£R’ew®Numb”
();

1008 
	ghash
 = (29 * 
hash
è+ 
unknownF›lds
.
hashCode
();

1009 
	gmemoizedHashCode
 = 
hash
;

1010  
	ghash
;

1013 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(

1014 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
)

1015 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1016  
	gPARSER
.
·r£From
(
d©a
);

1018 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(

1019 
com
.
googË
.
´Ùobuf
.
By‹SŒšg
 
d©a
,

1020 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1021 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1022  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1024 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(
by‹
[] 
d©a
)

1025 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1026  
	gPARSER
.
·r£From
(
d©a
);

1028 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(

1029 
by‹
[] 
d©a
,

1030 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1031 
throws
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gInv®idPrÙocŞBufãrExû±iÚ
 {

1032  
	gPARSER
.
·r£From
(
d©a
, 
ex‹nsiÚRegi¡ry
);

1034 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1035 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1036  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1037 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1039 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(

1040 
java
.
io
.
IÅutSŒ—m
 
šput
,

1041 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1042 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1043  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1044 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1046 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£D–im™edFrom
(
java
.
io
.
IÅutSŒ—m
 
šput
)

1047 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1048  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1049 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
);

1051 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£D–im™edFrom
(

1052 
java
.
io
.
IÅutSŒ—m
 
šput
,

1053 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1054 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1055  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1056 .
·r£D–im™edW™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1058 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(

1059 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
)

1060 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1061  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1062 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
);

1064 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
·r£From
(

1065 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1066 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1067 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1068  
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1069 .
·r£W™hIOExû±iÚ
(
PARSER
, 
šput
, 
ex‹nsiÚRegi¡ry
);

1072 
public
 
Bud”
 
ÃwBud”FÜTy³
(è{  
ÃwBud”
(); }

1073 
public
 
Bud”
 
ÃwBud”
() {

1074  
	gDEFAULT_INSTANCE
.
toBud”
();

1076 
public
 
Bud”
 
ÃwBud”
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
 
´ÙÙy³
) {

1077  
	gDEFAULT_INSTANCE
.
toBud”
().
m”geFrom
(
´ÙÙy³
);

1079 
public
 
Bud”
 
toBud”
() {

1080  
	gthis
 =ğ
DEFAULT_INSTANCE


1081 ? 
Ãw
 
Bud”
(è:‚ew Bud”().
m”geFrom
(
this
);

1084 @
	gjava
.
	gÏng
.
Ov”ride


1085 
´Ùeùed
 
Bud”
 
ÃwBud”FÜTy³
(

1086 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1087 
Bud”
 
	gbud”
 = 
Ãw
 Bud”(
·»Á
);

1088  
	gbud”
;

1097 
public
 
fš®
 
şass
 
Bud”
 
ex‹nds


1098 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
	gBud”
<Bud”> 
im¶em’ts


1100 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockD©aOrBud”
 {

1101 
public
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1102 
g‘DesütÜ
() {

1103  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_desütÜ
;

1106 
´Ùeùed
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1107 
š‹º®G‘F›ldAcûssÜTabË
() {

1108  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_f›ldAcûssÜTabË


1109 .
’su»F›ldAcûssÜsIn™Ÿlized
(

1110 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
.
şass
, org.cÜfudb.uts.lock.LockD©aTy³s.LockD©a.
Bud”
.class);

1114 
´iv©e
 
Bud”
() {

1115 
maybeFÜûBud”In™Ÿliz©iÚ
();

1118 
´iv©e
 
Bud”
(

1119 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
Bud”P¬’t
 
·»Á
) {

1120 
su³r
(
·»Á
);

1121 
maybeFÜûBud”In™Ÿliz©iÚ
();

1123 
´iv©e
 
maybeFÜûBud”In™Ÿliz©iÚ
() {

1124 ià(
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3


1125 .
	g®waysU£F›ldBud”s
) {

1128 
public
 
Bud”
 
ş—r
() {

1129 
	gsu³r
.
ş—r
();

1130 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1131 
lockId_
 = 
nuÎ
;

1133 
	glockId_
 = 
nuÎ
;

1134 
	glockIdBud”_
 = 
nuÎ
;

1136 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1137 
Ëa£OwÃrId_
 = 
nuÎ
;

1139 
	gËa£OwÃrId_
 = 
nuÎ
;

1140 
	gËa£OwÃrIdBud”_
 = 
nuÎ
;

1142 
	gËa£Acquis™iÚNumb”_
 = 0;

1144 
	gËa£R’ew®Numb”_
 = 0;

1146  
	gthis
;

1149 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1150 
g‘DesütÜFÜTy³
() {

1151  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_desütÜ
;

1154 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1155  
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockD©a
.
g‘DeçuÉIn¡ªû
();

1158 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
bud
() {

1159 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
	g»suÉ
 = 
budP¬tŸl
();

1160 ià(!
	g»suÉ
.
isIn™Ÿlized
()) {

1161 
throw
 
ÃwUnš™ŸlizedMes§geExû±iÚ
(
»suÉ
);

1163  
	g»suÉ
;

1166 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
budP¬tŸl
() {

1167 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
	g»suÉ
 = 
Ãw
 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.LockD©a(
this
);

1168 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1169 
»suÉ
.
lockId_
 =†ockId_;

1171 
	g»suÉ
.
	glockId_
 = 
lockIdBud”_
.
bud
();

1173 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1174 
»suÉ
.
Ëa£OwÃrId_
 =†easeOwnerId_;

1176 
	g»suÉ
.
	gËa£OwÃrId_
 = 
Ëa£OwÃrIdBud”_
.
bud
();

1178 
	g»suÉ
.
	gËa£Acquis™iÚNumb”_
 = 
Ëa£Acquis™iÚNumb”_
;

1179 
	g»suÉ
.
	gËa£R’ew®Numb”_
 = 
Ëa£R’ew®Numb”_
;

1180 
ÚBut
();

1181  
	g»suÉ
;

1184 
public
 
Bud”
 
şÚe
() {

1185  (
	gBud”
è
	gsu³r
.
şÚe
();

1187 
public
 
Bud”
 
£tF›ld
(

1188 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1189 
Objeù
 
v®ue
) {

1190  (
	gBud”
è
	gsu³r
.
£tF›ld
(
f›ld
, 
v®ue
);

1192 
public
 
Bud”
 
ş—rF›ld
(

1193 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
) {

1194  (
	gBud”
è
	gsu³r
.
ş—rF›ld
(
f›ld
);

1196 
public
 
Bud”
 
ş—rOÃof
(

1197 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
OÃofDesütÜ
 
Úeof
) {

1198  (
	gBud”
è
	gsu³r
.
ş—rOÃof
(
Úeof
);

1200 
public
 
Bud”
 
£tR•—‹dF›ld
(

1201 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1202 
šdex
, 
Objeù
 
v®ue
) {

1203  (
	gBud”
è
	gsu³r
.
£tR•—‹dF›ld
(
f›ld
, 
šdex
, 
v®ue
);

1205 
public
 
Bud”
 
addR•—‹dF›ld
(

1206 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
F›ldDesütÜ
 
f›ld
,

1207 
Objeù
 
v®ue
) {

1208  (
	gBud”
è
	gsu³r
.
addR•—‹dF›ld
(
f›ld
, 
v®ue
);

1210 
public
 
Bud”
 
m”geFrom
(
com
.
googË
.
´Ùobuf
.
Mes§ge
 
Ùh”
) {

1211 ià(
Ùh”
 
š¡ªûof
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockD©a
) {

1212  
m”geFrom
((
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
)
Ùh”
);

1214 
	gsu³r
.
m”geFrom
(
Ùh”
);

1215  
	gthis
;

1219 
public
 
Bud”
 
m”geFrom
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
 
Ùh”
) {

1220 ià(
	gÙh”
 =ğ
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
.
g‘DeçuÉIn¡ªû
()è 
this
;

1221 ià(
	gÙh”
.
hasLockId
()) {

1222 
m”geLockId
(
Ùh”
.
g‘LockId
());

1224 ià(
	gÙh”
.
hasL—£OwÃrId
()) {

1225 
m”geL—£OwÃrId
(
Ùh”
.
g‘L—£OwÃrId
());

1227 ià(
	gÙh”
.
g‘L—£Acquis™iÚNumb”
() != 0) {

1228 
£tL—£Acquis™iÚNumb”
(
Ùh”
.
g‘L—£Acquis™iÚNumb”
());

1230 ià(
	gÙh”
.
g‘L—£R’ew®Numb”
() != 0) {

1231 
£tL—£R’ew®Numb”
(
Ùh”
.
g‘L—£R’ew®Numb”
());

1233 
ÚChªged
();

1234  
	gthis
;

1237 
public
 
fš®
 
boŞ—n
 
isIn™Ÿlized
() {

1238  
	gŒue
;

1241 
public
 
Bud”
 
m”geFrom
(

1242 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1243 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1244 
throws
 
	gjava
.
	gio
.
	gIOExû±iÚ
 {

1245 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
	g·r£dMes§ge
 = 
nuÎ
;

1246 
	gŒy
 {

1247 
	g·r£dMes§ge
 = 
PARSER
.
·r£P¬tŸlFrom
(
šput
, 
ex‹nsiÚRegi¡ry
);

1248 } 
ÿtch
 (
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 
e
) {

1249 
	g·r£dMes§ge
 = (
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
è
e
.
g‘UnfšishedMes§ge
();

1250 
throw
 
	ge
.
unw¿pIOExû±iÚ
();

1251 } 
	gfš®ly
 {

1252 ià(
	g·r£dMes§ge
 !ğ
nuÎ
) {

1253 
m”geFrom
(
·r£dMes§ge
);

1256  
	gthis
;

1259 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
	glockId_
 = 
nuÎ
;

1260 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1261 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
, org.cÜfudb.uts.lock.LockD©aTy³s.LockId.
	gBud”
, org.cÜfudb.uts.lock.LockD©aTy³s.
	gLockIdOrBud”
> 
	glockIdBud”_
;

1265 
public
 
boŞ—n
 
hasLockId
() {

1266  
	glockIdBud”_
 !ğ
nuÎ
 || 
lockId_
 !=‚ull;

1271 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockId
 
g‘LockId
() {

1272 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1273  
lockId_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
g‘DeçuÉIn¡ªû
() :†ockId_;

1275  
	glockIdBud”_
.
g‘Mes§ge
();

1281 
public
 
Bud”
 
£tLockId
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
 
v®ue
) {

1282 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1283 ià(
v®ue
 =ğ
nuÎ
) {

1284 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1286 
	glockId_
 = 
v®ue
;

1287 
ÚChªged
();

1289 
	glockIdBud”_
.
£tMes§ge
(
v®ue
);

1292  
	gthis
;

1297 
public
 
Bud”
 
£tLockId
(

1298 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
Bud”
 
bud”FÜV®ue
) {

1299 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1300 
lockId_
 = 
bud”FÜV®ue
.
bud
();

1301 
ÚChªged
();

1303 
	glockIdBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

1306  
	gthis
;

1311 
public
 
Bud”
 
m”geLockId
(
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
 
v®ue
) {

1312 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1313 ià(
lockId_
 !ğ
nuÎ
) {

1314 
lockId_
 =

1315 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
ÃwBud”
(
lockId_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

1317 
	glockId_
 = 
v®ue
;

1319 
ÚChªged
();

1321 
	glockIdBud”_
.
m”geFrom
(
v®ue
);

1324  
	gthis
;

1329 
public
 
Bud”
 
ş—rLockId
() {

1330 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1331 
lockId_
 = 
nuÎ
;

1332 
ÚChªged
();

1334 
	glockId_
 = 
nuÎ
;

1335 
	glockIdBud”_
 = 
nuÎ
;

1338  
	gthis
;

1343 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
.
Bud”
 
g‘LockIdBud”
() {

1345 
ÚChªged
();

1346  
g‘LockIdF›ldBud”
().
g‘Bud”
();

1351 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockIdOrBud”
 
g‘LockIdOrBud”
() {

1352 ià(
	glockIdBud”_
 !ğ
nuÎ
) {

1353  
lockIdBud”_
.
g‘Mes§geOrBud”
();

1355  
	glockId_
 =ğ
nuÎ
 ?

1356 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
.
g‘DeçuÉIn¡ªû
(è: 
lockId_
;

1362 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1363 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
, org.cÜfudb.uts.lock.LockD©aTy³s.LockId.
	gBud”
, org.cÜfudb.uts.lock.LockD©aTy³s.
	gLockIdOrBud”
>

1364 
g‘LockIdF›ldBud”
() {

1365 ià(
	glockIdBud”_
 =ğ
nuÎ
) {

1366 
lockIdBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

1367 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockId
, 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
	gLockId
.
	gBud”
, org.cÜfudb.uts.lock.LockD©aTy³s.
	gLockIdOrBud”
>(

1368 
g‘LockId
(),

1369 
g‘P¬’tFÜChd»n
(),

1370 
isCËª
());

1371 
	glockId_
 = 
nuÎ
;

1373  
	glockIdBud”_
;

1376 
´iv©e
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
	gËa£OwÃrId_
 = 
nuÎ
;

1377 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1378 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
, org.cÜfudb.uts.CommÚTy³s.Uuid.
	gBud”
, org.cÜfudb.uts.CommÚTy³s.
	gUuidOrBud”
> 
	gËa£OwÃrIdBud”_
;

1386 
public
 
boŞ—n
 
hasL—£OwÃrId
() {

1387  
	gËa£OwÃrIdBud”_
 !ğ
nuÎ
 || 
Ëa£OwÃrId_
 !=‚ull;

1396 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
Uuid
 
g‘L—£OwÃrId
() {

1397 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1398  
Ëa£OwÃrId_
 =ğ
nuÎ
 ? 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
g‘DeçuÉIn¡ªû
() :†easeOwnerId_;

1400  
	gËa£OwÃrIdBud”_
.
g‘Mes§ge
();

1410 
public
 
Bud”
 
£tL—£OwÃrId
(
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
 
v®ue
) {

1411 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1412 ià(
v®ue
 =ğ
nuÎ
) {

1413 
throw
 
Ãw
 
NuÎPoš‹rExû±iÚ
();

1415 
	gËa£OwÃrId_
 = 
v®ue
;

1416 
ÚChªged
();

1418 
	gËa£OwÃrIdBud”_
.
£tMes§ge
(
v®ue
);

1421  
	gthis
;

1430 
public
 
Bud”
 
£tL—£OwÃrId
(

1431 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
Bud”
 
bud”FÜV®ue
) {

1432 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1433 
Ëa£OwÃrId_
 = 
bud”FÜV®ue
.
bud
();

1434 
ÚChªged
();

1436 
	gËa£OwÃrIdBud”_
.
£tMes§ge
(
bud”FÜV®ue
.
bud
());

1439  
	gthis
;

1448 
public
 
Bud”
 
m”geL—£OwÃrId
(
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
 
v®ue
) {

1449 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1450 ià(
Ëa£OwÃrId_
 !ğ
nuÎ
) {

1451 
Ëa£OwÃrId_
 =

1452 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
ÃwBud”
(
Ëa£OwÃrId_
).
m”geFrom
(
v®ue
).
budP¬tŸl
();

1454 
	gËa£OwÃrId_
 = 
v®ue
;

1456 
ÚChªged
();

1458 
	gËa£OwÃrIdBud”_
.
m”geFrom
(
v®ue
);

1461  
	gthis
;

1470 
public
 
Bud”
 
ş—rL—£OwÃrId
() {

1471 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1472 
Ëa£OwÃrId_
 = 
nuÎ
;

1473 
ÚChªged
();

1475 
	gËa£OwÃrId_
 = 
nuÎ
;

1476 
	gËa£OwÃrIdBud”_
 = 
nuÎ
;

1479  
	gthis
;

1488 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
.
Bud”
 
g‘L—£OwÃrIdBud”
() {

1490 
ÚChªged
();

1491  
g‘L—£OwÃrIdF›ldBud”
().
g‘Bud”
();

1500 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
UuidOrBud”
 
g‘L—£OwÃrIdOrBud”
() {

1501 ià(
	gËa£OwÃrIdBud”_
 !ğ
nuÎ
) {

1502  
Ëa£OwÃrIdBud”_
.
g‘Mes§geOrBud”
();

1504  
	gËa£OwÃrId_
 =ğ
nuÎ
 ?

1505 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
.
g‘DeçuÉIn¡ªû
(è: 
Ëa£OwÃrId_
;

1515 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gSšgËF›ldBud”V3
<

1516 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
, org.cÜfudb.uts.CommÚTy³s.Uuid.
	gBud”
, org.cÜfudb.uts.CommÚTy³s.
	gUuidOrBud”
>

1517 
g‘L—£OwÃrIdF›ldBud”
() {

1518 ià(
	gËa£OwÃrIdBud”_
 =ğ
nuÎ
) {

1519 
Ëa£OwÃrIdBud”_
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
SšgËF›ldBud”V3
<

1520 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
Uuid
, 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
	gUuid
.
	gBud”
, org.cÜfudb.uts.CommÚTy³s.
	gUuidOrBud”
>(

1521 
g‘L—£OwÃrId
(),

1522 
g‘P¬’tFÜChd»n
(),

1523 
isCËª
());

1524 
	gËa£OwÃrId_
 = 
nuÎ
;

1526  
	gËa£OwÃrIdBud”_
;

1529 
´iv©e
 
	gËa£Acquis™iÚNumb”_
 ;

1537 
public
 
g‘L—£Acquis™iÚNumb”
() {

1538  
	gËa£Acquis™iÚNumb”_
;

1547 
public
 
Bud”
 
£tL—£Acquis™iÚNumb”
(
v®ue
) {

1549 
	gËa£Acquis™iÚNumb”_
 = 
v®ue
;

1550 
ÚChªged
();

1551  
	gthis
;

1560 
public
 
Bud”
 
ş—rL—£Acquis™iÚNumb”
() {

1562 
	gËa£Acquis™iÚNumb”_
 = 0;

1563 
ÚChªged
();

1564  
	gthis
;

1567 
´iv©e
 
	gËa£R’ew®Numb”_
 ;

1575 
public
 
g‘L—£R’ew®Numb”
() {

1576  
	gËa£R’ew®Numb”_
;

1585 
public
 
Bud”
 
£tL—£R’ew®Numb”
(
v®ue
) {

1587 
	gËa£R’ew®Numb”_
 = 
v®ue
;

1588 
ÚChªged
();

1589  
	gthis
;

1598 
public
 
Bud”
 
ş—rL—£R’ew®Numb”
() {

1600 
	gËa£R’ew®Numb”_
 = 0;

1601 
ÚChªged
();

1602  
	gthis
;

1604 
public
 
fš®
 
Bud”
 
£tUnknownF›lds
(

1605 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1606  
	gthis
;

1609 
public
 
fš®
 
Bud”
 
m”geUnknownF›lds
(

1610 
fš®
 
com
.
googË
.
´Ùobuf
.
UnknownF›ldS‘
 
unknownF›lds
) {

1611  
	gthis
;

1619 
´iv©e
 
fš®
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
	gDEFAULT_INSTANCE
;

1621 
	gDEFAULT_INSTANCE
 = 
Ãw
 
Üg
.
cÜfudb
.
uts
.
lock
.
LockD©aTy³s
.
LockD©a
();

1624 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
g‘DeçuÉIn¡ªû
() {

1625  
	gDEFAULT_INSTANCE
;

1628 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLockD©a
>

1629 
	gPARSER
 = 
Ãw
 
com
.
googË
.
´Ùobuf
.
Ab¡¿ùP¬£r
<
LockD©a
>() {

1630 
public
 
LockD©a
 
·r£P¬tŸlFrom
(

1631 
com
.
googË
.
´Ùobuf
.
CodedIÅutSŒ—m
 
šput
,

1632 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ryL™e
 
ex‹nsiÚRegi¡ry
)

1633 
throws
 
com
.
googË
.
´Ùobuf
.
Inv®idPrÙocŞBufãrExû±iÚ
 {

1634  
Ãw
 
LockD©a
(
šput
, 
ex‹nsiÚRegi¡ry
);

1638 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLockD©a
> 
·r£r
() {

1639  
	gPARSER
;

1642 @
	gjava
.
	gÏng
.
Ov”ride


1643 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gP¬£r
<
	gLockD©a
> 
g‘P¬£rFÜTy³
() {

1644  
	gPARSER
;

1647 
public
 
	gÜg
.
	gcÜfudb
.
	guts
.
	glock
.
	gLockD©aTy³s
.
LockD©a
 
g‘DeçuÉIn¡ªûFÜTy³
() {

1648  
	gDEFAULT_INSTANCE
;

1653 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1654 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_desütÜ
;

1655 
´iv©e
 
fš®


1656 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1657 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_f›ldAcûssÜTabË
;

1658 
´iv©e
 
fš®
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
DesütÜ


1659 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_desütÜ
;

1660 
´iv©e
 
fš®


1661 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gG’”©edMes§geV3
.
F›ldAcûssÜTabË


1662 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_f›ldAcûssÜTabË
;

1664 
public
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


1665 
	$g‘DesütÜ
() {

1666  
desütÜ
;

1667 
	}
}

1668 
´iv©e
 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
FeDesütÜ


1669 
	gdesütÜ
;

1671 
	gjava
.
	gÏng
.
	gSŒšg
[] 
	gdesütÜD©a
 = {

1682 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ
.
IÁ”ÇlDesütÜAssigÃr
 
	gassigÃr
 =

1683 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
. 
IÁ”ÇlDesütÜAssigÃr
() {

1684 
public
 
com
.
googË
.
´Ùobuf
.
Ex‹nsiÚRegi¡ry
 
assignDesütÜs
(

1685 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
 
roÙ
) {

1686 
desütÜ
 = 
roÙ
;

1687  
	gnuÎ
;

1690 
	gcom
.
	ggoogË
.
	g´Ùobuf
.
	gDesütÜs
.
	gFeDesütÜ


1691 .
š‹º®BudG’”©edFeFrom
(
desütÜD©a
,

1692 
Ãw
 
com
.
googË
.
´Ùobuf
.
DesütÜs
.
FeDesütÜ
[] {

1693 
Üg
.
cÜfudb
.
uts
.
CommÚTy³s
.
g‘DesütÜ
(),

1694 }, 
assigÃr
);

1695 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_desütÜ
 =

1696 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(0);

1697 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_f›ldAcûssÜTabË
 = 
Ãw


1698 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

1699 
š‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockId_desütÜ
,

1700 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "LockGroup", "LockName", });

1701 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_desütÜ
 =

1702 
g‘DesütÜ
().
g‘Mes§geTy³s
().
g‘
(1);

1703 
	gš‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_f›ldAcûssÜTabË
 = 
Ãw


1704 
com
.
googË
.
´Ùobuf
.
G’”©edMes§geV3
.
F›ldAcûssÜTabË
(

1705 
š‹º®_¡©ic_Üg_cÜfudb_uts_lock_LockD©a_desütÜ
,

1706 
Ãw
 
java
.
Ïng
.
SŒšg
[] { "LockId", "LeaseOwnerId", "LeaseAcquisitionNumber", "LeaseRenewalNumber", });

1707 
	gÜg
.
	gcÜfudb
.
	guts
.
	gCommÚTy³s
.
g‘DesütÜ
();

	@
1
.
0
786
60658
.mvn/wrapper/MavenWrapperDownloader.java
annotationProcessor/src/main/java/org/corfudb/annotations/ObjectAnnotationProcessor.java
annotations/src/main/java/org/corfudb/annotations/Accessor.java
annotations/src/main/java/org/corfudb/annotations/ConflictParameter.java
annotations/src/main/java/org/corfudb/annotations/ConstructorType.java
annotations/src/main/java/org/corfudb/annotations/CorfuObject.java
annotations/src/main/java/org/corfudb/annotations/DontInstrument.java
annotations/src/main/java/org/corfudb/annotations/InstrumentedCorfuObject.java
annotations/src/main/java/org/corfudb/annotations/InterfaceOverride.java
annotations/src/main/java/org/corfudb/annotations/Mutator.java
annotations/src/main/java/org/corfudb/annotations/MutatorAccessor.java
annotations/src/main/java/org/corfudb/annotations/ObjectType.java
annotations/src/main/java/org/corfudb/annotations/PassThrough.java
annotations/src/main/java/org/corfudb/annotations/StateSource.java
annotations/src/main/java/org/corfudb/annotations/StaticMappingObject.java
annotations/src/main/java/org/corfudb/annotations/TransactionalMethod.java
annotations/src/main/java/org/corfudb/annotations/package-info.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuExecutionContext.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMR.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRAccess.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRProxy.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRProxyWrapper.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuSMRUpcallTarget.java
annotations/src/main/java/org/corfudb/runtime/object/ICorfuVersionPolicy.java
annotations/src/main/java/org/corfudb/runtime/object/IUndoFunction.java
annotations/src/main/java/org/corfudb/runtime/object/IUndoRecordFunction.java
annotations/src/main/java/org/corfudb/runtime/object/package-info.java
cmdlets/src/main/java/org/corfudb/metrics/MBeanDumperApp.java
cmdlets/src/main/java/org/corfudb/metrics/MBeanUtils.java
cmdlets/src/main/java/org/corfudb/shell/ShellMain.java
common/src/main/java/org/corfudb/common/compression/Codec.java
common/src/main/java/org/corfudb/common/compression/LZ4Compression.java
common/src/main/java/org/corfudb/common/compression/NoCompression.java
common/src/main/java/org/corfudb/common/compression/ZSTDCompression.java
common/src/main/java/org/corfudb/common/metrics/MetricsServer.java
common/src/main/java/org/corfudb/common/metrics/servers/PrometheusMetricsServer.java
common/src/main/java/org/corfudb/common/result/Result.java
common/src/main/java/org/corfudb/common/util/ClassUtils.java
common/src/main/java/org/corfudb/common/util/ObservableValue.java
common/src/main/java/org/corfudb/common/util/Tuple.java
corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowser.java
corfudb-tools/src/main/java/org/corfudb/browser/CorfuStoreBrowserMain.java
format/target/generated-sources/org/corfudb/format/Types.java
generator/src/main/java/org/corfudb/generator/Correctness.java
generator/src/main/java/org/corfudb/generator/Generator.java
generator/src/main/java/org/corfudb/generator/LongevityApp.java
generator/src/main/java/org/corfudb/generator/LongevityRun.java
generator/src/main/java/org/corfudb/generator/State.java
generator/src/main/java/org/corfudb/generator/StringIndexer.java
generator/src/main/java/org/corfudb/generator/distributions/DataSet.java
generator/src/main/java/org/corfudb/generator/distributions/Keys.java
generator/src/main/java/org/corfudb/generator/distributions/OperationCount.java
generator/src/main/java/org/corfudb/generator/distributions/Operations.java
generator/src/main/java/org/corfudb/generator/distributions/Streams.java
generator/src/main/java/org/corfudb/generator/operations/CheckpointOperation.java
generator/src/main/java/org/corfudb/generator/operations/NestedTxOperation.java
generator/src/main/java/org/corfudb/generator/operations/Operation.java
generator/src/main/java/org/corfudb/generator/operations/OptimisticTxOperation.java
generator/src/main/java/org/corfudb/generator/operations/ReadOperation.java
generator/src/main/java/org/corfudb/generator/operations/RemoveOperation.java
generator/src/main/java/org/corfudb/generator/operations/SleepOperation.java
generator/src/main/java/org/corfudb/generator/operations/SnapshotTxOperation.java
generator/src/main/java/org/corfudb/generator/operations/WriteAfterWriteTxOperation.java
generator/src/main/java/org/corfudb/generator/operations/WriteOperation.java
infrastructure/src/main/java/org/corfudb/infrastructure/AbstractServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/BaseServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/BatchProcessor.java
infrastructure/src/main/java/org/corfudb/infrastructure/BatchWriterOperation.java
infrastructure/src/main/java/org/corfudb/infrastructure/CorfuServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/CorfuServerNode.java
infrastructure/src/main/java/org/corfudb/infrastructure/HandlerMethods.java
infrastructure/src/main/java/org/corfudb/infrastructure/IServerRouter.java
infrastructure/src/main/java/org/corfudb/infrastructure/LayoutServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/LocalMonitoringService.java
infrastructure/src/main/java/org/corfudb/infrastructure/LogReplicationServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/LogUnitServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/LogUnitServerCache.java
infrastructure/src/main/java/org/corfudb/infrastructure/ManagementAgent.java
infrastructure/src/main/java/org/corfudb/infrastructure/ManagementServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/MonitoringService.java
infrastructure/src/main/java/org/corfudb/infrastructure/NettyServerRouter.java
infrastructure/src/main/java/org/corfudb/infrastructure/Phase2Data.java
infrastructure/src/main/java/org/corfudb/infrastructure/Rank.java
infrastructure/src/main/java/org/corfudb/infrastructure/RecoveryHandler.java
infrastructure/src/main/java/org/corfudb/infrastructure/RemoteMonitoringService.java
infrastructure/src/main/java/org/corfudb/infrastructure/ResourceQuota.java
infrastructure/src/main/java/org/corfudb/infrastructure/SequencerServer.java
infrastructure/src/main/java/org/corfudb/infrastructure/SequencerServerCache.java
infrastructure/src/main/java/org/corfudb/infrastructure/ServerContext.java
infrastructure/src/main/java/org/corfudb/infrastructure/ServerHandler.java
infrastructure/src/main/java/org/corfudb/infrastructure/ServerHandshakeHandler.java
infrastructure/src/main/java/org/corfudb/infrastructure/ServerThreadFactory.java
infrastructure/src/main/java/org/corfudb/infrastructure/TxResolutionResponse.java
infrastructure/src/main/java/org/corfudb/infrastructure/datastore/DataStore.java
infrastructure/src/main/java/org/corfudb/infrastructure/datastore/KvDataStore.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/AddressMetaData.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/InMemoryStreamLog.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/LogMetadata.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/MultiReadWriteLock.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/SegmentHandle.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLog.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogCompaction.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogDataStore.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogFiles.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/StreamLogWithRankedAddressSpace.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/StateTransferException.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/StateTransferManager.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batch/ReadBatch.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batch/TransferBatchRequest.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batch/TransferBatchResponse.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/StateTransferBatchProcessor.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/protocolbatchprocessor/ProtocolBatchProcessor.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/exceptions/ReadBatchException.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/exceptions/StateTransferBatchProcessorException.java
infrastructure/src/main/java/org/corfudb/infrastructure/log/statetransfer/exceptions/TransferSegmentException.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/DataReceiver.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/DataSender.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/LogEntryWriter.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/LogReplicationConfig.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/LogReplicationError.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/PersistedWriterMetadata.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/ReplicationWriterException.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/SinkBufferManager.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/SinkManager.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/SnapshotWriter.java
infrastructure/src/main/java/org/corfudb/infrastructure/logreplication/StreamsSnapshotWriter.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterAdvisor.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterAdvisorFactory.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterStateAggregator.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterStateCollector.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterStateContext.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ClusterType.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/CompleteGraphAdvisor.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/FailureDetector.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/IDetector.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/NetworkStretcher.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/PollReport.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/ReconfigurationEventHandler.java
infrastructure/src/main/java/org/corfudb/infrastructure/management/failuredetector/ClusterGraph.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/Action.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/ActionStatus.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/IWorkflow.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/Orchestrator.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/actions/RestoreRedundancyMergeSegments.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/AddNodeWorkflow.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/ForceRemoveWorkflow.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/HealNodeWorkflow.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/RemoveNodeWorkflow.java
infrastructure/src/main/java/org/corfudb/infrastructure/orchestrator/workflows/RestoreRedundancyMergeSegmentsWorkflow.java
infrastructure/src/main/java/org/corfudb/infrastructure/paxos/PaxosDataStore.java
infrastructure/src/main/java/org/corfudb/infrastructure/redundancy/RedundancyCalculator.java
infrastructure/src/main/java/org/corfudb/infrastructure/utils/Persistence.java
infrastructure/src/test/java/org/corfudb/infrastructure/CorfuAbstractServerTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/LayoutBasedTestHelper.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/StreamLogChecksumTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/StreamLogDataStoreTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/DataTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/FaultyBatchProcessor.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/StateTransferManagerTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/SuccessfulBatchProcessor.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/TransferSegmentCreator.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/StateTransferBatchProcessorTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/log/statetransfer/batchprocessor/protocolbatchprocessor/ProtocolBatchProcessorTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterGraphTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterStateAggregatorTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterStateCollectorTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/ClusterStateTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/CompleteGraphAdvisorTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/FailureDetectorTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/NetworkStretcherTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/NodeRankTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/NodeStateTestUtil.java
infrastructure/src/test/java/org/corfudb/infrastructure/management/PollReportTest.java
infrastructure/src/test/java/org/corfudb/infrastructure/redundancy/RedundancyCalculatorTest.java
infrastructure/target/generated-sources/org/corfudb/infrastructure/logreplication/proto/LogReplicationWriterMetadata.java
it/src/main/java/org/corfudb/universe/UniverseAppUtil.java
it/src/main/java/org/corfudb/universe/UniverseManager.java
it/src/main/java/org/corfudb/universe/group/Group.java
it/src/main/java/org/corfudb/universe/group/cluster/AbstractCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/AbstractCorfuCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/AbstractSupportCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/Cluster.java
it/src/main/java/org/corfudb/universe/group/cluster/CorfuCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/CorfuClusterParams.java
it/src/main/java/org/corfudb/universe/group/cluster/SupportClusterParams.java
it/src/main/java/org/corfudb/universe/group/cluster/docker/DockerCorfuCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/docker/DockerSupportCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/process/ProcessCorfuCluster.java
it/src/main/java/org/corfudb/universe/group/cluster/vm/RemoteOperationHelper.java
it/src/main/java/org/corfudb/universe/group/cluster/vm/VmCorfuCluster.java
it/src/main/java/org/corfudb/universe/logging/LoggingParams.java
it/src/main/java/org/corfudb/universe/node/Node.java
it/src/main/java/org/corfudb/universe/node/NodeException.java
it/src/main/java/org/corfudb/universe/node/client/ClientParams.java
it/src/main/java/org/corfudb/universe/node/client/CorfuClient.java
it/src/main/java/org/corfudb/universe/node/client/LocalCorfuClient.java
it/src/main/java/org/corfudb/universe/node/server/AbstractCorfuServer.java
it/src/main/java/org/corfudb/universe/node/server/CorfuServer.java
it/src/main/java/org/corfudb/universe/node/server/CorfuServerParams.java
it/src/main/java/org/corfudb/universe/node/server/ServerUtil.java
it/src/main/java/org/corfudb/universe/node/server/SupportServer.java
it/src/main/java/org/corfudb/universe/node/server/SupportServerParams.java
it/src/main/java/org/corfudb/universe/node/server/docker/DockerCorfuServer.java
it/src/main/java/org/corfudb/universe/node/server/docker/DockerSupportServer.java
it/src/main/java/org/corfudb/universe/node/server/docker/PrometheusConfig.java
it/src/main/java/org/corfudb/universe/node/server/process/CorfuProcessManager.java
it/src/main/java/org/corfudb/universe/node/server/process/ExecutionHelper.java
it/src/main/java/org/corfudb/universe/node/server/process/ProcessCorfuServer.java
it/src/main/java/org/corfudb/universe/node/server/vm/VmCorfuServer.java
it/src/main/java/org/corfudb/universe/node/server/vm/VmCorfuServerParams.java
it/src/main/java/org/corfudb/universe/node/stress/Stress.java
it/src/main/java/org/corfudb/universe/node/stress/vm/VmStress.java
it/src/main/java/org/corfudb/universe/scenario/fixture/Fixture.java
it/src/main/java/org/corfudb/universe/scenario/fixture/FixtureUtil.java
it/src/main/java/org/corfudb/universe/scenario/fixture/Fixtures.java
it/src/main/java/org/corfudb/universe/universe/AbstractUniverse.java
it/src/main/java/org/corfudb/universe/universe/Universe.java
it/src/main/java/org/corfudb/universe/universe/UniverseException.java
it/src/main/java/org/corfudb/universe/universe/UniverseParams.java
it/src/main/java/org/corfudb/universe/universe/docker/DockerUniverse.java
it/src/main/java/org/corfudb/universe/universe/docker/FakeDns.java
it/src/main/java/org/corfudb/universe/universe/process/ProcessUniverse.java
it/src/main/java/org/corfudb/universe/universe/vm/ApplianceManager.java
it/src/main/java/org/corfudb/universe/universe/vm/VmConfigPropertiesLoader.java
it/src/main/java/org/corfudb/universe/universe/vm/VmManager.java
it/src/main/java/org/corfudb/universe/universe/vm/VmUniverse.java
it/src/main/java/org/corfudb/universe/universe/vm/VmUniverseParams.java
it/src/main/java/org/corfudb/universe/util/DockerManager.java
it/src/main/java/org/corfudb/universe/util/IpAddress.java
it/src/main/java/org/corfudb/universe/util/IpTablesUtil.java
it/src/test/java/org/corfudb/universe/GenericIntegrationTest.java
it/src/test/java/org/corfudb/universe/group/CorfuClusterParamsTest.java
it/src/test/java/org/corfudb/universe/node/server/CorfuServerParamsTest.java
it/src/test/java/org/corfudb/universe/scenario/AllNodesPartitionedIT.java
it/src/test/java/org/corfudb/universe/scenario/ClusterResizeIT.java
it/src/test/java/org/corfudb/universe/scenario/ConcurrentClusterResizeIT.java
it/src/test/java/org/corfudb/universe/scenario/HandOfGodIT.java
it/src/test/java/org/corfudb/universe/scenario/NodeDownAndLinkFailureIT.java
it/src/test/java/org/corfudb/universe/scenario/NodeDownAndPartitionedIT.java
it/src/test/java/org/corfudb/universe/scenario/NodePausedAndPartitionedIT.java
it/src/test/java/org/corfudb/universe/scenario/NodeUpAndPartitionedIT.java
it/src/test/java/org/corfudb/universe/scenario/OneLinkFailureIT.java
it/src/test/java/org/corfudb/universe/scenario/OneNodeDownIT.java
it/src/test/java/org/corfudb/universe/scenario/OneNodePausedIT.java
it/src/test/java/org/corfudb/universe/scenario/RotateLinkFailureIT.java
it/src/test/java/org/corfudb/universe/scenario/ScenarioUtils.java
it/src/test/java/org/corfudb/universe/scenario/TwoLinksFailureIT.java
it/src/test/java/org/corfudb/universe/scenario/TwoNodesDownIT.java
log-replication/src/main/java/org/corfudb/logreplication/DataControl.java
log-replication/src/main/java/org/corfudb/logreplication/SourceManager.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/IllegalTransitionException.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/InLogEntrySyncState.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/InSnapshotSyncState.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/InitializedState.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationEvent.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationFSM.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationState.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/LogReplicationStateType.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/ObservableAckMsg.java
log-replication/src/main/java/org/corfudb/logreplication/fsm/StoppedState.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationDiscoveryService.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationManager.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationServer.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationServerNode.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CorfuReplicationSiteManagerAdapter.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/CrossSiteConfiguration.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/DefaultSiteManager.java
log-replication/src/main/java/org/corfudb/logreplication/infrastructure/LogReplicationServerContext.java
log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationClient.java
log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationHandler.java
log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationRuntime.java
log-replication/src/main/java/org/corfudb/logreplication/runtime/LogReplicationRuntimeParameters.java
log-replication/src/main/java/org/corfudb/logreplication/send/CorfuDataSender.java
log-replication/src/main/java/org/corfudb/logreplication/send/DefaultReadProcessor.java
log-replication/src/main/java/org/corfudb/logreplication/send/IllegalTransactionStreamsException.java
log-replication/src/main/java/org/corfudb/logreplication/send/LogEntryReader.java
log-replication/src/main/java/org/corfudb/logreplication/send/LogEntrySender.java
log-replication/src/main/java/org/corfudb/logreplication/send/LogEntrySyncTimeoutException.java
log-replication/src/main/java/org/corfudb/logreplication/send/LogReplicationEventMetadata.java
log-replication/src/main/java/org/corfudb/logreplication/send/ReadProcessor.java
log-replication/src/main/java/org/corfudb/logreplication/send/ReplicationReaderException.java
log-replication/src/main/java/org/corfudb/logreplication/send/SnapshotReadMessage.java
log-replication/src/main/java/org/corfudb/logreplication/send/SnapshotReader.java
log-replication/src/main/java/org/corfudb/logreplication/send/SnapshotSender.java
log-replication/src/main/java/org/corfudb/logreplication/send/StreamsLogEntryReader.java
log-replication/src/main/java/org/corfudb/logreplication/send/StreamsSnapshotReader.java
log-replication/src/test/java/org/corfudb/AppTest.java
log-replication/target/generated-sources/org/corfudb/logreplication/proto/LogReplicationSiteInfo.java
runtime/src/main/java/org/corfudb/comm/ChannelImplementation.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/CheckpointEntry.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/ISMRConsumable.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/LogEntry.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/MultiObjectSMREntry.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/MultiSMREntry.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/OpaqueEntry.java
runtime/src/main/java/org/corfudb/protocols/logprotocol/SMREntry.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ClientHandshakeHandler.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ClusterState.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuMsgType.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuPayload.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/CorfuPayloadMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/DataType.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/DetectorMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ExceptionMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/HandshakeMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/HandshakeResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/HandshakeState.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ICorfuPayload.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ILogData.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/IMetadata.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/IToken.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ITypedEnum.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/InboundMsgFilterHandler.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/JSONPayloadMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/KnownAddressRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/KnownAddressResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutBootstrapRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutCommittedRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutPrepareRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutPrepareResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutProposeRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LayoutProposeResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/LogData.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/MsgHandlingFilter.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/MultipleReadRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/NettyCorfuMessageDecoder.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/NettyCorfuMessageEncoder.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/NodeState.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/PriorityLevel.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/RangeWriteMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ReadRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/ReadResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/SequencerMetrics.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/SequencerRecoveryMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/StreamAddressRange.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/StreamsAddressRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/StreamsAddressResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TailsRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TailsResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/Token.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TokenRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TokenResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TokenType.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TrimRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/TxResolutionInfo.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/VersionInfo.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/WriteRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/failuredetector/FailureDetectorMetrics.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/failuredetector/NodeConnectivity.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/failuredetector/NodeRank.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationEntry.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationEntryMetadata.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationNegotiationResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/LogReplicationQueryLeaderShipResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/logreplication/MessageType.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/AddNodeRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/CreateRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/CreateWorkflowResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/ForceRemoveNodeRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/HealNodeRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorMsg.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorRequestType.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/OrchestratorResponseType.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/QueryRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/QueryResponse.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/RemoveNodeRequest.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/Request.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/Response.java
runtime/src/main/java/org/corfudb/protocols/wireprotocol/orchestrator/RestoreRedundancyMergeSegmentsRequest.java
runtime/src/main/java/org/corfudb/runtime/BootstrapUtil.java
runtime/src/main/java/org/corfudb/runtime/CheckpointWriter.java
runtime/src/main/java/org/corfudb/runtime/CorfuRuntime.java
runtime/src/main/java/org/corfudb/runtime/MultiCheckpointWriter.java
runtime/src/main/java/org/corfudb/runtime/NodeRouterPool.java
runtime/src/main/java/org/corfudb/runtime/RebootUtil.java
runtime/src/main/java/org/corfudb/runtime/RuntimeParameters.java
runtime/src/main/java/org/corfudb/runtime/ViewsGarbageCollector.java
runtime/src/main/java/org/corfudb/runtime/clients/AbstractClient.java
runtime/src/main/java/org/corfudb/runtime/clients/BaseClient.java
runtime/src/main/java/org/corfudb/runtime/clients/BaseHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/ClientHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/ClientMsgHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/IClient.java
runtime/src/main/java/org/corfudb/runtime/clients/IClientRouter.java
runtime/src/main/java/org/corfudb/runtime/clients/IHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/LayoutClient.java
runtime/src/main/java/org/corfudb/runtime/clients/LayoutHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/LogUnitClient.java
runtime/src/main/java/org/corfudb/runtime/clients/LogUnitHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/ManagementClient.java
runtime/src/main/java/org/corfudb/runtime/clients/ManagementHandler.java
runtime/src/main/java/org/corfudb/runtime/clients/NettyClientRouter.java
runtime/src/main/java/org/corfudb/runtime/clients/SequencerClient.java
runtime/src/main/java/org/corfudb/runtime/clients/SequencerHandler.java
runtime/src/main/java/org/corfudb/runtime/collections/ContextAwareMap.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuDynamicKey.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuDynamicMessage.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuDynamicRecord.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuQueue.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuRecord.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuStore.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuStoreEntry.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuStreamEntries.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuStreamEntry.java
runtime/src/main/java/org/corfudb/runtime/collections/CorfuTable.java
runtime/src/main/java/org/corfudb/runtime/collections/ICorfuTable.java
runtime/src/main/java/org/corfudb/runtime/collections/Index.java
runtime/src/main/java/org/corfudb/runtime/collections/MetadataOptions.java
runtime/src/main/java/org/corfudb/runtime/collections/PersistedStreamingMap.java
runtime/src/main/java/org/corfudb/runtime/collections/ProtobufIndexer.java
runtime/src/main/java/org/corfudb/runtime/collections/Query.java
runtime/src/main/java/org/corfudb/runtime/collections/QueryOptions.java
runtime/src/main/java/org/corfudb/runtime/collections/QueryResult.java
runtime/src/main/java/org/corfudb/runtime/collections/RocksDbEntryIterator.java
runtime/src/main/java/org/corfudb/runtime/collections/StreamListener.java
runtime/src/main/java/org/corfudb/runtime/collections/StreamingMap.java
runtime/src/main/java/org/corfudb/runtime/collections/StreamingMapDecorator.java
runtime/src/main/java/org/corfudb/runtime/collections/StreamingSubscriptionContext.java
runtime/src/main/java/org/corfudb/runtime/collections/Table.java
runtime/src/main/java/org/corfudb/runtime/collections/TableOptions.java
runtime/src/main/java/org/corfudb/runtime/collections/TableSchema.java
runtime/src/main/java/org/corfudb/runtime/collections/TransactionPoller.java
runtime/src/main/java/org/corfudb/runtime/collections/TxBuilder.java
runtime/src/main/java/org/corfudb/runtime/collections/TxnStreamingManager.java
runtime/src/main/java/org/corfudb/runtime/collections/WrappedRocksIterator.java
runtime/src/main/java/org/corfudb/runtime/exceptions/AbortCause.java
runtime/src/main/java/org/corfudb/runtime/exceptions/AlreadyBootstrappedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/AppendException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/DataCorruptionException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/DataOutrankedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/FastObjectLoaderException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/HoleFillRequiredException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/LayoutModificationException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/LogUnitException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/NetworkException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/NoBootstrapException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/NoRollbackException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/OutOfSpaceException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/OutrankedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/OverwriteCause.java
runtime/src/main/java/org/corfudb/runtime/exceptions/OverwriteException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/QuorumUnreachableException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/QuotaExceededException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/RecoveryException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/RetryExhaustedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/SerializerException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/ServerNotReadyException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/StaleTokenException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/TransactionAbortedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/TrimmedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/TrimmedUpcallException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/UnreachableClusterException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/ValueAdoptedException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/WorkflowException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/WorkflowResultUnknownException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/WriteSizeException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/WrongClusterException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/WrongEpochException.java
runtime/src/main/java/org/corfudb/runtime/exceptions/unrecoverable/SystemUnavailableError.java
runtime/src/main/java/org/corfudb/runtime/exceptions/unrecoverable/UnrecoverableCorfuError.java
runtime/src/main/java/org/corfudb/runtime/exceptions/unrecoverable/UnrecoverableCorfuInterruptedError.java
runtime/src/main/java/org/corfudb/runtime/object/CorfuCompileProxy.java
runtime/src/main/java/org/corfudb/runtime/object/CorfuCompileWrapperBuilder.java
runtime/src/main/java/org/corfudb/runtime/object/ICorfuSMRProxyInternal.java
runtime/src/main/java/org/corfudb/runtime/object/ISMRStream.java
runtime/src/main/java/org/corfudb/runtime/object/StreamViewSMRAdapter.java
runtime/src/main/java/org/corfudb/runtime/object/VersionLockedObject.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/AbstractTransactionalContext.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/ConflictSetInfo.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/OptimisticTransactionalContext.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/SnapshotTransactionalContext.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/Transaction.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/TransactionType.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/TransactionalContext.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/WriteAfterWriteTransactionalContext.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/WriteSetInfo.java
runtime/src/main/java/org/corfudb/runtime/object/transactions/WriteSetSMRStream.java
runtime/src/main/java/org/corfudb/runtime/view/AbstractView.java
runtime/src/main/java/org/corfudb/runtime/view/Address.java
runtime/src/main/java/org/corfudb/runtime/view/AddressSpaceView.java
runtime/src/main/java/org/corfudb/runtime/view/CacheOption.java
runtime/src/main/java/org/corfudb/runtime/view/ClusterStatusReport.java
runtime/src/main/java/org/corfudb/runtime/view/ConservativeFailureHandlerPolicy.java
runtime/src/main/java/org/corfudb/runtime/view/CorfuGuidGenerator.java
runtime/src/main/java/org/corfudb/runtime/view/IReconfigurationHandlerPolicy.java
runtime/src/main/java/org/corfudb/runtime/view/Layout.java
runtime/src/main/java/org/corfudb/runtime/view/LayoutBuilder.java
runtime/src/main/java/org/corfudb/runtime/view/LayoutDeserializer.java
runtime/src/main/java/org/corfudb/runtime/view/LayoutManagementView.java
runtime/src/main/java/org/corfudb/runtime/view/LayoutView.java
runtime/src/main/java/org/corfudb/runtime/view/ManagementView.java
runtime/src/main/java/org/corfudb/runtime/view/ObjectOpenOption.java
runtime/src/main/java/org/corfudb/runtime/view/ObjectsView.java
runtime/src/main/java/org/corfudb/runtime/view/OrderedGuidGenerator.java
runtime/src/main/java/org/corfudb/runtime/view/QuorumFuturesFactory.java
runtime/src/main/java/org/corfudb/runtime/view/ReadOptions.java
runtime/src/main/java/org/corfudb/runtime/view/RuntimeLayout.java
runtime/src/main/java/org/corfudb/runtime/view/SMRObject.java
runtime/src/main/java/org/corfudb/runtime/view/SealServersHelper.java
runtime/src/main/java/org/corfudb/runtime/view/SequencerView.java
runtime/src/main/java/org/corfudb/runtime/view/SnowflakeGuidGenerator.java
runtime/src/main/java/org/corfudb/runtime/view/StreamOptions.java
runtime/src/main/java/org/corfudb/runtime/view/StreamsView.java
runtime/src/main/java/org/corfudb/runtime/view/TableRegistry.java
runtime/src/main/java/org/corfudb/runtime/view/replication/AbstractReplicationProtocol.java
runtime/src/main/java/org/corfudb/runtime/view/replication/AlwaysHoleFillPolicy.java
runtime/src/main/java/org/corfudb/runtime/view/replication/ChainReplicationProtocol.java
runtime/src/main/java/org/corfudb/runtime/view/replication/IHoleFillPolicy.java
runtime/src/main/java/org/corfudb/runtime/view/replication/IReplicationProtocol.java
runtime/src/main/java/org/corfudb/runtime/view/replication/NeverHoleFillPolicy.java
runtime/src/main/java/org/corfudb/runtime/view/replication/QuorumReplicationProtocol.java
runtime/src/main/java/org/corfudb/runtime/view/replication/ReadWaitHoleFillPolicy.java
runtime/src/main/java/org/corfudb/runtime/view/stream/AbstractContextStreamView.java
runtime/src/main/java/org/corfudb/runtime/view/stream/AbstractQueuedStreamView.java
runtime/src/main/java/org/corfudb/runtime/view/stream/AbstractStreamContext.java
runtime/src/main/java/org/corfudb/runtime/view/stream/AddressMapStreamView.java
runtime/src/main/java/org/corfudb/runtime/view/stream/BackpointerStreamView.java
runtime/src/main/java/org/corfudb/runtime/view/stream/IStreamView.java
runtime/src/main/java/org/corfudb/runtime/view/stream/OpaqueStream.java
runtime/src/main/java/org/corfudb/runtime/view/stream/StreamAddressSpace.java
runtime/src/main/java/org/corfudb/runtime/view/stream/StreamSpliterator.java
runtime/src/main/java/org/corfudb/runtime/view/stream/ThreadSafeStreamView.java
runtime/src/main/java/org/corfudb/runtime/view/workflows/AddNode.java
runtime/src/main/java/org/corfudb/runtime/view/workflows/ForceRemoveNode.java
runtime/src/main/java/org/corfudb/runtime/view/workflows/HealNode.java
runtime/src/main/java/org/corfudb/runtime/view/workflows/RemoveNode.java
runtime/src/main/java/org/corfudb/runtime/view/workflows/RestoreRedundancyMergeSegments.java
runtime/src/main/java/org/corfudb/runtime/view/workflows/WorkflowRequest.java
runtime/src/main/java/org/corfudb/security/sasl/SaslUtils.java
runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextCallbackHandler.java
runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextLoginModule.java
runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslNettyClient.java
runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslNettyServer.java
runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslServer.java
runtime/src/main/java/org/corfudb/security/sasl/plaintext/PlainTextSaslServerProvider.java
runtime/src/main/java/org/corfudb/security/tls/ReloadableTrustManager.java
runtime/src/main/java/org/corfudb/security/tls/ReloadableTrustManagerFactory.java
runtime/src/main/java/org/corfudb/security/tls/SslContextConstructor.java
runtime/src/main/java/org/corfudb/security/tls/TlsUtils.java
runtime/src/main/java/org/corfudb/util/CFUtils.java
runtime/src/main/java/org/corfudb/util/CorfuComponent.java
runtime/src/main/java/org/corfudb/util/GitRepositoryState.java
runtime/src/main/java/org/corfudb/util/Holder.java
runtime/src/main/java/org/corfudb/util/ImmutableListSetWrapper.java
runtime/src/main/java/org/corfudb/util/JsonUtils.java
runtime/src/main/java/org/corfudb/util/LambdaUtils.java
runtime/src/main/java/org/corfudb/util/MetricsUtils.java
runtime/src/main/java/org/corfudb/util/NetworkUtils.java
runtime/src/main/java/org/corfudb/util/NodeLocator.java
runtime/src/main/java/org/corfudb/util/ReflectionUtils.java
runtime/src/main/java/org/corfudb/util/Sleep.java
runtime/src/main/java/org/corfudb/util/Utils.java
runtime/src/main/java/org/corfudb/util/UuidUtils.java
runtime/src/main/java/org/corfudb/util/Version.java
runtime/src/main/java/org/corfudb/util/concurrent/SingletonResource.java
runtime/src/main/java/org/corfudb/util/retry/AbstractRetry.java
runtime/src/main/java/org/corfudb/util/retry/ExponentialBackoffRetry.java
runtime/src/main/java/org/corfudb/util/retry/IRetry.java
runtime/src/main/java/org/corfudb/util/retry/IRetryable.java
runtime/src/main/java/org/corfudb/util/retry/IntervalRetry.java
runtime/src/main/java/org/corfudb/util/retry/RetryNeededException.java
runtime/src/main/java/org/corfudb/util/serializer/CorfuSerializer.java
runtime/src/main/java/org/corfudb/util/serializer/DynamicProtobufSerializer.java
runtime/src/main/java/org/corfudb/util/serializer/ICorfuHashable.java
runtime/src/main/java/org/corfudb/util/serializer/ICorfuSerializable.java
runtime/src/main/java/org/corfudb/util/serializer/ISerializer.java
runtime/src/main/java/org/corfudb/util/serializer/JavaSerializer.java
runtime/src/main/java/org/corfudb/util/serializer/JsonSerializer.java
runtime/src/main/java/org/corfudb/util/serializer/PrimitiveSerializer.java
runtime/src/main/java/org/corfudb/util/serializer/ProtobufSerializer.java
runtime/src/main/java/org/corfudb/util/serializer/Serializers.java
runtime/src/test/java/org/corfudb/protocols/wireprotocol/ICorfuPayloadTest.java
runtime/src/test/java/org/corfudb/protocols/wireprotocol/NodeStateTest.java
runtime/src/test/java/org/corfudb/protocols/wireprotocol/failuredetector/NodeConnectivityTest.java
runtime/src/test/java/org/corfudb/runtime/view/LayoutTest.java
runtime/target/generated-sources/annotations/org/corfudb/runtime/collections/CorfuTable$CORFUSMR.java
runtime/target/generated-sources/org/corfudb/runtime/CorfuOptions.java
runtime/target/generated-sources/org/corfudb/runtime/CorfuStoreMetadata.java
samples/src/main/java/org/corfudb/samples/BaseCorfuAppUtils.java
samples/src/main/java/org/corfudb/samples/BatchedWriteTransaction.java
samples/src/main/java/org/corfudb/samples/CorfuCompoundObject.java
samples/src/main/java/org/corfudb/samples/CorfuSharedCounter.java
samples/src/main/java/org/corfudb/samples/CorfuStoreSample.java
samples/src/main/java/org/corfudb/samples/HelloCorfu.java
samples/src/main/java/org/corfudb/samples/SimpleAtomicTransaction.java
samples/src/main/java/org/corfudb/samples/SimpleUseCustomBaseCorfuObject.java
samples/src/main/java/org/corfudb/samples/WriteOnlySimpleTransaction.java
samples/src/main/java/org/corfudb/samples/WriteWriteTXs.java
samples/target/generated-sources/annotations/org/corfudb/samples/CorfuCompoundObject$CORFUSMR.java
samples/target/generated-sources/annotations/org/corfudb/samples/CorfuSharedCounter$CORFUSMR.java
samples/target/generated-sources/samples/protobuf/PersonProfile.java
samples/target/generated-sources/samples/protobuf/Vehicle.java
samples/target/generated-sources/samples/protobuf/WorkExperience.java
test/src/test/java/org/corfudb/AbstractCorfuConcurrencyTest.java
test/src/test/java/org/corfudb/AbstractCorfuTest.java
test/src/test/java/org/corfudb/CorfuTestParameters.java
test/src/test/java/org/corfudb/CorfuTestServers.java
test/src/test/java/org/corfudb/CustomSerializer.java
test/src/test/java/org/corfudb/LogReplicationTest.java
test/src/test/java/org/corfudb/common/metrics/servers/PrometheusMetricsServerTest.java
test/src/test/java/org/corfudb/infrastructure/AbstractServerTest.java
test/src/test/java/org/corfudb/infrastructure/BaseServerTest.java
test/src/test/java/org/corfudb/infrastructure/DataStoreTest.java
test/src/test/java/org/corfudb/infrastructure/LayoutBuilderTest.java
test/src/test/java/org/corfudb/infrastructure/LayoutServerAssertions.java
test/src/test/java/org/corfudb/infrastructure/LayoutServerTest.java
test/src/test/java/org/corfudb/infrastructure/LogUnitCacheTest.java
test/src/test/java/org/corfudb/infrastructure/LogUnitServerAssertions.java
test/src/test/java/org/corfudb/infrastructure/LogUnitServerTest.java
test/src/test/java/org/corfudb/infrastructure/ManagementServerTest.java
test/src/test/java/org/corfudb/infrastructure/ReconfigurationEventHandlerTest.java
test/src/test/java/org/corfudb/infrastructure/ResourceQuotaTest.java
test/src/test/java/org/corfudb/infrastructure/SequencerServerTest.java
test/src/test/java/org/corfudb/infrastructure/ServerContextBuilder.java
test/src/test/java/org/corfudb/infrastructure/TestLayoutBuilder.java
test/src/test/java/org/corfudb/infrastructure/TestServerRouter.java
test/src/test/java/org/corfudb/infrastructure/log/MultiReadWriteLockTest.java
test/src/test/java/org/corfudb/infrastructure/log/StreamLogCompactionTest.java
test/src/test/java/org/corfudb/infrastructure/log/StreamLogFilesTest.java
test/src/test/java/org/corfudb/infrastructure/log/StreamLogWithRankedAddressSpaceTest.java
test/src/test/java/org/corfudb/integration/AbstractIT.java
test/src/test/java/org/corfudb/integration/AckDataSender.java
test/src/test/java/org/corfudb/integration/ClusterReconfigIT.java
test/src/test/java/org/corfudb/integration/CmdletIT.java
test/src/test/java/org/corfudb/integration/CorfuMsgFilterIT.java
test/src/test/java/org/corfudb/integration/CorfuReplicationE2EIT.java
test/src/test/java/org/corfudb/integration/CorfuStoreBrowserIT.java
test/src/test/java/org/corfudb/integration/CorfuStoreIT.java
test/src/test/java/org/corfudb/integration/CorfuStorePerfIT.java
test/src/test/java/org/corfudb/integration/DefaultDataControl.java
test/src/test/java/org/corfudb/integration/Event.java
test/src/test/java/org/corfudb/integration/Harness.java
test/src/test/java/org/corfudb/integration/LargeWriteIT.java
test/src/test/java/org/corfudb/integration/LockIT.java
test/src/test/java/org/corfudb/integration/LogReplicationIT.java
test/src/test/java/org/corfudb/integration/LogSizeQuotaIT.java
test/src/test/java/org/corfudb/integration/MemoryFootprintIT.java
test/src/test/java/org/corfudb/integration/ReplicationReaderWriterIT.java
test/src/test/java/org/corfudb/integration/SealIT.java
test/src/test/java/org/corfudb/integration/SecurityIT.java
test/src/test/java/org/corfudb/integration/ServerRestartIT.java
test/src/test/java/org/corfudb/integration/SourceForwardingDataSender.java
test/src/test/java/org/corfudb/integration/StreamAddressDiscoveryIT.java
test/src/test/java/org/corfudb/integration/StreamingIT.java
test/src/test/java/org/corfudb/integration/TestSerializer.java
test/src/test/java/org/corfudb/integration/TransactionStreamIT.java
test/src/test/java/org/corfudb/integration/WorkflowIT.java
test/src/test/java/org/corfudb/integration/cluster/Harness/Action.java
test/src/test/java/org/corfudb/integration/cluster/Harness/Node.java
test/src/test/java/org/corfudb/integration/cluster/Harness/ShutdownAction.java
test/src/test/java/org/corfudb/integration/cluster/Harness/StartAction.java
test/src/test/java/org/corfudb/logreplication/fsm/EmptyDataSender.java
test/src/test/java/org/corfudb/logreplication/fsm/EmptySnapshotReader.java
test/src/test/java/org/corfudb/logreplication/fsm/LogReplicationFSMTest.java
test/src/test/java/org/corfudb/logreplication/fsm/ReplicationReaderWriterTest.java
test/src/test/java/org/corfudb/logreplication/fsm/TestDataSender.java
test/src/test/java/org/corfudb/logreplication/fsm/TestLogEntryReader.java
test/src/test/java/org/corfudb/logreplication/fsm/TestReaderConfiguration.java
test/src/test/java/org/corfudb/logreplication/fsm/TestSnapshotReader.java
test/src/test/java/org/corfudb/protocols/logprotocol/LogEntryTest.java
test/src/test/java/org/corfudb/protocols/wireprotocol/TokenTest.java
test/src/test/java/org/corfudb/runtime/CompressionTest.java
test/src/test/java/org/corfudb/runtime/CorfuRuntimeTest.java
test/src/test/java/org/corfudb/runtime/checkpoint/CPSerializer.java
test/src/test/java/org/corfudb/runtime/checkpoint/CheckpointSmokeTest.java
test/src/test/java/org/corfudb/runtime/checkpoint/CheckpointTest.java
test/src/test/java/org/corfudb/runtime/checkpoint/CheckpointTrimTest.java
test/src/test/java/org/corfudb/runtime/clients/AbstractClientTest.java
test/src/test/java/org/corfudb/runtime/clients/BaseHandlerTest.java
test/src/test/java/org/corfudb/runtime/clients/LayoutHandlerTest.java
test/src/test/java/org/corfudb/runtime/clients/LogUnitHandlerTest.java
test/src/test/java/org/corfudb/runtime/clients/ManagementHandlerTest.java
test/src/test/java/org/corfudb/runtime/clients/NettyCommTest.java
test/src/test/java/org/corfudb/runtime/clients/SequencerHandlerTest.java
test/src/test/java/org/corfudb/runtime/clients/TestChannelContext.java
test/src/test/java/org/corfudb/runtime/clients/TestClientRouter.java
test/src/test/java/org/corfudb/runtime/clients/TestClientRouterTest.java
test/src/test/java/org/corfudb/runtime/clients/TestRule.java
test/src/test/java/org/corfudb/runtime/collections/CorfuMapTest.java
test/src/test/java/org/corfudb/runtime/collections/CorfuQueueTest.java
test/src/test/java/org/corfudb/runtime/collections/CorfuStoreTest.java
test/src/test/java/org/corfudb/runtime/collections/CorfuTableTest.java
test/src/test/java/org/corfudb/runtime/collections/DiskBackedCorfuClientTest.java
test/src/test/java/org/corfudb/runtime/collections/PutIfAbsentMapTest.java
test/src/test/java/org/corfudb/runtime/collections/RocksDbEntryIteratorTest.java
test/src/test/java/org/corfudb/runtime/collections/SMRMapEntrySetTest.java
test/src/test/java/org/corfudb/runtime/collections/SMRMapTest.java
test/src/test/java/org/corfudb/runtime/collections/SMRMultiLogunitTest.java
test/src/test/java/org/corfudb/runtime/collections/StringIndexer.java
test/src/test/java/org/corfudb/runtime/collections/StringMultiIndexer.java
test/src/test/java/org/corfudb/runtime/concurrent/CorfuQueueTxTest.java
test/src/test/java/org/corfudb/runtime/concurrent/MapsAsMQsTest.java
test/src/test/java/org/corfudb/runtime/concurrent/MultipleNonOverlappingTest.java
test/src/test/java/org/corfudb/runtime/concurrent/StreamSeekAtomicityTest.java
test/src/test/java/org/corfudb/runtime/object/AbstractObjectTest.java
test/src/test/java/org/corfudb/runtime/object/CompileProxyTest.java
test/src/test/java/org/corfudb/runtime/object/ConflictParameterClass.java
test/src/test/java/org/corfudb/runtime/object/CorfuCompoundObj.java
test/src/test/java/org/corfudb/runtime/object/CorfuSMRObjectConcurrencyTest.java
test/src/test/java/org/corfudb/runtime/object/CorfuSMRObjectProxyTest.java
test/src/test/java/org/corfudb/runtime/object/CorfuSharedCounter.java
test/src/test/java/org/corfudb/runtime/object/ObjectBuilderTest.java
test/src/test/java/org/corfudb/runtime/object/TestClass.java
test/src/test/java/org/corfudb/runtime/object/TestClassUsingAnnotation.java
test/src/test/java/org/corfudb/runtime/object/TransactionalObject.java
test/src/test/java/org/corfudb/runtime/object/transactions/AbstractTransactionContextTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/AbstractTransactionsTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/ImplicitTransactionsTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/OptimisticTXConcurrencyTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/OptimisticTransactionContextTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/SequencerServerCacheTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/SnapshotTransactionContextTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/StreamTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/TXConflictScenariosTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/TXsFromTwoRuntimesTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/TransactionAbortedTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/UndoTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/WriteAfterWriteTransactionContextTest.java
test/src/test/java/org/corfudb/runtime/object/transactions/WriteWriteTXConcurrencyTest.java
test/src/test/java/org/corfudb/runtime/utils/NodeLocatorTest.java
test/src/test/java/org/corfudb/runtime/view/AbstractViewTest.java
test/src/test/java/org/corfudb/runtime/view/AddressSpaceViewTest.java
test/src/test/java/org/corfudb/runtime/view/ChainReplicationViewTest.java
test/src/test/java/org/corfudb/runtime/view/CorfuGuidGeneratorTest.java
test/src/test/java/org/corfudb/runtime/view/LayoutManagementViewTest.java
test/src/test/java/org/corfudb/runtime/view/LayoutSealTest.java
test/src/test/java/org/corfudb/runtime/view/LayoutTest.java
test/src/test/java/org/corfudb/runtime/view/LayoutViewTest.java
test/src/test/java/org/corfudb/runtime/view/LogUnitSealTest.java
test/src/test/java/org/corfudb/runtime/view/ManagementViewTest.java
test/src/test/java/org/corfudb/runtime/view/ObjectsViewTest.java
test/src/test/java/org/corfudb/runtime/view/QuorumFuturesFactoryTest.java
test/src/test/java/org/corfudb/runtime/view/QuorumReplicationStreamViewTest.java
test/src/test/java/org/corfudb/runtime/view/SequencerViewTest.java
test/src/test/java/org/corfudb/runtime/view/SnowflakeGuidGeneratorTest.java
test/src/test/java/org/corfudb/runtime/view/StateTransferTest.java
test/src/test/java/org/corfudb/runtime/view/StreamViewTest.java
test/src/test/java/org/corfudb/runtime/view/StreamsViewTest.java
test/src/test/java/org/corfudb/runtime/view/ViewsGarbageCollectorTest.java
test/src/test/java/org/corfudb/runtime/view/replication/AbstractReplicationProtocolTest.java
test/src/test/java/org/corfudb/runtime/view/replication/ChainReplicationProtocolTest.java
test/src/test/java/org/corfudb/runtime/view/replication/QuorumReplicationProtocolAdditionalTests.java
test/src/test/java/org/corfudb/runtime/view/replication/QuorumReplicationProtocolTest.java
test/src/test/java/org/corfudb/runtime/view/stream/AbstractStreamViewTest.java
test/src/test/java/org/corfudb/runtime/view/stream/AddressMapStreamViewTest.java
test/src/test/java/org/corfudb/runtime/view/stream/BackpointerStreamViewTest.java
test/src/test/java/org/corfudb/runtime/view/stream/OpaqueStreamTest.java
test/src/test/java/org/corfudb/security/tls/ReloadableTrustManagerTest.java
test/src/test/java/org/corfudb/security/tls/TlsUtilsTest.java
test/src/test/java/org/corfudb/test/DisabledOnTravis.java
test/src/test/java/org/corfudb/test/TestUtils.java
test/src/test/java/org/corfudb/test/concurrent/TestThreadGroups.java
test/src/test/java/org/corfudb/util/MemoryFootprintMeasurerIT.java
test/src/test/java/org/corfudb/util/UuidUtilsTest.java
test/src/test/java/org/corfudb/util/retry/IRetryTest.java
test/src/test/java/org/corfudb/util/serializer/SerializersTest.java
test/src/test/java/org/corfudb/utils/TestLockListener.java
test/target/generated-sources/org/corfudb/runtime/CorfuOptions.java
test/target/generated-sources/org/corfudb/runtime/CorfuStoreMetadata.java
test/target/generated-sources/org/corfudb/test/SampleAppliance.java
test/target/generated-sources/org/corfudb/test/SampleSchema.java
test/target/generated-sources/org/corfudb/test/TestSchema.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/collections/PutIfAbsentMapTest$PutIfAbsentMap$CORFUSMR.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/ConflictParameterClass$CORFUSMR.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/CorfuCompoundObj$CORFUSMR.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/CorfuSharedCounter$CORFUSMR.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/TestClass$CORFUSMR.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/TestClassUsingAnnotation$CORFUSMR.java
test/target/generated-test-sources/test-annotations/org/corfudb/runtime/object/TransactionalObject$CORFUSMR.java
utils/src/main/java/org/corfudb/utils/lock/Lock.java
utils/src/main/java/org/corfudb/utils/lock/LockClient.java
utils/src/main/java/org/corfudb/utils/lock/LockListener.java
utils/src/main/java/org/corfudb/utils/lock/persistence/LockStore.java
utils/src/main/java/org/corfudb/utils/lock/persistence/LockStoreException.java
utils/src/main/java/org/corfudb/utils/lock/states/HasLeaseState.java
utils/src/main/java/org/corfudb/utils/lock/states/IllegalTransitionException.java
utils/src/main/java/org/corfudb/utils/lock/states/LockEvent.java
utils/src/main/java/org/corfudb/utils/lock/states/LockState.java
utils/src/main/java/org/corfudb/utils/lock/states/LockStateType.java
utils/src/main/java/org/corfudb/utils/lock/states/NoLeaseState.java
utils/src/main/java/org/corfudb/utils/lock/states/StoppedState.java
utils/target/generated-sources/org/corfudb/utils/CommonTypes.java
utils/target/generated-sources/org/corfudb/utils/lock/LockDataTypes.java
