<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>IClientRouter.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">generator</a> &gt; <a href="../index.html" class="el_bundle">runtime</a> &gt; <a href="index.source.html" class="el_package">org.corfudb.runtime.clients</a> &gt; <span class="el_source">IClientRouter.java</span></div><h1>IClientRouter.java</h1><pre class="source lang-java linenums">package org.corfudb.runtime.clients;

import io.netty.channel.ChannelHandlerContext;

import java.util.NoSuchElementException;
import java.util.concurrent.CompletableFuture;

import org.corfudb.protocols.wireprotocol.CorfuMsg;

/**
 * This is an interface in which all client routers must implement.
 * Client routers are classes which talk to server routers. Clients are registered
 * on client routers using the addClient() interface, and can be retrieved using the
 * getClient() interface.
 *
 * &lt;p&gt;Created by mwei on 12/13/15.
 */
public interface IClientRouter {


    /**
     * Add a new client to the router.
     *
     * @param client The client to add to the router.
     * @return This IClientRouter, to support chaining and the builder pattern.
     */
    IClientRouter addClient(IClient client);

    /**
     * Gets a client that matches a particular type.
     *
     * @param clientType The class of the client to match.
     * @param &lt;T&gt;        The type of the client to match.
     * @return The first client that matches that type.
     * @throws NoSuchElementException If there are no clients matching that type.
     */
    &lt;T extends IClient&gt; T getClient(Class&lt;T&gt; clientType);

    /**
     * Send a message and get a completable future to be fulfilled by the reply.
     *
     * @param ctx     The channel handler context to send the message under.
     * @param message The message to send.
     * @param &lt;T&gt;     The type of completable to return.
     * @return A completable future which will be fulfilled by the reply,
     * or a timeout in the case there is no response.
     */
    &lt;T&gt; CompletableFuture&lt;T&gt; sendMessageAndGetCompletable(ChannelHandlerContext ctx,
                                                          CorfuMsg message);

    /**
     * Send a message using the router channel handler and
     * get a completable future to be fulfilled by the reply.
     *
     * @param message The message to send.
     * @param &lt;T&gt;     The type of completable to return.
     * @return A completable future which will be fulfilled by the reply,
     *      or a timeout in the case there is no response.
     */
    default &lt;T&gt; CompletableFuture&lt;T&gt; sendMessageAndGetCompletable(CorfuMsg message) {
<span class="nc" id="L61">        return sendMessageAndGetCompletable(null, message);</span>
    }

    /**
     * Send a one way message, without adding a completable future.
     *
     * @param ctx     The context to send the message under.
     * @param message The message to send.
     */
    void sendMessage(ChannelHandlerContext ctx, CorfuMsg message);

    /**
     * Send a one way message using the default channel handler,
     * without adding a completable future.
     *
     * @param message The message to send.
     */
    default void sendMessage(CorfuMsg message) {
<span class="nc" id="L79">        sendMessage(null, message);</span>
<span class="nc" id="L80">    }</span>

    /**
     * Send a netty message through this router, setting the fields in the outgoing message.
     *
     * @param ctx    Channel handler context to use.
     * @param inMsg  Incoming message to respond to.
     * @param outMsg Outgoing message.
     */
    void sendResponseToServer(ChannelHandlerContext ctx, CorfuMsg inMsg, CorfuMsg outMsg);

    /**
     * Complete a given outstanding request with a completion value.
     *
     * @param requestID  The request to complete.
     * @param completion The value to complete the request with
     * @param &lt;T&gt;        The type of the completion.
     */
    &lt;T&gt; void completeRequest(long requestID, T completion);

    /**
     * Exceptionally complete a request with a given cause.
     *
     * @param requestID The request to complete.
     * @param cause     The cause to give for the exceptional completion.
     */
    void completeExceptionally(long requestID, Throwable cause);

    /**
     * Starts routing requests.
     */
    void start();

    /**
     * Stops routing requests.
     */
    void stop();

    void stop(boolean shutdown);

    /**
     * The host that this router is routing requests for.
     */
    String getHost();

    /**
     * The port that this router is routing requests for.
     */
    Integer getPort();

    /**
     * Set the Connect timeout
     *
     * @param timeoutConnect timeout for connection in milliseconds.
     */
    void setTimeoutConnect(long timeoutConnect);

    /**
     * Set the retry timeout
     *
     * @param timeoutRetry timeout to make a retry in milliseconds.
     */
    void setTimeoutRetry(long timeoutRetry);

    /**
     * Set the Response timeout
     *
     * @param timeoutResponse Response timeout in milliseconds.
     */
    void setTimeoutResponse(long timeoutResponse);
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>